!function(e,t,G){G.un,G.uns;var f=G.static,b=G.class,p=G.getset,n=(G.__newvec,modules.activity.others.A_TestAwardsModel),s=layouts.bag.AchieveItemNewLayoutUI,o=layouts.bag.AchieveItemUI,a=(modules.achievenew.order.AchieveNew_InternalOrder,modules.achievenew.order.AchieveNew_Server_Order,modules.achieve.order.Achieve_Order,zwc.engine.core.displays.avatars.ActConst,layouts.nav.ActIconCollectionUI),g=zwc.engine.core.displays.avatars.ActWealthData,r=modules.digger.views.active.ActivityEntranceExplainView,l=layouts.activity.gongce.ActivityGongceLoginLayoutUI,c=layouts.activity.hefu.ActivityHeFuAthleticsLayoutUI,u=layouts.activity.hefu.ActivityHeFuChargeGiftLayoutUI,d=layouts.activity.hefu.ActivityHeFuChargeProfitDayLayoutUI,i=layouts.activity.hefu.ActivityHeFuChargeProfitItemLayoutUI,h=layouts.activity.hefu.ActivityHeFuChargeProfitLayoutUI,_=(layouts.activity.hefu.ActivityHeFuGifItemLayoutUI,modules.activity.others.ActivityHeFuGiftStatuVo),v=layouts.activity.hefu.ActivityHeFuLoginLayoutUI,m=layouts.activity.hefu.ActivityHeFuShaChengLayoutUI,y=layouts.activity.hefu.ActivityHeFuTreasureLayoutUI,I=layouts.activity.hefu.ActivityHeFuVipSpecialLayoutUI,w=protos.activity.ActivityHeFu_Back_Vip_30732_toc,x=protos.activity.ActivityHeFu_Reqeust_VipTry_30731_tos,S=protos.activity.ActivityHeFu_Reqeust_Vip_30733_tos,k=protos.activity.ActivityHeFu_Request_Welfare_tos_30734,E=layouts.activity.hefu.ActivityHefuAlthletiscItemLayoutUI,T=layouts.activity.hefu.ActivityHefuRankItemUI,C=layouts.activity.hefu.ActivityHefuRankMainUI,L=layouts.activity.hefu.ActivityHefuWelfareResetLayoutUI,M=layouts.activity.tehui.ActivityMysteryLayoutUI,A=modules.activity.others.ActivityMysteryMallvo,D=layouts.broad.ActivityOpenViewUI,O=layouts.activity.tehui.ActivityPointShopUI,P=modules.activity.others.ActivityPointShopVo,R=protos.activity.ActivityRankVo,N=layouts.activity.tehui.ActivityTehuiLayoutUI,B=layouts.activity.ActivityUI,H=(modules.activity.order.Activity_InternalOrder,modules.activity.order.Activity_ServiceOrder,layouts.actor.ActorActRemindTipUI),V=layouts.actor.ActorActiveVUI,U=layouts.actor.ActorAtrrDetailUI,F=modules.actor.others.ActorConst,q=layouts.actor.ActorEquipVUI,j=layouts.actor.heji.ActorHeJiCanJuanLayoutUI,W=modules.actor.others.ActorHeJiConfigVo,Y=layouts.actor.heji.ActorHeJiExchangeDetailItemLayoutUI,z=layouts.actor.heji.ActorHeJiExchangeLayoutUI,X=layouts.actor.heji.ActorHeJiFenJieLayoutUI,Q=layouts.actor.heji.ActorHeJiFuWenAttrTipLayoutUI,J=layouts.actor.heji.ActorHeJiMainTypeItemLayoutUI,Z=layouts.actor.heji.ActorHeJiMoreAttrLayoutUI,K=layouts.actor.heji.ActorHeJiSkillTIpsUI,$=layouts.actor.lunhui.ActorLunhuiViewUI,ee=modules.resonate.others.ActorResonateData,te=layouts.actor.ActorSelectUI,ie=layouts.actor.ActorShowVUI,ne=layouts.actor.ActorVeinVUI,se=layouts.actor.wing.ActorWingVUI,oe=layouts.actor.zs.ActorZsViewUI,ae=protos.actor.Actor_Back_Setting_toc_10121,le=protos.actor.Actor_HeJi_Back_Info_toc_23712,ce=protos.actor.Actor_HeJi_Back_Upgrade_toc_23711,ue=protos.actor.Actor_HeJi_Request_Upgrade_tos_23710,de=(modules.actor.order.Actor_InternalOrder,protos.actor.Actor_Request_Setting_tos_10120),he=modules.actor.order.Actor_ServerOrder,_e=protos.actor.Actor_request_ZhuiJi_tos_10507,fe=layouts.arena.ArenaFailViewUI,pe=layouts.arena.ArenaInfoVNewUI,ge=layouts.arena.ArenaMVUI,ve=layouts.arena.ArenaMatchViewUI,me=layouts.arena.ArenaRankVUI,ye=layouts.arena.ArenaSeasonVUI,Ie=layouts.arena.ArenaSucceedViewUI,be=(modules.arena.order.Arena_order,utils.ArrayUtil),we=layouts.task.ArrowUI,xe=laya.ui.Asset,Se=protos.assist.Assist_request_note_tos_23715,ke=layouts.assit.AssitMVUI,Ee=(modules.assit.order.AssitOrder,zwc.saiman.Asswc),Te=(zwc.engine.core.protos.AsswcOrder,laya.webgl.atlas.AtlasResourceManager),Ce=laya.debug.tools.AtlasTools,Le=(laya.webgl.atlas.Atlaser,layouts.nav.AttRemindUI),Me=layouts.broad.AttrEffectItemUI,Ae=layouts.broad.AttrEffectViewUI,De=(protos.mail.AttrVo,modules.auctionhouse.other.AuctionRequest),Oe=(modules.auctionhouse.order.Auction_InternalOrder,modules.auctionhouse.order.Auction_ServiceOrder,zwc.engine.core.displays.avatars.AvatarScaleData),Pe=protos.backpack.BackPack_Back_Echange_toc_23621,Re=protos.backpack.BackPack_Back_Open_Package_toc_10413,Ne=(modules.backpack.order.BackPack_InternalOrder,protos.backpack.BackPack_Request_CheckGoods_tos_10422),Be=protos.backpack.BackPack_Request_Exchange_tos_23620,He=protos.backpack.BackPack_Request_Open_Package_tos_10412,Ve=modules.backpack.order.BackPack_ServerOrder,Ge=layouts.bag.bagCompose.BagBtnsViewUI,Ue=layouts.bag.bagCompose.BagComBigBtnUI,Fe=layouts.bag.bagCompose.BagComItem2UI,qe=layouts.bag.bagCompose.BagComItemUI,je=layouts.bag.bagCompose.BagComViewUI,We=layouts.bag.bagCompose.BagComposeBtnUI,Ye=layouts.bag.BagEquipViewUI,ze=layouts.bag.BagItemViewUI,Xe=layouts.bag.BagLongWenViewUI,Qe=layouts.bag.BagPackageLayoutUI,Je=layouts.bag.BagViewBaseUI,Ze=layouts.recharge.BaiYuanHaoLiVUI,Ke=layouts.recharge.BaiYuanItemUI,$e=protos.db.BaseConfig,et=zwc.utils.Bezier,tt=utils.BitmapLoader,it=modules.bossancient.view.BossAncientRankItem,nt=modules.bossancient.others.BossAncientVo,st=(modules.bossancient.order.BossAncient_InterOrder,modules.bossancient.order.BossAncient_ServiceOrder,modules.boss.others.BossConst,layouts.navboss.BossHeadTowerUI),ot=layouts.navboss.BossHeadUI,at=(protos.db.BossHome,layouts.boss.bosshome.BossHomeMainLayoutUI,layouts.boss.bosshome.BossHomeMainRenderLayoutUI,layouts.boss.bosshome.BossHomeSubIRenderLayoutUI,layouts.boss.bosshome.BossHomeSubLayoutUI,layouts.boss.bosshome.BossHomeSubLevelRenderLayoutUI,modules.boss.others.BossHomeVO,protos.boss.BossHome_back_baseInfo_30400_toc),rt=protos.boss.BossHome_back_bossDead_30402_toc,lt=protos.boss.BossHome_back_bossRebord_30401_toc,ct=modules.boss.others.BossPersonVo,ut=modules.boss.others.BossWildVo,dt=(modules.boss.order.Boss_InterOrder,modules.boss.order.Boss_ServiceOrder,utils.easing.Bounce,laya.ui.Box),ht=layouts.broad.BroadGetIconUI,_t=layouts.broad.BroadGetSepcialRingUI,ft=layouts.broad.BroadcastViewUI,pt=(modules.broadcast.order.Broadcast_order,laya.utils.Browser),gt=protos.db.BuffPassiveFly,vt=(modules.buff.order.Buff_InternalOrder,laya.ui.Button),mt=(laya.utils.Byte,utils.ByteArray),yt=zwc.utils.ByteUtils,It=protos.db.CActivity,bt=protos.db.CActivityEntranceResource,wt=protos.db.CActivityExchange,xt=protos.db.CActivityFire,St=protos.db.CActivityGift,kt=protos.db.CActivityIcon,Et=protos.db.CActivityMainType,Tt=protos.db.CActivityRank,Ct=protos.db.CArenaCommon,Lt=protos.db.CArenaPlayerLevel,Mt=protos.db.CArenaPurchase,At=protos.db.CArenaReward,Dt=(protos.db.CAuctionResource,protos.db.CAuctionWorldBossResource,protos.db.CAvatarClothes),Ot=protos.db.CAvatarWeapon,Pt=protos.db.CAvatarWing,Rt=protos.db.CBackpack,Nt=protos.db.CBaiYuan,Bt=(protos.db.CBlackGoodsMatch,protos.db.CBossCardLevelResource),Ht=protos.db.CBossCardResolveResource,Vt=protos.db.CBossCardSuitResource,Gt=protos.db.CBpRedDot,Ut=(protos.db.CBuffModel,protos.db.CCelebretion),Ft=(protos.db.CClothDispose,protos.db.CConCeal),qt=protos.db.CConfigDragonDesignOpen,jt=protos.db.CConfigDragonInfo,Wt=protos.db.CConfigDragonPartOpen,Yt=protos.db.CConfigDragonView,zt=protos.db.CConfigDuanHun,Xt=protos.db.CConfigDuanHunBuff,Qt=protos.db.CConfigGodRingModel,Jt=protos.db.CConfigJQRAttr,Zt=modules.skill.others.CD,Kt=protos.db.CDailyRecharge,$t=protos.db.CDailyTaskData,ei=protos.db.CDescModel,ti=protos.db.CDragonSoulUpgrade,ii=(protos.db.CEnchantModel,protos.db.CEnhanceModel,protos.db.CFDShowAward,protos.db.CFSShowAward),ni=protos.db.CFashionModel,si=protos.db.CFashionSuitModel,oi=protos.db.CFashionUpgradeResourceModel,ai=protos.db.CFavourPointResource,ri=protos.db.CFavourPointReward,li=(protos.db.CFazhenQn,protos.db.CFazhenResourse,protos.db.CFazhenSkill,protos.db.CFeedKunResource),ci=(protos.db.CFeedRankResource,protos.db.CFestBossView),di=protos.db.CFestivalBoss,hi=protos.db.CFieldFightAward,_i=protos.db.CFieldRankAward,fi=(protos.db.CFireDragon,protos.db.CFirstRecharge),pi=protos.db.CFlyUpModel,gi=protos.db.CFlyUpTitle,vi=protos.db.CFlyupBoss,mi=(protos.db.CForgingiCostModel,protos.db.CFunctionBuffModel),yi=protos.db.CGDReonanceResource,Ii=protos.db.CGFTmapping,bi=protos.db.CGRelive,wi=protos.db.CGcAward,xi=(protos.db.CGemStoneModel,protos.db.CGenter),Si=protos.db.CGodArmsHoly,ki=protos.db.CGodArmsSkill,Ei=protos.db.CGodArmsUpgrade,Ti=protos.db.CGodComModel,Ci=protos.db.CGodEquip,Li=protos.db.CGodWeapon,Mi=protos.db.CGodWeaponPosition,Ai=protos.db.CGodWeaponShow,Di=protos.db.CGodlyEquipModel,Oi=protos.db.CGoldEgg,Pi=protos.db.CGoldEggReward,Ri=protos.db.CGoldTurn,Ni=protos.db.CGoldTurnRate,Bi=protos.db.CGoodsModel,Hi=protos.db.CGuanQiaResource,Vi=(protos.db.CGuildShopGoods,protos.db.CHelpDes),Gi=protos.db.CHerald,Ui=protos.db.CIconBubble,Fi=protos.db.CInnerAttrPillModel,qi=protos.db.CInventedName,ji=protos.db.CJZGodModel,Wi=protos.db.CKunResource,Yi=protos.db.CLimitSurprise,zi=protos.db.CLimiteGift,Xi=protos.db.CLoadingCoolTime,Qi=protos.db.CLoadingMsg,Ji=protos.db.CLunhuiGoodsExchangeModel,Zi=protos.db.CLunhuiLevelExchangeModel,Ki=protos.db.CLunhuiModel,$i=protos.db.CMagicEquipCombineResource,en=protos.db.CMagicEquipUpgradeResource,tn=protos.db.CMagicPositionResource,nn=protos.db.CMagicSuitResource,sn=protos.db.CMagicTower,on=protos.db.CMagicWeaponSoulResource,an=(protos.db.CMatMisstionPrice,protos.db.CMateMissionTimes,protos.db.CMentalMissonModel,protos.db.CMijiHoleModel),rn=protos.db.CMissionModel,ln=protos.db.CMoMappingResource,cn=protos.db.CMoZhuHunResource,un=protos.db.CModuleOpenResource,dn=protos.db.CMohuaResource,hn=protos.db.CMonsterData,_n=protos.db.CMonsterModels,fn=protos.db.CNPCOption,pn=protos.db.CNewGuide,gn=protos.db.CNsGiftRes,vn=protos.db.COfficialDailyResource,mn=protos.db.COfficialResource,yn=protos.db.COfficialRewardResource,In=protos.db.COfficialTaskResource,bn=protos.db.CPinXiXiComResource,wn=protos.db.CPlayerActivity,xn=protos.db.CPlayerGift,Sn=protos.db.CPrestigeResource,kn=protos.db.CPreviewAwardDetail,En=protos.db.CPreviewAwardNav,Tn=protos.db.CRainbowWord,Cn=protos.db.CRankTitle,Ln=protos.db.CRecharge,Mn=protos.db.CRechargeGift,An=protos.db.CRechargeGiftShow,Dn=protos.db.CRoleSystemModel,On=protos.db.CRoleSystemStepModel,Pn=protos.db.CSceneCheckPoint,Rn=protos.db.CSdkGift,Nn=protos.db.CShopModel,Bn=protos.db.CSignIn,Hn=protos.db.CSignInTimes,Vn=protos.db.CSkillModel,Gn=protos.db.CSoulSkinNameModel,Un=protos.db.CSoulSkinResource,Fn=protos.db.CSoulSkinSkillModel,qn=protos.db.CSoulSuolianResource,jn=protos.db.CSoulTalentSkillModel,Wn=protos.db.CSysGuide,Yn=protos.db.CSysGuideDesc,zn=protos.db.CTaskModel,Xn=protos.db.CTeamCopyGLModel,Qn=protos.db.CTeamCopyModel,Jn=(protos.db.CTeamCopyOtherModel,protos.db.CTreePick),Zn=protos.db.CTreePlant,Kn=(protos.db.CYiguiResource,protos.db.CYuPei),$n=protos.db.CZhuHunUpgradeResource,es=protos.db.CZsAttrModel,ts=protos.db.CZsExchangeModel,is=protos.db.CZsLevelExchange,ns=(layouts.guild.boss.CallBossExitUI,layouts.guild.boss.CallBossItemUI,layouts.guild.boss.CallBossMainViewUI,protos.db.CashExchange,modules.scene.others.fight.CateConst,protos.db.CcztzModel),ss=modules.changename.others.ChangeNameManager,os=layouts.changename.ChangeNameViewUI,as=(modules.changename.order.ChangeName_order,layouts.chat.ChatBaseUI),rs=layouts.chat.ChatFaceBaseUI,ls=modules.chat.others.ChatSendHelper,cs=(modules.chat.order.Chat_order,modules.checkpoint.others.CheckPointConst,layouts.checkpoint.CheckPointExpAddUI),us=protos.checkpoint.tos.CheckPoint_GetReward_23616_tos,ds=(modules.checkpoint.order.CheckPoint_InternalOrder,protos.checkpoint.tos.CheckPoint_KillLittleMonster_23613),hs=(modules.checkpoint.order.CheckPoint_ServerOrder,protos.checkpoint.toc.CheckPoint_toc_23611),_s=(protos.checkpoint.toc.CheckPoint_toc_23612,utils.easing.Circ,ui.CircleCDItem,zwc.utils.ClassUtil),fs=laya.utils.ClassUtils,ps=protos.db.ClassicalRingResource,gs=(laya.debug.tools.ClickSelectTool,protos.db.ClientRewardModel),vs=laya.ui.Clip,ms=(layouts.fashion.ClothesCupboardViewUI,layouts.fashion.ClothesDisposeItemUI,layouts.fashion.ClothesDisposeTipUI,utils.ColorConst),ys=laya.filters.ColorFilter,Is=ui.ColorFont,bs=protos.db.CombineAttackExchange,ws=protos.db.CombineAttackRuneResource,xs=utils.Common,Ss=laya.ui.Component,ks=modules.godweapon.others.ConditionUtil,Es=G.Config,Ts=protos.db.ConfigBPComResource,Cs=protos.db.ConfigBPMap,Ls=protos.db.ConfigBuff,Ms=protos.db.ConfigChuanshi,As=protos.db.ConfigChuanshiSuit,Ds=protos.ConfigDataUtils,Os=protos.db.ConfigDragonType,Ps=protos.db.ConfigFlyUpSuitLimit,Rs=protos.db.ConfigFlyUpSuitResource,Ns=protos.db.ConfigFlyUpSuitTitle,Bs=protos.db.ConfigGELC,Hs=protos.db.ConfigGELCgroup,Vs=protos.db.ConfigGuildBoss,Gs=(protos.db.ConfigGuildBuildUpgrade,protos.db.ConfigGuildDonation,protos.db.ConfigGuildLevel,protos.db.ConfigGuildMJ),Us=protos.db.ConfigGuildSkill,Fs=protos.db.ConfigKunMisstionPrice,qs=protos.db.ConfigLCResource,js=protos.db.ConfigLuckDrawResource,Ws=protos.db.ConfigLuckDrawSubResource,Ys=protos.db.ConfigMSRefresh,zs=protos.db.ConfigMedal,Xs=protos.db.ConfigMiji,Qs=protos.db.ConfigMijiGrid,Js=protos.db.ConfigMineCommon,Zs=protos.db.ConfigMiner,Ks=protos.db.ConfigMysteryShop,$s=protos.db.ConfigNewWing,eo=protos.db.ConfigNiePanEleResource,to=protos.db.ConfigNiePanResource,io=protos.db.ConfigPreview,no=(protos.db.ConfigRaiseKun,protos.db.ConfigRaiseKunSkill,protos.db.ConfigRareShop),so=protos.db.ConfigRingSkill,oo=protos.db.ConfigSeaAir,ao=(protos.db.ConfigShaoZhu,protos.db.ConfigShaoZhuCommon,protos.db.ConfigShaoZhuEnter,protos.db.ConfigSpecialDonation,protos.db.ConfigTalent),ro=protos.db.ConfigTalentLevel,lo=protos.db.ConfigTalentMap,co=protos.db.ConfigTitle,uo=protos.db.ConfigTqyueka,ho=protos.db.ConfigTrunTableResource,_o=(ui.controls.ConfigView_Temp_1,protos.db.ConfigVip),fo=protos.db.ConfigWSSkill,po=protos.db.ConfigWeaponSoul,go=protos.db.ConfigWeaponSoulPos,vo=(protos.db.ConfigWildBossTimes,protos.db.ConfigWingCombine),mo=protos.db.ConfigWingEffect,yo=protos.db.ConfigWingEquip,Io=protos.db.ConfigWingExchange,bo=protos.db.ConfigWorldBoss,wo=protos.db.ConfigWxshare,xo=protos.db.ConfigYCTianGuan,So=protos.db.ConfigYZBQAward,ko=protos.db.ConfigYZBQCommon,Eo=protos.db.ConfigYZBQRankAward,To=protos.db.ConfigYzbqcKillMsg,Co=(modules.copy.others.CopyConst,layouts.activityDaily.CopyShareViewUI),Lo=modules.copy.others.CopyTowerData,Mo=(modules.copy.order.Copy_InternalOrder,modules.copy.order.Copy_ServiceOrder,layouts.copy.CpMaterialItemUI,layouts.copy.CpMaterialViewUI,modules.corssbattle.others.CrossBattleConst,layouts.crossbattle.CrossBattleItemUI,protos.db.CrossBattleMainShow,layouts.crossbattle.CrossBattleViewUI,modules.corssbattle.order.CrossBattle_InternalOrder,modules.corssbattle.order.CrossBattle__ServiceOrder,modules.corssbattle.others.CrossBettleItemTypeConst,layouts.crossbattle.crossboss.CrossBossCaijiBarUI),Ao=(layouts.crossbattle.crossboss.CrossBossCenterItemUI,layouts.crossbattle.crossboss.CrossBossEnterViewUI,layouts.crossbattle.newworldboss.CrossBossItemViewUI,protos.db.CrossBossMissionResource),Do=layouts.crossbattle.crossboss.CrossBossResultUI,Oo=layouts.crossbattle.crossboss.CrossBossTitleUI,Po=(layouts.crossbattle.crossboss.CrossBossViewUI,layouts.crossbattle.newworldboss.CrossNewBossAttentionItemUI,layouts.crossbattle.newworldboss.CrossNewBossAttentionUI,modules.corssbattle.others.CrossNewBossDataModel),Ro=(layouts.crossbattle.newworldboss.CrossNewBossFightItemUI,layouts.crossbattle.newworldboss.CrossNewBossFightViewUI,layouts.crossbattle.newworldboss.CrossNewBossKillRecordItemUI,layouts.crossbattle.newworldboss.CrossNewBossKillRecordViewUI,layouts.crossbattle.newworldboss.CrossNewBossKillSmallRecordItemUI,layouts.crossbattle.newworldboss.CrossNewBossSceneItemUI,layouts.crossbattle.newworldboss.CrossNewBossSceneViewUI,layouts.crossbattle.newworldboss.CrossNewWorldBossViewUI,modules.corssbattle.others.CrossStatusConst,layouts.crossbattle.crossboss.CrossbossItemUI,protos.db.CwxShareLvVip),No=utils.DBUtil,Bo=(layouts.pig.DailyCopyVUI,layouts.dailygift.DailyGiftItemUI,modules.dailygift.others.DailyGiftReq),Ho=layouts.dailygift.DailyGiftVUI,Vo=(modules.activityDaily.order.Daily_InternalOrder,modules.activityDaily.order.Daily_ServiceOrder,protos.scene.DamageType),Go=utils.DateUtil,Uo=laya.debug.DebugPanel,Fo=(zwc.engine.core.controls.dock.DefaultModule,layouts.common.DialogueBubbleViewUI),qo=layouts.common.DialogueViewUI,jo=laya.utils.Dictionary,Wo=modules.digger.others.DiggerConst,Yo=protos.db.DiggerGroup,zo=(modules.digger.order.DiggerOrder,layouts.task.DirectionAchieveItemUI),Xo=zwc.engine.core.displays.DisplaySprite,Qo=protos.db.DragonDiggerExhibition,Jo=layouts.actor.cimelia.DragonSoulActivedUI,Zo=layouts.actor.cimelia.DragonSoulUI,Ko=(protos.arena.DtoArenaPlayer,protos.arena.DtoArenaRank,protos.chat.DtoChat),$o=protos.scene.DtoEnterScene,ea=protos.fashion.DtoFashion,ta=protos.field.DtoField,ia=protos.scene.DtoGKData,na=(protos.inner.DtoInner,protos.boss.DtoMijingBossData,protos.goldrotary.DtoRotary,protos.skill.DtoSkill),sa=(modules.scene.others.DtoTeleportPoint,protos.title.DtoTitle,protos.guild.Dto_GuildInfo,protos.guild.Dto_GuildMem,layouts.god.DuanHunAttrUI),oa=layouts.god.DuanHunSkillTipUI,aa=(modules.activity.others.EActivity,modules.arena.others.EArenaType,modules.actor.others.enum.EAttri),ra=(modules.chat.others.EChannel,modules.chat.others.EChatType,type.EClickType,zwc.engine.global.EConst),la=(modules.copy.others.ECopyType,modules.dailygift.others.EDailyGift,modules.actor.others.enum.EEquip),ca=modules.backpack.others.enum.EGoodsConst,ua=(modules.guide.others.EGuideType,modules.actor.others.enum.EHeJiConst),da=(modules.chat.others.ELinkType,modules.chat.others.ELinkUIType,protos.broadcast.EMsgId,modules.broadcast.others.EMsgShow,modules.broadcast.others.EMsgType,modules.task.others.ENewGuideEvent),ha=(modules.actor.others.enum.ERing,modules.actor.others.enum.ERoleType),_a=global.EScene,fa=(global.ESound,modules.actor.others.enum.ESpecial),pa=(modules.backpack.others.enum.EUsageType,laya.utils.Ease),ga=layouts.pet.EggTipUI,va=modules.chat.others.links.EquipLink,ma=(modules.actor.others.enum.EquipPart,layouts.broad.EquipWearTipUI),ya=protos.db.EquipsDiggerExhibition,Ia=laya.events.Event,ba=laya.events.EventDispatcher,wa=layouts.recharge.EveryRechargeVUI,xa=protos.db.ExchangeResource,Sa=protos.db.ExploreResource,ka=modules.fashion.others.FashionConfigData,Ea=(layouts.fashion.FashionItemRenderUI,modules.fashion.others.FashionReqUtils,layouts.fashion.FashionSuitAttrUI,layouts.fashion.FashionSuitItemUI,layouts.bag.FashionTipUI),Ta=(layouts.fashion.FashionViewBaseUI,modules.fashion.order.Fashion_order,layouts.activityDaily.FavourGameViewUI),Ca=(layouts.fazhen.FazhenAllViewUI,layouts.fazhen.FazhenItemUI,layouts.fazhen.FazhenJulianViewUI,layouts.fazhen.FazhenQnGridUI,layouts.fazhen.FazhenSkillAlertUI,layouts.fazhen.FazhenSkilllTipsUI,layouts.fazhen.FazhenViewUI,layouts.field.FieldFightItemUI),La=layouts.field.FieldFightVUI,Ma=layouts.field.FieldMVUI,Aa=(modules.field.order.Field_order,modules.scene.others.fight.FightConst),Da=layouts.broad.FightEffectViewUI,Oa=layouts.fight.FightStartUI,Pa=layouts.fight.FightSuccessPersonBossFirstKillLayoutUI,Ra=layouts.fight.FightSuccessUI,Na=(modules.fight.order.Fight_order,modules.firedragon.others.FireDragonData),Ba=modules.firedragon.view.FireDragonRankItem,Ha=modules.firedragon.view.FireDragonRankItem2,Va=(modules.firedragon.order.FireDragon_InterOrder,modules.firedragon.order.FireDragon_ServiceOrder,layouts.recharge.FirstPayPopUI),Ga=layouts.recharge.FirstRechargeVUI,Ua=layouts.chat.FlyUpNPCChatUI,Fa=(layouts.boss.flyupBoss.FlyupBossItemViewUI,layouts.boss.flyupBoss.FlyupBossLevelRenderItemUI,layouts.boss.flyupBoss.FlyupBossMainLayoutUI,layouts.actor.soaring.other.FlyupBossOpenViewUI),qa=modules.boss.others.FlyupBossVO,ja=modules.activityDaily.others.FocusRewardManager,Wa=laya.display.css.Font,Ya=(laya.ui.FontClip,layouts.friendnew.FriendNewAddFriendLayoutUI,layouts.friendnew.FriendNewAddLayoutUI,layouts.friendnew.FriendNewApplyRenderLayoutUI,layouts.friendnew.FriendNewBlockRenderLayoutUI,layouts.friendnew.FriendNewFriendRenderLayoutUI,layouts.friendnew.FriendNewMainViewUI,layouts.friendnew.FriendNewRecentPlayerHeadItemLayoutUI,modules.friendnew.others.FriendNewVo,modules.friendnew.orders.FriendNew_InnerOrder,protos.friendsnew.toc.FriendNew_back_applyRed_30477_toc),za=protos.friendsnew.toc.FriendNew_back_chatBack_30473_toc,Xa=protos.friendsnew.toc.FriendNew_back_list_30468_toc,Qa=(protos.friendsnew.tos.FriendNew_requestApply_30467_tos,protos.friendsnew.tos.FriendNew_request_addByName_30471_tos,protos.friendsnew.tos.FriendNew_request_addChat_30472_tos,protos.friendsnew.tos.FriendNew_request_add_30466_tos,protos.friendsnew.tos.FriendNew_request_allChatRecord_30475_tos,protos.friendsnew.tos.FriendNew_request_delFriend_30470_tos,protos.friendsnew.tos.FriendNew_request_list_30469_tos,protos.friendsnew.tos.FriendNew_request_readPlayer_30474_tos,modules.friendnew.orders.FriendNew_serverOrder,layouts.bag.FuWenNormalTipUI),Ja=layouts.actor.wing.FunctionActiveVUI,Za=(layouts.guild.siege.GC_AwardsViewUI,layouts.guild.siege.GC_GuildAwardsViewUI,layouts.guild.siege.GC_GuildHuiZhangAwardsViewUI,layouts.guild.siege.GC_GuildRankViewUI,layouts.guild.siege.GC_PersonAwardsViewUI,layouts.guild.siege.GC_PersonRankViewUI,layouts.guild.siege.GC_RankInfoViewUI,layouts.guild.siege.GC_ScAwardsItemUI,layouts.guild.siege.GC_ScAwardsViewUI,zwc.engine.global.GConst),Ka=modules.chat.views.gm.GMButtonLog,$a=modules.chat.views.gm.GMFitView,er=layouts.chat.GMHelpUI,tr=modules.chat.views.gm.GMLog,ir=protos.db.GWFairyLandResource,nr=utils.GameLog,sr=layouts.god.GeAttrUI,or=layouts.actor.lunhui.GetLhExpItemUI,ar=layouts.actor.lunhui.GetLhExpViewUI,rr=layouts.skill.GetSeaAirExpItemUI,lr=layouts.skill.GetSeaAirExpViewUI,cr=layouts.actor.zs.GetZsExpItemUI,ur=layouts.actor.zs.GetZsExpViewUI,dr=(protos.db.GiveWeiResource,global.Global),hr=global.GI,_r=global.GC,fr=laya.filters.GlowFilter,pr=layouts.god.GodDuanHunVUI,gr=layouts.god.GodEquipPreviewLayoutUI,vr=layouts.god.GodEquipUI,mr=(layouts.godweapon.compound.GodWeaponCompoundItemUI,layouts.godweapon.compound.GodWeaponCompoundMainViewUI),yr=layouts.godweapon.weapon.GodWeaponDetailAttrTipUI,Ir=modules.godweapon.others.GodWeaponFairylandConst,br=layouts.godweapon.fairyland.GodWeaponFairylandCountDownLayoutUI,wr=layouts.godweapon.fairyland.GodWeaponFairylandDetailLayoutUI,xr=layouts.godweapon.fairyland.GodWeaponFairylandLevelLayoutUI,Sr=modules.godweapon.others.vo.GodWeaponFairylandLevelVo,kr=layouts.godweapon.fairyland.GodWeaponFairylandMainLayoutUI,Er=layouts.godweapon.fairyland.GodWeaponFairylandRankLayoutUI,Tr=layouts.godweapon.fairyland.GodWeaponFairylandRankSimpleLayoutUI,Cr=layouts.godweapon.fairyland.GodWeaponFairylandSuccessLayoutUI,Lr=layouts.godweapon.weapon.GodWeaponHolyIconUI,Mr=layouts.godweapon.weapon.GodWeaponMainUI,Ar=(layouts.godweapon.weapon.GodWeaponPreItemUI,layouts.godweapon.shengyu.GodWeaponSYItemUI),Dr=layouts.godweapon.weapon.GodWeaponSelectItemUI,Or=layouts.godweapon.weapon.GodWeaponSelectPanelUI,Pr=layouts.godweapon.shengyu.GodWeaponSetViewUI,Rr=layouts.godweapon.shengyu.GodWeaponSettingItemUI,Nr=layouts.godweapon.shengyu.GodWeaponShengYuViewUI,Br=layouts.godweapon.weapon.GodWeaponSkillAlertUI,Hr=layouts.godweapon.weapon.GodWeaponSkillIconUI,Vr=layouts.godweapon.weapon.GodWeaponSkillPanelUI,Gr=layouts.godweapon.weapon.GodWeaponTaskPanelUI,Ur=layouts.godweapon.shengyu.GodWeaponTipViewUI,Fr=layouts.godweapon.shengyu.GodWeaponTowerItemUI,qr=(modules.godweapon.order.GodWeapon_InternalOrder,modules.godweapon.order.GodWeapon_ServerOrder,protos.godweapon.toc.GodWeapon_backFairylandInfo_23770_toc),jr=protos.godweapon.toc.GodWeapon_backFairylandLevelInfo_23771_toc,Wr=protos.godweapon.tos.GodWeapon_requestFairylandAddChallengeTime_23773_tos,Yr=protos.godweapon.tos.GodWeapon_requestFairylandGetReward_23772_tos,zr=(modules.god.order.God_InternalOrder,modules.god.order.God_ServiceOrder,layouts.actor.godlyequip.GodlyEquipMainUI),Xr=layouts.actor.godlyequip.GodlyEquipResolveItemUI,Qr=layouts.actor.godlyequip.GodlyEquipResolveUI,Jr=layouts.godweapon.weapon.GoldCostAlertUI,Zr=layouts.goldlottery.GoldLotteryBuyLayoutUI,Kr=modules.activity.others.GoldLotteryDataModel,$r=layouts.goldlottery.GoldLotteryGetLayoutUI,el=layouts.goldlottery.GoldLotteryInfoLayoutUI,tl=layouts.goldlottery.GoldLotteryMainLayoutUI,il=layouts.goldrotary.GoldRotaryGetUI,nl=layouts.goldrotary.GoldRotaryVUI,sl=modules.goldrotary.others.GoldrotaryDatas,ol=(modules.goldrotary.order.Goldrotary_order,zwc.utils.GomeUtils),al=(protos.mail.GoodVo,layouts.bag.GoodsAchieveNewLayoutUI),rl=layouts.bag.GoodsAchieveUI,ll=layouts.bag.GoodsContent2UI,cl=layouts.bag.GoodsContentUI,ul=modules.chat.others.links.GoodsLink,dl=layouts.broad.GoodsQuickUseTipUI,hl=layouts.bag.GoodsUseTipUI,_l=modules.achievenew.others.GovConst,fl=modules.achievenew.others.GovDataModel,pl=layouts.achievenew.gov.GovLiLianRewardLayoutUI,gl=layouts.achievenew.gov.GovMainPanelLayoutUI,vl=modules.achievenew.others.GovTaskClientVO,ml=layouts.achievenew.gov.GovTaskItemLayoutUI,yl=protos.gov.toc.Gov_BackInfo_21006_toc,Il=protos.gov.toc.Gov_GetGuanYinBack_21011_toc,bl=protos.gov.toc.Gov_GetLiLianRewardBack_21009_toc,wl=protos.gov.toc.Gov_PromotionBack_21013_toc,xl=protos.gov.tos.Gov_RequestGetGuanYin_21010_tos,Sl=protos.gov.tos.Gov_RequestGetTodayLiLianReward_21008_tos,kl=protos.gov.tos.Gov_RequestPromotion_21012_tos,El=protos.gov.toc.Gov_UpdateMission_21007_toc,Tl=protos.gov.toc.Gov_back_lettoryTime_21714_toc,Cl=utils.GraphicUtil,Ll=(laya.display.Graphics,layouts.bag.GridOpenViewUI),Ml=modules.scene.others.jqr.GuanQiaJQRConfig,Al=modules.scene.others.jqr.GuanQiaJQRVO,Dl=protos.db.GuanQiaScene,Ol=(modules.gui.others.GuiEvent,modules.gui.order.Gui_order,layouts.guide.GuideAwardItemUI,layouts.guide.GuideAwardVUI),Pl=layouts.guide.GuideIconUI,Rl=modules.guide.others.GuideManager,Nl=(modules.guide.order.Guide_order,protos.db.GuildBossRankRewarRes),Bl=modules.guild.others.GuildConst,Hl=(protos.db.GuildCreateResource,modules.guild.order.Guild_InternalOrder,protos.guild.Guild_recordInout_12983_toc),Vl=protos.guild.Guild_recordPosChange_12984_toc,Gl=laya.ui.HSlider,Ul=ui.controls.HTMLClipElement,Fl=laya.html.dom.HTMLDivElement,ql=laya.utils.Handler,jl=zwc.utils.Hash,Wl=protos.db.HeFuDiggerExhibition,Yl=layouts.actor.heji.HeJiAttrItemLayoutUI,zl=modules.actor.others.HeJiInfo,Xl=ui.controls.HtmlDiv,Ql=utils.HtmlUtils,Jl=utils.HttpActionUtil,Zl=(modules.copy.order.Hundun_Order,global.IconTexture),Kl=laya.ui.Image,$l=zwc.engine.core.displays.world.parts.ImageTextureData,ec=layouts.skill.InnerActivedShowViewUI,tc=layouts.skill.InnerAttrPillViewUI,ic=modules.skill.others.InnerAttrPillVo,nc=modules.skill.others.InnerReqUtil,sc=protos.db.InnerUpgrade,oc=layouts.skill.InnerViewUI,ac=(modules.skill.order.Inner_InternalOrder,modules.skill.order.Inner_ServerOrder,utils.InputUtils),rc=global.JXRConst,lc=(modules.jianbao.others.JianbaoOrder,layouts.jianbao.JianbaoPanelUI),cc=layouts.jianbao.JianbaoViewUI,uc=(modules.jianbao.order.Jianbao__ServiceOrder,laya.debug.tools.JsonTool,modules.activity.JxrManager),dc=(modules.jzgod.order.JzGod_InternalOrder,laya.events.Keyboard,layouts.limitchallenge.godEquip.LCGEItemUI),hc=modules.limitChallenge.others.LCGodEquipTaskVo,_c=layouts.limitchallenge.godEquip.LCGodEquipUI,fc=(modules.limitChallenge.order.LC_InternalOrder,laya.ui.Label),pc=layouts.gui.LayoutPanelUI,gc=protos.db.LegendDiggerExhibition,vc=layouts.limitchallenge.LimitChallengeOpenViewUI,mc=laya.ui.List,yc=laya.net.Loader,Ic=layouts.login.LoadingViewUI,bc=laya.net.LocalStorage,wc=layouts.task.LockSceenHollowUI,xc=utils.LogUtil,Sc=layouts.login.LoginBaseUI,kc=layouts.login.LoginConcealUI,Ec=layouts.login.LoginNoticeUI,Tc=layouts.login.LoginViewUI,Cc=(modules.login.order.Login_IntOrder,modules.login.order.Login_SerOrder,layouts.actor.longwen.LongWenChangeItemUI),Lc=layouts.actor.longwen.LongWenChangeViewUI,Mc=modules.actor.others.enum.LongWenConst,Ac=layouts.actor.longwen.LongWenFenJieItemUI,Dc=layouts.actor.longwen.LongWenFenJieViewUI,Oc=layouts.actor.longwen.LongWenGetItemUI,Pc=layouts.actor.longwen.LongWenGridUI,Rc=layouts.actor.longwen.LongWenMainViewUI,Nc=layouts.actor.longwen.LongWenTipsUI,Bc=layouts.actor.longwen.LongWenZongLanViewUI,Hc=layouts.actor.longwen.LongwenAttrTipsUIUI,Vc=layouts.actor.longwen.LongwenViewTipsUI,Gc=(protos.activity.LotteryRecordVO,protos.activity.Lottery_back_LotteryTime_toc31033),Uc=protos.activity.Lottery_back_MyAllRecord_toc_31032,Fc=protos.activity.Lottery_back_MyRecord_toc_31031,qc=protos.activity.Lottery_request_Lottery_tos_31029,jc=protos.activity.Lottery_request_buyLotteryTime_tos_31030,Wc=layouts.actor.lunhui.LunhuiAttrDetailTipUI,Yc=layouts.actor.lunhui.LunhuiAttrItemUI,zc=layouts.actor.lunhui.LunhuiRemindTipUI,Xc=(layouts.actor.lunhui.LunhuiZhuhunItemUI,layouts.actor.lunhui.LunhuiZhuhunMaterialTipUI),Qc=layouts.actor.lunhui.LunhuiZhuhunTipUI,Jc=layouts.actor.lunhui.LunhuiZhuhunViewUI,Zc=(modules.actor.order.LunhuiZhuhun_ServerOrder,ui.text.render.MAtlasManager),Kc=ui.text.render.MAtlaser,$c=ui.MConfigViewMng,eu=utils.MHashMap,tu=utils.pool.MObjectPool,iu=ui.layerrender.MRenderUtil,nu=ui.text.MTextField,su=protos.db.MagicLimitTaskResource,ou=modules.magic.order.Magic_InternalOrder,au=(modules.magic.order.Magic_ServerOrder,layouts.mail.MailContentNoGiftUI),ru=layouts.mail.MailContentWithGiftUI,lu=modules.mail.others.MailDataModel,cu=layouts.mail.MailItemRenderUI,uu=layouts.mail.MailVBUI,du=(protos.mail.MailVo,modules.mail.order.Mail_InternalOrder,modules.mail.order.Mail_ServerOrder,layouts.mall.MallAchieveItemUI),hu=layouts.mall.MallAchieveUI,_u=layouts.mall.MallBuyPanelLayoutUI,fu=modules.mall.others.MallConst,pu=layouts.mall.MallItemBaseUI,gu=layouts.mall.MallQuickBuyUI,vu=layouts.mall.MallViewLayoutUI,mu=(modules.mall.order.Mall_InternalOrder,protos.mall.Mall_MallItem_vo,modules.mall.order.Mall_ServerOrder,layouts.map.MapPanelUI),yu=layouts.map.MapPointUI,Iu=protos.map.Map_Back_BossInfo_25018_toc,bu=(modules.map.order.Map_ServerOrder,laya.maths.Matrix),wu=(modules.achievenew.others.medal.MedalConst,modules.achievenew.others.medal.MedalDataModel),xu=layouts.achievenew.medal.MedalMianLayoutUI,Su=layouts.achievenew.medal.MedalTaskLayoutUI,ku=(modules.achievenew.others.medal.MedalTaskVo,protos.medal.toc.Medal_backInfo_30202_toc),Eu=protos.medal.tos.Medal_requestUpgradeMedal_30203_tos,Tu=(modules.copy.others.MentalData,layouts.pig.mental.MentalMoppingTipUI,layouts.pig.mental.MentalSceneUI,layouts.pig.mental.MentalSummonVUI,zwc.engine.core.controls.dock.Message),Cu=layouts.skill.MijiComposeViewUI,Lu=layouts.skill.MijiGetwayItemUI,Mu=layouts.skill.MijiInfoRenderUI,Au=layouts.skill.MijiLaoyinViewUI,Du=layouts.skill.MijiLearnViewUI,Ou=layouts.skill.MijiMainViewUI,Pu=layouts.skill.MijiShowViewUI,Ru=protos.skill.Miji_returnUpgrade_21413_toc,Nu=(laya.wx.mini.MiniAdpter,laya.wx.mini.MiniFileMgr),Bu=protos.db.MissionKillResource,Hu=protos.db.MissionTransfers,Vu=layouts.actor.mo.MoBreakViewUI,Gu=layouts.actor.mo.MoEquipComVUI,Uu=layouts.actor.mo.MoEquipComposeItemUI,Fu=(layouts.actor.mo.MoEquipComposeListItemUI,layouts.actor.mo.MoEquipGridUI,layouts.actor.mo.MoEquipMainComVUI),qu=layouts.actor.mo.MoEquipSelectorItemUI,ju=layouts.actor.mo.MoEquipSelectorUI,Wu=(layouts.actor.mo.MoEquipSuitItemUI,layouts.actor.mo.MoEquipSuitViewUI),Yu=layouts.actor.mo.MoEquipVUI,zu=layouts.actor.mo.MoEquipZhuhunUI,Xu=(modules.actor.order.MoEquip_InternalOrder,layouts.molimit.MoLimitMissionLayoutUI),Qu=layouts.molimit.MoLimitMissionOpenLayoutUI,Ju=layouts.molimit.MoLimitMissionRanderLayoutUI,Zu=(modules.moLimitMission.order.MoLimitMission_ActorOrder,modules.moLimitMission.order.MoLimitMission_ServerOrder,protos.molimit.MoLimit_Back_FirstOpen_toc_23730),Ku=protos.molimit.MoLimit_Request_CommitTask_tos_23729,$u=protos.molimit.MoLimit_Request_GroupReward_tos_23726,ed=protos.molimit.MoLimit_Request_TaskInfo_tos_23728,td=protos.molimit.MoLitmit_Request_Pop_tos_23735,id=protos.db.MoSubLMResource,nd=layouts.actor.mo.MoZhuHunAttrItemUI,sd=zwc.engine.core.controls.dock.Module,od=zwc.engine.core.controls.dock.ModuleDock,ad=(modules.scene.others.fight.MonsterConst,modules.yueka.order.MonthCardOrder,modules.yueka.others.MonthCardUtil),rd=layouts.yueka.MonthCardViewUI,ld=modules.yueka.others.MonthDataCenter,cd=protos.db.MoreReceiveResource,ud=utils.MoveDisplay,dd=(zwc.engine.core.controls.dock.MsgConst,layouts.broad.NPCTalkViewUI),hd=layouts.nav.NavActLUI,_d=layouts.nav.NavActRUI,fd=layouts.nav.NavAttackListItemUI,pd=layouts.nav.NavAttackListUI,gd=layouts.nav.NavAttackOtherUI,vd=layouts.nav.NavAutoWayUI,md=layouts.nav.NavBlockUI,yd=layouts.nav.NavBossAncientUI,Id=layouts.nav.NavBossUI,bd=layouts.nav.NavBottomVBUI,wd=layouts.nav.NavCallFriendUI,xd=layouts.nav.NavCheckPointUI,Sd=layouts.nav.NavDailyEnterUI,kd=layouts.nav.NavExitUI,Ed=layouts.nav.NavFairylandUI,Td=layouts.nav.NavFightingTargetUI,Cd=layouts.nav.NavFirstPayTimeUI,Ld=layouts.nav.NavHejiMissionUI,Md=layouts.nav.NavHejiUI,Ad=layouts.magic.NavHelpFriendUI,Dd=layouts.nav.NavHotupdateUI,Od=layouts.nav.NavInCallBossUI,Pd=layouts.nav.NavLimitZhuiJiUI,Rd=layouts.nav.NavLuckyDropUI,Nd=layouts.nav.NavMapUI,Bd=layouts.nav.NavMaterialUI,Hd=layouts.nav.NavMineUI,Vd=layouts.nav.NavMiniMapUI,Gd=layouts.nav.NavMissionUI,Ud=layouts.nav.NavOtherBarUI,Fd=layouts.pet.NavPetBirthUI,qd=layouts.nav.NavPreviewAwardUI,jd=layouts.nav.NavSceneFocusUI,Wd=layouts.nav.NavTopBarVBUI,Yd=layouts.nav.NavWorldBossUI,zd=layouts.nav.NavZhuiJiUI,Xd=(modules.nav.order.Nav_InternalOrder,modules.nav.order.Nav_Order,modules.newDailyAct.order.NewDailyActOrders,modules.newsiege.order.NewSiege_InternalOrder,modules.newsiege.order.NewSiege_ServiceOrder,layouts.newsiege.scene.NewSsAwardVUI),Qd=layouts.newsiege.scene.NewSsCaiJiInfoUI,Jd=layouts.newsiege.scene.NewSsGuiShuVUI,Zd=layouts.newsiege.gc.NewSsGuildItemVUI,Kd=layouts.newsiege.scene.NewSsGuildPanelVUI,$d=layouts.newsiege.scene.NewSsHurtRankVUI,eh=layouts.newsiege.gc.NewSsMoveVUI,th=layouts.newsiege.scene.NewSsPersonPanelVUI,ih=layouts.newsiege.gc.NewSsPlayerInfoVUI,nh=layouts.newsiege.gc.NewSsResultVUI,sh=protos.newworldboss.NewWorldBoss_Back_GuiShu_30859_toc,oh=protos.newworldboss.NewWorldBoss_Back_Info_30857_toc,ah=protos.newworldboss.NewWorldBoss_Back_Kill_30861_toc,rh=protos.newworldboss.NewWorldBoss_Back_Relive_30862_toc,lh=(modules.corssbattle.order.NewWorldBoss_InternalOrder,protos.newworldboss.NewWorldBoss_Request_GuiShu_30858_tos,protos.newworldboss.NewWorldBoss_Request_Info_30856_tos,protos.newworldboss.NewWorldBoss_Request_Kill_30860_tos,modules.corssbattle.order.NewWorldBoss_ServiceOrder,modules.niepan.others.NiepanConst,layouts.niepan.NiepanDailyUI),ch=layouts.niepan.NiepanEffectUI,uh=layouts.chat.NiepanNpcTalkUI,dh=layouts.niepan.NiepanPointUI,hh=layouts.niepan.NiepanTaskUI,_h=layouts.niepan.NiepanWuxingViewUI,fh=(modules.niepan.order.Niepan_InternalOrder,modules.niepan.order.Niepan_ServiceOrder,layouts.niepan.NiepanchallengeViewUI),ph=laya.display.Node,gh=layouts.broad.NoticeItemUI,vh=modules.notice.view.NoticeView,mh=ui.NumImage,yh=laya.debug.tools.ObjectTools,Ih=layouts.offline.OfflineExpVUI,bh=layouts.offline.OfflinePanelLayoutUI,wh=(modules.offline.order.Offline_order,zwc.engine.core.protos.Order),xh=layouts.actor.other.OtherEquipVUI,Sh=layouts.actor.other.OtherGodEquipUI,kh=layouts.actor.other.OtherPsVUI,Eh=laya.ui.Panel,Th=(global.PanelConst,modules.gui.others.PanelVo),Ch=modules.gui.others.PanelWaitBase,Lh=(modules.passsuit.order.PassSuit_Order,layouts.activityDaily.pay0.Pay0ItemUI,layouts.activityDaily.pay0.Pay0PopupUI),Mh=layouts.activityDaily.pay0.Pay0ViewUI,Ah=(protos.db.PetAppendageResource,protos.db.PetAttrResource,layouts.pet.PetBaseViewUI,protos.db.PetColorUpgradeResource),Dh=(modules.pet.others.PetConst,protos.db.PetEatingResource,protos.db.PetEggResource),Oh=(layouts.pet.PetEggSelectItemUI,layouts.pet.PetEggSelectViewUI,protos.db.PetFootEffect),Ph=(layouts.pet.PetFutiViewUI,protos.db.PetGridNumResource,layouts.pet.PetHasBirthedTipUI,layouts.pet.PetJichengViewUI,protos.db.PetLeadModel,layouts.pet.PetListBarUI,protos.db.PetLvUpgradeResource,layouts.pet.PetOpenDownTipUI,layouts.pet.PetOpenTipUI,layouts.pet.PetPopUI,protos.db.PetResource),Rh=(protos.db.PetShopResource,layouts.pet.PetShopViewUI,layouts.pet.PetSkillTips1UI),Nh=layouts.pet.PetSkillTips2UI,Bh=protos.db.PetStarUpgradeResource,Hh=(layouts.pet.PetTipUI,layouts.pet.PetTunshiSelectItemUI,layouts.pet.PetTunshiSelectViewUI,layouts.pet.PetTunshiViewUI,layouts.pet.PetXilianViewUI,modules.pet.order.Pet_InternalOrder,modules.pet.order.Pet_ServiceOrder,layouts.pet.PetgetEggTipUI,modules.pet.others.Petvo),Vh=(layouts.pig.pigTwo.PigTwoAwardsItemUI,layouts.pig.pigTwo.PigTwoAwardsViewUI,layouts.pig.pigTwo.PigTwoBoxItemUI,layouts.pig.pigTwo.PigTwoChangeStrongViewUI,layouts.pig.pigTwo.PigTwoEnterViewUI,layouts.pig.pigTwo.PigTwoFightNoEnouphUI,layouts.pig.pigTwo.PigTwoMainViewUI,layouts.pig.pigTwo.PigTwoShowAwardsViewUI,layouts.pig.pigTwo.PigTwoShowExpViewUI,layouts.pig.pigTwo.PigTwoShowVipExpUI,layouts.pig.pigTwo.PigTwoSuccessUI,modules.copy.order.Pig_Order,protos.yzbqc.PlayerRankVo),Gh=layouts.task.PlayerUpgradeDirectionsUI,Uh=laya.maths.Point,Fh=laya.utils.Pool,qh=(utils.PreLoadUtils,layouts.achievenew.prestige.PrestigeMainUI),jh=layouts.achievenew.prestige.PrestigePreviewListItemUI,Wh=layouts.achievenew.prestige.PrestigePreviewUI,Yh=protos.prestige.Prestige_back_toc_30023,zh=protos.prestige.Prestige_back_tos_30021,Xh=protos.prestige.Prestige_info_toc_30024,Qh=protos.prestige.Prestige_info_tos_30022,Jh=protos.activity.PreviewModel,Zh=layouts.nav.previewaward.PreviewRingPanelUI,Kh=layouts.preview.PreviewViewUI,$h=(modules.preview.order.Preview_ServerOrder,zwc.engine.core.protos.Proto),e_=utils.ProtocolUtil,t_=layouts.activity.qq.QqDaTingItemLayoutUI,i_=layouts.activity.qq.QqDaTingLayoutUI,n_=(utils.easing.Quad,protos.db.QuestTargetResource),s_=(modules.broadcast.others.RainbowType,layouts.broad.RainbowViewUI),o_=(layouts.guild.raisekunmaster.RaiseKunMasterViewUI,layouts.guild.raisekunmaster.RaiseKunSkillGridUI,layouts.guild.raisekunmaster.RaiseKunSkillViewUI,modules.guild.others.RaiseKunVo,modules.rank.others.RankData),a_=layouts.rank.RankItemUI,r_=(modules.rank.others.RankType,layouts.rank.RankViewUI),l_=(modules.rank.order.Rank_InternalOrder,modules.rank.order.Rank_ServiceOrder,layouts.recharge.RechargeMVUI),c_=(layouts.recharge.RechargeSubItemUI,layouts.recharge.RechargeSubVUI),u_=(modules.recharge.order.Recharge_order,laya.maths.Rectangle),d_=modules.backpack.others.RecycleModel,h_=layouts.bag.RecycleViewUI,__=modules.nav.others.redpt.RedPtConst,f_=modules.nav.others.redpt.RedTargetVo,p_=(layouts.guild.store.RedpagTipUI,modules.relive.others.ReliveData),g_=layouts.relive.ReliveTipsViewUI,v_=(modules.relive.order.Relive_InternalOrder,modules.relive.order.Relive_ServerOrder,laya.renders.Render),m_=global.ReportUtils,y_=(global.ResConst,layouts.resonate.view.ResonateAttrDetailTipUI),I_=(layouts.resonate.view.ResonateEquipItemUI,layouts.resonate.view.ResonateSkillTipUI),b_=layouts.resonate.ResonateSubViewUI,w_=layouts.resonate.view.ResonateViewUI,x_=(modules.resonate.orders.Resonate_ServerOrder,laya.resource.Resource,laya.resource.ResourceManager),S_=layouts.actor.ringup.RingAttrItemUI,k_=modules.actor.others.RingDataModel,E_=layouts.bag.RingEquipTipUI,T_=layouts.actor.ringup.RingSkillAlertUI,C_=layouts.bag.RingTipUI,L_=layouts.actor.ringup.RingTypeItemUI,M_=layouts.actor.ringup.RingUpgradeViewUI,A_=(modules.actor.order.Ring_ServerOrder,protos.db.RoleLevelResource,modules.specialgodring.other.SGRConst),D_=(modules.specialgodring.order.SGR_InternarOrder,modules.specialgodring.order.SGR_ServerOrder,layouts.actor.wing.SWingBlessTipsUI),O_=layouts.actor.wing.SWingComposeVUI,P_=layouts.actor.wing.SWingEquipVUI,R_=layouts.actor.wing.SWingExchangeUI,N_=layouts.actor.wing.SWingMasterTipsUI,B_=layouts.actor.wing.SWingMasterV1UI,H_=layouts.actor.wing.SWingSkillNewTipUI,V_=layouts.actor.wing.SWingSkillTipsUI,G_=layouts.actor.wing.SWingSkillVUI,U_=layouts.actor.wing.SWingUpdateUI,F_=layouts.actor.wing.SWingzhishengViewUI,q_=protos.db.SamEquipCycle,j_=protos.db.SamEquipLimitLevel,W_=protos.db.SamEquipRefine,Y_=layouts.actor.samsaraequip.SamEquipRefineTipUI,z_=layouts.actor.samsaraequip.SamsaraEquipTipUI,X_=layouts.actor.samsaraequip.SamsaraEquipViewUI,Q_=protos.db.SceneChange,J_=(modules.scene.order.Scene_InternalOrder,modules.scene.order.Scene_ServiceOrder,laya.ui.ScrollBar,layouts.skill.SeaAirUI),Z_=layouts.skill.SeaAirzhishengViewUI,K_=layouts.login.ServerIdListUIUI,$_=layouts.login.ServerItemUI,ef=layouts.login.ServiceListUIUI,tf=layouts.seven.SevenBaseUI,nf=layouts.seven.SevenBoxBarUI,sf=layouts.seven.SevenBoxItemUI,of=(protos.db.ShaoZhuReward,protos.db.ShaoZhuSpecialReward,modules.siege.others.SiegeData),af=modules.siege.others.SiegeReqs,rf=(modules.siege.order.Siege_InternalOrder,modules.siege.order.Siege_ServiceOrder,layouts.welfare.SigninItemUI),lf=layouts.mall.SimpleGetMaterialUI,cf=(modules.skill.others.SkillConst,layouts.skill.SkillItemRenderUI),uf=modules.skill.others.SkillReqUtils,df=layouts.skill.SkillViewBaseUI,hf=protos.skill.Skill_Back_Passive_toc_24043,_f=(modules.skill.order.Skill_InternalOrder,modules.skill.order.Skill_ServerOrder,layouts.skill.Skill_SubView_1UI),ff=utils.SkinUtil,pf=layouts.actor.soaring.other.SoaringEquipItemUI,gf=layouts.actor.soaring.other.SoaringEquipResolveItemUI,vf=layouts.actor.soaring.other.SoaringEquipResolveUI,mf=layouts.actor.soaring.other.SoaringEquipSubItemUI,yf=layouts.actor.soaring.other.SoaringEquipTip2UI,If=layouts.actor.soaring.SoaringEquipTipUI,bf=layouts.actor.soaring.other.SoaringEquipViewUI,wf=layouts.actor.soaring.interior.SoaringInteriorTipUI,xf=layouts.actor.soaring.SoaringLongWenTipUI,Sf=layouts.actor.soaring.other.SoaringPieceExchangeUI,kf=layouts.actor.soaring.other.SoaringPreviewUI,Ef=layouts.actor.soaring.SoaringSkillItemUI,Tf=layouts.actor.soaring.other.SoaringSkillViewUI,Cf=layouts.actor.soaring.SoaringSubViewUI,Lf=layouts.actor.soaring.other.SoaringSuitGrowViewUI,Mf=(layouts.actor.soaring.other.SoaringSuitItemUI,layouts.actor.soaring.other.SoaringSuitTip2UI),Af=layouts.actor.soaring.other.SoaringSuitViewUI,Df=layouts.actor.soaring.SoaringView2UI,Of=(zwc.engine.core.controls.dock.SocketConst,zwc.engine.core.protos.Socket_toc),Pf=zwc.engine.core.protos.Socket_tos,Rf=layouts.soul.SoulActivityLayoutUI,Nf=(modules.soul.others.SoulConst,layouts.soulout.SoulCopySuccessLayoutUI),Bf=layouts.soul.SoulElementLayoutUI,Hf=layouts.soul.SoulMainLayoutUI,Vf=(modules.soul.others.SoulPreviewConfigVo,modules.soul.others.SoulPreviewDataModel),Gf=layouts.soulout.soulskin.SoulSkillGridUI,Uf=layouts.soulout.soulskin.SoulSkinAttDetailUI,Ff=layouts.soulout.soulskin.SoulSkinItemUI,qf=layouts.soulout.soulskin.SoulSkinPropShowUI,jf=layouts.soulout.soulskin.SoulSkinSkillAlertUI,Wf=layouts.soulout.soulskin.SoulSkinViewUI,Yf=(modules.soul.order.Soul_InterServer,modules.soul.order.Soul_ServerOrder,protos.soul.toc.Soul_back_baseInfo_30392_toc),zf=protos.soul.tos.Soul_request_baseInfo_30391_tos,Xf=protos.soul.tos.Soul_request_upgradeElement_30390_tos,Qf=layouts.soulout.SouloutAdvanceViewUI,Jf=layouts.soulout.SouloutAttDetailUI,Zf=layouts.soulout.SouloutCopyRewardLayoutUI,Kf=layouts.soulout.SouloutCopyViewUI,$f=modules.soul.others.SouloutDataModel,ep=protos.soul.toc.SouloutSkill_24040_toc,tp=layouts.soulout.SouloutUpgradeViewUI,ip=(modules.soul.others.SouloutVo,protos.soul.tos.Soulout_reqSouloutInfo_31002_tos),np=protos.soul.tos.Soulout_reqUpgrade_31001_tos,sp=protos.soul.tos.Soulout_reqUplevel_31000_tos,op=protos.soul.tos.Soulout_request_over_31006_tos,ap=(laya.media.SoundChannel,laya.media.SoundManager),rp=layouts.specialgodring.SpecialGodRingActiveViewUI,lp=layouts.specialgodring.SpecialGodRingActivedShowViewUI,cp=layouts.specialgodring.SpecialGodRingAttrTipsUI,up=layouts.specialgodring.SpecialGodRingItemRightUI,dp=layouts.specialgodring.SpecialGodRingMainViewUI,hp=layouts.specialgodring.SpecialGodRingsuipianTipsUI,_p=protos.db.SpiritAdvanceResource,fp=protos.db.SpiritResource,pp=(modules.digger.order.Sports_InternalOrder,modules.digger.order.Sports_ServiceOrder,laya.display.Sprite),gp=(laya.display.Stage,laya.utils.Stat),vp=(protos.scene.StateType,protos.strength.StrengthVo,modules.strength.order.Strength_InternalOrder,modules.strength.order.Strength_ServiceOrder,laya.debug.tools.StringTool),mp=utils.StringUtils,yp=laya.ui.Styles,Ip=ui.SubPanel,bp=zwc.engine.core.controls.dock.SubProxy,wp=(layouts.strength.SubSpritUI,layouts.strength.SubStoneUI,layouts.strength.SubStrengthUI,protos.db.SuitResource),xp=layouts.actor.wing.SwingActiveViewUI,Sp=layouts.actor.wing.SwingZSQuickbuyViewUI,kp=(laya.ui.Tab,modules.skill.others.TalentInfoVo),Ep=layouts.skill.talent.TalentLearnOkPanelUI,Tp=layouts.skill.talent.TalentLearnPanelUI,Cp=modules.skill.others.TalentMapVo,Lp=layouts.skill.talent.TalentResetPanelUI,Mp=layouts.skill.talent.TalentSkillItemUI,Ap=layouts.skill.talent.TalentSkillPanelUI,Dp=layouts.skill.talent.TalentSuitFenJieItemUI,Op=layouts.skill.talent.TalentSuitFenJiePanelUI,Pp=layouts.skill.talent.TalentViewUI,Rp=modules.skill.others.TalentVo,Np=modules.task.others.TargetVo,Bp=modules.tasknew.others.TaskNewStatusConst,Hp=protos.tasknew.toc.TaskNew_backReward_23722_toc,Vp=protos.tasknew.toc.TaskNew_backTaskInfo_23720_toc,Gp=protos.tasknew.tos.TaskNew_requestReward_23721_tos,Up=(modules.tasknew.others.vo.TaskRecordVo,modules.tasknew.others.TaskStatusConst),Fp=(protos.task.TaskTarVo,modules.tasknew.others.vo.TaskTargetVo,layouts.task.TaskTrackUI),qp=(modules.tasknew.others.TaskTypeConst,modules.tasknew.others.vo.TaskVo,modules.task.order.Task_InternalOrder,modules.tasknew.order.Task_New_InterOrder,modules.tasknew.order.Task_New_ServerOrder,modules.task.order.Task_ServerOrder,layouts.teamCopy.TeamCopyChallageVUI,layouts.teamCopy.TeamCopyFriendYaoQingVUI,modules.copy.others.TeamCopyGLVO),jp=(layouts.teamCopy.TeamCopyHeadVUI,layouts.teamCopy.TeamCopyHelpVUI,layouts.teamCopy.TeamCopyItemUI,layouts.teamCopy.TeamCopyMainVUI,layouts.teamCopy.TeamCopyOutVUI,layouts.teamCopy.TeamCopyResultVUI,layouts.teamCopy.TeamCopyRoomItemVUI,layouts.teamCopy.TeamCopySceneViewUI,layouts.teamCopy.TeamCopyStrategyItemUI,layouts.teamCopy.TeamCopyStrategyVUI,modules.copy.others.TeamCopyVO),Wp=(layouts.teamCopy.TeamCopyYaoQingItemUI,modules.copy.others.TeamCopyYaoQingVO),Yp=(layouts.teamCopy.TeamCopyYaoQingVUI,modules.copy.order.TeamCopy_Order,layouts.activity.tehui.TehuiGiftItemUI,laya.display.Text),zp=ui.text.TextField,Xp=laya.resource.Texture,Qp=ui.TextureSheet,Jp=(modules.tianguan.order.Tianguan_ServiceOrder,utils.TimeUtils),Zp=laya.utils.Timer,Kp=protos.db.TimesRewardResource,$p=ui.controls.TipButton,eg=layouts.title.TitleItemUI,tg=modules.title.others.TitleManager,ig=layouts.title.TitleShowVUI,ng=layouts.title.TitleTotalUI,sg=(modules.title.order.Title_order,protos.boss.worldboss.Toc_21250),og=protos.boss.worldboss.Toc_21252,ag=protos.boss.worldboss.Toc_21254,rg=protos.boss.worldboss.Toc_21255,lg=protos.boss.worldboss.Toc_21258,cg=protos.boss.worldboss.Toc_24050,ug=protos.boss.worldboss.Toc_24051,dg=protos.boss.worldboss.Toc_24052,hg=(protos.boss.worldboss.Tos_21249,protos.boss.worldboss.Tos_21251,protos.boss.worldboss.Tos_21253,protos.boss.worldboss.Tos_21256,layouts.tower.TowerFightSuccessLayoutUI,layouts.tower.TowerLevelUpLayoutUI,layouts.tower.TowerLotteryLayoutUI,layouts.tower.TowerMainLayoutUI,layouts.tower.TowerRankDetailItemLayoutUI,layouts.tower.TowerRankLayoutUI,layouts.tower.TowerRankSimpleItemLayoutUI,layouts.tower.TowerRewardLayoutUI,modules.tqyueka.others.TqMonthCardDataCenter),_g=(modules.tqyueka.order.TqMonthCardOrder,modules.tqyueka.others.TqMonthCardUtil),fg=layouts.treasure.TrBigAwardViewUI,pg=layouts.treasure.TrChuanshiViewUI,gg=layouts.treasure.TrHuntViewUI,vg=layouts.treasure.TrLongwenViewUI,mg=protos.db.TrMysticalExhibition,yg=layouts.treasure.TrMysticalItemUI,Ig=layouts.treasure.TrMysticalViewUI,bg=layouts.treasure.TrResultUI,wg=layouts.treasure.TrStoreViewUI,xg=(modules.treasure.others.TreasureConst,modules.treasure.others.TreasureExchangeVo),Sg=layouts.treasure.TreasureLWexchangeViewUI,kg=layouts.treasure.TreasureLWitemViewUI,Eg=modules.treasure.others.TreasureReqs,Tg=(modules.treasure.order.Treasure_InternalOrder,modules.treasure.order.Treasure_ServiceOrder,protos.treasure.Treasure_resultRecord_30326_toc),Cg=protos.treasure.Treasure_resultTreasure_30322_toc,Lg=protos.treasure.Treasure_resultgetGoods_30324_toc,Mg=protos.treasure.Treasure_returnInfo_30328_toc,Ag=layouts.treasure.TrquickBuyViewUI,Dg=layouts.treasure.TrwardTipUI,Og=laya.utils.Tween,Pg=(utils.UIUtil,laya.ui.UIUtils),Rg=laya.net.URL,Ng=protos.db.Update,Bg=laya.utils.Utils,Hg=global.VersionUtils,Vg=laya.ui.View,Gg=ui.ViewBase,Ug=(laya.ui.ViewStack,layouts.vip.Vip3PrivilegeVUI),Fg=(layouts.vip.VipGiftItemUI,layouts.vip.VipGiftVUI),qg=(layouts.vip.VipInfoSubVUI,layouts.vip.VipInfoVUI),jg=layouts.vip.VipMVUI,Wg=modules.vip.others.VipManager,Yg=(modules.vip.order.VipOrder,protos.db.VipTeHuiReSource),zg=protos.db.VipTehuiNumResource,Xg=laya.utils.WeakObject,Qg=layouts.weaponsoul.WeaponMainPanelUI,Jg=layouts.weaponsoul.WeaponSoulCoreUI,Zg=layouts.weaponsoul.WeaponSoulDetailUI,Kg=layouts.weaponsoul.WeaponSoulItemUI,$g=layouts.weaponsoul.WeaponSoulLvUpVUI,ev=(modules.weaponsoul.order.WeaponSoulOrder,modules.weaponsoul.other.WeaponSoulReq),tv=layouts.weaponsoul.WeaponSoulTip1UI,iv=layouts.weaponsoul.WeaponSoulTipUI,nv=laya.webgl.WebGL,sv=layouts.welfare.WelfareBaseUI,ov=layouts.welfare.WelfareRedPacketIconUI,av=layouts.welfare.WelfareRedPacketPopupUI,rv=layouts.welfare.WelfareRedPacketUI,lv=modules.welfare.others.WelfareReqs,cv=(modules.welfare.order.Welfare_InternalOrder,modules.welfare.order.Welfare_ServiceOrder,layouts.task.WellcomeBaseUI),uv=layouts.welfare.WfActiveUI,dv=layouts.welfare.WfSigninUI,hv=protos.db.XinfaBookModel,_v=layouts.xinfa.XinfaCJDisposeUI,fv=layouts.xinfa.XinfaCJUpUI,pv=protos.db.XinfaModel,gv=(modules.xinfa.order.XinfaOrder,layouts.xinfa.XinfaPropShowUI),vv=modules.xinfa.view.XinfaRulesShowPanel,mv=layouts.xinfa.XinfaShowViewUI,yv=protos.db.XinfaSkillModel,Iv=layouts.xinfa.XinfaSkillShowUI,bv=layouts.actor.cimelia.YuPeiSkillTipsUI,wv=layouts.actor.cimelia.YuPeiViewUI,xv=protos.db.YuanGodActive,Sv=layouts.yunying.YunyingAccountVUI,kv=layouts.yunying.YunyingCareVUI,Ev=layouts.yunying.YunyingMicroVUI,Tv=layouts.yunying.YunyingSaveVUI,Cv=layouts.yunying.YunyingShareVUI,Lv=layouts.yunying.YunyingVerifyVUI,Mv=layouts.yzbqc.YzbcAwardsItemUI,Av=layouts.yzbqc.YzbqcMainVUI,Dv=layouts.yzbqc.YzbqcNewEnterVUI,Ov=layouts.yzbqc.YzbqcNewResultVUI,Pv=layouts.yzbqc.YzbqcNewRewardRankVUI,Rv=(modules.yzbqc.order.YzbqcOrder,modules.yzbqc.view.itemrender.YzbqcPRItem),Nv=(layouts.yzbqc.YzbqcPRItemVUI,layouts.yzbqc.YzbqcPlayerRankVUI),Bv=layouts.yzbqc.YzbqcRRItemVUI,Hv=modules.yzbqc.other.YzbqcReq,Vv=layouts.yzbqc.YzbqcTipsPanelUI,Gv=protos.scene.ZB_Act,Uv=layouts.actor.soaring.ZhuiJiAutoSettinglayoutUI,Fv=layouts.actor.soaring.other.ZhuijiSkillTipsUI,qv=layouts.actor.zs.ZsAttrItemUI,jv=layouts.actor.zs.ZsPreviewTipUI,Wv=(modules.zzt.order.ZztOrder,layouts.digger.active._AE_Bubble_ProfitUI),Yv=layouts.digger.active._AE_Bubble_RankItemUI,zv=layouts.digger.active._AE_Bubble_RankUI,Xv=layouts.digger.active._AE_Bubble_RuleUI,Qv=layouts.digger.active._AE_Bubble_SceneItemUI,Jv=layouts.digger.active._AE_Bubble_SceneUI,Zv=layouts.digger.active._ActivityEntranceItemUI,Kv=layouts.digger.active._ActivityEntranceUI,$v=layouts.common._AlertUI,em=(layouts.arena._ArenaRankItemUI,layouts.arena._ArenaSeasonItemUI,layouts.boss.scene._AttackTargetHeadUI),tm=layouts.bag._BlankWinTipUI,im=(layouts.guild.domain.scene._BossKun_CallVUI,layouts.bossancient._Boss_AncientItemViewUI),nm=layouts.bossancient._Boss_AncientMainViewUI,sm=layouts.bossancient._Boss_AncientRankSceneUI,om=layouts.bossancient._Boss_AncientRefreshUI,am=layouts.bossancient._Boss_AncientViewUI,rm=(layouts.boss.scene._Boss_CheckPointSceneUI,layouts.boss.scene._Boss_GWshengyuViewUI,layouts.boss._Boss_GodAttentionItemUI,layouts.boss._Boss_GodAttentionUI,layouts.boss._Boss_GodItemViewUI,layouts.boss._Boss_GodRefreshUI,layouts.boss._Boss_GodViewUI,layouts.boss.scene._Boss_GodWeaponFairyLandSceneUI,layouts.guild.domain.scene._Boss_KunSceneUI,layouts.boss._Boss_MainViewUI,layouts.boss._Boss_MijingAlertItemUI,layouts.boss._Boss_MijingAlertViewUI,layouts.boss.scene._Boss_MijingAttackViewUI,layouts.boss.scene._Boss_MijingResultViewUI,layouts.boss.scene._Boss_PersonBossSceneUI,layouts.boss._Boss_PersonItemViewUI,layouts.boss._Boss_PersonViewUI,layouts.boss._Boss_RefreshNoteUI,layouts.boss._Boss_WildItemViewUI,layouts.boss.scene._Boss_WildKillViewUI,layouts.boss.scene._Boss_WildSceneAwardViewUI,layouts.boss.scene._Boss_WildSceneUI,layouts.boss._Boss_WildViewUI,layouts.boss.worldBoss._Boss_WorldBossItemUI,layouts.boss.worldBoss._Boss_WorldBossMainViewUI,layouts.boss.worldBoss._Boss_WorldBossRankItem2UI,layouts.boss.worldBoss._Boss_WorldBossRankItemUI,layouts.boss.worldBoss._Boss_WorldBossRankViewUI,layouts.boss.worldBoss._Boss_WorldBossResultUI,layouts.boss.scene._Boss_WorldBossSceneRankItemUI,layouts.boss.scene._Boss_WorldBossSceneUI,layouts.boss.worldBoss._Boss_WorldBossViewUI,layouts.boss.worldBoss._Boss_WorldBossYaoQingViewUI,layouts.boss.worldBoss._Boss_WorldBossZhuWeiViewUI,layouts.boss.scene._Boss_WorldSceneJieSuanViewUI,layouts.boss.scene._Boss_sczbAwardViewUI,layouts.activity.os._Celebration_ItemUI),lm=layouts.activity.os._Celebration_ViewUI,cm=layouts.boss.scene._Char_HeadViewUI,um=layouts.bag._EquipTipUI,dm=layouts.activity.festivalboss._FestivalBossMainViewUI,hm=layouts.activity.festivalboss._FestivalBossRankAwardVUI,_m=layouts.activity.festivalboss._FestivalBossRankViewUI,fm=layouts.activity.festivalboss._FestivalBossViewUI,pm=layouts.activity.festivalboss._FestivalBossZhuWeiViewUI,gm=(layouts.field._FieldRankItemUI,layouts.field._FieldRankVUI),vm=layouts.fight._Fight_FialItemUI,mm=layouts.fight._Fight_FialUI,ym=layouts.fight._Fight_ReliveUI,Im=(layouts.fight._Fight_SettleUI,layouts.hllx._FireDragonMainViewUI,layouts.hllx._FireDragonRankAwardItemUI,layouts.hllx._FireDragonRankAwardVUI,layouts.hllx._FireDragonRankViewUI,layouts.hllx._FireDragonViewUI,layouts.hllx._FireDragonZhuWeiViewUI,layouts.activityDaily._FocusQRCodeUI),bm=layouts.common._GK_TitleUI,wm=(layouts.guild.base._GcGuildAwardsItemUI,layouts.guild.base._GcGuildRankItemUI,layouts.guild.base._GcPersonAwardsItemUI,layouts.bag._GoodsTipUI),xm=(layouts.guild.manage._GuildApplyMngItemViewUI,layouts.guild.manage._GuildApplyMngViewUI,layouts.guild.base._GuildBase_ViewUI,layouts.guild.boss._GuildBoss_BaseUI,layouts.guild.boss._GuildBoss_BossItemUI,layouts.guild.boss._GuildBoss_CountDownUI,layouts.guild.boss._GuildBoss_InfoItemUI,layouts.guild.boss._GuildBoss_InfoUI,layouts.guild.boss._GuildBoss_RankItemUI,layouts.guild.boss._GuildBoss_RankUI,layouts.guild.boss._GuildBoss_SceneUI,layouts.guild.boss._GuildBoss_SettleUI,layouts.guild.manage._GuildCreateViewUI,layouts.guild.siege._GuildGc_NewSiegeVUI,layouts.guild.base._GuildGuilditem_ViewUI,layouts.guild.base._GuildGuildlist_ViewUI,layouts.guild.domain._GuildKunFeedVUI,layouts.guild.domain._GuildKunOpenVUI,layouts.guild.domain._GuildKunRankVUI,layouts.guild.domain._GuildKunRewardVUI,layouts.guild.domain._GuildKun_BaseVUI,layouts.guild.domain._GuildKun_FightViewUI,layouts.guild.domain._GuildKun_ViewUI,layouts.guild.domain._GuildKun_titleUI,layouts.guild.base._GuildManage_LogItemUI,layouts.guild.base._GuildManage_ViewUI,layouts.guild.manage._GuildMng_BaseItemViewUI,layouts.guild.manage._GuildMng_FuncItemViewUI,layouts.guild.manage._GuildMng_FuncViewUI,layouts.guild.manage._GuildMng_ListItemViewUI,layouts.guild.manage._GuildMng_ListViewUI,layouts.guild.manage._GuildModifyNoteViewUI,layouts.guild.base._GuildPlayeritem_ViewUI,layouts.guild.base._GuildPlyerlist_ViewUI,layouts.guild.skill._GuildSkill_BaseViewUI),Sm=(layouts.guild.skill._GuildSkill_cangbaoViewUI,layouts.guild.store._GuildStore_ContribViewUI,layouts.guild.store._GuildStore_RecordItemViewUI,layouts.guild.store._GuildStore_RecordViewUI,layouts.guild.store._GuildStore_RedResultViewUI,layouts.guild.store._GuildStore_RedViewUI,layouts.guild.shop._Guild_ShopItemUI,layouts.guild.shop._Guild_ShopViewUI,layouts.activityDaily._In_EggItemUI),km=layouts.activityDaily._In_EggUI,Em=layouts.activity.invite._In_LoginTipUI,Tm=layouts.activity.invite._In_LoginUI,Cm=layouts.activity.invite._In_LotteryUI,Lm=layouts.activity.invite._In_SaleAwardUI,Mm=layouts.activity.invite._In_SaleItemUI,Am=layouts.activity.invite._In_SaleLogUI,Dm=layouts.activity.invite._In_SaleUI,Om=layouts.activityDaily._LimitSurpriseUI,Pm=layouts.magic._MagicTowerAwardItemUI,Rm=layouts.magic._MagicTowerBaseUI,Nm=layouts.magic._MagicTowerRankItemUI,Bm=layouts.magic._MagicTowerRankUI,Hm=layouts.magic._MagicTowerSceneUI,Vm=layouts.magic._MagicTowerSettleUI,Gm=layouts.magic._MagicTowerUnlockSucUI,Um=layouts.magic._Magic_AttentionItemUI,Fm=layouts.magic._Magic_AttentionUI,qm=layouts.magic._Magic_BaokuViewUI,jm=layouts.magic._Magic_JindiItemUI,Wm=layouts.magic._Magic_JindiViewUI,Ym=layouts.mall._MallMysteryViewBaseUI,zm=layouts.mall._MallNormalViewBaseUI,Xm=layouts.actor.mo._MoEquipAdvancedUI,Qm=layouts.actor.mo._MoEquipSkillTipsUI,Jm=layouts.actor.mo._MoEquipSuitTipUI,Zm=layouts.actor.mo._MoEquipToolTipUI,Km=layouts.activity.os._OS_BossScoreExchangeItemUI,$m=layouts.activity.os._OS_BossScoreExchangeUI,ey=layouts.activity.os._OS_BossScoreUI,ty=layouts.activity.os._OS_DailyPayItemUI,iy=layouts.activity.os._OS_DailyPayUI,ny=layouts.activity.os._OS_DayReturnItemUI,sy=layouts.activity.os._OS_DayReturnUI,oy=layouts.activity.os._OS_GiftsItemUI,ay=layouts.activity.os._OS_GiftsUI,ry=layouts.activity.os._OS_GoalItemUI,ly=layouts.activity.os._OS_GoalUI,cy=layouts.activity.os._OS_LimitBuyItemUI,uy=layouts.activity.os._OS_LimitBuyUI,dy=layouts.activity.os._OS_PurchaseItemUI,hy=layouts.activity.os._OS_PurchaseUI,_y=layouts.activity.os._OS_RankItemUI,fy=layouts.activity.os._OS_RankMainUI,py=layouts.activity.os._OS_RankNewItemUI,gy=layouts.activity.os._OS_RankUI,vy=layouts.activity.os._OS_RechargeReturnUI,my=layouts.activity.os._OS_RechargeTotalUI,yy=layouts.activity.os._OS_SevenKHItemUI,Iy=layouts.activity.os._OS_SevenKHPreviewItemUI,by=layouts.activity.os._OS_SevenKHPreviewUI,wy=layouts.activity.os._OS_SevenKHUI,xy=layouts.activity.os._OS_SevenRechargeUI,Sy=layouts.activity.os._OS_ShaChengPKUI,ky=layouts.activity.os._OS_SoulEnterUI,Ey=layouts.activity.os._OS_SoulUI,Ty=layouts.activity.os._OS_UniversalBossItemUI,Cy=layouts.activity.os._OS_UniversalBossUI,Ly=layouts.activityDaily._OneYuanGiftVUI,My=layouts.passsuit._PassEquipToolTipUI,Ay=layouts.activity.returns._Re_InvestUI,Dy=layouts.activity.returns._Re_LoginItem2UI,Oy=layouts.activity.returns._Re_LoginItemUI,Py=layouts.activity.returns._Re_LoginUI,Ry=layouts.activity.returns._Re_TaskItemUI,Ny=layouts.activity.returns._Re_TaskUI,By=layouts.login._RoleCreateBaseUI,Hy=layouts.activityDaily._SmallActivityViewUI,Vy=layouts.activity.spring._Sp_BargainGuildItemUI,Gy=layouts.activity.spring._Sp_BargainGuildUI,Uy=layouts.activity.spring._Sp_BargainItemUI,Fy=layouts.activity.spring._Sp_BargainPromptUI,qy=layouts.activity.spring._Sp_BargainUI,jy=layouts.activity.spring._Sp_BossUI,Wy=layouts.activity.spring._Sp_CoupletItemUI,Yy=layouts.activity.spring._Sp_CoupletUI,zy=layouts.activity.spring._Sp_CrackerItemUI,Xy=layouts.activity.spring._Sp_CrackerUI,Qy=layouts.activity.spring._Sp_Firework_RecordViewUI,Jy=layouts.activity.spring._Sp_FireworksPreviewUI,Zy=layouts.activity.spring._Sp_FireworksPromptUI,Ky=layouts.activity.spring._Sp_FireworksUI,$y=layouts.activity.spring._Sp_RechargeUI,eI=layouts.activity.spring._Sp_TreeBoxsUI,tI=layouts.activity.spring._Sp_TreeGoodsItemUI,iI=layouts.activity.spring._Sp_TreePickAwardUI,nI=layouts.activity.spring._Sp_TreePickPreviewUI,sI=layouts.activity.spring._Sp_TreePickUI,oI=layouts.activity.spring._Sp_TreePlantUI,aI=layouts.activity.spring._Sp_TreeScoreItemUI,rI=layouts.activity.spring._Sp_TreeWholeItemUI,lI=layouts.activity.spring._Sp_WelfareItemUI,cI=layouts.activity.spring._Sp_WelfareUI,uI=layouts.activityDaily._SuperVipViewUI,dI=layouts.achievenew.tujian._Tujian_ActivedUI,hI=layouts.achievenew.tujian._Tujian_BaseUI,_I=layouts.achievenew.tujian._Tujian_CardItemUI,fI=layouts.achievenew.tujian._Tujian_DetailUI,pI=layouts.achievenew.tujian._Tujian_ResolveItemUI,gI=layouts.achievenew.tujian._Tujian_ResolveUI,vI=layouts.achievenew.tujian._Tujian_SuitItemUI,mI=layouts.achievenew.tujian._Tujian_SuitUI,yI=layouts.achievenew.tujian._Tujian_ToolTipUI,II=layouts.achievenew.tujian._Tujian_TypeItemUI,bI=layouts.activityDaily._WechatFirstShareViewUI,wI=layouts.activityDaily._WechatShareLVIPViewUI,xI=layouts.activityDaily._WechatShareLvItemUI,SI=layouts.activityDaily._WechatShareSubViewUI,kI=layouts.activityDaily._WechatShareViewUI,EI=layouts.broad._heraldViewUI,TI=(layouts.pig.hundunMonster._hundunMonsterEnterViewUI,layouts.activity.invest._investItemUI),CI=layouts.activity.invest._investMainViewUI,LI=(layouts.boss.jipinRecord._jipinItemViewUI,layouts.boss.jipinRecord._jipinRecordViewUI,layouts.passsuit._passSuitComposeViewUI),MI=layouts.passsuit._passSuitFenJieItemUI,AI=layouts.passsuit._passSuitFenJieViewUI,DI=layouts.passsuit._passSuitMainViewUI,OI=layouts.passsuit._passSuitSkillTipsUI,PI=layouts.passsuit._passSuitTipsUI,RI=layouts.bag._remindUseUI,NI=(layouts.auctionhouse.auctionGoodsTipUI,layouts.auctionhouse.auctionhouseItemViewUI,layouts.auctionhouse.auctionhouseMainViewUI,layouts.res.basicUIConst),BI=(layouts.auctionhouse.blackmacketViewUI,layouts.auctionhouse.cashExchangeItemViewUI,layouts.auctionhouse.cashExchangeViewUI,layouts.auctionhouse.myattentionViewUI,layouts.auctionhouse.myattontionItemUI,layouts.auctionhouse.myrecordItemUI,layouts.auctionhouse.myrecordMainViewUI,layouts.chat.otherInfoUI),HI=(layouts.auctionhouse.pirceRemindViewUI,protos.login.toc_10102),VI=protos.login.toc_10104,GI=protos.login.toc_10106,UI=protos.login.toc_10110,FI=protos.assist.toc_10112,qI=protos.login.toc_10114,jI=protos.login.toc_10117,WI=protos.login.toc_10118,YI=protos.activity.toc_10119,zI=protos.scene.toc_10122,XI=protos.actor.toc_10208,QI=protos.char.toc_10302,JI=protos.char.toc_10304,ZI=protos.scene.toc_10306,KI=protos.scene.toc_10309,$I=protos.char.toc_10310,eb=protos.char.toc_10311,tb=protos.char.toc_10312,ib=protos.char.toc_10313,nb=protos.char.toc_10314,sb=protos.backpack.toc_10403,ob=protos.backpack.toc_10408,ab=protos.backpack.toc_10415,rb=protos.backpack.toc_10416,lb=protos.backpack.toc_10417,cb=protos.skill.seaair.toc_10425,ub=protos.skill.toc_10501,db=protos.skill.toc_10502,hb=protos.skill.toc_10504,_b=protos.char.toc_10601,fb=protos.rank.toc_10702,pb=protos.field.toc_10802,gb=protos.field.toc_10807,vb=protos.field.toc_10808,mb=protos.mall.toc_10902,yb=protos.mall.toc_10905,Ib=protos.mall.toc_10907,bb=protos.mall.toc_10909,wb=protos.strength.toc_11003,xb=protos.strength.toc_11004,Sb=protos.treasure.toc_11106,kb=protos.treasure.toc_11107,Eb=protos.treasure.toc_11108,Tb=protos.mail.toc_11203,Cb=protos.mail.toc_11205,Lb=protos.mail.toc_11211,Mb=protos.mail.toc_11212,Ab=protos.god.toc_11305,Db=protos.god.toc_11308,Ob=protos.god.toc_11310,Pb=protos.god.toc_11312,Rb=protos.god.toc_11314,Nb=protos.achieve.toc_11406,Bb=protos.guide.toc_11502,Hb=protos.guide.toc_11504,Vb=protos.chat.toc_11803,Gb=protos.chat.toc_11805,Ub=protos.broadcast.toc_11806,Fb=protos.task.toc_11901,qb=protos.activity.toc_12001,jb=protos.activity.toc_12003,Wb=protos.activity.toc_12210,Yb=protos.evaluate.toc_12212,zb=protos.evaluate.toc_12214,Xb=protos.goldrotary.toc_12216,Qb=protos.goldrotary.toc_12218,Jb=protos.goldrotary.toc_12219,Zb=protos.goldrotary.toc_12220,Kb=protos.activity.toc_12222,$b=protos.activity.toc_12224,ew=protos.activity.toc_12226,tw=protos.activity.toc_12229,iw=protos.activityDaily.toc_12231,nw=protos.mall.toc_12234,sw=protos.activity.toc_12235,ow=protos.activity.toc_12237,aw=protos.activity.toc_12239,rw=(protos.mall.toc_12243,protos.activity.toc_12247),lw=protos.activity.toc_12248,cw=protos.guild.toc_12902,uw=protos.guild.toc_12904,dw=protos.guild.toc_12906,hw=protos.guild.toc_12910,_w=protos.guild.toc_12912,fw=protos.guild.toc_12914,pw=protos.guild.toc_12918,gw=protos.guild.toc_12921,vw=protos.guild.toc_12924,mw=protos.guild.toc_12930,yw=protos.guild.toc_12934,Iw=protos.guild.toc_12936,bw=protos.guild.toc_12938,ww=protos.guild.toc_12941,xw=protos.guild.toc_12943,Sw=protos.guild.toc_12945,kw=protos.guild.toc_12947,Ew=protos.guild.toc_12952,Tw=protos.guild.toc_12954,Cw=protos.guild.toc_12963,Lw=protos.guild.toc_12967,Mw=protos.guild.toc_12970,Aw=protos.guild.toc_12972,Dw=protos.guild.toc_12974,Ow=protos.guild.toc_12976,Pw=protos.guild.toc_12978,Rw=protos.guild.toc_12982,Nw=protos.siege.toc_12986,Bw=protos.guild.toc_12989,Hw=protos.guild.toc_12991,Vw=protos.guild.toc_12993,Gw=protos.guild.toc_12994,Uw=protos.guild.toc_12995,Fw=protos.offline.toc_13001,qw=protos.offline.toc_13002,jw=protos.offline.toc_13003,Ww=protos.offline.toc_13005,Yw=protos.offline.toc_13028,zw=protos.broadcast.toc_13301,Xw=protos.broadcast.toc_13303,Qw=protos.title.toc_13502,Jw=protos.title.toc_13504,Zw=protos.title.toc_13507,Kw=protos.login.toc_13602,$w=protos.vip.toc_14003,ex=protos.vip.toc_14006,tx=protos.vip.toc_14008,ix=protos.vip.toc_14009,nx=protos.vip.toc_14010,sx=protos.actor.toc_21115,ox=protos.actor.toc_21117,ax=protos.actor.toc_21120,rx=protos.copy.toc_21203,lx=protos.copy.toc_21205,cx=protos.copy.toc_21207,ux=protos.copy.toc_21214,dx=protos.copy.toc_21219,hx=protos.boss.toc_21220,_x=protos.boss.toc_21221,fx=protos.boss.toc_21225,px=protos.boss.toc_21227,gx=protos.scene.heji.toc_21230,vx=protos.bossancient.toc_21232,mx=protos.boss.toc_21236,yx=protos.magic.toc_21241,Ix=protos.magic.toc_21243,bx=protos.magic.toc_21245,xx=protos.magic.toc_21246,Sx=protos.magic.toc_21247,kx=protos.boss.toc_21259,Ex=protos.boss.toc_21261,Tx=protos.boss.toc_21263,Cx=protos.boss.toc_21264,Lx=protos.firedragon.toc_21268,Mx=protos.firedragon.toc_21269,Ax=protos.activity.toc_21271,Dx=protos.activity.toc_21272,Ox=protos.activity.toc_21273,Px=protos.pig.hundunmonster.toc_21276,Rx=protos.arena.toc_21302,Nx=protos.arena.toc_21305,Bx=protos.arena.toc_21308,Hx=protos.arena.toc_21311,Vx=protos.arena.toc_21313,Gx=protos.arena.toc_21315,Ux=protos.arena.toc_21316,Fx=protos.skill.toc_21408,qx=protos.zzt.toc_21505,jx=protos.welfare.toc_21602,Wx=protos.welfare.toc_21604,Yx=protos.tianguan.toc_21702,zx=protos.tianguan.toc_21707,Xx=protos.tianguan.toc_21709,Qx=protos.tianguan.toc_21712,Jx=protos.buff.toc_21902,Zx=protos.buff.toc_21904,Kx=protos.pig.two.toc_22016,$x=protos.boss.toc_22106,eS=protos.boss.toc_22151,tS=protos.boss.toc_22152,iS=protos.scene.toc_22153,nS=protos.scene.toc_22154,sS=protos.digger.toc_22202,oS=protos.digger.toc_22205,aS=protos.digger.toc_22210,rS=protos.digger.toc_22214,lS=protos.digger.toc_22217,cS=protos.digger.toc_22220,uS=protos.digger.toc_22221,dS=protos.digger.toc_22222,hS=protos.yueka.toc_22303,_S=protos.offline.toc_22305,fS=protos.tqyueka.toc_22352,pS=protos.tqyueka.toc_22357,gS=protos.yueka.toc_22363,vS=protos.expborn.toc_22402,mS=protos.expborn.toc_22404,yS=protos.weaponsoul.toc_22509,IS=protos.weaponsoul.toc_22511,bS=protos.scene.toc_22602,wS=protos.scene.toc_22604,xS=protos.scene.toc_22610,SS=protos.scene.toc_22612,kS=protos.scene.toc_22614,ES=protos.scene.toc_22616,TS=protos.char.toc_22617,CS=protos.scene.toc_22618,LS=protos.boss.toc_22620,MS=protos.boss.toc_22621,AS=protos.boss.toc_22622,DS=protos.boss.toc_22623,OS=protos.fashion.toc_22702,PS=protos.fashion.toc_22707,RS=protos.fashion.toc_22709,NS=protos.fashion.toc_22711,BS=protos.fashion.toc_22713,HS=protos.fashion.toc_22715,VS=protos.recharge.toc_23004,GS=protos.recharge.toc_23005,US=protos.recharge.toc_23006,FS=protos.recharge.toc_23008,qS=protos.recharge.toc_23009,jS=protos.yzbqc.toc_23103,WS=protos.yzbqc.toc_23112,YS=protos.yzbqc.toc_23114,zS=protos.yzbqc.toc_23117,XS=protos.yzbqc.toc_23118,QS=protos.yzbqc.toc_23120,JS=protos.yzbqc.toc_23121,ZS=protos.yzbqc.toc_23122,KS=protos.yzbqc.toc_23123,$S=protos.specialgodring.toc_23221,ek=protos.specialgodring.toc_23223,tk=protos.specialgodring.toc_23224,ik=protos.specialgodring.toc_23226,nk=protos.specialgodring.toc_23227,sk=protos.siege.toc_23302,ok=protos.siege.toc_23305,ak=protos.siege.toc_23306,rk=protos.siege.toc_23308,lk=protos.siege.toc_23309,ck=protos.siege.toc_23310,uk=protos.siege.toc_23311,dk=protos.siege.toc_23312,hk=protos.siege.toc_23313,_k=protos.siege.toc_23314,fk=protos.siege.toc_23315,pk=protos.siege.toc_23316,gk=protos.siege.toc_23317,vk=protos.siege.toc_23319,mk=protos.siege.toc_23320,yk=protos.siege.toc_23322,Ik=protos.siege.toc_23324,bk=protos.siege.toc_23325,wk=protos.siege.toc_23326,xk=protos.siege.toc_23327,Sk=protos.siege.toc_23329,kk=protos.siege.toc_23331,Ek=protos.siege.toc_23335,Tk=protos.siege.toc_23336,Ck=protos.siege.toc_23337,Lk=protos.siege.toc_23338,Mk=protos.siege.toc_23341,Ak=protos.guild.toc_23344,Dk=protos.digger.toc_23601,Ok=protos.yzbqc.toc_23602,Pk=protos.activity.toc_23622,Rk=protos.jzgod.toc_23701,Nk=protos.godweapon.toc_23703,Bk=protos.limitChallenge.toc_23724,Hk=protos.limitChallenge.toc_23725,Vk=protos.limitChallenge.toc_23731,Gk=protos.limitChallenge.toc_23732,Uk=protos.limitChallenge.toc_23733,Fk=protos.actor.toc_23750,qk=protos.actor.toc_23752,jk=protos.actor.toc_23754,Wk=protos.actor.toc_23756,Yk=protos.scene.heji.toc_24000,zk=protos.scene.heji.toc_24001,Xk=protos.scene.heji.toc_24002,Qk=protos.scene.heji.toc_24003,Jk=protos.scene.heji.toc_24004,Zk=protos.scene.heji.toc_24006,Kk=protos.scene.heji.toc_24007,$k=protos.scene.heji.toc_24013,eE=protos.scene.heji.toc_24014,tE=protos.scene.heji.toc_24016,iE=protos.scene.heji.toc_24017,nE=protos.scene.heji.toc_24018,sE=protos.scene.heji.toc_24019,oE=protos.scene.heji.toc_24020,aE=protos.scene.heji.toc_24021,rE=protos.scene.heji.toc_24022,lE=protos.scene.heji.toc_24026,cE=protos.scene.heji.toc_24030,uE=protos.scene.heji.toc_24031,dE=protos.scene.heji.toc_24033,hE=protos.crossBoss.toc_24034,_E=protos.skill.newSkill.toc_24035,fE=protos.skill.newSkill.toc_24037,pE=protos.scene.heji.toc_24038,gE=protos.siege.toc_24042,vE=protos.bossancient.toc_24044,mE=protos.scene.heji.toc_24045,yE=protos.boss.toc_24046,IE=protos.boss.toc_24047,bE=protos.boss.toc_24048,wE=protos.scene.toc_24049,xE=protos.scene.heji.toc_24053,SE=protos.scene.heji.toc_25000,kE=protos.actor.toc_25001,EE=protos.pig.two.toc_25003,TE=protos.firedragon.toc_25004,CE=protos.firedragon.toc_25005,LE=protos.copy.teamCopy.toc_25006,ME=protos.activity.toc_25007,AE=protos.activity.toc_25008,DE=protos.crossBoss.toc_25009,OE=protos.crossBoss.toc_25011,PE=protos.crossBoss.toc_25012,RE=protos.crossBoss.toc_25013,NE=protos.crossBoss.toc_25014,BE=protos.guild.toc_25017,HE=protos.pet.toc_25019,VE=protos.boss.toc_30007,GE=protos.actor.toc_30010,UE=protos.actor.toc_30011,FE=protos.actor.toc_30102,qE=protos.actor.toc_30104,jE=protos.actor.toc_30106,WE=protos.actor.toc_30121,YE=protos.actor.toc_30123,zE=protos.activityDaily.toc_30131,XE=protos.activityDaily.toc_30133,QE=protos.activityDaily.toc_30134,JE=protos.achieve.toc_30151,ZE=protos.achieve.toc_30153,KE=protos.achieve.toc_30155,$E=protos.xinfa.toc_30161,eT=protos.xinfa.toc_30163,tT=protos.xinfa.toc_30165,iT=protos.inner.toc_30252,nT=protos.inner.toc_30253,sT=protos.inner.toc_30255,oT=protos.inner.toc_30257,aT=protos.inner.toc_30259,rT=protos.digger.toc_30330,lT=protos.digger.toc_30331,cT=protos.digger.toc_30333,uT=protos.godweapon.toc_30340,dT=protos.godweapon.toc_30342,hT=protos.godweapon.toc_30343,_T=protos.godweapon.toc_30350,fT=protos.godweapon.toc_30352,pT=protos.godweapon.toc_30353,gT=protos.field.toc_30360,vT=protos.boss.toc_30370,mT=protos.boss.toc_30371,yT=protos.boss.toc_30372,IT=protos.boss.toc_30375,bT=protos.sdk.toc_30414,wT=protos.activity.toc_30418,xT=protos.ringclassic.toc_30452,ST=protos.changename.toc_30462,kT=protos.changename.toc_30465,ET=protos.actor.toc_30481,TT=protos.actor.toc_30483,CT=protos.welfare.toc_30491,LT=protos.welfare.toc_30493,MT=protos.welfare.toc_30495,AT=protos.welfare.toc_30496,DT=protos.magic.toc_30601,OT=protos.magic.toc_30602,PT=protos.actor.toc_30611,RT=protos.actor.toc_30613,NT=protos.actor.toc_30615,BT=protos.actor.toc_30617,HT=protos.actor.toc_30619,VT=protos.actor.toc_30623,GT=protos.actor.toc_30625,UT=protos.actor.toc_30627,FT=protos.auctionhouse.toc_30631,qT=protos.auctionhouse.toc_30633,jT=protos.auctionhouse.toc_30635,WT=protos.auctionhouse.toc_30636,YT=protos.auctionhouse.toc_30637,zT=protos.auctionhouse.toc_30638,XT=protos.auctionhouse.toc_30641,QT=protos.auctionhouse.toc_30643,JT=protos.auctionhouse.toc_30646,ZT=protos.auctionhouse.toc_30649,KT=protos.backpack.toc_30652,$T=protos.backpack.toc_30653,eC=protos.actor.toc_30662,tC=protos.actor.toc_30667,iC=protos.actor.toc_30668,nC=protos.lunhuizhuhun.toc_30672,sC=protos.copy.teamCopy.toc_30684,oC=protos.copy.teamCopy.toc_30686,aC=protos.copy.teamCopy.toc_30687,rC=protos.copy.teamCopy.toc_30702,lC=protos.copy.teamCopy.toc_30704,cC=protos.copy.teamCopy.toc_30705,uC=protos.copy.teamCopy.toc_30710,dC=protos.copy.teamCopy.toc_30712,hC=protos.backpack.toc_30721,_C=protos.backpack.toc_30722,fC=protos.activityDaily.toc_30726,pC=protos.crossBoss.toc_30744,gC=protos.guild.toc_30771,vC=protos.guild.toc_30773,mC=protos.guild.toc_30776,yC=protos.guild.toc_30781,IC=protos.guild.toc_30783,bC=protos.guild.toc_30785,wC=protos.skill.seaair.toc_30787,xC=protos.activity.toc_30801,SC=protos.activity.toc_30805,kC=protos.activity.toc_30807,EC=protos.activity.toc_30808,TC=protos.guild.toc_30846,CC=protos.guild.toc_30847,LC=protos.guild.toc_30848,MC=protos.guild.toc_30849,AC=protos.strength.toc_30877,DC=protos.strength.toc_30879,OC=protos.strength.toc_30880,PC=protos.activity.toc_30904,RC=protos.activity.toc_30952,NC=protos.activity.toc_30954,BC=protos.pet.toc_30972,HC=protos.pet.toc_30977,VC=protos.pet.toc_30978,GC=protos.pet.toc_30980,UC=protos.recharge.toc_31011,FC=protos.flyup.toc_31024,qC=protos.flyup.toc_31025,jC=protos.flyup.toc_31026,WC=protos.niepan.toc_31051,YC=protos.niepan.toc_31054,zC=protos.activityDaily.toc_31061,XC=protos.recharge.toc_33017,QC=protos.activity.toc_34007,JC=protos.activity.toc_34016,ZC=protos.activity.toc_34018,KC=protos.activityDaily.toc_34020,$C=protos.pet.toc_36002,eL=protos.pet.toc_36003,tL=protos.activityDaily.toc_36012,iL=protos.activityDaily.toc_36020,nL=protos.activityDaily.toc_39009,sL=protos.activityDaily.toc_39011,oL=protos.activityDaily.toc_39013,aL=protos.activityDaily.toc_39015,rL=protos.activityDaily.toc_39017,lL=protos.login.tos_10101,cL=protos.login.tos_10103,uL=protos.login.tos_10105,dL=protos.login.tos_10107,hL=protos.assist.tos_10111,_L=protos.login.tos_10113,fL=protos.login.tos_10115,pL=protos.login.tos_10116,gL=protos.actor.tos_10203,vL=protos.actor.tos_10209,mL=protos.actor.tos_10211,yL=protos.char.tos_10303,IL=protos.backpack.tos_10404,bL=protos.backpack.tos_10405,wL=protos.backpack.tos_10406,xL=protos.backpack.tos_10407,SL=protos.backpack.tos_10409,kL=protos.backpack.tos_10410,EL=protos.passsuit.tos_10411,TL=protos.backpack.tos_10414,CL=protos.backpack.tos_10418,LL=protos.backpack.tos_10419,ML=protos.backpack.tos_10420,AL=protos.backpack.tos_10421,DL=protos.skill.seaair.tos_10423,OL=protos.scene.heji.tos_10506,PL=protos.rank.tos_10701,RL=protos.field.tos_10801,NL=protos.field.tos_10804,BL=protos.field.tos_10805,HL=protos.mall.tos_10901,VL=protos.mall.tos_10903,GL=protos.mall.tos_10904,UL=protos.mall.tos_10906,FL=protos.mall.tos_10908,qL=protos.skill.seaair.tos_10911,jL=(protos.strength.tos_11001,protos.strength.tos_11002,protos.mail.tos_11202),WL=protos.mail.tos_11204,YL=protos.mail.tos_11206,zL=protos.mail.tos_11208,XL=protos.passsuit.tos_11301,QL=protos.passsuit.tos_11303,JL=protos.god.tos_11304,ZL=protos.god.tos_11306,KL=protos.god.tos_11307,$L=protos.god.tos_11309,eM=protos.god.tos_11311,tM=protos.god.tos_11313,iM=protos.achieve.tos_11401,nM=protos.achieve.tos_11405,sM=protos.guide.tos_11501,oM=protos.guide.tos_11503,aM=protos.chat.tos_11801,rM=protos.chat.tos_11802,lM=protos.chat.tos_11804,cM=protos.task.tos_11902,uM=protos.task.tos_11904,dM=protos.task.tos_11906,hM=protos.activity.tos_12002,_M=protos.activity.tos_12201,fM=protos.activity.tos_12203,pM=protos.activity.tos_12205,gM=protos.activity.tos_12207,vM=protos.activity.tos_12209,mM=protos.evaluate.tos_12211,yM=protos.evaluate.tos_12213,IM=protos.goldrotary.tos_12215,bM=protos.goldrotary.tos_12217,wM=protos.activity.tos_12221,xM=protos.activity.tos_12223,SM=protos.activity.tos_12225,kM=protos.activity.tos_12227,EM=protos.activity.tos_12228,TM=protos.activityDaily.tos_12230,CM=protos.mall.tos_12232,LM=protos.mall.tos_12233,MM=protos.activity.tos_12236,AM=protos.activity.tos_12238,DM=protos.mall.tos_12242,OM=protos.mall.tos_12244,PM=protos.activity.tos_12245,RM=protos.activity.tos_12246,NM=protos.guild.tos_12903,BM=protos.guild.tos_12905,HM=protos.guild.tos_12907,VM=(protos.guild.tos_12909,protos.guild.tos_12911,protos.guild.tos_12913,protos.guild.tos_12915,protos.guild.tos_12916,protos.guild.tos_12917,protos.guild.tos_12919,protos.guild.tos_12920,protos.guild.tos_12922,protos.guild.tos_12923,protos.guild.tos_12925,protos.guild.tos_12926,protos.guild.tos_12927,protos.guild.tos_12928,protos.guild.tos_12932,protos.guild.tos_12933,protos.guild.tos_12935,protos.guild.tos_12937),GM=(protos.guild.tos_12944,protos.guild.tos_12946,protos.guild.tos_12948),UM=protos.guild.tos_12950,FM=protos.guild.tos_12964,qM=protos.guild.tos_12966,jM=(protos.guild.tos_12969,protos.guild.tos_12971,protos.guild.tos_12973,protos.guild.tos_12975,protos.guild.tos_12977,protos.guild.tos_12981,protos.siege.tos_12985),WM=(protos.guild.tos_12987,protos.guild.tos_12988),YM=protos.scene.heji.tos_13026,zM=protos.scene.heji.tos_13027,XM=protos.title.tos_13503,QM=protos.title.tos_13505,JM=protos.title.tos_13506,ZM=protos.title.tos_13508,KM=protos.title.tos_13509,$M=protos.vip.tos_14002,eA=protos.vip.tos_14004,tA=protos.vip.tos_14005,iA=protos.vip.tos_14007,nA=protos.actor.tos_21102,sA=protos.actor.tos_21103,oA=protos.actor.tos_21104,aA=protos.actor.tos_21105,rA=protos.actor.tos_21107,lA=protos.actor.tos_21108,cA=protos.actor.tos_21112,uA=protos.actor.tos_21114,dA=protos.actor.tos_21118,hA=protos.actor.tos_21119,_A=protos.actor.tos_21121,fA=protos.actor.tos_21126,pA=protos.actor.tos_21127,gA=protos.sdk.tos_212,vA=protos.copy.tos_21202,mA=protos.copy.tos_21204,yA=protos.copy.tos_21206,IA=protos.copy.tos_21213,bA=protos.copy.tos_21217,wA=(protos.copy.tos_21223,protos.boss.tos_21224,protos.scene.heji.tos_21228),xA=protos.scene.heji.tos_21229,SA=protos.scene.heji.tos_21231,kA=protos.boss.tos_21234,EA=(protos.copy.tos_21235,protos.copy.tos_21237,protos.copy.tos_21238,protos.copy.tos_21240,protos.magic.tos_21242),TA=protos.magic.tos_21244,CA=protos.magic.tos_21248,LA=protos.boss.tos_21257,MA=(protos.boss.tos_21260,protos.activity.tos_21270),AA=protos.activity.tos_21274,DA=(protos.pig.hundunmonster.tos_21275,protos.arena.tos_21301),OA=protos.arena.tos_21303,PA=protos.arena.tos_21304,RA=protos.arena.tos_21306,NA=protos.arena.tos_21310,BA=protos.arena.tos_21312,HA=protos.arena.tos_21314,VA=protos.tianguan.tos_21701,GA=(protos.tianguan.tos_21704,protos.tianguan.tos_21705,protos.tianguan.tos_21706,protos.tianguan.tos_21708,protos.tianguan.tos_21710,protos.pig.two.tos_22015,protos.pig.two.tos_22017,protos.pig.two.tos_22018,protos.pig.two.tos_22019,protos.copy.tos_22155),UA=protos.digger.tos_22203,FA=protos.scene.tos_22609,qA=(protos.fashion.tos_22708,protos.fashion.tos_22716,protos.fashion.tos_22717,protos.readot.tos_22801),jA=protos.readot.tos_22805,WA=protos.recharge.tos_23001,YA=protos.recharge.tos_23002,zA=protos.recharge.tos_23003,XA=protos.recharge.tos_23007,QA=protos.yzbqc.tos_23107,JA=protos.specialgodring.tos_23220,ZA=protos.specialgodring.tos_23222,KA=protos.siege.tos_23304,$A=protos.siege.tos_23307,eD=protos.siege.tos_23323,tD=protos.siege.tos_23328,iD=protos.siege.tos_23330,nD=protos.siege.tos_23333,sD=protos.siege.tos_23334,oD=protos.siege.tos_23339,aD=protos.siege.tos_23340,rD=protos.siege.tos_23342,lD=(protos.guild.tos_23343,protos.siege.tos_23345),cD=protos.jzgod.tos_23700,uD=protos.godweapon.tos_23702,dD=protos.godweapon.tos_23723,hD=protos.limitChallenge.tos_23734,_D=protos.siege.tos_23776,fD=protos.siege.tos_23777,pD=protos.scene.heji.tos_30002,gD=protos.scene.heji.tos_30003,vD=(protos.boss.tos_30006,protos.actor.tos_30101),mD=protos.actor.tos_30103,yD=protos.actor.tos_30105,ID=protos.actor.tos_30120,bD=protos.actor.tos_30122,wD=protos.activityDaily.tos_30130,xD=protos.activityDaily.tos_30132,SD=protos.achieve.tos_30150,kD=protos.achieve.tos_30152,ED=protos.achieve.tos_30154,TD=protos.xinfa.tos_30160,CD=protos.xinfa.tos_30162,LD=protos.xinfa.tos_30164,MD=protos.xinfa.tos_30166,AD=protos.godweapon.tos_30301,DD=protos.godweapon.tos_30305,OD=protos.godweapon.tos_30306,PD=protos.godweapon.tos_30307,RD=protos.godweapon.tos_30308,ND=protos.godweapon.tos_30309,BD=protos.digger.tos_30332,HD=protos.field.tos_30362,VD=(protos.boss.tos_30374,protos.boss.tos_30376,protos.sdk.tos_30410),GD=protos.sdk.tos_30411,UD=protos.sdk.tos_30412,FD=protos.sdk.tos_30413,qD=protos.sdk.tos_30415,jD=protos.activityDaily.tos_30416,WD=protos.sdk.tos_30417,YD=protos.sdk.tos_30419,zD=protos.ringclassic.tos_30451,XD=protos.changename.tos_30461,QD=protos.changename.tos_30463,JD=protos.actor.tos_30480,ZD=protos.actor.tos_30482,KD=protos.actor.tos_30484,$D=protos.magic.tos_30603,eO=protos.magic.tos_30604,tO=protos.actor.tos_30612,iO=protos.actor.tos_30614,nO=protos.actor.tos_30616,sO=protos.actor.tos_30618,oO=protos.actor.tos_30620,aO=protos.actor.tos_30621,rO=protos.actor.tos_30622,lO=protos.actor.tos_30624,cO=protos.actor.tos_30626,uO=protos.backpack.tos_30651,dO=protos.actor.tos_30661,hO=protos.actor.tos_30663,_O=protos.actor.tos_30664,fO=protos.actor.tos_30665,pO=protos.actor.tos_30666,gO=protos.lunhuizhuhun.tos_30669,vO=protos.lunhuizhuhun.tos_30671,mO=protos.copy.teamCopy.tos_30682,yO=protos.copy.teamCopy.tos_30683,IO=protos.copy.teamCopy.tos_30685,bO=protos.copy.teamCopy.tos_30701,wO=protos.copy.teamCopy.tos_30703,xO=protos.copy.teamCopy.tos_30706,SO=protos.copy.teamCopy.tos_30707,kO=protos.copy.teamCopy.tos_30709,EO=protos.copy.teamCopy.tos_30711,TO=protos.copy.teamCopy.tos_30713,CO=protos.copy.teamCopy.tos_30715,LO=protos.activityDaily.tos_30725,MO=protos.crossBoss.tos_30741,AO=(protos.crossBoss.tos_30743,protos.guild.tos_30765),DO=protos.guild.tos_30767,OO=protos.guild.tos_30769,PO=(protos.guild.tos_30770,protos.guild.tos_30772,protos.guild.tos_30775,protos.guild.tos_30777,protos.guild.tos_30778,protos.guild.tos_30779,protos.guild.tos_30780),RO=protos.guild.tos_30782,NO=protos.skill.seaair.tos_30786,BO=protos.skill.seaair.tos_30788,HO=protos.activity.tos_30800,VO=protos.activity.tos_30802,GO=protos.activity.tos_30804,UO=protos.activity.tos_30806,FO=protos.skill.talent.tos_30821,qO=protos.skill.talent.tos_30823,jO=protos.skill.talent.tos_30825,WO=protos.guild.tos_30842,YO=protos.guild.tos_30845,zO=(protos.strength.tos_30875,protos.strength.tos_30876,protos.strength.tos_30878,protos.actor.tos_30891),XO=protos.actor.tos_30892,QO=protos.activity.tos_30903,JO=protos.activity.tos_30906,ZO=protos.activity.tos_30908,KO=protos.activity.tos_30910,$O=protos.activity.tos_30951,eP=protos.activity.tos_30953,tP=protos.activity.tos_30955,iP=(protos.pet.tos_30971,protos.pet.tos_30973,protos.pet.tos_30974,protos.pet.tos_30975,protos.pet.tos_30976,protos.pet.tos_30979,protos.soul.tos.tos_31007),nP=protos.soul.tos.tos_31008,sP=protos.soul.tos.tos_31009,oP=protos.actor.tos_31020,aP=protos.flyup.tos_31022,rP=protos.actor.tos_31025,lP=protos.flyup.tos_31026,cP=protos.flyup.tos_31028,uP=protos.resonate.tos_31040,dP=protos.resonate.tos_31041,hP=protos.resonate.tos_31043,_P=protos.niepan.tos_31050,fP=protos.niepan.tos_31052,pP=protos.niepan.tos_31053,gP=protos.niepan.tos_31055,vP=protos.activityDaily.tos_31060,mP=protos.recharge.tos_33015,yP=protos.recharge.tos_33016,IP=protos.activity.tos_34015,bP=protos.activity.tos_34017,wP=protos.activityDaily.tos_34019,xP=protos.activityDaily.tos_34021,SP=(protos.pet.tos_36001,protos.activityDaily.tos_36010),kP=protos.activityDaily.tos_36011,EP=protos.activityDaily.tos_36019,TP=protos.activityDaily.tos_36021,CP=protos.activityDaily.tos_39008,LP=protos.activityDaily.tos_39010,MP=protos.activityDaily.tos_39012,AP=protos.activityDaily.tos_39014,DP=protos.activityDaily.tos_39016,OP=protos.login.tos_39018,PP=protos.treasure.tr_toc_30314;G.interface("modules.resonate.views.IResonateView"),G.interface("zwc.saiman.interfaces.IAI","zwc.saiman.interfaces.IProto"),G.interface("zwc.saiman.interfaces.displays.IAvatar","zwc.saiman.interfaces.displays.IDisplay");var RP=function(){function e(){}return b(e,"global.C"),e.n=[],e}(),NP=function(){function r(){}return b(r,"global.ClearTextureUtils"),r.isClearTexture=function(e){var t;if(e)for(var i in r.noClearTexture)if(t=r.noClearTexture[i],-1<e.indexOf(t))return!1;return!0},r.clearTextureByModule=function(e){for(var t in yc.loadedMap)-1<t.indexOf(e)&&yc.clearRes(t,!0)},r.printBitTexture=function(){for(var e in yc.loadedMap){var t=yc.loadedMap[e];t&&(1024<t.width||t.height)}},r.startLoop=function(){G.timer.loop(2e4,r,r.onTimeClear)},r.onTimeClear=function(){hN.ins.isCloseAll&&(GB.faseDestroy(),xe.faseDestroy(),CF.clearLoader(!0),0==dr.xgame&&UP.ins.autoDestory())},r.destoryImage=function(e){},r.log=function(e){void 0===e&&(e=!0);var t=0,i="";for(var n in yc.loadedMap)if((e||!(-1<n.indexOf("avatars_")))&&!(-1<n.indexOf("avatars_"))){var s,o=!0;for(var a in r.noClearTexture)s=r.noClearTexture[a],-1<n.indexOf(s)&&(o=!1);if(o)i+=++t+":"+n.split("/ui/")[1]+"\n"}return i+="总数："+t},r.clearLoadMap=function(){BB.getTimer();var e,t=!0,i="";for(i in xe._map)if(!(-1<i.indexOf("avatars_"))){var n;for(n in t=!0,r.noClearTexture)e=r.noClearTexture[n],-1<i.indexOf(e)&&(t=!1);0,t&&(Zl.clearAllTextureByUrl(i),xe.release(i))}},f(r,["noClearTexture",function(){return this.noClearTexture=["/layouts/grids","/layouts/mainframe","/images/actorhead","/images/boss/ichead","/layouts/basic_ui","/layouts/base_ui2","/layouts/gui.","/images/bin/","/images/textures/","layouts/broad","layouts/color","imagesactorsmallhead","layouts/mainicons_mix","maps/map_","layouts/chat","images/titles/","images/previewaward/","achieveNew/gov/","layouts/mission","layouts/bosshead/","images/zhuiji","images/noclear","images/attrtxts/"]}]),r}(),BP=function(){function s(){}return b(s,"global.NativeSdkManager"),p(1,s,"hasPhoneBang",function(){return!!s.GameSdk&&s.GameSdk.hasPhoneBang}),s.payRequst=function(e){if(e<=0)zB.ins.playErrorMsg("param error，cann't pay");else{var t=new Object;t.uid=hr.uid,t.sid=hr.serverID,t.actor_id=gR.ins.charId,t.product_id=e.toString(),t.application_model=dr.application_model,pt.onAndroid&&(t.referer=hr.referer);var i=JSON.stringify(t);nR.reqPayData(i)}},s.app_createRole=function(e,t){s.GameSdk&&s.GameSdk.create_role(e,t)},s.app_enterGame=function(e,t){s.GameSdk&&s.GameSdk.enter_game(e,t)},s.app_reportRole=function(e,t){var i={};i.serverid=hr.serverID+"",i.servername=hr.serverName,i.rolename=gR.ins.charName,i.rolename||(i.rolename=""),i.roleid=gR.ins.charId+"",i.roleid||(i.roleid=""),i.rolelevel=gR.ins.lv+"",i.rolelevel||(i.rolelevel=""),i.viplevel=gR.ins.VIPLevel+"",i.country=gR.ins.guildName,i.country||(i.country=""),i.balance=gR.ins.YB+"",i.balance||(i.balance=0);var n=0;n=dr.curServerTime?Math.floor(dr.curServerTime/1e3):Math.floor(pt.now()/1e3),i.timestamp=n+"",0<gR.ins.createDay?i.rolecreatetime=gR.ins.createDay:i.rolecreatetime="-1",gR.ins.actorList&&0<gR.ins.actorList.length?i.power=gR.ins.force:i.power=0,s.GameSdk&&s.GameSdk.reportRole(e,i,t)},s.doPayPlatform=function(e,t){s.GameSdk&&s.GameSdk.pay(e,t)},s.doActivity=function(e){e&&e.hasOwnProperty("activityId")&&0<e.activityId?s.GameSdk&&s.GameSdk.doActivity(e):e?console.error("doActivity,info:"+JSON.stringify(e)):console.error("doActivity,info:null")},s.dealActIconType=function(e){s.doActivity({activityId:1,type:e})},s.GameSdk=null,s.deviceInfo=null,s.ACTION_CREATE_ROLE="create_role",s.ACTION_ENTER_GAME="enter_game",s.ACTION_ROLE_UPDATE="role_update",s.ACTIVITY_ID_ICON=1,s}(),HP=function(){function l(){}return b(l,"global.ResUtils",null,"ResUtils$1"),l.getHost=function(){if(!l._host_){var e=pt.window.location.href;l._host_=e.substring(0,e.indexOf("h5"))}return l._host_},l.loadStyleImage=function(e,t){void 0===t&&(t="");var i=_r.getStyleTexturePath(e),n=_r.getStylegBinPath(e),s=ql.create(l,global.ResUtils.onImageComplete,[t,n,i]);G.loader.load([{url:n,type:"arraybuffer"},{url:i,type:"image"}],s)},l.onImageComplete=function(e,t,i){var n=new mt(G.loader.getRes(t)),s=G.loader.getRes(i);if(null!=s){var o=Qp.GetNew();o.fileName=e,o.sourceTexture=s,o.decode(n),l.UiTextureHash.push(o),"FightNumFont"==e&&FB.todo(o)}},l.takeTexture=function(e,t){for(var i,n=0;n<l.UiTextureHash.length;n++)if(i=l.UiTextureHash[n].takeTexture(t))return i;return i},l.drawTexture=function(e,t,i,n,s,o){void 0===o&&(o=!1);var a=l.takeTexture(e,t);return o&&i.clear(),a?(i.drawTexture(a,n,s,a.width,a.height),new u_(n,s,a.width,a.height)):new u_(n,s)},l.loadConfig=function(e,t,i,n){for(var s=[],o=0;o<e.length;++o){var a=fs.getClass("protos.db."+t[o]);if(a){if(!a.hash){var r=e[o];r=_r.getDBPath(e[o]),s.push({url:r,type:"arraybuffer",className:t[o]})}}else console.log(t[o]+"类不存在或者未在ConfigDataUtils注册")}0<s.length?G.loader.load(s,ql.create(l,global.ResUtils.onConfigComplete,[s,i]),null,"arraybuffer"):(n&&(n.run(),n.clear(),n=null),i&&(i.run(),i.clear(),i=null))},l.onConfigComplete=function(e,t){for(var i=0;i<e.length;++i){var n=e[i],s=fs.getClass("protos.db."+n.className);if(s&&s.count<=0&&(s.setup(n.url),s.bytes))for(var o=0;o<s.count;++o)s.config(o);G.loader.clearRes(n.url),s.buff=null,s.bytes&&s.bytes.clear(),n=s.bytes=null}e.length=0,e=null,t&&(t.run(),t.clear(),t=null)},l.setCookie=function(e){for(var t in e)bc.setItem(t,e[t])},l.getCookie=function(e){return bc.getItem(e)},l.loadTitles=function(e,t){var i=_r.getTitlePath(e),n=tt.ins.getTexture(i);n?t&&t.runWith(n):tt.ins.loadPicture(i,t)},l.loadRes=function(e,t){},l.hasResLoaded=function(){return!1},l.getWordTex=function(){var e=_r.getAtlasSubPath("basic_ui_3/xt_zy_bg.png");return G.loader.getRes(e)},l.getArrowTex=function(){var e=_r.getAtlasSubPath("mainframe/xt_zy_jt1.png");return G.loader.getRes(e)},l.newGuideLoadPro=function(){var e=l.checkPointPros[UR.instance.currentPoint];if(e)for(var t=String(e).split(","),i=0;i<t.length;i++)l.startLoad(t[i])},l.taskLoadPro=function(e,t){if(!(t<=2)){var i=l.taskPros[e];if(i)for(var n=String(i).split(","),s=0;s<n.length;s++)l.startLoad(n[s])}},l.startLoad=function(e){var t=[{url:_r.getLayoutsPath(e),type:"atlas"}];G.loader.load(t,ql.create(l,global.ResUtils.onLoad),null,"atlas"),"actor"==e?global.ResUtils.loadConfig(rc.actor_A,rc.actor_C):"strength"==e?global.ResUtils.loadConfig(rc.streng_A,rc.streng_C):"bag"==e?global.ResUtils.loadConfig(rc.bag_A,rc.bag_C):"specialgodring"==e?global.ResUtils.loadConfig(rc.specialgodring_A,rc.specialgodring_C):"boss"==e?(global.ResUtils.loadConfig(rc.boss_A,rc.boss_C),global.ResUtils.loadConfig(rc.flyboss_A,rc.flyboss_C)):"copy"==e?global.ResUtils.loadConfig(rc.copy_A,rc.copy_C):"digger"==e?global.ResUtils.loadConfig(rc.digger_A,rc.digger_C):"limitchallenge"==e?global.ResUtils.loadConfig(rc.flyroad_A,rc.flyroad_C):"limitYQBtn"==e&&(G.loader.load(_r.getFullUrl("ui/layouts/basic_ui/fs_tc_bg_01.jpg",!1)),G.loader.load(_r.getFullUrl("ui/layouts/basic_ui/fs_tc_bg_02.jpg",!1)))},l.onLoad=function(){},l.checkBasicLoaded=function(){return G.loader.getRes(_r.getLayoutsPath("basic_ui"))&&G.loader.getRes(_r.getLayoutsPath("base_ui2"))&&G.loader.getRes(_r.getLayoutsPath("basic_ui_3"))&&G.loader.getRes(_r.getLayoutsPath("basic_ui_g"))&&G.loader.getRes(_r.getLayoutsPath("basic_ui_b"))},l.loadBasicUI=function(e){G.loader.load([_r.getLayoutsPath("basic_ui_b"),_r.getLayoutsPath("basic_ui_g"),_r.getLayoutsPath("basic_ui_3"),_r.getLayoutsPath("base_ui2"),_r.getLayoutsPath("basic_ui")],e)},l._host_=null,l.UiTextureHash=[],f(l,["checkPointPros",function(){return this.checkPointPros={2:"actor,skill",3:"bag,strength,strength_mix",4:"limitYQBtn,limitchallenge",5:"specialgodring",7:"strength,strength_mix",11:"boss",12:"strength,strength_mix",12:"specialgodring,boss",14:"skill",16:"specialgodring",17:"boss",18:"digger"}},"taskPros",function(){return this.taskPros={10046:"copy",10047:"strength,strength_mix"}}]),l}(),VP=function(){function e(){this._ready=!1,this.createjs=null,this.Sound=null,this._loadedIdMap={},this._channelInsMap={},this._errorIdMap={},this._count=0,this._maxCount=2,this.MAX=Math.pow(2,31)}b(e,"global.sound.CreatejsSound");var t=e.prototype;return G.imps(t,{"global.sound.ISound":!0}),t.setup=function(e){if(pt.window.createjs)global.sound.CreatejsSound.ins._setup(e);else{var t=pt.document.createElement("script");t.src=_r.getFullUrl("js/soundjs-NEXT.min.js?1",!1),t.onload=function(){global.sound.CreatejsSound.ins._setup(e)},pt.document.body.appendChild(t)}},t._setup=function(t){try{if(this.createjs=createjs,this.Sound=this.createjs.Sound,this.Sound.alternateExtensions=["mp3"],t&&0<t.length){var i=this;i.Sound.addEventListener("fileload",function(e){i._loadedIdMap[e.id]=!0,t.splice(t.indexOf(e.id),1),UP.ins.addLoadedSound(e.id,e.data),0==t.length&&(i.Sound.removeAllEventListeners(),i._setupFinish())});for(var e=0;e<t.length;e++){var n=t[e];(this._channelInsMap[n]={}).rtime=pt.now(),this.Sound.registerSound(UB.ins.getUrl(n),n)}}else this._setupFinish()}catch(e){console.log("createJs error")}},t._setupFinish=function(){this.Sound.addEventListener("fileload",this.createjs.proxy(this.onSoundLoaded,global.sound.CreatejsSound.ins)),this.Sound.addEventListener("fileerror",this.createjs.proxy(this.onSoundError,global.sound.CreatejsSound.ins)),this._ready=!0},t.onSoundError=function(e){},t.onSoundLoaded=function(e){var t=e.id;if(null!=this._channelInsMap[t]){this._loadedIdMap[t]=!0;var i=e.data;i.autoPlay&&UB.ins.soundEnabled&&this.play(t,i.channels,i.interrupt==this.Sound.INTERRUPT_EARLY,i.delay,i.loop,i.startTime,!0,i.priority),UP.ins.addLoadedSound(t,i)}},t.play=function(e,t,i,n,s,o,a,r){var l=this;if(void 0===t&&(t=1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===r&&(r=UB.ins.SOUND_PRIORITY_FIRST),!0===this._errorIdMap[e])return null;if(!(this._count>=this._maxCount&&r!=UB.ins.SOUND_PRIORITY_FIRST)){var c=xs.newObject();c.delay=n,0==s?c.loop=this.MAX:1!=s&&(c.loop=s),c.channels=t,c.interrupt=i?this.Sound.INTERRUPT_EARLY:this.Sound.INTERRUPT_NONE,c.priority=r;var u=pt.now();if(UP.ins.addCall(e),UP.ins.updateSTime(e,u),this._loadedIdMap[e]){for(var d=this._channelInsMap[e],h=d.c||(d.c=[]),_=d.t||(d.t=[]),f=_.length-1;0<=f;f--)15e3<=u-_[f]&&(h.splice(f,1),_.splice(f,1));if(h.length>=t&&!i)return;var p=this.Sound.play(e,c);return null==p||p.playState==this.createjs.Sound.PLAY_FAILED?null:(p.soundId=e,h.push(p.uniqueId),_.push(u),this._count++,p.addEventListener("complete",function(e){var t=h.indexOf(e.target.uniqueId);0<=t&&(h.splice(t,1),_.splice(t,1),l._count--)}),p)}return(d=this._channelInsMap[e])?8e3<=u-d.rtime?(delete this._channelInsMap[e],this._errorIdMap[e]=!0,null):void 0:((d=this._channelInsMap[e]={}).rtime=u,c.autoPlay=a,c.stime=u,this.Sound.registerSound(UB.ins.getUrl(e),e,c),null)}},t.stop=function(e){if(e&&e.stop(),e){var t=e.soundId,i=this._channelInsMap[t],n=i.c,s=i.t,o=n.indexOf(e.uniqueId);0<=o&&(n.splice(o,1),s.splice(o,1),this._count--)}},t.pause=function(e){e&&!e.paused&&(e.paused=!0,this._count--)},t.resume=function(e){e&&e.paused&&(e.paused=!1,this._count++)},t.stopAll=function(){for(var e in this.Sound&&this.Sound.stop(),this._channelInsMap){var t=this._channelInsMap[e];t.c&&(t.c.length=0),t.t&&(t.t.length=0)}this._count=0},t.remove=function(e){delete this._loadedIdMap[e],delete this._channelInsMap[e]},p(0,t,"ready",function(){return this._ready}),p(0,t,"volume",function(){return this.Sound?this.Sound.volume:1},function(e){this.Sound&&(this.Sound.volume=e)}),p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e.__init$=function(){(function(){function e(){this.channels=0,this.interrupt=null,this.delay=0,this.loop=0,this.autoPlay=!1,this.stime=NaN,this.startTime=NaN,this.priority=0}return b(e,""),e})()},e}(),GP=function(){function e(){this._channelInsMap={},this._errorIdMap={},this._count=0,this._maxCount=2}b(e,"global.sound.LayaSound");var t=e.prototype;return G.imps(t,{"global.sound.ISound":!0}),t.setup=function(e){ap.autoReleaseSound=!1,ap.autoStopMusic=!1},t.play=function(t,e,i,n,s,o,a,r){var l=this;if(void 0===e&&(e=1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===r&&(r=UB.ins.SOUND_PRIORITY_FIRST),!0===this._errorIdMap[t])return null;if(!(this._count>=this._maxCount&&r!=UB.ins.SOUND_PRIORITY_FIRST)){if(!(0<n)){var c=pt.now(),u=this._channelInsMap[t];if(u){for(var d=u.c,h=u.t,_=u.n,f=h.length-1;0<=f;f--)15e3<=c-h[f]&&(_[f].stop(),d.splice(f,1),h.splice(f,1),_.splice(f,1));if(d.length>=e){if(!i)return;var p=_.shift();p&&p.stop(),h.shift(),d.shift()}}var g=Bg.getGID(),v=ap.playSound(UB.ins.getUrl(t),s,ql.create(void 0,function(){var e=d?d.indexOf(g):-1;0<=e&&(d.splice(e,1),h.splice(e,1),_.splice(e,1),l._count--),UP.ins.addLoadedSound(t,{stime:0})}),null,o);return null==v?null:(v.soundId=t,u=this._channelInsMap[t]||(this._channelInsMap[t]={}),d=u.c||(u.c=[]),h=u.t||(u.t=[]),_=u.n||(u.n=[]),d.push(g),h.push(c),_.push(v),this._count++,v)}G.timer.once(n,this,this.play,[t,e,i,0,s,o,a],!1)}},t.stop=function(e){if(e&&e.stop(),e){var t=e.soundId;e.stop();var i=this._channelInsMap[t],n=i.c,s=i.t,o=i.n,a=o.indexOf(e);0<=a&&(n.splice(a,1),s.splice(a,1),o.splice(a,1),this._count--)}},t.pause=function(e){var t=e;t&&!t.isStopped&&(t.pause(),this._count--)},t.resume=function(e){var t=e;t&&t.isStopped&&(t.resume(),this._count++)},t.stopAll=function(){for(var e in ap.stopAll(),this._channelInsMap)delete this._channelInsMap[e];G.timer.clear(this,this.play),this._count=0},t.remove=function(e){delete this._channelInsMap[e]},p(0,t,"ready",function(){return!0}),p(0,t,"volume",function(){return ap.soundVolume},function(e){ap.soundVolume=e;for(var t=ap._channels,i=0;i<t.length;i++){var n=t[i];n&&!n.isStopped&&(n.volume=e)}}),p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e}(),UP=function(){function e(){this.loadedMap=null,this.callMap=null,this.createjs=null,this.sound=null,this.cleanTime=18e4,this.loadedMap=new jl,this.callMap=new jl}b(e,"global.sound.SoundController");var t=e.prototype;return t.addLoadedSound=function(e,t){this.hasLoadedSound(e)?this.addCall(e):(this.loadedMap.put(e,t),this.callMap.put(e,1)),this.updateSTime(e,pt.now())},t.addCall=function(e){if(this.hasLoadedSound(e)){var t=this.getCallCount(e);this.callMap.put(e,t+1,!0)}},t.print=function(){var e=RP.n[1];for(var t in this.loadedMap.proto)this.callMap.has(t)&&(e+="\n"+t.toString()+"\t"+this.callMap.take(t));return e},t.destorySound=function(e){var t=this;if(t.sound){var i=UB.ins.getUrl(e);t.sound.remove(e),t.sound instanceof global.sound.LayaSound?ap.destroySound(i):t.sound instanceof global.sound.CreatejsSound&&(t.createjs=t.createjs||createjs,t.createjs&&t.createjs.Sound&&t.createjs.Sound.removeSound(i)),t.loadedMap.remove(e),t.callMap.remove(e)}},t.autoDestory=function(){var e=[],t=pt.now();for(var i in this.loadedMap.proto){var n=this.loadedMap.take(i);n.stime&&t-n.stime>this.cleanTime&&e.push(i)}for(var s=0;s<e.length;s++)this.destorySound(e[s])},t.hasLoadedSound=function(e){return this.loadedMap.has(e)},t.getCallCount=function(e){var t=this.callMap.take(e);return t=t||0},t.updateSTime=function(e,t){this.hasLoadedSound(e)&&(this.loadedMap.take(e).stime=t)},p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e}(),FP=function(){function e(){this._runIns=null,this._lastAct=null}b(e,"global.sound.WalkSoundControll");var t=e.prototype;return t.setup=function(){UB.ins.on("changed",this,this.onChanged),G.timer.frameLoop(1,this,this.onFrame)},t.onChanged=function(){UB.ins.soundEnabled||(this._runIns=null,this._lastAct=null)},t.onFrame=function(){if(UB.ins.soundEnabled&&NF.Ins().isReady&&NF.mainChar&&NB.isSceneReady){var e=NF.mainChar.currAct;this._lastAct!=e&&"run"==(this._lastAct=e)&&(this._runIns=UB.ins.playSound("002",1,!1,0,0,0,!1))}"run"!=this._lastAct&&this._runIns&&(UB.ins.stop(this._runIns),this._runIns=null)},p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e}(),qP=function(){function a(){}return b(a,"global.web.WebSdk",null,"WebSdk$1"),a.getIns=function(){if(!a.sqgamesdk)try{a.sqgamesdk=new SQGAMESDK}catch(e){return!1}return!0},a.share=function(e,t,i,n,s,o){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.share&&a.sqgamesdk.share(t,e,i,function(){s&&s.apply(n)},function(){o&&o.apply(n)})},a.subscribe=function(t,i){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.subscribe&&a.sqgamesdk.subscribe(function(e){i&&i.apply(t,[e])})},a.querySubscrible=function(e,t,i,n){var s=hr.query_subscribe;s&&Jl.httpGet(s,e,t,i,n)},a.logServer=function(e,t){void 0===t&&(t="server"),a.getIns()&&a.sqgamesdk&&a.sqgamesdk.log&&a.sqgamesdk.log(e,t)},a.download_wd=function(t,i){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.download_wd&&a.sqgamesdk.download_wd(function(e){i&&i.apply(t,[e])})},a.verify=function(t,i){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.verify&&(tr.push(RP.n[2]),a.sqgamesdk.verify(function(e){tr.push(RP.n[3]),hr.id_verify=2,i&&i.apply(t,[e])}))},a.switchAccount=function(){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.switchAccount&&a.sqgamesdk.switchAccount()},a.saveToDesktop=function(t,i){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.saveToDesktop&&a.sqgamesdk.saveToDesktop(function(e){i&&i.apply(t,[e])})},a.mallList=function(e,t,i,n){var s=hr.mall_list;s&&Jl.httpGet(s,e,t,i,n)},a.pay=function(e){a.getIns()&&a.sqgamesdk&&a.sqgamesdk.pay&&a.sqgamesdk.pay(a.changeData(e))},a.getAppDeviceInfo=function(i,t,n){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.getAppInfo)try{a.sqgamesdk.getAppInfo(function(e){t&&t.apply(i,[e])},function(e,t){n&&n.apply(i,[e,t])})}catch(e){console.log(e)}},a.getAwyAd=function(e,t,i,n){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.all)try{a.sqgamesdk.all(e,t,function(e){if(1==e.code){e.data.awy_cb;var t=e.data.res;n&&n.apply(i,[t])}})}catch(e){console.log(e)}},a.bindPhone=function(e,t,i){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.bindPhone)try{a.sqgamesdk.bindPhone(function(){t&&t.apply(e)},function(){i&&i.apply(e)})}catch(e){console.log(e)}},a.wx_share=function(e,t,i){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.wx_share)try{a.sqgamesdk.wx_share(function(){console.log("wx_share,获取成功"),t&&t.apply(e)},function(){console.log("wx_share,获取失败"),i&&i.apply(e)})}catch(e){console.log(e)}},a.wx_share_type=function(t,i,e,n){if(void 0===n&&(n=""),a.getIns()&&a.sqgamesdk&&a.sqgamesdk.wx_share)try{a.sqgamesdk.wx_share(function(e){console.log("wx_share,获取成功"),i&&i.apply(t,[e])},function(){console.log("wx_share,获取失败"),e&&e.apply(t)},n)}catch(e){console.log(e)}},a.cp_share=function(e,t,i){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.cp_share)try{a.sqgamesdk.cp_share(function(){console.log("cp_share,获取成功"),t&&t.apply(e)},function(){console.log("cp_share,获取失败"),i&&i.apply(e)})}catch(e){console.log(e)}},a.changeData=function(e){if(!e)return{};for(var t={},i=e?e.split("&"):[],n=0,s=i.length;n<s;n++){var o=i[n];if(o&&0<o.length){var a=o.indexOf("="),r=o.slice(0,a),l=o.slice(a+1,o.length);l&&l.match(/^\d*(\.\d*){0,1}$/)?t[r]=parseInt(l):t[r]=l}}return t},a.getAwyKf=function(e,t,i){if(a.getIns()&&a.sqgamesdk&&a.sqgamesdk.all)try{a.sqgamesdk.all(e,t,function(e){e&&1==e.code&&(tr.push(RP.n[4]),i&&i.apply())})}catch(e){console.log(e)}},a.sqgamesdk=null,a}(),jP=function(){function g(){}return b(g,"global.web.WebSdkUtil",null,"WebSdkUtil$1"),g.initSdk=function(){qP.getIns()},g.setSdk=function(e){qP.sqgamesdk=e},g.checkFunctionOpen=function(e){var t=g.platformIds.indexOf(e);if(t<0)return!0;var i=hr.webGetParams;if(!i)return!1;switch(t){case 0:if(i.hasOwnProperty("id_verify_switch"))if("2"==i.id_verify_switch){var n=i.id_verify;return hr.id_verify=parseInt(n),!0}break;case 1:if(i.hasOwnProperty("desktop_switch"))if("2"==i.desktop_switch)return!0;break;case 2:if(i.hasOwnProperty("subscribe_switch")){var s=i.subscribe_switch;if(0<=s.indexOf("wx")||0<=s.indexOf("qq")||0<=s.indexOf("other"))return"-1"==(s=i.wx_is_subscribe)?nR.reqSubscribeStatus():"1"==s?hr.wx_is_subscribe=0:"2"==s&&(hr.wx_is_subscribe=1),!0}break;case 3:if(i.hasOwnProperty("wd_download_switch"))if("1"==i.wd_download_switch)return!0;break;case 4:if(i.hasOwnProperty("change_account_switch"))if("2"==i.change_account_switch)return!0;break;case 5:if(i.hasOwnProperty("shared_switch")){var o=i.shared_switch;if(0<=o.indexOf("wx")||0<=o.indexOf("qq")||0<=o.indexOf("other"))return!0}break;case 6:if(i.hasOwnProperty("bind_phone_switch"))if("2"==i.bind_phone_switch)return!0;break;case 7:if(i.hasOwnProperty("vip_kf_switch"))if("1"==i.vip_kf_switch)return!1;return!0;case 8:if(i.hasOwnProperty("com_share_switch")){var a=i.com_share_switch;if(0<=a.indexOf("wx")||0<=a.indexOf("qq")||0<=a.indexOf("other"))return!0}}return!1},g.sdk_cmd=function(e,t){if(e)switch(e=e.toLowerCase()){case"app_device_info":qP.getAppDeviceInfo(null,global.web.WebSdkUtil.getDeviceSuccessFn,global.web.WebSdkUtil.getDeviceFailFn);break;case"share":if(hr.webGetParams.hasOwnProperty("shared_switch")){var i=hr.webGetParams.shared_switch;(0<=i.indexOf("wx")||0<=i.indexOf("qq")||0<=i.indexOf("other"))&&qP.share(RP.n[5],RP.n[6],_r.getShareIconPath(),null,global.web.WebSdkUtil.shareSuccess,global.web.WebSdkUtil.shareFail)}break;case"subscribe":var n=hr.webGetParams.subscribe_switch;if((0<=n.indexOf("wx")||0<=n.indexOf("qq")||0<=n.indexOf("other"))&&hr.webGetParams.hasOwnProperty("wx_is_subscribe")){var s=parseInt(hr.webGetParams.wx_is_subscribe);1==s||0==hr.wx_is_subscribe?qP.subscribe(null,global.web.WebSdkUtil.subscribeSuccess):2==s&&1==hr.wx_is_subscribe?global.web.WebSdkUtil.subscribeSuccess():-1==s&&1==hr.wx_is_subscribe&&global.web.WebSdkUtil.subscribeSuccess()}break;case"report_server":case"report_entergame":case"report_levelup":var o=e.split("_")[1],a={};a.serverid=hr.serverID,a.servername=hr.serverName,a.rolename=gR.ins.charName,a.rolename||(a.rolename=""),a.roleid=gR.ins.charId,a.roleid||(a.roleid=""),a.rolelevel=gR.ins.lv,a.rolelevel||(a.rolelevel=""),a.zsLv=gR.ins.zsLv,a.zsLv||(a.zsLv="0"),a.isnewrole=_r.justCreated,a.viplevel=gR.ins.VIPLevel,a.country=gR.ins.guildName,a.country||(a.country=""),a.countryid=gR.ins.guildId,a.countryid||(a.countryid=""),a.countryrolename="",a.party="",a.balance=gR.ins.YB,a.balance||(a.balance=0),a.fightvalue=gR.ins.force,a.fightvalue||(a.fightvalue=0),dr.curServerTime?a.timestamp=dr.curServerTime:a.timestamp=pt.now(),0<gR.ins.createDay?a.rolecreatetime=1e3*gR.ins.createDay:a.rolecreatetime="";var r=[],l=gR.ins.actorList;if(l)for(var c=l.length,u=0;u<c;u++){var d=l[u];if(d){var h="boy";2==d.sex&&(h="girl"),r.push({profession:ha.getDesByType(d.job),professionid:d.job,gender:h})}}a.roles=r,qP.logServer(a,o);break;case"report_create":var _={};_.serverid=hr.serverID,_.servername=hr.serverName,_.rolename=gR.ins.charName,_.roleid=gR.ins.charId,dr.curServerTime?_.timestamp=dr.curServerTime:_.timestamp=pt.now(),qP.logServer(_,"create");break;case"download_wd":if(hr.webGetParams.hasOwnProperty("wd_download_switch"))1==parseInt(hr.webGetParams.wd_download_switch)&&qP.download_wd(null,global.web.WebSdkUtil.downWdSuccess);break;case"switchaccount":if(hr.webGetParams.hasOwnProperty("change_account_switch"))2==parseInt(hr.webGetParams.change_account_switch)&&qP.switchAccount();break;case"savetodesktop":if(hr.webGetParams.hasOwnProperty("desktop_switch"))2==parseInt(hr.webGetParams.desktop_switch)&&qP.saveToDesktop(null,global.web.WebSdkUtil.saveDeskSuccess);break;case"pay":var f=parseInt(t);0<f&&g.payRequst(f);break;case"verify":break;case"bind_phone":hr.webGetParams&&hr.webGetParams.hasOwnProperty("is_bind_phone")&&(1==hr.isBindPhone?qP.bindPhone(null,global.web.WebSdkUtil.bindingPhoneSuccess):YB.reqBindPhoneReward());break;case"wx_share":if(hr.webGetParams.hasOwnProperty("com_share_switch")){var p=hr.webGetParams.com_share_switch;(0<=p.indexOf("wx")||0<=p.indexOf("qq")||0<=p.indexOf("other"))&&qP.wx_share(null,global.web.WebSdkUtil.wxshareSuccess)}break;case"wx_share_2":qP.wx_share_type(null,global.web.WebSdkUtil.wxshare2Success,global.web.WebSdkUtil.wxshare2Fail,t);break;case"cp_share":global.web.WebSdkUtil.getCpShareSwitch()&&qP.cp_share(null,global.web.WebSdkUtil.cpshareSuccess);break;default:zB.ins.playErrorMsg(RP.n[7]+e)}},g.payRequst=function(e){if(null!=hr.webGetParams){var t=new Object;t.appid=hr.appid,t.uid=hr.uid,t.sid=hr.serverID,t.actor_id=gR.ins.charId,t.product_id=e.toString(),t.referer=hr.referer,t.application_model=dr.application_model;var i=JSON.stringify(t);nR.reqPayData(i),console.log("向后端请求下单："+i)}else zB.ins.playErrorMsg(RP.n[8])},g.doPayPlatform=function(e){console.log("通知平台下单："+e),qP.pay(e)},g.querySubscribeStatus=function(){nR.reqSubscribeStatus()},g.checkSubscribeBack=function(e){void 0===e&&(e=1),-1!=(hr.wx_is_subscribe=e)||zB.ins.playErrorMsg(RP.n[9]+e)},g.saveDeskSuccess=function(){nR.reqSaveDeskReward()},g.subscribeSuccess=function(e){void 0===e&&(e=1),nR.reqSubscribeReward(),hr.wx_is_subscribe=1},g.downWdSuccess=function(){nR.reqMicroReward()},g.getAwyKfAward=function(){nR.getAwyKf()},g.shareSuccess=function(){nR.reqShareReward()},g.shareFail=function(){},g.bindingPhoneSuccess=function(){hr.isBindPhone=2,hr.webGetParams.is_bind_phone="2",hN.ins.open("BINDING_PHONE")},g.hasBindPhone=function(){if(hr.webGetParams&&hr.webGetParams.hasOwnProperty("is_bind_phone")&&(2==parseInt(hr.webGetParams.is_bind_phone)||2==hr.isBindPhone))return!0;return!1},g.wxshareSuccess=function(){YB.reqWxshareSuccess("WX_SHARE")},g.cpshareSuccess=function(){YB.reqCpshareSuccess()},g.getHasFavour=function(){return!(!hr.webGetParams||!hr.webGetParams.hasOwnProperty("is_mypro"))&&"1"==hr.webGetParams.is_mypro},g.getCpShareSwitch=function(){if(hr.webGetParams.hasOwnProperty("hd_share_switch")){var e=hr.webGetParams.hd_share_switch;if(0<=e.indexOf("wx")||0<=e.indexOf("qq")||0<=e.indexOf("other"))return!0}return!1},g.wxshare2Success=function(e){if(console.log("wxshare2Success>>>:"+e),e)switch(e){case"NEW_SERVER_GIFT":YB.reqWxshareSuccess(e);break;case"ZERO_RMB_81":case"ZERO_RMB_82":case"ZERO_RMB_83":YB.reqWxshareSuccess(e);var t=parseInt(e.split("_")[2]);YB.req0YuanGold(t);break;case"LOGIN_GIFT_ACTIVITY":YB.reqWxshareSuccess(e),Tu.sendToModule("UPDATE_BARGAIN_SELECTED",["modules.activity.ActivityModule","modules.nav.NavModule"],{share:!0})}},g.wxshare2Fail=function(){},g.getDeviceSuccessFn=function(e){(g.deviceInfo=e)&&g.deviceInfo.IMEI&&(hr.IMEI=g.deviceInfo.IMEI)},g.getDeviceFailFn=function(e,t){g.getDeviceFailTimes++,t&&console.log("获取设备失败消息：",t),g.getDeviceFailTimes<3&&g.sdk_cmd("app_device_info")},g.SHARE="share",g.SUBSCRIBE="subscribe",g.REPORT_SERVER="report_server",g.REPORT_CREATE="report_create",g.REPORT_ENTERGAME="report_entergame",g.REPORT_LEVE_LUP="report_levelup",g.DOWNLOAD_WD="download_wd",g.SWITCHACCOUNT="switchaccount",g.SAVETODESKTOP="savetodesktop",g.PAY_ORDER="pay",g.VERIFY="verify",g.APP_DEVICE_INFO="app_device_info",g.BINDING_PHONE="bind_phone",g.WX_SHARE="wx_share",g.WX_SHARE_2="wx_share_2",g.CP_SHARE="cp_share",g.getDeviceFailTimes=0,g.deviceInfo=null,g.WD_INDEX=3,f(g,["platformIds",function(){return this.platformIds=[22,23,24,25,26,27,79,54,149]}]),g}(),WP=function(){function n(){}return b(n,"modules.achievenew.others.AchievenewRequestUtils"),n.requestGetTodayLiLianReward=function(e,t){var i=new Sl;i.requestID=e,n.getTodayLiLianRewardBackHandler=t,Tu.sendToService(i)},n.runGetTodayLiLianRewardFn=function(){n.getTodayLiLianRewardBackHandler&&(n.getTodayLiLianRewardBackHandler.run(),n.getTodayLiLianRewardBackHandler.clear(),n.getTodayLiLianRewardBackHandler=null)},n.requestGuanYin=function(e){var t=new xl;n.getGuanYinBackHandler=e,Tu.sendToService(t)},n.runGetGuanYinBackFn=function(){n.getGuanYinBackHandler&&(n.getGuanYinBackHandler.run(),n.getGuanYinBackHandler.clear(),n.getGuanYinBackHandler=null)},n.requestPromotion=function(e){var t=new kl;n.getPromotionHandler=e,Tu.sendToService(t)},n.runGetPromotionFn=function(){n.getPromotionHandler&&(n.getPromotionHandler.run(),n.getPromotionHandler.clear(),n.getPromotionHandler=null)},n.reqPretigeInfo=function(){var e=new Qh;Tu.sendToService(e)},n.reqPretigeBack=function(){var e=new zh;Tu.sendToService(e)},n.backToGov=function(e){n.backHandler=e},n.runBackToGovHandler=function(){n.backHandler&&(n.backHandler.run(),n.backHandler.clear(),n.backHandler=null)},n.getTodayLiLianRewardBackHandler=null,n.getGuanYinBackHandler=null,n.getPromotionHandler=null,n.backHandler=null,n}(),YP=function(){function e(){this.m_currentIndex=0,this.prestige_changed=!0,this.back_prestige=0,this.m_roles=[],this.rankBack=!1,this._inited=!1,this.Prestige_Vec=new jl}b(e,"modules.achievenew.others.prestige.PrestigeDataModel");var t=e.prototype;return t.getPrestigeIndex=function(){this.prestige_changed=!1;for(var e=Sn.count,t=0;t<e&&!(gR.ins.WW<Sn.MODEL.minPrestige(t));t++);return this.m_currentIndex=0==t?0:t-1,this.m_currentIndex},t.getRoles=function(){return this.m_roles},t.checkRequestInfo=function(){WP.reqPretigeInfo()},t.updateInfo=function(e){this.prestige_changed=!0,this.m_roles=e.roles,this.back_prestige=e.back_prestige},t.setImage=function(e,t){var i=G.loader.getRes(e.skin);null!=i?(i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.Prestige_Vec.put(t,e,!0)):e.on("loaded",this,this.onLoadedImage,[,[e,t]])},t.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.Prestige_Vec.put(t[1],t[0],!0)},p(0,t,"cfgOpenServerDay",function(){return parseInt($e.MODEL.value($e.getIndex(73)))}),p(0,t,"cfgLimitLevel",function(){return parseInt($e.MODEL.value($e.getIndex(72)))}),p(0,t,"pricePrestige",function(){return parseFloat($e.MODEL.value($e.getIndex(70)))}),p(0,t,"getPrestigeWayKey",function(){return parseInt($e.MODEL.value($e.getIndex(71)))}),p(0,t,"openBool",function(){return!(dr.getOpenServiceDay()<this.cfgOpenServerDay||gR.ins.lv<this.cfgLimitLevel)}),p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),zP=function(){function c(){this.tuJian_Vec=new jl}return b(c,"modules.achievenew.others.TujianDataModel"),p(1,c,"totalFightNum",function(){if(!c.activeHash)return 0;var e,t=0,i=0;for(var n in c.activeHash.proto)e=c.activeHash.proto[n],i=Bt.getIndex(e),t+=c.getBossCardLevelFight(i);return t+=c.getSuitTotalFight()}),p(1,c,"typeList",function(){if(c.cardsTypeList&&0<c.cardsTypeList.length)return c.cardsTypeList;for(var e,t=new jl,i=0;i<Bt.count;i++)t.take(Bt.MODEL.type(i))||t.put(Bt.MODEL.type(i),Bt.MODEL.type(i));for(var n in c.cardsTypeList=c.cardsTypeList||[],t.proto)e=t.proto[n],c.cardsTypeList.push(e);return c.cardsTypeList}),p(1,c,"isLoadTujianJxr",function(){return 0<Ht.count}),c.isActivedById=function(e){return!(!c.activeHash||!c.activeHash.take(e))},c.getBossCardLevelFight=function(e,t){void 0===t&&(t=!1);var i=0;return""!=Bt.MODEL.attrs(e)&&(i+=RR.getFight(JSON.parse(Bt.MODEL.attrs(e)))*(t?3:gR.ins.actorList.length)),""!=Bt.MODEL.zhanAttrs(e)&&(i+=RR.getFight(JSON.parse(Bt.MODEL.zhanAttrs(e)))),""!=Bt.MODEL.faAttrs(e)&&(i+=RR.getFight(JSON.parse(Bt.MODEL.faAttrs(e)))),""!=Bt.MODEL.daoAttrs(e)&&(i+=RR.getFight(JSON.parse(Bt.MODEL.daoAttrs(e)))),i},c.getSuitTotalByType=function(e){Object;for(var t,i=0;i<Vt.count;i++)if(Vt.MODEL.type(i)==e&&(t=String(Vt.MODEL.cardSuitNum(i)).split(","),0==parseInt(t[1])))return{key:Vt.MODEL.key(i),suitNum:parseInt(t[0]),suitAttr:Vt.MODEL.attrs(i)};return null},c.getSuitActiveNumByType=function(e){var t=0;if(!c.activeHash)return t;var i,n=0;for(var s in c.activeHash.proto)i=c.activeHash.proto[s],n=Bt.getIndex(i),Bt.MODEL.type(n)==e&&t++;return t},c.getSuitListByType=function(e){for(var t=[],i=0;i<Vt.count;i++)Vt.MODEL.type(i)==e&&t.push({id:Vt.MODEL.key(i),type:Vt.MODEL.type(i),suitLevel:Vt.MODEL.suitLevel(i),cardSuitNum:Vt.MODEL.cardSuitNum(i),attrs:Vt.MODEL.attrs(i),zhanAttrs:Vt.MODEL.zhanAttrs(i),faAttrs:Vt.MODEL.faAttrs(i),daoAttrs:Vt.MODEL.daoAttrs(i)});return t},c.getSuitTotalFight=function(){for(var e,t=0,i=0,n=0;n<c.typeList.length;n++){e=c.getSuitListByType(c.typeList[n]),i=c.getSuitActiveNumByType(c.typeList[n]);for(var s=0;s<e.length;s++){var o=e[s].cardSuitNum.split(",");if(0<parseInt(o[1])){if(i>=parseInt(o[0])&&i<=parseInt(o[1])){""!=e[s].attrs&&(t+=RR.getFight(e[s].attrs)*gR.ins.actorList.length),""!=e[s].zhanAttrs&&(t+=RR.getFight(e[s].zhanAttrs)),""!=e[s].faAttrs&&(t+=RR.getFight(e[s].faAttrs)),""!=e[s].daoAttrs&&(t+=RR.getFight(e[s].daoAttrs));break}}else if(i>=parseInt(o[0])){t+=RR.getFight(e[s].attrs);break}}}return t},c.getSuitNameByType=function(e){for(var t=0;t<Vt.count;t++)if(Vt.MODEL.type(t)==e)return Vt.MODEL.suitName(t);return""},c.getResolvelist=function(){for(var e=[],t=0;t<Ht.count;t++)0<TR.ins.getGoodsNum(Ht.MODEL.key(t))&&c.getCardsResolveActive(Ht.MODEL.key(t))&&e.push({gid:Ht.MODEL.key(t),cardExp:Ht.MODEL.cardExp(t)});return e},c.getCardsListByType=function(e){for(var t=[],i=0;i<Bt.count;i++)Bt.MODEL.type(i)==e&&0==Bt.MODEL.level(i)&&t.push(Bt.MODEL.key(i));return t},c.getCardsActive=function(e){if(e&&0<e.length)for(var t,i=0,n=0,s=!1,o=0;o<e.length;o++)if(i=Bt.getIndex(e[o]),n=modules.achievenew.others.TujianDataModel.getCardsLevel(Bt.MODEL.type(i),Bt.MODEL.index(i)),t=JSON.parse(Bt.MODEL.goodsComsumption(i)),s=TR.ins.getGoodsNum(parseInt(t[0].value.toString().split(":")[0]))>=parseInt(t[0].value.toString().split(":")[1]),-1==n&&s)return o;return 0},c.getCardsLevel=function(e,t){for(var i=0;i<Bt.count;i++)if(Bt.MODEL.type(i)==e&&Bt.MODEL.index(i)==t&&c.activeHash&&c.activeHash.take(Bt.MODEL.key(i)))return Bt.MODEL.key(i);return-1},c.getRoleCard=function(){for(var e=0,t=0,i=0;i<Bt.count;i++)if(""!=Bt.MODEL.goodsComsumption(i)&&(e=JSON.parse(Bt.MODEL.goodsComsumption(i)),t=parseInt(e[0].value.toString().split(":")[0]),c.getIsSpecialCard(t)&&-1==c.getCardsLevel(Bt.MODEL.type(i),Bt.MODEL.index(i))))return!1;return!0},c.getTujianRed=function(){return!!c.getRedResolve()||!!c.getRedByTypeList(c.typeList.slice(0,c.typeList.length))},c.getRedResolve=function(){for(var e=0;e<Ht.count;e++)if(0<TR.ins.getGoodsNum(Ht.MODEL.key(e))&&c.getCardsResolveActive(Ht.MODEL.key(e)))return!0;return!1},c.getCardsResolveActive=function(e){var t=[],i=0;for(i=0;i<Bt.count;i++)if(""!=Bt.MODEL.goodsComsumption(i)){var n=JSON.parse(Bt.MODEL.goodsComsumption(i));parseInt(n[0].value.toString().split(":")[0])==e&&t.push({gid:e,type:Bt.MODEL.type(i),index:Bt.MODEL.index(i)})}if(t.length<1)return!1;for(i=0;i<t.length;i++)if(!c.getJudgeActive(t[i].type,t[i].index))return!1;return!0},c.getRedByType=function(e){for(var t=0;t<Bt.count;t++)if(Bt.MODEL.type(t)==e)if(c.getJudgeActive(Bt.MODEL.type(t),Bt.MODEL.index(t))){var i=c.getJudgeActiveExp(Bt.MODEL.type(t),Bt.MODEL.index(t));if(0<i&&i<=c.curExp)return!0}else if(""!=Bt.MODEL.goodsComsumption(t)){var n=JSON.parse(Bt.MODEL.goodsComsumption(t)),s=parseInt(n[0].value.toString().split(":")[0]),o=parseInt(n[0].value.toString().split(":")[1]);if(TR.ins.getGoodsNum(s)>=o&&c.getRedByRole(t))return!0}return!1},c.getRedByRole=function(e){return""!=Bt.MODEL.zhanAttrs(e)?!!gR.ins.actorByJob(1):""!=Bt.MODEL.faAttrs(e)?!!gR.ins.actorByJob(2):""==Bt.MODEL.daoAttrs(e)||!!gR.ins.actorByJob(3)},c.getRedByRoleName=function(e){return""!=Bt.MODEL.zhanAttrs(e)?"战士":""!=Bt.MODEL.faAttrs(e)?"法师":""!=Bt.MODEL.daoAttrs(e)?"道士":""},c.getJudgeActive=function(e,t){if(!c.activeHash)return!1;var i,n=0;for(var s in c.activeHash.proto)if(i=c.activeHash.proto[s],n=Bt.getIndex(i),Bt.MODEL.type(n)==e&&Bt.MODEL.index(n)==t)return!0;return!1},c.getJudgeActiveExp=function(e,t){if(!c.activeHash)return 0;var i,n=0;for(var s in c.activeHash.proto)if(i=c.activeHash.proto[s],n=Bt.getIndex(i),Bt.MODEL.type(n)==e&&Bt.MODEL.index(n)==t)return Bt.MODEL.levelUpCardExp(n);return 0},c.getRedByTypeList=function(e){if(!e||e.length<1)return!1;for(var t=0;t<e.length;t++)if(c.getRedByType(e[t]))return!0;return!1},c.refreshRedPoint=function(){Tu.sendToModule("UPDATE_TUJIAN_REDPOINT",["modules.achievenew.AchieveNewModule"])},c.getAttrsByIndex=function(e){var t=0,i=[],n=[],s=[];Bt.MODEL.attrs(e)&&(s=aa.formatAttrToChineseByList(Bt.MODEL.attrs(e),!1,!0));var o,a=[];for(t=0;t<s.length;t++)-1<c.spe_id.indexOf(s[t].id)?a.push(s[t]):i.push({addName:s[t].addName,val:s[t].val});n=c.setNormAttr(a);var r=[],l=[];return""!=Bt.MODEL.zhanAttrs(e)&&(r=aa.formatAttrToChineseByList(Bt.MODEL.zhanAttrs(e)),l=c.getSpAttr(r),o=c.getJobAttrs(l[0],1),0<l[1].length&&(n=c.setSpAttr(l[1],1))),""!=Bt.MODEL.faAttrs(e)&&(r=aa.formatAttrToChineseByList(Bt.MODEL.faAttrs(e)),l=c.getSpAttr(r),o=c.getJobAttrs(l[0],2),0<l[1].length&&(n=c.setSpAttr(l[1],2))),""!=Bt.MODEL.daoAttrs(e)&&(r=aa.formatAttrToChineseByList(Bt.MODEL.daoAttrs(e)),l=c.getSpAttr(r),o=c.getJobAttrs(l[0],3),0<l[1].length&&(n=c.setSpAttr(l[1],3))),o&&0<o.length&&(i=0<i.length?i.concat(o):o.slice(0,o.length)),{attrN:i,attrS:n}},c.getJobAttrs=function(e,t,i){void 0===i&&(i=!1);for(var n=[],s=0;s<e.length;s++)n.push({addName:ha.getDesByType(t)+e[s].addName,val:i?0:e[s].val});return n},c.getSpecialName=function(e,t){switch(e){case 310:return RP.n[10];case 311:return RP.n[11];case 230:case 227:return RP.n[12];default:return RP.n[13]+t}return""},c.getSpAttr=function(e){var t=0,i=[],n=[],s=[];for(t=0;t<e.length;t++)-1<c.spe_id.indexOf(e[t].id)?s.push(e[t]):n.push(e[t]);return i[0]=n,i[1]=s,i},c.setSpAttr=function(e,t){var i=[],n="";1==t?n="战士":2==t?n="法师":3==t&&(n="道士");for(var s=0;s<e.length;s++)n+=c.getSpecialNameByJob(e[s].id);return n=n.replace(RP.n[14],"防御"),n+="加成",i.push({addName:n,val:e[0].val}),i},c.getSpecialNameByJob=function(e){switch(e){case 212:return"血量";case 224:return"攻击";case 227:return"物防";case 230:return"魔防"}return""},c.setNormAttr=function(e){var t=[];if(0<e.length){for(var i=e.length,n=RP.n[15],s=0;s<e.length;s++)1<i?n+=c.getSpecialNameByJob(e[s].id):n=c.getSpecialName(e[s].id,e[s].addName);n=n.replace(RP.n[16],"防御").replace("加成",""),n+="加成",t.push({addName:n,val:e[0].val})}return t},c.getCardInfoByGoodId=function(e){for(var t,i=0;i<Bt.count;i++)if(""!=Bt.MODEL.goodsComsumption(i)&&(t=JSON.parse(Bt.MODEL.goodsComsumption(i)),parseInt(t[0].value.toString().split(":")[0])==e))return i;return-1},c.getIsSpecialCard=function(e){return-1!=ca.TUJIAN_CARD.indexOf(e)},c.getIsSpecialCard1=function(e){return-1!=ca.TUJIAN_CARD_1.indexOf(e)},c.runRespComplete=function(){c.respHandler&&(c.respHandler.run(),c.respHandler.clear(),c.respHandler=null)},c.reqTujianInfo=function(e){c.respHandler=e;var t=new SD;Tu.sendToService(t)},c.reqTujianActive=function(e){c.activeiObj=e;var t=new kD;t.tid=e.cid,Tu.sendToService(t)},c.reqTujianResolve=function(e){var t=new ED;t.size=e.length,t.resolveList=e,Tu.sendToService(t)},c.EFF_ACTIVE="jm1247",c.EFF_LEVELUP="jm1245",c.EFF_LINK="jm1130",c.cardsTypeList=null,c.selectType=1,c.activeHash=null,c.curExp=0,c.addExp=0,c.activeiObj=null,c.respHandler=null,f(c,["spe_id",function(){return this.spe_id=[310,311,212,253,224,230,227]}]),c}(),XP=function(){function e(){this._giftArr=null,this._isAllGet=!1,this._isHasBuy=!1,this._currentLevel=0,this.level=0,this._giftArr=[]}b(e,"modules.activity.others.ActivityHeFuChargeProfitVo");var t=e.prototype;return t.pushGift=function(e){this._giftArr.push(e)},p(0,t,"currentLevel",function(){var e;for(var t in this._giftArr)return e=this._giftArr[t],parseInt(St.MODEL.targetParam2(e.index));return this._currentLevel}),p(0,t,"isAllGet",function(){this._isAllGet=!1;for(var e=0,t=0;t<this._giftArr.length;t++)2<=this._giftArr[t].status&&e++;return 0!=e&&e==this._giftArr.length||this._isAllGet}),p(0,t,"isHasBuy",function(){this._isHasBuy=!1;for(var e=0;e<this._giftArr.length;e++)if(1==this._giftArr[e].status)return!0;return this._isHasBuy}),p(0,t,"giftArr",function(){return this._giftArr}),p(0,t,"ownActivity",function(){return 0<this._giftArr.length?this._giftArr[0].owerActivity:0}),e}(),QP=function(){function n(){this._currentGiftID=0,this.currentGiftResourceID=0,this.currentGiftNumID=0,this._selectId=-1,this.currentSelectedLevel=-1,this._currentVipStatuArr=null,this.isClickedBack=!1,this.needToShowVIPTip=!0,this.needToShowWelfareTip=!0}b(n,"modules.activity.others.ActivityHeFuDataModel");var e=n.prototype;return e.initStatuVo=function(){for(var e,t=0,i=0;i<Yg.count;i++)t=Yg.MODEL.giftId(i),null==this.getCurrentStatueVoByGiftID(t)&&((e=new _).giftID=t,this._currentVipStatuArr.push(e))},e.update30732=function(e){var t=this;t._currentGiftID=e.giftID,null==t._currentVipStatuArr&&(t._currentVipStatuArr=[],t.initStatuVo());var i,n,s=e.voArr.slice();for(var o in s)i=s[o],t.getCurrentStatueVoByGiftID(i.giftID).updateVO(i);for(var a in t._currentVipStatuArr)if((n=t._currentVipStatuArr[a]).giftID==t._currentGiftID){t.currentGiftResourceID=n.resourceID,t.currentGiftNumID=n.numID;break}},e.getCurrentStatueVoByGiftID=function(e){var t;if(null==this._currentVipStatuArr||0==this._currentVipStatuArr.length)return null;for(var i in this._currentVipStatuArr)if((t=this._currentVipStatuArr[i]).giftID==e)return t;return null},p(0,e,"currentVipStatuArr",function(){return this._currentVipStatuArr}),p(0,e,"selectId",function(){return this._selectId},function(e){this._selectId=e}),p(1,n,"ins",function(){return null==n._instance&&(n._instance=new n),n._instance}),n.getClass=function(e){switch(e){case 18:return pz;case 19:return J1;case 20:return t2;case 21:return hz;case 22:return Z1;case 6:return Q1;case 7:case 23:return K1;case 24:return fz;case 10:return $1;case 8:return a2}return null},n.getSoluLevel=function(e){var t=Math.floor(e/11),i=e-11*t-1;return i<0&&(i=0),t+1+"阶"+i+"星"},n.goToLink=function(e){if(e&&""!=e){var t=e.split("|");if(gR.ins.lv<parseInt(t[0]))zB.ins.showMsg(RP.n[17]+t[0]+"级开启",1);else if("PLAY_UPGRADE_DIRECTION"==t[1])gR.ins.lv<80?hN.ins.open(t[1]):hN.ins.open("ACTOR_M",{_subIndex_:"1"},null,!0);else if("SOULOUT_V"==t[1])if(aB.isActiveSoul)if(0<xv.count)n.initSoulLink();else{var i=[{url:_r.getJxrDBPath("YuanGodActive"),type:"arraybuffer",cls:xv}];uc.ins().onLoadJxrs(i,ql.create(null,n.initSoulLink))}else zB.ins.showById(3971,1);else hN.ins.open(t[1],{_subIndex_:t[2]},null,!0)}},n.initSoulLink=function(){WB.reqSoulInfo(),G.timer.once(100,null,n.doSomething)},n.doSomething=function(){Vf.instance.checkOut()?hN.ins.open("SOULOUT_V",null,0):Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]),G.timer.clear(null,n.doSomething)},n.sortArray=function(e,t){var i=0,n=0;if((i=0==e.status?3:1==e.status?1:5)==(n=0==t.status?3:1==t.status?1:5)){if(e.hasOwnProperty("giftId"))return e.giftId-t.giftId;if(e.hasOwnProperty("id"))return e.id-t.id}return i-n},n.A_ID_1057=1057,n._instance=null,f(n,["IS_HIDE_BG",function(){return this.IS_HIDE_BG=[18,20,21]}]),n}(),JP=function(){function n(){this.actType=0,this.isLinkToView=0,this.isActToView=!1,this.firstArr=[]}return b(n,"modules.activity.others.A_OsDataModel"),n.prototype.setBargainIds=function(){if(0!=It.count){n.A_BARGAIN_ID_ARR=[],n.A_PLANT_ID_ARR=[];for(var e=0;e<It.count;e++)34==It.MODEL.uiType(e)&&n.A_BARGAIN_ID_ARR.push(It.MODEL.key(e)),40==It.MODEL.uiType(e)&&n.A_PLANT_ID_ARR.push(It.MODEL.key(e))}else{var t=[{url:_r.getJxrDBPath("ConfigActivity"),type:"arraybuffer",cls:It}];uc.ins().onLoadJxrs(t,ql.create(this,this.setBargainIds))}},p(1,n,"c_mainType",function(){return n._c_mainType},function(e){n._c_mainType=e}),p(1,n,"ins",function(){return null==n._instance&&(n._instance=new n),n._instance}),p(1,n,"sub_limitBuy",function(){return 7<dr.getOpenServiceDay()?0:1}),n.getClass=function(e){switch(e){case 2:return Az;case 3:return d2;case 4:return c2;case 5:return I2;case 6:return o2;case 7:return l2;case 8:return a2;case 9:return m2;case 10:return g2;case 11:return s2;case 12:return p2;case 13:return i2;case 14:return v2;case 15:return f2;case 16:return n2;case 17:return Lz;case 18:return D2;case 19:return M2;case 20:return N2;case 21:return C2;case 22:return A2;case 23:return b2;case 24:return _2;case 25:return h2;case 26:return t2;case 27:return E2;case 28:return k2;case 29:return X1;case 30:return Iz;case 31:return K1;case 32:return hz;case 33:return L2;case 34:return T2;case 35:return RK;case 36:return e2;case 37:return y2;case 40:return R2;case 41:return O2;case 42:return P2;case 43:return u2;case 60:return r2;case 61:return vz;case 101:return x2;case 102:return S2;case 103:return w2}return null},n.getWordsByRtype=function(e){return""},n.sortArray=function(e,t){var i=0,n=0;if((i=0==e.status?3:1==e.status?1:5)==(n=0==t.status?3:1==t.status?1:5)){if(e.hasOwnProperty("giftId"))return e.giftId-t.giftId;if(e.hasOwnProperty("id"))return e.id-t.id}return i-n},n.getListById=function(e){for(var t=[],i=0;i<St.count;++i)if(St.MODEL.activityId(i)==e){var n=new SH;n.giftId=St.MODEL.key(i),t.push(n)}return be.sortOn(t,["rankTarget"],Array.NUMERIC),t},n.getExchangeData=function(e){for(var t,i=[],n=0;n<xa.count;n++)if(xa.MODEL.type(n)==e){(t=new xg).exChangeId=xa.MODEL.key(n);var s=JSON.parse(xa.MODEL.consumption(n)),o=s[0].value.split(":");t.costId=o[0],t.costCount=parseInt(o[1]);var a=(s=JSON.parse(xa.MODEL.reward(n)))[0].value.split(":");t.targetId=parseInt(a[0]),i.push(t)}return i},n.getMissionScoreData=function(){for(var e,t=[],i=0;i<xa.count;i++)if("SERVEN_DAY_INTEGRAL"==xa.MODEL.type(i)){e=null;var n=[];(e=new xg).exChangeId=xa.MODEL.key(i);var s=JSON.parse(xa.MODEL.consumption(i)),o=s[0].value.split(":");e.costId=o[0],e.costCount=parseInt(o[1]);for(var a=(s=JSON.parse(xa.MODEL.reward(i))).length,r=0;r<a;r++){var l=yh.copyObjFast(e),c=s[r].value.split(":");l.targetId=parseInt(c[0]),l.num=parseInt(c[1]),n.push(l)}t.push(n)}return t},n.getIsRedPt=function(e){for(var t=0,i=modules.activity.others.A_OsDataModel.getExchangeData("BOSS_EXCHANGE"),n=0;n<i.length;n++)if(e.scoreObj.score>=i[n].costCount&&(t=e.scoreObj.exchange.take(i[n].exChangeId)?e.scoreObj.exchange.take(i[n].exChangeId):0,0<(e.scoreObj.limit.take(i[n].exChangeId)?e.scoreObj.limit.take(i[n].exChangeId):0)-t))return!0;return!1},n.getIsRedPtSoul=function(e){if(e.soulObj.enterTime>=e.soulObj.totalTime)return!1;var t=St.getIndex(e.giftId);return!(gR.ins.YB<St.MODEL.costGold(t))},n.closeAosPanel=function(){hN.ins.isOpen("OPENSERVER")&&hN.ins.close("OPENSERVER")},n.closeAdailyPanel=function(){hN.ins.isOpen("DAILY_ACTIVITY")&&hN.ins.close("DAILY_ACTIVITY")},n.isEqual=function(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e.indexOf(t[i])<0)return!1;return!0},n.getSoluLevel=function(e){var t=Math.floor(e/11),i=e-11*t-1;return i<0&&(i=0),t+1+"阶"+i+"星"},n.goToLink=function(e){if(e&&""!=e){var t=e.split("|");if(gR.ins.lv<parseInt(t[0]))zB.ins.showMsg(RP.n[17]+t[0]+"级开启",1);else if("PLAY_UPGRADE_DIRECTION"==t[1])gR.ins.lv<80?hN.ins.open(t[1]):hN.ins.open("ACTOR_M",{_subIndex_:"1"},null,!0);else if("SOULOUT_V"==t[1])if(aB.isActiveSoul)if(0<xv.count)n.initSoulLink();else{var i=[{url:_r.getJxrDBPath("YuanGodActive"),type:"arraybuffer",cls:xv}];uc.ins().onLoadJxrs(i,ql.create(null,n.initSoulLink))}else zB.ins.showById(3971,1);else"OPEN_FEST_ENTER_PANEL"==t[1]?Tu.sendToModule("OPEN_FEST_ENTER_PANEL",["modules.activity.ActivityModule"],$P.ins.actId):hN.ins.open(t[1],{_subIndex_:t[2]},0,!0)}},n.initSoulLink=function(){WB.reqSoulInfo(),G.timer.once(100,null,n.doSomething)},n.doSomething=function(){Vf.instance.checkOut()?hN.ins.open("SOULOUT_V",null,0):Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]),G.timer.clear(null,n.doSomething)},n.praseGoodsStr=function(e){var t=[];if(e&&""!=e&&"0"!=e){var i=e.split(";");for(var n in i){var s=i[n].split(",");if(!s[2]||0==parseInt(s[2])||gR.ins.actorList[0].job==parseInt(s[2])){var o=yB.create(s[0],s[1]);o&&t.push(o)}}}return t},n.M_GRIDE_NAME="A_DAILY__GOODS",n.gnameFont="20px SimHei",n._c_mainType=0,n.pickLevel=0,n.selectId=0,n.lotId=0,n.investHash=null,n.investSerid=-1,n.isPlaying=!1,n.isShowFireTips=!1,n.g_eff_gold="jm1226",n.A_ID_1048=1048,n.A_ID_1051=1051,n.A_ID_1042=1042,n.A_ID_1053=1053,n.A_ID_1057=1057,n.A_ID_1001=1001,n.A_ID_1177=1177,n.A_BARGAIN_ID_ARR=[],n.A_PLANT_ID_ARR=[],n.TYPE_EX_BOSS="BOSS_EXCHANGE",n.TYPE_EX_QRKH="SERVEN_DAY_INTEGRAL",n._instance=null,n.openIndex=-1,f(n,["A_GIFT_ID_ARR",function(){return this.A_GIFT_ID_ARR=[10016,10015]},"A_GIFT_ID_HASH",function(){return this.A_GIFT_ID_HASH=new jl},"IS_HIDE_BG",function(){return this.IS_HIDE_BG=[2,3,4,12,17,21,22,61]}]),n}(),ZP=function(){function o(){}return b(o,"modules.activity.others.A_SpBargainDataModel"),p(1,o,"cutUseGoodsLimit",function(){return bn.MODEL.cutUseGoodsLimit(o.index)}),p(1,o,"index",function(){return bn.getIndex(1)}),p(1,o,"consumDef",function(){if(0!=o._consumDef)return o._consumDef;var e=JSON.parse(bn.MODEL.consumDef(o.index))[0].value.split(":");return parseInt(e[0])}),p(1,o,"isHasBuyNums",function(){if(!o.actInfo||!o.actInfo.gifts)return!1;for(var e=o.actInfo.gifts.concat(),t=0;t<e.length;t++)if(e[t]&&e[t].perBuyNum<e[t].personalLimit)return!0;return!1}),p(1,o,"giftNumLimit",function(){return bn.MODEL.giftNumLimit(o.index)}),p(1,o,"callCutLimit",function(){return bn.MODEL.callGuilderCutLimit(o.index)}),p(1,o,"allBargainNum",function(){return bn.MODEL.helpGuilderCutLimit(o.index)}),p(1,o,"bargainTabRedPt",function(){return!!o.bargainList&&(!!o.isHasBuyNums&&(o.bargainList.length<o.giftNumLimit||o.getRateRedPt()))}),o.getBargainInfo=function(e){if(!o.bargainList||o.bargainList.length<0)return null;for(var t=0;t<o.bargainList.length;t++)if(e==o.bargainList[t].giftId)return o.bargainList[t];return null},o.resetBargainInfo=function(e,t){if(o.bargainList&&!(o.bargainList.length<0))for(var i=0;i<o.bargainList.length;i++)if(e==o.bargainList[i].giftId){o.bargainList[i].cdTime=t;break}},o.getSelectIndex=function(e){if(!o.bargainList||o.bargainList.length<1)return 0;for(var t=0;t<o.bargainList.length;t++)if(e==o.bargainList[t].giftId)return t;return 0},o.reqBargainInfo=function(e){var t=new HO;Tu.sendToService(t),o.getHandler=e},o.reqFriendsHand=function(e,t){var i=new GO;i.giftId=e,Tu.sendToService(i),o.friend_gid=e,o.getHandler=t},o.reqBargain=function(e,t,i,n){void 0===i&&(i=0);var s=new VO;s.giftId=e,s.bType=i,s.playerId=t,Tu.sendToService(s),o.getHandler=n},o.reqGuildBList=function(){var e=new UO;Tu.sendToService(e)},o.runComplete=function(){o.getHandler&&(o.getHandler.run(),o.getHandler.clear(),o.getHandler=null)},o.getRateRedPt=function(){if(!o.bargainList||o.bargainList.length<1)return!1;for(var e=0;e<o.bargainList.length;e++)if(o.bargainList[e]&&o.getBargainRedPt(o.bargainList[e].giftId))return!0;return!1},o.getBargainRedPt=function(e){var t=o.getBargainInfo(e);if(!t)return!1;if(t.playerList.length<=0)return!0;if(1==o.handRedPt)return!0;var i=zi.getIndex(e),n=parseInt(zi.MODEL.oriCostGold(i).split(":")[1]),s=parseInt(zi.MODEL.actCostGold(i).split(":")[1]);return Math.max(n-s-t.cutPrice,0)<=0||(0<TR.ins.getGoodsNum(o.consumDef)&&0<o.cutUseGoodsLimit-o.useTimes||0==t.cdTime&&0<o.callCutLimit-t.handNum)},o.sortArray=function(e,t){var i,n;return(i=e.gvo.perBuyNum>=e.gvo.personalLimit?5:3)==(n=t.gvo.perBuyNum>=t.gvo.personalLimit?5:3)?-(t.gvo.giftId-e.gvo.giftId):i-n},o.CUT_TYPE_0=0,o.CUT_TYPE_1=1,o.CUT_TYPE_2=2,o.CUT_TYPE_3=3,o.handRedPt=0,o.bargainNum=0,o.useTimes=0,o.bargainList=null,o.gid_select=0,o.friend_gid=0,o._consumDef=0,o.getHandler=null,o.isFrtRedPt=!0,o.actInfo=null,o}(),KP=function(){function e(){}b(e,"modules.activity.others.A_TaskLinkModel");var t=e.prototype;return t.goToLink=function(e){var t=Ut.getIndex(e),i=Ut.MODEL.taskGo(t),n=i.indexOf("#"),s=parseInt(i.substring(0,n)),o=(i=i.substring(n+1)).split("|");if(1==s){if(WR.ins.checkPlayerInCopy())return void zB.ins.showMsg(RP.n[19],1);if(WR.ins.checkPlayerInTeam())return void Tu.sendToModule("OPEN_TEAM_COPY_EXIT",["modules.copy.CopyModule"],{tips:"跳转将退出队伍，确认退出？"});var a=parseInt(o[0]),r=2<=o.length?{_subIndex_:parseInt(o[1])}:null;if(!GR.getInstance().checkModuleOpen(a))return void zB.ins.showMsg(RP.n[20],1);switch(a){case 1:break;case 2:hN.ins.open("GUILD_STORE_MAINVIEW",r);break;case 3:var l=parseInt(o[1]),c=rn.getIndex(l),u=rn.MODEL.cate(c);3==u?hN.ins.open("BOSS_MAINVIEW",{_subIndex_:1}):49==u&&hN.ins.open("BOSS_MAINVIEW",{_subIndex_:1});break;case 27:case 28:case 29:hN.ins.open("TREASURE_VIEW",r);break;case 53:hN.ins.open("TR_MYSTICAL_VIEW",r);break;case 35:hN.ins.open("MONTHCARD",{selectedIndex:parseInt(o[1])},0);break;case 37:case 38:hN.ins.open("MAGIC_VIEW",{_subIndex_:parseInt(o[1])},null,!0);break;case 40:hN.ins.open("AUCTION_MAIN",{__subIndex_:parseInt(o[1])},null,!0);break;case 45:hN.ins.open("MALL_PANEL",{__subIndex_:parseInt(o[1])},null,!0);break;case 43:hN.ins.open("SOARING_VIEW",{__subIndex_:parseInt(o[1])},null,!0);break;case 47:if(2==HN.ins.toc_recharge.canGet)return void zB.ins.showMsg(RP.n[21],1);hN.ins.open("FIRST_RECHARGE");break;case 48:hN.ins.open("BOSS_MAINVIEW",{_subIndex_:parseInt(o[1])},null,!0);break;case 49:Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]);break;case 50:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:1});break;case 26:parseInt($e.MODEL.value($e.getIndex(158)))>aB.instance.activedRingId?zB.ins.showById(3971,1):Vf.instance.checkOut()?hN.ins.open("SOULOUT_V",null,0):Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]);break;case 24:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:2});break;case 51:2==HN.ins.toc_recharge.canGet?hN.ins.open("EVERY_RECHARGE"):hN.ins.open("FIRST_RECHARGE");break;case 52:var d=PH.Ins().info;if(!(!!d&&10010<=d.taskId))return void zB.ins.playErrorMsg(RP.n[22]);var h=!1;if(dr.dtoEnterScene&&43==dr.dtoEnterScene.type&&(h=!0),h)return void zB.ins.playErrorMsg(RP.n[23]);Tu.sendToModule("OPEN_LIMIT_CHALLENGE_MAIN",["modules.limitChallenge.LimitChallengeModule"],{subIndex:parseInt(o[1])});break;case 62:WR.ins.checkSelfHasTeam()?zB.ins.showById(4386,1):Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:3});break;case 58:CN.dealActIcon(CN.getIconBtn(51));break;case 57:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:3});break;case 64:eU.toSelectIndex=parseInt(o[1]),CN.dealActIcon(CN.getIconBtn(62));break;case 65:hN.ins.open("TR_HEFU_VIEW",r);break;case 70:Tu.sendToModule("OPEN_MATERIAL",["modules.copy.CopyModule"],{selectedIndex:o[1]});break;case 71:hN.ins.close("OPENSERVER");var _=parseInt($e.MODEL.value($e.getIndex(106)));if(gR.ins.lv<_)return void zB.ins.playErrorMsg(_+RP.n[24]);dr.dtoEnterScene=null;var f=uH.Ins().prveCid=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"";NF.Ins().changeScene(f,!0,ql.create(aF,aF.onReadForYeZhanHandler)),sH.getInstance().autoMode=!0,eB.getInstance().resetAllSkillCd();break;case 22:hN.ins.open("COPYMAINVIEW",{_subIndex_:2});break;case 8:Tu.sendToModule("OPEN_SPORTS_VIEW",["modules.digger.DiggerModule"]);break;case 69:this.setTeHuiLink(o);break;case 18:hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(o[1])});break;case 85:vN.ins.joinGuild?hN.ins.open("GUILD_BOSS_MAINVIEW",null,0):hN.ins.open("GUILD_LIST_VIEW");break;case 19:Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"]);break;case 68:Tu.sendToModule("CROSSBATTLREQDATA",["modules.corssbattle.CrossBattleModule"])}}},t.setTeHuiLink=function(e){if(e&&!(e.length<1))if(1<e.length&&(eU.toSelectIndex=parseInt(e[1])),0<Et.count)this.onJxrComplete(e[2]);else{var t=[{url:_r.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:Et}];uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete,[e[2]]))}},t.onJxrComplete=function(e){for(var t=0,i=0;i<Et.count;i++)if(e==Et.MODEL.mainType(i)){t=Et.MODEL.key(i);break}CN.dealActIcon(CN.getIconBtn(t))},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}(),$P=function(){function e(){this.toc21272=null,this.gwNums=0,this.toc25007=null,this.copyHurtList=[],this.gwTotal=0,this.actId=0,this.iconId=0}return b(e,"modules.activity.others.FestivalBossData"),e.prototype.reqFestBossGUWU=function(e){var t=new MA;t.missionId=e,Tu.sendToService(t)},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}(),eR=function(){function e(){this.toc39013=null,this.toc31061=null,this.curRid=0,this._wxShareInfos,this.toc39013=new oL,this.toc31061=new zC}b(e,"modules.activityDaily.others.DailyDataModel");var t=e.prototype;return t.updateWxShareInfo=function(e){this._wxShareInfos||this.initWxShareInfo();var t=e.infos;for(var i=0 in t){var n=this._wxShareInfos[i];n&&(n.peopleNum=t[i].peopleNum,n.leftTimes=t[i].leftRwdTimes)}},t.getRedShare=function(e){for(var t=0 in this._wxShareInfos){var i=this._wxShareInfos[t];if(i.type==e&&i.leftTimes+i.peopleNum>i.maxTimes&&1<=i.leftTimes)return!0}return!1},t.getWXShare=function(){for(var e=2;e<=wo.count;e++)if(modules.activityDaily.others.DailyDataModel.ins.toc39013.curShareCount<wo.MODEL.needShareCount(wo.getIndex(e)));else if(!(modules.activityDaily.others.DailyDataModel.ins.toc39013.rewardArr&&0<=modules.activityDaily.others.DailyDataModel.ins.toc39013.rewardArr.indexOf(e)))return!0;return!1},t.initWxShareInfo=function(){this._wxShareInfos={};for(var e=0;e<Ro.count;e++){var t=Ro.MODEL.key(e),i=Ro.MODEL.type(e),n=Ro.MODEL.condition(e),s=Ro.MODEL.recieveLimit(e),o=Ro.MODEL.reward(e);this._wxShareInfos[t]={id:t,type:i,condition:n,leftTimes:s,maxTimes:s,rewards:o,peopleNum:0}}},t.getRWT=function(e){for(var t=0;t<this.toc31061.len;t++)if(e==this.toc31061.reward[t].rid)return this.toc31061.reward[t].times;return 0},t.getRecGiftIdx=function(e){var t=[];if(0<Ln.count&&0<An.count)for(var i=0;i<An.count;i++){var n=An.MODEL.rechargeId(i),s=Ln.getIndex(n);Ln.MODEL.type(s)==e&&t.push(i)}return t},p(0,t,"wxShareInfos",function(){return this._wxShareInfos||this.initWxShareInfo(),this._wxShareInfos}),p(1,e,"ins",function(){return e._instance||(e._instance=new e),e._instance}),e._instance=null,e.WX_SHARE_T="WX_SHARE",e.WX_SHARE_LV="WX_SHARE_LEVEL",e.WX_SHARE_VIP="WX_SHARE_VIP",e}(),tR=function(){function i(e){var t=this;t.id=0,t.job=0,t.objectId=0,t.sex=0,t.isDeath=0,t.wingData=null,t.jmCfgId=0,t.mbCfgId=0,t.hsCfgId=0,t.xzCfgId=0,t.dpCfgId=0,t.hsAdvCfgId=0,t.mbAdvCfgId=0,t.strengthTotalLv=0,t.stoneTotalLv=0,t.spriteTotalLv=0,t.equips=null,t.titles=[],t.mid="1001",t.wid="wwx001",t.wgid="",t.weaponSoulId="",t.chuanshiId="",t.magicId="",t.hyCfgId=0,t.hyAdvCfgId=0,t.sjCfgId=0,t.sjAdvCfgId=0,t.luckyNormal=0,t.luckyThunder=0,t.luckyPassSuit=0,t.shenliRingLv=0,t.fuhuoRingLv=0,t.dragonEff="",t.force=0,t.currHP=0,t.currMP=0,t.currHD=0,t.attrHash=null,t._isInitHD=!1,t.qhCfgId=0,t.niepanlevel=0,t.id=e,t.attrHash=new jl,t.wingData=new xR,t.equips=new DR(1,116,"EQUIP_DRESS","EQUIP_UPDATE",null),t.equips.crossNotify=!1,t.equips.forceNotify=!0}b(i,"modules.actor.others.ActorData");var e=i.prototype;return e.getAttrValWordById=function(e,t){void 0===t&&(t=!1);var i=0,n=aa.getAttributById(e);return t&&e==aa.CRI_QD_RATE.id&&(i=parseInt($e.MODEL.value($e.getIndex(169)))),this.attrHash.has(e)?(i+=this.attrHash.take(e),n.isPer?i/100+"%":i+""):0==i?"0":n.isPer?i/100+"%":i+""},e.setAttrById=function(e,t){var i=this;i.attrHash.put(e,t,!0),e==aa.MAXHP.id?(ZN.isEnabledChangeScene()&&(i.currHP=t),Tu.sendToModule("MAX_HP_CHANGE",["modules.scene.SceneModule"],e),Tu.sendToTotalModule("HP_CHANGE")):e==aa.MAXMP.id?(ZN.isEnabledChangeScene()&&(i.currMP=t),Tu.sendToModule("MAX_MP_CHANGE",["modules.scene.SceneModule"],e),Tu.sendToTotalModule("MP_CHANGE")):e==aa.MAXHD.id&&(ZN.isEnabledChangeScene()&&(i.currHD=t),i._isInitHD||(i.currHD=t),i._isInitHD=!0,Tu.sendToModule("MAX_HD_CHANGE",["modules.scene.SceneModule"],[i.objectId,i.currHD,i.maxHD]),Tu.sendToTotalModule("HD_CHANGE"))},e.getAttrById=function(e){return this.attrHash.has(e)?this.attrHash.take(e):0},e.update=function(e,t){var i=this;void 0===t&&(t=!1),t||(i.id=e.readByte()),i.job=e.readByte(),i.sex=e.readByte(),i.mid=e.readUTF(),i.wid=e.readUTF(),i.wgid=e.readUTF(),""==i.wgid&&(i.wgid="0");var n=e.readByte(),s=0;if(i.titles)for(s=0;s<n;s++)i.titles[s]=e.readShort();else for(i.titles=[],s=0;s<n;s++)i.titles.push(e.readShort());i.force=yt.readLong64(e),i.qhCfgId=e.readInt(),i.jmCfgId=e.readShort(),i.mbCfgId=e.readShort(),i.hsCfgId=e.readShort(),i.xzCfgId=e.readShort(),i.dpCfgId=e.readShort(),i.wingData.id=e.readShort(),i.wingData.curWingExp=yt.readLong64(e),i.wingData.wearStep=e.readShort(),i.hsAdvCfgId=e.readShort(),i.mbAdvCfgId=e.readShort();for(var o=e.readByte(),a=0,r=0,l=0;l<o;l++)a=e.readByte(),r=e.readInt(),i.attrHash.put(a,r,!0);i.setAttr(e),i.attrHash.has(aa.MAXHP.id)&&(i.currHP=i.attrHash.take(aa.MAXHP.id)),i.attrHash.has(aa.MAXMP.id)&&(i.currMP=i.attrHash.take(aa.MAXMP.id)),i.attrHash.has(aa.MAXHD.id)&&(i.currHD=i.attrHash.take(aa.MAXHD.id),Tu.sendToModule("MAX_HD_CHANGE",["modules.scene.SceneModule"],[i.objectId,i.currHD,i.maxHD]),Tu.sendToTotalModule("HD_CHANGE")),i.strengthTotalLv=e.readShort(),i.stoneTotalLv=e.readShort(),i.spriteTotalLv=e.readShort(),i.weaponSoulId=e.readUTF(),i.chuanshiId=e.readUTF(),i.dragonEff=e.readUTF(),i.hyCfgId=e.readShort(),i.hyAdvCfgId=e.readShort(),i.sjCfgId=e.readShort(),i.sjAdvCfgId=e.readShort(),i.magicId=e.readUTF(),i.niepanlevel=e.readInt()},e.setAttr=function(e){for(var t=e.readShort(),i=0,n=0,s=0;s<t;s++)i=e.readShort(),n=yt.readLong64(e),this.attrHash.put(i,n,!0)},e.changeAvatar=function(e,t,i,n,s,o){this.mid=e,this.wid=t,this.wgid=i,this.weaponSoulId=n,this.chuanshiId=s,this.magicId=o},e.getThunderNum=function(){for(var e=0,t=la.THUNDER,i=0;i<t.length;i++){null!=this.equips.getPart(t[i])&&e++}return e},p(0,e,"maxMP",function(){return this.attrHash.has(aa.MAXMP.id)?this.attrHash.take(aa.MAXMP.id):0}),p(0,e,"zhuijiSkillLevel",function(){var e=gR.ins.zhuijiSkillLevels;return e&&e.hasOwnProperty(this.id)?e[this.id]:0}),p(0,e,"luckProp",function(){return 0}),p(0,e,"maxHP",function(){return this.attrHash.has(aa.MAXHP.id)?this.attrHash.take(aa.MAXHP.id):0}),p(0,e,"maxHD",function(){return this.attrHash.has(aa.MAXHD.id)?this.attrHash.take(aa.MAXHD.id):0}),p(0,e,"luckRate",function(){return 0}),p(0,e,"flyupLevel",function(){return gR.ins.actorFlyUpLevel}),i.create=function(e){var t=new i(e.readByte());return t.update(e,!0),t},i}(),iR=function(){function e(){var e;this._part=[],this._configVo=null,this.heJiSkillToPlayer=48e3,this.heJiSkillToMonster=105e3,this._canExchangeData=[],this.isFirstActivityHeJiRang=!1;for(var t=0;t<8;t++)(e=new zl).part=t+1,this._part.push(e);this.initConfig()}b(e,"modules.actor.others.ActorHeJiData");var t=e.prototype;return t.getInfoByPart=function(e){var t;for(var i in this._part)if((t=this._part[i]).part==e)return t;return null},t.getRuneResouseByGoodID=function(e){for(var t=0;t<ws.count;t++)if(e==ws.MODEL.levelUpGoodsId(t))return this.configVo[ws.MODEL.level(t)-1][ws.MODEL.part(t)-1];return null},t.checkLevelPartIsSame=function(e){for(var t in this._part)if(this._part[t].level!=e)return!1;return!0},t.initConfig=function(){var e;this._configVo=[];for(var t=0,i=0;i<ws.count;i++)e=new W,t=ws.MODEL.level(i),null==this._configVo[t-1]&&(this._configVo[t-1]=[]),e.id=i,this._configVo[t-1].push(e)},t.updatePart=function(e){var t;for(var i in this._part)(t=this._part[i]).part==e.part&&(t.level=e.level)},t.getTaoZhuangLevel=function(e){for(var t=0,i=0,n=0;n<ua.PART_NAME.length;n++){for(var s in t=0,this._part)this._part[s].level>=n&&t++;e<=t&&(i=n)}return i},t.checkLevelTao=function(e,t){if(0==e)return!1;if(-1==ua.HEJI_TAO_ZHUANG.indexOf(t))return!1;var i=0;for(var n in this._part)this._part[n].level>=e&&i++;return t<=i},t.getAttrFromCommonSuitByLevelAndNum=function(e,t){for(var i=0;i<wp.count;i++)if("RUNE"==wp.MODEL.suitType(i)){var n=wp.MODEL.level(i),s=wp.MODEL.needNum(i);if(n==e&&s==t)return wp.MODEL.attrsAdd(i)}return 0},t.checkHasHeJiExchange=function(){for(var e,t,i=0,n=0,s=0,o=0,a=0,r=0,l=0,c=0,u=!(this._canExchangeData=[]),d=!1,h=0;h<bs.count;h++){o=bs.MODEL.key(h),s=bs.MODEL.fuwenID(h),bs.MODEL.exchangeID(h),n=bs.MODEL.level(h),e=this.canExchangeData[n-1],t=yB.createStr(xa.MODEL.consumption(xa.getIndex(o))),a=parseInt(t.goodsNum.toString()),l=this.getRuneResouseByGoodID(s).part,r=this.getInfoByPart(l).level;var _=this.getRuneResouseByGoodID(s);c=t.goodsId==aR.RUNE_PIECE.itemId?gR.ins.fuwen:gR.ins.fuwengaoji,d=0==_.needFlyLevel?gR.ins.lv>=_.needLevel:gR.ins.zsLv>=_.needFlyLevel,u=0<TR.ins.getGoodsNum(s),a<=c&&r<n&&!u&&d&&(null==e&&(this.canExchangeData[n-1]=[]),this.canExchangeData[n-1].push(s),i++)}return i},t.checkHasHeJiPart=function(){var e=0,t=TR.ins.getBackPackFuWen(),i=TR.ins.getFuWenFenJie();if(t.length==i.length)return 0;var n,s,o=[],a=1,r=0;for(var l in t)s=t[l],a=ua.judgePart(s.goodsId),r=modules.actor.others.ActorHeJiData.instance.getInfoByPart(a).level,n=modules.actor.others.ActorHeJiData.instance.getRuneResouseByGoodID(s.goodsId),0!=r&&r<n.level&&o.push(s),e++;return e},t.checkPointRedPoint=function(){return this.checkHasHeJiExchange()||this.checkHasHeJiPart()},t.checkPartSame=function(){for(var e,t,i=0,n=0;n<this._part.length-1;n++)e=this._part[n],t=this._part[n+1],0<e.level&&0<t.level&&e.level==t.level&&i++;return i==ua.PART_NAME.length-1},t.getAllPartAttr=function(){for(var e=0,t=0;t<this._part.length;t++){var i=this._part[t];if(0<i.level){var n=this._configVo[i.level-1][i.part-1];if(n){var s=Bi.getIndex(n.levelUpGoodsId),o=n.attrs;aa.formatAttrToChineseByList(o),e+=RR.getFight(o)+Bi.MODEL.fight(s)}}}return e},p(0,t,"canExchangeData",function(){return this._canExchangeData}),p(0,t,"lowLevel",function(){for(var e=0,t=1;t<=ua.PART_NAME.length;){var i;for(var n in this._part){if(0==(i=this._part[n]).level)return 0;i.level>=t&&e++}if(e!=ua.PART_NAME.length)return t;t++,e=0}return 0}),p(0,t,"configVo",function(){return this._configVo}),p(0,t,"part",function(){return this._part},function(e){var t;if(0!=e.length)for(var i in e){var n;t=e[i];for(var s=0;s<this._part.length;s++)if(n=this._part[s],t.part==n.part){n.level=t.level,this._part[s]=n;break}}}),p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),nR=function(){function e(){}return b(e,"modules.actor.others.ActorReq"),e.reqRoleSystemUpgrade=function(e,t){var i=new nA;i.actor=e,i.type=t,Tu.sendToService(i)},e.reqZsUpgrade=function(){var e=new rA;Tu.sendToService(e)},e.reqZsExchange=function(e){var t=new lA;t.type=e,Tu.sendToService(t)},e.reqOpenZsExchange=function(){var e=new hA;Tu.sendToService(e)},e.equipSWing=function(e,t,i){var n=new dA;n.item=t,n.pos=i,n.role=e,Tu.sendToService(n)},e.swingQuickStep=function(e,t){var i=new uA;i.role=e,i.pos=t,Tu.sendToService(i)},e.swingQuickCompose=function(e,t){var i=new cA;i.role=e,i.pos=t,Tu.sendToService(i)},e.reqRingAdvance=function(e,t){var i=new _A;i.roleIndex=e,i.type=t,Tu.sendToService(i)},e.reqViewOther=function(e,t,i){if(void 0===t&&(t=""),void 0===i&&(i=0),gR.ins.charId!=e.toString()){var n=new mL;n.playerId=e,n.platform=t,n.serverId=i,Tu.sendToService(n)}},e.reqPayData=function(e){var t=new gA;t.json_words=e,Tu.sendToService(t)},e.reqShareReward=function(){var e=new qD;Tu.sendToService(e)},e.reqVerifyReward=function(){tr.push(RP.n[25]),Tu.sendToService(new VD)},e.reqSaveDeskReward=function(){Tu.sendToService(new GD)},e.reqSubscribeReward=function(){tr.push(RP.n[26]),Tu.sendToService(new UD)},e.reqSubscribeStatus=function(){e._hasReqSubscribes||Tu.sendToService(new FD),e._hasReqSubscribes=!0},e.reqZhuiJi=function(e){var t=new _e;t.playerIndex=e,Tu.sendToService(t)},e.reqLunhuiMessage=function(){var e=new dO;Tu.sendToService(e)},e.reqLunhuiUpgrade=function(){var e=new hO;Tu.sendToService(e)},e.reqLunhuiExchange=function(e){var t=new _O;t.type=e,Tu.sendToService(t)},e.reqMicroReward=function(){var e=new WD;tr.push(RP.n[27]),Tu.sendToService(e)},e.getAwyKf=function(){var e=new YD;Tu.sendToService(e)},e._hasReqSubscribes=!1,e}(),sR=function(){function a(){}return b(a,"modules.actor.others.DragonSoulDataModel"),a.getIsFull=function(e){return ti.MODEL.key(e)>=ti.count},a.getCurIndex=function(e,t){for(var i=0;i<ti.count;i++)if(ti.MODEL.level(i)==t&&ti.MODEL.tier(i)==e)return i;return-1},a.getDragonSoulRed=function(){if(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(141))))return!1;if(!a.draSoulHash)return!1;var e;for(var t in a.draSoulHash.proto)if(e=a.draSoulHash.proto[t],a.getRedByActorId(e.actorId))return!0;return!1},a.getRedByActorId=function(e){if(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(141))))return!1;if(!a.draSoulHash||!a.draSoulHash.take(e))return!1;var t=a.draSoulHash.take(e);if(0==t.steps&&0==t.level)return!0;var i=a.getCurIndex(t.steps,t.level);if(!a.getIsFull(i)){if(0==ti.MODEL.experience(i))return!0;var n=JSON.parse(ti.MODEL.consumeDef(i)),s=parseInt(n[0].value.toString().split(":")[0]),o=parseInt(n[0].value.toString().split(":")[1]);if(TR.ins.getGoodsNum(s)>=o)return!0}return!1},a.refreshRedPointCimecial=function(){Tu.sendToModule("UPDATE_REDPOINT_CIMECILA",["modules.actor.ActorModule"])},a.reqInfo=function(){var e=new ID;Tu.sendToService(e)},a.reqUpdate=function(e){var t=new bD;t.actorId=e,Tu.sendToService(t)},a.draSoulHash=null,a.roleIndex=0,a.isUp=!1,a.isStep=!1,a}(),oR=function(){function t(){}return b(t,"modules.actor.others.enum.EActive"),t.checkOpen=function(e){return!(3<=e||e<0)&&(gR.ins.lv>=t._lv[e]&&gR.ins.zsLv>=t._zsLv[e]||gR.ins.VIPLevel>=t._vipLv[e])},t.getDesc=function(e){return t._zsLv[e]+"转"},t.getVipDesc=function(e){return"VIP"+t._vipLv[e]},f(t,["_zsLv",function(){return this._zsLv=[0,1,4]},"_vipLv",function(){return this._vipLv=[0,2,4]},"_lv",function(){return this._lv=[0,0,0]}]),t}(),aR=function(){function r(e,t,i,n,s,o){var a=this;a.name=null,a.id=0,a.itemId=0,a.desc=null,a.color=null,a.key=null,void 0===i&&(i=0),void 0===n&&(n=""),void 0===s&&(s=""),void 0===o&&(o=""),a.name=t,a.id=e,a.itemId=i,a.color=n,a.desc=s,a.key=o,r._idHash.put(a.id,a),r._keyHash.put(a.key,a)}return b(r,"modules.actor.others.enum.EMoney"),r.getById=function(e){return r._idHash.take(e)},r.getBykey=function(e){return r._keyHash.take(e)},r.setValueById=function(e,t){var i=0;switch(e){case r.EXP.id:i=gR.ins.exp,gR.ins.exp=t;break;case r.GOLD.id:i=gR.ins.YB,gR.ins.YB=t;break;case r.COPPER.id:i=gR.ins.coin,gR.ins.coin=t;break;case r.ZHANJI.id:i=gR.ins.ZJ,gR.ins.ZJ=t;break;case r.SOUL.id:i=gR.ins.soul,gR.ins.soul=t;break;case r.ZS_EXP.id:i=gR.ins.zsExp,gR.ins.zsExp=t;break;case r.PRESTIGE.id:i=gR.ins.WW,gR.ins.WW=t;break;case r.PK.id:i=gR.ins.pk,gR.ins.pk=t;break;case r.RUNE_PIECE.id:i=gR.ins.fuwen,gR.ins.fuwen=t;break;case r.HIGH_RUNE_PIECE.id:i=gR.ins.fuwengaoji,gR.ins.fuwengaoji=t;break;case r.DRAGON_DESIGN_FRAGMENT.id:i=gR.ins.dragonsuipian,gR.ins.dragonsuipian=t;break;case r.DRAGON_DESIGN_ESSENCE.id:i=gR.ins.dragonJingHua,gR.ins.dragonJingHua=t;break;case r.DRAGON_DESIGN_SOUL.id:i=gR.ins.dragonHunshi,gR.ins.dragonHunshi=t;break;case r.VIP_EXP.id:var n=Wg.ins.toc_info;if(null==n)break;case r.MEILI_VALUE.id:i=gR.ins.meili,gR.ins.meili=t;break;case r.KUN_EXP.id:i=gR.ins.kunExp,gR.ins.kunExp=t;break;case r.GUILD_MEDAL.id:i=gR.ins.guildMedal,gR.ins.guildMedal=t;break;case r.CASH.id:i=gR.ins.cash,gR.ins.cash=t}var s=t-i;return s<0?0:s},r.getMoneysByStr=function(e){if(null==e)return{};for(var t={},i=e.split(","),n=0;n<i.length;n++){var s=i[n].split(":");t[s[0]]=parseInt(s[1])}return t},r.getMoneyItems=function(e){if(null==e)return[];for(var t=[],i=e.split(","),n=0;n<i.length;n++){var s=i[n].split(":"),o=r[s[0]];t.push({itemId:o.itemId,itemNum:parseInt(s[1])})}return t},r.getMoneyDto=function(e){var t=e.split(":"),i=r[t[0]];return yB.create(i.itemId,t[1])},r.changeToGoodsId=function(e){var t=-1;switch(e){case modules.actor.others.enum.EMoney.EXP.id:t=modules.actor.others.enum.EMoney.EXP.itemId;break;case modules.actor.others.enum.EMoney.GOLD.id:t=modules.actor.others.enum.EMoney.GOLD.itemId;break;case modules.actor.others.enum.EMoney.COPPER.id:t=modules.actor.others.enum.EMoney.COPPER.itemId;break;case modules.actor.others.enum.EMoney.PRESTIGE.id:t=modules.actor.others.enum.EMoney.PRESTIGE.itemId;break;case modules.actor.others.enum.EMoney.DRAGON_DESIGN_FRAGMENT.id:t=modules.actor.others.enum.EMoney.DRAGON_DESIGN_FRAGMENT.itemId;break;case modules.actor.others.enum.EMoney.DRAGON_DESIGN_ESSENCE.id:t=modules.actor.others.enum.EMoney.DRAGON_DESIGN_ESSENCE.itemId;break;case modules.actor.others.enum.EMoney.DRAGON_DESIGN_SOUL.id:t=modules.actor.others.enum.EMoney.DRAGON_DESIGN_SOUL.itemId;break;case modules.actor.others.enum.EMoney.GOD_ARMS_EXP.id:t=modules.actor.others.enum.EMoney.GOD_ARMS_EXP.itemId;break;case modules.actor.others.enum.EMoney.GUILD_DONATE.id:t=modules.actor.others.enum.EMoney.GUILD_DONATE.itemId;break;case modules.actor.others.enum.EMoney.VIP_EXP.id:t=modules.actor.others.enum.EMoney.VIP_EXP.itemId;break;case modules.actor.others.enum.EMoney.KUN_EXP.id:t=modules.actor.others.enum.EMoney.KUN_EXP.itemId;break;case modules.actor.others.enum.EMoney.GUILD_MEDAL.id:t=modules.actor.others.enum.EMoney.GUILD_MEDAL.itemId;break;case modules.actor.others.enum.EMoney.CASH.id:t=modules.actor.others.enum.EMoney.CASH.itemId}return t},r.EXP_ITEM_ID=4,r.VIP_EXP_ITEM_ID=6,r.GOLD_ITEM_ID=14,r.COPPER_ITEM_ID=15,r.PRESTIGE_ITEM_ID=35,r.DRAGON_DESIGN_FRAGMENT_ITEM_ID=2524,r.DRAGON_DESIGN_ESSENCE_ITEM_ID=2526,r.DRAGON_DESIGN_SOUL_ITEM_ID=2525,r.GOD_ARMS_EXP_ITEM_ID=2038,r.GUILD_DONATE_ITEM_ID=351,r.ZHANJI_ITEM_ID=34,r.XINGCHEN_ITEM_ID=3,r.PK_ITEM_ID=33,r.KUN_EXP_ITEM_ID=2369,r.GUILD_MEDAL_ID=2370,r.CASH_ID=2631,f(r,["EXP",function(){return this.EXP=new r(1,"经验",4,"#01b527","","EXP")},"GOLD",function(){return this.GOLD=new r(2,"元宝",14,"#ff831e","","GOLD")},"COPPER",function(){return this.COPPER=new r(3,"金币",15,"#fff9e0","","COPPER")},"ZHANJI",function(){return this.ZHANJI=new r(4,"战绩",34,"#fff9e0","","ZHANJI")},"SOUL",function(){return this.SOUL=new r(5,"魔尘",3,"#fff9e0","","SOUL")},"ZS_EXP",function(){return this.ZS_EXP=new r(6,"转生经验",0,"#fff9e0","","ZS_EXP")},"PRESTIGE",function(){return this.PRESTIGE=new r(7,"威望",35,"#fff9e0","","PRESTIGE")},"PK",function(){return this.PK=new r(8,"PK值",33,"#fff9e0","","PK")},"RUNE_PIECE",function(){return this.RUNE_PIECE=new r(9,"符文碎片",2460,"#fff9e0","","RUNE_PIECE")},"HIGH_RUNE_PIECE",function(){return this.HIGH_RUNE_PIECE=new r(10,"高级符文碎片",2459,"#fff9e0","","HIGH_RUNE_PIECE")},"DRAGON_DESIGN_FRAGMENT",function(){return this.DRAGON_DESIGN_FRAGMENT=new r(11,"龙纹碎片",2524,"#fff9e0","","DRAGON_DESIGN_FRAGMENT")},"DRAGON_DESIGN_ESSENCE",function(){return this.DRAGON_DESIGN_ESSENCE=new r(12,"龙纹精华",2526,"#fff9e0","","DRAGON_DESIGN_ESSENCE")},"DRAGON_DESIGN_SOUL",function(){return this.DRAGON_DESIGN_SOUL=new r(13,"龙纹魂石",2525,"#fff9e0","","DRAGON_DESIGN_SOUL")},"GOD_ARMS_EXP",function(){return this.GOD_ARMS_EXP=new r(14,"神兵经验",r.GOD_ARMS_EXP,"#fff9e0","","GOD_ARMS_EXP")},"EXPLORE_DD_LUCK",function(){return this.EXPLORE_DD_LUCK=new r(15,"探宝龙纹祝福值",0,"#fff9e0","","EXPLORE_DD_LUCK")},"EXPLORE_CS_LUCK",function(){return this.EXPLORE_CS_LUCK=new r(16,"探宝传世祝福值",0,"#fff9e0","","EXPLORE_CS_LUCK")},"GUILD_DONATE",function(){return this.GUILD_DONATE=new r(17,"帮会贡献",351,"#fff9e0","","GUILD_DONATE")},"VIP_EXP",function(){return this.VIP_EXP=new r(21,"VIP经验",6,"#fff9e0","","VIPEXP")},"MEILI_VALUE",function(){return this.MEILI_VALUE=new r(23,"魅力值",0,"#fff9e0","","MEILI_VALUE")},"PIC_EXP",function(){return this.PIC_EXP=new r(20,"图鉴经验",0,"#fff9e0","","PIC_EXP")},"KUN_EXP",function(){return this.KUN_EXP=new r(24,"养鲲经验",2369,"#fff9e0","","KUN_EXP")},"GUILD_MEDAL",function(){return this.GUILD_MEDAL=new r(25,"公会勋章",2370,"#fff9e0","","GUILD_MEDAL")},"CASH",function(){return this.CASH=new r(26,"银票",2631,"#fff9e0","CASH")},"_idHash",function(){return this._idHash=new jl},"_keyHash",function(){return this._keyHash=new jl}]),r.__init$=function(){xs.initStaticClass(r)},r}(),rR=function(){function e(){this.m_inited=!1,this.needUpdate=1,this.m_roleStatus=[],this.m_hash=new jl,this.m_partStatusHash=new jl}b(e,"modules.actor.others.GodlyEquipData");var t=e.prototype;return t.showGodlyEquipPanel=function(e){if(e&&1==e.equipType){var t=$e.MODEL.value($e.getIndex(172));return!(t&&0<=t.indexOf(e.goodsId))}return!1},t.findExchangeId=function(e,t,i){this.m_inited||this.initExchange();for(var n,s=e+"_"+t,o=this.m_hash.take(s),a=0,r=0;r<o.length;r++){if(a=(n=o[r]).index,i<n.score)return Di.MODEL.exchangeId(a)}return 0<o.length?(a=(n=o[o.length-1]).index,Di.MODEL.exchangeId(a)):0},t.initExchange=function(){for(var e=Di.count,t={},i=0;i<e;i++){var n=Di.MODEL.role(i),s=Di.MODEL.position(i),o=Di.MODEL.score(i),a=Di.MODEL.exchangeId(i);if(19061!=a&&29061!=a&&39061!=a){var r=n+"_"+s,l=t[r];l||(l=[]),l.push({index:i,score:o}),t[r]=l}}for(var c in t){var u=t[c].sort(this.sortHandler);this.m_hash.put(c,u,!0)}this.m_inited=!0},t.sortHandler=function(e,t){return e&&t&&e.score!=t.score?e.score>t.score?1:-1:0},t.updateRedData=function(){for(var e=gR.ins.actorList.length,t=F.GODLYPARTS,i=gR.ins.lv,n=gR.ins.zsLv,s=this.m_roleStatus.length=0;s<e;s++){for(var o=s+1,a=!1,r=0;r<t.length;r++){var l=t[r],c=o+"_"+l,u=MR.ins.getEquip(o,l),d=0,h=!0;if(this.showGodlyEquipPanel(u)){var _=Ti.getIndex(u.goodsId);if(h=0<_){var f=yB.createStr(Ti.MODEL.materialConsumption(_));f&&0<f.goodsId&&(h=TR.ins.getGoodsNum(f.goodsId)>=f.goodsNum);var p=Ti.MODEL.targetModelId(_),g=KH.create(p);h&&g&&(h=g.useLevel<=i&&g.flyLevel<=n)}}else{u&&(d=u.sorce);var v=modules.actor.others.GodlyEquipData.instance.getRoleIdByIndex(o-1),m=modules.actor.others.GodlyEquipData.instance.findExchangeId(v,l,d),y=xa.getIndex(m),I=yB.createStr(xa.MODEL.consumption(y));I&&0<I.goodsId&&(h=TR.ins.getGoodsNum(I.goodsId)>=I.goodsNum);var b=KH.createStr(xa.MODEL.reward(y));h&&b&&(h=b.useLevel<=i&&b.flyLevel<=n)}this.m_partStatusHash.put(c,h,!0),!a&&h&&(a=!0)}this.m_roleStatus.push(a)}this.needUpdate=0},t.getRoleIdByIndex=function(e){var t=gR.ins.actorList.length;return t<=e&&(e=t-1),gR.ins.actorList[e].job},t.getRoleShowTip=function(e){return this.m_roleStatus[e]},t.getPartShowTip=function(e,t){return this.m_partStatusHash.take(e+"_"+t)},t.showTip=function(){return 0<=this.m_roleStatus.indexOf(!0)||0<this.getResolveList().length},t.getResolveList=function(){var e,t=TR.ins.getBackPackEquips(-1,1),i=[];for(var n in t)if(1==(e=t[n]).equipType)if(0==e.roleJob){for(var s=gR.ins.actorList.length,o=0,a=0;a<s;a++){var r=MR.ins.getEquip(a+1,e.decoratePosition);r&&r.sorce>=e.sorce&&o++}s<=o&&i.push(e)}else{var l=gR.ins.actorByJob(e.roleJob);if(l){var c=MR.ins.getEquip(l.id,e.decoratePosition),u=0,d=0;e&&(d=1<=e.flyLevel?(u=gR.ins.zsLv,e.flyLevel):(u=gR.ins.lv,e.useLevel),u<d?i.push(e):c&&c.sorce>=e.sorce&&i.push(e))}else i.push(e)}return i},p(0,t,"open",function(){var e=$e.MODEL.value($e.getIndex(130));return!(parseInt(e)>gR.ins.lv)}),p(1,e,"instance",function(){return e._instance||(e._instance=new e),e._instance}),e._instance=null,e}(),lR=function(){function e(){var e=this;e.isReciveFenJie=!1,e.longwenChipNum=0,e.longwenSuiPianNum=0,e.longwenLyanNum=0,e.longwenLyiNum=0,e.roleIndex=0,e.longwenOpenList=[],e.longwenOpenTypeList=[],e.hasLongwenInnerArr=[!1,!1,!1],e.hasLongwenUpArr=[!1,!1,!1],e.hasLongwenChangeArr=[!1,!1,!1],e.longwenConfigFight=0,e.longwenConfigJFight=0,e.longWenHash=new jl,e.hashToGoodsId=new jl}b(e,"modules.actor.others.LongWenDataModel");var t=e.prototype;return t.sendToInner=function(e){var t=new mD;t.goodsPosition=e.goodsPosition,t.goodsUUID=e.goodsId,t.roleIndex=e.roleIndex,Tu.sendToService(t)},t.sendToUp=function(e){var t=new vD;t.goodsUUID=e,Tu.sendToService(t)},t.sendToFenJie=function(e){var t=new yD;t.fenjieList=e,Tu.sendToService(t)},t.getkeyByLongwenPart=function(e){var t=0;switch(e){case 52:t=0;break;case 53:t=1;break;case 54:t=2;break;case 55:t=3;break;case 56:t=4;break;case 57:t=5;break;case 58:t=6;break;case 59:t=7}return t},t.getModuleByGodPart=function(e){var t="";switch(e){case 60:t="FLYUP_WEAPON_BASE";break;case 61:t="FLYUP_UPPER_BODY_BASE";break;case 67:t="FLYUP_HEAD_BASE";break;case 66:t="FLYUP_NECKLACE_BASE";break;case 64:t="FLYUP_BRACE_LET_BASE";break;case 63:t="FLYUP_BELT_BASE";break;case 62:t="FLYUP_RING_BASE";break;case 65:t="FLYUP_SHOE_BASE"}return t},t.getRedPoint=function(){this.hasLongwenInnerArr=[],this.hasLongwenUpArr=[];var e=!(this.hasLongwenChangeArr=[]),t=!1,i=!1;if(gR.ins.actorList)for(var n=0;n<3;n++){e=!1;var s=gR.ins.actorList[n];if(e=null!=s&&this.checkHasInnerDragon(n+1),this.hasLongwenInnerArr.push(e),t=!1,t=null!=s&&this.checkHasUpDragon(n+1),this.hasLongwenUpArr.push(t),i=!1,null!=s)for(var o=0;o<8;o++){var a=MR.ins.getEquip(n+1,52+o);if(i=this.checkHasChange(a,n+1))break}else i=!1;this.hasLongwenChangeArr.push(i)}},t.checkLongwenUpOrInner=function(){for(var e=!1,t=0;t<3;t++){if(1==this.hasLongwenInnerArr[t]){e=!0;break}if(1==this.hasLongwenUpArr[t]){e=!0;break}}return e},t.getIsOpen=function(e){return e<this.longwenOpenList.length},t.checkHasInnerDragon=function(e){var t=!1,i=[],n=0,s="";for(n=0;n<8;n++){var o=MR.ins.getEquip(e,52+n);if(o){s=o.goodsId.toString().substr(3,2);var a=parseInt(s);i.push(a)}}var r=TR.ins.getBackPackLongWens(),l=0;for(n=0;n<r.length;n++){var c=r[n];if(l=parseInt(c.goodsId.toString().substr(3,2)),-1==i.indexOf(l)&&this.getIsOpen(i.length)&&this.checkLongWenUnlockByType(l)){t=!0;break}}return t},t.checkLongWenUnlockByType=function(e){for(var t=0;t<qt.count;t++){if(qt.MODEL.key(t)==e){var i=qt.MODEL.conditionDef(t),n=JSON.parse(i),s=parseInt(n[0].value);if(Lo.instance.currentLevel>=s)return!0}}return!1},t.checkHasUpDragon=function(e){var t=!1,i=0;for(i=0;i<8;i++){var n=MR.ins.getEquip(e,52+i);if(n){var s=jt.MODEL.consumeDef(n.dragonIndex-1);if(s){var o=JSON.parse(s);if(null!=o)var a=parseInt(o[0].value.toString().split(":")[1]);if(a<=gR.ins.dragonJingHua&&0!=jt.MODEL.nextId(n.dragonIndex-1)){t=!0;break}}}}return t},t.getInnerDragonTypeList=function(e,t){void 0===t&&(t=!1);var i=new Object;i.longwenTyps=[],i.longwenData=[];var n=0,s="";for(n=0;n<8;n++){var o;if(o=0==t?MR.ins.getEquip(e,52+n):pR.ins.getEquip(e,52+n)){s=o.goodsId.toString().substr(3,2);var a=parseInt(s);i.longwenTyps.push(a),i.longwenData.push(o)}}return i},t.getOtherFight=function(e,t){void 0===t&&(t=!0);var i=0,n=0,s=[];for(n=0;n<8;n++){var o;if(1==t&&(o=pR.ins.getEquip(e,52+n))){var a=jt.MODEL.attrs(o.dragonIndex-1);s=aa.mergeFormatAttrs(a,s),i+=jt.MODEL.fight(o.dragonIndex-1)}}return i},t.getInnerDragonTypeBagList=function(e){var t=[],i=0,n="",s=TR.ins.getBackPackLongWens();for(i=0;i<s.length;i++){var o=s[i];if(o){n=o.goodsId.toString().substr(3,2);var a=parseInt(n);-1==t.indexOf(a)&&t.push(a)}}return t},t.checkHasUpDragon2=function(e){var t=!1,i=jt.MODEL.consumeDef(e.dragonIndex-1),n=JSON.parse(i);if(null!=n)var s=parseInt(n[0].value.toString().split(":")[1]);s<=gR.ins.dragonJingHua&&(0!=jt.MODEL.nextId(e.dragonIndex-1)&&(t=!0));return t},t.getAllFightNumForJob=function(e,t){void 0===t&&(t=!1);var i=[],n=0;this.longwenConfigFight=0;for(var s=this.longwenConfigJFight=0;s<8;s++){var o=MR.ins.getEquip(e+1,52+s);if(o){var a=jt.MODEL.attrs(o.dragonIndex-1);i=aa.mergeFormatAttrs(a,i),n=Bi.getIndex(o.goodsId);var r=Bi.MODEL.fight(n);this.longwenConfigFight+=r,this.longwenConfigJFight+=jt.MODEL.fight(o.dragonIndex-1)}}return aa.formatAttrToChineseByList(i,!1,!1,t)},t.checkHasChange=function(e,t){var i=!1,n=0;if(null!=e){var s=parseInt(e.goodsId.toString().substr(3,2)),o=this.getInnerDragonTypeList(t).longwenTyps;n=Bi.getIndex(e.goodsId);var a=Bi.MODEL.colourId(n),r=TR.ins.getBackPackLongWensFiltersame();for(var l in r.proto){var c=r.take(l),u=parseInt(c.goodsId.toString().substr(3,2));if(s==u||-1==o.indexOf(u))if(n=Bi.getIndex(c.goodsId),a<Bi.MODEL.colourId(n))if(1==this.checkLongWenIsOpen(c.goodsId)[0]){i=!0;break}}}return i},t.checkHasFenJie=function(){var e,t={},i=gR.ins.actorList,n=this.longwenOpenList.length,s=0,o=0,a=0,r=0,l=[];for(s=0;s<i.length;s++)for(o=0;o<n;o++){if(null==(e=MR.ins.getEquip(s+1,52+o)))return t={isRedPoint:!1,isSelectedPurole:!1};r=Bi.getIndex(e.goodsId),a=Bi.MODEL.colourId(r),l.push(a)}t.isRedPoint=!1,l.sort(this.onSortQulity),0<l.length&&3<=l[0]&&(t.isSelectedPurole=!0);var c=TR.ins.getBackPackLongWensFiltersame();for(var u in c.proto){var d=c.take(u);if(r=Bi.getIndex(d.goodsId),a=Bi.MODEL.colourId(r),2==l[0]){if(2==a){t.isRedPoint=!0;break}}else if(3<=l[0]&&(2==a||3==a)){t.isRedPoint=!0;break}}return t},t.onSortQulity=function(e,t){return t<e?1:e<t?-1:1},t.checkLongWenIsOpen=function(e){var t=[];if(this.hashToGoodsId.length<=0)for(var i=0;i<Yt.count;i++)this.hashToGoodsId.put(Yt.MODEL.toolsId(i),i);var n=parseInt(this.hashToGoodsId.take(e)),s=Yt.MODEL.unlock(n);if(0==s)t.push(!0);else{var o=s<=Lo.instance.currentChong(),a=Yt.MODEL.floor(n)*s<=Lo.instance.currentLevel;t.push(o&&a)}return t.push(Yt.MODEL.chineseNum(n)),t.push(s),t},t.checkLongWenIsOpen2=function(e){if(this.hashToGoodsId.length<=0)for(var t=0;t<Yt.count;t++)this.hashToGoodsId.put(Yt.MODEL.toolsId(t),t);var i=parseInt(this.hashToGoodsId.take(e));return Yt.MODEL.unlock(i)},t.dragonFight=function(e){var t,i,n=0,s=this.getInnerDragonTypeList(e);if(0<s.longwenData.length)for(var o in t=s.longwenData)i=t[o],n+=jt.MODEL.fight(i.dragonIndex-1);return n},e.instance=function(){return null==e._instance&&(e._instance=new e),e._instance},e._instance=null,e}(),cR=function(){function e(){}return b(e,"modules.actor.others.LunhuiModel"),e.checkCanExchangeYeli=function(){var e=gR.ins.lunhuiId,t=gR.ins.lunhuiRemainTime;if(e<1||!t||t.length<3)return!1;if(80<gR.ins.lv&&0<t[0])return!0;var i=Ji.MODEL.costSeniorItem(Ji.getIndex(e)).split(",")[0];if(0<TR.ins.getGoodsNum(i)&&0<t[1])return!0;var n=Ji.MODEL.costSuperItem(Ji.getIndex(e)).split(",")[0];return 0<TR.ins.getGoodsNum(n)&&0<t[2]},e.checkCanUpgrade=function(){var e=gR.ins.lunhuiId,t=!1;if(0<=Ki.getIndex(e+1)){var i=gR.ins.yeli;t=Ki.MODEL.yeliCost(Ki.getIndex(e))<=i}return t},e}(),uR=function(){function e(){this.info=null,this.info=[]}b(e,"modules.actor.others.LunhuiZhuhunModel");var t=e.prototype;return t.isAbleGrowZhuhun=function(e){for(var t=0;t<la.SAMSARA_EQUIPS.length;t++){var i=la.SAMSARA_EQUIPS[t];if(this.isAbleGrowPosZhuhun(e,i))return!0}return!1},t.isAbleGrowPosZhuhun=function(e,t){var i=this.getMohuaLevel(e,t);if(i>=hR.MAX_LEVEL)return!1;var n=gR.ins.actorById(e);if(n&&null==n.equips.getPart(t))return!1;var s=hR.getPosGrowCost(e,i+1,t);if(null!=s&&0<s.length){var o=s[0].value,a=parseInt(o.split(":")[0]);if(parseInt(o.split(":")[1])<=TR.ins.getGoodsNum(a))return!0}return!1},t.getMohuaLevel=function(e,t){var i=modules.actor.others.LunhuiZhuhunModel.ins.info;return i&&i.hasOwnProperty(e)&&i[e].hasOwnProperty(t)?i[e][t]:0},t.getLinkLevel=function(e,t){var i=hR.getPreLinkPos(t),n=this.getMohuaLevel(e,i),s=this.getMohuaLevel(e,t);return Math.min(s,n)},p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),dR=function(){function i(){}return b(i,"modules.actor.others.LunhuiZhuhunReq"),i.reqZhuhunInfo=function(e){var t=new gO;t.roleId=e,Tu.sendToService(t)},i.reqGrowZhuhun=function(e,t){var i=new vO;i.roleId=e,i.position=t,Tu.sendToService(i)},i.reqZhuhunTotalInfo=function(){var e;for(var t in gR.ins.actorList)e=gR.ins.actorList[t],i.reqZhuhunInfo(e.id)},i}(),hR=function(){function c(){}return b(c,"modules.actor.others.LunhuiZhuhunUtil"),p(1,c,"isOpenModule",function(){return GR.getInstance().checkModuleOpen(73)}),p(1,c,"MAX_LEVEL",function(){if(0<c._maxLevel)return c._maxLevel;for(var e=0;e<$n.count;e++){var t=$n.MODEL.zhuhunLevel(e);c._maxLevel<t&&(c._maxLevel=t)}return c._maxLevel}),c.getPosGrowCost=function(e,t,i){for(var n=0;n<$n.count;n++){var s=$n.MODEL.zhuhunLevel(n),o=$n.MODEL.position(n);if(s==t&&o==i)return JSON.parse($n.MODEL.consumptionDef(n))}return null},c.getPosAttr=function(e,t,i){for(var n=0;n<$n.count;n++){var s=$n.MODEL.zhuhunLevel(n),o=$n.MODEL.position(n);if(s==t&&o==i)return JSON.parse($n.MODEL.attrs(n))}return null},c.getPosAttr2=function(e,t,i){return c.getPosAttr(0,t,i)},c.getLinkAttr=function(e,t,i){for(var n=0;n<qn.count;n++){var s=qn.MODEL.soulLevel(n),o=qn.MODEL.position(n);if(s==t&&o==i)return JSON.parse(qn.MODEL.attrs(n))}return null},c.getMoAttr=function(e,t,i){for(var n=0;n<dn.count;n++){var s=dn.MODEL.mohuaLevel(n),o=dn.MODEL.position(n);if(s==t&&o==i)return JSON.parse(dn.MODEL.attrs(n))}return null},c.getLinkRateByPos=function(e,t,i){for(var n=0;n<qn.count;n++){var s=qn.MODEL.soulLevel(n),o=qn.MODEL.position(n);if(s==t&&o==i)return qn.MODEL.rate(n)}return 0},c.getLinkRateAddAttrIdByPos=function(e,t,i){var n=c.getLinkAttr(e,t,i),s=aa.formatNewAttrToChinese(n);return null!=s&&0<s.length?s[0].id:0},c.getMoRateByPos=function(e,t,i){for(var n=0;n<dn.count;n++){var s=dn.MODEL.mohuaLevel(n),o=dn.MODEL.position(n);if(s==t&&o==i)return dn.MODEL.rate(n)}return 0},c.getNextLinkPos=function(e){var t=la.LUNHUI_ZHUHUN_LINK,i=t.indexOf(e);return t[i==t.length-1?0:i+1]},c.getPreLinkPos=function(e){var t=la.LUNHUI_ZHUHUN_LINK,i=t.indexOf(e);return t[0==i?t.length-1:i-1]},c.formatString=function(e,t){for(var i=[],n=1,s=arguments.length;n<s;n++)i.push(arguments[n]);for(n=0;n<i.length;n++){var o=new RegExp(n+"]","g");e=e.replace(o,i[n])}return e=e.replace(/\[/g,"")},c.getLinkDes1=function(e,t,i){var n=$e.MODEL.value($e.getIndex(283)),s=c.getLinkRateAddAttrIdByPos(e,t,i),o=aa.getAttriNameById(s),a=c.getLinkRateByPos(e,t,i);return c.formatString(n,o,a/100+"%")},c.getLinkDes1_2=function(e,t,i){return c.getLinkDes1(0,t,i)},c.getLinkDes2=function(e,t,i,n){var s=$e.MODEL.value($e.getIndex(284)),o=c.getLinkRateAddAttrIdByPos(e,t,n),a=aa.getAttriNameById(o),r=c.getLinkRateByPos(e,t,n),l=c.getLinkRateByPos(e,i,n);return c.formatString(s,a,r/100+"%",l/100+"%")},c.getLinkNextCondition1=function(e,t,i){var n=$e.MODEL.value($e.getIndex(285)),s=c.getLinkRateByPos(e,t,i),o=c.getPreLinkPos(i),a=la.getName(o);return c.formatString(n,s/100+"%",a,t+"级")},c.getLinkNextCondition2=function(e,t,i){var n=$e.MODEL.value($e.getIndex(286)),s=c.getPreLinkPos(i),o=la.getName(s);return c.formatString(n,o,t+"级")},c.getLinkNextCondition3=function(e,t){var i=$e.MODEL.value($e.getIndex(290)),n=c.getPreLinkPos(t),s=la.getName(n);return c.formatString(i,s)},c.getLinkNextCondition4=function(e,t){var i=$e.MODEL.value($e.getIndex(294)),n=c.getPreLinkPos(t),s=la.getName(t),o=la.getName(n);return c.formatString(i,s,o)},c.getLinkNextCondition4_2=function(e,t){return c.getLinkNextCondition4(0,t)},c.getMohuaDes=function(e,t,i){var n=$e.MODEL.value($e.getIndex(287)),s=c.getMoRateByPos(e,t,i);return c.formatString(n,s/100+"%")},c.getMohuaDes2=function(e,t,i){return c.getMohuaDes(0,t,i)},c.getMohuaNextDes=function(e,t,i){var n=$e.MODEL.value($e.getIndex(288)),s=c.getMoRateByPos(e,t,i);return c.formatString(n,s/100+"%")},c._maxLevel=0,c}(),_R=function(){function s(){var e=this;e.data30611Hash=null,e.data30619Hash=null,e.data30617Hash=null,e.equipArrInBag=null,e.curPosition=0,e.curStatus=0,e.selectorType=1,e.typeSuits=null,e._buffSoulIds=null,e._sceceToPanelEffIds=null,e._skillIDs=null,e._skillConfigIndexs=null}b(s,"modules.actor.others.MoEquipData");var e=s.prototype;return e.updateMoEquipNum=function(){this.equipArrInBag=TR.ins.getBackPackMoEquip()},e.getEquipByPosition=function(e,t){void 0===t&&(t=0),0==t&&(t=gR.ins.currentSelectRoleIndex+1);var i=null,n=this.getPart(e,t);return n&&n.roleId==t&&(i=n),i},e.getPart=function(e,t){var i;for(var n in void 0===t&&(t=0),0==t&&(t=gR.ins.currentSelectRoleIndex+1),s.moEquipModel.goodsList)if((i=modules.actor.others.MoEquipData.moEquipModel.goodsList[n])&&i.position==e&&i.roleId==t)return i;return null},e.isBetter=function(e,t){void 0===t&&(t=0),0==t&&(t=gR.ins.currentSelectRoleIndex+1);var i=LR.getPart(e.goodsId),n=this.getPart(i,t);return!!(!n||e.moEquipScore>n.moEquipScore||e.moEquipScore==n.moEquipScore&&PR.betterThan(e,n))},e.hasBetter=function(e,t){var i=null!=this.getEquipByPosition(e,t),n=this.getEquipsByPositionInBag(e,t);if(i){if(0<n.length)for(var s=0;s<n.length;s++)if(this.isBetter(n[s],t))return!0}else if(0<n.length)return!0;return!1},e.hasEquipByPosition=function(e){return null!=this.getEquipByPosition(e)},e.hasEquipByPosAndRole=function(e,t){return null!=this.getEquipByPosition(e,t)},e.getEquipsByPositionInBag=function(e,t,i){void 0===i&&(i=!1),this.equipArrInBag||this.updateMoEquipNum();var n=[];if(0!=e){var s,o=gR.ins.getJobByIdx(t);for(var a in this.equipArrInBag)(s=this.equipArrInBag[a]).decoratePosition==e&&(0==s.roleJob||s.roleJob==o)&&gR.ins.lv>=s.useLevel&&(i||gR.ins.zsLv>=s.flyLevel)&&n.push(s)}return n},e.getMaterialEquips=function(e,t,i,n){void 0===n&&(n=""),this.equipArrInBag||this.updateMoEquipNum();var s,o,a=[];if(0!=e)for(var r in this.equipArrInBag)(o=this.equipArrInBag[r]).decoratePosition==e&&o.magicStarLevel>=t&&((s=new Object).dto=o,s.arr=i,s.func=n,a.push(s));return a},e.getMoWeaponAndClothes=function(e,t){var i=-1,n=0;for(n=0;n<$i.count;n++){var s=$i.MODEL.type(n),o=$i.MODEL.magicId(n);if(s==e&&t==o){i=n;break}}return i},e.getMoNeishiCompose=function(e){var t=0,i=0;for(i=0;i<$i.count;i++){var n=$i.MODEL.type(i),s=$i.MODEL.tarMagicId(i);if(3==n&&e==s){t=i;break}}return t},e.reqComposeMoEquip=function(e,t,i){var n=new tO;n.roleIndex=e,n.tarMagicId=t,n.selectGoodsId=i,Tu.sendToService(n)},e.getMoEquipGoodsIDByPart=function(e){var t=0,i=0;for(i=0;i<$i.count;i++){var n=$i.MODEL.type(i),s=$i.MODEL.position(i);if(3==n&&e==s){t=i;break}}return t},e.isMaxStarLevel=function(e,t){var i=this.getEquipByPosition(e,t),n=tn.getIndex(e-67),s=tn.MODEL.maxStarLevel(n);return null!=i&&Bi.MODEL.magicStarLevel(i.cfgIdx)==s},e.isSuitEquip=function(e,t,i){if(!e)return!1;if(0==e.length)return!1;for(var n=!0,s=e.length,o=0;o<s;o++){var a=this.getEquipByPosition(e[o],i);n=n&&null!=a&&a.magicStarLevel>=t}return n},e.getSuitId=function(e){void 0===e&&(e=0),0==e&&(e=gR.ins.currentSelectRoleIndex+1);for(var t=0,i=3;1<=i;i--){var n=this.getMaxLevelSuitIndexByType(i,e);if(0<n){t=n;break}}return nn.MODEL.key(t)},e.initSuitType=function(){this.typeSuits=new jl;for(var e=nn.count,t=0;t<e;t++){var i=t,n=nn.MODEL.suitType(i),s=this.typeSuits.take(n);s?s.push(i):s=[i],this.typeSuits.put(n,s,!0)}},e.getSuitsByType=function(e){return this.typeSuits||this.initSuitType(),this.typeSuits.take(e)},e.getMaxSuitBySuitIndexs=function(e,t){for(var i=0,n=0;n<e.length;n++){for(var s=e[n],o=nn.MODEL.positions(s),a=nn.MODEL.starLevel(s),r=!0,l=0;l<o.length;l++){var c=this.getEquipByPosition(o[l],t);if(!c||c.magicStarLevel<a){r=!1;break}}r&&0<a&&(i=s)}return i},e.getMaxLevelSuitIndexByType=function(e,t){var i=this.getSuitsByType(e);return this.getMaxSuitBySuitIndexs(i,t)},e.setActiveSkin=function(e){switch(e){case 68:return"wq";case 69:return"yf";case 70:return"tk";case 71:return"xl";case 72:return"sz";case 73:return"yd";case 74:return"jz";case 75:return"xz";case 76:return"hf";case 77:return"mj";case 78:return"hj";case 79:return"hx";case 80:return"yp";case 81:return"pf"}return""},e.getRoleEquipsScore=function(e){void 0===e&&(e=0);var t,i=0;for(var n in 0==e&&(e=gR.ins.currentSelectRoleIndex+1),s.moEquipModel.goodsList)(t=modules.actor.others.MoEquipData.moEquipModel.goodsList[n])&&t.roleId==e&&(i+=this.getEquipScoreByEquipData(t));return i},e.getRoleEquipsAttrs=function(e){void 0===e&&(e=0);var t,i=[];for(var n in s.moEquipModel.goodsList)(t=modules.actor.others.MoEquipData.moEquipModel.goodsList[n])&&t.roleId==e&&(i=aa.mergeFormatAttrs(t.attribles,i));return i},e.isSkillActive=function(e,t){if(void 0===t&&(t=0),!this.data30619Hash)return!1;0==t&&(t=gR.ins.currentSelectRoleIndex+1);for(var i=0,n=0,s=0;s<nn.count;s++)if(nn.MODEL.buffIds(s)==e){i=nn.MODEL.suitType(s),n=nn.MODEL.starLevel(s);var o=modules.actor.others.MoEquipData.getActiveEquipKey(t,i,n),a=this.data30619Hash.take(o);if(!a)return!1;for(var r=0;r<a.length;r++){var l=a[r];if(1==l.activeStatus&&l.suitType==i&&l.starLevel==n)return!0}break}return!1},e.getMagicSoulId=function(e){if(!this._buffSoulIds){this._buffSoulIds=new jl;for(var t=0;t<nn.count;t++){var i=nn.MODEL.soulIds(t),n=nn.MODEL.buffIds(t);i&&this._buffSoulIds.put(n,i)}}return this._buffSoulIds.take(e)},e.getPanelEffectIdByMagicId=function(e){if(!this._sceceToPanelEffIds){this._sceceToPanelEffIds=new jl;for(var t=0;t<on.count;t++){var i=on.MODEL.effectId(t),n=on.MODEL.roleEffectId(t);n&&this._sceceToPanelEffIds.put(i,n)}}return this._sceceToPanelEffIds.take(e)},e.getActivePartsBySkill=function(e,t,i){for(var n=[],s=0;s<e.length;s++){var o=this.getEquipByPosition(e[s],i);null!=o&&o.magicStarLevel>=t&&n.push(e[s])}return n},e.getBuffFighting=function(e){var t=Ls.getIndex(e);return Ls.MODEL.fighting(t)},e.getEquipFighting=function(e){var t=0;t+=RR.getFight(e.attribles);var i=0;for(var n=0 in e.buffs){var s=e.buffs[n];for(var o in s)i+=s[o]}return t+=i/1e4*1e6},e.getTotalFighting=function(e){void 0===e&&(e=0);for(var t=0,i=la.MO_SIMPLE_EQUIPS.concat(la.MO_SPECIAL_EQUIPS),n=0;n<i.length;n++){var s=this.getEquipByPosition(i[n],e);null!=s&&(t+=this.getEquipFighting(s))}for(var o=this.skillIDs,a=0;a<o.length;a++){var r=o[a];this.isSkillActive(r)&&(t+=this.getBuffFighting(r))}return t},e.getEquipScoreByEquipData=function(e){var t=0;return t+=e.moEquipScore},e.reqBreak=function(e){var t=new cO;t.list=e,Tu.sendToService(t)},e.getBreakEquips=function(){var e,t=[];for(var i in this.equipArrInBag||this.updateMoEquipNum(),this.equipArrInBag){var n=(e=this.equipArrInBag[i]).moBreakReward;n&&0<n.length&&t.push(e)}return t},e.getBreakRewardCount=function(e){var t=0;for(var i in e){var n=e[i].moBreakReward;if(n&&0<n.length){var s=JSON.parse(n);if(s&&0<s.length){var o=s[0].value;o&&0<o.length&&(s=o.split(":"))&&1<s.length&&(t+=parseInt(s[1]))}}}return t},p(0,e,"skillIDs",function(){if(!this._skillIDs){this._skillIDs=[];for(var e=0;e<nn.count;e++)4==nn.MODEL.suitType(e)&&this._skillIDs.push(nn.MODEL.buffIds(e))}return this._skillIDs}),p(0,e,"skillConfigIndexs",function(){if(!this._skillConfigIndexs){this._skillConfigIndexs=[];for(var e=0;e<nn.count;e++)4==nn.MODEL.suitType(e)&&this._skillConfigIndexs.push(e)}return this._skillConfigIndexs}),p(1,s,"ins",function(){return modules.actor.others.MoEquipData._ins||(modules.actor.others.MoEquipData._ins=new s),modules.actor.others.MoEquipData._ins}),p(1,s,"starBgTexture",function(){var e;return e=_r.getAtlasSubPath("grids/mz_bq_x.png"),G.loader.getRes(e)}),p(1,s,"starLevelTexture",function(){var e;return e=_r.getAtlasSubPath("grids/mz_bq_num.png"),G.loader.getRes(e)}),s.isOpen=function(){return GR.getInstance().checkModuleOpen(42)},s.isMoEquipByPart=function(e){return 0<=la.MO_SIMPLE_EQUIPS.indexOf(e)||0<=la.MO_SPECIAL_EQUIPS.indexOf(e)},s.isMoEquipByType=function(e){return 2==e},s.isMoEquipByDto=function(e){return modules.actor.others.MoEquipData.isMoEquipByType(e.equipType)},s.isMoEquipByGoodsID=function(e){var t=Bi.getIndex(e);return modules.actor.others.MoEquipData.isMoEquipByType(Bi.MODEL.equipType(t))},s.isSimpleMoEquip=function(e){return 0<=la.MO_SIMPLE_EQUIPS.indexOf(e)},s.isSpecialMoEquip=function(e){return 0<=la.MO_SPECIAL_EQUIPS.indexOf(e)},s.getMoEquipKey=function(e,t){return e+","+t},s.getActiveEquipKey=function(e,t,i){return e+","+t+","+i},s.reqMagicUnlockPacket=function(e,t){var i=new ML;i.roleIndex=e,i.position=t,Tu.sendToService(i)},s.reqMoEquipAdvanced=function(e,t,i){var n=new iO;n.actorId=e,n.position=t,n.costArr=i,Tu.sendToService(n)},s.reqWearEquip=function(e,t,i){void 0===i&&(i=0),OR.reqWearEquip(e,t,i)},s.reqMagicUnloadPacket=function(e,t){var i=new AL;i.roleIndex=e,i.position=t,Tu.sendToService(i)},s.reqActiveMoEquip=function(e,t,i){var n=new sO;n.roleIndex=e,n.suitType=t,n.starLevel=i,Tu.sendToService(n)},s.getAdPosIndex=function(e){switch(e){case 77:return 0;case 78:return 1;case 79:return 2;case 76:return 3;case 80:return 4;case 81:return 5}return 0},s.getAdvanceIndex=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0);for(var n=0;n<en.count;n++)if(s.A_EquipPart[e]==en.MODEL.position(n)&&t==en.MODEL.level(n)&&i==en.MODEL.start(n))return n;return 0},s.getAdvanceActiveIndexByPart=function(e){for(var t=0;t<en.count;t++)if(e==en.MODEL.position(t))return t;return 0},s.getAdvanceIndexByGid=function(e){for(var t=0;t<en.count;t++)if(e==en.MODEL.modelId(t))return t;return 0},s.getIsAdvanceFull=function(e){return 0<en.count&&e+1>=en.count||en.MODEL.position(e+1)!=en.MODEL.position(e)},s.reqWearMoSkill=function(e,t){var i=new oO;i.roleId=e,i.magicSkillId=t,Tu.sendToService(i)},s.reqTakeOffMoSkill=function(e,t){var i=new aO;i.roleId=e,i.magicSkillId=t,Tu.sendToService(i)},s.reqActiveMoSkill=function(e,t,i,n){var s=new nO;s.roleId=e,s.magicId=n,s.suitType=t,s.starLevel=i,Tu.sendToService(s)},s.getStartX=function(e){return(220-44*e)/2},s.getIsMoEquit=function(e){return 2==Bi.MODEL.equipType(Bi.getIndex(e))},s.getIsMoEquitSpecial=function(e){var t=Bi.getIndex(e);return 2==Bi.MODEL.equipType(t)&&1==Bi.MODEL.magicSpecialPosition(t)},s.getStarTexture=function(e,t){var i;return void 0===t&&(t=!0),i=t?_r.getAtlasSubPath("base_ui2/g_level_"+e+"_0.png"):_r.getAtlasSubPath("base_ui2/g_level_"+e+"_1.png"),G.loader.getRes(i)},s.canAdvance=function(e,t,i){if(e)return!1;var n=0,s=en.count,o=modules.actor.others.MoEquipData.ins.getEquipByPosition(t,i),a=0;null!=o?(a=o.goodsId,n=modules.actor.others.MoEquipData.getAdvanceIndexByGid(a)+1):n=modules.actor.others.MoEquipData.getAdvanceActiveIndexByPart(t);if(s<=n)return!1;for(var r=[],l=yh.getObj(en.MODEL.materialConsumption(n)),c=0;c<l.length;c++){var u=l[c].value.split(":");r.push({goodsId:parseInt(u[0]),goodsNum:parseInt(u[1])})}for(var d=0;d<r.length;d++)if(TR.ins.getGoodsNum(r[d].goodsId)<r[d].goodsNum)return!1;return!0},s.canCompose=function(e,t){var i=modules.actor.others.MoEquipData.ins.getEquipByPosition(e,t),n=null!=i?i.goodsId:0,s=0,o=0;if(68==e?(s=1,o=modules.actor.others.MoEquipData.ins.getMoWeaponAndClothes(s,n)):69==e?(s=2,o=modules.actor.others.MoEquipData.ins.getMoWeaponAndClothes(s,n)):modules.actor.others.MoEquipData.isSpecialMoEquip(e)&&(s=3,o=modules.actor.others.MoEquipData.ins.getMoEquipGoodsIDByPart(e)),o<0)return!1;if($i.count<=o)return!1;var a=$i.MODEL.tarMagicId(o),r=Bi.getIndex(a);if(gR.ins.zsLv<Bi.MODEL.flyLevel(r))return!1;for(var l=[],c=yh.getObj($i.MODEL.materialConsumption(o)),u=0;u<c.length;u++){var d=c[u].value.split(":");l.push({goodsId:parseInt(d[0]),goodsNum:parseInt(d[1])})}for(var h=0;h<l.length;h++){var _=l[h].goodsId,f=l[h].goodsNum;if((null==i||_!=i.goodsId||1!=f)&&TR.ins.getGoodsNum(_)<f)return!1}l=$i.MODEL.materialPosition(o).split(",");var p=$i.MODEL.minLevel(o),g=!0,v=parseInt(l[0]);if(v==parseInt(l[1])){var m=modules.actor.others.MoEquipData.ins.getMaterialEquips(v,p);g=g&&1<m.length}else for(var y=0;y<l.length;y++){var I=parseInt(l[y]),b=modules.actor.others.MoEquipData.ins.getMaterialEquips(I,p);g=g&&0<b.length}return g},s.TAB_COM="1",s.TAB_ADVANCE="0",s.mTowerExtra=null,s._ins=null,s.MAX_LVL=6,s.STAR_W=44,s.S_BOX_W=220,f(s,["moEquipModel",function(){return this.moEquipModel=new DR(68,81,"MO_EQUIP_DRESS","MO_EQUIP_UPDATE",null)},"A_EquipPart",function(){return this.A_EquipPart=[77,78,79,76,80,81]}]),s}(),fR=function(){function e(){this.currentRoleIndex=1,this.levelCountObj={},this.zhuhunInfo=new jl}b(e,"modules.actor.others.MoZhuHunData");var t=e.prototype;return t.getSuitFight=function(e){for(var t=0,i=la.MO_SIMPLE_EQUIPS.length,n=0;n<i;n++){var s=la.MO_SIMPLE_EQUIPS[n];if(this.isSuitByPosition(e,s)){var o=_R.ins.getEquipByPosition(s,e);if(!o)continue;var a=this.getSuitInfoByPosition(e,s),r=a.jie,l=a.level,c=modules.actor.others.MoZhuHunData.ins.getMappingResIndex(o.magicStarLevel),u=ln.MODEL.maxTier(c),d=ln.MODEL.maxLevel(c),h=0;h=u<r||r==u&&d<l?modules.actor.others.MoZhuHunData.ins.getZhuHunResIndex2(s,u,d):this.getZhuHunResIndex2(s,r,l);var _=cn.MODEL.attrs(h);if(""==_)continue;t+=RR.getFight(_,e)+cn.MODEL.fight(h)}}return t},t.isSuitByPosition=function(e,t){var i=!1;if(this.zhuhunInfo){var n=this.zhuhunInfo.take(e);if(n)for(var s=n.length,o=0;o<s;o++){var a=n[o];if(a.position==t&&(0!=a.jie||0!=a.level)){i=!0;break}}}return i},t.getSuitInfoByPosition=function(e,t){var i=null;if(this.zhuhunInfo){var n=this.zhuhunInfo.take(e);if(n)for(var s=n.length,o=0;o<s;o++){var a=n[o];if(a.position==t){i=a;break}}}return i},t.hasSuitByActorId=function(e){var t=!1;this.zhuhunInfo&&(this.zhuhunInfo.take(e)&&(t=!0));return t},t.getZhuHunResIndex=function(e,t){var i=0,n=0;if(this.isSuitByPosition(e,t)){var s=this.getSuitInfoByPosition(e,t);i=s.jie,n=s.level}return this.getZhuHunResIndex2(t,i,n)},t.getZhuHunResIndex2=function(e,t,i){for(var n=0,s=0;s<cn.count;s++)if(e==cn.MODEL.position(s)&&t==cn.MODEL.tier(s)&&i==cn.MODEL.level(s)){n=s;break}return n},t.reqZhuHunInfo=function(e){var t=new rO;t.roleIndex=e,Tu.sendToService(t)},t.reqZhuHun=function(e,t){var i=new lO;i.roleIndex=e,i.position=t,Tu.sendToService(i)},t.updateSuitInfo=function(e){if(this.zhuhunInfo||(this.zhuhunInfo=new jl),e instanceof protos.actor.toc_30623)this.zhuhunInfo.put(e.actorId,e.arr,!0);else if(e instanceof protos.actor.toc_30625)if(this.hasSuitByActorId(this.currentRoleIndex)){for(var t=this.zhuhunInfo.take(this.currentRoleIndex),i=!1,n=0;n<t.length;n++)if(t[n].position==e.position){t[n].jie=e.jie,t[n].level=e.level,i=!0;break}i||t.push({position:e.position,jie:e.jie,level:e.level})}else this.zhuhunInfo.put(this.currentRoleIndex,[{position:e.position,jie:e.jie,level:e.level}],!0)},t.showSuitRoleRP=function(e){for(var t=la.MO_SIMPLE_EQUIPS.length,i=0;i<t;i++){var n=la.MO_SIMPLE_EQUIPS[i];if(this.isAbleGrowEquip(e,n))return!0}return!1},t.isAbleGrowEquip=function(e,t){var i=!1,n=this.getZhuHunResIndex(e,t),s=cn.MODEL.consumptionDef(n+1);if(s&&0<s.length)for(var o=JSON.parse(s),a=0;a<o.length;a++){var r=o[a].value.split(":"),l=parseInt(r[0]),c=parseInt(r[1]);if(TR.ins.getGoodsNum(l)<c)return!1}var u=_R.ins.getEquipByPosition(t,e);if(u)if(this.isSuitByPosition(e,t)){var d=this.getSuitInfoByPosition(e,t),h=d.jie,_=d.level,f=u.magicStarLevel;n=this.getMappingResIndex(f);var p=ln.MODEL.maxTier(n),g=ln.MODEL.maxLevel(n);h<p?i=!0:h==p&&_<g&&(i=!0)}else i=!0;return i},t.getMappingResIndex=function(e){for(var t=0,i=0;i<ln.count;i++)if(e==ln.MODEL.key(i)){t=i;break}return t},t.getMapIndexByTier=function(e){for(var t=-1,i=0;i<ln.count;i++)e>=ln.MODEL.maxTier(i)&&(t=i);return t},t.isMaxJieAndMaxLevel=function(e,t){var i=!1,n=0;if(this.isSuitByPosition(e,t)){var s=this.getSuitInfoByPosition(e,t),o=s.jie,a=s.level,r=_R.ins.getEquipByPosition(t,e);if(r){var l=r.magicStarLevel;n=this.getMappingResIndex(l);var c=ln.MODEL.maxTier(n),u=ln.MODEL.maxLevel(n);c<o?i=!0:o==c&&u<=a&&(i=!0)}}return i},t.isMaxLevel=function(e,t){var i=!1,n=0;if(this.isSuitByPosition(e,t)){var s=this.getSuitInfoByPosition(e,t),o=s.jie,a=s.level,r=_R.ins.getEquipByPosition(t,e);if(r){var l=r.magicStarLevel;n=this.getMappingResIndex(l),o<ln.MODEL.maxTier(n)&&a>=this.getLevelCount(t,o)&&(i=!0)}}return i},t.isFull=function(e,t,i){var n=!1,s=this.getZhuHunResIndex2(e,t,i);return e!=cn.MODEL.position(s+1)&&(n=!0),n},t.getLevelCount=function(e,t){this.levelCountObj[e]||(this.levelCountObj[e]={});var i=this.levelCountObj[e],n=i[t];if(!n){n=0;for(var s=cn.count,o=0;o<s;o++)e==cn.MODEL.position(o)&&t==cn.MODEL.tier(o)&&0!=cn.MODEL.level(o)&&n++;i[t]=n}return n},p(1,e,"ins",function(){return modules.actor.others.MoZhuHunData._ins||(modules.actor.others.MoZhuHunData._ins=new e),modules.actor.others.MoZhuHunData._ins}),e._ins=null,e}(),pR=function(){function n(){var e=this;e.charId=null,e.charName=null,e.lv=0,e.zsLv=0,e.force=99999,e.wingActive=!1,e.actorList=[],e.passHash=null,e.guildName=null,e.index=0,n._ins&&pt.window.alert(RP.n[28])}b(n,"modules.actor.others.OtherPlayerData");var e=n.prototype;return e.actorById=function(e){return this.actorList[e]},e.actorByJob=function(e){var t;for(var i in this.actorList)if((t=this.actorList[i]).job==e)return t;return null},e.getEquip=function(e,t){var i=n.roleEquip(e);return i?i.getPart(t):null},p(1,n,"ins",function(){return null==n._ins&&(n._ins=new n),n._ins}),n.roleEquip=function(e){var t=modules.actor.others.OtherPlayerData.ins.actorById(e);return t?t.equips:null},n._ins=null,n}(),gR=function(){function t(){var e=this;e.charId=null,e.objectId=NaN,e.controlobjId=NaN,e.charName=null,e.platform=null,e.serverId=0,e.cId=null,e.guajiId=null,e.lv=0,e.zsLv=0,e.zsExp=0,e.exp=NaN,e.maxExp=NaN,e.pk=0,e.pkMode=0,e.VIPLevel=0,e.totalRecharge=0,e.actorList=null,e.guildId=NaN,e.guildName=null,e.guidePos=0,e.zsRemainTime=null,e.lunhuiId=0,e.yeli=0,e.lunhuiRemainTime=null,e.newWingOpenArr=null,e.isBuyGift=0,e.isShowBuyGifttip=[],e.showId=0,e.specialRingId=0,e.coinStr=null,e.createDay=0,e.lastUpgradeTime=0,e.isGm=0,e.isShowGm=0,e._coin=NaN,e._YB=NaN,e.ZJ=NaN,e.soul=NaN,e.WW=NaN,e.jmUps=[],e.forRed=!1,e.fuwen=0,e.fuwengaoji=0,e.dragonsuipian=0,e.dragonJingHua=0,e.dragonHunshi=0,e.showYuyiBless=0,e.isshowYuyiBless=1,e.isshowYuyiZhisheng=0,e.currentSelectRoleIndex=0,e.soulSkill=[],e.soulIsout=!1,e.souloutAdvanStep=0,e.souloutSkin=0,e.zhuijiSkill=[0,0,0],e.limitZhuiJiSkillID=0,e.limitZhuiJiTime=0,e.actorRingData=null,e.actorFlyUpData=null,e.actorFlyUpLevel=0,e.zhuijiSkillLevels=null,e.firstFlyupIdx=0,e.actorFlyUpBosstask=0,e.govPosition=-1,e.serverType=0,e.meili=0,e.kunExp=0,e.guildMedal=0,e.cash=0,e.niePan=!0,e.petIndex=-1,e.petColor=0,e.petStar=0,e.petAttrHash=null,e.petforce=0,t._ins&&pt.window.alert(RP.n[30])}b(t,"modules.actor.others.PlayerData");var e=t.prototype;return e.setForce=function(e,t){e>this.actorList.length||(this.actorList[e-1].force=t)},e.setObjectId=function(e,t){e>this.actorList.length||(this.actorList[e-1].objectId=t)},e.isMasterByObjectId=function(e){for(var t in this.actorList)if(this.actorList[t].objectId==e)return!0;return!1},e.actorById=function(e){return this.actorList[e-1]},e.actorByJob=function(e){var t;for(var i in this.actorList)if((t=this.actorList[i]).job==e)return t;return null},e.getAttackAttrValueByIdx=function(e,t){if(e>this.actorList.length)return 0;var i=this.actorList[e-1];return i?i.getAttrById(t):0},e.getJobByIdx=function(e){if(e>this.actorList.length)return 0;var t=this.actorList[e-1];return t?t.job:0},e.getIndexByJob=function(e){if(e<4&&0<e)for(var t=0;t<this.actorList.length;t++)if(this.actorList[t].job==e)return t;return-1},e.setAttackAttrValueByIdx=function(e,t,i){e>this.actorList.length||this.actorList[e-1].setAttrById(t,i)},e.canActive=function(e){var t=0;if(this.newWingOpenArr)for(var i=0;i<this.newWingOpenArr.length;i++)this.newWingOpenArr[i].roleindex==e&&(t=this.newWingOpenArr[i].isActive);return!t},e.canLevelActive=function(){return modules.actor.others.PlayerData.ins.lv>=this.activeLv},e.getLuckProp=function(e){return this.actorById(e)?this.actorById(e).luckProp:0},e.getLuckRate=function(e){return this.actorById(e).luckRate},e.setRoleHp=function(e,t){e>this.actorList.length||e<0||(this.actorList[e-1].currHP=t,Tu.sendToTotalModule("HP_CHANGE"))},e.setRoleMp=function(e,t){e>this.actorList.length||(this.actorList[e-1].currMP=t,Tu.sendToTotalModule("MP_CHANGE"))},e.changeScene=function(e){this.cId=e;var t=Pn.getIndex(parseInt(e));return 2==Pn.MODEL.type(t)&&(this.guajiId=e,!0)},e.checkCanZsExchange=function(e){if(!this.zsRemainTime)return!1;if(0==e){if(80<this.lv&&0<this.zsRemainTime[e])return!0}else{var t=ts.getIndex(this.zsLv),i=(1==e?ts.MODEL.costItem(t).split(","):ts.MODEL.superCostItem(t).split(","))[0];if(0<TR.ins.getGoodsNum(i)&&0<this.zsRemainTime[e])return!0}return!1},e.updateVein=function(){if(Dn.count<=0){var e=[{url:_r.getDBPath("ConfigRoleSystem"),type:"arraybuffer"}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}else this.refreshJMRedPoint()},e.onLoad=function(e){if(G.loader.getRes(e.url)&&Dn.count<=0){Dn.setup(e.url);for(var t=Dn.count,i=0;i<t;i++)Dn.config(i)}G.loader.clearRes(e.url),this.refreshJMRedPoint()},e.refreshJMRedPoint=function(){for(var e=!1,t=modules.actor.others.PlayerData.ins.actorList,i=0;i<t.length;i++){var n=t[i].jmCfgId;modules.actor.others.PlayerData.ins.jmUps[i]=!1;var s=-1;0<n&&(s=Dn.getIndex(n));var o=0;-1!=s&&(o=Dn.MODEL.level(s));var a=this.getNextJm(o);if(-1!=a){var r=Dn.MODEL.cost(a);if(r&&0<r.length){var l=r.split(","),c=parseInt(l[0]);parseInt(l[1])<=TR.ins.getGoodsNum(c)&&(modules.actor.others.PlayerData.ins.jmUps[i]=!0)}else modules.actor.others.PlayerData.ins.jmUps[i]=!0}modules.actor.others.PlayerData.ins.jmUps[i]&&(e=!0)}AN.ins.updatePt(5,e)},e.getNextJm=function(e){for(var t=-1,i=Dn.count,n=0;n<i;n++)if(Dn.MODEL.type(n)==fa.JM.type&&Dn.MODEL.level(n)==e+1){t=n;break}return t},e.getTotalGemLevel=function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].stoneTotalLv;return e},e.hasZhuiJi=function(){for(var e in this.zhuijiSkill)if(0<this.zhuijiSkill[e])return!0;return!1},e.getZhuiJiNum=function(){var e=0;for(var t in this.zhuijiSkill)0<this.zhuijiSkill[t]&&e++;return e},e.isniePan=function(){for(var e,t=0;t<this.actorList.length;t++)if((e=this.actorList[t])&&0<e.niepanlevel)return t;return-1},e.isniePanByIndex=function(e){for(var t,i=!1,n=0;n<this.actorList.length;n++)if((t=this.actorList[n])&&0<t.niepanlevel&&e==n){i=!0;break}return i},p(0,e,"YB",function(){return this._YB},function(e){this._YB=e}),p(0,e,"force",function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].force;return e+=this.petforce}),p(0,e,"maxMP",function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].maxMP;return e}),p(0,e,"wingActive",function(){var e=modules.actor.others.PlayerData.ins.newWingOpenArr;if(e)for(var t=0;t<e.length;t++)if(e[t].isActive)return!0;return!1}),p(0,e,"coin",function(){return this._coin},function(e){this._coin=e,this.coinStr=9999<e?(.001*e>>0)/10+"万":e+""}),p(0,e,"actorIsDead",function(){for(var e in this.actorList)if(this.actorList[e].currHP<=0)return!0;return!1}),p(0,e,"currMP",function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].currMP;return e}),p(0,e,"activeLv",function(){return parseInt($e.MODEL.value($e.getIndex(120)))}),p(0,e,"currHP",function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].currHP;return e}),p(0,e,"maxHP",function(){var e=0;for(var t in this.actorList)e+=this.actorList[t].maxHP;return e}),p(0,e,"strLv",function(){return(0<this.zsLv?this.zsLv+"转":"")+this.lv+"级"}),p(0,e,"wingRpt",function(){if(this.canLevelActive)return!0;for(var e=0;e<modules.actor.others.PlayerData.ins.actorList.length;e++)if(modules.actor.others.PlayerData.ins.actorList[e].wingData.showTip)return!0;return!1}),p(0,e,"wingCanUseAuto",function(){return 1<=modules.actor.others.PlayerData.ins.VIPLevel||3<=modules.actor.others.PlayerData.ins.zsLv}),p(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins}),t._ins=null,t}(),vR=function(){function e(){}return b(e,"modules.actor.others.RingEquipReq"),e.reqGrowRing=function(e,t){var i=new zD;i.jobId=e,i.type=t,Tu.sendToService(i)},e}(),mR=function(){function i(){}b(i,"modules.actor.others.RoleAvatarResource");var e=i.prototype;return e.onToLoad=function(e){i.getHandler=e;var t=[];0==Ot.count&&t.push({url:_r.getJxrDBPath("CAvatarWeapon"),type:"arraybuffer",cls:Ot}),0==Dt.count&&t.push({url:_r.getJxrDBPath("CAvatarClothes"),type:"arraybuffer",cls:Dt}),0==Pt.count&&t.push({url:_r.getJxrDBPath("CAvatarWing"),type:"arraybuffer",cls:Pt}),0<t.length?uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete)):this.onJxrComplete()},e.onJxrComplete=function(){i._weaponCfg=i._weaponCfg||{},i._clothesCfg=i._clothesCfg||{},i._wingCfg=i._wingCfg||{};var e=0;for(e=0;e<Ot.count;e++)i._weaponCfg[Ot.MODEL.name(e)]=Ot.MODEL.pos(e);for(e=0;e<Dt.count;e++)i._clothesCfg[Dt.MODEL.name(e)]=Dt.MODEL.pos(e);for(e=0;e<Pt.count;e++)i._wingCfg[Pt.MODEL.name(e)]=Pt.MODEL.pos(e);i.runComplete()},p(0,e,"isComplete",function(){return!!(i._weaponCfg&&i._clothesCfg&&i._wingCfg)}),p(1,i,"ins",function(){return null==i._ins&&(i._ins=new i),i._ins}),i.runComplete=function(){i.getHandler&&(i.getHandler.run(),i.getHandler.clear(),i.getHandler=null)},i._weaponCfg=null,i._clothesCfg=null,i._wingCfg=null,i._ins=null,i.getHandler=null,i}(),yR=function(){function e(){this._allInfo=null,this._refineInfo=null,this.initData()}b(e,"modules.actor.others.SamEquipData");var t=e.prototype;return t.getRedPtStatusByActor=function(e){for(var t={},i=0;i<8;i++){var n=la.SAMSARA_EQUIPS[i],s=e.equips.getPart(n),o=this.getBetterDto(n,e,s);t[n]=!!o}return t},t.getSamEquipsInBag=function(){for(var e=[],t=TR.bagModel.goodsList,i=0;i<t.length;i++){var n=t[i];ca.isSamsaraEquip(n.goodsId)&&e.push(n)}return e},t.getEquipFightByActor=function(e){for(var t=0,i=0,n=e.getAttrById(370)/1e4+1,s=0;s<8;s++){var o=0,a=0,r=0,l=la.SAMSARA_EQUIPS[s],c=e.equips.getPart(l);if(c){o=uR.ins.getMohuaLevel(e.id,c.decoratePosition),a=uR.ins.getLinkLevel(e.id,c.decoratePosition),0<o&&(r+=hR.getMoRateByPos(e.id,o,c.decoratePosition));var u=[],d={},h=PR.getGoodsNewAttr(c.goodsId);for(var _ in h){!h[_]||h[_].type!=aa.HOLY_DAM_NUM.keyStr&&h[_].type!=aa.HOLY_DAM_NUM2.keyStr&&h[_].type!=aa.HOLY_DAM_NUM3.keyStr?h[_]&&u.push(h[_]):d=h[_];var f=aa.formatNewAttrToChinese([h[_]]),p=0;if(0<a){var g=hR.getLinkRateAddAttrIdByPos(e.id,a,c.decoratePosition);0<f.length&&f[0].id==g&&(p+=hR.getLinkRateByPos(e.id,a,c.decoratePosition))}if(0<r+p){if(0<f.length){var v=Math.ceil((r+p)/1e4*f[0].val),m={};m[aa.getAttributById(f[0].id).keyStr]=v}i+=RR.getFight(m)}}t+=Math.ceil(RR.getFight(u))*n,d&&(t+=.72*d.value)}}return Math.ceil(t+i)},t.getBetterDto=function(e,t,i){var n,s,o=this.getSamEquipsInBag(),a=0;for(a=0;a<o.length;a++)n=o[a],this.getPosByCfg(n)==e&&this.getJobByCfg(n)==t.job&&PR.dressAble(t,n,this.getPosByCfg(n))&&(i&&n.fight>i.fight||!i)&&(s?s.fight<n.fight&&(s=n):s=n);return s},t.getMaxLvlWhileNull=function(e,t){var i,n,s=this.getSamEquipsInBag(),o=0,a=gR.ins.actorById(t);for(o=0;o<s.length;o++)i=s[o],this.getPosByCfg(i)==e&&this.getJobByCfg(i)==a.job&&PR.dressAble(a,i,this.getPosByCfg(i))&&(n?n.fight<i.fight&&(n=i):n=i);return n||this.getDtoByPosLvl(1,e,a.job)},t.getPosByCfg=function(e){return Bi.MODEL.decoratePosition(e.cfgIdx)},t.getJobByCfg=function(e){return Bi.MODEL.roleTypeId(e.cfgIdx)},t.getLevelByCfg=function(e){return Bi.MODEL.LunHuiLevel(e.cfgIdx)},t.initData=function(){this._allInfo={};var e=0,t=0;for(e=0;e<Bi.count;e++)if(t=Bi.MODEL.key(e),ca.isSamsaraEquip(t)){var i=Bi.MODEL.LunHuiLevel(e),n=Bi.MODEL.roleTypeId(e),s=Bi.MODEL.decoratePosition(e),o=KH.create(t);this._allInfo[n]||(this._allInfo[n]={}),this._allInfo[n][i]||(this._allInfo[n][i]={}),this._allInfo[n][i][s]||(this._allInfo[n][i][s]=o)}},t.getDtoByPosLvl=function(e,t,i){return this._allInfo[i][e][t]},t.getWearedNumByLvlActor=function(e,t){var i=gR.ins.actorById(t);if(!i)return 0;for(var n=0,s=0;s<8;s++){var o=la.SAMSARA_EQUIPS[s],a=i.equips.getPart(o);a&&this.getSamLevelByDto(a)>=e&&n++}return n},t.getSamLevelByDto=function(e){return e?Bi.MODEL.LunHuiLevel(e.cfgIdx):0},t.getSuitLevelName=function(e,t){for(var i=0;i<ji.count;i++){var n=ji.MODEL.suitType(i),s=ji.MODEL.level(i),o=(ji.MODEL.suitNeedNum(i),ji.MODEL.roleType(i));if("lunhuiEquip"==n&&e==s&&t==o&&ji.MODEL.SuitName(i).length)return ji.MODEL.SuitName(i)}return""},t.getSuitInfoByActor=function(e){for(var t={},i=0;i<8;i++){var n=la.SAMSARA_EQUIPS[i],s=e.equips.getPart(n);if(s){var o=this.getLevelByCfg(s),a=this.getWearNumByLvlActor(o,e);8<=a&&(t[8]=o),5<=a&&(t[5]&&o>t[5]||!t[5])&&(t[5]=o),2<=a&&(t[2]&&o>t[2]||!t[2])&&(t[2]=o)}}return t[2]||(t[2]=1),t[5]||(t[5]=1),t[8]||(t[8]=1),t},t.getWearNumByLvlActor=function(e,t){if(!t)return 0;for(var i=0,n=0;n<8;n++){var s=la.SAMSARA_EQUIPS[n],o=t.equips.getPart(s);o&&this.getSamLevelByDto(o)>=e&&i++}return i},t.sort=function(e,t){return e-t},t.getSuitAttrsByActor=function(){},t.initRefineInfo=function(e){this._refineInfo=e.info},t.updateRefineInfo=function(e){this._refineInfo||(this._refineInfo={}),this._refineInfo[e.info.roleId]||(this._refineInfo[e.info.roleId]={}),this._refineInfo[e.info.roleId][e.info.pos]=e.info},t.getRoleIdByJob=function(e){return 0},t.getRefineInfoPos=function(e,t){return this._refineInfo&&this._refineInfo[e]?this._refineInfo[e][t]:null},t.getRefineAttrPos=function(e,t){var i,n=this.getRefineInfoPos(e,t);if(!n)return null;for(var s=0;s<W_.count;s++)W_.MODEL.position(s)==t&&W_.MODEL.refineLevel(s)==n.level&&(i=W_.MODEL.attr(s));return i?JSON.parse(i):null},t.getRefineNextAttr=function(e,t){for(var i,n=this.getRefineInfoPos(e,t),s=0;s<W_.count;s++)W_.MODEL.position(s)==t&&W_.MODEL.refineLevel(s)==n.level+1&&(i=W_.MODEL.attr(s));return i?JSON.parse(i):null},t.getRefineAttrByLvl=function(e,t){for(var i,n=0;n<W_.count;n++)W_.MODEL.position(n)==e&&W_.MODEL.refineLevel(n)==t&&(i=W_.MODEL.attr(n));return i?JSON.parse(i):null},t.isMaxLvlByPos=function(e,t){var i=this.getRefineInfoPos(e,t);return!!i&&i.level>=this.getMaxLvl()},t.getMaxLvl=function(){for(var e=0,t=0;t<j_.count;t++)j_.MODEL.maxRefineLevel(t)>e&&(e=j_.MODEL.maxRefineLevel(t));return e},t.getLimLvlBySamLvl=function(e){for(var t=0;t<j_.count;t++)if(j_.MODEL.lunhuiLevel(t)==e)return j_.MODEL.maxRefineLevel(t);return 0},t.getRefineMatis=function(e,t){for(var i=[],n=this.getSamEquipsInBag(),s=0;s<n.length;s++){for(var o=n[s],a=this.getPosByCfg(o),r=!1,l=0;l<gR.ins.actorList.length;l++){var c=gR.ins.actorList[l];if(c&&(!c||c.equips)){var u=c.equips.getPart(a);u&&this.getSamLevelByDto(u)>=this.getSamLevelByDto(o)&&c.job==this.getJobByCfg(o)&&(r=!0)}}r&&i.push(o)}return i.sort(this.sortByRefineValue),i},t.sortByRefineValue=function(e,t){return modules.actor.others.SamEquipData.ins.getRefineValue(e)-modules.actor.others.SamEquipData.ins.getRefineValue(t)},t.getRefineValue=function(e){for(var t=0,i=0;i<q_.count;i++)if(q_.MODEL.goodsId(i)==e.goodsId){t=q_.MODEL.addRefineValue(i);break}return t},t.getCanUpLvlNum=function(e,t,i,n,s){var o=0,a=modules.actor.others.SamEquipData.ins.getRefineInfoPos(t,i);if(!a)return 0;var r=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(a.level,i),l=s.equips.getPart(i),c=this.getSamLevelByDto(l),u=this.getLimLvlBySamLvl(c);if(u<=n)return 0;for(;r<=e&&(e-=r,!(u<=n+ ++o));)r=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(n+o,i);return o},t.getMaxValueByLvl=function(e,t){for(var i=0,n=0;n<W_.count;n++)if(W_.MODEL.position(n)==t&&W_.MODEL.refineLevel(n)==e){i=W_.MODEL.refineMaxValue(n);break}return i},t.checkCanAdd=function(e,t,i,n,s,o){var a=0,r=modules.actor.others.SamEquipData.ins.getRefineInfoPos(i,n);if(!r)return 0;var l=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(r.level,n),c=o.equips.getPart(n),u=this.getSamLevelByDto(c),d=this.getLimLvlBySamLvl(u);if(d<s)return!1;if(s==d)return!1;for(;l<t;)t-=l,a++,l=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(r.level+a,n);return!(d<=s+a)},t.checkAddedIsMax=function(e,t,i,n,s){var o=0,a=modules.actor.others.SamEquipData.ins.getRefineInfoPos(i,n);if(!a)return 0;var r=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(a.level,n),l=this.getMaxLvl();if(l<s)return!1;if(s==l)return!1;for(;r<t;)t-=r,o++,r=modules.actor.others.SamEquipData.ins.getMaxValueByLvl(a.level+o,n);return!(l<=s+o)},t.getRefineRPtStatusByActor=function(e,t){for(var i={},n=0;n<8;n++){var s=la.SAMSARA_EQUIPS[n],o=e.equips.getPart(s);if(o){var a=this.getRefineInfoPos(t,s);if(a)if(a.level>=this.getLimLvlBySamLvl(this.getSamLevelByDto(o)))i[s]=!1;else{for(var r=this.getRefineMatis(e,s),l=a.value,c=0;c<r.length;c++)l+=this.getRefineValue(r[c]);i[s]=l>=this.getMaxValueByLvl(a.level,s)}else i[s]=!1}else i[s]=!1}return i},t.getRefineFightByActor=function(e){var t=0;if(!this._refineInfo)return 0;var i=this._refineInfo[e];if(!i)return 0;for(var n=0 in i)if(i[n]){var s=this.getRefineAttrPos(e,n);t+=RR.getFight(s)}return Math.ceil(t)},p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,f(e,["gray",function(){return this.gray=new ys([.5,0,0,0,1.75,0,.5,0,0,1.75,0,0,.5,0,1.75,0,0,0,1,0])}]),e}(),IR=function(){function e(){this._lstEquips=null,this._maxLevel=0,this.init()}b(e,"modules.actor.others.SoaringInteriorData");var t=e.prototype;return t.init=function(){this._lstEquips=[];for(var e=0;e<Bi.count;e++){var t=Bi.MODEL.key(e);if(ca.isSoaringInteriors(t)){var i=Bi.MODEL.flyUpJewelryLevel(e),n=Bi.MODEL.decoratePosition(e),s=Bi.MODEL.roleTypeId(e),o=KH.create(t);this._lstEquips.hasOwnProperty(s)||(this._lstEquips[s]=[]),this._lstEquips[s].hasOwnProperty(i)||(this._lstEquips[s][i]=[]),this._lstEquips[s][i].hasOwnProperty(n)||(this._lstEquips[s][i][n]=o),i>this._maxLevel&&(this._maxLevel=i)}}},t.getAbleWearEquips=function(e){var t=[],i=$e.MODEL.value($e.getIndex(207)),n=JSON.parse(i);if(n.flyUpLevel&&gR.ins.actorFlyUpLevel<n.flyUpLevel)return t;var s,o=modules.actor.others.SoaringInteriorData.ins.getBagSoaringInteriors;for(var a in o)if((s=o[a]).roleJob==e.job||0==s.roleJob){var r=Bi.MODEL.minUseLevel(s.cfgIdx),l=Bi.MODEL.flyLevel(s.cfgIdx);if(!(r>gR.ins.lv||l>gR.ins.zsLv)){var c=Bi.MODEL.decoratePosition(s.cfgIdx),u=e.equips.getPart(c);null!=u&&u.flyUpJewelryLevel>=s.flyUpJewelryLevel||(t.hasOwnProperty(s.decoratePosition)?t[s.decoratePosition].flyUpJewelryLevel<s.flyUpJewelryLevel&&(t[s.decoratePosition]=s):t[s.decoratePosition]=s)}}return t},t.getInteriorSuitData=function(e){var t=[];if(null==e)return t;for(var i=0;i<la.SOARING_INTERIOR_UI_POS.length;i++){var n=la.SOARING_INTERIOR_UI_POS[i],s=e.equips.getPart(n);if(null!=s&&0<s.flyUpJewelryLevel)for(var o=s.flyUpJewelryLevel,a=1;a<=o;a++)t.hasOwnProperty(a)||(t[a]=0),t[a]++}return t},t.getInteriorGradeEquipByPos=function(e,t,i){return this.lstEquips[e][t][i]},t.getBetterEquips=function(e,t){var i=gR.ins.actorByJob(e);if(null!=i){var n=this.getAbleWearEquips(i);if(n.hasOwnProperty(t))return n[t]}return null},p(0,t,"lstEquips",function(){return this._lstEquips}),p(0,t,"maxLevel",function(){return this._maxLevel}),p(0,t,"getBagSoaringInteriors",function(){for(var e=[],t=TR.bagModel.goodsList,i=0;i<t.length;i++){var n=t[i];ca.isSoaringInteriors(n.goodsId)&&e.push(n)}return e}),p(0,t,"isShowCompoundPt",function(){return!1}),p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e}(),bR=function(){function e(){}return b(e,"modules.actor.others.SoaringReqUtil"),e.reqEnter=function(e){jR.reqEntry(e)},e.reqCompound=function(e){OR.requestExchange(AR.ins.getExchangeConfigId(e))},e.reqWear=function(e,t){var i=new pA;i.roleIndex=e,i.modelId=t,Tu.sendToService(i)},e.reqWearInterior=function(e,t){var i=new XO;i.roleIndex=e,i.uuid=t,Tu.sendToService(i)},e.reqUnpack=function(e,t){var i=new zO;i.roleIndex=e,i.position=t,Tu.sendToService(i)},e.reqSoaringData=function(){var e=new oP;Tu.sendToService(e)},e.reqOpenResoveSign=function(){var e=new rP;Tu.sendToService(e)},e.reqFlyByZones=function(){var e=new aP;e._missionId=modules.actor.others.SoaringReqUtil.copyId,Tu.sendToService(e)},e.reqPoistionGrow=function(e,t){var i=AR.ins.getSuitGrowConfigIndex(e);if(-1==i)throw new Error(RP.n[31]);var n=new lP;n.actorId=t,n.resId=Rs.MODEL.key(i),Tu.sendToService(n)},e.reqSkillActive=function(e){var t=new cP;t.actorId=e,Tu.sendToService(t)},e.selectedId=-1,e.copyId=-1,e.npcBB=RP.n[32],e.isSucess=!1,e}(),wR=function(){function e(){this._redP=null,this.posH=null,this._minStepH=null,this._rolePt=!1,this.isActivitingWing=!1,e._ins&&pt.window.alert("SWingData not new"),this.init()}b(e,"modules.actor.others.SWingData");var t=e.prototype;return t.getMinStep=function(e){return this._minStepH||this.initData(),this._minStepH.take(e)},t.getBetter=function(e,t){var i=la.SWING.indexOf(t);return this._redP[e-1][i]},t.getMasterId=function(e){this.getMinStepAllEquip(e);return 0},t.getMinStepAllEquip=function(e){for(var t,i=0,n=-1,s=0;s<la.SWING.length;s++){if(!(t=MR.ins.getEquip(e,la.SWING[s])))return 0;i=yo.MODEL.level(yo.getIndex(t.goodsId)),n=-1==n?i:i<n?i:n}return n},t.getSkillId=function(e){this.getMinStepAllEquip(e);return 0},t.getNumByStep=function(e,t){for(var i,n=0,s=0;s<la.SWING.length;s++)(i=MR.ins.getEquip(e,la.SWING[s]))&&!(yo.MODEL.level(yo.getIndex(i.goodsId))<t)&&n++;return n},t.getForceByRole=function(e){for(var t,i=0,n=0;n<la.SWING.length;n++)(t=MR.ins.getEquip(e,la.SWING[n]))&&(i+=t.fight);return i},t.checkRedPt=function(){var e,t,i,n=0,s=0,o=0,a=0;for(this._rolePt=!1,this._redP=[[],[],[]],n=0;n<this._redP.length;n++)for(s=0;s<la.SWING.length;s++)this._redP[n][s]=null;for(n=0;n<TR.bagModel.goodsList.length;n++)if((e=TR.bagModel.goodsList[n])instanceof protos.backpack.DtoEquip&&(o=Bi.MODEL.decoratePosition(e.cfgIdx),-1!=(a=la.SWING.indexOf(o))))for(s=0;s<gR.ins.actorList.length;s++){t=gR.ins.actorList[s],yo.MODEL.levelLimit(yo.getIndex(e.goodsId))>t.wingData.wingStep||(null==(i=MR.ins.getEquip(t.id,o))||e.goodsId>i.goodsId)&&(this._rolePt=!0,null==this._redP[s][a]?this._redP[s][a]=e:this._redP[s][a].goodsId<e.goodsId&&(this._redP[s][a]=e))}},t.itemIsTop=function(e,t){this.posH||this.initData();var i=this.posH.take(e);return i.indexOf(t)==i.length-1},t.init=function(){},t.initData=function(){this.posH=new jl,this._minStepH=new jl;for(var e,t=0,i=0;i<vo.count;i++)t=vo.MODEL.type(i),this.posH.has(t)?e=this.posH.take(t):(e=[],this.posH.put(t,e,!0)),e[vo.MODEL.level(i)-1]=vo.MODEL.itemId(i),this._minStepH.has(t)?this._minStepH.take(t)>vo.MODEL.level(i)&&this._minStepH.put(t,vo.MODEL.level(i),!0):this._minStepH.put(t,vo.MODEL.level(i))},t.getMasterLvByRoleIndex=function(e){return this.getMasterId(e)},t.getCombime=function(){for(var e=vo.count,t=0,i=0,n=0,s=0;s<e;s++){t=vo.MODEL.exchangeID(s);var o=JSON.parse(xa.MODEL.consumption(xa.getIndex(t)))[0].value.split(":");i=parseInt(o[0]),n=parseInt(o[1]);var a=TR.ins.getGoodsNum(i);if(0<n&&n<=a)return!0}return!1},p(0,t,"rolePt",function(){return this._rolePt}),p(1,e,"ins",function(){return e._ins?e._ins:e._ins=new e}),e.GOD_WING_SKILL_MAXlEVEL=2,e._ins=null,e}(),xR=function(){function e(){var e=this;e.activeHandler=!1,e.curWingExp=0,e.costItemId=0,e.costItemNum=0,e.cost=0,e.wingStep=0,e.wingStar=0,e.totalWingExp=0,e.wingMID=null,e.nextAttr=null,e.curAttr=null,e.wearStep=0,e.skillArr=null,e.starUp=!1,e.levelUp=!1,e.isTop=!1,e.isMaxLevel=!1,e.mid=null,e._id=0,e._force=0,e._canLvup=!1,e._copperAdd=0,e.zhizidan=0,e.feishengdan=0}b(e,"modules.actor.others.WingData");var t=e.prototype;return t.itemCost=function(e){var t=e.split(":");this.costItemId=t[0],this.costItemNum=t[1]},p(0,t,"id",function(){return this._id},function(e){var t,i=[],n=-1,s=0;if(0==(this._id=e))s=$s.getIndex(1),this.curAttr=$s.MODEL.attr(s),this.nextAttr=$s.MODEL.attr(s+1),this.isTop=!1,i=(t=JSON.parse($s.MODEL.consumeDef(e))[0].value).split(":"),this.skillArr=[],this.cost=parseInt(i[1]),this.itemCost(t),this.mid=mo.MODEL.avatarId(this.wingStep),this.totalWingExp=$s.MODEL.exp(s);else{n=$s.getIndex(e),this.isTop=e+1>$s.count,this.wingStep=$s.MODEL.tier(n),this.wingStar=$s.MODEL.level(n),this.isTop?(this.totalWingExp=$s.MODEL.exp(n),this.cost=0,this._canLvup=!1):(s=$s.getIndex(e+1),this.nextAttr=$s.MODEL.attr(s),this.totalWingExp=$s.MODEL.exp(n),i=(t=JSON.parse($s.MODEL.consumeDef(n))[0].value).split(":"),this.cost=parseInt(i[1]),this.itemCost(t)),this.skillArr=$s.MODEL.pasSkillId(n),this.curAttr=$s.MODEL.attr(n),this.mid=mo.MODEL.avatarId(this.wingStep)+"";$s.MODEL.attr(n)}this.wingMID=mo.MODEL.jmId(mo.getIndex(this.wingStep))}),p(0,t,"force",function(){return this._force}),p(0,t,"copperLvUp",function(){var e=Math.ceil((this.totalWingExp-this.curWingExp)/this._copperAdd)*this.cost;return 0!=e&&e<=gR.ins.coin}),p(0,t,"itemLvUp",function(){return this.costItemNum<=TR.ins.getGoodsNum(this.costItemId)}),p(0,t,"showTip",function(){return 0<TR.ins.getGoodsNum(2536)&&$s.MODEL.flyLimit($s.getIndex(this._id))>this.feishengdan||(0<TR.ins.getGoodsNum(2537)&&$s.MODEL.apLimit($s.getIndex(this._id))>this.zhizidan||this.itemLvUp&&!this.isTop)}),e.getIdByStepAndLevel=function(e,t){var i=0,n=0;if(0==e&&0==t)n=-1;else for(i=0;i<$s.count;i++){var s=$s.MODEL.tier(i),o=$s.MODEL.level(i);if(s==e&&o==t){n=i;break}}return n+1},e.TOTAL_STAR=10,e}(),SR=function(){function c(){}return b(c,"modules.actor.others.YuPeiDataModel"),p(1,c,"isUpgradeSuccess",function(){return modules.actor.others.YuPeiDataModel._isUpgradeSuccess},function(e){modules.actor.others.YuPeiDataModel._isUpgradeSuccess=e}),c.isMaxLevel=function(e){return 10===Kn.MODEL.level(e)},c.isMaxByIndex=function(e){return e===Kn.count-1},c.isMaxByLevelAndTier=function(e,t){var i=modules.actor.others.YuPeiDataModel.getCurrentID(e,t),n=Kn.getIndex(i);return modules.actor.others.YuPeiDataModel.isMaxByIndex(n)},c.getCurrentID=function(e,t){return 11*(e-1)+t+1},c.getAttrValue=function(e,t){var i=0;if("ATK"==t?i=0:"CRI"==t?i=1:"CRI_QD_RATE"==t&&(i=2),e){var n=e[i];if(n.type&&n.type==t&&"YUPEI"==n.module&&n.value)return n.value}return 0},c.isSkillActived=function(e,t){return modules.actor.others.YuPeiDataModel.yupeiHash.take(e).steps>=c.unlockSkillStep[t]},c.getUnlockSkillStr=function(e){var t="（<font color='#ff2e24'>";return(t+=c.unlockSkillStep[e])+RP.n[33]},c.getYuPeiRed=function(){if(!modules.actor.others.YuPeiDataModel.isOpen())return!1;if(!c.yupeiHash)return!1;var e;for(var t in c.yupeiHash.proto)if(e=c.yupeiHash.proto[t],c.getRedByActorId(e.actorId))return!0;return!1},c.isOpen=function(){var e=gR.ins.lv,t=dr.getOpenServiceDay(),i=$e.MODEL.value($e.getIndex(173)).split(","),n=parseInt(i[0]),s=parseInt(i[1]);return n<=t&&s<=e},c.getRedByActorId=function(e){if(!modules.actor.others.YuPeiDataModel.isOpen())return!1;if(!c.yupeiHash||!c.yupeiHash.take(e))return!1;var t;e==c.roleID&&(t=c.getRealData()),t=t||c.yupeiHash.take(e);var i=c.getCurrentID(t.steps,t.level),n=Kn.getIndex(i);if(!c.isMaxByIndex(n)){if(c.isMaxLevel(n))return!0;if(0<c.getMaterialNum(0)||0<c.getMaterialNum(1)||0<c.getMaterialNum(2))return!0}return!1},c.getMaterialNum=function(e){return e=e||modules.actor.others.YuPeiDataModel.materialIndex,TR.ins.getGoodsNum(c.materialIDs[e])},c.refreshRedPointCimecial=function(){Tu.sendToModule("UPDATE_YUPEI_MATERIAL",["modules.actor.ActorModule"])},c.reqInfo=function(){var e=new JD;Tu.sendToService(e)},c.reqUpdateLevel=function(e,t){var i=new ZD;i.actorId=e,i.materialId=t,Tu.sendToService(i)},c.reqUpdateTier=function(e){var t=new KD;t.actorId=e,Tu.sendToService(t)},c.newDatas=function(e){c.clearFakeDatas(),c._realData=e,c._fakeDataArray.push(e);var t=c.yupeiHash.take(c.roleID),i=c.getCurrentID(t.steps,t.level),n=c.getCurrentID(e.steps,e.level),s=n-2;if(0<=s&&(e.level!=t.level||e.steps!=t.steps)){var o=Kn.MODEL.experience(s),a=Kn.MODEL.level(s),r=Kn.MODEL.tier(s);for(n--;i<n||n==i&&o>t.exp;){var l=new TT;l.steps=r,l.level=a,l.exp=o,c._fakeDataArray.push(l),s--,o=Kn.MODEL.experience(s),a=Kn.MODEL.level(s),r=Kn.MODEL.tier(s),n=s+1}}},c.getFakeData=function(){return c._fakeDataArray||(c._fakeDataArray=[]),c._fakeDataArray.pop()},c.clearFakeDatas=function(){c._fakeDataArray?c._fakeDataArray.length=0:c._fakeDataArray=[],c._realData=null},c.getRealData=function(){return c._realData?c._realData:c._fakeDataArray&&0<c._fakeDataArray.length?c._fakeDataArray[0]:modules.actor.others.YuPeiDataModel.yupeiHash?c.yupeiHash.take(c.roleID):null},c.yupeiHash=null,c.roleID=0,c.materialIndex=0,c._isUpgradeSuccess=!1,c._fakeDataArray=null,c._realData=null,f(c,["skillIDs",function(){return this.skillIDs=[227,229,231,233,235]},"materialIDs",function(){return this.materialIDs=[2071,2072,2073]},"unlockSkillStep",function(){return this.unlockSkillStep=[10,19,28,37,45]}]),c}(),kR=function(){function e(){this.toc_arena=null,this.toc_arena_pre=null,this.toc_rank=null,this.toc_preRank=null,this.toc_extra=null,this.toc_red=null,this.isMatching=!1}b(e,"modules.arena.others.ArenaManager");var t=e.prototype;return t.getPurchaseCost=function(e){for(var t=Mt.count,i=0;i<t;i++)if(e>=Mt.MODEL.minPurchase(i)&&e<=Mt.MODEL.maxPurchase(i))return Mt.MODEL.costGold(i);return 0},t.getDailyZhanji=function(e){for(var t="",i=At.count,n=0;n<i;n++)if("DailyClass"==At.MODEL.rewardType(n)&&At.MODEL.param(n)==e+""){t=At.MODEL.resourceReward(n);break}if(null==t||0==t.length)return 0;var s=aR.getMoneysByStr(t);return s.ZHANJI?s.ZHANJI:0},t.getWeeklyGoods=function(e){for(var t=At.count,i=0;i<t;i++)if("WeeklyClass"==At.MODEL.rewardType(i)&&At.MODEL.param(i)==e+"")return At.MODEL.goodsReward(i);return""},t.getDiamondExtraGoods=function(e){for(var t=At.count,i=0;i<t;i++)if("DiamondExtra"==At.MODEL.rewardType(i)&&At.MODEL.param(i)==e+"")return At.MODEL.goodsReward(i);return""},t.getDiamondExtras=function(){for(var e=[],t=At.count,i=0;i<t;i++)"DiamondExtra"==At.MODEL.rewardType(i)&&e.push(i);return e},t.getEachFightIdx=function(e){for(var t=At.count,i=0;i<t;i++)if("EachFight"==At.MODEL.rewardType(i)){if(e&&"1"==At.MODEL.param(i))return i;if(!e&&"0"==At.MODEL.param(i))return i}return-1},p(1,e,"ins",function(){return e._inst=e._inst||new e}),e._inst=null,e}(),ER=function(){function t(){var e=this;e._cansetM=!0,e.hideMe=!1,e.hideOther=!1,e.hideZhen=!1,e.hideHeji=!1,e._hejiAutoObj=null,e.isClickedHeJi=!1,e.isAutoZhuiJi=!1,e.autoZhuiJiStr="",e.unionLocalObject=null}b(t,"modules.assit.AssitData");var e=t.prototype;return e.formateHeJi=function(e){var t;return null==e?((t=new Object)[3]=1,t[4]=1,t[6]=1,t[7]=1,t[11]=1,t[12]=1,t[13]=1,t[14]=1,t[15]=1,t[16]=1,t[20]=1,t[21]=1,t[23]=1,t[24]=1,t[25]=1,t[26]=1,t[28]=1,t[31]=1,t[32]=1,t[34]=1,t[41]=1,t[42]=1,t[43]=1,t[45]=1,t[44]=1,t[46]=1,t[47]=1,t[48]=1,t[49]=1,t[50]=1,t[51]=1,t[52]=1,t[53]=1,t[54]=1,t[57]=1,t[58]=1):t=JSON.parse(e),t},e.getHeJiSettiongByCate=function(e){return null==this._hejiAutoObj?0:this._hejiAutoObj[e]},e.updateHeJiChange=function(){var e=rn.getIndex(BR.ins.curCopyId),t=rn.MODEL.cate(e);2==this._hejiAutoObj[t]?this._hejiAutoObj[t]=1:1==this._hejiAutoObj[t]&&(this._hejiAutoObj[t]=2),modules.assit.AssitData.ins.requestSaveSetting()},e.update10121=function(e){var t=!1;if(""==e.autoHeJi)t=!0,this._hejiAutoObj=this.formateHeJi(null);else{var i=this.formateHeJi(null);for(var n=0 in this._hejiAutoObj=JSON.parse(e.autoHeJi),i){var s=i[n];this._hejiAutoObj.hasOwnProperty(n)||(this._hejiAutoObj[n]=s,t=!0)}}this.isAutoZhuiJi=e.isAutoZhuiJi,this.autoZhuiJiStr=e.autoZhuiJiStr,t&&modules.assit.AssitData.ins.requestSaveSetting()},e.requestSaveSetting=function(){var e=new de;e.autoHeJi=JSON.stringify(this._hejiAutoObj),e.isAutoZhuiJi=this.isAutoZhuiJi,e.autoZhuiJiStr=this.autoZhuiJiStr,Tu.sendToService(e)},e.encode=function(e){if(""==e)return UB.ins.musicVolume=1,void(UB.ins.soundVolume=1);var t=e.split(",");this.hideMe=1==t[1],this.hideOther=1==t[2],BB.heidOtherHeroMode=this.hideMe,BB.heidOtherCharMode=this.hideOther,UB.ins.musicVolume=t[3],UB.ins.soundVolume=t[4],this.hideZhen=1==t[5],this.hideHeji=1==t[6],this.cansetM=1==t[0]},e.decode=function(){var e;return e=this.cansetM?"1,":"0,",e+=this.hideMe?"1,":"0,",e+=this.hideOther?"1,":"0,",e+=UB.ins.musicVolume+",",e+=UB.ins.soundVolume+",",e+=this.hideZhen?"1,":"0,",e+=this.hideHeji?"1,":"0,"},e.unionLocalStorage=function(e){var t,i=this;if(i.unionLocalObject||(i.unionLocalObject={},i.unionLocalObject[3]=1,i.unionLocalObject[4]=1,i.unionLocalObject[6]=1,i.unionLocalObject[7]=1,i.unionLocalObject[11]=1,i.unionLocalObject[12]=1,i.unionLocalObject[13]=1,i.unionLocalObject[14]=1,i.unionLocalObject[15]=1,i.unionLocalObject[16]=1,i.unionLocalObject[20]=1,i.unionLocalObject[21]=1,i.unionLocalObject[23]=1,i.unionLocalObject[24]=1,i.unionLocalObject[25]=1,i.unionLocalObject[26]=1,i.unionLocalObject[28]=1,i.unionLocalObject[31]=1,i.unionLocalObject[30]=1,i.unionLocalObject[32]=1,i.unionLocalObject[34]=1,i.unionLocalObject[41]=1,i.unionLocalObject[42]=1,i.unionLocalObject[43]=1,i.unionLocalObject[45]=1,i.unionLocalObject[46]=1,i.unionLocalObject[47]=1,i.unionLocalObject[48]=1,i.unionLocalObject[49]=1,i.unionLocalObject[50]=1,i.unionLocalObject[51]=1,i.unionLocalObject[52]=1,i.unionLocalObject[53]=1,i.unionLocalObject[54]=1,i.unionLocalObject[57]=1,i.unionLocalObject[58]=1),e)for(var n in t=JSON.parse(e))i.unionLocalObject[n]=t[n];bc.setItem("uniconSett",JSON.stringify(i.unionLocalObject))},e.getUnionLocalStorage=function(e){return this.unionLocalObject[e]?this.unionLocalObject[e]:0},e.changeUnion=function(){var e=rn.getIndex(BR.ins.curCopyId),t=rn.MODEL.cate(e);2==this.unionLocalObject[t]?this.unionLocalObject[t]=1:1==this.unionLocalObject[t]&&(this.unionLocalObject[t]=2),bc.setItem("uniconSett",JSON.stringify(this.unionLocalObject))},e.canHideOtherChars=function(){return ZN.isSynchScene()||uH.Ins().currCid==_a.S_WorldBoss.toString()||dr.dtoEnterScene&&(7==dr.dtoEnterScene.type||14==dr.dtoEnterScene.type||17==dr.dtoEnterScene.type||26==dr.dtoEnterScene.type||49==dr.dtoEnterScene.type||27==dr.dtoEnterScene.type||21==dr.dtoEnterScene.type||20==dr.dtoEnterScene.type||46==dr.dtoEnterScene.type||47==dr.dtoEnterScene.type||41==dr.dtoEnterScene.type||42==dr.dtoEnterScene.type||50==dr.dtoEnterScene.type||45==dr.dtoEnterScene.type||52==dr.dtoEnterScene.type||51==dr.dtoEnterScene.type||53==dr.dtoEnterScene.type||54==dr.dtoEnterScene.type||56==dr.dtoEnterScene.type||57==dr.dtoEnterScene.type)},e.getHideChar=function(e){var t=!1,i=!1;return e instanceof zwc.engine.core.displays.world.char.MainChar?t=e.type!=Za.MAIN_CHAR&&e.type!=Za.HERO:i=e.ai?e.hero_id.toString()+NF.mainChar.objectId.toString()!=e.char_id:e.type==Za.CHAR||e.type==Za.HERO,i||t},e.interruptAvatarResourceLoad=function(e){if(BB.heidOtherCharMode&&e&&e.owner&&e.owner instanceof zwc.engine.core.displays.world.char.Char){var t=e.owner;if(this.getHideChar(t)&&!t.aunit._mainActData_&&this.canHideOtherChars())return!0}return!1},e.goOnAvatarResourceLoad=function(){for(var e=0;e<zN.charQueue.length;e++){var t=zN.charQueue[e];t&&this.getHideChar(t)&&(t.isCharMode&&t.updateTitles(),ZN.updateCharDisplay(t,t.mid,t.wid,t.wgid,t.eid,t.chuanshiid,t.magicId,t.dragonEffid))}},e.clearHideOtherAvatarTexture=function(){for(var e=0;e<zN.charQueue.length;e++){var t=zN.charQueue[e];t&&this.getHideChar(t)&&t.graphics.clear(!0)}},p(0,e,"cansetM",function(){return this._cansetM},function(e){this._cansetM=e,UB.ins.muted=!this._cansetM,t.reqSave()}),p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins}),t.reqSave=function(){var e=new hL;e.reqStr=modules.assit.AssitData.ins.decode(),Tu.sendToService(e)},t.MAX_OFF_LINE=3e4,t._ins=null,t.UNION_SETTING="uniconSett",t}(),TR=function(){function a(){var e=this;e.gridNum=0,e.forRed=!1,e.mulFly=!1,e.allList=null,e.isInitBag=!1,e.reHash=null,e.posHash=null,e._desHash=null,e.isChange=!1,e.firstChargeBoxClickArr=null,e.goodtimesHash=null,e.selectGoodsId=-1,e.goodtimesHash=new jl,e.firstChargeBoxClickArr=[],e.reHash=new jl,e.posHash=new jl,e._desHash=new jl,e.allList=[a.bagModel,uB.treasureModel,a.dragonModel,uB.equipModel,uB.longwenModel,uB.chuanshiModel,uB.mysticalModel,uB.hefuTrModel,_R.moEquipModel]}b(a,"modules.backpack.others.BackPackData");var e=a.prototype;return e.initGoods=function(e){var t,i,n;for(var s in this.allList)(t=this.allList[s]).reset();for(i in gR.ins.actorList)gR.ins.actorList[i].equips.reset();for(var o in e)n=e[o],null!=(t=this.getModel(n))&&t.add(n,!1);this.isInitBag?Tu.sendToTotalModule("BP_UPDATE",null):(this.isInitBag=!0,Tu.sendToTotalModule("BP_INIT",null))},e.updateGoods=function(e,t){void 0===t&&(t=!0);var i,n,s,o=[],a=!1;for(var r in e)s=e[r],a=!0,i=this.getModelByUUID(s.uuId),n=this.getModel(s),i&&i!=n&&(i.remove(s.uuId),be.add(o,i),a=i.crossNotify),n.add(s,a),be.add(o,n);if(t)for(var l in o)o[l].notify()},e.deleteGoods=function(e){var t,i,n,s=[];for(var o in e)i=e[o],(t=this.getModelByUUID(i))?(t.remove(i),be.add(s,t)):console.error(RP.n[34],i);for(n in s)(t=s[n]).notify()},e.getBackPackEquips=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=0);var i,n=[];for(var s in a.bagModel.goodsList){i=a.bagModel.goodsList[s];var o=LR.getIsDragon(i.goodsId);i instanceof protos.backpack.DtoEquip&&0==o&&(0<e?e==i.decoratePosition&&n.push(i):(0<t&&i.equipType,n.push(i)))}return n},e.getPackGodWeaponHolys=function(){var e,t=[];for(var i in a.bagModel.goodsList)4==(e=a.bagModel.goodsList[i]).subType&&t.push(e);return t},e.getPackEgg=function(){var e,t=[];for(var i in a.bagModel.goodsList)34==(e=a.bagModel.goodsList[i]).subType&&t.push(e);return t},e.getBackPackFuWen=function(){var e,t=[];for(var i in a.bagModel.goodsList)(e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoGoods&&6==e.subType&&t.push(e);return t},e.getBackPackItems=function(){var e,t=[];for(var i in a.bagModel.goodsList)(e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoEquip||t.push(e);return t},e.getClothesItems=function(){var e,t=[];for(var i in a.bagModel.goodsList){if(!((e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoEquip))0<=Ii.getIndex(e.goodsId)&&t.push(e)}return t},e.getBackPackCS=function(){var e,t=[];for(var i in a.bagModel.goodsList)if(!((e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoEquip)){var n=Bi.getIndex(e.goodsId);1==Bi.MODEL.isChuanShiEqu(n)&&t.push(e)}return t},e.getBackPackTalentBook=function(){var e,t=[];for(var i in a.bagModel.goodsList)if(!((e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoEquip)){var n=Bi.getIndex(e.goodsId);30==Bi.MODEL.subType(n)&&t.push(e)}return t},e.getBackPackMoEquip=function(){var e,t=[];for(var i in a.bagModel.goodsList)if((e=a.bagModel.goodsList[i])instanceof protos.backpack.DtoEquip){var n=Bi.getIndex(e.goodsId);_R.isMoEquipByType(Bi.MODEL.equipType(n))&&t.push(e)}return t},e.getBackPackLongWens=function(){var e,t=[];for(var i in a.dragonModel.goodsList){e=a.dragonModel.goodsList[i];var n=LR.getIsDragon(e.goodsId);e instanceof protos.backpack.DtoEquip&&1==n&&t.push(e)}return t},e.getBackPackLongWensFiltersame=function(){var e,t=new jl;for(var i in a.dragonModel.goodsList){e=a.dragonModel.goodsList[i];var n=LR.getIsDragon(e.goodsId);if(e instanceof protos.backpack.DtoEquip&&1==n){var s=jt.MODEL.itemId(e.dragonIndex-1),o=jt.MODEL.level(e.dragonIndex-1);t.put(s+"_"+o,e,!0)}}return t},e.getLongWenNum=function(e){var t,i=0;for(var n in a.dragonModel.goodsList)(t=a.dragonModel.goodsList[n]).goodsId==e&&(i+=t.goodsNum);return i},e.getBackPackDragonTools=function(){var e,t=[];for(var i in a.dragonModel.goodsList)e=a.dragonModel.goodsList[i],-1!=ca.DRAGON_JINGHUA_IDS.indexOf(e.goodsId)&&t.push(e);return t},e.getBetterWearableEquips=function(e){var t,i=[];for(var n in a.bagModel.goodsList)t=a.bagModel.goodsList[n],e&&-1==e.indexOf(Bi.MODEL.decoratePosition(t.cfgIdx))||t instanceof protos.backpack.DtoEquip&&MR.ins.isBetter2Wear(t)&&i.push(t);return i},e.getBetterEquip=function(e,t){var i,n=MR.ins.getEquip(e.id,t),s=null;for(var o in a.bagModel.goodsList)(i=a.bagModel.goodsList[o])instanceof protos.backpack.DtoEquip&&PR.dressAble(e,i,t)&&(s?PR.betterThan(i,s)&&(s=i):n?PR.betterThan(i,n)&&(s=i):s=i);return s},e.hasBetterEquip=function(e,t,i){var n,s=MR.ins.getEquip(e.id,t);for(var o in a.bagModel.goodsList)if(n=a.bagModel.goodsList[o],!(i&&0<=i.indexOf(n))&&n instanceof protos.backpack.DtoEquip&&PR.dressAble(e,n,t)&&(!s||PR.betterThan(n,s)))return i&&i.push(n),!0;return!1},e.hasEmptyNum=function(e){return this.getLeftGridNum()>=e},e.getGoodsNum=function(e){var t,i=0;for(var n in a.bagModel.goodsList)(t=a.bagModel.goodsList[n]).goodsId==e&&(i+=t.goodsNum);return i},e.getGoodsUseNum=function(e){var t,i=0;for(var n in a.bagModel.goodsList)(t=a.bagModel.goodsList[n]).goodsId==e&&(i=t.usedCountDay);return i},e.getGoodsDto=function(e){var t;for(var i in a.bagModel.goodsList)if((t=a.bagModel.goodsList[i]).goodsId==e)return t;return null},e.isShowRecycleTip=function(){var e=this.getBackPackEquips().length,t=0<modules.backpack.others.BackPackData.ins.getRecycleEquips(la.NORMAL,9).length,i=this.getLeftGridNum(),n=gR.ins.lv;return 55<n&&i<=50&&t||n<=55&&50<=e&&t},e.getRecycleEquips=function(e,t,i){void 0===t&&(t=-1);var n=this.getBackPackEquips();n.sort(function(e,t){return Bi.MODEL.colourId(e.cfgIdx)<=Bi.MODEL.colourId(t.cfgIdx)?1:-1});var s,o=[],a=[],r=0,l=0,c=0,u=0,d=[],h=[],_=new jo;for(var f in n)if(1!=(s=n[f]).equipType){if(null!=i){if(!i(s))continue}else{if(-1==e.indexOf(Bi.MODEL.decoratePosition(s.cfgIdx)))continue;if(!Bi.MODEL.recycleResAward(s.cfgIdx)&&!Bi.MODEL.recycleGoodsAward(s.cfgIdx))continue}if(MR.ins.isBetter(s)){if(51==Bi.MODEL.decoratePosition(s.cfgIdx)){h.push(s);continue}for(var p=0;p<gR.ins.actorList.length;p++){var g=Bi.MODEL.decoratePosition(s.cfgIdx),v=gR.ins.actorList[p];s.goodsId;if(PR.dressAble(v,s,g)){var m=_.get(g);m||(m={},_.set(g,m));var y=this.getWeak(s,m);y&&be.add(o,y)}else if(r=Bi.MODEL.minUseLevel(s.cfgIdx),l=Bi.MODEL.flyLevel(s.cfgIdx),u=Bi.MODEL.decoratePosition(s.cfgIdx),c=0<l?l:r,this.posHash=this.reHash.take(c),this.posHash)if(a=this.posHash.take(u)){var I;for(var b in d=[],a)I=a[b],d.push(I.uuId);-1==d.indexOf(s.uuId)&&a.push(s),this.posHash.put(u,a,!0)}else(a=[]).push(s),this.posHash.put(u,a);else this.posHash=new jl,this.reHash.put(c,this.posHash),(a=[]).push(s),this.posHash.put(u,a)}}else o.push(s);if(0<t&&o.length>=t)break}var w=gR.ins.actorList.length;if(h&&0<h.length){h.sort(function(e,t){return e.sorce<=t.sorce?1:-1});for(var x=0;x<w;x++)h.shift();if(0<h.length)for(var S=0;S<h.length;S++)o.push(h[S])}var k=0,E=0;E=0<l?(k=16,1):(k=9,10);for(var T=1;T<k;T++){var C=this.reHash.take(T*E);if(C)for(var L=1;L<9;L++){var M=C.take(L);if(M&&(1<M.length&&M.sort(function(e,t){return e.sorce<=t.sorce?1:-1}),M.shift(),0<M.length))for(var A=0;A<M.length;A++)o.push(M[A])}}return _.clear(),this.reHash.reset(),this.posHash.reset(),o},e.getGoodsDes=function(e,t){var i,n,s;if(this._desHash.has(e)){s=(i=this._desHash.take(e)).des;var o=i.state;if(2==o){var a=[e,s];null!=t&&t.runWith(a)}else 1==o&&-1==(n=i.handlers).indexOf(t)&&n.push(t)}else i={state:1,handlers:n=[t]},this._desHash.put(e,i),OR.reqGoodsDes(e)},e.handleGoodsDes=function(e,t){var i,n;if(this._desHash.has(e)){for(var s in(i=this._desHash.take(e)).state=2,i.des=t,n=i.handlers)n[s].runWith([e,t]);n=[]}},e.clearGoodsDes=function(){this._desHash.reset()},e.getFuWenFenJie=function(e){void 0===e&&(e=-1);var t=this.getBackPackFuWen(),i=this.partCheck(t);return e>i.length&&(e=i.length),i.slice(0,e)},e.partCheck=function(e){var t,i,n,s=[],o=1,a=0;for(var r in e)n=e[r],o=ua.judgePart(n.goodsId),(t=iR.instance.getInfoByPart(o))&&(a=t.level),i=iR.instance.getRuneResouseByGoodID(n.goodsId),0!=a&&a>=i.level&&s.push(n);return s},e.getWeak=function(e,t){var i=Bi.MODEL.roleTypeId(e.cfgIdx),n=Bi.MODEL.flyLevel(e.cfgIdx),s=(gR.ins.zsLv,i.toString()),o=t[s];if(!o)return t[s]=[e],null;if(o.length<2&&la.isBoth(Bi.MODEL.decoratePosition(e.cfgIdx)))return o.push(e),null;for(var a=o.length-1;0<=a;a--){if(PR.betterThan(e,o[a]))e=o.splice(a,1,e)[0]}return e},e.getLeftGridNum=function(){var e=this.getBackPackEquips();return this.gridNum-e.length},e.getLeftGridNumMore20=function(e){return void 0===e&&(e=20),this.getLeftGridNum()<=e},e.hasUsableItem=function(){var e;for(var t in a.bagModel.goodsList)if(e=a.bagModel.goodsList[t],PR.isTipAble(e))return!0;return!1},e.canRecycle=function(){var e=!1;gR.ins.lv<=55?50<=this.getBackPackEquips().length&&(e=!0):this.getLeftGridNum()<=50&&(e=!0);return e},e.getModel=function(e){if(0<e.roleId&&!_R.isMoEquipByPart(e.position))return MR.roleEquip(e.roleId);var t;for(var i in this.allList)if((t=this.allList[i]).contains(e.position))return t;return null},e.getModelByUUID=function(e){var t,i;for(var n in this.allList)if((t=this.allList[n]).goodsHash.has(e))return t;for(var s in gR.ins.actorList)if((i=gR.ins.actorList[s]).equips.goodsHash.has(e))return i.equips;return null},p(1,a,"ins",function(){return null==a._instance&&(a._instance=new a),a._instance}),a.FREE_GRID_TIP=20,a.mijiFREE_GRID_TIP=50,a._instance=null,f(a,["bagModel",function(){return this.bagModel=new DR(0,0,"BP_ADD","BP_UPDATE",null)},"dragonModel",function(){return this.dragonModel=new DR(102,102,"BP_ADD","BP_UPDATE",null)}]),a}(),CR=function(){function e(){this.hasRedPoint=!1,this.bigTypeHash=new jl,this.smallTypeHash=new jl}b(e,"modules.backpack.others.BagComDataModel");var t=e.prototype;return t.getComKeys=function(e,t){var i=new Object;if(i.bType=e,i.sType=1,i.randerType=1,t)for(var n=0 in this.bigTypeHash.proto)if(this.bigTypeHash.take(n)){i.bType=n;break}for(var s in this.smallTypeHash.proto)if(parseInt(s.split("_")[0])==i.bType&&this.smallTypeHash.take(s)){i.sType=s.split("_")[1];break}for(var o=0;o<Cs.count;o++)if(Cs.MODEL.key(o)==i.bType){var a=Cs.MODEL.composeKeys(o);i.comIds=a.split("|")[i.sType-1],a=Cs.MODEL.backType(o),i.randerType=parseInt(a.split(",")[i.sType-1]);break}return i},t.findComIndex=function(e){for(var t=0,i=0,n=0,s=0,o=0,a=0;a<Ts.count;a++){var r=Ts.MODEL.target(a),l=JSON.parse(r),c=Ts.MODEL.bType(a),u=Ts.MODEL.sType(a);if(s==c&&o==u||(n=0),s<c&&0!=s&&(t++,i=0,o=u),o<u&&0!=o&&i++,l.type&&"goods"==l.type)if(e==parseInt(l.value.split(":")[0])){var d={};return d.id=Ts.MODEL.key(a),d.bType=c,d.sType=u,d.conditions=Ts.MODEL.conditions(a),d.index1=t,d.index2=i,d.index3=n,d}n++,s=c,o=u}return null},t.CPForCom=function(){if(Ts.count<=0){var e=[{url:_r.getDBPath("ComposeResource"),type:"arraybuffer"}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}else this.refreshComRedPoint()},t.onLoad=function(e){if(G.loader.getRes(e.url)&&Ts.count<=0){Ts.setup(e.url);for(var t=Ts.count,i=0;i<t;i++)Ts.config(i)}G.loader.clearRes(e.url),this.refreshComRedPoint()},t.refreshComRedPoint=function(){var e=this,t=0;for(e.bigTypeHash.reset(),e.smallTypeHash.reset(),e.hasRedPoint=!1,t=0;t<Ts.count;t++){var i=Ts.MODEL.conditions(t);if(i){var n=e.checkHasEnoughToolds(i),s=Ts.MODEL.bType(t),o=Ts.MODEL.sType(t);n&&(e.bigTypeHash.has(s)||e.bigTypeHash.put(s,n,!0),e.smallTypeHash.has(s+"_"+o)||e.smallTypeHash.put(s+"_"+o,n,!0),e.hasRedPoint=!0)}}AN.ins.updatePt(275,e.hasRedPoint)},t.checkHasEnoughToolds=function(e){var t=!1,i=[];if(e){var n=0;i=JSON.parse(e);for(var s=0;s<i.length;s++){var o=i[s].value.split(":")[0],a=i[s].value.split(":")[1];if(n=Bi.getIndex(o),!(t=a<=(1==Bi.MODEL.subType(n)||-1!=ca.DRAGON_JINGHUA_IDS.indexOf(parseInt(o+""))?TR.ins.getLongWenNum(o):TR.ins.getGoodsNum(o))))break}}return t},p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e}(),LR=function(){function e(){}return b(e,"modules.backpack.others.enum.EGoodsType"),e.getPart=function(e){if(77==e)return 1;if(78==e)return 2;var t=Bi.getIndex(e);return Bi.MODEL.decoratePosition(t)},e.judgeKind=function(e){if(e<101e4)return 0;var t=e.toString().slice(1,3);return parseInt(t)},e.getIsDragon=function(e){var t=!1,i=Bi.getIndex(e);return 1!=Bi.MODEL.subType(i)&&32!=Bi.MODEL.subType(i)||(t=!0),t},e.getIsSamsara=function(e){var t=!1,i=Bi.getIndex(e);return 18==Bi.MODEL.subType(i)&&(t=!0),t},e.PROFESSION_TYPE_ZHANSHI=1,e.PROFESSION_TYPE_FASHI=2,e.PROFESSION_TYPE_DAOSHI=3,e.PROFESSION_TYPE_WU=4,e.KIND_GOD=1,e.KIND_FUWEN=6,e.TYPE_ITEM=1,e.TYPE_EQUIP=2,e.TYPE_LONGWEN=3,e.SHEN_YU=3,e.GOD_HOLY_EQUIP=4,e.FU_WEN=5,e.SHEN_ZHUANG=9,e.COMMON_EQUIP=10,e.SZ_FRAGMENT=11,e.SY_FRAGMENT=12,e.MO_EQUIT=16,e.RED_EQUIT=15,e.RED_FRAGMENT=17,e.KIND_FAZHEN=33,e.PET_EGG=34,e.EVENT_GETBIGGIFTBAG="GetBigGiftBag",e}(),MR=function(){function n(){}b(n,"modules.backpack.others.EquipData");var e=n.prototype;return e.getFirstActor=function(){for(var e=0;e<gR.ins.actorList.length;e++){var t=gR.ins.actorList[e];if(this.isRoleDressable(t,la.NORMAL))return t.id}return gR.ins.actorList[0].id},e.isDressable=function(e){var t;for(var i in gR.ins.actorList)if(t=gR.ins.actorList[i],this.isRoleDressable(t,e))return!0;return!1},e.isRoleDressable=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(this.hasBetterEquip(e,n,null))return!0}return!1},e.hasBetterEquip=function(e,t,i){return TR.ins.hasBetterEquip(e,t,i)},e.getEquip=function(e,t){var i=n.roleEquip(e);return i?i.getPart(t):null},e.isBetter2Wear=function(e){var t,i=Bi.MODEL.decoratePosition(e.cfgIdx);for(var n in gR.ins.actorList)if(t=gR.ins.actorList[n],PR.dressAble(t,e,i))return this.isBetter(e);return!1},e.isBetter=function(e){var t,i,n=Bi.MODEL.roleTypeId(e.cfgIdx);if(0<n)return!!(t=gR.ins.actorByJob(n))&&t.equips.isBetter(e);for(i in gR.ins.actorList)if((t=gR.ins.actorList[i]).equips.isBetter(e))return!0;return!1},p(1,n,"ins",function(){return null==n._instance&&(n._instance=new n),n._instance}),n.roleEquip=function(e){var t;return gR.ins.actorList&&0<gR.ins.actorList.length&&(t=gR.ins.actorById(e)),t?t.equips:null},n._instance=null,n}(),AR=function(){function e(){this._consumeHash=null,this._exchangeHash=null,this._lstEquips=null,this._maxLevel=0,this.newActiveNum=0,this.curActiveNum=0,this.hasLookResolve=!1,this.needShowResolveExtraRedDot=!1,0==_r.justCreated&&this.init()}b(e,"modules.backpack.others.SoaringEquipData");var t=e.prototype;return t.init=function(){var e=this;if(!(e._consumeHash&&0<e._consumeHash.length)){if(xa.count){e._consumeHash=new jl,e._exchangeHash=new jl;for(var t=0;t<xa.count;t++){var i=xa.MODEL.reward(t);if(i){var n=JSON.parse(i);if(0<n.length){var s=n[0],o=s.value,a=xa.MODEL.type(t),r=o.split(":"),l=parseInt(r[0]);if("FLY_UP_EQUIP"==a&&"goods"==s.type){var c=xa.MODEL.consumption(t),u=xa.MODEL.key(t),d=JSON.parse(c);e._consumeHash.put(l,d),e._exchangeHash.put(l,u)}}}}}if(!(e.lstEquips&&0<e.lstEquips.length))for(e._lstEquips=[],t=0;t<Bi.count;t++)if(l=Bi.MODEL.key(t),ca.isSoaringEquip(l)){var h=Bi.MODEL.flyUpLevel(t),_=Bi.MODEL.decoratePosition(t),f=KH.create(l);e._lstEquips.hasOwnProperty(h)||(e._lstEquips[h]=[]),e._lstEquips[h].hasOwnProperty(_)||(e._lstEquips[h][_]=f),e._maxLevel<h&&(e._maxLevel=h)}}},t.getExchangeConfigId=function(e){return this._exchangeHash.take(e)},t.getSkillId=function(e,t){for(var i=gR.ins.actorById(e),n=0;n<gi.count;n++){var s=gi.MODEL.job(n),o=gi.MODEL.level(n);if(s==i.job&&t==o)return gi.MODEL.skillId(n)}return 0},t.getSkillIdByJob=function(e,t){for(var i=0;i<gi.count;i++){var n=gi.MODEL.job(i),s=gi.MODEL.level(i);if(n==e&&t==s)return gi.MODEL.skillId(i)}return 0},t.getSuitEquipName=function(e){var t=e.positionLevel;return 0==t&&(t=1),this.getSuitPositionName(e)},t.getSuitEquipName2=function(e,t){return 0==t&&(t=1),this.getSuitPositionName2(e,t)},t.getActorUseLevel=function(e){for(var t=this.MAX_POSITION_LEVEL,i=0;i<8;i++){var n=la.SOARING_EQUIPS[i],s=e.equips.getPart(n);if(null==s){t=0;break}t>s.flyupLevel&&(t=s.flyupLevel)}return t},t.getActorActivingMaxLevel=function(e){for(var t=0,i=0;i<8;i++){var n=la.SOARING_EQUIPS[i],s=e.equips.getPart(n);null!=s&&t<s.flyupLevel&&(t=s.flyupLevel)}return t},t.getSuitNameByLevel=function(e,t){for(var i=0;i<ji.count;i++){var n=ji.MODEL.suitType(i),s=ji.MODEL.level(i);ji.MODEL.suitNeedNum(i),ji.MODEL.roleType(i);if("flyUpEquip"==n&&e==s)return ji.MODEL.SuitName(i)}return""},t.getBagSoaringNotUseEquip=function(){for(var e=[],t=this.getBagSoaringEquips,i=0;i<t.length;i++){var n=t[i],s=n.decoratePosition,o=0;for(var a in gR.ins.actorList){var r=gR.ins.actorList[a].equips.getPart(s);r&&r.flyupLevel>=n.flyupLevel&&o++}-1==e.indexOf(n)&&o>=gR.ins.actorList.length&&e.push(n)}return e},t.getSoaringSuitNums=function(e,t){var i=gR.ins.actorById(e);if(i.flyupLevel+1>t)return la.SOARING_EQUIPS.length;var n,s=0;for(var o in la.SOARING_EQUIPS){n=la.SOARING_EQUIPS[o];var a=i.equips.getPart(n);null!=a&&(Bi.MODEL.flyUpLevel(a.cfgIdx)==t&&s++)}return s},t.getSoaringFight=function(e,t,i){var n;void 0===t&&(t=!1),void 0===i&&(i=!1),n=0==t?gR.ins.actorById(e):pR.ins.actorById(e);var s,o=0;for(var a in la.SOARING_EQUIPS){s=la.SOARING_EQUIPS[a];var r=n.equips.getPart(s);if(null!=r){var l=PR.getGoodsNewAttr(r.goodsId);aa.formatNewAttrToChinese(l,!1,!1);o+=RR.getFight(l)+Bi.MODEL.fight(r.cfgIdx)}}if(i)for(a in la.SOARING_INTERIOR_UI_POS)s=la.SOARING_INTERIOR_UI_POS[a],null!=(r=n.equips.getPart(s))&&(l=PR.getGoodsNewAttr(r.goodsId),aa.formatNewAttrToChinese(l,!1,!1),o+=RR.getFight(l)+Bi.MODEL.fight(r.cfgIdx));return o},t.getSoaringLongWen=function(e,t){var i;void 0===t&&(t=!1),i=0==t?gR.ins.actorById(e):pR.ins.actorById(e);var n,s,o,a=0,r=0,l=0,c=[];for(var u in 0<(n=lR.instance().getInnerDragonTypeList(e,t)).longwenData.length&&(c=n.longwenData),la.SOARING_EQUIPS){o=la.SOARING_EQUIPS[u];var d=i.equips.getPart(o);if(null!=d){s=lR.instance().getModuleByGodPart(d.decoratePosition);var h,_,f=PR.getGoodsNewAttr(d.goodsId);aa.formatNewAttrToChinese(f,!1,!1);if(r=RR.getFight(f)+Bi.MODEL.fight(d.cfgIdx),0<n.longwenData.length)for(var p in c=n.longwenData){var g;for(var v in _=c[p],f=jt.MODEL.attrs(_.dragonIndex-1),l=0,h=aa.formatAttrToChineseByList(f,!1,!0,!1))if((g=h[v]).module==s){l=g.val;break}0<l&&(a+=Math.round(l*r/1e4))}}else;}return a},t.getSoaringName=function(e,t){void 0===t&&(t=-1);var i=gR.ins.actorById(e),n=i.flyupLevel;-1!=t&&(n=t);for(var s=RP.n[35],o=0;o<gi.count;o++){var a=gi.MODEL.level(o);gi.MODEL.job(o)==i.job&&a==n&&(s=gi.MODEL.name(o))}return s},t.getSoaringName2=function(e,t){for(var i=RP.n[35],n=0;n<gi.count;n++){var s=gi.MODEL.level(n);gi.MODEL.job(n)==e&&s==t&&(i=gi.MODEL.name(n))}return i},t.getSoaringNameColor=function(e,t){for(var i=-1,n=0;n<gi.count;n++){var s=gi.MODEL.level(n);gi.MODEL.job(n)==e&&s==t&&(i=gi.MODEL.key(n))}return i},t.checkAbleActive2=function(e,t){var i,n=[],s=gR.ins.actorById(e);if(s.flyupLevel+1!=t)return n;for(var o in this.getBagSoaringEquips){var a;for(var r in i=this.getBagSoaringEquips[o],la.SOARING_EQUIPS){a=la.SOARING_EQUIPS[r];var l=s.equips.getPart(a);if((null==l||Bi.MODEL.flyUpLevel(l.cfgIdx)!=t)&&Bi.MODEL.flyUpLevel(i.cfgIdx)==t){var c=Bi.MODEL.roleTypeId(i.cfgIdx),u=Bi.MODEL.minUseLevel(i.cfgIdx),d=Bi.MODEL.flyLevel(i.cfgIdx);u>gR.ins.lv||d>gR.ins.zsLv||c!=s.job&&0!=c||Bi.MODEL.decoratePosition(i.cfgIdx)==a&&n.push(i)}}}return n},t.isShowSkillActivePt=function(e){return e.zhuijiSkillLevel<this.getActorUseLevel(e)},t.showSuitGrowDot=function(e){for(var t=gR.ins.actorById(e),i=0;i<8;i++){var n=la.SOARING_EQUIPS[i],s=t.equips.getPart(n);if(null!=s&&this.isAbleGrowEquip(s))return!0}return!1},t.isAbleActorEnterCurCopy=function(e){for(var t=0,i=0;i<8;i++){var n=la.SOARING_EQUIPS[i],s=e.equips.getPart(n);if(null==s)break;Bi.MODEL.flyUpLevel(s.cfgIdx)==e.flyupLevel+1&&t++}return 8==t},t.isAbleGrowEquip=function(e){var t=e.positionLevel,i=e.flyupLevel;if(i<=t)return!1;if(t>=modules.backpack.others.SoaringEquipData.ins.MAX_POSITION_LEVEL)return!1;if(i<this.getWearSuitLimit(t+1))return!1;var n=this.getNextSuit(e);if(null==n)return!1;if(null==n)return!1;var s=modules.backpack.others.SoaringEquipData.ins.getSuitConsume(n);if(""==s||null==s)return!1;for(var o=JSON.parse(s),a=0;a<o.length;a++){var r=o[a];if("goods"==r.type){var l=r.value,c=parseInt(l.split(":")[0]),u=parseInt(l.split(":")[1]);if(TR.ins.getGoodsNum(c)<u)return!1}}return!0},t.getWearSuitLimit=function(e){var t=Ps.getIndex(e);return-1==t?0:Ps.MODEL.level(t)},t.getCompoundDotPosition=function(e){var t=[];for(var i=0 in this.lstEquips){var n=this.lstEquips[i];for(var s=0 in n)if(!t.hasOwnProperty(s)){var o=n[s];if(this.checkActorNeedCompoundEquip(e,s,o))this.checkAbleCompoundMaterials(o)&&(t[s]=1)}}return t},t.checkActorNeedCompoundEquip=function(e,t,i){return!!this.checkActorNeedEquip(e,t,i)&&!(0<TR.ins.getGoodsNum(i.goodsId))},t.checkActorNeedEquip=function(e,t,i){var n=i.flyupLevel,s=e.equips.getPart(t);return!(null!=s&&s.flyupLevel>=n)&&(!(i.flyLevel>gR.ins.zsLv)&&!(i.useLevel>gR.ins.lv))},t.checkAbleCompoundMaterials=function(e){var t=this.getExchangeConsume(e);if(null==t)return!1;for(var i=!0,n=0;n<t.length;n++){var s=t[n].value.split(":"),o=parseInt(s[0]);TR.ins.getGoodsNum(o)<parseInt(s[1])&&(i=!1)}return!!i},t.getCompoundDotPositionItems=function(){var e,t=[];for(var i in gR.ins.actorList)for(var n=0 in e=gR.ins.actorList[i],this.lstEquips){var s=this.lstEquips[n];for(var o=0 in s){e.equips.getPart(o);var a=s[o];if(this.checkActorNeedCompoundEquip(e,o,a))this.checkAbleCompoundMaterials(a)&&(t[o]=a)}}return t},t.getExchangeConsume=function(e){var t=e.goodsId,i=modules.backpack.others.SoaringEquipData.ins.consumeHash;return i.has(t)?i.take(t):null},t.isShowActorEquipPt=function(e){for(var t=0;t<8;t++){la.SOARING_EQUIPS[t];if(0<this.getAbleWearEquips2(e).length)return!0;if(0<IR.ins.getAbleWearEquips(e).length)return!0}return!1},t.getSoaringGradeEquipByPos=function(e,t){(!this.lstEquips||this.lstEquips.length<=0)&&this.init();var i=null;return 0<this.lstEquips.length&&this.lstEquips[e]&&this.lstEquips[e][t]&&(i=this.lstEquips[e][t]),i},t.getAbleWearEquips2=function(e){var t=[],i=$e.MODEL.value($e.getIndex(207)),n=JSON.parse(i);if(n.flyUpLevel&&gR.ins.actorFlyUpLevel<n.flyUpLevel)return t;var s,o=modules.backpack.others.SoaringEquipData.ins.getBagSoaringEquips;for(var a in o){s=o[a];var r=Bi.MODEL.decoratePosition(s.cfgIdx);this.checkActorNeedEquip(e,r,s)&&t.push(s)}return t},t.getOverGradeEquips=function(){var e,t=[],i=modules.backpack.others.SoaringEquipData.ins.getBagSoaringEquips;for(var n in i)e=i[n],this.isOverGradeEquips(e)&&t.push(e);return t},t.isOverGradeEquips=function(e){if(!ca.isSoaringEquip(e.goodsId))return!1;var t=Bi.MODEL.roleTypeId(e.cfgIdx),i=gR.ins.actorByJob(t);if(null==i)return!0;var n=Bi.MODEL.minUseLevel(e.cfgIdx),s=Bi.MODEL.flyLevel(e.cfgIdx);if(n>gR.ins.lv)return!0;if(s>gR.ins.zsLv)return!0;var o=Bi.MODEL.flyUpLevel(e.cfgIdx),a=Bi.MODEL.decoratePosition(e.cfgIdx);if(null!=i.equips.getPart(a)){if(o>i.flyupLevel+1)return!0}else if(o>i.flyupLevel+1)return!0;return!1},t.isNeedCurFlyupEquip=function(e){if(!ca.isSoaringEquip(e.goodsId))return!1;var t=Bi.MODEL.roleTypeId(e.cfgIdx),i=gR.ins.actorByJob(t);if(null==i)return!1;var n=Bi.MODEL.flyUpLevel(e.cfgIdx),s=Bi.MODEL.decoratePosition(e.cfgIdx),o=i.equips.getPart(s);if(null!=o){var a=Bi.MODEL.flyUpLevel(o.cfgIdx);if(i.flyupLevel+1==a)return!1;if(i.flyupLevel+1==n)return!0}else if(n==i.flyupLevel+1)return!0;return!1},t.showWearTip=function(e){if(!hN.ins.isOpen("SOARING_VIEW")){var t,i,n=0;for(var s in gR.ins.actorList){i=gR.ins.actorList[s],0==n&&(n=i.id);var o=i.equips.getPart(e.decoratePosition);if(null==o){t=i;break}if(o.flyupLevel<e.flyupLevel){t=i;break}}null!=t&&(n=t.id),XQ.ins.show(e,RP.n[37],ql.create(this,function(e){hN.ins.open("ACTOR_M",{_subIndex_:0,actorId:n})},[e]))}},t.getSuitActiveNum=function(e,t,i){for(var n=0,s=0;s<ji.count;s++){var o=ji.MODEL.suitType(s),a=ji.MODEL.level(s),r=ji.MODEL.suitNeedNum(s),l=ji.MODEL.roleType(s);"flyUpEquip"==o&&e==a&&t==l&&r<=i&&n++}return n},t.getSuitGrowConfigIndex=function(e){if(!e)return-1;for(var t=e.decoratePosition,i=0;i<Rs.count;i++){var n=Rs.MODEL.position(i),s=Rs.MODEL.level(i);if(t==n&&(e.positionLevel==s||0==e.positionLevel&&1==s))return i}return-1},t.getSuitGrowConfigIndex2=function(e,t){for(var i=0;i<Rs.count;i++){var n=Rs.MODEL.position(i),s=Rs.MODEL.level(i);if(e==n&&(t==s||0==t&&1==s))return i}return-1},t.getSuitPositionName=function(e){var t=this.getSuitGrowConfigIndex(e);return-1==t?"":Rs.MODEL.name(t)},t.getSuitPositionName2=function(e,t){var i=this.getSuitGrowConfigIndex2(e,t);return-1==i?"":Rs.MODEL.name(i)},t.getSuitPositionShowId=function(e){var t=this.getSuitGrowConfigIndex(e);return-1==t?0:Rs.MODEL.goodsID(t)},t.getSuitConsume=function(e){var t=this.getSuitGrowConfigIndex(e);return-1==t?"":Rs.MODEL.consumptionDef(t)},t.getNextSuit=function(e){if(e.positionLevel>=this.MAX_POSITION_LEVEL)return null;var t=KH.create(e.goodsId);return t.positionLevel=e.positionLevel+1,t.position=e.position,t},t.toSuitShowDto=function(e){var t=KH.create(modules.backpack.others.SoaringEquipData.ins.getSuitPositionShowId(e));return t.positionLevel=e.positionLevel,t},t.getSuitGradeName=function(e){for(var t=0;t<Ns.count;t++)if(Ns.MODEL.key(t)==e)return Ns.MODEL.title(t);return""},t.getSuitFight=function(e){for(var t=0,i=modules.backpack.others.SoaringEquipData.ins.MAX_POSITION_LEVEL,n=gR.ins.actorById(e),s=[],o=0;o<8;o++){var a=la.SOARING_EQUIPS[o],r=n.equips.getPart(a);if(null!=r){i>r.positionLevel&&(i=r.positionLevel);for(var l=r.positionLevel;0<l;)s.hasOwnProperty(l)||(s[l]=0),s[l]++,l--}else i=0}for(var c=0 in i=Math.max(i,1),s)i<=c&&s[c];var u=[];for(o=0;o<ji.count;o++){var d=ji.MODEL.suitType(o),h=ji.MODEL.level(o),_=ji.MODEL.suitNeedNum(o);ji.MODEL.roleType(o);if("flyUpEquip"==d&&i<=h){var f=ji.MODEL.suitNeedNum(o);s.hasOwnProperty(h)&&s[h]>=f&&(u[f]=o),u.hasOwnProperty(f)||i!=h||(u[f]=o)}}for(f in u){var p=!1,g=u[f];h=ji.MODEL.level(g),_=ji.MODEL.suitNeedNum(g);var v=0;for(c in s)c==h&&(v+=s[c]);_<=v&&(p=!0);var m=ji.MODEL.attributes(g);""!=m&&(p&&(t+=RR.getFight(m,e)))}return t},t.getActiveNum=function(e,t){for(var i=0,n=0;n<8;n++){var s=la.SOARING_EQUIPS[n],o=e.equips.getPart(s);null!=o&&o.flyupLevel>=t&&i++}return i},p(0,t,"consumeHash",function(){return this._consumeHash}),p(0,t,"lstEquips",function(){return this._lstEquips}),p(0,t,"MAX_LEVEL",function(){return this._maxLevel}),p(0,t,"MAX_SKILL_LEVEL",function(){return 9}),p(0,t,"isAbleEnterCurCopy",function(){var e;for(var t in gR.ins.actorList)if(e=gR.ins.actorList[t],this.isAbleActorEnterCurCopy(e))return!0;return!1}),p(0,t,"MAX_POSITION_LEVEL",function(){return 9}),p(0,t,"isShowEquipPt",function(){var e;for(var t in gR.ins.actorList){if(e=gR.ins.actorList[t],this.isShowActorEquipPt(e))return!0;if(this.isShowSkillActivePt(e))return!0}return!1}),p(0,t,"getBagSoaringEquips",function(){for(var e=[],t=TR.bagModel.goodsList,i=0;i<t.length;i++){var n=t[i];ca.isSoaringEquip(n.goodsId)&&e.push(n)}return e}),p(0,t,"isAbleGrowSuit",function(){var e;for(var t in gR.ins.actorList)if(e=gR.ins.actorList[t],this.showSuitGrowDot(e.id))return!0;return!(!UN.isNeedIconRedDot||!UN.isOpenModule)}),p(0,t,"isShowExtraResolvePt",function(){return!this.hasLookResolve&&this.needShowResolveExtraRedDot}),p(0,t,"isShowCompoundPt",function(){var e;for(var t in gR.ins.actorList)if(e=gR.ins.actorList[t],0<this.getCompoundDotPosition(e).length)return!0;return 0<modules.backpack.others.SoaringEquipData.ins.getBagSoaringNotUseEquip().length}),p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),DR=function(){function e(e,t,i,n,s){var o=this;o.start=0,o.end=0,o.addMessage=null,o.upMessage=null,o.modules=null,o.goodsList=null,o.goodsHash=null,o.addList=[],o.crossNotify=!0,o.forceNotify=!1,o.start=e,o.end=t,o.addMessage=i,o.upMessage=n,o.modules=s,o.goodsList=[],o.goodsHash=new jl}b(e,"modules.backpack.others.StorageModel");var t=e.prototype;return t.contains=function(e){return e>=this.start&&e<=this.end},t.add=function(e,t){void 0===t&&(t=!0);var i=this.goodsHash.take(e.uuId);if(i){var n=this.goodsList.indexOf(i);this.goodsList.splice(n,1,e),this.goodsHash.put(e.uuId,e,!0)}else this.goodsList.push(e),this.goodsHash.put(e.uuId,e);t&&(i?(e.goodsNum>i.goodsNum||this.forceNotify)&&(e.changeNum=e.goodsNum-i.goodsNum,this.addList.push(e)):(e.changeNum=e.goodsNum,this.addList.push(e))),i&&i.recover()},t.remove=function(e){var t=this.goodsHash.take(e);if(t){var i=this.goodsList.indexOf(t);this.goodsList.splice(i,1),this.goodsHash.remove(e),t.recover()}},t.notify=function(){var e=this;e.addList.length&&e.addMessage&&(e.modules?Tu.sendToModule(e.addMessage,e.modules,e.addList.concat()):Tu.sendToTotalModule(e.addMessage,e.addList.concat())),e.upMessage&&(e.modules?Tu.sendToModule(e.upMessage,e.modules):Tu.sendToTotalModule(e.upMessage,null)),e.addList.length=0},t.reset=function(){for(var e in this.goodsList)this.goodsList[e].recover();this.goodsList.length=0,this.goodsHash.reset(),this.addList.length=0},t.getPart=function(e){var t;for(var i in this.goodsList)if((t=this.goodsList[i])&&t.position==e)return t;return null},t.getDto=function(e){var t;for(var i in this.goodsList)if((t=this.goodsList[i])&&t.goodsId==e)return t;return null},t.isBetter=function(e){var t=LR.getPart(e.goodsId),i=this.getPart(t);return!(i&&!PR.betterThan(e,i))||!(!la.isBoth(t)||(i=this.getPart(la.getOther(t)))&&!PR.betterThan(e,i))},e}(),OR=function(){function e(){}return b(e,"modules.backpack.others.util.BackPackReqs"),e.reqWearAll=function(e){var t=new IL;t.roleId=e,Tu.sendToService(t)},e.reqWearGodEqAll=function(e){var t=new kL;t.roleId=e,Tu.sendToService(t)},e.reqWearEquip=function(e,t,i){if(void 0===i&&(i=0),!(e<=0||t<=0)){if(0==i){var n=TR.bagModel.goodsHash.take(t);i=Bi.MODEL.decoratePosition(n.cfgIdx);var s=MR.ins.getEquip(e,i);s&&!PR.betterThan(n,s)&&(i=la.getOther(i))}if(-1==la.SWING.indexOf(i)){var o=new bL;o.roleId=e,o.uuId=t,o.position=i,Tu.sendToService(o)}else nR.equipSWing(e,t,i)}},e.reqRecycle=function(e){var t=new wL;t.equipList=e,Tu.sendToService(t)},e.reqRecycleChuanShi=function(e){var t=new EL;t.equipList=e,Tu.sendToService(t)},e.reqOpenGrid=function(e){var t=new xL;t.num=e,Tu.sendToService(t)},e.reqUseGoods=function(e,t){var i=new SL;i.uuId=e,i.num=t,Tu.sendToService(i)},e.requestExchange=function(e,t,i,n){void 0===t&&(t=1),void 0===i&&(i=0),void 0===n&&(n=0);var s=new Be;s.echangeID=e,s.num=t,s.roleIndex=i,s.iswear=n,Tu.sendToService(s)},e.reqCompose=function(e,t,i){var n=new cD;n.targetID=e,n.mainToolId=t,n.equipList=i,Tu.sendToService(n)},e.reqOpenPackage=function(e,t,i){var n=new He;n.uuid=e,n.goodsID=t,n.num=i,Tu.sendToService(n)},e.reqGoodsDes=function(e){var t=new TL;t.goodsId=e,Tu.sendToService(t)},e.reqDiscardGoods=function(e){var t=new CL;t.goodsId=e,Tu.sendToService(t)},e.reqGiftInfo=function(){var e=new LL;Tu.sendToService(e)},e.reqAucGoodsTime=function(e){var t=new uO;t.uid=e,Tu.sendToService(t)},e}(),PR=function(){function s(){}return b(s,"modules.backpack.others.util.BackPackUtils"),s.betterThan=function(e,t){var i=e.cfgIdx,n=t.cfgIdx,s=Bi.MODEL.roleTypeId(i),o=Bi.MODEL.roleTypeId(n);if(0<s&&0<o&&s!=o)return!1;var a=Bi.MODEL.decoratePosition(i),r=Bi.MODEL.decoratePosition(n);return!!la.isSame(a,r)&&e.baseFight>t.baseFight},s.dressAble=function(e,t,i){return s.dressAbleById(e,t.goodsId,i)},s.dressAbleById=function(e,t,i){var n=Bi.getIndex(t);return!(i<=0||!la.isSame(Bi.MODEL.decoratePosition(n),i))&&(!(0<Bi.MODEL.roleTypeId(n)&&Bi.MODEL.roleTypeId(n)!=e.job)&&(!(Bi.MODEL.flyLevel(n)>gR.ins.zsLv)&&!(Bi.MODEL.minUseLevel(n)>gR.ins.lv)))},s.getGoodsNewAttr=function(e){if(0<=s._attrNewHash_.indexOf(e))return s._attrNewHash_.get(e);var t=Bi.getIndex(e),i=Bi.MODEL.attributes(t),n=i?JSON.parse(i):{};return s._attrNewHash_.set(e,n),n},s.isComposeGoods=function(e){var t=Bi.MODEL.event2(e.cfgIdx);return t&&"MULTI_COMPOSE"==t.split("|")[1]?0|t.split("|")[2]:0},s.isAutoUsageGoods=function(e){var t=Bi.MODEL.event2(e.cfgIdx);return t&&"AUTO_USE"==t.split("|")[1]},s.isPetEggShow=function(e){var t=$e.getIndex(321),i=$e.MODEL.value(t);return 0<=be.stringToNumArray(i).indexOf(e.goodsId)},s.isTipAble=function(e){if(e.uuId<=0||0<e.position&&102!=e.position)return!1;if(!s.isUsable(e))return!1;if(0<=TR.ins.firstChargeBoxClickArr.indexOf(e.goodsId))return!1;if(Gt.hasIndex(e.goodsId)){var t=Gt.getIndex(e.goodsId);if(e.goodsNum<Gt.MODEL.num(t)||gR.ins.lv<Gt.MODEL.showLevel(t)||gR.ins.zsLv<Gt.MODEL.zhuanSheng(t))return!1;var i=Bi.MODEL.useLimitOfDay(Bi.getIndex(e.goodsId));if(0<i)if(i<=TR.ins.getGoodsUseNum(e.goodsId))return!1;switch(e.goodsId){case 340:if(0<BR.ins.wild_cl_count)return!1;break;case 81:case 82:case 83:case 349:case 350:case 455:case 456:case 457:case 458:if(gR.ins.guildId<=0)return!1;break;case 467:case 468:if(KR.ins.checkIsInActiveTime(e.goodsId))return!1;break;case 60600:case 60601:case 60602:case 2134:case 2135:case 2136:var n=TR.ins.goodtimesHash.take(e.goodsId);return!!(n&&0<n)}return!0}return!1},s.isUsable=function(e){var t=Bi.MODEL.flyLevel(e.cfgIdx);if(gR.ins.zsLv<t)return!1;var i=Bi.MODEL.minUseLevel(e.cfgIdx);return!(gR.ins.lv<i)},s.drawThunderStar=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var s=Bi.getIndex(t);if(0<Bi.MODEL.thunderStar(s)){var o=G.loader.getRes(NI.STAR_BG);o&&e.drawTexture(o,i,n,o.width,o.height);var a=Bi.MODEL.thunderStarDesc(s),r=G.loader.getRes(NI.starNum(a[1]));r&&e.drawTexture(r,i+5,n+4,r.width,r.height);var l=G.loader.getRes(NI.starText(a[0]));l&&e.drawTexture(l,i+5,n+24,l.width,l.height)}},f(s,["_attrNewHash_",function(){return this._attrNewHash_=new jo}]),s}(),RR=function(){function d(){}return b(d,"modules.backpack.others.util.FightingUtil"),d.forAtts=function(e,t,i){var n={},s=0;for(s=0;s<e.length;s++){var o=e[s];o&&o.hasOwnProperty("module")&&"GLOBAL"==o.module||(o&&o.hasOwnProperty("id")?o.id==aa.ATTR_INC_RATE.id?null!=i?t&&t.push({type:aa.ATTR_INC_RATE.keyStr,value:o.val+i.random,module:o.module}):t&&t.push({type:aa.ATTR_INC_RATE.keyStr,value:o.val,module:o.module}):n[aa.getAttributById(o.id).keyStr]=null!=i?o.val+o.val*i.minRandom>>0:o.val:o&&o.hasOwnProperty("type")&&(o.type==aa.ATTR_INC_RATE.keyStr?t&&t.push(o):n[o.type]=null!=i?o.value+o.value*i.minRandom>>0:o.value))}return n},d.getAtt_Inc_Rate=function(e){void 0===e&&(e=-1);for(var t=0,i=0;i<d.attrIncRateArr.length;i++)for(var n,s,o=d.attrIncRateArr[i],a=o.value/1e4,r=1;r<4;r++)if(!(0<e&&r!=e)&&("WEAPON_BASE"==o.module?s=MR.ins.getEquip(r,1):"HEAD_BASE"==o.module?s=MR.ins.getEquip(r,8):"UPPER_BODY_BASE"==o.module?s=MR.ins.getEquip(r,2):"RING_BASE"==o.module?s=MR.ins.getEquip(r,3):"BRACE_BASE"==o.module?s=MR.ins.getEquip(r,5):"NECKLACK_BASE"==o.module?s=MR.ins.getEquip(r,7):"BELT_BASE"==o.module?s=MR.ins.getEquip(r,4):"SHOE_BASE"==o.module&&(s=MR.ins.getEquip(r,6)),s)){var l=s.getBaseAttr();t+=(n=d.forAtts(l,null,s)).hasOwnProperty(aa.MAXHP.keyStr)?.2*n[aa.MAXHP.keyStr]*a:0,t+=n.hasOwnProperty(aa.ATK.keyStr)?3.6*n[aa.ATK.keyStr]*a:0,t+=n.hasOwnProperty(aa.DEF.keyStr)?1.8*n[aa.DEF.keyStr]*a:0,t+=n.hasOwnProperty(aa.MDEF.keyStr)?1.8*n[aa.MDEF.keyStr]*a:0,t+=(n.hasOwnProperty(aa.CRI.keyStr)?n[aa.CRI.keyStr]:0)*d.STD_CRIT_RATE*3.6*a}return t},d.getFight=function(e,t,i,n,s){if(void 0===t&&(t=-1),void 0===i&&(i=0),void 0===n&&(n=!0),void 0===s&&(s=!0),!e)return 0;var o=0;"string"==typeof e&&(e=JSON.parse(e)),d.attrIncRateArr.length=0,e instanceof Array&&(e=d.forAtts(e,d.attrIncRateArr)),d.STD_ATK||(d.STD_ATK=parseInt($e.MODEL.value($e.getIndex(86))),d.STD_DEF=parseInt($e.MODEL.value($e.getIndex(87))),d.STD_CRIT_RATE=parseInt($e.MODEL.value($e.getIndex(88)))/1e4);var a=d.STD_ATK-d.STD_DEF,r=0;0<i?(r+=e.hasOwnProperty(aa.MAXHP.keyStr)?.2*(e[aa.MAXHP.keyStr]+Math.floor(e[aa.MAXHP.keyStr]*i)):0,r+=e.hasOwnProperty(aa.MAXHD.keyStr)?.2*e[aa.MAXHD.keyStr]:0,r+=e.hasOwnProperty(aa.ATK.keyStr)?3.6*(e[aa.ATK.keyStr]+Math.floor(e[aa.ATK.keyStr]*i)):0,r+=e.hasOwnProperty(aa.DEF.keyStr)?1.8*(e[aa.DEF.keyStr]+Math.floor(e[aa.DEF.keyStr]*i)):0,r+=e.hasOwnProperty(aa.MDEF.keyStr)?1.8*(e[aa.MDEF.keyStr]+Math.floor(e[aa.MDEF.keyStr]*i)):0):(r+=e.hasOwnProperty(aa.MAXHP.keyStr)?.2*e[aa.MAXHP.keyStr]:0,r+=e.hasOwnProperty(aa.MAXHD.keyStr)?.2*e[aa.MAXHD.keyStr]:0,r+=e.hasOwnProperty(aa.ATK.keyStr)?3.6*e[aa.ATK.keyStr]:0,r+=e.hasOwnProperty(aa.DEF.keyStr)?1.8*e[aa.DEF.keyStr]:0,r+=e.hasOwnProperty(aa.MDEF.keyStr)?1.8*e[aa.MDEF.keyStr]:0),o+=r+=(e.hasOwnProperty(aa.CRI.keyStr)?e[aa.CRI.keyStr]:0)*d.STD_CRIT_RATE*3.6,r=0,r+=e.hasOwnProperty(aa.CRI_RATE.keyStr)?e[aa.CRI_RATE.keyStr]/1e4:0,r+=e.hasOwnProperty(aa.CRI_RES_RATE.keyStr)?e[aa.CRI_RES_RATE.keyStr]/1e4:0;var l=0;l+=e.hasOwnProperty(aa.PRECISION_RATE.keyStr)?e[aa.PRECISION_RATE.keyStr]/1e4:0;o+=15e4*r+21e5*(l+=e.hasOwnProperty(aa.EVASION_RATE.keyStr)?e[aa.EVASION_RATE.keyStr]/1e4:0)+6e5*(e.hasOwnProperty(aa.CRI_QD_RATE.keyStr)?e[aa.CRI_QD_RATE.keyStr]/1e4:0),o+=e.hasOwnProperty(aa.TRUE_DEF.keyStr)?3.6*e[aa.TRUE_DEF.keyStr]:0,r=0,r+=e.hasOwnProperty(aa.DEF_DEC_RATE.keyStr)?e[aa.DEF_DEC_RATE.keyStr]/1e4:0,o+=(r+=e.hasOwnProperty(aa.DEF_INC_RATE.keyStr)?e[aa.DEF_INC_RATE.keyStr]/1e4:0)*d.STD_DEF*3.6,o+=e.hasOwnProperty(aa.HOLY_DAM_NUM_PREV.keyStr)?15*e[aa.HOLY_DAM_NUM_PREV.keyStr]:0;for(var c=0;c<aa.HOLY_DAM_NUMS.length;c++){var u=aa.HOLY_DAM_NUMS[c];if(e.hasOwnProperty(u.keyStr)){o+=e.hasOwnProperty(u.keyStr)?.72*e[u.keyStr]:0;break}}return r=0,r+=e.hasOwnProperty(aa.DAM_INC_RATE.keyStr)?e[aa.DAM_INC_RATE.keyStr]/1e4:0,r+=e.hasOwnProperty(aa.DAM_DEC_RATE.keyStr)?e[aa.DAM_DEC_RATE.keyStr]/1e4:0,r+=e.hasOwnProperty(aa.LIFE_STEAL_RATE.keyStr)?e[aa.LIFE_STEAL_RATE.keyStr]/1e4:0,o+=(r+=e.hasOwnProperty(aa.RETURN_DAMAGE_RATE.keyStr)?e[aa.RETURN_DAMAGE_RATE.keyStr]/1e4:0)*a*3.6,r=0,r+=e.hasOwnProperty(aa.SKILL_DAM_INC_RATE.keyStr)?e[aa.SKILL_DAM_INC_RATE.keyStr]/1e4:0,o+=(r+=e.hasOwnProperty(aa.SKILL_DAM_DEC_RATE.keyStr)?e[aa.SKILL_DAM_DEC_RATE.keyStr]/1e4:0)*a*3.6,r=0,o+=1.8*(r+=e.hasOwnProperty(aa.DAM_PS_HP.keyStr)?e[aa.DAM_PS_HP.keyStr]:0),!s&&0<d.attrIncRateArr.length&&(d.attrIncRateArr.length=0),0<d.attrIncRateArr.length&&-1!=t&&(o+=d.getAtt_Inc_Rate(t)),n?Math.ceil(o):o},d.calScoreValue=function(e,t){void 0===t&&(t=0),"string"==typeof e&&(e=JSON.parse(e));var i,n=0,s=0;for(var o in e)if(i=e[o],aa.isbaseKey(i.type)){s=0|i.value;var a=0;a=0<t?s+Math.floor(s*t):s,i.type==aa.MAXHP.keyStr&&(a*=.2),i.type==aa.ATK.keyStr&&(a*=3.6),i.type==aa.DEF.keyStr&&(a*=1.8),i.type==aa.MDEF.keyStr&&(a*=1.8),n+=a}return Math.ceil(n)},d.calFightingValue=function(e,t){void 0===t&&(t=0),"string"==typeof e&&(e=JSON.parse(e));var i=0,n=0;for(var s in e)n=0|e[s].value,0<t&&(n+=n*t>>0),i+=n;return i},d.MAXHP_P=.2,d.ATK_P=3.6,d.DEF_P=1.8,d.HD_P=1.8,d.CRI_P=3.6,d.FIGHT_P=3.6,d.STD_ATK=NaN,d.STD_DEF=NaN,d.STD_CRIT_RATE=NaN,d.attrIncRateArr=[],d}(),NR=function(){function i(){}return b(i,"modules.backpack.others.util.GoodsIconLoadUtil"),i.loadIcon=function(e,t){if(e&&"null"!=e&&"0"!=e&&"-1"!=e){var i=_r.getIconPath(e),n=tt.ins.getTexture(i);n&&null!=n.bitmap?t&&t.runWith(n):tt.ins.loadPicture(i,t)}},i.getIcon=function(e){var t=_r.getIconPath(e);return tt.ins.getTexture(t)},i.loadSmallIcon=function(e,t){if(e&&"null"!=e&&"0"!=e&&"-1"!=e){var i=_r.getSmallIconPath(e),n=tt.ins.getTexture(i);n?t&&t.runWith(n):tt.ins.loadPicture(i,t)}},i.getSmallIcon=function(e){var t=_r.getSmallIconPath(e);return tt.ins.getTexture(t)},i.loadimage=function(e,t){if(e&&"null"!=e&&"0"!=e&&"-1"!=e){var i=_r.getStyleImagePath(e),n=tt.ins.getTexture(i);n?t&&t.runWith(n):tt.ins.loadPicture(i,t)}},i.loadRedDotImage=function(e,t){void 0===e&&(e=0);var i=_r.getAtlasSubPath("basic_ui/comp_point.png"),n=tt.ins.getTexture(i);return n?(t&&t.runWith(n),tt.ins.getTexture(i)):(tt.ins.loadPicture(i,t),null)},i.loadJobImage=function(e,t){var i="";switch(e){case 1:i="bb_jb_zs";break;case 2:i="bb_jb_fs";break;case 3:i="bb_jb_ds";break;default:return null}var n=_r.getAtlasSubPath("basic_ui/"+i+".png"),s=tt.ins.getTexture(n);return s?(t&&t.runWith(s),tt.ins.getTexture(n)):(tt.ins.loadPicture(n,t),null)},i.loadHunImage=function(e){var t=_r.getAtlasSubPath("basic_ui/bb_jb_h.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadLWImage=function(e){var t=_r.getAtlasSubPath("grids/lw_jb_s.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadGodImage=function(e){var t=_r.getAtlasSubPath("basic_ui/bb_jb_s.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadAuctionBg=function(e){var t=_r.getAtlasSubPath("basic_ui/cz_sc_bq_da.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadAuctionImg=function(e){var t=_r.getAtlasSubPath("basic_ui/sczb_jb_pm.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadGradeBgImage=function(e){var t=_r.getAtlasSubPath("basic_ui/fs_jb_cs.png"),i=tt.ins.getTexture(t);return i?(e&&e.runWith(i),tt.ins.getTexture(t)):(tt.ins.loadPicture(t,e),null)},i.loadGradeImage=function(e,t){var i=_r.getAtlasSubPath("grids/mz_bq_num.png"),n=tt.ins.getTexture(i);return n?(t&&t.runWith(n),tt.ins.getTexture(i)):(tt.ins.loadPicture(i,t),null)},i.loadSamsaraBgImage=function(e,t){var i=_r.getAtlasSubPath("basic_ui/fs_jb_cs.png"),n=tt.ins.getTexture(i);return n?(t&&t.runWith(n),tt.ins.getTexture(i)):(tt.ins.loadPicture(i,t),null)},i.loadSamsaraImage=function(e,t){var i=_r.getAtlasSubPath("grids/mz_bq_num.png"),n=tt.ins.getTexture(i);return n?(t&&t.runWith(n),tt.ins.getTexture(i)):(tt.ins.loadPicture(i,t),null)},i.loadSamsaraImageXuan=function(e,t){var i=_r.getAtlasSubPath("basic_ui/lhzb_jb_zi2.png"),n=tt.ins.getTexture(i);return n?(t&&t.runWith(n),tt.ins.getTexture(i)):(tt.ins.loadPicture(i,t),null)},i.destoryGridImage=function(){0<i.gridDestroyImage.length&&G.timer.frameLoop(1,i,modules.backpack.others.util.GoodsIconLoadUtil.loop)},i.loop=function(){for(var e=0;0<i.gridDestroyImage.length;){if(10<e)return;var t=i.gridDestroyImage.shift();tt.ins.getTexture(t)&&tt.ins.clearTexture(t),G.loader.clearTextureRes(t),e++}i.gridDestroyImage.length<=0&&G.timer.clear(i,modules.backpack.others.util.GoodsIconLoadUtil.loop)},i.gridDestroyImage=[],i}(),BR=function(){function e(){var e=this;e.enterScenceBossInfo=null,e.godBossHash=null,e.wildBossObj=null,e.gb_totalNum=0,e.gb_leftlNum=0,e.toc25000=null,e.toc10309=null,e.curCopyId=0,e.isCheckPointBoss=!1,e.curVictory=!1,e.bossBlood=0,e.wild_cl_count=0,e.wild_cl_max=0,e.isfirst_flyup=!0,e.jindiBossObj=null,e.mijingBossObj=null,e.data_21247=null,e.noShow=!1,e.timeGS=0,e.timeXZ=0,e.score=0,e.wild_own_cl_count=0,e.buyNum=0,e.remainBuy=0,e.copyReward=null,e.copyEnd=!1,e.toc24004=null,e.toc24026=null,e.toc24027=null,e.toc24033=null,e.toc25012=null,e.toc24028=null,e.copyBossDeadXY=null,e.charDeadXY=null,e.toc22604=null,e.ascripStatus=-1,e.reliveObj=null,e.iswin=!1,e.bossHuDunData=null,e.data30370=null,e.data30375=null,e.bossPersonHash=null,e.bossWildHash=null,e.crossNewWorldBoss=null,e.crossAwardArr=[],e.isCrossFirst=!1,e.bookDto={},e.autoBossId=-1,e._btnCallBossPanel=!1,e.isFirst=!0,e._cateBossIdsMap=null,e.backToPersonBoss=!1,e._wildIsAuto=!1,e._godIsAuto=!1,e.isQuitFromDig=!1,e.isQuitFromDig2=!1,e.isQuitFromDig3=!1,e.destroyImage=[],e.Boss_Vec=new jl}b(e,"modules.boss.others.BossModel");var t=e.prototype;return t.openSceneUI=function(e,t){if(31==e)return hN.ins.close("COPYMAINVIEW"),void hN.ins.open(t);3!=e&&7!=e&&8!=e&&13!=e&&14!=e&&26!=e&&47!=e&&48!=e&&49!=e||(nF.curFightModule="modules.boss.BossModule"),30==e&&hN.ins.close("BOSS_ANCIENT_MAINVIEW"),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_0),hN.ins.close("BOSS_MAINVIEW"),hN.ins.isOpen("GUILD_BOSS_MAINVIEW")&&hN.ins.close("GUILD_BOSS_MAINVIEW"),hN.ins.open(t)},t.getUiIDAndDtoType=function(e){var t,i=0;return 2==e?(t="BOSS_PERSONBOSS_SCENE",i=6):3==e?(t="BOSS_WILD_SCENE",i=7):4==e?(t="BOSS_WORLDBOSS_SCENE",i=9):8==e?(t="BOSS_CHECKPOINT_SCENE",i=6):7==e?(t="BOSS_WILD_OWN_SCENE",i=14):20==e?(t="BOSS_SY_OWN_SCENE",i=20):21==e?(t="BOSS_SY_OWN_SCENE",i=21):11==e?(t="AE_BUBBLE_SCENE_VIEW",i=18):10==e?(t="BOSS_PERSONBOSS_SCENE",i=40):13==e?(t="BOSS_WILD_SCENE",i=17):14==e?(t="BOSS_WILD_SCENE",i=22):12==e?(t="BOSS_PERSONBOSS_SCENE",i=17):22==e?(t="BOSS_PERSONBOSS_SCENE",i=23):28==e?(t="NEW_SS_SCENE",i=13):26==e?(t="BOSS_WILD_SCENE",i=27):27==e?(t="BOSS_PERSONBOSS_SCENE",i=28):29==e?(t="BOSS_PERSONBOSS_SCENE",i=29):30==e?(t="BOSS_ANCIENT_RANKSCENE",i=30):31==e?(t="MENTAL_SCENE",i=31):34==e?(t="MAGIC_TOWER_SCENE",i=34):32==e?(t="PIG_FIRE_MAIN",i=32):41==e?(t="BOSS_WILD_SCENE",i=41):42==e?(t="BOSS_WILD_SCENE",i=42):43==e?(t="SOARING_VIEW",i=43):45==e?(t="WB_MAIN_PANEL",i=45):44==e?(t="MAGIC_VIEW",i=44):47==e||48==e?(t="BOSS_WILD_SCENE",i=47):49==e?(t="BOSS_WILD_SCENE",i=49):50==e?(t="FIREDRAGONMAINVIEW",i=50):51==e?(t="TEAM_COPY_SCENE",i=51):52==e?(t="FESTBOSS_MAIN_VIEW",i=52):53==e?(t="BOSS_WILD_SCENE",i=53):54==e?(t="BOSS_GUILD_KUN",i=54):56==e?(t="CROSSNEWWORLDBOSSPANEL",i=56):57==e?i=57:58==e&&(t="BOSS_PERSONBOSS_SCENE",i=58),{uiID:t,dtoType:i}},t.changeSceneUI=function(e,t){var i=this.getUiIDAndDtoType(e),n=i.uiID,s=i.dtoType;if(s||n||(this.clearScene(),this.exitScene(e,s)),!t&&0<modules.boss.others.BossModel.ins.curCopyId){if(7==e){var o=new GA;o.copyId=modules.boss.others.BossModel.ins.curCopyId,Tu.sendToService(o)}modules.boss.others.BossModel.ins.curCopyId=0,30==e?this.exitCopy(300):49==e&&this.exitCopy(300),modules.boss.others.BossModel.ins.data30375=null,modules.boss.others.BossModel.ins.curVictory=!1}t?hN.ins.isOpen(n)!=t&&this.openSceneUI(e,n):(this.clearScene(),this.exitScene(e,s),hN.ins.close(n))},t.clearScene=function(){this.bossBlood=-1,this.copyEnd=!1,this.copyReward=null,this.toc24027=null,this.toc24028=null,qU.ins.lockBossId=0,YR.ins.curBossId=0,qU.ins.updateBossBlood(0),nF.curFightModule=null,Tu.sendToModule("RELIVEVIEW_CLOSE",["modules.relive.ReliveModule"]),this.curCopyId=0},t.exitScene=function(e,t){if(2==e)Tu.sendToModule("__PERSONAL_BOSS_EXIT__",["modules.boss.BossModule"],{type:t}),Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}),LN.isShow=!1,LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2;else if(4==e)Tu.sendToModule("__WORLD_EXIT__",["modules.scene.SceneModule"],{type:t});else if(3==e)Tu.sendToModule("__BOSS_EXIT__",["modules.scene.SceneModule"],{type:t});else if(2==e)Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t});else if(7==e)Tu.sendToModule("__BOSS_OWN_EXIT__",["modules.scene.SceneModule"],{type:t});else if(23==e)Tu.sendToModule("__ARENA_EXIT__",["modules.digger.DiggerModule"],{type:t}),Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t});else if(26==e)Tu.sendToModule("__BOSS_HOME_EXIT__",["modules.boss.BossModule"],{type:t}),Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t});else if(32==e)LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2,Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t});else if(43==e){Tu.sendToModule("CATE_43_QUIT",["modules.boss.BossModule"],{type:t}),Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t});var i=new Tu;i.setup("checkZone",[]),sJ.ins.notice(["NavBottom"],i)}else 1==e?(Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}),Tu.sendToModule("CATE_1_QUIT",["modules.boss.BossModule"],{type:t}),LN.isShow=!1,LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2):8==e?(Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}),LN.isShow=!1,LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2):48==e?Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}):58==e?(Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}),LN.isShow=!1,LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2):(51==e&&(LN.isShowPetBtn=!1,modules.pet.others.PetDataModel.ins().btnPetShow=2),Tu.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:t}))},t.btnCallBossPanel=function(){this._btnCallBossPanel=!0,jR.reqCopy(2)},t.checkCopyId=function(e,t){if(!e)return!1;var i=rn.getIndex(e);return t==rn.MODEL.cate(i)},t.exitCopy=function(e){if(void 0===e&&(e=300),tr.push(pt.now()+"：run exitCopy:"+this.curCopyId),zN.clearSceneMonster(),this.curCopyId){var t=rn.getIndex(modules.boss.others.BossModel.ins.curCopyId),i=rn.MODEL.cate(t);50==i&&(Na.ins.copyHurtList=[]),52==i&&($P.ins.copyHurtList=[]),57==i&&(modules.boss.others.BossModel.ins.crossAwardArr=[]),dr.dtoEnterScene&&0!=dr.dtoEnterScene.cid&&32==i&&(modules.copy.others.NewPigData.ins.isOut=!0,LN.isShowPetBtn=!1),32==i&&(LN.isShowPetBtn=!1),G.timer.once(e,this,this.changeSceneUI,[i,!1])}else sH.getInstance().exit()},t.offlineClearObject=function(){Tu.sendToModule("NOTICE_REMOVE_FOCUS",["modules.nav.NavModule"]),XN.instance().isEnterCopy=!1,Lo.instance.isNeedToShowLottery=!0,ZB.ins.isYezhan=!1,TR.ins.mulFly=!1,dr.dtoEnterScene=null,G.timer.once(400,null,function(){Tu.sendToModule("SHOW_ACT_ICON",["modules.nav.NavModule"])}),modules.boss.others.BossModel.ins.isCheckPointBoss=!1,modules.boss.others.BossModel.ins.toc24004=null,modules.boss.others.BossModel.ins.toc24026=null,modules.boss.others.BossModel.ins.toc24027=null,modules.boss.others.BossModel.ins.toc24028=null,modules.boss.others.BossModel.ins.toc25000=null,modules.boss.others.BossModel.ins.curCopyId=0,modules.boss.others.BossModel.ins.autoBossId=-1,modules.boss.others.BossModel.ins.data30375=null,DN.instance._toc23335=null,modules.boss.others.BossModel.ins.enterScenceBossInfo=null,hN.ins.close("PIG_FIRE_MAIN"),hN.ins.close("NEW_SS_SCENE"),hN.ins.close("YZBQC_MAIN"),gB.ins._uiShow=!1,hN.ins.close("AE_BUBBLE_SCENE_VIEW"),hN.ins.close("TEAM_COPY_SCENE"),hN.ins.close("NavWorldBoss"),hN.ins.close("FESTBOSS_MAIN_VIEW"),hN.ins.close("FIREDRAGONMAINVIEW"),WR.ins.clearTeamdata(),tr.push(RP.n[38])},t.exitClearBossData=function(){for(modules.boss.others.BossModel.ins.toc24004=null,modules.boss.others.BossModel.ins.toc24026=null,modules.boss.others.BossModel.ins.toc24027=null,modules.boss.others.BossModel.ins.toc24028=null,modules.boss.others.BossModel.ins.toc25000=null,modules.boss.others.BossModel.ins.curCopyId=0,modules.boss.others.BossModel.ins.autoBossId=-1,modules.boss.others.BossModel.ins.enterScenceBossInfo=null,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],[MN.NORMAL,!0]),modules.boss.others.BossModel.ins.data30375=null,hN.ins.isOpen("GUILD_BOSS_CD_VIEW")&&hN.ins.close("GUILD_BOSS_CD_VIEW"),GB.has(_r.getLayoutsPath("diggerScene"))&&GB.release(_r.getLayoutsPath("diggerScene"));rF.luckyDrops.length;)rF.luckyDrops.shift().run()},t.getWorldBossEndTime=function(e){var t=bo.getIndex(e),i=bo.MODEL.close(t).split(":"),n=3600*parseInt(i[0])+60*parseInt(i[1]);return Go.getDayTime(n,0,dr.curServerTime).getTime()},t.getBossIds=function(e){return null==this._cateBossIdsMap&&this.initCateBossIdsMap(),this._cateBossIdsMap[e]},t.initCateBossIdsMap=function(){var e=this;e._cateBossIdsMap={},e._cateBossIdsMap[2]=[],e._cateBossIdsMap[3]=[],e._cateBossIdsMap[4]=[],e._cateBossIdsMap[7]=[],e._cateBossIdsMap[13]=[],e._cateBossIdsMap[14]=[],e._cateBossIdsMap[15]=[],e._cateBossIdsMap[41]=[],e._cateBossIdsMap[42]=[],e._cateBossIdsMap[49]=[],e._cateBossIdsMap[53]=[],e._cateBossIdsMap[57]=[];for(var t=0,i=rn.count;t<i;t++){var n=rn.MODEL.cate(t);2!=n&&3!=n&&4!=n&&7!=n&&13!=n&&14!=n&&15!=n&&41!=n&&42!=n&&49!=n&&53!=n&&57!=n||e._cateBossIdsMap[n].push(rn.MODEL.key(t))}},t.getFirstKillReward=function(e){for(var t={id:0,count:0},i=Bu.count,n=0;n<i;n++)if(e==Bu.MODEL.missionId(n)){var s=gR.ins.getJobByIdx(2)||gR.ins.getJobByIdx(1),o=JSON.parse(Bu.MODEL.reward(n));o=o[s-1].value.split(":"),t.id=o[0],t.count=o[1];break}return t},t.setImage=function(e,t){var i=G.loader.getRes(e.skin);null!=i?(i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.Boss_Vec.put(t,e,!0)):e.on("loaded",this,this.onLoadedImage,[,[e,t]])},t.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.Boss_Vec.put(t[1],t[0],!0)},t.clearImage=function(){for(var e in this.Boss_Vec.proto){var t=this.Boss_Vec.take(e);t&&t.skin&&(G.loader.clearRes(t.skin,!0),tt.ins.clearTexture(t.skin))}for(this.Boss_Vec.dispose(),this.Boss_Vec=new jl;0<modules.boss.others.BossModel.ins.destroyImage.length;){var i=modules.boss.others.BossModel.ins.destroyImage.shift();yc.clearRes(i),tt.ins.clearTexture(i)}var n=_r.getLayoutsPath("boss");if(G.loader.clearRes(n),-1<n.indexOf(".atlas")){var s=n.replace(".atlas",".png"),o=yc.getRes(s);o&&(o.destroy(),G.loader.clearRes(s))}},t.checkPersonHasFirstKillReward=function(e){for(var t=0;t<Bu.count;t++)if(e==Bu.MODEL.missionId(t))return t;return-1},t.reqAutoChallenge=function(){var e=new LA;Tu.sendToService(e)},p(0,t,"godIsAuto",function(){return this._godIsAuto},function(e){this._godIsAuto=e}),p(0,t,"wildIsAuto",function(){return this._wildIsAuto},function(e){this._wildIsAuto=e}),p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e}(),HR=function(){function e(){var e=this;e._configArr=null,e.currentSubSelected=0,e._map=null,e.flyup_cl_count=0,e.flyup_cl_max=0,e.hfTime=0,e.buyNum=0,e.remainBuy=0,e.renderRedArr=null,e.isFinishFlyup=0,e.isFirstLogin=1,e.renderRedArr={}}b(e,"modules.boss.others.FlyupBossModel");var t=e.prototype;return t.updateInfo=function(e){this._map=e.map,this.flyup_cl_max=e.maxClCount,this.hfTime=e.hfTime},t.getBossInfoByIndex=function(){var e=[];this.configArr[this.currentSubSelected]||console.log("boss提示异常报错",this.configArr,this.currentSubSelected);var t;this.configArr[this.currentSubSelected].bossIds;for(var i in this._map)(t=this._map[i])&&e.push(t.id);return e},t.getBGimgStr=function(e){for(var t,i=0;i<vi.count;i++)for(var n=vi.MODEL.bossIds(i).split(","),s=0;s<n.length;s++){parseInt(n[s])==e&&(t=vi.MODEL.bgId(i))}return t||(t="fsboss_bg_01"),t},t.getFlyupLimit=function(e){for(var t=0,i=0;i<vi.count;i++)for(var n=vi.MODEL.bossIds(i).split(","),s=0;s<n.length;s++){parseInt(n[s])==e&&(t=vi.MODEL.flyup_limit(i))}return t},t.showRedPot=function(e,t){if(void 0===t&&(t=!1),null==this.map)return!1;for(var i,n=[],s=[],o=0;o<vi.count;o++)(i=new qa).id=vi.MODEL.key(o),i.flyup_limit=vi.MODEL.flyup_limit(o),i.bgId=vi.MODEL.bgId(o),i.buttonImg=vi.MODEL.buttonImg(o),i.bossIds=vi.MODEL.bossIds(o).split(","),n.push(i);if(null==gR.ins.actorList)return!1;gR.ins.actorList[0].job;if(!(n[e].flyup_limit<=gR.ins.actorFlyUpLevel))return!1;s=n[e].bossIds;for(var a=0;a<s.length;a++){if(1==this.map[parseInt(s[a])].selected&&2==this.map[parseInt(s[a])].state)return!(this.flyup_cl_count<=0)}return!1},t.showRedPot1=function(e){for(var t,i=[],n=0;n<vi.count;n++)(t=new qa).id=vi.MODEL.key(n),t.flyup_limit=vi.MODEL.flyup_limit(n),t.bgId=vi.MODEL.bgId(n),t.buttonImg=vi.MODEL.buttonImg(n),t.bossIds=vi.MODEL.bossIds(n).split(","),i.push(t);gR.ins.actorList[0].job;for(var s=0;s<e;s++)if(i[s]&&i[s].flyup_limit<=gR.ins.actorFlyUpLevel)return!0;return!1},t.getAttionArr=function(e){for(var t=0;t<e.length;t++){if(1==modules.boss.others.FlyupBossModel.ins.map[parseInt(e[t])].selected)return!0}return!1},t.isShowflyupBossTask=function(){return"BOSS_MAINVIEW"!=hN.ins._getLayoutPanelId()&&(0==gR.ins.actorFlyUpBosstask&&0<gR.ins.actorFlyUpLevel)},t.openFlayupBossGuide=function(){modules.boss.others.FlyupBossModel.ins.isShowflyupBossTask()&&Tu.sendToModule("FLYUP_BOSS_TASK",["modules.actor.ActorModule"])},t.timeoutFlayBoss=function(){1!=modules.boss.others.FlyupBossModel.ins.isFirstLogin&&G.timer.once(500,this,this.openFlayupBossGuide)},t.openFlyupBossView=function(){Tu.sendToModule("FLYUP_BOSS_TASK",["modules.actor.ActorModule"])},p(0,t,"configArr",function(){if(null==this._configArr){var e;this._configArr=[];for(var t=0;t<vi.count;t++)(e=new qa).id=vi.MODEL.key(t),e.flyup_limit=vi.MODEL.flyup_limit(t),e.bgId=vi.MODEL.bgId(t),e.buttonImg=vi.MODEL.buttonImg(t),e.bossIds=vi.MODEL.bossIds(t).split(","),this._configArr.push(e)}return this._configArr}),p(0,t,"map",function(){return this._map}),p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e.openLevel=-1,e}(),VR=function(){function e(){this._array=null,this._firstInfo=null,this._canClgId=0,this._configArr=null,this._showWildId=0,this._rankArray=null,this._myInfo=null,this._toc22613=null}b(e,"modules.bossancient.others.BossAncientModel");var t=e.prototype;return t.updateInfoByVSC=function(e){var t=this;if(t._array||(t._array=t.configArr),e instanceof protos.bossancient.toc_21232){var i=e.infos;t._canClgId=e.curBossId;for(var n=0;n<t._array.length;n++)t._array[n].leftTime=i[t._array[n].id].leftTime,t._array[n].curAnger=i[t._array[n].id].curAnger,t._array[n].maxAnger=i[t._array[n].id].maxAnger,t._array[n].status=t._array[n].curAnger>=t._array[n].maxAnger?1:0}sJ.ins.notice(["NavBossAncient"],null)},t.getRefreshTime=function(e,t,i){return e*t+i},t.updateRankInfo=function(e){var t=this;if(e instanceof protos.bossancient.toc_24044){t._rankArray=e.infos,t._myInfo=t._rankArray.pop(),t._rankArray=t._rankArray.sort(t.sortByDam);for(var i=0;i<t._rankArray.length;i++)t._rankArray[i].rank=i+1;t._rankArray.push(t._myInfo)}var n=hN.ins._getPanel("BOSS_ANCIENT_RANKSCENE");n&&n.parent&&n.updateListShow(t._rankArray)},t.sortByDam=function(e,t){return t.damage-e.damage},p(0,t,"configArr",function(){for(var e,t,i=$e.MODEL.value(164).split("|"),n={},s=0;s<i.length;s++){var o=i[s].split(":"),a=parseInt(o[0]),r=o[1];n[a]={id:a,rwdStr:r}}for(var l in this._configArr=[],n){t=n[l],(e=new nt).id=t.id;var c=rn.getIndex(t.id);e.reward=t.rwdStr,e.name=hn.MODEL.name(hn.getIndex(rn.MODEL.bossId(c))),e.levLim=rn.MODEL.levelLimit(c),e.zsLim=rn.MODEL.zsLevelLimit(c);var u=rn.MODEL.wildOrYuanguId(c);e.corBossId=u;var d=rn.getIndex(u),h=rn.MODEL.bossId(d);e.refreshTime=rn.MODEL.reliveTime(d);var _=hn.getIndex(h);e.level=hn.MODEL.level(_);var f=hn.MODEL.muId(_);e.corWildName=hn.MODEL.name(_),_=_n.getIndex(f),e.bossHead=_n.MODEL.headId(_),this._configArr.push(e)}return this._configArr}),p(0,t,"arrayList",function(){return this._array}),p(0,t,"canClgId",function(){return this._canClgId}),p(0,t,"showWildId",function(){return this._showWildId},function(e){this._showWildId=e}),p(0,t,"toc22613",function(){return this._toc22613},function(e){this._toc22613=e}),p(0,t,"firstInfo",function(){this._array||(this._array=this.configArr);for(var e,t=1e11,i=0;i<this._array.length;i++){var n=this._array[i],s=n.leftTime?n.maxAnger-n.curAnger-1:n.maxAnger-n.curAnger,o=this.getRefreshTime(n.refreshTime,s,n.leftTime);if(1<=n.curAnger/n.maxAnger)return n;o<t&&(t=o,e=n)}return e||(e=this._array[0]),e}),p(0,t,"rankListInfo",function(){return this._rankArray||[]}),p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e.BOSS_ANCIENT_REFRESH="BOSS_ANCIENT_REFRESH",e._ins=null,e._status=-1,e._canClear=!0,e}(),GR=function(){function e(){}b(e,"modules.chat.ModuleOpenCheck");var t=e.prototype;return t.checkModuleOpen=function(e){var t=un.getIndex(e),i=un.MODEL.openConditions(t);if(!i)return!1;for(var n=JSON.parse(i),s=0;s<n.length;s++){var o,a=n[s];if(null==a)return!1;a.type&&(o=a.type.toLowerCase());var r=parseInt(a.value);if("playerlevel"==o&&gR.ins.lv<r)return!1;if("flyUpLevel"==o&&gR.ins.actorFlyUpLevel<r)return!1;if("serveropenday"==o&&dr.getOpenServiceDay()<r)return!1;if("playerzhuanshenglevel"==o&&gR.ins.zsLv<r)return!1;if("ringlevel"==o&&aB.instance.activedRingId<r)return!1;if("taskfinish"==o&&PH.Ins().info&&(PH.Ins().info.taskId<r||PH.Ins().info.taskId==r&&PH.hasTask()))return!1;if("passedguanqianum"==o&&UR.instance.currentPoint<r)return!1;if("servercombineday"==o&&dr.getComServiceDay()<r)return!1;if("niepanlevel"==o){for(var l in gR.ins.actorList)if(gR.ins.actorList[l].niepanlevel>=r)return!0;return!1}if("playerspiritout"==o)return Vf.instance.checkOut()}return!0},t.getModuleLevel=function(e){var t=un.getIndex(e),i=un.MODEL.openConditions(t);if(i)for(var n=0;n<JSON.parse(i).length;n++){var s,o=JSON.parse(i)[n];if(o.type&&(s=o.type.toLowerCase()),"playerlevel"==s)return parseInt(o.value)}return 0},t.getModuleDate=function(e){var t=un.getIndex(e),i=un.MODEL.openConditions(t);if(i)for(var n=0;n<JSON.parse(i).length;n++){var s,o=JSON.parse(i)[n];if(o.type&&(s=o.type.toLowerCase()),"serveropenday"==s)return parseInt(o.value)}return 0},t.getModuleZhuansheng=function(e){var t=un.getIndex(e),i=un.MODEL.openConditions(t);if(i)for(var n=0;n<JSON.parse(i).length;n++){var s,o=JSON.parse(i)[n];if(o.type&&(s=o.type.toLowerCase()),"playerzhuanshenglevel"==s)return parseInt(o.value)}return 0},t.getErrorTips=function(e){var t=[],i=un.getIndex(e),n=un.MODEL.openConditions(i);if(n)for(var s=JSON.parse(n),o=0;o<s.length;o++){var a=s[o];if(a){var r,l=parseInt(a.value);switch(a.type&&(r=a.type.toLowerCase()),r){case"playerlevel":gR.ins.lv<l&&t.push(l+"级");break;case"playerZhuanShengLevel":gR.ins.zsLv<l&&t.push(l+"转");break;case"serveropenday":dr.getOpenServiceDay()<l&&t.push("开服第"+l+"天");break;case"playerzhuanshenglevel":gR.ins.zsLv<l&&t.push(RP.n[39]+l+"级");break;case"ringlevel":aB.instance.activedRingId<l&&t.push("激活第"+l+"个特戒");break;case"taskfinish":if(PH.Ins().info&&(PH.Ins().info.taskId<l||PH.Ins().info.taskId==l&&PH.hasTask())){var c=zn.getIndex(l),u=zn.MODEL.taskingName(c);t.push("需"+u)}case"passedguanqianum":UR.instance.currentPoint<l&&t.push("关卡第"+l+"关");case"serverCombineDay":dr.getComServiceDay()<l&&t.push("合服第"+l+"天");case"niepanlevel":var d=!1;for(var h in gR.ins.actorList)if(gR.ins.actorList[h].niepanlevel>=l){d=!0;break}d||t.push(RP.n[40]+l+"重")}}}return t.join("并且")+"开启"},e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e._instance=null,e.MODULE_ARENA=18,e.MODULE_GOV=19,e.MODULE_RED_PACKET=34,e.MODULE_MONTH_CARD=35,e.MODULE_MO_EQUIP=42,e.MODULE_FLYUP_EQUIP=43,e.MODULE_GOLD_LOTTERY=59,e.MODULE_MO_ZHUHUN=60,e.MODULE_SHENMO=61,e.MODULE_ACTIVITY_HEFU=63,e.MODULE_ACTIVITY_HEFU_TREASURE=65,e.MODULE_LUNHUI_ZHUHUN=73,e.MODULE_BLACK_MARCKET=77,e.MODULE_NEW_WORLD_BOSS=79,e.GOD_OPEN=105,e}(),UR=function(){function e(){var e=this;e._currentPoint=1,e._currentBo=0,e._currentCheckPointMaxBo=0,e.current_GetRewardID=0,e.isAuto=!1,e.isNeedShowUpdate=!1,e.isfirst=!0,e.isUpdate=!1,e.checkPointExitBirth=null,e.previewIndex=-1,e._maxBool=!1}b(e,"modules.checkpoint.others.CheckPointModel");var t=e.prototype;return t.updateData=function(){},t.guanQiaBtnOpen=function(){var e=$e.MODEL.value($e.getIndex(135));return!(e&&0<e.length)||parseInt(e)<=this.currentPoint},t.showNextExpAdd=function(){this.isUpdate&&(this.isUpdate=!1,Tu.sendToModule("_CheckPoint_Exp_add_",["modules.checkpoint.CheckPointModule"]))},t.addBatch=function(){var e=this;if(e.fullPower&&modules.checkpoint.others.CheckPointModel.instance.isAuto&&!BR.ins.isCheckPointBoss){if(TR.ins.getLeftGridNumMore20())return void(0==hN.ins.isOpen("RECYCLE")&&KQ.ins.showBagRecycle());var t=zB.ins.getDesc(3997);zB.ins.playNoticeMsg(t,!0,!0),G.timer.once(1e3,FR,FR.killBoss)}if(e._maxBool){e.currentBo=e.currentCheckPointMaxBo;var i=PH.Ins().info;i&&0<=i.taskEvent.indexOf(da.EVENT_GUANQIA_FIGHT_BUTTON.toString())&&Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"])}else e.currentBo>e.currentCheckPointMaxBo&&(e.currentBo=e.currentCheckPointMaxBo),FR.requestKillLittleMonster(),Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"]),e._maxBool=e.currentBo==e.currentCheckPointMaxBo},t.clearBatch=function(){0==this._maxBool&&0==this.currentBo||(this._maxBool=!1,this.currentBo=0,Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"]))},t.isHasReward=function(){return 10<this.currentPoint&&parseInt((this.currentPoint/10).toString())>this.current_GetRewardID},t.loadCheckPointMonster=function(){if(!(this.currentPoint<99)){var e=Math.floor(this._currentPoint/100);if(!hn.getIndex(3e6+1e3*e)){var t=[{url:_r.getCKMonsterDBPath("monsterResource"+e),type:"arraybuffer"}];G.loader.load(t,ql.create(this,this.onLoad,t),null,"arraybuffer")}}},t.onLoad=function(e){var t=G.loader.getRes(e.url);if(t){hn.bytes=new mt(t);for(var i=hn.bytes.readShort(),n=0;n<i;n++)hn.config(hn.count+n);hn.count=hn.count+i}},p(0,t,"currentPoint",function(){return this._currentPoint},function(e){this._currentPoint!=e&&(!this.isfirst&&this._currentPoint<e&&(this.isUpdate=!0),this._currentPoint=e,this._currentCheckPointMaxBo=Hi.MODEL.progress(0==this._currentPoint?1:this._currentPoint-1),Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"])),this.loadCheckPointMonster(),this.isfirst=!1}),p(0,t,"currentBo",function(){return this._currentBo},function(e){this._currentBo=e}),p(0,t,"fullPower",function(){return this.currentBo>=this.currentCheckPointMaxBo}),p(0,t,"currentCheckPointMaxBo",function(){return this._currentCheckPointMaxBo<=0&&(this._currentCheckPointMaxBo=Hi.MODEL.progress(0==this._currentPoint?1:this._currentPoint-1)),this._currentCheckPointMaxBo}),p(1,e,"instance",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}(),FR=function(){function e(){}return b(e,"modules.checkpoint.others.CheckPointUtil"),e.killBoss=function(){if(TR.ins.getLeftGridNumMore20()&&0==hN.ins.isOpen("RECYCLE"))KQ.ins.showBagRecycle();else if(!kR.ins.isMatching&&(hN.ins.close("SPORTS_MAIN_VIEW"),hN.ins.close("ARENA_MATCH"),hN.ins.close("COPYMAINVIEW"),UR.instance.currentBo>=UR.instance.currentCheckPointMaxBo)){var e=Math.round((NF.mainChar.x-40)/80),t=Math.round((NF.mainChar.y-20)/40);jR.reqEntry(Hi.MODEL.missionId(UR.instance.currentPoint-1),e,t),UR.instance.clearBatch()}},e.requestKillLittleMonster=function(){var e=new ds;Tu.sendToService(e)},e.requestGetReward=function(){var e=new us;e.rewardID=UR.instance.current_GetRewardID+1,Tu.sendToService(e)},e}(),qR=function(){function e(){this.materialHash=null,this.currCopyId=0,this.isRaiding=0}b(e,"modules.copy.others.CopyData");var t=e.prototype;return t.setCopyEntry=function(e){this.currCopyId=e;var t=rn.getIndex(e);switch(rn.MODEL.cate(t)){case 1:this.setMaterialEntry(e)}Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_0)},t.setCopyRaids=function(e){var t=rn.getIndex(e);switch(rn.MODEL.cate(t)){case 1:this.setMaterialRaids(e)}},t.getMaterial=function(e){return this.materialHash?this.materialHash.get(e):null},t.setMaterialEntry=function(e){var t=this.getMaterial(e);t?t.f+=1:(t={f:1,r:0},this.materialHash.set(e,t))},t.setMaterialRaids=function(e){var t=this.getMaterial(e);t?t.r+=1:(t={f:0,r:1},this.materialHash.set(e,t))},t.maxRaids=function(){var e,t=0;if(this.materialHash)for(var i in this.materialHash.values)e=this.materialHash.values[i],t=Math.max(t,e.r);return t},t.getCopyAward=function(e){for(var t=rn.getIndex(e),i=rn.MODEL.goodsAward(t).split(","),n=0|i[0],s=0|i[1],o=[],a=0;a<s;a++)o.push(yB.create(n));return o},p(0,t,"isOpenCopy",function(){var e=parseInt($e.MODEL.value($e.getIndex(124))),t=parseInt($e.MODEL.value($e.getIndex(125)));return gR.ins.lv>=e&&UR.instance.currentPoint>=t}),p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),jR=function(){function e(){}return b(e,"modules.copy.others.CopyReqs"),e.reqEntry=function(e,t,i,n,s,o){if(void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),modules.copy.others.PigData.ins.isInPigCopy())zB.ins.showMsg(RP.n[41],1);else if(ZN.isEnabledChangeScene()||!dr.dtoEnterScene||40==dr.dtoEnterScene.type||56==dr.dtoEnterScene.type||57==dr.dtoEnterScene.type){var a=new YV;a.copyId=e,a.createPlayerId=n,a.channelId=s,a.x=t,a.y=i,a.statue=o,Tu.sendToService(a)}else zB.ins.showById(2126,1)},e.reqDirectEntry=function(e,t,i,n,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0);var o=new YV;o.copyId=e,o.createPlayerId=n,o.channelId=s,o.x=t,o.y=i,Tu.sendToService(o)},e.reqAward=function(e,t){void 0===t&&(t=0);var i=new vA;i.copyId=e,i.type=t,Tu.sendToService(i)},e.reqRaids=function(e){var t=new mA;t.copyId=e,Tu.sendToService(t)},e.reqMagicBaoku=function(e){var t=new CA;t.missionId=e,Tu.sendToService(t)},e.reqCopy=function(e){var t=new yA;t.type=e,Tu.sendToService(t)},e.reqDisplayAward=function(e){var t=new IA;t.copyId=e,Tu.sendToService(t)},e}(),WR=function(){function e(){var e=this;e.teamCopyList=[],e.yaoQingMemberList=[],e.teamCopyData=null,e.worldYaoQingCD=0,e.currentCopyID=0,e.nextRefreshTime=0,e.teamCopyID=0,e.noShow=!1,e.currentTargetID=0,e.assistAward=0,e.isAssist=!1,e.YaoQingCDList=new jl,e.teamMemberHash=new jl}b(e,"modules.copy.others.TeamCopyModelData");var t=e.prototype;return t.getTeamCopyList=function(){if(!(0<this.teamCopyList.length)){var e,t=0;for(t=0;t<Qn.count;t++)(e=new jp).key=Qn.MODEL.key(t),e.missionId=Qn.MODEL.missionId(t),e.copyAwards=Qn.MODEL.copyAwards(t),e.copyNameRes=Qn.MODEL.copyNameRes(t),e.copyBgRes=Qn.MODEL.copyBgRes(t),e.copyDesc=Qn.MODEL.copyDesc(t),e.bossHeadRes=Qn.MODEL.bossHeadRes(t),e.bossName=Qn.MODEL.bossName(t),e.walkthroughIDS=Qn.MODEL.walkthroughIDS(t),this.teamCopyList.push(e)}},t.getGongLueInfo=function(e){for(var t,i=[],n=0;n<e.length;n++)(t=new qp).headRes=Xn.MODEL.headRes(e[n]-1),t.bossName=Xn.MODEL.bossName(e[n]-1),t.bossLv=Xn.MODEL.bossLv(e[n]-1),t.bossWalkThrough=Xn.MODEL.bossWalkThrough(e[n]-1),i.push(t);return i},t.setLeaderInfo=function(e){var t=this;t.teamCopyData=new Object,t.teamCopyData.copyID=e.copyID,t.teamCopyData.teamUUID=e.teamUUID,t.teamCopyData.teamLeaderID=e.teamLeaderID;for(var i=null,n=0;n<e.mumberList.length;n++)if(e.mumberList[n].playerID==e.teamLeaderID){i=e.mumberList[n];break}null!=i&&(t.teamCopyData.name=i.name,t.teamCopyData.playerID=i.playerID,t.teamCopyData.Level=i.Level,t.teamCopyData.fsLevel=i.fsLevel,t.teamCopyData.avatar=i.avatar,t.teamCopyData.weapon=i.weapon,t.teamCopyData.wing=i.wing,t.teamCopyData.weaponSoul=i.weaponSoul,t.teamCopyData.chuanshi=i.chuanshi,t.teamCopyData.magicWeaponSoul=i.magicWeaponSoul,t.teamCopyData.fightValue=i.fightValue,t.teamCopyData.sex=i.sex)},t.clearTeamdata=function(){hN.ins.close("CHAT"),this.teamCopyData&&(this.teamCopyData=null),this.teamMemberHash=new jl,this.teamCopyID=-1},t.checkSelfHasTeam=function(){return null!=this.teamCopyData||0<this.teamMemberHash.length},t.getIndexBuMuid=function(e){for(var t=0,i=0;i<hn.count;i++)if(hn.MODEL.muId(i)==e){t=i;break}return t},t.checkPlayerInTeam=function(){var e=!1;return(null!=this.teamCopyData||0<this.teamMemberHash.length)&&(e=!0),e},t.checkPlayerInCopy=function(){var e=!1;if(0!=BR.ins.curCopyId){var t=rn.getIndex(BR.ins.curCopyId);51==rn.MODEL.cate(t)&&(e=!0)}return e},t.getTeamCopyTitlePath=function(e){return _r.getFullUrl("ui/layouts/teamCopy/"+e+".png")},t.reqCopyInfo=function(){Tu.sendToService(new EO)},t.reqCreateTeam=function(e){Tu.sendToService(new bO)},t.reqOutTeam=function(e){Tu.sendToService(new mO)},t.reqJieSanTeam=function(){Tu.sendToService(new yO)},t.reqCopyStart=function(){Tu.sendToService(new kO)},t.reqYaoQingToWorld=function(){Tu.sendToService(new xO)},t.reqYaoQingFriendOrGuildMember=function(e){1==e?Tu.sendToService(new TO):Tu.sendToService(new CO)},t.reqYaoQingToPlayer=function(e,t){var i=new wO;i.playerId=e,i.type=t,Tu.sendToService(i)},t.enterTeam=function(e){var t=new SO;t.teamUUID=e,Tu.sendToService(t)},t.lickPlayer=function(e){var t=new IO;t.playerID=e,Tu.sendToService(t)},p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e.MAX_MEMBER=3,e.attackMonsterSelect=null,e._instance=null,e}(),YR=function(){function e(){this.crossBattleData=null,this.crossBossData=null,this.curBossId=0,this.isBorn=0}b(e,"modules.corssbattle.others.CrossBattleDataModel");var t=e.prototype;return t.bossisBorn=function(){if(0<BR.ins.curCopyId)for(var e=BR.ins.curCopyId,t=this.crossBossData.copyList,i=0;i<t.length;i++){if(e==t[i].copyId)if(t[i].bossleftTime-dr.serverTimeSec<=0)return!0}return!1},t.isCrossBoss=function(e){return 0<e&&53==rn.MODEL.cate(rn.getIndex(e))},t.isCrossBossCopy=function(){return 0<BR.ins.curCopyId&&53==rn.MODEL.cate(rn.getIndex(BR.ins.curCopyId))},t.getBossServer=function(e){for(var t=this.crossBossData.copyList,i=0;i<t.length;i++)if(e==t[i].copyId){var n=t[i].serverId;return 0==n?RP.n[42]:n+""==hr.serverID?"本服-":"S."+n+"服-"}return""},t.getAttentionBossArr=function(){for(var e=[],t=this.crossBossData.copyList,i=0;i<t.length;i++){0==Ao.MODEL.missionType(Ao.getIndex(t[i].copyId))?e.push(t[i].copyId):0<t[i].serverId&&e.push(t[i].copyId)}return e},t.getBossRefreshTime=function(e){for(var t=modules.corssbattle.others.CrossBattleDataModel.ins.crossBossData.copyList,i=0;i<t.length;i++)if(e==t[i].copyId)return t[i].bossleftTime;return 0},p(1,e,"ins",function(){return e._ins=e._ins||new e}),e._ins=null,e}(),zR=function(){function e(){this.icomUrl=null,this.zsLimitStr=null,this.serverId=0,this.isOpen=0,this.owner=NaN,this.bossleftTime=NaN,this.caijileftTime=NaN,this.copyId=0,this.coypIndex=0}b(e,"modules.corssbattle.others.CrossBossVo");var t=e.prototype;return t.decode=function(e){this.copyId=e.readInt(),this.serverId=e.readInt(),this.bossleftTime=e.readInt(),this.caijileftTime=e.readInt(),this.coypIndex=rn.getIndex(this.copyId),this.zsLimitStr=rn.MODEL.zsLevelLimit(this.coypIndex)+"转-"+rn.MODEL.zsLevelUpLimit(this.coypIndex)+"转"},t.getzsLevelLimit=function(){return rn.MODEL.zsLevelLimit(this.coypIndex)<=gR.ins.zsLv&&rn.MODEL.zsLevelUpLimit(this.coypIndex)>=gR.ins.zsLv},e}(),XR=function(){function n(){}return b(n,"modules.dailygift.data.DailyGiftData"),p(1,n,"toc12202",function(){return n._toc12202}),p(1,n,"curaId",function(){return n._aid}),p(1,n,"actInfo",function(){return n._actInfo}),p(1,n,"endTime",function(){return n._actInfo?n._actInfo.endTime:-1}),p(1,n,"refreshTime",function(){var e=dr.curServerTime/1e3;return dr.getZeroTime(86400+e)}),p(1,n,"ableAwardIndex",function(){if(!n._actInfo)return-1;for(var e=0;e<n._actInfo.gifts.length;e++)if(n.isShowDot(e))return e;return-1}),n.initMainConfig=function(){n._toc12202=mB.getInStance().getMainType(1003),tr.push(RP.n[43]),n._aid=n._toc12202.activityIds[0]},n.initShowConfig=function(){n._actInfo=mB.getInStance().getActivityData(n._aid),tr.push(RP.n[44])},n.isAbleShare=function(e){var t=jP.getCpShareSwitch(),i=eR.ins.getRWT(e)<=0;return t&&i},n.getAward=function(e){var t=n.getGift(e);if(t){var i=St.MODEL.goodsReward(St.getIndex(t.giftId)).split(";");return n.getGoodsByType2(i)}return[]},n.getState=function(e){var t=n.getGift(e);return t?t.status:0},n.getGoodsByType2=function(e){for(var t=e,i=[],n={},s=0;s<t.length;s++){var o=t[s];if(o){var a=o.split(",");if(!a[2]||0==parseInt(a[2])||gR.ins.actorList[0].job==parseInt(a[2])){var r=parseInt(a[0]),l=parseInt(a[1]),c=n[r];c?c.goodsNum+=l:(c=yB.create(r,l),i.push(c),1==Bi.MODEL.type(c.cfgIdx)&&(n[r]=c))}}}return i},n.getDes=function(e){return 2==e?ei.MODEL.content(ei.getIndex(11102)):ei.MODEL.content(ei.getIndex(11101))},n.getCost=function(e){var t=n.getGift(e);if(t){var i=t.index;return parseInt(St.MODEL.targetParam1(i))}return 0},n.getGiftId=function(e){var t=n.getGift(e);return t?t.giftId:0},n.getGift=function(e){return n._actInfo?n._actInfo.gifts[e]:null},n.isShowDot=function(e){var t=n.getGift(e);if(t){if(1==t.status)return!0;if(2==t.status&&(0==e||1==e)&&n.isAbleShare(e+6))return!0}return!1},n._toc12202=null,n._aid=0,n._actInfo=null,n.hasOpenV=!1,n}(),QR=function(){function i(){}return b(i,"modules.digger.others.AE_BubbleDataModel"),i.goToOpenHelpDes=function(e){if(0<Vi.count)i.onJxrComplete(e);else{var t=[{url:_r.getJxrDBPath("ConfigRule"),type:"arraybuffer",cls:Vi}];uc.ins().onLoadJxrs(t,ql.create(CN,i.onJxrComplete,[e]))}},i.onJxrComplete=function(e){var t=Vi.MODEL.description(Vi.getIndex(e));hN.ins.open("AE_EXPLAIN_VIEW",{desc:t})},i.reqBubbleProfit=function(){var e=new BD;Tu.sendToService(e)},i.curRate=0,i.AE_TYPE=1,f(i,["b_infoHash",function(){return this.b_infoHash=new jl}]),i}(),JR=function(){function l(){this.money=0,this._data22202=null,this._recordTime22204=NaN,this._data22217=null,this._data22220=null,this._minerList=null}b(l,"modules.digger.others.DiggerDataCenter");var e=l.prototype;return e.changeMimePlayState=function(e){if(e){this._recordTime22204=dr.curServerTime;var t,i=e.playerId,n=e.leftMimeTimes,s=e.mimeQuality,o=e.canRob,a=l.diggerHash;n<=0?null!=a.take(i)&&(a.remove(i),Tu.sendToModule("__DIGGER_REMOVE__",["modules.scene.SceneModule"],[i])):(null==a.take(i)?((t=new bB).mimeLeftTimes=n,t.playerId=i,t.mimeQuality=s,t.canRob=o,t.playerId==gR.ins.charId&&(t.playerName=gR.ins.charName)):((t=a.take(i)).mimeLeftTimes=n,t.playerId=i,t.mimeQuality=s,t.canRob=o),Tu.sendToModule("__DIGGER_ADD__",["modules.scene.SceneModule"],[t]),a.put(i,t,!0))}},e.getMinerVos=function(){if(null==this._minerList){this._minerList=[];for(var e,t=Zs.count,i=0;i<t;i++)(e=new ZR).mineLvl=Zs.MODEL.key(i),e.goodsAward=Zs.MODEL.goodsAward(i),e.notRobAward=Zs.MODEL.notRobAward(i),this._minerList.push(e)}return this._minerList},e.getImproveCost=function(){var e=Js.MODEL.improveCost(0).split(":");return parseInt(e[1])},e.getDoubleGetCost=function(){var e=Js.MODEL.doubleGetCost(0).split(":");return parseInt(e[1])},e.getQuickFinishCost=function(){var e=Js.MODEL.quickFinishCost(0).split(":");return parseInt(e[1])},e.getMimeNameByQuality=function(e){var t;switch(e){case 1:t=Ql.createColor(RP.n[45],"#01b527");break;case 2:t=Ql.createColor(RP.n[46],"#a93aff");break;case 3:t=Ql.createColor(RP.n[47],"#ff831e");break;case 4:t=Ql.createColor(RP.n[48],"#e41b00")}return t},e.getMimeName=function(e){var t;switch(e){case 1:t=RP.n[49];break;case 2:t=RP.n[50];break;case 3:t=RP.n[51];break;case 4:t=RP.n[52]}return t},e.getMimeTitleSkin=function(e){var t;switch(e){case 1:t="ui/layouts/digger/wk_text_cjkg.png";break;case 2:t="ui/layouts/digger/wk_text_zjkg.png";break;case 3:t="ui/layouts/digger/wk_text_gjkg.png";break;case 4:t="ui/layouts/digger/wk_text_zjjkg.png"}return t},e.getMimeNameByQualityColor=function(e){var t;switch(e){case 1:t="#00ff0c";break;case 2:t="#00d2ff";break;case 3:t="#ff02f6";break;case 4:t="#ff0101"}return t},p(0,e,"data22220",function(){return this._data22220},function(e){this._data22220=e}),p(0,e,"data22202",function(){return this._data22202},function(e){this._data22202=e,this.money=e.money}),p(0,e,"data22217",function(){return this._data22217},function(e){this._data22217=e}),p(0,e,"data22204",null,function(e){l.diggerHash=new jl,this._recordTime22204=dr.curServerTime;for(var t=[],i=0;i<e.mimeList.length;i++){var n=e.mimeList[i];l.diggerHash.put(n.playerId,n,!0),t.push(n)}Tu.sendToModule("__DIGGER_RESET__",["modules.scene.SceneModule"],t)}),p(1,l,"instance",function(){return l._instance||(l._instance=new l),l._instance}),l.getFightReward=function(e){void 0===e&&(e=1);var t,i=modules.digger.others.DiggerDataCenter.instance.getMinerVos(),n=0;for(n=0;n<i.length;n++){var s=i[n];if(s.mineLvl==l.mimeQuality){t=s;break}}var o,a=t.getAwardList(.1*e),r=[];for(n=0;n<a.length;n++)o=a[n],r.push({itemId:o.goodsId,itemNum:o.goodsNum});return r},l.isPlayingZhanBao=!1,l.digZhanBaoType=-1,l.isDigging=!1,l.isBalanceing=!1,l.mimeQuality=-1,l.fightResult=-1,l.isNeedShowTips=!1,l.message23601=null,l._instance=null,f(l,["diggerHash",function(){return this.diggerHash=new jl}]),l}(),ZR=function(){function e(){this.mineLvl=0,this.goodsAward=null,this.notRobAward=null}b(e,"modules.digger.others.vo.MinerVo");var t=e.prototype;return t.getAwardList=function(e){void 0===e&&(e=1);var t,i=0,n=[],s=[],o=[];if(""!=this.goodsAward)for(n=this.goodsAward.split(";"),i=0;i<n.length;i++)2<=(o=n[i].split(",")).length&&(t=yB.create(o[0],o[1]*e),s.push(t));return s},t.getNotRobAwardList=function(){var e,t=0,i=[],n=[],s=[];if(""!=this.notRobAward)for(i=this.notRobAward.split(";"),t=0;t<i.length;t++)2<=(s=i[t].split(",")).length&&(e=yB.create(s[0],s[1]),n.push(e));return n},e}(),KR=function(){function e(){this.luckyValue=0,this.bestAwardNum=0,this.isFree=0,this.isAuto=!1,e._inst&&pt.window.alert(RP.n[53])}b(e,"modules.evaluate.others.EvaluateDataModel");var t=e.prototype;return t.initEvaluateData=function(e){this.luckyValue=e.luckyValue,this.bestAwardNum=e.bestAwardNum,this.isFree=e.isFree},t.updateEvaluateData=function(e){this.luckyValue=e.luckyValue,this.isAuto=!(0<e.isStop)},t.checkIsInActiveTime=function(e){var t;t=467==e?"LJIAN":"HJIAN";var i=CN.iconData;if(i)for(var n=0;n<i.icons1.length;n++){var s=i.icons1[n].iconId,o=kt.getIndex(s);if(kt.MODEL.iconName(o)==t)return!0}return!1},t.openEvaluateView=function(e){467==e?hN.ins.open("LJIAN"):hN.ins.open("HJIAN"),hN.ins.close("BAGPACK")},p(1,e,"ins",function(){return e._inst||(e._inst=new e),e._inst}),e._inst=null,e}(),$R=function(){function n(){}return b(n,"modules.fight.others.FightResultUtil"),n.createAwardList=function(e){for(var t=[],i=e.split(";"),n=0;n<i.length;n++){var s=i[n];if(s){var o=s.split(",");t.push({itemId:parseInt(o[0]),itemNum:parseInt(o[1])})}}return t},n.checkPanelClose=function(){if(1==modules.fight.others.FightResultUtil.isViewLink){var e,t=n.CHECK_PANELS;for(var i in t)if(e=t[i],hN.ins.isOpen(e))return}hN.ins.close("RESULT_FAIL"),modules.fight.others.FightResultUtil.isViewLink=!1},n.isFaildLink=!1,n.isViewLink=!1,f(n,["CHECK_PANELS",function(){return this.CHECK_PANELS=["ACTOR_M","ACTOR_ACTIVE","RECHARGE_VIEW","FIRST_RECHARGE","STRENGTH","TREASURE_VIEW","WEAPONSOUL_CORE","CIMELIA_MAIN_VIEW"]}]),n}(),eN=function(){function e(){this.ALL_TYPE=[0,1],this.ALL_PART=[90,91],this.equipDic=null,this.duanhunHash=new jl,this.duanhunSkillHash=new jl}b(e,"modules.god.other.GodEquipData");var t=e.prototype;return t.isGodEquip=function(e){return Ci.hasIndex(e)},t.hasGodEquip=function(e){var t;if(77==e)for(var i in gR.ins.actorList){t=gR.ins.actorList[i];var n=MR.ins.getEquip(t.id,1);if(!n||!this.isGodEquip(n.goodsId))return!1}else if(78==e){for(i in gR.ins.actorList)if(t=gR.ins.actorList[i],!(n=MR.ins.getEquip(t.id,2))||!this.isGodEquip(n.goodsId))return!1}return!0},t.getCurrGodEqu=function(e,t){this.equipDic||this.initGodCfgs();var i=this.ALL_PART[this.ALL_TYPE.indexOf(t)],n=MR.ins.getEquip(e,i);return n&&n.isGodEqu?n:null},t.getNextGodEqu=function(e,t){var i,n=this.getCurrGodEqu(e,t);if(n){i=this.equipDic.get(t);for(var s=0;s<i.length;s++){if(i[s].id==n.goodsId)break}return s<i.length-1?i[s+1].id:0}return(i=this.equipDic.get(t))[0].id},t.getRecycles=function(){return TR.ins.getRecycleEquips(null,-1,this.filterGodEquip)},t.filterGodEquip=function(e){return e.isGodEqu},t.isActorUpEnable=function(e){var t;for(var i in this.ALL_TYPE)if(t=this.ALL_TYPE[i],this.isUpable(e.id,parseInt(t)))return!0;return!1},t.isUpable=function(e,t){var i=this.getNextGodEqu(e,t);if(0<i){if(!PR.dressAbleById(gR.ins.actorById(e),i,this.ALL_PART[this.ALL_TYPE.indexOf(t)]))return!1;var n=Ci.getIndex(i),s=Ci.MODEL.cost(n);if(TR.ins.getGoodsNum(s[0])>=s[1])return!0}return!1},t.initGodCfgs=function(){this.equipDic=new jo;for(var e=0;e<Ci.count;e++){var t=Ci.MODEL.type(e),i=this.equipDic.get(t);i||(i=[],this.equipDic.set(t,i)),i.push({id:Ci.MODEL.key(e),lv:Ci.MODEL.level(e)})}for(e in this.equipDic.keys)this.equipDic.set(e,ol.srotOn(this.equipDic.get(e),"lv",Array.NUMERIC))},t.getDuanHunBuffIndex=function(e,t){var i=-1,n=Math.min(e,t);return 0!=n&&(i=n-1),i},t.getBuffIndexByLevel=function(e){return e<0&&(e=1),e-1},t.getDuanHuanBuffs=function(e,t){var i,n=this.getDuanHunBuffIndex(e,t);return-1!=n&&(i=Xt.MODEL.buffs(n)),i},t.getDuanHuanEffect=function(e,t){var i,n=this.getDuanHunBuffIndex(e,t);return-1!=n&&(i=Xt.MODEL.effects(n)),i},t.getDuanHunIndex=function(e,t){for(var i=-1,n=zt.count,s=0;s<n;s++){var o=zt.MODEL.position(s),a=zt.MODEL.level(s);if(o==e&&t==a){i=s;break}}return i},t.getDuanHunEffect=function(e,t,i){var n=this.getDuanHunIndex(e,t),s=zt.MODEL.effectid(n);if(s&&0<s.length){var o=s.split(",");return 1<o.length?o[i-1]:o[0]}return null},t.getDuanHunConsuption=function(e,t){var i,n=this.getDuanHunIndex(e,t);return-1!=n&&(i=zt.MODEL.consumDef(n)),i},t.getDuanHunMatIdAndNum=function(e,t){var i=null,n=this.getDuanHunConsuption(e,t);if(n&&0<n.length){var s=JSON.parse(n);if(s&&0<s.length){var o=(s=s[0]).value;if(o&&0<o.length){var a=o.split(":"),r=parseInt(a[0]),l=parseInt(a[1]);isNaN(r)||isNaN(l)||(i={id:r,num:l})}}}return i},t.getDuanHunAttrs=function(e,t){var i,n=this.getDuanHunIndex(e,t);return-1!=n&&(i=zt.MODEL.attrs(n)),i},t.getDuanHunFight=function(e,t){var i=0,n=!1,s=0,o=this.getDuanHunLevel(e,t),a=this.getLevel(e,t),r=Math.min(o,a);if(0==r)return 0;var l=this.getDuanHunAttrs(t,r);if(l&&0<l.length){var c=JSON.parse(l);i+=RR.getFight(c,e,0,!0,!1);for(var u=0;u<c.length;u++)if(c[u].type==aa.ATTR_INC_RATE.keyStr){n=!0,s=c[u].value/1e4;break}}if(n){var d=this.getCurrGodEqu(e,t);if(d){var h=PR.getGoodsNewAttr(d.goodsId),_=RR.getFight(h,e)*s;i+=Math.floor(_)}}return i},t.getDuanHunKey=function(e,t){return e+"_"+t},t.updateDuanHunInfo=function(e,t,i){this.duanhunHash.put(this.getDuanHunKey(e,t),i,!0)},t.getDuanHunLevel=function(e,t){return this.duanhunHash.take(this.getDuanHunKey(e,t))||0},t.getConditionLevel=function(e,t){var i,n=this.getDuanHunIndex(e,t),s=zt.MODEL.conditionDef(n);return s&&0<s.length&&(i=JSON.parse(s))&&0<i.length?(i=i[0]).value:0},t.isDuanHunUp=function(e,t){var i=this.getCurrGodEqu(e,t);if(null!=i){var n=this.getDuanHunLevel(e,t);if(!(n>=this.getDuanHunMaxLevel(t,n))){var s,o=this.getDuanHunIndex(t,n+1),a=zt.MODEL.conditionDef(o);if(a&&0<a.length&&(s=JSON.parse(a))&&0<s.length){var r=Ci.getIndex(i.goodsId);if(s=s[0],Ci.MODEL.level(r)>=s.value){var l=(s=this.getDuanHunMatIdAndNum(t,n+1)).id;if(s.num<=TR.ins.getGoodsNum(l))return!0}}}}return!1},t.isDuanHunActorUp=function(e){return this.isDuanHunUp(e,0)||this.isDuanHunUp(e,1)||this.isShowSkillRp(e)},t.getDuanHunMaxLevel=function(e,t){for(var i=0,n=zt.count,s=0;s<n;s++)e==zt.MODEL.position(s)&&zt.MODEL.level(s)>i&&(i=zt.MODEL.level(s));return i},t.getSkillLevel=function(e){return this.duanhunSkillHash.take(e)||0},t.updateDuanHunSkill=function(e,t){this.duanhunSkillHash.put(e,t,!0)},t.isShowSkillRp=function(e){var t=this.getSkillLevel(e),i=this.getLevel(e,0),n=this.getLevel(e,1),s=0<i&&0<n,o=this.getDuanHunLevel(e,0),a=this.getDuanHunLevel(e,1),r=1==o&&1==a&&0==t&&s;return r||!r&&t<o&&t<a&&(t<i&&t<n)},t.getLevel=function(e,t){var i=this.getCurrGodEqu(e,t);if(i){var n=i.goodsId,s=Ci.getIndex(n);return Ci.MODEL.level(s)}return 0},p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e.isDragonEffect=function(e){var t=e.replace("eid_","");return-1!=modules.god.other.GodEquipData.EFFECT_IDS.indexOf(t)},e.WEAPON=0,e.CLOTH=1,e._instance=null,f(e,["EFFECT_IDS",function(){return this.EFFECT_IDS=["jm1471","jm1472","jm1473","jm1474","jm1475"]}]),e}(),tN=function(){function e(){}return b(e,"modules.god.other.GodEquipReqs"),e.reqUpgrade=function(e,t){var i=new JL;i.roleIndex=e,i.equipIndex=t,Tu.sendToService(i)},e.reqBreak=function(e,t){var i=new ZL;i.roleIndex=e,i.type=t,Tu.sendToService(i)},e.reqDuanHunInfo=function(){var e=new KL;Tu.sendToService(e)},e.reqDuanHunUpgrade=function(e,t){var i=new $L;i.roleIndex=e,i.type=t,Tu.sendToService(i)},e.reqDuanHunSkillInfo=function(){var e=new tM;Tu.sendToService(e)},e.reqDuanHunSkillUpgrade=function(e){var t=new eM;t.roleIndex=e,Tu.sendToService(t)},e}(),iN=function(){function e(){var e=this;e.crtRoleId=1,e.needUpgrade=0,e.rolesDict={},e.holysDict={},e.leftExp=0,e.taskGroups=[],e._inited=!1,e.taskRoleId=0,e.activedRoleId=0,e.activedAmount=0,e.currentTaskId=0,e.currentStatus=-1,e.currentProgress=-1,e.currentTaskIds=[],e.TASKS_GLOBEL_ID=111,e.RESET_GLOBEL_ID=112,e.holyList=[1,2,3,4,5],e.previewDict=new jl,e.posDict=new jl,e.extPointDict=new jl}b(e,"modules.godweapon.others.GodWeaponData");var t=e.prototype;return t.updateInfo=function(e){this._inited=!0,this.leftExp=e.leftExp,this.rolesDict=e.roleDict,this.holysDict=e.holyWearDict,this.updateTaskStatus()},t.updateHolyExtPoint=function(e){if(0<e)for(var t=this.holyList,i=0;i<t.length;i++){var n=this.getGodHoly(e,t[i]);if(n){var s=Bi.MODEL.holyAddSkill(n.cfgIdx);if(s&&0<s.length){var o=s.split(":"),a=e+"_"+o[0],r=this.extPointDict.take(a);0<r?r+=parseInt(o[1]):r=parseInt(o[1]),this.extPointDict.put(a,r,!0)}}}},t.getExtPt=function(e,t){var i=this.extPointDict.take(e+"_"+t);return 0<i?i:0},t.getRoleExtPts=function(e){for(var t=0,i=0;i<this.holyList.length;i++)t+=this.getExtPt(e,this.holyList[i]);return t},t.getRoleOwnPts=function(e){var t=0,i=this.rolesDict[e];if(i){var n=i.skills;for(var s in n){var o=n[s];0<o&&(t+=o)}}return t},t.getWeaponTotalByRoleId=function(e){var t=[],i=this.rolesDict[e];if(i){var n="";(n=Ei.MODEL.attrs(i.weaponLv))&&0<n.length&&(t=aa.mergeFormatAttrs(n,t));var s=i.weaponId,o=i.skills;for(var a in o){var r=s+"_"+a+"_"+o[a];(n=ki.MODEL.attrs(ki.getIndex(r)))&&0<n.length&&(t=aa.mergeFormatAttrs(n,t))}for(var l=0;l<this.holyList.length;l++){var c=this.getGodHoly(e,this.holyList[l]);c&&(n=c.attribles)&&0<n.length&&(t=aa.mergeFormatAttrs(n,t))}}return t},t.getActivedByRoleId=function(e){var t=this.rolesDict[e];return!!t&&t.actived},t.getTaskGroup=function(){if(0==this.taskGroups.length){var e=$e.MODEL.value($e.getIndex(this.TASKS_GLOBEL_ID));if(e)for(var t=e.split(";"),i=0;i<t.length;i++)this.taskGroups.push(t[i].split(","))}return this.taskGroups},t.updateTaskStatus=function(){var e,t=this;for(var i in t.extPointDict.reset(),t.rolesDict)e=t.rolesDict[i],t.updateHolyExtPoint(e.roleId);var n=lB.instance(),s=n.completeDic;t.taskRoleId=0,t.currentTaskId=0,t.activedRoleId=0,t.activedAmount=0,t.currentStatus=-1,t.currentProgress=-1;var o=0;for(var a in t.rolesDict){var r=t.rolesDict[a];r&&(r.actived?((t.activedRoleId<=0||0<t.activedRoleId&&o>r.weaponId&&o>r.weaponId)&&(t.activedRoleId=r.roleId,o=r.weaponId),t.activedAmount++):0<r.taskId&&(t.taskRoleId=r.roleId,r.taskId))}var l=t.getTaskGroup();if(!(t.activedAmount>=l.length)){var c=l[t.activedAmount],u=(t.currentTaskIds=c)[0],d=s[u],h=null;if(d){if(d=s[u=c[c.length-1]])t.currentTaskId=u,t.currentStatus=1;else for(var _=0;_<c.length;_++)if(h=n.progressDic[c[_]]){t.currentTaskId=h.questId,t.currentStatus=0,t.currentProgress=h.phase;break}}else h=n.progressDic[u],t.currentTaskId=u,h&&(t.currentStatus=0,t.currentProgress=h.phase)}},t.getTaskProgressDescr=function(){var e=this.currentTaskIds.length,t=0,i="#00FF00";return 0<this.currentStatus?t=e:(i="#FF0000",0<this.currentTaskId&&(t=this.currentTaskIds.indexOf(this.currentTaskId.toString()))),Ql.createColor("("+t+"/"+e+")",i)},t.getPreviewIndexs=function(e){return this.previewDict.length<=0&&this.initPreviewData(),this.previewDict.take(e)},t.initPreviewData=function(){for(var e=Ai.count,t=0;t<e;t++){var i=Ai.MODEL.type(t);if(0<i){var n=this.previewDict.take(i);n||(n=[]),n.indexOf(t)<0&&(n.push(t),this.previewDict.put(i,n,!0))}}},t.getPositonsByWeaponId=function(e){return this.posDict.length<=0&&this.initPositionData(),this.posDict.take(e)},t.getGodHoly=function(e,t){var i=this.holysDict[e+"_"+t];return 0<i?yB.create(i):null},t.initPositionData=function(){for(var e=Mi.count,t=0;t<e;t++){var i=Mi.MODEL.type(t);if(0<i){var n=this.posDict.take(i);n||(n=[]),n.push(t),this.posDict.put(i,n,!0)}}},t.getPositionName=function(e,t){for(var i=this.getPositonsByWeaponId(e),n=0;n<i.length;n++){if(Mi.MODEL.position(i[n])==t)return Mi.MODEL.skillName(i[n])}return null},t.showTipHolyByPosId=function(e,t){var i=Si.MODEL.conditionDef(Si.getIndex(e)),n=this.rolesDict[t],s=!0;if(i&&0<i.length&&n&&(s=ks.enoughCondition(i,n.weaponLv)),s&&!this.getGodHoly(t,e)){var o,a=TR.ins.getPackGodWeaponHolys(),r=gR.ins.actorById(t);for(var l in a){if(!(0<(o=a[l]).roleJob))return!0;if(r.job==o.roleJob)return!0}}return!0},t.showTipByWeaponId=function(e,t){var i=this,n=i.roleIdByBtn(e,t);if(0<n){var s=i.rolesDict[n];if(s)if(s.actived){if(0<s.leftPoint)for(var o=0 in s.skills){var a=s.skills[o],r=Mi.getIndex(o),l=Mi.MODEL.upgradeLimit(r);if(a-i.getExtPt(s.roleId,o)<l)return!0}if(0<i.leftExp){var c=Ei.MODEL.consumeExp(s.weaponLv);if(0<c&&c<=i.leftExp)return!0}}else{if(0<s.taskId&&1==i.currentStatus)return!0;if(0<s.taskId&&0==i.currentStatus&&1==i.currentProgress)return!0;if(-1==i.currentStatus)return!0}else if(-1==i.currentStatus)return!0}return!1},t.roleIdByBtn=function(e,t){var i=gR.ins.actorList,n=i.length;if(3<n)return this.rolesDict[e+1];for(var s=0;s<n;s++){var o=i[s];if(o&&o.job==t)return o.id}return-1},p(0,t,"initedData",function(){return this._inited}),p(0,t,"costReset",function(){var e=$e.MODEL.value($e.getIndex(this.RESET_GLOBEL_ID)),t=parseInt(e);return 0<t?t:0}),p(1,e,"instance",function(){return e._instance||(e._instance=new e),e._instance}),e._instance=null,e}(),nN=function(){function e(){this._currentLevel=0,this._currentThroughLevel=0,this.leftChallengeTime=0,this.lastTime=0,this.lastQuality=0,this.showQuality=0,this.isFirstThrough=!1,this.configArr=null}b(e,"modules.godweapon.others.GodWeaponFairylandDataModal");var t=e.prototype;return t.update23770=function(e){this._currentLevel=e.levelID,this._currentThroughLevel=this._currentLevel,this.leftChallengeTime=e.leftTime,this.lastQuality=e.quality},t.update23771=function(e){this._currentThroughLevel=e.levelID,this.lastTime=e.time,this.isFirstThrough=e.isFisrtThrough,(0==this.lastQuality||e.lastQuality<=this.lastQuality)&&(this.lastQuality=e.lastQuality),this.showQuality=e.lastQuality},t.getRewardByLevelAndQuality=function(e,t){var i;switch(t){case 0:i=ir.MODEL.sReward(e-1);break;case 1:i=ir.MODEL.aReward(e-1);break;case 2:i=ir.MODEL.bReward(e-1);break;case 3:i=ir.MODEL.cReward(e-1)}return i},t.getConfig=function(){var e,t=this,i=0;null==t.configArr&&(t.configArr=[]);var n=!1;for(i=0;i<ir.count;i++)null==(e=t.configArr[i])&&(n=!0,e=new Sr,t.configArr.push(e)),e.id=ir.MODEL.key(i),e.id>t.currentLevel?e.quality=-1:e.id==t.currentLevel?t.currentLevel<t.currentThroughLevel?e.quality=0:1<t.lastQuality?e.quality=t.lastQuality-1:e.quality=0:e.quality=0,n||(t.configArr[i]=e);return t.configArr},p(0,t,"currentLevel",function(){return this._currentLevel}),p(0,t,"currentThroughLevel",function(){return this._currentThroughLevel}),p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),sN=function(){function e(){}return b(e,"modules.godweapon.others.GodWeaponRequest"),e.requestGodWeapon=function(){var e=new AD;Tu.sendToService(e)},e.requestGetTask=function(e,t){var i=new dD;i.taskId=e,i.roleId=t,Tu.sendToService(i)},e.reqActiveWeapon=function(e){var t=new DD;t.roleId=e,Tu.sendToService(t)},e.reqFinishedTask=function(e){var t=new Gp;t.taskId=e,Tu.sendToService(t)},e.reqWeaponUpgrade=function(e){var t=new OD;t.roleId=e,Tu.sendToService(t)},e.reqPosUpgrade=function(e,t){var i=new PD;i.roleId=e,i.posId=t,Tu.sendToService(i)},e.reqResetPoints=function(e){var t=new RD;t.roleId=e,Tu.sendToService(t)},e.reqHolyWear=function(e,t,i){var n=new ND;n.roleId=e,n.uuId=t,n.position=i,Tu.sendToService(n)},e}(),oN=function(){function e(){}return b(e,"modules.godweapon.others.GodWeaponReqUtil"),e.ReqCompoundItem=function(e,t,i){var n=new uD;n.uuId1=e.goodsId,n.uuId2=t.goodsId,n.uuId3=i.goodsId,Tu.sendToService(n)},e}(),aN=function(){function e(){}return b(e,"modules.godweapon.others.GodWeaponUtil"),e.isHalldom=function(e){var t=Bi.getIndex(e.goodsId),i=Bi.MODEL.subType(t),n=Bi.MODEL.colourId(t);return 4==i&&n<5},e}(),rN=function(){function e(){this.roleId=0,this.weaponId=1,this.actived=!1,this.weaponLv=0,this.leftPoint=0,this.useExp=0,this.skills={},this.taskId=0}return b(e,"modules.godweapon.proxys.GodWeaponRoleVO"),e}(),lN=function(){function e(){}return b(e,"modules.godweapon.views.shengyu.data.GodWeaponCost"),f(e,["TOWER_POINT",function(){return this.TOWER_POINT=[{x:382,y:490},{x:382,y:390},{x:382,y:306},{x:382,y:223},{x:382,y:137}]},"SY_POINT",function(){return this.SY_POINT=[{x:33,y:792},{x:355,y:661},{x:23,y:399}]},"SY_ITEM_LOC",function(){return this.SY_ITEM_LOC=[{icon:[81,18],tbg:[113,247],fly:[113,252],time:[113,279]},{icon:[81,18],tbg:[113,219],fly:[113,224],time:[113,251]},{icon:[75,92],tbg:[85,305],fly:[85,310],time:[85,337]}]}]),e}(),cN=function(){function e(){this.ShenBin_TowerInfo=null,this.ShenBin_ShenYuInfo=null,this.shenbinTList=[],this.shenbinSYList=[],this.syBossNums=0,this.syTowerArr=[],this.txHash=new jl}b(e,"modules.godweapon.views.shengyu.data.GodWeaponSYModel");var t=e.prototype;return t.getCopyInfoByType=function(){this.shenbinTList=[],this.shenbinSYList=[];for(var e=0;e<rn.count;e++){var t=rn.MODEL.cate(e);20==t?this.shenbinTList.push(e):21==t&&this.shenbinSYList.push(e)}},t.reqShenBinTower=function(e){jR.reqCopy(e)},p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance.getCopyInfoByType(),e._instance}),e.COPY_TYPE_TOWER=20,e.COPY_TYPE_SY=21,e._instance=null,e}(),uN=function(){function e(){this._skin=null}b(e,"modules.godweapon.views.weapon.GodWeaponPreviewItem");var t=e.prototype;return t.showHide=function(e){this._skin&&(this._skin.visible=e)},p(0,t,"skin",null,function(e){this._skin=e,this._skin.txt_descr.style.align="left",this._skin.txt_descr.style.font="SimHei",this._skin.txt_descr.style.fontFamily="SimHei",this._skin.txt_descr.style.fontSize=24,this._skin.txt_descr.style.color="#90877b",this._skin.txt_descr.style.leading=10}),p(0,t,"data",null,function(e){this._skin&&(this._skin.txt_title.text=Ai.MODEL.skillName(e),this._skin.skillIcon.skin=_r.getSkillPath(Ai.MODEL.skillIcon(e)),this._skin.txt_descr.innerHTML=Ai.MODEL.skillDesc(e))}),e}(),dN=function(){function e(){this._rtMap={},this._noArr=["/fightresult/","/fightresult."],null!=e._ins&&pt.window.alert(RP.n[54]),G.timer.loop(1e3,this,this.loop)}b(e,"modules.gui.others.PanelResMap");var t=e.prototype;return t.loop=function(){var e=pt.now();for(var t in this._rtMap){var i=this._rtMap[t];if(i&&G.loader.getRes(t)){var n=i.time;0==i.ref&&e-n>=modules.gui.others.PanelResMap.CLEAR_INTERVAL&&(delete this._rtMap[t],GB.release(t))}}},t.add=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];this.isLoad(i)&&this.updateTime(i)}},t.addRef=function(e){for(var t=0;t<this._noArr.length;t++)if(0<=e.indexOf(this._noArr[t]))return;var i=this._rtMap[e];i=i||{},this.isLoad(e)||(GB.retain(e),this._rtMap[e]=i),i.ref?i.ref++:i.ref=1},t.addRefs=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];this.addRef(i)}},t.rmRef=function(e){var t=this._rtMap[e];t&&(0!=t.ref?t.ref&&t.ref--:delete t.ref)},t.rmRefs=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];this.rmRef(i)}},t.isLoad=function(e){return null!=this._rtMap[e]},t.updateTime=function(e){var t=this._rtMap[e];t&&(t.time=pt.now())},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e.CLEAR_INTERVAL=1e4,e}(),hN=function(){function a(){this.panelVoMap={},this.destroyMap={},this.openIdArr=[],this.operateQueue=[],this.currOpenLayoutId=null,this.__openSubViewHandler=null,this._lockMaskIds={},this.destroyQueue=[],this.event=new ba,this.__openWaitCallbackBind=xs.bind(this,this.__openWaitCallback),this.__operateObjPool=new tu(20,{factory:xs.nullObjectFactory,recycle:function(e){e.vo=void 0,e.userData=void 0,e.operate=void 0}})}b(a,"modules.gui.others.PU");var e=a.prototype;return e.registPanel=function(e,t,i,n,s){var o=new Th;if(o.id=e,!(o.cls=t)){if(!s||"function"!=typeof s.factory)throw"illegal cls or option.factory";o.factory=s.factory}i&&(o.name=i),o.target=n,o.layer=s&&void 0!==s.layer?s.layer:"panel",s&&(o.wait=s.wait),"layout"==o.layer&&(o.wait=a.wait(a.waitLayout(),o.wait)),s&&void 0!==s.clearAll&&(o.clearAll=!!s.clearAll),s&&void 0!==s.mask&&(o.mask=!!s.mask),s&&void 0!==s.clickClose&&(o.clickClose=!!s.clickClose),o.destoryDelay=s&&void 0!==s.delay?0|s.delay:0,s&&null!=s.back&&(o.back=s.back),o.remove=!s||void 0===s.remove||!!s.remove,o.showDragon=!(!s||null==s.showDragon)&&s.showDragon,this.panelVoMap[e]=o},e.open=function(e,t,i,n){void 0===n&&(n=!1),"DAILY_ACTIVITY"==e?(JP.c_mainType=11,e="OPENSERVER"):"OS_TEHUI"==e&&(JP.c_mainType=12,e="OPENSERVER");var s=this.panelVoMap[e];pt.onPC&&(s||console.log("PU cannot find panel id = "+e)),s&&(s.isOpenning?s.isOpen&&n&&(s.userOpenData=t,s.userBackId=i,this.__notifyOpen(s,t)):s.target&&s.target.checkPanelOpen&&!s.target.checkPanelOpen(e,t)||(this.event.hasListener("prepare_open")&&this.event.event("prepare_open",e),s.isOpenning=!0,"panel"==s.layer||"layout"==s.layer?this.openIdArr.unshift(e):this.openIdArr.push(e),"layout"==s.layer&&(this.currOpenLayoutId=e,UB.ins._playPanelSound()),LY.Ins().closeLockArrow(41),s.userOpenData=t,s.userBackId=i,this.__clearPanelLayer(e,t),this._addOperate(s,t,"open")))},e.close=function(e,t){var i=this.panelVoMap[e];pt.onPC&&(i||console.log("PU cannot find panel id = "+e)),i&&i.isOpenning&&(i.target&&i.target.checkPanelClose&&!i.target.checkPanelClose(e,t)||(i.isOpenning=!1,this.openIdArr.splice(this.openIdArr.indexOf(e),1),i.userBackId=null,i.userOpenData=null,i._cache_backDatas=null,this.currOpenLayoutId==e&&(this.currOpenLayoutId=null),"layout"==i.layer&&UB.ins._playPanelSound(),$R.checkPanelClose(),this._addOperate(i,t,"close")))},e.back=function(e,t){var i=this,n=i.panelVoMap[e];if(pt.onPC&&(n||console.log("PU cannot find panel id = "+e)),n.isOpenning){var s=n._cache_backDatas,o=n.userBackId||n.back;if(i.close(e,t),s){var a=s.pop(),r=a.id,l=i.panelVoMap[r];0<s.length&&(l._cache_backDatas=s),"RESONATE_SUB_VIEW"==e&&("MO_MAIN_VIEW"==r?i.open(r,{_subIndex_:1}):"SOARING_VIEW"==r&&i.open(r,{_subIndex_:2})),"AO_EQUIP"==e&&"SPORTS_MAIN_VIEW"==r?i.open(r,{_subIndex_:1}):"OPENSERVER"==r?i.open(r,{_subIndex_:JP.sub_limitBuy}):"BOSS_MAINVIEW"==r?i.open(r,{_subIndex_:modules.boss.views.BossMainView.curTab}):"SKILL_MAINVIEW"==e&&"ACTOR_M"==r?t&&4==t?i.open(r,{subIndex:5}):i.open(r,a.userData,a.backId):"CROSSBATTLE_MAIN_VIEW"==e&&"ACTOR_M"==r?i.open(r,{subIndex:5}):i.open(r,a.userData,a.backId)}else o&&0!==o&&("PETMAIN_VIEW"==o?Tu.sendToModule("PETOPENVIEW",["modules.pet.PetModule"]):i.open(o))}},e.toggle=function(e,t){var i=this.panelVoMap[e];pt.onPC&&(i||console.log("PU cannot find panel id = "+e)),i&&i.isOpenning?this.close(e,t):this.open(e,t)},e.isOpen=function(e){var t=this.panelVoMap[e];return null!=t&&(pt.onPC&&(t||console.log("PU cannot find panel id = "+e)),t.isOpenning)},e.isDisplay=function(e){var t=this.panelVoMap[e];return pt.onPC&&(t||console.log("PU cannot find panel id = "+e)),!!t.panel&&!!t.panel.displayedInStage},e._closePanel=function(e){var t=arguments;be.isArray(t[0])&&(t=t[0]);for(var i=0;i<t.length;i++){var n=t[i][a._panelId_prop];n&&this.close(n)}},e._closePanelForce=function(e){for(;e;){var t=e[a._panelId_prop];if(t)return void this.close(t);e=e.parent}},e._backPanel=function(e){var t=e[a._panelId_prop];t&&("SKILL_MAINVIEW"==t?e.vsc&&this.back(t,e.vsc.selectedIndex):this.back(t))},e._backPanelForce=function(e){for(;e;){var t=e[a._panelId_prop];if(t)return void this.back(t);e=e.parent}},e._getPanel=function(e){var t=this.panelVoMap[e];return pt.onPC&&(t||console.log("PU cannot find panel id = "+e)),t?t.panel:null},e._getPanelId=function(e){return e[a._panelId_prop]},e._getOpenData=function(e){var t=this.panelVoMap[e];return pt.onPC&&(t||console.log("PU cannot find panel id = "+e)),t.userOpenData},e._closeLayout=function(){for(var e=0;e<this.openIdArr.length;e++){var t=this.panelVoMap[this.openIdArr[e]];if("layout"==t.layer)return void this.close(t.id)}},e._closeAll=function(){for(var e=0;e<this.openIdArr.length;e++)this.close(this.openIdArr[e])},e._getLayoutPanelId=function(){return this.currOpenLayoutId},e.foreachOpen=function(e,t){for(var i=this.openIdArr.concat(),n=0;n<i.length;n++){var s=i[n];e.call(t,s,this.panelVoMap[s].layer)}},e.loadRes=function(e,t,i){var n=JH.waitPreload[e];n&&n.load(t,i)},e._addOperate=function(e,t,i){var n=this.__operateObjPool.obtain();n.vo=e,n.userData=t,n.operate=i,this.operateQueue.push(n),1==this.operateQueue.length&&G.timer.callLater(this,this._operateThread)},e._operateThread=function(){for(var e=0;e<this.operateQueue.length;e++){var t=this.operateQueue[e];switch(t.operate){case"open":this.__open(t.vo.id,t.userData,t.vo);break;case"openDelay":this.__openDelay(t.vo.id,t.userData,t.vo);break;case"close":this.__close(t.vo.id,t.userData,t.vo)}this.__operateObjPool.release(t)}this.operateQueue.length=0},e.__open=function(e,t,i){this._removeDestroy(i),i.wait?i.waitHandler?i.waitHandler.resume(t,this.__openWaitCallbackBind):(i.waitHandler=i.wait.call(void 0),i.waitHandler.wait(e,t,this.__openWaitCallbackBind)):this.__openWaitCallback(e,t)},e.__openWaitCallback=function(e,t){var i=this.panelVoMap[e];i.isOpenning&&this._addOperate(i,t,"openDelay")},e.__clearPanelLayer=function(e,t){var i=this.panelVoMap[e];if("layout"==i.layer||"panel"==i.layer&&i.clearAll){for(var n,s,o,a,r=0;r<this.openIdArr.length;r++){var l=this.openIdArr[r];if("LAYOUT"!=l){var c=this.panelVoMap[l];if("panel"!=c.layer&&"layout"!=c.layer)break;"LAYOUT"==i.id&&l==this.currOpenLayoutId||"RESULT_SUCC"==l||"RESULT_FAIL"==l||"modules.copy.views.tower.CopyTowerFightSuccessView"==l||i!=c&&(n=l,s=c.userOpenData,o=c.userBackId,a=c._cache_backDatas,this.close(l),r--)}}if(n&&0===i.userBackId){var u={id:n,userData:s,backId:0!==o?o:null};a?(a.push(u),i._cache_backDatas=a):i._cache_backDatas=[u],i.userBackId=null}}0===i.userBackId&&(i.userBackId=null)},e.__openDelay=function(e,t,i){if(i.isOpenning){i.isOpen=!0;var n=i.panel||(i.panel=i.cls?new i.cls:i.factory.call());switch(void 0!==n.id&&(n.id=e),n[a._panelId_prop]=e,n.once&&(n.once("close",this,this._onPanelClose),n.once("SubPanel_showGuide",this,this._panelShowGuide),n.once("SubPanel_Close",this,this._panelClose),n.once("SubPanel_onRemove",this,this._panelRemove)),eq.instance.parent||eq.setup(),i.layer){case"layout":try{eq.layout.addPanel(n)}catch(e){console.log(e)}break;case"panel":try{eq.panelLayer.open(n,i.clearAll,i.mask,i.clickClose)}catch(e){console.log(e)}break;case"under":try{eq.underPanelLayer.addChild(n)}catch(e){console.log(e)}break;case"bottom":try{eq.bottomLayer.addChild(n)}catch(e){console.log(e)}break;case"nav":try{eq.navLayer.addChild(n)}catch(e){console.log(e)}break;case"effect":try{eq.effectLayer.addChild(n)}catch(e){console.log(e)}break;case"top":try{eq.topLayer.addChild(n)}catch(e){console.log(e)}}this.__notifyOpen(i,t),uq.showPanelLayer=!modules.gui.others.PU.ins.isCloseAll2}},e.__notifyOpen=function(e,t){this.event.hasListener("panel_open")&&this.event.event("panel_open",[e.id,t]),e.target&&(e.name&&(e.target[e.name]=e.panel),e.target.showPanel(e.id,t))},e.__close=function(e,t,i){if(this._addDestroy(i),i.isOpen){i.isOpen=!1;var n=i.panel;switch(delete n[a._panelId_prop],n.off&&n.off("close",this,this._onPanelClose),i.layer){case"layout":try{eq.layout.removePanel(n)}catch(e){console.log(e)}break;case"panel":try{eq.panelLayer.close(n)}catch(e){console.log(e)}break;case"under":try{eq.underPanelLayer.removeChild(n)}catch(e){console.log(e)}break;case"bottom":try{eq.bottomLayer.removeChild(n)}catch(e){console.log(e)}break;case"nav":try{eq.navLayer.removeChild(n)}catch(e){console.log(e)}break;case"effect":try{eq.effectLayer.removeChild(n)}catch(e){console.log(e)}break;case"top":try{eq.topLayer.removeChild(n)}catch(e){console.log(e)}break;case"none":if(i.remove)if(n.removeSelf)n.removeSelf();else{if(!n.parent)throw"Kidding me???";n.parent.removeChild(n)}}n&&("function"==typeof n.removeSelf?n.removeSelf():n.parent&&n.parent.removeChild(n)),i.waitHandler&&i.waitHandler.pause(),this.event.hasListener("panel_close")&&this.event.event("panel_close",e),i.target&&(i.name&&(i.target[i.name]=null),i.target.closePanel(e,t))}else i.waitHandler&&i.waitHandler.pause(),this.event.hasListener("panel_close")&&this.event.event("panel_close",e);this.lockMask(e,!1),uq.showPanelLayer=!modules.gui.others.PU.ins.isCloseAll2,modules.gui.others.PU.ins.isCloseAll2&&modules.pet.views.PetHasBirthedTip.ins.checkShow()},e._closeAllPanel=function(){for(var e=0;e<this.openIdArr.length;e++){var t=this.panelVoMap[this.openIdArr[e]];t&&"layout"==t.layer&&this.close(t.id)}},e._onPanelClose=function(e){var t=e&&e.currentTarget||e,i=t?t[a._panelId_prop]:null;i?this.close(i):console.error("event must has param = panel")},e.setup=function(){eq.panelLayer.on("MASK_CLOSE",this,this._onPanelLayerMaskClose),G.timer.frameOnce(1,this,this._setupHandler)},e._setupHandler=function(){this.__openSubViewHandler=new _N},e._onPanelLayerMaskClose=function(e){if(e){var t=e[a._panelId_prop];if(t){if(!0===this._lockMaskIds[t])return;this.close(t)}}},e.lockMask=function(e,t){t?this._lockMaskIds[e]=!0:null!=this._lockMaskIds[e]&&delete this._lockMaskIds[e]},e.fastDestroy=function(e){if(void 0===e&&(e=200),0!=this.destroyQueue.length){for(var t=0;t<this.destroyQueue.length;t++)this.destroyQueue[t]._destoryTime=0;G.timer.loop(e,this,this._destroyThread,null,!0)}},e._addDestroy=function(e){var t=this;0==t.destroyQueue.length&&G.timer.loop(100,t,t._destroyThread),t.destroyMap[e.id]&&t.destroyQueue.splice(t.destroyQueue.indexOf(e),1);for(var i=e._destoryTime=BB.getTimer()+1e3*e.destoryDelay,n=t.destroyQueue.length;0<n&&!(t.destroyQueue[n-1]._destoryTime<=i);)n--;t.destroyQueue.splice(n,0,e),t.destroyMap[e.id]=e},e._removeDestroy=function(e){this.destroyMap[e.id]&&(delete this.destroyMap[e.id],this.destroyQueue.splice(this.destroyQueue.indexOf(e),1),0==this.destroyQueue.length&&G.timer.clear(this,this._destroyThread))},e._destroyThread=function(){var e;if((e=this.destroyQueue[0])._destoryTime<=BB.getTimer()){e.panel;e.panel&&(e.panel.destroy&&e.panel.destroy(!0),e.panel=null),e.waitHandler&&(e.waitHandler.destroy(),e.waitHandler=null),delete this.destroyMap[e.id],this.destroyQueue.shift(),0==this.destroyQueue.length&&G.timer.clear(this,this._destroyThread)}},e._panelRemove=function(e){LY.Ins().closeLockArrow(12),e&&modules.gui.others.PU.ins.isOpen(e.id)&&modules.gui.others.PU.ins.close(e.id),e&&e.offAll()},e._panelClose=function(e){modules.gui.others.PU.ins.close(e)},e._panelShowGuide=function(e,t,i){if(void 0===i&&(i=!1),i)switch(t){case 12:if(e.layout&&e.layout.bottom_nav){if(LY.Ins().show(12,e.layout.bottom_nav.btn_back),"STRENGTH"==modules.gui.others.PU.ins._getLayoutPanelId()||e instanceof modules.limitChallenge.views.LimitChallengeMainView)return;LY.Ins().lockSceneShowByDisPlay(e.layout.bottom_nav.btn_back)}}else LY.showing&&LY.Ins().closeLockArrow(t)},p(0,e,"isCloseAll",function(){return!(0<eq.panelLayer.numChildren||this.currOpenLayoutId)}),p(0,e,"isCloseAll2",function(){return!(0<eq.panelLayer.numChildren||this.currOpenLayoutId)||!(!modules.gui.others.PU.ins.isOpen("CHAT")&&!modules.gui.others.PU.ins.isOpen("FRIENDNEWMAINVIEW"))}),p(1,a,"ins",function(){return a._ins||(a._ins=new a)}),a.waitAtlas=function(e){var t=arguments;be.isArray(t[0])&&(t=t[0]);for(var i=[],n=0;n<t.length;n++){var s=t[n].trim();""!=s&&i.push(_r.getLayoutsPath(s))}return a.waitRes.apply(void 0,i)},a.waitRes=function(e){var t=arguments;be.isArray(t[0])&&(t=t[0]);for(var i=[],n=0;n<t.length;n++){var s=t[n].trim();""!=s&&-1==i.indexOf(s)&&i.push(s)}return t=null,function(){return new ZH(i)}},a.waitConfig=function(e,t,i){return void 0===i&&(i=!1),function(){return new zH(e,t,i)}},a.waitLoad=function(){return function(){return new JH}},a.waitLayout=function(){return function(){return new XH}},a.wait=function(e){var t=arguments;return be.isArray(t[0])&&(t=t[0]),function(){return new QH(t)}},a.LAYER_NONE="none",a.LAYER_LAYOUT="layout",a.LAYER_BOTTOM="bottom",a.LAYER_UNDER="under",a.LAYER_PANEL="panel",a.LAYER_NAV="nav",a.LAYER_EFFECT="effect",a.LAYER_TOP="top",a._ins=null,f(a,["LAYER_ALL",function(){return this.LAYER_ALL=["none","nav","layout","bottom","under","panel","effect","top"]},"_panelId_prop",function(){return this._panelId_prop=xs.getSoleProperty()}]),a}(),_N=function(){function e(){hN.ins.event.on("panel_open",this,this.onListen)}return b(e,"modules.gui.others._OpenSubViewHandler"),e.prototype.onListen=function(e,t){if(t){var i=t._subId_||t._subid_;if(i){var n=hN.ins._getPanel(e),s=SB._getVSC(n);return void(s&&(s.selectId=i))}var o=isNaN(t._subIndex_)?t._subindex_:t._subIndex_;if(!isNaN(o))return n=hN.ins._getPanel(e),void((s=SB._getVSC(n))&&(s.selectedIndex=o))}},e}(),fN=function(){function i(){}return b(i,"modules.gui.views.HelpPanel"),i.openHelp=function(e){if(0<Vi.count)i.onJxrComplete(e);else{var t=[{url:_r.getJxrDBPath("ConfigRule"),type:"arraybuffer",cls:Vi}];uc.ins().onLoadJxrs(t,ql.create(CN,i.onJxrComplete,[e]))}},i.onJxrComplete=function(e){var t=Vi.getIndex(e),i=(Vi.MODEL.description(t).split(";"),Vi.MODEL.description(t).split(";").join("<br>"));hN.ins.open("AE_EXPLAIN_VIEW",{desc:i})},i}(),pN=function(){function n(){this._handler=null,this._backhandler=null,this._panel=null,this._layoutPanel=null,hN.ins.registPanel("LAYOUT",jJ,"_layoutPanel",this,{mask:!1,clearAll:!0,delay:600})}b(n,"modules.gui.views.LayoutManager");var e=n.prototype;return G.imps(e,{"ui.IPanelProxy":!0}),e.addPanel=function(e){null!=this._panel&&console.log("repeat addPanel"),this._panel=e,this.addSub()},e.removePanel=function(e){null==this._panel&&console.log("error"),this.removeSub(),this._panel=null},e.closePanel=function(e,t){Tu.sendToModule("LAYER_LAYOUT_CLOSE",["modules.broadcast.BroadcastModule"]),n.isPanelOnStage=!1,eq.navLayer.visible=!0},e.showPanel=function(e,t){var i=this;i._layoutPanel.bottom_nav.btn_back.clickHandler=i._backhandler||(i._backhandler=ql.create(i,i.onBack,null,!1)),i._layoutPanel.head_bar.btn_close.clickHandler=i._handler||(i._handler=ql.create(i,i.onClose,null,!1)),i.addSub(),Tu.sendToModule("LAYER_LAYOUT_OPEN",["modules.broadcast.BroadcastModule"]),n.isPanelOnStage=!0,eq.navLayer.visible=!1},e.updateMoney=function(){this._layoutPanel&&this._layoutPanel.displayedInStage&&this._layoutPanel.updateMoney()},e.addSub=function(){return!(!this._layoutPanel||!this._panel||this._panel.parent==this._layoutPanel)&&(this._layoutPanel.addPanel(this._panel),!0)},e.removeSub=function(){return this._layoutPanel&&this._layoutPanel.removePanel(this._panel),!1},e.onBack=function(e){if(gR.ins.isshowYuyiBless&&gR.ins.showYuyiBless)Tu.sendToModule("WING_CLEAR_BLESSTIPS",["modules.actor.ActorModule"]);else{if(this._panel){if(this._panel instanceof modules.weaponsoul.views.WeaponSoulCorePanel)return void Tu.sendToModule("ST_OPEN",["modules.strength.StrengthModule"],{selectedInex:4});if(this._panel instanceof modules.boss.views.bosshome.BossHomeSubView)return void hN.ins.open("BOSS_MAINVIEW","4");if(this._panel instanceof modules.rank.views.RankMainView){if(YP.instance.rankBack)return void hN.ins.open("NewDailyActMainView",{_subIndex_:"1"})}else if(this._panel instanceof modules.vip.views.VipMV){if(modules.copy.others.NewPigData.ins.isReturnShaoZhu)return void Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:1})}else this._panel instanceof modules.actor.views.soaring.ActorSoaringMainV?HR.ins.timeoutFlayBoss():this._panel instanceof modules.strength.views.fazhen.FazhenMainView&&Tu.sendToModule("ST_OPEN_RED",["modules.strength.StrengthModule"],{_subIndex_:3});hN.ins._backPanel(this._panel)}else{var t=hN.ins._getLayoutPanelId();t&&hN.ins.back(t)}Tu.sendToTotalModule("LAYER_LAYOUT_CLOSE")}},e.onClose=function(e){if(this._panel)hN.ins._closePanel(this._panel);else{var t=hN.ins._getLayoutPanelId();t&&hN.ins.close(t)}Tu.sendToTotalModule("LAYER_LAYOUT_CLOSE")},n.isPanelOnStage=!1,n}(),gN=function(){function e(){var e=this;e.kunsInfo=null,e.food1Id=2359,e.food2Id=2360,e.feedRankInfo=null,e.damageRankInfo=null,e.neverNotice=!1,e.kunMovePoint=[],e.monsterIds={},e.openedKunId=0,e.leaveOpenTimes={},e.kunsInfo=new $V}b(e,"modules.guild.others.GuildKunData");var t=e.prototype;return t.reqKunPanelInfo=function(){var e=new DO;Tu.sendToService(e)},t.reqFeed=function(e,t){var i=new OO;i.kunId=e,i.mode=t,Tu.sendToService(i)},t.reqOpenMission=function(e,t){var i=new AO;i.guildId=e,i.missionId=t,Tu.sendToService(i)},t.reqFightPanelInfo=function(e,t){var i=new PO;i.guildId=e,i.missionId=t,Tu.sendToService(i)},t.reqInvite=function(e){var t=new RO;t.missionId=e,Tu.sendToService(t)},t.reqUseGold=function(e){var t=new WO;t.missionId=e,Tu.sendToService(t)},t.reqNoticeHZ=function(e){var t=new YO;t.kunId=e,Tu.sendToService(t)},t.getMonsterId=function(e){if(null==this.monsterIds[e])for(var t=Wi.count,i=0;i<t;i++)if(e==Wi.MODEL.kunId(i)){this.monsterIds[e]=Wi.MODEL.monsterId(i);break}return this.monsterIds[e]},t.getMonsterHeadId=function(e){var t=this.getMonsterId(e),i=hn.getIndex(t),n=hn.MODEL.muId(i);return i=_n.getIndex(n),_n.MODEL.headId(i)},t.getGrowedKunId=function(){for(var e=0 in this.kunsInfo.kuns.proto)if(e&&2==this.kunsInfo.kuns.take(e).status)return e;return 0},t.isDead=function(e){var t=this.kunsInfo.kuns.take(e);return!(!t||3!=t.status)},t.getKunResIdx=function(e){for(var t=Wi.count,i=0;i<t;i++)if(e==Wi.MODEL.kunId(i))return i;return 0},t.getZhuanLevel=function(e){var t=this.getKunResIdx(e);return Wi.MODEL.ZhuanShengLevel(t)},t.getLevel=function(e){var t=this.getKunResIdx(e);return Wi.MODEL.kunLevel(t)},t.getLevelString=function(e){var t=this.getLevel(e)+"级",i=this.getZhuanLevel(e);return 0<i&&(t=i+"转"+t),t},t.getKunName=function(e){var t=this.getKunResIdx(e),i=Wi.MODEL.monsterId(t);return t=hn.getIndex(i),hn.MODEL.name(t)},t.getPanelPos=function(e){for(var t={},i=Wi.count,n=0;n<i;n++)if(e==Wi.MODEL.kunId(n)){var s=Wi.MODEL.panelPos(n);if(s&&0<s.length){var o=s.split(";");s=o[Math.floor(10*Math.random()%o.length)]}var a=s.split(",");a&&1<a.length&&(t.x=parseInt(a[0]),t.y=parseInt(a[1]))}return t},t.getMissionId=function(e){for(var t=Wi.count,i=0;i<t;i++)if(e==Wi.MODEL.kunId(i))return Wi.MODEL.missionId(i);return 0},t.getGrowthPerStr=function(e){var t=this.getGrowthPercent(e);return 1==t?"100%":(100*t).toFixed(2)+"%"},t.getGrowthPercent=function(e){var t=this.kunsInfo.kuns.take(e);if(t){var i=t.growth,n=this.getKunResIdx(e),s=Wi.MODEL.maxGrouthValue(n);return s<=i?1:i/s}return 0},t.reliveTime=function(e){var t=this.getKunResIdx(e),i=Wi.MODEL.reliveTime(t),n=this.kunsInfo.kuns.take(e);if(n){var s=n.deadTime,o=dr.serverTimeSec-s;return i<=o?0:i-o}return 0},t.setRelive=function(e){var t=this.kunsInfo.kuns.take(e);t&&(t.status=1,t.growth=0,t.deadTime=0)},t.getExpByCfg=function(e,t){var i,n=0;if((i=0==t?li.MODEL.commonFeedReWard(e):li.MODEL.luxuryFeedReWard(e))&&0<i.length){var s=JSON.parse(i);(s=(i=s[0].value).split(":"))&&1<s.length&&(n=parseInt(s[1]))}return n},t.getConsuptionByCfg=function(e,t){var i,n={goodsId:0,num:0};if((i=0==t?li.MODEL.commonFeedItem(e):li.MODEL.luxuryFeedItem(e))&&0<i.length){var s=JSON.parse(i);(s=(i=s[0].value).split(":"))&&1<s.length&&(n.goodsId=parseInt(s[0]),n.num=parseInt(s[1]))}return n},t.getGoldByCfg=function(e){return li.MODEL.luxuryFeedCostGold(e)},t.getCommonFeedIdx=function(e){for(var t=li.count,i=0;i<t;i++)if(e==li.MODEL.kunId(i))return i;return 0},t.getLuxuryFeedIdx=function(e){var t=this.kunsInfo.specialtimes||1,i=this.specialFeedMax-t+(this.getCommonFeedIdx(e)+1);return i>=li.count&&(i=li.count-1),i},t.getDescription=function(e){var t=this.getKunResIdx(e);return Wi.MODEL.extraDes(t)},t.getRewardByCfg=function(e){var t=[],i=this.getKunResIdx(e),n=Wi.MODEL.annReward(i),s=JSON.parse(n);if(s&&0<s.length)for(var o=s.length,a=0;a<o;a++){var r=s[a].value.split(":");if(r&&1<r.length){var l=yB.create(parseInt(r[0]),parseInt(r[1]));t.push(l)}}return t},t.autoOpenTime=function(e){return 0},t.autoCloseTime=function(e){return 0},t.isFullGrowth=function(e,t){var i=this.getKunResIdx(e);return Wi.MODEL.maxGrouthValue(i)<=t},t.isFullGrowth2=function(e){var t=this.kunsInfo.kuns.take(e);return!(!t||2!=t.status)},t.canFeedByCondiction=function(e){var t=this.getKunResIdx(e),i=Wi.MODEL.feedConditionDef(t);if(i&&0<i.length){var n=JSON.parse(i);if(2<=n.length){var s=n[0],o=n[1],a=0,r=0;return"playerLevel"==s.type&&(a=parseInt(s.value)),"playerLevel"==o.type&&(a=parseInt(o.value)),"playerZhuanShengLevel"==s.type&&(r=parseInt(s.value)),"playerZhuanShengLevel"==o.type&&(r=parseInt(o.value)),gR.ins.lv>=a&&gR.ins.zsLv>=r}}return!0},t.canSimpleFeed=function(e){if(!this.canFeedByCondiction(e))return!1;if(this.isFullGrowth2(e))return!1;if(0<this.kunsInfo.simpletimes)return!0;var t=this.getCommonFeedIdx(e),i=this.getConsuptionByCfg(t,0);return i.num<=TR.ins.getGoodsNum(i.goodsId)},t.canSpecialFeed=function(e){if(!this.canFeedByCondiction(e))return!1;if(this.kunsInfo.specialtimes<=0)return!1;if(this.isFullGrowth2(e))return!1;if(s=modules.guild.others.GuildKunData.ins.getGoldByCfg(t),gR.ins.YB>=s)return!0;var t=this.getLuxuryFeedIdx(e),i=this.getConsuptionByCfg(t,1),n=i.num,s=TR.ins.getGoodsNum(i.goodsId);return!(s<n)},t.canOpenMission=function(e){return 0==this.kunsInfo.statusObj[e]&&this.isFullGrowth2(e)},t.isOpenMission=function(e){return 1==this.kunsInfo.statusObj[e]},t.hasOpenTimes=function(e){return null==this.leaveOpenTimes[e]||0<this.leaveOpenTimes[e]},t.getFightCost=function(e){e=Math.min(e,Fs.count);var t=Fs.getIndex(e),i=Fs.MODEL.gold(t);return null==i&&(i=0),i},t.getSizeRate=function(e){var t=this.getKunResIdx(e);return Wi.MODEL.rate(t)/100},t.getTotalHP=function(e){var t=this.getMissionId(e),i=rn.getIndex(t),n=rn.MODEL.bossId(i);i=hn.getIndex(n);var s=hn.MODEL.attributes(i);if(s&&0<s.length){var o=JSON.parse(s);if(o&&0<o.length)for(var a=0;a<o.length;a++){var r=o[a];if(r&&"MAXHP"==r.type)return r.value}}return 1},p(0,t,"specialFeedMax",function(){var e=$e.getIndex(282);return parseInt($e.MODEL.value(e))}),p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),vN=function(){function e(){var e=this;e.joinGuild=!1,e.gczT=0,e.allGuildToc=null,e.myGuildBaseToc=null,e.myGuildMemList=null,e.mycontribute=null,e.myBuildInfo=null,e.pos=0,e.guild_bossToc=null,e.fightPass=0,e.fightVictory=!1,e.curCopyId=0,e.bossBlood=-1,e.reliveData=null,e.reddotData={},e.recordArrayVec=null,e.tc_allGuildInfo=null,e.tc_myGuildBase=null,e.tc_myGuildMems=null,e.tc_records=null,e.isFirst=!0,e.selectArr=null,e._sendCallMsgTimes=null,e._sendArgs=null,e.tc_allGuildInfo=new eH(5e3),e.tc_allGuildInfo.on("change",e,e.sendAllGuildInfoReq),e.tc_myGuildBase=new eH(1e3),e.tc_myGuildBase.on("change",e,e.sendMineGuildBaseReq),e.tc_myGuildMems=new eH(3e3),e.tc_myGuildMems.on("change",e,e.sendMineGuildMemsReq),e.recordArrayVec=[],e.tc_records=[];for(var t=0;t<7;t++){var i=new eH(1e4);e.tc_records.push(i),i.on("change",e,e.sendRecordReq,[t])}}b(e,"modules.guild.others.GuildModel");var t=e.prototype;return t.updateReddotData=function(e){xs.assign(this.reddotData,e.map)},t.updaterecordArr=function(e){e instanceof protos.guild.toc_12947?this.recordArrayVec[3]=e.list:e instanceof protos.guild.Guild_recordInout_12983_toc?this.recordArrayVec[4]=e.list:e instanceof protos.guild.Guild_recordPosChange_12984_toc?this.recordArrayVec[5]=e.list:e instanceof protos.guild.toc_12943&&(this.recordArrayVec[2]=e.list)},t.getRecord=function(){for(var e=[],t=0;t<Bl.RECORD_ARR.length;t++)this.recordArrayVec[Bl.RECORD_ARR[t]]&&(e=e.concat(this.recordArrayVec[Bl.RECORD_ARR[t]]));return e.sort(this.sortFunc),e},t.sortFunc=function(e,t){return e.time>=t.time?-1:1},t.changeBossUI=function(e){hN.ins.isOpen("GUILD_BOSS_SCENE_VIEW")!=!!e&&(e?(nF.curFightModule="modules.guild.GuildModule",Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_0),hN.ins.open("GUILD_BOSS_SCENE_VIEW")):(this.curCopyId=0,this.bossBlood=-1,this.reliveData=null,nF.curFightModule=null,qU.ins.updateBossBlood(0),hN.ins.close("GUILD_BOSS_SCENE_VIEW"),hN.ins.close("GUILD_BOSS_CD_VIEW"),Tu.sendToModule("__BOSS_EXIT__",["modules.scene.SceneModule"],{type:111})))},t.checkCopyId=function(e,t){if(!e)return!1;var i=rn.getIndex(e);return t==rn.MODEL.cate(i)},t.nextPassConfigIndex=function(e){var t=Gs.getIndex(e+1);return null==t?-1:t},t.foreachMem=function(e,t){if(this.myGuildMemList)for(var i=this.myGuildMemList.memList,n=0;n<i.length;n++)if(t.call(e,i[n]))return},t.sendCallMsg=function(e){var t=this;if(t._sendCallMsgTimes||(t._sendCallMsgTimes=[]),0<t._sendCallMsgTimes.length){var i=t._sendCallMsgTimes[t._sendCallMsgTimes.length-1];if(pt.now()-i<5e3)return void zB.ins.showMsg(RP.n[55],1);if(5<=t._sendCallMsgTimes.length&&(i=t._sendCallMsgTimes[0],pt.now()-i<6e4))return void zB.ins.showMsg(RP.n[55],1)}5<=t._sendCallMsgTimes.length&&t._sendCallMsgTimes.shift(),t._sendCallMsgTimes.push(pt.now()),1==e&&Tu.sendToService(new qM)},t.sendAllGuildInfoReq=function(){var e=new NM;Tu.sendToService(e)},t.sendMineGuildBaseReq=function(){var e=new HM;Tu.sendToService(e)},t.sendMineGuildMemsReq=function(){var e=new BM;Tu.sendToService(e)},t.sendRecordReq=function(e){var t=new VM;t.type=e,Tu.sendToService(t)},t.reqReddot=function(e){var t=arguments;if(this._sendArgs)for(var i=0;i<t.length;i++)-1==this._sendArgs.indexOf(t[i])&&this._sendArgs.push(t[i]);else this._sendArgs=be.transArgs(t),G.timer.frameOnce(1,this,this.delaySend)},t.delaySend=function(){var e=new FM;e.list=this._sendArgs,Tu.sendToService(e),this._sendArgs=null},t.isReddot=function(e){for(var t=arguments,i=0;i<t.length;i++)if(this.reddotData[t[i]])return!0;return!1},t.noGuild=function(){this.joinGuild=!1,this.myGuildBaseToc=null,this.myGuildMemList=null,this.allGuildToc=null,this.tc_allGuildInfo.reset(),this.tc_myGuildBase.reset(),this.tc_myGuildMems.reset(),this.clearRecord(),hN.ins.close("GUILD_BASE_MAINVIEW"),hN.ins.close("GUILD_CONTTIBULT_VIEW")},t.clearRecord=function(){for(var e=this.recordArrayVec.length=0;e<this.tc_records.length;e++)this.tc_records[e].reset()},t.findBestCallGoods=function(){for(var e,t=TR.ins.getBackPackItems(),i=0,n=0;n<t.length;n++){var s=t[n],o=s.goodsId,a=Bl.CALL_GOODS_GRADE[o];a&&i<a&&(i=a,e=s)}return e},t.getGuildDonateByRank=function(e){for(var t=0;t<Nl.count;t++)if(e<=Nl.MODEL.key(t))return Nl.MODEL.showvalue(t)+"";return"0"},t.getIsPassedAward=function(e){if(!modules.guild.others.GuildModel.ins.guild_bossToc)return!1;var t=Vs.getIndex(e);if(t>=modules.guild.others.GuildModel.ins.guild_bossToc.bossCount)return!1;var i=Vs.MODEL.key(t);return!(!modules.guild.others.GuildModel.ins.guild_bossToc.awardList.take(i)||0!=modules.guild.others.GuildModel.ins.guild_bossToc.awardList.take(i).state)},p(0,t,"myPos",function(){return this.myGuildBaseToc?this.myGuildBaseToc.minePos:7}),p(0,t,"myGuildId",function(){return this.myGuildBaseToc?this.myGuildBaseToc.guildId:0}),p(0,t,"guildBossCurIndex",function(){if(!this.guild_bossToc||this.guild_bossToc.copyId<=0)return-1;for(var e=0;e<Vs.count;e++)if(modules.guild.others.GuildModel.ins.guild_bossToc.copyId==Vs.MODEL.missionId(e))return e;return-1}),p(1,e,"ins",function(){return e._ins||(e._ins=new e)}),e._ins=null,e}(),mN=function(){function e(){this._leftTime=0,this._groupId=0,this._taskInfo=[],this._taskHash=null,this._allInfo=null,this.checkLoad()}b(e,"modules.limitChallenge.others.LCGodEquipModel");var t=e.prototype;return t.updateInfo=function(e){var t=0,i=0,n=hc.create(e[0]),s=this._taskHash.take(n.groupId);for(t=0;t<e.length;t++){var o=hc.create(e[t]);for(i=0;i<s.length;i++)if(s[i].id==o.id&&(s.splice(i,1,o),3==o.status)){Tu.sendToModule("GET_AWARD_EFFECT",["modules.limitChallenge.LimitChallengeModule"],o);break}}Tu.sendToModule("UPDATE_LIMIT_CHALLENGE",["modules.limitChallenge.LimitChallengeModule"])},t.isInAct=function(){return 0!=modules.limitChallenge.others.LCGodEquipModel.ins.leaveTime},t.getIsFinishById=function(e){if(0==e)return!0;if(this._groupId>this._taskHash.length)return!0;var t=this._taskHash.take(this._groupId);if(!t)return!0;for(var i=0;i<t.length;i++){var n=t[i];if(n.id==e&&3<=n.status)return!0}for(var s=0;s<this._allInfo.length;s++){var o=this._allInfo[s];if(o.id==e&&o.groupId<this._groupId)return!0}return!1},t.setData=function(e){if(this._taskHash||this.checkLoad(),e.length<8)this.updateInfo(e);else{this._taskInfo=[];for(var t=0;t<e.length;t++)if(e[t]){var i=hc.create(e[t]);this._taskInfo.push(i)}if(this._taskInfo[0]){var n=be.copyArray(this._taskInfo);this._taskHash.put(this._taskInfo[0].groupId,n,!0)}Tu.sendToModule("UPDATE_LIMIT_CHALLENGE",["modules.limitChallenge.LimitChallengeModule"])}},t.sortByPos=function(e,t){return e.position-t.position},t.checkRedPoint=function(){var e=!1,t=!1,i=!1,n=gR.ins.actorList,s=0;for(s=0;s<n.length;s++)if(AR.ins.isShowActorEquipPt(n[s])){i=!0;break}for(s=0;s<this._taskInfo.length;s++){var o=this._taskInfo[s];for(var a in o.lvLim){var r=o.lvLim[a];"playerLevel"==r.type?t=gR.ins.lv>=r.value:"playerZhuanShengLevel"==r.type&&(t=gR.ins.zsLv>=r.value)}if(e=this.getIsFinishById(o.id),t&&e&&2==o.status||i)return!0}return!1},t.updateCountDown=function(){if(this._leftTime<=0)return this._leftTime=0,void G.timer.clear(this,this.updateCountDown);this._leftTime=this._leftTime-1e3},t.checkLoad=function(){1<=Bs.count?this.initData():HP.loadConfig(["GLCResoure"],["ConfigGELC"],ql.create(this,this.initData))},t.initData=function(){var e,t=0,i={};for(this._allInfo=[],t=0;t<Bs.count;t++){var n=hc.createByIdx(t);i[n.groupId]?i[n.groupId].taskInfo.push(n):i[n.groupId]={group:n.groupId,taskInfo:[n]},this._allInfo.push(n)}for(var s in this._taskHash=new jl,i)e=i[s],this._taskHash.put(e.group,e.taskInfo)},t.getInfoByGroup=function(e){this._taskHash||this.checkLoad();var t=this._taskHash.take(e);if(!t)return[];if(e<this._groupId)for(var i=0;i<t.length;i++)t[i].status=3,t[i].progress=t[i].tarValue;return t.sort(this.sortByRule),t},t.sortByRule=function(e,t){return 2==e.status&&2==t.status&&modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(e.preId)&&modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(t.preId)?t.position-e.position:2==e.status&&modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(e.preId)?-1:2==t.status&&modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(t.preId)?1:3==e.status&&3==t.status?t.position-e.position:3==e.status?1:3==t.status?-1:modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(e.preId)&&modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(t.preId)?t.position-e.position:modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(e.preId)?-1:modules.limitChallenge.others.LCGodEquipModel.ins.getIsFinishById(t.preId)?1:t.position-e.position},t.reqReward=function(e){var t=new hD;t.rewardId=e,Tu.sendToService(t)},p(0,t,"leaveTime",function(){return this._leftTime},function(e){this._leftTime=e,G.timer.clear(this,this.updateCountDown),G.timer.loop(1e3,this,this.updateCountDown),this.updateCountDown()}),p(0,t,"groupId",function(){return this._groupId},function(e){this._groupId=e}),p(0,t,"taskInfo",function(){return this._taskInfo}),p(0,t,"taskHash",function(){return this._taskHash||this.checkLoad(),this._taskHash}),p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e.shouldOpen=!1,e.showGuild=!1,e.showArrow=!1,e._ins=null,e}(),yN=function(){function e(){this._data=null,this._leaveTime=0,this.groupId=1}b(e,"modules.limitChallenge.others.LimitChallengeModel");var t=e.prototype;return t.setData=function(e,t,i){var n=t+"_"+e;this._data.put(n,i,!0),Tu.sendToModule("UPDATE_LIMIT_CHALLENGE",["modules.limitChallenge.LimitChallengeModule"])},t.getData=function(e,t){var i=t+"_"+e;return this._data.has(i)?this._data.take(i):null},t.getTaskStateByGroupId=function(e,t){void 0===t&&(t=8);for(var i=[],n=(e-1)*t,s=0;s<t;s++){var o=n+s,a=qs.MODEL.missionId(o),r=lB.instance().getTaskAsstInfo(a),l={},c=0,u=0;if(null!=r){0==r.phase?l.state=0:lB.instance().checkRemoveById(a)?l.state=2:l.state=1;var d=r.targetList;if(null!=d&&0<d.length){var h=d[0];c=h.currentValue;var _=n_.getIndex(h.targetId);u=n_.MODEL.value(_)}}l.progress=c,l.maxProgress=u,i[s]=l}return i},t.updateCountDown=function(){if(this._leaveTime<=0)return this._leaveTime=0,void G.timer.clear(this,this.updateCountDown);this._leaveTime=this._leaveTime-1e3},p(0,t,"leaveTime",function(){return this._leaveTime},function(e){this._leaveTime=e,G.timer.clear(this,this.updateCountDown),G.timer.loop(1e3,this,this.updateCountDown),this.updateCountDown()}),p(1,e,"ins",function(){return e._inst||(e._inst=new e),e._inst}),e._inst=null,e}(),IN=function(){function e(){}return b(e,"modules.magic.others.MagicDataModel"),p(1,e,"isOpenMagicTower",function(){return!(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(188))))&&(!(gR.ins.zsLv<parseInt($e.MODEL.value($e.getIndex(189))))&&!(dr.getOpenServiceDay()<parseInt($e.MODEL.value($e.getIndex(190)))))}),p(1,e,"magicMinjingModuleId",function(){return 38}),p(1,e,"isPassAll",function(){return!!e.mTowerData&&(1==e.mTowerData.pLevel&&e.mTowerData.pId>=sn.count)}),p(1,e,"magicJindiModule",function(){return 37}),p(1,e,"isOpenMagicJindi",function(){return!!GR.getInstance().checkModuleOpen(e.magicJindiModule)}),p(1,e,"isOpenMagicBaoku",function(){return!(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(210))))&&(!(gR.ins.zsLv<parseInt($e.MODEL.value($e.getIndex(211))))&&!(dr.getOpenServiceDay()<parseInt($e.MODEL.value($e.getIndex(212)))))}),p(1,e,"isOpenMagicMinjing",function(){return!!GR.getInstance().checkModuleOpen(e.magicMinjingModuleId)}),e.getExtraAward=function(e){for(var t=e;t<sn.count;t++)if(sn.MODEL.extraAward(t)&&""!=sn.MODEL.extraAward(t))return{index:t,id:sn.MODEL.key(t),extra:sn.MODEL.extraAward(t),target:sn.MODEL.target(t).split("|")};return null},e.getMagicTowerAward=function(e,t,i){switch(void 0===i&&(i=!1),t){case 0:return sn.MODEL.firstReward(e);case 1:if(i&&""!=sn.MODEL.firstReward(e)){var n=sn.MODEL.sReward(e).replace("[","");return sn.MODEL.firstReward(e).replace("]",","+n)}return sn.MODEL.sReward(e);case 2:return sn.MODEL.aReward(e);case 3:return sn.MODEL.bReward(e)}return""},e.TAB_MTWOER="0",e.TAB_MJINDI="1",e.TAB_MMIJING="2",e.TAB_MBAOKU="3",e.mTowerData=null,e}(),bN=function(){function e(){}return b(e,"modules.magic.others.MagicRequest"),e.reqChallengeCopy=function(e){var t=new YV;t.copyId=e,Tu.sendToService(t)},e.reqMTowerReceive=function(e){var t=new $D;t.isReceive=e,Tu.sendToService(t)},e.reqMTowerAddTimes=function(){var e=new eO;Tu.sendToService(e)},e.reqCallFriend=function(e){var t=new EA;t.copyId=e,Tu.sendToService(t)},e.reqInitiatorId=function(e){var t=new TA;t.playId=e,Tu.sendToService(t)},e}(),wN=function(){function s(){}return b(s,"modules.mall.others.MallReqUtils"),s.reqMallList=function(e,t,i){s.callBackFunc=t,s.callBackparam=i;var n=new HL;n.ye=e,Tu.sendToService(n)},s.reqBuyMallGood=function(e,t){void 0===t&&(t=1);var i=new VL;i.index=e,i.buyNum=t,Tu.sendToService(i)},s.reqMySteryList=function(){var e=new GL;Tu.sendToService(e)},s.reqMySteryBuy=function(e,t){var i=new UL;i.index=e,i.shopIndex=t,Tu.sendToService(i)},s.reqMySteryRefresh=function(e,t){var i=new FL;i.costId=e,i.costNum=t,Tu.sendToService(i)},s.callBackFunc=null,s.callBackparam=0,s}(),xN=function(){function e(){this._currentClickedPoint=null,this._mapBossDate=null}b(e,"modules.map.others.MapDataModel");var t=e.prototype;return t.update25018=function(e){this._mapBossDate=e.bossInfoDic},t.updateClickPoint=function(e,t){this.currentClickedPoint.x=e,this.currentClickedPoint.y=t},t.getMissionIdByBossId=function(e){for(var t=0;t<Hu.count;t++){if(Hu.MODEL.bossId(t)==e)return Hu.MODEL.nextMissionId(t)}return 0},t.getMaxHpByModelId=function(e){var t=hn.getIndex(e);if(0<=t){var i=hn.MODEL.attributes(t),n=JSON.parse(i);if(n){for(var s=0;s<n.length;s++)if("MAXHP"==n[s].type)return n[s].value;return 1}}return 0},p(0,t,"currentClickedPoint",function(){return null==this._currentClickedPoint&&(this._currentClickedPoint=new Uh),this._currentClickedPoint}),p(0,t,"mapBossDate",function(){return null==this._mapBossDate&&(this._mapBossDate=new jo),this._mapBossDate}),e.Ins=function(){return null==e._ins&&(e._ins=new e),e._ins},e._ins=null,e}(),SN=function(){function e(){}return b(e,"modules.ModuleConst"),e.MLOGIN="modules.login.LoginModule",e.MACTOR="modules.actor.ActorModule",e.MBACKPACK="modules.backpack.BackpackModule",e.MCHAT="modules.chat.ChatModule",e.MSKILL="modules.skill.SkillModule",e.MSCENE="modules.scene.SceneModule",e.MMAIL="modules.mail.MailModule",e.MMALL="modules.mall.MallModule",e.MNAV="modules.nav.NavModule",e.MACHIEVE="modules.achieve.AchieveModule",e.MGUI="modules.gui.GuiModule",e.MACTIVITY="modules.activity.ActivityModule",e.MDAILY="modules.activityDaily.DailyModule",e.MBROADCAST="modules.broadcast.BroadcastModule",e.MGUILD="modules.guild.GuildModule",e.MFRIENDS="modules.friends.FriendsModule",e.MRANK="modules.rank.RankModule",e.MSTRENGTH="modules.strength.StrengthModule",e.MTASK="modules.task.TaskModule",e.MCUSTOMPASS="modules.customspass.CustomPassModule",e.MVIP="modules.vip.VipModule",e.MFIGHT="modules.fight.FightModule",e.MBOSS="modules.boss.BossModule",e.MCOPY="modules.copy.CopyModule",e.MZZT="modules.zzt.ZztModule",e.MTREASURE="modules.treasure.TreasureModule",e.MSPOTGOLD="modules.spotgold.SpotgoldModule",e.MOFFLINE="modules.offline.OfflineModule",e.MPASSSUIT="modules.passsuit.PassSuitModule",e.MFIELD="modules.field.FieldModule",e.MARENA="modules.arena.ArenaModule",e.MGOD="modules.god.GodModule",e.MTITLE="modules.title.TitleModule",e.MWELFARE="modules.welfare.WelfareModule",e.BUFF="modules.buff.BuffModule",e.MTIANGUAN="modules.tianguan.TianguanModule",e.RELIVE="modules.relive.ReliveModule",e.MPIG="modules.pig.PigModule",e.MSEVEN="modules.seven.SevenModule",e.MDIGGER="modules.digger.DiggerModule",e.FASHION="modules.fashion.FashionModule",e.MSIEGE="modules.siege.SiegeModule",e.MLOGINNOTICE="modules.loginnotice.LoginNoticeModule",e.MWEAPONSOUL="modules.weaponsoul.WeaponSoulModule",e.MTHUNDER="modules.thunder.ThunderModule",e.MRECHARGE="modules.recharge.RechargeModule",e.MASSIT="modules.assit.AssitModule",e.MYZBQC="modules.yzbqc.YzbqcModule",e.MGUIDE="modules.guide.GuideModule",e.BESTEQUIP="modules.bestequip.BestEquipModule",e.MEVALUATE="modules.evaluate.EvaluateModule",e.MGOLDROTARY="modules.goldrotary.GoldrotaryModule",e.CHECKPOINT="modules.checkpoint.CheckPointModule",e.JZGODEQU="modules.jzgod.JZGodModule",e.ACHIEVE_NEW="modules.achievenew.AchieveNewModule",e.RANK="modules.rank.RankModule",e.TASKNEW="modules.tasknew.TaskNewModule",e.GODWEAPON="modules.godweapon.GodWeaponModule",e.VIPGIFT="modules.vip.VipModule",e.LIMIT_CHALLENGE="modules.limitChallenge.LimitChallengeModule",e.SOUL="modules.soul.SoulModule",e.SOULOUT="modules.soul.SoulOutModule",e.SGRING_NEW="modules.specialgodring.SpecialGodRingModule",e.MNEWSIEGE="modules.newsiege.NewSiegeModule",e.MANCIENTBOSS="modules.bossancient.BossAncientModule",e.FRIENDNEW="modules.friendnew.FriendNewModule",e.PREVIEW="modules.preview.PreviewModule",e.YUNYING="modules.yunying.YunyingModule",e.TREASURE=" modules.treasure.TreasureModule",e.DAILYACT="modules.newDailyAct.NewDailyActModule",e.MMONTHCARD="modules.yueka.MonthCardModule",e.MAGIC="modules.mail.MagicModule",e.MOLIMITMISSION="modules.moLimitMission.MoLimitMissionModule",e.JIANBAO="modules.jianbao.JianbaoModule",e.MFIREDRAGON="modules.firedragon.FireDragonModule",e.CORSSBATTLE="modules.corssbattle.CrossBattleModule",e.CORSSBOSS="modules.corssbattle.CrossBossModule",e.NEWWORLDBOSS="modules.corssbattle.NewBossModule",e.MAPMODULE="modules.map.MapModule",e.AUCTION_HOUSE="modules.auctionhouse.AuctionHouseModule",e.NEIPAN="modules.niepan.NiepanModule",e.PET="modules.pet.PetModule",e.DAILYGIFT="modules.dailygift.DailyGiftModule",f(e,["moduleClass",function(){return this.moduleClass=[Hq,yq,wq,nj,Uq,Fq,Wq,Pq,ij,Sq,Eq,Kq,rj,uj,Aq,modules.boss.BossModule,modules.copy.CopyModule,cj,Qq,Jq,Mq,Iq,dj,ej,Lq,vq,mq,Vq,$q,bq,fj,Rq,Oq,Tq,gq,aj,lj,Dq,Bq,sj,oj,zq,Zq,xq,kq,_j,Yq,hj,Gq,jq,Nq,tj,Cq,modules.corssbattle.CrossBattleModule,modules.corssbattle.CrossBossModule,Xq,modules.corssbattle.NewBossModule,qq,modules.pet.PetModule,modules.guild.GuildModule,modules.strength.StrengthModule,modules.fashion.FashionModule,modules.auctionhouse.AuctionHouseModule,modules.firedragon.FireDragonModule,modules.friendnew.FriendNewModule]}]),e}(),kN=function(){function e(){this._moLevelArr=null,this.endTime=NaN}b(e,"modules.moLimitMission.others.MoLimitMissionDataModel");var t=e.prototype;return t.initData=function(){for(var e,t=0;t<su.count;t++)e=new EN(t),this._moLevelArr.push(e)},t.getDataByGroudAndID=function(e,t){var i;for(var n in this.moLevelArr[e-1])if((i=this.moLevelArr[e-1][n]).id==t)return i;return null},t.checkChapterMissionAllFinished=function(e){var t=this.moLevelArr[e-1];if(t){var i=0;for(var n in t.subMissionArr)2==t.subMissionArr[n].statue&&i++;return i==t.subMissionArr.length?1:0}return-1},t.checkHasSubLevelRewardUnget=function(e){var t=this.moLevelArr[e-1];if(t)for(var i in t.subMissionArr)if(1==t.subMissionArr[i].statue)return!0;return!1},t.checkSubLevelUnget=function(e){var t=this.moLevelArr[e-1];for(var i in t.subMissionArr)if(1==t.subMissionArr[i].statue)return!0;return!1},p(0,t,"moLevelArr",function(){return null==this._moLevelArr&&(this._moLevelArr=[]),0==this._moLevelArr.length&&this.initData(),this._moLevelArr}),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e._instance=null,e}(),EN=function(){function e(e){var t,i=this;i._chapter=0,i._titleImg=null,i._limitTime=0,i._reward=null,i._subMissionArr=null,i.currentProgress=0,i.statue=0,i._chapter=su.MODEL.key(e),i._titleImg=su.MODEL.titleResource(e),i._limitTime=su.MODEL.limitTime(e),i._reward=yB.createStrArr(su.MODEL.reward(e)),i._subMissionArr=[];for(var n=0;n<id.count;n++)id.MODEL.groudId(n)==i._chapter&&(t=new TN(n),i._subMissionArr.push(t))}b(e,"modules.moLimitMission.others.MoLimitMissionLevelVo");var t=e.prototype;return p(0,t,"reward",function(){return this._reward}),p(0,t,"chapter",function(){return this._chapter}),p(0,t,"titleImg",function(){return this._titleImg}),p(0,t,"limitTime",function(){return this._limitTime}),p(0,t,"subMissionArr",function(){return this._subMissionArr}),e.STATUE_UNGET=0,e.STATUE_ISGET=1,e}(),TN=function(){function e(e){var t=this;t._id=0,t._chapter=0,t._missionID=0,t._goCammand=null,t._showGoods=null,t._taskDesc=null,t._taskNum=0,t._currentProgress=0,t._statue=0,t._id=id.MODEL.key(e),t._chapter=id.MODEL.groudId(e),t._missionID=id.MODEL.missionId(e),t._goCammand=id.MODEL.taskContent(e),t._showGoods=id.MODEL.showgoods(e),t._taskDesc=id.MODEL.taskDesc(e),t._taskNum=id.MODEL.targetNum(e)}b(e,"modules.moLimitMission.others.MoLimitMissionSubLevelVo");var t=e.prototype;return p(0,t,"id",function(){return this._id}),p(0,t,"chapter",function(){return this._chapter}),p(0,t,"taskNum",function(){return this._taskNum}),p(0,t,"missionID",function(){return this._missionID}),p(0,t,"showGoods",function(){return this._showGoods}),p(0,t,"goCammand",function(){return this._goCammand}),p(0,t,"currentProgress",function(){return this._currentProgress}),p(0,t,"taskDesc",function(){return this._taskDesc}),p(0,t,"statue",function(){switch(lB.instance().getTaskStatus(this.missionID)){case Up.ON_PROCESS:return this._statue=0;case Up.CAN_COMMIT:return this._statue=1;case Up.FINISHED:return this._statue=2}return Up.NO_ACCEPT},function(e){this._statue=e}),e.STATUE_GOING=0,e.STATUE_CAN_FINISH=1,e.STATUE_FINISHED=2,e}(),CN=function(){function c(){}return b(c,"modules.nav.others.NavActUtil"),p(1,c,"iconData",function(){return c._iconData},function(e){c._iconData&&(c.doComplete(c._iconData.icons1,e.icons1),c.doComplete(c._iconData.icons2,e.icons2),c.doComplete(c._iconData.iconsPrevR,e.iconsPrevR)),c._iconData=e}),c.dealActIcon=function(e){if(e&&e.dataSource){var t=e.dataSource.iconId,i=BB.getTimer();if(1e3<i-c.clickTime){var n=new hM;n.iconId=t,Tu.sendToService(n),c.clickTime=i}var s=kt.getIndex(t),o=kt.MODEL.parent(s),a=kt.MODEL.respTextTips(s);if(0<o&&hZ.instance.close(),0<a&&dr.hasHotUpdate)return void zB.ins.showById(4543,1);switch(e.name){case"btnYz":Tu.sendToModule("OPEN_YZ",["modules.field.FieldModule"]);break;case"btnTb":Tu.sendToModule("TR_OPEN",["modules.treasure.TreasureModule"]);break;case"CS_TB":Tu.sendToModule("TR_HEFU_OPEN",["modules.treasure.TreasureModule"]);break;case"btnRank":Tu.sendToModule("OPEN",["modules.rank.RankModule"]);break;case"btnFl":Tu.sendToModule("OPEN",["modules.welfare.WelfareModule"]);break;case"btnJJ":hN.ins.open("ARENA_VIEW");break;case"btnDaily":Tu.sendToModule("OPENDAILYTASK",["modules.achieve.AchieveModule"]);break;case"btnshop":Tu.sendToModule("OPEN_MAIN_VIEW",["modules.mall.MallModule"]);break;case"btnKd":Tu.sendToModule("OPEN_SPORTS_VIEW",["modules.digger.DiggerModule"]);break;case"btnCZ":Tu.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"],{type:"first"});break;case"btnTQ":hN.ins.open("VIP3_VIEW");break;case"btn7":Tu.sendToModule("OPEN_ENTER",["modules.pig.PigModule"]);break;case"btnGuild":vN.ins.joinGuild?hN.ins.open("GUILD_MNG_MAINVIEW"):hN.ins.open("GUILD_LIST_VIEW");break;case"btnGcz":vN.ins.joinGuild?hN.ins.open("GUILD_PK_MAINVIEW"):(zB.ins.playErrorMsg(RP.n[57]),hN.ins.open("GUILD_LIST_VIEW"));break;case"btnYzbqc":Tu.sendToModule("OPEN",["modules.yzbqc.YzbqcModule"]);break;case"btnLB":Tu.sendToModule("14006",["modules.vip.VipModule"]);break;case"btnmrcz":Tu.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"],{type:"daily"});break;case"btnHb":Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]);break;case"ADDCONSUME":hN.ins.open("LJXF_VIEW");break;case"btnYzbq":FN.setNPCinfo("100211"),c.gotoYzbqcNpc();break;case"btnGodWeapon":Tu.sendToModule("OPEN_MAIN_PANEL",["modules.godweapon.GodWeaponModule"]);break;case"btnLimitChallenge":Tu.sendToModule("OPEN_LIMIT_CHALLENGE_MAIN",["modules.limitChallenge.LimitChallengeModule"]);break;case"btnArena":Tu.sendToModule("OPEN_ARENA",["modules.arena.ArenaModule"]);break;case"btnyuanshen":Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]);break;case"btnyueka":Tu.sendToModule("OPEN_MV",["modules.yueka.MonthCardModule"]);break;case"btnjiqingpaodian":case"btnyugao":hN.ins.open("NewDailyActMainView",{_subIndex_:"2"});break;case"shimingrenzheng":hN.ins.open("YUNYING_VERIFY_VIEW");break;case"baocunzhuomian":hN.ins.open("YUNYING_SAVE_VIEW");break;case"guanzhu":hN.ins.open("YUNYING_CARE_VIEW");break;case"weiduanxiazai":hN.ins.open("YUNYING_MICRO_VIEW");break;case"qiehuanzhenghao":hN.ins.open("YUNYING_ACCOUNT_VIEW");break;case"share":hN.ins.open("YUNYING_SHARE_VIEW");break;case"functionpredict":hN.ins.open("PREVIEW_VIEW");break;case"btnParent":hZ.instance.showActIcons(t);break;case"LIMITSURPRISE":if(!YB.isOpenLimitSp)return;if(0==EB.showCharge)return;hN.ins.open("LIMIT_SURPRISE");break;case"SuperVip":Tu.sendToModule("SUPER_VIP_VIEW",["modules.activityDaily.DailyModule"]);break;case"FocusReward":Tu.sendToModule("FOCUS_REWARD",["modules.activityDaily.DailyModule"]);break;case"BindPhone":Tu.sendToModule("BINDING_PHONE",["modules.activityDaily.DailyModule"]);break;case"WX_WXSHARE":Tu.sendToModule("WECHAT_SHARE",["modules.activityDaily.DailyModule"]);break;case"btn_favour":Tu.sendToModule("FAVOUR_GAME",["modules.activityDaily.DailyModule"]);break;case"FengMo":hN.ins.open("MAGIC_VIEW");break;case"TianMo":Tu.sendToModule("OPEN_WB_ENTER_PANEL",["modules.boss.BossModule"]);break;case"LIMIT_TASK":Tu.sendToModule("SHOW_MO_LIMIT_MISSION_MAIN_VIEW",["modules.moLimitMission.MoLimitMissionModule"]);break;case"Auction":De.reqBtnClickState(1),hN.ins.open("AUCTION_MAIN");break;case"FIRE_DRAGON":Tu.sendToModule("OPEN_FD_ENTER_PANEL",["modules.firedragon.FireDragonModule"]);break;case"FESTIVAL_BOSS":JP.ins.isLinkToView=0,Tu.sendToModule("OPEN_FEST_ENTER_PANEL",["modules.activity.ActivityModule"],t);break;case"CrossBattle":Tu.sendToModule("CROSSBATTLREQDATA",["modules.corssbattle.CrossBattleModule"]);break;case"btn_tecentlt":dr.isConchApp&&BP.dealActIconType(1);break;case"ForecastFunction":Tu.sendToModule("OPEN_HERALD",["modules.broadcast.BroadcastModule"]);break;case"btn_np":if(gR.ins.zsLv<parseInt($e.MODEL.value($e.getIndex(304))))return void zB.ins.showMsg(RP.n[58],1);Tu.sendToModule("OPEN_NIEPAN",["modules.niepan.NiepanModule"]);break;case"btn_pet":Tu.sendToModule("PETOPENVIEW",["modules.pet.PetModule"]);break;case"WX_MRLB":var r=[];r.sendMessageTitle=RP.n[59],r.sendMessageImg=_r.getInteractionPath(),qP.getAwyKf("awy_clickKf",r,jP.getAwyKfAward);break;case"WX_ONEYUAN":if(gR.ins.lv<kt.MODEL.openLevel(s))return;if(0==EB.showCharge)return;hN.ins.open("ONEYUAN_GIFT");break;case"EGG":hN.ins.open("IN_EGG");break;case"DAILYGIFT":WB.getActivity(1003);break;case"WX_ZEROYUAN":if(gR.ins.lv<kt.MODEL.openLevel(s))return;if(0==EB.showCharge)return;hN.ins.open("PAY0_VIEW");break;default:if(0<Et.count)c.onJxrComplete(t);else{var l=[{url:_r.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:Et}];uc.ins().onLoadJxrs(l,ql.create(c,c.onJxrComplete,[t]))}}}},c.onJxrComplete=function(e){if(Et.hasIndex(e)){var t=Et.getIndex(e),i=Et.MODEL.mainType(t);WB.getActivity(i,ql.create(c,c.onGetActivityList,[i,t]))}},c.onGetActivityList=function(e,t){var i=Et.MODEL.UIId(t);if(i)if(JP.c_mainType=e,hN.ins.isOpen(i)){var n=eU.toSelectIndex;hN.ins.close(i),G.timer.once(100,c,c.openPanel,[i,e,n],!0)}else hN.ins.toggle(i,e)},c.openPanel=function(e,t,i){eU.toSelectIndex=i,hN.ins.toggle(e,t),G.timer.clear(c,c.openPanel)},c.getIconBtn=function(e){var t=c.getActIcon(e);return t?t.btn:null},c.getActIcon=function(e){var t=sJ.ins.getCompomentsByName("NavActLView"),i=t?t.getIconBtn(e):null;return i||(i=(t=sJ.ins.getCompomentsByName("NavActRView"))?t.getIconBtn(e):null),i},c.getAIconOpen=function(e){var t=modules.nav.others.NavActUtil.iconData;if(t){var i,n=0;for(n=0;n<t.icons1.length;n++)if((i=t.icons1[n])&&i.iconId==e)return!0;for(n=0;n<t.icons2.length;n++)if((i=t.icons2[n])&&i.iconId==e)return!0;for(n=0;n<t.icons3.length;n++)if((i=t.icons3[n])&&i.iconId==e)return!0}return!1},c.checkHasRed=function(e){var t,i=0;for(i=0;i<c._iconData.icons1;++i)if((t=c.iconData.icons1[i]).iconId==e)return 2<=t.status;for(i=0;i<c._iconData.icons2;++i)if((t=c.iconData.icons2[i]).iconId==e)return 2<=t.status;for(i=0;i<c._iconData.iconsPrevR;++i)if((t=c.iconData.iconsPrevR[i]).iconId==e)return 2<=t.status;return!1},c.doComplete=function(e,t){for(var i=0;i<e.length;++i){for(var n=e[i],s=!1,o=0;o<t.length;++o)if(n.iconId==t[o].iconId){s=!0;break}s||c.closeActIcon(n.iconId)}},c.closeActIcon=function(e){if(kt.hasIndex(e))switch(kt.MODEL.iconName(kt.getIndex(e))){case"btnYz":break;case"btnCZ":hN.ins.close("FIRST_PAY");break;case"btnmrcz":hN.ins.close("EVERY_RECHARGE");break;case"btnTQ":hN.ins.close("VIP3_VIEW");break;case"btnYzbq":gB.ins.pushTips=!1,hN.ins.close("YZBQC_TIPS")}},c.gotoYzbqcNpc=function(){uH.Ins().currCid==_a.S_BIQI.toString()?ZN.goTarget(1,"100211"):(NF.Ins().recordMainCharPosition(),NF.Ins().changeScene("1"),sH.getInstance().autoMode=!1,G.timer.loop(100,c,c.clearTimerLoop))},c.clearTimerLoop=function(){uH.Ins().currCid==_a.S_BIQI.toString()&&(ZN.goTarget(1,"100211"),G.timer.clear(c,c.clearTimerLoop))},c._iconData=null,c.clickTime=0,c}(),LN=function(){function a(){}return b(a,"modules.nav.others.NavDataModel"),p(1,a,"bubbleIndex",function(){for(var e=0;e<Ui.count;e++)if(1==Ui.MODEL.type(e)&&Ui.MODEL.openDays(e)==dr.getOpenServiceDay())return e;return-1}),p(1,a,"isOpenAchieve",function(){return parseInt($e.MODEL.value($e.getIndex(90)))<=aB.instance.activedRingId||(parseInt($e.MODEL.value($e.getIndex(163)))<=gR.ins.lv||!!YP.instance.openBool)}),a.getBubbleIndexByIcon=function(e){for(var t=0;t<Ui.count;t++)if(Ui.MODEL.type(t)==e)return t;return-1},a.getShowID=function(e){var t;return 0<=(t=a.checkTime(e))?t:-1},a.checkTime=function(e){for(var t=0,i=-1,n=0;n<Ui.count;n++)if(Ui.MODEL.type(n)==e){var s=Ui.MODEL.startTimeStr(n),o=Ui.MODEL.endTimeStr(n);if(1==Ui.MODEL.openDays(n).length){if(-1==(t=Ui.MODEL.openDays(n)[0]))return n;if(0==t&&a.formatTime(s)<=dr.curServerTime&&a.formatTime(o)>=dr.curServerTime)return n;if(t==dr.getOpenServiceDay()){if(-1==a.formatTime(s)||-1==a.formatTime(o))return n;if(a.formatTime(s)<=dr.curServerTime&&a.formatTime(o)>=dr.curServerTime)return n}}else if(t=Ui.MODEL.openDays(n)[0],i=Ui.MODEL.openDays(n)[1],dr.getOpenServiceDay()>=t&&dr.getOpenServiceDay()<=i){if(-1==a.formatTime(s)||-1==a.formatTime(o))return n;if(a.formatTime(s)<=dr.curServerTime&&a.formatTime(o)>=dr.curServerTime)return n}}return-1},a.formatTime=function(e){if(null==e||0==e.length)return-1;var t=e.split(" ");if(null==t||2!=t.length)return-1;var i=t[0].split("-"),n=new Date;n.setFullYear(parseInt(i[0])),n.setMonth(parseInt(i[1])-1),n.setDate(parseInt(i[2]));var s=t[1].split(":");return n.setHours(parseInt(s[0])),n.setMinutes(parseInt(s[1])),n.setSeconds(parseInt(s[2])),n.getTime()},a.getIsOpen=function(e){switch(e){case 0:return!0;case 1:if(parseInt($e.MODEL.value($e.getIndex(90)))<=aB.instance.activedRingId)return!0;break;case 2:if(parseInt($e.MODEL.value($e.getIndex(163)))<=gR.ins.lv)return!0;break;case 3:if(YP.instance.openBool)return!0}return!1},a.attackSelect=null,a.attackMonsterSelect=null,a.attackCollcetionSelect=null,a.curOpenServiceDay=0,a.actRListOpen=!0,a.toc_12001=null,a.isCall=!1,a.isTarMove=!1,a.isShow=!1,a.isShowPop=!1,a.isShowPetBtn=!1,a}(),MN=function(){function e(){}return b(e,"modules.nav.others.NavUISet"),e.isNormalShow=!0,f(e,["NORMAL",function(){return this.NORMAL=["NavActRView","NavActLView","NavMap","NavTopBar","NavBoss","NavMission","NavCheckPoint","NavMineView","ChatSimpleUI","NavBottom","NavOtherBar","Navheji","NavNewDailyEnter"]},"COPY_0",function(){return this.COPY_0=["NavTopBar","NavBottom","NavOtherBar","ChatSimpleUI"]},"DIGGER",function(){return this.DIGGER=["NavBottom","ChatSimpleUI","Navheji"]},"COPY",function(){return this.COPY=["NavBottom","ChatSimpleUI","NavExit","Navheji","NavHejiMission","NavAttackOther","NavAttackTarget"]},"COPY_11",function(){return this.COPY_11=["NavBottom","ChatSimpleUI","NavAttackList","NavCounterList","Navheji","NavHejiMission","NavATKTargetHead","NavAttRemind"]},"COPY_10",function(){return this.COPY_10=["Navheji","NavBottom","NavExit"]},"COPY_8",function(){return this.COPY_8=["NavActLView","NavBottom","ChatSimpleUI","Navheji","NavTopBar"]},"COPY_CP",function(){return this.COPY_CP=["NavActLView","NavBottom","ChatSimpleUI","Navheji"]},"COPY_12",function(){return this.COPY_12=["NavHejiMission","NavExit","NavFairylandView","NavBottom","Navheji"]},"COPY_1",function(){return this.COPY_1=["NavActLView","NavBottom","ChatSimpleUI","NavExit","Navheji","NavMaterialView"]},"COPY_2",function(){return this.COPY_2=["NavActLView","NavBottom","ChatSimpleUI","Navheji","NavHejiMission","NavExit"]},"COPY_3",function(){return this.COPY_3=["NavBottom","ChatSimpleUI","NavTargetHead","NavAttackList","NavCounterList","NavExit","NavBlock","NavAttackOther","NavAttackTarget","Navheji","NavHejiMission","NavAttRemind"]},"COPY_6",function(){return this.COPY_6=["NavBottom","ChatSimpleUI","NavTargetHead","NavAttackList","NavCounterList","NavExit","NavAttackTarget","Navheji","NavHejiMission"]},"COPY_13",function(){return this.COPY_13=["NavBottom","ChatSimpleUI","NavTargetHead","NavAttackList","NavCounterList","NavExit","NavBlock","NavAttackOther","NavAttackTarget","Navheji","NavHejiMission","NavAttRemind"]},"COPY_14",function(){return this.COPY_14=["NavBottom","ChatSimpleUI","NavCounterList","NavAttackList","Navheji","NavHejiMission","NavTargetHead","NavExit"]},"ARENA",function(){return this.ARENA=["NavExit","NavBottom"]},"COPY_23",function(){return this.COPY_23=["NavExit","NavBottom","Navheji","NavHejiMission"]},"COPY_20",function(){return this.COPY_20=["ChatSimpleUI","NavBottom","NavAttackList","NavBlock","Navheji","NavCounterList","NavHejiMission","NavAttackOther","NavAttackTarget","NavExit","NavTargetHead","NavAttRemind"]},"SCZB",function(){return this.SCZB=["ChatSimpleUI","NavBottom","NavAttackList","NavExit","NavMonsterAttackList","NavAttackTarget","NavATKTargetHead","NavCounterList","Navheji"]},"COPY_26",function(){return this.COPY_26=["NavBottom","ChatSimpleUI","NavTargetHead","NavAttackList","NavCounterList","Navheji","NavHejiMission","NavAttackOther","NavAttRemind","NavBlock","NavExit"]},"COPY_27",function(){return this.COPY_27=["NavBottom","ChatSimpleUI","Navheji","NavExit"]},"COPY_15",function(){return this.COPY_15=["NavBottom","ChatSimpleUI","NavAttackList","NavCounterList","Navheji","NavHejiMission","NavTargetHead","NavExit","NavBlock","NavAttackOther","NavAttackTarget","NavAttRemind"]},"SZFB",function(){return this.SZFB=["NavBottom","ChatSimpleUI","NavHejiMission"]},"YZBQC",function(){return this.YZBQC=["ChatSimpleUI","NavBottom","NavAttackList","NavMonsterAttackList","NavAttackTarget","NavATKTargetHead","NavCounterList","Navheji"]},"COPY_31",function(){return this.COPY_31=["NavExit","NavBottom","ChatSimpleUI","Navheji","NavHejiMission"]},"COPY_24_25",function(){return this.COPY_24_25=["NavExit","NavBottom","ChatSimpleUI","Navheji","NavHejiMission"]},"COPY_41_42",function(){return this.COPY_41_42=["ChatSimpleUI","NavBottom","NavAttackList","NavBlock","NavCounterList","NavHejiMission","NavAttackOther","NavAttackTarget","NavExit","NavTargetHead","NavAttRemind","NavCallFriend","Navheji"]},"COPY_44",function(){return this.COPY_44=["NavBottom","ChatSimpleUI","Navheji","NavHejiMission","NavExit"]},"COPY_32",function(){return this.COPY_32=["NavExit","NavBottom","ChatSimpleUI","Navheji","NavHejiMission"]},"COPY_34",function(){return this.COPY_34=["NavHejiMission","NavExit","NavBottom","Navheji"]},"COPY_43",function(){return this.COPY_43=["NavHejiMission","NavExit","NavBottom","Navheji"]},"COPY_45",function(){return this.COPY_45=["ChatSimpleUI","NavHejiMission","NavExit","Navheji","NavBottom","NavBlock"]},"GUILD_CALL_BOSS",function(){return this.GUILD_CALL_BOSS=["ChatSimpleUI","NavBottom","Navheji","NavHejiMission","NavInCallBoss","NavBlock"]},"GUILD_CALLED_BOSS",function(){return this.GUILD_CALLED_BOSS=["ChatSimpleUI","NavBottom","Navheji","NavHejiMission","NavExit","NavBlock"]},"COPY_47",function(){return this.COPY_47=["NavBottom","ChatSimpleUI","NavTargetHead","NavAttackList","NavCounterList","NavExit","NavBlock","NavAttackOther","NavAttackTarget","Navheji","NavHejiMission","NavAttRemind"]},"COPY_50",function(){return this.COPY_50=["ChatSimpleUI","NavHejiMission","NavExit","Navheji","NavBottom","NavBlock"]},"COPY_51",function(){return this.COPY_51=["ChatSimpleUI","NavHejiMission","NavExit","Navheji","NavBottom","NavBlock"]},"COPY_52",function(){return this.COPY_52=["ChatSimpleUI","NavHejiMission","NavExit","Navheji","NavBottom","NavBlock"]},"COPY_53",function(){return this.COPY_53=["ChatSimpleUI","NavBottom","NavAttackList","NavBlock","CROSSBOSSTITLE","NavCollectionList","NavCounterList","NavHejiMission","NavAttackOther","NavAttackTarget","NavExit","NavTargetHead","NavAttRemind","NavCallFriend","Navheji"]},"COPY_54",function(){return this.COPY_54=["ChatSimpleUI","NavBottom","NavBlock","NavHejiMission","NavExit","NavCallFriend","Navheji"]},"COPY_56",function(){return this.COPY_56=["ChatSimpleUI","NavBottom","NavAttackList","NavBlock","NavCounterList","NavHejiMission","NavAttackTarget","NavExit","NavAttRemind","Navheji","NavMiniMap"]},"COPY_57",function(){return this.COPY_57=["ChatSimpleUI","NavBottom","NavAttackList","NavBlock","NavCounterList","NavHejiMission","NavAttackOther","NavAttackTarget","NavExit","NavTargetHead","NavAttRemind","NavCallFriend","Navheji","NavHejiMission"]},"COPY_58",function(){return this.COPY_58=["NavActLView","NavBottom","ChatSimpleUI","Navheji","NavHejiMission","NavExit"]}]),e}(),AN=function(){function e(){this.isInit=!1,this._stateH=null,this._regH=null,this._updateList=[],e._ins&&pt.window.alert("NavRedptM not new"),this._stateH=new jl,this._regH=new jl}b(e,"modules.nav.others.redpt.RedptM");var t=e.prototype;return t.addListener=function(e,t,i){var n;this._regH.has(e)?n=this._regH.take(e):(n=new f_,this._regH.put(e,n)),n.careList=t,n.handler=i;for(var s=!1,o=0;o<t.length&&!(s=this._stateH.take(t[o]));o++);s&&i.runWith([e,s])},t.removeListener=function(e){if(this._regH&&this._regH.has(e)){var t=this._regH.take(e);t&&(t.dispose(),this._regH.remove(e))}},t.updatePt=function(e,t){this._stateH.put(e,t,!0),-1==this._updateList.indexOf(e)&&this._updateList.push(e),G.timer.callLater(this,this.updateState)},t.updateState=function(){var e=0;for(var t in this._regH.proto){var i=this._regH.proto[t],n=!1,s=!1;for(e=0;e<i.careList.length;e++)s||(s=-1!=this._updateList.indexOf(i.careList[e])),this._stateH.take(i.careList[e])&&(n=!0);s&&i.handler.runWith([t,n])}this._updateList=[]},t.getStateByBtnName=function(e){if(!this._regH.has(e))return!1;for(var t=this._regH.take(e),i=0;i<t.careList.length;i++)if(this._stateH.take(t.careList[i]))return!0;return!1},t.getStateByCareList=function(e){for(var t=0;t<e.length;t++)if(this._stateH.take(e[t]))return!0;return!1},p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e.reqNav=function(){var e=new qA;Tu.sendToService(e)},e.reqRedPt=function(e){var t=new jA;t.list=e,Tu.sendToService(t)},e._ins=null,e}(),DN=function(){function e(){var e=this;e.isclickGet=!1,e.isShowCN_effect_h=!0,e.isShowCN_effect_a=!0,e.isShowDQ_effect=!0,e.isShowHG_effect=!0,e.isShowCQ_effect=!0,e.selectedNum=0,e.selectedGoodsObject=null,e.sceneName="",e.enterSceneId=0,e.winGuild="",e.myGongXun=0,e.myScore=0,e.addScore=0,e.addZhanGong=0,e.myGuildScore=0,e.awardList=[],e.playerList=[],e.reliveT=0,e.restT=0,e._hash=null,e.guideRank=[],e.personRank=[],e.hurtRank=[],e.endTime=0,e._toc23335=null}b(e,"modules.newsiege.others.NewSiegeData");var t=e.prototype;return t.changeSCZBscene=function(e){e&&(hN.ins.close("GUILD_MNG_MAINVIEW"),hN.ins.close("GUILD_PK_MAINVIEW"),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.SCZB),Tu.sendToModule("OPEN_MAIN_SCENE_VIEW",["modules.newsiege.NewSiegeModule"]))},t.clear=function(){Tu.sendToModule("CLEAR_LIST_INFO",["modules.nav.NavModule"]),this.guideRank=[]},t.reqGuildInfo=function(){var e=new tD;Tu.sendToService(e)},t.reqCaiJiStartInfo=function(e){var t=new _D;t.uuid=e,Tu.sendToService(t)},t.reqGuildAwards=function(){var e=new jM;Tu.sendToService(e)},t.reqCaiJiEndInfo=function(){var e=new fD;Tu.sendToService(e)},t.reqGetAwardsInfo=function(e){var t=new eD;t.awardId=e,Tu.sendToService(t)},t.reqLastRank=function(){var e=new KA;Tu.sendToService(e)},t.reqCurrentRank=function(){var e=new aD;Tu.sendToService(e)},t.reqFFguildAwards=function(e,t){var i=new nD;i.goodsid=e,i.list=t,Tu.sendToService(i)},t.reqDayguildAwards=function(){var e=new sD;Tu.sendToService(e)},t.getAwards=function(e){return this.initAward(),this._hash.get(e)},t.reqBeforeMoveScene=function(e){var t=new iD;t.cid=e,Tu.sendToService(t)},t.reqEntry=function(e){if(ZN.isEnabledChangeScene()){var t=new $A;t.cId=e,Tu.sendToService(t)}},t.reqGetAwardsMembers=function(){var e=new rD;Tu.sendToService(e)},t.getAwardsByRank=function(e,t){var i="",n=0,s=1==t?"PersonalRank":"GuildRank";for(n=0;n<wi.count;n++)if(s==wi.MODEL.rewardType(n)){var o=wi.MODEL.param(n);if(parseInt(o[0])>=e&&e<=parseInt(o[1])){i=wi.MODEL.goodsRewardStr(n);break}}return i},t.getAwardsList=function(e){for(var t=[],i=0;i<wi.count;i++)wi.MODEL.rewardType(i)==e&&t.push(i);return t},t.getReliveTimes=function(){for(var e=0,t=0;t<bi.count;t++){if(bi.MODEL.key(t)>=this.myScore){e=bi.MODEL.time(t);break}}return e},t.guildTop5=function(){if(""==gR.ins.guildName||""==of.ins.panelInfo.wcGuild)return!1;for(var e=0;e<this.guideRank.length;e++)if(this.guideRank[e].rank<=5&&gR.ins.guildName==this.guideRank[e].gname&&gR.ins.charName==this.guideRank[e].name)return!0;return!1},t.isWinGuildHuiZhang=function(){return""!=gR.ins.guildName&&""!=of.ins.panelInfo.wcGuild&&(gR.ins.guildName==of.ins.panelInfo.wcGuild&&gR.ins.charName==of.ins.panelInfo.charName)},t.isWinGuildPlayer=function(){return""!=gR.ins.guildName&&""!=of.ins.panelInfo.wcGuild&&gR.ins.guildName==of.ins.panelInfo.wcGuild},t.getdayAwardsStatus=function(){var e=new oD;Tu.sendToService(e)},t.initAward=function(){if(!this._hash){this._hash=new jo;for(var e=0;e<wi.count;e++){var t=wi.MODEL.rewardType(e),i=this._hash.get(t);i?i.push(e):this._hash.set(t,[e])}}},p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e.HURT_NUM=10,e._instance=null,f(e,["NEW_SIEGE_COPYID",function(){return this.NEW_SIEGE_COPYID=[33001,33002,33003,33004]},"NEW_SIEGE_SCENEID",function(){return this.NEW_SIEGE_SCENEID=[20130,20140,20150,20160]}]),e}(),ON=function(){function e(){this.data31051=null,this.data31054=null,this.curRoleLevel=0,this.firstIn=1,this.openTalentIndex=0,this.isOpenTalent=0}b(e,"modules.niepan.others.NiepanDataModel");var t=e.prototype;return t.getNowStatus=function(){return this.data31051&&0<this.data31051.curRoleIndex?lB.instance().getProGressDicTaskByType(4)?1:lB.instance().getProGressDicTaskByType(5)?2:3:0},t.checkTask=function(){var e=this.getNowStatus();if(1==e){var t=lB.instance().getProGressDicTaskByType(4);if(t&&t.phase==Bp.FINISHED)return 1}else if(0==e)for(var i=0;i<3;i++){if(gR.ins.actorById(i+1)&&0==this.checkMaxByIndex(i+1))return 1}return 0},t.checkWuxingCost=function(){if(this.data31051){var e=to.MODEL.consumptionDef(to.getIndex(this.getLevelByIndex(this.data31051.curRoleIndex)));if(e){var t=JSON.parse(e),i=parseInt(t[0].value.split(":")[0]);if(parseInt(t[0].value.split(":")[1])<=TR.ins.getGoodsNum(i))return 1}}return 0},t.checkMaxByIndex=function(e){if(this.data31051&&this.data31051.roleData)return this.curRoleLevel=this.data31051.roleData[e],0==this.curRoleLevel?0:to.MODEL.maxLevel(to.getIndex(this.curRoleLevel));return 0},t.checkNiepan=function(){var e=0;if(this.data31051&&this.data31051.roleData){var t=this.data31051.curRoleIndex;this.curRoleLevel=this.data31051.roleData[t]+1;var i=to.MODEL.eleNum(to.getIndex(this.curRoleLevel));for(var n in this.data31051.wuxingData){var s=parseInt(n);if(s&&(e=1,this.data31051.wuxingData[s]<i))return 0}}return e},t.checkDailyAward=function(){if(this.data31051&&this.data31051.roleData){var e=this.data31051.curRoleIndex,t=to.MODEL.dailyQuest(to.getIndex(this.getLevelByIndex(e))).split(",");if(0<t.length){for(var i=lB.instance().gettodayCompListGroupTaskByType(5),n=0,s=0;s<i.length;s++)0<i[s].count&&n++;if(0==this.data31051.dailyAward&&n==t.length)return 1}}return 0},t.getNiepanNpcPoint=function(){if(0<this.curRoleLevel){var e=to.MODEL.npcPoint(to.getIndex(this.curRoleLevel));if(e)return e.split(",")}return null},t.getTaskNpcPoint=function(){var e=lB.instance().getProGressDicTaskByType(4);if(e){var t=n_.getIndex(e.questId),i=n_.MODEL.commitNpcPoint(t);if(i)return i.split(",")}return null},t.getLevelByIndex=function(e){return this.data31051&&this.data31051.roleData&&(this.curRoleLevel=this.data31051.roleData[e],0<this.curRoleLevel)?this.curRoleLevel:1},t.getIconName=function(e,t){var i,n=to.MODEL.title1(to.getIndex(this.getLevelByIndex(e)));return n&&(i=n.split(",")[t-1]),i},t.getNpcname=function(e,t){return to.MODEL.npName(to.getIndex(this.getLevelByIndex(e)))},t.getdes=function(e,t){var i,n,s=to.MODEL.niepanChat(to.getIndex(this.getLevelByIndex(e)));return s&&(n=s.split(","),i=zB.ins.getDesc(n[t-1])),i},t.getPreNiepanLevel=function(e,t){var i,n=to.MODEL.title1(to.getIndex(this.getLevelByIndex(e))-1);return n&&(i=n.split(",")[t-1]),null==i&&(i="np_text_wnp"),i},p(1,e,"ins",function(){return e._ins=e._ins||new e}),e._ins=null,e}(),PN=function(){function e(){this.toc_exp=null,this.toc22305=null,this.cur_exp=0,this.cur_copper=0,this.prev_exp=0,this.prev_copper=0,this.currentOfflineSecond=0,this.reConnectTime=0}b(e,"modules.offline.others.OfflineManager");var t=e.prototype;return t.setCurRatio=function(e,t){var i=this;return i.prev_exp=i.cur_exp,i.prev_copper=i.cur_copper,i.cur_exp=e,i.cur_copper=t,0!=i.prev_exp&&(i.cur_exp!=i.prev_exp||i.cur_copper!=i.prev_copper)},t.resetOffline=function(){tr.push(RP.n[60]),this.currentOfflineSecond=0,this.reConnectTime=0},t.resetFlyup=function(){var e=new Tu;e.setup("checkZone",[]),sJ.ins.notice(["NavBottom"],e)},p(1,e,"ins",function(){return e._inst=e._inst||new e}),e._inst=null,e.MAX_CONNECT_SECOND=30,e}(),RN=function(){function i(){this.equipHash=null,this.proHash=new jl,this.costHash=new jl}b(i,"modules.passsuit.others.PassSuitData");var e=i.prototype;return e.checkEffIsPasssuit=function(e){var t=e.replace("eid_","");return-1!=i.EFFECT_IDS.indexOf(t)},e.decode=function(e){this.equipHash=this.doDecode(e),Tu.sendToModule("CHUANSHI_EQU_READ_END",["modules.actor.ActorModule"])},e.doDecode=function(e){for(var t,i=new jl,n=e.readByte(),s=0,o=0,a=0;a<n;a++){s=e.readByte(),t=[];for(var r=0;r<8;r++)o=e.readByte(),t.push(o);i.put(s,t)}return i},e.doDecode2=function(e){for(var t,i=new jl,n=e.readByte(),s=0,o=0,a=0;a<n;a++){s=e.readByte(),t=[];e.readByte();for(var r=0;r<8;r++)o=e.readByte(),t.push(o);i.put(s,t)}return i},e.getPro=function(e,t){var i=0,n="",s="",o=0,a=0;for(i=0;i<Ms.count;i++)Ms.MODEL.position(i)==e&&(Ms.MODEL.level(i)==t?(n=Ms.MODEL.attrs(i),o=i):Ms.MODEL.level(i)==t+1&&(s=Ms.MODEL.attrs(i),a=i));return{cur:n,next:s,cindex:o,nindex:a}},e.getProHash=function(e,t){var i,n=e+""+t;return null==this.proHash.take(n)?(i=this.getPro(e,t),this.proHash.put(n,i),i):this.proHash.take(n)},e.getCostPro=function(e,t){var i=0,n=0,s=0;for(i=0;i<Ms.count;i++)Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t+1&&(n=Ms.MODEL.goodsId(i),s=Ms.MODEL.cost(i));return{costId:n,costNum:s}},e.getCostHash=function(e,t){var i,n=e+""+t;return null==this.costHash.take(n)?(i=this.getCostPro(e,t),this.costHash.put(n,i),i):this.costHash.take(n)},e.getCurSuitPro=function(e,t){var i=[],n=0;for(n=0;n<As.count;n++)e==As.MODEL.kind(n)&&i.push(n);var s="",o="",a=0,r=0,l="",c="",u="",d="";for(n=0;n<As.count;n++)e==As.MODEL.kind(n)&&(As.MODEL.condition(n)==t?(a=t,s=As.MODEL.attrs(n),l=As.MODEL.name(n),u=As.MODEL.avatarId(n)):As.MODEL.condition(n)==t+1&&(r=t+1,o=As.MODEL.attrs(n),c=As.MODEL.name(n),d=As.MODEL.avatarId(n)));return{curLvl:a,cur:s,nextLvl:r,next:o,curName:l,nextName:c,cEffct:u,nEffct:d}},e.getEquipNameByPosAndLvl=function(e,t){var i=0;for(0==t&&(t=1),i=0;i<Ms.count;i++)if(Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t)return Ms.MODEL.name(i);return""},e.getAttrByPositionAndLv=function(e,t){for(var i=0;i<Ms.count;i++)if(Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t)return Ms.MODEL.attrs(i);return""},e.getKeyByPositionAndLv=function(e,t){for(var i=0;i<Ms.count;i++)if(Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t)return i;return-1},e.getNameByPositionAndLv=function(e){var t="";return 0==e?t="武器":1==e?t="神甲":2==e?t="护腕":3==e?t="戒指":4==e?t="头盔":5==e?t="项链":6==e?t="腰带":7==e&&(t="鞋子"),t},e.getGoodOpenUI=function(e){for(var t,i=0,n=-1,s=-1,o=-1,a="",r=ca.PASSSUIT_IDS.indexOf(e),l=0;l<gR.ins.actorList.length;l++)if(t=this.equipHash.take(l+1)){if(0==(i=t[r])){n=l,s=r,o=1;break}5!=i&&(n=l,s=r,o=2)}1==o?a=RP.n[61]:2==o?a=RP.n[62]:(a=RP.n[62],s=n=0),null!=VQ.instance.parent&&VQ.instance.setClickHandler(a,ql.create(this,this.openPassSuitView,null,!1),{roleIndex:n+1,equipIndex:s})},e.openPassSuitView=function(e){Tu.sendToModule("FORCE_OPEN_PASSSUIT",["modules.passsuit.PassSuitModule"],e)},e.isTotalEnought=function(e){for(var t=0;t<8;t++)if(this.isEnoughtByPos(e,t))return!0;return!1},e.isEnoughtByPos=function(e,t){var i=this.equipHash.take(e)[t],n=this.getCostHash(t,i),s=parseInt(n.costId),o=parseInt(n.costNum),a=TR.ins.getGoodsNum(s),r=this.getProHash(t,i).next;return""!=r&&null!=r&&o<=a},e.getChuanShiPositionByEquPosi=function(e){var t=0;return 1==e?t=0:2==e?t=1:3==e?t=3:4==e?t=6:5==e?t=2:6==e?t=7:7==e?t=5:8==e&&(t=4),t},e.getFenJieEqui=function(){var e,t=[],i=TR.ins.getBackPackItems(),n=0,s=0,o=[];for(n=0;n<i.length;n++)e=i[n],s=Bi.getIndex(e.goodsId),1==Bi.MODEL.isChuanShiEqu(s)&&o.push(e);for(n=0;n<8;n++){for(var a=0,r=0;r<o.length;r++){e=o[r],parseInt(e.goodsId.toString().substr(-1,1))-1==n&&a++}t.push(a)}return t},e.getSuitIdByRoleIndex=function(e){var t=this.equipHash.take(e);if(t&&0<t.length){var i=t.concat();return i.sort(function(e,t){return t<e?1:e==t?0:-1}),i[0]}return 0},e.getIndexBySuitTypeAndLv=function(e,t){var i=0,n=0;for(n=0;n<As.count;n++){var s=As.MODEL.kind(n),o=As.MODEL.condition(n);if(s==e&&o==t){i=n;break}}return i},e.isEnoughtComposeByPos=function(e,t){var i=!1;if(this.equipHash.take(e)[t]<=0&&0!=t&&1!=t){var n=this.getComposeCost(t);if(n){var s=parseInt(n.costId);i=parseInt(n.costNum)<=TR.ins.getGoodsNum(s)}}return i},e.getComposeCost=function(e){for(var t,i=0;i<Ms.count;i++)if(e==Ms.MODEL.position(i)){t=new Object;var n=Ms.MODEL.composeCost(i);if(n){var s=JSON.parse(n);if(0<s.length){var o=parseInt(s[0].value.split(":")[0]),a=parseInt(s[0].value.split(":")[1]);t.costId=o,t.costNum=a;break}}}return t},p(1,i,"ins",function(){return i._ins||(i._ins=new i),i._ins}),i.getActviePathByPos=function(e,t){for(var i=0;i<Ms.count;i++)if(Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t)return Ms.MODEL.icon(i);return""},i._ins=null,i.MAX=5,i.isSpecialRefresh=!1,i.TAO_EFFECTID="jm0148",i.FIRE_EFFECTID="jm0150",i.ACTIVE_EFFECTID="jm0149",i.UPLVL_EFFECTID="jm0011",f(i,["noActivePath",function(){return this.noActivePath=["passsuit/inheritance_icon_grey_cswq.png","passsuit/inheritance_icon_grey_csyf.png","passsuit/inheritance_icon_grey_cshs.png","passsuit/inheritance_icon_grey_csjz.png","passsuit/inheritance_icon_grey_cstk.png","passsuit/inheritance_icon_grey_csxl.png","passsuit/inheritance_icon_grey-belt.png","passsuit/inheritance_icon_ash-shoes.png"]},"EFFECT_IDS",function(){return this.EFFECT_IDS=["jm1043","jm1046","jm1050","jm1054"]}]),i}(),NN=function(){function n(){}return b(n,"modules.passsuit.others.PassSuitReqUtil"),n.reqPassSuitInfo=function(e,t){void 0===t&&(t=0),e&&(n.passSuitInfoCallBack=e,n.passSuitInfoParam=t);var i=new XL;Tu.sendToService(i)},n.reqPassSuitUpLvl=function(e,t){var i=new QL;i.rolePos=e,i.equipPos=t,Tu.sendToService(i)},n.passSuitInfoCallBack=null,n.passSuitInfoParam=0,n}(),BN=function(){function e(){}return b(e,"modules.rank.others.RankReqs"),e.reqRank=function(e){var t=new PL;t.type=e,Tu.sendToService(t)},e}(),HN=function(){function e(){this._isTipOpen=!1,this._isTip=!1,this.toc_recharge=null,this.toc_every=null,this.to_31011=null,this.toc_baiY=null,this.recharge_Vec=new jl}b(e,"modules.recharge.others.RechargeManager");var t=e.prototype;return t.isFrtRechage=function(){return!modules.recharge.others.RechargeManager.ins.toc_recharge||2==modules.recharge.others.RechargeManager.ins.toc_recharge.canGet},t.reqBuyCoin=function(){var e=gR.ins.VIPLevel;Tu.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1031+e,showCharge:!1})},t.reqBuyCoin2=function(){Tu.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1020})},t.isShowEveryRed=function(){if(null==this.toc_every)return!1;var e=0;for(var t=0 in this.toc_every.showArray)if(1==this.toc_every.showArray[t]){e=t;break}return 0<e},t.setImage=function(e,t){var i=G.loader.getRes(e.skin);null!=i?(i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.recharge_Vec.put(t,e,!0)):e.on("loaded",this,this.onLoadedImage,[,[e,t]])},t.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.recharge_Vec.put(t[1],t[0],!0)},t.getShowMoney=function(e){return 0<Ln.count?dr.nativeIOS?Ln.MODEL.money_ios(e):2==dr.xgame?Ln.MODEL.money_wx(e):Ln.MODEL.money(e):0},t.getShowGold=function(e){return 0<Ln.count?dr.nativeIOS?Ln.MODEL.gold_ios(e):2==dr.xgame?Ln.MODEL.gold_wx(e):Ln.MODEL.gold(e):0},p(1,e,"ins",function(){return e._inst=e._inst||new e}),e._inst=null,e}(),VN=function(){function e(){this._actorResonateData=null,this.isFirstShowBtnEff=!0,this._actorResonateData=[];for(var e=0;e<3;e++){for(var t=new ee,i=t.level=0;i<8;i++)t[i]=0;this._actorResonateData[e+1]=t}}b(e,"modules.resonate.others.ResonateData");var t=e.prototype;return t.getActorResonateData=function(e){return this._actorResonateData.hasOwnProperty(e)?this._actorResonateData[e]:null},t.setActorResonateData=function(e){e instanceof Array&&(this._actorResonateData=e)},p(1,e,"ins",function(){return e._ins=e._ins||new e}),e._ins=null,e}(),GN=function(){function e(){}return b(e,"modules.resonate.others.ResonateReq"),e.reqActorsInfo=function(){var e=new uP;Tu.sendToService(e)},e.reqGrowActor=function(e,t){var i=new dP;i.roleIndex=e,i.position=UN.indexToConfigPosition(t),Tu.sendToService(i)},e.reqGrowSkill=function(e){var t=new hP;t.roleIndex=e,Tu.sendToService(t)},e}(),UN=function(){function r(){}return b(r,"modules.resonate.others.ResonateUtil"),p(1,r,"isShowMingBtnEff",function(){if(VN.ins.isFirstShowBtnEff)return!0;for(var e in gR.ins.actorList)for(var t=gR.ins.actorList[e].id,i=0;i<8;i++)if(r.isAbleGrowPosition2(t,i))return!0;return!1}),p(1,r,"isNeedIconRedDot",function(){var e;for(var t in gR.ins.actorList){if(e=gR.ins.actorList[t],modules.resonate.others.ResonateUtil.isAbleGrowSkill(e.id))return!0;if(0<r.ableGrowPositions(e.id).length)return!0}return!1}),p(1,r,"MAX_LEVEL",function(){if(0==r._maxLevel)for(var e=0;e<yi.count;e++){var t=yi.MODEL.level(e);r._maxLevel<t&&(r._maxLevel=t)}return r._maxLevel}),p(1,r,"isOpenModule",function(){return GR.getInstance().checkModuleOpen(61)}),p(1,r,"errorTips",function(){return GR.getInstance().getErrorTips(61)}),r.getPartPositionObj=function(e){var t={},i=0,n=0;switch(e){case 0:i=60,n=68;break;case 1:i=61,n=69;break;case 2:i=62,n=74;break;case 3:i=63,n=73;break;case 4:i=64,n=72;break;case 5:i=65,n=75;break;case 6:i=66,n=71;break;case 7:i=67,n=70}return t.soaring=i,t.mo=n,t},r.getSoaringPartShowEquip=function(e,t){var i=r.getPartPositionObj(t),n=gR.ins.actorById(e),s=n.equips.getPart(i.soaring);if(!s){var o=n.flyupLevel+1;o>AR.ins.MAX_LEVEL&&(o=AR.ins.MAX_LEVEL),s=AR.ins.getSoaringGradeEquipByPos(o,i.soaring)}return s},r.getSoaringSuitShowEquip=function(e,t,i){void 0===i&&(i=-1);var n=r.getSoaringPartShowEquip(e,t);return-1!=i&&((n=KH.create(n.goodsId)).positionLevel=i),AR.ins.toSuitShowDto(n)},r.isAbleGrowPosition=function(e,t){return 0==r.disableGrowLevelCode(e,t)},r.isAbleGrowPosition2=function(e,t){return 0==r.disableGrowLevelCode2(e,t)},r.disableGrowLevelCode=function(e,t){var i=VN.ins.getActorResonateData(e);if(null==i)return 1;i.level;var n=Math.min(i[t],r.MAX_LEVEL);if(r.MAX_LEVEL<=n)return 5;var s=r.getMoSuitLevel(e,t);return r.getSoaringSuitShowEquip(e,t).positionLevel<Math.min(n+1,r.MAX_LEVEL)?2:s<Math.min(n+1,r.MAX_LEVEL)?3:r.isMaterialAble(e,t,Math.min(n+1,r.MAX_LEVEL))?0:4},r.disableGrowLevelCode2=function(e,t){var i=VN.ins.getActorResonateData(e);if(null==i)return 1;i.level;var n=Math.min(i[t],r.MAX_LEVEL);if(r.MAX_LEVEL<=n)return 5;var s=r.getMoSuitLevel(e,t);return r.getSoaringSuitShowEquip(e,t).positionLevel<Math.min(n+1,r.MAX_LEVEL)?2:s<Math.min(n+1,r.MAX_LEVEL)?3:0},r.ableGrowPositions=function(e){for(var t=[],i=0;i<8;i++)r.isAbleGrowPosition(e,i)&&t.push(i);return t},r.isAbleGrowSkill=function(e){var t=VN.ins.getActorResonateData(e);if(null==t)return!1;for(var i=0;i<8;i++){if(t[i]<t.level+1)return!1}return!0},r.showSoaringSuitTip=function(e,t){var i={data:e,showGrow:!1,actorId:t};hN.ins.open("SOARING_EQUIP_TIP",i)},r.isMaterialAble=function(e,t,i){var n=r.getMaterials(e,t,i);if(null!=n&&0<n.length)for(var s in n){var o=n[s].value,a=parseInt(o.split(":")[0]);if(0==parseInt(o.split(":")[1])<=TR.ins.getGoodsNum(a))return!1}return!0},r.getFightNum=function(e){var t=0,i=VN.ins.getActorResonateData(e);if(null!=i){for(var n=0;n<8;n++){var s=i[n];0<s&&(t+=r.getActorPositionFightNum(e,n,s))}0<i.level&&(t+=r.getActorSkillFightNum(i.level))}return t},r.getChineseAttrByLevel=function(e,t){return aa.formatNewAttrToChinese(r.getAttrByLevel(e,t))},r.indexToConfigPosition=function(e){return e>=r.POSITION_ID.length?-1:r.POSITION_ID[e]},r.configPositionToIndex=function(e){return r.POSITION_ID.indexOf(e)},r.getMoSuitShowEquip=function(e,t,i){var n=r.getPartPositionObj(t).mo,s=fR.ins.getZhuHunResIndex2(n,i,1),o=cn.MODEL.goodsId(s);return KH.create(o)},r.getMoSuitLevel=function(e,t){var i=0,n=r.getPartPositionObj(t).mo,s=fR.ins.getSuitInfoByPosition(e,n);return s&&(i=s.jie||0),i},r.showMoSuitTip=function(e,t){var i=null!=e?e.decoratePosition:0,n=fR.ins.getSuitInfoByPosition(t,i);if(n){var s={showRed:!1,showBtn:!1,actorId:t,position:i,data:n};hN.ins.open("MO_ZHUHUN_TIPS",s)}},r.getActorSkillFightNum=function(e){return 0},r.getActorPositionFightNum=function(e,t,i){gR.ins.actorById(e).job;var n=0,s=r.getAttrByLevel(i,t);return n+=RR.getFight(s),n+=r.getShowFights(e,t,i)},r.getGrowNeedMoLevel=function(e,t,i){for(var n=0;n<yi.count;n++){var s=yi.MODEL.position(n),o=yi.MODEL.level(n);if(s==r.indexToConfigPosition(t)&&o==i)return yi.MODEL.moZhuHunLevel(n)}return 0},r.getGrowNeedSoaringLevel=function(e,t,i){for(var n=0;n<yi.count;n++){var s=yi.MODEL.position(n),o=yi.MODEL.level(n);if(s==r.indexToConfigPosition(t)&&o==i)return yi.MODEL.flyUpSuitLevel(n)}return 0},r.getAttrByLevel=function(e,t){for(var i=0;i<yi.count;i++){var n=yi.MODEL.position(i),s=yi.MODEL.level(i);if(n==r.indexToConfigPosition(t)&&s==e)return yi.MODEL.attrs(i)}return null},r.getMaterials=function(e,t,i){for(var n=0;n<yi.count;n++){var s=yi.MODEL.position(n),o=yi.MODEL.level(n);if(s==r.indexToConfigPosition(t)&&o==i){var a=yi.MODEL.consumeDef(n);return null==a||""==a?null:JSON.parse(a)}}return null},r.getShowFights=function(e,t,i){for(var n=0;n<yi.count;n++){var s=yi.MODEL.position(n),o=yi.MODEL.level(n);if(s==r.indexToConfigPosition(t)&&o==i)return yi.MODEL.fight(n)}return 0},r.getLevelEffect=function(e){var t=r.BUFF_IDS[Math.max(1,e)-1],i=Ls.getIndex(t);return-1!=i?Ls.MODEL.skillDesc(i):""},r.getLevelName=function(e){var t=r.BUFF_IDS[Math.max(1,e)-1],i=Ls.getIndex(t);return-1!=i?Ls.MODEL.skillName(i):""},r.getMoPart=function(e){var t=0,i=modules.resonate.others.ResonateUtil._shenEquipParts.indexOf(e);return 0<=i&&i<modules.resonate.others.ResonateUtil._moEquipParts.length&&(t=modules.resonate.others.ResonateUtil._moEquipParts[i]),t},r.getShenPart=function(e){var t=0,i=modules.resonate.others.ResonateUtil._moEquipParts.indexOf(e);return 0<=i&&i<modules.resonate.others.ResonateUtil._shenEquipParts.length&&(t=modules.resonate.others.ResonateUtil._shenEquipParts[i]),t},r.getResonatePart=function(e,t){var i=(0==t?modules.resonate.others.ResonateUtil._moEquipParts:modules.resonate.others.ResonateUtil._shenEquipParts).indexOf(e);return i<0&&(i=0),i},r.MAX_SUIT=8,r._maxLevel=0,f(r,["POSITION_ID",function(){return this.POSITION_ID=[1,2,3,4,5,6,7,8]},"BUFF_IDS",function(){return this.BUFF_IDS=[717,719,721,723,725,727,729]},"_shenEquipParts",function(){return this._shenEquipParts=[60,61,62,63,64,65,66,67]},"_moEquipParts",function(){return this._moEquipParts=[68,69,74,73,72,75,71,70]}]),r}(),FN=function(){function s(){}return b(s,"modules.scene.others.CrossSceneFindPath"),s.setNPCinfo=function(e){modules.scene.others.CrossSceneFindPath.isClickActiveNPC=!0,modules.scene.others.CrossSceneFindPath.isNeedCrossScene="1"!=uH.Ins().currCid,modules.scene.others.CrossSceneFindPath.NPC_ID=e},s.clearNPCinfo=function(){modules.scene.others.CrossSceneFindPath.isClickActiveNPC=!1,modules.scene.others.CrossSceneFindPath.isNeedCrossScene=!1,modules.scene.others.CrossSceneFindPath.NPC_ID=""},s.crossSceneFindPathForNPCID=function(e,t){var i=new Uh(NF.mainChar.x,NF.mainChar.y);NF.mainChar.sendPath(s.findPath(i,t))},s.findPath=function(e,t){var i;i=null==e?(e=new Uh(NF.mainChar.x,NF.mainChar.y),NF.mainChar.tilePoint):PB.pixelsToTile(e.x,e.y);var n=PB.pixelsToTile(t.x,t.y);i.x,i.y,n.x,n.y;return s.tileAstar.getPath(YH.instance,i.x,i.y,n.x,n.y,!0,200)},s.isClickActiveNPC=!1,s.isNeedCrossScene=!1,s.NPC_ID="",s.YZBQC_NPC_ID="100211",f(s,["YZBQC_NPC_P",function(){return this.YZBQC_NPC_P=new Uh(1480,620)},"tileAstar",function(){return this.tileAstar=new jH}]),s}(),qN=function(){function a(){}return b(a,"modules.scene.others.DropsUtil"),a.showDropsToScene=function(e,t,i,n,s,o){void 0===n&&(n=1),void 0===s&&(s=4),void 0===o&&(o=!1),e.toString()==uH.Ins().currCid&&t.length&&(sH.pickItems=t,null==i&&(i=uH.killPoint),uH.addPickItem(i,t,s,o),UB.ins.playSound(90006),1==n?sH.start():G.timer.once(700,a,modules.scene.others.DropsUtil.pickupAll,[uH.Ins().currCid]))},a.showDropToScene=function(e){uH.createPackItem(e)},a.pickupAll=function(e){for(var t=[],i=zN.pickUpQueue,n=0;n<i.length;n++){var s=i[n];if(s&&(s.type==Za.PICKUP_GOLD||s.type==Za.PICKUP_ITEM)){s.selectEnabled=!0,s==NF.Ins().selectChar&&(NF.Ins().selectChar=null);var o=150*ZN.getTileDis(s.tilePoint,NF.mainChar.tilePoint);600<o&&(o=600),Og.to(s,{x:NF.mainChar.x,y:NF.mainChar.y-40,alpha:0},o,null,ql.create(s,s.clearTweenFunc)),t.push(s)}}NF.mainChar.lockSkill=!0,G.timer.once(510,a,modules.scene.others.DropsUtil.pickupAllPart2,[t,e])},a.pickupAllPart2=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];n&&modules.scene.others.DropsUtil.doPickUp(n,t,!0)}},a.updatePickuptime=function(){a.pickuptime=BB.getTimer()},a.doPickUp=function(e,t,i){void 0===i&&(i=!1);var n=BB.getTimer();n-a.pickuptime<500&&!i||(a.pickuptime=n,(sH.getInstance().autoMode||i)&&e&&(e&&"Char"!=_s.getQualifiedClassName(e)&&e.type==Za.PICKUP_GOLD&&zB.ins.playGetItems([e.proto]),uH.Ins().removePickItem(e),NF.Ins().selectChar=null,e.proto&&"number"==typeof e.proto&&Math.floor(e.proto)==e.proto&&UB.ins._playPickupSound(e.proto),tr.push("InventedUtils.enabledPickupQueueLength2:"+zN.enabledPickupQueueLength2),zN.enabledPickupQueueLength2<=0&&(tr.push("doPickUp send Scene_InternalOrder.PICK_UP_All_END,currCid:"+t),Tu.sendToModule("PICK_UP_All_END",["modules.scene.SceneModule"],t))))},a.removePickUP=function(e){uH.Ins().removePickItemByObjectId(e)},a.pickuptime=0,a}(),jN=function(){var d;function e(){if(this._stateDatas=[],this._coolDatas=[],null!=e.ins)throw new Error(RP.n[64]);G.timer.loop(100,this,this.updateState)}b(e,"modules.scene.others.fight.BattleStateCtrl");var t=e.prototype;return G.imps(t,{"modules.scene.others.fight.IBaseStateCtrl":!0}),t.getCoolDatas=function(e,t){void 0===t&&(t=0);var i,n=[];for(var s in this._coolDatas)(i=this._coolDatas[s]).sender==e&&(0==t?n.push(i):t==i.state&&n.push(i));return n},t.addState=function(e,t,i,n,s){if(void 0===s&&(s=0),null!=n){if(this.isCoolDown(n,e))return;if(0<s){var o,a=this.getCoolDatas(n,e);0==a.length?(o=new d,this._coolDatas.push(o)):o=a[0],o.cool=s+dr.curServerTime,o.sender=n,o.state=e}}for(var r=0;r<t.length;r++){var l=t[r];if(null!=l){var c,u=this.getStates(l,e);0==u.length?(c=new WN,this._stateDatas.push(c)):c=u[0],c.cd=i+dr.curServerTime,null!=n&&(c.sender=n),c.receiver=l,c.state=e,0<i&&this.startHandleState(c)}}this.updateState()},t.getStates=function(e,t){void 0===t&&(t=0);var i,n=[];for(var s in this._stateDatas)(i=this._stateDatas[s]).receiver==e&&(0==t?n.push(i):t==i.state&&n.push(i));return n},t.updateState=function(){for(var e=0 in this._stateDatas){var t=this._stateDatas[e];t.cd<dr.curServerTime?(this.removeHandleState(t),delete this._stateDatas[e]):this.loopHandleState(t)}for(e in this._coolDatas){this._coolDatas[e].cool<dr.curServerTime&&delete this._coolDatas[e]}},t.startHandleState=function(e){var t=e.receiver;switch(e.state){case 401:t.setMabi(!0)}},t.loopHandleState=function(e){e.receiver;e.state},t.removeHandleState=function(e){var t=e.receiver;switch(e.state){case 401:t.setMabi(!1)}},t.isCoolDown=function(e,t){return 0<this.getCoolDatas(e,t).length},t.removeState=function(e,t){for(var i=0 in void 0===t&&(t=0),this._stateDatas){var n=this._stateDatas[i];n.receiver==e&&(n.state!=t&&0!=t||(n.cd=0,this.updateState()))}},t.clear=function(e){this.removeState(e)},e.getInstance=function(){return null==e.ins&&(e.ins=new e),e.ins},e.ins=null,e.__init$=function(){d=function(){function e(){this.state=0,this.sender=null,this.cool=0}return b(e,""),e}()},e}(),WN=function(){function e(){this.state=0,this.cd=0,this.sender=null,this.receiver=null}return b(e,"modules.scene.others.fight.BattleStateData"),e}(),YN=function(){function p(){}return b(p,"modules.scene.others.fight.FightUtils"),p.getPtDis=function(e,t){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.max(i,n)},p.getNearCharPoint=function(e,t){var i=VB.getDretion(e.point.x,e.point.y,t.x,t.y);return VB.getTileByDir(e.tilePoint,i,1)},p.checkPointSameTileDir=function(e,t){e=PB.pixelsAlginTile(e.x,e.y,e),t=PB.pixelsAlginTile(t.x,t.y,t);var i=PB.pixelsToTile(e.x,e.y),n=PB.pixelsToTile(t.x,t.y),s=(t.y-e.y)/(t.x-e.x);VB.getDretion(i.x,i.y,n.x,n.y),VB.getDretion(n.x,n.y,i.x,i.y);return i.x==n.x||i.y==n.y||.5==s||-.5==s},p.getFitPoint=function(e,t,i){void 0===i&&(i=2);var n=(t.y-e.y)/(t.x-e.x),s=e.x-t.x,o=e.y-t.y;return e.x==t.x&&e.y==t.y?e:e.x==t.x?0<o?VB.getTileByDir(e,0,i):VB.getTileByDir(e,4,i):e.y==t.y?0<s?VB.getTileByDir(e,6,i):VB.getTileByDir(e,2,i):.5==n?0<s?VB.getTileByDir(e,7,i):VB.getTileByDir(e,3,i):-.5==n?0<s?VB.getTileByDir(e,5,i):VB.getTileByDir(e,1,i):p.get16Grids(e,t)},p.get16Grids=function(e,t){for(var i=[],n=YH.instance.get8Grids(e,PB.getPtDis(e,t)),s=0;s<n.length;s++){var o=n[s];p.checkPointSameTileDir(o,PB.tileToPixels(t))&&i.push(o)}for(var a=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y,l=e.x>=t.x?e.x:t.x,c=e.y>=t.y?e.y:t.y,u=[],d=(new u_(a,r,Math.abs(e.x-t.x),Math.abs(e.y-t.y)),[]),h=0;h<i.length;h++){var _=PB.pixelsToTile(i[h].x,i[h].y),f=YH.instance.takeItem(_.x,_.y);_.x>=a&&_.x<=l&&_.y>=r&&_.y<=c&&f&&0<f.type&&(p.checkPointSameTileDir(i[h],PB.tileToPixels(e))?u.push({point:i[h],dis1:p.getPtDis(t,_),dis2:p.getPtDis(e,_)}):d.push({point:i[h],dis1:p.getPtDis(t,_),dis2:p.getPtDis(e,_)}))}return(u=ol.srotOn(u,"dis1",Array.NUMERIC)).length?u[0].point:0==u.length&&d.length?d[0].point:PB.tileToPixels(t)},p.getDepthLoopSun=function(e,t){void 0===e&&(e=1),void 0===t&&(t=0);for(var i=t+(e-=1),n=0,s=t;s<=i;s++)n+=p.getDepthLoopValue(s);return n},p.getDepthLoopValue=function(e){if(0==e)return 1;var t=Math.pow(2*e+1,2)-Math.pow(2*e+1-2,2);return 0==t?1:t},p.getNearPt=function(e,t){null==t&&(t=NF.mainChar);for(var i=YH.instance.get8Grids(e),n={point:null,dis:0},s=0;s<i.length;s++){for(var o=PB.pixelsToTile(i[s].x,i[s].y),a=!1,r=0;r<uH.heroQueue.length;r++){var l=uH.heroQueue[r].tilePoint;l.x==o.x&&l.y==o.y&&(a=!0)}a&&(i.splice(s,1),s--)}for(var c=0;c<i.length;c++){var u=i[c],d=Math.random()*i.length>>0;i[h]=i[d],i[d]=u}for(var h=0;h<i.length;h++){var _=ol.distance(t.point,i[h]);null==n.point?(n.point=i[h],n.dis=_):_<n.dis&&(n.point=i[h],n.dis=_)}return null==n.point&&(n.point=t.point),n.point},p.getCharNearPt=function(e,t){null==t&&(t=NF.mainChar);for(var i=YH.instance.get8Grids(e.tilePoint),n={point:null,dis:0},s=0;s<i.length;s++){for(var o=PB.pixelsToTile(i[s].x,i[s].y),a=!1,r=0;r<uH.heroQueue.length;r++){var l=uH.heroQueue[r].tilePoint;l.x==o.x&&l.y==o.y&&(a=!0)}a&&(i.splice(s,1),s--)}for(var c=0;c<i.length;c++){var u=i[c],d=Math.random()*i.length>>0;i[h]=i[d],i[d]=u}for(var h=0;h<i.length;h++){var _=ol.distance(t.point,i[h]);null==n.point?(n.point=i[h],n.dis=_):_<n.dis&&(n.point=i[h],n.dis=_)}return null==n.point&&(n.point=t.point),n.point},p.getMonsterHurtValue=function(e,t){var i=kH.takeMonsterModelProtoData(e).att*(.95+.1*Math.random());return Math.round(i)},p.getYuanshenHurtValue=function(e,t,i){for(var n=0,s=1;s<4;s++)n+=gR.ins.getAttackAttrValueByIdx(s,aa.ATK.id);var o=0;if(t.type==Za.MONSTER){var a=parseInt(t.proto.modelId),r=kH.takeMonsterModelProtoData(a);o=Math.ceil((r.wuDef+r.moDef)/2)}var l=Vn.getIndex(i),c=Vn.MODEL.damageFactor(l),u=Vn.MODEL.fixedDamage(l);gR.ins.getAttackAttrValueByIdx(1,aa.UNION_DAM_INC_RATE_PVE.id);return Math.ceil((n-o)*c[0]/1e4+u[0])},p.getPetHurtValue=function(e,t){void 0===t&&(t=.2);for(var i,n=kH.takeMonsterModelProtoData(300001).att+p.getCharAtt(e)*t/1e4,s=0;s<uH.heroQueue.length;s++){var o=uH.heroQueue[s];if(o&&o.proto&&3==o.proto.job){i=o;break}}var a=Vn.getIndex(305),r=Vn.MODEL.para1(a)[IH.ins.getDtoSkill(i.hero_id,305).cur_lvl-1],l=Math.round(n)+r/1e4*p.getCharAtt(i.hero_id);return Math.round(l)},p.getNewPetHurtValue=function(e,t,i){var n=modules.pet.others.PetDataModel.ins().getAttByIndex();return n},p.getCharTotalHurtForMonster_New=function(e,t,i){var n;if(-1<IH.ins.UNION_SKILL.indexOf(i)?n=p.unionHurtFormonster(e,t,i):-1<Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(i)||(n=p.charFacBaseHurtForMonster_new(e,t,i)),!n)return null;var s=n.type,o=n.value;return{value:o=Math.round(o*(.95+.1*Math.random())),type:s}},p.zhuiJiHurtForMonster=function(e,t,i){if(!e||!t)return null;var n=0,s=NaN,o=0,a=Vn.getIndex(i),r=0,l=(Vn.MODEL.name(a),Vn.MODEL.fixedDamage(a)),c=!1,u=0,d=0;if(t.type==Za.MONSTER){var h=parseInt(t.proto.modelId),_=kH.takeMonsterModelProtoData(h),f=gR.ins.getAttackAttrValueByIdx(e.hero_id,aa.ATK.id);if(n=Math.ceil((_.wuDef+_.moDef)/2),0!=Vn.MODEL.triggerBuffProp(a)){var p=Vn.MODEL.triggerBuffProp(a);Math.random();sH.getRate(p)&&(c=!0)}var g=0;u=0<l.length?l[0]:0;var v=parseInt(Vn.MODEL.params(a).split(",")[0]);if(s=(sH.getRate(v)?(r=Vn.MODEL.damageFactor2Group(a)[1],d=Math.round((f-n)*r/1e4+u)):r=Vn.MODEL.damageFactor2Group(a)[0],Math.round((f-n)*r/1e4+u)),-1!=Aa.ZHUI_JI_SKILL_FA.indexOf(i))c?(o=16,nH.addBuff(t.char_id,10,i)):o=16;else if(-1!=Aa.ZHUI_JI_SKILL_DAO.indexOf(i))c?(o=20,nH.addBuff(t.char_id,1,i)):o=17;else if(c){o=19,g=Vn.MODEL.buffIds(a)[0];var m=parseInt(Ls.MODEL.value(Ls.getIndex(g)));e.currHp+=s*(m/1e4)}else o=0<d?18:15}return{value:s,type:o,bo:d}},p.getMonsterTotalHurtForChar_New=function(e,t,i){var n,s=(n=p.monsterFacBaseHurtForChar_new(e,t,i)).type,o=n.value;return{value:o=Math.round(o*(.95+.1*Math.random())),type:s}},p.unionHurtFormonster=function(e,t,i){if(!e||!t)return null;var n=e.hero_id;n<=0&&(n=1);for(var s=0,o=1;o<4;o++)s+=gR.ins.getAttackAttrValueByIdx(o,aa.ATK.id);var a=0;if(t.type==Za.MONSTER){var r=parseInt(t.proto.modelId),l=kH.takeMonsterModelProtoData(r);a=Math.ceil((l.wuDef+l.moDef)/2)}var c=gR.ins.getAttackAttrValueByIdx(1,aa.UNION_DAM_INC_RATE_PVE.id);return{value:Math.ceil((s-a)*(3.5+c/1e4)+9e3),type:1}},p.monsterFacBaseHurtForChar_new=function(e,t,i){if(!e)return{value:0,type:0};var n=e.hero_id;if(n<=0&&(n=1),!e.data)return{value:0,type:0};var s=hn.getIndex(e.data.modelId),o=hn.MODEL.attributes(s),a=0;if(o){var r=JSON.parse(o);a=aa.formatNewAttrToObject(r).ATK}var l=gR.ins.getAttackAttrValueByIdx(t.hero_id,aa.DEF.id);t.type,Za.MONSTER;var c=gR.ins.getAttackAttrValueByIdx(n,aa.CRI_RATE.id),u=(Math.random(),(a-l)*p.getSkillAddPer(e,i)+(p.getSkillAdd(n,i)+gR.ins.getAttackAttrValueByIdx(n,aa.TRUE_ATK.id)-0));return u<0&&(u=0),{value:u,type:1}},p.charFacBaseHurtForMonster_new=function(e,t,i){if(!e)return{value:0,type:0};var n=e.hero_id;n<=0&&(n=1);var s=gR.ins.getAttackAttrValueByIdx(n,aa.ATK.id),o=0,a=0;if(t.type==Za.MONSTER){var r=parseInt(t.proto.modelId),l=kH.takeMonsterModelProtoData(r);o=1==gR.ins.getJobByIdx(n)?l.wuDef:l.moDef,l.damDecRa,a=l.trueDef}var c=gR.ins.getAttackAttrValueByIdx(n,aa.CRI_RATE.id),u=0,d=1;return 1e4*Math.random()<=c&&(u=gR.ins.getAttackAttrValueByIdx(n,aa.CRI.id),d=4),{value:(s+u-o)*p.getSkillAddPer(e,i)+(p.getSkillAdd(n,i)+gR.ins.getAttackAttrValueByIdx(n,aa.TRUE_ATK.id)-a),type:d}},p.getSkillAddPer=function(e,t){return e.type==Za.MAIN_CHAR||e.type==Za.HERO?p.getSkillAcf(e.hero_id,t):1},p.baseCharHurtForMonster=function(e,t){var i=e.hero_id,n=1;return e.type!=Za.MAIN_CHAR&&e.type!=Za.HERO||(n=p.getSkillAcf(i,t)),302==t&&(n=1),p.getCharAtt(i)*n*(1+p.getCharFac(i))+p.getSkillAdd(i,t)},p.getCharAtt=function(e){for(var t=gR.ins.getAttackAttrValueByIdx(e,aa.ATK.id),i=[],n=0;n<i.length;n++);return 1*t},p.getSkillAcf=function(e,t){var i=IH.ins.getCurrSkillDto(e,t);return i?i.facValue/1e4:0},p.getSkillAdd=function(e,t){var i=IH.ins.getCurrSkillDto(e,t);return i?i.addValue:0},p.getCharFac=function(e){return 0},p.getKJHH=function(e,t,i){void 0===t&&(t=2),void 0===i&&(i=!0);var n=e.x,s=e.y,o=[];if(ZN.isSynchScene())return o;for(var a=n-1;a<=n+1;a++)for(var r=s-1;r<=s+1;r++){var l=zN.getCharByPtXY(a,r);if(l){var c,u=VB.getDretion(e.x,e.y,a,r);c=a+"_"+r!=e.x+"_"+e.y?p.getKJHH2(l.tilePoint,u,0==u||4==u?t+1:t):l.tilePoint,i||(c=PB.tileToPixels(c)),o.push({tar:l,pt:c})}}return o},p.getKJHH2=function(e,t,i){var n,s,o;void 0===i&&(i=2);var a=e;(aH.isZhanBaokMode||uH.Ins().currCid==_a.S_WorldBoss.toString()||dr.dtoEnterScene&&7==dr.dtoEnterScene.type||dr.dtoEnterScene&&49==dr.dtoEnterScene.type||dr.dtoEnterScene&&14==dr.dtoEnterScene.type)&&(i=0);for(var r=1;r<i&&(n=VB.getTileByDir(e,t,r),s=PB.pixelsToTile(n.x,n.y),o=YH.instance.takeItem(s.x,s.y))&&(0<o.type&&0<o.walkType);r++)a=s;return a},p.getCZ=function(e,t,i,n){var s,o,a;void 0===i&&(i=3),void 0===n&&(n=!0);var r=[];0!=t&&4!=t||(i+=1);for(var l=1;l<i+2&&(s=VB.getTileByDir(e,t,l),o=PB.pixelsToTile(s.x,s.y),a=YH.instance.takeItem(o.x,o.y))&&0<a.type;l++)r.push(o);for(var c=r.length,u=e,d=null,h=null,_=0;_<r.length;_++)if(u=r[_],null==d)c=_,d=zN.getCharByPt(u);else if(h=zN.getCharByPt(u)){if(i<=(c=_))break;break}var f=-1,p=-1;0==ZN.isHookScene()||ZN.isSynchScene()||aH.isZhanBaokMode||uH.Ins().currCid==_a.S_ARENA.toString()||uH.Ins().currCid==_a.S_WorldBoss.toString()||8==uH.Ins().currCkType||dr.dtoEnterScene&&7==dr.dtoEnterScene.type||dr.dtoEnterScene&&49==dr.dtoEnterScene.type||dr.dtoEnterScene&&14==dr.dtoEnterScene.type?p=-1:d&&h?(f=c-1,p=c-2):d&&!h?p=(f=r.length-c+c-1)-1:(p=r.length-1,r.length>=i&&(p=i-1));var g={currData:null,tarData:null};if(-1!=f){var v=PB.tileToPixels(r[f]);g.tarData=n?{tar:d,pt:r[f]}:{tar:d,pt:v}}if(-1!=p){var m=PB.tileToPixels(r[p]);g.currData=n?{pt:r[p]}:{pt:m}}else g.currData=n?{pt:e}:{pt:s};return g},p.checkTriggerMabi=function(e){if(null==e)return!1;if(e.type!=Za.HERO&&e.type!=Za.MAIN_CHAR)return!1;if(jN.getInstance().isCoolDown(e,401))return!1;var t=gR.ins.actorRingData;if(null==t)return!1;for(var i=0 in t){if(e.profession==i){var n=t[i][1];if(1!=n.type)continue;var s=n.configIndex,o=ps.MODEL.mabiBuffParam(s);if(!o)continue;if(-1==o.indexOf(","))continue;var a=o.split(",");if(null==a||a.length<3)continue;if(1e4-a[0]<=Math.floor(1e4*Math.random())+1)return!0}}return!1},p.forceTriggerMabi=function(e,t){var i=gR.ins.actorRingData;if(null!=i)for(var n=0 in i){if(e.profession==n){var s=i[n][1].configIndex,o=ps.MODEL.mabiBuffParam(s);if(o&&-1!=o.indexOf(",")){var a=o.split(",");if(!(null==a||a.length<3)){var r=a[1],l=a[2];jN.getInstance().addState(401,t,l,e,r)}}}}},p.isDuanhunSkill=function(e){return e/100>>0==1024},p.isFsChangeSkill=function(e){return 2090<=e&&e<=2099},p.WAN=1e4,p}(),zN=function(){function l(){}return b(l,"modules.scene.others.invented.InventedUtils"),p(1,l,"enabledPickupQueueLength2",function(){for(var e=0,t=0;t<l.pickUpQueue.length;t++){var i=l.pickUpQueue[t];i.type!=Za.PICKUP_ITEM&&i.type!=Za.PICKUP_GOLD||i.cid!=uH.Ins().currCid||0!=i.isRecover||1!=i.visible||0!=i.isDeath||!i.stage||e++}return e}),p(1,l,"enabledPickupQueueLength",function(){for(var e=0,t=0;t<l.pickUpQueue.length;t++){var i=l.pickUpQueue[t];i.selectEnabled&&(i.type==Za.PICKUP_ITEM||i.type==Za.PICKUP_GOLD)&&i.cid==uH.Ins().currCid&&0==i.isRecover&&1==i.visible&&0==i.isDeath&&i.stage&&e++}return e}),p(1,l,"enabledPickupQueueLengthState",function(){for(var e=0,t=0;t<l.pickUpQueue.length;t++){var i=l.pickUpQueue[t];i&&(i.type==Za.PICKUP_ITEM||i.type==Za.PICKUP_GOLD)&&i.cid==uH.Ins().currCid&&0==i.isRecover&&1==i.visible&&0==i.isDeath&&i.stage&&e++}return e}),l.GetChar=function(){var t;if(l._sceneCharPoolQueue_.length)try{(t=l._sceneCharPoolQueue_.pop()).char_id=Ee.getSoleId(),t._setup_(),G.timer.clearAll(t),t.isDeath=!1,t.isCharMode=!1,t.isUpdateBool=!0,t.setCharBoolValue(100,100),t.play("stand"),t.isBoss=!1,t.scaleX=t.scaleY=1,t.alpha=1,t.visible=!0,t.selectEnabled=!0,t.selectTarget=null,t.ai=null,t.relive(),t.resetCharHead(),t._movePath_.length=0,t.tarPoint_=null,t.hero_id=-1}catch(e){t=new yj}else t=new yj;return t.scaleX=t.scaleY=1,t.isRecover=!1,t.isShowad=!0,t.isCharObj=!0,t},l.recoverChar=function(e){if(e)if(e instanceof zwc.engine.core.displays.world.char.Char)if(-1==_s.getQualifiedClassName(e).indexOf("Sprite")){if(e instanceof zwc.engine.core.displays.world.char.MainChar)return;e.recover(),e.isUpdateBool=!0,-1==l._sceneCharPoolQueue_.indexOf(e)&&l._sceneCharPoolQueue_.push(e)}else e.dispose();else e instanceof zwc.engine.core.displays.avatars.Effect&&e.dispose()},l.getNearItem=function(e){for(var t={char:null,dis:0},i=0;i<l.pickUpQueue.length;i++){var n=l.pickUpQueue[i];if(n.selectEnabled&&(n.type==Za.PICKUP_ITEM||n.type==Za.PICKUP_GOLD)&&n.cid==uH.Ins().currCid&&0==n.isRecover&&1==n.visible&&0==n.isDeath&&n.stage&&n.isOwner&&n.selectEnabled){var s=ol.distance(e,n.point);null==t.char?(t.char=n,t.dis=s):s<t.dis&&(t.char=n,t.dis=s)}}return t.char},l.getChar=function(e){if(null==e)return null;for(var t=0;t<l.charQueue.length;t++){var i=l.charQueue[t];if(i.char_id==e)return i}return null},l.getCharByCharIDAndHeroID=function(e){if(null==e||null==e.char_id)return null;for(var t=0;t<l.charQueue.length;t++){var i=l.charQueue[t];if(i.char_id==e.char_id&&i.hero_id==e.hero_id)return i}return null},l.getCharInStage=function(e,t){for(var i=0;i<l.stageCharQueue.length;i++){var n=l.stageCharQueue[i];if(0<n.objectId){if(n.char_id==e&&n.objectId==t)return n}else if(n.char_id==e)return n}return null},l.getMonstersInSize=function(e,t){void 0===t&&(t=1);for(var i,n=[],s=[],o=0;o<l.charQueue.length;o++){if(0==(i=l.charQueue[o]).isDeath&&i!=NF.mainChar&&i.type==Za.MONSTER&&i.selectEnabled&&0==i.isRecover&&e)ZN.getTileDis(e,i.tilePoint)<=t&&n.push(i);else i.isRecover&&(l.charQueue.splice(o,1),s.push(i),o--)}for(var a=0;a<s.length;a++)i=s[a],uH.Ins().removeChar(i);return n},l.getMonsters=function(e){for(var t,i=[],n=[],s=0;s<l.charQueue.length;s++)(t=l.charQueue[s]).type==Za.MONSTER&&!t.isDeath&&t.selectEnabled&&0==t.isRecover?null!=e?t.proto.modelId==e&&i.push(t):i.push(t):t.isRecover&&(n.push(t),l.charQueue.splice(s,1),s--);for(var o=0;o<n.length;o++)t=n[o],uH.Ins().removeChar(t);return i},l.getChars=function(){for(var e,t=[],i=[],n=0;n<l.charQueue.length;n++)(e=l.charQueue[n]).type!=Za.MAIN_CHAR&&e.type!=Za.HERO||(0==e.isRecover?t.push(e):(i.push(e),l.charQueue.splice(n,1),n--));for(var s=0;s<i.length;s++)e=i[s],uH.Ins().removeChar(e);return t},l.getMonsterInStage=function(e){for(var t,i=[],n=0;n<l.stageCharQueue.length;n++)(t=l.stageCharQueue[n]).type==Za.MONSTER&&!t.isDeath&&t.selectEnabled&&0==t.isRecover&&(null!=e?t.proto.modelId==e&&i.push(t):i.push(t));return i},l.getCollectionInStage=function(e){for(var t,i=[],n=0;n<l.stageCharQueue.length;n++)(t=l.stageCharQueue[n]).type==Za.COLLECTION&&!t.isDeath&&t.selectEnabled&&0==t.isRecover&&(null!=e?t.proto.modelId==e&&i.push(t):i.push(t));return i},l.getCharByPt=function(e){for(var t=modules.scene.others.invented.InventedUtils.getMonsterInStage(),i=0;i<t.length;i++){var n=t[i];if(0==n.isDeath&&n.tilePoint.x==e.x&&n.tilePoint.y==e.y)return n}return null},l.getCharByPtXY=function(e,t,i){for(var n=modules.scene.others.invented.InventedUtils.getMonsterInStage(),s=0;s<n.length;s++){var o=n[s];if(o.tilePoint.x==e&&o.tilePoint.y==t&&(null==i||o.char_id!=i&&o.owner_char!=i))return o}return null},l.getNPC=function(e){for(var t=0;t<l.charQueue.length;t++){var i=l.charQueue[t];if(i.type==Za.NPC&&null!=e&&i.char_id==e)return i}return null},l.getNPCs=function(){for(var e=[],t=0;t<l.charQueue.length;t++){var i=l.charQueue[t];i.type==Za.NPC&&e.push(i)}return e},l.findCharsBySize=function(e,t,i){for(var n=[],s=0;s<l.charQueue.length;s++){var o=l.charQueue[s];if(o&&(0==o.isDeath||"ms228"==o.mid)&&o!=NF.mainChar&&e&&o.tilePoint){var a=ZN.getTileDis(e,o.tilePoint),r=!0;null!=i&&(r=Boolean(o.type==i)),a<=t&&r&&n.push(o)}}return n},l.findCharByDir=function(e,t,i){void 0===i&&(i=1);for(var n=[],s=0;s<l.charQueue.length;s++){var o=l.charQueue[s];if(0==o.isDeath&&o!=NF.mainChar){var a=o.tilePoint,r=e.tilePoint;if(ZN.getTileDis(new Uh(r.x,r.y),new Uh(a.x,a.y))==i){VB.getDretion(r.x,r.y,a.x,a.y);n.push(o)}}}return n},l.getTilesForBanYue=function(e,t,i){void 0===i&&(i=!0);for(var n=[],s=t+2,o=t-1;o<s;o++){var a=t+o;7<a&&(a-=7),a<0&&(a+=7);var r=VB.getTileByDir(e,a,1);i?n.push(PB.pixelsToTile(r.x,r.y)):n.push(r)}return n},l.getTargetForSkillBanYue=function(e,t){for(var i=[],n=l.getTilesForBanYue(e,t),s=0;s<n.length;s++){var o=l.getCharByPt(n[s]);o&&o.selectEnabled&&i.push(o)}return i},l.isCharFaceToTile=function(e,t){for(var i=VB.getDretion(e.tilePoint.x,e.tilePoint.y,t.x,t.y),n=-1;n<2;n++){var s=e.dir+n;if(7<s&&(s-=7),s<0&&(s+=7),s==i)return!0}return!1},l.clearPickUpQueue=function(){var e;for(var t in l.pickUpQueue)e=l.pickUpQueue[t],NF.scene.removeItem(e),e.recover(),e.isRecover=!0,e=null;l.pickUpQueue=[]},l.clearSceneMonster=function(){for(var e=0;e<l.stageCharQueue.length;e++){var t=l.stageCharQueue[e];t.type==Za.MONSTER&&(NF.scene.removeItem(t),t.recover(),t.isRecover=!0,t=null,l.charQueue.splice(e,1))}},l.charQueue=[],l.stageCharQueue=[],l._sceneCharPoolQueue_=[],l.deathQueue=[],l.pickUpQueue=[],f(l,["stageRect",function(){return this.stageRect=new u_}]),l}(),XN=function(){function t(){this.isEnterCopy=!1,this.charArr=[]}b(t,"modules.scene.others.jqr.GuanQiaJQRManager");var e=t.prototype;return e.clearJQR=function(){for(var e=0,t=this.charArr.length;e<t;e++){var i=this.charArr[e];i.ai&&i.ai.stop(),i.setCharNameVisible(!1),i.setCharBoolVisible(!1),i.removeReason&&i.removeReason.push("remove"),uH.Ins().removeChar(i)}this.charArr=[],G.timer.clear(this,this.createJQR2)},e.createJQRByGuanQiaLv=function(){(this.clearJQR(),this.isEnterCopy)||(0!=BR.ins.curCopyId&&t.NEED_SHOW_JQR_COPYID.indexOf(-1==BR.ins.curCopyId)||18<UR.instance.currentPoint||this.createJQRBySceneID_config(2,1))},e.createCharDtoByM=function(e,t){t.professional=e.roleTypeId,t.sex=e.genderId,t.mid=e.avatars.avatar,t.wid=e.avatars.weapon,t.wgid=e.avatars.wing,t.eid="0",t.chuanshi="0",t.wgid||(t.wgid="0"),t.x=NF.mainChar.x+3,t.y=NF.mainChar.y+3,t.dir=NF.mainChar.dir;for(var i=e.attributes,n=0;n<i.length;n++)"MAXHP"==i[n].type&&(t.currHP=i[n].value,t.maxHP=i[n].value);return t.robot=1,t.modelId=e.robotRoleId,uH.setMonsetAttributes(t.modelId,e.attributes),t},e.createJQR2=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=0);var s=new TH;if(this.createCharDtoByM(e,s),!Ml.CONFIG_POINT){var o=$e.MODEL.value($e.getIndex(168));Ml.CONFIG_POINT=o.split("|")}var a=new ta;a.eid=s.eid,a.mid=s.mid,a.wgid=s.wgid,a.wid=s.wid,a.playerId=e.robotRoleId,a.pro=s.professional,a.sex=s.sex,a.name=s.charName;var r,l=UR.instance.currentPoint,c=String(Ml.CONFIG_POINT[l-1]).split(",");0==n?(s.x=80*c[0],s.y=40*c[1]):1==n&&(s.x=80*c[2],s.y=40*c[3]),r=uH.Ins().createChar(e.robotRoleId,new Uh(s.x,s.y),a,null),this.charArr.push(r);var u=rH.GetRobotHootAI();u.setup(r),rH.pushAI(u),u.start(),r.char_id=e.robotRoleId.toString(),r.char_name=e.description,r.setCharNameVisible(!0),r.setCharBoolVisible(!0),r.setCharBoolValue(1e7,1e7),r.dir=NF.mainChar.dir,r.bodyHeight=NB.BODY_HEIGHT,r.type=Za.HERO,r.objectId=e.robotRoleId,r.camp=NF.mainChar.camp,r.campState=NF.mainChar.campState,r.cid=uH.Ins().currCid,r.proto=a,ZN.updateCharDisplay(r,s.mid,s.wid,s.wgid),r.removeEffect(Aa.EFFECT_MOFADUN),uH.Ins().addChar(r)},e.createJQRBySceneID_config=function(e,t,i){void 0===i&&(i=0);var n=0,s=parseInt(Math.random()*Ml.CONFIG_0.length+"");10<s&&(s=10);for(var o=Ml.CONFIG_0[s].id,a=Ml.CONFIG_0[s].monsterData,r=0,l=[];r<2;){var c=parseInt(Math.random()*a.length+"");-1==l.indexOf(c)&&(l.push(c),r++)}for(var u=UR.instance.currentPoint,d=0;d<l.length;d++){n=Ml.robotRoleIdsByMonsterId(a[l[d]].monsterId);var h=Ml.getAttrInfoByrobotIDs(n);if(null!=h){var _=new Al;_.attributes=h.attributes,_.description=h.description,_.avatars=h.avatars,_.robotRoleId=h.id,_.genderId=h.genderId,_.roleTypeId=h.roleTypeId,_.skillArr=h.roleSkill;for(var f=[],p=0;p<_.skillArr.length;p++){var g=new na;g.skill_id=_.skillArr[p].id,g.cur_lvl=_.skillArr[p].level,f.push(g)}_.skillArr=f,n=rn.getIndex(o);var v=rn.MODEL.robotBirthGrid(n);if(""!=v)JSON.parse(v);5<=u&&u<=14?this.createJQR2(_,t,!1,d):2<=u&&u<=14&&G.timer.once(0==d?500:2e3,this,this.createJQR2,[_,t,!1,d],!1)}}},t.instance=function(){null==t._insatance&&(t._insatance=new t);for(var e=1;e<=18;e++)t.GUANQIA_TO_MISSID.put(e,1e4+e);return t._insatance},t._insatance=null,f(t,["GUANQIA_TO_MISSID",function(){return this.GUANQIA_TO_MISSID=new jl},"GUANQIA_1_4",function(){return this.GUANQIA_1_4=[1,4]},"GUANQIA_5_14",function(){return this.GUANQIA_5_14=[5,14]},"GUANQIA_15_18",function(){return this.GUANQIA_15_18=[15,18]},"NEED_SHOW_JQR_COPYID",function(){return this.NEED_SHOW_JQR_COPYID=[10001,10002,10003,10004,10005,10006,10007,10008,10009,10010,10011,10012,10013,10014,10015,10016,10017,10018]}]),t}(),QN=function(){function e(){this.disNum=240,this.time=0,this.sayIndex=0,this.sayQueue=[],this.charHash=new jo,G.timer.loop(600,this,this.enterFrameFunc)}b(e,"modules.scene.others.MonsterSayWord");var t=e.prototype;return t.sayWord=function(e){if(e.proto&&e.proto.modelId){var t=e.proto.modelId;for(var i in this.sayQueue)if(this.sayQueue[i].key==t)return;var n=e.proto.modelIndex;if(!hn.MODEL.talkContent(n))return;this.sayQueue.push({key:t,saycast:hn.MODEL.talkInterval(n)}),be.sortOn(this.sayQueue,"saycast",Array.NUMERIC)}},t.clear=function(){this.sayQueue.length=0,this.charHash.clear()},t.enterFrameFunc=function(){var e=this;if(e.sayQueue.length&&BB.getTimer()-e.time>1e3*(2+(2*Math.random()>>0))&&NF.Ins().isReady){e.time=BB.getTimer(),e.sayIndex++,e.sayIndex>=e.sayQueue.length&&(e.sayIndex=0);var t=e.sayQueue[e.sayIndex].key,i=e.charHash.get(t);if(i||(i={key:t,time:0,dur:1e3*hn.MODEL.talkInterval(hn.getIndex(parseInt(t)))},e.charHash.set(t,i)),BB.getTimer()-i.time>=i.dur+1500){var n=e.finedMonster(t);if(n.length){var s=Math.random()*n.length>>0,o=n[s].char;o.type==Za.NPC?n[s].dis<=e.disNum&&e.say(o):e.say(o)}}}},t.finedMonster=function(e){var t,i=[];for(var n in zN.stageCharQueue)(t=zN.stageCharQueue[n]).proto&&t.proto.modelId==e&&i.push({char:t,dis:BB.distance(t.point,NF.mainChar.point)});return be.sortOn(i,["dis"],[Array.NUMERIC]),i},t.say=function(e){if(e&&e.proto&&0==e.isDeath&&("stand"==e.act||"walk"==e.act||"run"==e.act)&&(e.type==Za.MONSTER||e.type==Za.SUMMON_MONSTER||e.type==Za.NPC)){var t=hn.MODEL.talkContent(e.proto.modelIndex).split("|");e.sayWord(t[Math.random()*t.length>>0])}},p(1,e,"ins",function(){return e.instance=e.instance||new e}),e.instance=null,e}(),JN=function(){function e(){this._guajiList=null,this._vipList=null}b(e,"modules.scene.others.SceneCheckPointData");var t=e.prototype;return t.getGuajiList=function(){return this.initCheckPoint(),this._guajiList},t.getVipList=function(){return this.initCheckPoint(),this._vipList},t.getRecommendScene=function(){for(var e=ld.ins.hasMonthCard?this.getVipList():this.getGuajiList(),t=e.length-1;0<=t;t--){var i=e[t],n=Pn.MODEL.limitLv(i.index),s=Pn.MODEL.limitZsLv(i.index);if(gR.ins.lv>=n&&gR.ins.zsLv>=s)return Pn.MODEL.key(i.index)+""}return i=e[0],Pn.MODEL.key(i.index)+""},t.initCheckPoint=function(){if(!this._guajiList){this._guajiList=[],this._vipList=[];for(var e=0;e<Pn.count;++e)2==Pn.MODEL.type(e)&&(1==Pn.MODEL.isVip(e)?this._vipList.push({index:e,type:1}):this._guajiList.push({index:e,type:0}))}},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}(),ZN=function(){function a(){}return b(a,"modules.scene.others.SceneUtils"),a.isEnabledChangeScene=function(){if(dr.dtoEnterScene&&23==dr.dtoEnterScene.type)return!0;if(aH.isZhanBaokMode)return!1;if(dr.dtoEnterScene&&7!=dr.dtoEnterScene.type&&nF.enabled())return!1;if(dr.dtoEnterScene&&14!=dr.dtoEnterScene.type&&nF.enabled())return!1;if(dr.dtoEnterScene&&49!=dr.dtoEnterScene.type&&nF.enabled())return!1;if(PH.hasTask()&&PH.Ins().info.waitZhanBao)return!1;if(dr.dtoEnterScene&&2==dr.dtoEnterScene.type&&0<zN.enabledPickupQueueLength)return!1;var e=Pn.getIndex(parseInt(gR.ins.cId));if(0<=e){var t=parseInt(gR.ins.cId);if(1!=Pn.MODEL.type(e)&&2!=Pn.MODEL.type(e)&&1!=t&&-1==_a.S_SBK_SCENES.indexOf(t))return!1}return!0},a.isHookScene=function(){parseInt(uH.Ins().currCid);return 2==uH.Ins().currCkType||1==uH.Ins().currCkType},a.isSynchScene=function(e){return void 0===e&&(e=-1),-1==e&&(e=parseInt(uH.Ins().currCid)),-1!=a.sendMove.indexOf(e)},a.isSynchMission=function(){return 0<rn.MODEL.synchScene(rn.getIndex(BR.ins.curCopyId))},a.isSynch=function(){return!(!a.isSynchScene()&&!a.isSynchMission())},a.setCharTitle=function(e,t){var i=[];if(t){for(var n=0;n<t.length;n++){var s=t[n],o=co.getIndex(s),a=co.MODEL.effect(o);i.push(a)}e.showTitles(i)}},a.updateCharDisplayByVo=function(e,t){a.updateCharDisplay(e,t.mid,t.wid,t.wgid,t.weaponSoulId,t.chuanshiId,t.magicId,t.dragonEff)},a.updateCharDisplay=function(e,t,i,n,s,o,a,r){void 0===t&&(t="0"),void 0===i&&(i="0"),void 0===n&&(n="0"),void 0===s&&(s="0"),void 0===o&&(o=""),void 0===a&&(a=""),void 0===r&&(r=""),e&&(t="null"==t?"0":t,i="null"==i?"0":i,n="null"==n?"0":n,s="null"==s?"0":s,o=o||"",r=r||"",e.mid=t,e.wgid=n,e.wid=i,e.eid=s,e.magicId=a,t&&"0"!=t&&e.loadAvatarParts("mid",t,!0),i&&"0"!=i&&e.loadAvatarParts("wid",i),n&&"0"!=n&&e.loadAvatarParts("wgid",n),a&&"0"!=a&&""!=a?e.loadAvatarParts("eid",a):s&&"0"!=s&&""!=s?e.loadAvatarParts("eid",s):e.aunit&&e.aunit.loadAvatarParts("eid",null),o&&""!=o&&e.setChuanShiEffect(o),r&&""!=r&&e.setTianHuangLongWu(r))},a.loopShake=function(){var e=BB.getTimer();if(a.shakeXArray.length<=0)a.isShaking=!1;else if(15<e-a.durTime){a.durTime=e;var t=a.shakeX+a.shakeXArray.shift(),i=a.shakeY+a.shakeYArray.shift();NF.scene.sceneMoveTo(t,i)}},a.toShake=function(){if(!ER.ins.hideZhen){if(HB.fps<30){if(dr.dtoEnterScene&&7==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&49==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&14==dr.dtoEnterScene.type)return}if(!a.isShaking&&!a._heidShake_){a.durTime=a.shakeTime=BB.getTimer(),a.shakeX=NF.mainChar.x,a.shakeY=NF.mainChar.y,a.isShaking=!0;a.shakeXArray=[5,-5,5,5,20,40,0,-40,40,-20,40,40,0,-40,40,-20,40,-20,0],a.shakeYArray=[5,-10,15,15,20,40,0,-40,40,-20,40,40,0,-40,40,-20,40,-20,0]}}},a.updatePingbiStatus=function(e){BB._auto_heidOtherCharMode=e,modules.scene.others.SceneUtils._heidShake_=e},a.updateMainCharName=function(){for(var e=gR.ins.guildName,t=gR.ins.charName,i=0;i<gR.ins.actorList.length;i++){var n=gR.ins.actorList[i],s=uH.getHero(n.id);if(s){if(s.char_name=t,""==e||null==e?(s.setCharProfessionNameVisible(!1),s.charProfessionName=""):(s.setCharProfessionNameVisible(!0),0<gR.ins.guidePos?s.charProfessionName=e+"["+Bl.getCNPos(gR.ins.guidePos)+"]":s.charProfessionName=e),0<gR.ins.actorFlyUpLevel){var o=gR.ins.actorFlyUpLevel;s.setCharFlyupNameVisible(!0),s.setflyupName(o)}else s.setCharFlyupNameVisible(!1),s.setflyupName(0);a.setCharTitle(s,n.titles)}}},a.getTileDis=function(e,t){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.max(i,n)},a.getTileDisByPos=function(e,t,i,n){var s=Math.abs(e-i),o=Math.abs(t-n);return Math.max(s,o)},a.goTarget=function(e,t,i,n,s,o){void 0===n&&(n=!1),Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],Np.create(e,t,i,n,s,o))},a.goTargetbyVo=function(e){Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],e)},a.pickupAll=function(){if(zN.pickUpQueue.length){for(var e=0;e<zN.pickUpQueue.length;e++){var t=zN.pickUpQueue[e];t.type==Za.PICKUP_GOLD&&zB.ins.playGetItems([t.proto]),uH.Ins().removePickItem(t),t==NF.Ins().selectChar&&(NF.Ins().selectChar=null),t.parent&&t.parent.removeChild(t)}zN.pickUpQueue.length=0}},a.isYZBQCSceneID=function(){return uH.Ins().currCid==_a.S_YeZhanBIQI.toString()},a.checkIsCopyScene=function(){return dr.dtoEnterScene&&0!=dr.dtoEnterScene.copyId&&0!=dr.dtoEnterScene.type&&0!=BR.ins.curCopyId},a.isShaking=!1,a._heidShake_=!1,a.shakeX=0,a.shakeY=0,a.shakeTime=0,a.shakeXArray=[],a.shakeYArray=[],a.durTime=0,f(a,["points_JJC",function(){return this.points_JJC=[new Uh(1609,1151),new Uh(1513,1191),new Uh(1591,1232),new Uh(1700,1230),new Uh(1660,1172),new Uh(1461,1155),new Uh(1640,1264)]},"points_TQG",function(){return this.points_TQG=[new Uh(1944,763),new Uh(1779,765),new Uh(1982,898),new Uh(2048,807),new Uh(1985,789),new Uh(1779,765),new Uh(1919,854)]},"sendMove",function(){return this.sendMove=[1,20100,20140,20150,20130,20160]}]),a}(),KN=function(){var i;function e(){this.showQuene=null,this.showQuene=[]}b(e,"modules.scene.views.SceneFlyText");var t=e.prototype;return t.showText=function(){var e=this.showQuene.shift(),t=new i;t.update(e),t.pos(NF.mainChar.x-t.width/2,NF.mainChar.y-NF.mainChar.bodyHeight),t.scale(0,0),t.alpha=0,NF.scene.addChild(t),0==this.showQuene.length&&G.timer.clear(this,this.showText)},t.putType=function(e,t){var i=new Object;i.type=e,i.value=t,0==this.showQuene.length&&(G.timer.once(10,this,this.showText),G.timer.loop(500,this,this.showText)),this.showQuene.push(i)},p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e.heartCeatHandler=function(){if(modules.scene.views.SceneFlyText.instance.showQuene.length)for(var e=0;e<modules.scene.views.SceneFlyText.instance.showQuene.length;e++)modules.scene.views.SceneFlyText.instance.showQuene[e]},e.TYPE_DRAGON_DESIGN_ESSENCE=1,e.TYPE_EXP=2,e._instance=null,e.__init$=function(){i=function(t){function e(){this._imageType=null,this._imagePlue=null,this._clip=null,e.__super.call(this)}b(e,"",t);var i=e.prototype;return i.onAdd=function(e){t.prototype.onAdd.call(this,e),Og.to(this,{alpha:1,scaleX:1,scaleY:1,y:NF.mainChar.y-NF.mainChar.bodyHeight-100},1500,pa.elasticInOut,ql.create(this,this.onTweenComplete))},i.onTweenComplete=function(){Og.to(this,{alpha:0,y:NF.mainChar.y-NF.mainChar.bodyHeight-300},2e3,pa.linearIn,ql.create(this,this.onDisploseCompolete))},i.onDisploseCompolete=function(){this.parent.removeChild(this),this.destroy(!0)},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},i.update=function(e){var t,i=e.value.toString().split(""),n=0,s=0;switch(e.type){case 2:s=1e4;break;case 1:s=10001}var o=Aa.getHurtNumberImageHash(s);if(o){var a=o.img,r=o.numImg;if(a&&(n+=(t=HP.drawTexture("fightNumer",a,this.graphics,n,-110)).width,this.height=t.height),n+=(t=HP.drawTexture("fightNumer",r+"+",this.graphics,n,-110)).width,this.height=t.height,null!=r&&(1!=i.length||"0"!=i[0]))for(var l=0;l<i.length;l++)n+=(t=HP.drawTexture("fightNumer",r+i[l],this.graphics,n,-110)).width;this.width=n}},e}(Gg)},e}(),$N=function(){function e(){}b(e,"modules.seven.others.SevenData");var t=e.prototype;return t.isOpen=function(){return this.signinData},t.isAwardable=function(){var e=this.signinData;if(e)for(var t in e.gifts)if(1==e.gifts[t].status)return!0;return!1},p(0,t,"signinDays",function(){var e,t=0,i=this.signinData;for(var n in i.gifts)1!=(e=i.gifts[n]).status&&2!=e.status||t++;return t}),p(0,t,"signinData",function(){return mB.getInStance().getActivityData(1034)}),p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),eB=function(){function e(){this.spSkillArray=[501,502,503],this.charSkillHash=new jl}b(e,"modules.skill.others.CdManager");var t=e.prototype;return t.getSkillHash=function(e){return void 0===e&&(e=1),this.charSkillHash.take(e)},t.setSkillHash=function(e,t){void 0===t&&(t=1),this.charSkillHash.put(t,e,!0)},t.resetAllSkillCd=function(){for(var e=1;e<4;e++){var t=this.charSkillHash.take(e);if(t){for(var i=0;i<t.length;i++){var n=t[i];n&&(n.isRuning=!1)}this.charSkillHash.put(e,t,!0)}}},t.checkIsInCD=function(e,t){void 0===t&&(t=1);var i,n=this.getSkillHash(t);for(var s in n)if((i=n[s]).specialId==e)return i.isRuning;return!1},t.playSkillCD=function(e){var t=Vn.getIndex(e),i=1*Vn.MODEL.CD(t)/NF.mainChar.actSpeed;this.playCD(1,e,i,0)},t.playCD=function(e,t,i,n,s){void 0===n&&(n=0),void 0===s&&(s=1);var o,a=this.getSkillHash(s);if(1==e&&0<a.length)for(var r in a)if((o=a[r]).specialId==t&&(o.play(i,n),-1!=this.spSkillArray.indexOf(t)))for(var l=0;l<this.spSkillArray.length;l++)if(this.spSkillArray[l]==t)for(var c=0;c<uH.heroQueue.length;c++){var u,d=uH.heroQueue[c];if(d&&0<d.hero_id&&d.hero_id<4)1==d.hero_id?u=this.getHeroCD(d.hero_id,501):2==d.hero_id?u=this.getHeroCD(d.hero_id,502):3==d.hero_id&&(u=this.getHeroCD(d.hero_id,503)),u&&u.play(8e3,n)}},t.getHeroCD=function(e,t){if(null==IH.ins.getCurrSkillDto(e,t))return null;for(var i=this.getSkillHash(e),n=0;n<i.length;n++){var s=i[n];if(s.specialId==t)return s}return null},t.playPropCD=function(){},e.getInstance=function(){return e.instance=e.instance||new e},e.instance=null,e}(),tB=function(){function o(){this.innerAttrPillList=null,this.innerAttrPillLvLimit=null,this._innerDatas=new jl}b(o,"modules.skill.others.InnerDataModel");var e=o.prototype;return e.updateAllInnerDatas=function(e){for(var t=e.length,i=0;i<t;i++)this.updateInnerData(i+1,e[i])},e.updateInnerData=function(e,t){var i=this.getInnerData(e);null!=i&&i.level<t.level&&Tu.sendToModule("UPGRADE_SUCCESS",["modules.skill.SkillModule"]),this._innerDatas.put(e,t,!0),IH.ins.currentSelectedRole+1==e&&Tu.sendToModule("UPDATE_INNER_DATA",["modules.skill.SkillModule"],t)},e.getInnerData=function(e){return this._innerDatas.take(e)},e.isActived=function(e){var t=this.getInnerData(e);return null!=t&&-1!=t.level},e.getInnerUpdateIndex=function(e){for(var t=sc.count,i=0;i<t;i++){var n=sc.MODEL;if(null!=n&&n.level(i)==e)return i}return null},e.checkRedPoint=function(){for(var e=[0,0,0],t=0;t<3;t++){var i=this.getInnerData(t+1);if(null!=i){for(var n=i.level,s=sc.count-1,o=sc.MODEL.copper(n),a=gR.ins.coin,r=sc.MODEL.chong(n),l=sc.MODEL.exp(n),c=sc.MODEL.addExp(n),u=n-11*r,d=i.exp,h=0;d<l;)h+=o,d+=c;33<=gR.ins.lv&&n<s&&h<=a&&1e6<=a||10==u||-1==n?e[t]=1:e[t]=0}}return e},e.updateLvLimit=function(){this.innerAttrPillLvLimit=[];for(var e=0;e<3;e++){var t=0,i=new jl,n=modules.skill.others.InnerDataModel.ins.getInnerData(e+1);n&&n.level&&(t=n.level);var s=sc.MODEL.ndLimit(modules.skill.others.InnerDataModel.ins.getInnerUpdateIndex(t));if(s)for(var o=s.split(";"),a=0;a<o.length;a++){var r=parseInt(o[a].split(":")[0]),l=parseInt(o[a].split(":")[1]);i.put(r,l,!0)}this.innerAttrPillLvLimit.push(i)}},e.getLvLimit=function(e){return this.innerAttrPillLvLimit[e-1]},e.updateInnerAttrPillVo=function(e){if(!this.innerAttrPillList){this.innerAttrPillList=[];for(var t=0;t<3;t++){var i=new ic;i.roleIndex=t+1;for(var n=0;n<modules.skill.others.InnerDataModel.ATTRPILL_GOODSID.length;n++)i.hash.put(modules.skill.others.InnerDataModel.ATTRPILL_GOODSID[n],0);this.innerAttrPillList.push(i)}}for(var s=0;s<modules.skill.others.InnerDataModel.ATTRPILL_GOODSID.length;s++)e.hash.has(modules.skill.others.InnerDataModel.ATTRPILL_GOODSID[s])&&this.innerAttrPillList[e.roleIndex-1].hash.put(o.ATTRPILL_GOODSID[s],e.hash.take(o.ATTRPILL_GOODSID[s]),!0)},e.getInnerAttrPillVo=function(e){return this.innerAttrPillList&&this.innerAttrPillList[e-1]?this.innerAttrPillList[e-1]:null},e.updateInnerAttrPillInfo=function(e){if(e instanceof protos.inner.toc_30255)this.innerAttrPillList[e.roleIndex-1].hash.put(e.goodsId,e.level,!0);else if(e instanceof protos.inner.toc_30257)this.updateInnerAttrPillVo(e.innerAttrPillInfo);else if(e instanceof protos.inner.toc_30259)for(var t=0;t<e.innerAttrPillList.length;t++)this.updateInnerAttrPillVo(e.innerAttrPillList[t]);Tu.sendToModule("UPDATE_INNER_DATA",["modules.skill.SkillModule"])},e.innerAttrPillCanUpgrade=function(e){for(var t=0;t<this.innerAttrPillLvLimit.length;t++)if(this.innerAttrPillList&&this.innerAttrPillList[t]){var i=this.innerAttrPillList[t],n=this.innerAttrPillLvLimit[e-1];if(i&&i.roleIndex==e)for(var s=0;s<o.ATTRPILL_GOODSID.length;s++)if(n.has(o.ATTRPILL_GOODSID[s])&&i.hash.take(o.ATTRPILL_GOODSID[s])<n.take(o.ATTRPILL_GOODSID[s])&&0<TR.ins.getGoodsNum(o.ATTRPILL_GOODSID[s]))return!0}return!1},p(1,o,"ins",function(){return o._inst||(o._inst=new o),o._inst}),o._inst=null,f(o,["ATTRPILL_GOODSID",function(){return this.ATTRPILL_GOODSID=[2355,2356,2357,2358]}]),o}(),iB=function(){function e(){this.curUpgradeId=0,this.isNewFuwen=[!0,!0,!0],this.mijiHash=new jl,e._inst&&pt.window.alert(RP.n[65])}b(e,"modules.skill.others.MijiDataModel");var t=e.prototype;return t.updateMiji=function(e,t,i){var n=this.mijiHash.take(e);if(n){var s={};switch(i){case 1:n.push(t),s.holeIdx=t.miji_index,s.opType=1,Tu.sendToModule("MIJI_UPGRADE",["modules.skill.SkillModule"],s);break;case 2:var o=this.getMijiIndex(e,t.miji_index);n.splice(o,1);break;case 3:o=this.getMijiIndex(e,t.miji_index),n.splice(o,1,t),s.holeIdx=t.miji_index,s.opType=3,Tu.sendToModule("MIJI_UPGRADE",["modules.skill.SkillModule"],s)}this.mijiHash.put(e,n,!0)}else{var a=[];a.push(t),Tu.sendToModule("MIJI_UPGRADE",["modules.skill.SkillModule"],s),this.mijiHash.put(e,a,!0)}},t.getMijiIndex=function(e,t){var i=this.mijiHash.take(e);if(i)for(var n=0;n<i.length;n++){if(i[n].miji_index==t)return n}return-1},t.takeCharMijiList=function(e){var t=this.mijiHash.take(e);return null==t?[]:t},t.getMijiDto=function(e,t){var i=this.takeCharMijiList(e);if(i)for(var n=0;n<i.length;n++){var s=i[n];if(s.miji_index==t)return s}return null},t.getRewardNumByTakeoff=function(e,t){return{}},t.getNullHole=function(e){for(var t,i=modules.skill.others.MijiDataModel.ins.takeCharMijiList(e),n=[1,2,3,4,5,6,7,8],s=0;s<i.length;s++)t=i[s],n.splice(n.indexOf(t.miji_index),1);for(s=0;s<n.length;s++){var o=gR.ins.VIPLevel,a=gR.ins.zsLv,r=an.getIndex(n[s]),l=an.MODEL.vipLevel(r),c=an.MODEL.playerLevel(r);if(l<=o||c<=a)return n[s]}return-1},t.checkCanLearn=function(e){return!1},t.checkCanUpgradeByIndex=function(e){var t=e.maxLv;if(e.cur_lvl>=t)return!1;var i=e.cost.split(","),n=i[0];return i[1]<=TR.ins.getGoodsNum(n)},t.checkCanUpgrade=function(e){for(var t,i=modules.skill.others.MijiDataModel.ins.takeCharMijiList(e),n=0;n<i.length;n++)if(t=i[n],this.checkCanUpgradeByIndex(t))return!0;return!1},t.checkRedPoint=function(e){return this.checkCanLearn(e)||this.checkCanUpgrade(e)},t.canEquipBySlot=function(e,t){var i=this.getMijiDto(e,t);return i&&1==i.isOpen&&!i.miji_id},t.isLock=function(e,t){var i=this.getMijiDto(e,t);return i&&0==i.isOpen},t.isEquipBySlot=function(e,t){var i=this.getMijiDto(e,t);return i&&1==i.isOpen&&i.miji_id},t.canEquipAll=function(e){for(var t=!0,i=1;i<=8;i++)t=t&&(this.canEquipBySlot(e,i)||this.isLock(e,i));return t},t.hasEmptySlot=function(e){for(var t=1;t<=8;t++)if(this.canEquipBySlot(e,t))return!0;return!1},t.canEquip=function(e){var t=!1,i=0,n=0,s=TR.ins.getBackPackItems();for(n=0;n<s.length;n++){var o=s[n];for(i=0;i<Xs.count;i++)if(Xs.MODEL.goodsId(i)==o.goodsId){t=!0;break}if(t)break}if(t)for(n=1;n<=8;n++)if(this.canEquipBySlot(e,n))return!0;return!1},t.getMaxLevel=function(e){for(var t=0,i=1;i<=8;i++){var n=this.getMijiDto(e,i);n&&1==n.isOpen&&0<n.miji_id&&n.cur_lvl>t&&(t=n.cur_lvl)}return t},t.getMaxLevelInBag=function(e,t,i){void 0===i&&(i=0);var n=0,s=0;for(s=0;s<t.length;s++){var o=t[s],a=Xs.MODEL.type(o);if(0==i||a==i){var r=Xs.MODEL.mijiLevel(o);n<r&&(n=r)}}return n},t.hasHighLevelGoods=function(e,t){return t+3<e},t.getFuwenIndexs=function(){for(var e=[],t=0,i=TR.ins.getBackPackItems(),n=0;n<i.length;n++){var s=i[n];for(t=0;t<Xs.count;t++)Xs.MODEL.goodsId(t)==s.goodsId&&e.push(t)}return e},t.hasLearnByType=function(e,t){return null!=this.getLearnSlot(e,t)},t.getLearnSlot=function(e,t){for(var i=1;i<=8;i++){var n=this.getMijiDto(e,i);if(n&&1==n.isOpen&&t==n.type)return n}return null},t.hasAllType=function(e,t){var i={},n=0;for(n=0;n<t.length;n++){var s=t[n];i[Xs.MODEL.type(s)]=1}var o={};for(n=1;n<=8;n++){var a=this.getMijiDto(e,n);a&&0<a.miji_id&&a.type}var r=!0;for(var l=0 in i)if(!(r=r&&1==o[l]))break;return r},p(1,e,"ins",function(){return e._inst||(e._inst=new e),e._inst}),e.refreshRedPoint=function(e){var t=!1;for(var i in e)if(5==e[i].subType){t=!0;break}t&&(modules.skill.others.MijiDataModel.ins.isNewFuwen=[!0,!0,!0],Tu.sendToModule("FUWEN_CHANGED",["modules.skill.SkillModule"]))},e._inst=null,e}(),nB=function(){function a(){this.seaAirInfo=null,this.seaAirUps=[],this.seaAirRemainTime=null,this.showAddSouleExp=!1,this.useGoodsDto=null,this.tooldsId=-1}b(a,"modules.skill.others.SeaAirDataModel");var e=a.prototype;return e.getSeaAirLv=function(e){var t=[],i=0,n=0,s=0;for(i=0;i<oo.count;i++)if(n=oo.getIndex(i),e==(s=oo.MODEL.level(n))){t.push(Math.floor(s/10)),t.push(s%10);break}return t},e.updateSeaAir=function(){if(oo.count<=0){var e=[{url:_r.getDBPath("ConfigQihai"),type:"arraybuffer"}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}else this.refreshSeaAirRedPoint()},e.onLoad=function(e){if(G.loader.getRes(e.url)&&oo.count<=0){oo.setup(e.url);for(var t=oo.count,i=0;i<t;i++)oo.config(i)}G.loader.clearRes(e.url),this.refreshSeaAirRedPoint()},e.refreshSeaAirRedPoint=function(){if(null!=this.seaAirInfo)for(var e=gR.ins.actorList,t=0,i=0;i<e.length;i++){var n=e[i].qhCfgId;if(this.seaAirInfo.has(i+1))t=this.seaAirInfo.take(i+1).soulScore;this.seaAirUps[i]=!1;var s=-1;0<n&&(s=oo.getIndex(n));var o=0;-1!=s&&(o=oo.MODEL.level(s));var a=this.getNextSeaAir(o);if(-1!=a)oo.MODEL.cost(a)<=t&&(this.seaAirUps[i]=!0);this.seaAirUps[i]&&!0}},e.getNextSeaAir=function(e){for(var t=-1,i=oo.count,n=0;n<i;n++)if(oo.MODEL.level(n)==e+1){t=n;break}return t},e.seaAirGetPrice=function(e){var t=0,i=Nn.count,n=0;for(n=0;n<i;n++){if(Nn.MODEL.goodsId(n)==e){t=Nn.MODEL.price(n);break}}return t},e.seaAirGetShopIndex=function(e,t){void 0===t&&(t=4);var i=0,n=Nn.count,s=0;for(s=0;s<n;s++){if(Nn.MODEL.goodsId(s)==e&&Nn.MODEL.tabId(s)==t){i=Nn.MODEL.key(s);break}}return i},e.checkCanSeaAirExchange=function(e,t){var i=!1;if(this.seaAirRemainTime){var n=0,s=Bi.getIndex(a.PROP_IDS[e]),o=Bi.MODEL.roleUseLimitOfDay(s);if(this.seaAirRemainTime&&this.seaAirRemainTime.has(a.PROP_IDS[e]))n=this.seaAirRemainTime.take(a.PROP_IDS[e])[t];if(n<o)i=0<TR.ins.getGoodsNum(a.PROP_IDS[e]);else i=!1}else i=!1;return i},e.getSeaAirValue=function(e){return 0},e.showGetRedPoint=function(e){for(var t=!1,i=0;i<a.PROP_IDS.length&&1!=(t=this.checkCanSeaAirExchange(i,e));i++);return t},e.getSeaAirByIndex=function(e){var t=new NO;t.roleIndex=e,Tu.sendToService(t)},e.upSeaAirByIndex=function(e){var t=new BO;t.roleIndex=e,Tu.sendToService(t)},e.useSoulTools=function(e,t,i){void 0===i&&(i=1);var n=new DL;n.roleIndex=e,n.uuid=t,n.num=i,Tu.sendToService(n)},e.buyMallGood=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=0);var n=new qL;n.index=e,n.buyNum=t,n.roleIndex=i,Tu.sendToService(n)},p(1,a,"ins",function(){return null==a._ins&&(a._ins=new a),a._ins}),a.FIRST_LONGIN=!0,a._ins=null,f(a,["PROP_IDS",function(){return this.PROP_IDS=[2341,2342,2343]},"POINT",function(){return this.POINT=[{x:330,y:618},{x:469,y:599},{x:570,y:517},{x:570,y:408},{x:469,y:328},{x:330,y:303},{x:191,y:327},{x:89,y:409},{x:89,y:514},{x:189,y:596}]}]),a}(),sB=function(){function e(){this.talentType=1,this.talentUps=[],this.actorTalentData=new jl,this.talentRedPointHash=new jl}b(e,"modules.skill.others.TalentDataModel");var t=e.prototype;return t.decode=function(e){var t=new kp;t.roleIndex=e.readByte(),t.leftTalentPoint=e.readInt();var i,n=e.readShort(),s=0;for(s=0;s<n;s++)(i=new Object).id=e.readInt(),i.lv=e.readShort(),t.talent_Hash.put(i.id,i,!0);for(n=e.readByte(),s=0;s<n;s++)(i=new Object).type=e.readInt(),i.cost=e.readInt(),t.talentCost_hash.put(i.type,i.cost,!0);this.actorTalentData.put(t.roleIndex,t,!0)},t.decodeToRolePoint=function(e){var t=e.readByte(),i=this.actorTalentData.take(t);i&&(i.leftTalentPoint=e.readInt())},t.decodeToRoleTalentInfo=function(e){var t,i=0,n=0,s=e.readByte(),o=new kp;for(o.roleIndex=s,o.leftTalentPoint=e.readInt(),i=e.readShort(),n=0;n<i;n++)(t=new Object).id=e.readInt(),t.lv=e.readShort(),o.talent_Hash.put(t.id,t,!0);for(i=e.readByte(),n=0;n<i;n++)(t=new Object).type=e.readInt(),t.cost=e.readInt(),o.talentCost_hash.put(t.type,t.cost,!0);this.actorTalentData.put(s,o,!0)},t.decodeToTalentLevelUp=function(e){var t,i=e.readByte(),n=this.actorTalentData.take(i);if(n){n.leftTalentPoint=e.readInt();var s=e.readInt(),o=e.readInt(),a=e.readShort();(t=new Object).id=o,t.lv=a,t.isNew=n.talent_Hash.has(t.id),n.talent_Hash.put(t.id,t,!0);var r=this.getTypeBySkillIdAndLv(o,a);n.talentCost_hash.put(r.type,s,!0)}return t},t.updateTalent=function(){if(ao.count<=0){var e=[{url:_r.getDBPath("SkillInnateResource"),type:"arraybuffer"}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}else this.refreshTalentRedPoint()},t.getTypeBySkillIdAndLv=function(e,t){var i,n=0,s=0,o=0,a=0;for(n=0;n<ao.count;n++)s=ao.getIndex(n+1),o=ao.MODEL.skillInnateId(s),a=ao.MODEL.level(s),o==e&&a==t&&(i=this.createTalentVo(s));return i},t.createTalentVo=function(e){var t=null;return(t=new Rp).id=e,t.skillName=ao.MODEL.skillName(e),t.skillInnateId=ao.MODEL.skillInnateId(e),t.level=ao.MODEL.level(e),t.roleType=ao.MODEL.roleType(e),t.type=ao.MODEL.type(e),t.skillId_levelMap=ao.MODEL.skillId_levelMap(e),t.buffs=ao.MODEL.buffs(e),t.skillLevelConditionMap=ao.MODEL.skillLevelConditionMap(e),t.totalCostInnateCondition=ao.MODEL.totalCostInnateCondition(e),t.costInnate=ao.MODEL.costInnate(e),t.learnPlayerCostDefs=ao.MODEL.learnPlayerCostDefs(e),t.recycleInnate=ao.MODEL.recycleInnate(e),t.recycleRewardDefs=ao.MODEL.recycleRewardDefs(e),t.specialGrid=ao.MODEL.specialGrid(e),t.skillLevelOrCondition=ao.MODEL.skillLevelOrCondition(e),t},t.talentMapInit=function(e){var t=null;return 0<lo.count&&((t=new Cp).id=e,t.roleSkill_1=lo.MODEL.roleSkill_1(e),t.roleSkill_2=lo.MODEL.roleSkill_2(e),t.roleSkill_3=lo.MODEL.roleSkill_3(e),t.nextSkillIds=lo.MODEL.nextSkillIds(e)),t},t.getMaxLevelBySkillId=function(e){for(var t=0,i=0;i<ro.count;i++)if(ro.MODEL.skillID(i)==e){t=ro.MODEL.maxLevel(i);break}return t},t.getTalentNameByType=function(e){var t="";return 1==e?t=RP.n[66]:2==e&&(t=RP.n[67]),t},t.getSkillIdByCid=function(e){var t=ao.getIndex(e);return ao.MODEL.skillInnateId(t)},t.checkIsLearnNewSkill=function(e){var t=IH.ins.currentSelectedRole+1,i=(this.talentType,!1);this.actorTalentData.has(t)&&(i=!this.actorTalentData.take(t).talent_Hash.has(e));return i},t.reqTalentInfoByRoleIndex=function(e){var t=new FO;t.roleIndex=e,Tu.sendToService(t)},t.reqTalentUpByRoleIndex=function(e,t){var i=new qO;i.roleIndex=e,i.skillId=t,Tu.sendToService(i)},t.reqTalentReSetByRoleIndex=function(e,t,i){var n=new jO;n.roleIndex=e,n.talentType=t,n.resetType=i,Tu.sendToService(n)},t.getRedPointByRoleIndex=function(e,t){var i,n=[!1,!1,!1];for(var s=0 in this.talentRedPointHash.proto)if((i=this.talentRedPointHash.take(s)).role==e)if(t&&1==i.showRed)n[0]=!0,1==i.type&&(n[1]=!0),2==i.type&&(n[2]=!0);else if(1==i.showRed){n[0]=!0;break}return n},t.onLoad=function(e){if(G.loader.getRes(e.url)&&ao.count<=0){ao.setup(e.url);for(var t=ao.count,i=0;i<t;i++)ao.config(i)}G.loader.clearRes(e.url),this.refreshTalentRedPoint()},t.refreshTalentRedPoint=function(){var e=this;for(var t=0 in e.actorTalentData.proto){var i=e.actorTalentData.take(t);if(i){var n,s,o,a=0,r=0,l=0,c=0,u=0,d=gR.ins.actorList[t-1].job,h=!1;for(r=0;r<2;r++)for(a=0;a<lo.count;a++){var _,f=[];if(1==d?f=lo.MODEL.roleSkill_1(a):2==d?f=lo.MODEL.roleSkill_2(a):3==d&&(f=lo.MODEL.roleSkill_3(a)),l=f[r],c=ao.getIndex(l),u=ao.MODEL.skillInnateId(c),i.talent_Hash.has(u)){if(!((s=i.talent_Hash.take(u)).lv<e.getMaxLevelBySkillId(u))){n=e.getTypeBySkillIdAndLv(s.id,s.lv),h=!1,e.setTalentRedPointHash(n.skillInnateId,r+1,h,n,t);continue}n=e.getTypeBySkillIdAndLv(s.id,s.lv+1)}else n=e.getTypeBySkillIdAndLv(u,ao.MODEL.level(c));if(n.learnPlayerCostDefs&&(h=e.checkHasEnoughToolds(n.learnPlayerCostDefs)),h)if(i.leftTalentPoint>=n.costInnate){if(""!=n.skillLevelOrCondition&&(h=e.checkCondition(n,i)),h)if(n.skillLevelConditionMap)o=n.skillLevelConditionMap.split(","),h=!!i.talent_Hash.has(o[0])&&(_=e.getTypeBySkillIdAndLv(o[0],o[1]),i.talent_Hash.take(o[0]).lv>=_.level);else if(0<n.totalCostInnateCondition)if(i.talentCost_hash.has(r+1)){var p=i.talentCost_hash.take(r+1)+"";h=parseInt(p)>=n.totalCostInnateCondition}else h=!1}else h=!1;e.setTalentRedPointHash(n.skillInnateId,r+1,h,n,t)}}}},t.setTalentRedPointHash=function(e,t,i,n,s){var o=new Object;o.key=e,o.type=t,o.showRed=i,o.vo=n,o.role=s,this.talentRedPointHash.put(e,o,!0)},t.checkHasEnoughToolds=function(e){var t=!1,i=[];if(e){i=JSON.parse(e);for(var n=0;n<i.length;n++){var s=i[n].value.split(":")[0];if(!(t=i[n].value.split(":")[1]<=TR.ins.getGoodsNum(s)))break}}return t},t.checkCondition=function(e,t){for(var i=!1,n=e.skillLevelOrCondition.split(";"),s=[],o=0,a=0,r=0;r<n.length;r++)if(s=n[r].split(","),o=parseInt(s[0]),a=parseInt(s[1]),t.talent_Hash.has(o)){if(t.talent_Hash.take(o).lv>=a){i=!0;break}i=!1}return i},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e.MAX_ZANGJIE=2,e.TALENT_BOOK_TYPE=30,e._ins=null,f(e,["POINT",function(){return this.POINT=[{x:222,y:10},{x:7,y:190},{x:222,y:190},{x:440,y:190},{x:7,y:361},{x:222,y:361},{x:440,y:361},{x:222,y:539},{x:7,y:725},{x:222,y:725},{x:440,y:725},{x:7,y:907},{x:222,y:907},{x:440,y:907},{x:222,y:1089}]}]),e}(),oB=function(){function e(){this._info=null,this._curWearSkin=0,this._skillInfo=null,this.isFirstLogin=!0,this._wearTime=-3e3,this._talentInfo=null,this._skinModelInfo=null}b(e,"modules.soul.others.SoulSkinData");var t=e.prototype;return t.upateSkinInfo=function(e){if(e){if(this._info||this.initInfo(),e.soulSkinInfo)for(var t in e.soulSkinInfo)this._info[t]=e.soulSkinInfo[t];this._curWearSkin=e.curWearSkin}},t.initInfo=function(){this._info={};for(var e=0;e<Un.count;e++){var t=Un.MODEL.type(e);if(!this._info[t]){for(var i={},n=0;n<jn.count;n++){var s=jn.MODEL.type(e),o=jn.MODEL.position(e);jn.MODEL.buffId(e);t==s&&(i[o]||(i[o]={pos:o,level:0}))}this._info[t]={type:t,level:0,skills:i}}}},t.getCanOper=function(){return!0},t.getWearCanClick=function(){var e,t=pt.now();return(e=Math.ceil((3e3-(t-this._wearTime))/1e3))<=0&&(this._wearTime=t),e},t.getSkillFight=function(e){var t=0,i=this._info[e],n=i.level,s=i.skills,o=0;for(o=0;o<Gn.count;o++)if(Gn.MODEL.type(o)==e&&0<n){t=Gn.MODEL.fight(o);break}if(s&&s instanceof Array&&-1!=s.indexOf("undefined"))for(o=0;o<s.length;o++)if(1<s[o].level){var a=this.getTalentByPosLvl(e,s[o].pos,s[o].level),r=Ls.getIndex(a);t+=Ls.MODEL.fighting(r)}var l=this.skillInfo[e];if(l&&l instanceof Array&&-1!=l.indexOf("undefined"))for(o=0;o<l.length;o++){if(l[o]<=n){var c=Ls.getIndex(l[o].skillId);t+=Ls.MODEL.fighting(c)}}return t},t.initSkillInfo=function(){this._skillInfo={};for(var e=0;e<Fn.count;e++){var t=Fn.MODEL.type(e),i=Fn.MODEL.skill(e),n=Fn.MODEL.level(e),s=Fn.MODEL.simDesc(e);this._skillInfo[t]?this._skillInfo[t].push({type:t,skillId:i,lockLevel:n,desc:s}):this._skillInfo[t]=[{type:t,skillId:i,lockLevel:n,desc:s}]}},t.getStepByLevel=function(e,t){var i=t+"_"+e,n=Un.getIndex(i),s=Un.MODEL.step(n);return mp.getChineseNum(s)},t.getLevelByLevel=function(e,t){var i=t+"_"+e,n=Un.getIndex(i),s=Un.MODEL.step(n),o=Un.MODEL.star(n);return mp.getChineseNum(s)+"阶"+mp.getChineseNum(o)+"星"},t.getTalentSkillInfo=function(){return this.initTalentInfo(),this._talentInfo},t.initTalentInfo=function(){var e=this;e._talentInfo={};for(var t=0;t<jn.count;t++){var i=jn.MODEL.type(t),n=jn.MODEL.position(t),s=t,o=jn.MODEL.buffId(t);if(e._info&&e._info[i]&&e._info[i].skills&&e._info[i].skills[n]&&0!=e._info[i].skills[n].level)jn.MODEL.level(t)==e._info[i].skills[n].level&&(e._talentInfo[i]=[{type:i,pos:n,index:s,skillId:o}]);else e._talentInfo[i]||(e._talentInfo[i]=[{type:i,pos:n,index:s,skillId:o}])}},t.getTalentByPosLvl=function(e,t,i){for(var n=0;n<jn.count;n++){var s=jn.MODEL.type(n),o=jn.MODEL.position(n),a=jn.MODEL.level(n);if(s==e&&o==t&&a==i)return jn.MODEL.buffId(n)}return 0},t.getRedPointByType=function(e){var t=e+"_"+(this._info[e].level+1),i=Un.getIndex(t),n=!1;if(i||0==i){var s=Un.MODEL.consumeDef(i);if(s){var o=JSON.parse(s)[0].value.split(":"),a=parseInt(o[0]);n=parseInt(o[1])<=TR.ins.getGoodsNum(a)}}else n=!1;return this.getCanUpSkillByType(e)||n},t.getCanUpSkillByType=function(e){var t=!1,i=this._info[e].skills;for(var n in i){var s=i[n].level,o=e+"_"+i[n].pos+"_"+(s+1),a=jn.getIndex(o),r=jn.MODEL.consumeDef(a);if(r){var l=JSON.parse(r)[0].value.split(":"),c=parseInt(l[0]);t=parseInt(l[1])<=TR.ins.getGoodsNum(c)}}return t},t.getNameByType=function(e){for(var t=0;t<Gn.count;t++)if(e==Gn.MODEL.type(t))return Gn.MODEL.name(t);return""},t.getSkinModelByType=function(e){if(!this._skinModelInfo){var t=$e.getIndex(263),i=$e.MODEL.value(t);this._skinModelInfo=JSON.parse(i)[0]}return this._skinModelInfo[e]},p(0,t,"info",function(){return this._info||this.initInfo(),this._info}),p(0,t,"wearSkin",function(){return this._curWearSkin}),p(0,t,"skillInfo",function(){return this._skillInfo||this.initSkillInfo(),this._skillInfo}),p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e.openType=-1,e}(),aB=function(){function e(){this.activedRingId=0,this.activingRingId=0,this.activingRingChipArr=[],this.ringTaskArr=[]}b(e,"modules.specialgodring.other.SGRDateModel");var t=e.prototype;return t.getAtrrForRingId1=function(){var e=0,t=0,i=[];for(e=0;e<this.activedRingId;e++){var n=Qt.MODEL.fragments(e);i=i.concat(n.split(","))}for(e=0;e<i.length;e++){var s=PR.getGoodsNewAttr(parseInt(i[e]));t+=RR.getFight(s)}if(0!=this.activingRingId){var o=Qt.MODEL.fragments(this.activingRingId-1).split(","),a=0;for(e=0;e<this.activingRingChipArr.length;e++)1==this.activingRingChipArr[e]&&a++;for(e=0;e<o.length;e++)if(e<a){var r=Bi.getIndex(o[e]);t+=RR.getFight(JSON.parse(Bi.MODEL.attributes(r)))}}return t},t.getAtrrForRingId=function(){var e=0,t=[];for(e=0;e<this.activedRingId;e++){var i=Qt.MODEL.fragments(e);t=t.concat(i.split(","))}var n=[];for(e=0;e<t.length;e++){var s=PR.getGoodsNewAttr(parseInt(t[e]));n=n.concat(aa.formatNewAttrToChinese(s))}if(0!=this.activingRingId){var o=Qt.MODEL.fragments(this.activingRingId-1).split(","),a=0;for(e=0;e<this.activingRingChipArr.length;e++)1==this.activingRingChipArr[e]&&a++;for(e=0;e<o.length;e++)e<a&&(s=PR.getGoodsNewAttr(parseInt(o[e])),n=n.concat(aa.formatNewAttrToChinese(s)))}var r={hp:0,atk:0,def:0,mdef:0};for(e=0;e<n.length;e++)n[e].id==aa.MAXHP.id?r.hp+=parseInt(n[e].val):n[e].id==aa.ATK.id?r.atk+=parseInt(n[e].val):n[e].id==aa.DEF.id?r.def+=parseInt(n[e].val):n[e].id==aa.MDEF.id&&(r.mdef+=parseInt(n[e].val));return r},t.isActive=function(e){return this.activedRingId>=e},t.reqActiveRingChip=function(e){var t=new JA;t.chipid=e,Tu.sendToService(t)},t.reqActiveRing=function(){var e=new ZA;Tu.sendToService(e)},p(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p(1,e,"isActiveSoul",function(){return parseInt($e.MODEL.value($e.getIndex(158)))<=modules.specialgodring.other.SGRDateModel.instance.activedRingId}),e._instance=null,e}(),rB=function(){function i(){this._attrInfo=null,this._colorInfo=null}b(i,"modules.strength.others.FazhenAttrCache");var e=i.prototype;return e.updateAttr=function(e){this._attrInfo=e.attrInfo},e.getPlusByModule=function(e,t){if(!this._attrInfo)return 0;var i=this._attrInfo[t];if(!i)return 0;for(var n=0;n<i.length;n++)if(i[n].module==e)return parseInt(i[n].value)/1e4;return 0},e.initColorInfo=function(){var e=$e.getIndex(310),t=$e.MODEL.value(e);this._colorInfo=JSON.parse(t)},e.getColorByTV=function(e){this._colorInfo||this.initColorInfo();for(var t=0;t<this._colorInfo.length;t++)if(e.keyStr==this._colorInfo[t].type&&e.val>=this._colorInfo[t].min&&e.val<this._colorInfo[t].max)return this._colorInfo[t].color;return"#90877b"},p(1,i,"firstLogin",function(){return i._firstLogin&&modules.strength.others.FazhenAttrCache.checkFazhenOpen()}),p(1,i,"ins",function(){return i._ins||(i._ins=new i),i._ins}),i.haveActive=function(){for(var e=0;e<gR.ins.actorList.length;e++){if(0<modules.strength.others.FazhenData.ins.fazhenInfo[e+1][modules.strength.others.FazhenData.curShowFazhenVo.type].level)return!0}return!1},i.haveAnyActive=function(){for(var e=0;e<gR.ins.actorList.length;e++){var t=modules.strength.others.FazhenData.ins.fazhenInfo[e+1];for(var i in t){if(0<t[i].level)return!0}}return!1},i.checkFazhenOpen=function(){var e=$e.getIndex(311),t=$e.MODEL.value(e).split(",");return i.openServerDay=parseInt(t[0]),i.zsLevel=parseInt(t[1]),!(dr.getOpenServiceDay()<i.openServerDay)&&!(gR.ins.zsLv<i.zsLevel)},i._ins=null,i._firstLogin=!0,i.openServerDay=0,i.zsLevel=0,i}(),lB=function(){function e(){this.completeDic=new jo,this.removeDic=new jo,this.progressDic=new jo,this.todayDic=new jo,this.todayCompleteDic=new jo,this.tasktargetProgress=new jl}b(e,"modules.tasknew.others.TaskNewDataModel");var t=e.prototype;return t.updateTaskInfoByServer=function(e){var t=this;if(e){var i=e.updateList.length,n=0,s=null;for(n=0;n<i;n++)if(s=e.updateList[n],t.progressDic[s.questId]=s){var o=s.targetList[0],a=n_.getIndex(o.targetId),r=n_.MODEL.hasJob(a),l=n_.MODEL.flyTxtId(a),c=n_.MODEL.flyType(a);if(l){var u=t.tasktargetProgress.take(o.targetId);if(u&&u.currentRound==o.currentRound&&u.currentValue!=o.currentValue){var d=[];l&&0<l.length&&(d=l.split(","));var h=d[0];if(r)if(1==c){var _=gR.ins.getJobByIdx(iN.instance.taskRoleId);_&&(h=d[_-1]);var f=zB.ins.getDesc(parseInt(h));f&&G.timer.once(2e3,t,t.flyTxt,[f])}else if(2==c){h=l;var p=zB.ins.getDesc(parseInt(h));p&&zB.ins.playRainbowByWords(p,2e3)}}t.tasktargetProgress.put(o.targetId,{currentRound:o.currentRound,currentValue:o.currentValue},!0)}}n_.MODEL.value(a);var g=n_.MODEL.descr(a);for(var v in g&&0<g.length&&g.split(","),t.removeDic)delete t.removeDic[v];for(i=e.removeList.length,n=0;n<i;n++)null!=(s=t.progressDic[e.removeList[n]])&&(s=null,delete t.progressDic[e.removeList[n]]),t.removeDic[e.removeList[n]]=e.removeList[n];for(i=e.completeList.length,n=0;n<i;n++){var m=e.completeList[n];t.completeDic[m.questId]=m}for(i=e.todayCompList.length,n=0;n<i;n++){var y=e.todayCompList[n];t.todayCompleteDic[y.questId]=y}}},t.flyTxt=function(e){zB.ins.playNoticeMsg(e,!0,!0)},t.checkCompleteById=function(e){return null!=this.completeDic[e]},t.checkRemoveById=function(e){return null!=this.removeDic[e]},t.getTaskStatus=function(e){if(this.checkCompleteById(e))return Up.FINISHED;var t=this.progressDic[e];return t?0<t.phase?Up.CAN_COMMIT:Up.ON_PROCESS:Up.NO_ACCEPT},t.getTaskAsstInfo=function(e){return this.checkCompleteById(e)?this.completeDic[e]:this.progressDic[e]},t.getProGressDicTaskByType=function(e){var t;for(var i in this.progressDic)if((t=this.progressDic[i]).questType==e)return t;return null},t.getProGressGroupTaskByType=function(e){var t,i=[];for(var n in this.progressDic)(t=this.progressDic[n]).questType==e&&i.push(t);return i},t.gettodayCompListGroupTaskByType=function(e){var t,i=[];for(var n in this.todayCompleteDic)(t=this.todayCompleteDic[n]).questType==e&&i.push(t);return i},e.instance=function(){return null==e._instance&&(e._instance=new e),e._instance},e._instance=null,e}(),cB=function(){function e(){}return b(e,"modules.tasknew.others.TaskNewUtils"),e.taskLinkHandler=function(e){if(e){var t,i=e.split("|"),n=0,s=!1,o=parseInt(i[0]),a=6==o;if(1==o)hN.ins._closeLayout();else if(a){var r=parseInt(i[3]);if(!GR.getInstance().checkModuleOpen(r))return void zB.ins.showMsg(GR.getInstance().getErrorTips(r),1)}var l=parseInt(i[3]);if(!a&&gR.ins.lv<l)return void zB.ins.showMsg(RP.n[68],1);if("COPYMAINVIEW"==i[1]){if(!qR.ins.isOpenCopy)return void zB.ins.showMsg(RP.n[69],1)}else if("GUILD_MALL_MAINVIEW"==i[1]){if(!vN.ins.joinGuild)return void zB.ins.showMsg(RP.n[70],1);hN.ins.open("GUILD_MNG_MAINVIEW")}else if("GUILD_BOSS_MAINVIEW"==i[1]){if(!vN.ins.joinGuild)return void zB.ins.showMsg(RP.n[70],1);hN.ins.open("GUILD_BOSS_MAINVIEW")}else if("BOSS_MAINVIEW"==i[1]&&1==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[72],1);hN.ins.open("BOSS_MAINVIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&1==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[73],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&0==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[74],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&2==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[75],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&3==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[76],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("MALL_PANEL"==i[1]&&0==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[77],1);hN.ins.open("MALL_PANEL",{_subIndex_:parseInt(i[2])})}else if("TREASURE_VIEW"==i[1]&&2==parseInt(i[2])){var c=$e.MODEL.value($e.getIndex(155)).split(",");if(dr.getOpenServiceDay()<c[0]||gR.ins.zsLv<c[1])return void zB.ins.showMsg(RP.n[78],1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(i[2])})}else if("TREASURE_VIEW"==i[1]&&0==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[79],1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(i[2])})}else if("WELFARE"==i[1]&&1==parseInt(i[2])){if(!$N.ins.isOpen())return void zB.ins.showMsg(RP.n[80],1)}else if("SOARING_VIEW"==i[1]){var u=$e.MODEL.value($e.getIndex(207)),d=JSON.parse(u);if(d.level>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[81]+d.level+"级开启");if(d.flyLevel>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[82]+d.flyLevel+"级开启")}else if("ACHIEVE_NEW_MAIN_VIEW"==i[1]){if(!LN.isOpenAchieve)return void zB.ins.showById(4212,1)}else if("NewDailyActMainView"==i[1]);else if("OS_Purchase"==i[1]){if(!CN.getAIconOpen(47))return void zB.ins.playErrorMsg(RP.n[83]);JP.openIndex=parseInt(i[2]),CN.dealActIcon(CN.getIconBtn(47))}if(5==parseInt(i[0])){var h=i[4].split(","),_=parseInt(h[0]),f=parseInt(h[1]),p=dr.getOpenServiceDay();if(p<_||f<p)return void zB.ins.showMsg(RP.n[84]+_+"且<="+f+"开启",1);i[0]="2"}if("OS_TEHUI"==i[1])return 6<i.length&&(eU.targetId=parseInt(i[5])),eU.toSelectIndex=parseInt(i[2]),void CN.dealActIcon(CN.getIconBtn(46));if("OPENSERVER"==i[1])return eU.toSelectIndex=parseInt(i[2]),void CN.dealActIcon(CN.getIconBtn(12));if("VIPGIFT_VIEW"==i[1])Wg.openIndex=parseInt(i[2]);else if("FIRST_RECHARGE"==i[1]){if(null==HN.ins.toc_recharge)return;if(EB.showCharge)2==HN.ins.toc_recharge.canGet?hN.ins.open("EVERY_RECHARGE"):hN.ins.open("FIRST_RECHARGE")}}var g=i.join("|");a&&(g=g.replace(/[0-9]?|/,"2")),Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],g)},e}(),uB=function(){function e(){var e=this;e.groupId=0,e.msgList=null,e.longwenBless=0,e.chuanshiBless=0,e.equipbuyTip1=1,e.equipbuyTip10=1,e.longwenbuyTip1=1,e.longwenbuyTip10=1,e.chuanshibuyTip1=1,e.chuanshibuyTip10=1,e.mysticalTip1=1,e.mysticalTip10=1,e.hefuTip1=1,e.hefuTip10=1,e.TrasureCountArr=null,e.TrasureAwardArr=null,e.chuanshiCountTime=null,e.freeTimeHash=null,e.currentType=0,e.curActivityId=0,e.ExchangeDataArr=null}b(e,"modules.treasure.others.TreasureData");var t=e.prototype;return t.init=function(e,t){this.groupId=e,this.msgList=t},t.update=function(e){if(this.msgList){var t;for(var i in e)t=e[i],this.msgList.push(t);20<this.msgList.length&&this.msgList.splice(0,20-this.msgList.length)}else this.msgList=e},t.getExchangeData=function(){if(!this.ExchangeDataArr){var e;this.ExchangeDataArr=[];for(var t=0;t<xa.count;t++)if("DragonDesign"==xa.MODEL.type(t)){(e=new xg).exChangeId=xa.MODEL.key(t);var i=JSON.parse(xa.MODEL.consumption(t)),n=i[0].value.split(":");e.costId=n[0],e.costCount=parseInt(n[1]);var s=(i=JSON.parse(xa.MODEL.reward(t)))[0].value.split(":");e.targetId=parseInt(s[0]),this.ExchangeDataArr.push(e)}}return this.ExchangeDataArr},t.needFly=function(e){return!1},t.getShowArrByType=function(e){for(var t=[],i=Kp.count,n=0;n<i;n++)Kp.MODEL.type(n)==e&&t.push(n+1);return t},t.getGroup=function(e){var t=0,i=gR.ins.lv,n=gR.ins.zsLv,s=dr.getOpenServiceDay(),o=[],a=[];for(t=0;t<Yo.count;t++)if(e==Yo.MODEL.type(t)&&s>=Yo.MODEL.startDay(t)&&s<=Yo.MODEL.endDay(t)&&(o=Yo.MODEL.levelRange(t).split(","),a=Yo.MODEL.flyLevelRange(t).split(","),i>=parseInt(o[0])&&i<=parseInt(o[1])&&n>=parseInt(a[0])&&n<=parseInt(a[1])))return t;return 0},t.getDragonGroup=function(){var e=Lo.instance.currentLevel,t=0,i=[];for(t=0;t<Yo.count;t++)if((i=Yo.MODEL.TowerLevel(t).split(","))&&e>=parseInt(i[0])&&e<=parseInt(i[1]))return t;return 0},t.gethefuGroup=function(e){var t=0,i=gR.ins.lv,n=gR.ins.zsLv,s=dr.getComServiceDay(),o=[],a=[];for(t=0;t<Yo.count;t++)if(e==Yo.MODEL.type(t)&&2==Yo.MODEL.timeType(t)&&s>=Yo.MODEL.startDay(t)&&s<=Yo.MODEL.endDay(t)&&(o=Yo.MODEL.levelRange(t).split(","),a=Yo.MODEL.flyLevelRange(t).split(","),i>=parseInt(o[0])&&i<=parseInt(o[1])&&n>=parseInt(a[0])&&n<=parseInt(a[1])))return t;return 0},t.getShowTip=function(e,t){var i=this;switch(e){case 103:return 1==t?i.equipbuyTip1:i.equipbuyTip10;case 104:return 1==t?i.longwenbuyTip1:i.longwenbuyTip10;case 105:return 1==t?i.chuanshibuyTip1:i.chuanshibuyTip10;case 108:return 1==t?i.mysticalTip1:i.mysticalTip10;case 109:return 1==t?i.hefuTip1:i.hefuTip10}return 0},t.SetShowTip=function(e,t,i){var n=this;switch(e){case 103:1==t?n.equipbuyTip1=i:n.equipbuyTip10=i;break;case 104:1==t?n.longwenbuyTip1=i:n.longwenbuyTip10=i;break;case 105:1==t?n.chuanshibuyTip1=i:n.chuanshibuyTip10=i;break;case 108:1==t?n.mysticalTip1=i:n.mysticalTip10=i;break;case 109:1==t?n.hefuTip1=i:n.hefuTip10=i}return 0},t.getCountByType=function(e){if(this.TrasureCountArr)for(var t=0;t<this.TrasureCountArr.length;t++)if(this.TrasureCountArr[t].type==e)return this.TrasureCountArr[t].value;return 0},t.getChuanshiTime=function(){if(null==this.chuanshiCountTime||this.chuanshiCountTime.length<=0){this.chuanshiCountTime=[];for(var e=0;e<Kp.count;e++)105==Kp.MODEL.type(e)&&this.chuanshiCountTime.push(Kp.MODEL.times(e))}return this.chuanshiCountTime},t.getReqType=function(e,t,i){for(var n=0,s=0;s<Sa.count;s++)if(e==Sa.MODEL.position(s)&&t==Sa.MODEL.exploreNum(s)&&i==Sa.MODEL.consumptionType(s)){n=Sa.MODEL.key(s);break}return n},t.reqOne=function(e,t){void 0===t&&(t=0),this.currentType=e,this.curActivityId=t,Eg.reqOne(e,t)},p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e.getExploreIndex=function(e,t,i,n){void 0===i&&(i=1),void 0===n&&(n=108);for(var s=0;s<Sa.count;s++)if(Sa.MODEL.position(s)==n&&Sa.MODEL.activityId(s)==t&&Sa.MODEL.consumptionType(s)==e&&Sa.MODEL.exploreNum(s)==i)return s;return 0},e._ins=null,f(e,["treasureModel",function(){return this.treasureModel=new DR(55,55,"TR_GADD","TR_GUPDATE",["modules.treasure.TreasureModule"])},"equipModel",function(){return this.equipModel=new DR(103,103,"EQUIP_GUPDATE","EQUIP_GUPDATE",["modules.treasure.TreasureModule"])},"longwenModel",function(){return this.longwenModel=new DR(104,104,"LONGWEN_GUPDATE","LONGWEN_GUPDATE",["modules.treasure.TreasureModule"])},"chuanshiModel",function(){return this.chuanshiModel=new DR(105,105,"CHUANSHI_GUPDATE","CHUANSHI_GUPDATE",["modules.treasure.TreasureModule"])},"mysticalModel",function(){return this.mysticalModel=new DR(108,108,"MYSTICAL_GUPDATE","MYSTICAL_GUPDATE",["modules.treasure.TreasureModule"])},"hefuTrModel",function(){return this.hefuTrModel=new DR(109,109,"HEFU_GUPDATE","HEFU_GUPDATE",["modules.treasure.TreasureModule"])}]),e}(),dB=function(){function e(e){var t=this;t.wearId=0,t.force=NaN,t._idx=0,t._wsH=null,t._redPtH=null,t.useSoul=0,t.useWeaponSouls=[],t._idx=e,t._wsH=new jl,t._redPtH=new jl}b(e,"modules.weaponsoul.other.WeaponSoulActorVo");var t=e.prototype;return t.addWSState=function(e,t,i){void 0===i&&(i=!1),this._wsH.has(e)||this._wsH.put(e,new _B(e),!0);var n=this._wsH.take(e);n.actived=i,n.updateLvs(t),G.timer.callLater(this,this.updateRedPt)},t.updateLv=function(e,t,i){var n=this._wsH.take(e);n&&n.updateLv(t,i),G.timer.callLater(this,this.updateRedPt)},t.getWsVo=function(e){return this._wsH.take(e)},t.showTips=function(){for(var e in this._redPtH.proto)if(-1!=this._redPtH.proto[e].indexOf(1))return!0;return!1},t.wsShowTips=function(e){var t=this._redPtH.take(e);return!!t&&-1!=t.indexOf(1)},t.wsPartShowTips=function(e,t){return this._redPtH.take(e)[t-1]},t.updateRedPt=function(){var e,t={};for(var i in this._wsH.proto){var n;e=this._wsH.proto[i],this._redPtH.has(e.wsid)?n=this._redPtH.take(e.wsid):(n=[],this._redPtH.put(e.wsid,n)),!1;for(var s,o=0,a=0,r=0,l=0,c=0,u=0,d=0;d<e.totalPart;d++){u=e.getPartLv(d+1),o=hB.getWspId(e.wsid,d+1,u),a=go.getIndex(o);var h=go.MODEL.cost(a);h&&0<h.length?(r=(s=h.split(","))[0],l=s[1],t[r]?c=t[r]:(c=TR.ins.getGoodsNum(r),t[r]=c),n[d]=l<=c?1:0):n[d]=0}}},p(0,t,"idx",function(){return this._idx}),e}(),hB=function(){function n(){var e=this;e.needUpdate=0,e.curRole=-1,e.curWSId=0,e.curPart=0,e.init=!1,e._actorVos=[],e._iconDtoH=null,e.coreSelectId=-1,e.actorSelectIndex=0,e.cacheBytes=null,e.ws_Vec=new jl,e._iconDtoH=new jl}b(n,"modules.weaponsoul.other.WeaponSoulDM");var e=n.prototype;return e.checkData=function(e){this.init?this.updateInfo(e):this.cacheBytes=e},e.parseData=function(){this.cacheBytes&&0<this.cacheBytes.length&&this.updateInfo(this.cacheBytes)},e.updateInfo=function(e){this.init=!0;var t,i,n=e.readByte(),s=0,o=0,a=0,r=0,l=0,c=0,u=0;for(this._actorVos=[],s=0;s<n;s++){for(r=e.readByte(),i=new dB(r),(this._actorVos[r-1]=i).force=e.readInt(),i.wearId=e.readByte(),l=e.readByte(),o=0;o<l;o++){u=e.readByte();var d=e.readByte();for(c=e.readByte(),t=[],a=0;a<c;a++)t[a]=e.readShort();i.addWSState(u,t,1==d)}for(i.useSoul=e.readByte(),l=e.readByte(),o=i.useWeaponSouls.length=0;o<l;o++)i.useWeaponSouls.push(e.readByte())}Tu.sendToModule("UPDATE_DETAIL",["modules.strength.StrengthModule"]),AN.ins.getStateByBtnName("BTN_DZ")&&this.showTips(),this.cacheBytes&&(this.cacheBytes.clear(),this.cacheBytes=null)},e.getIconDto=function(e){if(this._iconDtoH.has(e))return this._iconDtoH.take(e);for(var t=po.getIndex(e),i=po.MODEL.iconId(t).split(","),n=[],s=0;s<i.length;s++)n[s]=yB.create(i[s]);return n},e.getNameByPost=function(e,t){var i=this.getIconDto(e);return Bi.MODEL.name(i[t-1].cfgIdx)},e.getVoByRole=function(e){return this._actorVos[e-1]},e.getWsVoByRole=function(e,t){return this._actorVos[e-1].getWsVo(t)},e.partIsTop=function(e,t,i){return 0==go.hasIndex(n.getWspId(e,t,i))},e.updateLv=function(e,t,i,n){this._actorVos[e-1].updateLv(t,i,n)},e.updateCoreAmount=function(e,t){var i=this._actorVos[e-1];i.useSoul=t,this._actorVos[e-1]=i},e.updateCoreList=function(e,t){var i=this._actorVos[e-1];i.useWeaponSouls=t,this._actorVos[e-1]=i},e.updateForce=function(e,t){this._actorVos[e-1].force=t},e.showTips=function(){if(!this._actorVos)return!1;if(AN.ins.getStateByBtnName("BTN_WEAPONSOUL_MAIN"))return!0;for(var e,t=this._actorVos.length,i=0;i<t;i++){if((e=this._actorVos[i])&&e.showTips())return!0;if(this.coreTotalRedPoint(e.idx))return!0}return!1},e.goodsUpdate=function(){if(this._actorVos)for(var e,t=this._actorVos.length,i=0;i<t;i++)(e=this._actorVos[i])&&e.updateRedPt()},e.coreTotalRedPoint=function(e){return!(!this.coreUseItemRedPoint(e)&&!this.coreUseWsRedPoint(e))},e.coreUseItemRedPoint=function(e){var t=this.coreCostId,i=0;t&&(i=TR.ins.getGoodsNum(t));var n=this._actorVos[e-1];return 0<i&&n.useSoul<this.coreCostMax},e.coreUseWsRedPoint=function(e){var t=this._actorVos[e-1];if(t&&0<t.useSoul&&t.useSoul>=t.useWeaponSouls.length){for(var i=po.count,n=0,s=0;s<i;s++){var o=po.MODEL.key(s),a=t.getWsVo(o);a&&a.actived&&n++}return n>t.useWeaponSouls.length}return!1},e.setImage=function(e,t){var i=G.loader.getRes(e.skin);null!=i?(i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.ws_Vec.put(t,e,!0)):e.on("loaded",this,this.onLoadedImage,[,[e,t]])},e.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),this.ws_Vec.put(t[1],t[0],!0)},p(0,e,"isOpen",function(){return 70<=gR.ins.lv&&0<=dr.getOpenServiceDay()}),p(0,e,"coreCostId",function(){return parseInt($e.MODEL.value($e.getIndex(76)))}),p(0,e,"coreCostMax",function(){return parseInt($e.MODEL.value($e.getIndex(79)))}),p(1,n,"ins",function(){return null==n._ins&&(n._ins=new n),n._ins}),n.getWspId=function(e,t,i){return e*(100*n.LVBLOCK)+t*n.LVBLOCK+i},n.OPEN_LV=70,n.OPEN_SERDAY=0,n.TOTAL_LV=9,n._ins=null,n.LVBLOCK=1e3,n.coreWsId=-1,n}(),_B=function(){function e(e){var t=this;t.wsid=0,t.skillId=0,t.actived=!1,t.skilllv=0,t.skillStep=0,t.isTop=!1,t.fitParts=0,t.nextfitParts=0,t.partLvs=null,t.minStep=0,t.totalPart=0,t.panelEffect=null,t.wsName=null,t.showUsed=!1,t.coreUsed=!1,t.effectIcon=null,t.step=0,t.wsid=e;var i=po.getIndex(e);t.skillId=po.MODEL.skillId(i);var n=po.MODEL.effectCondition(i);t.skillStep=Math.floor((n+10)/10),t.totalPart=po.MODEL.posNum(i),t.panelEffect=po.MODEL.panelEffect(i),t.wsName=po.MODEL.name(i),t.effectIcon=po.MODEL.effectIcon(i)}b(e,"modules.weaponsoul.other.WeaponSoulVo");var t=e.prototype;return t.updateLvs=function(e){this.partLvs=e,this.update()},t.updateLv=function(e,t){this.partLvs[e-1]=t,this.update()},t.getPartLv=function(e){return this.partLvs[e-1]},t.getTips=function(e){for(var t,i=RP.n[85]+Ql.createColor(Math.floor((e+10)/10)+"","#23b11f")+RP.n[86],n=hB.ins.getIconDto(this.wsid),s=0;s<this.partLvs.length;s++)t=this.partLvs[s]>=e?"#a19980":"#696969",i+=Ql.createColor(Bi.MODEL.name(n[s].cfgIdx),t),i+=s==.5*this.totalPart-1?"<br>":s==this.totalPart-1?"":"&nbsp;&nbsp;";return i},t.update=function(){var e=this,t=po.getIndex(e.wsid),i=e.partLvs[0];e.fitParts=0;for(var n=1;n<e.partLvs.length;n++)i>e.partLvs[n]&&(i=e.partLvs[n]);if(e.minStep=i,e.step=Math.floor(e.minStep/10),!e.actived){var s=po.MODEL.effectCondition(t);for(n=0;n<e.partLvs.length;n++)s<=e.partLvs[n]&&(e.fitParts+=1)}if(e.actived){var o=1,a=0;for(e.isTop=!0;fo.hasIndex(100*e.skillId+o);){if(a=fo.getIndex(100*e.skillId+o),i<fo.MODEL.conditions(a)){e.skilllv=o-1,e.isTop=!1;break}o++}if(e.isTop)e.skilllv=o-1;else{var r=fo.getIndex(100*e.skillId+e.skilllv+1),l=fo.MODEL.conditions(r);for(n=e.nextfitParts=0;n<e.partLvs.length;n++)l<=e.partLvs[n]&&(e.nextfitParts+=1)}}},e}(),fB=function(){function e(){var e=this;e.day=0,e.round=0,e.signKeys=[],e.totalKeys=[],e.totalDats=0,e.isBuyFund=0,e.fundRewardArr=[],e.forRed=!1,e.packetNum=0,e.packetType=0,e.isPacketOpen=!1,e.packets30491=[],e.packetIconNum=0,e.packetUUID=""}b(e,"modules.welfare.others.WelfareData");var t=e.prototype;return t.init=function(e){this.day=e.day,this.round=e.round,this.signKeys=e.signKeys,this.totalKeys=e.totalKeys,this.totalDats=e.totalDay},t.isSignin=function(e){return!!this.signKeys&&0<=this.signKeys.indexOf(e)},t.isTotal=function(e){return!!this.totalKeys&&0<=this.totalKeys.indexOf(e)},t.canSignAward=function(){if(this.signKeys.length<this.day)return!0;for(var e=0;e<Hn.count;e++){var t=(this.round,Hn.MODEL.firstDayTimes(e));if(!(this.signKeys.length>=t))return!1;if(!this.isTotal(Hn.MODEL.key(e)))return!0}return!1},p(0,t,"isDailyReturnAble",function(){var e=mB.getInStance().getActivityData(1004);if(e)for(var t in e.gifts)if(1==e.gifts[t].status)return!0;return!1}),p(0,t,"isDailyReturn",function(){return mB.getInStance().getActivityData(1004)instanceof protos.activity.ActivityInfo}),p(0,t,"isTqMonthCard",function(){var e=hg.ins.datas22352;return e.receiveTime<=0&&0<e.leftTime}),p(1,e,"ins",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),pB=function(){function f(){}b(f,"modules.xinfa.others.XinfaDataModel");var e=f.prototype;return e.getXinfaIsGray=function(e,t){var i=f._xinfaDataHash.take(e).infos,n=[],s=0;for(s=0;s<i.length;s++)if(i[s].xinfa==t){n=i[s].books;break}if(0<n.length)for(s=0;s<n.length;s++)if(n[s].quality<2)return!0;return!1},e.getIsMaxLev=function(e){return 10<=pv.MODEL.level(e)},e.getIsMaxStep=function(e){var t=JSON.parse(pv.MODEL.consumeption(e));return parseInt(t[0].value.toString().split(":")[1])<0},e.getCurIndex=function(e,t,i){for(var n=0;n<pv.count;n++)if(pv.MODEL.level(n)==t&&pv.MODEL.tier(n)==e&&pv.MODEL.type(n)==i)return n;return-1},e.sortByXinfa=function(e,t){return t.xinfa-e.xinfa},e.getXinfaRedFP=function(e){var t=f._xinfaDataHash.take(e);if(!t)return!1;var i=t.infos,n=0;for(i.sort(this.sortByXinfa),n=0;n<i.length;n++){var s=this.getCurIndex(i[n].steps,i[n].level,i[n].xinfa);if(-1!=s){var o=JSON.parse(pv.MODEL.consumeption(s)),a=parseInt(o[0].value.toString().split(":")[0]),r=parseInt(o[0].value.toString().split(":")[1]);if(r<0);else{if(10==i[n].level)return!0;if(TR.ins.getGoodsNum(a)>=r)return!0}for(var l=i[n].books,c=0;c<l.length;c++)if(this.getCanOperBookByPos(e,l[c].pos,i[n].xinfa))return!0}}return!1},e.getXinfaBookStarNum=function(e){return e<=2?3:5},e.getBookInfoByPos=function(e,t,i){if(!f._xinfaDataHash)return null;var n=f._xinfaDataHash.take(t).infos,s=0;for(s=0;s<n.length;s++)if(n[s].xinfa==i){n=n[s].books;break}for(s=0;s<n.length;s++)if(n[s].pos==e)return n[s];return null},e.getCIndexByInfo=function(e){for(var t=0;t<hv.count;t++)if(hv.MODEL.position(t)==e.pos&&hv.MODEL.level(t)==e.level&&hv.MODEL.quality(t)==e.quality)return t;return-1},e.getCIndexByGoodId=function(e){for(var t=0;t<hv.count;t++)if(hv.MODEL.goodsId(t)==e)return t;return-1},e.getCanOperBookByPos=function(e,t,i){var n=f._xinfaDataHash.take(e).infos,s=0;for(s=0;s<n.length;s++)if(n[s].xinfa==i)for(var o=n[s].books,a=0;a<o.length;a++)if(o[a].pos==t)for(var r=this.getBooksHaveByPos(t),l=0;l<r.length;l++)if(r[l].quality>o[a].quality||r[l].quality==o[a].quality&&(o[a].level<this.getXinfaBookStarNum(r[l].quality)&&0==r[l].level||o[a].level<r[l].level))return!0;return!1},e.getBooksHaveByPos=function(e){var t={},i=0;for(i=0;i<hv.count;i++){var n=hv.MODEL.goodsId(i),s=TR.ins.getGoodsNum(n);0<s&&(t[n]||(t[n]={pos:hv.MODEL.position(i),quality:hv.MODEL.quality(i),num:s,level:hv.MODEL.level(i)}))}var o,a=[];for(var r in t)(o=t[r]).pos==e&&a.push(o);return a},e.getBookCanUpStar=function(e,t){var i=0;for(i=0;i<hv.count;i++){var n=hv.MODEL.goodsId(i);if(0<TR.ins.getGoodsNum(n)&&hv.MODEL.position(i)==e&&hv.MODEL.quality(i)==t&&0==hv.MODEL.level(i))return!0}return!1},e.getBookCanReplace=function(){return!1},e.getLowQuality=function(e){for(var t={},i=1;i<=3;i++){var n=f._xinfaDataHash.take(i);if(n)for(var s=n.infos,o=0;o<s.length;o++)if(s[o].xinfa==e)for(var a=s[o].books,r=0;r<a.length;r++)t[a[r].pos]?t[a[r].pos].quality>a[r].quality&&(t[a[r].pos].quality=a[r].quality,t[a[r].pos].level=a[r].level):t[a[r].pos]={pos:a[r].pos,quality:a[r].quality,level:a[r].level}}return t},e.getCanResoBooksByXAQ=function(e){var t=this.getLowQuality(e),i={},n=0;for(n=0;n<hv.count;n++)if(hv.MODEL.type(n)==e){var s=hv.MODEL.position(n);if(hv.MODEL.quality(n)<t[s].quality||hv.MODEL.quality(n)==t[s].quality&&t[s].level>=this.getXinfaBookStarNum(t[s].quality)){var o=hv.MODEL.goodsId(n),a=TR.ins.getGoodsNum(o);0<a&&(i[o]||(i[o]={id:n+1,pos:hv.MODEL.position(n),quality:hv.MODEL.quality(n),num:a,goodsId:o,pos:s}))}}var r,l=[];for(var c in i){var u=(r=i[c]).num;for(r.num=1,n=0;n<u;n++)l.push(r)}return l.sort(this.sortOfDispose),16<l.length&&(l.length=16),l},e.sortOfDispose=function(e,t){return e.quality!=t.quality?t.quality-e.quality:e.pos!=t.pos?e.pos-t.pos:t.level-e.level},e.getBookGoodIdByPQL=function(e,t,i){var n=0,s=-1;for(n=0;n<hv.count;n++)if(hv.MODEL.level(n)==i&&hv.MODEL.quality(n)==t&&hv.MODEL.position(n)==e){s=n;break}return-1<s?hv.MODEL.goodsId(s):0},e.getModelByBooks=function(e,t){var i=f._xinfaDataHash.take(e).infos,n=0,s=[],o="";for(n=0;n<i.length;n++)if(i[n].xinfa==t){s=i[n].books;break}if(s.length){s.sort(this.sortByQuality);var a=s[0].quality;for(0==a&&(a=2),n=0;n<yv.count;n++)yv.MODEL.quality(n)==a&&yv.MODEL.type(n)==t&&(o="jm"+yv.MODEL.jmId(n))}return o},e.getSkillIdByXinfaActor=function(e,t){var i=f._xinfaDataHash.take(e).infos,n=0,s=[],o=0,a=0,r=[],l="",c="",u=0,d=0;for(n=0;n<i.length;n++)if(i[n].xinfa==t){s=i[n].books;break}if(s.length){s.sort(this.sortByQuality);var h=s[0].quality,_=0;for(_=0==h?h+2:h+1,n=0;n<yv.count;n++)yv.MODEL.quality(n)==h&&yv.MODEL.type(n)==t&&(o=yv.MODEL.skillIds(n),l=yv.MODEL.demandTxt(n)),yv.MODEL.quality(n)==_&&yv.MODEL.type(n)==t&&(a=yv.MODEL.skillIds(n),c=yv.MODEL.demandTxt(n))}for(n=0;n<s.length;n++)s[n].quality>=h&&u++,s[n].quality>=_&&d++;return r.push({skillId:o,bookNum:u,need:l,quality:h}),r.push({skillId:a,bookNum:d,need:c,quality:_}),r},e.sortByQuality=function(e,t){return e.quality-t.quality},e.sortOn=function(e,t){return t.xinfa-e.xinfa},e.getFightNumByActor=function(e){var t,i=0,n=e-1,s=(gR.ins.actorList[n],modules.xinfa.others.XinfaDataModel._xinfaDataHash.take(e).infos),o=0;for(s.sort(this.sortOn),o=0;o<s.length;o++)0==s[o].steps&&0==s[o].level||(0<s[o].steps||0<s[o].level)&&(t=s[o]);if(!t)return 0;var a=modules.xinfa.others.XinfaDataModel.ins.getCurIndex(t.steps,t.level,t.xinfa),r=pv.MODEL.attrs(a);i+=pv.MODEL.extrafight(a);var l=t.books,c=[],u=[];for(c.push(r),o=0;o<l.length;o++){var d=modules.xinfa.others.XinfaDataModel.ins.getCIndexByInfo(l[o]);-1<d&&(u.push(hv.MODEL.attrs(d)),i+=hv.MODEL.extrafight(d))}var h=rB.ins.getPlusByModule("XINFA",e);for(o=0;o<c.length;o++)"string"==typeof c[o]&&5<c[o].length&&(i+=RR.getFight(JSON.parse(c[o]))*(1+h));for(o=0;o<u.length;o++)"string"==typeof u[o]&&5<u[o].length&&(i+=RR.getFight(JSON.parse(u[o])));return Math.floor(i)},e.reqInfo=function(){var e=new TD;Tu.sendToService(e)},e.reqUpgrade=function(e,t){var i=new CD;i._operType=2,i._actorId=e,i._xinfa=t,Tu.sendToService(i)},e.reqBooksUp=function(e,t,i,n,s){var o=new LD;o.actorId=e,o.type=t,o.quality=i,o.pos=n,o.xinfa=s,Tu.sendToService(o)},e.reqDisposeBook=function(e){var t=new MD;t.arr=e,Tu.sendToService(t)},e.destroyAll=function(){},p(1,f,"ins",function(){return f._ins||(f._ins=new f),f._ins}),f.XINFA_BOOK_UP="XINFA_BOOK_UP",f.XINFA_BOOK_DISPOSE="XINFA_BOOK_DISPOSE",f.XINFA_RULES_PANEL="XINFA_RULES_PANEL",f.XINFA_SKILL_PANEL="XINFA_SKILL_PANEL",f.XINFA_ATTR_PANEL="XINFA_ATTR_PANEL",f.XINFA_MIJI_PANEL="XINFA_MIJI_PANEL",f.roleIndex=0,f._xinfaDataHash=null,f._ins=null,f.isUp=!1,f.isStep=!1,f}(),gB=function(){function e(){var e=this;e.changeCampTime=0,e.openTime=0,e.curRank=null,e.rankData=null,e.endTime=0,e.restTime=NaN,e.getRewards=null,e.monsterL=null,e.playerL=null,e.isRss=!0,e.pushTips=!1,e._uiShow=!1,e._defaultRank=null,e._rankList=null,e._defaultRank=new JG}b(e,"modules.yzbqc.other.YzbqcData");var t=e.prototype;return t.isIn=function(){return uH.Ins().currCid==_a.S_YeZhanBIQI.toString()},t.needShowTips=function(){return MN.isNormalShow&&this.pushTips},t.changeUI=function(e){this._uiShow!=e&&(e?(hN.ins.close("YZBQC_ENTER"),hN.ins.open("YZBQC_MAIN"),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.YZBQC)):(Tu.sendToModule("YZBQ_END",["modules.scene.SceneModule"]),hN.ins.close("YZBQC_MAIN")),this._uiShow=e)},t.updateHp=function(e,t,i){if(this.playerL)for(var n,s=0;s<this.playerL.length;s++)(n=this.playerL[s]).id==e&&(n.curHp=t,n.maxHp=i)},t.reqExit=function(e){KQ.ins.show(RP.n[87],e,!1,3)},t.getNextRank=function(){var e,t=this;if(!t._rankList){t._rankList=[];for(var i=0;i<Eo.count;i++)(e=Eo.MODEL.range(i).split(","))[0]=parseInt(e[0]),e[1]=parseInt(e[1]),t._rankList[i]=e}for(var n=t._rankList.length-1;0<=n;n--)if((e=t._rankList[n])[0]<=t.curRank.myRank&&e[1]>=t.curRank.myRank)return 0==n?1:t._rankList[n-1][1];return t._rankList[t._rankList.length-1][1]},p(0,t,"isOpen",function(){return dr.serverTimeSec>=this.openTime&&0!=this.openTime}),p(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e}(),vB=function(){function e(){this.type=0,this.acId=0,this.currentNum=0,this.status=0}b(e,"protos.achieve.DailyTaskVo");var t=e.prototype;return t.decode=function(e,t){void 0===t&&(t=!0),this.acId=e.readInt(),t&&(this.type=e.readByte()),this.currentNum=e.readShort(),this.status=e.readByte()},t.isShowTip=function(e){var t=$t.getIndex(this.acId),i=$t.MODEL.redTime(t),n=$t.MODEL.iconId(t),s=$t.MODEL.redId(t),o=$t.MODEL.priority(t);if(2==this.status)return 1;if(0<i&&0<o)if(0<n){if(CN.checkHasRed(n)&&this.currentNum<i)return 2}else if(0<s){if(e&&this.currentNum<i)return 2}else if(this.currentNum<i)return 2;return 0},e}(),mB=function(){function e(){this.giftType=0,this.currentValue=0,this.m_Hash=new jl,this.m_ActHash=new jl}b(e,"protos.activity.ActivityModel");var t=e.prototype;return t.setMainType=function(e){var t=!1,i=this.m_Hash.take(e.mainType);if(i){if(i.activityIds.length!=e.activityIds.length)t=!0;else for(var n=0;n<i.activityIds.length;++n)if(e.activityIds[n]!=i.activityIds[n]){t=!0;break}t&&(this.m_Hash.remove(e.mainType),i=null)}return this.m_Hash.put(e.mainType,e,!0),t},t.setExchagneRedPt=function(e){if(e){var t=this.m_Hash.take(e.mType);t&&(-1<t.fActivityIds.indexOf(e.activityId)?e.redPt||t.fActivityIds.splice(t.fActivityIds.indexOf(e.activityId),1):e.redPt&&t.fActivityIds.push(e.activityId))}},t.setActivityData=function(e){this.m_ActHash.put(e.activityId,e,!0)},t.getMainType=function(e){return this.m_Hash.take(e)},t.getActivityData=function(e){return this.m_ActHash?this.m_ActHash.take(e):null},t.updateGiftVo=function(e){var t=e.gift;if(this.m_ActHash&&t&&t.owerActivity){var i=this.m_ActHash.take(t.owerActivity);i&&i.updateGift(t)}},t.updateLimiteGiftVo=function(e){var t=e.gift;if(this.m_ActHash){var i=this.m_ActHash.take(t.owerActivity);i&&i.updateGift(t)}},t.updateGiftValue=function(e){this.currentValue=e.currentValue,this.giftType=e.giftType},t.updateSevenKH=function(e){if(this.m_ActHash){var t=this.m_ActHash.take(e.owerActivity);t&&t.updateGift(e)}},t.getActiveDescPath=function(e){var t="",i=this.getActivityData(e);return i&&(t=_r.getOsNewPath("title/font_desc_"+i.mainType)),t},e.getInStance=function(){return null==e.m_Instance&&(e.m_Instance=new e),e.m_Instance},e.m_Instance=null,e}(),yB=function(){function a(){var e=this;e.uuId=0,e.position=0,e.goodsId=0,e.goodsNum=0,e.expTime=0,e.roleId=0,e.changeNum=0,e.cfgIdx=-1,e.canUse=!1,e.usedCountDay=0,e.isOther=!1,e.disAchi=!0,e.needGetWay=!0,e.buffs=null,e.moEquipScore=0,e._baseF=0,e._baseId=0}b(a,"protos.backpack.DtoGoods");var e=a.prototype;return e.decode=function(e,t){this.goodsNum=yt.readBit(t,1,31),this.goodsId=e.readInt(),this.uuId=e.readInt(),this.position=e.readShort(),this.canUse=e.readBoolean(),this.cfgIdx=Bi.getIndex(this.goodsId)},e.setGoodsId=function(e){this.goodsId=e,this.cfgIdx=Bi.getIndex(e)},e.recover=function(){this.reset(),-1==a._instancePool_.indexOf(this)&&a._instancePool_.push(this)},e.reset=function(){var e=this;e.uuId=e.position=e.goodsId=e.goodsNum=e.expTime=e.roleId=e.changeNum=e.moEquipScore=0,e.isOther=e.canUse=!1,e.disAchi=!0,e.cfgIdx=-1,e.buffs=null},e.getGoodScore=function(){if(0<this.goodsId&&this._baseId!=this.goodsId){this._baseId=this.goodsId;var e=PR.getGoodsNewAttr(this._baseId);this._baseF=RR.calScoreValue(e,0)}return this._baseF},p(0,e,"useLevel",function(){return Bi.MODEL.minUseLevel(this.cfgIdx)}),p(0,e,"isFashionProp",function(){return 0<Bi.MODEL.fashion(this.cfgIdx)}),p(0,e,"name",function(){return Bi.MODEL.name(this.cfgIdx)}),p(0,e,"simpleName",function(){return Bi.MODEL.simpleName(this.cfgIdx)}),p(0,e,"equipType",function(){return Bi.MODEL.equipType(this.cfgIdx)}),p(0,e,"subType",function(){return Bi.MODEL.subType(this.cfgIdx)}),p(0,e,"roleJob",function(){return Bi.MODEL.roleTypeId(this.cfgIdx)}),p(0,e,"flyLevel",function(){return Bi.MODEL.flyLevel(this.cfgIdx)}),p(0,e,"decoratePosition",function(){return Bi.MODEL.decoratePosition(this.cfgIdx)}),p(0,e,"attribles",function(){return Bi.MODEL.attributes(this.cfgIdx)}),p(0,e,"colourId",function(){return Bi.MODEL.colourId(this.cfgIdx)}),p(0,e,"flyupLevel",function(){return Bi.MODEL.flyUpLevel(this.cfgIdx)}),p(0,e,"defaultUseMax",function(){return Bi.MODEL.defaultUseMax(this.cfgIdx)}),p(0,e,"moBreakReward",function(){return Bi.MODEL.reward(this.cfgIdx)}),p(0,e,"flyUpJewelryLevel",function(){return Bi.MODEL.flyUpJewelryLevel(this.cfgIdx)}),a.create=function(e,t){void 0===t&&(t=1),e|=0,t|=0;var i,n=Bi.getIndex(e);return 2==Bi.MODEL.type(n)?KH.create(e,t):((i=0<a._instancePool_.length?a._instancePool_.pop():new a).setGoodsId(e),i.goodsNum=t,i)},a.createStr=function(e){var t,i=yh.getObj(e)[0].value.split(":"),n=aR.getBykey(i[0]),s=0,o=0;return o=(s=n?n.itemId:parseInt(i[0]),parseInt(i[1])),(t=0<a._instancePool_.length?a._instancePool_.pop():new a).setGoodsId(s),t.goodsNum=o,t},a.createStrArr=function(e,t){void 0===t&&(t=!1);var i,n,s,o,a,r,l=yh.getObj(e),c="",u=0,d=0;o=[],a={};var h=0,_=0;for(h=0;h<l.length;h++)c+=l[h].value+";";for(s=c.split(";"),_=0;_<s.length&&0!=s[_].length;_++)r=s[_].split(":"),d=(i=aR.getBykey(r[0]))?(u=i.itemId,r[1]):(u=parseInt(r[0]),parseInt(r[1])),u&&(!(n=a[u])||t?(n=protos.backpack.DtoGoods.create(u,d),o.push(n),a[u]=n):n.goodsNum+=d);return[].concat(o)},a.createCombine=function(e,t){var i,n,s,o,a,r,l=yh.getObj(e),c="",u=0,d=0;o=[],a={};var h=0,_=0;for(h=0;h<l.length;h++)c+=l[h].value+";";for(s=c.split(";"),_=0;_<s.length&&0!=s[_].length;_++)r=s[_].split(":"),d=(i=aR.getBykey(r[0]))?(u=i.itemId,r[1]):(u=parseInt(r[0]),parseInt(r[1])),u&&((n=a[u])?n.goodsNum+=d:(n=protos.backpack.DtoGoods.create(u,d),o.push(n),a[u]=n));for(c="",l=yh.getObj(t),h=0;h<l.length;h++)c+=l[h].value+";";for(s=c.split(";"),_=0;_<s.length&&0!=s[_].length;_++)r=s[_].split(":"),d=(i=aR.getBykey(r[0]))?(u=i.itemId,r[1]):(u=parseInt(r[0]),parseInt(r[1])),u&&((n=a[u])?n.goodsNum+=d:(n=protos.backpack.DtoGoods.create(u,d),o.push(n),a[u]=n));return[].concat(o)},a._instancePool_=[],a}(),IB=function(){function v(){}return b(v,"protos.db.CGKModel"),p(1,v,"MODEL",function(){return null==protos.db.CGKModel._intance_&&(protos.db.CGKModel._intance_=new v),protos.db.CGKModel._intance_}),v.takeNPCDto=function(e){return v.npcHash.take(e)},v.setup=function(e){protos.db.CGKModel.hash=new jl,protos.db.CGKModel.buff=G.loader.getRes(e),protos.db.CGKModel.bytes=new mt(v.buff);var t=v.bytes.readInt();protos.db.CGKModel.count=t},v.config=function(e){for(var t=v.bytes.readInt(),i=v.bytes.readInt(),n=v.bytes.readShort(),s=[],o=[],a=0;a<n;a++){for(var r=v.bytes.readShort(),l=[],c=0;c<r;c++){var u=v.bytes.readUTF(),d=v.bytes.readUTF();-1==s.indexOf(d)&&(s.push(d),"mid_"+d+","),parseInt(u);var h=v.bytes.readShort(),_=v.bytes.readShort(),f=v.bytes.readShort(),p=new ia;p.avatarId=d,p.modelId=u,p.sid=i,p.cid=t,p.x=h,p.y=_,p.dir=f;var g=PB.pixelsToTile(h,_);p.tileX=g.x,p.tileY=g.y,l.push(p),-1!=p.avatarId.indexOf("npc")&&v.npcHash.put(p.modelId,p)}o.push(l)}protos.db.CGKModel.hash.put(t.toString(),{cid:t,arr:o,scene_id:i})},v.hash=null,v._intance_=null,v.c_gkScene=[],v.count=0,v.buff=null,v.bytes=null,f(v,["npcHash",function(){return this.npcHash=new jl}]),v}(),bB=function(){function i(){this.playerId=null,this.playerName=null,this.fightValue=NaN,this.guildName=null,this.mimeLeftTimes=0,this.mimeQuality=0,this.canRob=!1}return b(i,"protos.digger.MimePlayerVo"),i.prototype.getLeftTime=function(){return this.mimeLeftTimes-Math.floor((dr.curServerTime-JR.instance._recordTime22204)/1e3)},i.createVo=function(e){var t=new i;return t.playerId=yt.readLong64(e).toString(),t.playerName=e.readUTF(),t.fightValue=yt.readLong64(e),t.guildName=e.readUTF(),t.mimeLeftTimes=e.readInt(),t.mimeQuality=e.readByte(),t.canRob=e.readByte(),t},i}(),wB=function(){function e(e,t,i){this.type=0,this.level=0,this.jobId=0,this.type=e,this.level=t,this.jobId=i}b(e,"protos.ringclassic.DtoActorRingData");var t=e.prototype;return t.fightValue=function(e){void 0===e&&(e=-1);var t=this.attrs;return null==t?-1:RR.getFight(t,e)},p(0,t,"configIndex",function(){return protos.ringclassic.DtoActorRingData.getConfigIndex(this.type,this.level,this.jobId)}),p(0,t,"consumptions",function(){var e=this.configIndex;if(-1==e)return null;var t=ps.MODEL.consumptions(e);return""==t||null==t?null:JSON.parse(t)}),p(0,t,"nextConfigIndex",function(){for(var e=ps.count,t=0;t<e;t++){var i=ps.MODEL.type(t),n=ps.MODEL.level(t);if(i==this.type&&n==this.level+1)return t}return-1}),p(0,t,"isAbleGrow",function(){var e=this.consumptions;if(null==e)return!1;var t=!0;for(var i in e){var n=e[i];if("goods"==n.type){var s=n.value,o=s.split(":")[0],a=s.split(":")[1];TR.ins.getGoodsNum(o)<a&&(t=!1)}}return t}),p(0,t,"attrs",function(){var e=this.configIndex;if(-1==e)return null;var t=ps.MODEL.attrs(e);return""==t||null==t?null:JSON.parse(t)}),p(0,t,"nextAttrs",function(){var e=this.nextConfigIndex;if(-1==e)return null;var t=ps.MODEL.attrs(e);return""==t||null==t?null:aa.formatAttrToChineseByList(t)}),p(0,t,"chineseAttrs",function(){var e=this.configIndex;if(-1==e)return null;var t=ps.MODEL.attrs(e);return""==t||null==t?null:aa.formatAttrToChineseByList(t)}),p(0,t,"buffIds",function(){var e=this.configIndex;if(-1!=e){var t=ps.MODEL.buffIds(e);if(""!=t&&null!=t)return JSON.parse(t)}return null}),e.getConfigIndex=function(e,t,i){for(var n=ps.count,s=0;s<n;s++){var o=ps.MODEL.type(s),a=ps.MODEL.level(s);if(e==o&&t==a)return s}return-1},e}(),xB=function(){function i(){this.serverVo=null,this.m_taskContant=null,this.m_taskReward=null,this.m_GoodsReward=null,this.m_NewGuides=null,this.DirectionEvent=0,this.m_GuideId=0,this.needZhanBao=!1}b(i,"protos.task.TaskInfo");var e=i.prototype;return e.setServer=function(e){this.key!=e.taskKey&&this.clear(),this.serverVo&&(this.serverVo.dispose(),this.serverVo=null),this.serverVo=e},e.clear=function(){var e=this;e.m_taskContant&&(e.m_taskContant.length=0,e.m_taskContant=null),e.m_GoodsReward&&(e.m_GoodsReward.length=0,e.m_GoodsReward=null),e.m_NewGuides&&(e.m_NewGuides.length=0,e.m_NewGuides=null),e.m_taskReward=null},e.getCurrentGuide=function(e){if(2==this.status&&this.taskEvent&&0<this.taskEvent.length){var t=this.taskEvent.indexOf(e+"");if(LY.showing){var i=LY.Ins().currGuideId;if(t<this.taskEvent.indexOf(i+""))return 0}if(-1!=t){var n=this.taskEvent[t];return this.m_GuideId=parseInt(n),this.m_GuideId}}return 0},e.clearGuide=function(){this.m_GuideId=0},e.getProTxt=function(){return this.taskingName},p(0,e,"key",function(){return this.serverVo?this.serverVo.taskKey:0}),p(0,e,"daoReward",function(){return zn.MODEL.daoReward(this.index)}),p(0,e,"finishEffect",function(){return!!this.statusEffect&&0<=this.statusEffect.indexOf(",1")}),p(0,e,"faReward",function(){return zn.MODEL.faReward(this.index)}),p(0,e,"taskingName",function(){return zn.MODEL.taskingName(this.index)}),p(0,e,"taskName",function(){return zn.MODEL.taskName(this.index)}),p(0,e,"status",function(){return this.serverVo?this.serverVo.status:0}),p(0,e,"index",function(){return zn.getIndex(this.key)}),p(0,e,"zhanReward",function(){return zn.MODEL.zhanReward(this.index)}),p(0,e,"taskId",function(){return this.key}),p(0,e,"isSceneKillTypeTask",function(){return 2==this.status&&this.serverVo&&this.serverVo.tarVo&&15==this.serverVo.tarVo.tarType}),p(0,e,"statusEffect",function(){return zn.MODEL.effectsSet(this.index)}),p(0,e,"recieveEffect",function(){return!!this.statusEffect&&0<=this.statusEffect.indexOf("1,")}),p(0,e,"taskContent",function(){if(!this.m_taskContant){var e=zn.MODEL.taskContent(this.index);this.m_taskContant=JSON.parse(e)}return this.m_taskContant||(this.m_taskContant=[]),this.m_taskContant}),p(0,e,"taskReward",function(){if(!this.m_taskReward){this.m_taskReward={};for(var e=zn.MODEL.taskReward(this.index),t=e.split(","),i=0;i<t.length;++i){var n=(e=t[i]).split(":");1<n.length&&(this.m_taskReward[n[0]]=n[1])}}return this.m_taskReward}),p(0,e,"goodsRewads",function(){var e=this;if(!e.m_GoodsReward){e.m_GoodsReward=[];var t,i,n;switch(gR.ins.actorList[0].job){case 1:n=zn.MODEL.zhanReward(e.index);break;case 2:n=zn.MODEL.faReward(e.index);break;case 3:n=zn.MODEL.daoReward(e.index)}if(n&&""!=n&&"0"!=n&&0<(t=n.split(";")).length){var s=(n=t[0]).split(",");1<s.length&&(i=yB.create(s[0],s[1]),e.m_GoodsReward.push(i))}0==e.m_GoodsReward.length&&(n=zn.MODEL.taskGoodsReward(e.index))&&""!=n&&"0"!=n&&1<(t=n.split(",")).length&&(i=yB.create(t[0],t[1]),e.m_GoodsReward.push(i))}return e.m_GoodsReward}),p(0,e,"commitNPC",function(){return zn.MODEL.commitNPC(this.index)}),p(0,e,"taskEvent",function(){if(null==this.m_NewGuides){var e=zn.MODEL.taskEvent(this.index);this.m_NewGuides=e.split(",")}return this.m_NewGuides}),p(0,e,"commitDialogue",function(){return zn.MODEL.commitDialogue(this.index)}),p(0,e,"isKillTypeTask",function(){return 2==this.status&&this.serverVo&&this.serverVo.tarVo&&4==this.serverVo.tarVo.tarType}),p(0,e,"isKillBossTask",function(){return 2==this.status&&this.serverVo&&this.serverVo.tarVo&&13==this.serverVo.tarVo.tarType}),p(0,e,"waitZhanBao",function(){return this.needZhanBao},function(e){this.needZhanBao=e}),p(0,e,"targetWord",function(){var e=this.taskName;return 2==this.status?e=this.getProTxt():this.waitZhanBao&&(e=this.getProTxt()),e}),p(0,e,"target",function(){return this.serverVo?this.serverVo.tarVo:null}),p(0,e,"statusTxt",function(){var e=RP.n[88];if(2==this.status||this.waitZhanBao)if(this.serverVo.tarVo&&this.taskContent&&0<this.taskContent.length){var t=this.taskContent[0];if(t){var i=null;e=(i=t.num?t.num:t.times?t.times:t.swId?t.swId:t.ceng?t.ceng:t.level?t.level:t.id?t.id:"1")?this.waitZhanBao?"(0/"+i+")":"("+this.serverVo.tarVo.currentNum+"/"+i+")":""}}else e="";return e}),p(0,e,"tarIcon",function(){return this.taskReward&&this.taskReward.GOLD?i.getValueIcon("GOLD"):null}),p(0,e,"rewardText",function(){var e,t,i=this,n=0;switch(gR.ins.actorList[0].job){case 1:t=zn.MODEL.zhanReward(i.index);break;case 2:t=zn.MODEL.faReward(i.index);break;case 3:t=zn.MODEL.daoReward(i.index)}if(t&&""!=t&&"0"!=t&&0<(e=t.split(";")).length){var s=(t=e[0]).split(",");if(1<s.length&&(n=parseInt(s[0]),Bi.hasIndex(n)))return"奖励："+Bi.MODEL.name(Bi.getIndex(n))}if(i.taskReward){var o=0,a="";return i.taskReward.GOLD?(a="元宝",1e4<(o=i.taskReward.GOLD)&&(o=i.taskReward.GOLD/1e4,a="万元宝")):i.taskReward.EXP?(a="经验",1e4<(o=i.taskReward.EXP)&&(o=i.taskReward.EXP/1e4,a="万经验")):i.taskReward.COPPER&&(a="金币",1e4<(o=i.taskReward.COPPER)&&(o=i.taskReward.COPPER/1e4,a="万金币")),"奖励："+o+a}return RP.n[89]}),i.getValueIcon=function(e){var t="";switch(e){case"EXP":t="icgoods286";break;case"GOLD":t="icgoods042";break;case"COPPER":t="icgoods087"}return t},i.getValueGoods=function(e,t){return 0!=i.getValueId(e)?yB.create(i.getValueId(e),t):null},i.getValueTxt=function(e){var t="";switch(e){case"EXP":t="经验";break;case"GOLD":t="元宝";break;case"COPPER":t="金钱"}return t},i.getValueId=function(e){switch(e){case"EXP":return 4;case"GOLD":return 14;case"COPPER":return 15}return 0},i.ISPROESSING=2,i.CANCOMMIT=3,i.FINISH=4,i}(),SB=function(){var o;function a(e,t,i){var n=this;n.selectHandler=null,n.filterHandler=null,n.viewX=NaN,n.viewY=NaN,n._container=null,n._userTab=null,n._tab=null,n._tabType=0,n._tabHandler=null,n._voMap={},n._sameViewMap=null,n._oriTabItems=null,n._selectedIndex=-1,n._invalid=!1,n._invalidView=!1,n.openSelectReddot=!1,n._isOpen=!1,n._vos=[],n._showVos=[],n._id=Bg.getGID(),n._waitCallbackBind=xs.bind(n,n.___waitCallback),void 0===t&&(t=1),n._container=e,n._container.on("display",n,n.onContainerDisplayChanged),n._container.on("undisplay",n,n.onContainerDisplayChanged),n._container[a._vsc_]=n._id,n._tabType=t,n._userTab=i,xs.injectFunction2(xs.bind(n,n.destroy),e,e.destroy,xs.SpriteDestroyName,!0)}b(a,"ui.ViewStackComponent");var e=a.prototype;return e.regist=function(e,t,i){this._vos.length;var n=new o;n.cls=e,n.id=t,i&&(n.data=i.data,n.label=i.label,n.sameType=i.sameType,n.grayTip=i.grayTip,n.wait=i.wait,n.oriIndex=i.index,i.hasOwnProperty("showDragon")&&(n.showDragon=i.showDragon),i.hasOwnProperty("showBtnHelp")&&(n.showBtnHelp=i.showBtnHelp),i.hasOwnProperty("btnInfo")&&(n.btnInfo=i.btnInfo),i.hasOwnProperty("isHideBg")&&(n.isHideBg=i.isHideBg)),n.oriIndex=this._vos.length,this._vos.push(n),this._voMap[n.id]=n},e.registAll=function(e){for(var t in this._vos.length=0,this._voMap)delete this._voMap[t];for(var i=0;i<e.length;i++){var n=e[i],s=new o;s.cls=n.cls,s.id=n.id,s.data=n.data,s.label=n.label,s.sameType=n.sameType,s.grayTip=n.grayTip,s.limitTip=n.limitTip,s.oriIndex=i,s.wait=n.wait,n.hasOwnProperty("showDragon")&&(s.showDragon=n.showDragon),n.hasOwnProperty("showBtnHelp")&&(s.showBtnHelp=n.showBtnHelp),n.hasOwnProperty("btnInfo")&&(s.btnInfo=n.btnInfo),n.hasOwnProperty("isHideBg")&&(s.isHideBg=n.isHideBg),this._vos.push(s),this._voMap[s.id]=s}},e.invalid=function(){this._invalid||(this._invalid=!0,G.timer.callLater(this,this.___changeValid)),this.invalidView()},e.invalidTab=function(){this._tab=null,this.invalid()},e.invalidView=function(){this._invalidView||(this._invalidView=!0,G.timer.callLater(this,this.___changeView))},e.updateSelectedView=function(e){var t=this.selectedView;t&&t.updateByVSC&&t.updateByVSC(e)},e.onContainerDisplayChanged=function(){var e=this;if(e._container.displayedInStage)(a._vscMap[e._id]=e)._selectedIndex=-1,e._isOpen=!0,e.invalid();else{a._waitVscMap.remove(e._id),delete a._vscMap[e._id];var t=e._findShowVo();t&&e._hideViewVo(t),e._tab&&(e._tab.selectHandler=null,e._userTab||(e._tab=null,e._oriTabItems=null)),e._removeDelay()}},e._initTab=function(){if(0!=this._tabType&&this._tab){this._oriTabItems?this._oriTabItems.length=0:this._oriTabItems=[];for(var e=0;e<1e4;e++){var t=this._tab.getChildByName("item"+e);if(null==t)break;this._oriTabItems.push(t)}}},e._searchTab=function(){var e=this._searchLayout();return e?e.bottom_nav.tab:null},e._searchLayout=function(){for(var e,t=this._container;t;){if(t.layout instanceof modules.gui.views.layout.LayoutPanel){e=t.layout;break}if(t instanceof modules.gui.views.layout.LayoutPanel){e=t;break}t=t.parent}return e},e.runChangeValid=function(){this._invalid&&G.timer.runCallLater(this,this.___changeValid)},e.___changeValid=function(){var e=this;e._invalid=!1;var t=e._findShowVo();e._showVos.length=0;for(var i=-1,n=-1,s=t&&t.id?t.id:null,o=e._selectedIndex,a={},r={},l=0;l<e._vos.length;l++){var c=e._vos[l];c.filterType=null!=e.filterHandler?e.filterHandler.runWith([c.id,c.data]):0;var u=!0,d=c.view;2!=c.filterType&&1!=c.filterType||(c.isShow&&e._hideViewVo(c),c.view=null,u=!1);var h=c.sameType;if(h?u?(r[h]=!0,a[h]&&delete a[h]):d&&!r[h]&&(a[h]=d):!u&&d&&d.destroy&&d.destroy(!0),s!=c.id||u||(s=null),2!=c.filterType){var _=e._showVos.length;-1==i&&u&&(i=_),-1==n&&u&&3==c.filterType&&(n=_),o!=_||u||(o=-1),e._showVos.push(c)}}for(var f in a)(d=a[f]).destroy&&d.destroy(!0);if(s)for(l=0;l<e._showVos.length;l++)if(e._showVos[l].id==s){o=l;break}if((-1==o||o>=e._showVos.length)&&(o=e.openSelectReddot&&-1!=n?n:i),e._selectedIndex=o,null==e._tab&&(e._tab=e._userTab||e._searchTab(),e._initTab()),null!=e._tab&&e._oriTabItems&&0!=e._oriTabItems.length){e._tab.selectHandler=null;var p=[],g=[];for(l=0;l<e._showVos.length;l++)c=e._showVos[l],0==e._tabType?p.push(c.label):1==e._tabType&&g.push(e._oriTabItems[c.oriIndex]);if(0==e._tabType)e._tab.labels=p.join(",");else if(1==e._tabType)for(e._tab.removeChildren(),e._tab.initItems(),l=0;l<g.length;l++)e._tab.addItem(g[l]);for(l=0;l<e._showVos.length;l++)e._setItemEnabled(l,e._tab.items[l],e._showVos[l].filterType);e._tab.selectedIndex=e._selectedIndex,e._tab.selectHandler=e._tabHandler||(e._tabHandler=ql.create(e,e.onTabSelect,null,!1));var v=e._searchLayout();v&&e._isOpen&&v.tabScrollTo(e._selectedIndex),e._isOpen=!1}},e.updateItemEnabled=function(){if(this._tab&&this._tab.items)for(var e,t=0;t<this._showVos.length;t++)(e=this._showVos[t]).filterType=null!=this.filterHandler?this.filterHandler.runWith([e.id,e.data]):0,this._setItemEnabled(t,this._tab.items[t],e.filterType)},e.runChangeView=function(){this._invalidView&&G.timer.runCallLater(this,this.___changeView)},e.___changeView=function(){var e=this;if(e._invalidView=!1,e._container.displayedInStage&&(e.runChangeValid(),-1!=e._selectedIndex)){var t=e._showVos[e._selectedIndex],i=e._findShowVo();if(i){if(i==t)return;e._hideViewVo(i)}t.wait?(a._waitVscMap.put(e._id,!0),e.updateLayoutCircle(),t.waitHandler?t.waitHandler.resume(null,e._waitCallbackBind):(t.waitHandler=t.wait.call(void 0),t.waitHandler.wait(t.id,null,e._waitCallbackBind))):e.___waitCallback(t.id,null);var n=e._searchLayout();n&&(n.dragon_border.visible=t.showDragon,n.btn_help.visible=t.showBtnHelp,n.btn_help.centerX=t.btnInfo[0],n.btn_help.centerY=t.btnInfo[1],n.btn_help.clickHandler=ql.create(e,e.openHelpView,[t.btnInfo[2]],!1),n.g_bg.visible=!t.isHideBg)}},e.___waitCallback=function(e,t){var i=this;a._waitVscMap.remove(i._id),i.updateLayoutCircle();var n=i._showVos[i._selectedIndex];if(!n||n.id==e){var s=i._findShowVo();if(s){if(s==n)return;i._hideViewVo(s)}n.isShow=!0;var o=n.view;null==o&&(n.sameType&&i._sameViewMap&&(o=i._sameViewMap[n.sameType]),null==o&&(o=new n.cls,n.sameType&&((i._sameViewMap||(i._sameViewMap={}))[n.sameType]=o),isNaN(i.viewX)||(o.x=i.viewX),isNaN(i.viewY)||(o.y=i.viewY)),n.view=o),o[a._vsc_]=i._id,o.parent||i._container.addChild(o),o.showByVSC&&o.showByVSC(n.id,n.data),i.selectHandler&&i.selectHandler.runWith([n.id,n.data])}},e._hideViewVo=function(e){var t=e.view;t&&(t.parent&&t.parent.removeChild(t),t[a._vsc_]&&(t[a._vsc_]=null),t.hideByVSC&&t.hideByVSC(e.id,e.data)),e.isShow=!1,e.waitHandler&&e.waitHandler.pause()},e.updateLayoutCircle=function(){var e=this._searchLayout();e&&e.updateCircle()},e._findShowVo=function(){if(this._showVos)for(var e=0;e<this._showVos.length;e++){var t=this._showVos[e];if(t.isShow)return t}return null},e.onTabSelect=function(e){var t=this,i=t._showVos[e];if(i&&4==i.filterType){var n=t._tab.selectHandler;return t._tab.selectHandler=null,t._tab.selectedIndex=t._selectedIndex,t._tab.selectHandler=n,void t._showGrayTip(i.id,i.limitTip)}if(i&&1==i.filterType){var s=t._tab.selectHandler;return t._tab.selectHandler=null,t._tab.selectedIndex=t._selectedIndex,t._tab.selectHandler=s,void t._showGrayTip(i.id,i.grayTip)}t._selectedIndex=e,t.invalidView(),UB.ins._playPanelSound()},e._setItemEnabled=function(e,t,i){t&&(t.gray=1==i||2==i,t instanceof ui.controls.TipButton&&(t.showTip=3==i))},e._showGrayTip=function(e,t){var i=typeof t;"string"==i?zB.ins.showMsg(t,1):"function"==i&&t.call(void 0,e)},e._removeDelay=function(){this._invalid&&(this._invalid=!1,G.timer.clear(this,this.___changeValid)),this._invalidView&&(this._invalidView=!1,G.timer.clear(this,this.___changeView))},e.destroy=function(e){var t=this;void 0===e&&(e=!0),a._waitVscMap.remove(t._id),a._vscMap[t._id]&&delete a._vscMap[t._id];var i=[];if(t._showVos)for(var n=0;n<t._showVos.length;n++){var s=t._showVos[n],o=s.view;o&&-1==i.indexOf(o)&&(s.isShow&&t._hideViewVo(s),NP.destoryImage(o),i.push(o),o[a._vsc_]=null,o.destroy(!0)),s.view=null,s.waitHandler&&s.waitHandler.destroy(),s.wait=null,s.waitHandler=null}i.length=0,i=null,t._showVos=null,t._vos=null,t.filterHandler=null,t.selectHandler=null,a._vsc_&&t._container[a._vsc_]&&delete t._container[a._vsc_],t._container.off("display",t,t.onContainerDisplayChanged),t._container.off("undisplay",t,t.onContainerDisplayChanged),t._container=null,t._tab=null,t._userTab=null,t._oriTabItems=null,t._sameViewMap=null,t._selectedIndex=-1,t._tabHandler&&(t._tabHandler.recover(),t._tabHandler=null),t._removeDelay()},e.openHelpView=function(e){fN.openHelp(e)},p(0,e,"selectedIndex",function(){return this.runChangeValid(),this._selectedIndex},function(e){if(this.runChangeValid(),this._selectedIndex!=e){var t=this._showVos[e];if(t){if(1==t.filterType)return void this._showGrayTip(t.id,t.grayTip);if(this._selectedIndex=e,this._tab){var i=this._tab.selectHandler;this._tab.selectHandler=null,this._tab.selectedIndex=e,this._tab.selectHandler=i}this.invalidView()}}}),p(0,e,"selectId",function(){return this.runChangeValid(),-1==this._selectedIndex?null:this._selectedIndex<this._showVos.length?this._showVos[this._selectedIndex].id:null},function(e){this.runChangeValid();for(var t=0;t<this._showVos.length;t++){var i=this._showVos[t];if(i.id==e){if(this._selectedIndex==t)return;if(1==i.filterType)return void this._showGrayTip(i.id,i.grayTip);if(this._selectedIndex=t,this._tab){var n=this._tab.selectHandler;this._tab.selectHandler=null,this._tab.selectedIndex=t,this._tab.selectHandler=n}this.invalidView();break}}}),p(0,e,"firstTipIndex",function(){if(this._showVos)for(var e=0;e<this._showVos.length;e++)if(3==this._showVos[e].filterType)return e;return-1}),p(0,e,"selectedView",function(){return this.runChangeView(),-1==this._selectedIndex?null:this._showVos[this._selectedIndex].view}),p(1,a,"isWaiting",function(){return 0<a._waitVscMap.capacity}),a.judgeView=function(e,t){var i=a._getVSC(e);i&&(i.selectId=t)},a._getVSC=function(e){var t=e[a._vsc_];return t?a._vscMap[t]:null},a.STATUS_NORMAL=0,a.STATUS_GRAY=1,a.STATUS_UNOPEN=2,a.STATUS_TIP=3,a.STATUS_LIMIT=4,a.TAB_AUTO=0,a.TAB_CUSTOM=1,a._vscMap={},f(a,["_vsc_",function(){return this._vsc_=xs.getSoleProperty()},"_waitVscMap",function(){return this._waitVscMap=new eu}]),a.__init$=function(){o=function(){function e(){var e=this;e.cls=null,e.id=null,e.label=null,e.data=null,e.sameType=null,e.filterType=0,e.grayTip=null,e.limitTip=null,e.oriIndex=0,e.isShow=!1,e.showDragon=!1,e.showBtnHelp=!1,e.btnInfo=[],e.isHideBg=!1,e.wait=null,e.waitHandler=null,e.view=null}return b(e,""),e}()},a}(),kB=function(){function t(){}return b(t,"utils.CodeUtils",null,"CodeUtils$1"),t.createButton=function(e,t,i,n,s,o,a,r,l,c){void 0===o&&(o=2),void 0===a&&(a=""),void 0===l&&(l=0);var u=new vt(e,a);return u.pos(t,i),0<n&&0<s&&u.size(n,s),u.stateNum=o,u.labelFont="SimHei",0<l&&(u.labelSize=l),c&&(u.labelColors=c),r&&r.addChild(u),u},t.createTipButton=function(e,t,i,n,s,o,a,r,l,c,u){void 0===a&&(a=2),void 0===r&&(r=""),void 0===c&&(c=0);var d=new $p(e,r);return d.pos(i,n),0<s&&0<o&&d.size(s,o),d.tipSkin=t,d.stateNum=a,d.labelFont="SimHei",0<c&&(d.labelSize=c),u&&(d.labelColors=u),l&&l.addChild(d),d},t.createText=function(e,t,i,n,s,o,a,r,l,c,u,d,h){void 0===s&&(s=""),void 0===o&&(o=18),void 0===a&&(a="#ffffff"),void 0===r&&(r=!1),void 0===l&&(l="center"),void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===h&&(h=!1);var _=new Yp;return _.pos(e,t),0<i&&(_.width=i),0<n&&(_.height=n),_.text=s,_.fontSize=o,_.color=a,_.bold=r,_.align=l,_.wordWrap=c,_.autoSize=u,_.cacheAsBitmap=h,_.font="SimHei",d&&d.addChild(_),_},t.createLabel=function(e,t,i,n,s,o,a){void 0===o&&(o=""),void 0===a&&(a=16777215);var r=new fc;return r.text=o,r.pos(e,t),r.size(i,n),r.color="#"+a.toString(16),s&&s.addChild(r),r},t.createImage=function(e,t,i,n,s,o){void 0===n&&(n=0),void 0===s&&(s=0);var a=new Kl;return a.pos(t,i),0<n&&0<s&&a.size(n,s),a.dataSource=e,o&&o.addChild(a),a},t.createHtmlDiv=function(e,t,i,n,s,o,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=20),void 0===n&&(n="#ffffff"),void 0===s&&(s=0),void 0===o&&(o=0);var r=new Fl;return r.x=e,r.y=t,r.style.font="SimHei",r.style.fontFamily="SimHei",r.style.fontSize=i,r.style.color=n,0<s&&(r.width=s),0<o&&(r.height=o),a&&a.addChild(r),r},t.createSprite=function(e,t,i,n,s,o){void 0===n&&(n=0),void 0===s&&(s=0);var a=new pp;return e&&(a.texture=G.loader.getRes(e)),a.pos(t,i),0<n&&(a.width=n),0<s&&(a.height=s),o&&o.addChild(a),a},t.createEffect=function(e,t,i,n,s){var o=mj.GetNew();return o.renderInSelf=!0,o.setXY(t,i),0!=o.rotation&&(o.rotation=0),1!=o.scaleX&&(o.scaleX=1),1!=o.scaleY&&(o.scaleY=1),o.loadEffect(e,"body_top",s),o.mouseEnabled=!1,o.mouseThrough=!0,n&&n.addChild(o),o},t.replace=function(e,t){t.pos(e.x,e.y),e.parent&&(e.parent.addChildAt(t,e.parent.getChildIndex(e)),e.removeSelf())},t.enumSuccessRate=function(e){return e=e.toLowerCase(),t._enumSR.indexOf(e)},f(t,["_enumSR",function(){return this._enumSR=["none","verylow","low","middle","high","veryhigh","mustsuccess"]}]),t}(),EB=function(){function s(){}return b(s,"utils.CommonUtils"),p(1,s,"isOppoFindX",function(){return!!pt.onAndroid&&"oppokyx"==hr.platform}),p(1,s,"isIphoneX",function(){return!!pt.onIOS&&(1125==pt.clientWidth&&2436==pt.clientHeight)}),p(1,s,"showCharge",function(){return 0!=dr.rechargeModel&&(2!=dr.rechargeModel||!pt.onIOS)}),p(1,s,"nativeHasBang",function(){return BP.hasPhoneBang}),p(1,s,"iPhoneBang",function(){return!!pt.onIPhone&&(1125==pt.width&&2436==pt.height||828==pt.width&&1792==pt.height||1242==pt.width&&2688==pt.height)}),p(1,s,"isAndroidX_New",function(){return!!pt.onAndroid&&(pt.clientWidth*pt.pixelRatio==1080&&pt.clientHeight*pt.pixelRatio==2220)}),p(1,s,"isIphoneXw",function(){return!!pt.onIOS&&1125==pt.clientWidth}),p(1,s,"isAndroidX",function(){return!!pt.onAndroid&&(pt.clientWidth*pt.pixelRatio==1080&&pt.clientHeight*pt.pixelRatio==2280||(pt.clientWidth*pt.pixelRatio==720&&pt.clientHeight*pt.pixelRatio==1520||(400==pt.clientWidth&&867==pt.clientHeight?2.7==pt.pixelRatio:2.04<pt.clientHeight/pt.clientWidth)))}),p(1,s,"isFitBottom",function(){return pt.clientWidth/pt.clientHeight<.54}),p(1,s,"isFitWidth",function(){var e=pt.clientWidth/pt.clientHeight;return s.firstSize<=0&&(s.firstSize=e),e<.5625}),s.polyfill=function(){TB.ins.init(),G.timer.frameOnce(120,xs,s.mytest)},s.mytest=function(){var e=pt.document.getElementById("mirOption");if(null!=e){var t=e.getAttribute("arthor");if(!t)return;0==t.indexOf("coolupso")&&gp.show(),"zjh"==t&&gp.show()}},s.pay=function(e,t,i){if(0!=s.showCharge)if(pt.onIOS&&3==dr.rechargeModel){var n=[{text:RP.n[90],color:"#ff2e24"}];zB.ins.playNoticeMsg(n,!0,!0)}else dr.isConchApp?BP.payRequst(t):jP.payRequst(t)},s.doPayPlatform=function(e){if(dr.isConchApp){var t=null;dr.nativeAndroid&&((t=new Object).servername,hr.serverName,t.servername||(t.servername=""),t.rolename,gR.ins.charName,t.rolename||(t.rolename="")),BP.doPayPlatform(e,t)}else jP.doPayPlatform(e)},s.testSendToc=function(e,t){for(var i=[],n=1,s=arguments.length;n<s;n++)i.push(arguments[n]);G.timer.frameOnce(1,null,function(){Tu.sendToModule(""+e.packId,i,e)})},s.registerMemoryWarning=function(){2==dr.xgame&&wx.onMemoryWarning(function(){nr.log("=== === memory warning === ===,size:"+x_.systemResourceManager.memorySize,0,!0),UH.getInstance().clearHeightMemory(!0)})},s.firstSize=0,s}(),TB=(function(){function e(){}b(e,"utils.RewardUtil"),e.parse=function(e){var t,i=[],n=e.split(";");for(var s in n){t=n[s];var o=be.stringToNumArray(t);i.push(yB.create(o[0],o[1]))}return i}}(),function(){function e(){}b(e,"utils._polyfill");var t=e.prototype;return t.init=function(){Array.CASEINSENSITIVE=1,Array.DESCENDING=2,Array.NUMERIC=16,Array.RETURNINDEXEDARRAY=8,Array.UNIQUESORT=4;var t=fs.isDrawType;fs.isDrawType=function(e){return"GridTexture"==e||("_ConfigViewSingleton_"==e||t.call(fs,e))};var u=fs.addGraphicToSprite;fs.addGraphicToSprite=function(e,t,i){if(void 0===i&&(i=!1),"GridTexture"==e.type){var n=e.props,s=G.loader.getRes(n.skin),o=null;n.sizeGrid&&(o=Pg.fillArray(yp.defaultSizeGrid,n.sizeGrid,Number));var a=0|n.x,r=0|n.y,l=1;n.alpha&&(l=n.alpha),0==a&&0==r||t.graphics.translate(a,r);var c=null;return n&&(c=fs._getTransformData(n)),(c||1!=l)&&(t.graphics.save(),c&&t.graphics.transform(c),1!=l&&t.graphics.alpha(l)),Cl.draw9Grid(t.graphics,s,0,0,0|n.width,0|n.height,o),(c||1!=l)&&t.graphics.restore(),void(0==a&&0==r||t.graphics.translate(-a,-r))}"_ConfigViewSingleton_"!=e.type?u.call(fs,e,t,i):t&&$c.ins.handle(e,t)};var n=vs.prototype.loadComplete;vs.prototype.loadComplete=function(e,t){var i=t instanceof laya.resource.Texture?t.bitmap:t;i&&i instanceof laya.resource.Resource&&n.call(this,e,t)};var e=Zp.prototype._update;Zp.prototype._update=function(){try{e.call(this)}catch(e){console.log("error===="+e);var t="["+hr.serverID+","+hr.serverName+","+hr.uid+","+gR.ins.charName+"]";nr.ins().writeBoSaiDong("LogError:"+t+" "+e)}};var i=pt.onMobile;pt.__onMobile=i,pt.onMobile=i||v_.isConchApp,v_._context._drawTextureWithTransform=function(e,t,i){var n=i[0];try{if(n&&n.loaded){if(n instanceof laya.resource.Texture&&(null==n.bitmap||n.bitmap.destroyed))return;this.ctx&&this.ctx.drawTextureWithTransform(i[0],i[1],i[2],i[3],i[4],i[5],e,t,i[6])}}catch(e){}},v_._context._drawTexture=function(e,t,i){var n=i[0];try{if(n&&n.loaded){if(n instanceof laya.resource.Texture&&(null==n.bitmap||n.bitmap.destroyed))return;this.ctx&&this.ctx.drawTexture(i[0],i[1],i[2],i[3],i[4],e,t)}}catch(e){}},vs.prototype._loop=function(){var e=this;e._style.visible&&e._sources&&(e.index=e._index,e._index++,-1<e._toIndex&&e._index>=e._toIndex?e.stop():e._index>=e._sources.length&&(e._index=0))},this.modifyList(),this.modifyAtlas(),this.modifyHandler(),this.modifyURL()},t.modifyList=function(){var t="_mRenderOptimize",n="itemRender",e="preinitialize";function i(e){var t=e[n];if(t){var i=e.optimize;if("custom"==i&&"function"==typeof t)iu.optimizeList(e,t);else if("default"==i&&"function"!=typeof t){t.props&&t.props.runtime;0}}}var s={get:function(){return this[t]},set:function(e){"default"!=(this[t]=e)&&"custom"!=e||i(this)}};Object.defineProperty(mc.prototype,"optimize",s);var o=Object.getOwnPropertyDescriptor(mc.prototype,n),a={get:function(){return o.get.call(this)},set:function(e){o.set.call(this,e),e&&i(this)}},r=mc.prototype[e];mc.prototype[e]=function(){r&&r.call(this),Object.defineProperty(this,n,a)}},t.modifyAtlas=function(){var i=Te.prototype.addToAtlas;Te.prototype.addToAtlas=function(e){var t=e._MAtlasID_;t?Zc.ins.pushTex(t,e):i.call(this,e)};var n=Te.prototype.getAtlaserCount;Te.prototype.getAtlaserCount=function(){return n.call(this)+Zc.ins.getAtlaserCount()};var s=Te.prototype.getAtlaserByIndex;Te.prototype.getAtlaserByIndex=function(e){var t=n.call(this);return e<t?s.call(this,e):Zc.ins.getAtlaserByIndex(e-t)},Te.prototype.getTextureByIndex=function(e){var t=n.call(this);return e<t?null:e<t?null:Zc.ins.getTextureByIndex(e-t)},Kc.prototype.computeUVinAtlasTexture=function(e,t,i,n){var s=this._w,o=this._h,a=i/s,r=n/o,l=(i+e.bitmap.width)/s,c=(n+e.bitmap.height)/o,u=e.bitmap.width/s,d=e.bitmap.height/o;e.uv=[a+t[0]*u,r+t[1]*d,l-(1-t[2])*u,r+t[3]*d,l-(1-t[4])*u,c-(1-t[5])*d,a+t[6]*u,c-(1-t[7])*d]};var a=Ce.prototype.showNext;Ce.prototype.showNext=function(){if(v_.isWebGL){var e=Te.instance.getAtlaserCount(),t=this.mIndex+1;e<=t&&(t=0);for(var i=e-Zc.ins.getAtlaserCount(),n=0;n<i;n++)this.mTextureDic[n]=null;var s=Te.instance.getTextureByIndex(t);s&&(this.mTextureDic[t]=s),a.call(this);var o=this.mSprite;o&&(o.x=G.stage.width-1024)}}},t.modifyURL=function(){yc.prototype.formatURL=function(e){return e=Hg.getIntance().formatURL(e)}},t.restoreURL=function(){yc.prototype.restoreURL=function(e){return e=Hg.getIntance().restoreURL(e)}},t.modifyHandler=function(){ql.create=function(e,t,i,n){return void 0===n&&(n=!0),new ql(e,t,i,n)},ql.prototype.recover=function(){0<this._id&&(this._id=0,this.clear())},ql.prototype.run=function(){var e=this;if(null==e.method)return null;var t=e.method,i=e.caller,n=e.args;return e.once&&e.recover(),t.apply(i,n)},ql.prototype.runWith=function(e){var t=this;if(null==t.method)return null;var i=t.method,n=t.caller,s=t.args;if(t.once&&t.recover(),null==e)var o=i.apply(n,s);else o=s||e.unshift?s?i.apply(n,s.concat(e)):i.apply(n,e):i.call(n,e);return o}},t._privatePolyFill=function(e){xc.__ori_console_log__;console.log=function(e){}},f(e,["ins",function(){return this.ins=new e}]),e}()),CB=function(){function c(){var e=this;e._currValue_=0,e._maxValue_=0,e._width_=0,e._height_=0,e._percent_=1,e.x=0,e.y=0,e.w=0,e.h=0,e.owner=null,e.pox=0,e.poy=0,e.inStageRect=!1,e._visible_=!0,e.isRecover=!1,c._charBoolQueue_.push(e)}b(c,"zwc.engine.core.displays.world.parts.CharBool");var e=c.prototype;return e.setValue=function(e,t,i){void 0===i&&(i=1),this._currValue_=e,this._maxValue_=t,this._percent_=this._currValue_/this._maxValue_,1<this._percent_&&(this._percent_=1),this._percent_<0&&(this._percent_=0)},e.recover=function(){this.isRecover=!0,this.owner=null;var e=c._charBoolQueue_.indexOf(this);-1!=e&&c._charBoolQueue_.splice(e,1)},e.reset=function(e){this.owner=e,this.isRecover=!1,-1==c._charBoolQueue_.indexOf(this)&&c._charBoolQueue_.push(this)},p(0,e,"percent",function(){return this._percent_}),p(0,e,"currValue",function(){return this._currValue_?parseInt(this._currValue_.toString()):0},function(e){this._currValue_=e,this._currValue_>=this._maxValue_&&(this._currValue_=this._maxValue_),this.setValue(this._currValue_,this._maxValue_)}),p(0,e,"maxValue",function(){return this._maxValue_},function(e){this._maxValue_=e,this.setValue(this._currValue_,this._maxValue_)}),p(0,e,"visible",function(){return this._visible_},function(e){this._visible_=e}),c.doRender=function(e){for(var t,i,n=[],s=NB.boolBackgroundTexture,o=0;o<c._charBoolQueue_.length;o++)if(0==(t=c._charBoolQueue_[o]).isRecover&&t.owner&&t.owner.visible&&0==t.owner.isBoss&&t.owner.stage&&0==t.owner.isDeath&&t.owner.inStageRect()||t&&t.owner&&t.owner.type==Za.MONSTER_TRANSPORT&&0==t.owner.isDeath){var a=t.owner.isBoss?t.owner.y+1-(t.owner.bodyHeight+135):t.owner.y+1-(t.owner.bodyHeight+5);0<t.currValue&&t.visible&&n.push(t.owner.x-s.width/2,a)}e.drawTextures(s,n);if(s=NB.boolTexture)for(var r=0;r<c._charBoolQueue_.length;r++)if((0==(t=c._charBoolQueue_[r]).isRecover&&t.owner&&t.owner.visible&&0==t.owner.isBoss&&t.owner.stage&&0==t.owner.isDeath&&t.owner.inStageRect()||t&&t.owner&&t.owner.type==Za.MONSTER_TRANSPORT&&0==t.owner.isDeath)&&0<t.currValue&&t.visible){var l=!1;ZN.isSynchScene()&&t.owner.camp==NF.mainChar.camp&&(l=!0);a=t.owner.isBoss?t.owner.y+1-(t.owner.bodyHeight+135):t.owner.y+1-(t.owner.bodyHeight+5);0<t.owner.hero_id||l?(i=NB.UiTextureSheet.takeStyleTextureBounds("top_img_green"),e.drawTexture(NB.boolHeroTexture,t.owner.x-i.width/2,a,t.percent*i.width,i.height)):(i=NB.UiTextureSheet.takeStyleTextureBounds("top_img_red"),e.drawTexture(s,t.owner.x-i.width/2,a,t.percent*i.width,i.height))}},c._charBoolQueue_=[],c}(),LB=function(){function g(){var e=this;e.owner=null,e._textWidth_=0,e._text_="",e._titleEffect_=null,e._color_="#ffffff",e._professionText_="",e._professionColor_="#ffffff",e._bodyHeight_=130,e.x=NaN,e.y=NaN,e.charBool=null,e.innerBool=null,e._charNameVisible=!0,e._charProfessionNameVisible=!1,e._flyupNameVisible=!1,e._isRecover=!1,e._wordContent=null,e._wordTime=0,e._govPosition=-1,e._govPositionName="",e.flyUpImg=null,e._flyUpLevel=-1,e._reliveText="",null==g._charHeadIntance_&&((g._charHeadIntance_=new Yp).fontSize=g._size_),g.charHeaadQueue.push(e)}b(g,"zwc.engine.core.displays.world.parts.CharHead");var e=g.prototype;return e.recover=function(){var e=this;e.isRecover=!0,e.charBool.isRecover=!0,e.innerBool.isRecover=!0;var t=g.charHeaadQueue.indexOf(e);-1!=t&&g.charHeaadQueue.splice(t,1),e.charBool&&e.charBool.recover(),e.innerBool&&e.innerBool.recover(),e._professionText_="",e._reliveText="",e._govPositionName="",e._text_="",e.owner=null,e._titleEffect_=null,e._color_="#ffffff",e._professionColor_="#ffffff",e._bodyHeight_=130,e.x=0,e.y=0,e._charNameVisible=!0,e._charProfessionNameVisible=!1,e._flyupNameVisible=!1,e._wordContent=null,0<=e._flyUpLevel&&(e._flyUpLevel=-1,e.flyUpImg&&(e.flyUpImg.dispose(),e.flyUpImg=null))},e.hideHead=function(){this.recover()},e.reset=function(e){this.isRecover=!1,-1==g.charHeaadQueue.indexOf(this)&&g.charHeaadQueue.push(this),this.owner=e,this.charBool&&this.charBool.reset(e),this.innerBool&&this.innerBool.reset(e)},e.sayWord=function(e){this._wordContent=e,this._wordTime=BB.getTimer()},e.loadFlyUpTitle=function(e){null==this.flyUpImg&&(this.flyUpImg=new Kl),this.flyUpImg.skin=e},p(0,e,"isRecover",function(){return this._isRecover},function(e){this._isRecover=e,this.charBool.isRecover=e}),p(0,e,"charProfessionNameVisible",function(){return this._charProfessionNameVisible},function(e){this._charProfessionNameVisible=e}),p(0,e,"text",function(){return this._text_},function(e){this._text_=e}),p(0,e,"professionColor",function(){return this._professionColor_},function(e){this._professionColor_=e}),p(0,e,"charNameVisible",function(){return this._charNameVisible},function(e){this._charNameVisible=e}),p(0,e,"professionText",function(){return this._professionText_},function(e){this._professionText_=e}),p(0,e,"relieveText",function(){return this._reliveText},function(e){this._reliveText=e}),p(0,e,"color",function(){return this._color_},function(e){this._color_=e}),p(0,e,"textWidth",function(){return this._textWidth_},function(e){this._textWidth_=e}),p(0,e,"bodyHeight",function(){return this.owner.type==Za.MONSTER||this.owner.type==Za.NPC?1.3*this._bodyHeight_:this._bodyHeight_},function(e){this._bodyHeight_=e}),p(0,e,"flyupNameVisible",function(){return this._flyupNameVisible},function(e){this._flyupNameVisible=e}),p(0,e,"flyUpTitle",function(){return this._govPosition},function(e){this._flyUpLevel=e;var t=gi.MODEL.title(this._flyUpLevel-1);if(t){var i=t.toString();if(0!=i.length){var n=_r.getFullUrl("ui/images/soaring/"+i+".png");G.loader.load(n,ql.create(this,this.loadFlyUpTitle,[n]),null,"image")}}}),p(0,e,"govPosition",null,function(e){this._govPosition=e;var t=mn.MODEL.position(e);this._govPositionName=0<=t?_l.GOV_TITLE_NAME_ARR[t]:""}),p(0,e,"flyUpLevel",function(){return this._flyUpLevel},function(e){this._flyUpLevel=e}),g.doRender=function(e){for(var t=0;t<g.charHeaadQueue.length;t++){var i=g.charHeaadQueue[t];if(i&&i.owner&&0==i.owner.isBoss&&i.owner.visible&&0==i.isRecover&&i.owner.inStageRect()&&0==i.owner.isDeath||i&&i.owner&&i.owner.type==Za.MONSTER_TRANSPORT){if(4==i.owner.hero_id||i.text&&(-1!=i.text.indexOf("神兽")||-1!=i.text.indexOf("白虎"))){i.charNameVisible=!1,i.charBool.visible=!1;continue}if(5==i.owner.hero_id&&(i.charNameVisible=!0,i.charBool.visible=!1),i.charNameVisible){g._charHeadIntance_.text=i.text;var n=i.owner.x-g._charHeadIntance_.textWidth/2,s=i.owner.isBoss?i.owner.y-i.bodyHeight-160:i.owner.y-i.bodyHeight-30;0==i.charBool.visible&&(s+=23),i.charProfessionNameVisible,i&&i.text&&(e.fillBorderText(i.text,n,s,g._size_+"px SimHei",i.color,"#333333",2,"left"),s-=25),i&&i.relieveText&&e.fillBorderText(i.relieveText,i.owner.x,s,g._size_+"px SimHei","#23b11f","#333333",2,"center")}var o=i.owner.y-i.bodyHeight-30,a=i.owner,r=!BB.heidOtherCharMode;if(a&&0<a.hero_id&&(r=!0),r&&i.charProfessionNameVisible){g._charHeadIntance_.text=i.professionText;var l=i.owner.x-g._charHeadIntance_.textWidth/2;0==i.charBool.visible||(o-=23),i&&i.professionText&&e.fillBorderText(i.professionText,l,o,g._size_+"px SimHei",i.professionColor,"#333333",2,"left")}var c=0;if(r&&(0<=a.gov&&(g._charHeadIntance_.text=i._govPositionName,l=i.owner.x-g._charHeadIntance_.textWidth/2,0==i.charBool.visible||(o-=23,c+=23),i._govPositionName&&e.fillBorderText(i._govPositionName,l,o,g._size_+"px SimHei","#e6d80d","#333333",2,"left")),i.flyupNameVisible&&(i.charProfessionNameVisible&&(c+=20),i&&i.flyUpImg&&e.fillTexture(i.flyUpImg.source,i.owner.x-i.flyUpImg.width/2,i.owner.y-i.bodyHeight-60-c,i.flyUpImg.width,i.flyUpImg.height))),null!=i.owner.titleData){var u,d=a.titleData.texture,h=a.titleData.offsetX;u=a.titleData.offsetY-i.bodyHeight+c+30,d&&e.fillTexture(d,a.x-d.width/2+h,a.y-d.height/2+u,d.width,d.height)}if(i._wordContent&&BB.getTimer()-i._wordTime<8e3){n=i.owner.x,s=i.owner.y-i.bodyHeight-10,i.charNameVisible&&(s-=24);var _=HP.getWordTex();_&&_.bitmap&&Cl.draw9Grid(e,_,n-99,s-62-9,198,72,[16,16,16,16]);var f=HP.getArrowTex();f&&e.drawTexture(f,n+10,s-6);var p=i._wordContent.split("#");1==p.length?e.fillText(p[0],n,s-45,"18px SimHei","#e0d6c1","center"):(e.fillText(p[0],n,s-57,"18px SimHei","#e0d6c1","center"),e.fillText(p[1],n,s-31,"18px SimHei","#e0d6c1","center"))}}}},g._charHeadIntance_=null,g._charHeadProIntance_=null,g.charHeaadQueue=[],g._size_=20,g}(),MB=function(){function r(){var e=this;e._currValue_=0,e._maxValue_=0,e._width_=0,e._height_=0,e._percent_=1,e.x=0,e.y=0,e.w=0,e.h=0,e.owner=null,e.pox=0,e.poy=0,e.inStageRect=!1,e._visible_=!0,e.isRecover=!1,r._charInnerQueue_.push(e)}b(r,"zwc.engine.core.displays.world.parts.CharInner");var e=r.prototype;return e.setValue=function(e,t,i){void 0===i&&(i=1),this._currValue_=e,this._maxValue_=t,this._percent_=this._currValue_/this._maxValue_,1<this._percent_&&(this._percent_=1),this._percent_<0&&(this._percent_=0)},e.recover=function(){this.isRecover=!0,this.owner=null;var e=r._charInnerQueue_.indexOf(this);-1!=e&&r._charInnerQueue_.splice(e,1)},e.reset=function(e){this.owner=e,this.isRecover=!1,-1==r._charInnerQueue_.indexOf(this)&&r._charInnerQueue_.push(this)},p(0,e,"percent",function(){return this._percent_}),p(0,e,"currValue",function(){return parseInt(this._currValue_.toString())},function(e){this._currValue_=e,this._currValue_>=this._maxValue_&&(this._currValue_=this._maxValue_),this.setValue(this._currValue_,this._maxValue_)}),p(0,e,"maxValue",function(){return this._maxValue_},function(e){this._maxValue_=e,this.setValue(this._currValue_,this._maxValue_)}),p(0,e,"visible",function(){return this._visible_},function(e){this._visible_=e}),r.doRender=function(e){for(var t,i,n=[],s=NB.boolBackgroundTexture,o=0;o<r._charInnerQueue_.length;o++)0==(t=r._charInnerQueue_[o]).isRecover&&t.owner&&t.owner.visible&&0==t.owner.isBoss&&t.owner.stage&&0==t.owner.isDeath&&t.owner.inStageRect()&&t.visible&&n.push(t.owner.x-s.width/2,t.owner.y-t.owner.bodyHeight);0<n.length&&e.drawTextures(s,n);if(s=NB.innerTexture)for(var a=0;a<r._charInnerQueue_.length;a++)if(0==(t=r._charInnerQueue_[a]).isRecover&&t.owner&&t.owner.visible&&0==t.owner.isBoss&&t.owner.stage&&0==t.owner.isDeath&&t.owner.inStageRect()&&0<t.currValue&&t.visible){ZN.isSynchScene()&&t.owner.camp==NF.mainChar.camp&&!0,i=NB.UiTextureSheet.takeStyleTextureBounds("top_img_yellow"),e.drawTexture(NB.innerTexture,t.owner.x-i.width/2,t.owner.y+1-t.owner.bodyHeight,t.percent*i.width,i.height)}},r._charInnerQueue_=[],r}(),AB=function(){function e(e,t,i){this.key=null,this.pt=null,this.G=0,this.F=0,this.parent,this.G=e,this.F=t,null!=i&&(this.key=i.x.toString()+"_"+i.y.toString()),this.pt=i}return b(e,"zwc.engine.core.displays.world.terrain.astar.TileAstarData"),e}(),DB=function(){function e(){this.item_id=null,this.x=NaN,this.y=NaN,this.layer=NaN,this.depth=NaN,this.dir}return b(e,"zwc.engine.core.displays.world.terrain.ItemData"),e}(),OB=function(){function t(){var e=this;e.isBook=!1,e.isBookHero=!1,e.initValue=NaN,e.type=NaN,e.walkType=1,e.heroType=1,e.isSell=!1,e.isSafe=!1,e.isAlpha=!1,e._x_=0,e._y_=0,e.quoteIndex=0,e.heroQuoteIndex=0,e.charIndex=NaN,e._pt_=new Uh,e._key_}b(t,"zwc.engine.core.displays.world.terrain.Tile");var e=t.prototype;return e.setTileIndex=function(e,t){PB.pixelsToTile(e,t,this._pt_)},e.setXY=function(e,t){this._x_=e,this._y_=t,this._pt_.x=e,this._pt_.y=t,this._key_=this._x_+"_"+this._y_},e.clear=function(){var e=this;e._key_=null,e.charIndex=0,e.isBook=!1,e.isBookHero=!1,e.initValue=0,e.type=0,e.walkType=1,e.heroType=1,e.isSell=!1,e.isSafe=!1,e.isAlpha=!1,e._x_=0,e._y_=0,e.quoteIndex=0,t._tileHash_.push(e)},p(0,e,"pixel_cy",function(){return 40*this.y+20}),p(0,e,"pixel_x",function(){return 80*this.x}),p(0,e,"pixel_cx",function(){return 80*this.x+40}),p(0,e,"pixel_y",function(){return 40*this.y}),p(0,e,"x",function(){return this._x_},function(e){this._x_=e,this._pt_.x=e,this._key_=this._x_+"_"+this._y_}),p(0,e,"key",function(){return this._key_}),p(0,e,"y",function(){return this._y_},function(e){this._y_=e,this._pt_.y=e,this._key_=this._x_+"_"+this._y_}),p(0,e,"pt",function(){return this._pt_}),t.createTile=function(){return zwc.engine.core.displays.world.terrain.Tile._tileHash_.length?zwc.engine.core.displays.world.terrain.Tile._tileHash_.pop():new t},t.deleteTile=function(){for(;0<zwc.engine.core.displays.world.terrain.Tile._tileHash_.length;){zwc.engine.core.displays.world.terrain.Tile._tileHash_.pop();null}},f(t,["_tileHash_",function(){return this._tileHash_=new Array}]),t}(),PB=(function(){function e(){}b(e,"zwc.engine.core.displays.world.terrain.TileConst"),e.BLOCK_TYPE=0,e.ROAD_TYPE=1,e.TILE_SIZE=40,e.LEFT=-1,e.RIGHT=1,e.TILE_HEIGHT=40,e.TILE_WIDTH=80,e.WH=40,e.HH=20,e.Tile_XIE=80}(),function(){function e(){}return b(e,"zwc.engine.core.displays.world.terrain.TileUtils"),e.loopRect=function(e,t,i,n,s,o){if(i<=0)throw new Error(RP.n[91]);if(n<0)throw new Error(RP.n[92]);zwc.engine.core.displays.world.terrain.TileUtils.loop_break=!1,0==n&&0<i&&(s.runWith([e,t]),null!=o&&o.runWith(1));var a=!1;if(0==n?(a=!0,i-=1):n-=1,e-=2,t-=2,!(i<1)){i=n+i;for(var r=NaN,l=NaN,c=n,u=2*n+1;c<i;){var d=e-(c-1),h=t-(c-1),_=1,f=0,p=0;l=u+2,r=Math.pow(l,2)-Math.pow(u,2);for(var g=[],v=0;v<r;v++)p%(l-1)==0&&++f%3==0&&(_=-_),f%2==0?d+=_:h+=_,g.push(d),g.push(h),p++;h=g.pop(),d=g.pop(),g.unshift(h),g.unshift(d);for(var m=0;m<g.length;m+=2){if(zwc.engine.core.displays.world.terrain.TileUtils.loop_break)return;null!=s&&s.runWith([g[m],g[m+1]])}if(c++,u+=2,0==n){var y=c;y=a?c+1:c,null!=o&&o.runWith(y)}else null!=o&&o.runWith(c+1-n-1)}}},e.getPtDis=function(e,t){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.max(i,n)},e.isSameSlope=function(e,t){e=zwc.engine.core.displays.world.terrain.TileUtils.pixelsAlginTile(e.x,e.y,e),t=zwc.engine.core.displays.world.terrain.TileUtils.pixelsAlginTile(t.x,t.y,t);var i=zwc.engine.core.displays.world.terrain.TileUtils.pixelsToTile(e.x,e.y),n=zwc.engine.core.displays.world.terrain.TileUtils.pixelsToTile(t.x,t.y),s=(t.y-e.y)/(t.x-e.x);VB.getDretion(i.x,i.y,n.x,n.y),VB.getDretion(n.x,n.y,i.x,i.y);return i.x==n.x||i.y==n.y||.5==s||-.5==s},e.isSameSlopeTile=function(e,t){var i=e,n=t,s=(n.y-i.y)/(n.x-i.x);VB.getDretion(i.x,i.y,n.x,n.y),VB.getDretion(n.x,n.y,i.x,i.y);return i.x==n.x||i.y==n.y||1==s||-1==s},e.getFitPt=function(e,t,i){void 0===i&&(i=2);var n=(t.y-e.y)/(t.x-e.x),s=e.x-t.x,o=e.y-t.y;return e.x==t.x&&e.y==t.y?e:e.x==t.x?0<o?VB.getTileByDir(e,0,i):VB.getTileByDir(e,4,i):e.y==t.y?0<s?VB.getTileByDir(e,6,i):VB.getTileByDir(e,2,i):1==n?0<s?VB.getTileByDir(e,7,i):VB.getTileByDir(e,3,i):-1==n?0<s?VB.getTileByDir(e,5,i):VB.getTileByDir(e,1,i):zwc.engine.core.displays.world.terrain.TileUtils.get16Grids(e,t)},e.get16Grids=function(e,t){for(var i=[],n=YH.instance.get8Grids(e,zwc.engine.core.displays.world.terrain.TileUtils.getPtDis(e,t)),s=0;s<n.length;s++){var o=n[s];zwc.engine.core.displays.world.terrain.TileUtils.isSameSlope(o,zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(t))&&i.push(o)}for(var a=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y,l=e.x>=t.x?e.x:t.x,c=e.y>=t.y?e.y:t.y,u=[],d=(new u_(a,r,Math.abs(e.x-t.x),Math.abs(e.y-t.y)),[]),h=0;h<i.length;h++){var _=zwc.engine.core.displays.world.terrain.TileUtils.pixelsToTile(i[h].x,i[h].y),f=YH.instance.takeItem(_.x,_.y);_.x>=a&&_.x<=l&&_.y>=r&&_.y<=c&&f&&0<f.type&&(zwc.engine.core.displays.world.terrain.TileUtils.isSameSlope(i[h],zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e))?u.push({point:i[h],dis1:zwc.engine.core.displays.world.terrain.TileUtils.getPtDis(t,_),dis2:zwc.engine.core.displays.world.terrain.TileUtils.getPtDis(e,_)}):d.push({point:i[h],dis1:zwc.engine.core.displays.world.terrain.TileUtils.getPtDis(t,_),dis2:zwc.engine.core.displays.world.terrain.TileUtils.getPtDis(e,_)}))}return u.sortOn(["dis1","dis2"],[Array.NUMERIC,Array.NUMERIC]),n.length?n[0].point:0==n.length&&d.length?d[0].point:zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(t)},e.getDepthLoopSun=function(e,t){void 0===e&&(e=1),void 0===t&&(t=0);for(var i=t+(e-=1),n=0,s=t;s<=i;s++)n+=zwc.engine.core.displays.world.terrain.TileUtils.getDepthLoopValue(s);return n},e.getDepthLoopValue=function(e){if(0==e)return 1;var t=Math.pow(2*e+1,2)-Math.pow(2*e+1-2,2);return 0==t?1:t},e.pixelsToTile=function(e,t,i){var n=parseInt((e/80).toString()),s=parseInt((t/40).toString());return i?(i.x=n,i.y=s,i):new Uh(n,s)},e.pixelsAlginTile=function(e,t,i){var n=80*Math.floor(e/80)+40,s=40*Math.floor(t/40)+20;if(i)return i.x=n,i.y=s,i;var o=new Uh;return o.x=n,o.y=s,o},e.tileToPixels=function(e,t){var i=Math.floor(80*e.x+40),n=Math.floor(40*e.y+20);return t?(t.x=i,t.y=n,t):new Uh(i,n)},e.tileToPixelsByXY=function(e,t){var i=Math.floor(80*e+40),n=Math.floor(40*t+20);return new Uh(i,n)},e.getGridBoundsPointByDir=function(e,t){var i=zwc.engine.core.displays.world.terrain.TileUtils.pixelsToTile(e.x,e.y),n=new Uh;return 0==t?(n.x=e.x,n.y=e.y-20):1==t?zwc.engine.core.displays.world.terrain.TileUtils.getTileTopRightPoint(i,n):2==t?(n.x=e.x+40-2,n.y=e.y):3==t?zwc.engine.core.displays.world.terrain.TileUtils.getTileBottomRightPoint(i,n):4==t?(n.x=e.x,n.y=e.y+20-2):5==t?zwc.engine.core.displays.world.terrain.TileUtils.getTileBottomLeftPoint(i,n):6==t?(n.x=e.x-40,n.y=e.y):7==t&&zwc.engine.core.displays.world.terrain.TileUtils.getTileTopLeftPoint(i,n),n},e.getTileTopLeftPoint=function(e,t){var i=80*e.x,n=40*e.y;return t&&(t.x=i,t.y=n),new Uh(i,n)},e.getTileTopRightPoint=function(e,t){var i=80*(e.x+1),n=40*e.y;return t&&(t.x=i,t.y=n),new Uh(i,n)},e.getTileBottomRightPoint=function(e,t){var i=80*(e.x+1),n=40*(e.y+1);return t&&(t.x=i,t.y=n),new Uh(i,n)},e.getTileBottomLeftPoint=function(e,t){var i=80*e.x,n=40*(e.y+1);return t&&(t.x=i,t.y=n),new Uh(i,n)},e.getTileMidVertex=function(e,t){return zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e,t)},e.getTileLeftVertex=function(e,t){var i=zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e);return null==t&&(t=i),t.x=i.x-40,t.y=i.y,t},e.getTileTopVertex=function(e,t){var i=zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e);return null==t&&(t=i),t.x=i.x,t.y=i.y-20,t},e.getTileRightVertex=function(e,t){var i=zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e);return null==t&&(t=i),t.x=i.x+40,t.y=i.y,t},e.getTileBottomVertex=function(e,t){var i=zwc.engine.core.displays.world.terrain.TileUtils.tileToPixels(e);return null==t&&(t=i),t.x=i.x,t.y=i.y+20,t},e.drawTile=function(e,t,i,n,s,o,a){void 0===s&&(s=!1),void 0===o&&(o=0),void 0===a&&(a=.5);var r=zwc.engine.core.displays.world.terrain.TileUtils.pixelsToTile(t,i);t=r.x,i=r.y},e.loop_break=null,e}()),RB=function(){function e(){}return b(e,"zwc.engine.global.AptConst",null,"AptConst$1"),e.RENDER_NEXT_TIME=1,e.RENDER_NOW=2,e.RENDER_NOMOVE=3,e.AP_CharBody="charBody_part",e.AP_Body="body_part",e.AP_Effect="effect_part",e.AP_Shadow="shadow_part",e.layer_body_top="body_top",e.layer_body_bottom="body_bottom",e.layer_top="top",e.layer_bottom="bottom",e.bmd_mid="mid",e.bmd_wgid="wgid",e.bmd_wid="wid",e.bmd_eid="eid",e.bmd_wmid="wmid",f(e,["loopActions",function(){return this.loopActions=["warm","stand","run","walk"]},"DefaultDepths",function(){return this.DefaultDepths=[["wid","mid","wgid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"],["mid","wgid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"]]},"AttackDepths",function(){return this.AttackDepths=[["wid","mid","wgid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wid","wgid","mid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"]]},"DeathDepths",function(){return this.DeathDepths=[["wid","mid","wgid","eid","chuanshiid"],["mid","wid","wgid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wid","mid","wgid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wgid","mid","wid","eid","chuanshiid"],["wid","mid","wgid","eid","chuanshiid"]]},"actDepths",function(){return this.actDepths={stand:zwc.engine.global.AptConst.DefaultDepths,attack:zwc.engine.global.AptConst.AttackDepths,walk:zwc.engine.global.AptConst.DefaultDepths,run:zwc.engine.global.AptConst.DefaultDepths,hit:zwc.engine.global.AptConst.DefaultDepths,skill:zwc.engine.global.AptConst.DefaultDepths,warm:zwc.engine.global.AptConst.AttackDepths,skillWarm:zwc.engine.global.AptConst.DefaultDepths,death:zwc.engine.global.AptConst.DeathDepths}},"idPart",function(){return this.idPart={mid:"mid",wid:"wid",wgid:"wgid",eid:"eid",chuanshiid:"eid"}}]),e}(),NB=function(){function t(){}return b(t,"zwc.engine.global.EGlobal",null,"EGlobal$1"),t.getSceneImagePath=function(e){return t.IMAGE_DIR+"ui/images/"+e},t.getActDataPath=function(e){return zwc.engine.global.EGlobal.ASSET_DIR+"output/"+e+"."+zwc.engine.global.EGlobal.actDataExtension},t.getAvatarTexturePath=function(e,t,i,n){return zwc.engine.global.EGlobal.ASSET_DIR+zwc.engine.global.EGlobal.ReflexDIR[e]+"/"+t+"/"+i+"/"+n+"."+zwc.engine.global.EGlobal.avatarTextureExtension},t.BODY_HEIGHT=130,t.logText=null,t.version="",t.clientVersion="",t.mainVersion="",t.language=null,t.mid="mid",t.wid="wid",t.wgid="wgid",t.eid="eid",t.chuanshiid="chuanshiid",t.midm="midm",t.fid="fid",t.shoawd="shoawd",t.stage=null,t.defaultAvatarMid="ds1000",t.avatarDataBaseMale=null,t.avatarDataBaseFamale=null,t.shadowAvatarGroupBaseMale=null,t.shadowAvatarGroupBaseFamale=null,t.BITMAP_WIDTH=400,t.BITMAP_HEIGHT=300,t.Image_Width=512,t.Image_Height=512,t.IMAGE_DIR=null,t.UiTextureSheet=null,t.selectTexture=null,t.showadTexture=null,t.boolTexture=null,t.innerTexture=null,t.boolHeroTexture=null,t.boolBackgroundTexture=null,t.boolTextureQueue=[],t.selectEffect=null,t.selectGreenEffect=null,t.selectYellowEffect=null,t.isAllStop=!1,t.isSceneReady=!1,t.ASSETS_CATCHE_GROUP="ASSETS_CATCHE_GROUP",t.ASSETS_SCENE_GROUP="ASSETS_SCENE_GROUP",t.ASSETS_TERRAIN_GROUP="ASSETS_TERRAIN_GROUP",t.actDataExtension="sm",t.avatarTextureExtension="png",t.AVATARS="avatars_",t.ASSET_DIR=null,f(t,["ReflexDIR",function(){return this.ReflexDIR={mid:"clothes",wgid:"wings",wid:"weapons",eid:"effects",wmid:"mounts"}}]),t}(),BB=function(){function t(){}return b(t,"zwc.Engine",null,"Engine$1"),p(1,t,"heidOtherCharMode",function(){return t._heidOtherCharMode||t._auto_heidOtherCharMode},function(e){t._heidOtherCharMode=e}),p(1,t,"heidOtherHeroMode",function(){return t._heidOtherHeroMode},function(e){t._heidOtherHeroMode=e}),t.loop=function(){},t.isInBIQI=function(){return uH.Ins().currCid==_a.S_BIQI.toString()},t.isShaozhu=function(){var e=parseInt(uH.Ins().currCid);return 5020==e||-1!=_a.S_PIG_SCENE.indexOf(e)},t._setup_=function(){yH.Ins()||new yH},t.getTimer=function(){return(pt.now()-t._runtime_)*zwc.Engine.accSpeed},t.trace=function(e){for(var t=arguments,i="",n=0;n<t.length;n++)i+=t[n]+" ";console.log(i)},t.distance=function(e,t){return e.distance(t.x,t.y)},t.isDirMode5=!0,t.IsModePVE=!0,t.accSpeed=1,t.actSpeed=1,t.defaultActSpeed=.9,t.stage=null,t._heidOtherCharMode=!1,t._auto_heidOtherCharMode=!1,t._auto_heidOtherHeroMode=!1,t._heidOtherHeroMode=!1,t.attackMonsterMode=0,t.countIndex=6,t.set_limi_Dur=-1,t.fpsDurArray=[],t.isSoundAdurationMode=1,t.soundAduration=1e3,f(t,["_runtime_",function(){return this._runtime_=pt.now()}]),t}(),HB=function(){function n(){}return b(n,"zwc.utils.FPSUtils",null,"FPSUtils$1"),p(1,n,"fps",function(){return n._fps}),p(1,n,"lost_fps",function(){return n._lost_fps}),n.setup=function(e){n._fps=Math.round(e.frameRate),n.fpsTime=BB.getTimer(),n.fpsTime2=BB.getTimer(),e.timer.frameLoop(1,n,n.onEnterFrame),n.stage=e,n.count=0,n.count2=0},n.onEnterFrame=function(e){n.count++,n.count2++;var t=BB.getTimer();if(10<=n.count){n._fps=Math.round(1e4/(t-n.fpsTime));var i=parseInt(n.stage.frameRate)-n._fps;n._lost_fps=0<i?i:0,n.count=0,n.fpsTime=t}n.frameFps=Math.round(1e3/(t-n.fpsTime2)),n.fpsTime2=t,nH.loop()},n._fps=30,n.fpsTime=0,n.fpsTime2=0,n.count=0,n.count2=0,n.maxCount=10,n.stage=null,n._lost_fps=0,n.frameFps=0,n}(),VB=function(){function e(){}return b(e,"zwc.utils.LinearUtils",null,"LinearUtils$1"),e.lineAttck=function(e,t,i){if(void 0===i&&(i=80),!e||!t)return[];e.x,e.y;for(var n,s=[],o=ol.distance(e,t)/i,a=0;a<o;a++)n=ol.interpolate(e,t,1-a/o),s.push(n);return s},e.getReverseDir=function(e){return[4,5,6,7,0,1,2,3][e]},e.pointForRadial=function(e,t,i){var n=i,s=t.x-e.x,o=t.y-e.y,a=Math.atan2(o,s),r=e.x+Math.cos(a)*n,l=e.y+Math.sin(a)*n;return new Uh(r,l)},e.pointBetweenPoint=function(e,t,i){var n=ol.distance(e,t);return n<=i?zwc.utils.LinearUtils.extensionPoint(t,e,i-n):ol.interpolate(e,t,i/n)},e.extensionPoint=function(e,t,i){if(!e||!t)return null;var n=ol.distance(e,t),s=t.x+i/n*(t.x-e.x),o=t.y+i/n*(t.y-e.y);return new Uh(s,o)},e.lineSectorAttack=function(e,t,i,n,s){if(void 0===n&&(n=3),void 0===s&&(s=200),!e||!t)return[];for(var o=zwc.utils.LinearUtils.sectorAttack(e,t,i,n,s),a=[],r=0;r<o.length;r++)a[r]=zwc.utils.LinearUtils.lineAttck(e,o[r]);return a},e.sectorAttack=function(e,t,i,n,s){void 0===n&&(n=3),void 0===s&&(s=200);var o=i;if(o<=0)return[];360<o&&(o=360),o=Math.PI/180*o;var a=e.x,r=e.y,l=ol.distance(e,t),c=t.x-e.x,u=t.y-e.y,d=Math.atan2(u,c),h=180*d/Math.PI;h-=i/2;var _=o/n,f=l/Math.cos(_/2),p=h*Math.PI/180;if(-1!=s&&l<s){l=s;var g=a+Math.cos(p)*l,v=r+Math.sin(p)*l;t.x=g,t.y=v,c=t.x-e.x,u=t.y-e.y,h=180*(d=Math.atan2(u,c))/Math.PI,h-=i/2,_=o/n,f=l/Math.cos(_/2),p=h*Math.PI/180}var m=NaN,y=NaN,I=a+Math.cos(p)*l,b=r+Math.sin(p)*l,w=[];w.push(new Uh(I,b));for(var x=0;x<n;x++){p+=_,a+Math.cos(p-_/2)*f,r+Math.sin(p-_/2)*f,m=a+Math.cos(p)*l,y=r+Math.sin(p)*l;var S=new Uh(m,y);w.push(S)}return w},e.pointIntr=function(e,t,i,n){var s=(e.x-i.x)*(t.y-i.y)-(e.y-i.y)*(t.x-i.x),o=(e.x-n.x)*(t.y-n.y)-(e.y-n.y)*(t.x-n.x);if(0<=s*o)return null;var a=(i.x-e.x)*(n.y-e.y)-(i.y-e.y)*(n.x-e.x);if(0<=a*(a+s-o))return null;var r=a/(o-s),l=r*(t.x-e.x),c=r*(t.y-e.y);return new Uh(e.x+l,e.y+c)},e.dirExtensionPoint=function(e,t,i){var n=zwc.utils.LinearUtils.getAngle(e),s=Math.PI/180*n,o=t+Math.cos(s),a=i+Math.sin(s);return new Uh(o,a)},e.getTileByDir=function(e,t,i){e=new Uh(e.x,e.y),i*=0==t||4==t?40:80;var n=new Uh(e.x,e.y);e=PB.tileToPixels(e,e);var s=new Uh;0==t?(s.x=e.x,s.y=e.y-20):1==t?PB.getTileTopRightPoint(n,s):2==t?(s.x=e.x+40-2,s.y=e.y):3==t?PB.getTileBottomRightPoint(n,s):4==t?(s.x=e.x,s.y=e.y+20-2):5==t?PB.getTileBottomLeftPoint(n,s):6==t?(s.x=e.x-40,s.y=e.y):7==t&&PB.getTileTopLeftPoint(n,s);var o=zwc.utils.LinearUtils.extensionPoint(e,s,i);return o=PB.pixelsAlginTile(o.x,o.y)},e.getAngle=function(e){switch(e){case 0:return-90;case 1:return-45;case 2:return 0;case 3:return 45;case 4:return 90;case 5:return 135;case 6:return-175;case 7:return-135}return 0},e.getAnglebyDir=function(e,t){var i=new Uh(e.x,e.y);e=PB.tileToPixels(e,e);var n=new Uh;0==t?(n.x=e.x,n.y=e.y-20):1==t?PB.getTileTopRightPoint(i,n):2==t?(n.x=e.x+40-2,n.y=e.y):3==t?PB.getTileBottomRightPoint(i,n):4==t?(n.x=e.x,n.y=e.y+20-2):5==t?PB.getTileBottomLeftPoint(i,n):6==t?(n.x=e.x-40,n.y=e.y):7==t&&PB.getTileTopLeftPoint(i,n);var s=PB.getTileMidVertex(i),o=s.x-n.x,a=s.y-n.y;return 180*Math.atan2(a,o)/Math.PI},e.getDretion=function(e,t,i,n){var s=NaN,o=e-i,a=t-n,r=180*Math.atan2(a,o)/Math.PI;return-22<=r&&r<22?s=6:22<=r&&r<67?s=7:67<=r&&r<112?s=0:112<=r&&r<157?s=1:157<=r||r<-157?s=2:-157<=r&&r<-112?s=3:-112<=r&&r<-67?s=4:-67<=r&&r<-22&&(s=5),s},e.getCharDir=function(e,t,i,n){return zwc.utils.LinearUtils.getDretion(e,t,i,n)},e}(),GB=function(s){function n(e,t){var i=this;i._isDestroy=!1,i._url=null,i._reference=0,i._loaded=!1,i._inFrame=!1,i._content=null,i._test=!1,n.__super.call(i),n._asset_prop!=t&&console.log("abstract class!!!"),i._url=e,i._content=G.loader.getRes(e),i._content?i._loaded=!0:G.loader.load(i._url,ql.create(i,i._eventComplete),null,null,0),n.testReg&&(i._test=n.testReg.test(i._url))}b(n,"global.Asset",s,"Asset$1");var e=n.prototype;return e._retain=function(){this._isDestroy&&console.log("asset has been destroyed!!!"),this._reference++,this._test&&xs.printStack(" >>>Asset.retain = "+this._reference+" <<<"+this._url)},e._release=function(){var e=this;e._isDestroy&&console.log("asset has been destroyed!!!"),e._reference--,e._test&&xs.printStack(" >>>Asset.release = "+e._reference+" <<<"+e._url),0==e._reference&&NP.isClearTexture(e._url)&&0<=e._url.indexOf("layouts")&&0<e._url.indexOf(".atlas")&&(delete n._map[e._url],e._loaded?n._addDestroy(e._url):G.loader.cancelLoadByUrl(e._url),e._url=null,e._content=null,e.offAll(),e._isDestroy=!0)},e.getRes=function(){return this._isDestroy&&console.log("asset has been destroyed!!!"),this._content},e.on=function(e,t,i,n){return this._isDestroy&&console.log("asset has been destroyed!!!"),this.once(e,t,i,n)},e.once=function(e,t,i,n){return this._isDestroy&&console.log("asset has been destroyed!!!"),this._loaded&&!this._inFrame&&(this._inFrame=!0,G.timer.callLater(this,this._eventComplete)),s.prototype.once.call(this,e,t,i,n)},e._eventComplete=function(){var e=this;e._inFrame=!1,e._loaded=!0,e._content=G.loader.getRes(e.url),e._content&&e._content instanceof laya.resource.Texture&&e._content.bitmap&&(e._content.bitmap.enableMerageInAtlas=!1),e.event("complete",e)},p(0,e,"url",function(){return this._isDestroy&&console.log("asset has been destroyed!!!"),this._url}),p(0,e,"loaded",function(){return this._isDestroy&&console.log("asset has been destroyed!!!"),this._loaded}),p(0,e,"isDestroy",function(){return this._isDestroy}),n.retain=function(e){var t=n._map[e];return null==t&&(n._destroyMap[e]&&(delete n._destroyMap[e],n._destroyQueue.splice(n._destroyQueue.indexOf(e),1),0==n._destroyQueue.length&&G.timer.clear(n,n._destroyThread)),t=n._map[e]=new n(e,n._asset_prop)),t._retain(),t},n.release=function(e){var t="string"==typeof e?n._map[e]:e;t?t._release():"string"==typeof e&&e.indexOf("basic_ui")<0&&e.indexOf("base_ui2")},n.has=function(e){return null!=n._map[e]},n.hasLoaded=function(e){var t=n._map[e];return t&&t.loaded},n.faseDestroy=function(e){void 0===e&&(e=200),0<n._destroyQueue.length&&G.timer.loop(e,n,n._destroyThread,null,!0)},n._addDestroy=function(e){n._destroyMap[e]||(n._destroyMap[e]=!0,n._destroyQueue.push(e),0<n._destroyQueue.length&&G.timer.loop(20,n,n._destroyThread))},n._destroyThread=function(){var e=n._destroyQueue.shift();delete n._destroyMap[e],G.loader.clearRes(e),0==n._destroyQueue.length&&G.timer.clear(n,n._destroyThread)},n._destroyQueue=[],n._destroyMap={},n.testReg=null,f(n,["_asset_prop",function(){return this._asset_prop=xs.getSoleProperty()},"_map",function(){return this._map=Object.create(null)}]),n}(ba),UB=function(e){function u(){var e=this;e.musicVolume=1,e.soundVolume=1,e.muted=!1,e.soundMuted=!1,e.autoStopMusic=!0,e._enabled=!1,e._soundEnabled=!1,e._sound=null,e.SOUND_PRIORITY_FIRST=0,e.SOUND_PRIORITY_MONSTER=3,e._lastPanelSound=0,e._lastPanelIns=null,e.specialPanelID=["MALL_PANEL","LIMIT_CHALLENGE_MAIN_VIEW","SPORTS_MAIN_VIEW"],e._lastTabSound=0,e.soundDurHash=new jl,u.__super.call(e)}b(u,"global.sound.SoundUtil",ba);var t=u.prototype;return t.setup=function(){this._sound=GP.ins,UP.ins.sound=this._sound,this._sound.setup(void 0),FP.ins.setup()},t.start=function(){G.timer.frameLoop(2,this,this.onFrame)},t.playSound=function(e,t,i,n,s,o,a,r,l){return void 0===t&&(t=1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===r&&(r=!1),void 0===l&&(l=this.SOUND_PRIORITY_FIRST),this._soundEnabled&&e&&0!=e&&"0"!=e?this._sound.play(e,t,i,n,s,o,a,l):null},t.pause=function(e){this._sound.pause(e)},t.resume=function(e){this._sound.resume(e)},t.stop=function(e){this._sound.stop(e)},t.getTest=function(){var e=!this.muted&&this._sound.ready&&(!this.autoStopMusic||G.stage.isVisibility&&G.stage.isFocused),t="en="+e+" ts="+(e&&!this.soundMuted&&0<this.soundVolume);return t+=" isV"+G.stage.isVisibility,t+=" isF"+G.stage.isFocused},t.onFrame=function(){var e=this,t=!e.muted&&e._sound.ready&&(!e.autoStopMusic||G.stage.isVisibility&&SF.GetIntance().isConnect),i=t&&!e.soundMuted&&.1<=e.soundVolume;e._enabled==t&&e._soundEnabled==i||(e._enabled=t,e._soundEnabled=i,e._soundEnabled||e._sound.stopAll(),e.event("changed")),e._soundEnabled&&e._sound.volume!=e.soundVolume&&(e._sound.volume=e.soundVolume)},t.getUrl=function(e){return v_.isConchApp?_r.getFullUrl("sound/app/"+e+".ogg"):_r.getFullUrl("sound/"+e+".mp3")},t._playBackpackNot=function(){this.playSound("vo_1")},t._playCoinNot=function(){this.playSound("vo_2")},t._playLevelNot=function(){this.playSound("vo_3")},t._playMonsterSound=function(e,t){if(this.soundEnabled&&2!=BB.isSoundAdurationMode){var i=hn.getIndex(e);if(null!=i){var n=hn.MODEL.muId(i);i=_n.getIndex(n);var s=0;if(1==t?s=_n.MODEL.musicStay(i):3==t&&(s=_n.MODEL.musicDead(i)),0<s){if(u.soundLimit(s))return;this.playSound(s,1,!1,0,1,0,!0,!0,this.SOUND_PRIORITY_MONSTER)}}}},t._playSkillSound=function(e,t,i){if(2!=BB.isSoundAdurationMode&&this.soundEnabled&&!((t|=0)<1||(0|e)<=0)){var n=Vn.getIndex(e);if(null!=n){var s=gR.ins.actorById(t);if(s){var o,a,r=Vn.MODEL.sound_play(n);if(r){var l=r.split(",");if(2==l.length){if(o=l[(2==s.sex?2:1)-1],u.soundLimit(o))return;this.playSound(o,2,!0)}}var c=Vn.MODEL.sound_hit(n);if(c&&0<(l=c.split(",")).length){if(a=l[0],u.soundLimit(a))return;this.playSound(a,2,!0,i)}}}}},t._playPickupSound=function(e){if(this.soundEnabled){var t=0;if(15==e)t=90003;else{var i=Bi.getIndex(e);if(0<=i){var n=Bi.MODEL.type(i);1==n?t=90004:2==n&&(t=90007)}}this.playSound(t,2,!0)}},t._playPanelSound=function(){var e=pt.now();e-this._lastPanelSound<40||(this._lastPanelSound=e,global.sound.SoundUtil.ins.playSound(90101,2,!0))},t.isSpecialPanelSound=function(e){return 0<=this.specialPanelID.indexOf(e)},t.playTabSound=function(e){if(e&&0<e.length){var t=pt.now();if(t-this._lastTabSound<40)return;this._lastTabSound=t,this.playSound(e)}},t._playCharDeath=function(e){if(e&&0<e.hero_id&&e.hero_id<4){var t=gR.ins.actorList[e.hero_id-1];t&&(1==t.sex?this.playSound("144"):this.playSound("145"))}},p(0,t,"enabled",function(){return this._enabled}),p(0,t,"soundEnabled",function(){return this._soundEnabled}),p(1,u,"ins",function(){return u._ins||(u._ins=new u)},laya.events.EventDispatcher._$SET_ins),u.soundLimit=function(e){if(1==BB.isSoundAdurationMode&&"002"!=e)if(this.soundDurHash.has(e)){var t=this.soundDurHash.take(e);if(BB.getTimer()-t<BB.soundAduration)return!0;this.soundDurHash.put(e,BB.getTimer(),!0)}else this.soundDurHash.put(e,BB.getTimer());return!1},u._ins=null,f(u,["soundDurHash",function(){return this.soundDurHash=new jl}]),u}(),FB=function(e){function o(){o.__super.call(this),EB.polyfill()}b(o,"global.GameInit",$h,"GameInit$1");var t=o.prototype;return t.initOption=function(){var e=null,t=null;if(0==hr.clientGate?(e=getGlobalParams(),hr.globalParams=e,t=getRequest(),hr.webGetParams=t):(e=hr.globalParams,t=hr.webGetParams),e){if(0==hr.clientGate){if(e.hasOwnProperty("socket_ip")&&(hr.socket_host=e.socket_ip),e.hasOwnProperty("socket_port")&&(hr.socket_port=e.socket_port),e.hasOwnProperty("serverID")&&(hr.serverID=e.serverID),e.hasOwnProperty("client")&&(hr.client=e.client),e.hasOwnProperty("host")&&(_r.host=pt.window.GlobalParams.host),30==hr.client&&(e.time&&0<e.time.length&&(hr.serverTime=e.time),e.sign&&0<e.sign.length&&(hr.sign=e.sign),e.cdn&&0<e.cdn.length)){var i=e.cdn.split(";");_r.host=i[0]+"resources/",hr.cdns=i}e.appversion&&0<e.appversion.length&&(hr.appVersion=e.appversion)}e.hasOwnProperty("query_subscribe")&&(hr.query_subscribe=e.query_subscribe),e.hasOwnProperty("importServerUrl")&&(hr.importServerUrl=e.importServerUrl),e.hasOwnProperty("getServerListUrl")&&(hr.getServerListUrl=e.getServerListUrl),e.hasOwnProperty("pNoteUrl")&&(hr.pNoteUrl=e.pNoteUrl),e.hasOwnProperty("token")&&(hr.token=e.token),e.hasOwnProperty("clickUrl")&&(hr.clickUrl=e.clickUrl,hr.clickUrl=e_.changeProtocalByString(hr.clickUrl)),e.hasOwnProperty("bigClickUrl")&&(hr.bigClickUrl=e.bigClickUrl,hr.bigClickUrl=e_.changeProtocalByString(hr.bigClickUrl)),e.hasOwnProperty("adminClickStream")&&(hr.adminClickStream=e.adminClickStream),t&&(t.hasOwnProperty("uid")&&t.uid&&t.uid.length&&(hr.uid=t.uid),t.hasOwnProperty("time")&&t.time&&t.time.length&&(hr.platformTime=t.time),t.hasOwnProperty("sign")&&t.sign&&t.sign.length&&(hr.platformSign=t.sign),t.hasOwnProperty("is_adult")&&t.is_adult&&t.is_adult.length&&(hr.platformAdult=t.is_adult),0==hr.clientGate&&(t.hasOwnProperty("ip")&&t.ip&&t.ip.length&&(hr.socket_host=t.ip),t.hasOwnProperty("port")&&t.port&&t.port.length&&(hr.socket_port=t.port),t.hasOwnProperty("sid")&&t.sid&&t.sid.length&&(hr.serverID=t.sid),t.hasOwnProperty("client_type")&&(1==t.client_type?hr.client=10:2==t.client_type&&(hr.client=20))),t.hasOwnProperty("guid")&&t.guid&&t.guid.length&&(hr.guid=t.guid),t.hasOwnProperty("appid")&&t.appid&&t.appid.length&&(hr.platform=hr.pid=hr.appid=t.appid),t.hasOwnProperty("game_id")&&t.game_id&&t.game_id.length&&(hr.gid=t.game_id),t.hasOwnProperty("rechargeModel")&&t.rechargeModel&&t.rechargeModel.length&&(dr.rechargeModel=parseInt(t.rechargeModel))),Rg.basePath=_r.host}},t.initErrorLisenter=function(){pt.window.onerror=function(e,t,i,n,s){return("Script error"==e||t)&&G.timer.once(0,o,global.GameInit.GlobalErrorHander,[e,t,i,n,s]),!0}},t.initGame=function(){this.initErrorLisenter(),Rg.basePath=_r.host,this.initOption(),NB.IMAGE_DIR=_r.host+"ui/",NB.ASSET_DIR=NB.IMAGE_DIR+NB.AVATARS+"/",OH.setup(),Ds.setup(),od.setup(SN.moduleClass,SF),Tu.sendToTotalModule("__ENGIN_READY__"),HB.setup(G.stage),NB.stage=G.stage,dr.isConchApp||(G.stage.on("focus",this,this.onFocus),G.stage.on("blur",this,this.onBlur)),Tu.sendToModule("__TO_LOGIN__",["modules.login.LoginModule"]),RH.instance().setup(),UB.ins.setup(),zp.colorUrlHandler=ql.create(null,function(e){return"#"==e.charAt(0)&&(e=e.substr(1)),_r.getAtlasSubPath("color/c_"+e+".png")},null,!1),G.stage.on("resize",this,this.onResize),m_.ins.pushInfo("agent:"+pt.userAgent),m_.ins.pushInfo("size:"+G.stage.width+"x"+G.stage.height),tr.push("agent:"+pt.userAgent),tr.push("size:"+G.stage.width+"x"+G.stage.height),G.stage.on("mousedown",this,this.onMouseDown)},t.onMouseDown=function(){m_.ins.pushInfo("mousedown:"+G.stage.mouseX+"x"+G.stage.mouseY)},t.onBlur=function(e){dr.isSleep=!0,m_.ins.pushInfo("onblur:true"),Tu.sendToTotalModule("APP_ONBLUR")},t.onFocus=function(e){dr.isSleep=!1,m_.ins.pushInfo("onblur:false"),Tu.sendToTotalModule("APP_ONFOCUS")},t.onResize=function(){G.timer.once(100,this,this.doResize)},t.doResize=function(){m_.ins.pushInfo("size:"+G.stage.width+"x"+G.stage.height),tr.push("size:"+G.stage.width+"x"+G.stage.height),Tu.sendToTotalModule("resize")},o.getIntance=function(){return null==global.GameInit._intance_&&(global.GameInit._intance_=new o),global.GameInit._intance_},o.GlobalErrorHander=function(e,t,i,n,s){var o={url:t,line:i,col:n,msg:e};if(n=n||pt.window.event&&pt.window.errorCharacter||0,s&&s.stack)o.msg=s.stack.toString();else if(arguments.callee){for(var a=[],r=arguments.callee.caller,l=3;r&&0<--l&&(a.push(r.toString()),r!==r.caller);)r=r.caller;a=a.join(","),o.msg=s.stack.toString()}alert(o.msg)},o.todo=function(e){},o._intance_=null,o.ErrorMsgCodeArray=[],o}(),qB=function(e){function t(){this._jss=[],t.__super.call(this)}b(t,"global.UpdateOtherJxrUtils",$h);var i=t.prototype;return i.reLdOtCfg=function(){this._jss.push({url:_r.getDBPath("ConfigGoods_other"),classStr:"CGoodsModel",t:1e3,add:!0}),this._jss.push({url:_r.getDBPath("MissionResource_other"),classStr:"CMissionModel",t:3e3,add:!0}),this._jss=this._jss.concat(jB.NODO),G.timer.once(3e3,this,this.starLoad)},i.starLoad=function(){for(var e=0;e<4;e++)this.load_other(1<e)},i.load_other=function(e){if(void 0===e&&(e=!0),!(this._jss.length<=0)){var t=this._jss.shift();console.log(this._jss.length),t.hasOwnProperty("t")||(t.t=2e3),t.hasOwnProperty("add")||(t.add=!1);var i=[{url:t.url,type:"arraybuffer",classStr:t.classStr,time:t.t,add:t.add,open:e}];G.loader.load(i,ql.create(this,this.onLoad,i),null,"arraybuffer")}},i.onLoad=function(e){e.add?this.onLdNDAdd(e):this.onLdND(e),e.open&&G.timer.once(e.time,this,this.load_other,[!0])},i.onLdND=function(e){var t=G.loader.getRes(e.url),i=fs.getClass("protos.db."+e.classStr);if(t&&i.count<=0){i.setup(e.url);for(var n=i.count,s=0;s<n;s++)i.config(s)}G.loader.clearRes(e.url)},i.onLdNDAdd=function(e){var t=fs.getClass("protos.db."+e.classStr),i=G.loader.getRes(e.url);if(i){t.bytes=new mt(i);for(var n=t.bytes.readShort(),s=0;s<n;s++)t.config(t.count+s);t.count=t.count+n,G.loader.clearRes(e.url)}},t.getIntance=function(){return null==t._ins&&(t._ins=new t),t._ins},t._ins=null,t}(),jB=function(e){function l(){var e=this;e.paths=[],e.configClass=[],e.statusType=0,e.persent=0,e.loadedCount=0,e.loadedPartTotal=4,e.sMax=3,e.loadingList=[],e.configNum=5e3,e.configIndex=0,e.currConut=0,e.count=0,e.logErrors=[],l.__super.call(e)}b(l,"global.UpdateResUtils",$h,"UpdateResUtils$1");var t=l.prototype;return t.setup=function(){0<dr.xgame&&(this.sMax=8),G.timer.frameLoop(1,this,this.doShowLoading),this.statusType=1,HP.loadConfig(["update"],["Update"],ql.create(this,this._onUpdateLoaded),ql.create(this,this.onLoadingUpdate))},t.onLoadingUpdate=function(e){this.persent=e},t.doShowLoading=function(){var e=this;1<=e.persent&&(3==e.statusType?e.persent=1:e.persent=0);var t=0,i=RP.n[96];if(1==e.statusType)return t=100*e.persent,i=RP.n[97]+t.toFixed(2)+"%",void e.showLoading(i,e.persent);if(2==e.statusType){var n=e.loadedCount/Ng.count;return t=100*n,i=RP.n[98]+t.toFixed(2)+"%",void e.showLoading(i,n)}if(3==e.statusType)return t=100*e.persent,i=RP.n[99]+t.toFixed(2)+"%",void e.showLoading(i,e.persent);4==e.statusType&&(i=RP.n[100]),e.showLoading(i,e.persent),e.persent+=.02*Math.random()},t._onUpdateLoaded=function(){var e=this;e.statusType=1;for(var t,i=0;i<Ng.count;++i){var n=Ng.MODEL.key(i),s=Ng.getIndex(n),o=Ng.MODEL.source(s),a=Ng.MODEL.opration(s),r=Ng.MODEL.classStr(s);_r.justCreated&&2==a?((t=new Object).url=_r.getFullUrl(o),r&&""!=r&&null!=r&&(t.classStr=r),"ExchangeResource"==r&&l.NODO.unshift(t),"ConfigBuff"==r?l.NODO.unshift(t):l.NODO.push(t)):(o=e.checkIsNew(o,a),e.paths.push({url:_r.getFullUrl(o),type:Ng.MODEL.type(s)}),r&&""!=r&&null!=r&&e.configClass.push({url:_r.getFullUrl(o),classStr:r}))}e.paths.push({url:_r.getFullUrl("db/configs/gk_config.jxr"),type:"arraybuffer"}),e.configClass.push({url:_r.getFullUrl("db/configs/gk_config.jxr"),classStr:"CGKModel"}),0<e.paths.length&&(e.statusType=2,G.timer.once(200,e,e.startLoadJxr))},t.startLoadJxr=function(){G.timer.frameLoop(1,this,this.loopLoadHandler)},t.loopLoadHandler=function(){var e=this;if(!(0<e.loadingList.length)){for(var t=pt.now(),i=0;i<e.sMax;i++)if(e.loadedCount<e.paths.length){var n=e.paths[e.loadedCount].url;e.loadingList.push(n),G.loader.load([e.paths[e.loadedCount]],ql.create(e,e.loopOneLoaded,[n,t])),e.loadedCount++}e.loadingList.length<=0&&(G.timer.clear(e,e.loopLoadHandler),e._onConfigLoaded())}},t.loopOneLoaded=function(e,t){var i=this.loadingList.indexOf(e);0<=i&&this.loadingList.splice(i,1)},t._onConfigLoaded=function(){nr.log(">>>>> loaded end"),this.loadedCount=Ng.count,xs.mirClick(13,hr.pid,hr.uid),this.onDoPraConfig()},t.doShowCreateRole=function(){G.timer.clear(this,this.doShowLoading),Tu.sendToModule("SHOWCREATEROLE",["modules.login.LoginModule"])},t.doLoadCreateRole=function(e){this.statusType=4},t.onDoPraConfig=function(){xs.mirClick(14,hr.pid,hr.uid),this.statusType=3,this.count=0;for(var e=this.persent=0;e<this.configClass.length;++e){var t=this.configClass[e],i=fs.getClass("protos.db."+t.classStr);i&&(i.setup(t.url),t.count=i.count,this.count+=i.count,t.index=0)}G.timer.frameLoop(1,this,this.onConfigHandler),this.configIndex=0},t.onConfigHandler=function(){for(var t=this,e=BB.getTimer(),i=0;i<t.configNum;++i){if(t.configIndex>=t.configClass.length)return G.timer.clear(t,t.onConfigHandler),void t.onEnterGame();var n=t.configClass[t.configIndex];if(n){var s=fs.getClass("protos.db."+n.classStr);if(s)try{s.config(n.index),n.index++,t.currConut++}catch(e){var o=t.configIndex+"_"+n.classStr+"_"+n.index;t.logErrors.indexOf(o)<0&&(t.logErrors.push(o),console.log("配置异常： run onConfigHandler:"+t.configIndex+",protos.db."+n.classStr+",obj.index:"+n.index))}n.index==n.count&&(G.loader.clearRes(n.url,!0),s.buff=null,s.bytes&&s.bytes.clear(),s.bytes=null,t.configIndex++);t.configClass.length}if(t.persent=t.currConut/t.count,20<BB.getTimer()-e)break}},t.showLoading=function(e,t){void 0===t&&(t=.5);var i=0<hr.clientGate||_r.isCreated?3:4,n="",s=.5;if(0<Ng.count){var o=0,a=this.loadedPartTotal+i-1;this.loadedCount==Ng.count?o=this.loadedPartTotal:this.loadedCount<2?o=1:this.loadedCount<5?o=2:(o=Math.floor(this.loadedCount/Math.ceil(Ng.count/this.loadedPartTotal)))<2&&(o=2);var r=o+this.statusType-1-1;if(n=r+"/"+a,s=t,r==a)t=1;else t=(r+s)/a}Tu.sendToModule("SETLOADING",["modules.login.LoginModule"],{des:e,per:t,gPer:s,tdes:n})},t.onEnterGame=function(){xs.mirClick(15,hr.pid,hr.uid),this.configClass.length=0,this.configClass=null,this.paths=null,"0"!=hr.socket_host?_r.isCreated?(G.timer.clear(this,this.doShowLoading),Tu.sendToModule("SHOWCREATEROLE",["modules.login.LoginModule"])):(this.statusType=4,this.loginUrlsV1()):Tu.sendToModule("SHOWCREATEROLE",["modules.login.LoginModule"])},t.loginUrlsV1=function(){for(var e=[],t=1;t<=3;t++)for(var i=1;i<=2;i++)RU.urls.push(_r.getLayoutsImagePath("createrole1/cj_js_"+t+"_"+i+".png",!1)),e.push({url:_r.getLayoutsImagePath("createrole1/cj_js_"+t+"_"+i+".png",!1)});RU.urls.push(_r.getLayoutsPath("createrole1")),e.push({url:_r.getLayoutsPath("createrole1")}),G.loader.load(e,ql.create(this,this.doShowCreateRole))},t.loginUrlsV2=function(){for(var e=[],t=1;t<=3;t++){for(var i=1;i<=2;i++)RU.urls.push(_r.getLayoutsImagePath("createrole2/cj_img_"+t+"_"+i+".png",!1)),RU.urls.push(_r.getLayoutsImagePath("createrole2/cj_s_"+t+"_"+i+".png",!1)),e.push({url:_r.getLayoutsImagePath("createrole2/cj_img_"+t+"_"+i+".png",!1)}),e.push({url:_r.getLayoutsImagePath("createrole2/cj_s_"+t+"_"+i+".png",!1)});RU.urls.push(_r.getLayoutsImagePath("createrole2/cj_job_"+t+".png",!1)),e.push({url:_r.getLayoutsImagePath("createrole2/cj_job_"+t+".png",!1)})}RU.urls.push(_r.getLayoutsPath("createrole2")),e.push({url:_r.getLayoutsPath("createrole2")}),G.loader.load(e,ql.create(this,this.doShowCreateRole))},t.checkIsNew=function(e,t){var i=e;if(_r.justCreated&&1==t){var n=i.split("configs/"),s=n[1].split(".jxr");i=n[0]+"configs/"+s[0]+"_new.jxr"+s[1]}return i},l.getIntance=function(){return null==global.UpdateResUtils._intance_&&(global.UpdateResUtils._intance_=new l),global.UpdateResUtils._intance_},l._intance_=null,l.NODO=[],l}(),WB=function(e){function n(){n.__super.call(this)}return b(n,"modules.activity.others.ActivityRequestUtil",$h),n.getActivity=function(e,t){var i=new _M;i.mainType=e,n.getHandler=t,Tu.sendToService(i)},n.runComplete=function(){n.getHandler&&(n.getHandler.run(),n.getHandler.clear(),n.getHandler=null)},n.getActivityData=function(e,t){var i=new fM;i.activityId=e,n.getActHandler=t,Tu.sendToService(i)},n.runActComplete=function(){n.getActHandler&&(n.getActHandler.run(),n.getActHandler.clear(),n.getActHandler=null)},n.setComplete=function(e){n.getActHandler=e},n.getGift=function(e,t){var i=new pM;i.giftId=e,n.getGiftHandler=t,Tu.sendToService(i),UB.ins.playSound("14",3,!0)},n.runGetGiftFn=function(){n.getGiftHandler&&(n.getGiftHandler.run(),n.getGiftHandler.clear(),n.getGiftHandler=null)},n.buyGift=function(e,t){var i=new gM;i.giftId=e,n.buyGiftHandler=t,Tu.sendToService(i)},n.runBuyGiftFn=function(){n.buyGiftHandler&&(n.buyGiftHandler.run(),n.buyGiftHandler.clear(),n.buyGiftHandler=null)},n.getValue=function(e,t){var i=new vM;i.giftType=e,n.updateValueHandler=t,Tu.sendToService(i)},n.runUpdateValueFn=function(){n.updateValueHandler&&(n.updateValueHandler.run(),n.updateValueHandler.clear(),n.updateValueHandler=null)},n.reqEvaluateData=function(e){var t=new mM;t.actId=e,Tu.sendToService(t)},n.reqEvaluate=function(e,t){var i=new yM;i.actId=e,i.type=t,Tu.sendToService(i)},n.reqExchange=function(e,t){n.activityId=t;var i=new wM;i.exchangeId=e,Tu.sendToService(i)},n.reqSevenKHAward=function(e,t){n.giftVo=e;var i=new xM;i.giftId=e.giftId,Tu.sendToService(i),n.getGiftHandler=t},n.reqSevenKHScore=function(e){void 0===e&&(e=1);var t=new SM;t.type=e,Tu.sendToService(t)},n.reqGetPurchaseAward=function(e){var t=new kM;t.giftId=e,Tu.sendToService(t)},n.reqSoulInfo=function(){var e=new zf;Tu.sendToService(e)},n.reqFireworks=function(e){var t=new EM;t.activityId=e,Tu.sendToService(t)},n.requestHeFuVip=function(e,t){var i=new S;i.giftID=e,n.backHeFuVipHandler=t,Tu.sendToService(i)},n.runHeFuVipComplete=function(){n.backHeFuVipHandler&&(n.backHeFuVipHandler.run(),n.backHeFuVipHandler.clear(),n.backHeFuVipHandler=null)},n.requestHeFuTry=function(e,t){var i=new x;i.giftID=e,n.backHeFuTryHandler=t,Tu.sendToService(i)},n.runHeFuTryComplete=function(){n.backHeFuTryHandler&&(n.backHeFuTryHandler.run(),n.backHeFuTryHandler.clear(),n.backHeFuTryHandler=null)},n.reqPickAward=function(e,t){var i=new PM;i.activityId=e,n.getHandler=t,Tu.sendToService(i)},n.reqPickLogs=function(e,t){var i=new RM;i.activityId=e,n.getHandler=t,Tu.sendToService(i)},n.reqLottery=function(e,t){var i=new IP;i.aid=e,n.getHandler=t,Tu.sendToService(i)},n.reqLottA=function(e){var t=new bP;t.kid=e,Tu.sendToService(t)},n.reqPlayerActivity=function(e,t){var i=new QO;i.activityId=e,n.getHandler=t,Tu.sendToService(i)},n.reqPlayerAward=function(e,t){var i=new JO;i.giftId=e,n.getHandler=t,Tu.sendToService(i)},n.reqPlayerLogin=function(e,t){var i=new ZO;i.giftId=e,n.getHandler=t,Tu.sendToService(i)},n.reqPlayerLimit=function(e,t){var i=new KO;i.giftId=e,n.buyGiftHandler=t,Tu.sendToService(i)},n.reqTaskInfo=function(e){var t=new MM;t.actId=e,Tu.sendToService(t)},n.reqInvestInfo=function(){var e=new eP;Tu.sendToService(e)},n.reqInvestAward=function(e,t){var i=new $O;i.type=e,n.getHandler=t,Tu.sendToService(i)},n.reqInvestDrop=function(e,t){var i=new tP;i.type=e,i.serId=t,Tu.sendToService(i)},n.getHandler=null,n.getActHandler=null,n.getGiftHandler=null,n.buyGiftHandler=null,n.updateValueHandler=null,n.activityId=null,n.giftVo=null,n.backHeFuVipHandler=null,n.backHeFuTryHandler=null,n}(),YB=function(e){function t(){t.__super.call(this)}return b(t,"modules.activityDaily.others.DailyRequest",$h),p(1,t,"isOpenLimitSp",function(){return!(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(185)))||dr.getOpenServiceDay()<parseInt($e.MODEL.value($e.getIndex(184))))},zwc.engine.core.protos.Proto._$SET_isOpenLimitSp),t.reqLimitSpInfo=function(){var e=new wD;Tu.sendToService(e)},t.reqLimitSpAward=function(){var e=new xD;Tu.sendToService(e)},t.reqEggInfo=function(){var e=new AP;Tu.sendToService(e)},t.reqEggDraw=function(e){var t=new DP;t.eid=e,Tu.sendToService(t)},t.reqSuperVip=function(){var e=new LO;Tu.sendToService(e)},t.reqFocusReward=function(){var e=new TM;Tu.sendToService(e)},t.reqBindPhoneReward=function(){var e=new jD;Tu.sendToService(e)},t.reqWxCanShare=function(e){var t=new CP;t.type=e,Tu.sendToService(t)},t.reqWxshareSuccess=function(e){var t=new MP;t.type=e,Tu.sendToService(t)},t.reqCpshareSuccess=function(){if(0<eR.ins.curRid){var e=new vP;e.rid=eR.ins.curRid,Tu.sendToService(e)}eR.ins.curRid=0},t.reqGetOneYuanGift=function(){Tu.sendToService(new SP)},t.reqOneYuanInfo=function(){Tu.sendToService(new kP)},t.req0YuanInfo=function(){Tu.sendToService(new EP)},t.req0YuanGold=function(e){var t=new TP;t.rechargeId=e,Tu.sendToService(t)},t}(),zB=function(e){function o(){var e=this;e._broadMsg=null,e.broadView=null,e.noticeView=null,e.attrView=null,e.itemView=null,e.itemView2=null,e.expView=null,e.powerEffectView=null,e.rainbowView=null,e._godRing=null,e._iconView=null,e.expRunning=!1,e.rainbowDict=new jl,o.__super.call(e),e._broadMsg=[],o.MAX_ONE=parseInt($e.MODEL.value($e.getIndex(182))),o.MAX_ZERO=parseInt($e.MODEL.value($e.getIndex(183)))}b(o,"modules.broadcast.others.BroadcastUtils",$h);var t=o.prototype;return t.showGetToolInfo=function(e){this._godRing&&this._godRing.showInfo(e)},t.showGetSkillIcon=function(e){this._iconView&&this._iconView.showSkill(e,RP.n[101])},t.showGetGoodsIcon=function(e){this._iconView&&this._iconView.showGoods(e,RP.n[102])},t.playBroadMsg=function(e,t){void 0===t&&(t=1e3),this.broadView?this.broadView.pushText({html:e,pri:t}):this._broadMsg.push({html:e,pri:t})},t.playErrorMsg=function(e){if(null!=e&&""!=e)if(-1!=e.indexOf("<font"))e=Ql.createColor(e,"#ff2e24"),this.playNoticeMsg(e);else{var t=[{text:e,color:"#ff2e24"}];this.playNoticeMsg(t)}},t.playNoticeMsg=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this.noticeView&&("string"==typeof e?this.noticeView.pushText(e,t,i):this.noticeView.pushTextItem(e,t))},t.playAttrMsg=function(e,t){this.attrView&&this.attrView.pushAttr(e,t)},t.playGetItems=function(e){hN.ins.isOpen("TREASURE_VIEW")||this.itemView&&this.itemView.displayedInStage&&this.itemView.pushItems(e)},t.playGetItemsByPos=function(e,t,i,n){this.itemView2&&this.itemView2.displayedInStage&&this.itemView2.pushItems(e,t,i,n)},t.playGetGoods=function(e){if(null!=e&&0!=e.length){for(var t=e.split(";"),i=[],n=0;n<t.length;n++){var s=t[n].split(","),o=parseInt(s[0]);i.push(o)}modules.broadcast.others.BroadcastUtils.ins.playGetItems(i)}},t.playGetGoodsByPos=function(e,t,i,n){if(null!=e&&0!=e.length){for(var s=e.split(";"),o=[],a=0;a<s.length;a++){var r=s[a].split(","),l=parseInt(r[0]);o.push(l)}modules.broadcast.others.BroadcastUtils.ins.playGetItemsByPos(o,t,i,n)}},t.playGetGoodsToRing=function(e,t,i){modules.broadcast.others.BroadcastUtils.ins.playGetItemsByPos(e,t,sJ.getRingPt(),i||ql.create(this,this.toRingEndCallFun))},t.toRingEndCallFun=function(){},t.playExp=function(e,t,i){if(void 0===i&&(i=1),this.expView&&this.expView.displayedInStage){this.expRunning=!0;for(var n=0;n<i;n++)this.expView.pushPos(new Uh(e.x+50*Math.random()-50,e.y+50*Math.random()-50),t)}},t.playBossExp=function(e,t){if(this.expView&&this.expView.displayedInStage){this.expRunning=!0;for(var i=0;i<20;i++)this.expView.pushPos(new Uh(e.x+50*Math.random()-50,e.y+50*Math.random()-50),t)}},t.playPower=function(e,t,i,n){void 0===n&&(n=!0),this.powerEffectView&&this.powerEffectView.displayedInStage&&this.powerEffectView.pushPos(e,t,i,n)},t.clearPowerEffect=function(){this.powerEffectView&&this.powerEffectView.displayedInStage&&this.powerEffectView.clearEffect()},t.showMsg=function(e,t,i){void 0===i&&(i=!1),0==t?this.playBroadMsg(e):1==t?this.playErrorMsg(e):2==t&&this.playNoticeMsg(e,i)},t.showById=function(e,t){var i,n=ei.getIndex(e);this.showMsg(ei.MODEL.content(n),t),1303==e||102==e||1300==e?i="vo_3":1002==e||1031==e?i="vo_1":1003!=e&&2087!=e&&2088!=e||(i="vo_2"),i&&UB.ins.playSound(i)},t.showById2=function(e,t,i){var n=ei.getIndex(e),s=ei.MODEL.content(n);s=mp.getFormat(s,t),this.showMsg(s,i)},t.getDesc=function(e){var t=ei.getIndex(e);return ei.MODEL.content(t)},t.pushBroadMsg=function(e){this._broadMsg.push(e)},t.getBroadMsg=function(){for(var e,t=0,i=[],n=Nu.sortOn(this._broadMsg,"pri",Array.NUMERIC|Array.DESCENDING),s=0;s<n.length;s++)if(e=n[s])switch(e.pri){case 2:++t<o.MAX_TWO+1?i.push(e):(0,t=0);break;case 1:++t<o.MAX_ONE+1?i.push(e):(0,t=0);break;case 0:++t<o.MAX_ZERO+1?i.push(e):(0,t=0)}return this._broadMsg=i,this._broadMsg},t.sortByPri=function(e,t){return e.pri-t.pri},t.playRainbowById=function(e){this.rainbowView&&this.rainbowView.pushCfgId(e)},t.playRainbowByWords=function(e,t){void 0===t&&(t=1500),this.rainbowView&&this.rainbowView.pushWords(e,t)},t.checkRainbowAction=function(e,t){0==this.rainbowDict.length&&this.initRainBow();var i=this.rainbowDict.take(e+"_"+t);0<=i&&this.rainbowView&&this.rainbowView.pushCfgIndex(i)},t.initRainBow=function(){for(var e=Tn.count,t=0;t<e;t++){var i=Tn.MODEL.content(t);if(i&&0<i.length){var n=JSON.parse(i);n.type&&0<n.type.length&&n.id&&0<n.id.length&&this.rainbowDict.put(n.type+"_"+n.id,t)}}},p(1,o,"ins",function(){return o._inst=o._inst||new o},zwc.engine.core.protos.Proto._$SET_ins),o._inst=null,o.MAX_TWO=999,o.MAX_ONE=0,o.MAX_ZERO=0,o.isFlying=!1,f(o,["gridGoods",function(){return this.gridGoods=new Array}]),o}(),XB=function(e){function t(){this.type=0,this.chanType=0,this.dtoChat=null,this._showStr=null,this._disposed=!1,t.__super.call(this)}b(t,"modules.chat.others.ChatInfo",e);var i=t.prototype;return i._setup=function(e,t,i){this.type=e,this.chanType=t,(this.dtoChat=i).useCnt++,this._showStr=null},i.getShowStr=function(){var e,t="",i="";if(1==this.dtoChat.isguildNotice)return t=this.dtoChat.content;switch(this.type){case 2:i+="[公会]",e="#39e449";break;case 1:i+="[世界]",e="#ff8916";break;case 3:i+="[系统]",e="#ffe324";break;case 5:case 6:i+="[GM]",e="#833dec";break;case 7:i+="[跨服]",e="#833dec"}if(t+=Ql.createColor(i,e),3==this.type)t+=QB.praseEncodeStr(this.dtoChat.content);else{this.dtoChat.playerId&&this.dtoChat.playerName&&(this.dtoChat.isVip&&(t+=Ql.htmlTex2(_r.getAtlasSubPath("basic_ui_n/num1_vip.png"),42,26)),this.dtoChat.playerId!=gR.ins.charId?t+=Ql.createColorHerf(this.dtoChat.playerName,"#02b0e9","5#"+this.dtoChat.playerId+"|"+this.dtoChat.playerName+"|"+this.dtoChat.platform+"|"+this.dtoChat.serverId):t+=Ql.createColor(this.dtoChat.playerName,"#02b0e9"),t+=":");var n=QB.praseEncodeStr(this.dtoChat.content),s=QB.ins.faceArr;t+=n.replace(/\[#([0-9]+)\]/g,re=function(e,t){var i=parseInt(t);return 0<i&&i<=s.length?Ql.htmlClip(_r.getFacePath("face"+i),1,s[i-1],52,52):e})}return t},i.relive=function(){this._disposed&&(this._disposed=!1)},i.dispose=function(){this._disposed||(e.prototype.dispose.call(this),this._disposed=!0,this._showStr=null,this.dtoChat&&(this.dtoChat.useCnt--,this.dtoChat.useCnt<=0&&Ko.recover(this.dtoChat)),this.dtoChat=null)},p(0,i,"showStr",function(){return null==this._showStr&&(this._showStr=this.getShowStr()),this._showStr}),t.create=function(){if(0<t._pools.length){var e=t._pools.pop();return e.relive(),e}return new t},t.recover=function(e){null!=e&&(e.dispose(),t._pools.push(e))},t._pools=[],f(t,["regFace",function(){return this.regFace=/\[#([0-9]+)\]/g}]),t}($h),QB=function(e){function y(){var e=this;e.otherUI=null,e.playID=NaN,e.platform=null,e.serverId=0,e.playName="",e.faceArr=null,e._channels=null,e._curChannel=0,e.chatUI=null,e.infoUI=null,e.sendHelper=null,e.isDebug=!1,e._chatMsg=[],e.chatType=0,e.isblock=0,e.isFirst=1,y.__super.call(e),e.faceArr=[8,2,12,2,4,5,2,2,4,2,4,2,8,4,13,3,10,10,8,6,9,4,10,4,11,6,5,8,2],e._channels=[],e._channels[0]=new Array,e._channels[1]=new Array,e._channels[2]=new Array,e._channels[3]=new Array,e._channels[4]=new Array,e._channels[5]=new Array,e._curChannel=0,e.infoUI=Ej.ins,y.channelMap[1]=[0,1],y.channelMap[2]=[0,2],y.channelMap[3]=[0,3],y.channelMap[5]=[0,4],y.channelMap[7]=[0,5],y.linkMap[3]=new ul,y.linkMap[4]=new va,e.sendHelper=new ls,G.timer.loop(100,e,e.onLoop)}b(y,"modules.chat.others.ChatManager",$h);var t=y.prototype;return t.sendChat=function(e,t,i){void 0===i&&(i=0);var n=new rM;n.chatType=t,n.content=e,n.isGm=i,Tu.sendToService(n)},t.sendChatforPritave=function(e,t,i){var n=new aM;n.channel=i,n.content=t,n.targetId=e,Tu.sendToService(n)},t.pushMsg=function(e,t){var i=Ko.create();i.chatType=t,i.content=e,this.pushChatDtos(i.chatType,[i])},t.pushChatDtos=function(e,t){null!=t&&0!=t.length&&(this._chatMsg=this._chatMsg.concat(t))},t.onLoop=function(){if(this._chatMsg&&0<this._chatMsg.length){var e=1;30<this._chatMsg.length&&(e=3);for(var t=0;t<e;t++){var i=this._chatMsg.shift();this.pushChatDto(i)}}},t.pushChatDto=function(e){var t=this,i=e.chatType,n=y.channelMap[i];if(null!=n){for(var s=0;s<n.length;s++){var o=n[s],a=XB.create();a._setup(i,o,e),t._channels[o].push(a)}for(s=0;s<n.length;s++)o=n[s],y.maxLen=0==o?60:20,t._channels[o].length>y.maxLen&&(a=t._channels[o].shift(),XB.recover(a));if(SF.GetIntance().checkPackidBlock()){if(1!=t.isFirst)return t.isblock=1,G.timer.clear(t,t.showChat),void G.timer.once(5e3,t,t.showChat);for(s=0;s<n.length;s++)if((o=n[s])==t._curChannel&&t.infoUI&&t.infoUI.displayedInStage){var r=t._channels[t._curChannel];t.infoUI.pushAInfo(r[r.length-1]);break}}else if(0==t.isblock)for(s=t.isFirst=0;s<n.length;s++)if((o=n[s])==t._curChannel&&t.infoUI&&t.infoUI.displayedInStage){var l=t._channels[t._curChannel];t.infoUI.pushAInfo(l[l.length-1]);break}}},t.showChat=function(){this.isblock=0,this.infoUI&&this.infoUI.refreshInfo(this._channels[this._curChannel])},t.getCurChatInfo=function(){return this._channels[this._curChannel]},t.getChatInfo=function(e){return this._channels[e]},t.changeChannel=function(e){e!=this._curChannel&&(this._curChannel=e,this.infoUI&&this.infoUI.refreshInfo(this._channels[this._curChannel]))},t.linkHandler=function(e){if("0"!=e&&0==e.search(y.hrefReg)){var t=e.indexOf("#"),i=parseInt(e.substring(0,t)),n=(e=e.substring(t+1)).split("|");this._onLinkHandler(i,n)}},t._onLinkHandler=function(e,t){if(1==e){if(dr.hasHotUpdate)return void zB.ins.showById(4543,1);if(WR.ins.checkPlayerInCopy())return void zB.ins.showMsg(RP.n[19],1);if(WR.ins.checkPlayerInTeam())return void Tu.sendToModule("OPEN_TEAM_COPY_EXIT",["modules.copy.CopyModule"],{tips:"跳转将退出队伍，确认退出？"});var i=parseInt(t[0]),n=2<=t.length?{_subIndex_:parseInt(t[1])}:null;if(!GR.getInstance().checkModuleOpen(i))return void zB.ins.showMsg(RP.n[20],1);switch(i){case 66:oB.openType=parseInt(t[1]),hN.ins.open("SoulSkinMainView",null,"SOULOUT_V");break;case 1:break;case 2:hN.ins.open("GUILD_STORE_MAINVIEW",n);break;case 3:var s=parseInt(t[1]),o=rn.getIndex(s),a=rn.MODEL.cate(o);3==a?hN.ins.open("BOSS_MAINVIEW",{_subIndex_:1}):49==a&&hN.ins.open("BOSS_MAINVIEW",{_subIndex_:1});break;case 27:case 28:case 29:hN.ins.open("TREASURE_VIEW",n);break;case 53:hN.ins.open("TR_MYSTICAL_VIEW",n);break;case 35:if(0==EB.showCharge)return;hN.ins.open("MONTHCARD",{selectedIndex:parseInt(t[1])},0);break;case 59:var r=parseInt(t[1]);WB.getActivity(r,ql.create(modules.chat.others.ChatManager.ins,y.onGetActivityList,[r]));break;case 63:WB.getActivity(16,ql.create(modules.chat.others.ChatManager.ins,y.onGetActivityList,[16,t[1]]));break;case 37:case 38:hN.ins.open("MAGIC_VIEW",{_subIndex_:parseInt(t[1])},null,!0);break;case 40:hN.ins.open("AUCTION_MAIN",{__subIndex_:parseInt(t[1])},null,!0);break;case 45:hN.ins.open("MALL_PANEL",{__subIndex_:parseInt(t[1])},null,!0);break;case 46:this.setTeHuiLink(t);break;case 76:WB.getActivity(parseInt(t[2]),ql.create(modules.chat.others.ChatManager.ins,y.onLinkToBargain,[parseInt(t[2])]));break;case 43:hN.ins.open("SOARING_VIEW",{__subIndex_:parseInt(t[1])},null,!0);break;case 47:if(2==HN.ins.toc_recharge.canGet)return void zB.ins.showMsg(RP.n[21],1);EB.showCharge&&hN.ins.open("FIRST_RECHARGE");break;case 48:hN.ins.open("BOSS_MAINVIEW",{_subIndex_:parseInt(t[1])},null,!0);break;case 49:Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]);break;case 50:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:1});break;case 26:parseInt($e.MODEL.value($e.getIndex(158)))>aB.instance.activedRingId?zB.ins.showById(3971,1):Vf.instance.checkOut()?hN.ins.open("SOULOUT_V",null,0):Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]);break;case 24:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:2});break;case 51:EB.showCharge&&(2==HN.ins.toc_recharge.canGet?hN.ins.open("EVERY_RECHARGE"):hN.ins.open("FIRST_RECHARGE"));break;case 52:var l=PH.Ins().info;if(!(!!l&&10010<=l.taskId))return void zB.ins.playErrorMsg(RP.n[22]);var c=!1;if(dr.dtoEnterScene&&43==dr.dtoEnterScene.type&&(c=!0),c)return void zB.ins.playErrorMsg(RP.n[23]);Tu.sendToModule("OPEN_LIMIT_CHALLENGE_MAIN",["modules.limitChallenge.LimitChallengeModule"],{subIndex:parseInt(t[1])});break;case 62:WR.ins.checkSelfHasTeam()?zB.ins.showById(4386,1):Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:3});break;case 58:CN.dealActIcon(CN.getIconBtn(51));break;case 57:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:3});break;case 64:eU.toSelectIndex=parseInt(t[1]),CN.dealActIcon(CN.getIconBtn(62));break;case 65:if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);hN.ins.open("TR_HEFU_VIEW",n)}}else if(2==e);else if(3==e){var u=parseInt(t[0]),d=yB.create(u);2==Bi.MODEL.type(d.cfgIdx)?fW.instance.show(d):VQ.instance.show(d)}else if(4==e){var h=parseInt(t[0]),_=yB.create(h);fW.instance.show(_)}else if(5==e){var f=parseInt(t[0]);if(0==f)return;hN.ins.open("FRIENDNEWADDFRIENDVIEW");var p=t[1];this.playID=f,this.playName=p,this.platform=t[2],this.serverId=parseInt(t[3]);var g=new lM;g.targetId=f,g.platform=t[2],g.serverId=parseInt(t[3]),Tu.sendToService(g)}else if(8==e){1==parseInt(t[0])&&vN.ins.sendCallMsg(1)}else if(7==e){if(WR.ins.checkPlayerInTeam())return void Tu.sendToModule("OPEN_TEAM_COPY_EXIT",["modules.copy.CopyModule"],{tips:"跳转将退出队伍，确认退出？"});switch(i=parseInt(t[0]),n=2<=t.length?{_subIndex_:parseInt(t[1])}:null,i){case 37:case 38:jR.reqEntry(parseInt(t[1]));break;case 44:var v=t[1].split(",");modules.guild.others.GuildCallBossUtils.ins.reqAllowHelp(v[0],v[1],v[2]);break;case 79:hN.ins.isOpen("WB_YQ_PANEL")&&hN.ins.close("WB_YQ_PANEL");var m=rn.getIndex(BR.ins.curCopyId);57!=rn.MODEL.cate(m)?(Po.ins().currentSelectMissionID=parseInt(t[1]),jR.reqEntry(parseInt(t[1]),0,0,0,0,1)):zB.ins.showById(3998,1)}}else 9==e&&2<=t.length&&(WR.ins.checkSelfHasTeam()?zB.ins.showById(4386,1):WR.ins.enterTeam(t[1]))},t.sendGoods=function(e){var t=new ul;t.decode([e]),40<this.sendHelper.getLinkLen(t)+this.sendHelper.content.length?zB.ins.showById(2095,1):(this.sendHelper.appendLink(t),hN.ins.isDisplay("CHAT")&&this.chatUI.updateInput(),hN.ins.open("CHAT"),hN.ins._closeLayout())},t.appendMsg=function(e,t){void 0===t&&(t=!1),t&&this.sendHelper.clear(),this.sendHelper.appendMsg(e),hN.ins.isDisplay("CHAT")&&this.chatUI.updateInput()},t.setTeHuiLink=function(e){if(e&&!(e.length<1))if(1<e.length&&(eU.toSelectIndex=parseInt(e[1])),e.length<3)CN.dealActIcon(CN.getIconBtn(46));else if(0<Et.count)y.onJxrComplete(e[2]);else{var t=[{url:_r.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:Et}];uc.ins().onLoadJxrs(t,ql.create(this,y.onJxrComplete,[e[2]]))}},p(0,t,"curChannel",function(){return this._curChannel}),p(1,y,"ins",function(){return y._inst=y._inst||new y},zwc.engine.core.protos.Proto._$SET_ins),y.onGetActivityList=function(e,t){if(void 0===t&&(t=0),ZN.isEnabledChangeScene()){var i="";switch(e){case 15:case 33:i="GOLDLOTTERYMAINVIEW";break;case 16:i="ActivityHeFuMainView"}hN.ins.toggle(i,[e,t])}else zB.ins.showById(2126,1)},y.onLinkToBargain=function(e,t){void 0===t&&(t=!1);var i=!1,n=mB.getInStance().getMainType(e);if(n){if(t&&G.timer.clear(CN,y.onLinkToBargain),0<n.activityIds.length)for(var s=0;s<JP.A_BARGAIN_ID_ARR.length;s++)if(-1<n.activityIds.indexOf(JP.A_BARGAIN_ID_ARR[s])){i=!0;break}i?vN.ins.joinGuild?hN.ins.isOpen("SP_BARGAIN_GUILD")||hN.ins.open("SP_BARGAIN_GUILD"):zB.ins.showById(2031,1):zB.ins.showById(4437,1)}else G.timer.once(350,CN,y.onLinkToBargain,[e,!0])},y.praseEncodeStr=function(e){return null==e?"":e=e.replace(y.encodeReg,re=function(e,t){var i=t.split("奲"),n=parseInt(i.shift()),s=y.linkMap[n];return s?(s.decode(i),s.getHtmlStr()):e})},y.onJxrComplete=function(e){for(var t=0,i=0;i<Et.count;i++)if(e==Et.MODEL.mainType(i)){t=Et.MODEL.key(i);break}CN.dealActIcon(CN.getIconBtn(t))},y._inst=null,y.channelMap={},y.maxLen=20,y.linkMap={},y.noralArr=null,y.kuafuArr=null,y.defaultArr=null,f(y,["encodeReg",function(){return this.encodeReg=/圞夁([^圞]+)圞/g},"hrefReg",function(){return this.hrefReg=/([0-9]+)#/g}]),y}(),JB=function(e){function d(){var e=this;e.openIdx=0,e._configArr=null,e.avatorDataArr=[],e.selectArr=[],e._yiguiVo=null,e._yiguiInfo=null,e.fashionHash=new jl,e.suitHash=new jl,e.platformHash=new jl,d._inst&&pt.window.alert(RP.n[108]),d.__super.call(e)}b(d,"modules.fashion.others.FashionDataModel",$h);var t=d.prototype;return t.takeCharFashionList=function(e){var t=this.fashionHash.take(e);return null==t?[]:t},t.getFashionById=function(e,t){for(var i=this.takeCharFashionList(e),n=0;n<i.length;n++){var s=i[n];if(s.f_id==t)return s}return null},t.getTypeName=function(e,t){var i;switch(void 0===t&&(t=!1),e){case 1:i="衣服";break;case 2:i="武器";break;case 3:i="称号";break;case 4:i=t?"羽翼":"翅膀"}return i},t.getTypeName1=function(e,t){var i;if(1==t)switch(e){case 1:i="衣服";break;case 2:i="武器";break;case 4:i="翅膀"}return i},t.getSuitIndex=function(e,t){for(var i=0;i<si.count;i++)if(si.MODEL.suitId(i)==e&&si.MODEL.suitNum(i)==t)return i;return-1},t.checkSuitIsActive=function(e,t){var i=this.suitHash.take(e);null==i&&(i=[]);for(var n=0;n<i.length;n++){var s=si.getIndex(i[n]);if(t==si.MODEL.suitId(s))return!0}return!1},t.addAttr=function(e,t){if(null==e)return t;var i,n;for(i in e)for(n in t)i==n&&(e[i]+=t[n]);return e},t.checkRedPoint=function(e,t,i,n){for(var s=!1,o=gR.ins.actorList[e-1].job.toString(),a=0;a<ni.count;a++){if(-1!=ni.MODEL.roleType(a).split(",").indexOf(o)&&ni.MODEL.position(a)==t){var r=ni.MODEL.key(a),l=ni.MODEL.goodsCost(a).split(","),c=l[0],u=parseFloat(l[1]),d=TR.ins.getGoodsNum(c);if(modules.fashion.others.FashionDataModel.ins.getFashionById(e,r)){var h=this.fashionHash.take(e);if(0<h.length)for(var _=0;_<h.length;_++){var f=ni.MODEL.level(ni.getIndex(h[_].f_id));ni.MODEL.position(ni.getIndex(h[_].f_id))==t&&(10<=f?s=!1:u<=d&&(s=!0))}}else 0<d&&(s=!0)}}return s},t.findFashionByID=function(e,t){var i;this.fashionHash.proto[t];for(var n in this.fashionHash.proto[t])if((i=this.fashionHash.proto[t][n])&&i.f_id==e)return i;return null},t.findConfigDataByPositionSuitLevel=function(e,t,i){var n,s=this._configArr[e-1][t-1];for(var o in s)if((n=s[o]).level==i)return n;return null},t.getUpgradeCostByFid=function(e){for(var t=0;t<oi.count;t++)if(e==oi.MODEL.key(t))return oi.MODEL.consumeDef(t);return null},t.canPlatformUse=function(e){return this.canPlatformUseByID(e.platform)},t.canPlatformUseByID=function(e){if(!e||""==e||e==hr.appid)return!0;if(e&&e.split&&0<=e.split(",").indexOf(hr.appid))return!0;return!1},t.getPlatformByEffect=function(e){var t;if(!e||"null"==e||""==e)return t;if(0==this.platformHash.length)for(var i,n=ni.count,s=0;s<n;s++){var o=ni.MODEL.avatarId(s);if(o&&0<o.length&&i!=(o=o.replace(/[\'\"]*/g,""))&&o&&o.split){var a=o.split(",");if(0<a.length){t=ni.MODEL.platform(s);for(var r=0;r<a.length;r++)this.platformHash.put(a[r],t)}}i=o}return t=this.platformHash.take(e)},t.updateYiguiVo=function(e){if(e.info)for(var t in this._yiguiInfo||(this._yiguiInfo={}),e.info)this._yiguiInfo[t]?this._yiguiInfo[t].decode(e.info[t]):this._yiguiInfo[t]=new modules.fashion.others.YiguiVo(e.info[t])},t.getIsMaxById=function(e){return 10<=ni.MODEL.level(e)},t.getCanDisposeCloth=function(){for(var e=[],t=TR.ins.getClothesItems(),i=0,n=0;n<t.length;n++){var s=t[n],o=[];if(s.isFashionProp){if(!this.fashionHash)continue;for(i=0;i<gR.ins.actorList.length;i++){var a=this.fashionHash.take(i+1);if(a&&0!=a.length){for(var r=0;r<a.length;r++){var l=a[r],c=ni.getIndex(l.f_id);ni.MODEL.goodsCost(c).split(",")[0]==s.goodsId&&(o[i]=this.getIsMaxById(c))}o[i]||(o[i]=!1)}else o[i]=!1}0<o.length&&o.indexOf(!1)<=-1&&e.push(s)}else{var u=Ii.getIndex(s.goodsId);if(!u&&0==u)continue;var d=Ii.MODEL.titleId(u),h=tg.ins.toc_title;if(!h||!h.titles)continue;for(i=0;i<gR.ins.actorList.length;i++){var _=h.titles[i];if(_){for(var f=0;f<_.length;f++)_[f].id==d&&(o[i]=0<=_[f].state);o[i]||(o[i]=!1)}else o[i]=!1}0<o.length&&-1<o.indexOf(!0)&&e.push(s)}}return e},p(0,t,"configArr",function(){if(null==this._configArr){var e;this._configArr=[];for(var t=0;t<ni.count;t++)(e=new ka).id=ni.MODEL.key(t),e.suitID=ni.MODEL.suitId(t),e.position=ni.MODEL.position(t),e.level=ni.MODEL.level(t),e.platform=ni.MODEL.platform(t),null==this._configArr[e.position-1]&&(this._configArr[e.position-1]=[]),null==this._configArr[e.position-1][e.suitID-1]&&(this._configArr[e.position-1][e.suitID-1]=[]),this._configArr[e.position-1][e.suitID-1].push(e)}return this._configArr}),p(0,t,"yiguiInfo",function(){return this._yiguiInfo}),p(1,d,"ins",function(){return d._inst||(d._inst=new d),d._inst},zwc.engine.core.protos.Proto._$SET_ins),p(1,d,"fashionSuitHash",function(){for(var e=new jl,t=0;t<si.count;t++){var i=si.MODEL.suitId(t),n=si.MODEL.suitName(t),s=si.MODEL.suitNum(t),o={};o.suitId=i,o.id=si.MODEL.key(t),o.suitNum=s,o.attrs=si.MODEL.attrs(t),o.enhanceRate=si.MODEL.enhanceRate(t),e.take(i)?e.take(i).suit.push(o):e.put(i,{sid:i,suitName:n,suitMax:s,suit:[o]})}return e},zwc.engine.core.protos.Proto._$SET_fashionSuitHash),d.getFsuitName=function(e,t,i){void 0===i&&(i=!0);for(var n=0;n<ni.count;n++)if(ni.MODEL.position(n)==t&&ni.MODEL.suitId(n)==e)return i?d._inst.getTypeName(t,!0)+"·"+ni.MODEL.name(n):ni.MODEL.name(n);return""},d.getFsuitTitleName=function(e,t){if(3!=e)return"";for(var i=0;i<co.count;i++)if(co.MODEL.suitId(i)==t)return d._inst.getTypeName(e,!0)+"·"+co.MODEL.name(i);return""},d.getGoodsCost=function(e,t){var i=0;if(3==e){for(i=0;i<co.count;i++)if(co.MODEL.suitId(i)==t)return JP.praseGoodsStr(co.MODEL.goodsCost(i));return null}for(i=0;i<ni.count;i++)if(ni.MODEL.position(i)==e&&ni.MODEL.suitId(i)==t)return JP.praseGoodsStr(ni.MODEL.goodsCost(i));return null},d.getFsuitAttrs=function(){var e=d.fashionSuitHash;if(!e||!d._suitHash)return null;var t,i,n,s,o=new jl,a=0;for(var r in e.proto)if(s=e.proto[r],t=d._suitHash.take(modules.fashion.others.FashionDataModel._curRole+"_"+s.sid)){for(i=aa.formatAttrToChineseByList(s.suit[0].attrs,!1,!0),2==t.state&&(n=aa.formatAttrToChineseByList(s.suit[1].attrs,!1,!0),i=i.concat(n)),a=0;a<i.length;a++)if(0==t.state&&(i[a].val="0"),o.take(i[a].sIdx)){var l=o.take(i[a].sIdx),c=parseInt(i[a].val)+parseInt(l.val);l.val=c.toString(),o.put(i[a].sIdx,l)}else o.put(i[a].sIdx,i[a]);for(a=0;a<s.suit.length;a++)if(0<s.suit[a].enhanceRate){var u=2!=t.state?"0%":100*s.suit[a].enhanceRate/1e4+"%";o.put(1e4+s.sid,{sIdx:1e4+s.sid,val:u,sname:s.suitName+RP.n[109]})}}return o},d.getRoleRedPt=function(e){var t,i=d.fashionSuitHash;if(!i||!d._suitHash)return!1;var n,s=0;for(var o in i.proto)if(n=i.proto[o],(t=d._suitHash.take(e+"_"+n.sid))&&2!=t.state){for(var a=s=0;a<t.list.length;a++)1==t.list[a].pstate&&s++;if(0==t.state&&2<=s)return!0;if(1==t.state&&4<=s)return!0}return!1},d._suitHash=null,d._curRole=0,d._inst=null,d.ALERT=!0,f(d,["TITLE_SPECIAL_IDS",function(){return this.TITLE_SPECIAL_IDS=["jm1275","jm1276","jm1277","jm1278","jm1279","jm1280"]}]),d}(),ZB=function(e){function n(){this.fighttingID=0,this._isInYezhan=!1,this.toc_field=null,this.playerArr=[],n.__super.call(this)}b(n,"modules.field.others.FieldManager",$h);var t=n.prototype;return t.getRankResult=function(e){5e4<e&&(e=5e4);for(var t={soul:0,prestige:0,coin:0},i=_i.count,n=0;n<i;n++){var s=_i.MODEL.rankRange(n).split(","),o=parseInt(s[0]),a=parseInt(s[1]);if(o<=e&&e<=a){t.prestige=0;var r=_i.MODEL.goodsAward(n);t.soul=this.getSoulCount(r);var l=_i.MODEL.currencyValue(n);t.coin=l.split(":")[1];break}}return t},t.getSoulCount=function(e){if(null==e)return 0;for(var t=e.split(";"),i=0;i<t.length;i++){var n=t[i].split(","),s=parseInt(n[0]),o=parseInt(n[1]);if(3==s)return o}return 0},t.getXundiCost=function(e){return 0},t.getFightAwardIdx=function(e,t){return-1},t.updatePlayer=function(e){var t=0,i=[];for(t=0;t<this.playerArr.length;t++)this.playerArr[t].playerId!=e.playerId&&i.push(this.playerArr[t]);this.playerArr=i},t.getwfxbyid=function(e){for(var t=null,i=0;i<n.WFX_CONFIG.length;i++)if(n.WFX_CONFIG[i].key==e){t=n.WFX_CONFIG[i];break}return t},p(0,t,"isYezhan",function(){return this._isInYezhan},function(e){this._isInYezhan=e}),p(1,n,"ins",function(){return n._inst=n._inst||new n},zwc.engine.core.protos.Proto._$SET_ins),n._inst=null,f(n,["WFX_CONFIG",function(){return this.WFX_CONFIG=[{key:"-5",headImage:"js_tx_11",name:RP.n[110]},{key:"-4",headImage:"js_tx_09",name:RP.n[111]},{key:"-3",headImage:"js_tx_07",name:RP.n[112]},{key:"-2",headImage:"js_tx_08",name:RP.n[113]},{key:"-1",headImage:"js_tx_10",name:RP.n[114]}]}]),n}(),KB=function(e){function t(){this._curVal=0,this._nextVal=0,this._numClip=null,this._numText=null,this._index=0,this._arr=null,this._count=0,t.__super.call(this)}b(t,"modules.welfare.views.item.RedPacketScrollText",ba);var i=t.prototype;return i.playStart=function(){var e=this;e._numClip&&(e._numClip.value=e.addPreZero(e._curVal)),e._numText&&(e._numText.text=e.addPreZero(e._curVal)),e._index=0,e._arr=e.generateNumbers(),G.timer.loop(30,e,e.rollNum)},i.rollNum=function(){var e=this,t=e._arr[e._index];if(e._index>=e._arr.length||null==t)return G.timer.clear(e,e.rollNum),void e.rollEnd();e._numClip&&(e._numClip.value=t+""),e._numText&&(e._numText.text=t+""),e._index++},i.addPreZero=function(e){for(var t=(e+"").length,i="",n=0;n<this._count-t;n++)i+="0";return i+e},i.rollEnd=function(){this._numClip&&(this._numClip.value=this._nextVal+""),this._numText&&(this._numText.text=this._nextVal+""),G.timer.once(200,this,this.clear),this.event("complete")},i.stop=function(){G.timer.clear(this,this.rollNum),this.clear()},i.clear=function(){G.timer.clearAll(this),Og.clearAll(this),this._numClip=null,this._numText=null,this._arr=null},i.generateNumbers2=function(){var e=[],t=this._nextVal-this._curVal,i=1;29<t&&(i=Math.ceil(t/29));for(var n=this._curVal,s=0;s<29&&!((n+=i)>=this._nextVal);s++)e.push(n);return e.push(this._nextVal),e},i.generateNumbers=function(){for(var e=[],t=0;t<29;t++){for(var i="",n=0;n<this._count;n++)i+=Math.floor(10*Math.random());e.push(i)}return e.push(this._nextVal+""),e},i.playText=function(e,t,i){this._nextVal=e,this._curVal=t,this._numText=i,this._count=this._nextVal.toString().length,this.playStart()},i.play=function(e,t,i){this._nextVal=e,this._curVal=t,this._numClip=i,this._count=this._nextVal.toString().length,this.playStart()},t}(),$B=function(e){function r(e,t){var i=this;i.buffMessages=[],i.messageArray=[],i.reConnectNum=0,i.reConnecting=!1,i.reConnectTime=0,i._webSocket_=null,i._connected=!1,i._closeStatus=!0,i._ReConnectNum=0,i._autoCheckConnect=!0,i.hasRevice13303=!1,i.tryTime=0,i.shortSize=65536,i.bodaySize=-1,i.indexKey=0,i.endian="bigEndian",i._inputBytes_=new mt,void 0===t&&(t=0),r.__super.call(i),i.endian="bigEndian"}b(r,"net.CustomSocket",ba);var t=r.prototype;return t.loop=function(){BB.getTimer();0!=this.connected||this.hasRevice13303?this.reConnecting=!1:(this.reConnecting=!0,this._closeStatus?(this._closeStatus=!1,this.reConnectNum=BB.getTimer()):this._closeStatus)},t.connect=function(e,t){var i=this;if(!this.connected){var n="ws://"+e+":"+t;n=0<dr.xgame?"wss://minigame.cqjy.5jli.com/?host="+e+":"+t:"https:"==pt.window.location.protocol?"wss://"+e+":"+t:"ws://"+e+":"+t,this._webSocket_&&this.clean(),this._webSocket_=new pt.window.WebSocket(n),this._webSocket_.binaryType="arraybuffer",this._inputBytes_.length=0,this._inputBytes_.endian=this.endian,this._inputBytes_.position=0,this.bodaySize=-1,this._webSocket_.onopen=function(e){i._onConnect_(e)},this._webSocket_.onmessage=function(e){i._onMessage_(e)},this._webSocket_.onclose=function(e){i._onClose_(e)},this._webSocket_.onerror=function(e){i._onError_(e)}}},t._onConnect_=function(e){console.log("onConnect:"),this.connected=!0,this._ReConnectNum=0,tr.push(RP.n[115]),SF.logined||(Tu.sendToModule("__SOCKET_CONENTED__",["modules.login.LoginModule"]),SF.logined=!0,G.timer.loop(15,this,this.loop)),this.reConnectNum=BB.getTimer()},t._onMessage_=function(e){if(e&&e.data){var t=e.data;this._readSocketDate_(t)}},t._onClose_=function(e){this.connected=!1,this._closeStatus=!0,tr.push("onClose key="+hr.key+" uid="+hr.uid+" socket_port="+hr.socket_port+" socket_host="+hr.socket_host),G.timer.once(600,null,function(){Tu.sendToModule("SOCKET_CLOSE",["modules.scene.SceneModule","modules.offline.OfflineModule"])})},t._onError_=function(e){this.connected=!1,this._closeStatus=!0,console.log("WebSocket Error:"+e),tr.push("WebSocket Error")},t.reConnected=function(){this._ReConnectNum++,this.connect(hr.socket_host,hr.socket_port)},t.close=function(){if(this.bodaySize=-1,null!=this._webSocket_)try{this._webSocket_.close()}catch(e){}},t.clean=function(){try{this._webSocket_.close()}catch(e){}this.connected=!1,this._webSocket_.onopen=null,this._webSocket_.onmessage=null,this._webSocket_.onclose=null,this._webSocket_.onerror=null,this._webSocket_=null,this.bodaySize=-1},t._readSocketDate_=function(e){var t=this;if(e){var i=0,n=t._inputBytes_.position;if(t._inputBytes_.writeArrayBuffer(e),t._inputBytes_.position=n,dr.lastReceivePackageTime=dr.curServerTime,t._inputBytes_.length>r.BUFFER_MAX_SIZE){var s=new mt;s.endian=t.endian,i=t._inputBytes_.length-t._inputBytes_.position,t._inputBytes_.readBytes(s,0,i),t._inputBytes_.clear(),t._inputBytes_=s,t._inputBytes_.position=0}var o,a=0;(4<=(i=t._inputBytes_.length-t._inputBytes_.position)||-1!=t.bodaySize)&&(-1==t.bodaySize&&(t.bodaySize=t._inputBytes_.readInt()),t.bodaySize==t._inputBytes_.bytesAvailable&&(t._inputBytes_.readInt(),(a=t._inputBytes_.readShort())<0&&(a+=t.shortSize),o=new mt,t._inputBytes_.readBytes(o,0,t.bodaySize),o.position=0,13303==a||10118==a?(t.hasRevice13303=!0,t.buffMessages.splice(0,0,[a,o])):t.buffMessages.push([a,o]),t.bodaySize=-1,t._inputBytes_.bytesAvailable<=0&&t._inputBytes_.length>r.BUFFER_MAX_SIZE/2&&t._inputBytes_.clear()))}},t.sendBeanData=function(e){if(null!=this._webSocket_){var t=e.encode(),i=new mt;i.writeByte(9),i.writeByte(5),i.writeByte(2),i.writeByte(7),i.writeInt(this.indexKey),i.writeInt(t.length+2),i.writeShort(e.packId),t&&t.length&&(t.position=0,i.writeBytes(t,0,t.length)),this._webSocket_.send(i.__getBuffer().slice(0,i.length)),t.clear(),i.clear(),t=i=null}},t.send=function(e){this._webSocket_.send(e)},t.flush=function(){},p(0,t,"connected",function(){return this._connected},function(e){dr.socketConnected=this._connected=e}),r.BIG_ENDIAN="bigEndian",r.LITTLE_ENDIAN="littleEndian",r.TYPE_BINARY="arraybuffer",r.RECONNECTNUM=3e4,r.BUFFER_MAX_SIZE=2e4,r}(),eH=function(e){function t(e){this._intervalTime=0,this._lastCallTime=0,this._inTimer=!1,t.__super.call(this),this._intervalTime=e}b(t,"utils.TimerCall",ba);var i=t.prototype;return i.invalid=function(){var e=this;return 0==e._lastCallTime||BB.getTimer()-e._lastCallTime>=e._intervalTime?(e._lastCallTime=BB.getTimer(),e._inTimer?G.timer.runTimer(e,e._callback):e._callback(),!0):(e._inTimer||(e._inTimer=!0,G.timer.once(BB.getTimer()-e._lastCallTime,e,e._callback)),!1)},i.reset=function(){this._inTimer=!1,G.timer.clear(this,this._callback),this._lastCallTime=0},i._callback=function(){this._inTimer=!1,this.event("change")},t}(),tH=function(e){var t;function i(e){if(this.tabGoodsHash=null,this._mysterystore_data=null,this._recordTime=NaN,i.__super.call(this),null==e)throw new Error("单例");this.tabGoodsHash=new jl}b(i,"modules.mall.others.Mall_DataModel",$h);var n=i.prototype;return n.hasLeftFreeTime=function(){return!!this.mysterystore_data&&0==this.mysterystore_data.refreshTime},n.getLeftTime=function(){var e=pt.now();return this._mysterystore_data.refreshTime-Math.floor(e-this._recordTime)},n.setTabGoods=function(e,t){null==this.tabGoodsHash.take(e)?this.tabGoodsHash.put(e,t):this.tabGoodsHash.put(e,t,!0)},n.getTabByIndex=function(e){var t=Nn.getIndex(e);return-1!=t?Nn.MODEL.tabId(t):(console.log("不存在该物品"),-1)},n.changeMallVo=function(e){if(null!=e){var t=e.shopIndex,i=this.getMallDataVoByIndex(t);i&&(i.leftDailyTimes=e.dailyLimitTime,i.foreverLeftTime=e.foreveLimitTime,0==e.foreveLimitTime&&this.removeMallDataVoByIndex(t))}},n.getMallDataVoByIndex=function(e){var t=this.getTabByIndex(e),i=this.getTabGoodsList(t);if(i)for(var n,s=0;s<i.length;s++)if((n=i[s]).shopIndex==e)return n;return null},n.removeMallDataVoByIndex=function(e){for(var t=this.getTabByIndex(e),i=this.getTabGoodsList(t),n=0;n<i.length;n++)i[n].shopIndex==e&&i.splice(n,1)},n.getTabGoodsList=function(e){return null==this.tabGoodsHash.take(e)?null:this.tabGoodsHash.take(e)},n.getDiffFightValue=function(e){var t=Bi.getIndex(e),i=Bi.MODEL.attributes(t),n=0;n=null!=i&&""!=i?RR.getFight(i):0;var s,o,a=Bi.MODEL.roleTypeId(t),r=Bi.MODEL.decoratePosition(t);77==e?r=1:78==e&&(r=2);var l=0;if(0==a)for(var c=0,u=1;u<=3;u++)(s=MR.ins.getEquip(u,r))?eN.ins.isGodEquip(s.goodsId)?l=n:(t=Bi.getIndex(s.goodsId),i=Bi.MODEL.attributes(t),(c=RR.getFight(i))<l&&(l=c)):l=0;else l=null==(o=gR.ins.actorByJob(a))?0:(s=MR.ins.getEquip(o.id,r))?eN.ins.isGodEquip(s.goodsId)?n:(t=Bi.getIndex(s.goodsId),i=Bi.MODEL.attributes(t),RR.calScoreValue(i)):0;return n-l},n.getRefreshCost=function(){for(var e=gR.ins.VIPLevel,t=[],i=0,n=0,s=0,o=1;o<=Ys.count;o++)if(s=Ys.getIndex(o),2<=(t=Ys.MODEL.vipLimit(s).split(",")).length&&(i=parseInt(t[0]),n=parseInt(t[1])),i<=e&&(e<=n||-1==n))return Ys.MODEL.refreshPrice(Ys.getIndex(o));return 0},n.isMysteryAllBuy=function(){if(null==this.mysterystore_data)return!0;for(var e=!0,t=0;t<this.mysterystore_data.list.length;t++)if(!this.mysterystore_data.list[t].hasBuy){e=!1;break}return e},p(0,n,"mysterystore_data",function(){return this._mysterystore_data},function(e){this._recordTime=pt.now(),this._mysterystore_data=e}),p(1,i,"instance",function(){return i._instance=i._instance||new i(new t)},zwc.engine.core.protos.Proto._$SET_instance),i._instance=null,i.needShowTips=!0,i.__init$=function(){t=function(){function e(){}return b(e,""),e}()},i}(),iH=function(e){function t(){this.needShowAct=!1,t._inst&&pt.window.alert(RP.n[117]),t.__super.call(this)}b(t,"modules.medal.others.MedalDataModel",$h,"MedalDataModel$1");var i=t.prototype;return i.checkCanUp=function(e,t,i){return void 0===i&&(i=!0),!1},i.checkCanAdvance=function(e,t,i){return void 0===i&&(i=!0),!1},i.getDefaultCfgId=function(e,t){return 0},i.getGoodsEquipType=function(e){var t=0;switch(e){case 309:t=fa.MB.type;break;case 307:t=fa.XZ.type;break;case 308:t=fa.DP.type;break;case 310:t=fa.HS.type;break;case 312:t=fa.HY.type;break;case 311:t=fa.SJ.type}return t},i.getTipsType=function(e){var t=2;switch(e){case fa.XZ.type:case fa.DP.type:t=1}return t},i.addAttr=function(e,t){if(null==e)return t;var i,n;for(i in e)for(n in t)i==n&&(e[i]+=t[n]);return e},i.subAttr=function(e,t){if(null==e)return t;var i,n;for(i in e)for(n in t)i==n&&(e[i]-=t[n]);return e},i.getDefaulyAttr=function(e){var t=this.getDefaultCfgId(e,!1);return JSON.parse(Dn.MODEL.attrs(Dn.getIndex(t)))},i.getAttrByType=function(e,t){return this.subAttr(t,this.getDefaulyAttr(e))},i.addSkill=function(e,t){if(0!=t){var i=gR.ins.actorList[e-1].job,n=0,s=On.getIndex(t);switch(i){case ha.ZHAN.type:n=On.MODEL.zsSkillId(s);break;case ha.FA.type:n=On.MODEL.fsSkillId(s);break;case ha.DAO.type:n=On.MODEL.dsSkillId(s)}if(0<n){var o=On.MODEL.skillLevel(s),a=na.create(n,o);IH.ins.updateSkill(e,[a])}}},p(1,t,"ins",function(){return t._inst||(t._inst=new t),t._inst},zwc.engine.core.protos.Proto._$SET_ins),t._inst=null,t}(),nH=function(e){function u(){u.__super.call(this)}return b(u,"modules.scene.others.fight.BuffCtrl",$h),u.loop=function(){BB.getTimer();if(0!=NB.isSceneReady);},u.addBuff=function(e,t,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0);var o=u.charBuffHash.take(e);o||(o=new jl,u.charBuffHash.put(e,o));var a=o.take(t),r=Ls.getIndex(t),l=Ls.MODEL.duration(r);0==l&&(l=999999999),null==a?((a=new MH).buff_id=t,o.put(t,a)):o.put(t,a,!0),1==t?a.type=2:7==t||(6==t?l=30:404==t&&(a.type=1)),a.duration=1e3*l,a.startTime=BB.getTimer(),a.hurtTime=BB.getTimer(),a.char_id=e,a.skillId=i;var c=zN.getCharInStage(e,s);if(c)switch(t){case 1:sH.skillState(c,1,1,500);break;case 6:sH.skillState(c,6,1);break;case 7:sH.skillState(c,7,1,n);break;case 10:sH.skillState(c,10,1),sH.playBuffImg(c,"zj_pz_bd");break;case 15:sH.skillState(c,15,1);break;case 16:sH.skillState(c,16,1);break;case 18:sH.skillState(c,18,1);break;case 9:sH.skillState(c,9,1),sH.playBuffImg(c,"pz_pt_zs")}},u.removeCharBuff=function(e){if(null!=e){var t=u.charBuffHash.take(e);if(t)for(var i in t.proto)u.removeBuff(e,parseInt(i));var n=zN.getChar(e);n&&n.clearCharState();var s=Vn.getIndex(203);Vn.MODEL.effect_play(s);n&&n.removeEffect(s.toString()),u.charBuffHash.remove(e)}},u.removeBuff=function(e,t,i){void 0===i&&(i=0);var n=u.charBuffHash.take(e);if(u.hasBuff(e,t)){n&&n.remove(t);var s=zN.getCharInStage(e,i);s&&sH.skillState(s,t,0)}},u.hasBuff=function(e,t){var i=u.charBuffHash.take(e);return!(!i||!i.has(t))},f(u,["charBuffHash",function(){return this.charBuffHash=new jl}]),u}(),sH=function(e){function L(){var e=this;e._autoMode=!1,e.autoTime=0,e.attackTime=0,e._isStop=!1,e.attackDur=100,e.unionSendTime=0,e.yuanshenSkillReady=!0,e.errorTime=0,e.pickupTime=0,e.zhuijiPos=0,e.ysSkillCD=[],L.__super.call(e),L._instance_=e}b(L,"modules.scene.others.fight.FightCtrl",$h);var t=L.prototype;return t.loop=function(){0!=NB.isSceneReady&&this.autoFight()},t.autoFight=function(){var e=BB.getTimer();50<e-this.autoTime&&(this.autoTime=e,this.autoAttack())},t.updateAttackTimeDur=function(e){void 0===e&&(e=0);var t=BB.getTimer();this.attackTime=t+e},t.autoAttack=function(e){var t=this,i=BB.getTimer();if(gR.ins&&Pn.hasIndex(gR.ins.cId)){var n=Pn.getIndex(gR.ins.cId);if(1==Pn.MODEL.type(n)&&!t.autoMode&&gF.NEEDAUTO&&!gF.TARGETHISTORY&&PH.hasTask()&&PH.Ins().isNewHands){var s=1e4;if(1==uH.Ins().currCkType&&(s=6500),i-gF.AUTOTIME>s)return modules.scene.others.fight.FightCtrl.autoFighCounter=i,void Tu.sendToModule("AUTOTASK",["modules.task.TaskModule"])}}if(2!=uH.Ins().currCkType||!t.isStop||dr.dtoEnterScene||aH.isZhanBaokMode||(t.isStop=!1),!YR.ins.isCrossBossCopy())if(t.isStop||aH.isZhanBaokMode||0==NB.isSceneReady)modules.scene.others.fight.FightCtrl.autoFighCounter=i;else{null==e&&(e=NF.mainChar);var o=e.selectTarget=NF.Ins().selectChar;if(t.autoUnselect(),t.autoMode&&!o||o&&o.isDeath)o=t.autoSelect();else if(t.autoMode&&!o){var a=zN.getNearItem(e.point);a&&(o=a)}if(2==uH.Ins().currCkType&&0==t.autoMode&&2e3<i-modules.scene.others.fight.FightCtrl.autoFighCounter&&(modules.scene.others.fight.FightCtrl.autoFighCounter=i,t.autoMode=!0),o){var r=o;if(t.autoMode&&r&&0==r.isDeath&&r.type==Za.MONSTER&&L.getSkillDisValue(L.getCurrSkill(e.hero_id,o),e.point,o.point)<=0){if(uH.ysReady&&0<gR.ins.soulSkill.length&&t.ysSkillCD.length<gR.ins.soulSkill.length){var l=uH.Ins().isGetHero(uH.yuanshenHash.take(gR.ins.objectId));l&&(l.ai&&l.ai.start(),t.attackChar(l.char_id,r.char_id,l.objectId))}if(uH.ysReady){var c=uH.heroHash,u=5+gR.ins.charId,d=c.take(u);d&&t.attackChar(d.char_id,r.char_id,5)}if(yH.Ins().actCtrl.currOrder&&yH.Ins().actCtrl.currOrder.closuredOrder&&(yH.Ins().actCtrl.currOrder.closuredOrder.method==t.attackChar||yH.Ins().actCtrl.currOrder.closuredOrder.method==NF.Ins().onMoveEndFor))return e.stopMove(),yH.Ins().actCtrl.clearAll(),void t.attackChar(gR.ins.charId,r.char_id)}if(e.isRuning)return;var h=t.attackDur;if(i-t.attackTime>h&&!e.lockMove)if(t.attackTime=i,o.type==Za.PICKUP_ITEM||o.type==Za.PICKUP_GOLD)ZN.getTileDis(o.tilePoint,e.tilePoint)<=0?t.pickUp(o):yH.Ins().mainCharMove(o.point,!1,ql.create(t,t.pickUp,[o]));else if(o.type==Za.CHAR)if(ZN.getTileDis(o.tilePoint,e.tilePoint)<=1)NF.Ins().onMoveEndForChar(o);else{var _=YN.getCharNearPt(o);yH.Ins().mainCharMove(_,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndForChar,[o]))}else{if(o.type==Za.COLLECTION||o.type==Za.BUILDING)return;if(L.attackCharEnabled(o))if(0<L.getSkillDisValue(L.getCurrSkill(e.hero_id,o),e.point,o.point)){var f=YN.getCharNearPt(o);if(modules.scene.others.fight.FightCtrl.attackCharEnabled(o,e.hero_id)){var p=L.getSkillDisValue(L.getCurrSkill(e.hero_id,o),e.point,o.point);(0<p||0==ZN.getTileDis(e.tilePoint,o.tilePoint))&&(f=YN.getFitPoint(e.tilePoint,o.tilePoint,p))}yH.Ins().mainCharMove(f,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndHander))}else{var g=ZN.getTileDis(e.tilePoint,o.tilePoint);if(g<=4&&2<g)return void yH.Ins().mainCharMove(o.point,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndHander));1<g?(f=YN.getFitPoint(e.tilePoint,o.tilePoint,1),yH.Ins().mainCharMove(f,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndHander))):g<=1&&(f=e.point,yH.Ins().actCtrl.clearAll(),t.attackChar(gR.ins.charId,o.char_id))}}t.errorTime=BB.getTimer()}else if(2==uH.Ins().currCkType&&!t.isStop&&!dr.dtoEnterScene&&!aH.isZhanBaokMode)if(0==zN.getMonsters().length&&0==zN.enabledPickupQueueLength2){if(2e3<BB.getTimer()-t.errorTime)return t.errorTime=BB.getTimer(),void uH.Ins().doNotPlayNextThen(!0)}else t.errorTime=BB.getTimer()}},t.clickUnionAttack=function(e){void 0===e&&(e=!1);var t=rn.getIndex(BR.ins.curCopyId),i=rn.MODEL.cate(t);if(0<BR.ins.curCopyId&&1!=i&&27!=i)IH.ins.isCanUse()&&(e||"attack"==NF.mainChar.getCurrAct()||"skill"==NF.mainChar.getCurrAct())&&300<BB.getTimer()-this.unionSendTime&&0<gR.ins.currHP&&(ER.ins.isClickedHeJi=!0,Tu.sendToService(new OL),this.unionSendTime=BB.getTimer());else{var n=this.autoSelect(NF.mainChar);if(n){var s=NF.mainChar,o=ZN.getTileDisByPos(n.tileX,n.tileY,s.tilePoint.x,s.tilePoint.y),a=gR.ins.actorList[0].job,r=Aa.UNION_SKILL[a-1];o<=Vn.MODEL.pointDis(Vn.getIndex(r))&&this.attckCharUnion(s,n)}}},t.pickUp=function(e){if(0<e.objectId){if(500<BB.getTimer()-this.pickupTime){var t=new SA;t.objectId=e.objectId,Tu.sendToService(t),this.pickupTime=BB.getTimer()}}else qN.doPickUp(e,uH.Ins().currCid)},t.exit=function(){null!=uH.Ins().prveCid&&(tr.push("FightCtrl-----exit"),NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(L,modules.scene.others.fight.FightCtrl.start)))},t.attckCharUnion=function(e,t){if(e&&t){var i=L.getUnionSkill(e.hero_id),n=Vn.getIndex(i),s=[t],o=YN.getCharTotalHurtForMonster_New(e,s[0],i);if(o){oH.playSkill2(e,s[0],i);var a=Vn.MODEL.nextCastCD(n);1==e.profession?(o.type=10,e.pauseAct("attack",a)):2==e.profession?(o.type=11,e.pauseAct("skill",a)):3==e.profession&&(o.type=12,e.pauseAct("skill",a)),this.doFightEffectUtilsPlayNormalSkillEnd(s,o.value,o.type,i,e.profession),IH.ins.unionCD=IH.ins.unionCD_Server,IH.ins.unionUseTime=dr.curServerTime+IH.ins.unionCD}}},t.doFightEffectUtilsPlayNormalSkillEnd=function(e,t,i,n,s){if(void 0===n&&(n=0),void 0===s&&(s=0),e&&0<e.length){var o=[e.shift()];modules.scene.others.fight.FightCtrl.onHurt(o,t,i,!1,s,n)}if(0<e.length&&modules.scene.others.fight.FightCtrl.onHurt(e,Math.ceil(t/2),i,!1,s,n),this.zhuijiPos=0,gR.ins.hasZhuiJi())if(ER.ins.isAutoZhuiJi){var a=parseInt($e.MODEL.value($e.getIndex(201)));G.timer.once(a,this,this.autoPlayzhuiji,null)}else Tu.sendToModule("USE_HEJI_BACK",["modules.nav.NavModule"])},t.autoPlayzhuiji=function(){var e=this;if(!(3<=e.zhuijiPos)){var t,i=parseInt($e.MODEL.value($e.getIndex(202))),n=gR.ins.actorList[e.zhuijiPos];if(e.zhuijiPos++,n&&0<n.currHP&&0<=ER.ins.autoZhuiJiStr.indexOf(e.zhuijiPos.toString())){var s=uH.getHero(n.id),o=gR.ins.zhuijiSkill[s.profession-1];if(0!=o){t=e.autoSelect(NF.mainChar);var a=YN.zhuiJiHurtForMonster(s,t,o);if(null==t||null==a||0==a.value)return void e.autoPlayzhuiji();oH.playSkill2(s,t,o);var r=Vn.getIndex(o),l=(Vn.MODEL.nextCastCD(r),Vn.MODEL.singingTime(r));1==s.profession?s.pauseAct("attack",l):s.pauseAct("skill",l);var c=parseInt(gR.ins.cId),u=Pn.getIndex(c),d=(Pn.MODEL.type(u),rn.getIndex(BR.ins.curCopyId));rn.MODEL.cate(d);G.timer.once(l,e,e.playZhuiJiNameAndHurt,[s,t,o,a],!1),G.timer.once(i,e,e.autoPlayzhuiji,null,!1),1==e.zhuijiPos&&Tu.sendToModule("USE_HEJI_BACK",["modules.nav.NavModule"])}else e.autoPlayzhuiji()}}},t.playZhuiJi=function(e){for(var t=-1,i=0;i<gR.ins.actorList.length;i++)if(gR.ins.actorList[i].job==e){t=i;break}if(0<=t){var n=rn.getIndex(BR.ins.curCopyId),s=rn.MODEL.cate(n);if(0<BR.ins.curCopyId&&1!=s&&27!=s)nR.reqZhuiJi(t+1);else{var o,a=gR.ins.actorList[t];if(a&&0<a.currHP){var r=uH.getHero(a.id),l=gR.ins.zhuijiSkill[a.job-1];if(0!=l){o=this.autoSelect(NF.mainChar);var c=YN.zhuiJiHurtForMonster(r,o,l);if(null==o||null==c)return;oH.playSkill2(r,o,l);var u=Vn.getIndex(l),d=(Vn.MODEL.nextCastCD(u),Vn.MODEL.singingTime(u));1==r.profession?r.pauseAct("attack",d):r.pauseAct("skill",d);var h=parseInt(gR.ins.cId),_=Pn.getIndex(h);Pn.MODEL.type(_);G.timer.once(d,this,this.playZhuiJiNameAndHurt,[r,o,l,c],!1)}}}}},t.playZhuiJiNameAndHurt=function(e,t,i,n){var s=!1,o=zN.getMonsters();if(0<o.length){for(var a in o)o[a].char_id==t.char_id&&(s=!0,0<n.bo?modules.scene.others.fight.FightCtrl.onHurt([t],n.bo,n.type,!1,e.profession,i):modules.scene.others.fight.FightCtrl.onHurt([t],n.value,n.type,!1,e.profession,i),ZN.toShake());if(!s){var r=this.autoSelect(NF.mainChar);0<n.bo?modules.scene.others.fight.FightCtrl.onHurt([r],n.bo,n.type,!1,e.profession,i):modules.scene.others.fight.FightCtrl.onHurt([r],n.value,n.type,!1,e.profession,i),ZN.toShake()}}},t.playZhuiJiNameAndHurt2=function(e,t,i,n){modules.scene.others.fight.FightCtrl.playZhuiJiSkill(e,i),modules.scene.others.fight.FightCtrl.addHurtImage(e,n.value,n.type,e.profession,i),modules.scene.others.fight.FightCtrl.onHurt([t],n.value,n.type,!1,e.profession,i),0<n.bo&&modules.scene.others.fight.FightCtrl.onHurt([t],n.bo,n.type,!1,e.profession,i),ZN.toShake()},t.attackChar=function(e,t,i){var n=this;if(void 0===i&&(i=1),NB.isSceneReady){var s=zN.getChar(e);if(s&&s.isBoss&&7!=uH.Ins().currCkType&&27!=uH.Ins().currCkType)s.ai&&s.ai.stop();else{var o=0,a=0;if(-1==i)o=27==uH.Ins().currCkType&&"60195"==s.data.modelId?420:403;else if(s&&s.ai&&"YuanshenAI"==s.ai.className){if(o=this.getYSskill()){var r=this.getsouloutSkillCD(o);this.ysSkillCD.push(o),G.timer.once(r,this,function(){-1!=n.ysSkillCD.indexOf(o)&&n.ysSkillCD.splice(n.ysSkillCD.indexOf(o),1)})}}else if(s&&s.ai&&"PetAI"==s.ai.className){if(o=this.getPetskill()){var l=this.getPetSkillCD(o);a=1}}else{o=L.getCurrSkill(i,s);var c=IH.ins.isChangeSKill(o);c&&1==c[0]&&(o=c[1]),4==i&&IH.ins.isBahu&&(o=416)}if(304==o&&(t=e),303==o&&(t=e),0!=o){var u=zN.getChar(t);if(u&&s){if(1==a){if(!L.checkDisEnough(o,u.point,s.tilePoint,s,1))return;this.ysSkillCD.push(o),s.ai&&s.ai.setAttack(),G.timer.once(l,this,function(){-1!=n.ysSkillCD.indexOf(o)&&n.ysSkillCD.splice(n.ysSkillCD.indexOf(o),1)})}if(u.type!=Za.NPC&&u.type!=Za.TRANSPORT&&u.type!=Za.PICKUP_ITEM&&u.type!=Za.PICKUP_GOLD&&u.type!=Za.CHAR){var d,h=0,_=1,f=1;if(s&&s.type==Za.MONSTER){var p=parseInt(s.proto.modelId),g=hn.getIndex(p),v=hn.MODEL.muId(g);v=_n.getIndex(v);var m=hn.MODEL.skillIds(g);m&&0<m.length&&(o=m[0]),d=_n.MODEL.skillEffect(v),_n.MODEL.effect_shoot(v),_n.MODEL.effect_hit(v),f=hn.MODEL.attackRadius(g);hn.MODEL.attackRadius(g);var y=YN.getMonsterTotalHurtForChar_New(s,u,o);h=y.value,_=y.type}else if(s&&(s.type==Za.MAIN_CHAR||s.type==Za.HERO))if(4==i)h=YN.getPetHurtValue(4),_=1;else if(5==i)h=YN.getNewPetHurtValue(s,u,o),_=29;else if(20<=i)h=YN.getYuanshenHurtValue(s,u,o),_=14;else{var I=YN.getCharTotalHurtForMonster_New(s,u,o);if(!I)return;h=I.value,_=I.type}if((0!=h||0!=_)&&u&&s){if(!L.checkDisEnough(o,u.point,s.tilePoint,s,f)&&-1==s.hero_id)return;if(""!=d&&"0"!=d&&null!=d&&s.loadEffect(d),(203==o||302==o)&&BB.IsModePVE){if(203==o&&s&&s.profession==ha.FA.type)return oH.playSkill(e,e,o,i),nH.addBuff(s.char_id,6,100),void G.timer.once(9e3,this,nH.addBuff,[s,6]);302==o&&nH.addBuff(t,301,o)}if(401==_)return nH.addBuff(t,7,o),void oH.playSkill(e,t,o,i);if(oH.playSkill(e,t,o,i),302==o)return;if(BB.IsModePVE){var b=0,w=[u];-1==Aa.S_FASHI.indexOf(o)&&-1==Aa.S_DAOSHI.indexOf(o)||(b=700/s.actSpeed),204==o&&(b=100),202==o&&(b=700/s.actSpeed),301==o&&(b=150/s.actSpeed),4001!=o&&4002!=o&&4003!=o||(b=550/s.actSpeed),BB.IsModePVE&&(104==o?-1==(w=zN.getTargetForSkillBanYue(s.tilePoint,s.dir)).indexOf(u)&&w.push(u):204==o&&-1==(w=zN.getMonstersInSize(s.tilePoint)).indexOf(u)&&w.push(u));var x,S=0;u.point;if(303==o?(S=3,x=L.getHurtChar(u.tilePoint,1)):205==o?(S=2,x=L.getHurtChar(u.tilePoint,2)):406==o&&(S=0,x=L.getMonsterHurtChar(u.tilePoint,5)),0==h&&304==o)return;var k=YN.checkTriggerMabi(s),E=[];if(x&&x.length){for(var T=0;T<x.length;T++){var C=x[T];C&&C.doDelay(b,C,C.doOnHurt,[[C],h,_,!1,S,o]),C.type==Za.MONSTER&&E.push(C)}k&&C.doDelay(b,this,function(){YN.forceTriggerMabi(s,E)})}else{for(s.type!=Za.MONSTER&&(S=s.profession,(4==s.hero_id||20<=s.hero_id)&&(S=3)),T=0;T<w.length;T++)(C=w[T]).type==Za.MONSTER&&E.push(C);0==b?(modules.scene.others.fight.FightCtrl.onHurt(w,h,_,!1,S,o),k&&YN.forceTriggerMabi(s,E)):(u.doDelay(b,u,u.doOnHurt,[w,h,_,!1,S,o]),k&&u&&u.doDelay(b,this,function(){YN.forceTriggerMabi(s,E)}))}103!=o&&this.showShakeByAttack(u,s,200)}}}}}}}},t.showShakeByAttack=function(e,t,i){e!=NF.mainChar&&e.type==Za.MONSTER&&t==NF.mainChar&&G.timer.once(i,this,this.showShake,[e,e.x,e.y])},t.clearAllPassive=function(){if(L._passiveSkillRecord)for(var e;0<L._passiveSkillRecord.length;)(e=L._passiveSkillRecord.shift())&&e.parent&&e.removeSelf()},t.clearZhuiJiSkillImage=function(){if(L._zhuiJiSkillRecord)for(var e;0<L._zhuiJiSkillRecord.length;)(e=L._zhuiJiSkillRecord.shift())&&e.parent&&(Og.clearAll(e),e.removeSelf())},t.clearFreezeImg=function(){if(L._freezeImgArr&&0<L._freezeImgArr.length){var e=L._freezeImgArr.shift();Og.clearAll(e),e.removeSelf(),e.destroy(),e.dispose(),e=null}},t.clearZhuiJiTimer=function(){G.timer.clear(this,this.autoPlayzhuiji),G.timer.clear(this,this.playZhuiJiNameAndHurt),G.timer.clear(this,this.playZhuiJiNameAndHurt2)},t.clean=function(){this.clearAllPassive(),this.clearZhuiJiSkillImage(),this.clearFreezeImg(),this.clearZhuiJiTimer(),ER.ins.isClickedHeJi=!1},t.autoUnselect=function(e){var t;if(t=e?e.selectTarget:(e=NF.mainChar,NF.Ins().selectChar)){if(t){var i=YH.instance.takeItem(t.tilePoint.x,t.tilePoint.y);(null==i||i.type<=0)&&(e.selectTarget=null,e==NF.mainChar&&(NF.Ins().selectChar=null))}(t.isDeath||!t.stage||t.isRecover||0==t.visible||null==t.ai&&t.type==Za.MONSTER)&&(e.selectTarget=null,e==NF.mainChar&&(NF.Ins().selectChar=null))}},t.autoSelect=function(e){var t;return null==e&&(e=NF.mainChar),e.selectTarget&&e.selectTarget.type!=Za.HERO&&0==e.selectTarget.isDeath&&e.selectTarget.visible&&e.selectTarget.ai?e.selectTarget:(e.type==Za.MAIN_CHAR&&(t=zN.getNearItem(e.point)),t||0!=BB.attackMonsterMode&&(t=this.findNearMonsterByMode(BB.attackMonsterMode))||(t=this.findNearMonster(e.tilePoint,e)),e.selectTarget=t,e==NF.mainChar&&(NF.Ins().selectChar=t),t)},t.findNearMonster=function(e,t){var i=zN.getMonsters();null==t&&(t=NF.mainChar),null==e&&((e=new Uh).x=t.tileX,e.y=t.tileY);for(var n={dis:0,tar:null},s=0;s<i.length;s++){var o=i[s];if(o.type==Za.MONSTER&&!o.isDeath&&o.stage&&o.visible&&0==o.isRecover&&o.ai){var a=ZN.getTileDisByPos(o.tileX,o.tileY,e.x,e.y);null==n.tar?(n.dis=a,n.tar=o):a<n.dis&&(n.dis=a,n.tar=o)}}return n.tar},t.findNearMonsterByMode=function(e){for(var t=zN.getMonsters(e.toString()),i=NF.mainChar,n={dis:0,tar:null},s=0;s<t.length;s++){var o=t[s];if(!o.isDeath&&o.stage&&o.ai){var a=ZN.getTileDisByPos(o.tileX,o.tileY,i.tileX,i.tileY);null==n.tar?(n.dis=a,n.tar=o):a<n.dis&&(n.dis=a,n.tar=o)}}return n.tar},t.findNearMonsterArea=function(e,t){for(var i=zN.getMonsters(),n=[],s=0;s<i.length;s++){var o=i[s];if(!o.isDeath&&o.stage&&o.ai)ZN.getTileDisByPos(o.tileX,o.tileY,e.tileX,e.tileY)<=t&&n.push(o)}return n},t.showShake=function(e,t,i){Og.to(e,{x:e.x-5},10,pa.backIn,ql.create(this,this.onComplseFunc,[e,t,i]))},t.onComplseFunc=function(e,t,i){Og.to(e,{x:e.x+10},10,pa.backIn,ql.create(this,this.onComplseFunc1,[e,t,i]))},t.onComplseFunc1=function(e,t,i){e.x=t,e.y=i},t.getsouloutSkillCD=function(e){return 0<e?Vn.MODEL.CD(Vn.getIndex(e)):-1},t.getPetSkillCD=function(e){return 0<e?Vn.MODEL.CD(Vn.getIndex(e)):-1},t.getYSskill=function(){for(var e=gR.ins.soulSkill,t=0;t<e.length;t++)if(-1==this.ysSkillCD.indexOf(e[t]))return e[t];return 0},t.getPetskill=function(){var e=modules.pet.others.PetDataModel.ins().getPetSkill();if(e)for(var t=0;t<e.length;t++)if(-1==this.ysSkillCD.indexOf(e[t]))return e[t];return 0},p(0,t,"isStop",function(){return this._isStop},function(e){this._isStop=e}),p(0,t,"autoMode",function(){return this._autoMode},function(e){0==e&&yH.Ins().clear(),this._autoMode=e}),L.getInstance=function(){return null==L._instance_&&new L,L._instance_},L.startInstantFight=function(){var e=new pD;Tu.sendToService(e),tr.push(RP.n[118])},L.fights=function(e){var t=new gD;t.objectId=e,Tu.sendToService(t)},L.start=function(){modules.scene.others.fight.FightCtrl.getInstance().isStop=!1,modules.scene.others.fight.FightCtrl.getInstance().autoMode=!0},L.stop=function(){modules.scene.others.fight.FightCtrl.getInstance().isStop=!0},L.getRate=function(e){return Math.round(1e6*Math.random())<100*e},L.playSkillSountHit=function(e,t){},L.getHurtChar=function(e,t){void 0===t&&(t=3);for(var i=[],n=e.x-t,s=e.x+t,o=e.y-t,a=e.y+t,r=n;r<=s;r++)for(var l=o;l<=a;l++){var c=zN.getCharByPtXY(r,l);c&&c.hero_id<=0&&c.type==Za.MONSTER&&0==c.isRecover&&c.stage&&c.visible&&i.push(c)}return i},L.getMonsterHurtChar=function(e,t){void 0===t&&(t=3);for(var i=[],n=e.x-t,s=e.x+t,o=e.y-t,a=e.y+t,r=n;r<s;r++)for(var l=o;l<a;l++){var c=zN.getCharByPtXY(r,l);c&&0<c.hero_id&&0==c.isRecover&&c.stage&&c.visible&&i.push(c)}return i},L.getHurtCharByDir=function(e,t){void 0===t&&(t=4);for(var i=[],n=1;n<t+1;n++){var s=VB.getTileByDir(e.tilePoint,e.dir,n),o=PB.pixelsToTile(s.x,s.y),a=zN.getCharByPtXY(o.x,o.y);a&&a.hero_id<=0&&a.type==Za.MONSTER&&0==a.isRecover&&a.stage&&a.visible&&i.push(a)}return i},L.onBuffHurt=function(e,t,i,n){var s=zN.getChar(n),o=zN.getChar(i);if(s&&o){var a=YN.getCharTotalHurtForMonster_New(s,o,t);if(a){var r=a.value,l=a.type;L.onHurt([o],r,l,!1,s.profession,t)}}},L.onBuffADD=function(e,t,i){void 0===i&&(i=0);var n=zN.getChar(t);if(!aH.isZhanBaokMode&&(!dr.dtoEnterScene||7!=dr.dtoEnterScene.type)&&(!dr.dtoEnterScene||49!=dr.dtoEnterScene.type)&&(!dr.dtoEnterScene||14!=dr.dtoEnterScene.type)&&!ZN.isSynchScene()&&n){var s=100;0<n.hero_id&&(s=n.proto.maxHP-n.proto.currHP);L.onHurt([n],s,9,!0,n.profession,i)}},L.playHeJiNameImage=function(e,t){var i=_r.getFullUrl("ui/images/actor_heji/"+t+".png");G.loader.getRes(i)?modules.scene.others.fight.FightCtrl.onHeJiLoad(e,t,i):G.loader.load(i,ql.create(L,modules.scene.others.fight.FightCtrl.onHeJiLoad,[e,t,i]),null,"image")},L.loadPassiveImage=function(e,t){var i,n=gt.MODEL.type(t-1);switch(n){case 1:i=[_r.getFullUrl("ui/images/passiveskill/textbg_mc_dhk.png")];break;case 2:var s=gt.MODEL.dect(t-1);i=[_r.getFullUrl("ui/images/passiveskill/pz_jn_dt.png"),_r.getFullUrl("ui/images/passiveskill/"+s+".png")];break;case 3:i=[_r.getFullUrl("ui/images/passiveskill/pz_bdpz_dt.png")]}G.loader.load(i,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveSkillLoad,[e,t,n,i]),null,"image")},L.onHeJiLoad=function(e,t,i){var n=new Kl;n.skin=i,n.scaleX=n.scaleY=3,n.x=e.x-n.width,n.y=e.y-200*n.scaleX,n.alpha=0,L.charX=e.x,L.charY=e.y,L.hTarX=e.x-n.width/2-50,L.hTarY=e.y-400,Og.to(n,{scaleX:1,scaleY:1,alpha:1,x:e.x-n.width/2-50,y:e.y-400},100,pa.cubicInOut),G.timer.once(800,null,function(){L.onPlayHeJiNameEnd(n)}),NF.scene.addChild(n)},L.playZhuiJiSkill=function(e,t){if(0!=zN.getMonsters().length){null==L._zhuiJiSkillRecord&&(L._zhuiJiSkillRecord=[]);var i="";switch(e.profession){case ha.ZHAN.type:i=3<t%10?"zj_pz_zbfz":"zj_pz_bfz";break;case ha.FA.type:i=3<t%10?"zj_pz_hbxc":"zj_pz_hbc";break;case ha.DAO.type:i=3<t%10?"zj_pz_shdz":"zj_pz_gdz"}var n;n=[_r.getFullUrl("ui/images/skill/zj_pz_dt.png"),_r.getFullUrl("ui/images/skill/"+i+".png")],G.loader.load(n,ql.create(L,modules.scene.others.fight.FightCtrl.onZhuiJiSkillLoad,[e,n,t]),null,"image")}},L.onZhuiJiSkillLoad=function(e,t,i){if(!(0<=e.InterruptsingSkillIdArr.indexOf(i))){var n=new pp;NF.scene.addChild(n);var s=new Kl;s.skin=t[0],n.addChild(s);var o=new Kl;o.skin=t[1],o.pos(10,10),n.addChild(o),L._zhuiJiSkillRecord.push(n);NF.mainChar;n.scaleX=n.scaleY=3,n.x=L.charX,n.y=L.charY,n.alpha=0,NF.scene.addChild(n),Og.to(n,{scaleX:1,scaleY:1,alpha:1,x:L.hTarX,y:L.hTarY},100,pa.cubicInOut),G.timer.once(800,null,function(){L.onZhuiJiSkillEnd(e,n)})}},L.onZhuiJiSkillEnd=function(e,t){Og.to(t,{alpha:0},500),G.timer.once(800,null,function(){L.onZhuiJiSkillFakeOut(t)})},L.onZhuiJiSkillFakeOut=function(e){e&&NF.scene.contains(e)&&e.removeSelf()},L.playzhudongSkill=function(e,t){if(null==L._passiveSkillRecord&&(L._passiveSkillRecord=[]),0<gt.count)L.loadzhudongImage(e,t);else{var i=[{url:_r.getJxrDBPath("BuffPassiveFly"),type:"arraybuffer",cls:gt}];uc.ins().onLoadJxrs(i,ql.create(L,modules.scene.others.fight.FightCtrl.loadzhudongImage,[e,t]))}},L.loadzhudongImage=function(e,t){var i,n=gt.MODEL.type(t-1);switch(n){case 1:i=[_r.getFullUrl("ui/images/passiveskill/textbg_mc_dhk.png")];break;case 2:var s=gt.MODEL.dect(t-1);i=[_r.getFullUrl("ui/images/passiveskill/pz_jn_dt.png"),_r.getFullUrl("ui/images/passiveskill/"+s+".png")];break;case 3:i=[_r.getFullUrl("ui/images/passiveskill/pz_bdpz_dt.png")]}G.loader.load(i,ql.create(L,modules.scene.others.fight.FightCtrl.onzhudongSkillLoad,[e,t,n,i]),null,"image")},L.getCharByObjectId=function(e){if(NF.mainChar.objectId==e)return NF.mainChar;var t=uF.charQueue.take(e);return t||(t=uH.getHeroByObjectid(e)),t||null},L.onzhudongSkillLoad=function(e,t,i,n){var s=L.getCharByObjectId(e);switch(i){case 1:if(!s)return;var o=new pp;o.size(120,40);var a=new Kl;a.sizeGrid="4,4,4,4,0",a.skin=n[0],a.left=a.right=a.top=a.bottom=0,o.addChild(a);var r=new Yp;r.pos(6,8),5==s.hero_id?r.color="#e0d6c1":r.color=ms.PASSIVE_SKILL_POSITION[s.hero_id-1];var l=gt.MODEL.dect(t-1);r.text=l,r.font=dr.font,r.fontSize=20,r.align="center",r.width=100,o.addChild(r),o.pivot(o.width,o.height),o.alpha=0,o.pos(s.x,s.y-73),NF.scene.addChild(o),L._passiveSkillRecord.push(o),Og.to(o,{scaleX:1,scaleY:1,alpha:1,x:s.x-50,y:s.y-123},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveZiSkillEnd,[o]));break;case 2:if(!(s=uH.heroQueue[0]))return;null==L._passiveSP?(L._passiveSP=new pp,(L._passiveBg=new Kl).skin=n[0],L._passiveSP.addChild(L._passiveBg),L._passiveHurt=new Kl,L._passiveSP.addChild(L._passiveHurt)):Og.clearAll(L._passiveSP),L._passiveHurt.skin=n[1],L._passiveSP.x=s.x-200,L._passiveSP.y=s.y-330,L._passiveSP.scaleX=L._passiveSP.scaleY=3,L._passiveSP.alpha=0,Og.to(L._passiveSP,{scaleX:1,scaleY:1,alpha:1,x:s.x-200,y:s.y-330},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveSkillEnd,[s,n])),NF.scene.addChild(L._passiveSP),L._passiveSkillRecord.push(L._passiveSP);break;case 3:if(!s)return;(o=new pp).size(43,176),(a=new Kl).skin=n[0],a.left=a.right=a.top=a.bottom=0,o.addChild(a),(r=new Yp).color="#f8d40a";var c=(l=gt.MODEL.dect(t-1)).split("");r.text=c.join("\n"),r.font=dr.font,r.fontSize=24,r.align="center",r.width=o.width,r.height=132,r.valign="middle",r.wordWrap=!0,o.addChild(r),o.alpha=0,o.pos(s.x-40,s.y-303),NF.scene.addChild(o),L._passiveSkillRecord.push(o),Og.to(o,{alpha:1,y:s.y-363},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveZiSkillEnd,[o]))}},L.playPassiveSkill=function(e,t){if(null==L._passiveSkillRecord&&(L._passiveSkillRecord=[]),0<gt.count)L.loadPassiveImage(e,t);else{var i=[{url:_r.getJxrDBPath("BuffPassiveFly"),type:"arraybuffer",cls:gt}];uc.ins().onLoadJxrs(i,ql.create(L,modules.scene.others.fight.FightCtrl.loadPassiveImage,[e,t]))}},L.playBuffImg=function(e,t){null==L._freezeImgArr&&(L._freezeImgArr=[]);var i=_r.getFullUrl("ui/images/skill/"+t+".png");G.loader.load(i,ql.create(L,modules.scene.others.fight.FightCtrl.loadFreezeComplete,[e,i]),null,"image")},L.loadFreezeComplete=function(e,t){var i;L._freezeImgArr.length<10?((i=new Kl).skin=t,L._freezeImgArr.push(i)):i=L._freezeImgArr.shift(),NF.scene.addChild(i),i.pos(e.x,e.y-90),Og.to(i,{y:e.y-120},500,pa.cubicOut,ql.create(L,modules.scene.others.fight.FightCtrl.onFreezeFakeOut,[i]))},L.onFreezeFakeOut=function(e){Og.to(e,{alpha:0,x:e.x-20,y:e.y-30},500,pa.circIn,ql.create(null,function(){NF.scene.removeChild(e)},null))},L.onPassiveSkillLoad=function(e,t,i,n){var s=uH.heroQueue[e];switch(i){case 1:var o=new pp;o.size(120,40);var a=new Kl;a.sizeGrid="4,4,4,4,0",a.skin=n[0],a.left=a.right=a.top=a.bottom=0,o.addChild(a);var r=new Yp;r.pos(6,8);var l=gR.ins.actorList[e];r.color=ms.PASSIVE_SKILL_POSITION[l.job-1];var c=gt.MODEL.dect(t-1);r.text=c,r.font=dr.font,r.fontSize=20,r.align="center",r.width=100,o.addChild(r),o.pivot(o.width,o.height),o.alpha=0,o.pos(s.x,s.y-73),NF.scene.addChild(o),L._passiveSkillRecord.push(o),Og.to(o,{scaleX:1,scaleY:1,alpha:1,x:s.x-50,y:s.y-123},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveZiSkillEnd,[o]));break;case 2:s=uH.heroQueue[0],null==L._passiveSP?(L._passiveSP=new pp,(L._passiveBg=new Kl).skin=n[0],L._passiveSP.addChild(L._passiveBg),L._passiveHurt=new Kl,L._passiveSP.addChild(L._passiveHurt)):Og.clearAll(L._passiveSP),L._passiveHurt.skin=n[1],L._passiveSP.x=s.x-200,L._passiveSP.y=s.y-330,L._passiveSP.scaleX=L._passiveSP.scaleY=3,L._passiveSP.alpha=0,Og.to(L._passiveSP,{scaleX:1,scaleY:1,alpha:1,x:s.x-200,y:s.y-330},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveSkillEnd,[s,n])),NF.scene.addChild(L._passiveSP),L._passiveSkillRecord.push(L._passiveSP);break;case 3:(o=new pp).size(43,176),(a=new Kl).skin=n[0],a.left=a.right=a.top=a.bottom=0,o.addChild(a),(r=new Yp).color="#f8d40a";var u=(c=gt.MODEL.dect(t-1)).split("");r.text=u.join("\n"),r.font=dr.font,r.fontSize=24,r.align="center",r.width=o.width,r.height=132,r.valign="middle",r.wordWrap=!0,o.addChild(r),o.alpha=0,o.pos(s.x-40,s.y-303),NF.scene.addChild(o),L._passiveSkillRecord.push(o),Og.to(o,{alpha:1,y:s.y-363},150,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassiveZiSkillEnd,[o]))}},L.onPassiveZiSkillEnd=function(e){G.timer.once(800,L,modules.scene.others.fight.FightCtrl.onPassieveSkillFake),G.timer.once(500,null,function(){Og.to(e,{alpha:0},500,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassieveSkillFake,[e]))})},L.onPassiveZiSkillFake=function(e){e.removeSelf(),e.destroy(),e=null},L.onPassiveSkillEnd=function(e,t){G.timer.once(850,L,modules.scene.others.fight.FightCtrl.onPassieveSkillFake),G.timer.once(300,null,function(){Og.to(L._passiveSP,{alpha:0},500,null,ql.create(L,modules.scene.others.fight.FightCtrl.onPassieveSkillFake))})},L.onPassieveSkillFake=function(){null!=L._passiveSP&&null!=L._passiveSP.parent&&L._passiveSP.removeSelf()},L.onPlayHeJiNameEnd=function(e){Og.to(e,{alpha:0},500),G.timer.once(720,null,function(){L.onPlayHeJiFake(e)})},L.onPlayHeJiFake=function(e){e.dispose(),NF.scene.removeChild(e),e=null},L.playHurtImage=function(e,t){void 0===t&&(t=1),G.timer.once(300,L,modules.scene.others.fight.FightCtrl.playHurtImage2,[e,t],!1)},L.playHurtImage2=function(e,t){void 0===t&&(t=1);for(var i=3,n=0;n<3;n++){var s=L.hHurts[n];if(null==s||s.isDisposed){i=n;break}}if(!(3<=i)){var o=60*i+G.stage.height/2,a=G.stage.width/2-150,r=hq.GetNew();r.toImage(0,802,t),r.pivotX=r.width/2,r.pivotY=r.height/2-110,r.toImage(0,e,t,!1),r.x=a,r.y=o,r.scaleX=r.scaleY=2,r.alpha=1,L.hHurts[i]=r,Og.to(r,{scaleX:.5,scaleY:.5},250,null,ql.create(L,modules.scene.others.fight.FightCtrl.onHurtImgStep1,[i,e])),NF._EffectLayer_.addChild(r)}},L.onHurtImgStep1=function(e,t){var i=L.hHurts[e];-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(t)||-1!=Aa.STATR_UNION_TYPE.indexOf(t)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(t)?Og.to(i,{scaleX:1,scaleY:1},1e3,null,ql.create(L,modules.scene.others.fight.FightCtrl.onHurtImgStep2,[e,t])):Og.to(i,{scaleX:1,scaleY:1},250,null,ql.create(L,modules.scene.others.fight.FightCtrl.onHurtImgStep2,[e,t]))},L.onHurtImgStep2=function(e,t){var i=L.hHurts[e];-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(t)||-1!=Aa.STATR_UNION_TYPE.indexOf(t)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(t)?Og.to(i,{x:i.x-300,alpha:0},350,null,ql.create(L,modules.scene.others.fight.FightCtrl.onHurtImgEnd,[e]),750):Og.to(i,{x:i.x-300,alpha:0},250,null,ql.create(L,modules.scene.others.fight.FightCtrl.onHurtImgEnd,[e]),750)},L.onHurtImgEnd=function(e){var t=L.hHurts[e];L.hHurts[e]=null,t.clearRecover(null)},L.skillState=function(e,t,i,n){void 0===n&&(n=0);var s,o=0;switch(6==t&&(o=Vn.getIndex(203),s=Vn.MODEL.effect_hit(o),0!=i?e&&e.profession==ha.FA.type&&null!=s&&""!=s&&(e.delayDo(510,e,e.loadEffect,[s,Za.LAYER_BODY_TOP,"eid_"+s.toString()]),Aa.EFFECT_MOFADUN="eid_"+s.toString()):e&&null!=s&&""!=s&&e.removeEffect("eid_"+s.toString())),1==t&&e&&e instanceof zwc.engine.core.displays.world.char.Char&&e.delayDo(n,e,e.setPoisoning,[0!=i]),7==t&&e&&e instanceof zwc.engine.core.displays.world.char.Char&&e.delayDo(n,e,e.setMabi,[0!=i]),t){case 15:e&&e instanceof zwc.engine.core.displays.world.char.Char&&e.setMoZhuangDun(0!=i);break;case 16:e&&e instanceof zwc.engine.core.displays.world.char.Char&&e.setShenmoDun(0!=i);break;case 10:e&&(e.setFreeze(0!=i),0!=i&&modules.scene.others.fight.FightCtrl.playBuffImg(e,"zj_pz_bd"));break;case 9:e&&(e.setBurn(0!=i),0!=i&&modules.scene.others.fight.FightCtrl.playBuffImg(e,"pz_pt_zs"));break;case 18:e&&e instanceof zwc.engine.core.displays.world.char.Char&&e.delayDo(n,e,e.setStun,[0!=i])}},L.onHurt=function(e,t,i,n,s,o,a,r,l,c){void 0===n&&(n=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===r&&(r=!1),void 0===l&&(l=!0);for(var u=0;u<e.length;u++){var d=e[u];t=Math.abs(t);var h=300;if(0<o){var _=Vn.getIndex(o);h=Vn.MODEL.hitDealytime(_)}10!=i&&11!=i&&12!=i||(h=800),26==i||27==i||28==i?h=800:-1!=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(o)&&(h=10),d&&d.doDelay(h,d,d.doAddHurtImage,[d,t,i,s,a,r,o,l,c])}},L.setDeath=function(e){if(e)if(e.selectTarget=null,NF.Ins().selectChar==e&&(NF.Ins().selectChar=null),nH.removeCharBuff(e.char_id),dr.dtoEnterScene&&0!=dr.dtoEnterScene.cid&&22==dr.dtoEnterScene.type&&e.type==Za.CHAR&&e.data&&1==e.data.robot&&zB.ins.checkRainbowAction("robot",e.data.modelId),e.type==Za.MONSTER){if(UB.ins._playMonsterSound(parseInt(e.proto.modelId),3),dr.dtoEnterScene&&0!=dr.dtoEnterScene.cid&&4==dr.dtoEnterScene.type&&0==modules.copy.others.PigData.ins.isEnd){modules.copy.others.PigData.ins.killMonsterNumber++;var t=new Uh(e.x,e.y);Tu.sendToModule("COPY_FIREPIG_NUM_CHANGE",["modules.copy.CopyModule"],{p:t})}uH.Ins().killMonster(e)}else e.type!=Za.MAIN_CHAR&&e.type!=Za.HERO&&(ZN.isSynch()||e.removeReason.push("setdeath"))},L.addHurtImage=function(e,t,i,n,s){if(void 0===i&&(i=-1),void 0===n&&(n=0),void 0===s&&(s=0),-1==Aa.ZHUI_JI_TYPE_ARR.indexOf(i)||0!=t){var o=BB.getTimer();if(o-L.showHurtImgeTime<300){if(L.showHurtImgeIndex++,5<L.showHurtImgeTime)return;L.showHurtImgeTime=o}else L.showHurtImgeIndex=0;if(-1==i&&(i=1),e&&NB.isSceneReady&&!NB.isAllStop)if(34==i&&e.hero_id<=0)L.playHurtImage(i,n);else{var a=hq.GetNew();a.owner=e,a.type=i.toString(),a.toImage(t,i,n,!0,s),a.x=e.x,a.y=e.y;var r=pt.width,l=NF.mainChar,c=0;if(-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(i)||-1!=Aa.STATR_UNION_TYPE.indexOf(i)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(i)){a.setStartY(e.y+50-50*Math.random(),i);NF.scene.localToGlobal(new Uh(e.x,e.y));c=200,a.setOffsetX(l.x-a.width/2-c)}else if(4==i){a.setStartY(e.y+50-50*Math.random(),i);var u=NF.scene.localToGlobal(new Uh(e.x,e.y));u.x+a.width>r&&(a.width>=r||u.x>=r)?(u.x>=r&&(c+=u.x-r),a.width>=r&&(c+=a.width-r),a.setOffsetX(e.x-a.width/2*3-c)):a.setOffsetX(e.x-a.width/2*3)}else 9==i||2==i?a.setStartY(e.y+70,i):9999==i?a.setStartY(e.y,9999):(0==t?a.setStartY(e.y,5):1<i?a.setStartY(e.y,1):a.setStartY(e.y,0),a.setOffsetX(e.x));a.startPlay();var d=VB.getCharDir(NF.mainChar.point.x,NF.mainChar.point.y,e.point.x,e.point.y);a.dir=d,NF.scene.addHurtImage(a)}}},L.attackCharEnabled=function(e,t,i){return void 0===t&&(t=1),null==i&&(i=NF.mainChar),0!=L.getCurrSkill(t,e)&&(!L.checkCharInSafe(i)&&(null!=e&&!(e.type==Za.NPC||e.type==Za.TRANSPORT||e.type==Za.DIGGER||e.type==Za.PICKUP_ITEM||e.type==Za.PICKUP_GOLD||e.type==Za.COLLECTION||e.type==Za.BUILDING||e.type==Za.MONSTER_TRANSPORT||e.owner_char==i.char_id||!e.selectEnabled)))},L.getCurrSkill=function(e,t,i){if(void 0===e&&(e=1),void 0===i&&(i=0),4==e)return 405;if(5==e)return 405;if(20<=e)return gR.ins.soulSkill[0];if(0!=i)return 101;var n=IH.ins.takeCharSkillList(e),s=gR.ins.actorById(e);if(1<n.length){var o=0;for(n.length;o<n.length;o++){var a=n[o];if(401==a.skill_id){n.splice(o,1);break}if(-1<IH.ins.UNION_SKILL.indexOf(a.skill_id)){n.splice(o,1);break}if(6001==a.skill_id){n.splice(o,1);break}}}if(0==n.length){if(s){if(1==s.job)return Aa.S_ZHANSHI[0];if(2==s.job)return Aa.S_FASHI[0];if(3==s.job)return Aa.S_DAOSHI[0]}return 0}for(var r,l=[],c=0,u=3==s.job?[]:1==s.job?L.spSkillsZhan:L.spSkillsFa,d={};c<n.length;c++)if(204!=n[c].skill_id&&(305!=n[c].skill_id||!uH.Ins().isShowDogHero())){var h=!1;for(o=0;o<u.length;o++){if(n[c].skill_id==u[o].id)1<modules.scene.others.fight.FightCtrl._instance_.findNearMonsterArea(uH.getHero(e),u[o].dis).length?1==u[o].type&&(h=!0):2==u[o].type&&(h=!0)}if(gR.ins.lv<=35&&(h=!1),h)h=!(d[n[c].skill_id]=1);else if((d[n[c].skill_id]=0)==modules.scene.others.fight.FightCtrl.checkInCd(n[c].skill_id))if(t&&t.isPoisoning&&302==n[c].skill_id);else if(0<n[c].skill_id)if(203==n[c].skill_id){var _=uH.getHero(e),f=Vn.getIndex(n[c].skill_id);_&&0==_.hasEffect(f.toString())&&l.push(n[c])}else l.push(n[c])}if(1==n.length||0==l.length)return 3!=s.job&&1==d[n[0].skill_id]?1==s.job?104:205:n[0].skill_id;if(l=ol.srotOn(l,"prioOnSrot",Array.NUMERIC),1==e&&L.hasSkill(104,l)){var p=uH.getHero(e);if(p)if(1<zN.getTargetForSkillBanYue(p.tilePoint,p.dir).length)return 104}for(c=0;c<l.length;c++)if(r=l[c],L.useSkills.indexOf(r.skill_id)<0)return L.useSkills.push(r.skill_id),r.skill_id;return r=l[L.useSkills.length=0],L.useSkills.push(r.skill_id),r.skill_id},L.getUnionSkill=function(e){return void 0===e&&(e=1),500+gR.ins.actorList[0].job},L.hasSkill=function(e,t){for(var i=0;i<t.length;i++){if(t[i].skill_id==e)return!0}return!1},L.take8GridChar=function(e){for(var t=0,i=L.getHurtChar(e,1),n=0;n<i.length;n++)i[n].type==Za.MONSTER&&t++;return t},L.checkNeedTar=function(e){return!1},L.checkDisEnough=function(e,t,i,n,s){if(void 0===s&&(s=1),0==e)return!1;null==n&&(n=NF.mainChar);var o=PB.pixelsToTile(t.x,t.y),a=0;a=null!=i?ZN.getTileDisByPos(o.x,o.y,i.x,i.y):ZN.getTileDisByPos(o.x,o.y,n.tileX,n.tileY);var r=0;if(n.type==Za.MONSTER)r=s;else{var l=Vn.getIndex(e);r=Vn.MODEL.pointDis(l)}return a<=r},L.getSkillDisValue=function(e,t,i){if(0==e)return 1;var n,s=Vn.getIndex(e),o=Vn.MODEL.pointDis(s),a=PB.pixelsToTile(t.x,t.y),r=PB.pixelsToTile(i.x,i.y);return(n=ZN.getTileDisByPos(a.x,a.y,r.x,r.y))<=o?0:Math.abs(n-o)},L.checkCharInSafe=function(e){var t=YH.instance.takeItemByKey(e.key);return t&&t.isSafe&&t.isSafe,!1},L.checkInCd=function(e){return eB.getInstance().checkIsInCD(e)},L.playNotEffectImg=function(e){L.addHurtImage(e,0,9999,e.profession,9999)},L.onHudunEffectLoad=function(e,t){var i=new pp,n=new Kl;n.skin=t[0],i.addChild(n),NF.scene.addChild(i),i.scaleX=i.scaleY=3,i.x=e.x,i.y=e.y,i.alpha=0;var s=e.x-n.width/2-50,o=e.y-400;NF.scene.addChild(i),Og.to(i,{scaleX:1,scaleY:1,alpha:1,x:s,y:o},100,pa.cubicInOut),G.timer.once(800,null,function(){L.onHudunEffectEnd(e,i)})},L.onHudunEffectEnd=function(e,t){Og.to(t,{alpha:0},100),G.timer.once(800,null,function(){t.removeSelf()},[t])},L._instance_=null,L._passiveSkillRecord=null,L._zhuiJiSkillRecord=null,L._freezeImgArr=null,L.pickItems=[],L.charX=NaN,L.charY=NaN,L.hTarX=NaN,L.hTarY=NaN,L._passiveHurt=null,L._passiveBg=null,L._passiveSP=null,L.hHurts=[],L.showHurtImge=0,L.showHurtImgeTime=0,L.showHurtImgeIndex=0,L.autoFighCounter=0,L.index=0,L.useSkills=[],f(L,["spSkillsZhan",function(){return this.spSkillsZhan=[{id:101,type:1,dis:1},{id:102,type:1,dis:1},{id:104,type:2,dis:1}]},"spSkillsFa",function(){return this.spSkillsFa=[{id:201,type:1,dis:3},{id:205,type:2,dis:3}]}]),L}(),oH=function(e){function I(){I.__super.call(this)}return b(I,"modules.scene.others.fight.FightEffectUtils",$h),I.playSkill2=function(e,t,i,n){void 0===n&&(n=!0);try{if(!G.stage.isVisibility)return;if(0==i)return;4==e.hero_id&&403==i&&(i=405),eB.getInstance().playSkillCD(i);var s=Vn.getIndex(i),o=Vn.MODEL.attack_action(s);if(203==i){e.play(o);var a=Vn.MODEL.effect_play(s);return void(SF.GetIntance().checkPackidIsBlock("24011")||e.loadEffect(a,Za.LAYER_BODY_TOP,null,!0,0,!0,"stand"))}if(0==n)return void e.play(o);if(""!=Vn.MODEL.effect_shoot(s)&&"0"!=Vn.MODEL.effect_shoot(s))I.playShootSkill(e,t,s);else if(103==i){if(BB.IsModePVE){e&&t&&e.hasOwnProperty("faceTo")&&e.faceTo(t);var r=e.dir;if(8==uH.Ins().currCkType)if(e&&t)0<ol.distance(e.point,t.point)&&(r=VB.getDretion(e.point.x,e.point.y,t.point.x,t.point.y),e.dir=r);if(!e.tilePoint)return;var l=YN.getCZ(e.tilePoint,r),c=[l.tarData];(t.isBoss||t.isElites)&&(c=[e.tilePoint]),SF.GetIntance().checkPackidIsBlock("24011")||modules.scene.others.fight.FightEffectUtils.playChongZhuangSkill(e,l.currData.pt,c,400*e.actSpeed)}}else if(204==i){if(BB.IsModePVE){var u=YN.getKJHH(e.tilePoint);modules.scene.others.fight.FightEffectUtils.playKangJuHuoHuanSkill(e,u)}}else 10196!=i?I.playNormalSkill(e,t,s):e.play("skill");UB.ins._playSkillSound(i,e.hero_id,0)}catch(e){}},I.playSkill=function(e,t,i,n){try{if(!G.stage.isVisibility)return;if("1"==uH.Ins().currCid)return;if(0==i)return;var s=zN.getChar(e);if(s&&(s.lock||s.isRuning)||!s)return;4==s.hero_id&&403==i&&(i=405),eB.getInstance().playSkillCD(i);var o=Vn.getIndex(i),a=zN.getChar(t),r=Vn.MODEL.attack_action(o);if(203==i){s.play(r);var l=Vn.MODEL.effect_play(o);return void(SF.GetIntance().checkPackidIsBlock("24011")||s.loadEffect(l,Za.LAYER_BODY_TOP,null,!0,0,!0,"stand"))}if(""!=Vn.MODEL.effect_shoot(o)&&"0"!=Vn.MODEL.effect_shoot(o))I.playShootSkill(s,a,o);else if(103==i){if(BB.IsModePVE){s&&a&&s.hasOwnProperty("faceTo")&&s.faceTo(a);var c=s.dir;if(8==uH.Ins().currCkType)if(s&&a)0<ol.distance(s.point,a.point)&&(c=VB.getDretion(s.point.x,s.point.y,a.point.x,a.point.y),s.dir=c);if(!s.tilePoint)return;var u=YN.getCZ(s.tilePoint,c),d=[u.tarData];modules.scene.others.fight.FightEffectUtils.playChongZhuangSkill(s,u.currData.pt,d,400*s.actSpeed)}}else if(204==i){if(BB.IsModePVE){var h=YN.getKJHH(s.tilePoint);modules.scene.others.fight.FightEffectUtils.playKangJuHuoHuanSkill(s,h)}}else I.playNormalSkill(s,a,o);UB.ins._playSkillSound(i,s.hero_id,0)}catch(e){}},I.clear=function(){G.timer.clearAll(I);for(var e=zN.charQueue.slice(),t=0;t<e.length;t++){var i=e[t],n=_s.getQualifiedClassName(i);-1==n.indexOf("MainChar")&&-1==n.indexOf("Char")||(G.timer.clearAll(i),Og.clearAll(i),I.chongZhuangCurrComplete(i))}for(var s=0;s<uH.heroQueue.length;s++){var o=uH.heroQueue[s];G.timer.clearAll(o),Og.clearAll(o),I.chongZhuangCurrComplete(o)}},I.playShootSkill=function(e,t,i,n,s){if(void 0===n&&(n=!0),void 0===s&&(s=!1),null!=e&&null!=t)try{if("1"==uH.Ins().currCid)return;var o=Vn.MODEL.effect_shoot(i),a=Vn.MODEL.effect_hit(i),r=Vn.MODEL.effect_hit2(i),l=Vn.MODEL.effect_play(i),c=Vn.MODEL.effect_play2(i),u=0,d=Vn.MODEL.key(i);201==d&&(u=15);var h=Za.LAYER_BODY_TOP;301==d&&(h=Za.LAYER_BODY_BOTTOM),l&&(s||SF.GetIntance().checkPackidIsBlock("24011")||e.loadEffect(l,h,null,!1,0,!0,"stand",0,u));var _="skill",f=!1;if(-1!=e.char_name.indexOf("幻影")&&(f=!0),e.type==Za.MONSTER&&!f){var p=parseInt(e.proto.modelId),g=hn.getIndex(p),v=hn.MODEL.muId(g);v=_n.getIndex(v),l=_n.MODEL.skillEffect(v),a=_n.MODEL.effect_hit(v),o=_n.MODEL.effect_shoot(v),_="attack"}!e.ai||"YuanshenAI"!=e.ai.className&&"PetAI"!=e.ai.className||(_="attack"),n&&e.playSkill(_,800/e.actSpeed),""!=c&&null!=c&&"0"!=c&&"0.0"!=c&&e.loadEffect(c),e&&t&&e.hasOwnProperty("faceTo")&&e.faceTo(t);var m=-70;4e3!=d&&4001!=d&&4002!=d&&4003!=d||(m=-160);var y=700/e.actSpeed;301==d?(y=100,m=-130):-1!=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(d)&&(y=300/e.actSpeed),SF.GetIntance().checkPackidIsBlock("24011")||G.timer.once(y,I,I.playShootEffect,[e,t,o,a,r,m],!1),0<=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(d)&&G.timer.once(300,ZN,ZN.toShake)}catch(e){}},I.playShootEffect=function(e,t,i,n,s,o){if(null!=e&&null!=t){var a=Aj.GetNew();a.speed=1e3,a.loadEffect(i,Za.LAYER_BODY_TOP),a.setXY(e.x,e.y+o);var r=new Uh(a.x,a.y),l=new Uh(t.point.x,t.point.y-60);a.tarMoveTo([r,l]),a.moveEndFunc=ql.create(I,I.playShootEnd,[a,t,n,s]),a.renderInSelf=!0;var c=l.x-r.x,u=l.y-r.y,d=Math.atan2(u,c);a.transform.scale(1,1),a.transform.rotate(d+Math.PI/2),"1"!=uH.Ins().currCid&&NF.scene.addItem(a,2)}},I.playShootEnd=function(e,t,i,n){e&&e.dispose(),"1"!=uH.Ins().currCid&&(t&&t.loadEffect(i),t&&n&&t.loadEffect(n,Za.LAYER_BODY_BOTTOM))},I.playNormalSkill=function(e,t,i){uF.charQueue;if(G.stage.isVisibility&&!SF.GetIntance().checkPackidIsBlock("24011")&&null!=e&&null!=t)try{if("1"==uH.Ins().currCid)return;var n=Vn.MODEL.key(i),s=Vn.MODEL.effect_play(i),o=Vn.MODEL.effect_hit(i),a=Vn.MODEL.effect_play2(i),r=Vn.MODEL.effect_hit2(i),l=Vn.MODEL.attack_action(i),c=Vn.MODEL.nextCastCD(i),u=Vn.MODEL.singingTime(i);if(e.type==Za.MONSTER&&e.char_name&&-1==e.char_name.indexOf("幻影")){var d=parseInt(Object(e.data).modelId);100302==d&&(d=dr.dtoEnterScene.monsterId);var h=d,_=hn.getIndex(h),f=hn.MODEL.muId(_);f=_n.getIndex(f),s=_n.MODEL.skillEffect(f);var p=hn.MODEL.skillIds(_);p&&0<p.length&&(o=2<=p.length?Vn.MODEL.effect_hit(i):_n.MODEL.effect_hit(f)),l="attack";var g=_n.MODEL.effect_shoot(f);if(""!=g&&null!=g&&"0"!=g&&"0.0"!=g)return I.playShootSkill(e,t,i),void(-1!=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(n)&&G.timer.once(u,null,sH.playZhuiJiSkill,[e,n],!1))}304!=n&&t&&e&&t!=e&&t&&e.hasOwnProperty("faceTo")&&e.faceTo(t),-1!=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(n)&&G.timer.once(u,null,sH.playZhuiJiSkill,[e,n,t.char_id],!1),""==l&&(l=1<e.profession?"skill":"attack"),e.type==Za.PET&&(l="attack");var v=c;(v<=0||!v)&&(v=800),"0.0"==s&&(s=""),"0.0"==a&&(a=""),"0.0"==o&&(o=""),"0.0"==r&&(r=""),e.playSkill(l,v);var m=Za.LAYER_BODY_TOP;if(""!=s&&null!=s&&(e.effectPlayKey="eid_"+s,e.loadEffect(s,m,null)),""!=a&&null!=a&&(105==n?G.timer.once(1/e.actSpeed*201,e,e.loadEffect,[a,Za.LAYER_BOTTOM],!1):501==n?G.timer.once(1/e.actSpeed*166,e,e.loadEffect,[a,Za.LAYER_BOTTOM],!1):e.loadEffect(a,Za.LAYER_BOTTOM)),t){t.point;-1<Aa.UNION_SKILL.indexOf(n)&&sH.playHeJiNameImage(e,n)}var y=v;304==n?e.doDelay(y,e,e.doFightEffectUtilsPlayNormalSkillEnd,[e,o,r,n]):-1!=Aa.UNION_SKILL.indexOf(n)?e.doDelay(500,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n]):201==n?(0!=IH.ins.isSpecial_LD_Type&&(1==IH.ins.isSpecial_LD_Type?o="jn10771":2==IH.ins.isSpecial_LD_Type&&(o="jn10780")),e.doDelay(200,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n]),IH.ins.isSpecial_LD_Type=0):305==n?e.doDelay(y,e,e.doFightEffectUtilsPlayNormalSkillEnd,[e,o,r,n]):0<=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(n)?(y=Vn.MODEL.singingTime(i),e.doDelay(y,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n])):YN.isDuanhunSkill(n)?e.doDelay(200,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n]):YN.isFsChangeSkill(n)?e.doDelay(200,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n]):-1!=Aa.NO_DEALY_SKILL.indexOf(n)?e.doDelay(200,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n]):e.doDelay(y,e,e.doFightEffectUtilsPlayNormalSkillEnd,[t,o,r,n])}catch(e){}},I.getHurtChar=function(e,t){void 0===t&&(t=2);for(var i=[],n=e.x-7,s=e.x+7,o=e.y-8,a=e.y+8,r=n;r<s;r++)for(var l=o;l<a;l++){var c=zN.getCharByPtXY(r,l);c&&0==c.hero_id&&c.type==Za.MONSTER&&0==c.isRecover&&c.stage&&c.visible&&i.push(c)}return i},I.playNormalSkillEnd=function(e,t,i,n){if(void 0===n&&(n=0),305==n){var s=uF.charQueue.take(uH.Ins().curentDogObjectID);if(s&&""!=t&&"0.0"!=t)return void modules.scene.others.fight.FightEffectUtils.addEffect(t,s.x,s.y)}var o=zN.getCharByCharIDAndHeroID(e);if(o&&0<o.currHp){Za.LAYER_TOP;if(501==n)return""!=t&&"0.0"!=t&&modules.scene.others.fight.FightEffectUtils.addEffect(t,e.x,e.y),void(""!=i&&"0.0"!=i&&(G.timer.once(200,I,modules.scene.others.fight.FightEffectUtils.addEffect,[i,e.x,e.y,0]),modules.scene.others.fight.FightEffectUtils.addEffect(i,e.x,e.y,0)));if(""!=i&&"0.0"!=i&&e.loadEffect(i,Za.LAYER_BOTTOM),""!=t&&"0.0"!=t)return void modules.scene.others.fight.FightEffectUtils.addEffect(t,e.x,e.y)}},I.chongZhuangCurrDealy=function(e){Og.clearTween(e)},I.chongZhuangCurrUpdate=function(e,t){NF.Ins().isStartChange&&(Og.clearAll(e),G.timer.clear(I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrDealy),G.timer.clear(I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrComplete),G.timer.clear(I,modules.scene.others.fight.FightEffectUtils.otherCharDealyMove))},I.chongZhuangCurrComplete=function(e){e.removeEffect(I.KEY_CHONG),e.stopMove(),e.isDeath||e.play("stand"),e.isDisposed||e.isRecover||(e==NF.mainChar&&yH.Ins().clear(),e.lockSkill=!1,e.lockMove=!1)},I.huoHuanCurrComplete=function(e){e.lockSkill=!1,e.lockMove=!1},I.playChongZhuangSkill=function(e,t,i,n){if(null!=e&&!SF.GetIntance().checkPackidIsBlock("24011")){var s=0;e.alginTile();var o=PB.tileToPixels(t);if((s=ol.distance(e.point,o)/n)<=0&&(s=.1),e.stopMove(),I.KEY_CHONG&&e.removeEffect(I.KEY_CHONG),e.lockMove=!0,e.lockSkill=!0,I.KEY_CHONG=e.loadEffect("jn10060",Za.LAYER_BODY_TOP),e.play("run"),G.timer.once(1e3*s+200,I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrDealy,[e],!1),0<o.x&&0<o.y){var a={x:e.x,y:e.y};Og.to(e,{x:o.x,y:o.y,update:ql.create(I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrUpdate,[e,a])},1e3*s);var r=s;r<.5&&(r=.5),G.timer.once(1e3*r,I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrComplete,[e])}if(i)for(var l=0;l<i.length;l++){var c=i[l];if(c){var u=c.tar,d=PB.tileToPixels(c.pt);if(u&&0==u.isDeath){var h=VB.getDretion(u.x,u.y,c.pt.x,c.pt.y);h<4?h+=4:h-=4,u.dir=h,u.stopMove(),u.lockSkill=!0,u.alginTile();var _=ol.distance(u.point,new Uh(d.x,d.y))/n;_<=0&&(_=.15);var f=ol.distance(e.point,u.point)/n;0<d.x&&0<d.y&&G.timer.once(1e3*f-100,I,modules.scene.others.fight.FightEffectUtils.otherCharDealyMove,[u,d,_],!1)}}}}},I.otherCharDealyMove=function(e,t,i){var n={x:e.x,y:e.y};i-=.05,Og.to(e,{x:t.x,y:t.y,update:ql.create(I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrUpdate,[e,n])},1e3*i)},I.playKangJuHuoHuanSkill=function(e,t){var i=400*e.actSpeed;if(e.loadEffect("jn10090"),e.playSkill("skill",800),e.lockSkill=!0,G.timer.once(800,I,modules.scene.others.fight.FightEffectUtils.huoHuanCurrComplete,[e]),uH.Ins().currCid!=_a.S_WorldBoss.toString()&&t)for(var n=0;n<t.length;n++){var s=t[n];if(s){var o=s.tar,a=PB.tileToPixels(s.pt);if(aH.isZhanBaokMode)return;if(o&&0==o.isDeath){var r=VB.getDretion(o.x,o.y,s.pt.x,s.pt.y);r<4?r+=4:r-=4,o.dir=r,o.stopMove(),o.lockSkill=!0,o.alginTile();var l=ol.distance(o.point,new Uh(a.x,a.y))/i;if(l<=0&&(l=.15),0<a.x&&0<a.y){var c={x:o.x,y:o.y};l-=.05,Og.to(c,{x:a.x,y:a.y,update:ql.create(I,modules.scene.others.fight.FightEffectUtils.chongZhuangCurrUpdate,[o,c])},1e3*l)}}}}},I.playScopeSkill=function(e,t,i,n){void 0===i&&(i=2),void 0===n&&(n=7);for(var s=t.x,o=t.y,a=s-n;a<s+n;a++)for(var r=o-n;r<o+n;r++)if(a%i==0&&r%i==0){var l=1e3*Math.random()>>0;G.timer.once(l,I,modules.scene.others.fight.FightEffectUtils.delayEffect,[e,a,r],!1)}},I.delayEffect=function(e,t,i){var n=mj.GetNew();n.renderInSelf=!0,n.isSceneEffect=!0,n.loadEffect(e,Za.LAYER_TOP);var s=new Uh(t,i);s=PB.tileToPixels(s),n.x=s.x,n.y=s.y,n.isCharObj=!0,NF.scene.addItem(n)},I.addEffect=function(e,t,i,n,s){if(void 0===n&&(n=1),void 0===s&&(s=0),null==e)return null;var o=mj.GetNew();return o.renderInSelf=!0,o.loadEffect(e),o.x=t,o.y=i,o.setDir(s),o.isCharObj=!0,NF.scene.addItem(o,n),o},I.LOCK_SKILL=800,I.LOCK_ATTACK=800,I.DEALY_SHOOT=700,I.DEALY_PLAY=800,I.KEY_CHONG="",I}(),aH=function(e){function C(){var e=this;e.isStop=!1,e.isReady=!1,e.isPlaying=!1,e.currDto=null,e.sid=null,e.playDurTime=10,e.playCountTime=0,e.skillRound=[],e.roundNum=2,e.playIndex=0,e.report=new Array,e.currRound,e.nextTime,C.__super.call(e),C._instance_=e,G.timer.frameLoop(1,e,e.loop)}b(C,"modules.scene.others.fight.ZhanBaoCtrl",$h);var t=C.prototype;return t.addDto=function(e){ZN.pickupAll(),C.clearTotalBean(),e&&(this.report.push(e),this.isPlaying||this.playDto())},t.removeDto=function(e){for(var t=0;t<this.report.length;t++){if(this.report[t].id==e)return void this.report.splice(t,1)}},t.loop=function(){this.isStop||this.isReady&&this.isPlaying&&this.loopPlay()},t.stop=function(){sH.getInstance().isStop=!1,sH.getInstance().autoMode=!0,this.isReady=!1},t.start=function(){(!dr.dtoEnterScene||7!=dr.dtoEnterScene.type&&49!=dr.dtoEnterScene.type&&14!=dr.dtoEnterScene.type)&&uH.updateHeroPoint(),sH.getInstance().isStop=!0,sH.getInstance().autoMode=!1,this.isReady=!0},t.beanScene=function(e){},t.playDto=function(){var e=this;if(modules.scene.others.fight.ZhanBaoCtrl.isZhanBaokMode=!0,yH.Ins().clear(),C.huanyinQueue.reset(),0==e.isPlaying){var t,i,n;if(e.isPlaying=!0,e.currDto=e.report.shift(),C.enemyQueue.length=0,uH.Ins().currCid==_a.S_KUANGDONG.toString())var s=new Uh(12,15),o=YH.instance.get8Grids(s);for(var a=0;a<e.currDto.attackers.length;a++)if(0<(i=e.currDto.attackers[a]).currHP){if(e.currDto.isMeAttack)if(!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type)t=i.isDog?uH.getHero(4):uH.getHero(a+1);else{var r=new Uh(NF.mainChar.tilePoint.x,NF.mainChar.tilePoint.y);r.x=r.x+a,r.y=r.y+a;var l=PB.tileToPixels(r);(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,l.x,l.y)).hero_id=a+1,t.char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0)),-1==uF.zhanBaoCharQueue.indexOf(t)&&uF.zhanBaoCharQueue.push(t)}else{if(uH.Ins().currCid==_a.S_ARENA.toString())n=Za.SceneArenaPoints[_],(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,n.x,n.y)).char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0));else if(uH.Ins().currCid==_a.S_KUANGDONG.toString())n=o[a],(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,n.x,n.y)).char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0));else if(!dr.dtoEnterScene||7!=dr.dtoEnterScene.type&&49!=dr.dtoEnterScene.type)if(!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type){var c=YH.instance.get8Grids(NF.mainChar.tilePoint);t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,c[0].x,c[0].y)}else if(e.currDto.isBoss)(t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,uF.currMonsterPoint.x,uF.currMonsterPoint.y)).char_name=i.charName,t.setCharNameVisible(!0);else{var u,d=uF.charQueue.take(i.playerId);(u=d?new Uh(d.tilePoint.x,d.tilePoint.y):(d=NF.mainChar,new Uh(d.tilePoint.x+1,d.tilePoint.y))).x=u.x+a,u.y=u.y+a;var h=PB.tileToPixels(u);(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,h.x,h.y)).char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0)),-1==uF.zhanBaoCharQueue.indexOf(t)&&uF.zhanBaoCharQueue.push(t)}else t=pH.takeChar(i.char_id);C.enemyQueue.push(t)}try{t.profession=i.professional,ZN.setCharTitle(t,i.titles),t.setCharBoolValue(i.currHP,i.maxHP)}catch(e){}t&&(t.data=i),C.bean(t,i.char_id)}for(var _=0;_<e.currDto.defenders.length;_++)if(t=null,0<(i=e.currDto.defenders[_]).currHP){if(e.currDto.isMeAttack){if(uH.Ins().currCid==_a.S_ARENA.toString())n=Za.SceneArenaPoints[_],(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,n.x,n.y)).type=Za.CHAR,t.setCharNameVisible(!0),t.char_name=i.charName,t.charNameColor="#ff0000",""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0));else if(uH.Ins().currCid==_a.S_KUANGDONG.toString())n=o[_],(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,n.x,n.y)).char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0));else if(!dr.dtoEnterScene||7!=dr.dtoEnterScene.type&&49!=dr.dtoEnterScene.type&&14!=dr.dtoEnterScene.type)if(!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type){if(dr.dtoEnterScene&&2==dr.dtoEnterScene.type){var f=YH.instance.get8Grids(NF.mainChar.tilePoint);if(0==_)t=zN.getChar(e.currDto.defenders_id.toString());else if(0<_){for(var p=f[0],g=0;g<f.length;g++){var v=PB.pixelsToTile(f[g].x,f[g].y);null==zN.getCharByPt(v)&&(p=f[g])}(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,p.x,p.y)).charNameColor="#ff0000",t.char_name=i.charName,""!=i.guideName&&(t.setCharProfessionNameVisible(!0),t.charProfessionNameColor="#02b0e9",t.charProfessionName=i.guideName);var m=gR.ins.actorFlyUpLevel;0<m&&(t.setCharFlyupNameVisible(!0),t.setflyupName(m)),ZN.setCharTitle(t,i.titles)}else(t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,f[0].x,f[0].y)).char_name=i.charName,t.ai&&t.ai.stop(),rH.removeAI(t);t&&t.hasOwnProperty("facePoint")&&t.facePoint(NF.mainChar.point);for(var y=0;y<uH.heroQueue.length;y++){var I=uH.heroQueue[y];if(I!=NF.mainChar&&I.ai){I.ai.stop();var b=I.ai.getPoint();I.setXY(b.x,b.y)}I.visible=!0,t&&t.point&&I&&I.hasOwnProperty("facePoint")&&I.facePoint(t.point)}}else if(1==e.currDto.defenders.length&&null!=C.boss)(t=C.boss).type!=Za.CHAR&&(t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,C.boss.x,C.boss.y,C.boss));else if(!(t=zN.getChar(e.currDto.defenders_id.toString()))){var w=YH.instance.get8Grids(NF.mainChar.tilePoint);t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,w[0].x,w[0].y)}}else if(e.currDto.isBoss)(t=modules.scene.others.fight.ZhanBaoCtrl.createMonster(i,uF.currMonsterPoint.x,uF.currMonsterPoint.y)).char_name=i.charName,t.setCharNameVisible(!0);else{var x,S=uF.charQueue.take(i.playerId);(x=S?new Uh(S.tilePoint.x,S.tilePoint.y):(S=NF.mainChar,new Uh(S.tilePoint.x+1,S.tilePoint.y))).x=x.x+_,x.y=x.y+_;var k=PB.tileToPixels(x);(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,k.x,k.y)).char_name=i.charName,t.setCharNameVisible(!0),""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0)),-1==uF.zhanBaoCharQueue.indexOf(t)&&uF.zhanBaoCharQueue.push(t)}else t=pH.takeChar(i.char_id);C.enemyQueue.push(t)}else if(!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type)t=i.isDog?uH.getHero(4):uH.getHero(_+1);else{var E=new Uh(NF.mainChar.tilePoint.x,NF.mainChar.tilePoint.y);E.x=E.x+_,E.y=E.y+_;var T=PB.tileToPixels(E);(t=modules.scene.others.fight.ZhanBaoCtrl.createChar(i,T.x,T.y)).char_name=i.charName,t.setCharNameVisible(!0),t.hero_id=_+1,""!=i.guideName&&(t.charProfessionName=i.guideName,t.setCharNameVisible(!0)),-1==uF.zhanBaoCharQueue.indexOf(t)&&uF.zhanBaoCharQueue.push(t)}try{ZN.setCharTitle(t,i.titles),t.profession=i.professional,t.setCharBoolValue(i.currHP,i.maxHP)}catch(e){}t&&(t.data=i),C.bean(t,i.char_id)}e.playCountTime=BB.getTimer()}e.currRound=null,C.overTime=BB.getTimer(),e.currDto.isBoss&&qU.ins.updateBossBlood(e.currDto.bossData.modelId,e.currDto.bossData.currHP,e.currDto.bossData.maxHP)},t.getAttackData=function(){if(this.skillRound.length)return this.skillRound.shift();if(this.currDto&&this.currDto.roundQueueData.length){var e=this.currDto.roundQueueData.shift();if(this.skillRound=e.queue,this.roundNum=e.charNum,this.skillRound.length)return this.skillRound.shift()}return null},t.playRoundEnd=function(e){for(var t=0;t<gR.ins.actorList.length;t++){var i=gR.ins.actorList[t],n=uH.getHero(i.id);n&&n.relive()}modules.scene.others.fight.ZhanBaoCtrl.isZhanBaokMode=!1},t.onMoveEndHander=function(e,t,i,n){e&&e.play("stand"),e&&0<n&&oH.playSkill(t,i,n,e.hero_id),Og.clearAll(e)},t.playEnd=function(){ZN.isSynchScene()&&qU.ins.updateBossBlood(0),Tu.sendToModule("__ZHANBAO_PLAY_END__",["modules.scene.SceneModule"])},t.loopPlay=function(){var e=this,t=BB.getTimer();if(null!=e.currDto){if(!e.currDto.roundQueueData.length)return e.isPlaying=!1,void G.timer.once(400,e,e.playEnd);if(null==e.currRound||t-e.nextTime>=e.currRound.nextGroundTime){null==e.currRound&&(e.playIndex=0),e.currRound=e.currDto.roundQueueData.shift(),e.nextTime=t;var i=modules.scene.others.fight.ZhanBaoCtrl.getChar(e.currRound.attacker),n=modules.scene.others.fight.ZhanBaoCtrl.getChar(e.currRound.defender);if(e.currRound)if(i instanceof zwc.engine.core.displays.world.char.Char&&n instanceof zwc.engine.core.displays.world.char.Char)if(i&&(i.lockMove=!1),n&&(n.lockMove=!1),204==e.currRound.skillId||304==e.currRound.skillId)204==e.currRound.skillId?oH.playKangJuHuoHuanSkill(i,[]):304==e.currRound.skillId&&oH.playNormalSkill(i,null,e.currRound.skillId);else{ZN.getTileDis(i.tilePoint,n.tilePoint),2==uH.Ins().currCkType||uH.Ins().currCid==_a.S_TIANGUAN.toString()||uH.Ins().currCid==_a.S_KUANGDONG.toString()||(uH.Ins().currCid,_a.S_YeZhanBIQI.toString());n&&n.point&&i&&i.hasOwnProperty("facePoint")&&n!=i&&i.facePoint(n.point),0<e.currRound.skillId&&!n.isDeath&&oH.playSkill2(i,n,e.currRound.skillId)}else if(i instanceof zwc.engine.core.displays.world.char.Char&&204==e.currRound.skillId||304==e.currRound.skillId)if(i&&(i.lockMove=!1),204==e.currRound.skillId)oH.playKangJuHuoHuanSkill(i,[]);else if(304==e.currRound.skillId){var s=Vn.getIndex(e.currRound.skillId);oH.playNormalSkill(i,i,s)}if(e.currRound.att.length||e.currRound.buff.length){var o=0;e.currRound.att.length&&(n=modules.scene.others.fight.ZhanBaoCtrl.getChar(e.currRound.att[0][0]),o=e.currRound.att[0][5]),null==n&&e.currRound.buff.length&&(n=modules.scene.others.fight.ZhanBaoCtrl.getChar(e.currRound.buff[0][0])),n&&(n.type!=Za.HERO&&n.type!=Za.MAIN_CHAR||(o=0),n.doZhanBaoCtrlPlayHurt(e.currRound.att,e.currRound.buff,o))}if(e.currRound.hyArray.length)for(var a=0;a<e.currRound.hyArray.length;a++){var r,l=e.currRound.hyArray[a];if(l.isAdd){if(i){var c=i.x+30,u=i.y-30;u=0==i.dir||1==i.dir||7==i.dir?(c=i.x+30,i.y+30):4==i.dir||3==i.dir||5==i.dir?(c=i.x+10,i.y+30):(c=2==i.dir?i.x+30:i.x-10,i.y-30),null==(r=C.huanyinQueue.take(l.char_id))&&(r=C.createHYMonster(e.currRound.hyArray[a],c,u),C.huanyinQueue.put(l.char_id,r)),C.bean(r,l.char_id),sH.playHurtImage(800,l.professional)}}else(r=C.huanyinQueue.remove(l.char_id))&&(C.unbean(l.char_id),r.removeReason.push("remove"),uH.Ins().removeChar(r))}}}else e.isPlaying=!1},t.getPoint=function(e){return uH.Ins().currCid,_a.S_TIANGUAN.toString(),new Uh},t.currPlayStateEnd=function(){this.currRound&&(this.currRound.playState=2)},t.playHurt=function(e,t,i){void 0===i&&(i=0);for(var n=0;n<e.length;n++){var s=e[n],o=s[0],a=s[1],r=s[2],l=s[3],c=s[4],u=C.getChar(o);if(u){if(0<l&&u.isDeath&&(u.relive(),u.play("stand")),u.setCharBoolValue(l),u.type==Za.MONSTER?0==u.isBoss&&u.setCharBoolVisible(!0):u.setCharBoolVisible(!0),!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type)u==NF.mainChar||u.type==Za.HERO?(Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule"],{hp:u.currHp,heroId:u.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:c,heroId:u.hero_id})):u.type!=Za.CHAR&&uH.Ins().currCid!=_a.S_KUANGDONG.toString()&&uH.Ins().currCid!=_a.S_ARENA.toString()&&qU.ins.updateBossBlood(u.proto.modelId,u.currHp,u.maxHP);else u.proto.playerId.toString()==gR.ins.charId&&0<u.hero_id&&u.hero_id<4?(Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:u.currHp,heroId:u.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:c,heroId:u.hero_id})):u.type==Za.MONSTER&&qU.ins.updateBossBlood(u.proto.modelId,u.currHp,u.maxHP);u.doDelay(50,u,u.doZhanBaoCtrlAddHurtImage,[u,r,a,i]),u.currHp<=0?(u.type==Za.MAIN_CHAR||(u.type,Za.HERO),u.setDeath(),u.play("death")):u.isDeath&&u.relive()}}for(var d=0;d<t.length;d++){var h=t[d],_=h[0],f=h[1],p=h[2],g=C.getChar(_);if(g)switch(p){case 301:1==f?g.delayDo(100,g,g.setPoisoning,[!0]):g.delayDo(100,g,g.setPoisoning,[!1]);break;case 405:if(1==f){g.data&&g.setActSpeedUp(!0,v.accSpeed,1e4)}else{var v=g.data;v&&g.setActSpeedUp(!1)}break;case 401:1==f?g.delayDo(100,g,g.setMabi,[!0]):g.delayDo(100,g,g.setMabi,[!1])}}},p(1,C,"isZhanBaokMode",function(){return C._isZhanBaokMode},function(e){C._isZhanBaokMode=e}),C.getInstance=function(){return null==C._instance_&&new C,C._instance_},C.createHYMonster=function(e,t,i,n){var s="hy000"+e.professional;return null==n&&(n=zN.GetChar()),n.cid=uH.Ins().currCid,n.selectEnabled=!1,ZN.updateCharDisplay(n,s),uH.Ins().addChar(n),n.type=Za.MONSTER,n._proto_=e,n.profession=e.professional,n.setXY(t,i),n.bodyHeight=120,n.char_name="[幻影]",e.playerId.toString()!=gR.ins.charId&&(n.charNameColor="#ff0000"),n.loadEffect("jm1084"),n.dir=8*Math.random()>>0,n.setCharBoolValue(e.currHP,e.maxHP),n.char_id=n.id,n.actSpeed=1.5,NF.scene.addItem(n),n},C.createChar=function(e,t,i,n){return null==n&&(n=zN.GetChar()),n.cid=uH.Ins().currCid,n.selectEnabled=!0,ZN.updateCharDisplay(n,e.mid,e.wid,e.wgid,e.eid,e.chuanshi,e.magicId,e.dragonEff),uH.Ins().addChar(n),n.type=Za.MONSTER,n._proto_=e,n.profession=e.professional,n.flyupLevel=e.flyupLevel,n.cid=uH.Ins().currCid,n.scaleX=n.scaleY=1,n.setXY(t,i),n.bodyHeight=NB.BODY_HEIGHT,n.char_name=e.char_id.toFixed(),n.dir=8*Math.random()>>0,n.setCharBoolValue(e.currHP,e.maxHP),n.char_id=n.id,""!=e.guideName&&(n.setCharProfessionNameVisible(!0),n.charProfessionNameColor="#02b0e9",0<e.guidePos?n.charProfessionName=e.guideName+"["+Bl.getCNPos(e.guidePos)+"]":n.charProfessionName=e.guideName),0<e.flyupLevel&&(n.setCharFlyupNameVisible(!0),n.setflyupName(e.flyupLevel)),ZN.setCharTitle(n,e.titles),NF.scene.addItem(n),n},C.createMonster=function(e,t,i,n){var s=e.modelId,o=hn.getIndex(s),a=hn.MODEL.muId(o);a=_n.getIndex(a);var r=uH.monsterDataHash.take(s);r||(r=JSON.parse(hn.MODEL.attributes(o)),uH.setMonsetAttributes(s,r));var l=_n.MODEL.avatarId(a);null==n&&(n=zN.GetChar()),n.cid=uH.Ins().currCid,n.selectEnabled=!0,ZN.updateCharDisplay(n,l),ZN.setCharTitle(n,e.titles),uH.Ins().addChar(n),n.type=Za.MONSTER,n._proto_=e,n.setXY(t,i),n.bodyHeight=_n.MODEL.avatarHeight(a),n.char_name=hn.MODEL.name(o);var c=_n.MODEL.awayEffect(a);return""!=c&&null!=c&&"0"!=c&&n.loadEffect(c,Za.LAYER_BODY_BOTTOM),n.dir=8*Math.random()>>0,0==e.maxHP&&(e.maxHP=e.currHP),n.setCharBoolValue(e.currHP,e.maxHP),n.char_id=n.id,NF.scene.addItem(n),n},C.clearHy=function(){for(var e in C.huanyinQueue.proto){var t=C.huanyinQueue.remove(e);t&&(pH.unbeanChar(parseInt(e)),t.removeReason.push("remove"),uH.Ins().removeChar(t))}C.huanyinQueue.reset()},C.addHurtImage=function(e,t,i,n){if(void 0===i&&(i=0),void 0===n&&(n=0),e&&NB.isSceneReady&&!NB.isAllStop)if(34==i&&e.hero_id<=0)sH.playHurtImage(i,n);else{var s=hq.GetNew();s.type=i.toString(),s.toImage(t,i,n),s.x=e.x,s.y=e.y,0==t?s.setStartY(e.y,5):1<i?3==i||5==i||3==i||7==i||36==i||24==i?s.setStartY(e.y,5):s.setStartY(e.y,1):s.setStartY(e.y,0),s.setOffsetX(e.x),s.startPlay(),s.owner=e,NF.scene.addHurtImage(s)}},C.getChar=function(e){return C.beanHash.take(String(e))},C.clear=function(){var e,t,i=modules.scene.others.fight.ZhanBaoCtrl.getInstance().currDto;if(i){for(var n=i.attackers.concat(i.defenders),s=0;s<n.length;s++)t=n[s],(e=C.getChar(t.char_id))&&e.type==Za.MONSTER&&(e.removeReason.push("clear"),uH.Ins().removeChar(e)),C.unbean(t.char_id);C.clearHy(),nF.clearHy(),C.beanHash.reset(),modules.scene.others.fight.ZhanBaoCtrl.getInstance().skillRound.length=0,modules.scene.others.fight.ZhanBaoCtrl.getInstance().currRound=null,modules.scene.others.fight.ZhanBaoCtrl.getInstance().currDto=null,modules.scene.others.fight.ZhanBaoCtrl.getInstance().isPlaying=!1,modules.scene.others.fight.ZhanBaoCtrl.getInstance().isStop=!1,modules.scene.others.fight.ZhanBaoCtrl.getInstance().isReady=!1,modules.scene.others.fight.ZhanBaoCtrl.getInstance().report.length=0,modules.scene.others.fight.ZhanBaoCtrl.isZhanBaokMode=!1}},C.unbean=function(e){C.beanHash.remove(e)},C.clearTotalBean=function(){C.beanHash.reset()},C.bean=function(e,t){for(var i in C.beanHash.proto)e&&C.beanHash.proto[i];C.beanHash.put(t,e,!0)},C._instance_=null,C._isZhanBaokMode=!1,C.enemyQueue=[],C.boss=null,C.overTime=0,f(C,["huanyinQueue",function(){return this.huanyinQueue=new jl},"beanHash",function(){return this.beanHash=new jl}]),C}(),rH=function(e){function n(){n.__super.call(this)}return b(n,"modules.scene.others.invented.AIFactory",$h),n.setup=function(){G.timer.loop(10,n,modules.scene.others.invented.AIFactory.loop)},n.loop=function(){if(!NB.isAllStop)for(var e=0;e<n.AI_QUEUE.length;e++){n.AI_QUEUE[e].doit()}},n.startAI=function(e){for(var t=0;t<n.AI_QUEUE.length;t++){var i=n.AI_QUEUE[t];if(i.owner==e&&"YuanshenAI"!=i.className){i.start();break}}},n.stopAI=function(e){for(var t=0;t<n.AI_QUEUE.length;t++){var i=n.AI_QUEUE[t];if(i.owner==e){i.stop();break}}},n.removeAI=function(e){for(var t=0;t<n.AI_QUEUE.length;t++){if(n.AI_QUEUE[t].owner==e){n.AI_QUEUE.splice(t,1);break}}},n.pushAI=function(e){-1==n.AI_QUEUE.indexOf(e)&&n.AI_QUEUE.push(e)},n.getAI=function(e){for(var t=0;t<n.AI_QUEUE.length;t++){var i=n.AI_QUEUE[t];if(i.owner==e)return i}return null},n.clearAll=function(){if(BR.ins.isQuitFromDig2)BR.ins.isQuitFromDig2=!1;else for(var e=0;e<n.AI_QUEUE.length;e++){var t=n.AI_QUEUE[e];"YuanshenAI"==t.className?(t.stop(),t.owner=null,n.AI_QUEUE.splice(e,1),e--):"HeroAI"!=t.className&&"PetAI"!=t.className&&(t.stop(),t.dispose(),t.owner=null,"modules.scene.others.invented.MonsterAI"==t.className&&n.pool.push(t),n.AI_QUEUE.splice(e,1),e--)}},n.clear=function(e){for(var t=0;t<n.AI_QUEUE.length;t++){var i=n.AI_QUEUE[t];if(i==e)return"modules.scene.others.invented.MonsterAI"==i.className&&n.pool.push(i),void n.AI_QUEUE.splice(t,1)}},n.GetMonsterAI=function(){return n.pool.length?n.pool.pop():new dH},n.GetHeroAI=function(){return new cH},n.GetPlayerAI=function(){return new fH},n.GetPlayerGroupAI=function(){return new pH},n.GetCharAI=function(){return new lH},n.GetRobotAI=function(){return new gH},n.GetRobotHootAI=function(){return new vH},n.GetNpcAI=function(){return new hH},n.GetYuanshenAI=function(){return new mH},n.GetPetAI=function(){return new _H},n.pool=[],n.AI_QUEUE=[],n}(),lH=function(e){function t(){this._owner_=null,this._mainChar_=null,this._isStrop_=!1,this.durTime=0,t.__super.call(this),this.actCtrl}b(t,"modules.scene.others.invented.CharAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e){this._owner_=e,(this.owner.ai=this).actCtrl=new NH(e),this.owner.faceTo(NF.mainChar)},i.doit=function(){NB.isAllStop||sH.getInstance().isStop||this._isStrop_||this.moveIt()},i.moveIt=function(){if(2e3<BB.getTimer()-this.durTime&&(this.durTime=BB.getTimer(),this.owner))sH.getInstance().findNearMonster(this.owner.tilePoint,this.owner)},i.stop=function(){this.actCtrl&&this.actCtrl.clearAll(),this._isStrop_=!0},i.start=function(){this._isStrop_=!1},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t}(),cH=function(e){function t(){var e=this;e._owner_=null,e._mainChar_=null,e._isStrop_=!1,e.mode=0,e.durTime=0,e.movetime=0,e.heroAttackDur=800,e.heroAttackTime=0,e.attackDur=2e3,e.attackTime=0,e.autoFighCounter=0,e.actCtrl,t.__super.call(e),e._className_="HeroAI",e.attackTime=BB.getTimer()+(1e3*Math.random()>>0)}b(t,"modules.scene.others.invented.HeroAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e,t){((this._owner_=e).ai=this)._mainChar_=t,this.actCtrl||(this.actCtrl=new NH(e)),this.actCtrl.owner=e},i.moveEndHandler=function(){null==this.actCtrl.nextOrder&&(this.owner.play("stand"),this.owner.selectTarget?this.owner.dir=this.owner.selectTarget.dir:this.owner.dir=this._mainChar_.dir)},i.getSkillList=function(){return[]},i.doit=function(){sH.getInstance().isStop&&8!=uH.Ins().currCkType&&uH.Ins().currCid!=_a.S_ARENA.toString()&&uH.Ins().currCid!=_a.S_KUANGDONG.toString()||this._isStrop_||uH.Ins().currCid!=_a.S_TIANGUAN.toString()&&11!=uH.Ins().currCkType&&(ZN.isSynchScene()||this.moveIt())},i.getPoint2=function(e){for(var t=YH.instance.get8Grids(e),i={point:this.owner.point,dis:0},n=0;n<t.length;n++){for(var s=PB.pixelsToTile(t[n].x,t[n].y),o=!1,a=0;a<uH.heroQueue.length;a++){var r=uH.heroQueue[a].tilePoint;r.x==s.x&&r.y==s.y&&(o=!0)}o&&(t.splice(n,1),n--)}for(var l=0;l<t.length;l++){var c=t[l],u=Math.random()*t.length>>0;t[d]=t[u],t[u]=c}for(var d=0;d<t.length;d++){var h=ol.distance(this.owner.point,t[d]);0==d?(i.point=t[d],i.dis=h):h<i.dis&&(i.point=t[d],i.dis=h)}return i.point},i.getPoint=function(e,t){var i=this;if(void 0===t&&(t=-1),null==e)return YN.getCharNearPt(i._mainChar_,i.owner);null==e&&(e=i._mainChar_.tilePoint),-1==t&&i._mainChar_.dir;var n=t,s=1;2<i.owner.profession&&(s=2);var o=VB.getTileByDir(e,n,s);4==i.owner.profession&&(n=VB.getDretion(i.owner.point.x,i.owner.point.y,i._mainChar_.point.x,i._mainChar_.point.y),o=VB.getTileByDir(e,(i.owner.profession+t)%7,2));var a=PB.pixelsToTile(o.x,o.y),r=YH.instance.takeItem(a.x,a.y);return r&&0!=r.type?o:PB.tileToPixels(e)},i.moveIt=function(){var e=this;if(!dr.inCountDown&&!e.owner.isDeath&&!e.owner.isRuning){var t=ZN.getTileDis(e.owner.tilePoint,e._mainChar_.tilePoint);8<=t&&0==e.owner.lock&&e._mainChar_.isRuning||8<=t&&0==e.owner.lock?(e.owner.speed=400,e.domove(!0)):(e.owner.speed=280,uH.Ins().currCid!=_a.S_ARENA.toString()&&e.autoAttack(e.owner))}},i.domove=function(e){var t=this;void 0===e&&(e=!1);var i=BB.getTimer();if((!(i-t.durTime<100)||e)&&(t.durTime=i,!t.owner.isRuning)){var n=t.getPoint(),s=ZN.getTileDis(t.owner.tilePoint,t._mainChar_.tilePoint);if(5<s&&(t.actCtrl.clearAll(),4<s))return t.owner.selectTarget=null,void t.owner.setXY(n.x,n.y);if(0==t.owner.isRuning&&1<s)if(0==s)t.checkMainCharSamPt();else PB.pixelsToTile(n.x,n.y).toString()!=t.owner.tilePoint.toString()&&t.actCtrl.moveTo(n,!0,ql.create(t,t.checkMainCharSamPt))}},i.checkMainCharSamPt=function(){for(var e=0;e<uH.heroQueue.length;e++){var t=uH.heroQueue[e];if(t!=this.owner){if(!this.owner.tilePoint||!t.tilePoint)continue;if(ZN.getTileDis(this.owner.tilePoint,t.tilePoint)<=0){if(!this.mainChar.tilePoint)continue;for(var i=YH.instance.get8Grids(this.mainChar.tilePoint),n=0;n<i.length;n++){for(var s=PB.pixelsToTile(i[n].x,i[n].y),o=!1,a=0;a<uH.heroQueue.length;a++){var r;if(uH.heroQueue[a]&&uH.heroQueue[a].tilePoint)uH.heroQueue[a]&&(r=uH.heroQueue[a].tilePoint),r&&r.x==s.x&&r.y==s.y&&(o=!0)}o&&(i.splice(n,1),n--)}if(i.length)return 0==i.length?this.actCtrl.moveTo(i[0],!0):this.actCtrl.moveTo(i[Math.random()*i.length>>0],!0),!0}}}return!1},i.autoAttack=function(e){if(0!=NB.isSceneReady){var t=BB.getTimer();if(null==e&&(e=NF.mainChar),!(e.lockMove||e.lockSkill||e.isRuning))if(uH.Ins().currCid!=_a.S_KUANGDONG.toString()){sH.getInstance().autoUnselect(e),(sH.getInstance().autoMode&&!i||i&&i.isDeath)&&(i=sH.getInstance().autoSelect(this.owner));var i=this.owner.selectTarget;if(i)ZN.getTileDis(i.tilePoint,e.tilePoint);i?t-this.heroAttackTime>=this.heroAttackDur&&(this.enter(i),this.heroAttackTime=t):this.domove()}else this.domove()}},i.enter=function(e){var t=this,i=0;i=4==t.owner.profession||5==t.owner.profession?405:sH.getCurrSkill(t.mainChar.hero_id,e);var n=t.mainChar.hero_id;if(4<n&&(n=4),sH.attackCharEnabled(e,n,t.mainChar)&&0==t.owner.lock){var s=sH.checkDisEnough(i,e.point,null,t.owner);if(0==aH.isZhanBaokMode&&0==s){var o=YN.getCharNearPt(e,t.owner);t.actCtrl.moveTo(o,!0,ql.create(sH.getInstance(),sH.getInstance().attackChar,[t.owner.char_id,e.char_id,t.owner.hero_id]))}else sH.getInstance().attackChar(t.owner.char_id,e.char_id,t.owner.hero_id)}},i.stop=function(){this.actCtrl&&this.actCtrl.clearAll(),this._isStrop_=!0,this.owner&&(this.owner.selectTarget=null)},i.start=function(){this._isStrop_=!1},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),p(0,i,"mainChar",function(){return this._mainChar_}),t.HEROAI="HeroAI",t}(),uH=function(e){function z(){var e=this;e.curentDogObjectID=0,e.replaceModel="",e.currParamData=null,e.currCkType=0,e.reliveTime=0,e.dark_img=null,z.__super.call(e),e._prveCid,e._currCid,e.recordCid,e.setup()}b(z,"modules.scene.others.invented.InventedScene",$h);var t=z.prototype;return t.setup=function(){rH.setup(),z.tickTime=BB.getTimer(),G.timer.frameLoop(1,z,modules.scene.others.invented.InventedScene.loop),z.yuanshenHash=new jl,z.ysPlayerHash=new jl},t.getCurrCharLayout=function(){var e;return z.gkDto&&(e=z.gkDto.arr[this.selectIndex]),e||[]},t.createCheckPointMonsters=function(){for(var e=Hi.getIndex(UR.instance.currentPoint),t=Hi.MODEL.quitCid(e),i=Hi.MODEL.coordinate(e),n=Hi.MODEL.monsterId(e),s=Hi.MODEL.eliteId(e),o=Dl.getIndex(t),a=Dl.MODEL["p"+i](o),r=[],l=0;l<2;l++){for(var c=[],u=a.split("|"),d=0;d<u.length;d++){var h=this.createCKM(n,t,u[d]);c.push(h)}if(0<l){var _=this.createCKM(s,t,u[0]);c.push(_)}r.push(c)}return r},t.createCKM=function(e,t,i){var n=new ia,s=hn.getIndex(e),o=hn.MODEL.muId(s),a=_n.getIndex(o),r=_n.MODEL.avatarId(a);n.avatarId=r,n.modelId=e+"",n.sid=t,n.tileX=parseInt(String(i).split(",")[0]),n.tileY=parseInt(String(i).split(",")[1]);var l=PB.tileToPixels(new Uh(n.tileX,n.tileY));return n.x=l.x,n.y=l.y,n},t.createData=function(e){var t;if(""!=e&&null!=e){var i=(e=e.replace("：",":")).split(",");t={};for(var n=0;n<i.length;n++){var s=i[n].split(":");s.length&&(t[s[0]]=parseInt(s[1]))}}return t},t.getAllHeroHp=function(){for(var e=0,t=0,i=modules.scene.others.invented.InventedScene.heroQueue,n=0;n<i.length;n++){var s=i[n];s.hero_id<4&&(e+=s.proto.currHP,t+=s.proto.maxHP)}return{currHP:e,maxHP:t}},t.getAllHeroMp=function(){for(var e=0,t=0,i=modules.scene.others.invented.InventedScene.heroQueue,n=0;n<i.length;n++){var s=i[n];s.hero_id<4&&(e+=s.proto.currMP,t+=s.proto.maxMP)}return{currMP:e,maxMP:t}},t.clearHeroMove=function(){var e=modules.scene.others.invented.InventedScene.heroQueue;rH.removeAI(NF.mainChar),sH.getInstance().autoUnselect(),NF.Ins().selectChar=null;for(var t=0;t<e.length;t++){var i=e[t];i&&(i.changeScene(),i._movePath_=[],G.timer.clearAll(i),i.play("stand"),i.removeEffect(Aa.EFFECT_MOFADUN),2==i.hero_id&&G.timer.clear(sH,sH.skillState),i.serverHp=null,i.selectTarget=null)}},t.updateHeroAI=function(){var e=modules.scene.others.invented.InventedScene.heroQueue;rH.removeAI(NF.mainChar);for(var t=0;t<e.length;t++){var i=e[t];if(i&&i!=NF.mainChar){if(5==i.hero_id||6<=i.hero_id)return;i.char_id=i.hero_id+"",3<i.hero_id&&(i.profession=i.hero_id),rH.removeAI(i);var n=rH.GetHeroAI();n.setup(i,NF.mainChar),n.start(),rH.pushAI(n),i.removeEffect(Aa.EFFECT_MOFADUN)}}},t.setFullScene=function(){z._isFullScene=!1;var e=modules.scene.others.invented.InventedScene.Ins().currCid;e==_a.S_DIGGER.toString()&&(z._isFullScene=!0),e==_a.S_BIQI.toString()&&(z._isFullScene=!0),e==_a.S_YeZhanBIQI.toString()&&(z._isFullScene=!0),e==_a.S_KUANGDONG.toString()&&(z._isFullScene=!0),e==_a.S_ARENA.toString()&&(z._isFullScene=!0),e==_a.S_WorldBoss.toString()&&(z._isFullScene=!0),e==_a.S_TIANGUAN.toString()&&(z._isFullScene=!0),dr.dtoEnterScene&&7==dr.dtoEnterScene.type&&(z._isFullScene=!0),dr.dtoEnterScene&&49==dr.dtoEnterScene.type&&(z._isFullScene=!0),dr.dtoEnterScene&&14==dr.dtoEnterScene.type&&(z._isFullScene=!0),dr.dtoEnterScene&&54==dr.dtoEnterScene.type&&(z._isFullScene=!0)},t.changeScene=function(e,t){var i=this;z.isWait13003=!1,modules.scene.others.invented.InventedScene.gkDto=IB.hash.take(e),i.selectIndex=t,z.currSceneMonsters.length=0,modules.scene.others.invented.InventedScene.hookCharQueue.length=0,z.heroHash.put(1+gR.ins.charId,NF.mainChar),sH.getInstance().clean(),G.timer.clear(sH.getInstance(),sH.getInstance().showShake),(z.gkDto=IB.hash.take(e))||(z.gkDto={cid:e,arr:[]});var n=Pn.getIndex(parseInt(e)),s=Pn.MODEL.type(n);2==(i.currCkType=s)&&(z.gkDto.arr=i.createCheckPointMonsters());var o=Pn.MODEL.dark(n);i.showHideDarkView(0<o),2==s&&(aF.isYeZhanUpDate=!0),i.recordCid=e,i.currCid=e,i.replaceModel=Pn.MODEL.dpoint(n),i.replaceModel&&(i.replaceModel=i.replaceModel.split(".")[0]);var a=Pn.MODEL.params(n);i.currParamData=i.createData(a),i.reliveTime=0,i.currParamData&&i.currParamData.hasOwnProperty("reliveTime")&&(i.reliveTime=parseInt(i.currParamData.reliveTime)),z.levelDealy=-1,i.currParamData&&i.currParamData.hasOwnProperty("dealy")&&(z.levelDealy=parseInt(i.currParamData.dealy),z.levelDealyTime=BB.getTimer()),z.robotBirthPoints.length=0;var r=Pn.MODEL.robotBirth(n);if(r&&""!=r)for(var l=r.split(","),c=0;c<l.length;c++){var u=l[c].split("-"),d=new Uh(parseInt(u[0]),parseInt(u[1]));z.robotBirthPoints.push(d)}QN.ins.clear(),2!=s||BR.ins.isCheckPointBoss||ZB.ins.isYezhan?3==s?G.timer.once(800,i,i.timeoutAI):i.selectIndex=0:(z.ysReady=!1,i.updateCheckPointSelectIndex(),G.timer.once(800,i,i.timeoutAI),G.timer.once(2e3,i,i.timeoutYuanshenAI)),i.createScene(),i.setFullScene(),NF.mainChar.cid=i.currCid,XN.instance().createJQRByGuanQiaLv()},t.timeoutYuanshenAI=function(){z.ysReady=!0},t.timeoutAI=function(){modules.scene.others.invented.InventedScene.Ins().showDogHero(),modules.scene.others.invented.InventedScene.Ins().updateHeroAI()},t.showHideDarkView=function(e){var t=this;if(void 0===e&&(e=!0),e)t.dark_img||(t.dark_img=new Kl,t.dark_img.top=0,t.dark_img.bottom=0,t.dark_img.left=0,t.dark_img.right=0),NF.scene.weatherLayer.addChild(t.dark_img),t.dark_img.skin=_r.getAtlasSubPath("task/Frame.png");else if(t.dark_img){t.dark_img.removeSelf(),t.dark_img=null;var i=_r.getAtlasSubPath("task/Frame.png");G.loader.getRes(i)?(G.loader.clearRes(i,!0),tt.ins.clearTexture(i)):G.loader.cancelLoadByUrl(i)}},t.clear=function(){if(BR.ins.isQuitFromDig){var e;BR.ins.isQuitFromDig=!1;for(var t=NF.scene.midLayer.numChildren,i=0;i<t;i++)(e=NF.scene.midLayer.getChildAt(i))&&e.ai&&"YuanshenAI"==e.ai.className&&e.ai.owner!=NF.mainChar&&(e.visible=!1,G.timer.clearAll(e),e.removeReason.push("invClear"),this.removeChar(e))}else{var n;IH.ins.unionCD=24e3,IH.ins.unionUseTime=dr.curServerTime+3900,this.selectIndex=0,z.currLevelTotalMonsterNumber=0,z.currLevelMonsterIndex=0,z._killPoint=null;for(var s=NF.scene.midLayer.numChildren,o=0,a=0;a<s;a++)(n=NF.scene.midLayer.removeChildAt(0))&&(G.timer.clearAll(n),n.removeReason.push("invClear"),this.removeChar(n));for(s=NF.scene.bomBodyLayer.numChildren,o=0;o<s;o++)(n=NF.scene.bomBodyLayer.removeChildAt(0))&&(G.timer.clearAll(n),n.removeReason.push("invClear"),this.removeChar(n));s=NF.scene.bomLayer.numChildren;for(var r=0;r<s;r++)(n=NF.scene.bomLayer.removeChildAt(0))&&(G.timer.clearAll(n),n.removeReason.push("invClear"),this.removeChar(n));for(var l=0;l<zN.deathQueue.length;l++){var c=zN.deathQueue[l];c&&(G.timer.clearAll(c),zN.recoverChar(c))}if(NF.scene.midLayerQueue.length=0,!ZN.isSynch())for(var u,d=rn.getIndex(BR.ins.curCopyId),h=rn.MODEL.cate(d),_=0;_<z.heroQueue.length;_++)5==(u=z.heroQueue[_]).hero_id&&-1==gR.ins.petIndex||(10==h&&4==u.hero_id?(G.timer.clearAll(z.heroQueue[_]),NF.scene.removeItem(z.heroQueue[_])):(G.timer.clearAll(z.heroQueue[_]),NF.scene.addItem(z.heroQueue[_]),modules.scene.others.invented.InventedScene.Ins().addChar(z.heroQueue[_]),u.ai&&"YuanshenAI"!=u.ai.className&&"PetAI"!=u.ai.className&&z.heroQueue[_].ai.start()));zN.deathQueue.length=0,zN.charQueue.length=0,this.clearHeroMove(),Og.clearAll(NF.mainChar),G.timer.clearAll(NF.mainChar),rH.clearAll(),sH.getInstance().autoUnselect(),z.HerostopNow(),eB.getInstance().resetAllSkillCd(),G.timer.clear(this,this._playNextSceneDealy_)}},t.removeHuanYingHero=function(e){},t.isShowDogHero=function(){var e;for(var t in z.heroQueue)if(4<=(e=z.heroQueue[t]).hero_id)return null==e.parent&&NF.scene.addItem(e),!0;return!1},t.createHero=function(e,t,i){var n=e+gR.ins.charId,s=z.heroHash.take(n);if(!s){if((s=new Dj).cid=modules.scene.others.invented.InventedScene.Ins().currCid,z.heroHash.put(n,s),s.stopMove(),s.isRecover=!1,s.type=Za.HERO,s.char_id=n,s.hero_id=e,s.isCharMode=!0,4==e){s.scaleX=s.scaleY=1,s.char_name=gR.ins.charName+"[神兽]";var o="ms1142";IH.ins.isBahu&&(o="ms136"),s.setCharBoolVisible(!1),s.setCharNameVisible(!1),ZN.updateCharDisplay(s,o)}else 5==e?(s.scaleX=s.scaleY=1,s.char_name=gR.ins.charName+"[神兽]",ZN.updateCharDisplay(s,"hy0001"),s.setCharBoolVisible(!1),s.setCharNameVisible(!1)):(s.scaleX=s.scaleY=1,s.char_name=gR.ins.charName,ZN.updateCharDisplayByVo(s,i),s.setCharBoolVisible(!0),s.setCharNameVisible(!0));if(s.setCharBoolValue(i.currHP,i.maxHP),s.speed=280,s._proto_=i,s.profession=i.job,s.sex=i.sex,s.dir=8*Math.random()>>0,s.cid=this.currCid,s.play("stand"),ZN.setCharTitle(s,i.titles),""!=gR.ins.guildName&&null!=gR.ins.guildName&&(s.setCharProfessionNameVisible(!0),0<gR.ins.guidePos?s.charProfessionName=gR.ins.guildName+"["+Bl.getCNPos(gR.ins.guidePos)+"]":s.charProfessionName=gR.ins.guildName),0<gR.ins.actorFlyUpLevel){s.setCharFlyupNameVisible(!0);var a=gR.ins.actorFlyUpLevel;s.setflyupName(a)}s.charProfessionNameColor="#02b0e9";var r=rH.GetHeroAI();r.setup(s,t),r.start(),rH.pushAI(r);var l=r.getPoint();if(l)ol.distance(NF.mainChar.point,l);else l=YH.instance.get8Grids(NF.mainChar.tilePoint)[0];s.setXY(l.x,l.y),s.visible=!0,s.alpha=1,s.char_id=i.id.toString(),0<=_a.S_COPY_AUTO_FIGHT.indexOf(modules.scene.others.invented.InventedScene.Ins().currCid)&&(s.char_id=e.toString()),s.charNameColor="#e8dcc2",s.char_name=gR.ins.charName,s.selectEnabled=!1,NF.scene.addItem(s),-1==z.heroQueue.indexOf(s)&&z.heroQueue.push(s),s.isCharObj=!0}return s},t.createChar=function(e,t,i,n){null==n&&(n=zN.GetChar()),n.cid=modules.scene.others.invented.InventedScene.Ins().currCid,n.stopMove(),n.isRecover=!1,n.type=Za.CHAR,n.char_id=e.toString(),n.setXY(t.x,t.y),n.isCharMode=!0,n.char_name=i.name,ZN.updateCharDisplay(n,i.mid,i.wid,i.wgid,i.eid),ZN.setCharTitle(n,i.titles),n.setCharNameVisible(!0),n.setCharBoolVisible(!0),n.setCharBoolValue(1e3,1e3),n.dir=8*Math.random()>>0,n.cid=this.currCid,n.play("stand");var s=rH.GetCharAI();return s.setup(n),s.start(),rH.pushAI(s),n._proto_=i,modules.scene.others.invented.InventedScene.Ins().addChar(n),n.isCharObj=!0,NF.scene.addItem(n),n},t.getTotalReplacePoints=function(){for(var e=z.replaceModelPoints.length=0;e<z.gkDto.arr.length;e++)for(var t=z.gkDto.arr[e],i=0;i<t.length;i++){var n=t[i];""!=this.replaceModel&&null!=this.replaceModel&&n.modelId==this.replaceModel&&(z.replaceModelPoints.push(new Uh(n.x,n.y)),z.replaceModelPoints=ol.srotOn(z.replaceModelPoints,"y",Array.NUMERIC),z.replaceModelDir.push(n.dir))}2==modules.scene.others.invented.InventedScene.Ins().currCkType&&aF.createYeZhanChar()},t.findNearReplacePoint=function(){this.getTotalReplacePoints();for(var e={dis:0,point:null,index:0},t=0;t<z.replaceModelPoints.length;t++){var i=z.replaceModelPoints[t],n=ol.distance(i,NF.mainChar.point);0==t?(e.point=i,e.dis=n,e.index=t):n<e.dis&&(e.point=i,e.dis=n,e.index=t)}return z.replaceModelPoints.splice(e.index,1),e.point},t.findAndSetNearLevelIndex=function(){for(var e=NF.mainChar.point,t={index:this.selectIndex,dis:0},i=0;i<z.gkDto.arr.length;i++)for(var n=z.gkDto.arr[i],s=0;s<n.length;s++){var o=n[s],a=ol.distance(e,new Uh(o.x,o.y));0==s&&0==i?(t.index=i,t.dis=a):a<t.dis&&(t.index=i,t.dis=a)}return t.index},t.arrRandom=function(e){for(var t=0;t<e.length;t++){var i=(e.length-1)*Math.random()>>0,n=e[t];e[t]=e[i],e[i]=n}},t.createScene=function(){var e=this,t=e.getCurrCharLayout();if(3!=e.currCkType&&(z.currLevelMonsterIndex=0),t=t.slice(),e.currCid!=_a.S_KUANGDONG.toString()&&e.arrRandom(t),t){nH.removeBuff(gR.ins.charId,404);var i=0,n=z.currLevelTotalMonsterNumber=t.length;if(e.currParamData&&e.currParamData.hasOwnProperty("levelNum")){z.currLevelTotalMonsterNumber=n=e.currParamData.levelNum;for(var s=0,o=0;o<t.length;o++){var a=t[o];if(""==e.replaceModel||null==e.replaceModel||a.modelId!=e.replaceModel){var r=a.modelId;0==z.currSceneMonsters.length&&-1==z.currSceneMonsters.indexOf(r)&&z.currSceneMonsters.push(r);var l=hn.getIndex(parseInt(r));null!=l&&1<hn.MODEL.type(l)&&s++}}s<z.currLevelTotalMonsterNumber&&(z.currLevelTotalMonsterNumber=n=s)}if(BB.IsModePVE){var c=gR.ins.actorList[0];NF.mainChar.setCharBoolValue(c.maxHP,c.maxHP),Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:NF.mainChar.currHp,heroId:NF.mainChar.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:c.maxMP,heroId:NF.mainChar.hero_id})}2!=e.currCkType?(z.replaceModelPoints.length=0,z.replaceModelDir.length=0):e.getTotalReplacePoints();for(var u=0;u<t.length;u++){var d=t[u];if(""!=e.replaceModel&&null!=e.replaceModel&&d.modelId==e.replaceModel)2!=e.currCkType&&(z.replaceModelPoints.push(new Uh(d.x,d.y)),z.replaceModelDir.push(d.dir),e.currCid!=_a.S_GUILD_BOSS.toString()&&e.currCid!=_a.S_GUILD_MJ.toString()&&e.currCid!=_a.S_WorldBoss.toString()&&e.currCid!=_a.S_TIANGUAN.toString()&&11!=e.currCkType&&12!=e.currCkType||(aH.boss=z.createMonster(d),aH.boss.isBoss=!0,11==e.currCkType&&(aH.boss.ai=null),aH.boss.stopMove()));else{var h=d.modelId,_=hn.getIndex(parseInt(h)),f=-1,p=0;if(0<=_&&(f=hn.MODEL.type(_),p=hn.MODEL.subType(_)),"jm0080"==d.avatarId||d.avatarId,f<=1||i<n&&1<f){var g;g=zN.GetChar();var v,m=PB.pixelsAlginTile(d.x,d.y),y=m.x%80,I=m.y%40;if(g.setXY(m.x-y,m.y-I),g.cid=modules.scene.others.invented.InventedScene.Ins().currCid,g.isCharMode=!1,g.setCharBoolVisible(!1),g.setCharNameVisible(!1),g.char_id=g.id,g.scaleX=g.scaleY=1.3,g._proto_=d,g.cid=e.currCid,modules.scene.others.invented.InventedScene.Ins().addChar(g),1==f){g.type=Za.NPC,ZN.updateCharDisplay(g,d.avatarId),g.dir=d.dir,g.char_id=h;var b=hn.MODEL.muId(_);b=_n.getIndex(b),g.bodyHeight=_n.MODEL.avatarHeight(b)+20,g.setCharNameVisible(!0),g.speed=hn.MODEL.speed(_),g.speed<=0&&(g.speed=1);var w=hn.MODEL.name(_);if(null==w&&(w=d.avatarId.toString()),PH.hasTask()){var x=PH.Ins().info;3==x.status&&g.char_id==x.commitNPC+""?g.showTopEffect("mjm1181","mjm1181"):g.removeTopEffect("mjm1181")}var S=["100209","100205","100207","100208","100206","100211","100210"].indexOf(h);-1!=S?HP.loadTitles(["npc_icon_head_jjc","npc_icon_head_ctg","npc_icon_head_clfb","npc_icon_head_xzkd","npc_icon_head_jqsz","npc_icon_head_yzbq","npc_icon_head_csy"][S],ql.create(g,g.showTopTexture)):(g.charNameColor="#e3dcc2",g.char_name=w)}else if(1<f){var k=hn.MODEL.muId(_),E=_n.getIndex(k);v=_n.MODEL.awayEffect(E);var T=hn.MODEL.scale(_)/100;T<1&&(T=1),201==f?(g.isElites=!0,g.charNameColor="#0000ff"):202==f?(g.isBoss=!0,g.charNameColor="#ff0000"):(v="",g.charNameColor="#b3ac9c"),g.scale(T,T),g.data=d,103!=p?(i++,g.type=Za.MONSTER):(g.charNameColor="#0000ff",g.type=Za.MONSTER_TRANSPORT,g.defaultHotAreaOffsetX=-150,g.defaultHotAreaOffsetY=-200,g.hotArea=new u_(g.defaultHotAreaOffsetX,g.defaultHotAreaOffsetY,300,300)),g.cid=e.currCid,g.isRecover=!1,g.setPoisoning(!1);var C=0;if(d.reliveEnabled=!1,(d.reliveDealy=0)<e.reliveTime&&(d.reliveEnabled=!0,d.reliveDealy=e.reliveTime),(1<e.currCkType||"200203"==h)&&(C=1),4==e.currCkType||8==e.currCkType||9==e.currCkType){if(g.isBoss=!0,8==e.currCkType){var L=hn.MODEL.muId(_);L=_n.getIndex(L);var M=_n.MODEL.avatarId(L);ZN.updateCharDisplay(g,M)}}else{var A=rH.GetMonsterAI(),D=hn.MODEL.attackRadius(_),O=hn.MODEL.attackType(_);0==D&&(D=2),A.setup(g,new Uh(d.tileX,d.tileY),80,6,D,C),rH.pushAI(A),0<O&&(A.radius=O),g.ai=A,rH.startAI(g);var P=hn.MODEL.muId(_);P=_n.getIndex(P);var R=_n.MODEL.avatarId(P);ZN.updateCharDisplay(g,R);var N=hn.MODEL.muId(_);N=_n.getIndex(N),g.bodyHeight=_n.MODEL.avatarHeight(N),g.char_name=hn.MODEL.name(_);var B=modules.scene.others.invented.InventedScene.monsterDataHash.take(h);B||(B=JSON.parse(hn.MODEL.attributes(_)),modules.scene.others.invented.InventedScene.setMonsetAttributes(d.modelId,B),B=modules.scene.others.invented.InventedScene.monsterDataHash.take(h)),g.dir=8*Math.random()>>0,g.setCharBoolValue(B.MAXHP,B.MAXHP)}if(""!=v&&null!=v&&"0"!=v&&"0.0"!=v&&g.loadEffect(v,Za.LAYER_BODY_BOTTOM),g.char_id=g.id,null!=dr.dtoEnterScene&&8!=dr.dtoEnterScene.type&&28!=dr.dtoEnterScene.type?1!=dr.dtoEnterScene.type&&11!=dr.dtoEnterScene.type&&1!=t.length||(g.play("stand"),aH.boss=g,rH.startAI(g)):dr.dtoEnterScene&&1==t.length&&8!=dr.dtoEnterScene.type&&28!=dr.dtoEnterScene.type?(g.play("stand"),aH.boss=g,rH.startAI(g)):null==dr.dtoEnterScene||1!=t.length||8!=dr.dtoEnterScene.type&&28!=dr.dtoEnterScene.type||(g.play("attack"),aH.boss=g,rH.startAI(g)),g.isBoss&&(7==e.currCkType||27==e.currCkType)){var H=rn.getIndex(BR.ins.curCopyId);null==B.MAXHP&&(modules.scene.others.invented.InventedScene.monsterDataHash.remove(d.modelId),B=JSON.parse(hn.MODEL.attributes(_)),modules.scene.others.invented.InventedScene.setMonsetAttributes(d.modelId,B),B=modules.scene.others.invented.InventedScene.monsterDataHash.take(h),g.setCharBoolValue(B.MAXHP)),qU.ins.updateBossBlood(rn.MODEL.bossId(H),B.MAXHP,B.MAXHP)}}else-1==f&&(g.renderInSelf=!0,g.isSceneEffect=!0,"mcj1011"==d.avatarId?(g.type=Za.TRANSPORT,g.loadEffect(d.avatarId,Za.LAYER_BOTTOM)):(g.type=Za.EFFECT,g.selectEnabled=!1,g.renderInSelf=!1,"jn10385"==d.avatarId||"jn10386"==d.avatarId||"jm1045"==d.avatarId?(g.loadEffect(d.avatarId,Za.LAYER_BOTTOM),tr.push(RP.n[119]+d.avatarId+", x: "+g.x+" y: "+g.y)):g.loadEffect(d.avatarId),g.isShowad=!1));NF.scene.addItem(g);var V=PB.pixelsAlginTile(d.x,d.y),G=V.x%80,U=V.y%40;g.setXY(V.x-G,V.y-U)}}}Pn.MODEL.sid(Pn.getIndex(parseInt(e.currCid)));var F=Q_.getIndex(parseInt(e.currCid)),q=Q_.MODEL.tars(F);if(q&&q.length)for(u=0;u<q.length;++u){var j=q[u],W=zN.GetChar(),Y=PB.tileToPixels(new Uh(j.curr_x,j.curr_y));W.setXY(Y.x,Y.y),W.cid=modules.scene.others.invented.InventedScene.Ins().currCid,W.isCharMode=!1,W.setCharBoolVisible(!1),W.setCharNameVisible(!1),W.char_id=W.id,W.scaleX=W.scaleY=1,W._proto_=j,W.cid=e.currCid,modules.scene.others.invented.InventedScene.Ins().addChar(W),W.renderInSelf=!0,W.isSceneEffect=!0,W.type=Za.TRANSPORT,W.loadEffect("jm0082",Za.LAYER_BOTTOM),NF.scene.addItem(W)}}},t.removePickItemByObjectId=function(e){var t;for(var i in zN.pickUpQueue)(t=zN.pickUpQueue[i]).objectId==e&&(this.removePickItem(t),NF.Ins().selectChar=null,UB.ins._playPickupSound(t.proto))},t.removePickItem=function(e){if(e){NF.scene.removeItem(e),e.recover(),e.isRecover=!0;var t=zN.pickUpQueue.indexOf(e);-1!=t&&zN.pickUpQueue.splice(t,1),-1==zN._sceneCharPoolQueue_.indexOf(e)&&zN._sceneCharPoolQueue_.push(e)}},t.removeChar=function(e){if(e&&(!e.removeReason||0!=e.removeReason.length)){var t=0;e.ai&&"YuanshenAI"==e.ai.className&&(t=z.heroQueue.indexOf(e),rH.removeAI(e),-1!=t&&z.heroQueue.splice(t,1)),-1==z.heroQueue.indexOf(e)&&(G.timer.clearAll(e),e.hero_id<=0&&(e.isRecover=!0),NF.scene.removeItem(e),-1!=(t=zN.charQueue.indexOf(e))&&zN.charQueue.splice(t,1),rH.stopAI(e),e.proto&&e.proto.reliveEnabled?zN.deathQueue.push({char:e,time:BB.getTimer(),dealy:e.proto.reliveDealy}):zN.recoverChar(e))}},t.addChar=function(e){-1==zN.charQueue.indexOf(e)&&zN.charQueue.push(e),QN.ins.sayWord(e)},t.exitCopy=function(){this.currCkType;if(7==this.currCkType){var e=BR.ins.curCopyId,t=rn.MODEL.pickup(rn.getIndex(e)),i=rn.MODEL.goodsAward(rn.getIndex(e));if(i)for(var n,s=i.split(","),o=parseInt(s[1]),a=[],r=0;r<o;r++)(n=new Object).modelId=parseInt(s[0]),n.count=1,a.push(n);z._killPoint?(sH.stop(),yH.Ins().actCtrl.clearAll(),qN.showDropsToScene(parseInt(modules.scene.others.invented.InventedScene.Ins().currCid),a,z._killPoint,t),G.timer.once(1200,this,function(){Tu.sendToModule("CATE_1_END",["modules.scene.SceneModule"])})):Tu.sendToModule("CATE_1_END",["modules.scene.SceneModule"])}else 27==this.currCkType&&Tu.sendToModule("CATE_27_END",["modules.scene.SceneModule"])},t.doNotPlayNextThen=function(e){void 0===e&&(e=!1),1!=this.currCkType&&(z.currLevelMonsterIndex+=1,3==this.currCkType&&z.levelDealyReady||z.currLevelTotalMonsterNumber<=z.currLevelMonsterIndex&&(z.currLevelMonsterIndex=0,this.playNextScene(e)))},t.updateCheckPointSelectIndex=function(){(this.selectIndex>=z.gkDto.arr.length||this.selectIndex<0)&&(this.selectIndex=0)},t._playNextSceneDealy_=function(e){var t=this;if(void 0===e&&(e=-1),t.selectIndex<z.gkDto.arr.length){switch(-1==e?t.selectIndex+=1:t.selectIndex=e,t.currCkType){case 7:case 27:return void(t.selectIndex<z.gkDto.arr.length?t.createScene():t.exitCopy())}if(2==t.currCkType&&t.updateCheckPointSelectIndex(),1<t.currCkType&&t.selectIndex>=z.gkDto.arr.length){if(t.currParamData&&t.currParamData.hasOwnProperty("loop")){t.selectIndex=0;var i=parseInt(t.currParamData.loop);(-1==i||0<i)&&(0<i&&i--,t.createScene())}}else t.createScene()}},t.isMonsterKillAll=function(){var e=zN.getMonsterInStage().length;return z.currLevelTotalMonsterNumber<=z.currLevelMonsterIndex||0==e},t.playNextScene=function(e){void 0===e&&(e=!1),this.selectIndex<=z.gkDto.arr.length&&(G.timer.clear(this,this._playNextSceneDealy_),G.timer.once(200,this,this._playNextSceneDealy_))},t.delayGKPower=function(){UR.instance.addBatch()},t.killMonster=function(e){if(e.isRecover)return e.removeReason.push("kill"),void this.removeChar(e);var t=e.point;if(t=NF.scene.localToGlobal(t),2==modules.scene.others.invented.InventedScene.Ins().currCkType)if(e.isElites){var i=new zM;i.monsterId=e.proto.modelId,Tu.sendToService(i),zB.ins.checkRainbowAction("monster",e.proto.modelId)}else{UR.instance.guanQiaBtnOpen()&&(0==UR.instance.fullPower&&zB.ins.playPower(t,sJ.getPowerEndPt()),UR.instance.currentBo+=1,G.timer.once(800,this,this.delayGKPower));var n=new YM;n.monsterId=e.proto.modelId,Tu.sendToService(n)}e.removeReason.push("kill"),this.removeChar(e);var s=e.proto;if(s){var o=this.getCurrCharLayout(),a=!1;if(null!=o){for(var r=0;r<o.length;r++){var l=o[r];if(l&&s.modelId==l.modelId){a=!0;Tu.sendToModule("KILLMONSTER",["modules.task.TaskModule"],s.modelId);break}}if(a){z.currLevelMonsterIndex+=1;var c=zN.getMonsterInStage().length;if(3==this.currCkType)c<=5&&this.playNextScene();else if(c<15&&(z.currLevelTotalMonsterNumber<=z.currLevelMonsterIndex||0==c))z.currLevelMonsterIndex=0,z._killPoint=new Uh(e.tileX,e.tileY),this.getMonseterNum()<=1&&this.playNextScene()}}}},t.createDogHero=function(e,t){var i="ms1142";IH.ins.isBahu&&(i="ms136");var n=new tR(t);n.mid=i,n.wgid="0",n.wid="0",n.currHP=1e6;var s=n.job=t,o=s+gR.ins.charId,a=z.heroHash.take(o);if(!a){(a=new Dj).cid=modules.scene.others.invented.InventedScene.Ins().currCid,z.heroHash.put(o,a),a.stopMove(),a.isRecover=!1,a.type=Za.HERO,a.char_id=o,a.hero_id=s,a.isCharMode=!1,ZN.updateCharDisplay(a,i),a.setCharBoolValue(n.currHP,n.currHP),a.speed=280,a._proto_=n,a.profession=n.job,a.sex=n.sex,a.dir=8*Math.random()>>0,a.cid=this.currCid,a.play("stand"),a.cid=this.currCid;var r=rH.GetHeroAI();r.setup(a,e),r.start(),rH.pushAI(r);var l=r.getPoint();if(l)ol.distance(NF.mainChar.point,l);else l=YH.instance.get8Grids(NF.mainChar.tilePoint)[0];a.cid=this.currCid,a.scaleY=a.scaleX=1,a.setXY(l.x,l.y),a.visible=!0,"1"==this.currCid&&(a.visible=!1),a.alpha=1,a.char_id=n.id.toString(),a.charNameColor="#e8dcc2",a.char_name="",a.selectEnabled=!1,a.setCharBoolVisible(!1),a.setCharNameVisible(!1),ZN.setCharTitle(a,n.titles),NF.scene.addItem(a),-1==z.heroQueue.indexOf(a)&&z.heroQueue.push(a),a.isCharObj=!0}return a},t.dogReplaceBahuHero=function(){var e=0,t=z.heroQueue.length;if(!(t<=0))for(var i=IH.ins.isBahu;e<t;e++){var n=z.heroQueue[e];if(n&&4==n.hero_id){var s="ms1142";i&&(s="ms136"),n.mid=s,ZN.updateCharDisplay(n,s)}}},t.createYuanshenHero=function(e){var t,i=0,n=e[0];if(!n)return null;if(n.objectId)i=z.yuanshenHash.take(n.objectId);else{if(!n._proto_)return null;i=z.yuanshenHash.take(n._proto_.objectId)}i&&0!=i||(i=z.yuanshenObjId++),t=0<e[2]?oB.ins.getSkinModelByType(e[2]):0<e[1]?"ms164":"ms163";var s,o=new tR(i);o.mid=t,o.wgid="0",o.wid="0",o.currHP=1e6,o.job=ha.ZHAN.type;var a,r,l=i;r=n==NF.mainChar?n.objectId?l+n.objectId.toString():l+n._proto_.objectId.toString():l+n.objectId.toString();uF.charQueue.length;var c=uF.charQueue.take(l.toString());if(c&&c.char_id==r&&(a=c),a)a.cid=this.currCid,ZN.updateCharDisplay(a,t),a.scaleY=a.scaleX=1.3,NF.scene.addItem(a),a.setCharBoolVisible(!1),a.setCharNameVisible(!1),a.char_name=n.objectId+"",a.visible=!0,a.ai.start(),rH.pushAI(a.ai);else{n==NF.mainChar?((a=z.heroHash.take(r))||(a=new Dj),z.heroHash.put(r,a)):a||(a=zN.GetChar()),a.hero_id=l,a.cid=modules.scene.others.invented.InventedScene.Ins().currCid,a.stopMove(),a.isRecover=!1,a.type=Za.HERO,a.char_id=r,a.isCharMode=!0;var u=rH.GetYuanshenAI();u.setup(a,n),ZN.updateCharDisplay(a,t),a.setCharBoolValue(o.currHP,o.currHP),a.speed=280,a.objectId=i,n==NF.mainChar?n.objectId?z.yuanshenHash.put(n.objectId,a.objectId):z.yuanshenHash.put(n._proto_.objectId,a.objectId):z.yuanshenHash.put(n.objectId,a.objectId),a._proto_=o,a.profession=ha.ZHAN.type,a.sex=o.sex,a.dir=n.dir,a.cid=this.currCid,a.play("stand"),u.start(),rH.pushAI(u),(s=u.getPoint())||(s=YH.instance.get8Grids(n.tilePoint)[0]),a.cid=this.currCid,a.scaleY=a.scaleX=1.3,a.setXY(s.x,s.y-10),a.visible=!0,a.alpha=1,a.charNameColor="#e8dcc2",a.setCharBoolVisible(!1),a.setCharNameVisible(!1),a.char_name=n.objectId+"",a.selectEnabled=!1,NF.scene.addItem(a),-1==z.heroQueue.indexOf(a)&&z.heroQueue.push(a),uF.charQueue.put(l,a)}return a&&n&&n.isDeath&&(a.visible=!1),a},t.createPetHero=function(e){var t=e?e.petIndex:gR.ins.petIndex;if(t<=0)return null;var i=e?e.petStar:gR.ins.petStar,n=Ph.getIndex(t),s=Ph.MODEL.model(n),o=hn.getIndex(s),a=hn.MODEL.muId(o),r=hn.MODEL.name(o);o=_n.getIndex(a);var l=_n.MODEL.avatarId(o),c=new tR(5);c.mid=l,c.wgid="0",c.wid="0",c.currHP=1e6;var u=0,d=(c.job=5,5+gR.ins.charId),h=z.heroHash.take(d);if(h)h.resetCharHead(),ZN.updateCharDisplay(h,c.mid),(u=Oh.MODEL.awayEffect(Oh.getIndex(i+1)))&&h.loadEffect("jm"+u,Za.LAYER_BODY_BOTTOM,"jm"+u),h.char_name=gR.ins.charName+"的"+r,h._proto_.mid=l,-1==z.heroQueue.indexOf(h)&&z.heroQueue.push(h),h.setCharNameVisible(!0),h.type=Za.HERO,NF.scene.addItem(h),h.visible=!0,h.ai&&(Object(h.ai).setup(h,NF.mainChar),h.ai.start(),rH.pushAI(h.ai));else{(h=new Dj).cid=modules.scene.others.invented.InventedScene.Ins().currCid,z.heroHash.put(d,h),h.stopMove(),h.isRecover=!1,h.type=Za.HERO,h.char_id=d,h.hero_id=5,h.isCharMode=!1,ZN.updateCharDisplay(h,c.mid),h.setCharBoolValue(c.currHP,c.currHP),h.speed=280,h._proto_=c,h.profession=c.job,h.sex=c.sex,h.dir=8*Math.random()>>0,h.cid=this.currCid,h.play("stand"),h.cid=this.currCid;var _=rH.GetPetAI();_.setup(h,NF.mainChar),_.start(),rH.pushAI(_);var f=_.getPoint();if(f)ol.distance(NF.mainChar.point,f);else f=YH.instance.get8Grids(NF.mainChar.tilePoint)[0];h.cid=this.currCid,h.scaleY=h.scaleX=1,h.setXY(f.x,f.y),(u=Oh.MODEL.awayEffect(Oh.getIndex(i)+1))&&h.loadEffect("jm"+u,Za.LAYER_BODY_BOTTOM),h.visible=!0,h.alpha=1,h.char_id=c.id.toString(),h.charNameColor="#e8dcc2",h.char_name=gR.ins.charName+"的"+r,h.selectEnabled=!1,h.setCharBoolVisible(!1),h.setCharNameVisible(!0),ZN.setCharTitle(h,c.titles),NF.scene.addItem(h),-1==z.heroQueue.indexOf(h)&&z.heroQueue.push(h),h.isCharObj=!0}if(u&&qH.Ins().addNoClears("jm"+u),e){h.objectId=e.objectId;var p=PB.tileToPixels(new Uh(e.x,e.y));h.changeScene(),h.setXY(p.x+20,p.y-20),h.data=e,G.timer.once(400,null,function(){h.loadEffect("jn10171",Za.LAYER_BODY_TOP,"jn10171",!1,200,!0,"stand",0,0)})}return h},t.updatePetHero=function(){var e=gR.ins.petIndex,t=Ph.getIndex(e),i=Ph.MODEL.model(t),n=hn.getIndex(i),s=hn.MODEL.muId(n),o=hn.MODEL.name(n);n=_n.getIndex(s);var a=_n.MODEL.avatarId(n),r=5+gR.ins.charId,l=z.heroHash.take(r);if(l){ZN.updateCharDisplay(l,a),l.char_name=gR.ins.charName+"的"+o,l._proto_.mid=a;var c=Oh.MODEL.awayEffect(Oh.getIndex(gR.ins.petStar+1));c&&l.loadEffect("jm"+c,Za.LAYER_BODY_BOTTOM)}},t.hidePetHero=function(){var e=5+gR.ins.charId,t=z.heroHash.take(e);t&&(t.visible=!1,t.ai.stop(),rH.removeAI(t),t.charHeadHide(),NF.scene.removeItem(t))},t.isGetHero=function(e){var t;return e&&(t=uF.charQueue.take(e.toString())),t},t.showDogHero=function(){for(var e=modules.scene.others.invented.InventedScene.heroQueue,t=0;t<e.length;t++){var i=e[t];3<i.hero_id&&(i.visible=!0),zN.charQueue.indexOf(i)<0&&zN.charQueue.push(i)}},t.getMonseterNum=function(){for(var e=zN.charQueue,t=0,i=0;i<e.length;i++){var n=e[i];n&&n.type==Za.MONSTER&&t++}return t},t.getPetByid=function(e){for(var t=0;t<zN.charQueue.length;t++)if(zN.charQueue[t].objectId==e)return zN.charQueue[t];return null},p(0,t,"selectIndex",function(){return z._selectIndex_},function(e){z._selectIndex_=e}),p(0,t,"prveCid",function(){return null==this._prveCid&&(this._prveCid=JN.ins.getRecommendScene()),this._prveCid},function(e){this._prveCid=e}),p(0,t,"currCid",function(){return this._currCid},function(e){this._currCid=e,gR.ins&&(gR.ins.cId=e)}),p(1,z,"isFullScene",function(){return z._isFullScene},function(e){z._isFullScene=e}),p(1,z,"killPoint",function(){return z._killPoint?z._killPoint:NF.mainChar.tilePoint},zwc.engine.core.protos.Proto._$SET_killPoint),z.Ins=function(){return null==z._instance_&&(z._instance_=new z),z._instance_},z.loop=function(){if(NB.isSceneReady){var e=new Uh;e=NF.scene.globalToLocal(e),zN.stageRect.x=e.x,zN.stageRect.y=e.y,zN.stageRect.width=G.stage.width,zN.stageRect.height=G.stage.height,zN.stageCharQueue.length=0,modules.scene.others.invented.InventedScene.Ins().dark_img&&(modules.scene.others.invented.InventedScene.Ins().dark_img.width=zN.stageRect.width+50,modules.scene.others.invented.InventedScene.Ins().dark_img.height=zN.stageRect.height+50,modules.scene.others.invented.InventedScene.Ins().dark_img.x=e.x-25,modules.scene.others.invented.InventedScene.Ins().dark_img.y=e.y-25);for(var t=0;t<zN.charQueue.length;t++){var i=zN.charQueue[t];zN.stageRect.contains(i.x,i.y)&&zN.stageCharQueue.push(i)}sH.getInstance().loop(),z.relive();var n=BB.getTimer();if(-1!=z.levelDealy&&(!sH.getInstance().isStop&&0==z.levelDealyReady&&ZN.isEnabledChangeScene()?modules.scene.others.invented.InventedScene.Ins().selectIndex<=z.gkDto.arr.length&&z.levelDealy<n-z.levelDealyTime&&zN.charQueue.length<15&&(z.levelDealyTime=n,z.levelDealyReady=!0,z.currLevelMonsterIndex=0,z.levelDealyReady=!1,modules.scene.others.invented.InventedScene.Ins().playNextScene()):z.levelDealyTime=n),7==modules.scene.others.invented.InventedScene.Ins().currCkType||27==modules.scene.others.invented.InventedScene.Ins().currCkType){if(null!=aH.boss&&1==aH.boss.isBoss){var s=rn.getIndex(BR.ins.curCopyId);qU.ins.updateBossBlood(rn.MODEL.bossId(s),aH.boss.currHp)}}else 2==modules.scene.others.invented.InventedScene.Ins().currCkType&&z.isWait13003&&1e3<BB.getTimer()-z.isWait13003OverTime&&1==z.isWait13003&&(z.isWait13003OverTime=BB.getTimer(),z.isWait13003=!1,modules.scene.others.invented.InventedScene.Ins().playNextScene())}},z.heroRelive=function(e){if(void 0===e&&(e=!0),gR.ins.charId){-1==modules.scene.others.invented.InventedScene.heroQueue.indexOf(NF.mainChar)&&modules.scene.others.invented.InventedScene.heroQueue.unshift(NF.mainChar),NF.Ins().selectChar=null;for(var t=modules.scene.others.invented.InventedScene.heroQueue,i=0;i<t.length;i++){var n=t[i];if(n.ai){if("YuanshenAI"==n.ai.className)return;n.ai.start()}if(modules.scene.others.invented.InventedScene.Ins().currCid!=_a.S_BIQI.toString()||4!=n.hero_id){n.cid=modules.scene.others.invented.InventedScene.Ins().currCid,n.relive(),n.visible=!0,n.isRecover=!1,n.isDeath=!1,n.isShowad=!0,n.selectTarget=null;var s=Pn.getIndex(parseInt(modules.scene.others.invented.InventedScene.Ins().currCid)),o=Pn.MODEL.type(s);if(2==o||6==o||4!=n.hero_id)if(BR.ins.isCheckPointBoss&&4==n.hero_id)n.visible=!1;else{4==n.hero_id?n.resetCharHead():5==n.hero_id&&-1==gR.ins.petIndex||NF.scene.addItem(n),modules.scene.others.invented.InventedScene.Ins().currCid==_a.S_BIQI.toString()&&1!=n.hero_id&&5!=n.hero_id&&(n.visible=!1);var a=gR.ins.actorList[n.hero_id-1];if(4==n.hero_id&&(a=n.proto),5==n.hero_id&&(a=n.proto),6<=n.hero_id&&(a=n.proto),a.id<4&&(n.setCharBoolValue(a.maxHP,a.maxHP),n.objectId=a.objectId),4==n.hero_id&&(a.mid=IH.ins.isBahu?"ms136":"ms1142"),0<a.maxHD&&(n.setCharInnerVisible(!0),n.setCharInnerValue(a.currHD,a.currHD)),Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:n.currHp,heroId:n.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:a.maxMP,heroId:n.hero_id}),modules.scene.others.invented.InventedScene.Ins().currCid!=_a.S_BIQI.toString()&&(ZN.updateCharDisplayByVo(n,a),ZN.setCharTitle(n,a.titles),n._proto_=a),NF.mainChar!=n&&0==NF.mainChar.isRuning){if(nF.isHeroRunInPlayGround)return;if(modules.scene.others.invented.InventedScene.Ins().currCid==_a.S_TIANGUAN.toString()||modules.scene.others.invented.InventedScene.Ins().currCid==_a.S_ARENA.toString())return;var r,l,c=ZN.getTileDis(NF.mainChar.tilePoint,n.tilePoint);null!=(l=(n.hero_id,n.ai))&&(r=l.getPoint()),r&&(3<c?c<5&&e?n.moveTo(r.x,r.y):n.setXY(r.x,r.y):c<=3&&0<c&&(e?n.moveTo(r.x,r.y):n.setXY(r.x,r.y)))}}else n.visible=!1}else n.visible=!1}}},z.updateHeroObjectId=function(e,t){for(var i=modules.scene.others.invented.InventedScene.heroQueue,n=gR.ins.actorById(e),s=0;s<i.length;s++){var o=i[s];o&&o.profession==n.job&&(o.objectId=t)}},z.getHeroByObjectid=function(e){for(var t=modules.scene.others.invented.InventedScene.heroQueue,i=0;i<t.length;i++){var n=t[i];if(n.objectId==e)return n}return null},z.updateHero=function(e){for(var t=modules.scene.others.invented.InventedScene.heroQueue,i=0;i<t.length;i++){var n=t[i];if(n&&n.ai&&"YuanshenAI"==n.ai.className)return void n.ai.resetPostion();if(n&&n.ai&&"PetAI"==n.ai.className)return void n.ai.resetPostion();if(n.objectId==e.objectId)null==uF.charQueue.take(e.objectId)&&uF.charQueue.put(e.objectId,n),n.visible=!0,n.x=e.x,n.y=e.y,n.dir=e.dir,n.bodyHeight=NB.BODY_HEIGHT,0<=_a.S_COPY_AUTO_FIGHT.indexOf(modules.scene.others.invented.InventedScene.Ins().currCid)||(n.char_id=e.char_id.toString()),n.objectId=e.objectId,ZN.updateCharDisplay(n,e.mid,e.wid,e.wgid,e.eid,e.chuanshi,e.magicId,e.dragonEff),n.camp=e.camp,n.isDeath&&n.relive(),n.setCharBoolValue(e.currHP,e.maxHP),n.campState=e.campState,n.cid=modules.scene.others.invented.InventedScene.Ins().currCid,ZN.setCharTitle(n,e.titles),n.removeEffect(Aa.EFFECT_MOFADUN),modules.scene.others.invented.InventedScene.heroQueue[i]=n;n.char_name=e.charName,n.setCharNameVisible(!0),n.setCharBoolVisible(!0),0!=e.camp?e.charName==gR.ins.charName?n.charNameColor="#00ff00":e.camp==NF.mainChar.camp?n.charNameColor="#00ff00":n.charNameColor="#ff0000":n.charNameColor="#ffffff",0<=e.govPosition&&1==n.hero_id&&n.showPosition(e.govPosition),dr.dtoEnterScene&&13==dr.dtoEnterScene.type&&(e.guild_id==gR.ins.guildId?n.charNameColor="#ffffff":n.charNameColor="#ff0000"),3<n.hero_id&&(uF.charQueue.remove(n.objectId),n.visible=!1)}},z.reliveHeroAll=function(){for(var e=modules.scene.others.invented.InventedScene.heroQueue,t=0;t<e.length;t++){var i=e[t];i&&i.hero_id<4&&(i.proto.currHp=i.maxHP,i.proto.maxHP=i.maxHP,i.setCharBoolValue(i.maxHP,i.maxHP),i.relive(),i.play("stand"))}},z.deadHeroAll=function(){for(var e=modules.scene.others.invented.InventedScene.heroQueue,t=0;t<e.length;t++){var i=e[t];i&&i.hero_id<4&&!i.isDeath&&0<i.proto.currHp&&(i.proto.currHp=0,i.proto.maxHP=i.maxHP,i.setDeath(),i.play("death"),i.doDelay(600,i,i.timeOutDeath))}},z.getHero=function(e){var t=e+gR.ins.charId;return z.heroHash.take(t)},z.getCallBossPoint=function(e,t,i){void 0===i&&(i=5),z.callBossGrids.length=0;var n=ql.create(z,modules.scene.others.invented.InventedScene.getBossPoints,null,!1);PB.loopRect(e.x,e.y,i,i,n);for(var s=[],o=0;o<z.callBossGrids.length;o++){var a=ZN.getTileDis(e,z.callBossGrids[o]);s.push({dis:a,point:z.callBossGrids[o]})}return s=ol.srotOn(s,"dis",Array.DESCENDING),PB.tileToPixels(s[0].point)},z.getCallBossPointByDir=function(e,t){var i=[0,1,2,3,4,5,6,7];i.splice(t,1),i.unshift(t);for(var n=0;n<i.length;n++){var s=i[n],o=4;0!=s&&4!=s||(o=6);var a=VB.getTileByDir(e,i[n],o),r=PB.pixelsToTile(a.x,a.y),l=YH.instance.takeItem(r.x,r.y);if(l&&1==l.type)return a}return z.getCallBossPoint(e,t)},z.getBossPoints=function(e,t){var i=YH.instance.takeItem(e,t);i&&1==i.type&&z.callBossGrids.push(new Uh(e,t))},z.getHeroPoint=function(e,t){for(var i=YH.instance.get8Grids(t),n={point:e.point,dis:0},s=0;s<i.length;s++){for(var o=PB.pixelsToTile(i[s].x,i[s].y),a=!1,r=0;r<modules.scene.others.invented.InventedScene.heroQueue.length;r++){var l=modules.scene.others.invented.InventedScene.heroQueue[r].tilePoint;l.x==o.x&&l.y==o.y&&(a=!0)}a&&(i.splice(s,1),s--)}for(var c=0;c<i.length;c++){var u=i[c],d=Math.random()*i.length>>0;i[h]=i[d],i[d]=u}for(var h=0;h<i.length;h++){var _=ol.distance(e.point,i[h]);0==h?(n.point=i[h],n.dis=_):_<n.dis&&(n.point=i[h],n.dis=_)}return n.point},z.createMonster=function(e,t,i){void 0===i&&(i=!1);var n=zN.GetChar();n.cid=modules.scene.others.invented.InventedScene.Ins().currCid;var s=PB.pixelsAlginTile(e.x,e.y);n.setXY(s.x,s.y),n.isCharMode=!1,n.setCharBoolVisible(!1),n.setCharNameVisible(!1),n.char_id=n.id,n.scaleX=n.scaleY=1.3,n._proto_=e,n.cid=modules.scene.others.invented.InventedScene.Ins().currCid,modules.scene.others.invented.InventedScene.Ins().addChar(n),n.type=Za.MONSTER,n.cid=modules.scene.others.invented.InventedScene.Ins().currCid,n.isRecover=!1,n.setPoisoning(!1);e.reliveEnabled=!1,e.reliveDealy=0;var o=hn.getIndex(parseInt(e.modelId));if(i){var a=rH.GetMonsterAI();a.setup(n,new Uh(e.tileX,e.tileY),80,2,2,1),rH.pushAI(a),n.ai=a}null!=t&&ZN.updateCharDisplay(n,t);var r=hn.MODEL.muId(o);r=_n.getIndex(r);var l=_n.MODEL.awayEffect(r);""!=l&&"0"!=l&&null!=l&&n.loadEffect(l,Za.LAYER_BODY_BOTTOM);var c=hn.MODEL.type(o),u=hn.MODEL.scale(o)/100;u<1&&(u=1),201==c?n.isElites=!0:202==c&&(n.isBoss=!0),n.scale(u,u),n.bodyHeight=_n.MODEL.avatarHeight(r),n.char_name=hn.MODEL.name(o);var d=modules.scene.others.invented.InventedScene.monsterDataHash.take(e.modelId);if(!d){var h=JSON.parse(hn.MODEL.attributes(o));h&&(d=aa.formatNewAttrToObject(h),modules.scene.others.invented.InventedScene.monsterDataHash.put(e.modelId,d),d=modules.scene.others.invented.InventedScene.monsterDataHash.take(e.modelId))}return n.dir=8*Math.random()>>0,n.setCharBoolValue(d.MAXHP,d.MAXHP),n.char_id=n.id,n},z.updateHeroPoint=function(){if(modules.scene.others.invented.InventedScene.Ins().currCid!=_a.S_TIANGUAN.toString()&&modules.scene.others.invented.InventedScene.Ins().currCid!=_a.S_ARENA.toString())for(var e=modules.scene.others.invented.InventedScene.heroQueue,t=0;t<e.length;t++){var i=e[t];if(i!=NF.mainChar&&null!=i.ai){var n;n=(i.hero_id,i.ai.getPoint());var s=ZN.getTileDis(NF.mainChar.tilePoint,i.tilePoint);3<s?s<5?i.moveTo(n.x,n.y):i.setXY(n.x,n.y):s<=3&&0<s&&i.moveTo(n.x,n.y)}}},z.HerostopNow=function(){for(var e=modules.scene.others.invented.InventedScene.heroQueue,t=0;t<e.length;t++){var i=e[t];i.stopMove(),null!=i.ai&&i!=NF.mainChar&&"YuanshenAI"!=i.ai.className&&i.ai.actCtrl.clearAll()}},z.getGrids=function(e){for(var t=e.x-7,i=e.x+7,n=e.y-8,s=e.y+8,o=t;o<i;o++)for(var a=n;a<s;a++){var r=YH.instance.takeItem(o,a);r&&0<r.type&&z.grids.push(new Uh(r.pt.x,r.pt.y))}},z.addPickItem=function(e,t,i,n){void 0===i&&(i=3),void 0===n&&(n=!1),z.grids.length=0,z.getGrids(e);for(var s,o=0,a=[],r=0;r<z.grids.length;r++)s=z.grids[r],o=ZN.getTileDis(s,e),a.push({dis:o,point:s});a=ol.srotOn(a,"dis",Array.NUMERIC);for(var l=0;l<t.length;l++){var c=a[l];if(null==c)z.createItem(e.x,e.y,t[l].modelId,t[l].count,n);else{var u=c.point.x,d=c.point.y;z.createItem(u,d,t[l].modelId,t[l].count,n)}}a.length=0,z.grids.length=0},z.pushItemGrid=function(e,t){var i=YH.instance.takeItem(e,t);i&&0<i.type&&z.grids.push({x:e,y:t})},z.createPackItem=function(e){var t=PB.pixelsToTile(e.x,e.y),i=z.createItem(t.x,t.y,e.goodsId,e.goodsNum,!1);i.objectId=e.objectId,i.isOwner=e.owner},z.createItem=function(e,t,i,n,s){if(void 0===s&&(s=!1),aR.EXP.itemId==i||aR.COPPER.itemId==i)return null;var o=Bi.getIndex(i),a=zN.GetChar();a.type=s?Za.PICKUP_GOLD:Za.PICKUP_ITEM;var r=!1;if(aR.GOLD.itemId!=i&&aR.COPPER.itemId!=i||(r=!0),a.recover(),a.relive(),null!=o){var l=Bi.MODEL.colourId(o);a.charNameColor=ms.getByQuality(l),a.char_name=r?n+Bi.MODEL.name(o):Bi.MODEL.name(o),a.loadIcon(Bi.MODEL.icon(o))}var c=PB.tileToPixelsByXY(e,t);a.isRecover=!1,a.setXY(c.x,c.y-100),a.bodyHeight=40,a._proto_=i,a.setCharBoolVisible(!1),a.setCharNameVisible(!0);Math.random(),c.x,c.y;return Og.to(a,{x:c.x,y:c.y},500,pa.bounceInOut,ql.create(a,a.clearTweenFunc)),a.delayDo(1e3,a,a.delayPickup),NF.scene.addItem(a,0),a.cid=modules.scene.others.invented.InventedScene.Ins().currCid,-1==zN.pickUpQueue.indexOf(a)&&zN.pickUpQueue.push(a),a},z.relive=function(){if(NB.isSceneReady)for(var e=BB.getTimer(),t=0;t<zN.deathQueue.length;t++){var i=zN.deathQueue[t],n=i.char,s=n.proto;if(e-i.time>i.dealy){if(n.cid==modules.scene.others.invented.InventedScene.Ins().currCid){nH.removeCharBuff(n.char_id),n.relive(),n.setCharNameVisible(!1),n.setCharBoolVisible(!1),n.setCharBoolValue(100,100),n.setXY(s.x,s.y);var o=hn.getIndex(parseInt(s.modelId)),a=hn.MODEL.muId(o);a=_n.getIndex(a),n.bodyHeight=_n.MODEL.avatarHeight(a),n.char_name=hn.MODEL.name(o),n.clearCharState(),jN.getInstance().clear(n),n.selectTarget=null,n.selectEnabled=!0,n.play("stand"),n.lockMove=n.lockSkill=!1,rH.startAI(n),NF.scene.addItem(n),modules.scene.others.invented.InventedScene.Ins().addChar(n)}zN.deathQueue.splice(t,1),t--}}},z.setMonsetAttributes=function(e,t){z.monsterDataHash.put(e,aa.formatNewAttrToObject(t))},z._instance_=null,z.gkDto=null,z._selectIndex_=0,z.isStop=!0,z.currLevelTotalMonsterNumber=0,z.currLevelMonsterIndex=0,z.tickTime=0,z.yuanshenHash=null,z.yuanshenObjId=20,z.ysPlayerHash=null,z.ysReady=!1,z._isFullScene=!1,z.levelDealy=-1,z.levelDealyTime=0,z.levelDealyReady=!1,z.replaceModelPoints=[],z.replaceModelDir=[],z.heroQueue=[],z.callBossGrids=[],z.robotBirthPoints=[],z.currSceneMonsters=[],z.hookCharQueue=[],z.grids=[],z.isWait13003=!1,z.isWait13003OverTime=0,z._killPoint=null,f(z,["heroHash",function(){return this.heroHash=new jl},"monsterDataHash",function(){return this.monsterDataHash=new jl}]),z}(),dH=function(e){function t(){var e=this;e.livePt=null,e._owner=null,e.speed=200,e.runRang=3,e.attackRadius=3,e._selectTarget=null,e.monsterType=0,e.randomValue=0,e.RADIX_ENEMY_TYPE=1e3,e.RADIX_SHOT=1e4,e.RADIX_HATRED=3500,e.RADIX_DISTANCE=1e3,e.RADIX_CURR_SELECT=3e3,e.RADIX_DEATH=1e4,e.tarPt=null,e.intervalueTime=5e3,e.intervalueRunTime=0,e.isStop=!1,e.intervalueAttackTime=0,e.intervalueAttack=1500,e.radius=1,e.durIndex=0,e.lockMove=!1,t.__super.call(e),e.hatredQueue=new Array,e._className_="modules.scene.others.invented.MonsterAI"}b(t,"modules.scene.others.invented.MonsterAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.stop=function(){this.isStop=!0},i.start=function(){this.isStop=!1},i.destory=function(){var e=this;e._owner=null,e.tarPt=null,e.livePt=null,e.owner&&e.owner._CharMoveEnd_&&(e.owner._CharMoveEnd_.clear(),e.owner._CharMoveEnd_.recover()),e.hatredQueue&&(e.hatredQueue.length=0),e.selectTarget=null,rH.clear(e)},i.setup=function(e,t,i,n,s,o){var a=this;a.owner=e,a.owner.speed=i,a.livePt=t,a.speed=i,a.runRang=n,a.attackRadius=s,a.monsterType=o,a.owner._CharMoveEnd_=ql.create(a,a.moveEndFunc,null,!1),0<o?(a.randomValue=6e3*Math.random()>>0,a.intervalueAttack=500+(1e3*Math.random()>>0)):(n=2,a.randomValue=1e4*Math.random()>>0)},i.moveEndFunc=function(){var e=this;if(e.owner){var t=BB.getTimer();if(e.intervalueRunTime=t,e.owner.unBookTile(),0==e.monsterType)e.owner.play("stand"),e.randomValue=1e4*Math.random()>>0;else if(e.owner.play("stand"),e.randomValue=6e3*Math.random()>>0,e.intervalueAttackTime=t,e.selectTarget){var i=ZN.getTileDis(e.owner.tilePoint,e.selectTarget.tilePoint);e.lockMove?i<=5&&sH.getInstance().attackChar(e.owner.char_id,e.selectTarget.char_id,-1):i<=e.radius&&sH.getInstance().attackChar(e.owner.char_id,e.selectTarget.char_id,-1)}}},i.randomAct=function(){var e=2*Math.random()>>0;return 0==e?"stand":1==e?"walk":"stand"},i.doit=function(){sH.getInstance().isStop||this.isStop||this.moveIt()},i.moveIt=function(){var e=this;if(e.owner&&!e.owner.isDeath&&!e.owner.lockMove&&!e.owner.lockSkill)if(-1!=ra.LOCK_MONSTERS.indexOf(e.owner.mid)?e.lockMove=!0:e.lockMove=!1,0==e.monsterType)e.normalMode();else{var t=YH.instance.takeItem(e.owner.tilePoint.x,e.owner.tilePoint.y);if(null==t||t.type<=0)return void(e.owner.type!=Za.ROBOT&&uH.Ins().killMonster(e.owner));null==e.selectTarget?e.selectCharFunc()||e.normalMode():e.auto()}},i.auto=function(){var e,t=this,i=BB.getTimer(),n=t.owner;if(n&&!(i-t.durIndex<1200||(t.durIndex=i,n.isRuning||n.lock||n.isDeath)))if(YH.instance.isTileMonstermoveenabled(n.tilePoint)&&!t.lockMove)t.romMove();else{var s=ZN.getTileDis(n.tilePoint,t.selectTarget.tilePoint);if(t.lockMove)s<5&&t.moveEndFunc();else if(s>t.radius){if(8<s)return void(t.selectTarget=null);var o=1500+t.randomValue;if(t.selectTarget&&(o=100),i-t.intervalueRunTime<o)return;if(t.intervalueRunTime=i,e=YH.instance.getMinDisWithTar(n.tilePoint,NF.mainChar.tilePoint)){var a=PB.pixelsToTile(e.x,e.y);n.toBookTile(a.x,a.y,!0),n.facePoint(e),n.tarMoveTo([e]),a=e=null}}else{if(t.owner.stopMove(),i-t.intervalueAttackTime<t.intervalueAttack)return;t.intervalueAttackTime=i,t.moveEndFunc()}}},i.romMove=function(){var e=this.owner;if(e&&!e.isRuning&&!e.lock&&!e.isDeath){var t=YH.instance.getMinDisWithTar(e.tilePoint,NF.mainChar.tilePoint);if(t){var i=PB.pixelsToTile(t.x,t.y);e.toBookTile(i.x,i.y,!0),e.facePoint(t),e.tarMoveTo([t]),t=null}}},i.selectCharFunc=function(){for(var e=zN.getChars(),t=[],i=!1,n=0;n<e.length;n++){var s=e[n];if(s.type!=Za.CHAR){if(s.ai&&"YuanshenAI"==s.ai.className)continue;var o=this.getWeightChoic(s);ZN.getTileDisByPos(s.tileX,s.tileY,this.owner.tileX,this.owner.tileY)<=this.runRang&&t.push({wcv:o,char:s})}}return t.length&&null==this.selectTarget&&(t=ol.srotOn(t,"wcv",Array.NUMERIC),this.selectTarget=t[0].char,i=!0),t.length=0,t=null,i},i.normalMode=function(){var e=BB.getTimer();if(!(e-this.intervalueRunTime<this.intervalueTime+this.randomValue||(this.intervalueRunTime=e,this.owner.isRuning||"stand"==this.randomAct()))){var t=this.getPtInRunRangForRandom(),i=PB.tileToPixels(t);this.owner.toBookTile(t.x,t.y,!0),this.owner.tarMoveTo([i])}},i.getPtInRunRangForRandom=function(){for(var e=this,t=4*e.runRang*e.runRang,i=Math.random()*t>>0,n=new Uh(e.livePt.x,e.livePt.y),s=0,o=e.livePt.x-e.runRang;o<=e.livePt.x+e.runRang;o++)for(var a=e.livePt.y-e.runRang;a<=e.livePt.y-e.runRang;a++){if(o+"_"+a!=n.x+"_"+n.y){s++;var r=YH.instance.takeItem(o,a);if(s==i&&r&&0<r.walkType&&!r.isBook)return new Uh(o,a)}}return n},i.getWeightChoic=function(e){var t=this,i=0,n=t.getDistance(e);(t.inRange(e,n)||t.isCurrSelect&&t.inShot(e,n))&&(i+=t.RADIX_SHOT);var s=t.totalHatredIndex(e),o=t.hatredIndex(e);0<s&&(i+=t.RADIX_HATRED+100*(1-o/t.totalHatredIndex(e))),i+=t.RADIX_DISTANCE-10*n,i+=t.RADIX_ENEMY_TYPE*t.enemyType(e);var a=t.hatred(e),r=t.currSelectHaterd(e);return t.isCurrSelect(e)&&r<a&&(i+=t.RADIX_CURR_SELECT),(t.isDeath||t.isOffline)&&(i-=t.RADIX_DEATH),i},i.inShot=function(e,t){return void 0===t&&(t=-1),-1==t&&(t=ZN.getTileDisByPos(e.tileX,e.tileY,this.owner.tileX,this.owner.tileY)),t<=this.attackRadius},i.inRange=function(e,t){return void 0===t&&(t=-1),-1==t&&(t=ZN.getTileDisByPos(e.tileX,e.tileY,this.owner.tileX,this.owner.tileY)),t<=this.runRang},i.getDistance=function(e){return ZN.getTileDisByPos(e.tileX,e.tileY,this.owner.tileX,this.owner.tileY)},i.isDeath=function(e){return e.isDeath},i.isOffline=function(e){return e.isOffline},i.enemyType=function(e){switch(e.type){case Za.CHAR:return 3;case Za.ROBOT:return 1}return e.isAres?2:0},i.totalHatredIndex=function(e){return this.hatredQueue.length},i.hatredIndex=function(e){return this.indexOf(e.char_id)},i.hatred=function(e){if(!e)return 0;var t=this.find(e.char_id);return t?t.hatred:0},i.isCurrSelect=function(e){return!!this.selectTarget&&this.selectTarget==e},i.currSelectHaterd=function(e){return this.hatred(e)},i.addHatredTarget=function(e,t){void 0===t&&(t=0);var i=this.find(e);i?i.hatred=t:this.hatredQueue.push(e,{char_id:e,hatred:t})},i.removeHatredTarget=function(e){var t=this.indexOf(e);-1!=t&&this.hatredQueue.splice(t,1)},i.takeHatredTarget=function(e){return this.find(e)},i.updateHatred=function(e,t){void 0===t&&(t=0);var i=this.find(e);return!!i&&(i.hatred=t,!0)},i.indexOf=function(e){for(var t=0;t<this.hatredQueue.length;t++){if(this.hatredQueue[t].char_id==e)return t}return-1},i.find=function(e){for(var t=0;t<this.hatredQueue.length;t++){var i=this.hatredQueue[t];if(i.char_id==e)return i}return null},p(0,i,"owner",function(){return this._owner},function(e){this._owner=e}),p(0,i,"selectTarget",function(){return this._selectTarget},function(e){this._selectTarget=e}),t.MONSTERAI="modules.scene.others.invented.MonsterAI",t}(),hH=function(e){function t(){this._owner_=null,this._mainChar_=null,this._isStrop_=!1,this.actCtrl=null,this.durTime=2e3,this.modelId=0,this.playDur=0,t.__super.call(this)}b(t,"modules.scene.others.invented.NpcAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e){this._owner_=e,(this.owner.ai=this).playDur=BB.getTimer(),this.durTime=1500+(1e3*Math.random()>>0)},i.doit=function(){if(uH.Ins().currCid!=_a.S_KUANGDONG.toString()){if(sH.getInstance().isStop)return;if(this._isStrop_)return}this.moveIt()},i.playAttack=function(){var e=this,t=BB.getTimer();if(uH.Ins().currCid==_a.S_KUANGDONG.toString()&&e.owner.proto instanceof protos.digger.MimePlayerVo){var i=e.owner.proto;e.owner.setCharProfessionNameVisible(!0),e.owner.charProfessionName=Jp.getENTickMS(i.getLeftTime())}if(t-e.playDur>e.durTime&&(e.playDur=t,e.owner.play("attack"),dr.dtoEnterScene&&9==dr.dtoEnterScene.type)){var n=dr.dtoEnterScene.monsterId,s=hn.getIndex(n),o=hn.MODEL.muId(s);o=_n.getIndex(o);var a=_n.MODEL.skillEffect(o);_n.MODEL.effect_hit(o),_n.MODEL.effect_shoot(o);G.timer.once(300,e.owner,e.owner.loadEffect,[a])}},i.moveIt=function(){this.playAttack()},i.stop=function(){this._isStrop_=!0,this.actCtrl&&this.actCtrl.clearAll()},i.start=function(){this._isStrop_=!1},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t}(),_H=function(e){function t(){var e=this;e._owner_=null,e._isStrop_=!1,e._mainChar_=null,e.actCtrl=null,e.isUseSkill=0,e.isPlaying=0,e.ballTween=null,e.checkPos=0,e.durTime=0,t.__super.call(e),e._className_="PetAI",G.timer.once(2e3,e,e.hidePet)}b(t,"modules.scene.others.invented.PetAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e,t){((this._owner_=e).ai=this)._mainChar_=t,this.actCtrl||(this.actCtrl=new NH(e)),this.actCtrl.owner=e},i.doit=function(){this._isStrop_||this.isPlaying||this.moveIt()},i.moveIt=function(){var e=this;if(e.owner&&!e.owner.isDeath&&!e.owner.isRecover&&null!=e.owner.stage&&e._mainChar_){var t=BB.getTimer();if(200<t-e.durTime){if(e.durTime=t,!e.owner.tilePoint||!e._mainChar_.tilePoint)return;if(e._mainChar_!=NF.mainChar&&(e._mainChar_=uF.charQueue.take(e._mainChar_.objectId),!e._mainChar_))return;var i=ZN.getTileDis(e.owner.tilePoint,e._mainChar_.tilePoint);1==e.isUseSkill?(e.isUseSkill=0,e.isPlaying=1,G.timer.once(1e3,e,e.hidePet)):2<=i&&(e.owner.speed=350,e.domove(!0))}}},i.hidePet=function(){this.isPlaying=0,this.owner&&this.owner.play("stand")},i.domove=function(e){var t=this;void 0===e&&(e=!1);var i=BB.getTimer();if((!(i-t.durTime<100)||e)&&(t.durTime=i,!t.owner.isRuning&&t._mainChar_&&t.owner)){var n=t.getPoint(),s=ZN.getTileDis(t.owner.tilePoint,t._mainChar_.tilePoint);if(5<s&&(t.actCtrl.clearAll(),4<s))return t.owner.selectTarget=null,0==t._mainChar_.dir?t.owner.pos(n.x,n.y+10):1==t._mainChar_.dir?t.owner.pos(n.x-10,n.y+10):2==t._mainChar_.dir?t.owner.pos(n.x-10,n.y):3==t._mainChar_.dir?t.owner.pos(n.x-10,n.y-10):4==t._mainChar_.dir?t.owner.pos(n.x,n.y-10):5==t._mainChar_.dir?t.owner.pos(n.x+10,n.y-10):6==t._mainChar_.dir?t.owner.pos(n.x+20,n.y):7==t._mainChar_.dir&&t.owner.pos(n.x+10,n.y+10),void(t.owner.dir=t._mainChar_.dir);if(0==t.owner.isRuning&&1<s)if(0==s)t.checkMainCharSamPt();else PB.pixelsToTile(n.x,n.y).toString()!=t.owner.tilePoint.toString()&&(t.actCtrl.moveTo(n,!0,ql.create(t,t.checkMainCharSamPt)),t.checkPos=1)}},i.checkMainCharSamPt=function(){for(var e=0;e<uH.heroQueue.length;e++){var t=uH.heroQueue[e];if(null==this.owner||null==t);if(t&&t!=this.owner){if(!this.owner.tilePoint||!t.tilePoint)continue;if(ZN.getTileDis(this.owner.tilePoint,t.tilePoint)<=0){if(!this._mainChar_)continue;if(!this._mainChar_.tilePoint)continue;for(var i=YH.instance.get8Grids(this._mainChar_.tilePoint),n=0;n<i.length;n++){for(var s=PB.pixelsToTile(i[n].x,i[n].y),o=!1,a=0;a<uH.heroQueue.length;a++)if(uH.heroQueue[a]&&uH.heroQueue[a].tilePoint){var r=uH.heroQueue[a].tilePoint;r&&r.x==s.x&&r.y==s.y&&(o=!0)}o&&(i.splice(n,1),n--)}if(i.length)return 0==i.length?this.actCtrl.moveTo(i[0],!0):this.actCtrl.moveTo(i[Math.random()*i.length>>0],!0),!0}}}return!1},i.getPoint=function(e,t){var i=this;if(void 0===t&&(t=-1),!i._mainChar_||!i.owner)return null;if(null==e)return YN.getCharNearPt(i._mainChar_,i.owner);null==e&&(e=i._mainChar_.tilePoint),-1==t&&i._mainChar_.dir;var n=t,s=1;2<i.owner.profession&&(s=2);var o=VB.getTileByDir(e,n,s);4==i.owner.profession&&(n=VB.getDretion(i.owner.point.x,i.owner.point.y,i._mainChar_.point.x,i._mainChar_.point.y),o=VB.getTileByDir(e,(i.owner.profession+t)%7,2));var a=PB.pixelsToTile(o.x,o.y),r=YH.instance.takeItem(a.x,a.y);return r&&0!=r.type?o:PB.tileToPixels(e)},i.resetPostion=function(){this.owner&&!this.owner.isDeath&&!this.owner.isRecover&&null!=this.owner.stage&&this._mainChar_&&this.domove(!0)},i.stop=function(){this._isStrop_=!0,this.actCtrl&&this.actCtrl.clearAll()},i.setAttack=function(){this.isUseSkill=1,this._mainChar_&&this.owner&&(this.owner.dir=this._mainChar_.dir),this.owner._isRuning_&&this.owner.stopMove()},i.start=function(){this._isStrop_=!1,this._mainChar_&&this.owner&&(this.owner.dir=this._mainChar_.dir)},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t.PETAI="PetAI",t}(),fH=function(e){function n(){var e=this;e.actCtrl=null,e._owner_=null,e.attackDurTime=0,e.attackDur=1200,e._skillArray=[],e.skillIndex=0,e.enemy=null,e._isStrop_=!0,e._hide=!1,n.__super.call(e)}b(n,"modules.scene.others.invented.PlayerAI",$h);var t=n.prototype;return G.imps(t,{"zwc.saiman.interfaces.IAI":!0}),t.setup=function(e){this.owner=e,(this.owner.ai=this).actCtrl=new NH(e)},t.start=function(){this.attackDurTime=BB.getTimer()-1e3+(300*Math.random()>>0),this._isStrop_=!1},t.stop=function(){this.actCtrl&&this.actCtrl.clearAll(),this.owner.selectTarget=null,this._isStrop_=!0},t.hide=function(){this._hide=!0,this.owner.visible=!1},t.show=function(){this._hide=!1,this.owner.visible=!0},t.doit=function(){if(uH.Ins().currCid!=_a.S_SBK_FRONT.toString()){if(sH.getInstance().isStop)return;if(this._isStrop_)return}this.moveIt()},t.moveIt=function(){this.playAttack()},t.takeCurrSkill=function(){return this.skillIndex>=this.skillArray.length&&(this.skillIndex=0),this.skillArray[this.skillIndex]},t.playAttack=function(){var e=this,t=BB.getTimer();if(2e3<t-e.attackDurTime&&100<t-n.playIndex&&(n.playIndex=t,e.attackDurTime=t,e.enemy&&e.owner&&0==e.owner.isDeath)){ZN.getTileDisByPos(e.enemy.tilePoint.x,e.enemy.tilePoint.y,e.owner.tilePoint.x,e.owner.tilePoint.y);var i=Vn.getIndex(e.takeCurrSkill());Vn.MODEL.pointDis(i);0<e.owner.hero_id?oH.playSkill2(e.owner,e.enemy,e.takeCurrSkill()):oH.playSkill2(e.owner,e.enemy,e.takeCurrSkill(),!1),e.passSkill()}},t.passSkill=function(){this.skillIndex++,this.skillIndex>=this.skillArray.length&&(this.skillIndex=0)},t.getPoint2=function(e){for(var t=YH.instance.get8Grids(e),i={point:this.owner.point,dis:0},n=0;n<t.length;n++){for(var s=PB.pixelsToTile(t[n].x,t[n].y),o=!1,a=0;a<uH.heroQueue.length;a++){var r=uH.heroQueue[a].tilePoint;r.x==s.x&&r.y==s.y&&(o=!0)}o&&(t.splice(n,1),n--)}for(var l=0;l<t.length;l++){var c=t[l],u=Math.random()*t.length>>0;t[d]=t[u],t[u]=c}for(var d=0;d<t.length;d++){var h=ol.distance(this.owner.point,t[d]);0==d?(i.point=t[d],i.dis=h):h<i.dis&&(i.point=t[d],i.dis=h)}return i.point},t.checkDis=function(){},t.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,t,"skillArray",function(){return 1==this.owner.profession?this._skillArray=Aa.S_ZHANSHI:2==this.owner.profession?this._skillArray=Aa.S_FASHI:3==this.owner.profession?this._skillArray=Aa.S_DAOSHI:this._skillArray=[405],this._skillArray}),p(0,t,"owner",function(){return this._owner_},function(e){this._owner_=e}),n.playIndex=0,n}(),pH=function(e){function I(){var e=this;e.attackValue=0,e.playerId=0,e.dto=null,e.boss=null,e.bossPoint=null,e.player=null,e.playerData=[],e.isLive=0,e.points=[],I.__super.call(e),e.charQueue=new jl}b(I,"modules.scene.others.invented.PlayerGroupAI",$h);var t=I.prototype;return t.setupAndPlay=function(e,t,i){var n=this;n.playerData=e;var s=LH.beanChar(n);n.dto=s;var o=VB.getDretion(n.dto.birthPoint.x,n.dto.birthPoint.y,i.point.x,i.point.y);ZN.getTileDis(n.dto.birthPt,i.tilePoint);n.points=LH.points[s.index];for(var a=0;a<e.length;a++){var r=n.dto.birthPoint.x,l=n.dto.birthPoint.y,c=e[a],u=aH.createChar(c,r,l);u.type=Za.CHAR,u.bodyHeight=NB.BODY_HEIGHT,u.charNameColor="#ff0000",u.cid=uH.Ins().currCid,u.char_name=c.charName,""!=c.guideName&&(u.charProfessionName=c.guideName,u.setCharProfessionNameVisible(!0));var d=gR.ins.actorFlyUpLevel;gR.ins.actorFlyUpLevel&&0<d&&(u.setCharFlyupNameVisible(!0),u.setflyupName(d)),ZN.setCharTitle(u,c.titles),u.setCharBoolValue(c.currHP,c.currHP),u.setCharNameVisible(!0),u.setCharBoolVisible(!0),u.isCharMode=!0,u.isShowad=!0,u.visible=!0,u.speed=400,u.owner_char=c.playerId.toString(),n.playerId=c.playerId,0==a&&(n.player=u);var h=rH.GetPlayerAI();h.setup(u),h.enemy=i,rH.pushAI(h),n.charQueue.put(u.char_id,u);var _=c.professional;2<_?2:_;var f=VB.getTileByDir(u.tilePoint,o,_);u.setXY(f.x,f.y);var p,g=PB.pixelsToTile(t.x,t.y),v=(ZN.getTileDis(u.tilePoint,g),VB.getDretion(t.x,t.y,u.point.x,u.point.y)),m=VB.getTileByDir(g,v,1),y=PB.pixelsToTile(m.x,m.y);0==_?p=n.points[3]:1==_?p=n.points[0]:2==_?p=n.points[1]:3==_&&(p=n.points[2]),0==a?(h.actCtrl.moveTo(p,!1,ql.create(h,h.start)),n.bossPoint=p,u.toBookHeroTile(y.x,y.y)):(y=PB.pixelsToTile(p.x,p.y),u.toBookHeroTile(y.x,y.y),n.points.length&&(p=n.points[a]),h.actCtrl.moveTo(p,!1,ql.create(h,h.start))),I.beanChar(c.char_id,u)}},t.remove=function(){for(var e in this.charQueue.proto){var t=this.charQueue.proto[e],i=t.proto;i&&I.unbeanChar(i.char_id),t&&(t.ai&&t.ai.stop(),rH.removeAI(t),t.removeReason.push("playGroup"),uH.Ins().removeChar(t),t.visible=!1)}this.dto.isQuote=!1},t.isPlayerAllDeath=function(){var e=!0;for(var t in this.charQueue.proto){var i=this.charQueue.proto[t];i&&0==i.isDeath&&(e=!1)}return e},t.stop=function(){for(var e in this.charQueue.proto){var t=this.charQueue.proto[e];t&&t.ai&&t.ai.stop()}},t.hide=function(){for(var e in this.charQueue.proto){var t=this.charQueue.proto[e];t&&t.ai&&t.ai.hide()}},t.show=function(){for(var e in this.charQueue.proto){var t=this.charQueue.proto[e];t&&t.ai&&t.ai.show()}},t.start=function(){for(var e in this.charQueue.proto){var t=this.charQueue.proto[e];t&&0==t.isDeath&&(t.setPoisoning(!1),t.visible=!0,t.lockMove=t.lockSkill=!1),t&&t.ai&&t.ai.start()}},t.moveTo=function(e,t){for(var i=0;i<this.playerData.length;i++){var n=this.playerData[i],s=I.takeChar(n.char_id),o=s.ai;if(0==i)o.actCtrl.moveTo(e,!1,t);else{var a=PB.pixelsToTile(e.x,e.y);s.toBookHeroTile(a.x,a.y);var r=uH.getHeroPoint(s,a);o.actCtrl.moveTo(r)}}},I.reset=function(){I.charHash.reset()},I.takeChar=function(e){return I.charHash.take(e)},I.beanChar=function(e,t){I.charHash.put(e,t)},I.unbeanChar=function(e){I.charHash.remove(e)},f(I,["charHash",function(){return this.charHash=new jl}]),I}(),gH=function(e){function t(){this._owner_=null,this._isStrop_=!1,this.durTime=0,this.actCtrl,t.__super.call(this)}b(t,"modules.scene.others.invented.RobotAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e){this._owner_=e,(this.owner.ai=this).actCtrl=new NH(e),this.owner.faceTo(NF.mainChar),this.durTime=BB.getTimer()+(1e3*Math.random()>>0)},i.doit=function(){sH.getInstance().isStop||this._isStrop_||this.moveIt()},i.moveIt=function(){var e=this;if(e.owner&&!e.owner.isDeath&&!e.owner.isRecover&&null!=e.owner.stage){var t=BB.getTimer();if(t-e.durTime>2e3+(500*Math.random()>>0)&&(e.durTime=t,e.owner.selectTarget&&0==e.owner.selectTarget.isDeath&&e.owner.selectTarget.stage&&0==e.owner.selectTarget.isRecover))if(e.owner.faceTo(e.owner.selectTarget),e.owner.type==Za.CHAR){var i=e.owner.proto,n=104;3==i.pro?n=201:2==i.pro&&(n=301),oH.playSkill2(e.owner,e.owner.selectTarget,n)}else e.owner.play("attack")}},i.stop=function(){this._isStrop_=!0,this.actCtrl&&this.actCtrl.clearAll(),this.owner.selectTarget=null},i.start=function(){this._isStrop_=!1},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t}(),vH=function(e){function t(){this._owner_=null,this._isStrop_=!1,this.durTime=0,this.actCtrl,t.__super.call(this)}b(t,"modules.scene.others.invented.RobotHootAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e){this._owner_=e,(this.owner.ai=this).actCtrl=new NH(e),this.owner.faceTo(NF.mainChar),this.durTime=BB.getTimer()},i.doit=function(){sH.getInstance().isStop||this._isStrop_||this.moveIt()},i.moveIt=function(){var e=this;if(e.owner&&!e.owner.isDeath&&!e.owner.isRecover&&null!=e.owner.stage){var t=BB.getTimer();if(1e3<=t-e.durTime&&(e.durTime=t,e.owner.selectTarget=sH.getInstance().findNearMonster(e.owner.tilePoint,e.owner),e.owner.selectTarget&&0==e.owner.selectTarget.isDeath&&e.owner.selectTarget.stage&&0==e.owner.selectTarget.isRecover)){if(e.owner.isRuning)return;var i=e.owner.proto,n=104;if(3==i.pro?n=201:2==i.pro&&(n=301),0==sH.checkDisEnough(n,e.owner.selectTarget.point,null,e.owner)){var s=YN.getCharNearPt(e.owner.selectTarget,e.owner);e.actCtrl.moveTo(s,!0,ql.create(e,e.attack,[e.owner,e.owner.selectTarget,n]))}else e.owner.faceTo(e.owner.selectTarget),e.attack(e.owner,e.owner.selectTarget,n)}}},i.attack=function(e,t,i){if(!(t.isBoss||t.ai&&"YuanshenAI"==t.ai.className)){oH.playSkill2(e,t,i);var n,s=gR.ins.actorList[0];n=s?s.getAttrById(aa.ATK.id):0,G.timer.loop(300,this,this.hurt,[t,n])}},i.hurt=function(e,t){if(e.ai){var i=0;if((i=e.currHp-t)<=0&&(i=0),e.type==Za.MONSTER)parseInt(Object(e.data).modelId);e.setCharBoolValue(i),e.currHp<=0&&(e.doDelay(100,e,e.timeOutDead),e.doDelay(500,e,e.doFightCtrlSetDeath,[e]))}else G.timer.clear(this,this.hurt)},i.stop=function(){this._isStrop_=!0,G.timer.clear(this,this.hurt),this.actCtrl&&this.actCtrl.clearAll(),this.owner.selectTarget=null},i.start=function(){this._isStrop_=!1},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t}(),mH=function(e){function t(){var e=this;e._owner_=null,e._isStrop_=!1,e._mainChar_=null,e.actCtrl=null,e.isUseSkill=0,e.isPlaying=0,e.ballTween=null,e.checkPos=0,e.durTime=0,t.__super.call(e),e._className_="YuanshenAI",G.timer.once(2e3,e,e.hideYuanshen)}b(t,"modules.scene.others.invented.YuanshenAI",$h);var i=t.prototype;return G.imps(i,{"zwc.saiman.interfaces.IAI":!0}),i.setup=function(e,t){((this._owner_=e).ai=this)._mainChar_=t,this.actCtrl||(this.actCtrl=new NH(e)),this.actCtrl.owner=e},i.doit=function(){this._isStrop_||this.isPlaying||this.moveIt()},i.moveIt=function(){var e=this;if(e.owner&&!e.owner.isDeath&&!e.owner.isRecover&&null!=e.owner.stage&&e._mainChar_){var t=BB.getTimer();if(200<t-e.durTime){if(e.durTime=t,!e.owner.tilePoint||!e._mainChar_.tilePoint)return;if(e._mainChar_!=NF.mainChar&&(e._mainChar_=uF.charQueue.take(e._mainChar_.objectId),!e._mainChar_))return;var i=ZN.getTileDis(e.owner.tilePoint,e._mainChar_.tilePoint);1==e.isUseSkill?(e.isUseSkill=0,e.isPlaying=1,G.timer.once(1e3,e,e.hideYuanshen)):(2<=i&&0==e.owner.lock&&e._mainChar_.isRuning||2<=i&&0==e.owner.lock)&&(e.owner.speed=400,e.domove(!0))}}},i.hideYuanshen=function(){this.isPlaying=0,this.owner&&this.owner.play("stand")},i.domove=function(e){var t=this;void 0===e&&(e=!1);var i=BB.getTimer();if((!(i-t.durTime<100)||e)&&(t.durTime=i,!t.owner.isRuning)){var n=t.getPoint(),s=ZN.getTileDis(t.owner.tilePoint,t._mainChar_.tilePoint);if(5<s&&(t.actCtrl.clearAll(),4<s))return t.owner.selectTarget=null,0==t._mainChar_.dir?t.owner.pos(n.x,n.y+10):1==t._mainChar_.dir?t.owner.pos(n.x-10,n.y+10):2==t._mainChar_.dir?t.owner.pos(n.x-10,n.y):3==t._mainChar_.dir?t.owner.pos(n.x-10,n.y-10):4==t._mainChar_.dir?t.owner.pos(n.x,n.y-10):5==t._mainChar_.dir?t.owner.pos(n.x+10,n.y-10):6==t._mainChar_.dir?t.owner.pos(n.x+20,n.y):7==t._mainChar_.dir&&t.owner.pos(n.x+10,n.y+10),void(t.owner.dir=t._mainChar_.dir);if(0==t.owner.isRuning&&1<s)if(0==s)t.checkMainCharSamPt();else PB.pixelsToTile(n.x,n.y).toString()!=t.owner.tilePoint.toString()&&(t.actCtrl.moveTo(n,!0,ql.create(t,t.checkMainCharSamPt)),t.checkPos=1)}},i.checkMainCharSamPt=function(){for(var e=0;e<uH.heroQueue.length;e++){var t=uH.heroQueue[e];if(null==this.owner||null==t);if(t&&t!=this.owner){if(!this.owner.tilePoint||!t.tilePoint)continue;if(ZN.getTileDis(this.owner.tilePoint,t.tilePoint)<=0){if(!this._mainChar_.tilePoint)continue;for(var i=YH.instance.get8Grids(this._mainChar_.tilePoint),n=0;n<i.length;n++){for(var s=PB.pixelsToTile(i[n].x,i[n].y),o=!1,a=0;a<uH.heroQueue.length;a++)if(uH.heroQueue[a]&&uH.heroQueue[a].tilePoint){var r=uH.heroQueue[a].tilePoint;r&&r.x==s.x&&r.y==s.y&&(o=!0)}o&&(i.splice(n,1),n--)}if(i.length)return 0==i.length?this.actCtrl.moveTo(i[0],!0):this.actCtrl.moveTo(i[Math.random()*i.length>>0],!0),!0}}}return!1},i.getPoint=function(e,t){var i=this;if(void 0===t&&(t=-1),null==e)return YN.getCharNearPt(i._mainChar_,i.owner);null==e&&(e=i._mainChar_.tilePoint),-1==t&&i._mainChar_.dir;var n=t,s=1;2<i.owner.profession&&(s=2);var o=VB.getTileByDir(e,n,s);4==i.owner.profession&&(n=VB.getDretion(i.owner.point.x,i.owner.point.y,i._mainChar_.point.x,i._mainChar_.point.y),o=VB.getTileByDir(e,(i.owner.profession+t)%7,2));var a=PB.pixelsToTile(o.x,o.y),r=YH.instance.takeItem(a.x,a.y);return r&&0!=r.type?o:PB.tileToPixels(e)},i.resetPostion=function(){this.owner&&!this.owner.isDeath&&!this.owner.isRecover&&null!=this.owner.stage&&this._mainChar_&&this.domove(!0)},i.stop=function(){this._isStrop_=!0,this.actCtrl&&this.actCtrl.clearAll()},i.start=function(){this._isStrop_=!1,this.owner.dir=this._mainChar_.dir,this.isUseSkill=1,this.owner._isRuning_&&this.owner.stopMove()},i.destory=function(){this.actCtrl&&this.actCtrl.clearAll(),this.actCtrl=null},p(0,i,"owner",function(){return this._owner_},function(e){this._owner_=e}),t.YUANSHENAI="YuanshenAI",t}(),yH=function(e){function t(){this.mainChar=null,t.__super.call(this),this.actCtrl,(t._instance_=this).actCtrl=new NH(NF.mainChar)}b(t,"modules.scene.others.MainMoveCtrl",$h);var i=t.prototype;return i.updateCtrl=function(){this.actCtrl.owner=NF.mainChar},i.stopNow=function(e){void 0===e&&(e=!0),NF.mainChar.stopMove(e),NF.mainChar.lockSkill=!1},i.mainCharMove=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=!0),this.actCtrl&&this.actCtrl.currOrder&&this.actCtrl.currOrder.dispose(),this.actCtrl&&this.actCtrl.nextOrder&&(this.actCtrl.nextOrder.dispose(),this.actCtrl.clearAll()),this.actCtrl.moveTo(e,t,i,n)},i.stopMove=function(e){this.actCtrl.moveTo(null,!0,e,!1)},i.clear=function(e){void 0===e&&(e=!0),this.stopNow(e),NF.mainChar.lockMove=!1,this.actCtrl.clearAll()},t.Ins=function(){return null==t._instance_&&new t,t._instance_},t._instance_=null,t.currDir=4,f(t,["tileAstar",function(){return this.tileAstar=new jH}]),t}(),IH=function(e){function t(){var e=this;e.forRed=!1,e.isSpecial_LD_Type=0,e.SUMMON_SKILL=305,e.UNION_SKILL=[501,502,503],e.unionUseTime=0,e.unionCD_Server=6e4,e.unionCD=6e4,e.currentSelectedRole=0,e.skillReplace=null,e.skillHash=new jl,t._inst&&pt.window.alert(RP.n[120]),t.__super.call(e)}b(t,"modules.skill.others.SkillDataModel",$h);var i=t.prototype;return i.isCanUse=function(){return modules.skill.others.SkillDataModel.ins.unionUseTime<=0||modules.skill.others.SkillDataModel.ins.unionUseTime<dr.curServerTime},i.updateSkill=function(e,t){var i=!1,n=[],s=gR.ins.lv,o=this.skillHash.take(e);if(o){for(var a=0;a<t.length;a++){var r=t[a],l=this.getSkillIndex(e,r.skill_id);Vn.getIndex(r.skill_id);-1==l?(o.push(r),2<=s&&s<=80&&Tu.sendToModule("GAIN_NEWSKILL",["modules.skill.SkillModule"],r.skill_id),r.skill_id==this.SUMMON_SKILL&&Tu.sendToModule("LEARN_SUMMON_SKILL",["modules.scene.SceneModule"])):(n.push(o[l]),o.splice(l,1,r),i=!0)}if(this.skillHash.put(e,o,!0),i){var c={};c.newList=t,c.oldList=n,Tu.sendToModule("SKILL_UPGRADE",["modules.skill.SkillModule"],c)}}else this.skillHash.put(e,t)},i.getSkillIndex=function(e,t){var i=this.skillHash.take(e);if(i)for(var n=0;n<i.length;n++){if(i[n].skill_id==t)return n}return-1},i.hasSummonSkill=function(){for(var e=1;e<=3;e++){var t=this.skillHash.take(e);if(t)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.skill_id==this.SUMMON_SKILL)return!0}}return!1},i.takeCharSkillList=function(e){var t=this.skillHash.take(e);return null==t?[]:t},i.getCurrSkillDto=function(e,t){var i=null,n=this.skillHash.take(e);if(n)for(var s=0;s<n.length;s++)if((i=n[s]).skill_id==t)return i;return this.checkIsChangeSKill(t)&&(i=na.create(t,1)),i},i.getDtoSkill=function(e,t){for(var i,n=this.takeCharSkillList(e),s=0;s<n.length;s++)if(t==(i=n[s]).skill_id)return i;return i=na.create(t,0)},i.getAllUpCost=function(e){var t=this.cloneSkillArr(e),i=gR.ins.coin,n=0,s=0,o=0;if(t.sort(this.sortFunc),s=t[0].cur_lvl,o=t[0].skill_id,0==this.checkLvLimit(o,s))return 0;for(var a=!0;a;){t.sort(this.sortFunc);var r=t[0];if(s=1<=r.cur_lvl?r.cur_lvl-1:0,o=r.skill_id,1==this.checkLvLimit(o,s)){var l=Vn.getIndex(o),c=Vn.MODEL.upgradeCost(l),u=Vn.MODEL.maxLevel(l);i>=n+c[s]&&s<u?(n+=c[s],r.cur_lvl++,t.splice(0,1,r)):a=!1}else a=!1}return n},i.checkLvLimit=function(e,t){var i=Vn.getIndex(e),n=Vn.MODEL.levelLimit(i),s=Vn.MODEL.zsLimit(i),o=n[t],a=s[t],r=gR.ins.lv,l=gR.ins.zsLv;return!(r<o||l<a)},i.cloneSkillArr=function(e){for(var t,i,n=gR.ins.actorList[e-1].job,s=[],o=this.takeCharSkillList(e),a=0;a<o.length;a++){t=o[a];var r=Vn.getIndex(t.skill_id);Vn.MODEL.role(r)==n&&0<Vn.MODEL.available(r)&&(i=na.create(t.skill_id,t.cur_lvl),s.push(i))}return s},i.sortFunc=function(e,t){return e.cur_lvl>=t.cur_lvl?1:-1},i.checkRedPoint=function(e){var t=this.cloneSkillArr(e);if(0==t.length)return!1;var i,n,s=gR.ins.coin;if(t.sort(this.sortFunc),i=t[0].cur_lvl,n=t[0].skill_id,1==this.checkLvLimit(n,i)){var o=Vn.getIndex(n);if(s>=Vn.MODEL.upgradeCost(o)[i])return!0}return!1},i.canUpgrade=function(e){var t=Vn.getIndex(e.skill_id),i=Vn.MODEL.maxLevel(t),n=gR.ins.coin;if(this.checkLvLimit(e.skill_id,e.cur_lvl)&&e.cur_lvl<i&&Vn.MODEL.upgradeCost(t)[e.cur_lvl]<=n)return!0;return!1},i.replaceSKILL=function(e){this.skillReplace||(this.skillReplace=new Object),305==(this.skillReplace[e.skillId]=e).skillId&&uH.Ins().dogReplaceBahuHero()},i.isChangeSKill=function(e){var t=[!1,0];if(this.skillReplace){var i=this.skillReplace[e];i&&i.skillId==e&&(t[0]=!0,t[1]=i.replaceSkillIds[0])}return t},i.checkIsChangeSKill=function(e){if(!this.skillReplace)return!1;for(var t=0 in this.skillReplace){var i=this.skillReplace[t];if(i&&i.replaceSkillIds[0]==e)return!0}return!1},p(0,i,"progress",function(){return modules.skill.others.SkillDataModel.ins.unionUseTime<=0?1:modules.skill.others.SkillDataModel.ins.unionUseTime<dr.curServerTime?1:(modules.skill.others.SkillDataModel.ins.unionCD-Math.ceil(modules.skill.others.SkillDataModel.ins.unionUseTime-dr.curServerTime))/modules.skill.others.SkillDataModel.ins.unionCD}),p(0,i,"isBahu",function(){if(!this.skillReplace)return!1;var e=this.skillReplace[305];return!!(e&&305==e.skillId&&-1<e.replaceSkillIds.indexOf(309))}),p(1,t,"ins",function(){return t._inst||(t._inst=new t),t._inst},zwc.engine.core.protos.Proto._$SET_ins),t._inst=null,t.UNIONCD_TIME=24e3,t}(),bH=function(e){function t(){this.currentUI=null,this.m_NPCId=null,t.__super.call(this)}b(t,"modules.task.views.NPCControler",$h);var i=t.prototype;return i.show=function(e){this.currentUI&&(this.currentUI.destroy(),this.currentUI=null),this.m_NPCId=e,PH.hasTask()&&PH.Ins().commitNPC==e&&PH.Ins().canCommit?this.showMainTaskUI():this.showOther(),hr.showNpcId=this.npcId},i.showOther=function(){var e=fn.getIndex(parseInt(this.m_NPCId));switch(fn.MODEL.type(e)){case 1:break;case 2:Tu.sendToModule("OPEN_ARENA",["modules.arena.ArenaModule"]);break;case 4:Tu.sendToModule("OPEN_ENTER",["modules.pig.PigModule"]);break;case 5:Tu.sendToModule("OPEN_SPORTS_VIEW",["modules.digger.DiggerModule"]);break;case 6:Tu.sendToModule("OPEN_HIREVIEW",["modules.digger.DiggerModule"]);break;case 7:Tu.sendToModule("OPEN",["modules.yzbqc.YzbqcModule"]);break;case 8:this.showSiegeUI();break;case 9:Tu.sendToModule("OPENSCENELIST",["modules.achieve.AchieveModule"]);break;default:this.showCommonUI()}},i.isShowing=function(){return!!this.currentUI&&this.currentUI.isShowing()},i.showMainTaskUI=function(){this.onShowMainTaskUI(null)},i.onShowMainTaskUI=function(e){UB.ins.playSound(90006)},i.showNPCOption=function(){},i.showCommonUI=function(){GB.has(_r.getAtlasSubPath("task/task_Bg.png"))?GB.hasLoaded(_r.getAtlasSubPath("task/task_Bg.png"))&&this.doShowCommonUI(null):GB.retain(_r.getAtlasSubPath("task/task_Bg.png")).once("complete",this,this.doShowCommonUI)},i.doShowCommonUI=function(e){this.currentUI},i.showSiegeUI=function(){GB.has(_r.getAtlasSubPath("task/task_Bg.png"))?GB.hasLoaded(_r.getAtlasSubPath("task/task_Bg.png"))&&this.doShowSiegeUI(null):GB.retain(_r.getAtlasSubPath("task/task_Bg.png")).once("complete",this,this.doShowSiegeUI)},i.doShowSiegeUI=function(e){},i.destroy=function(){this.currentUI&&(this.currentUI.destroy(),this.currentUI=null),hr.showNpcId=null},i.clearSiege=function(){},i.resize=function(){this.currentUI&&this.currentUI.isShowing()&&this.currentUI.resize()},p(0,i,"npcId",function(){return this.m_NPCId}),p(1,t,"showing",function(){return t.m_Instance&&t.m_Instance.isShowing()},zwc.engine.core.protos.Proto._$SET_showing),t.getInstance=function(){return null==t.m_Instance&&(t.m_Instance=new t),t.m_Instance},t.TYPE_1=1,t.TYPE_2=2,t.TYPE_3=3,t.TYPE_4=4,t.TYPE_5=5,t.TYPE_6=6,t.TYPE_7=7,t.TYPE_8=8,t.TYPE_9=9,t.m_Instance=null,t}(),wH=function(e){function t(){var e=this;e.forRed=!1,e.hasInit=!1,e.activityData=null,e.dailyTasks=null,e.timeTasks=null,e.date=null,e.currentIndex=0,e.actVo=null,e.time=0,t.__super.call(e)}b(t,"protos.achieve.DailyTaskModel",$h);var i=t.prototype;return i.setUp=function(e,t){var i=this;1==e?(i.dailyTasks&&(i.dailyTasks.dispose(),i.dailyTasks=null),i.dailyTasks=t,i.checkIndex()):2==e&&(i.timeTasks&&(i.timeTasks.dispose(),i.timeTasks=null),i.timeTasks=t),i.dailyTasks&&i.timeTasks&&(i.hasInit=!0)},i.hasSetUp=function(e){return 1==e?null!=this.dailyTasks:2==e&&null!=this.timeTasks},i.update=function(e){var t=null;if(1==e.activityVo.type?t=this.dailyTasks.vos:2==e.activityVo.type&&(t=this.timeTasks.vos),t)for(var i=0;i<t.length;++i){if(t[i].acId==e.activityVo.acId){t[i]=e.activityVo;break}}this.checkIndex(),Tu.sendToModule("SHOWDAILYICONEFFECT",["modules.nav.NavModule"])},i.getDailyTaskVo=function(e,t){var i;if(1==e&&this.dailyTasks?i=this.dailyTasks.vos:2==e&&this.timeTasks&&(i=this.timeTasks.vos),i)for(var n=0;n<i.length;++n){var s=i[n];if(s.acId==t)return s}return null},i.checkIndex=function(){if(this.dailyTasks)for(var e=this.currentIndex=0;e<this.dailyTasks.vos.length;e++){var t=this.dailyTasks.vos[e];if(null!=t&&2==t.isShowTip(!1)){var i=$t.getIndex(t.acId),n=$t.MODEL.priority(i);0==this.currentIndex?this.currentIndex=n:this.currentIndex>n&&(this.currentIndex=n)}}},i.getHasReward=function(e){var t;if(1==e&&this.dailyTasks?t=this.dailyTasks.vos:2==e&&this.timeTasks&&(t=this.timeTasks.vos),null!=t)for(var i=0;i<t.length;++i){if(2==t[i].status)return!0}return!1},i.getHasData=function(e){var t,i=this;if(1==e&&i.dailyTasks?t=i.dailyTasks.vos:2==e&&i.timeTasks&&(t=i.timeTasks.vos),null!=t)for(var n=0;n<t.length;++n){var s=t[n];if(2==s.status)return!0;if(2==e){var o=$t.getIndex(s.acId),a=$t.MODEL.openLevel(o),r=$t.MODEL.openFlyLevel(o),l=gR.ins.lv>=a&&gR.ins.zsLv>=r;if(i.actVo=protos.achieve.DailyTaskModel.Ins().getDailyTaskVo(e,s.acId),!(0<$t.MODEL.redId(o))){if(gR.ins.zsLv<r)return!1;if(gR.ins.lv<a)return!1;if(l){var c=protos.achieve.DailyTaskModel.Ins().serverDate,u=$t.MODEL.openWeek(o),d=null;if(u){d=u.split(",");var h=c.getDay();if(-1==d.indexOf(h+""))l=i.actVo&&2==i.actVo.status;else{var _=c.getHours(),f=c.getUTCMinutes(),p=$t.MODEL.openTime(o).split("-");if(0<p.length){var g=p[0].split(":"),v=p[1].split(":");_<i.strToInt(g[0])||_>i.strToInt(v[0])?l=i.actVo&&2==i.actVo.status:_==i.strToInt(g[0])&&f<i.strToInt(g[1])?l=i.actVo&&2==i.actVo.status:_==i.strToInt(v[0])&&f>i.strToInt(v[1])&&(l=i.actVo&&2==i.actVo.status)}}}}return l}if(AN.ins.getStateByBtnName("btn_main_sjboss"))return!0}}return!1},i.strToInt=function(e){return e?"0"==e.charAt(0)?parseInt(e.charAt(1)):parseInt(e):0},i.hasActivity=function(){return null!=this.activityData},i.updateActivity=function(e){this.activityData&&(this.activityData.dispose(),this.activityData=null),this.activityData=e,this.checkIndex(),Tu.sendToModule("SHOWDAILYICONEFFECT",["modules.nav.NavModule"])},i.getActivity=function(){return this.activityData},p(0,i,"serverDate",function(){var e=BB.getTimer();return 2e3<e-this.time&&(this.date=dr.serverDate,this.time=e),this.date}),t.Ins=function(){return null==t.m_Instance&&(t.m_Instance=new t),t.m_Instance},t.PROGRESS=1,t.CANGET=2,t.HASGET=3,t.m_Instance=null,t.DAILY=1,t.TIME=2,t.WORLDBOSS_ID=63,t}(),xH=function(e){function n(){this.serverVo=null,this.isPlayerAct=0,this.preferGift=null,this.preSenGift=null,this._perbossKiller=null,this._serbossKiller=null,n.__super.call(this)}b(n,"protos.activity.ActivityInfo",$h);var t=n.prototype;return t.setServerVo=function(e,t){void 0===t&&(t=0),this.serverVo=e,this.isPlayerAct=t},t.updateGift=function(e){var t=this;if(t.preferGift&&(t.preferGift.length=0,t.preferGift=null),t.preSenGift&&(t.preSenGift.length=0,t.preSenGift=null),t.gifts)for(var i=0;i<t.gifts.length;++i){var n=t.gifts[i];if(n&&n.giftId==e.giftId)return n.dispose(),n=null,t.gifts[i]=e,void(t._serbossKiller&&(t._perbossKiller.length=0,t._perbossKiller=null,t._serbossKiller.length=0,t._serbossKiller=null))}},t.hasComGift=function(){for(var e=0;e<this.gifts.length;++e){var t=this.gifts[e];if(t)if(t.isLimiteGift){var i=!0,n=t.oriCostGold[0],s=parseInt(t.actCostGold[1]);if("COPPER"==n?i=gR.ins.coin>=s:"GOLD"==n&&(i=gR.ins.YB>=s),-1<JP.A_BARGAIN_ID_ARR.indexOf(t.owerActivity)){if(ZP.isFrtRedPt){if(-1<mB.getInStance().getMainType(this.mainType).fActivityIds.indexOf(t.owerActivity))return!0}else if(ZP.bargainList)return ZP.bargainTabRedPt}else if(t.owerActivity==JP.A_ID_1177){if(1==t.status&&gR.ins.VIPLevel>=t.minVipLevel)return!0}else if(1==t.status&&i)return!0}else{if(-1<JP.A_PLANT_ID_ARR.indexOf(t.owerActivity))return-1<mB.getInStance().getMainType(this.mainType).fActivityIds.indexOf(t.owerActivity);if(t.isBossScore){if(JP.getIsRedPt(t))return!0}else if(t.isSoulMJ){if(JP.getIsRedPtSoul(t))return!0}else if(t.owerActivity==JP.A_ID_1051){if(1==t.sevenOpen&&1==t.status)return!0}else if("ACTIVITY_DAY_LOGIN"==t.targetType){if(1==t.status)return!0}else if(1==t.status&&gR.ins.YB>=t.costGold)return!0}}return!1},t.getGift=function(e){if(this.gifts)for(var t=0;t<this.gifts.length;++t){var i=this.gifts[t];if(i&&i.giftId==e)return i}return null},t.getTargetGift=function(e){if(2!=e.status)return e;for(var t=0;t<this.preSenGift.length;++t){var i=this.preSenGift[t];if(i.targetValue==e.giftId)return i}return e},p(0,t,"leftTime",function(){return this.serverVo.leftTime}),p(0,t,"btnLable",function(){switch(this.activityId){case 2101:case 2201:return RP.n[121];case 2102:case 2202:return RP.n[122];case 2103:case 2203:return RP.n[123];case 2104:case 2204:return RP.n[124];case 2105:case 2205:return RP.n[125];case 2106:case 2206:return RP.n[126];case 2107:case 2207:return RP.n[127];case 2108:case 2208:return RP.n[128];case 2109:case 2209:return RP.n[129];case 2110:case 2210:return RP.n[130];case 2111:case 2211:return RP.n[131]}return""}),p(0,t,"activityId",function(){return this.serverVo.activityId}),p(0,t,"starTime",function(){return this.serverVo.starTime}),p(0,t,"share",function(){return this.serverVo.share}),p(0,t,"exchangeList",function(){return this.serverVo.exchangeList}),p(0,t,"target",function(){return It.MODEL.target(this.index)}),p(0,t,"position",function(){return It.MODEL.position(this.index)}),p(0,t,"growth",function(){return this.serverVo.growth}),p(0,t,"type",function(){return this.serverVo.type}),p(0,t,"index",function(){return It.getIndex(this.activityId)}),p(0,t,"endTime",function(){return this.serverVo.endTime}),p(0,t,"refreshtime",function(){return this.serverVo.refreshtime}),p(0,t,"gifts",function(){return this.serverVo.gifts},function(e){this.serverVo.gifts=e.concat()}),p(0,t,"totalLevelStr",function(){return""}),p(0,t,"currentGift",function(){if(this.preferGift)return this.preferGift;this.preferGift=[],this.preSenGift=[];for(var e=0;e<this.gifts.length;++e){var t=this.gifts[e];0<t.targetValue?this.preSenGift.push(t):this.preferGift.push(t)}return this.preferGift}),p(0,t,"perBossKiller",function(){if(null!=this._perbossKiller)return this._perbossKiller;this._perbossKiller=[],this._serbossKiller=[];for(var e=0;e<this.gifts.length;++e){var t=this.gifts[e];18==t.type?this._serbossKiller.push(t):this._perbossKiller.push(t)}return this._perbossKiller}),p(0,t,"serBossKiller",function(){if(null!=this._serbossKiller)return this._serbossKiller;this._perbossKiller=[],this._serbossKiller=[];for(var e=0;e<this.gifts.length;++e){var t=this.gifts[e];18==t.type?this._serbossKiller.push(t):this._perbossKiller.push(t)}return this._serbossKiller}),p(0,t,"rank",function(){return this.serverVo.ranks}),p(0,t,"rankValue",function(){return this.serverVo.rankValue}),p(0,t,"rankLevel",function(){return this.serverVo.rankLevel}),p(0,t,"myRank",function(){return this.serverVo.myRank}),p(0,t,"myRankType",function(){return this.serverVo.rankType}),p(0,t,"rankName",function(){var e=Tt.getIndex(this.activityId);return Tt.MODEL.name(e)}),p(0,t,"rankLevelStr",function(){var e=Tt.getIndex(this.activityId);return Tt.MODEL.levelStr(e)}),p(0,t,"shopitemList",function(){return this.serverVo.shopitemList}),p(0,t,"mainType",function(){return It.MODEL.mainType(this.index)}),p(0,t,"secTitle",function(){return It.MODEL.secondtitleui(this.index)}),n.create=function(e,t){if(void 0===t&&(t=0),e){var i=new n;return i.setServerVo(e,t),i}return null},n}(),SH=function(t){function d(){var e=this;e.dayCount=0,e.levelCount=0,e.count=0,e.giftId=0,e.status=0,e.receiveTime=0,e.type=0,e.recharge=0,e.gifts=null,e.rechargeDays=0,e.perBuyNum=0,e.SerBuyNum=0,e.isLimiteGift=!1,e.currentNum=0,e.targetId=0,e.completeNum=0,e.owerName=RP.n[132],e.killTime=0,e.reliveTime=0,e.killerName=null,e.killList=null,e.soulObj=null,e.scoreObj=null,e.sevenTarget=0,e.sevenOpen=0,e.buyTimes=0,e.loginDay=0,e.updateTime=NaN,e._rewardGoods=null,e._oriCostGold=null,e._actCostGold=null,e._CostGoods=null,e.isPlayerAct=0,d.__super.call(e)}b(d,"protos.activity.GiftVo",t);var e=d.prototype;return e.decode=function(e){var t=this;t.giftId=e.readInt(),t.status=e.readByte();var i=e.readByte();-1<JP.A_GIFT_ID_ARR.indexOf(t.giftId)&&(JP.A_GIFT_ID_HASH.take(t.giftId)&&JP.A_GIFT_ID_HASH.remove(t.giftId),JP.A_GIFT_ID_HASH.put(t.giftId,{status:t.status}));for(var n=0;n<i;++n)if(t.type=e.readByte(),-1<d.TYPE_SEVERKH.indexOf(t.type))t.sevenTarget=yt.readLong64(e);else switch(t.type){case 17:var s=e.readInt();0<s&&(s=dr.curServerTime+1e3*s),t.reliveTime=s,t.killerName=e.readUTF();break;case 3:case 23:t.recharge=yt.readLong64(e);break;case 7:t.recharge=e.readInt(),t.rechargeDays=e.readInt(),t.updateTime=e.readInt();break;case 4:t.gifts=[];for(var o=e.readByte(),a=0;a<o;++a)t.gifts.push(e.readInt());break;case 12:case 9:case 27:case 28:case 30:case 32:case 61:t.currentNum=yt.readLong64(e);break;case 29:case 57:case 58:case 59:case 62:case 63:case 67:case 66:case 64:case 65:t.currentNum=e.readInt();break;case 10:case 14:case 15:case 13:case 11:case 16:t.currentNum=e.readInt();break;case 18:t.owerName=e.readUTF(),t.killTime=e.readInt(),""==t.owerName&&(t.owerName=RP.n[132]);break;case 25:t.killList=[];for(var r=e.readByte(),l=0;l<r;l++)t.killList.push(e.readInt());break;case 34:t.soulObj={},t.soulObj.enterTime=e.readByte(),t.soulObj.totalTime=e.readByte();break;case 33:t.scoreObj={},t.scoreObj.score=e.readInt();var c=e.readInt(),u=0;for(t.scoreObj.exchange=new jl,u=0;u<c;u++)t.scoreObj.exchange.put(e.readInt(),e.readInt());for(c=e.readInt(),t.scoreObj.limit=new jl,u=0;u<c;u++)t.scoreObj.limit.put(e.readInt(),e.readInt());break;case 55:t.sevenOpen=yt.readLong64(e);break;case 77:case 56:t.buyTimes=e.readInt();break;case 68:t.recharge=e.readInt(),t.rechargeDays=e.readInt();break;case 70:t.scoreObj={},t.scoreObj.uTimes=e.readInt();break;case 100:t.loginDay=e.readInt();break;case 73:t.count=e.readInt();break;case 75:t.dayCount=e.readInt();break;case 74:t.levelCount=e.readFloat()}t.receiveTime=e.readInt()},e.decode2=function(e,t){void 0===t&&(t=0),this.isLimiteGift=!0,this.giftId=e.readInt(),this.perBuyNum=e.readInt(),this.SerBuyNum=e.readInt(),this.status=e.readByte(),this.isPlayerAct=zi.MODEL.playerActivity(this.index)},e.update=function(e){},e.praseGoodsStr=function(e,t){if(e&&""!=e&&"0"!=e){var i=e.split(";");for(var n in i){var s=i[n].split(",");if(!s[2]||0==parseInt(s[2])||gR.ins.actorList[0].job==parseInt(s[2])){var o=yB.create(s[0],s[1]);o&&t.push(o)}}}},e.dispose=function(){var e=this;e._CostGoods&&(e._CostGoods.length=0,e._CostGoods=null),e._rewardGoods&&(e._rewardGoods.length=0,e._rewardGoods=null),e.gifts&&(e.gifts.length=0,e.gifts=null),t.prototype.dispose.call(e)},e.decodePlayer=function(e){this.isPlayerAct=1,this.giftId=e.readInt(),this.status=e.readByte();for(var t=e.readByte(),i=0;i<t;++i)switch(this.type=e.readByte(),this.type){case 0:this.recharge=yt.readLong64(e);break;case 1:case 2:this.currentNum=e.readByte();break;case 3:this.currentNum=e.readInt()}},p(0,e,"maxRechargeDay",function(){var e=St.MODEL.targetParam1(this.index);if(e){var t=e.split(",");return parseInt(t[1])}return 0}),p(0,e,"currentType",function(){switch(this.owerActivity){case 2101:return 1;case 2102:return 10;case 2103:return 11;case 2104:return 9;case 2105:return 12;case 2106:return 13;case 2107:return 14;case 2108:return 15;case 2109:return 16;case 2111:return 22}return 0}),p(0,e,"currentDes",function(){switch(this.owerActivity){case 2101:return RP.n[134];case 2102:return RP.n[135];case 2103:return RP.n[136];case 2104:return RP.n[137];case 2105:return"战力";case 2106:return RP.n[138];case 2107:return RP.n[139];case 2108:return RP.n[140];case 2109:return RP.n[141];case 2110:return RP.n[142];case 2111:return RP.n[143]}return""}),p(0,e,"index",function(){if(this.isLimiteGift)return zi.getIndex(this.giftId);if(1==this.isPlayerAct)return xn.getIndex(this.giftId);St.count,St.getIndex(this.giftId);return St.getIndex(this.giftId)}),p(0,e,"levelDec",function(){switch(this.owerActivity){case 2103:case 2104:case 2106:case 2102:case 2108:return Ql.createColor("级","#01fb01");case 2101:return Ql.createColor("转","#01fb01")}return""}),p(0,e,"goodsReward",function(){return this.isLimiteGift?zi.MODEL.goodsReward(this.index):1==this.isPlayerAct?xn.MODEL.goodsReward(this.index):St.MODEL.goodsReward(this.index)}),p(0,e,"actCostGold",function(){return this._actCostGold||(this._actCostGold=zi.MODEL.actCostGold(this.index).split(":")),this._actCostGold}),p(0,e,"targetType",function(){return 1==this.isPlayerAct?xn.MODEL.targetParamType1(this.index):St.MODEL.targetParamType1(this.index)}),p(0,e,"rewardGoods",function(){return this._rewardGoods||(this._rewardGoods=[],this.praseGoodsStr(this.goodsReward,this._rewardGoods)),this._rewardGoods}),p(0,e,"targetValue",function(){return 1==this.isPlayerAct?parseInt(xn.MODEL.targetParam1(this.index)):parseInt(St.MODEL.targetParam1(this.index))}),p(0,e,"costGoods",function(){if(!this._CostGoods){this._CostGoods=[];var e=St.MODEL.costGoodsMapStr(this.index);this.praseGoodsStr(e,this._CostGoods)}return this._CostGoods}),p(0,e,"rankTarget",function(){var e=St.MODEL.targetParam1(this.index);if(e){var t=e.split(",");return parseInt(t[0])}return 0}),p(0,e,"extParams",function(){return St.MODEL.extParams(this.index)}),p(0,e,"rankNums",function(){var e=[],t=St.MODEL.targetParam1(this.index);return t&&(e=t.split(",")),e}),p(0,e,"maxServerTime",function(){var e=St.MODEL.serverNumLimit(this.index);return 0<e?e:0}),p(0,e,"owerActivity",function(){return this.isLimiteGift?zi.MODEL.activityId(this.index):1==this.isPlayerAct?xn.MODEL.activityId(this.index):St.MODEL.activityId(this.index)}),p(0,e,"name",function(){return this.isLimiteGift?zi.MODEL.dec(this.index):St.MODEL.content(this.index)}),p(0,e,"minVipLevel",function(){return zi.MODEL.minVipLevel(this.index)}),p(0,e,"personalLimit",function(){return zi.MODEL.personalLimit(this.index)}),p(0,e,"oriCostGold",function(){return this._oriCostGold||(this._oriCostGold=zi.MODEL.oriCostGold(this.index).split(":")),this._oriCostGold}),p(0,e,"serverLimit",function(){return zi.MODEL.serverLimit(this.index)}),p(0,e,"costGold",function(){return 1==this.isPlayerAct?xn.MODEL.costGold(this.index):St.MODEL.costGold(this.index)}),p(0,e,"isBossScore",function(){return 33==this.type}),p(0,e,"isSoulMJ",function(){return 34==this.type}),p(0,e,"job",function(){return St.MODEL.role(this.index)}),p(0,e,"uiType",function(){return St.MODEL.type(this.index)}),d.TYPE_ZHUZAI=2,d.TYPE_RECHARGE=3,d.TYPE_GIFTS=4,d.TYPE_WANGCHENG=5,d.TYPE_RANK=6,d.TYPE_RECHARGEDAYS=7,d.TYPE_LOGINDAYS=8,d.TYPE_XUNZHANGS=11,d.TYPE_FIGHTS=12,d.TYPE_SHIELDS=13,d.TYPE_LEITINGEQUIPS=14,d.TYPE_MERIDIANS=15,d.TYPE_ZHUZAIFIGHT=16,d.TYPE_PRIVATEBOSS=17,d.TYPE_SERVERBOSS=18,d.TYPE_RANK_SOUL=19,d.TYPE_Ring=22,d.TYPE_GEMSTONES=10,d.TYPE_FLY=1,d.TYPE_LEVEL=20,d.TYPE_WINGS=9,d.TYPE_BAOSHI=27,d.TYPE_DRAGON_SOUL=28,d.TYPE_TUJIAN=30,d.TYPE_EQUIT_SCORE=32,d.TYPE_SOUL_GOAL=29,d.TYPE_PLUME=57,d.TYPE_ZS=58,d.TYPE_TANBAO=59,d.TYPE_EQUIT_GRADE=61,d.TYPE_YUAN=62,d.TYPE_GRADE_RANK=21,d.TYPE_UNIVERSAL_BOSS=25,d.TYPE_SOUL=34,d.TYPE_BOSS_SCORE=33,d.TYPE_PURCHASE=56,d.TYPE_COST=23,d.TYPE_SEVERKH_OPENDAY=55,d.TYPE_HEFU_BAOSHI=63,d.TYPE_HEFU_LUNHUI=64,d.TYPE_HEFU_TREASURE=65,d.TYPE_HEFU_LONGWEN=66,d.TYPE_HEFU_LOGIN=67,d.TYPE_HEFU_LIANCHONG=68,d.TYPE_SP_BAOZHU=70,d.TYPE_GONGCE_LOGIN=100,d.TYPE_JF_CELEBRETION=73,d.TYPE_CHAOZHI_DAY=75,d.TYPE_CHAOZHI_LEVEL=74,d.TYPE_DAILYGIFT=77,f(d,["TYPE_SEVERKH",function(){return this.TYPE_SEVERKH=[36,35,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,60]}]),d}($h),kH=function(e){function o(){var e=this;e.monsterId=0,e.hp=0,e.mp=0,e.att=0,e.wuDef=0,e.moDef=0,e.hpFac=0,e.mpFac=0,e.attRecRa=0,e.attRecFac=0,e.recover=0,e.rallyRa=0,e.rallyFac=0,e.dodgeRa=0,e.hitRa=0,e.numbRa=0,e.numbRedRa=0,e.redDefRa=0,e.redDefFac=0,e.redAttRa=0,e.redAttFac=0,e.critRa=0,e.critRedRa=0,e.critFac=0,e.critRedFac=0,e.critBos=0,e.fatalRa=0,e.fatalAdd=0,e.fatalAddFac=0,e.damFac=0,e.damRed=0,e.wuDamRed=0,e.moDamRed=0,e.damBosFac=0,e.damBosRed=0,e.mfdFac=0,e.expFac=0,e.goldFac=0,e.regeTrig=0,e.regeFac=0,e.regeAdd=0,e.limitDamTrig=0,e.limitDamFac=0,e.seckillTrig=0,e.seckillRa=0,e.blessRa=0,e.blessAmend=0,e.jiFengZhanRate=0,e.jiFengZhanAdd=0,e.damDecRa=0,e.trueDef=0,e.unionDamDecFac=0,o.__super.call(e)}return b(o,"protos.boss.DtoMonsterData",$h),o.takeMonsterModelProtoData=function(e){var t=o.MonsterProtoDataHash.take(e);if(!t){t=new o;var i,n=hn.getIndex(e);if(0<=n)if(i=aa.formatNewAttrToObject(hn.MODEL.attributes(n))){for(var s in i)t.hasOwnProperty(s)&&(t[s]=i[s]);return o.MonsterProtoDataHash.put(e,t),t}}return t},f(o,["MonsterProtoDataHash",function(){return this.MonsterProtoDataHash=new jl}]),o}(),EH=function(e){function n(){this.buff_id=0,this.groupId=0,this.remainTime=0,this.pauseTime=0,this.endTime=0,this.replace_type=0,this.priority=0,this.curSvrTime=0,n.__super.call(this)}b(n,"protos.buff.DtoBuff",e);var t=n.prototype;return t.decode=function(e){var t=this;t.buff_id=e.readShort(),t.groupId=e.readShort(),t.remainTime=e.readInt(),t.pauseTime=e.readInt(),t.endTime=e.readInt(),t.replace_type=e.readByte(),0<t.pauseTime&&(t.remainTime=t.endTime-t.pauseTime);var i=mi.getIndex(t.buff_id);t.priority=mi.MODEL.priority(i),t.curSvrTime=dr.curServerTime},t.dispose=function(){e.prototype.dispose.call(this),this.buff_id=0,this.groupId=0,this.remainTime=0,this.pauseTime=0,this.groupId=0,this.replace_type=0,this.curSvrTime=0},n.recover=function(e){null!=e&&(e.dispose(),n._pools.push(e))},n.create=function(e){var t;(t=0<n._pools.length?n._pools.pop():new n).buff_id=e;var i=mi.getIndex(e);return t.priority=mi.MODEL.priority(i),t.curSvrTime=dr.curServerTime,t},n._pools=[],n}($h),TH=function(e){function t(){var e=this;e.playerId=0,e.objectId=0,e.charType=0,e.char_id=0,e.professional=0,e.sex=0,e.mid="",e.wid="",e.wgid="",e.eid="",e.chuanshi="",e.magicId=null,e.modelId=0,e.currHP=0,e.maxHP=0,e.currMP=0,e.maxMP=0,e.isDog=!1,e.isHY=!1,e.isAdd=!1,e.accSpeed=1,e.guild_id=0,e.guideName="",e.guidePos=0,e.charName="",e.x=0,e.y=0,e.dir=4,e.paths=[],e.titles=[],e.campState=0,e.camp=0,e.speed=0,e.isNew=!1,e.goodsId=0,e.goodsNum=0,e.owner=!1,e.robot=0,e.hasYuanshen=0,e.souloutAdvanStep=0,e.souloutSkin=0,e.masterObjectId=0,e.govPosition=0,e.flyupLevel=0,e.petStatus=0,e.petIndex=0,e.petColor=0,e.petStar=0,e.defaultMid="",e.defaultWid="",e.defaultWgid="",e.dragonEff="",e.building1="",e.building2="",e.fxid=0,t.__super.call(e)}b(t,"protos.scene.DtoCharData",$h);var i=t.prototype;return i.decodeChar=function(e){var t=this;t.char_id=yt.readLong64(e),t.objectId=yt.readLong64(e),t.charName=e.readUTF(),t.guild_id=yt.readLong64(e),t.guideName=e.readUTF(),t.guidePos=e.readInt(),t.professional=e.readByte(),t.sex=e.readByte(),t.mid=e.readUTF(),t.wid=e.readUTF(),t.wgid=e.readUTF(),""==t.wid&&(t.wid="null"),""==t.wgid&&(t.wgid="null"),t.eid=e.readUTF(),t.chuanshi=e.readUTF(),0<e.bytesAvailable&&(t.dragonEff=e.readUTF()),t.magicId=e.readUTF(),t.defaultMid=e.readUTF(),t.defaultWid=e.readUTF(),t.defaultWgid=e.readUTF();var i=JB.ins.getPlatformByEffect(t.mid);JB.ins.canPlatformUseByID(i)||(t.mid=t.defaultMid),i=JB.ins.getPlatformByEffect(t.wid),JB.ins.canPlatformUseByID(i)||(t.wid=t.defaultWid),i=JB.ins.getPlatformByEffect(t.wgid),JB.ins.canPlatformUseByID(i)||(t.wgid=t.defaultWgid),t.titles=[];for(var n=e.readByte(),s=0;s<n;s++){var o=e.readShort(),a=co.getIndex(o);i=co.MODEL.pidStr(a),tg.ins.canPlatformUseByID(i)&&t.titles.push(o)}t.dir=e.readByte(),t.x=e.readShort(),t.y=e.readShort(),t.paths=[];for(var r=e.readByte(),l=0;l<r;l++){var c=e.readShort(),u=e.readShort();t.paths.push(new Uh(c,u))}if(t.currHP=e.readInt(),t.maxHP=e.readInt(),t.camp=e.readByte(),t.campState=e.readByte(),t.robot=e.readByte(),t.modelId=yt.readLong64(e),t.fxid=e.readInt(),t.fxid<0){var d=ZB.ins.getwfxbyid(t.fxid);d&&(t.charName=d.name)}return t.hasYuanshen=e.readByte(),t.souloutAdvanStep=e.readInt(),t.souloutSkin=e.readInt(),t.govPosition=e.readShort(),0<e.bytesAvailable&&(t.flyupLevel=e.readInt()),t},i.createCharDto=function(e){var t=this,i=JSON.parse(e.avatars);t.professional=e.roleTypeId,t.sex=e.genderId,t.mid=i.avatar,t.wid=i.weapon,t.wgid=i.wing,t.eid="0",t.chuanshi="0",t.dragonEff="0",t.x=NF.mainChar.x+3,t.y=NF.mainChar.y+3,t.dir=NF.mainChar.dir;for(var n=JSON.parse(e.attributes),s=0;s<n.length;s++)"MAXHP"==n[s].type&&(t.currHP=n[s].value,t.maxHP=n[s].value);t.robot=1,t.modelId=e.robotRoleId;var o=Jt.getIndex(t.modelId),a=Jt.MODEL.attributes(o);return uH.setMonsetAttributes(t.modelId,a),t},t}(),CH=function(e){function t(){this.awardsList=null,t.__super.call(this)}return b(t,"protos.scene.DtoEproAwards",$h),t.prototype.decode=function(e){this.awardsList=[];for(var t=e.readShort(),i=0,n=0,s=0;s<t;s++)i=e.readInt(),n=e.readInt(),-1!=aR.changeToGoodsId(i)&&this.awardsList.push({modelId:aR.changeToGoodsId(i),count:n})},t}(),LH=function(e){function o(){this._birthPt_=null,this._birthPoint_=null,this._isQuote_=!1,this._owner=null,this._key=null,this.index=0,o.__super.call(this)}b(o,"protos.scene.DtoSceneRobotData",$h);var t=o.prototype;return t.setup=function(e){this._birthPt_=e,this._birthPoint_=PB.tileToPixels(e),this._key=e.x+"|"+e.y},p(0,t,"key",function(){return this._key}),p(0,t,"owner",function(){return this._owner},function(e){this._owner=e,this._isQuote_=!!e}),p(0,t,"isQuote",function(){return this._isQuote_},function(e){this._isQuote_=e}),p(0,t,"birthPt",function(){return this._birthPt_}),p(0,t,"birthPoint",function(){return this._birthPoint_}),o.GetNew=function(){return o._RobotDatasPool_.length?o._RobotDatasPool_.shift():new o},o.unbeanChar=function(e){e&&e.dto&&o.robotDataHash.remove(e.dto.key)},o.beanChar=function(e,t){var i=o.getFreeRobotData(t);return i&&(i.owner=e),i},o.getFreeRobotData=function(e){if(null!=e)for(var t in o.robotDataHash.proto){var i=o.robotDataHash.proto[t];if(i&&0==i.isQuote&&i._birthPt_.x==e.x&&i._birthPt_.y==e.y)return i}for(var n in o.robotDataHash.proto){var s=o.robotDataHash.proto[n];if(s&&0==s.isQuote)return s}return null},o.createRobotData=function(e,t){var i=o.GetNew();return i.index=t,i.setup(e),o.robotDataHash.put(i.key,i),i},o.clear=function(){for(var e in o.robotDataHash.proto){var t=o.robotDataHash.proto[e];t._birthPoint_=null,t._birthPt_=null,t._key=null,t.owner=null,o._RobotDatasPool_.push(t)}o.robotDataHash.reset()},o.hasFreeRobotData=function(){for(var e in o.robotDataHash.proto){var t=o.robotDataHash.proto[e];if(t&&0==t.isQuote)return!0}return!1},o.setupRobotDatas=function(e){o.clear();for(var t=0;t<e.length;t++){var i=e[t];o.createRobotData(i,t)}},o._RobotDatasPool_=[],f(o,["points",function(){return this.points=[[new Uh(1733,1119),new Uh(1659,1250),new Uh(1621,1142),new Uh(1632,1082),new Uh(1802,1137),new Uh(1702,1291),new Uh(1530,1104)],[new Uh(1851,1118),new Uh(1993,1150),new Uh(1904,1177),new Uh(1840,1174),new Uh(1904,1104),new Uh(2040,1128),new Uh(1859,1229)],[new Uh(1900,1063),new Uh(1960,985),new Uh(1997,1055),new Uh(2026,1091),new Uh(1868,1043),new Uh(1918,963),new Uh(2068,1077)],[new Uh(1795,1053),new Uh(1661,996),new Uh(1756,982),new Uh(1825,984),new Uh(1751,1062),new Uh(1608,1004),new Uh(1828,940)]]},"robotDataHash",function(){return this.robotDataHash=new jl}]),o}(),MH=function(e){function t(){var e=this;e.buff_id=0,e.duration=1,e.startTime=0,e.char_id=null,e.hurtTime=0,e.hurtDurTime=1500,e.type=0,e.attacker=null,e.skillId=0,t.__super.call(e),e.startTime=BB.getTimer(),e.hurtTime=BB.getTimer()}return b(t,"protos.scene.DtoSkillBuffData",$h),t}(),AH=function(e){function d(){var e=this;e.isMeWin=!1,e.isMeAttack=!1,e.isBoss=!1,e.bossData=null,e.items=[],e.result=0,e.attackers=[],e.attacker_id=0,e.attackerName=null,e.attackerGuidName=null,e.attackerAttackValue=0,e.attackerIsLive=1,e.defenders=[],e.defenders_id=0,e.defenderName=null,e.defenderGuidName=null,e.defenderAttackValue=0,e.defenderIsLive=1,e.roundQueueData=[],e.attackIsMe=0,e.startTime=NaN,e.timeNum=0,e.herosHPs=[],e.resultHash=new jl,d.__super.call(e)}b(d,"protos.scene.DtoZhanBao",$h);var t=d.prototype;return t.decode=function(e){var t=this,i=[];t.attackers.length=0,t.defenders.length=0,t.roundQueueData.length=0,t.result=e.readByte(),t.attacker_id=yt.readLong64(e),t.attackerName=e.readUTF(),t.attackerGuidName=e.readUTF(),t.attackerAttackValue=yt.readLong64(e),t.attackerIsLive,e.readByte(),t.attacker_id.toString()==gR.ins.charId&&(t.attackIsMe=1);for(var n,s=e.readByte(),o=0;o<s;o++){var a=e.readByte();1==a?n=d.decodeChar(e,t.attacker_id):2==a?(n=d.decodeMonster(e,t.attacker_id),t.isBoss=!0,t.bossData=n):3==a&&(n=d.decodePet(e,t.attacker_id)),n.charType=a,n.charName=t.attackerName,""!=t.attackerGuidName&&(n.guideName=t.attackerGuidName),t.resultHash.put(n.char_id,{char_id:n.char_id,currMP:n.currMP,maxMp:n.currMP,currHP:n.currHP,maxHp:n.currHP,playerId:n.playerId,pro:n.professional},!0),t.attackers.push(n),t.attackIsMe&&i.push(n.char_id)}t.defenders_id=yt.readLong64(e),t.defenderName=e.readUTF(),t.defenderGuidName=e.readUTF(),t.defenderAttackValue=yt.readLong64(e),t.defenderIsLive,e.readByte(),s=e.readByte();for(var r=0;r<s;r++)1==(a=e.readByte())?n=d.decodeChar(e,t.defenders_id):2==a?(n=d.decodeMonster(e,t.defenders_id),t.isBoss=!0,t.bossData=n):3==a&&(n=d.decodePet(e,t.defenders_id)),n.charType=a,n.charName=t.defenderName,""!=t.defenderGuidName&&(n.guideName=t.defenderGuidName),t.defenders.push(n),0==t.attackIsMe&&i.push(n.char_id),t.resultHash.put(n.char_id,{char_id:n.char_id,currHP:n.currHP,maxHp:n.currHP,playerId:n.playerId,pro:n.professional},!0);t.roundQueueData=d.decodeZhanBaoBody(e,t.resultHash),t.items=d.pickupItems(e),t.attacker_id.toString()==gR.ins.charId?(t.isMeAttack=!0,1==t.result&&(t.isMeWin=!0)):t.defenders_id.toString()==gR.ins.charId&&2==t.result&&(t.isMeWin=!0),t.timeNum=200*t.timeNum+1500,t.startTime=dr.curServerTime;for(var l=0;l<i.length;l++){var c=t.resultHash.take(i[l]);t.herosHPs.push({char_id:i[l],hp:c.currHP,maxHP:c.maxHp,mp:c.currMP,maxMP:c.maxMp})}},t.isWin=function(e){return this.attacker_id==e&&1==this.result||this.defenders_id==e&&2==this.result},d.decodeZhanBaoBody=function(e,t){for(var i,n=[],s=e.readInt(),o=[],a=0;a<s;a++){var r=e.readShort(),l=e.readByte();if(1==l){var c=new iF;c.actType=l,c.nextGroundTime=r,c.decode(e,t),n.push(c),0<a&&o.push(c.nextGroundTime)}else(i=new iF).actType=l,i.nextGroundTime=r,2==l?i.att.push(d.DHurt(e,t,i)):3==l?i.buff.push(d.DBuff(e,i)):4==l&&i.hyArray.push(d.DHuanYing(e,i)),n.push(i),0<a&&o.push(i.nextGroundTime)}for(var u=0;u<o.length;u++)(i=n[u+1]).nextGroundTime=o[u];return n},d.DHurt=function(e,t,i){var n=e.readShort(),s=e.readByte(),o=e.readShort(),a=e.readByte(),r=e.readInt(),l=e.readInt(),c=e.readInt();if(t){var u=t.take(o);u&&(u.currHP=l,u.currMP=c)}return i&&(i.attacker=o),[o,a,r,l,c,n,s]},d.DBuff=function(e,t){var i=e.readByte();2==i&&(i=0);var n=e.readShort(),s=e.readShort();return t&&(t.attacker=n),[n,i,s]},d.DHuanYing=function(e,t){var i=e.readByte(),n=e.readShort(),s=yt.readLong64(e),o=e.readByte(),a=new TH;return a.playerId=s,a.char_id=n,a.currHP=1e4,a.currMP=1e4,a.professional=o,a.isAdd=1==i,t&&(t.attacker=n),a},d.pickupItems=function(e){for(var t=[],i=e.readByte(),n=0;n<i;n++){var s=e.readInt(),o=e.readInt();t.push({itemId:s,itemNum:o})}return t},d.decodeChar=function(e,t){void 0===t&&(t=0);var i=new TH;i.char_id=e.readShort(),i.professional=e.readByte(),i.sex=e.readByte(),i.mid=e.readUTF(),i.wid=e.readUTF(),i.wgid=e.readUTF(),i.eid=e.readUTF(),i.chuanshi=e.readUTF();for(var n=[],s=e.readByte(),o=0;o<s;o++)n.push(e.readShort());return i.titles=n,i.maxHP=e.readInt(),i.currHP=e.readInt(),i.currMP=e.readInt(),i.accSpeed=e.readInt(),i.accSpeed=i.accSpeed/1e4,i.maxMP=i.currMP,i.playerId=t,i},d.decodeMonster=function(e,t){void 0===t&&(t=0);var i=new TH;return i.char_id=e.readShort(),i.modelId=e.readInt(),i.currHP=e.readInt(),i.maxHP=e.readInt(),i.currMP=1,i.maxMP=i.currMP,i.playerId=t,i},d.decodePet=function(e,t){void 0===t&&(t=0);var i=new TH;return i.char_id=e.readShort(),i.modelId=e.readInt(),i.currHP=e.readInt(),i.maxHP=e.readInt(),i.mid=d.getMonsterAvatarId(i.modelId),i.currMP=1,i.maxMP=i.currMP,i.isDog=!0,i.playerId=t,i},d.decodeHY=function(e,t){void 0===t&&(t=0);var i=new TH;return i.char_id=e.readShort(),i.modelId=e.readInt(),i.professional=e.readByte(),i.mid=d.getMonsterAvatarId(i.modelId),i.currHP=i.currMP=i.maxMP=i.maxHP=1e5,i.playerId=t,i},d.getMonsterAvatarId=function(e){var t=hn.getIndex(e),i=hn.MODEL.muId(t);return i=_n.getIndex(i),_n.MODEL.avatarId(i)},d}(),DH=function(e){function s(){var e=this;e.miji_index=0,e.miji_id=0,e.cur_lvl=0,e.cur_desc=null,e.next_desc=null,e.type=0,e.attPower=0,e.group=0,e.cost=null,e.maxLv=0,e.isLock=0,e.isOpen=0,s.__super.call(e)}b(s,"protos.skill.DtoMiji",e);var t=s.prototype;return t.decode=function(e){this.miji_index=e.readByte(),this.miji_id=e.readInt(),this.isLock=e.readByte(),this.isOpen=e.readByte(),this.setMijiInfo()},t.setMijiInfo=function(){var e=0;if(0<this.miji_id){for(var t=0;t<Xs.count;t++)Xs.MODEL.goodsId(t)==this.miji_id&&(e=t);this.type=Xs.MODEL.type(e),this.cur_lvl=Xs.MODEL.mijiLevel(e);var i=Xs.MODEL.attrs(e);this.attPower=i?Xs.MODEL.fighting(e)+Math.ceil(RR.getFight(i,-1,0,!1)):Xs.MODEL.fighting(e)}},t.dispose=function(){e.prototype.dispose.call(this),this.miji_id=0,this.cur_lvl=0,this.miji_index=0},s.recover=function(e){null!=e&&(e.dispose(),s._pools.push(e))},s.create=function(e,t,i){var n;return(n=0<s._pools.length?s._pools.pop():new s).miji_id=e,n.cur_lvl=t,n.miji_index=i,n},s._pools=[],s}($h),OH=function(e){function t(){t.__super.call(this)}return b(t,"protos.SocketUtils",$h),t.setup=function(){t.p.put("22612",SS),t.p.put("22611",SG),t.p.put("10309",KI),t.p.put("10306",ZI),t.p.put("10109",mG),t.p.put("10302",QI),t.p.put("10304",JI),t.p.put("10301",AV),t.p.put("22601",bG),t.p.put("22602",bS),t.p.put("22603",wG),t.p.put("22604",wS),t.p.put("22606",xG),t.p.put("22610",xS),t.p.put("22613",kG),t.p.put("22614",kS),t.p.put("10310",$I),t.p.put("22616",ES),t.p.put("10311",eb),t.p.put("22618",CS),t.p.put("22620",LS),t.p.put("30005",CV),t.p.put("10312",tb),t.p.put("10313",ib),t.p.put("10314",nb),t.p.put("22617",TS),t.p.put("22153",iS),t.p.put("22154",nS),t.p.put("30462",ST),t.p.put("30465",kT),t.p.put("21203",rx),t.p.put("21205",lx),t.p.put("21207",cx),t.p.put("21214",ux),t.p.put("21215",VV),t.p.put("23614",GV),t.p.put("21219",dx),t.p.put("10102",HI),t.p.put("10104",VI),t.p.put("10106",GI),t.p.put("10110",UI),t.p.put("10114",qI),t.p.put("10117",jI),t.p.put("10118",WI),t.p.put("13602",Kw),t.p.put("10201",yG),t.p.put("10204",hV),t.p.put("10205",_V),t.p.put("10206",fV),t.p.put("10207",pV),t.p.put("10208",XI),t.p.put("10210",gV),t.p.put("10212",vV),t.p.put("21125",IG),t.p.put("10121",ae),t.p.put("10401",xV),t.p.put("10402",SV),t.p.put("10403",sb),t.p.put("10408",ob),t.p.put("23621",Pe),t.p.put("10413",Re),t.p.put("10415",ab),t.p.put("10416",rb),t.p.put("10417",lb),t.p.put("10422",Ne),t.p.put("30652",KT),t.p.put("11803",Vb),t.p.put("11805",Gb),t.p.put("11203",Tb),t.p.put("11205",Cb),t.p.put("11207",nG),t.p.put("11211",Lb),t.p.put("11212",Mb),t.p.put("11402",eV),t.p.put("11403",tV),t.p.put("11406",Nb),t.p.put("13301",zw),t.p.put("13303",Xw),t.p.put("11806",Ub),t.p.put("10501",ub),t.p.put("10502",db),t.p.put("10504",hb),t.p.put("24043",hf),t.p.put("21403",PG),t.p.put("21404",RG),t.p.put("21406",NG),t.p.put("21408",Fx),t.p.put("21409",BG),t.p.put("21413",Ru),t.p.put("12902",cw),t.p.put("12904",uw),t.p.put("12906",dw),t.p.put("12908",zV),t.p.put("12910",hw),t.p.put("12912",_w),t.p.put("12914",fw),t.p.put("12918",pw),t.p.put("12921",gw),t.p.put("12924",vw),t.p.put("12930",mw),t.p.put("12934",yw),t.p.put("12936",Iw),t.p.put("12938",bw),t.p.put("12941",ww),t.p.put("12943",xw),t.p.put("12945",Sw),t.p.put("12947",kw),t.p.put("12949",XV),t.p.put("12952",Ew),t.p.put("12954",Tw),t.p.put("12956",QV),t.p.put("12961",JV),t.p.put("12963",Cw),t.p.put("12965",ZV),t.p.put("12967",Lw),t.p.put("12970",Mw),t.p.put("12972",Aw),t.p.put("12974",Dw),t.p.put("12976",Ow),t.p.put("12978",Pw),t.p.put("12982",Rw),t.p.put("12983",Hl),t.p.put("12984",Vl),t.p.put("23337",Ck),t.p.put("23344",Ak),t.p.put("21209",kV),t.p.put("21210",EV),t.p.put("22106",$x),t.p.put("21220",hx),t.p.put("21221",_x),t.p.put("22151",eS),t.p.put("22152",tS),t.p.put("21233",TV),t.p.put("21236",mx),t.p.put("21263",Tx),t.p.put("21264",Cx),t.p.put("24046",yE),t.p.put("24047",IE),t.p.put("24048",bE),t.p.put("21259",kx),t.p.put("22623",DS),t.p.put("21261",Ex),t.p.put("21232",vx),t.p.put("24044",vE),t.p.put("21702",Yx),t.p.put("21707",zx),t.p.put("21709",Xx),t.p.put("21711",UG),t.p.put("21712",Qx),t.p.put("21713",FG),t.p.put("11901",Fb),t.p.put("11905",GG),t.p.put("10902",mb),t.p.put("10905",yb),t.p.put("10907",Ib),t.p.put("10909",bb),t.p.put("12234",nw),t.p.put("21241",yx),t.p.put("21243",Ix),t.p.put("21245",bx),t.p.put("21246",xx),t.p.put("21247",Sx),t.p.put("10601",_b),t.p.put("10602",DV),t.p.put("10604",OV),t.p.put("10605",PV),t.p.put("21106",mV),t.p.put("21109",yV),t.p.put("21110",IV),t.p.put("21115",sx),t.p.put("21117",ox),t.p.put("21120",ax),t.p.put("11003",wb),t.p.put("11004",xb),t.p.put("11005",VG),t.p.put("12202",iV),t.p.put("12204",nV),t.p.put("12206",sV),t.p.put("12208",oV),t.p.put("12210",Wb),t.p.put("12001",qb),t.p.put("12222",Kb),t.p.put("12224",$b),t.p.put("12226",ew),t.p.put("12216",Xb),t.p.put("12218",Qb),t.p.put("12219",Jb),t.p.put("12220",Zb),t.p.put("10702",fb),t.p.put("10802",pb),t.p.put("10806",qV),t.p.put("10807",gb),t.p.put("10808",vb),t.p.put("21302",Rx),t.p.put("21305",Nx),t.p.put("21308",Bx),t.p.put("21311",Hx),t.p.put("21313",Vx),t.p.put("21315",Gx),t.p.put("21316",Ux),t.p.put("13001",Fw),t.p.put("13002",qw),t.p.put("13003",jw),t.p.put("13005",Ww),t.p.put("13028",Yw),t.p.put("22305",_S),t.p.put("11106",Sb),t.p.put("11107",kb),t.p.put("11108",Eb),t.p.put("30322",Cg),t.p.put("30324",Lg),t.p.put("30326",Tg),t.p.put("30328",Mg),t.p.put("11302",oG),t.p.put("11305",Ab),t.p.put("21505",qx),t.p.put("21602",jx),t.p.put("21604",Wx),t.p.put("30491",CT),t.p.put("30493",LT),t.p.put("30495",MT),t.p.put("30496",AT),t.p.put("13501",qG),t.p.put("13502",Qw),t.p.put("13504",Jw),t.p.put("13507",Zw),t.p.put("11502",Bb),t.p.put("11504",Hb),t.p.put("21901",LV),t.p.put("21902",Jx),t.p.put("21904",Zx),t.p.put("21906",MV),t.p.put("22002",aG),t.p.put("22007",rG),t.p.put("22202",sS),t.p.put("22204",FV),t.p.put("22205",oS),t.p.put("22210",aS),t.p.put("22214",rS),t.p.put("22217",lS),t.p.put("22220",cS),t.p.put("22221",uS),t.p.put("22222",dS),t.p.put("22402",vS),t.p.put("22404",mS),t.p.put("14001",jG),t.p.put("14003",$w),t.p.put("14006",ex),t.p.put("14008",tx),t.p.put("14009",ix),t.p.put("14010",nx),t.p.put("22502",WG),t.p.put("22504",YG),t.p.put("22507",zG),t.p.put("22702",OS),t.p.put("22707",PS),t.p.put("22709",RS),t.p.put("22303",hS),t.p.put("22363",gS),t.p.put("22352",fS),t.p.put("22357",pS),t.p.put("23004",VS),t.p.put("23005",GS),t.p.put("23006",US),t.p.put("23008",FS),t.p.put("23009",qS),t.p.put("22802",lG),t.p.put("22806",cG),t.p.put("23102",XG),t.p.put("23103",jS),t.p.put("23106",QG),t.p.put("23110",JG),t.p.put("23112",WS),t.p.put("23114",YS),t.p.put("23122",ZS),t.p.put("23117",zS),t.p.put("23118",XS),t.p.put("23120",QS),t.p.put("23121",JS),t.p.put("23123",KS),t.p.put("23125",ZG),t.p.put("23302",sk),t.p.put("23305",ok),t.p.put("23306",ak),t.p.put("23308",rk),t.p.put("23309",lk),t.p.put("23310",ck),t.p.put("23311",uk),t.p.put("23312",dk),t.p.put("23313",hk),t.p.put("23314",_k),t.p.put("23315",fk),t.p.put("23316",pk),t.p.put("23317",gk),t.p.put("23319",vk),t.p.put("23320",mk),t.p.put("23322",yk),t.p.put("23324",Ik),t.p.put("23325",bk),t.p.put("10112",FI),t.p.put("24042",gE),t.p.put("23327",xk),t.p.put("23329",Sk),t.p.put("23326",wk),t.p.put("23335",Ek),t.p.put("23336",Tk),t.p.put("23331",kk),t.p.put("12986",Nw),t.p.put("23338",Lk),t.p.put("23341",Mk),t.p.put("12212",Yb),t.p.put("12214",zb),t.p.put("23601",Dk),t.p.put("23602",Ok),t.p.put("23611",hs),t.p.put("23701",Rk),t.p.put("21006",yl),t.p.put("21007",El),t.p.put("21009",bl),t.p.put("21011",Il),t.p.put("21013",wl),t.p.put("21714",Tl),t.p.put("23221",$S),t.p.put("23223",ek),t.p.put("23224",tk),t.p.put("23226",ik),t.p.put("23227",nk),t.p.put("23711",ce),t.p.put("23712",le),t.p.put("25000",SE),t.p.put("24000",Yk),t.p.put("24001",zk),t.p.put("24002",Xk),t.p.put("24003",Qk),t.p.put("24004",Jk),t.p.put("24006",Zk),t.p.put("24011",_G),t.p.put("24020",oE),t.p.put("24016",tE),t.p.put("24017",iE),t.p.put("24018",nE),t.p.put("24019",sE),t.p.put("24021",aE),t.p.put("24022",rE),t.p.put("24026",lE),t.p.put("24027",fG),t.p.put("24028",pG),t.p.put("30004",vG),t.p.put("24030",cE),t.p.put("24007",Kk),t.p.put("24031",uE),t.p.put("24029",gG),t.p.put("24038",pE),t.p.put("30023",Yh),t.p.put("30024",Xh),t.p.put("23752",qk),t.p.put("23754",jk),t.p.put("23750",Fk),t.p.put("23756",Wk),t.p.put("22509",yS),t.p.put("22511",IS),t.p.put("30151",JE),t.p.put("30153",ZE),t.p.put("30155",KE),t.p.put("30102",FE),t.p.put("30104",qE),t.p.put("30106",jE),t.p.put("30010",GE),t.p.put("30011",UE),t.p.put("30202",ku),t.p.put("30252",iT),t.p.put("30253",nT),t.p.put("30255",sT),t.p.put("30257",oT),t.p.put("30259",aT),t.p.put("30330",rT),t.p.put("30331",lT),t.p.put("30333",cT),t.p.put("21225",fx),t.p.put("22621",MS),t.p.put("22622",AS),t.p.put("21227",px),t.p.put("23720",Vp),t.p.put("23722",Hp),t.p.put("30302",WV),t.p.put("30340",uT),t.p.put("30350",_T),t.p.put("30342",dT),t.p.put("30352",fT),t.p.put("30343",hT),t.p.put("30353",pT),t.p.put("23703",Nk),t.p.put("23724",Bk),t.p.put("23725",Hk),t.p.put("30360",gT),t.p.put("30121",WE),t.p.put("30123",YE),t.p.put("24013",$k),t.p.put("24014",eE),t.p.put("24033",dE),t.p.put("23771",jr),t.p.put("23770",qr),t.p.put("30392",Yf),t.p.put("31010",HG),t.p.put("24040",ep),t.p.put("30370",vT),t.p.put("30371",mT),t.p.put("30372",yT),t.p.put("214",EG),t.p.put("30375",IT),t.p.put("30414",bT),t.p.put("30400",at),t.p.put("30402",rt),t.p.put("30401",lt),t.p.put("24035",_E),t.p.put("24037",fE),t.p.put("30452",xT),t.p.put("30453",dG),t.p.put("24045",mE),t.p.put("12003",jb),t.p.put("30161",$E),t.p.put("30163",eT),t.p.put("30165",tT),t.p.put("30468",Xa),t.p.put("30473",za),t.p.put("30476",jV),t.p.put("30477",Ya),t.p.put("30481",ET),t.p.put("30483",TT),t.p.put("24049",wE),t.p.put("10119",YI),t.p.put("31011",UC),t.p.put("30131",zE),t.p.put("30133",XE),t.p.put("30134",QE),t.p.put("30726",fC),t.p.put("12231",iw),t.p.put("39009",nL),t.p.put("39011",sL),t.p.put("39013",oL),t.p.put("31061",zC),t.p.put("30601",DT),t.p.put("30602",OT),t.p.put("22016",Kx),t.p.put("25003",EE),t.p.put("25001",kE),t.p.put("31021",wV),t.p.put("30631",FT),t.p.put("30633",qT),t.p.put("30635",jT),t.p.put("30636",WT),t.p.put("30637",YT),t.p.put("30638",zT),t.p.put("30641",XT),t.p.put("30643",QT),t.p.put("30646",JT),t.p.put("30649",ZT),t.p.put("30653",$T),t.p.put("31023",dV),t.p.put("10507",_e),t.p.put("23713",uV),t.p.put("23714",cV),t.p.put("31024",FC),t.p.put("31025",qC),t.p.put("31026",jC),t.p.put("30611",PT),t.p.put("30615",NT),t.p.put("30619",HT),t.p.put("30617",BT),t.p.put("23731",Vk),t.p.put("23732",Gk),t.p.put("23733",Uk),t.p.put("30613",RT),t.p.put("21250",sg),t.p.put("21252",og),t.p.put("24050",cg),t.p.put("24051",ug),t.p.put("24052",dg),t.p.put("21254",ag),t.p.put("21255",rg),t.p.put("21258",lg),t.p.put("23730",Zu),t.p.put("23727",sG),t.p.put("30314",PP),t.p.put("12989",Bw),t.p.put("12991",Hw),t.p.put("12993",Vw),t.p.put("12994",Gw),t.p.put("12995",Uw),t.p.put("24010",hG),t.p.put("24053",xE),t.p.put("30662",eC),t.p.put("31031",Fc),t.p.put("31032",Uc),t.p.put("31033",Gc),t.p.put("21269",Mx),t.p.put("21268",Lx),t.p.put("25004",TE),t.p.put("25005",CE),t.p.put("30681",RV),t.p.put("30702",rC),t.p.put("30704",lC),t.p.put("30705",cC),t.p.put("30708",NV),t.p.put("30710",uC),t.p.put("30712",dC),t.p.put("30684",sC),t.p.put("30714",BV),t.p.put("30716",HV),t.p.put("30686",oC),t.p.put("30687",aC),t.p.put("25006",LE),t.p.put("21230",gx),t.p.put("30721",hC),t.p.put("30722",_C),t.p.put("30667",tC),t.p.put("30668",iC),t.p.put("12229",tw),t.p.put("12235",sw),t.p.put("30732",w),t.p.put("30623",VT),t.p.put("30625",GT),t.p.put("31042",uG),t.p.put("10122",zI),t.p.put("21272",Dx),t.p.put("21271",Ax),t.p.put("25007",ME),t.p.put("25008",AE),t.p.put("21273",Ox),t.p.put("24034",hE),t.p.put("30742",UV),t.p.put("25009",DE),t.p.put("25010",bV),t.p.put("25011",OE),t.p.put("25012",PE),t.p.put("25013",RE),t.p.put("25014",NE),t.p.put("30744",pC),t.p.put("12237",ow),t.p.put("30801",xC),t.p.put("30805",SC),t.p.put("30807",kC),t.p.put("30808",EC),t.p.put("11308",Db),t.p.put("11310",Ob),t.p.put("11312",Pb),t.p.put("11314",Rb),t.p.put("12239",aw),t.p.put("30627",UT),t.p.put("30787",wC),t.p.put("10425",cb),t.p.put("10424",TG),t.p.put("30789",CG),t.p.put("30776",mC),t.p.put("30670",iG),t.p.put("30672",nC),t.p.put("30771",gC),t.p.put("30773",vC),t.p.put("30768",$V),t.p.put("30774",eG),t.p.put("30822",LG),t.p.put("30824",MG),t.p.put("30826",DG),t.p.put("30827",OG),t.p.put("30781",yC),t.p.put("30783",IC),t.p.put("30784",tG),t.p.put("30785",bC),t.p.put("31051",WC),t.p.put("31054",YC),t.p.put("25016",KV),t.p.put("25017",BE),t.p.put("30846",TC),t.p.put("30847",CC),t.p.put("30848",LC),t.p.put("30849",MC),t.p.put("30857",oh),t.p.put("30859",sh),t.p.put("30861",ah),t.p.put("30862",rh),t.p.put("22711",NS),t.p.put("22713",BS),t.p.put("30904",PC),t.p.put("30905",aV),t.p.put("30907",rV),t.p.put("30909",lV),t.p.put("30952",RC),t.p.put("30954",NC),t.p.put("12247",rw),t.p.put("23622",Pk),t.p.put("12248",lw),t.p.put("25018",Iu),t.p.put("30877",AC),t.p.put("30879",DC),t.p.put("30880",OC),t.p.put("21276",Px),t.p.put("22715",HS),t.p.put("30972",BC),t.p.put("30978",VC),t.p.put("25019",HE),t.p.put("30977",HC),t.p.put("30418",wT),t.p.put("34007",QC),t.p.put("39015",aL),t.p.put("39017",rL),t.p.put("34016",JC),t.p.put("34018",ZC),t.p.put("30007",VE),t.p.put("36002",$C),t.p.put("30980",GC),t.p.put("36003",eL),t.p.put("36012",tL),t.p.put("33017",XC),t.p.put("36020",iL),t.p.put("34020",KC)},t.readBit=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=4);for(var n=0,s=0;s<i;s++)n|=1<<s;return(e>>=t)&n},t.read24=function(e){return e.readByte()<<16|e.readUnsignedShort()},t.writeArray=function(e,t,i,n){for(var s=0;s<i;s++)n.call(e,t[s])},t.readArray=function(e,t,i,n){for(var s=0;s<i;s++){var o=n.call(e);t.push(o)}},t.readObject=function(e,t,i,n,s){for(var o=0;o<i;o++){for(var a={},r=0;r<n.length;r++){a[n[r]]=e[s[r]]()}t.push(a)}},f(t,["orders",function(){return this.orders=new jl},"p",function(){return this.p=new jl}]),t}(),PH=function(e){function t(){this.m_Info=null,t.__super.call(this)}b(t,"protos.task.TaskModel",$h);var i=t.prototype;return i.update=function(e){this.hasData()||(this.m_Info=new xB),this.m_Info.setServer(e)},i.hasNewGuide=function(e){return!!this.hasData()&&0<this.info.getCurrentGuide(e)},i.needAutoGoTarget=function(){if(t.hasTask()){if(3==this.m_Info.status&&0<this.m_Info.commitNPC)return!0;var e=0;return this.m_Info.target&&(e=this.m_Info.target.tarType),4==e||15==e||13==e}return!1},i.hasData=function(){return null!=this.m_Info&&4!=this.m_Info.status},i.isFirstTask=function(){return this.hasData()&&this.m_Info.taskId==zn.MODEL.key(0)},p(0,i,"isNewHands",function(){if(this.m_Info){var e=$e.getIndex(52),t=$e.MODEL.value(e),i=be.stringToNumArray(t);return this.m_Info.taskId>=i[0]&&this.m_Info.taskId<=i[1]}return!1}),p(0,i,"info",function(){return this.m_Info}),p(0,i,"commitNPC",function(){return this.m_Info.commitNPC.toString()}),p(0,i,"canCommit",function(){return 3==this.m_Info.status}),t.Ins=function(){return null==t.m_Instance&&(t.m_Instance=new t),t.m_Instance},t.hasTask=function(){return null!=t.m_Instance&&t.m_Instance.hasData()},t.needGoTarget=function(){return null!=t.m_Instance&&t.m_Instance.needAutoGoTarget()},t.m_Instance=null,t}(),RH=function(e){function t(){t.__super.call(this)}return b(t,"ui.UIRegister",$h,"UIRegister$1"),t.prototype.setup=function(){fs.regClass("clip",Ul),Vg.regComponent("TipButton",$p),Vg.regComponent("HtmlDiv",Xl),Vg.regComponent("TextField",zp),Vg.regViewRuntime("layouts.fight._Fight_ReliveUI",xJ)},t.instance=function(){return t._inst=t._inst||new t},t._inst=null,t}(),NH=function(e){function t(e){this.currOrder=null,this.owner,this.nextOrder,t.__super.call(this),this.owner=e,this.owner._GridChangeHander_=ql.create(this,this._GridChangeHander_,null,!1)}b(t,"zwc.engine.core.controls.orders.ActionCtrl",$h,"ActionCtrl$1");var i=t.prototype;return i._GridChangeHander_=function(){this.nextOrder&&this.nextOrder.allowBreakout&&this.currOrderClosured()},i.doOrder=function(e){if(null==this.currOrder)this.currOrder=e;else{if(0==this.currOrder.allowInsertOrder)return!1;e.allowBreakout&&(this.nextOrder&&this.nextOrder.dispose(),this.nextOrder=e)}return this.doFrame(),!0},i.doFrame=function(){this.doNextFrame()},i.currOrderClosured=function(){this.currOrder&&this.currOrder.dispose(),this.currOrder=null,this.nextOrder&&(this.currOrder=this.nextOrder),this.nextOrder=null,this.currOrder&&this.doFrame()},i.doNextFrame=function(){var e=this;e.currOrder&&!e.currOrder.isPlay?e.currOrder.doit():e.currOrder&&e.currOrder.isPlay&&e.currOrder.allowBreakout&&e.nextOrder&&0==e.owner.isRuning&&0==e.owner.lock&&(e.currOrderClosured(),e.doFrame())},i.clearAll=function(){this.currOrder&&this.currOrder.dispose(),this.nextOrder&&this.nextOrder.dispose(),this.currOrder=null,this.nextOrder=null},i.moveTo=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var s=EF.Create(this.owner,this);s.setup(s,s.moveTo,[e],t,i,n),this.doOrder(s)},i.attack=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var s=EF.Create(this.owner,this);s.setup(s,s.moveTo,[e],t,i,n),this.doOrder(s)},t}(),BH=function(e){function t(){this.allowBreakout=!1,this.allowInsertOrder=!1,this.isClosured=!1,this.isPlay=!1,this.owner=null,this.closuredOrder=null,this.orderName="OrderMove",this.currOrder,t.__super.call(this)}b(t,"zwc.engine.core.controls.orders.ActOrder",e,"ActOrder$1");var i=t.prototype;return i.closure=function(){},i.doit=function(){this.currOrder.run(),this.isPlay=!0},i.setup=function(e,t,i,n,s,o){void 0===n&&(n=!0),void 0===o&&(o=!0),this.currOrder=ql.create(e,t,i),this.closuredOrder=s,this.allowBreakout=n,this.allowInsertOrder=o},i.dispose=function(){e.prototype.dispose.call(this)},t.ORDER_MOVE="OrderMove",t}($h),HH=function(e){function _(){var e=this;e.gotoPlayAndStop=!1,e.gotoAndStop=!1,e.replayStopIndex=0,e.recordDataFormat="",e.char_type=null,e.path=null,e.sign=null,e.partType=null,e.idName=null,e.totalTimes=0,e.depth=0,e.stopFrame=-1,e.offsetSpeed=0,e.replay=0,e.layer=null,e.totalFrames=0,e.offsetX=0,e.offsetY=0,e.loaded=!1,e.overtime=0,e.startTime=0,e.passTime=0,e.group_id=null,e.passID="",e.isBodyPart=!1,e._currFrame_=0,e._currDir_=0,e._currInterval_=0,e.skillFrame=0,e.hitFrame=0,e.random=0,e._currDataFormat_=null,e._dataFormatGroup_=null,e._isReady_=!1,e.dealyTime=0,e.usedTime=0,e.scaleRate=1,e.scaleMatrix=null,e.durtime=0,e._currAct_="stand",_.__super.call(e),e.scaleMatrix=bu.create(),zwc.engine.core.displays.avatars.AvatarActData.instanceHash.put(e.id,e),e.init()}b(_,"zwc.engine.core.displays.avatars.AvatarActData",e);var t=_.prototype;return t.init=function(){this.random=10*Math.random()>>0},t.getCurrDataFromat=function(){return this._currDataFormat_},t.getCurrBitmapOffsetX=function(e,t){return 0},t.getCurrBitmapOffsetY=function(e,t){return 0},t.update=function(){},t.loadTextures=function(){var e=this._currDataFormat_;if(e){var t=FH.takeAUnit(this.oid);t&&qH.Ins().loadTextures(e,this.partType,this.idName,e.actName,t.currDir)}},t.onReady=function(){var e=this;e._isReady_=!0,e.usedTime=e.startTime=BB.getTimer(),e._currDataFormat_=e.dataFormatGroup.takeActData(e._currAct_);var t=e._currDataFormat_;if(e.initScale(),t){0==e.replay&&(e.replay=t.replay),e.totalFrames=t.totalFrame,e.currInterval=t.intervalTimes[e.currFrame];var i=FH.takeAUnit(e.oid);if(i){var n=i.currDir;if(1==t.totalFrame&&(n=0),-1!=t.idName.indexOf("eid")){if(e.loadEnabled){qH.Ins().loadTextures(t,e.partType,e.idName,t.actName,n);for(var s=0;s<e._currDataFormat_.totalDir;s++)n!=s&&qH.Ins().loadTextures(t,e.partType,e.idName,t.actName,s)}}else if(-1!=e.idName.indexOf(NB.defaultAvatarMid))for(var o=0;o<8;o++)qH.Ins().loadTextures(t,e.partType,e.idName,t.actName,o);else qH.Ins().loadTextures(t,e.partType,e.idName,t.actName,n)}}},t.initScale=function(){var e=this;e.scaleRate=Oe.isScales(e.idName),e.scaleMatrix.identity(),.8==e.scaleRate?e.scaleMatrix.scale(1.25,1.25):.7==e.scaleRate?e.scaleMatrix.scale(1.428,1.428):.6==e.scaleRate?e.scaleMatrix.scale(1.666,1.666):.5==e.scaleRate?e.scaleMatrix.scale(2,2):.25==e.scaleRate?e.scaleMatrix.scale(4,4):.4==e.scaleRate?e.scaleMatrix.scale(2.5,2.5):.33==e.scaleRate?e.scaleMatrix.scale(3,3):e.scaleMatrix.scale(1,1)},t.getDataFromat=function(e){var t,i=this;if(i._dataFormatGroup_&&i._dataFormatGroup_.loaded)if(t=i._dataFormatGroup_.takeActData(e))try{i.replay=t.replay}catch(e){i.replay=1}else i.replay=1;return t},t.loadTexture=function(e,t){var i=this;BB.getTimer()-i.durtime<100||(i.durtime=BB.getTimer(),i._dataFormatGroup_&&i._dataFormatGroup_.loaded&&e&&(i._currDataFormat_=i._dataFormatGroup_.takeActData(e),i._currDataFormat_&&(i.skillFrame=i._currDataFormat_.skillFrame,i.hitFrame=i._currDataFormat_.hitFrame,"warm"==e&&(e=0<i._currDataFormat_.idName.indexOf("_fs")||0<i._currDataFormat_.idName.indexOf("_ds")?"skill":"attack"),i.loadEnabled&&qH.Ins().loadTextures(i._currDataFormat_,i.partType,i.idName,e,t))))},t.play=function(e,t,i){void 0===t&&(t=-1),void 0===i&&(i=-1)},t.setCurrFrame=function(e){this._currFrame_=e},t.setCurrDir=function(e){this._currDir_=e},t.setCurrAct=function(e){this._currAct_=e,this._currDataFormat_=this.dataFormatGroup.takeActData(this._currAct_)},t.setCurr=function(e,t,i){var n=this;n._currFrame_=i,n._currAct_=e,n._currDir_=t,n._currDataFormat_=n.dataFormatGroup.takeActData(n._currAct_),n._currDataFormat_&&(n.totalFrames=n._currDataFormat_.totalFrame),n.loadTexture(n._currAct_,t)},t.loadActAsset=function(e,t){},t.getCurrInterval=function(){return this._currInterval_},t.recover=function(){this.dispose()},t.dispose=function(){if(zwc.engine.core.displays.avatars.AvatarActData.instanceHash.remove(this.id),e.prototype.dispose.call(this),this.reset(),_.pool.push(this),this._currDataFormat_=null,this._dataFormatGroup_=null,10<_.pool.length)for(;1<_.pool.length;){_.pool.shift();null}},t.getReset=function(){zwc.engine.core.displays.avatars.AvatarActData.instanceHash.put(this.id,this),this.reset()},t.reset=function(){var e=this;e.init(),e._id_=Ee.getSoleId(),e.gotoPlayAndStop=!1,e.gotoAndStop=!1,e.replayStopIndex=0,e.recordDataFormat="",e.char_type="",e.path="",e.sign="",e.partType="",e.idName="",e.totalTimes=0,e.stopFrame=-1,e.depth=0,e.offsetSpeed=0,e.replay=0,e.totalFrames=0,e.layer="",e.scaleRate=1,e.usedTime=0,e.dealyTime=0,e._isReady_=!1,e._currDir_=0,e._currAct_="stand",e._currInterval_=0,e._currFrame_=0,e.passID=""},t.getBitmapDataOffsetX=function(e,t){return this._currDataFormat_&&1==this._currDataFormat_.totalDir&&(e=0),this._currDataFormat_&&this._currDataFormat_.txs[e]&&t<this._currDataFormat_.txs[e].length?(e=_.setDirMode(this._currDataFormat_.idName,e),this._currDataFormat_.txs[e][t]-this._currDataFormat_.dir_offsetXs[e]+this.offsetX):0},t.getBitmapDataOffsetY=function(e,t){return this._currDataFormat_&&1==this._currDataFormat_.totalDir&&(e=0),this._currDataFormat_&&this._currDataFormat_.tys[e]&&t<this._currDataFormat_.tys[e].length?(e=_.setDirMode(this._currDataFormat_.idName,e),this._currDataFormat_.tys[e][t]-this._currDataFormat_.dir_offsetYs[e]+this.offsetY):0},t.getRect=function(e,t){if(this._currDataFormat_&&1==this._currDataFormat_.totalDir&&(e=0),this._currDataFormat_&&this._currDataFormat_.widths[e]&&t<this._currDataFormat_.widths[e].length)return e=_.setDirMode(this._currDataFormat_.idName,e),this._currDataFormat_.textures[e][t]},t.getWidth=function(e,t){return this._currDataFormat_&&1==this._currDataFormat_.totalDir&&(e=0),this._currDataFormat_&&this._currDataFormat_.widths[e]&&t<this._currDataFormat_.widths[e].length?(e=_.setDirMode(this._currDataFormat_.idName,e),this._currDataFormat_.widths[e][t]):0},t.getHeight=function(e,t){return this._currDataFormat_&&1==this._currDataFormat_.totalDir&&(e=0),this._currDataFormat_&&this._currDataFormat_.heights[e]&&t<this._currDataFormat_.heights[e].length?(e=_.setDirMode(this._currDataFormat_.idName,e),this._currDataFormat_.heights[e][t]):0},t.setCurrActButDoNotLoadAvatarSWF=function(e){var t=this;t.currAct!=e&&(t._dataFormatGroup_&&t._dataFormatGroup_.loaded&&(t._currDataFormat_=t._dataFormatGroup_.takeActData(e),t._currDataFormat_&&(t.skillFrame=t._currDataFormat_.skillFrame,t.hitFrame=t._currDataFormat_.skillFrame,t.totalFrames=t._currDataFormat_.totalFrame)),t.setCurrAct(e))},t.getBitmapData=function(e,t){var i=this;if(i._currDataFormat_&&(i.usedTime=BB.getTimer(),i._currDataFormat_&&1==i._currDataFormat_.totalDir&&(e=0),e<i._currDataFormat_.totalDir)){var n=i._currDataFormat_.idName;e=_.setDirMode(n,e),t>=i._currDataFormat_.textures[e].length&&(t=i._currDataFormat_.textures[e].length-1);var s=i._currDataFormat_.idName+"."+i._currDataFormat_.actName+"."+e;i._currDataFormat_.textures[e][t];var o,a=qH.getBitmapDataHash(i._currDataFormat_.idName+"."+i._currDataFormat_.actName,s);if(a){if(!(o=a[s=i._currDataFormat_.idName+"."+i._currDataFormat_.actName+"."+e+"."+t]))if(zwc.engine.core.displays.avatars.AvatarActData.checkNeedLoad(i.partType,i.idName,i.currAct,e)){var r=i._currDataFormat_.actName;"warm"==r&&(r=0<i._currDataFormat_.idName.indexOf("_fs")||0<i._currDataFormat_.idName.indexOf("_ds")?"skill":"attack"),i.loadTexture(r,e)}else if(i._currDataFormat_&&(0==qH.Ins()._waitAnalyzeQueue_.length||qH.Ins().isCanPushToAnalyzeQueue(i._currDataFormat_.idName+"."+i._currDataFormat_.actName+"."+e))){var l=NB.getAvatarTexturePath(i.partType,i.idName,i.currAct,e),c=g.GetNew();c.dataFormat_id=i._currDataFormat_.id,c.act=i.currAct,c.dir=e,c.path=l,c.FidName=i._currDataFormat_.idName,qH.Ins()._waitAnalyzeQueue_.push(c)}}else if(zwc.engine.core.displays.avatars.AvatarActData.checkNeedLoad(i.partType,i.idName,i.currAct,e))i.loadTexture(i._currDataFormat_.actName,e);else{var u=NB.getActDataPath(i.idName),d=UH._actDataRequestHash_.take(u),h=NB.getAvatarTexturePath(i.partType,i.idName,i.currAct,e);d&&""!=h&&qH.Ins().toAnalyzeTexture(h,i.currAct,i._currDataFormat_.id,e,i.idName)}return o}return null},p(0,t,"currInterval",function(){if(this._currDataFormat_&&this._currDataFormat_.intervalTimes){var e=this.currFrame;return e<=-1?0:(e>=this._currDataFormat_.intervalTimes.length&&(e=this._currDataFormat_.intervalTimes.length-1),this._currDataFormat_.intervalTimes[e])}return this._currInterval_},function(e){this._currInterval_=e}),p(0,t,"dataFormatGroup",function(){return this._dataFormatGroup_||(this._dataFormatGroup_=GH.getActGroup(this.group_id)),this._dataFormatGroup_}),p(0,t,"currDir",function(){return this._currDir_},function(e){this._currDir_=e}),p(0,t,"totalDir",function(){return 1}),p(0,t,"isReady",function(){return this._isReady_}),p(0,t,"loadEnabled",function(){return!0}),p(0,t,"currFrame",function(){return this._currFrame_},function(e){this.usedTime=BB.getTimer(),this._currFrame_=e}),p(0,t,"currAct",function(){return this._currAct_},function(e){this._currAct_=e}),_.clean=function(){},_.takeAvatarActData=function(e){return zwc.engine.core.displays.avatars.AvatarActData.instanceHash.take(e)},_.removeAvatarActData=function(e){var t=zwc.engine.core.displays.avatars.AvatarActData.instanceHash.remove(e);null!=t&&t.dispose()},_.GetNew=function(){return new _},_.checkNeedLoad=function(e,t,i,n){var s=NB.getAvatarTexturePath(e,t,i,n);return!qH.takeWealth(s)},_.setDirMode=function(e,t){return _.isNeedDirMode(e)&&(7==t?t=1:6==t?t=2:5==t&&(t=3)),t},_.isNeedDirMode=function(e){return!(!BB.isDirMode5||-1==e.indexOf("mid_")&&-1==e.indexOf("wid_")&&-1==e.indexOf("wgid_"))},_.pool=[],f(_,["ATTACK_SETT",function(){return this.ATTACK_SETT=[5,15,37,-18,45,15]},"RUN_SETT",function(){return this.RUN_SETT=[-40,-40,-40,-40,-40,-40]},"SKILL_SETT",function(){return this.SKILL_SETT=[-25,-15,-25,-30,120,-25]},"noPlayerDealth",function(){return this.noPlayerDealth=["ms157","ms158","ms093","ms159","ms114","ms149","ms123","ms127","ms142","ms135","ms162","ms138","ms140","ms144","ms147","ms151","ms153","ms155","ms156","ms143"]},"instanceHash",function(){return this.instanceHash=new jl}]),_}($h),VH=function(i){function t(){var e=this;e.idName=null,e.actName="",e.path=null,e.offset_x=0,e.offset_y=0,e.totalFrame=0,e.actSpeed=0,e.replay=-1,e.skillFrame=0,e.hitFrame=0,e.totalDir=0,e.totalTime=0,e.intervalTimes=null,e.txs=null,e.tys=null,e.widths=null,e.heights=null,e.dir_offsetXs=null,e.dir_offsetYs=null,e.max_rects=null,e.textures=null,e.splices=null,e._TextureSignHash_={},e.sign="normal",t.__super.call(e),e.init()}b(t,"zwc.engine.core.displays.avatars.AvatarDataFormat",i);var e=t.prototype;return e.init=function(){var e=this;e.sign="normal",e.offset_x=0,e.offset_y=0,e.actName="",e.totalFrame=0,e.actSpeed=0,e.replay=1,e.skillFrame=0,e.hitFrame=0,e.totalDir=0,e.textures=new Array,e.txs=[],e.tys=[],e.widths=[],e.heights=[],e.splices=[],e.dir_offsetXs=new Array(0,0,0,0,0,0,0,0),e.dir_offsetYs=new Array(0,0,0,0,0,0,0,0),e.max_rects=[],e.intervalTimes=[],zwc.engine.core.displays.avatars.AvatarDataFormat.instanceHash.put(e.id,e)},e.clone=function(){},e.recover=function(){},e.setTextureSign=function(e,t,i){this._TextureSignHash_[e+"."+t]=i},e.getTextureSign=function(e,t){return null!=this._TextureSignHash_[e+"."+t]},e.resetTextureSign=function(){this._TextureSignHash_={}},e.getlink=function(e,t){return 0<this.idName.indexOf("_fs")||0<this.idName.indexOf("_ds")?this.actName.split("warm").join("skill"):this.actName.split("warm").join("attack"),this.idName+"."+this.actName+"."+e+"."+t},e.dispose=function(){var e=this;zwc.engine.core.displays.avatars.AvatarDataFormat.instanceHash.remove(e.id),e.intervalTimes=null,e.txs.length=0,e.txs=null,e.tys.length=0,e.tys=null,e.widths.length=0,e.widths=null,e.heights.length=0,e.heights=null,e.dir_offsetXs.length=0,e.dir_offsetXs=null,e.dir_offsetYs.length=0,e.dir_offsetYs=null;for(var t=0;t<e.max_rects.length;t++)e.max_rects[t]=null;e.max_rects.length=0,e.max_rects=null,e.textures.length=0,e.textures=null,e.splices.length=0,i.prototype.dispose.call(e)},t.takeActDataformat=function(e){return zwc.engine.core.displays.avatars.AvatarDataFormat.instanceHash.take(e)},t.GetNew=function(){return new t},f(t,["instanceHash",function(){return this.instanceHash=new jl}]),t}($h),GH=function(e){function t(){var e=this;e.wealth_path=null,e.owner=null,e._loaded=!1,e._isPend=!1,e.isName=null,e.wealth_id=null,e.isCreateWarmPart=!1,e.lastTime=0,e.actGroup=new jl,e._quoteQueue_=new Array,t.__super.call(e),e.lastTime=BB.getTimer(),zwc.engine.core.displays.avatars.AvatarDataFormatGroup._instanceHash_.put(e.id,e)}b(t,"zwc.engine.core.displays.avatars.AvatarDataFormatGroup",$h);var i=t.prototype;return i.addQuote=function(e){this.lastTime=BB.getTimer(),this._quoteQueue_.push(e)},i.addActData=function(e,t){this.lastTime=BB.getTimer(),this.actGroup.put(e,t)},i.hasActData=function(e){return this.lastTime=BB.getTimer(),this.actGroup.has(e)},i.takeActData=function(e){return this.lastTime=BB.getTimer(),this.actGroup.take(e)},i.removeActData=function(e){return this.lastTime=BB.getTimer(),this.actGroup.remove(e)},i.toNotice=function(){if(this.loaded){for(var e,t=0,i=this._quoteQueue_.length;t<i;)(e=HH.takeAvatarActData(this._quoteQueue_[t]))&&e.onReady(),t++;this._quoteQueue_.length=0,this.lastTime=BB.getTimer()}},p(0,i,"isPend",function(){return this._isPend},function(e){this.lastTime=BB.getTimer(),this._isPend=e}),p(0,i,"loaded",function(){return this._loaded},function(e){this.lastTime=BB.getTimer(),this._loaded=e}),p(0,i,"quoteQueue",function(){return this._quoteQueue_}),p(1,t,"groupMap",function(){return zwc.engine.core.displays.avatars.AvatarDataFormatGroup._instanceHash_},zwc.engine.core.protos.Proto._$SET_groupMap),t.getActGroup=function(e){var t=zwc.engine.core.displays.avatars.AvatarDataFormatGroup._instanceHash_.take(e);return t.lastTime=BB.getTimer(),t},t.removeActGroup=function(e){zwc.engine.core.displays.avatars.AvatarDataFormatGroup._instanceHash_.remove(e)},t.getNew=function(){return new t},f(t,["_instanceHash_",function(){return this._instanceHash_=new jl}]),t}(),UH=function(e){function l(){this.warmHash={attack:"warm",walk:"walk_warm",run:"run_warm"},this.timedur=0,this.clearTime=0,this.clearHeightMemoryCount=0,this.clearHeightMemoryTime=0,this.clearDeathQueue=!0,l.__super.call(this),this._setup_()}b(l,"zwc.engine.core.displays.avatars.AvatarDock",$h);var t=l.prototype;return t._setup_=function(){G.timer.frameLoop(1,this,this.loop)},t.loop=function(){if(!NB.isAllStop&&NB.isSceneReady&&!(BB.getTimer()-this.timedur<30)){this.timedur=BB.getTimer();for(var e in zwc.engine.core.displays.avatars.AvatarDock.unitQueue.proto){var t=zwc.engine.core.displays.avatars.AvatarDock.unitQueue.proto[e],i=!0;if(t.owner instanceof zwc.engine.core.displays.avatars.Effect&&0==t.owner.autoClear&&(i=!1),t&&t.showTimeout()&&i){if(t.owner){if(t.owner instanceof zwc.engine.core.displays.avatars.Effect){t.owner.dispose();continue}if(t.owner instanceof zwc.engine.core.displays.world.char.Char)continue}}else"zwc.engine.core.displays.avatars.AvatarUnit"==t.className&&(t.owner&&t.owner.parent&&t.owner.visible&&t.onRender(0,qH.Ins().clearAvatorsTime),t.onEffectRender(),0)}this.clearAvatarData()}},t.loadAvatarDataFormat=function(e,t,i){var n=HH.GetNew();n.oid=e,n.partType=t,n.idName=i,n.startTime=BB.getTimer();var s=NB.getActDataPath(i),o=zwc.engine.core.displays.avatars.AvatarDock._actDataRequestHash_.take(s);(o||((o=GH.getNew()).wealth_path=s,zwc.engine.core.displays.avatars.AvatarDock._actDataRequestHash_.put(s,o)),o.addQuote(n.id),n.group_id=o.id,o.loaded)&&(qH.takeWealth(s)||(o.loaded=!1,o.isPend=!1));if(o.loaded)o.toNotice();else if(!o.isPend){o.isPend=!0;var a=new g;a.actGroupId=o.id,a.actDataId=n.id,a.unitId=e,a.path=s,o.wealth_id=a.wealthId,o.wealth_path=s,qH.addWealth(a)}return n},t.clearAvatarData=function(e){void 0===e&&(e=!1);var t=BB.getTimer();if(!(!e&&t-this.clearTime<3e4||t-qH.Ins().clearAvatorsTime<6e4)){this.clearTime=t;var i=[];for(var n in HH.instanceHash.proto){var s=HH.instanceHash.proto[n];if(s){var o=GH.getActGroup(s.group_id);if(o){var a=o.actGroup;for(var r in a.proto){var l=a.proto[r];l&&i.push(l.id)}}}}for(var c in VH.instanceHash.proto){var u=VH.instanceHash.proto[c];if(u&&i.indexOf(u.id)<0){var d=GH.getActGroup(u.oid);if(d){var h=d.takeActData(u.actName);h&&h.id!=u.id&&(VH.instanceHash.remove(u.id),u.dispose())}}}for(var _ in GH.groupMap.proto){var f=GH.groupMap.proto[_];if(f)if(6e4<t-f.lastTime&&0==f.loaded&&0==f.isPend&&0==f.quoteQueue.length){var p=NB.getActDataPath(f.isName);zwc.engine.core.displays.avatars.AvatarDock._actDataRequestHash_.remove(p),GH.removeActGroup(f.id)}else 0==f.actGroup.length&&f.loaded}for(;50<mj.recoverQueue.length;){var g=mj.recoverQueue.shift();g&&g.forceDestory()}}},t.clearHeightMemory=function(e){void 0===e&&(e=!1);var t=BB.getTimer();if(0<this.clearHeightMemoryTime&&1e5<t-this.clearHeightMemoryTime&&(this.clearHeightMemoryCount=0),this.clearHeightMemoryTime=t,this.clearHeightMemoryCount++,e||3<this.clearHeightMemoryCount&&150<Math.floor(x_.systemResourceManager.memorySize/1048576*100)/100)return this.clearHeightMemoryCount=0,qH.Ins().clearAvatorsUrls(),void qH.Ins().clearDislayQueue();this.clearSceneAvator(),this.clearAvatarData(!0)},t.clearSceneAvator=function(){var e=[];if(this.clearDeathQueue)for(var t=0;t<zN.deathQueue.length;t++){var i=zN.deathQueue[t];i&&(l.idNameEmpty(i.mid)&&e.indexOf(i.mid)<0&&e.push(i.mid),l.idNameEmpty(i.wid)&&e.indexOf(i.wid)<0&&e.push(i.wid),l.idNameEmpty(i.wgid)&&e.indexOf(i.wgid)<0&&e.push(i.wgid),l.idNameEmpty(i.eid)&&e.indexOf(i.eid)<0&&e.push(i.eid),l.idNameEmpty(i.chuanshiid)&&e.indexOf(i.chuanshiid)<0&&e.push(i.chuanshiid),l.idNameEmpty(i.dragonEffid)&&e.indexOf(i.dragonEffid)<0&&e.push(i.dragonEffid),G.timer.clearAll(i),zN.recoverChar(i))}return e},t.clearSceneUrls=function(){var e=[],t=uq.dislayQueue;for(var i in t){var n=t[i];if(n&&n.aunit){var s=FH.takeAUnit(n.aunit.id);if(s)if(n instanceof zwc.engine.core.displays.world.char.Char&&s._mainActData_)l.idNameEmpty(n.mid)&&e.indexOf(n.mid)<0&&e.push(n.mid),l.idNameEmpty(n.wid)&&e.indexOf(n.wid)<0&&e.push(n.wid),l.idNameEmpty(n.wgid)&&e.indexOf(n.wgid)<0&&e.push(n.wgid),l.idNameEmpty(n.eid)&&e.indexOf(n.eid)<0&&e.push(n.eid),l.idNameEmpty(n.chuanshiid)&&e.indexOf(n.chuanshiid)<0&&e.push(n.chuanshiid),l.idNameEmpty(n.dragonEffid)&&e.indexOf(n.dragonEffid)<0&&e.push(n.dragonEffid);else if(n instanceof zwc.engine.core.displays.avatars.Effect){var o=n.aunit._effectPartHash_;for(var a in o.proto){var r=o.proto[a].actData;r&&l.idNameEmpty(r.idName)&&e.indexOf(r.idName)<0&&e.push(r.idName)}}}}qH.Ins().clearAvatorsUrls(e)},l.idNameEmpty=function(e){return null==e||""==e||"null"==e||"0.0"==e},l.getInstance=function(){return null==zwc.engine.core.displays.avatars.AvatarDock._instance_&&(zwc.engine.core.displays.avatars.AvatarDock._instance_=new l),zwc.engine.core.displays.avatars.AvatarDock._instance_},l.addUnit=function(e){null==zwc.engine.core.displays.avatars.AvatarDock.unitQueue&&(zwc.engine.core.displays.avatars.AvatarDock.unitQueue=new jl),zwc.engine.core.displays.avatars.AvatarDock.unitQueue.put(e.id,e)},l.removeUnit=function(e){null==zwc.engine.core.displays.avatars.AvatarDock.unitQueue&&(zwc.engine.core.displays.avatars.AvatarDock.unitQueue=new jl),zwc.engine.core.displays.avatars.AvatarDock.unitQueue.remove(e);var t=FH.takeAUnit(e);t&&t.recover()},l.toNoiceCharBool=function(e){},l.toNoiceCharUpdateShowad=function(e){for(var t in NB.UiTextureSheet=e,zwc.engine.core.displays.avatars.AvatarDock.unitQueue.proto){var i=zwc.engine.core.displays.avatars.AvatarDock.unitQueue.proto[t];if(i){var n=i.owner;null!=n&&n.type!=Za.EFFECT&&n.updateShowad(e)}}},l._instance_=null,l.unitQueue=null,f(l,["_actDataRequestHash_",function(){return this._actDataRequestHash_=new jl}]),l}(),FH=function(r){function t(){var e=this;e.charType=null,e.ownerType=null,e._isDisposed_=!1,e.isCharMode=!0,e._relayIndex_=0,e._totalFrame_=0,e._interval_=0,e._actNext_=null,e._actPrve_=null,e._currFrame_=0,e._currDir_=0,e.scene_id=null,e.sex=NaN,e.prioLoadActs=null,e._mainActData_=null,e._owner_=null,e._bodyOverTime_=0,e.renderDurTime=0,e.setTimeOutIndex=0,e.act_replay=0,e.pauseTime=NaN,e.pauseFrameIndex=0,e._pauseTime=0,e.lastTime=0,e._lockPlaywarm=!1,e.playActTime=0,e.isPauseFrame=!1,e._noRenderTime=0,e._currAct_="stand",e._bodyPartHash_=new jl,e._effectPartHash_=new jl,t.__super.call(e),e._className_="zwc.engine.core.displays.avatars.AvatarUnit",zwc.engine.core.displays.avatars.AvatarUnit._instanceHash_.put(e.id,e)}b(t,"zwc.engine.core.displays.avatars.AvatarUnit",r);var e=t.prototype;return e.pauseAvatar=function(e,t){this.pauseFrameIndex=e,this._pauseTime=t},e.startPauseAvatar=function(){this.pauseTime=BB.getTimer()+this._pauseTime},e.setOwner=function(e){this._owner_=e},e.showTimeout=function(){return 0<this.lastTime&&6e4<BB.getTimer()-this.lastTime},e.loadTextures=function(){this._mainActData_&&this._mainActData_.loadTexture(this._currAct_,this.currDir)},e.updateCurr=function(){},e.play=function(e,t,i,n){void 0===t&&(t=0),void 0===n&&(n=-1),0<t&&this.onRender(t)},e.setLockPlayWarmTimerOver=function(){this.lockPlaywarm=!1},e.setCurrAct=function(e){var t=this;if(t._currAct_!=e){if(t.isCharMode){if(t.lockPlaywarm&&"skill_warm"!=e&&"warm"!=e)return void(t.lockPlaywarm=!1);"attack"==e||"skill"==e?(t.lockPlaywarm=!0,G.timer.once(800,t,t.setLockPlayWarmTimerOver)):t.lockPlaywarm=!1}else t.lockPlaywarm=!1;t._bodyOverTime_=BB.getTimer()-300,t._currAct_=e,t.setCurrFrame(0),t.loadTextures()}else t.lockPlaywarm=!1;t._currAct_=e},e.setCurrDir=function(e){this._currDir_=e,this.loadTextures()},e.setCurrFrame=function(e){this._currFrame_=e},e.setMainBodyPart=function(e,t){},e.noticeRender=function(e,t){null==t&&this.owner&&this.owner.toRender(e)},e.loopAct=function(e){return-1!=RB.loopActions.indexOf(e)},e.loadAvatarParts=function(e,t,i,n,s,o){var a,r,l=this;if((void 0===i&&(i=!1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),!l._isDisposed_)&&!ER.ins.interruptAvatarResourceLoad(l))if(UH.idNameEmpty(t)){var c=new PU;c.renderType="RENDER_BODY",c.partType=e,l.noticeRender(c),l._bodyPartHash_.remove(e)}else a=e+"_"+t,(r=UH.getInstance().loadAvatarDataFormat(l.id,e,a)).offsetX=n,r.offsetY=s,r.isBodyPart=!0,r.random=o,i&&(l._mainActData_=r,l._mainActData_.setCurr(l.currAct,l.currDir,l.currFrame)),l._bodyPartHash_.put(e,r,!0)},e.loadEffect=function(e,t,i,n,s,o,a,r,l){var c;if(void 0===n&&(n=!0),void 0===s&&(s="stand"),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=-2),void 0===l&&(l=0),this._isDisposed_)return null;if(!this._effectPartHash_)return null;if(UH.idNameEmpty(e))return null;if(ER.ins.interruptAvatarResourceLoad(this))return null;var u=!1,d="eid_"+e;if(null==i)i=n?d:d+"_"+BB.getTimer();else{var h=this._effectPartHash_.take(i);h&&(c=h.actData,u=!0)}if(c||(c=UH.getInstance().loadAvatarDataFormat(this.id,"eid",d)),-1!=r&&(c.replay=r),c.offsetX=o,c.offsetY=a,c.dealyTime=BB.getTimer()+l,c.setCurr(s,0,0),u){var _=PU.GetNew();_.renderType="RENDER_EFFECT",_.partType="eid",_.texture=null,_.tx=0,_.ty=0,_.layer=t,_.dir=c.currDir,_.frame=c.currFrame,_.act=c.currAct,_.passID=c.passID,_.rect=null,_.scaleN=c.scaleRate,_.scaleMatrix=c.scaleMatrix,this.noticeRender(_)}var f={actData:c,key:i,layer:t};return this._effectPartHash_.put(i,f,!0),c.passID=i,c},e.takeEffect=function(e){if(null==this._effectPartHash_)return null;var t=this._effectPartHash_.take(e);return t?t.actData:null},e.hasEffect=function(e){return null!=this._effectPartHash_&&this._effectPartHash_.has(e)},e.removeEffect=function(e,t){if(void 0===t&&(t=!1),this._effectPartHash_){var i=this._effectPartHash_.remove(e);if(i){var n=i.actData;if(n){var s=n.group_id,o=GH.getActGroup(s);if(null!=o)for(var a,r=o.quoteQueue,l=r.length,c=0;c<l;c++)(a=HH.takeAvatarActData(r[c]))&&a.oid==this.id&&(o.quoteQueue.splice(c,1),a.dispose(),c--);var u=PU.GetNew();u.renderType="RENDER_EFFECT",u.partType="eid",u.texture=null,u.tx=0,u.ty=0,u.isRemove=!0,u.layer=null,u.dir=0,u.frame=n.currFrame,u.act=n.currAct,u.passID=n.passID,u.rect=null,u.mat=null,u.scaleN=n.scaleRate,u.scaleMatrix=n.scaleMatrix,this.owner.toRender(u),this.noticeRender(u)}}}},e.onRender=function(e,t){var i=this;if(void 0===e&&(e=0),void 0===t&&(t=0),!i._isDisposed_&&i.owner&&i.isOnReady)if(i.isPauseAvatar)i.pauseFrameIndex=-1;else if(!ER.ins.interruptAvatarResourceLoad(i)){var n=i._mainActData_;n.usedTime=BB.getTimer();var s=n.totalFrames,o=i._currFrame_;if(s<=o){try{if(s<=0)return void(i.owner&&(i.owner.type==Za.MAIN_CHAR||i.owner.type==Za.HERO||i.owner.type==Za.CHAR)&&1e4<n.usedTime-i._noRenderTime&&(i._noRenderTime=BB.getTimer(),n.loaded=!1,i.loadAvatarParts(n.partType,n.idName.replace(n.partType+"_",""),!0)));0==i._currFrame_&&(i._currFrame_=1);var a,r=n.getDataFromat(i._currAct_);if(!r)return void(pt.onPC&&5e3<BB.getTimer()-t&&console.error("avatar model action miss ："+n.idName+",action:"+i._currAct_));if(a=r.intervalTimes[i._currFrame_-1],BB.getTimer()-i._bodyOverTime_<a)return}catch(e){return}if(n.char_type==Za.EFFECT&&(i.act_replay=n.replay),0<i.act_replay||-1==i.act_replay)i.setCurrFrame(0),-1!=i.act_replay&&(i.act_replay-=1);else if("death"==i.currAct||-1!=n.stopFrame){var l=0;l="death"==i.currAct?s-1:n.stopFrame,i.setCurrFrame(l)}else{var c=-1!=n.stopFrame?n.stopFrame:0;if(i.setCurrFrame(c),i.loopAct(i.currAct)){if(i._actNext_!=i.currAct){if(0==i.loopAct(i._actNext_))return i._actPrve_=i.currAct,void i.play(i._actNext_,1);i.owner.onActPlayEnd.apply(i.currAct),i._actPrve_=i.currAct,i.play(i._actNext_,1)}}else{if(n.char_type==Za.EFFECT)return;i._actPrve_=i.currAct,"attack"!=i.currAct&&"skill"!=i.currAct&&i.owner.onActPlayEnd.apply(i.currAct),"attack"==i.currAct||"skill"==i.currAct?(i.lockPlaywarm=!1,i.isCharMode?"attack"==i.currAct||"skill"==i.currAct?(i.owner.play("warm"),i._actNext_="warm",i.setTimeOutIndex=BB.getTimer(),-1<i.pauseFrameIndex&&i.pauseFrameIndex==i._currFrame_&&i.startPauseAvatar()):(i.owner.play("stand"),i._actNext_="stand",i.setTimeOutIndex=BB.getTimer()):(i._actNext_="stand",i.owner.play("stand",1))):(i._actNext_="stand",i.play("stand",1))}}}0<i.setTimeOutIndex&&3e3<BB.getTimer()-i.setTimeOutIndex&&("warm"==i.currAct||"skill_warm"==i.currAct)?(i.setTimeOutIndex=BB.getTimer(),i.owner.play("stand")):"warm"!=i.currAct&&"skill_warm"!=i.currAct&&(i.setTimeOutIndex=BB.getTimer()),n.currDir!=i.currDir&&(n.currDir=i.currDir),i.currAct!=n.currAct&&n.setCurrActButDoNotLoadAvatarSWF(i.currAct),n.setCurrFrame(i.currFrame),i.isCharMode?"run"==i.currAct?i._interval_=270/280*361/s-1:"walk"==i.currAct?i._interval_=540/s-1:i._interval_=n.currInterval:i._interval_=n.currInterval;0<i.renderDurTime&&i.owner.type==Za.MAIN_CHAR&&(i.renderDurTime=0);var u=0;u=(i.owner.type,Za.MAIN_CHAR,i._interval_),"run"!=i._currAct_&&"walk"!=i._currAct_&&(u/=i.owner.actSpeed);var d=BB.getTimer()-i._bodyOverTime_;if(-1<=d-u||e&&i.currFrame<s){var h;for(var _ in i._bodyPartHash_.proto)if(null!=(h=i._bodyPartHash_.proto[_])){h.setCurr(i.currAct,i.currDir,i.currFrame);var f=h.getBitmapData(i.currDir,i.currFrame),p=null,g=null;f&&(p=f.texture,g=f.rect);var v=h.getBitmapDataOffsetX(i.currDir,i.currFrame),m=h.getBitmapDataOffsetY(i.currDir,i.currFrame);-1!=h.idName.indexOf("mms086")&&(m+=80);var y,I=h.getWidth(i.currDir,i.currFrame),b=h.getHeight(i.currDir,i.currFrame);if(i.isCharMode&&i.owner&&!p&&"mid"==h.partType)2!=i.owner.sex?(y=NB.avatarDataBaseMale,NB.shadowAvatarGroupBaseMale):(y=NB.avatarDataBaseFamale,NB.shadowAvatarGroupBaseFamale),y&&(y.currDir=i.currDir,y.currFrame=i.currFrame,y.currAct=i.currAct,(f=y.getBitmapData(i.currDir,i.currFrame))&&(p=f.texture,g=f.rect),v=y.getBitmapDataOffsetX(i.currDir,i.currFrame),m=y.getBitmapDataOffsetY(i.currDir,i.currFrame),I=y.getWidth(i.currDir,i.currFrame),b=y.getHeight(i.currDir,i.currFrame));var w=h.partType,x=PU.GetNew();x.renderType="RENDER_BODY",x.partType=w,x.passID=h.idName+"."+i.currAct+"."+i.currDir,x.texture=p,x.tx=v,x.ty=m,x.w=I,x.h=b,x.frame=o,x.dir=i.currDir,x.act=i.currAct,x.rect=g,x.scaleN=h.scaleRate,x.scaleMatrix=h.scaleMatrix,i.owner.toRender(x)}if(i.isPauseFrame)return;(0<=d-u||1==e)&&("warm"!=i.currAct&&i.setCurrFrame(i.currFrame+1),i._bodyOverTime_=BB.getTimer())}}},e.onEffectRender=function(){var e=this;if(!e._isDisposed_&&!ER.ins.interruptAvatarResourceLoad(e)){var t=NaN,i=(HB.fps,e.owner),n=BB.getTimer();for(var s in e._effectPartHash_.proto){var o=e._effectPartHash_.proto[s],a=o.key,r=0,l=o.layer,c=o.actData;if(!HH.instanceHash.take(c.id))return;if(0<(c.usedTime=n)-c.dealyTime){var u,d=!1,h=c.getCurrDataFromat();if(h&&!VH.takeActDataformat(h.id))return;if(h){1<h.totalDir&&(r=e.currDir);var _=_=c.partType;if(h.id!=c.recordDataFormat&&(d=!0),c.recordDataFormat=h.id,(0==c.replay||d)&&(c.replay=h.replay),c.currFrame>=c.totalFrames){if(c.gotoAndStop){c.stopFrame>=c.totalFrames&&((u=PU.GetNew()).renderType="RENDER_EFFECT",u.partType=_,u.texture=null,u.tx=0,u.ty=0,u.layer=l,u.rect=p,u.dir=r,u.frame=c.currFrame,u.act=c.currAct,u.passID=c.passID,u.scaleN=c.scaleRate,u.scaleMatrix=c.scaleMatrix,e.owner.toRender(u));break}if(-1!=c.replay||c.gotoPlayAndStop||c.gotoAndStop)if(c.replay<=1)if(c.gotoPlayAndStop&&c.stopFrame<c.totalFrames)c.replayStopIndex=0,c.setCurrFrame(c.stopFrame),c.replay=2;else if((u=PU.GetNew()).renderType="RENDER_EFFECT",u.partType=_,u.texture=null,u.tx=0,u.ty=0,u.isRemove=!0,u.layer=l,u.dir=r,u.frame=c.currFrame,u.act=c.currAct,u.passID=c.passID,u.scaleN=c.scaleRate,u.scaleMatrix=c.scaleMatrix,u.rect=null,e.owner.toRender(u),"stand"!=c.currAct||d)c.currAct="stand";else{if(!(c.gotoPlayAndStop&&c.stopFrame>=c.totalFrames||RN.ins.checkEffIsPasssuit(a)||eN.isDragonEffect(a))){e._effectPartHash_.remove(a),null!=i.onEffectPlayEnd&&i.onEffectPlayEnd(a),c.dispose();break}c.replayStopIndex=0,c.replay=2,c.setCurrFrame(c.stopFrame)}else c.replay-=1,c.currFrame=0;else c.setCurrFrame(0)}var f=c.currInterval;if(f/=e.owner.actSpeed,n-c.passTime>f){c.passTime=BB.getTimer(),t=c.currFrame;var p,g=null,v=c.getBitmapData(r,t);v&&(g=v.texture,p=v.rect);var m=c.getBitmapDataOffsetX(r,t),y=c.getBitmapDataOffsetY(r,t);(u=PU.GetNew()).renderType="RENDER_EFFECT",u.partType=_,u.texture=g,u.tx=m+c.offsetX,u.ty=y+c.offsetY,u.layer=l,u.dir=r,u.frame=c.currFrame,u.act=c.currAct,u.rect=p,u.scaleN=c.scaleRate,u.scaleMatrix=c.scaleMatrix,u.passID=c.passID,e.owner.toRender(u),c.gotoAndStop&&c.currFrame==c.stopFrame?c.setCurrFrame(c.stopFrame):c.gotoPlayAndStop&&c.currFrame==c.stopFrame&&0==c.replayStopIndex||c.setCurrFrame(c.currFrame+1)}}else c.loaded&&"stand"==c.currAct&&((u=PU.GetNew()).renderType="RENDER_EFFECT",u.partType=_,u.texture=g,u.tx=m,u.ty=y,u.layer=l,u.dir=c.currDir,u.frame=c.currFrame,u.act=c.currAct,u.passID=c.passID,u.scaleN=c.scaleRate,u.scaleMatrix=c.scaleMatrix,e.owner.toRender(u))}}}},e.recover=function(){var e,t,i=this;if(zwc.engine.core.displays.avatars.AvatarUnit._instanceHash_.remove(i.id),UH.removeUnit(i.id),i._bodyPartHash_){for(t in i._bodyPartHash_.proto)(e=i._bodyPartHash_.proto[t]).dispose(),i._bodyPartHash_.proto[t]=null,delete i._bodyPartHash_.proto[t];i._bodyPartHash_.reset()}if(i._effectPartHash_){for(t in i._effectPartHash_.proto){var n,s=i._effectPartHash_.proto[t],o=(s.key,s.layer),a=a=(e=s.actData).partType;(n=PU.GetNew()).renderType="RENDER_EFFECT",n.partType=a,n.texture=null,n.mat=null,n.tx=0,n.ty=0,n.layer=o,n.passID=e.passID,n.scaleN=e.scaleRate,n.scaleMatrix=e.scaleMatrix,i.owner&&i.owner.toRender(n),e.dispose(),i._effectPartHash_.proto[t]=null,delete i._effectPartHash_.proto[t]}i._effectPartHash_.reset()}i.prioLoadActs=[],i._mainActData_&&i._mainActData_.dispose(),i._mainActData_=null},e.dispose=function(){var e,t,i=this;if(UH.removeUnit(i.id),zwc.engine.core.displays.avatars.AvatarUnit._instanceHash_.remove(i.id),i.charType=null,i.ownerType=null,i._isDisposed_=!0,i.isCharMode=!1,i._relayIndex_=0,i._totalFrame_=0,i._interval_=0,i._actNext_=null,i._actPrve_=null,i._currFrame_=0,i._currAct_="stand",i._currDir_=0,i.scene_id,i.sex=0,i._bodyPartHash_){for(e in i._bodyPartHash_.proto)(t=i._bodyPartHash_.proto[e]).dispose(),delete i._bodyPartHash_.proto[e];i._bodyPartHash_.dispose()}if(i._bodyPartHash_=null,i._effectPartHash_){for(e in i._effectPartHash_.proto){var n,s=i._effectPartHash_.proto[e],o=(s.key,s.layer),a=a=(t=s.actData).partType;(n=PU.GetNew()).renderType="RENDER_EFFECT",n.partType=a,n.texture=null,n.mat=null,n.tx=0,n.ty=0,n.layer=o,n.passID=t.passID,n.scaleN=t.scaleRate,n.scaleMatrix=t.scaleMatrix,i.owner.toRender(n),t.dispose(),delete i._effectPartHash_.proto[e]}i._effectPartHash_.dispose()}i._effectPartHash_=null,i.prioLoadActs=null,i._mainActData_&&i._mainActData_.dispose(),i._mainActData_=null,i._owner_=null,i._bodyOverTime_=0,i.renderDurTime=0,i.setTimeOutIndex=0,i.act_replay=0,r.prototype.dispose.call(i)},p(0,e,"currDir",function(){return this._currDir_}),p(0,e,"owner",function(){return!this._owner_||this._owner_.isDisposed?null:(this._owner_ instanceof zwc.engine.core.displays.avatars.AvatarUnitDisplay&&this._owner_.parent&&(this.lastTime=BB.getTimer()),this._owner_)}),p(0,e,"isPauseAvatar",function(){return this.pauseTime>BB.getTimer()}),p(0,e,"isOnReady",function(){return!(null==this._mainActData_||!this._mainActData_.onReady)}),p(0,e,"currAct",function(){return this._currAct_}),p(0,e,"currFrame",function(){return this._currFrame_}),p(0,e,"lockPlaywarm",function(){return this._lockPlaywarm},function(e){this._lockPlaywarm=e}),p(1,t,"instanceHash",function(){return t._instanceHash_},zwc.engine.core.protos.Proto._$SET_instanceHash),t.takeAUnit=function(e){return zwc.engine.core.displays.avatars.AvatarUnit._instanceHash_.take(e)},t.removeUnit=function(e){var t=zwc.engine.core.displays.avatars.AvatarUnit._instanceHash_.remove(e);null!=t&&t.dispose()},t.GetNew=function(){return new t},t._CLASS_NAME_="zwc.engine.core.displays.avatars.AvatarUnit",f(t,["_instanceHash_",function(){return this._instanceHash_=new jl}]),t}($h),qH=function(e){function r(){var e=this;e._waitAnalyzeQueue_=[],e._onAnalyzeHash_={},e.warmHash={attack:"warm",walk:"walk_warm",run:"run_warm"},e.partTextureIndex=0,e.noClears=["jm1471","jm1472","jm1473","jm1474","jm1475","jm1043","jm1147","jm1226","jm1130","jm1046","jm1050","jm1054","jm1081","jm1080","jm0088","jm0018","jm00181","jm0019","jm00191","jm1310"],e.isclearEnd=!1,e.clearAvatorsTime=0,e.clearChangeSceneTime=0,e.gcSceneTime=0,e.otherSaveUrls=[],e.interval_value=3e5,r.__super.call(e),e._textureHash_=new jl,e.toAnalyzeHash=new jo,G.timer.frameLoop(1,e,e.loop)}b(r,"zwc.engine.core.displays.avatars.AvatarWealthDock",$h);var t=r.prototype;return t.loop=function(){NB.isAllStop||this.analyzeTexture()},t.isCanPushToAnalyzeQueue=function(e){return null==this.toAnalyzeHash[e]},t.onImageComplete=function(e,t,i){var n=new mt(r.takeWealth(t)),s=r.takeWealth(i);if(null!=s){var o=Qp.GetNew();if(o.fileName=e,o.sourceTexture=s,o.decode(n),"LeverUI"==e){var a=o.takeStyleTextureBounds("role_yy");NB.showadTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),a=o.takeStyleTextureBounds("select2"),NB.selectTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),a=o.takeStyleTextureBounds("top_img_black"),NB.boolBackgroundTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),a=o.takeStyleTextureBounds("top_img_red"),NB.boolTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),a=o.takeStyleTextureBounds("top_img_yellow"),NB.innerTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),a=o.takeStyleTextureBounds("top_img_green"),NB.boolHeroTexture=Xp.createFromTexture(s,a.x,a.y,a.width,a.height),UH.toNoiceCharUpdateShowad(o)}}},t.toAnalyzeTexture=function(e,t,i,n,s){var o=g.GetNew();o.dataFormat_id=i,o.act=t,o.dir=n,o.path=e,o.FidName=s,this.onWealthComplete(o)},t.onWealthComplete=function(e){var t,i=zwc.engine.core.displays.avatars.AvatarWealthDock.takeWealth(e.path),n=e.path;if(i)if(e.suffix==NB.actDataExtension)(t=GH.getActGroup(e.actGroupId))||((t=GH.getNew()).wealth_path=n,UH._actDataRequestHash_.put(n,t)),this.analyeDataFormat(t,i),t.isPend=!1,t.loaded=!0,t.toNotice();else if(e.suffix==NB.avatarTextureExtension){var s=e,o=s.FidName+"."+s.act+"."+s.dir;if(i.bitmap&&(i.bitmap.enableMerageInAtlas=!1),null==this.toAnalyzeHash[o]&&(this.toAnalyzeHash[o]=o,this._waitAnalyzeQueue_.push(s),("attack"==s.act||"skill"==s.act&&(0<s.FidName.indexOf("_fs")||0<s.FidName.indexOf("_ds")))&&(n=NB.getActDataPath(s.FidName),(t=UH._actDataRequestHash_.take(n))&&t.takeActData("warm")))){var a=g.GetNew();a.FidName=s.FidName,a.dir=s.dir,a.act="warm",a.dataFormat_id=t.takeActData(a.act).id,a.path=s.path,this._waitAnalyzeQueue_.push(a)}}},t.analyeDataFormat=function(e,t,i){void 0===i&&(i=!0);var n=new mt(t);if(n&&!(n.bytesAvailable<=6)){try{var s=n.readUTF()}catch(e){return}e.isName=s,e.isCreateWarmPart=i;for(var o=n.readByte(),a=0;a<o;){var r=n.readUTF(),l=n.readByte(),c=n.readShort(),u=n.readInt(),d=n.readByte(),h=n.readByte(),_=n.readByte(),f=VH.GetNew();f.oid=e.id,f.idName=s,f.actName=r,f.totalFrame=l,f.actSpeed=c,f.replay=u,"eid_jn10595"!=s&&"eid_jn10606"!=s&&"eid_jn10680"!=s||(f.replay=2),f.skillFrame=0==d?l-2:d,f.hitFrame=h,f.totalDir=_,0==f.replay&&(f.replay=1);for(var p=f.totalTime=0;p<l;){var g=n.readInt();f.intervalTimes.push(c+g),f.totalTime+=c+g,p++}for(var v=0;v<_;)f.dir_offsetXs[v]=n.readInt(),f.dir_offsetYs[v]=n.readInt(),"mid_ms162"==s&&(f.dir_offsetYs[v]=-64),"mid_ms135"==s&&(f.dir_offsetYs[v]=-100),"mid_ms163"==s&&(f.dir_offsetYs[v]=-80),"mid_ms164"==s&&(f.dir_offsetYs[v]=-80),"eid_jn10072"==s&&(f.dir_offsetYs[v]-=200),"eid_jn10331"==s&&(f.dir_offsetYs[v]-=100),"eid_jn10261"==s&&(f.dir_offsetYs[v]-=140),"eid_jn10201"==s&&(f.dir_offsetYs[v]-=100),"eid_jm1275"==s&&(f.dir_offsetYs[v]-=10),"eid_jm1276"==s&&(f.dir_offsetYs[v]-=15),"eid_jm1280"==s&&(f.dir_offsetYs[v]-=10),"eid_jn10081"!=s&&"eid_jn10771"!=s&&"eid_jn10780"!=s&&"eid_jn10750"!=s&&"eid_jn10670"!=s&&"eid_jn10581"!=s||(f.dir_offsetYs[v]-=80),"eid_jn10281"==s&&(f.dir_offsetYs[v]-=35),"eid_jn10261"==s&&(f.dir_offsetYs[v]-=35),"eid_jn10601"==s&&(f.dir_offsetYs[v]-=150),"eid_jn10596"==s&&(f.dir_offsetYs[v]-=150),"eid_jn10681"==s&&(f.dir_offsetYs[v]-=95),"eid_jn10691"==s&&(f.dir_offsetYs[v]-=95),"eid_jn10561"==s&&(f.dir_offsetYs[v]-=155),"eid_jn10521"==s&&(f.dir_offsetYs[v]-=200),"eid_jn10732"!=s&&"eid_jn10733"!=s||(f.dir_offsetYs[v]-=115),"eid_jn10301"==s&&(f.dir_offsetYs[v]-=100),"eid_jn10331"==s&&(f.dir_offsetYs[v]-=90),v++;for(var m=n.readInt(),y=0;y<m;)f.splices[y]=n.readInt(),y++;!0;var I=l,b=0,w=0;3<l&&(I=Math.ceil(l/2));for(var x=0;x<_;){var S=[],k=[],E=[],T=[],C=[],L=0,M=(w=b=0,0);for(I=f.splices[x]+1;L<l;){var A,D,O=0,P=0;A=parseFloat(n.readUTF()),D=parseFloat(n.readUTF()),O=parseFloat(n.readUTF()),P=parseFloat(n.readUTF()),O-=400,P-=300,"eid_jn10351"==s&&(P+=4<L?200:160),"eid_jn10391"==s&&(P+=100),"mid_ms213"==s&&("stand"==r?P+=150:"walk"==r&&(P+=150)),S.push(A),k.push(D),E.push(O.toFixed(1)),T.push(P.toFixed(1)),0==L?M=D:M<D&&(M=D),C.push(new u_(b,w,A,D)),b+=A,L++}for(var R=w=b=0,N=0;N<C.length;N++)R==I&&(w+=M,R=b=0),C[N].x=b,C[N].y=w,b+=C[N].width,R++;f.widths.push(S),f.heights.push(k),f.txs.push(E),f.tys.push(T),f.textures.push(C),x++}e.addActData(r,f),a++}if(0<n.bytesAvailable){var B=n.readInt()/100;Oe.sm_list.put(s,B)}e.isCreateWarmPart&&(s&&(0<s.indexOf("_fs")||0<s.indexOf("_ds"))?e.hasActData("skill")&&this.addWarmDataFormat("skill","warm",s,e):e.hasActData("attack")&&this.addWarmDataFormat("attack","warm",s,e),e.hasActData("walk")&&this.addWarmDataFormat("walk","walk_warm",s,e,1),e.hasActData("run")&&this.addWarmDataFormat("run","run_warm",s,e,1))}},t.addWarmDataFormat=function(e,t,i,n,s){void 0===s&&(s=-1);var o=n.takeActData(e);if(o){var a=VH.GetNew();a.oid=n.id,a.idName=i,a.actName=t,a.totalFrame=1,a.actSpeed=o.actSpeed,a.replay=-1,a.skillFrame=0,a.hitFrame=0,a.totalDir=o.totalDir;for(var r=0;r<a.totalDir;r++){a.intervalTimes.push(a.actSpeed+0),a.totalTime+=a.actSpeed+0}for(var l=0;l<a.totalDir;l++)a.dir_offsetXs[l]=o.dir_offsetXs[l],a.dir_offsetYs[l]=o.dir_offsetYs[l];for(var c=0;c<a.totalDir;c++){var u,d,h,_,f;u=o.widths[c].slice(0,1),d=o.heights[c].slice(0,1),h=o.txs[c].slice(0,1),_=o.tys[c].slice(0,1),f=o.textures[c].slice(0,1),a.widths.push(u),a.heights.push(d),a.txs.push(h),a.tys.push(_),a.textures.push(f)}n.addActData(t,a)}},t.loadTextures=function(e,t,i,n,s){if(i!=NB.defaultAvatarMid){if(NB.isAllStop||!NB.isSceneReady)return;if(-1!=n.indexOf("warm"))return}1==e.totalDir&&(s=0);var o=i;s=HH.setDirMode(i,s);var a,r=NB.getAvatarTexturePath(t,i,n,s);if(!zwc.engine.core.displays.avatars.AvatarWealthDock.takeWealth(r)){var l=r.split(".")[1],c=this.getPriority(o,l,n,!1);(a=g.GetNew()).dataFormat_id=e.id,a.act=n,a.dir=s,a.path=r,a.FidName=o,zwc.engine.core.displays.avatars.AvatarWealthDock.addWealth(a,c)}},t.getPriority=function(e,t,i,n){void 0===n&&(n=!1);var s=20;for(var o in t==NB.actDataExtension&&(s-=5),n&&(s-=3),null!=i&&("stand"==i&&(s-=2),"walk"!=i&&"walk"!=i||(s-=1)),-1!=e.indexOf("mid_")?s-=3:-1!=e.indexOf("wid_")?s-=2:-1!=e.indexOf("wgid_")&&(s-=1),zwc.engine.core.displays.avatars.AvatarWealthDock.mainCharPartNames)-1!=e.indexOf(zwc.engine.core.displays.avatars.AvatarWealthDock.mainCharPartNames[o])&&(s-=3);return s},t.analyzeTexture=function(e){if(0!=this._waitAnalyzeQueue_.length){null==e&&(e=this._waitAnalyzeQueue_.shift());var t=VH.takeActDataformat(e.dataFormat_id);if(t){var i=e.path;1==t.totalDir&&(e.dir=0);GH.getActGroup(t.oid);if(e.act!=t.actName)return;var n,s=zwc.engine.core.displays.avatars.AvatarWealthDock.takeWealth(i);if(!s)return;null==this._onAnalyzeHash_[t.idName]?(n={},this._onAnalyzeHash_[t.idName]=n):n=this._onAnalyzeHash_[t.idName];var o=e.FidName+"."+e.act+"."+e.dir;if(null==n[o]){n[o]=o;var a=this._textureHash_.take(e.FidName+"."+e.act);null==a&&(a={});for(var r=t.textures[e.dir],l=(t.totalDir,0);l<r.length;l++){var c=r[l],u=t.getlink(e.dir,l);null==a[u]&&(this.partTextureIndex++,a[u]={texture:s,rect:c})}this._textureHash_.put(e.FidName+"."+e.act,a,!0),r=null}}}},t.clear=function(e,t){NB.getActDataPath(e)},t.cleanPath=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(-1!=n.indexOf(NB.AVATARS)){var s=(n=n.split(NB.AVATARS)[1]).split("/");s&&3<s.length&&t.push(s[2])}}return t},t.addNoClears=function(e){e&&this.noClears.indexOf(e)<0&&this.noClears.push(e)},t.removeNoClears=function(e){var t=this.noClears.indexOf(e);return 0<=t&&(this.noClears.splice(t,1),!0)},t.checkClears=function(e,t){for(var i=0;i<t.length;i++)if(0<=e.indexOf(t[i]))return!1;return!0},t.panelEffectCheck=function(){for(var e=[],t=0;t<mj.useQueue.length;t++){var i=mj.useQueue[t];if(i.aunit){var n=i.aunit._effectPartHash_;for(var s in n.proto){var o=n.proto[s].actData;o&&e.indexOf(o.idName)<0&&e.push(o.idName)}}}return e},t.clearAvatorsUrls=function(e,t){var i=this;void 0===t&&(t=!1);var n=pt.now();e||(e=(e=[]).concat(i.noClears)),0==hN.ins.isCloseAll&&(e=e.concat(i.panelEffectCheck()));var s=0,o=[],a=[],r=yc.groupMap.ASSETS_SCENE_GROUP;if(r){var l=r.length;for(s=0;s<l;s++){var c=r[s];i.checkClears(c,e)&&(a.push(c),yc.clearRes(c,!0))}o=i.cleanPath(a),r.length=0}if(0!=o.length){var u=[];if(hN.ins.isCloseAll)for(var d=0;d<i.noClears.length;d++)u.push("eid_"+i.noClears[d]);var h=!1;for(var _ in i._textureHash_.proto){h=!1;var f=_.split(".")[0];if(-1!=o.indexOf(f)&&(h=!0),hN.ins.isCloseAll&&(h=!(-1<u.indexOf(f))),h){var p=i._textureHash_.proto[_];for(var g in p){var v=p[g].texture;if(yc.clearRes(v.url),p[g].texture=null,p[g].rect=null,p[g]=null,delete p[g],t&&20<pt.now()-n)return}i._textureHash_.remove(_),p=null}}for(var m in i._onAnalyzeHash_)if(h=!1,-1!=o.indexOf(m)&&(h=!0),hN.ins.isCloseAll&&(h=!(-1<u.indexOf(m))),h){var y=i._onAnalyzeHash_[m];for(var I in y)y[I]=null,delete y[I];if(i._onAnalyzeHash_[m]=null,delete i._onAnalyzeHash_[m],t&&20<pt.now()-n)return}for(var b in i.toAnalyzeHash)for(var w=0;w<o.length;w++)if(h=!1,-1!=b.indexOf(o[w])&&(h=!0),hN.ins.isCloseAll&&(h=!(-1<u.indexOf(o[w]))),h&&(i.toAnalyzeHash[b]=null,delete i.toAnalyzeHash[b],t&&20<pt.now()-n))return;for(var x in uq.dirTextureHash.proto){var S=uq.dirTextureHash.proto[x],k=!1;if(hN.ins.isCloseAll){k=!0;for(var E=0;E<i.noClears.length;E++)-1!=x.indexOf(i.noClears[E])&&(k=!1)}else{k=!1;for(var T=0;T<o.length;T++)-1!=x.indexOf(o[T])&&(k=!0)}if(S&&k&&(uq.dirTextureHash.remove(x),S=null,t&&20<pt.now()-n))return}i.isclearEnd=!0}else i.isclearEnd=!0},t.clearDirTextureHash=function(){BB.getTimer();for(var e in uq.dirTextureHash.proto){for(var t=uq.dirTextureHash.proto[e],i=!0,n=0;n<this.noClears.length;n++)-1!=e.indexOf(this.noClears[n])&&(i=!1);t&&i&&12e4<pt.now()-t.lastTime&&(uq.dirTextureHash.remove(e),t=null,0)}},t.clearAvatorsFormatData=function(){this.clearAvatorsTime=BB.getTimer();var e=[];for(var t in HH.instanceHash.proto){var i=HH.instanceHash.proto[t];if(i){var n=!1;6e4<=this.clearAvatorsTime-i.startTime&&6e4<=this.clearAvatorsTime-i.passTime&&6e4<=this.clearAvatorsTime-i.usedTime&&(n=!0);var s=GH.getActGroup(i.group_id),o=!1;if(s){var a=s.actGroup;for(var r in o=6e4<this.clearAvatorsTime-s.lastTime,a.proto){var l=a.proto[r];l&&(n&&o?(s.removeActData(l.actName),VH.instanceHash.remove(l.id),l.dispose()):e.push(l.id))}o&&0==s.actGroup.length&&(s.loaded=!1,s.isPend)}n&&HH.removeAvatarActData(i.id)}}for(var c in VH.instanceHash.proto){var u=VH.instanceHash.proto[c];if(u&&e.indexOf(u.id)<0){var d=GH.getActGroup(u.oid);d&&(d.removeActData(u.actName),0==d.actGroup.length&&(d.loaded&&(d.loaded=!1),d.isPend&&d.isPend)),VH.instanceHash.remove(u.id),u.dispose()}}for(var h in GH.groupMap.proto){var _=GH.groupMap.proto[h];if(_&&6e4<BB.getTimer()-_.lastTime&&0==_.loaded&&0==_.isPend&&0==_.quoteQueue.length){var f=NB.getActDataPath(_.isName);UH._actDataRequestHash_.remove(f),GH.removeActGroup(_.id)}}return[]},t.clearDislayQueue=function(){BB.getTimer();var e=uq.dislayQueue,t=[];for(var i in e){var n=e[i],s=!0;if(n&&n.aunit){var o=FH.takeAUnit(n.aunit.id);o&&(n instanceof zwc.engine.core.displays.world.char.Char&&o._mainActData_?s=!1:n instanceof zwc.engine.core.displays.avatars.Effect&&(s=!1))}if(0==s){if(t.push(n),n instanceof zwc.engine.core.displays.world.char.Char){var a=n;a.updateTitles(),ZN.updateCharDisplay(a,a.mid,a.wid,a.wgid,a.eid,a.chuanshiid,a.magicId,a.dragonEffid)}}else n.destroyed||n.dispose()}uq.dislayQueue=t},t.clearChangeScene=function(){var e=this;if(e.clearChangeSceneTime=pt.now(),0==e.gcSceneTime&&(e.gcSceneTime=e.clearChangeSceneTime),(_r.justCreated||pt.onAndroid)&&(e.interval_value=6e5),e.clearChangeSceneTime-hr.game_time<e.interval_value)e.isclearEnd=!0;else{e.otherSaveUrls=[];for(var t=0;t<gR.ins.actorList.length;t++)for(var i=gR.ins.actorList[t],n=0;n<i.titles.length;n++){var s=i.titles[n],o=co.getIndex(s),a=co.MODEL.effect(o);e.otherSaveUrls.push(a)}e.otherSaveUrls=e.otherSaveUrls.concat(e.noClears),e.isclearEnd=!1,e.clearAvatorsUrls(e.otherSaveUrls,!1),BR.ins.isQuitFromDig3?BR.ins.isQuitFromDig3=!1:(e.clearDislayQueue(),e.clearAvatorsFormatData(),Te.instance.freeAll(),2==dr.xgame&&e.clearChangeSceneTime-e.gcSceneTime>e.interval_value&&(e.gcSceneTime=e.clearChangeSceneTime,wx.triggerGC()))}},t.timeClear=function(){this.isclearEnd?G.timer.clear(this,this.timeClear):this.clearAvatorsUrls(this.otherSaveUrls,!1)},r.isCacheAssets=function(e){return""!=NF.mainChar.mid&&-1!=e.indexOf(NF.mainChar.mid)||(""!=NF.mainChar.wid&&-1!=e.indexOf(NF.mainChar.wid)||(""!=NF.mainChar.wgid&&-1!=e.indexOf(NF.mainChar.wgid)||""!=NF.mainChar.eid&&-1!=e.indexOf(NF.mainChar.eid)))},r.Ins=function(){return null==zwc.engine.core.displays.avatars.AvatarWealthDock._instance_&&(zwc.engine.core.displays.avatars.AvatarWealthDock._instance_=new r),zwc.engine.core.displays.avatars.AvatarWealthDock._instance_},r.takeWealth=function(e){return 0==v_.isConchApp&&-1==e.indexOf("?")&&(e=r.takeURLVersion(e)),G.loader.getRes(e)},r.hasWealth=function(e){return null!=G.loader.getRes(e)},r.loadStyleImage=function(e,t){void 0===t&&(t="");var i=_r.getStyleTexturePath(e),n=_r.getStylegBinPath(e);i=r.takeURLVersion(i),n=r.takeURLVersion(n);var s=ql.create(zwc.engine.core.displays.avatars.AvatarWealthDock.Ins(),zwc.engine.core.displays.avatars.AvatarWealthDock.Ins().onImageComplete,[t,n,i]);G.loader.getRes(n)?s.run():null==r.resMap[n]&&(r.resMap[n]=n,G.loader.load([{url:n,type:"arraybuffer"},{url:i,type:"image"}],s))},r.takeURLVersion=function(e){return dr.nativeSuffix?e+"?"+hr.otherVersion:e},r.addWealth=function(e,t){void 0===t&&(t=-1);var i=ql.create(zwc.engine.core.displays.avatars.AvatarWealthDock.Ins(),zwc.engine.core.displays.avatars.AvatarWealthDock.Ins().onWealthComplete,[e]),n=r.takeURLVersion(e.path);if(-1!=n.indexOf(".sm")){if(-1!=n.indexOf("eid_0.sm")||-1!=n.indexOf("mid_0.sm")||-1!=n.indexOf("wid_0.sm")||-1!=n.indexOf("wgid_0.sm"))return;G.loader.load([n],i,null,e.type,0,!0,"ASSETS_SCENE_GROUP")}else-1!=n.indexOf("eid_mjm")||-1!=n.indexOf("eid_jm")?G.loader.load([n],i,null,e.type,1,!0,"ASSETS_SCENE_GROUP"):r.isCacheAssets(n)?G.loader.load([n],i,null,e.type,0,!0,"ASSETS_SCENE_GROUP"):G.loader.load([n],i,null,e.type,1,!0,"ASSETS_SCENE_GROUP")},r.getBitmapDataHash=function(e,t){return zwc.engine.core.displays.avatars.AvatarWealthDock.Ins()._textureHash_.take(e)},r._instance_=null,r.mainCharPartNames={},r.resMap={},f(r,["TotalDataFormatHash",function(){return this.TotalDataFormatHash=new jl},"bytes",function(){return this.bytes=new mt}]),r}(),jH=function(e){function t(){var e=this;e.g=null,e.nonce=null,e.isFinish=!1,e.G=0,e.source=null,e.startPoint=null,e._endPoint=null,e.colsePath=null,e.colseArray=null,e.openPath=null,e.openArray=null,e.pathArray=null,e.canTL=!1,e.canTR=!1,e.canBL=!1,e.canBR=!1,e.canTC=!1,e.canCL=!1,e.canCR=!1,e.canBC=!1,e.closeLength=NaN,e.mode=1,e.key_start=null,t.__super.call(e),e.key_end}b(t,"zwc.engine.core.displays.world.terrain.astar.TileAstar",$h);var i=t.prototype;return i.getPath=function(e,t,i,n,s,o,a){var r=this;void 0===o&&(o=!0),void 0===a&&(a=1e4);var l=new Uh(t,i),c=new Uh(n,s);if(r.key_start=t+"_"+i,r.key_end=n+"_"+s,e.hasItem(t,i))e.takeItem(t,i),e.takeItem(n,s);if(r.reSet(),r.startPoint=r.loopCheck(e,l,8),zwc.engine.core.displays.world.terrain.astar.TileAstar.newStartPt=l,r.endPoint=r.loopCheck(e,c,8),null==r.endPoint||null==l)return[];for(r.source=e,r.nonce=new AB(0,0,r.startPoint),r.nonce.parent=r.nonce,r.colsePath[r.nonce.key]=r.nonce;r.isFinish;)r.getScale9Grid(e,r.nonce,new Uh(r.endPoint.x,r.endPoint.y),a);return r.cleanArray()},i.stop=function(){this.isFinish=!1},i.loopCheck=function(e,t,i){var n=1==this.mode?2:1,s=e.takeItem(t.x,t.y);if(null!=s&&0!=s.type&&s.type!=n)return t;zwc.engine.core.displays.world.terrain.astar.TileAstar.keyIndex=t;var o=zwc.engine.core.displays.world.terrain.astar.TileAstar.loopRect(t.x,t.y,i,e,n,t);return null==o&&(this.isFinish=!1),o},i.getDis=function(e,t){var i=t.x-e.x;i<0&&(i=-i);var n=t.y-e.y;return n<0&&(n=-n),i+n},i.pass=function(e){return 0<e.type},i.stratght=function(e,t,i){var n=this;if(null!=e)if(n.pass(e)){var s=e.key,o=e.pt,a=e.x,r=e.y,l=10*(Math.abs(t.x-a)+Math.abs(t.y-r)),c=10+n.G,u=new AB(c,c+l,o);null==u.parent&&(u.parent=n.nonce);var d=n.openPath[s],h=n.colsePath[s];null==d&&null==h?(n.openPath[s]=u,n.openArray.push(u)):null!=d&&u.F<d.F&&(n.openPath[s]=u),u=null}else"tc"==i?(n.canTC=!1,n.canCL||(n.canTL=!1),n.canCR||(n.canTR=!1)):"cl"==i?(n.canCL=!1,n.canTC||(n.canTL=!1),n.canBC||(n.canBL=!1)):"cr"==i?(n.canCR=!1,n.canTC||(n.canTR=!1),n.canBC||(n.canBR=!1)):"bc"==i&&(n.canBC=!1,n.canTC||(n.canBL=!1),n.canCR||(n.canBR=!1));else"tc"==i?(n.canTC=!1,n.canCL||(n.canTL=!1),n.canCR||(n.canTR=!1)):"cl"==i?(n.canCL=!1,n.canTC||(n.canTL=!1),n.canBC||(n.canBL=!1)):"cr"==i?(n.canCR=!1,n.canTC||(n.canTR=!1),n.canBC||(n.canBR=!1)):"bc"==i&&(n.canBC=!1,n.canTC||(n.canBL=!1),n.canCR||(n.canBR=!1))},i.diagonal=function(e,t,i){if(i&&null!=e&&this.pass(e)){var n=e.key,s=e.pt,o=10*(Math.abs(t.x-e.x)+Math.abs(this.endPoint.y-e.y)),a=14+this.G,r=new AB(a,a+o,s);null==r.parent&&(r.parent=this.nonce);var l=this.openPath[n],c=this.colsePath[n];null==l&&null==c?(this.openPath[n]=r,this.openArray.push(r)):null!=l&&r.F<l.F&&(this.openPath[n]=r),r=null}},i.getScale9Grid=function(e,t,i,n){var s=this;s.canBL=!0,s.canBR=!0,s.canTL=!0,s.canTR=!0,s.canTC=!0,s.canCR=!0,s.canCL=!0,s.canBC=!0;var o=t.pt,a=o.x,r=o.y,l=a+1,c=r+1,u=a-1,d=r-1,h=e.takeItem(u,d),_=e.takeItem(l,d),f=e.takeItem(u,c),p=e.takeItem(l,c),g=e.takeItem(a,d),v=e.takeItem(u,r),m=e.takeItem(l,r),y=e.takeItem(a,c);g&&s.stratght(g,i,"tc"),v&&s.stratght(v,i,"cl"),m&&s.stratght(m,i,"cr"),y&&s.stratght(y,i,"bc"),h&&s.diagonal(h,i,s.canTL),_&&s.diagonal(_,i,s.canTR),f&&s.diagonal(f,i,s.canBL),p&&s.diagonal(p,i,s.canBR);var I=s.openArray.length;if(0==I||null==g&&null==v&&null==m&&null==y&&null==h&&null==_&&null==f&&null==p)s.isFinish=!1;else{for(var b,w=0,x=0;x<I;x++){var S=s.openArray[x];0==x?b=S:S.F<b.F&&(b=S,w=x)}s.nonce=b,b=null,s.openArray.splice(w,1);var k=s.nonce.key;null==s.colsePath[k]&&(s.colsePath[k]=s.nonce,s.closeLength++,s.closeLength>n&&(s.isFinish=!1)),s.nonce.key==s.key_end&&(s.isFinish=!1),s.G=s.nonce.G}},i.pathCutter=function(e,t){void 0===t&&(t=2);for(var i,n=[],s=0;s<e.length;s++)s%t==0&&(i=[],0<n.length&&i.push(e[s-1]),n.push(i)),i.push(e[s]);for(var o=0;o<n.length;o++)n[o]=zwc.engine.core.displays.world.terrain.astar.TileAstar.cleanPath(n[o]);return n},i.cleanArray=function(){var e=this;e.pathArray=[];var t=e.endPoint.x+"_"+e.endPoint.y;if(null==e.colsePath[t]){var i,n=-1,s=NaN,o=NaN,a=NaN;for(var r in e.colsePath){var l=e.colsePath[r];l.pt&&(i=l.pt,(s=e.endPoint.x-i.x)<0&&(s=-s),(o=e.endPoint.y-i.y)<0&&(o=-o),a=s+o,-1==n?(n=a,t=i.x+"_"+i.y):a<n&&(n=a,t=i.x+"_"+i.y))}null==e.colsePath[t]&&e.pathArray}var c=e.colsePath[t];if(null!=c){e.pathArray.unshift(PB.tileToPixels(c.pt)),e.pathArray.unshift(PB.tileToPixels(c.parent.pt));for(var u=!0,d=0;u;){if((t=e.colsePath[t].parent.key)==e.startPoint.x+"_"+e.startPoint.y||1e4<d){u=!1;break}e.pathArray.unshift(PB.tileToPixels(e.colsePath[t].parent.pt)),d++}}return e.pathArray},i.reSet=function(){var e=this;e.pathArray=[];var t="";for(t in e.colsePath)e.colsePath[t],delete e.colsePath[t],null;for(t in e.colsePath={},e.colseArray=[],e.openPath)e.openPath[t],delete e.openPath[t],null;e.openPath={},e.openArray=[],e.G=0,e.nonce=null,e.canTL=!0,e.canTR=!0,e.canBL=!0,e.canBR=!0,e.isFinish=!0,e.closeLength=0},p(0,i,"endPoint",function(){return this._endPoint},function(e){this._endPoint=e}),t.loopRect=function(e,t,i,n,s,o){e-=2,t-=2,i=0+i;for(var a=0,r=NaN,l=0,c=1,u=[];l<i;){var d=e-(l-1),h=t-(l-1),_=1,f=0,p=0;r=c+2,a=Math.pow(r,2)-Math.pow(c,2);for(var g=!1,v=0;v<a;v++){p%(r-1)==0&&++f%3==0&&(_=-_),f%2==0?d+=_:h+=_;var m=n.takeItem(d,h);if(m&&0!=m.type&&m.type!=s){var y=VB.getCharDir(e,t,d,h);null==zwc.engine.core.displays.world.terrain.astar.TileAstar.newStartPt?u.push({tile:m,dis:ol.distance(m.pt,o)}):m.pt.toString()!=zwc.engine.core.displays.world.terrain.astar.TileAstar.newStartPt.toString()&&(u.push({tile:m,dir:y,dis:ol.distance(m.pt,o)}),g=!0)}p++}if(g)return u.length?(u=ol.srotOn(u,"dis",Array.NUMERIC))[0].tile.pt:null;l++,c+=2}return null},t.fineFaceTile=function(e,t){for(var i=[e-1,e,e+1],n=0;n<i.length;n++){var s=i[n];s<0&&(i[n]=8-s)}return-1!=i.indexOf(t)},t.cleanPath=function(e){if(2<e.length)for(var t=1;t<e.length-1;t++){var i=e[t-1],n=e[t],s=e[t+1];(i.y-n.y)/(i.x-n.x)==(n.y-s.y)/(n.x-s.x)&&(e.splice(t,1),t--)}return e},t.COST_STRAIGHT=10,t.COST_DIAGONAL=14,t.DIR_TC="tc",t.DIR_CL="cl",t.DIR_CR="cr",t.DIR_BC="bc",t.newStartPt=null,t.keyIndex=null,t}(),WH=function(e){function t(){var e=this;e.scene_id=null,e.pixel_x=0,e.pixel_y=0,e.pixel_width=0,e.pixel_height=0,e.size=0,e.items=[],e.imageIndexArray=[],e.imageArray=[],t.__super.call(e),e.imageIndexHash=new jl}b(t,"zwc.engine.core.displays.world.terrain.TerrainData",$h);var i=t.prototype;return i.clear=function(){for(var e in this.imageIndexHash)delete this.imageIndexHash[e];for(var t=0;t<this.imageIndexArray.length;t++){var i=this.imageIndexArray[t];for(var n in i)delete i[n];this.imageIndexArray[t]=null}this.imageArray.length=0,this.imageIndexArray.length=0,this.items.length=0,YH.instance.clear()},i.uncodeNew=function(e,t){var i=this;if(e&&!(e.bytesAvailable<4)){i.clear(),e.position=0,i.scene_id=String(e.readInt());var n=2<=e.bytesAvailable?e.readShort():0,s=2<=e.bytesAvailable?e.readShort():0;i.pixel_width=80*n,i.pixel_height=40*s,"1002"==i.scene_id&&(i.pixel_width=6482,i.pixel_height=4234),i.items=[];var o=YH.instance;i.imageIndexHash&&i.imageIndexHash.dispose(),i.imageIndexHash=new jl,i.imageArray=[];for(var a=YH.instance.length=0;a<n;a++)for(var r=0;r<s;r++){var l=e.readByte();if(0<l){var c=a+"_"+r;i.imageIndexHash.has(c)||(i.imageIndexHash.put(c,c,!1),i.imageArray.push({scene_id:i.scene_id,key:c,dis:0,index_x:a,index_y:r}));var u=OB.createTile();u.x=a,u.y=r,u.heroType=u.walkType=u.initValue=u.type=yt.readBit(l,0,1),u.isSafe=1==yt.readBit(l,1,1);var d=1==yt.readBit(l,2,1);if(u.isAlpha=1==yt.readBit(l,3,1),u.isSell&&u.isSell,d){var h=new DB;h.x=e.readShort(),h.y=e.readShort(),i.items.push(h)}t?t.put(c,u):o.putItem(a,r,u)}u=null}OB.deleteTile()}},t}(),YH=function(e){function t(){this.length=0,this.passGridsArray=[],t.__super.call(this),this.gridHash=new Array}b(t,"zwc.engine.core.displays.world.terrain.TileGroup",$h);var i=t.prototype;return i.get8GridsKeys=function(e){if(!e)return[];for(var t=new Array,i=e.x,n=e.y,s=e.x+"_"+e.y,o=i-1;o<=i+1;o++)for(var a=n-1;a<=n+1;a++){var r=o+"_"+a;r!=s&&t.push(r)}return t},i.get8Grids=function(e,t){void 0===t&&(t=1);for(var i=new Array,n=e.x,s=e.y,o=n-t;o<=n+t;o++)for(var a=s-t;a<=s+t;a++){if(o+"_"+a!=e.x+"_"+e.y){var r=this.takeItem(o,a);r&&0<r.type&&0<r.heroType&&i.push(PB.tileToPixels(new Uh(o,a)))}}return i},i.isBlock=function(e,t){var i=this.takeItem(e,t);return!(i&&0<i.type)},i.isAlpha=function(e,t){var i=this.takeItem(e,t);return!(!i||!i.isAlpha)},i.getRandomPoint=function(){var e=Math.random()*this.passGridsArray.length>>0;return this.passGridsArray[e]},i.clear=function(){for(var e in this.gridHash){var t=this.gridHash[e];for(var i in t){var n=t[i];n&&n.clear(),delete t[i],t[i]=null}delete this.gridHash[e],this.gridHash[e]=null}this.gridHash=[],this.passGridsArray.length=0},i.putItem=function(e,t,i){var n=this.gridHash[e];null==n&&(n=this.gridHash[e]=[]),1==(n[t]=i).type&&this.passGridsArray.push(i),this.length++},i.hasItem=function(e,t){var i=this.gridHash[e];return!(!i||!i[t])},i.takeItem=function(e,t){return this.gridHash[e]&&this.gridHash[e][t]?this.gridHash[e][t]:null},i.takeItemByKey=function(e){if(null==e)return null;var t=e.split("_"),i=parseInt(t[0]),n=parseInt(t[1]);return t.length=0,this.takeItem(i,n)},i.isGridPass=function(e){var t=this.takeItem(e.x,e.y);return!!t&&0!=t.walkType},i.getWalkTypeGridQuoteNumber=function(e){var t=this.takeItem(e.x,e.y);return t?t.quoteIndex:0},i.getWalkTypePassGrid=function(e,t){for(var i=new Array,n=e.x,s=e.y,o=n-t;o<=n+t;o++)for(var a=s-t;a<=s+t;a++){if(o+"_"+a!=e.x+"_"+e.y){var r=this.takeItem(o,a);r&&0<r.walkType&&!r.isBook&&i.push(PB.tileToPixels(new Uh(o,a)))}}return i},i.isTileMonstermoveenabled=function(e){var t=this.takeItem(e.x,e.y);return!(!(t&&0<t.walkType)||t.isBook)},i.getMinDisWithTar=function(e,t){for(var i=e.x,n=e.y,s=[],o=i-1;o<=i+1;o++)for(var a=n-1;a<=n+1;a++){if(o+"_"+a!=e.x+"_"+e.y){var r=this.takeItem(o,a);if(r&&0<r.walkType&&!r.isBook){var l=BB.distance(new Uh(o,a),t);s.push({dis:l,point:PB.tileToPixels(new Uh(o,a))})}}}return(s=ol.srotOn(s,"dis",Array.NUMERIC)).length?s[0].point:null},p(1,t,"instance",function(){return null==zwc.engine.core.displays.world.terrain.TileGroup._instance_&&(zwc.engine.core.displays.world.terrain.TileGroup._instance_=new t),zwc.engine.core.displays.world.terrain.TileGroup._instance_},zwc.engine.core.protos.Proto._$SET_instance),t._instance_=null,t}(),zH=function(e){function n(e,t,i){this._fileNames=null,this._classNames=null,this._zipFormat=!1,void 0===i&&(i=!1),n.__super.call(this),this._fileNames=e,this._classNames=t,this._zipFormat=i}b(n,"modules.gui.others.PanelWaitConfig",Ch);var t=n.prototype;return t._start=function(){HP.loadConfig(this._fileNames,this._classNames,ql.create(this,this.onConfigLoaded)),this._fileNames=null,this._classNames=null},t.onConfigLoaded=function(){this._finished=!0,this.laterCallback()},t._destroy=function(){this._fileNames=null,this._classNames=null},n}(),XH=function(e){function t(){t.__super.call(this)}b(t,"modules.gui.others.PanelWaitLayout",Ch);var i=t.prototype;return i._start=function(){this.openLayout()},i.openLayout=function(){hN.ins.isOpen(t.LayoutId)&&hN.ins.isDisplay(t.LayoutId)?this.onPanelOpen(t.LayoutId):(hN.ins.event.on("panel_open",this,this.onPanelOpen),hN.ins.open(t.LayoutId))},i.onPanelOpen=function(e){e==t.LayoutId&&(hN.ins.event.off("panel_open",this,this.onPanelOpen),this._finished=!0,this.laterCallback())},i._resume=function(){this.openLayout()},i._pause=function(){this._finished=!1,hN.ins.event.off("panel_open",this,this.onPanelOpen),null==hN.ins.currOpenLayoutId&&hN.ins.close(t.LayoutId)},i._destroy=function(){},t.LayoutId="LAYOUT",t}(),QH=function(e){function n(e){if(this._otherWaits=null,this._waitCount=0,this._waitCallbackBind=null,n.__super.call(this),this._otherWaits=[],e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];"function"==typeof i&&this._otherWaits.push(i.call(void 0))}this._waitCallbackBind=xs.bind(this,this.waitCallback)}b(n,"modules.gui.others.PanelWaitOthers",Ch);var t=n.prototype;return t._start=function(){var e=this,t=e._otherWaits.length;if(0==t)return e._waitCount=1,void e.waitCallback(e._id,e._data);e._waitCount=t;for(var i=0;i<t;i++)e._otherWaits[i].wait(e._id,e._data,e._waitCallbackBind)},t.waitCallback=function(e,t){this._waitCount--,0==this._waitCount&&(this._finished=!0,this.laterCallback())},t._resume=function(){var e=this._otherWaits.length;if(0==e)return this._waitCount=1,void this.waitCallback(this._id,this._data);this._waitCount=e;for(var t=0;t<e;t++)this._otherWaits[t].resume(this._data,this._waitCallbackBind)},t._pause=function(){for(var e=0;e<this._otherWaits.length;e++)this._otherWaits[e].pause();this._finished=!1},t._destroy=function(){for(var e=0;e<this._otherWaits.length;e++)this._otherWaits[e].destroy();this._otherWaits.length=0,this._otherWaits=null,this._waitCallbackBind=null},n}(),JH=function(e){function i(){this._assetMap=null,this._handlers=null,i.__super.call(this)}b(i,"modules.gui.others.PanelWaitPreload",Ch);var t=i.prototype;return t._start=function(){(i.waitPreload[this._id]=this)._finished=!0,this.laterCallback()},t._pause=function(){if(delete i.waitPreload[this._id],this._assetMap)for(var e in this._assetMap){this._assetMap[e].off("complete",this,this._assetLoaded)}this._handlers=null,this._finished=!1},t._resume=function(){(i.waitPreload[this._id]=this)._finished=!0,this.laterCallback()},t.load=function(e,t){var i=this;!i._assetMap&&(i._assetMap={}),!i._handlers&&(i._handlers={});var n=i._handlers[e]||(i._handlers[e]=[]);t&&n.push(t);var s=i._assetMap[e];null==s&&(s=i._assetMap[e]=GB.retain(e)),s.once("complete",i,i._assetLoaded)},t._assetLoaded=function(e){for(var t=e.url,i=this._handlers[t],n=0;n<i.length;n++)i[n].runWith(t);delete this._handlers[t]},t._destroy=function(){if(delete i.waitPreload[this._id],this._assetMap){for(var e in this._assetMap){var t=this._assetMap[e];t.off("complete",this,this._assetLoaded),GB.release(t)}this._assetMap=null}this._handlers=null},i.waitPreload={},i}(),ZH=function(e){function t(e){this._paths=null,this._assets=null,this._loadCount=0,this._p=null,t.__super.call(this),this._paths=e}b(t,"modules.gui.others.PanelWaitRes",Ch);var i=t.prototype;return i._start=function(){var e=this;e._loadCount=e._paths.length,e._assets=[];for(var t=0;t<e._paths.length;t++){var i=GB.retain(e._paths[t]);dN.ins.addRef(e._paths[t]),i.once("complete",e,e._assetLoaded),e._assets.push(i)}e._p=e._paths,e._paths=null},i._assetLoaded=function(){this._loadCount--,0==this._loadCount&&(this._finished=!0,this.laterCallback())},i._destroy=function(){var e=this;if(dN.ins.rmRefs(e._p),dN.ins.add(e._p),e._assets){for(var t=0;t<e._assets.length;t++){var i=e._assets[t];i.off("complete",e,e._assetLoaded),GB.release(i)}e._assets.length=0,e._assets=null}e._paths=null,e._p=null},t}(),KH=function(s){function a(){var e=this;e.random=0,e.luck=0,e.actorId=0,e.dragonIndex=0,e._disStrengthLv=0,e._disZhulingLv=0,e._disStoneLv=0,e.positionLevel=0,e._baseF=0,e._baseId=0,e._strengthF=0,e._strengthLv=0,e._spritF=0,e._spritLv=0,e._stoneF=0,e._stoneLv=0,a.__super.call(e)}b(a,"protos.backpack.DtoEquip",s);var e=a.prototype;return e.decode=function(e,t){var i=this;s.prototype.decode.call(i,e,t),i.random=e.readShort(),(1<=i.position&&i.position<=91||110<=i.position&&i.position<=115)&&(i.roleId=e.readByte()),i.luck=e.readByte();var n=e.readInt();i.dragonIndex=n<0?0:n+1,i.positionLevel=e.readInt()},e.getFuShuFight=function(){return this.getStrengthFight()+this.getSpritFight()+this.getStoneFight()},e.recover=function(){this.reset(),-1==a._instancePool_.indexOf(this)&&a._instancePool_.push(this)},e.reset=function(){var e=this;s.prototype.reset.call(e),e.random=e.luck=0,e._$1__baseF=e._$1__baseId=0,e._strengthF=e._strengthLv=0,e._spritF=e._spritLv=0,e._stoneF=e._stoneLv=0,e._disStrengthLv=e._disZhulingLv=e._disStoneLv=0,e.positionLevel=0},e.getBaseFight=function(){if(0<this.goodsId&&this._$1__baseId!=this.goodsId){this._$1__baseId=this.goodsId;var e=PR.getGoodsNewAttr(this._$1__baseId);this._$1__baseF=RR.calScoreValue(e,this.minRandom)}return this._$1__baseF},e.getBaseAttr=function(){return PR.getGoodsNewAttr(this.goodsId)},e.getBasePosAddFight=function(){return this.getBaseFight()},e.getBasePosFight=function(){var e=PR.getGoodsNewAttr(this.goodsId);return RR.calFightingValue(e,0)},e.getStrengthFight=function(){var e=this.strengthLv;if(0<e&&this._strengthLv!=e){this._strengthLv=e;var t=modules.strength.others.StrengthUtil.getStrenAttr(0<this.position?this.position:Bi.MODEL.decoratePosition(this.cfgIdx),this._strengthLv);this._strengthF=RR.getFight(t,-1,0,!1)}return this._strengthF},e.getSpritFight=function(){var e=this.zhulingLv;if(0<e&&this._spritLv!=e){this._spritLv=e;var t=modules.strength.others.StrengthUtil.getEnchantAttr(0<this.position?this.position:Bi.MODEL.decoratePosition(this.cfgIdx),this._spritLv);this._spritF=RR.getFight(t,-1,0,!1)}return this._spritF},e.getStoneFight=function(){var e=this.stoneLv;if(0<e&&this._stoneLv!=e){this._stoneLv=e;var t=modules.strength.others.StrengthUtil.getStoneProByP(0<this.position?this.position:Bi.MODEL.decoratePosition(this.cfgIdx),this._stoneLv);this._stoneF=RR.getFight(t,-1,0,!1)}return this._stoneF},e.getSuitFight=function(){return 0},p(0,e,"minRandom",function(){if(this.random<=0){var e=Bi.MODEL.randPropFac(this.cfgIdx);if(e){var t=e.split(",")[0];if(0<t)return.01*t}}return.01*this.random}),p(0,e,"randomRate",function(){return.01*this.random}),p(0,e,"posAddRate",function(){if(0<this.roleId&&0<this.position){var e=F.getExtAdd(this.position),t=(this.isOther?pR.ins.actorById(this.roleId):gR.ins.actorById(this.roleId)).getAttrById(e);return isNaN(t)?0:1e-4*t}return 0}),p(0,e,"strengthLv",function(){if(51==this.position)return 0;if(0<this.roleId&&la.isNormal(this.position)){var e=0;return e=this.isOther?pR.ins.actorById(this.roleId-1).strengthTotalLv:gR.ins.actorById(this.roleId).strengthTotalLv,modules.strength.others.StrengthUtil.getPartLvl(e,this.position)}return this._disStrengthLv}),p(0,e,"isThunderEqu",function(){return 0<Bi.MODEL.thunderStar(this.cfgIdx)}),p(0,e,"baseFight",function(){return this.getBaseFight()}),p(0,e,"fight",function(){var e=PR.getGoodsNewAttr(this.goodsId);return Math.ceil(RR.getFight(e,-1,this.minRandom,!1)+this.getStrengthFight()+this.getSpritFight()+this.getStoneFight())}),p(0,e,"sorce",function(){return this.getBasePosAddFight()}),p(0,e,"isSoaringEquip",function(){return 15==Bi.MODEL.subType(this.cfgIdx)}),p(0,e,"stoneLv",function(){if(0<this.roleId&&la.isNormal(this.position)){var e=0;return e=this.isOther?pR.ins.actorById(this.roleId-1).stoneTotalLv:gR.ins.actorById(this.roleId).stoneTotalLv,modules.strength.others.StrengthUtil.getPartLvl(e,this.position)}return this._disStoneLv}),p(0,e,"zhulingLv",function(){if(51==this.position)return 0;if(0<this.roleId&&la.isNormal(this.position)){var e=0;return e=this.isOther?pR.ins.actorById(this.roleId-1).spriteTotalLv:gR.ins.actorById(this.roleId).spriteTotalLv,modules.strength.others.StrengthUtil.getPartLvl(e,this.position)}return this._disZhulingLv}),p(0,e,"isGodEqu",function(){return eN.ins.isGodEquip(this.goodsId)}),p(0,e,"isFuWen",function(){return 6==LR.judgeKind(this.goodsId)}),p(0,e,"isSoaringInterior",function(){return ca.isSoaringInteriors(this.goodsId)}),p(0,e,"isJzGodEequ",function(){return 0<Bi.MODEL.isGodEquip(this.cfgIdx)}),p(0,e,"iswingequ",function(){return 0<=la.SWING.indexOf(Bi.MODEL.decoratePosition(this.cfgIdx))}),p(0,e,"magicStarLevel",function(){return Bi.MODEL.magicStarLevel(this.cfgIdx)}),a.createStr=function(e){var t,i=yh.getObj(e)[0].value.split(":"),n=aR.getBykey(i[0]),s=0,o=0;return o=n?(s=n.itemId,i[1]):(s=parseInt(i[0]),parseInt(i[1])),(t=0<a._instancePool_.length?a._instancePool_.pop():new a).setGoodsId(s),t.goodsNum=o,t},a.create=function(e,t,i,n,s){var o;return void 0===t&&(t=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),e|=0,t|=0,(o=0<a._instancePool_.length?a._instancePool_.pop():new a).setGoodsId(e),o.goodsNum=t,o._disStrengthLv=i,o._disZhulingLv=n,o._disStoneLv=s,o},a._instancePool_=[],a}(yB),$H=function(e){function l(e,t,i,n,s,o,a){var r=this;r.iconWidth=94,r.iconHeight=94,r.btn=null,r._iconL=null,r._effL=null,r._timeL=null,r._bubbleL=null,r._eff=null,r._textBg=null,r._text=null,r._textState=null,r._iconId=0,r._time=0,r.bSkin=null,r.tSkin=null,r.bgSkin=null,r.index=0,r.isFullBg=!0,r._p=null,r._status=-1,r._curbSkin=null,r._needUpdate=!1,r.iconTip=null,r._bubbleNameStr=null,void(r.showType=0)===n&&(n=90),void 0===s&&(s=90),l.__super.call(r),r._iconId=e,r._iconL=t,r._effL=i,r._timeL=o,r._bubbleL=a,r.iconWidth=n,r.iconHeight=s,modules.nav.views.item.NavActIcon.batch=19<++modules.nav.views.item.NavActIcon.batch?10:modules.nav.views.item.NavActIcon.batch,G.timer.frameOnce(modules.nav.views.item.NavActIcon.batch,r,r.updateSkin),r.on("display",r,r.onRemove)}b(l,"modules.nav.views.item.NavActIcon",ph);var t=l.prototype;return t.onLoad=function(){this._needUpdate?this.updateSkin():this.createBtn(),this.updateTime()},t.createBtn=function(){var e=this;e.index=kt.getIndex(e._iconId),3==kt.MODEL.index(e.index)?e.isFullBg=!1:e.isFullBg=!0;var t=!1;null==e.btn?(t=!0,e.btn=kB.createTipButton(e.bSkin,e.tSkin,0,0,e.iconWidth,e.iconHeight,1)):(e.btn.skin=e.bSkin,e.btn.tipSkin=e.tSkin),e.btn.on("mouseover",e,e.btnOver),e.btn.on("mouseout",e,e.btnOut),e.btn.dataSource={iconId:e._iconId,name:kt.MODEL.iconName(e.index)},e._iconL.addChildAt(e.btn,0),e._p&&e.btn.pos(e._p.x,e._p.y),-1!=e._status&&e.updateStatus(e._status),e.setBubble(t)},t.btnOver=function(e){this.btn&&(this.btn.filters=A_.getGrayFilter2())},t.btnOut=function(e){this.btn&&(this.btn.filters=null)},t.pos=function(e,t){this._p?this._p.setTo(e,t):this._p=new Uh(e,t),this.btn&&(this.btn.pos(e,t),this.updateEffectPos(),this.resetTipLoc())},t.setCountTime=function(e){this._time=e,this.updateTime(),37==this._iconId&&this.updateSkin()},t.updateSkin=function(){var e=this;e.btn&&e.iconTip&&e.resetTipLoc();var t=kt.getIndex(e._iconId);if(37==e._iconId&&null!=Jh.getInStance().toc12003){var i=io.getIndex(Jh.getInStance().toc12003.showId),n=io.MODEL.iconResource(i);e.bSkin=_r.getAtlasSubPath("mainicons_mix/"+n+".png")}else 12==e._iconId&&7<dr.getOpenServiceDay()?15<dr.getOpenServiceDay()?e.bSkin=_r.getAtlasSubPath("mainicons_mix/hdan_btn_mzhd.png"):e.bSkin=_r.getAtlasSubPath("mainicons_mix/hdan_btn_szhd.png"):e.bSkin=_r.getAtlasSubPath("mainicons_mix/"+kt.MODEL.icon(t)+".png");if(e.tSkin=_r.getAtlasSubPath("mainicons_mix/ty_ts_hd.png"),e.bgSkin=_r.getAtlasSubPath("mainicons_mix/img_djs.png"),e._curbSkin&&e._curbSkin!=e.bSkin&&!G.loader.getRes(e._curbSkin)&&(e._needUpdate=!0),e._curbSkin=e.bSkin,G.loader.getRes(e.bSkin))e.createBtn();else{var s=[{url:e.bSkin,type:"image"},{url:e.tSkin,type:"image"},{url:e.bgSkin,type:"image"}];G.loader.load(s,ql.create(e,e.onLoad),null,"image")}},t.clear=function(){var e=this;e._eff&&(e._eff.parent&&e._eff.parent.removeChild(e._eff),e._eff.dispose(),e._eff=null),e.btn&&e.btn.destroy(),e._textBg&&e._textBg.destroy(),e._text&&e._text.destroy(),e._textState&&e._textState.destroy(),e.removeIconTip()},t.onRemove=function(){this.removeIconTip()},t.updateTime=function(){var e=this;if(e.btn){var t=kt.getIndex(e._iconId),i=kt.MODEL.showPrediction(t);e._time>dr.serverTimeSec?(e._textBg||(e._textBg=kB.createImage(e.bgSkin,0,48,e.btn.width,20,e.btn),e._timeL.addChild(e._textBg)),e._text||(e._text=kB.createText(e._textBg.x,e._textBg.y,e.btn.width,20,"",20,"#23b11f"),e._timeL.addChild(e._text)),e._textBg&&e._textBg.pos(e.btn.x+0,e.btn.y+48),e._text&&e._text.pos(e._textBg.x,e._textBg.y),e._text&&e._text.changeText(Jp.simpleFormat(e._time-dr.serverTimeSec)),e._text&&(e._text.color="#23b11f")):(null!=e._textBg&&Tu.sendToModule("ICON_TIME_OVER",["modules.broadcast.BroadcastModule"]),e._textBg&&e._textBg.removeSelf(),e._textBg=null,e._text&&e._text.removeSelf(),e._text=null,1==i?e.showText("进行中"):e.showText(null))}},t.showText=function(e,t){var i=this;void 0===t&&(t="#23b11f"),null!=e?(i._textState||(i._textState=kB.createText(i.btn.x+0,i.btn.y+48,i.btn.width,20,"",20,t),i._timeL.addChild(i._textState)),i._textState&&i._textState.pos(i.btn.x+0,i.btn.y+48),i._textState.changeText(e),i._textState.color=t):(i._textState&&i._textState.removeSelf(),i._textState=null)},t.updateStatus=function(e){this._status=e,this.btn&&(this.updateEffectPos(),this.btn.showTip=2<=e,Tu.sendToModule("ICON_POS_CHANGED",["modules.recharge.RechargeModule","modules.guild.GuildModule","modules.yzbqc.YzbqcModule"]))},t.updateEffectPos=function(){switch(this._status){case 0:case 2:this.clearIconEffect(this._iconId);break;case 1:case 3:this.showIconEffect(this._iconId)}},t.clearIconEffect=function(e){this._eff&&(this._eff.parent&&this._eff.parent.removeChild(this._eff),this._eff.dispose(),this._eff=null)},t.showIconEffect=function(e){var t=this;if(t._p||(t._p=new Uh(t.btn.x,t.btn.y)),t._eff)3==kt.MODEL.index(t.index)?t._eff.pos(t._p.x+67,t._p.y+67):t._eff.pos(t._p.x+47,t._p.y+47);else{var i=kt.MODEL.effectId(kt.getIndex(e));t._eff=kB.createEffect(i,45,45,null,i),t._eff.autoClear=!1,t._effL.addChildAt(t._eff,0),3==kt.MODEL.index(t.index)?(t._eff.scale_X=1.2,t._eff.scale_Y=1.2,t._eff.pos(t._p.x+67,t._p.y+67)):t._eff.pos(t._p.x+47,t._p.y+47)}},t.setBubble=function(e){var t;if(void 0===e&&(e=!1),null!=(t=kt.MODEL.bubble(this.index))&&""!=t&&"NaN"!=t){var i,n=t.split("|");if(n[1]&&(i=n[1].split(",")),i&&!(i.length<1))if(this.showType=parseInt(n[0]),1==this.showType){if(!e)return;for(var s=0;s<i.length;s++)if(gR.ins.lv==parseInt(i[s])){this.showBubble();break}}else{if(gR.ins.lv<parseInt(i[0]))return;this.showBubble()}}},t.showBubble=function(){if(0<Ui.count)this.onJxrComplete();else{var e=[{url:_r.getJxrDBPath("IconBubble"),type:"arraybuffer",cls:Ui}];uc.ins().onLoadJxrs(e,ql.create(this,this.onJxrComplete))}},t.onJxrComplete=function(){var e=this;if(e.removeIconTip(),1==e.showType||-1==l.SHOW_IDS.indexOf(e._iconId)&&-1==l.SHOW_LEFT_ID.indexOf(e._iconId)){if("NaN"==dr.getOpenServiceDay().toString()||dr.getOpenServiceDay()<1)return G.timer.frameLoop(500,e,e.onJxrComplete),void(null==e.parent&&(e.removeIconTip(),G.timer.clear(e,e.onJxrComplete)));G.timer.clear(e,e.onJxrComplete);var t,i;if(!((i=LN.getShowID(e._iconId))<0)){t=Ui.MODEL.content(i);var n=2==kt.MODEL.index(e.index)?1:5;if(!e.iconTip){e.iconTip=$Q.addShow(t,e._bubbleL,0,0,!0,n);e.btn.dataSource.name,e.btn.dataSource.iconId;e.iconTip.name=e.btn.dataSource.name+e.btn.dataSource.iconId,2==kt.MODEL.index(e.index)?l.SHOW_IDS.push(e._iconId):l.SHOW_LEFT_ID.push(e._iconId)}e.resetTipLoc()}}else G.timer.clear(e,e.onJxrComplete)},t.resetTipLoc=function(){if(this.iconTip){var e=2==kt.MODEL.index(this.index)?1:5;this.iconTip.updatePosition(this.btn,e)}},t.removeIconTip=function(){var e=this;if(e._bubbleL&&e.btn&&e.btn.dataSource&&e.btn.dataSource.name&&e.btn.dataSource.iconId){var t=e.btn.dataSource.name+e.btn.dataSource.iconId;e.iconTip=e._bubbleL.getChildByName(t)}e.iconTip&&(e.iconTip.removeSelf(),e.iconTip.destroy(),e.iconTip=null)},l.SHOW_IDS=[],l.SHOW_LEFT_ID=[],l.batch=10,l}(),eV=function(e){function t(){this.type=0,this.vos=null,this.currentIndex=0,t.__super.call(this),this.packId=11402}b(t,"protos.achieve.toc_11402",Of);var i=t.prototype;return i.decode=function(e){this.type=e.readByte();var t=e.readByte();this.vos=[];for(var i=0;i<t;++i){var n=new vB;n.type=this.type,n.decode(e,!1),this.vos.push(n)}},i.dispose=function(){this.vos&&(this.vos.length=0,this.vos=null),zwc.engine.core.protos.Proto.prototype.dispose.call(this)},t}(),tV=function(e){function t(){this.type=0,this.activityVo=null,t.__super.call(this),this.packId=11403}return b(t,"protos.achieve.toc_11403",Of),t.prototype.decode=function(e){this.activityVo=new vB,this.activityVo.decode(e)},t}(),iV=function(e){function t(){this.activityIds=null,this.mainType=0,this.fActivityIds=null,this.awarderIds=null,this.isPlayerActivity=0,this._byte=null,t.__super.call(this),this.packId=12202}b(t,"protos.activity.toc_12202",Of);var i=t.prototype;return i.decode=function(e){if(this._byte=e,0<It.count)this.onJxrComplete();else{var t=[{url:_r.getJxrDBPath("ConfigActivity"),type:"arraybuffer",cls:It}];uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete))}},i.onJxrComplete=function(){if(0==wn.count){var e=[{url:_r.getJxrDBPath("ConfigPlayerActivity"),type:"arraybuffer",cls:wn}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}else this.onAanalyze()},i.onLoad=function(e){var t=G.loader.getRes(e.url);if(t){uc.ins().onLoadComplete(e),It.bytes=new mt(t);for(var i=It.bytes.readShort(),n=0;n<i;n++)It.config(It.count+n);It.count=It.count+i}this.onAanalyze()},i.onAanalyze=function(){this.isPlayerActivity=this._byte.readByte();var e=this._byte.readByte(),t=0;for(this.activityIds=[],this.fActivityIds=[],this.awarderIds=[],t=0;t<e;++t){var i=this._byte.readInt(),n=this._byte.readByte();if(0==this.activityIds.length)this.activityIds.push(i);else for(var s=this.activityIds.length-1,o=0;o<this.activityIds.length;++o){var a=It.getIndex(i),r=It.MODEL.sort(a);a=It.getIndex(this.activityIds[o]);var l=It.MODEL.sort(a);if(r<l){this.activityIds.splice(o,0,i);break}if(r==l&&i<this.activityIds[o]){this.activityIds.splice(o,0,i);break}if(o==s){this.activityIds.push(i);break}}1==n?this.fActivityIds.push(i):2==n&&this.awarderIds.push(i)}this.mainType=this._byte.readInt(),13==this.mainType?Tu.sendToModule("DEALACITVITY",["modules.activity.ActivityModule"],this):1003==this.mainType?(mB.getInStance().setMainType(this),XR.initMainConfig(),WB.getActivityData(XR.curaId,ql.create(this,function(){XR.initShowConfig(),Tu.sendToModule("DEALACITVITY",["modules.dailygift.DailyGiftModule"],this)}))):mB.getInStance().setMainType(this),WB.runComplete()},t}(),nV=function(e){function t(){var e=this;e.activityId=0,e.type=0,e.starTime=0,e.endTime=0,e.leftTime=0,e.refreshtime=0,e.gifts=null,e.ranks=null,e.rankValue=NaN,e.rankLevel=0,e.myRank=0,e.rankType=0,e.exchangeList=null,e.shopitemList=null,e.growth=0,e.share=!1,t.__super.call(e),e.packId=12204}return b(t,"protos.activity.toc_12204",Of),t.prototype.decode=function(e){var t=this;t.activityId=e.readShort(),t.type=e.readInt(),t.starTime=e.readInt(),t.endTime=e.readInt(),t.leftTime=e.readInt();var i=0,n=0;switch(t.type){case 1:for(t.gifts=[],i=e.readByte(),n=0;n<i;++n){var s=new SH;s.decode(e),t.gifts.push(s)}break;case 2:for(t.rankType=e.readByte(),i=e.readByte(),t.ranks=[],n=0;n<i;++n){var o=new R;o.decode(e,t.rankType,n,t.activityId),t.ranks.push(o)}1==t.rankType?(t.rankValue=e.readByte(),t.rankLevel=e.readShort()):5==t.rankType?t.rankValue=yt.readLong64(e):t.rankValue=e.readInt(),t.myRank=e.readInt();break;case 3:case 14:for(t.gifts=[],i=e.readByte(),n=0;n<i;++n){var a=new SH;a.decode2(e),t.gifts.push(a)}break;case 10:for(t.exchangeList=[],i=e.readByte(),n=0;n<i;++n)t.exchangeList.push({exId:e.readInt(),exTimes:e.readByte()});break;case 13:var r;for(t.refreshtime=yt.readLong64(e),t.shopitemList=[],i=e.readByte(),n=0;n<i;++n)(r=new A).activityId=t.activityId,r.tab=5,r.serviceIndex=n,r.decode2(e),t.shopitemList.push(r);break;case 15:var l;for(t.refreshtime=yt.readLong64(e),t.shopitemList=[],i=e.readShort(),n=0;n<i;++n)(l=new P).activityId=t.activityId,l.tab=6,l.serviceIndex=n,l.decode3(e),t.shopitemList.push(l);break;case 17:for(t.exchangeList=[],i=e.readByte(),n=0;n<i;++n)t.exchangeList.push({exId:e.readInt(),exTimes:e.readInt()});for(t.gifts=[],i=e.readByte(),n=0;n<i;++n){var c=new SH;c.giftId=e.readInt(),c.status=e.readByte(),c.currentNum=yt.readLong64(e),t.gifts.push(c)}break;case 18:t.growth=e.readInt();break;case 19:t.growth=yt.readLong64(e),t.rankValue=e.readInt();break;case 24:for(t.gifts=[],i=e.readByte(),n=0;n<i;++n){var u=new SH;u.decode2(e),t.gifts.push(u)}for(t.growth=yt.readLong64(e),i=e.readByte(),t.shopitemList=[],n=0;n<i;++n)t.shopitemList.push({pn:e.readUTF(),ps:e.readInt(),sex:e.readByte(),job:e.readByte()});break;case 1e3:for(t.share=e.readBoolean(),t.growth=e.readByte(),i=e.readByte(),t.exchangeList=[],n=0;n<i;++n)t.exchangeList.push(e.readInt())}t.gifts&&(t.gifts=ol.srotOn(t.gifts,"giftId",Array.NUMERIC))},t}(),sV=function(e){function t(){this.gift=null,t.__super.call(this),this.packId=12206}b(t,"protos.activity.toc_12206",Of);var i=t.prototype;return i.decode=function(e){if(0<St.count)this.onJxrComplete(e);else{var t=[{url:_r.getJxrDBPath("ConfigActivityGift"),type:"arraybuffer",cls:St},{url:_r.getJxrDBPath("ConfigActivityLimitBuy"),type:"arraybuffer",cls:zi}];uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete,[e]))}},i.onJxrComplete=function(e){this.gift=new SH,this.gift.decode(e)},t}(),oV=function(e){function t(){this.gift=null,t.__super.call(this),this.packId=12208}return b(t,"protos.activity.toc_12208",Of),t.prototype.decode=function(e){this.gift=new SH,this.gift.decode2(e)},t}(),aV=function(e){function t(){this.activityId=0,this.giftList=null,t.__super.call(this),this.packId=30905}return b(t,"protos.activity.toc_30905",Of),t.prototype.decode=function(e){this.activityId=e.readInt(),this.giftList=[];for(var t=e.readByte(),i=0;i<t;i++){var n=new SH;n.decodePlayer(e),this.giftList.push(n)}this.giftList=ol.srotOn(this.giftList,"giftId",Array.NUMERIC)},t}(),rV=function(e){function t(){this.gift=null,t.__super.call(this),this.packId=30907}return b(t,"protos.activity.toc_30907",Of),t.prototype.decode=function(e){this.gift=new SH,this.gift.decodePlayer(e)},t}(),lV=function(e){function t(){this.activityId=0,this.giftList=null,t.__super.call(this),this.packId=30909}return b(t,"protos.activity.toc_30909",Of),t.prototype.decode=function(e){this.activityId=e.readInt(),this.giftList=[];for(var t=e.readByte(),i=0;i<t;i++){var n=new SH;n.decode2(e),this.giftList.push(n)}this.giftList=ol.srotOn(this.giftList,"giftId",Array.NUMERIC)},t}(),cV=function(t){function e(){e.__super.call(this),this.packId=23714}return b(e,"protos.actor.Actor_Back_LimitZhuiJiEnd_toc_23714",t),e.prototype.decode=function(e){t.prototype.decode.call(this,e),gR.ins.limitZhuiJiSkillID=0,gR.ins.limitZhuiJiTime=0},e}(Of),uV=function(t){function e(){e.__super.call(this),this.packId=23713}return b(e,"protos.actor.Actor_Back_LimitZhuiJi_toc_23713",t),e.prototype.decode=function(e){t.prototype.decode.call(this,e),gR.ins.limitZhuiJiSkillID=e.readInt(),gR.ins.limitZhuiJiTime=yt.readLong64(e)},e}(Of),dV=function(n){function e(){e.__super.call(this),this.packId=31023}return b(e,"protos.actor.Actor_back_ZhuiJISkill_toc_31023",n),e.prototype.decode=function(e){n.prototype.decode.call(this,e);for(var t=0,i=0;i<gR.ins.zhuijiSkill.length;i++)t=e.readInt(),gR.ins.zhuijiSkill[i]=t},e}(Of),hV=function(e){function t(){this.newActor=null,t.__super.call(this),this.packId=10204}return b(t,"protos.actor.toc_10204",Of),t.prototype.decode=function(e){this.newActor=tR.create(e),gR.ins.actorList[this.newActor.id-1]=this.newActor},t}(),_V=function(e){function t(){this.list=null,this.isShow=0,t.__super.call(this),this.packId=10205}return b(t,"protos.actor.toc_10205",Of),t.prototype.decode=function(e){this.list=[];for(var t=e.readByte(),i=0,n=NaN,s=NaN,o=(gR.ins,0);o<t;o++)i=e.readByte(),s=yt.readLong64(e),n=aR.setValueById(i,s),this.list[o]={type:i,value:n};this.isShow=e.readInt()},t}(),fV=function(e){function t(){this.lv=0,this.upgradeTime=0,this.isUp=!1,t.__super.call(this),this.packId=10206}b(t,"protos.actor.toc_10206",Of);var i=t.prototype;return i.decode=function(e){var t=e.readShort();this.lv=t-gR.ins.lv,0<gR.ins.lv&&(this.isUp=!0),gR.ins.lv=t,0<this.lv&&0<t&&G.timer.once(1500,this,this.delayReport,null,!1),gR.ins.maxExp=yt.readLong64(e),this.upgradeTime=e.readInt()},i.delayReport=function(){dr.nativeAndroid?BP.app_reportRole("role_update",{zsLv:gR.ins.zsLv}):jP.sdk_cmd("report_levelup")},t}(),pV=function(e){function t(){this.value,t.__super.call(this),this.packId=10207}return b(t,"protos.actor.toc_10207",Of),t.prototype.decode=function(e){gR.ins.exp=yt.readLong64(e),this.value=yt.readLong64(e)},t}(),gV=function(e){function t(){t.__super.call(this),this.packId=10210}return b(t,"protos.actor.toc_10210",Of),t.prototype.decode=function(e){gR.ins.showId=e.readByte()},t}(),vV=function(e){function t(){t.__super.call(this),this.packId=10212}return b(t,"protos.actor.toc_10212",Of),t.prototype.decode=function(e){var t=pR.ins;t.charId=yt.readLong64(e)+"",t.charName=e.readUTF(),t.guildName=e.readUTF(),t.lv=e.readInt(),t.zsLv=e.readInt();var i,n,s=0,o=e.readByte();for(s=0;s<o;s++){var a=e.readByte();s<t.actorList.length?((i=t.actorList[s]).equips.reset(),i.id=a):(i=new tR(a),t.actorList.push(i)),i.job=e.readByte(),i.sex=e.readByte(),i.mid=e.readUTF(),i.wid=e.readUTF(),i.wgid=e.readUTF(),i.weaponSoulId=e.readUTF(),i.force=yt.readLong64(e),i.jmCfgId=e.readShort(),i.xzCfgId=e.readShort(),i.dpCfgId=e.readShort(),i.mbAdvCfgId=e.readShort(),i.hsAdvCfgId=e.readShort(),i.fuhuoRingLv=e.readShort(),i.shenliRingLv=e.readShort(),i.wingData.id=e.readShort(),i.strengthTotalLv=e.readShort(),i.stoneTotalLv=e.readShort(),i.spriteTotalLv=e.readShort(),i.hyCfgId=e.readShort(),i.hyAdvCfgId=e.readShort(),i.sjCfgId=e.readShort(),i.sjAdvCfgId=e.readShort(),i.chuanshiId=e.readUTF()}for(t.actorList.length=o,o=e.readShort(),s=0;s<o;s++){var r=e.readInt();(n=new KH).decode(e,r),n.isOther=!0,(i=t.actorList[n.roleId-1])&&i.equips.add(n,!1)}t.passHash=RN.ins.doDecode(e);var l=e.readShort(),c=0,u=0;for(s=0;s<l;s++)c=e.readByte(),u=e.readByte(),t.actorList[c-1]&&(t.actorList[c-1].wingData.wingActive=u)},t}(),mV=function(e){function t(){this.type=0,this.cfgId=0,this.actor=0,t.__super.call(this),this.packId=21106}b(t,"protos.actor.toc_21106",Of);var i=t.prototype;return i.decode=function(e){var t=this;t.type=e.readByte(),t.cfgId=e.readShort(),t.actor=e.readByte();var i=gR.ins.actorList[t.actor-1];t.type==fa.JM.type?i.jmCfgId=t.cfgId:t.type==fa.MB.type?i.mbCfgId=t.cfgId:t.type==fa.HS.type?i.hsCfgId=t.cfgId:t.type==fa.XZ.type?i.xzCfgId=t.cfgId:t.type==fa.DP.type?i.dpCfgId=t.cfgId:t.type==fa.HY.type?i.hyCfgId=t.cfgId:t.type==fa.SJ.type?i.sjCfgId=t.cfgId:t.type==fa.QH.type&&(i.qhCfgId=t.cfgId);var n=Dn.getIndex(t.cfgId);if(1==Dn.MODEL.level(n)&&t.type!=fa.JM.type){if(t.type==fa.HS.type||t.type==fa.HY.type?Tu.sendToModule("RING_DRESS",["modules.thunder.ThunderModule"],t.type):Tu.sendToModule("RING_DRESS",["modules.actor.ActorModule"],t.type),t.type!=fa.XZ.type&&t.type!=fa.DP.type){var s=iH.ins.getDefaultCfgId(t.type,!0),o=On.getIndex(s),a=On.MODEL.effect(o),r=On.MODEL.tipsName(o);(hN.ins.isOpen("RING_VIEW")||hN.ins.isOpen("ACTOR_M")||hN.ins.isOpen("THUNDER_EQUIP"))&&(Tu.sendToModule("OPEN_FUNC_ACTIVE",["modules.actor.ActorModule"],{name:r,effect:a,offsetY:100}),G.timer.once(300,t,t.updateRingTips,[{selectIdx:t.actor-1,equipType:t.type,isMe:!0}]))}if(t.type==fa.SJ.type){var l=iH.ins.getDefaultCfgId(t.type,!0);iH.ins.addSkill(t.actor,l)}}},i.updateRingTips=function(e){},t}(),yV=function(e){function t(){this.lv_change=0,this.xw_change=0,t.__super.call(this),this.packId=21109}return b(t,"protos.actor.toc_21109",Of),t.prototype.decode=function(e){var t=gR.ins,i=e.readShort();this.lv_change=i-t.zsLv,t.zsLv=i;var n=yt.readLong64(e);this.xw_change=n-t.zsExp,t.zsExp=n},t}(),IV=function(e){function t(){this.step=0,this.level=0,this.roleIdx=0,this.active=0,t.__super.call(this),this.packId=21110}return b(t,"protos.actor.toc_21110",Of),t.prototype.decode=function(e){gR.ins.newWingOpenArr||(gR.ins.newWingOpenArr=[]);for(var t=e.readShort(),i=0;i<t;i++){this.step=e.readShort();var n=yt.readLong64(e);this.roleIdx=e.readByte();var s=gR.ins.actorList[this.roleIdx-1];s.wingData.curWingExp=n,s.wingData.starUp=this.step>s.wingData.wingStep?1:0,s.wingData.wingStep=this.step,s.wingData.zhizidan=e.readInt(),s.wingData.feishengdan=e.readInt();var o,a=e.readInt();gR.ins.canActive(this.roleIdx)&&(s.wingData.activeHandler=!0),o={roleindex:this.roleIdx,isActive:a},gR.ins.newWingOpenArr.push(o);var r=e.readInt();s.wingData.levelUp=r>s.wingData.wingStar?1:0,s.wingData.wingStar=r,s.wingData.id=xR.getIdByStepAndLevel(this.step,r),10<=this.step?s.wingData.isMaxLevel=0<=r:s.wingData.isMaxLevel=10<=r}gR.ins.isBuyGift=e.readByte()},t}(),bV=function(e){function t(){t.__super.call(this),this.packId=25010}return b(t,"protos.actor.toc_25010",Of),t.prototype.decode=function(e){var t=pR.ins;t.charId=yt.readLong64(e)+"",t.charName=e.readUTF(),t.guildName=e.readUTF(),t.lv=e.readInt(),t.zsLv=e.readInt();var i,n,s=0,o=e.readByte();for(s=0;s<o;s++){var a=e.readByte();s<t.actorList.length?((i=t.actorList[s]).equips.reset(),i.id=a):(i=new tR(a),t.actorList.push(i)),i.job=e.readByte(),i.sex=e.readByte(),i.mid=e.readUTF(),i.wid=e.readUTF(),i.wgid=e.readUTF(),i.weaponSoulId=e.readUTF(),i.force=yt.readLong64(e),i.jmCfgId=e.readShort(),i.xzCfgId=e.readShort(),i.dpCfgId=e.readShort(),i.mbAdvCfgId=e.readShort(),i.hsAdvCfgId=e.readShort(),i.fuhuoRingLv=e.readShort(),i.shenliRingLv=e.readShort(),i.wingData.id=e.readShort(),i.strengthTotalLv=e.readShort(),i.stoneTotalLv=e.readShort(),i.spriteTotalLv=e.readShort(),i.hyCfgId=e.readShort(),i.hyAdvCfgId=e.readShort(),i.sjCfgId=e.readShort(),i.sjAdvCfgId=e.readShort(),i.chuanshiId=e.readUTF()}for(t.actorList.length=o,o=e.readShort(),s=0;s<o;s++){var r=e.readInt();(n=new KH).decode(e,r),n.isOther=!0,(i=t.actorList[n.roleId-1]).equips.add(n,!1)}t.passHash=RN.ins.doDecode2(e);var l=e.readShort(),c=0,u=0;for(s=0;s<l;s++)c=e.readByte(),u=e.readByte(),t.actorList[c-1]&&(t.actorList[c-1].wingData.wingActive=u)},t}(),wV=function(e){function d(){d.__super.call(this),this.packId=31021}return b(d,"protos.actor.toc_31021",Of),d.prototype.decode=function(e){var t=e.readInt();gR.ins.actorFlyUpLevel=t,BR.ins.checkCopyId(BR.ins.curCopyId,43)||1<=t&&(1==t&&1==HR.ins.isFirstLogin?(HR.ins.isFirstLogin=0,HR.ins.timeoutFlayBoss()):HR.ins.isFirstLogin=0);var i,n=uH.heroQueue,s=0;for(var o in n)s=t,(i=n[o]).hero_id<4&&0<s&&(i.setCharFlyupNameVisible(!0),i.setflyupName(s));for(var a=e.readShort(),r=[],l=0;l<a;l++){var c=e.readInt(),u=e.readInt();if(r[c]=u,d._lastZhuijiSkillLevels.hasOwnProperty(c))d._lastZhuijiSkillLevels[c];d._lastZhuijiSkillLevels[c]=u}gR.ins.zhuijiSkillLevels=r,Tu.sendToModule("ZHUIJI_SKILL_ACTIVED",["modules.actor.ActorModule"])},d._lastZhuijiSkillLevels=[],d}(),xV=function(e){function t(){this.gridNum=0,this.goodsList=null,t.__super.call(this),this.packId=10401}return b(t,"protos.backpack.toc_10401",Of),t.prototype.decode=function(e){var t;this.gridNum=e.readShort(),this.goodsList=[];for(var i=e.readShort(),n=0;n<i;n++){var s=e.readInt();(t=1==yt.readBit(s,0,1)?new KH:new yB).decode(e,s);var o=e.readUTF();if(o&&0<=o.indexOf("random")){var a=JSON.parse(o);a.random&&(t.buffs=a.random)}t.moEquipScore=yt.readLong64(e),t.usedCountDay=e.readInt(),this.goodsList.push(t)}},t}(),SV=function(e){function t(){this.goodsList=null,this.flyBool=!1,t.__super.call(this),this.packId=10402}return b(t,"protos.backpack.toc_10402",Of),t.prototype.decode=function(e){var t;this.goodsList=[];for(var i=e.readShort(),n=0;n<i;n++){var s=e.readInt();(t=1==yt.readBit(s,0,1)?new KH:new yB).decode(e,s);var o=e.readUTF();if(o&&0<=o.indexOf("random")){var a=JSON.parse(o);a.random&&(t.buffs=a.random)}t.moEquipScore=yt.readLong64(e),t.usedCountDay=e.readInt(),this.goodsList.push(t)}this.flyBool=1==e.readByte()},t}(),kV=function(e){function t(){this.map=null,this.challengeCount=0,t.__super.call(this),this.packId=21209}return b(t,"protos.boss.toc_21209",Of),t.prototype.decode=function(e){var t,i;this.map={},BR.ins.bossPersonHash=new jl,this.challengeCount=0;for(var n=e.readByte(),s=0;s<n;s++){var o=e.readInt(),a=e.readByte(),r=e.readInt();1==a&&this.challengeCount++,(t=new Object).id=o,t.status=a,t.passTimes=r,i=new ct(t),BR.ins.bossPersonHash.put(i.copyID,i),this.map[o]=a}},t}(),EV=function(e){function t(){this.clCount=0,this.maxClCount=0,this.hfTime=0,this.map=null,t.__super.call(this),this.packId=21210}return b(t,"protos.boss.toc_21210",Of),t.prototype.decode=function(e){var t=this;t.clCount=e.readShort(),t.maxClCount=e.readShort(),t.clCount<0&&(t.clCount=0),t.hfTime=e.readInt(),t.clCount>=t.maxClCount&&(t.hfTime=0),t.map={},BR.ins.bossWildHash=new jl;for(var i,n,s=e.readByte(),o=0;o<s;o++){var a=e.readInt(),r=e.readInt();0<r&&(r=dr.curServerTime+1e3*r);var l=yt.readLong64(e),c=e.readShort(),u=0==e.readByte(),d=rn.getIndex(a),h=rn.MODEL.levelLimit(d),_=rn.MODEL.zsLevelLimit(d),f=rn.MODEL.lunHuiLevelLimit(d),p=rn.MODEL.missionSeq(d);t.map[a]={time:r,blood:l,person:c,selected:u,level:h,zsLevel:_,lhId:f,missionSeq:p};var g=1==e.readByte();(i=new Object).id=a,i.person=c,i.isFirstKill=g,n=new ut(i),BR.ins.bossWildHash.put(n.copyID,n)}},t}(),TV=function(e){function t(){this.canEnterID=0,t.__super.call(this),this.packId=21233}return b(t,"protos.boss.toc_21233",Of),t.prototype.decode=function(e){this.canEnterID=e.readInt();var t=1==e.readByte();if(BR.ins.bossWildHash||(BR.ins.bossWildHash=new jl),BR.ins.bossWildHash.has(this.canEnterID)){BR.ins.bossWildHash.take(this.canEnterID).isFirstKill=t}else{var i=new ut({id:this.canEnterID,isFirstKill:t});BR.ins.bossWildHash.put(this.canEnterID,i)}},t}(),CV=function(e){function t(){var e=this;e.rewards=null,e.playerName="",e.roleType=0,e.gender=0,e.guildName="",e.canShow=0,e.copyId=0,e.serverId=0,e.myrank=0,e.isCollection=0,t.__super.call(e),e.packId=30005}return b(t,"protos.boss.toc_30005",Of),t.prototype.decode=function(e){var t=this;t.rewards=[];for(var i=e.readByte(),n=0;n<i;n++){var s=e.readInt(),o=e.readInt();t.rewards.push({modelId:s,count:o})}var a=new CH;a.decode(e),t.playerName=e.readUTF(),t.roleType=e.readByte(),t.gender=e.readByte(),t.guildName=e.readUTF(),t.canShow=e.readInt(),t.copyId=e.readInt(),t.myrank=e.readInt(),t.serverId=e.readInt(),t.isCollection=e.readByte(),0<t.rewards.length?t.rewards.concat(a.awardsList):t.rewards=a.awardsList.slice(0,a.awardsList.length),tr.push(RP.n[144]+t.playerName)},t}(),LV=function(e){function t(){this.dto=null,t.__super.call(this),this.packId=21901}return b(t,"protos.buff.toc_21901",Of),t.prototype.decode=function(e){var t=e.readShort();this.dto=EH.create(t),this.dto.groupId=e.readShort(),this.dto.remainTime=e.readInt()},t}(),MV=function(e){function t(){this.buffList=null,t.__super.call(this),this.packId=21906}return b(t,"protos.buff.toc_21906",Of),t.prototype.decode=function(e){this.buffList=[];for(var t=e.readShort(),i=0;i<t;i++){var n=new EH;n.decode(e),this.buffList.push(n)}},t}(),AV=function(e){function t(){this.charQueue=[],t.__super.call(this),this.packId=10301}b(t,"protos.char.toc_10301",Of);var i=t.prototype;return i.decode=function(e){for(var t=e.readShort(),i=0;i<t;i++){var n=e.readByte(),s=new TH;1==(s.charType=n)?(s.char_id=yt.readLong64(e),s.modelId=e.readInt(),s.objectId=s.char_id,s.dir=e.readByte(),s.x=e.readShort(),s.y=e.readShort()):2==n?s=s.decodeChar(e):3==n?this.decode3(s,e):4==n?this.decode4(s,e):5==n?this.decode5(s,e):6==n?this.decode6(s,e):7==n?this.decode7(s,e):8==n&&this.decode8(s,e),this.charQueue.push(s)}},i.decode3=function(e,t){if(e.objectId=yt.readLong64(t),e.char_id=e.objectId,e.modelId=t.readInt(),e.dir=t.readByte(),BR.ins.toc25000){var i=rn.getIndex(BR.ins.toc25000.copyId),n=rn.MODEL.cate(i);10!=n&&2!=n||(e.dir=5)}e.x=t.readShort(),e.y=t.readShort(),e.paths=[];for(var s=t.readByte(),o=0;o<s;o++){var a=t.readShort(),r=t.readShort();e.paths.push(new Uh(a,r))}e.maxHP=yt.readLong64(t),e.currHP=yt.readLong64(t),e.speed=t.readShort(),e.isNew=t.readByte()},i.decode4=function(e,t){e.objectId=yt.readLong64(t),e.modelId=t.readInt(),e.dir=t.readByte(),e.x=t.readShort(),e.y=t.readShort();for(var i=t.readByte(),n=0;n<i;n++){var s=t.readShort(),o=t.readShort();e.paths.push(new Uh(s,o))}e.maxHP=yt.readLong64(t),e.currHP=yt.readLong64(t),e.speed=t.readShort(),e.isNew=t.readByte(),e.masterObjectId=yt.readLong64(t)},i.decode5=function(e,t){e.objectId=yt.readLong64(t),e.char_id=e.objectId,e.x=t.readShort(),e.y=t.readShort(),e.goodsId=t.readInt(),e.goodsNum=yt.readLong64(t),e.owner=t.readBoolean()},i.decode6=function(e,t){e.objectId=yt.readLong64(t),e.char_id=e.objectId,e.modelId=t.readInt(),e.dir=t.readByte(),e.x=t.readShort(),e.y=t.readShort()},i.decode7=function(e,t){e.objectId=yt.readLong64(t),e.char_id=e.objectId,e.modelId=t.readInt(),e.dir=t.readByte(),e.x=t.readShort(),e.y=t.readShort(),e.building1=t.readUTF(),e.building2=t.readUTF(),e.titles=[];for(var i=t.readByte(),n=0;n<i;n++){var s=t.readInt(),o=co.getIndex(s),a=co.MODEL.pidStr(o);tg.ins.canPlatformUseByID(a)&&e.titles.push(s)}},i.decode8=function(e,t){e.objectId=yt.readLong64(t),e.petStatus=t.readInt(),e.masterObjectId=yt.readLong64(t),e.petIndex=t.readInt();t.readInt();e.petColor=t.readInt(),e.petStar=t.readInt(),e.charName=t.readUTF(),e.x=t.readInt(),e.y=t.readInt()},t}(),DV=function(e){function t(){this.attrChangeList=null,this.forceValue=null,this.ad=null,this.buff=null,t.__super.call(this),this.packId=10602}b(t,"protos.char.toc_10602",Of);var i=t.prototype;return i.decode=function(e){this.decodeNew(e)},i.decodeNew=function(e){var t,i,n=0;if(t=e.readByte()-1,!(null==gR.ins.actorList||gR.ins.actorList.length<=0)){this.ad=gR.ins.actorList[t],this.buff=[],i=e.readShort();var s=0,o=0,a=0;for(n=0;n<i;n++)s=e.readShort(),o=yt.readLong64(e),e.readByte()?(a=this.ad.getAttrById(s),this.buff[n]={id:s,value:o-a},this.ad.setAttrById(s,o)):this.ad.setAttrById(s,0)}},t}(),OV=function(e){function t(){this.idx=0,t.__super.call(this),this.packId=10604}return b(t,"protos.char.toc_10604",Of),t.prototype.decode=function(e){var t,i,n=0,s=0,o=0;for(this.idx=e.readByte()-1,i=gR.ins.actorList[this.idx],t=e.readShort(),n=0;n<t;n++)s=e.readShort(),o=yt.readLong64(e),i.setAttrById(s,o)},t}(),PV=function(e){function t(){this.newActorIdx=-1,t.__super.call(this),this.packId=10605}return b(t,"protos.char.toc_10605",Of),t.prototype.decode=function(e){var t=e.readByte(),i=!1;gR.ins.actorList?i=!0:gR.ins.actorList=new Array(t);for(var n,s=0,o=0;o<t;o++){var a=e.readByte();s=a-1,null==gR.ins.actorList[s]&&(gR.ins.actorList[s]=new tR(a),i&&(this.newActorIdx=s)),(n=gR.ins.actorList[s]).job=e.readByte(),n.sex=e.readByte(),n.force=e.readInt()}},t}(),RV=function(e){function t(){this.teamUUID=0,this.teamLeaderID=0,this.teamNum=0,this.mumberList=[],this.teamData=null,t.__super.call(this),this.packId=30681}return b(t,"protos.copy.teamCopy.toc_30681",Of),t.prototype.decode=function(e){var t;this.teamData=WR.ins,this.teamUUID=yt.readLong64(e),this.teamLeaderID=yt.readLong64(e),this.teamNum=e.readByte(),this.teamData.teamMemberHash=new jl;for(var i=0;i<this.teamNum;i++)(t=new Object).playerID=yt.readLong64(e),t.Level=e.readInt(),t.fsLevel=e.readInt(),t.name=e.readUTF(),t.avatar=e.readUTF(),t.weapon=e.readUTF(),t.wing=e.readUTF(),t.weaponSoul=e.readUTF(),t.chuanshi=e.readUTF(),t.magicWeaponSoul=e.readUTF(),t.fightValue=yt.readLong64(e),t.sex=e.readByte(),t.career=e.readByte(),t.LeaderID=this.teamLeaderID,this.mumberList.push(t),this.teamData.teamMemberHash.put(t.playerID,t,!0)},t}(),NV=function(e){function t(){this.copyID=0,this.teamUUID=0,this.teamLeaderID=0,this.teamNum=0,this.mumberList=[],this.teamData=null,t.__super.call(this),this.packId=30708}return b(t,"protos.copy.teamCopy.toc_30708",Of),t.prototype.decode=function(e){var t,i=this;i.teamData=WR.ins,i.copyID=e.readInt(),i.teamUUID=yt.readLong64(e),i.teamLeaderID=yt.readLong64(e),i.teamNum=e.readByte(),i.teamData.teamMemberHash=new jl;for(var n=0;n<i.teamNum;n++)(t=new Object).playerID=yt.readLong64(e),t.Level=e.readInt(),t.fsLevel=e.readInt(),t.name=e.readUTF(),t.avatar=e.readUTF(),t.weapon=e.readUTF(),t.wing=e.readUTF(),t.weaponSoul=e.readUTF(),t.chuanshi=e.readUTF(),t.magicWeaponSoul=e.readUTF(),t.fightValue=yt.readLong64(e),t.sex=e.readByte(),t.career=e.readByte(),t.LeaderID=i.teamLeaderID,i.mumberList.push(t),i.teamData.teamMemberHash.put(t.playerID,t,!0)},t}(),BV=function(e){function t(){this.modelData=null,t.__super.call(this),this.packId=30714}return b(t,"protos.copy.teamCopy.toc_30714",Of),t.prototype.decode=function(e){var t=e.readShort();this.modelData=WR.ins,this.modelData.yaoQingMemberList=[];for(var i=0;i<t;i++){var n=new Wp;n.playerID=yt.readLong64(e),n.playerName=e.readUTF(),n.career=e.readByte(),n.sex=e.readByte(),n.fightValue=yt.readLong64(e),n.meiliValue=e.readInt(),n.isVip=e.readBoolean(),n.type=1,n.lv=-1,this.modelData.yaoQingMemberList.push(n)}},t}(),HV=function(e){function t(){this.modelData=null,t.__super.call(this),this.packId=30716}return b(t,"protos.copy.teamCopy.toc_30716",Of),t.prototype.decode=function(e){var t=e.readShort();this.modelData=WR.ins,this.modelData.yaoQingMemberList=[];for(var i=0;i<t;i++){var n=new Wp;n.playerID=yt.readLong64(e),n.playerName=e.readUTF(),n.career=e.readByte(),n.sex=e.readByte(),n.fightValue=yt.readLong64(e),n.meiliValue=e.readInt(),n.isVip=e.readBoolean(),n.lv=e.readByte(),n.type=2,this.modelData.yaoQingMemberList.push(n)}},t}(),VV=function(e){function t(){this.copyId=0,this.zhanbao=null,t.__super.call(this),this.packId=21215}return b(t,"protos.copy.toc_21215",Of),t.prototype.decode=function(e){this.copyId=e.readInt(),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),GV=function(e){function t(){this.copyId=0,this.zhanbao=null,t.__super.call(this),this.packId=23614}return b(t,"protos.copy.toc_23614",Of),t.prototype.decode=function(e){this.copyId=e.readInt(),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),UV=function(e){function t(){this.bossCount=0,this.assitCount=0,this.caijiCount=0,this.copyList=null,this.map=null,t.__super.call(this),this.packId=30742}return b(t,"protos.crossBoss.toc_30742",Of),t.prototype.decode=function(e){var t;this.bossCount=e.readByte(),this.assitCount=e.readByte(),this.caijiCount=e.readByte(),this.copyList=[];for(var i=e.readByte(),n=0;n<i;n++)(t=new zR).decode(e),this.copyList.push(t);i=e.readByte(),this.map={};for(var s=0;s<i;s++){var o=e.readInt();this.map[o]={id:o,selected:1}}},t}(),FV=function(e){function t(){this.mimeList=[],t.__super.call(this),this.packId=22204}return b(t,"protos.digger.toc_22204",Of),t.prototype.decode=function(e){for(var t,i=e.readByte(),n=0;n<i;n++)t=bB.createVo(e),this.mimeList.push(t)},t}(),qV=function(e){function t(){this.playerId=NaN,this.zhanbao=null,t.__super.call(this),this.packId=10806}return b(t,"protos.field.toc_10806",Of),t.prototype.decode=function(e){this.playerId=yt.readLong64(e),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),jV=function(s){function e(){this.list,e.__super.call(this),this.packId=30476}return b(e,"protos.friendsnew.toc.FriendNew_back_recordAll_30476_toc",s),e.prototype.decode=function(e){s.prototype.decode.call(this,e);var t,i=e.readShort();this.list=[];for(var n=0;n<i;n++)(t=new modules.friendnew.others.FriendNewLocalPlayerRecord).decode(e),this.list.push(t)},e}(Of),WV=function(e){function t(){this.roleDict=null,this.leftExp=0,this.holyWearDict=null,t.__super.call(this),this.packId=30302}return b(t,"protos.godweapon.toc_30302",Of),t.prototype.decode=function(e){var t=e.readShort();this.roleDict={},this.holyWearDict={};gR.ins.actorList.length;for(var i=0;i<t;i++){var n=new rN;n.roleId=e.readInt(),n.weaponId=gR.ins.getJobByIdx(n.roleId),n.actived=1==e.readInt(),n.weaponLv=e.readInt(),n.leftPoint=e.readInt(),n.useExp=e.readInt();for(var s=e.readShort(),o=0;o<s;o++)n.skills[e.readInt()]=e.readInt();var a=iN.instance;n.weaponId<=0&&(n.weaponId=1);for(var r=a.getPositonsByWeaponId(n.weaponId),l=0;l<r.length;l++){var c=Mi.MODEL.position(r[l]);0<n.skills[c]||(n.skills[c]=0)}n.taskId=e.readInt();for(var u=e.readShort(),d=0;d<u;d++){var h=e.readInt(),_=e.readInt();this.holyWearDict[n.roleId+"_"+h]=_}this.roleDict[n.roleId]=n}this.leftExp=e.readInt()},t}(),YV=function(t){function i(){var e=this;e.copyId=0,e.x=0,e.y=0,e.playerId=NaN,e.time=NaN,e.createPlayerId=NaN,e.channelId=0,e.statue=0,i.__super.call(e),e.packId=21201}return b(i,"protos.copy.tos_21201",t),i.prototype.encode=function(){var e=this;return NF.Ins().recordMainCharPosition(),e.writeInt_ωòóω(e.copyId),e.writeShort_ωòóω(e.x),e.writeShort_ωòóω(e.y),yt.writeLong64_ωòóω(e.bytes,e.playerId),yt.writeLong64_ωòóω(e.bytes,e.time),yt.writeLong64_ωòóω(e.bytes,e.createPlayerId),e.writeInt_ωòóω(e.channelId),e.writeInt_ωòóω(e.statue),t.prototype.encode.call(e)},i}(Pf),zV=function(e){function t(){var e=this;e.guildId=NaN,e.guildName=null,e.guildMale=null,e.guildLevel=0,e.guildMemOnline=0,e.guildMemOwn=0,e.guildFunds=0,e.minePos=0,e.mineContrib=0,e.mineDayContrib=0,e.mineTotalContrib=0,e.guildNote=null,e.applyMode=0,e.needPower=0,e.baocangLevel=0,e.baocangCurExp=0,e.list=null,t.__super.call(e),e.packId=12908}return b(t,"protos.guild.toc_12908",Of),t.prototype.decode=function(e){var t=this;t.guildId=yt.readLong64(e),t.guildName=e.readUTF(),t.guildLevel=e.readInt(),t.guildMale=e.readUTF(),t.guildMemOwn=e.readInt(),t.guildMemOnline=e.readInt(),t.guildFunds=e.readInt(),t.guildNote=e.readUTF(),t.minePos=e.readByte(),t.mineTotalContrib=e.readInt(),t.mineDayContrib=e.readInt(),t.mineContrib=e.readInt(),t.applyMode=e.readByte(),t.needPower=e.readInt(),t.baocangCurExp=e.readInt(),t.baocangLevel=e.readInt(),t.list=[];for(var i=e.readByte(),n=0;n<i;n++){var s={};s.type=e.readByte(),s.level=e.readByte(),t.list.push(s)}vN.ins.myGuildBaseToc=t},t}(),XV=function(e){function t(){this.useGx=0,this.skillDataMap=null,t.__super.call(this),this.packId=12949}return b(t,"protos.guild.toc_12949",Of),t.prototype.decode=function(e){vN.ins.myGuildBaseToc.mineContrib=e.readInt(),this.skillDataMap={};for(var t=e.readByte(),i=0;i<t;i++){for(var n=e.readByte(),s={},o=e.readByte(),a=0;a<o;a++){var r=e.readByte(),l=e.readShort();s[r]=l}this.skillDataMap[n]=s}},t}(),QV=function(e){function t(){this.opcode=0,this.pass=0,this.victory=!1,this.zhanbao=null,t.__super.call(this),this.packId=12956}return b(t,"protos.guild.toc_12956",Of),t.prototype.decode=function(e){this.opcode=e.readByte(),this.pass=e.readShort(),this.victory=1==e.readByte(),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),JV=function(e){function t(){var e=this;e.copyId=0,e.bloodRate=0,e.challengeCount=0,e.challengeTotal=0,e.bossTotal=0,e.bossCount=0,e.guildLevel=0,e.cdTime=0,e.other_guildName=null,e.other_rate=0,e.awardList=null,e.awarArr=null,t.__super.call(e),e.packId=12961}return b(t,"protos.guild.toc_12961",Of),t.prototype.decode=function(e){var t=this;t.copyId=e.readInt(),t.bloodRate=e.readByte(),t.challengeCount=e.readByte(),t.challengeTotal=e.readByte(),t.bossTotal=e.readByte(),t.bossCount=e.readByte(),t.guildLevel=e.readInt(),t.cdTime=e.readInt(),-1==t.cdTime?t.cdTime=0:t.cdTime=dr.curServerTime+1e3*t.cdTime,t.other_guildName=e.readUTF(),t.other_rate=e.readByte(),t.awardList=new jl;for(var i=e.readByte(),n=0;n<i;n++){var s=e.readByte();t.awardList.put(s,{copyId:s,state:e.readByte()})}vN.ins.guild_bossToc=t},t}(),ZV=function(e){function t(){this.map=null,t.__super.call(this),this.packId=12965}return b(t,"protos.guild.toc_12965",Of),t.prototype.decode=function(e){this.map={};for(var t=e.readByte(),i=0;i<t;i++){var n=e.readByte(),s=1==e.readByte();this.map[n]=s}vN.ins.updateReddotData(this)},t}(),KV=function(e){function t(){this.bossHp=NaN,this.myRank=0,this.list=[],this.myDamage=0,t.__super.call(this),this.packId=25016}return b(t,"protos.guild.toc_25016",Of),t.prototype.decode=function(e){this.bossHp=yt.readLong64(e),this.list=[];for(var t=e.readShort(),i=0;i<t;i++){var n=e.readUTF(),s=yt.readLong64(e),o=e.readInt();this.list.push({rank:o,name:n,feed:s}),n==gR.ins.charName&&(this.myDamage=s,this.myRank=o)}},t}(),$V=function(e){function t(){this.simpletimes=0,this.specialtimes=0,this.hasOpenMission=!1,this.statusObj={},this.kuns=new jl,t.__super.call(this),this.packId=30768}return b(t,"protos.guild.toc_30768",Of),t.prototype.decode=function(e){this.kuns.reset(),this.simpletimes=e.readInt(),this.specialtimes=e.readInt();var t=e.readByte(),i=0;for(i=0;i<t;i++){var n=e.readInt(),s=e.readInt(),o=e.readInt(),a=yt.readLong64(e);this.kuns.put(n,{id:n,growth:s,status:o,deadTime:a},!0)}this.statusObj={};var r=e.readByte();for(i=0;i<r;i++){var l=e.readInt(),c=e.readInt(),u=1==(this.statusObj[l]=c);u&&(gN.ins.openedKunId=l),this.hasOpenMission=this.hasOpenMission||u,this.hasOpenMission||(gN.ins.openedKunId=0)}},t}(),eG=function(e){function t(){this.list=[],this.myRank=0,this.myFeed=0,t.__super.call(this),this.packId=30774}return b(t,"protos.guild.toc_30774",Of),t.prototype.decode=function(e){this.list=[];for(var t=e.readInt(),i=0;i<t;i++){var n=e.readInt(),s=e.readUTF(),o=e.readInt();this.list.push({rank:n,name:s,feed:o}),s==gR.ins.charName&&(this.myRank=n,this.myFeed=o)}},t}(),tG=function(e){function t(){this.bossHp=NaN,this.myRank=0,this.list=[],this.myDamage=0,t.__super.call(this),this.packId=30784}return b(t,"protos.guild.toc_30784",Of),t.prototype.decode=function(e){this.bossHp=yt.readLong64(e),this.list=[];for(var t=e.readShort(),i=0;i<t;i++){var n=e.readUTF(),s=yt.readLong64(e),o=e.readInt();this.list.push({rank:o,name:n,feed:s}),n==gR.ins.charName&&(this.myDamage=s,this.myRank=o)}},t}(),iG=function(e){function t(){t.__super.call(this),this.packId=30670}return b(t,"protos.lunhuizhuhun.toc_30670",Of),t.prototype.decode=function(e){var t=e.readInt(),i=e.readByte(),n=uR.ins.info;n.hasOwnProperty(t)||(n[t]=[]);for(var s=0;s<i;s++){var o=e.readInt(),a=e.readInt();n[t][o]=a}},t}(),nG=function(e){function t(){t.__super.call(this),this.packId=11207}return b(t,"protos.mail.toc_11207",Of),t.prototype.decode=function(e){for(var t,i=e.readShort(),n=NaN,s=0,o=0;o<i;o++)n=yt.readLong64(e),s=e.readByte(),(t=lu.ins.getVoById(n))&&(t.mail_attach=s);var a=[],r=0;for(i=e.readShort(),o=0;o<i;o++)r=e.readInt(),a.push(aR.changeToGoodsId(r));for(i=e.readShort(),o=0;o<i;o++)a.push(e.readInt());0<a.length&&Tu.sendToModule("UPDATE",["modules.broadcast.BroadcastModule"],a)},t}(),sG=function(o){function e(){e.__super.call(this),this.packId=23727}return b(e,"protos.molimit.MoLimit_Back_TaskInfo_toc_23727",o),e.prototype.decode=function(e){o.prototype.decode.call(this,e),kN.getInstance().endTime=yt.readLong64(e);for(var t=e.readByte(),i=0;i<t;i++){e.readInt();var n=e.readInt(),s=kN.getInstance().moLevelArr[i];s&&(s.statue=n)}},e}(Of),oG=function(e){function t(){t.__super.call(this),this.packId=11302}return b(t,"protos.passsuit.toc_11302",Of),t.prototype.decode=function(e){RN.ins.decode(e)},t}(),aG=function(e){function t(){t.__super.call(this),this.packId=22002}return b(t,"protos.pig.toc_22002",Of),t.prototype.decode=function(e){modules.copy.others.PigData.ins.restNum=e.readInt();var t=e.readInt(),i=e.readInt();modules.copy.others.PigData.ins.totalNum=t+i,modules.copy.others.PigData.ins.isFirst=1==e.readBoolean()?1:0,modules.copy.others.PigData.ins.currCopyExp=yt.readLong64(e),modules.copy.others.PigData.ins.isInit=1,modules.copy.others.PigData.ins.PigCopyID=e.readInt(),modules.copy.others.PigData.ins.isOpen3=1==e.readInt()},t}(),rG=function(e){function t(){this.isSkillA=!1,this.isUseSkill=!1,t.__super.call(this),this.packId=22007}return b(t,"protos.pig.toc_22007",Of),t.prototype.decode=function(e){modules.copy.others.PigData.ins.curExp=yt.readLong64(e),modules.copy.others.PigData.ins.restTime=e.readInt();var t=e.readInt();-1==t?this.isSkillA=!1:(0==t&&(this.isUseSkill=!0),this.isSkillA=0==modules.copy.others.PigData.ins.skillActive,modules.copy.others.PigData.ins.skillActive=1),modules.copy.others.PigData.ins.skillCd=t},t}(),lG=function(e){function t(){t.__super.call(this),this.packId=22802}return b(t,"protos.readot.toc_22802",Of),t.prototype.decode=function(e){for(var t=e.readShort(),i=0,n=0;n<t;n++)i=e.readShort(),AN.ins.updatePt(i,!0),i+","},t}(),cG=function(e){function t(){t.__super.call(this),this.packId=22806}return b(t,"protos.readot.toc_22806",Of),t.prototype.decode=function(e){for(var t=e.readShort(),i=0,n=!1,s=0;s<t;s++)i=e.readShort(),n=1==e.readByte(),AN.ins.updatePt(i,n),66!=i&&236!=i||tr.push(RP.n[145]+i+", "+n)},t}(),uG=function(e){function t(){t.__super.call(this),this.packId=31042}return b(t,"protos.resonate.toc_31042",Of),t.prototype.decode=function(e){for(var t=e.readShort(),i=0;i<t;i++){for(var n=e.readInt(),s=e.readShort(),o=VN.ins.getActorResonateData(n),a=0;a<s;a++){var r=e.readInt();r=UN.configPositionToIndex(r);var l=e.readInt();o[r]=l}var c=e.readInt();o.level=c}},t}(),dG=function(e){function r(){r.__super.call(this),this.packId=30453}return b(r,"protos.ringclassic.toc_30453",Of),r.prototype.decode=function(e){for(var t=e.readByte(),i=0;i<t;i++){var n=e.readByte(),s=e.readByte(),o=e.readInt(),a=new wB(s,o,n);r.actorRingData.hasOwnProperty(n)||(r.actorRingData[n]=[]),r.actorRingData[n][s]=a}gR.ins.actorRingData=protos.ringclassic.toc_30453.actorRingData},r.actorRingData=[],r}(),hG=function(e){function t(){this.skillId=0,this.casterObjId=NaN,this.targetObjId=NaN,this.targetX=0,this.targetY=0,t.__super.call(this),this.packId=24010}return b(t,"protos.scene.heji.toc_24010",Of),t.prototype.decode=function(e){this.skillId=e.readInt(),this.casterObjId=yt.readLong64(e),0<=gR.ins.soulSkill.indexOf(this.skillId)&&(this.casterObjId=uH.yuanshenHash.take(this.casterObjId)),this.targetObjId=yt.readLong64(e),this.targetX=e.readInt(),this.targetY=e.readInt()},t}(),_G=function(e){function t(){var e=this;e.skillId=0,e.casterObjId=NaN,e.targetObjId=NaN,e.targetX=0,e.targetY=0,e.battleUnitVOs=null,e.suckValue=0,e.reboundValue=0,t.__super.call(e),e.packId=24011}return b(t,"protos.scene.heji.toc_24011",Of),t.prototype.decode=function(e){var t=this;t.skillId=e.readInt(),t.casterObjId=yt.readLong64(e),0<=gR.ins.soulSkill.indexOf(t.skillId)&&(t.casterObjId=uH.yuanshenHash.take(t.casterObjId));var i=IH.ins.isChangeSKill(t.skillId);i&&1==i[0]&&(t.skillId=i[1]),t.targetObjId=yt.readLong64(e),t.targetX=e.readInt(),t.targetY=e.readInt(),t.battleUnitVOs=[];for(var n=e.readByte(),s=0;s<n;s++){var o={};o.targetObjId=yt.readLong64(e),o.damageType=e.readInt(),o.damage=e.readInt(),o.hdChangeValue=e.readInt(),o.reboundValue=e.readInt(),o.damageType<=0&&(o.damageType=1),t.battleUnitVOs.push(o)}t.suckValue=e.readInt()},t}(),fG=function(e){function t(){this.list=null,t.__super.call(this),this.packId=24027}return b(t,"protos.scene.heji.toc_24027",Of),t.prototype.decode=function(e){this.list=[];for(var t=e.readByte(),i=0;i<t;i++){var n={};n.objectId=yt.readLong64(e),n.name=e.readUTF(),n.roleType=e.readByte(),n.sex=e.readByte(),n.guildName=e.readUTF(),n.isfight=!1,n.type=1,n.robot=e.readByte(),n.modeId=yt.readLong64(e),n.objectId!=gR.ins.objectId&&this.list.push(n)}},t}(),pG=function(e){function t(){this.list=null,t.__super.call(this),this.packId=24028}return b(t,"protos.scene.heji.toc_24028",Of),t.prototype.decode=function(e){this.list=[];for(var t=e.readByte(),i=0;i<t;i++){var n={};n.objectId=yt.readLong64(e),n.name=e.readUTF(),n.roleType=e.readByte(),n.sex=e.readByte(),n.guildName=e.readUTF(),n.isfight=!1,n.type=2,n.robot=e.readByte(),n.modeId=yt.readLong64(e),n.objectId!=gR.ins.objectId&&this.list.push(n)}},t}(),gG=function(e){function t(){this.ad=null,t.__super.call(this),this.packId=24029}return b(t,"protos.scene.heji.toc_24029",Of),t.prototype.decode=function(e){e.readByte();this.ad=new TH,this.ad=this.ad.decodeChar(e)},t}(),vG=function(e){function t(){this.missionId=0,this.pass=!1,this.reward=null,t.__super.call(this),this.packId=30004}return b(t,"protos.scene.heji.toc_30004",Of),t.prototype.decode=function(e){var t=this;t.missionId=e.readInt(),t.pass=e.readBoolean();var i=e.readByte();t.reward=[];for(var n=0;n<i;n++){var s={};s.modelId=e.readInt(),s.count=e.readInt(),t.reward.push(s)}var o=new CH;o.decode(e),0<t.reward.length?t.reward=t.reward.concat(o.awardsList):t.reward=o.awardsList.slice(0,o.awardsList.length),tr.push(RP.n[146]+t.missionId+" "+t.pass)},t}(),mG=function(e){function t(){this.dto,t.__super.call(this),this.packId=10109}return b(t,"protos.scene.toc_10109",Of),t.prototype.decode=function(e){this.dto=new AH,this.dto.decode(e)},t}(),yG=function(e){function t(){t.__super.call(this)}return b(t,"protos.scene.toc_10201",Of),t.prototype.decode=function(e){var t=gR.ins;t.charId=yt.readLong64(e).toString(),t.charName=e.readUTF(),t.cId=e.readInt().toString(),t.lv=e.readShort(),t.zsLv=e.readShort(),t.zsExp=yt.readLong64(e),t.VIPLevel=e.readByte(),t.guildId=yt.readLong64(e),t.guildName=e.readUTF(),t.guidePos=e.readInt(),t.exp=yt.readLong64(e),t.maxExp=yt.readLong64(e),console.log("toc_10201",t.charId,t.charName,t.VIPLevel);var i=0;t.showId=e.readByte();var n=e.readByte(),s=0,o=NaN;for(null==t.actorList&&(t.actorList=new Array(n)),i=0;i<n;i++){if(i>t.actorList.length-1)t.actorList.push(tR.create(e));else if(t.actorList[i])t.actorList[i].update(e);else t.actorList[i]=tR.create(e)}for(n=e.readByte(),i=0;i<n;i++)s=e.readByte(),o=yt.readLong64(e),aR.setValueById(s,o);t.createDay=e.readInt(),hr.key=e.readUTF(),t.lastUpgradeTime=e.readInt(),e.position<e.length&&(UR.instance.currentPoint=e.readShort());var a=[],r=e.readShort(),l=0;for(i=0;i<r;i++)l=e.readInt(),a.push(l);t.soulSkill=a,0<r&&(gR.ins.soulIsout=!0),gR.ins.souloutAdvanStep=e.readInt(),gR.ins.souloutSkin=e.readInt(),t.govPosition=e.readShort(),gR.ins.actorFlyUpBosstask=e.readByte();var c=e.readInt();2==(gR.ins.serverType=c)&&(dr.iosCheck=1),gR.ins.petIndex=e.readInt(),gR.ins.petColor=e.readInt(),gR.ins.petStar=e.readInt(),r=e.readShort();var u=new jl,d="",h=0;for(i=0;i<r;i++)d=e.readUTF(),h=yt.readLong64(e),u.put(d,h,!0);gR.ins.petAttrHash=u,gR.ins.petforce=yt.readLong64(e),gR.ins.platform=e.readUTF(),gR.ins.serverId=e.readInt()},t}(),IG=function(e){function t(){t.__super.call(this),this.packId=21125}return b(t,"protos.scene.toc_21125",Of),t.prototype.decode=function(e){(!gR.ins.newWingOpenArr||0<gR.ins.newWingOpenArr.length)&&(gR.ins.newWingOpenArr=[]);var t,i=e.readShort(),n=0;for(n=0;n<i;n++)t={roleindex:e.readByte(),isActive:e.readByte()},gR.ins.newWingOpenArr.push(t)},t}(),bG=function(e){function t(){this.playState=0,this.roundQueueData=[],this.attacker=0,this.defender=0,t.__super.call(this),this.packId=22601}return b(t,"protos.scene.toc_22601",Of),t.prototype.decode=function(e){this.attacker=yt.readLong64(e),this.defender=yt.readLong64(e),this.roundQueueData=AH.decodeZhanBaoBody(e)},t}(),wG=function(e){function t(){this.palyers=[],t.__super.call(this),this.packId=22603}return b(t,"protos.scene.toc_22603",Of),t.prototype.decode=function(e){for(var t=e.readByte(),i=0;i<t;i++){for(var n,s=[],o=yt.readLong64(e),a=e.readUTF(),r=(e.readUTF(),yt.readLong64(e)),l=e.readByte(),c=e.readByte(),u=0;u<c;u++){var d=e.readByte();1==d?n=AH.decodeChar(e,o):2==d?n=AH.decodeMonster(e,o):3==d&&(n=AH.decodePet(e,o)),n.charType=d,n.charName=a,s.push(n)}this.palyers.push({playerId:o,queue:s,attackValue:r,isLive:l})}},t}(),xG=function(e){function t(){this.dtoZhanBao,t.__super.call(this),this.packId=22606}return b(t,"protos.scene.toc_22606",Of),t.prototype.decode=function(e){this.dtoZhanBao=new AH,this.dtoZhanBao.decode(e)},t}(),SG=function(e){function t(){this.palyers=[],t.__super.call(this),this.packId=22611}return b(t,"protos.scene.toc_22611",Of),t.prototype.decode=function(e){for(var t,i=[],n=yt.readLong64(e),s=e.readUTF(),o=(e.readUTF(),yt.readLong64(e)),a=e.readByte(),r=e.readByte(),l=0;l<r;l++){var c=e.readByte();1==c?t=AH.decodeChar(e,n):2==c?t=AH.decodeMonster(e,n):3==c&&(t=AH.decodePet(e,n)),t.charType=c,t.charName=s,i.push(t)}this.palyers.push({playerId:n,queue:i,attackValue:o,isLive:a})},t}(),kG=function(e){function t(){this.rewards=null,this.playerName="",this.roleType=0,this.gender=0,this.guildName="",t.__super.call(this),this.packId=22613}return b(t,"protos.scene.toc_22613",Of),t.prototype.decode=function(e){this.rewards=[];for(var t=e.readByte(),i=0;i<t;i++){var n=e.readInt(),s=e.readInt();this.rewards.push({modelId:n,count:s})}var o=new CH;o.decode(e),this.playerName=e.readUTF(),this.roleType=e.readByte(),this.gender=e.readByte(),this.guildName=e.readUTF(),0<this.rewards.length?this.rewards.concat(o.awardsList):this.rewards=o.awardsList.slice(0,o.awardsList.length)},t}(),EG=function(e){function t(){this.data_words=null,t.__super.call(this),this.packId=214}return b(t,"protos.sdk.toc_214",Of),t.prototype.decode=function(e){this.data_words=e.readUTF(),EB.doPayPlatform(this.data_words)},t}(),TG=function(e){function t(){t.__super.call(this),this.packId=10424}return b(t,"protos.skill.seaair.toc_10424",Of),t.prototype.decode=function(e){var t=e.readShort(),i=0,n=0;for(nB.ins.seaAirRemainTime=new jl,i=0;i<t;i++){var s=e.readInt(),o=e.readByte(),a=[];for(n=0;n<o;n++)a.push(e.readShort());nB.ins.seaAirRemainTime.put(s,a,!0)}},t}(),CG=function(e){function t(){this.modelData=null,this.roleIndex=0,this.qhCfgId=0,t.__super.call(this),this.packId=30789}return b(t,"protos.skill.seaair.toc_30789",Of),t.prototype.decode=function(e){this.modelData=nB.ins,this.modelData.seaAirInfo=new jl;for(var t,i=e.readByte(),n=0;n<i;n++)(t=new Object).roleIndex=e.readByte(),t.qhCfgId=e.readInt(),t.soulScore=e.readInt(),this.modelData.seaAirInfo.put(t.roleIndex,t,!0)},t}(),LG=function(e){function t(){this._data=null,t.__super.call(this),this.packId=30822}return b(t,"protos.skill.talent.toc_30822",Of),t.prototype.decode=function(e){this._data=sB.ins,this._data.decodeToRoleTalentInfo(e)},t}(),MG=function(e){function t(){this._data=null,this.skillId=0,this.level=0,this.isNew=!1,t.__super.call(this),this.packId=30824}return b(t,"protos.skill.talent.toc_30824",Of),t.prototype.decode=function(e){this._data=sB.ins;var t=this._data.decodeToTalentLevelUp(e);t&&(this.isNew=t.isNew,this.skillId=t.id,this.level=t.lv)},t}(),AG=function(e){function t(){this.cid=0,this.x=0,this.y=0,t.__super.call(this),this.packId=10305}return b(t,"protos.scene.tos_10305",Pf),t.prototype.encode=function(){return this.writeInt_ωòóω(this.cid),this.writeShort_ωòóω(this.x),this.writeShort_ωòóω(this.y),t.sendServerTime=BB.getTimer(),this.bytes},t.sendServerTime=NaN,t}(),DG=function(e){function t(){this._data=null,t.__super.call(this),this.packId=30826}return b(t,"protos.skill.talent.toc_30826",Of),t.prototype.decode=function(e){this._data=sB.ins;var t=e.readByte(),i=0;for(i=0;i<t;i++)this._data.decode(e)},t}(),OG=function(e){function t(){this._data=null,t.__super.call(this),this.packId=30827,this._data=sB.ins}return b(t,"protos.skill.talent.toc_30827",Of),t.prototype.decode=function(e){var t=e.readByte(),i=this._data.actorTalentData.take(t);i&&(i.leftTalentPoint=e.readInt())},t}(),PG=function(e){function t(){this.roleIndex=0,this.dto=null,t.__super.call(this),this.packId=21403}return b(t,"protos.skill.toc_21403",Of),t.prototype.decode=function(e){this.roleIndex=e.readByte(),this.dto=new DH,this.dto.miji_id=e.readInt(),this.dto.miji_index=e.readByte(),this.dto.cur_lvl=1,this.dto.setMijiInfo()},t}(),RG=function(e){function t(){this.roleIndex=0,this.dto=null,t.__super.call(this),this.packId=21404}return b(t,"protos.skill.toc_21404",Of),t.prototype.decode=function(e){this.roleIndex=e.readByte(),this.dto=new DH,this.dto.miji_id=e.readInt(),this.dto.miji_index=e.readByte(),this.dto.cur_lvl=e.readByte(),this.dto.setMijiInfo()},t}(),NG=function(e){function t(){this.roleIndex=0,this.dto=null,t.__super.call(this),this.packId=21406}return b(t,"protos.skill.toc_21406",Of),t.prototype.decode=function(e){this.roleIndex=e.readByte(),this.dto=new DH,this.dto.miji_id=e.readInt(),this.dto.miji_index=e.readByte()},t}(),BG=function(e){function t(){this.mijiHash=null,t.__super.call(this),this.packId=21409}return b(t,"protos.skill.toc_21409",Of),t.prototype.decode=function(e){this.mijiHash=new jl;for(var t=e.readInt(),i=e.readByte(),n=[],s=0;s<i;s++){var o=new DH;o.decode(e),n.push(o)}var a=iB.ins.mijiHash;a.has(t)&&a.remove(t),a.put(t,n)},t}(),HG=function(f){function t(){var e=this;e.souloutLv=0,e.souloutMarklv=0,e.souloutMarkExp=0,e.souloutGuanzhulv=0,e.hasReward=0,e.time=0,e.soulSkinInfo=null,e.curWearSkin=-1,t.__super.call(e),e.packId=31010}return b(t,"protos.soul.toc.Soulout_returnInfo_31010_toc",f),t.prototype.decode=function(e){var t=this;f.prototype.decode.call(t,e),t.souloutLv=e.readInt(),t.souloutMarklv=e.readInt(),t.souloutMarkExp=e.readInt(),t.souloutGuanzhulv=e.readInt();for(var i=e.readShort(),n=new jl,s=0;s<i;s++)n.put(e.readInt(),e.readInt());if($f.instance.souloutVo.id=t.souloutLv,$f.instance.soulMarkVo.id=t.souloutMarklv,$f.instance.soulMarkVo.currExp=t.souloutMarkExp,$f.instance.skillHash=n,0==$f.instance.souloutGuanzhulv&&1==t.souloutGuanzhulv){Tu.sendToModule("OPEN_SOUL_ADVANCE_PANEL",["modules.soul.SoulOutModule"],null);var o=uH.Ins().isGetHero(uH.yuanshenHash.take(gR.ins.objectId));gR.ins.souloutAdvanStep=1,o&&ZN.updateCharDisplay(o,"ms164")}$f.instance.souloutGuanzhulv=t.souloutGuanzhulv,t.hasReward=e.readByte(),t.time=e.readInt(),0<(i=e.readShort())&&(t.soulSkinInfo={});for(var a=0;a<i;a++){for(var r=e.readInt(),l=e.readInt(),c=e.readShort(),u={},d=0;d<c;d++){var h=e.readInt(),_={pos:h,level:e.readInt()};u[h]=_}t.soulSkinInfo[r]={type:r,level:l,skills:u}}t.curWearSkin=e.readInt(),gR.ins.souloutSkin=t.curWearSkin,gR.ins.soulIsout&&Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[NF.mainChar,gR.ins.souloutAdvanStep,gR.ins.souloutSkin])},t}(Of),VG=function(e){function t(){t.__super.call(this),this.packId=11005}return b(t,"protos.strength.toc_11005",Of),t.prototype.decode=function(e){var t,i,n=e.readByte(),s=0,o=0;t=e.readByte();for(var a=0;a<t;a++)switch(s=e.readByte(),i=gR.ins.actorList[s-1],o=e.readShort(),n){case 1:i.strengthTotalLv=o;break;case 2:i.stoneTotalLv=o;break;case 3:i.spriteTotalLv=o}},t}(),GG=function(e){function t(){this.currentHP=1e4,this.zhanbao=null,t.__super.call(this),this.packId=11905}return b(t,"protos.task.toc_11905",Of),t.prototype.decode=function(e){this.currentHP=e.readInt(),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),UG=function(e){function t(){this.pass=0,this.zhanbao=null,t.__super.call(this),this.packId=21711}return b(t,"protos.tianguan.toc_21711",Of),t.prototype.decode=function(e){this.pass=e.readInt(),this.zhanbao=new AH,this.zhanbao.decode(e)},t}(),FG=function(a){function e(){this.rewardArr=null,e.__super.call(this),this.packId=21713}return b(e,"protos.tianguan.Tower_backDailyReward_21713_toc",a),e.prototype.decode=function(e){a.prototype.decode.call(this,e);var t=e.readShort();this.rewardArr=[];for(var i=0;i<t;i++){var n=e.readInt(),s=e.readInt(),o=yB.create(n,s);this.rewardArr.push(o)}},e}(Of),qG=function(e){function t(){t.__super.call(this),this.packId=13501}return b(t,"protos.title.toc_13501",Of),t.prototype.decode=function(e){for(var t=[],i=e.readByte(),n=0;n<i;n++)t.push(e.readShort());var s=gR.ins.actorById(1);for(s&&(s.titles=t),t=[],i=e.readByte(),n=0;n<i;n++)t.push(e.readShort());for((s=gR.ins.actorById(2))&&(s.titles=t),t=[],i=e.readByte(),n=0;n<i;n++)t.push(e.readShort());(s=gR.ins.actorById(3))&&(s.titles=t)},t}(),jG=function(e){function t(){this.vipLvl=0,t.__super.call(this),this.packId=14001}return b(t,"protos.vip.toc_14001",Of),t.prototype.decode=function(e){this.vipLvl=e.readByte(),gR.ins.VIPLevel=this.vipLvl},t}(),WG=function(e){function t(){this.list=[],t.__super.call(this),this.packId=22502}return b(t,"protos.weaponsoul.toc_22502",Of),t.prototype.decode=function(e){hB.ins.checkData(e)},t}(),YG=function(e){function t(){this.result=0,this.partId=0,this.roleIdx=0,this.force=0,this.state=0,this.lv=0,t.__super.call(this),this.packId=22504}return b(t,"protos.weaponsoul.toc_22504",Of),t.prototype.decode=function(e){var t=this;if(t.result=e.readByte(),t.partId=e.readInt(),t.roleIdx=e.readByte(),t.force=e.readInt(),1==t.result){var i=t.partId,n=Math.floor(i/1e5),s=Math.floor(i/1e3)%100;t.lv=Math.floor(i%1e3),10<t.lv&&i%10==1?t.state=1:t.state=0,hB.ins.updateLv(t.roleIdx,n,s,t.lv),hB.ins.updateForce(t.roleIdx,t.force)}},t}(),zG=function(e){function t(){this.wear=0,this.result=0,this.wsId=0,this.roleIdx=0,t.__super.call(this),this.packId=22507}return b(t,"protos.weaponsoul.toc_22507",Of),t.prototype.decode=function(e){(this.wear=e.readByte(),this.result=e.readByte(),this.roleIdx=e.readByte(),this.wsId=e.readByte(),1==this.result)&&(hB.ins.getVoByRole(this.roleIdx).wearId=0==this.wear?this.wsId:0)},t}(),XG=function(e){function t(){t.__super.call(this),this.packId=23102}return b(t,"protos.yzbqc.toc_23102",Of),t.prototype.decode=function(e){gB.ins.endTime=e.readInt(),gB.ins.restTime=e.readInt(),gB.ins.getRewards=[];for(var t=e.readByte(),i=0;i<t;i++)gB.ins.getRewards[i]=e.readByte();gB.ins.changeCampTime=yt.readLong64(e)},t}(),QG=function(e){function t(){this.dtoZhanBao,t.__super.call(this),this.packId=23106}return b(t,"protos.yzbqc.toc_23106",Of),t.prototype.decode=function(e){this.dtoZhanBao=new AH,this.dtoZhanBao.decode(e)},t}(),JG=function(e){function t(){this.type=-1,this.time=0,this.myRank=0,this.mySorce=0,this.list=null,this.upSorce=0,t.__super.call(this),this.packId=23110}return b(t,"protos.yzbqc.toc_23110",Of),t.prototype.decode=function(e){var t=this;t.type=e.readByte(),t.time=e.readInt(),t.myRank=e.readShort(),t.mySorce=e.readShort(),t.list=[];var i,n=e.readByte(),s=0;for(s=0;s<10;s++)i=new Vh,s<n?(i.idx=e.readShort(),i.name=e.readUTF(),i.sorce=e.readShort(),i.guidName=e.readUTF()):(i.idx=s+1,i.name=RP.n[147],i.sorce=0,i.guidName=RP.n[148]),t.list[s]=i;0==t.type?gB.ins.rankData=t:(t.upSorce=gB.ins.curRank?t.mySorce-gB.ins.curRank.mySorce:t.mySorce,gB.ins.curRank=t)},t}(),ZG=function(e){function t(){t.__super.call(this),this.packId=23125}return b(t,"protos.yzbqc.toc_23125",Of),t.prototype.decode=function(e){gB.ins.pushTips=!0},t}(),KG=function(e){function t(){this._achieveNewMainView=null,this._prestigePreview=null,this._tujianDetailView=null,this._tujianDecomposeView=null,this._tujianActivedView=null,this._xinfaCJupV=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("achievenew")),e.push(_r.getLayoutsPath("functionActive")),e.push(_r.getLayoutsPath("actorCimelia")),hN.ins.registPanel("ACHIEVE_NEW_MAIN_VIEW",qY,"_achieveNewMainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["RobotResource","RingResource"],["CConfigJQR","CConfigGodRingModel"])),layer:"layout",mask:!1,clearAll:!0}),hN.ins.registPanel("PRESTIGE_PREVIEW_PANEL",JY,"_prestigePreview",this,{mask:!0}),hN.ins.registPanel("TUJIAN_DETAIL_VIEW",l$,"_tujianDetailView",this,{mask:!0}),hN.ins.registPanel("TUJIAN_DECOMPOSE_VIEW",iz,"_tujianDecomposeView",this,{mask:!0}),hN.ins.registPanel("TUJIAN_SUIT_VIEW",c$,"_tujianSuitView",this,{mask:!0}),hN.ins.registPanel("TUJIAN_ACTIVED_VIEW",r$,"_tujianActivedView",this,{mask:!0}),hN.ins.registPanel("XINFA_BOOK_UP",F1,"_xinfaCJupV",this,{mask:!0,wait:hN.waitConfig(["XinFaWasteSheetResource"],["XinfaBookModel"])})}b(t,"modules.achievenew.proxys.AchieveNewProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_ACHIEVE_NEW_MAIN_VIEW":e.proto&&e.proto._subIndex_,hN.ins.open("ACHIEVE_NEW_MAIN_VIEW",{_subIndex_:-1});break;case"OPEN_PRESTIGE_PREVIEW_VIEW":hN.ins.open("PRESTIGE_PREVIEW_PANEL");break;case"21007":var i=e.proto;fl.instance.updateCurrentLiLian(i.lilian),fl.instance.updateTodayLiLian(i.todayLiLian),fl.instance.updateServerMission(i.vo),Tu.sendToModule("UPDATE_GOV_REDPOINT",["modules.nav.NavModule"]);break;case"LAYER_LAYOUT_CLOSE":WP.runBackToGovHandler();break;case"30023":break;case"30024":break;case"30202":wu.instance.update30202(e.proto),t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.medal.MedalMainPanelView&&t._achieveNewMainView.updateView();break;case"30151":var n=e.proto;zP.curExp=n.curExp,zP.activeHash=n.activeHash,t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView&&t._achieveNewMainView.updateView(e.proto),zP.runRespComplete();break;case"30153":var s=e.proto;2!=s.result&&4!=s.result||(2<s.result&&(zP.curExp-=zP.activeiObj.exp),zP.activeHash.take(zP.activeiObj.cid)&&zP.activeHash.remove(zP.activeiObj.cid),2==s.result?(zP.activeHash.put(zP.activeiObj.nid,zP.activeiObj.cid),hN.ins.open("TUJIAN_ACTIVED_VIEW",{key:zP.activeiObj.cid}),hN.ins.close("TUJIAN_DETAIL_VIEW")):zP.activeHash.put(zP.activeiObj.nid,zP.activeiObj.nid),t._tujianDetailView&&t._tujianDetailView.updateToc(e.proto),t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView&&t._achieveNewMainView.updateView(e.proto));break;case"30155":1==e.proto.result&&(zP.curExp+=zP.addExp,t._tujianDecomposeView&&t._tujianDecomposeView.updateToc(),t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView&&t._achieveNewMainView.updateView());break;case"UPDATE_TUJIAN_REDPOINT":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView&&t._achieveNewMainView.updateView();break;case"10205":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.prestige.PrestigeMainView&&t._achieveNewMainView.updateView();break;case"30121":var o=e.proto;sR.draSoulHash&&sR.draSoulHash.dispose(),sR.draSoulHash=o.draSoulHash,t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.DragonSoulView&&t._achieveNewMainView.updateView(e.proto);break;case"30123":var a=e.proto,r=sR.draSoulHash?sR.draSoulHash.take(sR.roleIndex):null;(!r||r.steps<1)&&1==a.steps&&0==a.level&&hN.ins.open("DRAGONSOUL_ACTIVED_VIEW"),sR.isUp=!!(r&&a.level>r.level),sR.isStep=!!(r&&1<a.steps&&a.steps>r.steps),sR.draSoulHash.take(sR.roleIndex)&&sR.draSoulHash.remove(sR.roleIndex),sR.draSoulHash.put(sR.roleIndex,{actorId:sR.roleIndex,steps:a.steps,level:a.level,exp:a.exp}),t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.DragonSoulView&&t._achieveNewMainView.updateView(e.proto);break;case"UPDATE_REDPOINT_CIMECILA":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.DragonSoulView&&t._achieveNewMainView.updateView(e.proto);break;case"BP_UPDATE":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.DragonSoulView&&t._achieveNewMainView.updateView(null),t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.xinfa.view.XinfaShowView&&t._achieveNewMainView.updateByVSC(!0);break;case"30481":var l=e.proto;SR.yupeiHash&&SR.yupeiHash.dispose(),SR.yupeiHash=l.yupeiHash,t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.YuPeiView&&t._achieveNewMainView.updateView(e.proto);break;case"30483":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.YuPeiView&&(SR.newDatas(e.proto),t._achieveNewMainView.updateView(SR.getFakeData()));break;case"UPDATE_YUPEI_MATERIAL":t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.actor.views.cimelia.YuPeiView&&t._achieveNewMainView.updateView("UPDATE_YUPEI_MATERIAL");break;case"OPEN_DRADON_SOUL":if(t._achieveNewMainView&&t._achieveNewMainView.parent){var c=e.proto._subIndex_;t._achieveNewMainView.setSelectIndex(c)}break;case"23221":var u=e.proto.chipid;aB.instance.activingRingChipArr[u]=1;var d={ringid:aB.instance.activingRingId-1,part:u};t._achieveNewMainView&&t._achieveNewMainView.updateView(d);break;case"23223":var h=e.proto;aB.instance.activedRingId=h.activedRingId,aB.instance.activingRingId=h.activingRingId,aB.instance.activingRingChipArr=h.activingSuiPianArr,aB.instance.ringTaskArr=h.taskArr;t._achieveNewMainView&&t._achieveNewMainView.updateView({updatering:!0}),sJ.ins.showCompoment("Navheji"),sJ.ins.notice(["NavNewDailyEnter"],null);break;case"30161":var _=e.proto;pB._xinfaDataHash&&pB._xinfaDataHash.dispose(),pB._xinfaDataHash=_.xinfaHash,t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.xinfa.view.XinfaShowView&&t._achieveNewMainView.updateByVSC(e.proto);break;case"30163":var f,p=e.proto;if(pB._xinfaDataHash.take(p.result.actorId)&&(f=pB._xinfaDataHash.take(p.result.actorId),pB._xinfaDataHash.remove(p.result.actorId)),f){for(var g=f.infos,v=0;v<g.length;v++)if(g[v].xinfa==p.result.xinfa){g[v].steps=p.result.steps,g[v].level=p.result.level;break}pB._xinfaDataHash.put(p.result.actorId,f)}t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.xinfa.view.XinfaShowView&&t._achieveNewMainView.updateByVSC(e.proto);break;case"30165":var m,y=e.proto;if(t._xinfaCJupV&&t._xinfaCJupV.updateInfo(e.proto),pB._xinfaDataHash.take(y.actorId)&&(m=pB._xinfaDataHash.take(y.actorId),pB._xinfaDataHash.remove(y.actorId)),m){for(var I=m.infos,b=0;b<I.length;b++)if(I[b].xinfa==y.xinfa&&I[b].xinfa==y.xinfa)for(var w=I[b].books,x=0;x<w.length;x++)w[x].pos==y.pos&&w[x].pos==y.pos&&(m.infos[b].books[x].level=y.level,m.infos[b].books[x].pos=y.pos,m.infos[b].books[x].quality=y.quality);pB._xinfaDataHash.put(y.actorId,m)}t._achieveNewMainView&&t._achieveNewMainView.vsc.selectedView instanceof modules.xinfa.view.XinfaShowView&&t._achieveNewMainView.updateByVSC(null)}},i.showPanel=function(e,t){var i=this;switch(e){case"XINFA_BOOK_UP":i._xinfaCJupV&&i._xinfaCJupV.updateInfo(t);break;case"ACHIEVE_NEW_MAIN_VIEW":null==t?hN.ins.open("ACHIEVE_NEW_MAIN_VIEW",{_subIndex_:0},null,!0):(i._achieveNewMainView.setSelectIndex(t._subIndex_),t.hasOwnProperty("refreshType")&&(i._achieveNewMainView&&i._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView?i._achieveNewMainView.updateView(t):t.hasOwnProperty("pages")&&G.timer.once(200,i,i.onResetTjPage,[t])));break;case"TUJIAN_DETAIL_VIEW":t&&i._tujianDetailView.initInfo(t);break;case"TUJIAN_ACTIVED_VIEW":t&&i._tujianActivedView.update(t.key)}},i.onResetTjPage=function(e){this._achieveNewMainView&&this._achieveNewMainView.vsc.selectedView instanceof modules.achievenew.views.tujian.Tujian_MainView&&this._achieveNewMainView.updateView(e),G.timer.clear(this,this.onResetTjPage)},i.closePanel=function(e,t){},t}(),$G=function(c){function t(){this._activityHeFuMainView=null,t.__super.call(this);var e;e=[_r.getLayoutsPath("activity"),_r.getLayoutsPath("treasure")],hN.ins.registPanel("ActivityHeFuMainView",ez,"_activityHeFuMainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigActivityGift","ConfigActivityLimitBuy","ConfigRecharge","MissionResource","ExploreResource","DiggerGroup","EquipsDiggerExhibition","HeFuDiggerExhibition","TimesRewardResource","DragonDesignUpgrade","DragonView","VipTeHuiReSource","VipTehuiNumResource"],["CActivityGift","CLimiteGift","CRecharge","CMissionModel","ExploreResource","DiggerGroup","EquipsDiggerExhibition","HeFuDiggerExhibition","TimesRewardResource","CConfigDragonInfo","CConfigDragonView","VipTeHuiReSource","VipTehuiNumResource"])),layer:"layout",clearAll:!0})}b(t,"modules.activity.proxys.ActivityHeFuProxy",c);var e=t.prototype;return G.imps(e,{"ui.IPanelProxy":!0}),e.subHandler=function(e){var t=this;switch(c.prototype.subHandler.call(t,e),e.actionOrder){case"12202":break;case"12204":var i=xH.create(e.proto);i&&(mB.getInStance().setActivityData(i),WB.runActComplete(),t.updateActivity(i.activityId));break;case"30732":var n=e.proto;QP.ins.update30732(n),WB.runHeFuVipComplete(),WB.runHeFuTryComplete();break;case"12206":var s=e.proto;mB.getInStance().updateGiftVo(s),WB.runGetGiftFn(),s.gift&&s.gift.owerActivity&&t.updateActivity(s.gift.owerActivity);break;case"12208":var o=e.proto;mB.getInStance().updateLimiteGiftVo(e.proto),WB.runBuyGiftFn(),t.updateActivity(o.gift.owerActivity);break;case"HEFU_GUPDATE":case"BP_UPDATE":t.updateTreasureV(e);break;case"RESHOWMAINVIEW":t._activityHeFuMainView&&t._activityHeFuMainView.parent&&t._activityHeFuMainView.vsc.updateSelectedView("show");break;case"REHIDEMAINVIEW":t._activityHeFuMainView&&t._activityHeFuMainView.parent&&t._activityHeFuMainView.vsc.updateSelectedView("hide");break;case"30322":e.proto;t.updateTreasureV(e);break;case"30324":t.updateTreasureV(e);break;case"30326":var a=e.proto;uB.ins.update(a.list),t.updateTreasureV(e);break;case"30328":var r=e.proto;uB.ins.TrasureCountArr=r.treasureTime,uB.ins.TrasureAwardArr=r.awardArr,uB.ins.longwenBless=r.longwenBless,uB.ins.chuanshiBless=r.chuanshiBless,uB.ins.freeTimeHash=r.freeTimeHash,t.updateTreasureV(e);break;case"UPDATE_HEFU_TEHUI_SELECTED":t._activityHeFuMainView&&t._activityHeFuMainView.parent&&t._activityHeFuMainView.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuChargeProfitView&&t._activityHeFuMainView.vsc.updateSelectedView(e.proto);break;case"14001":t._activityHeFuMainView&&t._activityHeFuMainView.parent&&t._activityHeFuMainView.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuVipView&&t._activityHeFuMainView.vsc.selectedView.onReqBack();break;case"REFESH_RED_PT":var l=e.proto;l&&t.updateActivity(l.activityId)}},e.showPanel=function(e,t){switch(e){case"ActivityHeFuMainView":this._activityHeFuMainView&&this._activityHeFuMainView.parent&&t instanceof Array&&t[1]&&(this._activityHeFuMainView.vsc.selectedIndex=t[1])}},e.closePanel=function(e,t){},e.doChangeTable=function(e,t){this._activityHeFuMainView&&this._activityHeFuMainView.parent&&16==t&&(hN.ins.isOpen("ActivityHeFuMainView")||hN.ins.open("ActivityHeFuMainView"),this.updateActivity(0))},e.updateActivity=function(e){this._activityHeFuMainView&&this._activityHeFuMainView.parent&&this._activityHeFuMainView.update(e)},e.updateTreasureV=function(e){this._activityHeFuMainView&&this._activityHeFuMainView.parent&&this._activityHeFuMainView.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuTreasureView&&this._activityHeFuMainView.vsc.updateSelectedView(e)},t.targetId=0,t.toSelectIndex=-1,t}(bp),eU=function(e){function V(){var e=this;e.m_RankList=null,e.m_Activity=null,e.m_LimitBuy=null,e._osRankView=null,e._osSoulEnterView=null,e._osBossSExchangeView=null,e._osSevenKHPreview=null,e._limitBuyV=null,e._spFirePreV=null,e._spFirePromptV=null,e._goldLotteryMainView=null,e._goldLotteryGetView=null,e._goldLotteryBuyView=null,e._goldLotteryInfoView=null,e.festivalbossView=null,e.festivalbossRankView=null,e.festivalbossShowAward=null,e.festivalbossGuWuView=null,e.festivalbossMainView=null,e.festivalpayView=null,e.festivaluseView=null,e.firerecordView=null,e.bossData=null,e._spBargainGuildV=null,e._spBargainPromptV=null,e._spTreeBoxsV=null,e._spTreePickAwardV=null,e._spTreePickTipsV=null,e._saleAwardV=null,e._saleLogV=null,e._loginV=null,V.__super.call(e);var t=["ConfigPlayerActivityGift","ConfigActivityGift","ConfigActivityLimitBuy","BossCardLevelResource","ConfigRecharge","ConfigChuanshi","MissionResource","ConfigActivityExchange","ConfigDailyRecharge","FestivalBossSetPanel","ConfigRareRefresh","ConfigRareShop","ConfigQingDianFuli","ConfigPointsRefresh","ConfigPointsShop","ConfigInvestResource"],i=["CPlayerGift","CActivityGift","CLimiteGift","CBossCardLevelResource","CRecharge","ConfigChuanshi","CMissionModel","CActivityExchange","CDailyRecharge","CFestBossView","ConfigRareRefresh","ConfigRareShop","CCelebretion","ConfigPointsRefresh","ConfigPointsShop","CcztzModel"],n=[];n=[_r.getLayoutsPath("activity"),_r.getLayoutsPath("tujian"),_r.getLayoutsPath("vip2"),_r.getLayoutsPath("mall"),_r.getLayoutsPath("boss")],hN.ins.registPanel("OPENSERVER",u$,"m_Activity",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),layer:"layout",clearAll:!0}),hN.ins.registPanel("LIMITBUYGIFT",a2,"m_LimitBuy",e,{wait:hN.waitRes(n),layer:"layout",clearAll:!0}),n=[_r.getLayoutsPath("activity")],hN.ins.registPanel("LIMITBUY",h$,"_limitBuyV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),layer:"layout",clearAll:!0}),hN.ins.registPanel("OS_RANK_VIEW",g$,"_osRankView",e,{mask:!0}),hN.ins.registPanel("OS_SOUL_ENTER_VIEW",m$,"_osSoulEnterView",e,{mask:!0}),hN.ins.registPanel("OS_BOSS_SEXCHANGE_VIEW",p$,"_osBossSExchangeView",e,{mask:!0}),hN.ins.registPanel("OS_SEVENKH_PREVIEW",v$,"_osSevenKHPreview",e,{mask:!0}),hN.ins.registPanel("GOLDLOTTERYMAINVIEW",r0,"_goldLotteryMainView",e,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("goldlottery")]),hN.waitConfig(["ConfigLuckDrawResource","ConfigLuckDrawSubResource","ConfigTrunTableResource"],["ConfigLuckDrawResource","ConfigLuckDrawSubResource","ConfigTrunTableResource"])),layer:"layout"}),hN.ins.registPanel("GOLDLOTTERYBUYVIEW",s0,"_goldLotteryBuyView",e,{mask:!0}),hN.ins.registPanel("GOLDLOTTERYINFOVIEW",a0,"_goldLotteryInfoView",e,{mask:!0,clickClose:!0}),hN.ins.registPanel("GOLDlOTTERYGETVIEW",o0,"_goldLotteryGetView",e,{mask:!0}),hN.ins.registPanel("SP_FIREWORKS_PREVIEW",y$,"_spFirePreV",e,{mask:!0}),hN.ins.registPanel("SP_FIREWORKS_PROMPT",tX,"_spFirePromptV",e,{mask:!0}),hN.ins.registPanel("FESTBOSS_VIEW",d$,"festivalbossView",e,{wait:hN.wait(hN.waitAtlas("boss"),hN.waitConfig(rc.festivalboss_A,rc.festivalboss_C)),layer:"layout"}),hN.ins.registPanel("FESTBOSS_RANK_VIEW",rz,"festivalbossRankView",e,{mask:!0}),hN.ins.registPanel("FESTBOSS_SHOWAWARD_VIEW",az,"festivalbossShowAward",e,{mask:!0}),hN.ins.registPanel("FESTBOSS_GUWU_VIEW",lz,"festivalbossGuWuView",e,{mask:!0,layer:"panel"}),hN.ins.registPanel("FESTBOSS_MAIN_VIEW",oz,"festivalbossMainView",e,{wait:hN.wait(hN.waitAtlas("boss")),layer:"bottom"}),e.bossData=$P.ins,hN.ins.registPanel("FIRERECORD_VIEW",aX,"firerecordView",e,{mask:!0}),hN.ins.registPanel("SP_BARGAIN_GUILD",Jz,"_spBargainGuildV",e,{mask:!0}),hN.ins.registPanel("SP_BARGAIN_PROMPT",Kz,"_spBargainPromptV",e,{mask:!0}),hN.ins.registPanel("SP_TREE_BOXS",I$,"_spTreeBoxsV",e,{mask:!0}),hN.ins.registPanel("SP_TREE_PICK_AWARD",b$,"_spTreePickAwardV",e,{mask:!0}),hN.ins.registPanel("SP_TREE_PICK_TIPS",XX,"_spTreePickTipsV",e,{mask:!0}),hN.ins.registPanel("IN_SALEAWARD",f$,"_saleAwardV",e,{mask:!0}),hN.ins.registPanel("IN_SALELOG",yz,"_saleLogV",e,{mask:!0}),hN.ins.registPanel("IN_LOGIN",_$,"_loginV",e,{mask:!0})}b(V,"modules.activity.proxys.ActivityProxy",bp);var t=V.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"UPDATE_BOSS_EXCHANGE":t._osBossSExchangeView&&t._osBossSExchangeView.parent&&t._osBossSExchangeView.update(e.proto);break;case"UPDATE_TEHUI_GIFT":var i=e.proto;i&&i.hasOwnProperty("refreshType")&&t.m_Activity&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.os.OS_GiftsView&&t.m_Activity.updateByVSC(e.proto);break;case"DEALACITVITY":case"OPEN_OS_TEHUI":var n=e.proto,s=mB.getInStance().setMainType(n);t.doChangeTable(s,n.mainType);break;case"12204":var o=xH.create(e.proto);o&&(mB.getInStance().setActivityData(o),WB.runActComplete(),t.updateActivity(o.activityId));break;case"12206":var a=e.proto;mB.getInStance().updateGiftVo(a),WB.runGetGiftFn(),a.gift&&a.gift.owerActivity&&t.updateActivity(a.gift.owerActivity);break;case"12208":var r=e.proto;mB.getInStance().updateLimiteGiftVo(e.proto),WB.runBuyGiftFn(),t.updateActivity(r.gift.owerActivity);break;case"12210":mB.getInStance().updateGiftValue(e.proto),WB.runUpdateValueFn();break;case"12222":1==e.proto.result&&(t.m_Activity&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.os.OS_BossScoreView&&t.m_Activity.updateByVSC(e.proto),t.updateActivity(WB.activityId));break;case"12224":if(1==e.proto.result){var l=WB.giftVo;l.status=2,mB.getInStance().updateSevenKH(l),t.m_Activity&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.os.OS_SevenKHView&&t.m_Activity.updateByVSC({isUpdate:!0,score:e.proto.score}),WB.runGetGiftFn()}break;case"12226":t.m_Activity&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.os.OS_SevenKHView&&t.m_Activity.updateByVSC({score:e.proto.score});break;case"31033":if(t._goldLotteryMainView&&t._goldLotteryMainView.parent){var c=e.proto;Kr.ins.currentChargeLevel=c.boughTime,Kr.ins.currentChargeYB=c.currentChargeNum,Kr.ins.leftLotteryTime=c.leftLotteryTime,Kr.ins.hasLotteryTime=c.lotteryTime,Kr.ins.boughTime=c.boughTime,t._goldLotteryMainView.needToUpdateReward&&(t._goldLotteryMainView.needToUpdateReward=!1,t._goldLotteryMainView.updateView())}t._goldLotteryBuyView&&t._goldLotteryBuyView.parent&&c.lotteryID==Kr.ins.currentLotteryID&&t._goldLotteryBuyView.updateView();break;case"31032":var u=e.proto;t._goldLotteryMainView&&t._goldLotteryMainView.parent&&u.lotteryID==Kr.ins.actId&&(Kr.ins.hasRecord?Kr.ins.currentRecord.concat(u.recordArr):(Kr.ins.currentRecord=u.recordArr.slice(),Kr.ins.hasRecord=!0,t._goldLotteryMainView.updateRecord()));break;case"31031":var d=e.proto;if(t._goldLotteryMainView&&t._goldLotteryMainView.parent&&d.lotteryID==Kr.ins.actId){var h=d.recordArr[0];Kr.ins.currentRecord.push(h),t._goldLotteryMainView.play(h)}break;case"OPEN_FEST_ENTER_PANEL":var _,f=e.proto,p=0;p=null!=(_=ci.getIndex(f))?($P.ins.iconId=f,ci.MODEL.actId(_)):f;var g=new AA;g.actId=p,Tu.sendToService(g);break;case"21272":var v=e.proto;t.bossData.toc21272=v;var m=JP.ins.isLinkToView;if(0==m)1==JP.ins.isActToView?hN.ins.open("FESTBOSS_VIEW",null,0):hN.ins.open("FESTBOSS_VIEW");else if(1==m)hN.ins.open("FESTBOSS_SHOWAWARD_VIEW");else if(2==m)break;break;case"21271":var y=e.proto;y&&(t.festivalbossGuWuView&&t.festivalbossGuWuView.refreshNum(y),1==y.type&&t.festivalbossMainView&&t.festivalbossMainView.showZhuWeiHurt(t.bossData.gwNums));break;case"25007":var I=e.proto;t.bossData.toc25007=I,t.bossData.gwNums=I.time,t.festivalbossMainView&&t.festivalbossMainView.showZhuWeiHurt(t.bossData.gwNums);break;case"25008":t.bossData.copyHurtList=e.proto.hurtList,t.festivalbossMainView&&t.festivalbossMainView.showGuildCurrentHurt(e.proto.hurtList);break;case"UPDATE_VIEW":var b=e.proto;t.m_Activity&&t.m_Activity.update(b);case"23005":HN.ins.toc_every=e.proto,t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateByVSC(e.proto);break;case"23006":var w=e.proto.cfgId;if(HN.ins.toc_every)HN.ins.toc_every.showArray.hasOwnProperty(w)&&(HN.ins.toc_every.showArray[w]=2);t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateByVSC(e.proto);break;case"23621":case"12229":case"12235":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateByVSC(e.proto);break;case"12234":0==e.proto.result&&t.m_Activity&&t.m_Activity.parent&&t.updateActivity(0);break;case"12243":0==e.proto.result&&t.m_Activity&&t.m_Activity.parent&&t.updateActivity(0);break;case"REFESH_RED_PT":var x=e.proto;x&&(mB.getInStance().setExchagneRedPt(x),t.updateActivity(x.activityId));break;case"21273":f=e.proto.iconId;if(0<Et.count)t.onshowFestBossRefresh(f);else{var S=[{url:_r.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:Et}];uc.ins().onLoadJxrs(S,ql.create(V,t.onshowFestBossRefresh,[f]))}break;case"12237":var k=e.proto.taskList;t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateByVSC(k);break;case"12239":var E=e.proto;t.firerecordView&&t.firerecordView.parent?t.firerecordView.updateView(E.recordList):hN.ins.open("FIRERECORD_VIEW",E.recordList);break;case"UPDATE_HEFU_TEHUI_SELECTED":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuChargeProfitView&&t.m_Activity.vsc.updateSelectedView(e.proto);break;case"BP_UPDATE":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.ActivityPointsShopView&&t.updateActivity(0);break;case"30801":var T=e.proto;ZP.bargainNum=T.bargainNum,ZP.useTimes=T.useTimes,ZP.bargainList=T.bargainList,ZP.handRedPt=T.handRedPt,ZP.runComplete();break;case"30805":ZP.resetBargainInfo(ZP.friend_gid,e.proto.cdTime),ZP.runComplete(),t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.Sp_BargainView&&t.m_Activity.updateByVSC(e.proto);break;case"30807":ZP.bargainNum=e.proto.bargainNum,t._spBargainGuildV&&t._spBargainGuildV.parent&&t._spBargainGuildV.updateView(e.proto),t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.Sp_BargainView&&t.m_Activity.updateByVSC(e.proto);break;case"30808":ZP.handRedPt=e.proto.handRedPt,t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.Sp_BargainView&&t.m_Activity.updateByVSC(e.proto);break;case"UPDATE_BARGAIN_SELECTED":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateByVSC(e.proto);break;case"UPDATE_BARGAIN_PEDPT":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.updateView(e.proto);break;case"30904":var C=xH.create(e.proto,1);C&&mB.getInStance().setActivityData(C);break;case"30905":var L=e.proto,M=mB.getInStance().getActivityData(L.activityId);M&&(M.gifts=L.giftList,mB.getInStance().setActivityData(M),WB.runComplete(),t.updateActivity(M.activityId));break;case"30907":var A=e.proto;mB.getInStance().updateGiftVo(A),WB.runComplete(),A.gift&&A.gift.owerActivity&&t.updateActivity(A.gift.owerActivity);break;case"30909":var D=e.proto,O=mB.getInStance().getActivityData(D.activityId);O&&(O.gifts=D.giftList,mB.getInStance().setActivityData(O),WB.runComplete(),t.updateActivity(O.activityId));break;case"30952":if(!JP.investHash)return;var P=e.proto,R=JP.investHash.take(P.type);R.curTiems=P.curTiems,JP.investSerid=P.serId;for(var N=0;N<R.list.length;N++)if(R.list[N].serId==P.serId){R.list[N].isSign=1;break}JP.investHash.put(P.type,R),WB.runComplete();break;case"30954":JP.investHash=e.proto.investHash,WB.runComplete();break;case"12247":t._spTreePickAwardV&&t._spTreePickAwardV.parent&&t._spTreePickAwardV.updateView(e.proto),t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.Sp_TreePickView&&t.m_Activity.updateByVSC(e.proto);break;case"23622":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.sp.Sp_TreePlantView&&t.m_Activity.updateByVSC(e.proto);break;case"12248":hN.ins.open("SP_TREE_PICK_TIPS",e.proto);break;case"34007":var B=e.proto,H=Ql.createColor("S."+B.ps,"#e6d80d");H+="服玩家"+Ql.createColor(B.pn,"#e6d80d"),H+=RP.n[149]+Ql.createColor("一折","#e6d80d")+RP.n[150],KQ.ins.show(H,ql.create(t,t.onConfirm),!1,3,RP.n[151]),t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.invite.In_SaleView&&t.m_Activity.updateByVSC(e.proto);break;case"34016":JP.lotId=e.proto.kid,WB.runComplete();break;case"34018":t.m_Activity&&t.m_Activity.parent&&t.m_Activity.vsc.selectedView instanceof modules.activity.views.invite.In_LotteryView&&t.m_Activity.updateByVSC(e.proto)}},t.onConfirm=function(e){this.m_Activity&&this.m_Activity.parent&&this.m_Activity.vsc.selectedView instanceof modules.activity.views.invite.In_SaleView||1==e&&CN.getIconBtn(165)&&CN.dealActIcon(CN.getIconBtn(165))},t.updateActivity=function(e){this.m_Activity&&this.m_Activity.parent&&this.m_Activity.update(e),this._limitBuyV&&this._limitBuyV.parent&&this._limitBuyV.update(e)},t.doChangeTable=function(e,t){this._limitBuyV&&this._limitBuyV.parent&&13==t&&(hN.ins.isOpen("LIMITBUY")||hN.ins.open("LIMITBUY"),this.updateActivity(0)),this.m_Activity&&this.m_Activity.parent&&(hN.ins.isOpen("OPENSERVER")||hN.ins.open("OPENSERVER"),this.updateActivity(0))},t.closePanel=function(e,t){hN.ins.close(e,t)},t.showPanel=function(e,t){var i=this;switch(e){case"OS_RANK_VIEW":i._osRankView&&i._osRankView.parent&&i._osRankView.update(t);break;case"OS_SOUL_ENTER_VIEW":i._osSoulEnterView&&i._osSoulEnterView.parent&&i._osSoulEnterView.update(t);break;case"OS_BOSS_SEXCHANGE_VIEW":i._osBossSExchangeView&&i._osBossSExchangeView.parent&&i._osBossSExchangeView.update(t);break;case"GOLDLOTTERYMAINVIEW":var n=0;if(t instanceof Array){if(0==t.length)return;n=t[0]}else"number"==typeof t&&Math.floor(t)==t&&(n=t);if(0<n){var s=mB.getInStance().getMainType(n),o=s?s.activityIds[0]:0;Kr.ins.currentLotteryID=o,Kr.ins.actId=o,WB.getActivityData(o,ql.create(i,i.onActivity))}break;case"GOLDlOTTERYGETVIEW":i._goldLotteryGetView&&i._goldLotteryGetView.showExp(t);break;case"SP_FIREWORKS_PREVIEW":i._spFirePreV&&i._spFirePreV.parent&&i._spFirePreV.update(t);break;case"SP_FIREWORKS_PROMPT":i._spFirePromptV&&i._spFirePromptV.parent&&i._spFirePromptV.update(t);break;case"FESTBOSS_VIEW":i.festivalbossView&&i.festivalbossView.updateView();break;case"FESTBOSS_GUWU_VIEW":i.festivalbossGuWuView&&i.festivalbossGuWuView.showCurrentZhuWei();break;case"FIRERECORD_VIEW":i.firerecordView&&i.firerecordView.updateView(t);break;case"SP_BARGAIN_PROMPT":i._spBargainPromptV&&i._spBargainPromptV.parent&&i._spBargainPromptV.updateView(t);break;case"SP_TREE_BOXS":i._spTreeBoxsV&&i._spTreeBoxsV.parent&&i._spTreeBoxsV.updateView(t);break;case"SP_TREE_PICK_TIPS":i._spTreePickTipsV&&i._spTreePickTipsV.parent&&i._spTreePickTipsV.updateView(t);break;case"IN_SALEAWARD":i._saleAwardV&&i._saleAwardV.parent&&i._saleAwardV.updateView(t);break;case"IN_SALELOG":i._saleLogV&&i._saleLogV.parent&&i._saleLogV.updateView(t);break;case"IN_LOGIN":i._loginV&&i._loginV.parent&&i._loginV.updateView(t)}},t.onshowFestBossRefresh=function(e){jQ.lastShowTips=jQ.needShowTips.concat();var t=[];t.push(e),jQ.needShowTips=t,jQ.clearOverdueTips(),Tu.sendToModule("__SCENE_CHANGED__",["modules.broadcast.BroadcastModule"])},t.onActivity=function(e){this._goldLotteryMainView&&this._goldLotteryMainView.parent&&(this._goldLotteryMainView.updateView(),this._goldLotteryMainView.updateTime())},V.toSelectIndex=-1,V.targetId=0,V}(),tU=function(e){function r(){var e=this;e._limitSView=null,e._superVipView=null,e._focusRewardView=null,e._focusQRCodeView=null,e._bindingPhoneView=null,e._wechatFirstShareView=null,e._wechatShareView=null,e._copyShareV=null,e._favourGameV=null,e._oneYuanGift=null,e._pay0View=null,e._pay0Popup=null,e._eggV=null,r.__super.call(e);var t,i,n=[];t=["LimitSurpriseResource"],i=["CLimitSurprise"],n=[_r.getLayoutsPath("activityDaily")],hN.ins.registPanel("LIMIT_SURPRISE",C$,"_limitSView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),layer:"panel",clearAll:!1,mask:!0}),hN.ins.registPanel("SUPER_VIP",A$,"_superVipView",e,{wait:hN.waitRes(n),layer:"panel",clearAll:!1,mask:!0}),hN.ins.registPanel("FOCUS_REWARD",T$,"_focusRewardView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),layer:"panel",clearAll:!1,mask:!0}),hN.ins.registPanel("FOCUS_QRCODE",x$,"_focusQRCodeView",e,{wait:hN.waitRes(n),mask:!0,clickClose:!1}),hN.ins.registPanel("BINDING_PHONE",S$,"_bindingPhoneView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(["SdkGiftResource"],["CSdkGift"])),clearAll:!1,mask:!0}),n=[_r.getLayoutsPath("activity"),_r.getLayoutsPath("wxshare"),_r.getLayoutsPath("activityDaily")],hN.ins.registPanel("WECHAT_FIRST_SHARE",D$,"_wechatFirstShareView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(["WxShareRewardResource"],["ConfigWxshare"])),clearAll:!1,mask:!0}),hN.ins.registPanel("WECHAT_SHARE",kz,"_wechatShareView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(["WxShareRewardResource","WxShareProResource"],["ConfigWxshare","CwxShareLvVip"])),layer:"layout"}),hN.ins.registPanel("COPY_SHARE",uX,"_copyShareV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(["ClientRewardResource"],["ClientRewardModel"])),clearAll:!0,mask:!0}),hN.ins.registPanel("FAVOUR_GAME",w$,"_favourGameV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(["ClientRewardResource"],["ClientRewardModel"])),layer:"layout"});var s=[_r.getLayoutsPath("activityDaily")];hN.ins.registPanel("ONEYUAN_GIFT",M$,"_oneYuanGift",e,{wait:hN.wait(hN.waitRes(s),hN.waitConfig(["ConfigRecharge","RechargeGiftResource"],["CRecharge","CRechargeGift"])),layer:"panel",clearAll:!1,mask:!0}),hN.ins.registPanel("IN_EGG",k$,"_eggV",e,{wait:hN.wait(hN.waitConfig(["GoldEggResource","GoldEggRewardResource"],["CGoldEgg","CGoldEggReward"])),layer:"layout"});var o=[_r.getLayoutsPath("vip2"),_r.getLayoutsPath("pay0")];hN.ins.registPanel("PAY0_VIEW",L$,"_pay0View",e,{wait:hN.wait(hN.waitRes(o),hN.waitConfig(["ConfigRecharge","RechargeGiftResource","RechargeGiftShow"],["CRecharge","CRechargeGift","CRechargeGiftShow"])),layer:"layout"});var a=[_r.getLayoutsPath("activityDaily"),_r.getLayoutsPath("pay0")];hN.ins.registPanel("PAY0_SHARE",E$,"_pay0Popup",e,{wait:hN.wait(hN.waitRes(a),hN.waitConfig(["ConfigRecharge","RechargeGiftResource","RechargeGiftShow"],["CRecharge","CRechargeGift","CRechargeGiftShow"])),layer:"panel",clearAll:!1,mask:!0})}b(r,"modules.activityDaily.proxys.DailyProxy",bp);var t=r.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"SUPER_VIP_VIEW":hN.ins.isOpen("SUPER_VIP")||hN.ins.open("SUPER_VIP");break;case"FOCUS_REWARD":hN.ins.isOpen("FOCUS_REWARD")||hN.ins.open("FOCUS_REWARD");break;case"FOCUS_QRCODE":hN.ins.isOpen("FOCUS_QRCODE")||hN.ins.open("FOCUS_QRCODE");break;case"BINDING_PHONE":hN.ins.isOpen("BINDING_PHONE")||hN.ins.open("BINDING_PHONE");break;case"WECHAT_SHARE":eR.ins.toc39013.hasFirst?hN.ins.isOpen("WECHAT_SHARE")||hN.ins.open("WECHAT_SHARE"):hN.ins.isOpen("WECHAT_FIRST_SHARE")||hN.ins.open("WECHAT_FIRST_SHARE");break;case"39009":var i=e.proto;switch(i.type){case"WX_SHARE":i.canShare?jP.sdk_cmd("wx_share"):zB.ins.playErrorMsg(ei.MODEL.content(ei.getIndex(5308)));break;case"NEW_SERVER_GIFT":case"LOGIN_GIFT_ACTIVITY":if(!i.canShare)return;jP.sdk_cmd("wx_share_2",i.type)}break;case"39013":eR.ins.toc39013=e.proto,t._wechatShareView&&t._wechatShareView.update(e);break;case"FAVOUR_GAME":hN.ins.isOpen("FAVOUR_GAME")||hN.ins.open("FAVOUR_GAME");break;case"COPY_SHARE":var n=e.proto,s=n.id||0;if(0<eR.ins.getRWT(s)){zB.ins.playErrorMsg(ei.MODEL.content(ei.getIndex(5341)));break}hN.ins.isOpen("COPY_SHARE")||hN.ins.open("COPY_SHARE",n);break;case"31061":eR.ins.toc31061=e.proto,t._favourGameV&&t._favourGameV.parent&&t._favourGameV.update();break;case"30131":case"30133":t._limitSView&&t._limitSView.parent&&t._limitSView.updateToc(e.proto);break;case"30134":var o=e.proto;if(!YB.isOpenLimitSp||!o.result)return;G.timer.once(400,t,t.doOpen);break;case"30726":t._superVipView&&t._superVipView.parent&&t._superVipView.updateByVSC(e.proto);break;case"12231":1==e.proto.result&&hN.ins.close("FOCUS_REWARD");break;case"39015":case"39017":t._eggV&&t._eggV.parent&&t._eggV.refesh(e.proto);break;case"36012":t._oneYuanGift&&t._oneYuanGift.parent&&t._oneYuanGift.updateToc(e.proto);break;case"36020":t._pay0View&&t._pay0View.parent&&t._pay0View.update(e.proto);break;case"34020":eR.ins.updateWxShareInfo(e.proto),t._wechatShareView&&t._wechatShareView.update(e)}},t.doOpen=function(){0!=EB.showCharge&&(hN.ins.open("LIMIT_SURPRISE"),G.timer.clearAll(this))},t.closePanel=function(e,t){hN.ins.close(e,t)},t.showPanel=function(e,t){},r}(),iU=function(e){function t(){this._activeV=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("actorselectA")),e.push("ui/layouts/actorselectA/jskq_bg.jpg"),hN.ins.registPanel("ACTOR_ACTIVE",N$,"_activeV",this,{wait:hN.waitRes(e),layer:"layout",mask:!1}),hN.ins.registPanel("ActorActRemindTip",Z$,"",this,{layer:"nav",mask:!1})}b(t,"modules.actor.proxys.ActorActiveProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_ACTIVE":hN.ins.open("ACTOR_ACTIVE",null,0);break;case"CLOSE_ACTIVE":hN.ins.close("ACTOR_ACTIVE");break;case"10204":this._activeV&&this._activeV.parent&&this._activeV.activeNew(e.proto);break;case"10206":case"21109":case"14001":var t=gR.ins.actorList;t.length<3&&oR.checkOpen(t.length)&&hN.ins.open("ActorActRemindTip")}},i.showPanel=function(e,t){},i.closePanel=function(e,t){3<=gR.ins.actorList.length&&(this._activeV&&this._activeV.destroy(),this._activeV=null)},t}(),nU=function(e){function s(){this._view=null,this._pass=null,s.__super.call(this);var e=[_r.getLayoutsPath("actor_other")];hN.ins.registPanel("AO_EQUIP",rX,"_view",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ClassicalRingResource","ConfigForgingCost","ConfigGemStone","ConfigEnhance","ConfigEnchant","EquipmentSuitResource","ConfigFlyUpSuitResource","DragonDesignUpgrade"],["ClassicalRingResource","CForgingiCostModel","CGemStoneModel","CEnhanceModel","CEnchantModel","CJZGodModel","ConfigFlyUpSuitResource","CConfigDragonInfo"])),layer:"layout"});_r.getLayoutsPath("actor_other");var t,i,n=[_r.getLayoutsImagePath("passsuit/inheritance_img_bg.jpg"),_r.getLayoutsPath("passsuit"),_r.getLayoutsPath("actor_other")];t=["ConfigChuanshi","ConfigChuanshiSuit"],i=["ConfigChuanshi","ConfigChuanshiSuit"],hN.ins.registPanel("AO_PASSSUIT",$$,"_pass",this,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),layer:"layout"})}b(s,"modules.actor.proxys.ActorLookProxy",bp);var t=s.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){switch(e.actionOrder){case"10212":case"25010":pR.ins.index=0,17==o_.ins.type?hN.ins.open("AO_EQUIP",{_subId_:1},0):hN.ins.open("AO_EQUIP",null,0)}},t.closePanel=function(e,t){},t.showPanel=function(e,t){},s}(),sU=function(e){function t(){this._mainV=null,this._zsExchangeV=null,this._aShowV=null,this._attr=null,this._funcA=null,this._wingActive=null,this._soulSkinActive=null,this._heJiFenJieView=null,this._heJiExchangeView=null,this._heJiCanJuanView=null,this._heJiAllSuitAll=null,this._heJiFuWeiTips=null,this._heJiskillTips=null,this._longwenChange=null,this._longwenMV=null,this._longwenView=null,this._soaringMV=null,this._soaringResolveV=null,this._soaringSuitGrowV=null,this._soaringEquipTip=null,this._swingBlessTip=null,this._swingzhisheng=null,this.longwenModel=null,this._zhuiJiAutoView=null,this.longwenRateTip=null,this._lunhuiExchangeView=null,this._soaringPieceExchange=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("actor"),_r.getLayoutsPath("niepan"));[].push(_r.getLayoutsPath("functionActive"));hN.ins.registPanel("ACTOR_M",Hz,"_mainV",this,{wait:hN.wait(hN.waitRes(e)),mask:!1,layer:"layout"}),hN.ins.registPanel("ATTR_V",xX,"_attr",this,{mask:!0}),hN.ins.registPanel("ACTOR_ZSEXCHANGE",l0,"_zsExchangeV",this,{mask:!0}),hN.ins.registPanel("ACTOR_SHOW",B$,"_aShowV",this,{wait:hN.waitRes([_r.getLayoutsPath("actor")]),mask:!1,layer:"layout"}),hN.ins.registPanel("FUCTION_ACTIVEV",hQ,"_funcA",this,{wait:hN.wait(hN.waitConfig(["CommonEquipSuit","SuitResource"],["CommonEquipSuit","SuitResource"]),hN.waitAtlas("functionActive")),mask:!1,layer:"top"}),hN.ins.registPanel("WING_ACTIVEV",_Q,"_wingActive",this,{wait:hN.waitRes([_r.getLayoutsPath("functionActive")]),mask:!0,clickClose:!1}),hN.ins.registPanel("SoulSkinActiveView",QJ,"_soulSkinActive",this,{wait:hN.waitRes([_r.getLayoutsPath("functionActive"),_r.getLayoutsPath("yuyi")]),mask:!0,clickClose:!1}),hN.ins.registPanel("SWING_BLESSTIP",fQ,"_swingBlessTip",this,{mask:!0,clickClose:!1}),hN.ins.registPanel("SWING_ZHISHENG",IQ,"_swingzhisheng",this,{mask:!0}),hN.ins.registPanel("ActorHeJiFenJie",q$,"_heJiFenJieView",this,{mask:!0}),hN.ins.registPanel("ACTORHEJICANJUANVIEW",G$,"_heJiCanJuanView",this,{mask:!0}),hN.ins.registPanel("ActorHeJiExchangeView",U$,"_heJiExchangeView",this,{mask:!0}),hN.ins.registPanel("ActorHejiFuWeiTips",j$,"_heJiFuWeiTips",this,{mask:!0}),hN.ins.registPanel("ActorHejiAllSuitTips",F$,"_heJiAllSuitAll",this,{mask:!0}),hN.ins.registPanel("ActorHejiSkillTips",W$,"_heJiskillTips",this,{mask:!0}),hN.ins.registPanel("LONGWEN_CHANGE_PANEL",CX,"_longwenChange",this,{mask:!0}),hN.ins.registPanel("LONGWEN_MV_PANEL",Yz,"_longwenMV",this,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("longwen")])),mask:!1,layer:"layout"}),hN.ins.registPanel("LONGWEN_YULAN_PANEL",Yj,"_longwenView",this,{mask:!0}),hN.ins.registPanel("SOARING_VIEW",i0,"_soaringMV",this,{wait:hN.wait(hN.waitConfig(["ConfigFlyUpResource","ConfigFlyUpSuitResource","ConfigRule","ConfigFlyUpSuitLimit","GDReonanceResource","GDReonanceSuitResource"],["CFlyUpModel","ConfigFlyUpSuitResource","CHelpDes","ConfigFlyUpSuitLimit","CGDReonanceResource","CGDReonanceSuitResource"]),hN.waitRes([_r.getLayoutsPath("soaring")])),mask:!0,layer:"layout"}),hN.ins.registPanel("SOARING_RESOLVE_VIEW",$X,"_soaringResolveV",this,{layer:"panel",mask:!0}),hN.ins.registPanel("SOARING_EQUIP_GROW_VIEW",rQ,"_soaringSuitGrowV",this,{layer:"panel",mask:!0}),hN.ins.registPanel("SOARING_EQUIP_TIP",ZX,"_soaringEquipTip",this,{layer:"panel",mask:!0}),hN.ins.registPanel("SOARING_LONGWEN_TIP",iQ,"longwenRateTip",this,{layer:"panel",mask:!0}),hN.ins.registPanel("SOARING_PIECE_EXCHANGE",tQ,"_soaringPieceExchange",this,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("exchange")])),layer:"panel",mask:!0}),hN.ins.registPanel("ZhuiJiAutoSettingView",n0,"_zhuiJiAutoView",this,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("zhuiji")])),layer:"panel",mask:!0}),hN.ins.registPanel("ACTOR_LHEXCHANGE",X$,"_lunhuiExchangeView",this,{mask:!0}),hN.ins.registPanel("LunhuiRemindTip",Q$,"",this,{layer:"nav",mask:!1}),this.longwenModel=lR.instance()}b(t,"modules.actor.proxys.ActorProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":t.longwenModel.getRedPoint();break;case"OPEN_RED":gR.ins.forRed=!0;case"OPEN":var i=e.proto;i&&null!=i.actorId?Nj.globalIdx=i.actorId-1:Nj.globalIdx=MR.ins.getFirstActor()-1,hN.ins.isOpen("ACTOR_M")&&i&&i.subIndex?t._mainV.openIndex(i.subIndex):hN.ins.open("ACTOR_M",i);break;case"CLOSE":hN.ins.close("ACTOR_M");break;case"21110":t._mainV&&t._mainV.parent&&t._mainV.updateEquip(e);break;case"10205":t._mainV&&t._mainV.parent&&t._mainV.updateEquip(e),t._zsExchangeV&&t._zsExchangeV.parent&&t._zsExchangeV.update(),0==e.proto.isShow&&t.noticeMoneyChange(e.proto.list),t._heJiCanJuanView&&t._heJiCanJuanView.parent&&t._heJiCanJuanView.updateView(),t._heJiExchangeView&&t._heJiExchangeView.parent&&t._heJiExchangeView.updateView();break;case"10207":t.noticeMoneyChange([{type:aR.EXP.id,value:e.proto.value}]);break;case"BP_UPDATE":t._mainV&&t._mainV.parent&&(gR.ins.updateVein(),t._mainV.updateEquip()),t._heJiFenJieView&&t._heJiFenJieView.parent&&t._heJiFenJieView.update(),t._heJiExchangeView&&t._heJiExchangeView.parent&&t._heJiExchangeView.updateView(),t._soaringMV&&t._soaringMV.parent&&t._soaringMV.updateData(),t._soaringEquipTip&&t._soaringEquipTip.parent&&t._soaringEquipTip.refresh(),t._soaringSuitGrowV&&t._soaringSuitGrowV.parent&&t._soaringSuitGrowV.updateMaterial(),t._soaringResolveV&&t._soaringResolveV.parent&&t._soaringResolveV.updateData(),t.updateSeaAir(),t._soaringPieceExchange&&t._soaringPieceExchange.parent&&t._soaringPieceExchange.update();break;case"SOARING_UPDATE_SUIT":t._soaringMV&&t._soaringMV.parent&&t._soaringMV.vsc.selectedView instanceof modules.actor.views.soaring.subview.SoaringSuitV&&t._soaringMV.updateData(),t._soaringSuitGrowV&&t._soaringSuitGrowV.parent&&t._soaringSuitGrowV.refresh();break;case"21109":if(t._mainV&&t._mainV.parent&&t._mainV.updateEquip(e.proto),Tu.sendToModule("RESFRESH_BACKPACK_INFO",["modules.jzgod.JZGodModule"]),1<=gR.ins.lunhuiId)break;var n=e.proto.lv_change,s=$e.MODEL.value($e.getIndex(236)).split(",");gR.ins.zsLv-n<s[0]&&gR.ins.zsLv>=s[0]&&dr.getOpenServiceDay()>=s[1]&&hN.ins.open("LunhuiRemindTip");break;case"21120":var o=e.proto;o&&(gR.ins.zsRemainTime=o.remainTime,t._mainV&&t._mainV.parent&&t._mainV.updateEquip(e.proto),t._zsExchangeV&&t._zsExchangeV.parent&&t._zsExchangeV.update());break;case"OPEN_ZSEXP":hN.ins.toggle("ACTOR_ZSEXCHANGE");break;case"EQUIP_DRESS":t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView(e),t._longwenMV&&t._longwenMV.parent&&t._longwenMV.vsc.updateSelectedView(e),t.longwenModel.getRedPoint();break;case"RING_DRESS":t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView(e);break;case"UpdateCurrHP":ZN.isSynchScene()?aH.isZhanBaokMode?gR.ins.setRoleHp(e.proto.heroId,e.proto.hp):uH.Ins().currCid==_a.S_BIQI.toString()&&gR.ins.setRoleHp(e.proto.heroId,e.proto.hp):0<e.proto.heroId&&gR.ins.setRoleHp(e.proto.heroId,e.proto.hp);break;case"UpdateCurrMP":ZN.isSynchScene()?aH.isZhanBaokMode?gR.ins.setRoleMp(e.proto.heroId,e.proto.hp):uH.Ins().currCid==_a.S_BIQI.toString()&&gR.ins.setRoleMp(e.proto.heroId,e.proto.hp):0<e.proto.heroId&&gR.ins.setRoleMp(e.proto.heroId,e.proto.hp);break;case"OPEN_SHOW":hN.ins.open("ACTOR_SHOW");break;case"CLOSE_SHOW":hN.ins.close("ACTOR_SHOW");break;case"10210":if(t._aShowV&&t._aShowV.refresh(),uH.Ins().currCid==_a.S_BIQI.toString()){var a=gR.ins.actorById(gR.ins.showId);ZN.updateCharDisplayByVo(NF.mainChar,a),ZN.setCharTitle(NF.mainChar,a.titles)}break;case"10208":var r=e.proto,l=gR.ins.actorById(r.charIndex);l&&l.changeAvatar(r.avatorId,r.weaponId,r.wingId,r.weaponSoulId,r.chuanshiSuitID,r.magicSuitId);break;case"ZZT_UP_EQV":t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView(null);break;case"WING_ZHISHENG":t._mainV&&t._mainV.parent&&t._mainV.showZhisheng(e.proto);break;case"WING_CLEAR_BLESSTIPS":t._mainV&&t._mainV.parent&&t._mainV.showyyBlessTip();break;case"OPEN_FUNC_ACTIVE":hN.ins.open("FUCTION_ACTIVEV",e.proto);break;case"OPEN_WING_ACTIVE":hN.ins.open("WING_ACTIVEV",e.proto);break;case"23712":var c=e.proto;iR.instance.part=c.infoArr,Tu.sendToModule("UPDATE_HEJI_RED_POINT",["modules.nav.NavModule"]);break;case"23711":var u=e.proto;iR.instance.updatePart(u.vo),t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView(),Tu.sendToModule("UPDATE_HEJI_RED_POINT",["modules.nav.NavModule"]);break;case"LONGWEN_CHANGE_PANEL":hN.ins.open("LONGWEN_CHANGE_PANEL",e.proto);break;case"30102":t._longwenMV&&t._longwenMV.parent&&t._longwenMV.vsc.updateSelectedView(e),t.longwenModel.getRedPoint();break;case"30104":var d=e.proto;t.longwenModel.longwenOpenList=d.openLongwenList,t.longwenModel.longwenOpenTypeList=d.openLongwenTypeList;break;case"RESFRESH_BACKPACK_INFO":t._longwenMV&&t._longwenMV.parent&&t._longwenMV.vsc.updateSelectedView(e),t._longwenChange&&t._longwenChange.resfreshPanel(),t.longwenModel.getRedPoint(),t._mainV&&t._mainV.vsc.selectedView instanceof modules.passsuit.views.PassSuitMainView&&((m=t._mainV.vsc.selectedView)&&m.parent&&m.update(),t._mainV.vsc.updateItemEnabled());break;case"LONGWEN_SUIPIAN_NUM":t._longwenMV&&t._longwenMV.parent&&1==t._longwenMV.vsc.selectedIndex&&t._longwenMV.vsc.selectedView.showChipNum();break;case"30106":t._longwenMV&&t._longwenMV.parent&&1==t._longwenMV.vsc.selectedIndex&&(t.longwenModel.longwenChipNum=0,t.longwenModel.longwenSuiPianNum=0,t.longwenModel.longwenLyanNum=0,t.longwenModel.longwenLyiNum=0,t._longwenMV.vsc.selectedView.showChipNum());break;case"LONGWEN_YULAN_PANEL":hN.ins.open("LONGWEN_YULAN_PANEL",{type:e.proto.type});break;case"CHUANSHI_EQU_READ_END":t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView();break;case"30452":var h=e.proto,_=gR.ins.actorRingData[h.jobId][h.type];if(null==_)return;var f=!1;_.level<h.level&&(f=!0),_.level=h.level,t._mainV&&t._mainV.parent&&f&&t._mainV.vsc.updateSelectedView(e);break;case"30453":t._mainV&&t._mainV.parent&&t._mainV.vsc.updateSelectedView(e);break;case"10121":ER.ins.update10121(e.proto);break;case he.TOC_31021:t._soaringMV&&t._soaringMV.parent&&t._soaringMV.updateData();break;case"31024":if(1==e.proto._result){for(var p=1;p<=3;p++){var g=uH.getHero(p);if(g)kB.createEffect("jm1381",g.x,g.y-50,NF.scene).isAutoDispose=!0}4007!=bR.copyId&&(bR.isSucess=!0)}else bR.isSucess=!1;G.timer.once(1e3,t,t.exit);break;case"SOARING_OPEN_RESOLVED":if(t._soaringMV&&t._soaringMV.parent){t._soaringMV.updateData();var v=t._soaringMV.vsc.selectedView;null!=v&&v instanceof modules.actor.views.soaring.subview.SoaringEquipV&&v.updateView()}break;case"ZHUIJI_SKILL_ACTIVED":t._soaringMV&&t._soaringMV.parent&&t._soaringMV.updateData();break;case"11302":if(NN.passSuitInfoCallBack)RN.ins.getGoodOpenUI(NN.passSuitInfoParam),NN.passSuitInfoCallBack=null,NN.passSuitInfoParam=0;else if(t._mainV&&t._mainV.vsc.selectedView instanceof modules.passsuit.views.PassSuitMainView){var m=t._mainV.vsc.selectedView;m&&m.parent&&m.update(),t._mainV.vsc.updateItemEnabled()}break;case"10204":t._mainV&&t._mainV.vsc.selectedView instanceof modules.passsuit.views.PassSuitMainView&&((m=t._mainV.vsc.selectedView)&&m.parent&&m.refreshRoleInfo(),t._mainV.vsc.updateItemEnabled());break;case"23713":Tu.sendToModule("OPEN_LIMIT_ZHUIJI",["modules.nav.NavModule"]);break;case"23714":Tu.sendToModule("CLOSE_LIMIT_ZHUIJI",["modules.nav.NavModule"]);break;case"FLYUP_BOSS_TASK":if(t._soaringMV&&t._soaringMV.parent)return;if(t._mainV&&t._mainV.parent)return;nW.ins.isShow()||nW.ins.show();break;case"FLYUP_BOSS_SUIT_ARROW":t._soaringMV&&t._soaringMV.parent&&t._soaringMV.addSuitArrow();break;case"30662":var y=e.proto;gR.ins.lunhuiId=y.lunhuiId,gR.ins.yeli=y.yeli;var I=[];I.push(y.yeliExpRemainTime),I.push(y.yeliSeniorRemainTime),I.push(y.yeliSuperRemainTime),gR.ins.lunhuiRemainTime=I,t._mainV&&t._mainV.parent&&t._mainV.updateEquip(y),t._lunhuiExchangeView&&t._lunhuiExchangeView.parent&&t._lunhuiExchangeView.update();break;case"30787":var b=e.proto;if(b){nB.ins.seaAirInfo&&nB.ins.seaAirInfo.put(b.obj.roleIndex,b.obj,!0);var w=b.qhCfgId>gR.ins.actorList[b.roleIndex-1].qhCfgId;gR.ins.actorList[b.roleIndex-1].qhCfgId=b.qhCfgId,nB.ins.updateSeaAir(),t._mainV&&t._mainV.vsc.selectedView instanceof modules.skill.views.SeaAirMainView&&t._mainV.vsc.selectedView.updateSeaAirInfo(w)}break;case"10425":var x=e.proto;nB.ins.seaAirRemainTime.put(x.goodsId,x.arr,!0),t.updateSeaAir();var S="";if(-1!=nB.ins.tooldsId){var k=Bi.getIndex(nB.ins.tooldsId);Bi.MODEL.roleUseLimitOfDay(k);(S=Bi.MODEL.eventArgs(k))&&-1!=S.indexOf(".")&&(S=S.slice(0,-2));var E=[{text:"获得：",color:""},{text:RP.n[152],color:""},{text:S,color:""}];zB.ins.showMsg(E,2)}nB.ins.tooldsId=-1}},i.exit=function(){BR.ins.exitCopy(300),G.timer.clear(this,this.exit)},i.showPanel=function(e,t){var i=this;"ACTOR_M"==e?i._mainV.openIndex(t):"ATTR_V"==e?i._attr.show(t):"FUCTION_ACTIVEV"==e?i._funcA.showData(t):"WING_ACTIVEV"==e?i._wingActive.showData(t):"SoulSkinActiveView"==e?i._soulSkinActive&&i._soulSkinActive.showData(t):"LONGWEN_CHANGE_PANEL"==e?i._longwenChange&&i._longwenChange.show(t):"LONGWEN_YULAN_PANEL"==e?i._longwenView&&i._longwenView.showDragonInfo(t.type):"SWING_BLESSTIP"==e?i._swingBlessTip.update(t):"SOARING_VIEW"==e?t&&(t.actorId&&i._soaringMV.selectActor(t.actorId),t.__subIndex_&&0<t.__subIndex_&&i._soaringMV.setSelectIndex(t.__subIndex_),t._isEtip&&1==t._isEtip&&i._soaringMV.refreshToSEquip(t)):"SOARING_EQUIP_TIP"==e?t&&i._soaringEquipTip&&i._soaringEquipTip.showTips(t.data,t.showGrow,t.actorId):"SOARING_EQUIP_GROW_VIEW"==e?t&&i._soaringSuitGrowV&&i._soaringSuitGrowV.updateView(t.data,t.actorId):"SOARING_LONGWEN_TIP"==e?i.longwenRateTip&&i.longwenRateTip.showTips(t):"SOARING_PIECE_EXCHANGE"==e&&i._soaringPieceExchange&&i._soaringPieceExchange.bindData(t)},i.closePanel=function(e,t){"LONGWEN_YULAN_PANEL"==e&&this._longwenView&&this._longwenView.closeDragonView()},i.noticeMoneyChange=function(e){var t;for(var i in e)if(0<(t=e[i]).value){var n=aR.getById(t.type);if(n){if(n.id==aR.EXP.id&&3==uH.Ins().currCkType)return;if(n.id==aR.KUN_EXP.id)return;if(n.id==aR.GOD_ARMS_EXP.id)return;var s=[];s.push(Ql.createCmd("获得：")),s.push(Ql.createCmd(n.name+"x",n.color)),s.push(Ql.createCmd(t.value)),zB.ins.showMsg(s,2)}else console.error(RP.n[153]+t.type)}},i.updateSeaAir=function(){nB.ins.updateSeaAir(),Tu.sendToModule("OPEN_SOUL_POWER_REFRESH_PANEL",["modules.skill.SkillModule"]),this._mainV&&this._mainV.vsc.selectedView instanceof modules.skill.views.SeaAirMainView&&this._mainV.vsc.selectedView.updateSeaAirInfo(!1)},t}(),oU=function(e){function t(){this._swingV=null,this._swingUpdateV=null,this._swingZSquickbuyV=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("yuyi")),hN.ins.registPanel("SWING",dX,"_swingV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigWingEquipSkill","ConfigWingEquipSuit","ConfigWingExchange","ConfigWingCombine","EquipmentSuitResource"],["ConfigWingEquipSkill","ConfigWingEquipSuit","ConfigWingExchange","ConfigWingCombine","CJZGodModel"])),layer:"layout",mask:!1}),hN.ins.registPanel("SWING_UPDATE",yQ,"_swingUpdateV",this,{mask:!0}),hN.ins.registPanel("SWING_ZHISHENGBUY",bQ,"_swingZSquickbuyV",this,{mask:!0})}b(t,"modules.actor.proxys.ActorSWingProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"10204":break;case"OPEN_SWING":hN.ins.open("SWING",null,0);break;case"CLOSE_SWING":hN.ins.close("SWING");break;case"BP_INIT":case"BP_UPDATE":case"21110":case"EQUIP_UPDATE":case"21115":case"21117":wR.ins.checkRedPt(),this._swingV&&this._swingV.vsc.updateSelectedView(e),this._swingV&&this._swingV.vsc.updateItemEnabled();break;case"OPEN_MASTER":break;case"WING_STONE_UPDATE":hN.ins.isOpen("SWING_UPDATE")&&this._swingUpdateV.initInfo()}},i.showPanel=function(e,t){"SWING_UPDATE"==e&&this._swingUpdateV.update(t)},i.closePanel=function(e,t){},i.redPtUpdate=function(e){wR.ins.checkRedPt(),this._swingV&&this._swingV.vsc.updateSelectedView(e)},t}(),aU=function(e){function i(){var e=this;e._cimeliaView=null,e._dragonSoulAV=null,e._xinfaCJupV=null,e._xinfaCJdispV=null,e._xinfaSkillView=null,e._xinfaAttrSV=null,e._xinfaMijiSP=null,i.__super.call(e);var t=[_r.getLayoutsPath("actorCimelia"),_r.getLayoutsPath("xinfa")];hN.ins.registPanel("CIMELIA_MAIN_VIEW",Vz,"_cimeliaView",e,{wait:hN.wait(hN.waitRes(t),hN.waitConfig(["DragonSoulUpgrade","XinFaLevelResource","XinFaWasteSheetResource","XinFaSkillResource"],["CDragonSoulUpgrade","XinfaModel","XinfaBookModel","XinfaSkillModel"])),layer:"layout"}),hN.ins.registPanel("DRAGONSOUL_ACTIVED_VIEW",mX,"_dragonSoulAV",e,{mask:!0}),hN.ins.registPanel("XINFA_BOOK_DISPOSE",U1,"_xinfaCJdispV",e,{mask:!0,wait:hN.waitConfig(["XinFaWasteSheetResource"],["XinfaBookModel"])}),hN.ins.registPanel("XINFA_RULES_PANEL",vv,"",e,{mask:!0,wait:hN.waitConfig(["ConfigRule"],["CHelpDes"])}),hN.ins.registPanel("XINFA_SKILL_PANEL",zK,"_xinfaSkillView",e,{mask:!0,wait:hN.waitConfig(["BuffResource"],["ConfigBuff"])}),hN.ins.registPanel("XINFA_ATTR_PANEL",JJ,"_xinfaAttrSV",e,{mask:!0}),hN.ins.registPanel("XINFA_MIJI_PANEL",q1,"_xinfaMijiSP",e,{maks:!0,wait:hN.wait(hN.waitRes(t),hN.waitConfig(["XinFaWasteSheetResource"],["XinfaBookModel"]))})}b(i,"modules.actor.proxys.CimeliaProxy",bp);var t=i.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){switch(e.actionOrder){case"30121":case"30123":break;case"UPDATE_REDPOINT_CIMECILA":this._cimeliaView&&this._cimeliaView.vsc.selectedView instanceof modules.actor.views.cimelia.DragonSoulView&&this._cimeliaView.updateByVSC(e.proto);break;case"30161":case"30163":break;case"30165":e.proto;this._xinfaCJupV&&this._xinfaCJupV.updateInfo(e.proto)}},t.showPanel=function(e,t){var i=this;"XINFA_BOOK_UP"==e?i._xinfaCJupV&&i._xinfaCJupV.updateInfo(t):"XINFA_BOOK_DISPOSE"==e?i._xinfaCJdispV&&i._xinfaCJdispV.updateInfo(t):"XINFA_SKILL_PANEL"==e?i._xinfaSkillView&&i._xinfaSkillView.updateInfo(t):"XINFA_ATTR_PANEL"==e?i._xinfaAttrSV&&i._xinfaAttrSV.show(t):"XINFA_MIJI_PANEL"==e&&i._xinfaMijiSP&&i._xinfaMijiSP.update(t)},t.closePanel=function(e,t){},i}(),rU=function(e){function t(){this._godMainPanel=null,this._godlyResolvePanel=null,this._duanhunSkillTip=null,t.__super.call(this),hN.ins.registPanel("GOD_PANEL",Gz,"_godMainPanel",this,{layer:"layout",wait:hN.wait(hN.waitAtlas(["actor","godequip"]),hN.waitConfig(["GodlyEquip"],["CGodlyEquipModel"])),mask:!1}),hN.ins.registPanel("GODLY_RESOLVE",bX,"_godlyResolvePanel",this,{layer:"panel",mask:!0}),hN.ins.registPanel("DuanHunSkillTip",LJ,"_duanhunSkillTip",this,{clearAll:!1,mask:!0,layer:"panel",wait:hN.wait(hN.waitConfig(["ConfigDuanHunBuff"],["CConfigDuanHunBuff"]))})}b(t,"modules.actor.proxys.GodlyEquipProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_GODLY_EQUIP_PANEL":break;case Ve.TOC_23701:case Ve.TOC_23621:case"EQUIP_DRESS":rR.instance.needUpdate=1,t._godMainPanel&&t._godMainPanel.parent&&(t._godMainPanel.updateByVSC(),"0"==t._godMainPanel.vsc.selectedIndex.toString()&&t._godMainPanel.vsc.selectedView.showEffect());break;case"BP_UPDATE":rR.instance.needUpdate=1,t._godMainPanel&&t._godMainPanel.parent&&("0"==t._godMainPanel.vsc.selectedIndex.toString()?t._godMainPanel.updateByVSC():t._godMainPanel.vsc.selectedIndex.toString()),t._godlyResolvePanel&&t._godlyResolvePanel.updateData();break;case"10204":rR.instance.needUpdate=1,t._godMainPanel&&t._godMainPanel.parent&&t._godMainPanel.updateByVSC();break;case"SHOW_REXUE_VIEW":case"SHOW_HEJI_VIEW":hN.ins.isOpen("GOD_PANEL")?t.showPanel("GOD_PANEL",e.proto):hN.ins.open("GOD_PANEL",e.proto);break;case"11305":if(t._godMainPanel&&t._godMainPanel.parent&&"1"==t._godMainPanel.vsc.selectedIndex.toString())t._godMainPanel.vsc.selectedView.update();break;case"11308":var i=e.proto;if(eN.ins.updateDuanHunInfo(i.roleIndex,i.type,i.level),t._godMainPanel&&t._godMainPanel.parent&&"2"==t._godMainPanel.vsc.selectedIndex.toString())t._godMainPanel.vsc.selectedView.update(!0);break;case"11310":if(eN.ins.duanhunHash=e.proto.hash,t._godMainPanel&&t._godMainPanel.parent&&t._godMainPanel.vsc.selectedView instanceof modules.god.views.GodDuanhunView)t._godMainPanel.vsc.selectedView.update();break;case"11312":var n=e.proto;if(eN.ins.updateDuanHunSkill(n.roleIndex,n.level),t._duanhunSkillTip&&t._duanhunSkillTip.updateView(n.level),t._godMainPanel&&t._godMainPanel.parent&&t._godMainPanel.vsc.selectedView instanceof modules.god.views.GodDuanhunView)t._godMainPanel.vsc.selectedView.update();break;case"11314":if(eN.ins.duanhunSkillHash=e.proto.hash,t._godMainPanel&&t._godMainPanel.parent&&t._godMainPanel.vsc.selectedView instanceof modules.god.views.GodDuanhunView)t._godMainPanel.vsc.selectedView.update()}},i.showPanel=function(e,t){if("GOD_PANEL"==e)this._godMainPanel&&(t&&t.hasOwnProperty("selectedIndex")?(this._godMainPanel.vsc.selectedIndex=t.selectedIndex,this._godMainPanel.vsc.updateSelectedView(t.type)):this._godMainPanel.updateByVSC(t));else if("DuanHunSkillTip"==e){if(null==this._duanhunSkillTip||null==t)return;this._duanhunSkillTip.show(t.actorId,t.skillLevel,t.weaponLevel,t.clothLevel,t.isNeedActive,t.canUpgrade)}},i.closePanel=function(e,t){},t}(),lU=function(e){function u(){var e=this;e._moMainPanel=null,e._moOperateV=null,e._moEquipSelector=null,e._moMainComposePanel=null,e._MoEquipZhuHun=null,e._moEquipSuitTip=null,u.__super.call(e);var t=["MagicSuitResource","MagicPositionResource"],i=["CMagicSuitResource","CMagicPositionResource"],n=["MoZhuHunResource","MoMappingResource"],s=["CMoZhuHunResource","CMoMappingResource"],o=t.concat(["MagicEquipUpgradeResource","MagicEquipCombineResource","MagicWeaponSoulResource"],n),a=i.concat(["CMagicEquipUpgradeResource","CMagicEquipCombineResource","CMagicWeaponSoulResource"],s),r=[_r.getLayoutsPath("actormo")];hN.ins.registPanel("MO_MAIN_VIEW",nX,"_moMainPanel",e,{wait:hN.wait(hN.waitRes(r),hN.waitAtlas(["actormo"]),hN.waitConfig(o,a)),layer:"layout"}),hN.ins.registPanel("MO_EQUIP_SELECTOR",HX,"_moEquipSelector",e,{layer:"panel",mask:!0}),hN.ins.registPanel("MO_TIPS_VIEW",TX,"_moEquipAttrDetailV",e,{layer:"panel",mask:!0}),hN.ins.registPanel("MO_EQUIP_MAIN_COMPOSE",RX,"_moMainComposePanel",e,{layer:"panel",mask:!0,wait:hN.wait(hN.waitRes(r),hN.waitConfig(o,a))}),hN.ins.registPanel("MO_EQUIP_OPERATE",eX,"_moOperateV",e,{wait:hN.wait(hN.waitRes(r)),layer:"layout",clearAll:!1}),hN.ins.registPanel("MO_EQUIP_ZHUHUN",UX,"_MoEquipZhuHun",e,{layer:"panel",mask:!0});var l=t.concat(["ConfigFlyUpSuitResource","ConfigFlyUpSuitLimit"],n,["GDReonanceResource"]),c=i.concat(["ConfigFlyUpSuitResource","ConfigFlyUpSuitLimit"],s,["CGDReonanceResource"]);hN.ins.registPanel("MO_ZHUHUN_TIPS",$j,"_moEquipSuitTip",e,{wait:hN.wait(hN.waitConfig(l,c)),layer:"panel",mask:!0})}b(u,"modules.actor.proxys.MoEquipProxy",bp);var t=u.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"30611":var i=e.proto;if(_R.ins.data30611Hash)for(var n in i.equipHash.proto)n&&_R.ins.data30611Hash.put(n,i.equipHash.take(n),!0);else _R.ins.data30611Hash=i.equipHash;t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.MoEquipV&&t._moMainPanel.vsc.updateSelectedView(i);break;case"MO_EQUIP_DRESS":t._moMainPanel&&t._moMainPanel.parent&&(_R.ins.updateMoEquipNum(),t._moMainPanel.updateByVSC(),t._moMainPanel.vsc.selectedIndex.toString());break;case"BP_UPDATE":case"MO_EQUIP_UPDATE":_R.ins.updateMoEquipNum(),t._moMainPanel&&t._moMainPanel.parent&&("0"==t._moMainPanel.vsc.selectedIndex.toString()?t._moMainPanel.updateByVSC():t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.suit.MoEquipSuitV&&t._moMainPanel.updateByVSC()),hN.ins.isOpen("MO_EQUIP_ZHUHUN")&&t._MoEquipZhuHun&&t._MoEquipZhuHun.updateByVSC();break;case"10204":t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.MoEquipV&&t._moMainPanel.updateByVSC();break;case"OPEN_MO_EQUIP_SELECT":hN.ins.open("MO_EQUIP_SELECTOR",e.proto);break;case"SELECTOR_ITEM_CLICKED":var s=_R.ins.selectorType,o=e.proto;1==s&&_R.reqWearEquip(gR.ins.currentSelectRoleIndex+1,o.uuId,o.decoratePosition);break;case"OPEN_MO_EQUIP_OPERATE":var a=e.proto;hN.ins.open("MO_EQUIP_OPERATE",a);break;case"OPEN_MO_Main_COMPOSE":hN.ins.open("MO_EQUIP_MAIN_COMPOSE",e.proto);break;case"SELECTOR_COMPOSE_ITEM_CLICKED":t._moMainComposePanel&&t._moMainComposePanel.parent?t._moMainComposePanel.refreshTools(e.proto):t._moOperateV&&t._moOperateV.vsc.selectedView instanceof modules.actor.views.mo.MoEquipComV&&t._moOperateV.vsc.selectedView.refreshTools(e.proto);break;case"30613":G.timer.once(200,t,t.updateMoEquipCompose,[e.proto]);break;case"30615":var r=e.proto;t._moOperateV&&t._moOperateV.vsc.selectedView instanceof modules.actor.views.mo.MoEquipAdvancedV&&t._moOperateV.updateView(r);break;case"30619":var l=e.proto;if(_R.ins.data30619Hash)for(var c in l.list.proto)c&&_R.ins.data30619Hash.put(c,l.list.take(c),!0);else _R.ins.data30619Hash=l.list;t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.MoEquipV&&t._moMainPanel.vsc.updateSelectedView(l);break;case"30617":var u=e.proto;if(_R.ins.data30617Hash)for(var d in u.map.proto)d&&_R.ins.data30617Hash.put(d,u.map.take(d),!0);else _R.ins.data30617Hash=u.map;break;case"10208":t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.MoEquipV&&t._moMainPanel.updateByVSC();break;case"30623":fR.ins.updateSuitInfo(e.proto),t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.suit.MoEquipSuitV&&t._moMainPanel.updateByVSC(e.proto);break;case"30625":fR.ins.updateSuitInfo(e.proto),t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.suit.MoEquipSuitV&&t._moMainPanel.updateByVSC(e.proto),hN.ins.isOpen("MO_EQUIP_ZHUHUN")&&t._MoEquipZhuHun&&t._MoEquipZhuHun.updateByVSC();break;case"30627":_R.ins.updateMoEquipNum(),t._moMainPanel&&t._moMainPanel.parent&&t._moMainPanel.vsc.selectedView instanceof modules.actor.views.mo.MoBreakView&&t._moMainPanel.updateByVSC(e.proto)}},t.updateMoEquipCompose=function(e){1==e.result?this._moMainComposePanel&&this._moMainComposePanel.parent?this._moMainComposePanel.refreshPanel(e):this._moOperateV&&this._moOperateV.vsc.selectedView instanceof modules.actor.views.mo.MoEquipComV&&(this._moOperateV.vsc.updateItemEnabled(),this._moOperateV.vsc.selectedView.refreshPanel(e)):zB.ins.showMsg(RP.n[154],1),G.timer.clear(this,this.updateMoEquipCompose)},t.showPanel=function(e,t){var i=this;switch(e){case"MO_EQUIP_SELECTOR":i._moEquipSelector&&i._moEquipSelector.updateData(t);break;case"MO_EQUIP_MAIN_COMPOSE":i._moMainComposePanel&&i._moMainComposePanel.updateByVSC(t);break;case"MO_EQUIP_OPERATE":G.timer.once(100,i,i.updateOperateV,[t]);break;case"MO_MAIN_VIEW":t&&t.hasOwnProperty("isUnLock")&&i._moMainPanel&&i._moMainPanel.parent&&i._moMainPanel.updateByVSC(t);break;case"MO_EQUIP_ZHUHUN":i._MoEquipZhuHun&&i._MoEquipZhuHun.updateByVSC(t);break;case"MO_ZHUHUN_TIPS":i._moEquipSuitTip&&i._moEquipSuitTip.show(t)}},t.updateOperateV=function(e){this._moOperateV&&this._moOperateV.parent&&this._moOperateV.updateView(e),G.timer.clear(this,this.updateOperateV)},t.closePanel=function(e,t){},u}(),cU=function(e){function t(){this._ringMainView=null,t.__super.call(this),hN.ins.registPanel("RINGUPMAINVIEW",lX,"_ringMainView",this,{wait:hN.wait(hN.waitAtlas("ringup","actor"),hN.waitConfig(["RingShow"],["ConfigRingSkill"])),layer:"layout",mask:!1}),hN.ins.registPanel("FLYUPNPCCBBTIP",PQ,"",this,{wait:hN.wait(hN.waitAtlas("flyzone","limitchallenge")),mask:!1,clickClose:!0,layer:"nav"})}b(t,"modules.actor.proxys.RingUpProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case 1:hN.ins.open("RINGUPMAINVIEW",null,"ACTOR_M");break;case"30452":case"30453":this._ringMainView&&this._ringMainView.parent&&this._ringMainView.vsc.updateSelectedView(e)}},i.showPanel=function(e,t){"RINGUPMAINVIEW"==e&&this._ringMainView&&this._ringMainView.parent&&this._ringMainView.vsc.updateSelectedView(t)},i.closePanel=function(e,t){},t}(),uU=function(e){function t(){var e=this;e._samMainView=null,e._samRefine=null,e._lunhuiZhuhunTip=null,e._lunhuiAttrDetailTip=null,e._lunhuiMaterialTip=null,t.__super.call(e);_r.getAtlasSubPath("lunhuizhuhun/icskill0128.png"),_r.getAtlasSubPath("lunhuizhuhun/icskill0129.png");hN.ins.registPanel("SamsaraEquipMainView",cX,"_samMainView",e,{wait:hN.wait(hN.waitAtlas("lunhuizhuhun"),hN.waitAtlas("samsaraequip")),layer:"layout"}),hN.ins.registPanel("SamEquipRefineTip",e0,"_samRefine",e,{wait:hN.wait(hN.waitAtlas("samsaraequip"),hN.waitConfig(["lunhuiRefine","lunhuiRefineCycle","lunhuiRefineValue","ZhuHunUpgradeResource","SuolianPositionResource","SoulSuolianResource","MohuaResource"],["SamEquipRefine","SamEquipCycle","SamEquipLimitLevel","CZhuHunUpgradeResource","CSuolianPositionResource","CSoulSuolianResource","CMohuaResource"])),layer:"panel"}),hN.ins.registPanel("LUNHUI_ZHUHUN_TIP",DX,"_lunhuiZhuhunTip",e,{wait:hN.wait(hN.waitAtlas("lunhuizhuhun")),layer:"panel",mask:!0}),hN.ins.registPanel("LUNHUI_ZHUHUN_ATTR_DETAIL",MX,"_lunhuiAttrDetailTip",e,{mask:!0,layer:"panel"}),hN.ins.registPanel("LUNHUI_ZHUHUN_MATERIAL_TIP",AX,"_lunhuiMaterialTip",e,{wait:hN.wait(hN.waitConfig(["ZhuHunUpgradeResource","SuolianPositionResource","SoulSuolianResource","MohuaResource"],["CZhuHunUpgradeResource","CSuolianPositionResource","CSoulSuolianResource","CMohuaResource"])),mask:!0,layer:"panel"})}b(t,"modules.actor.proxys.SamsaraEquipProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case 1:hN.ins.open("SamsaraEquipMainView",null,"ACTOR_M");break;case"BP_UPDATE":t._samMainView&&t._samMainView.updateView(),t._lunhuiZhuhunTip&&t._lunhuiZhuhunTip.update();break;case"30667":yR.ins.initRefineInfo(e.proto);break;case"30668":yR.ins.updateRefineInfo(e.proto),t._samRefine&&t._samRefine.update(),t._samMainView&&t._samMainView.updateView();break;case"REFRESH_SAMEQUIPFIGHT":t._samMainView&&t._samMainView.updateView();break;case"30670":t._lunhuiZhuhunTip&&t._lunhuiZhuhunTip.update(),t._samMainView&&t._samMainView.updateView();break;case"30672":1==e.proto.result&&dR.reqZhuhunTotalInfo()}},i.showPanel=function(e,t){var i=this;"SamsaraEquipMainView"==e?i._samMainView&&i._samMainView.updateRole(t):"SamEquipRefineTip"==e?i._samRefine&&i._samRefine.show(t):"LUNHUI_ZHUHUN_TIP"==e?i._lunhuiZhuhunTip&&i._lunhuiZhuhunTip.show(t.actorId,t.position):"LUNHUI_ZHUHUN_ATTR_DETAIL"==e?i._lunhuiAttrDetailTip&&i._lunhuiAttrDetailTip.show(t.actorId):"LUNHUI_ZHUHUN_MATERIAL_TIP"==e&&i._lunhuiMaterialTip&&i._lunhuiMaterialTip.show(t.dtoGoods)},i.closePanel=function(e,t){},t}(),dU=function(e){function t(){this._mainV=null,this._season=null,this._toc05=null,t.__super.call(this);var e=[];e.push(_r.getAtlasSubPath("arena/dan_img_shadow50.jpg")),e.push(_r.getLayoutsPath("arena")),hN.ins.registPanel("ARENA_VIEW",c0,"_mainV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigArenaCommon","ConfigArenaPurchase","ConfigArenaPlayerLevel","ConfigArenaReward"],["CArenaCommon","CArenaPurchase","CArenaPlayerLevel","CArenaReward"])),mask:!1,layer:"layout"})}b(t,"modules.arena.proxys.ArenaProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){e.actionOrder},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),hU=function(e){function t(){this._mainV=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("assit")),hN.ins.registPanel("ASSIT",DQ,"_mainV",this,{wait:hN.waitRes(e),mask:!0})}b(t,"modules.assit.proxy.AssitProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN":hN.ins.toggle("ASSIT");break;case"10121":this._mainV&&this._mainV.parent&&this._mainV.updateView();break;case"10112":ER.ins.encode(e.proto.assist)}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),_U=function(e){function t(){this._isInited=!1,this._mainView=null,this._remindView=null,this.tipView=null,t.__super.call(this),hN.ins.registPanel("BAGPACK",d0,"_mainView",this,{wait:hN.wait(hN.waitAtlas("bag"),hN.waitConfig(rc.bag_A,rc.bag_C)),layer:"layout",mask:!1}),hN.ins.registPanel("REMINDUSE",w0,"_remindView",this,{mask:!1,layer:"nav"})}b(t,"modules.backpack.proxys.BackPackMainProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":G.timer.once(1e3,this,function(){t._isInited=!0});break;case"BP_OPEN_RED":TR.ins.forRed=!0;case"BP_OPEN":hN.ins.toggle("BAGPACK",e.proto);break;case"BP_ADD":for(var i=e.proto,n=0;n<i.length;n++){60001==i[n].goodsId&&Tu.sendToModule("UPDATE_HUNDUN_VIEW",["modules.copy.CopyModule"])}this.noticeNewGoods(e.proto),G.timer.once(500,this,this.checkBagItemShowUse),this.checkSoaringEquip(e.proto),this.checkSamsaraEquip(e.proto);var s=e.proto;ca.isBlackMacketGoods(s[0].goodsId)&&dr.dtoEnterScene&&57==dr.dtoEnterScene.type&&(BR.ins.bookDto=s[0]);break;case"BP_UPDATE":this.updateBagItemShowUse(),G.timer.once(200,this,this.doUpdate);break;case"10401":var o=e.proto;TR.ins.gridNum=o.gridNum,TR.ins.initGoods(o.goodsList),Tu.sendToModule("RESFRESH_BACKPACK_INFO",["modules.jzgod.JZGodModule","modules.passsuit.PassSuitModule","modules.nav.NavModule","modules.skill.SkillModule"]),69==gR.ins.lv&&0<TR.ins.getGoodsNum(89)&&!hN.ins.isOpen("QuickUseTip")&&hN.ins.open("QuickUseTip"),CR.ins.CPForCom();break;case"10402":var a=e.proto;this.judgeAuctionGoodsAdd(a.goodsList),TR.ins.updateGoods(a.goodsList,a.flyBool),Tu.sendToModule("RESFRESH_BACKPACK_INFO",["modules.jzgod.JZGodModule","modules.actor.ActorModule","modules.passsuit.PassSuitModule","modules.nav.NavModule","modules.skill.SkillModule"]),zP.refreshRedPoint(),sR.refreshRedPointCimecial(),SR.refreshRedPointCimecial(),iB.refreshRedPoint(a.goodsList),Tu.sendToModule("SOARING_UPDATE_SUIT",["modules.actor.ActorModule"]),this.showGodRingEffect(a),CR.ins.CPForCom(),this._mainView&&this._mainView.vsc.selectedView instanceof modules.backpack.views.sub.BackPackComView&&this._mainView.vsc.selectedView.refreshView();break;case"10403":var r=e.proto;TR.ins.deleteGoods(r.deleteList),Tu.sendToModule("RESFRESH_BACKPACK_INFO",["modules.jzgod.JZGodModule","modules.actor.ActorModule","modules.passsuit.PassSuitModule","modules.nav.NavModule","modules.skill.SkillModule"]);break;case"10415":var l=e.proto;TR.ins.handleGoodsDes(l.goodsId,l.des);break;case"10408":var c=e.proto;TR.ins.gridNum=c.gridNum,this._mainView&&this._mainView.parent&&this._mainView.updateExtend(),this.sendToModule("BP_EXTENDUP",["modules.backpack.BackpackModule"]);break;case"10417":var u=e.proto;G.timer.once(200,this,this.openReminde,[[u.overtimeId,u.uuid]]);break;case"10416":var d=e.proto;TR.ins.goodtimesHash=d.allHash,1==TR.ins.isChange&&I0.ins.updateTime();break;case"30652":var h=e.proto;if(I0.ins){var _=I0.ins.goodsId;1==ca.isBlackMacketGoods(_)&&I0.ins.updateAuctionGoodsTime(h.remainTime)}break;case"UPDATE_ERJI_TITLE":this._mainView&&this._mainView.vsc&&this._mainView.vsc.selectedView instanceof modules.backpack.views.sub.BackPackComView&&this._mainView.vsc.selectedView.showSTypeList(e.proto);break;case"23621":if(this._mainView&&this._mainView.vsc&&this._mainView.vsc.selectedView instanceof modules.backpack.views.sub.BackPackComView){var f=e.proto,p=xa.getIndex(f.exchangeID),g=xa.MODEL.reward(p),v=JSON.parse(g);0<v.length&&(zB.ins.playGetGoods(v[0].value.split(":")[0].toString()),this._mainView.vsc.selectedView.showEffect())}}},i.judgeAuctionGoodsAdd=function(e){if((!dr.dtoEnterScene||57!=dr.dtoEnterScene.type)&&e&&e.length&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t];i.goodsId&&ca.isBlackMacketGoods(i.goodsId)&&i.goodsNum&&i.goodsNum>TR.ins.getGoodsNum(i.goodsId)&&Tu.sendToModule("GET_GOODS",["modules.auctionhouse.AuctionHouseModule"],{dto:i})}},i.openReminde=function(e){hN.ins.open("REMINDUSE",[e[0],e[1]])},i.checkBagItemShowUse=function(){for(var e=TR.bagModel.goodsList,t=0;t<e.length;t++){var i=e[t],n=i.cfgIdx;if(Bi.MODEL.isShowUseTip(n)){var s=parseInt(uH.Ins().currCid);Pn.getIndex(s);if(ZN.isEnabledChangeScene())return JQ.ins.show(i),!0;JQ.ins.addNeedShow(i)}}return!1},i.updateBagItemShowUse=function(){for(var e=JQ.ins.curShow,t=TR.bagModel.goodsList,i=0;i<t.length;i++){if(e==t[i])return}JQ.ins.close()},i.showPanel=function(e,t){"REMINDUSE"==e?this._remindView&&this._remindView.update(t):"BAGPACK"==e&&this._mainView&&this._mainView.updateView(t)},i.closePanel=function(e,t){},i.checkSamsaraEquip=function(e){var t,i,n=RP.n[156],s=RP.n[157],o=RP.n[158];for(var a in e)if(i=e[a],ca.isSamsaraEquip(i.goodsId)){var r=yR.ins.getJobByCfg(i),l=gR.ins.actorByJob(r);if(!l)return;var c=yR.ins.getPosByCfg(i),u=l.equips.getPart(c);if(Bi.MODEL.flyLevel(i.cfgIdx)>gR.ins.zsLv)return n=RP.n[159],s=RP.n[160]+Bi.MODEL.flyLevel(i.cfgIdx)+RP.n[161],o=RP.n[162],t=ql.create(this,function(){Tu.sendToModule("BP_OPEN_RED",["modules.backpack.BackpackModule"],{_subIndex_:0})}),void XQ.ins.show(i,Ql.createColor(s,"#ff2e24"),t,n,o);(!u||u&&u.fight<i.fight)&&(t=ql.create(this,function(e){if(GR.getInstance().checkModuleOpen(56))hN.ins.open("ACTOR_M",0);else{Tu.sendToModule("BP_OPEN_RED",["modules.backpack.BackpackModule"],{_subIndex_:0})}},[i]),XQ.ins.show(i,Ql.createColor(s,"#ff2e24"),t,n,o))}},i.checkSoaringEquip=function(e){var t,i=RP.n[163],n=null,s=RP.n[164],o=ql.create(this,function(e){hN.ins.open("BAGPACK")},[t]);for(var a in e)if(t=e[a],AR.ins.isOverGradeEquips(t)){if(ca.isSoaringEquip(t.goodsId)){var r=$e.MODEL.value($e.getIndex(207)),l=JSON.parse(r);l.flyUpLevel&&gR.ins.actorFlyUpLevel<l.flyUpLevel&&(n=RP.n[165]+mp.getChineseNum(l.flyUpLevel)+RP.n[166]),gR.ins.lv<t.useLevel?n="达到"+t.useLevel+RP.n[167]:gR.ins.zsLv<t.flyLevel&&(n="达到"+t.flyLevel+RP.n[168])}if(null!=n)return AR.ins.isNeedCurFlyupEquip(t)||(AR.ins.hasLookResolve=!1,AR.ins.needShowResolveExtraRedDot=!0,Tu.sendToModule("SOARING_OPEN_RESOLVED",["modules.actor.ActorModule"])),void XQ.ins.show(t,Ql.createColor(n,"#ff2e24"),o,i,s);var c=!1,u=t.flyupLevel,d=t.decoratePosition;for(var h in gR.ins.actorList){var _=gR.ins.actorList[h].equips.getPart(d);if(null==_){c=!0;break}if(_.flyupLevel<u){c=!0;break}}if(c)return void AR.ins.showWearTip(t)}},i.noticeNewGoods=function(e){var t;if(this._isInited)for(var i in e){var n=(t=e[i]).cfgIdx;if(-1!=n){var s;if(PR.isPetEggShow(t)&&(ZN.isEnabledChangeScene()?modules.pet.views.PetgetEggTip.ins.show(t):modules.pet.views.PetgetEggTip.ins.addShowInfo(t)),PR.isAutoUsageGoods(t))this.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],t);else if(TR.ins.mulFly){TR.ins.mulFly=!1,s=[{text:"获得：",color:""},{text:Bi.MODEL.name(n),color:ms.getByQuality(Bi.MODEL.colourId(n))},{text:"x1",color:""}];for(var o=0;o<t.changeNum;o++)zB.ins.showMsg(s,2)}else s=[{text:"获得：",color:""},{text:Bi.MODEL.name(n),color:ms.getByQuality(Bi.MODEL.colourId(n))},{text:"x"+t.changeNum,color:""}],zB.ins.showMsg(s,2,!1);t&&1==t.equipType&&zB.ins.showGetToolInfo(t.goodsId)}}},i.doUpdate=function(){this._mainView&&this._mainView.parent&&this._mainView.update()},i.showGodRingEffect=function(e){if(e&&0<e.goodsList.length)for(var t=0;t<e.goodsList.length;t++){var i=e.goodsList[t];-1!=ca.SHOW_BRAOD_GOODS.indexOf(i.goodsId)&&zB.ins.showGetGoodsIcon(i.goodsId)}},t}(),fU=function(e){function n(){var e=this;e._recycleView=null,e._openView=null,e._bagPackageOpenView=null,e._quickUseTip=null,e._flyupStoneUseTip=null,e._samsaraEquipUseTip=null,e.gold=0,e.goodDto=null,n.__super.call(e);var t=[_r.getLayoutsPath("bag")];hN.ins.registPanel("RECYCLE",y0,"_recycleView",e,{wait:hN.waitRes(t),mask:!0}),hN.ins.registPanel("OPEN_GRID",v0,"_openView",e,{wait:hN.waitAtlas("bag"),mask:!0}),hN.ins.registPanel("BagPackageOpenPanel",h0,"_bagPackageOpenView",e,{mask:!0});var i=[_r.getAtlasSubPath("base_ui2/ty_zjm_tsbk.png")];hN.ins.registPanel("QuickUseTip",BQ,"_quickUseTip",e,{wait:hN.waitRes(i),mask:!1,clickClose:!1,layer:"top"}),hN.ins.registPanel("FlyupStoneUseTip",NQ,"_flyupStoneUseTip",e,{wait:hN.waitRes(i),mask:!1,clickClose:!1,layer:"top"})}b(n,"modules.backpack.proxys.BackPackUsageProxy",bp);var t=n.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"BP_RECYCLE":hN.ins.toggle("RECYCLE");break;case"BP_SHOWUSE":t.showUsage(e.proto);break;case"BP_GRIDEXTEND":hN.ins.open("OPEN_GRID");break;case"22352":case"BP_UPDATE":t._recycleView&&t._recycleView.parent&&t._recycleView.update();break;case"BP_EXTENDUP":t._openView&&t._openView.parent&&hN.ins.close("OPEN_GRID");break;case"BP_GOODSUSE":t.useGoods(e.proto.dto,e.proto.num);break;case Ve.TOC_10413:hN.ins.isOpen("BagPackageOpenPanel")&&hN.ins.close("BagPackageOpenPanel");break;case"10206":69==gR.ins.lv&&0<TR.ins.getGoodsNum(89)&&!hN.ins.isOpen("QuickUseTip")&&hN.ins.open("QuickUseTip"),sJ.ins.notice(["NavNewDailyEnter"],null)}},t.showPanel=function(e,t){"BagPackageOpenPanel"==e&&this._bagPackageOpenView&&this._bagPackageOpenView.parent&&this._bagPackageOpenView.updateShow(t)},t.closePanel=function(e,t){},t.showUsage=function(e){var t=Bi.MODEL.event2(e.cfgIdx);if(null!=t&&null!=t&&""!=t){var i=t.split("|");if(0==(0|i[0]))switch(i[1]){case"AUTO":1<e.goodsNum||this.useGoods(e,1);break;case"AUTO_USE":this.useGoods(e,e.goodsNum);break;case"GOLD":this.showConfirmGold(e,0|i[2]),this.goodDto=e,this.gold=0|i[2];break;case"GUI":hN.ins.open(i[2],e);break;case"MULTI_COMPOSE":var n=0|i[2];e.goodsNum>=n?this.useGoods(e,e.goodsNum):(zB.ins.showById(104,1),Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:e.goodsId}));break;case"PACKAGE":hN.ins.open("BagPackageOpenPanel",e);break;default:console.error(RP.n[169]+e.goodsId)}else Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],t)}},t.showConfirmGold=function(e,t){if(t<=0)this.useGoods(e,1);else{var i=RP.n[170]+Ql.createColor(t+"元宝","#fcd132")+"打开"+Ql.createColor(Bi.MODEL.name(e.cfgIdx),ms.getByQuality(Bi.MODEL.colourId(e.cfgIdx)));KQ.ins.show(i,ql.create(this,this.onConfirm),!0)}},t.onConfirm=function(e){1==e&&(gR.ins.YB>=this.gold?this.useGoods(this.goodDto,1):KQ.ins.showNoGold())},t.useGoods=function(e,t){if(Bi.MODEL.flyLevel(e.cfgIdx)>gR.ins.zsLv||Bi.MODEL.minUseLevel(e.cfgIdx)>gR.ins.lv)zB.ins.showById(1303,1);else{if(60035==e.goodsId||60062==e.goodsId){var i=Wg.ins.toc_info;i&&0<i.vipLvl?OR.reqUseGoods(e.uuId,t):(zB.ins.showMsg(RP.n[171],1),Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]))}else if(60132==e.goodsId)hN.ins.open("CHANGENAME");else if(2190==e.goodsId)gR.ins.guildId?hN.ins.open("GUILD_CHANGENAME"):zB.ins.showMsg(ei.MODEL.content(ei.getIndex(4423)),1);else if(89==e.goodsId){if(150<=gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[172]);OR.reqUseGoods(e.uuId,t)}else if(2198==e.goodsId||2226==e.goodsId)this.playFireworkEffect(8),OR.reqUseGoods(e.uuId,t);else{if(ca.isBlackMacketGoods(e.goodsId))return;if(89010==e.goodsId||89013==e.goodsId||89012==e.goodsId||89011==e.goodsId){var n=modules.pet.others.PetDataModel.ins().btnPetShow;if(0==n)return void zB.ins.showById(5003,1);if(2==n)return void zB.ins.showById(5004,1)}else OR.reqUseGoods(e.uuId,t)}var s=Bi.MODEL.event2(e.cfgIdx);if(null!=s&&null!=s&&""!=s){var o=s.split(";");1<=o.length&&G.timer.once(500,this,this.onAfter,[o[0]]),340==e.goodsId&&hN.ins.isOpen("BOSS_MAINVIEW")&&jR.reqCopy(3),ca.EXP_ITEM.indexOf(e.goodsId);var a=Bi.MODEL.sound(e.cfgIdx);0<a&&UB.ins.playSound(a,3,!0)}}},t.onAfter=function(e){Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],e)},t.playFireworkEffect=function(e){for(var t=80,i=0;i<e;i++)G.timer.once(t,this,this.playFirework,null,!1),t=20+Math.ceil(180*Math.random())},t.playFirework=function(){var e;(e=mj.GetNew()).renderInSelf=!0,e.loadEffect("jm1314"),e.playEndHandler=ql.create(this,this.effEnd,[e]),e.setXY(120+Math.ceil(500*Math.random()),300+Math.ceil(200*Math.random()));var t=hN.ins._getPanel("BAGPACK");t&&t.parent&&t.addChild(e)},t.effEnd=function(e){e.parent.removeChild(e),e.dispose(),e=null},n}(),pU=function(e){function t(){this._mainView=null,this._AncientRankScene=null,this._baRefresh=null,t.__super.call(this),hN.ins.registPanel("BOSS_ANCIENT_MAINVIEW",x0,"_mainView",this,{wait:hN.wait(hN.waitAtlas(["boss"])),layer:"layout"}),hN.ins.registPanel("BOSS_ANCIENT_RANKSCENE",GQ,"_AncientRankScene",this,{layer:"nav",wait:hN.wait(hN.waitAtlas(["boss"])),mask:!1,clickClose:!1}),hN.ins.registPanel("BOSS_ANCIENT_REFRESH",FQ,"_baRefresh",this,{layer:"nav",mask:!1,clickClose:!1})}b(t,"modules.bossancient.proxys.BossAncientProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_BOSS_ANCIENT_VIEE":null!=G.loader.getRes(_r.getLayoutsPath("boss"))?this.openBossAncient():G.loader.load(_r.getLayoutsPath("boss"),ql.create(this,this.openBossAncient)),hN.ins.open("BOSS_ANCIENT_MAINVIEW",{_subId_:0},null,!0),hN.ins.close("BOSS_ANCIENT_REFRESH");break;case"21232":VR.ins.updateInfoByVSC(e.proto),this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"24044":var t=hN.ins._getPanel("BOSS_ANCIENT_RANKSCENE");t&&t.parent&&t.updateRankInfo(e.proto)}},i.showPanel=function(e,t){"BOSS_ANCIENT_REFRESH"==e&&(this._baRefresh&&this._baRefresh.update(t),this._baRefresh.visible=MN.isNormalShow)},i.closePanel=function(e,t){},i.openBossAncient=function(){hN.ins.open("BOSS_ANCIENT_MAINVIEW",{_subId_:0},null,!0),hN.ins.close("BOSS_ANCIENT_REFRESH")},t}(),gU=function(e){function t(){var e=this;e.broadView=null,e.noticeView=null,e.fightView=null,e.attrView=null,e.itemView=null,e.itemView2=null,e.expView=null,e.powerView=null,e.rainbowView=null,e.toc_10602_att=null,e._godRing=null,e._iconBroadView=null,e._activityOpenView=null,e._heraldView=null,e.lastTotalForce=NaN,e.forcesArr=[],t.__super.call(e),hN.ins.registPanel("BROADCAST",zQ,"broadView",e,{wait:hN.wait(hN.waitAtlas(["broad","color"]),hN.waitConfig(["ModuleOpenResource"],["CModuleOpenResource"])),layer:"top"}),hN.ins.registPanel("NOTICE_VIEW",KF,"noticeView",e,{wait:hN.waitAtlas("broad"),layer:"top"}),hN.ins.registPanel("ATTR_EFFECT_V",YQ,"attrView",e,{wait:hN.waitAtlas("broad"),layer:"top"}),hN.ins.registPanel("FIGHT_EFFECT_V",QQ,"fightView",e,{wait:hN.waitAtlas("broad"),layer:"top"}),hN.ins.registPanel("ITEM_EFFECT_V",JF,"itemView",e,{wait:hN.waitAtlas("broad"),layer:"top"}),hN.ins.registPanel("ITEM_EFFECT_V2",ZF,"itemView2",e,{wait:hN.waitAtlas("broad"),layer:"top"}),hN.ins.registPanel("EXP_EFFECT_V",QF,"expView",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("POWER_EFFECT_V",$F,"powerView",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("RAINBOW_VIEW",IW,"rainbowView",e,{clearAll:!1,mask:!1,layer:"top"}),hN.ins.registPanel("RING_GET_EFFECT",mW,"_godRing",e,{wait:hN.waitAtlas("broad"),clearAll:!1,mask:!1,layer:"top"}),hN.ins.registPanel("ICON_BROAD_VIEW",yW,"_iconBroadView",e,{wait:hN.waitAtlas("broad"),clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("ACTIVITY_OPEN_VIEW",jQ,"_activityOpenView",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("EQUIP_WEAR_TIP",XQ,"_equipWearView",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("GOODS_QUICK_USE_TIP",JQ,"_goodsQuickUseTip",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("HERALD_VIEW",S0,"_heraldView",e,{wait:hN.wait(hN.waitConfig(["ForecastFunction"],["CHerald"])),clearAll:!1,mask:!0})}b(t,"modules.broadcast.proxys.BroadcastProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.updateForce=function(){for(this.lastTotalForce=gR.ins.force;0<this.forcesArr.length;){var e=this.forcesArr.shift();e instanceof protos.actor.toc_30010&&gR.ins.setForce(e.heroIndex,e.force),e instanceof protos.actor.toc_30011&&(gR.ins.petforce=e.force)}this.fightView&&gR.ins.force>this.lastTotalForce&&this.fightView.playFight(gR.ins.force,gR.ins.force-this.lastTotalForce),Tu.sendToModule("UPDATE_FORCE",["modules.nav.NavModule"])},i.subHandler=function(e){var t=this;switch(e.actionOrder){case"Layer_Init":hN.ins.open("EXP_EFFECT_V"),hN.ins.open("POWER_EFFECT_V"),hN.ins.open("RAINBOW_VIEW"),hN.ins.open("NOTICE_VIEW"),hN.ins.open("ITEM_EFFECT_V"),hN.ins.open("ITEM_EFFECT_V2"),hN.ins.open("ATTR_EFFECT_V"),hN.ins.open("FIGHT_EFFECT_V"),hN.ins.open("BROADCAST"),hN.ins.open("RING_GET_EFFECT"),hN.ins.open("ICON_BROAD_VIEW"),QB.ins.pushMsg(RP.n[173],3),QB.ins.pushMsg("亲爱的"+Ql.createColor(gR.ins.charName,"#02b0e9")+RP.n[174],3);break;case"13301":t.messageHandler(e.proto);break;case"11806":t.messageHandler1(e.proto);break;case"LAYER_LAYOUT_OPEN":case"LAYER_LAYOUT_CLOSE":case"SELECTOR_CHANGE":t.broadView&&t.adjustBroadPos();break;case"10204":var i=e.proto.newActor;t.fightView&&t.fightView.playFight(gR.ins.force,i.force);break;case"30010":t.forcesArr.push(e.proto),G.timer.once(100,t,t.updateForce,null,!0);break;case"30011":t.forcesArr.push(e.proto),G.timer.once(200,t,t.updateForce,null,!0);break;case"START_FIGHT_EFFECT":t.fightView&&t.fightView.starPlayFight(),t.toc_10602_att&&(t.roleAttChange(t.toc_10602_att),t.toc_10602_att=null);break;case"10602":var n=e.proto;QQ.delayShow?t.toc_10602_att=n:t.roleAttChange(n);break;case"12001":case"ICON_TIME_OVER":var s=e.proto;null==s&&(s=CN.iconData),jQ.lastShowTips=jQ.needShowTips.concat();for(var o=[],a=0;a<s.icons3.length;a++){var r=s.icons3[a];39!=r.iconId&&57!=r.iconId&&58!=r.iconId&&(r.time<=dr.serverTimeSec&&(o.push(r.iconId),jQ.needShowTips=o,jQ.clearOverdueTips()))}case"__SCENE_CHANGED__":ZN.isEnabledChangeScene()?(hN.ins.isOpen("GOODS_QUICK_USE_TIP")||JQ.ins.showNeedShow(),modules.pet.views.PetHasBirthedTip.ins.parent||modules.pet.views.PetHasBirthedTip.ins.checkShow(),gR.ins.lv>=parseInt($e.MODEL.value($e.getIndex(59)))&&modules.pet.others.PetDataModel.shouldOpenPop&&hN.ins.open("PETPOPTIP"),modules.pet.views.PetgetEggTip.ins.parent||modules.pet.views.PetgetEggTip.ins.checkShow()):hN.ins.close("GOODS_QUICK_USE_TIP");var l=parseInt(uH.Ins().currCid),c=Pn.getIndex(l);if(1!=Pn.MODEL.type(c)&&2!=Pn.MODEL.type(c)&&6001!=l&&1!=l&&-1==_a.S_SBK_SCENES.indexOf(l))hN.ins.isOpen("ACTIVITY_OPEN_VIEW")&&hN.ins.close("ACTIVITY_OPEN_VIEW"),hN.ins.isOpen("GUILD_KUN_NOTICE_VIEW")&&hN.ins.close("GUILD_KUN_NOTICE_VIEW"),hN.ins.isOpen("GUILD_KUN_CALL_VIEW")&&hN.ins.close("GUILD_KUN_CALL_VIEW");else if(6001!=l&&(1==l||2==Pn.MODEL.type(c))){var u=jQ.ableShowTips;u&&0<u.length?null!=t._activityOpenView&&t._activityOpenView.parent?t._activityOpenView.update():hN.ins.open("ACTIVITY_OPEN_VIEW"):hN.ins.isOpen("ACTIVITY_OPEN_VIEW")&&hN.ins.close("ACTIVITY_OPEN_VIEW")}break;case"OPEN_HERALD":hN.ins.open("HERALD_VIEW");break;case"UPDATE":var d=e.proto;d&&0<d.length&&zB.ins.playGetItems(d)}},i.roleAttChange=function(e){for(var t={},i=e.buff,n=0;n<i.length;n++){var s=i[n];t[s.id]?t[s.id]+=s.value:t[s.id]=s.value}for(var o in t)if(0<t[o]){var a=aa.getFormatValue(parseInt(o),t[o]);if(null!=aa.getAttributById(parseInt(o))){var r=aa.getAttributById(parseInt(o)).keyStr;this.attrView&&this.attrView.pushAttr(r,a)}}},i.messageHandler=function(e){if(ei.hasIndex(e.messageID)){var t=ei.getIndex(e.messageID),i=ei.MODEL.content(t),n=ei.MODEL.level(t);if(!(0<n&&gR.ins.lv<n)){var s=mp.getFormat(i,e.paramList),o=ei.MODEL.type(t);if(1!=o||1029!=e.messageID){if(2!=o||1030!=e.messageID)if(4==e.type){var a=0|ei.MODEL.priority(t);zB.ins.playBroadMsg(s,a)}else 3==e.type||2==e.type?zB.ins.showMsg(s,1):5==e.type?QB.ins.pushMsg(s,3):6==e.type?QB.ins.pushMsg(s,2):7==e.type?QB.ins.pushMsg(s,7):zB.ins.showMsg(s,2)}else KQ.ins.showNoGold()}}else hr.isDebug&&QB.ins.pushMsg(Ql.createColor(RP.n[175]+e.messageID,"#ff2e24"),3)},i.messageHandler1=function(e){for(var t=e.len1,i=[],n=0;n<t;n++){if(!ei.hasIndex(e.allMess[n][1]))return void(hr.isDebug&&QB.ins.pushMsg(Ql.createColor(RP.n[176]+e.allMess[n][1],"#ff2e24"),3));var s=ei.getIndex(e.allMess[n][1]),o=ei.MODEL.content(s),a=ei.MODEL.level(s);if(0<a&&gR.ins.lv<a)return;for(var r=0;r<e.allMess[n].length;r++)r+2<e.allMess[n].length&&i.push(e.allMess[n][r+2]);var l=mp.getFormat(o,i),c=ei.MODEL.type(s);if(1==c&&1029==e.messageID)return void KQ.ins.showNoGold();if(2==c&&1030==e.messageID)return;if(4==e.type){var u=0|ei.MODEL.priority(s);zB.ins.playBroadMsg(l,u)}else 3==e.type||2==e.type?zB.ins.showMsg(l,1):5==e.type?QB.ins.pushMsg(l,3):6==e.type?QB.ins.pushMsg(l,2):7==e.type?QB.ins.pushMsg(l,7):zB.ins.showMsg(l,2);i=[]}},i.adjustBroadPos=function(){},i.showPanel=function(e,t){"BROADCAST"==e&&this.adjustBroadPos()},i.closePanel=function(e,t){},t}(),vU=function(e){function t(){this._view=null,this._changeGuildNameView=null,t.__super.call(this),hN.ins.registPanel("CHANGENAME",E0,"_view",this,{mask:!0}),hN.ins.registPanel("GUILD_CHANGENAME",k0,"_changeGuildNameView",this,{mask:!0})}b(t,"modules.changename.proxys.ChangeNameProxys",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"30462":switch(e.proto.result){case 0:zB.ins.showMsg(RP.n[177],1),this._view&&this._view.parent&&this._view.changeName(),hN.ins.close("CHANGENAME");break;case 1:zB.ins.showMsg(RP.n[178],1);break;case 2:zB.ins.showMsg(RP.n[179],1);break;case 3:zB.ins.showMsg(RP.n[180],1)}break;case"30465":var t=e.proto;gR.ins.guildName=t.name;for(var i=gR.ins.actorList,n=0;n<i.length;n++){var s=i[n];if(s){var o=uH.getHero(s.id);""!=gR.ins.guildName&&null!=gR.ins.guildName&&(o.setCharProfessionNameVisible(!0),vN.ins.myGuildBaseToc&&0<vN.ins.myGuildBaseToc.minePos?o.charProfessionName=gR.ins.guildName+"["+Bl.getCNPos(vN.ins.myGuildBaseToc.minePos)+"]":gR.ins.guidePos&&0<gR.ins.guidePos?o.charProfessionName=gR.ins.guildName+"["+Bl.getCNPos(gR.ins.guidePos)+"]":o.charProfessionName=gR.ins.guildName)}}hN.ins.close("GUILD_CHANGENAME")}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),mU=function(e){function t(){this.chatUI=null,this.otherUI=null,t.__super.call(this),hN.ins.registPanel("CHAT",tJ,"chatUI",this,{wait:hN.wait(hN.waitAtlas(["chat","color"]),hN.waitConfig(["ModuleOpenResource"],["CModuleOpenResource"])),mask:!1,delay:99999999})}b(t,"modules.chat.proxys.ChatProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"11803":var t=e.proto;if(4==t.chatType)for(var i=t.arrDto,n=0;n<i.length;n++){var s=i[n];zB.ins.playBroadMsg(s.content,0)}else QB.ins.pushChatDtos(t.chatType,t.arrDto);QB.ins.chatType=t.chatType;break;case"ADDDELETECHANNEL":break;case"GUILD_CHANGE":this.chatUI&&this.chatUI.guildUpdate();break;case"11805":var o=e.proto;this.otherUI&&this.otherUI.parent&&this.otherUI.update(o);break;case"10206":case"21109":GR.getInstance().checkModuleOpen(68)&&(QB.defaultArr=QB.kuafuArr,this.chatUI&&this.chatUI.changeChatUI())}},i.showPanel=function(e,t){},i.closePanel=function(e,t){"CHAT"==e&&(sJ.ins.showCompoment("ChatSimpleUI"),Tu.sendToModule("CHAT_EXIT",["modules.copy.CopyModule"]))},t}(),yU=function(e){function t(){this._expAdd=null,this._text=null,t.__super.call(this)}b(t,"modules.checkpoint.proxys.CheckPointProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"23611":var t=e.proto;UR.instance.currentPoint=t.currentLevel,UR.instance.currentBo=t.currentLevelProgress,UR.instance.current_GetRewardID=t.currentGetBigRewardID,Tu.sendToModule("CHANGE_GUAN_QIA_LEVEL",["modules.nav.NavModule"]),Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"]),UR.instance.currentPoint>=parseInt($e.MODEL.value($e.getIndex(125)))&&G.timer.once(1e3,this,this.resetNavMissionIcon,[e]);break;case"23612":var i=e.proto;UR.instance.currentBo=i.currentKillLittleMonsterProgress;break;case"_CheckPoint_Exp_add_":this.showExpAdd(),UR.instance.isNeedShowUpdate&&(UR.instance.currentPoint-1)%10==0&&this.showUpgrade();break;case"__SCENE_CHANGED__":var n=Pn.getIndex(parseInt(gR.ins.cId));Pn.MODEL.name(n);2==Pn.MODEL.type(n)&&UR.instance.showNextExpAdd();break;case"BP_UPDATE":hN.ins.isOpen("RECYCLE")&&20<TR.ins.getLeftGridNum()&&UR.instance.isAuto&&UR.instance.currentBo==UR.instance.currentCheckPointMaxBo&&(hN.ins._closeAllPanel(),G.timer.once(1e3,FR,FR.killBoss));break;case"10702":var s=e.proto;o_.ins.setRank(s.type,s)}},i.resetNavMissionIcon=function(e){sJ.ins.notice(["NavMission"],e)},i.showPanel=function(e,t){},i.closePanel=function(e,t){},i.showExpAdd=function(){this._expAdd||(this._expAdd=new wW),this._expAdd.parent||eq.navLayer.addChild(this._expAdd),this._expAdd.show()},i.showUpgrade=function(){var e=this;UR.instance.isNeedShowUpdate=!1;var t=Hi.MODEL.quitCid(Hi.getIndex(UR.instance.currentPoint)),i=Pn.MODEL.name(Pn.getIndex(t)),n=mp.getFormat(zB.ins.getDesc(3205),[i]);e._text=new Xl,e._text.innerHTML=n,e._text.fontSize=35,e._text.font="SimHei",e._text.width=600,e._text.style.wordWrap=!0,e._text.color="#02b0e9",e._text.align="center",eq.navLayer.addChild(e._text),e._text.x=(eq.navLayer.width-e._text.width)/2,e._text.y=.6*(eq.navLayer.height-e._text.height),Og.to(e._text,{y:.4*(eq.navLayer.height-e._text.height)},2e3,null,ql.create(e,e.onTextEnd))},i.onTextEnd=function(){this._text&&(this._text.parent&&(this._text.parent.removeChild(this._text),this._text.destroy(!0)),this._text=null)},t}(),IU=function(e){function t(){this._v=null,t.__super.call(this);var e=[_r.getLayoutsPath("dailygift")];hN.ins.registPanel("DAILYGIFT",SQ,"_v",this,{wait:hN.wait(hN.waitRes(e)),mask:!1,layer:"layout"})}b(t,"modules.dailygift.proxys.DailyGiftProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"12202":break;case"12204":var i=xH.create(e.proto);i&&(mB.getInStance().setActivityData(i),XR.initShowConfig(),t._v&&t._v.parent&&t._v.updateView());break;case"12206":var n=e.proto;mB.getInStance().updateGiftVo(n),t._v&&t._v.parent&&t._v.updateView();break;case"DEALACITVITY":t._v&&t._v.parent?t._v.updateView():hN.ins.open("DAILYGIFT");break;case"31061":eR.ins.toc31061=e.proto,t._v&&t._v.parent&&t._v.updateView()}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),bU=function(e){function s(){var e=this;e._ae_explainView=null,e._ae_bubbleSceneView=null,e._ae_bubbleRankView=null,e._ae_bubbleProfitView=null,s.__super.call(e);var t=["FavourPointResource","FavourPointRewardResource"],i=["CFavourPointResource","CFavourPointReward"],n=_r.getLayoutsPath("fightresult");hN.ins.registPanel("AE_EXPLAIN_VIEW",r,"_ae_explainView",e,{clearAll:!1,mask:!0}),n=[_r.getLayoutsPath("digger"),_r.getLayoutsPath("bubbleScene")],hN.ins.registPanel("AE_BUBBLE_SCENE_VIEW",mJ,"_ae_bubbleSceneView",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("AE_BUBBLE_RANK_VIEW",pJ,"_ae_bubbleRankView",e,{wait:hN.waitRes(n),clearAll:!1,mask:!0}),hN.ins.registPanel("AE_BUBBLE_PROFIT_VIEW",_J,"_ae_bubbleProfitView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!1,mask:!1}),hN.ins.registPanel("AE_BUBBLE_RULE_VIEW",C0,"_ae_bubbleRuleView",e,{clearAll:!1,mask:!0})}b(s,"modules.digger.proxys.ActivityEntrance_Proxy",bp);var t=s.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"__SCENE_CHANGED__":233==e.proto&&(hN.ins.isOpen("AE_BUBBLE_SCENE_VIEW")||hN.ins.open("AE_BUBBLE_SCENE_VIEW"),hN.ins.isOpen("AE_BUBBLE_RULE_VIEW")||hN.ins.open("AE_BUBBLE_RULE_VIEW"));break;case"UPDATE_BUBBLE_SELECT":t._ae_bubbleSceneView&&t._ae_bubbleSceneView.updateSelect(e.proto);break;case"30330":QR.curRate=e.proto.rate,QR.b_infoHash=e.proto.infoList,t._ae_bubbleSceneView?t._ae_bubbleSceneView&&t._ae_bubbleSceneView.update():G.timer.frameLoop(10,t,t.onBubbleUpdate);break;case"30331":hN.ins.isOpen("AE_BUBBLE_RANK_VIEW")?t._ae_bubbleRankView&&t._ae_bubbleRankView.update(e.proto):hN.ins.open("AE_BUBBLE_RANK_VIEW",e.proto);break;case"30333":t._ae_bubbleProfitView&&t._ae_bubbleProfitView.update(e.proto)}},t.onBubbleUpdate=function(){this._ae_bubbleSceneView&&(this._ae_bubbleSceneView.update(),G.timer.clear(this,this.onBubbleUpdate))},t.showPanel=function(e,t){switch(e){case"AE_EXPLAIN_VIEW":this._ae_explainView&&this._ae_explainView.parent&&this._ae_explainView.update(t);break;case"AE_BUBBLE_RANK_VIEW":this._ae_bubbleRankView&&this._ae_bubbleRankView.parent&&this._ae_bubbleRankView.update(t)}},t.closePanel=function(e,t){},s}(),wU=function(e){function i(){var e=this;e._jjmainView=null,e._rankV=null,e._season=null,e._matchV=null,e._arenaRankV=null,e._zhanbao=null,e._hasReq=!1,e._toc05=null,e._asset=null,i.__super.call(e);var t=[_r.getLayoutsPath("digger")];hN.ins.registPanel("SPORTS_MAIN_VIEW",LQ,"_jjmainView",e,{wait:hN.wait(hN.waitRes(t)),mask:!1,layer:"layout"}),hN.ins.registPanel("FIELD_RANK",IJ,"_rankV",e,{wait:hN.waitRes(t),clearAll:!1,mask:!0}),hN.ins.registPanel("ARENA_RANK",CQ,"_arenaRankV",e,{wait:hN.wait(hN.waitAtlas("arena"),hN.waitAtlas("rank")),clearAll:!1,mask:!0}),hN.ins.registPanel("ARENA_MATCH",TQ,"_matchV",e,{wait:hN.waitAtlas("arena"),clearAll:!1,mask:!0,clickClose:!1}),hN.ins.registPanel("ARENA_SEASON",MQ,"_season",e,{wait:hN.wait(hN.waitAtlas("arena"),hN.waitAtlas("rank")),clearAll:!1,mask:!0})}b(i,"modules.digger.proxys.PKProxy",bp);var t=i.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_SPORTS_VIEW":hN.ins.toggle("SPORTS_MAIN_VIEW",{_subIndex_:0});break;case"10802":ZB.ins.toc_field=e.proto,t._jjmainView&&t._jjmainView.updateView(),t._rankV&&t._rankV.update();break;case"30360":ZB.ins.updatePlayer(e.proto),t._jjmainView&&t._jjmainView.vsc.selectedView instanceof modules.field.views.FieldFightV&&t._jjmainView.updateView();break;case"10806":var i=new $o;i.type=2,i.cid=parseInt(gR.ins.cId),i.dtoZhanbao=e.proto.zhanbao,i.monsterId=e.proto.playerId,t._zhanbao=i.dtoZhanbao,t._hasReq=!1,Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i);break;case"10807":ZB.ins.playerArr=e.proto.playerArr,t._jjmainView&&t._jjmainView.updateView(),Tu.sendToModule("LIST_UPDATE",["modules.scene.SceneModule"],ZB.ins.playerArr);break;case"__PICKUP_OVER__":if(!t._hasReq&&2==dr.dtoEnterScene.type){var n=new NL;Tu.sendToService(n),t._zhanbao=null}break;case"__ZHAOBAO_END__":2==dr.dtoEnterScene.type&&t._zhanbao&&0==t._zhanbao.items.length&&(n=new NL,Tu.sendToService(n),t._zhanbao=null,t._hasReq=!0);break;case"21302":var s=parseInt($e.MODEL.value($e.getIndex(133)));BR.ins.curCopyId==s&&(kR.ins.toc_arena_pre=kR.ins.toc_arena),kR.ins.toc_arena=e.proto,t._jjmainView&&t._jjmainView.updateView(e.proto),null!=t._matchV&&t._matchV.update();break;case"21305":t._toc05=e.proto,t._jjmainView&&t._jjmainView.updateView(t._toc05),null!=t._matchV&&t._matchV.updatePlayer(t._toc05);break;case"21308":t._jjmainView&&t._jjmainView.updateView(e.proto);break;case"21311":kR.ins.toc_rank=e.proto,t._jjmainView&&t._jjmainView.updateView(e.proto),t._season&&t._season.update(),t._arenaRankV&&t._arenaRankV.update();break;case"21313":kR.ins.toc_extra=e.proto,t._season&&t._season.update();break;case"21315":kR.ins.toc_preRank=e.proto,t._arenaRankV&&t._arenaRankV.update(),t._jjmainView&&t._jjmainView.updateView(e.proto);break;case"21316":kR.ins.toc_red=e.proto;break;case"EFFECT_END":t._toc05&&1==t._toc05.state&&null!=t._matchV&&t._matchV.startCountDown();break;case"COUNTDONW_END":t.enterFight();var o=parseInt($e.MODEL.value($e.getIndex(133))),a=new YV;a.copyId=o,Tu.sendToService(a);break;case"__ZHAOBAO_END__":if(5==e.proto){var r=new RA;Tu.sendToService(r);for(var l=kR.ins.getEachFightIdx(!0),c=aR.getMoneyItems(At.MODEL.resourceReward(l)),u=At.MODEL.goodsReward(l).split(";"),d=0;d<u.length;d++){var h=u[d].split(",");c.push({itemId:parseInt(h[0]),itemNum:parseInt(h[1])})}t._toc05=null}break;case"__ARENA_EXIT__":hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:1})}},t.closeFightResult=function(){hN.ins.close("RESULT_FAIL")},t.clearAsset=function(){this._asset&&(GB.release(this._asset),this._asset=null)},t.closePanel=function(e,t){},t.exitFight=function(){aF.callbackYeZhan()},t.showPanel=function(e,t){if("ARENA_RANK"==e){var i=t;this._arenaRankV&&this._arenaRankV.reqData(i)}},t.enterFight=function(){Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],[MN.ARENA,!1]),EZ.callback=ql.create(this,this.onSure),EZ.alertMsg=RP.n[155]},t.startFight=function(){Tu.sendToModule("START_JINGJI",["modules.scene.SceneModule"])},t.exitFight2=function(){Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.NORMAL),aF.exit({type:5})},t.onSure=function(){Tu.sendToModule("CLOSE_START",["modules.fight.FightModule"]),this.exitFight2()},i}(),xU=function(e){function t(){this._mainV=null,this._rankV=null,this._zhanbao=null,this._hasReq=!1,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("field")),e.push(_r.getAtlasSubPath("field/bg_recycle.jpg"));hN.ins.registPanel("FIELD_VIEW",L0,"_mainV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigOutdoorFightAward","ConfigOutdoorRankAward","ConfigPrestigePKAward","ConfigSearchEnemyBuy"],["CFieldFightAward","CFieldRankAward","CFieldInfo","CFieldEnemyBuy"])),mask:!1,layer:"layout"})}b(t,"modules.field.proxys.FieldProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){},i.exitFight=function(){aF.callbackYeZhan()},i.onGoFight=function(e){if(1==e){var t=JN.ins.getRecommendScene();ZN.goTarget(18,"FIELD_VIEW",t,!1,{durT:1e3})}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),SU=function(e){function t(){t.__super.call(this)}b(t,"modules.fight.proxys.FightProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){e.actionOrder},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),kU=function(e){function n(){var e=this;e._succView=null,e._failView=null,e._startView=null,e._arenaSucceedView=null,e._arenaFailView=null,e._fightSuccessPersonBossFirstKill=null,n.__super.call(e);var t=[_r.getLayoutsPath("fightresult"),_r.getAtlasSubPath("fightresult/ty_js_db.png"),_r.getAtlasSubPath("fightresult/ty_js_tt.png")];hN.ins.registPanel("RESULT_SUCC",wJ,"_succView",e,{wait:hN.waitRes(t),layer:"panel"});var i=[_r.getLayoutsPath("fightresult")];hN.ins.registPanel("RESULT_FAIL",SJ,"_failView",e,{wait:hN.waitRes(i),layer:"panel",mask:!0}),hN.ins.registPanel("RESULT_START",bJ,"_startView",e,{wait:hN.waitAtlas("fightstart"),layer:"under"}),hN.ins.registPanel("ARENA_SUCCEED",AQ,"_arenaSucceedView",e,{wait:hN.waitAtlas("arena"),layer:"under"}),hN.ins.registPanel("ARENA_FAIL",kQ,"_arenaFailView",e,{wait:hN.waitAtlas("arena"),layer:"under"}),hN.ins.registPanel("FightSuccessPersonBossFirstKillPanel",M0,"_fightSuccessPersonBossFirstKill",e,{wait:hN.waitRes(t),mask:!0,clickClose:!1})}b(n,"modules.fight.proxys.FightResultProxy",bp);var t=n.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){switch(e.actionOrder){case"OPEN_SUCC":tr.push("+++++++ run  subHandler Fight_order.OPEN_SUCC");var t=e.proto;hN.ins.open("RESULT_SUCC",t);break;case"OPEN_FAIL":var i=e.proto;hN.ins.open("RESULT_FAIL",i);break;case"OPEN_ARENA":break;case"OPEN_START":var n=e.proto;hN.ins.open("RESULT_START",n);break;case"CLOSE_START":this._startView&&this._startView.stop(),hN.ins.close("RESULT_START");break;case"ARENA_SUCCEED":t=e.proto,hN.ins.open("ARENA_SUCCEED",t);break;case"ARENA_FAIL":i=e.proto,hN.ins.open("ARENA_FAIL",i);break;case"PERSON_FIRST_SKILL":hN.ins.open("FightSuccessPersonBossFirstKillPanel",e.proto)}},t.closePanel=function(e,t){},t.showPanel=function(e,t){"RESULT_SUCC"==e?(this._succView.update(t.award,t.callback,t.cate),UB.ins.playSound("11")):"RESULT_FAIL"==e?(this._failView.update(t.award,t.callback),UB.ins.playSound("11")):"ARENA_SUCCEED"==e?(this._arenaSucceedView.update(t),UB.ins.playSound("11")):"ARENA_FAIL"==e?(this._arenaFailView.update(t),UB.ins.playSound("11")):"RESULT_START"==e?t?this._startView.start(0|t.type,t.callback):this._startView.start():"FightSuccessPersonBossFirstKillPanel"==e&&(this._fightSuccessPersonBossFirstKill.update(t.award,t.callback,t.cate),UB.ins.playSound("11"))},n}(),EU=function(e){function t(){this._preivewView=null,t.__super.call(this);_r.getLayoutsPath("godequip"),_r.getLayoutsImagePath("godequip/godequip_bg.jpg");hN.ins.registPanel("GodEquipPreviewView",A0,"_preivewView",this,{mask:!0})}b(t,"modules.god.proxys.GodEquipProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN":case"GE_RECYCLE":break;case"GE_OPEN_PREVIEW":hN.ins.open("GodEquipPreviewView",e.proto)}},i.closePanel=function(e,t){},i.showPanel=function(e,t){"GodEquipPreviewView"==e&&this._preivewView.updateViewData(t)},t}(),TU=function(s){function i(){var e=this;e._godWeaponMainPanel=null,e._godWeaponHolySelectPanel=null,e._godWeaponFairylandRank=null,e._godWeaponFairylandSuccessPanel=null,e._godWeaponFairylandCountDownPanel=null,e._syTiXing=null,e._syEnter=null,e.syData=null,i.__super.call(e);e.syData=cN.instance;var t=[];t.push(_r.getLayoutsPath("godweapon")),t.push("ui/layouts/godweapon/sb_jm_db.jpg"),t.push("ui/layouts/godweapon/gq_ts_db.png"),hN.ins.registPanel("GodWeaponMainPanel",RQ,"_godWeaponMainPanel",e,{wait:hN.wait(hN.waitRes(t),hN.waitConfig(["GWFairyLandResource","GodArmsResource","GodArmsEquipResource","GodWeaponPointResource","GodWeaponShowResource","GodWeaponResource","ConfigRule"],["GWFairyLandResource","CGodArmsUpgrade","CGodArmsHoly","CGodWeaponPosition","CGodWeaponShow","CGodWeapon","CHelpDes"])),layer:"layout",mask:!1}),hN.ins.registPanel("GOD_WEAPON_SELECT_HOLY_PANEL",DW,"_godWeaponHolySelectPanel",e,{layer:"panel",mask:!0}),hN.ins.registPanel("GodWeaponFairylandRankPanel",O0,"_godWeaponFairylandRank",e,{mask:!0}),hN.ins.registPanel("GodWeaponFairylandSuccessPanel",P0,"_godWeaponFairylandSuccessPanel",e,{wait:hN.wait(hN.waitAtlas(["godweapon"])),mask:!0,clickClose:!1}),hN.ins.registPanel("GodWeaponFairylandCountDownPanel",D0,"_godWeaponFairylandCountDownPanel",e,{mask:!0,clickClose:!1}),hN.ins.registPanel("GODWEAPON_SY_SETTING",R0,"_syTiXing",e,{mask:!0}),hN.ins.registPanel("GODWEAPON_SY_ENTER",B0,"_syEnter",e,{mask:!0})}b(i,"modules.godweapon.proxys.GodWeaponProxy",s);var e=i.prototype;return G.imps(e,{"ui.IPanelProxy":!0}),e.subHandler=function(e){var t=this;switch(s.prototype.subHandler.call(t,e),e.actionOrder){case"OPEN_MAIN_PANEL":hN.ins.isOpen("GodWeaponMainPanel")||hN.ins.open("GodWeaponMainPanel",e.proto);break;case"CLOSE_MAIN_PANEL":hN.ins.close("GodWeaponMainPanel");break;case"OPEN_HOLY_SELECTED_PANEL":hN.ins.isOpen("GOD_WEAPON_SELECT_HOLY_PANEL")||hN.ins.open("GOD_WEAPON_SELECT_HOLY_PANEL",e.proto);break;case"CLOSE_HOLY_SELECTED_PANEL":hN.ins.close("GOD_WEAPON_SELECT_HOLY_PANEL");break;case"30302":iN.instance.updateInfo(e.proto),t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(null),OW.instance.update();break;case"23722":case"23720":iN.instance.updateTaskStatus(),t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(null);break;case"10205":t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(null);break;case"OPEN_SHNEGYU_SETTING":hN.ins.isOpen("GODWEAPON_SY_SETTING")||hN.ins.open("GODWEAPON_SY_SETTING");break;case"OPEN_SHNEGYU_ENTER":hN.ins.isOpen("GODWEAPON_SY_ENTER")||hN.ins.open("GODWEAPON_SY_ENTER",e.proto);break;case"30340":t.syData.ShenBin_TowerInfo=e.proto,t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(e.proto);break;case"30350":t.syData.ShenBin_ShenYuInfo=e.proto,t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(e.proto);break;case"30342":case"30352":t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.vsc.selectedIndex==parseInt("3")&&t.syData.reqShenBinTower(20);case"30343":case"30353":hN.ins.isOpen("GODWEAPON_SY_ENTER")&&hN.ins.close("GODWEAPON_SY_ENTER"),t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.vsc.selectedIndex==parseInt("3")&&t.syData.reqShenBinTower(20);break;case"CLOSE_SY_SELCTED_VIEW":t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.vsc.selectedIndex==parseInt("3")&&t._godWeaponMainPanel.vsc.selectedView.updateRedPoint();break;case"OPEN_FAIRYLAND_RANK":hN.ins.isOpen("GodWeaponFairylandRankPanel")||hN.ins.open("GodWeaponFairylandRankPanel");break;case"10702":var i=e.proto;o_.ins.setRank(i.type,i),15==i.type&&t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.vsc.selectedView instanceof modules.godweapon.views.fairyland.GodWeaponFairylandMainView&&t._godWeaponMainPanel.vsc.selectedView.updateRank();break;case"23770":nN.instance.update23770(e.proto),t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.updateView(null);break;case"23771":nN.instance.update23771(e.proto),t._godWeaponMainPanel&&t._godWeaponMainPanel.parent&&t._godWeaponMainPanel.updateView(null),Tu.sendToModule("CHALLENGE_FINISH",["modules.nav.NavModule"]);break;case"OPEN_FAIRYLAND_SUCCESS_PANEL":if(!hN.ins.isOpen("GodWeaponFairylandSuccessPanel")){var n=e.proto;hN.ins.open("GodWeaponFairylandSuccessPanel",n)}break;case"23703":null!=t._godWeaponMainPanel&&t._godWeaponMainPanel.updateView(e)}},e.showPanel=function(e,t){var i=this;switch("GOD_WEAPON_SELECT_HOLY_PANEL"==e&&i._godWeaponHolySelectPanel&&i._godWeaponHolySelectPanel.updataData(t),"GODWEAPON_SY_ENTER"==e&&i._syEnter&&i._syEnter.refreshPanel(t),e){case"GodWeaponFairylandSuccessPanel":i._godWeaponFairylandSuccessPanel.updateView(t);break;case"GODWEAPON_SY_ENTER":i._syEnter&&i._syEnter.refreshPanel(t);break;case"GODWEAPON_SY_SETTING":i._syTiXing&&i._syTiXing.showInfo();break;case"GodWeaponMainPanel":t&&t.hasOwnProperty("selectedIndex")&&(i._godWeaponMainPanel.vsc.selectedIndex=parseInt(t.selectedIndex))}},e.closePanel=function(e,t){},i}(bp),CU=function(e){function t(){this._rotaryV=null,this._rotaryGet=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("goldrotary")),e.push(_r.getAtlasSubPath("goldrotary/treasure_mimg_frame.png")),e.push(_r.getAtlasSubPath("goldrotary/acer_img_bg.jpg")),e.push(_r.getAtlasSubPath("goldrotary/acer_text_prompt.png"));hN.ins.registPanel("GOLDROTARY",G0,"_rotaryV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigGoldTurn","ConfigGoldTurnRate"],["CGoldTurn","CGoldTurnRate"])),mask:!1,layer:"layout"}),hN.ins.registPanel("GOLDROTARYGET",FJ,"_rotaryGet",this,{wait:hN.waitAtlas("goldrotary"),clearAll:!1,mask:!0})}b(t,"modules.goldrotary.proxys.GoldrotaryProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"12216":sl.ins.toc_info=e.proto,this._rotaryV&&this._rotaryV.updateInfo();break;case"12218":this._rotaryV&&this._rotaryV.retResult(e.proto.ret);break;case"12219":var t=sl.ins.toc_record;if(t){var i=e.proto;1==i.recordType?(t.bRecords.unshift(i.dto),20<t.bRecords.length&&t.bRecords.pop()):(t.aRecords.unshift(i.dto),2<t.aRecords.length&&t.aRecords.pop()),this._rotaryV&&this._rotaryV.updateRecord()}break;case"12220":sl.ins.toc_record=e.proto,this._rotaryV&&this._rotaryV.updateRecord()}},i.showPanel=function(e,t){if("GOLDROTARY"==e){var i=t;if(i){var n=mB.getInStance().getMainType(i),s=n?n.activityIds[0]:0;this._rotaryV.actId=s,WB.getActivityData(s,ql.create(this,this.onActivity))}}},i.onActivity=function(e){this._rotaryV&&this._rotaryV.parent&&this._rotaryV.updateTime()},i.closePanel=function(e,t){},t}(),LU=function(e){function t(){this._gk_title=null,t.__super.call(this),hN.ins.registPanel("COMMON_GK_TITLE",EJ,"_gk_title",this,{layer:"nav",wait:hN.waitAtlas("gk_title")})}b(t,"modules.gui.proxys.CommonUIProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){e.actionOrder},i.showPanel=function(e,t){"COMMON_GK_TITLE"==e&&this._gk_title.update(t)},i.closePanel=function(e,t){},t}(),MU=function(e){function t(){this._helpPanel=null,t.__super.call(this)}b(t,"modules.gui.proxys.GuiMainProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"resize":eq.panelLayer&&eq.panelLayer.resize();break;case"__LOGIN_ENTERSCENE__":eq.instance.parent||eq.setup(),G.timer.frameOnce(1,this,this.layerInited);break;case"10205":eq.layout&&eq.layout.updateMoney();break;case"SHOWCLOSENEWGUIDE":this.doShowGuide(hN.ins._getLayoutPanelId())}},i.doShowGuide=function(e){if(pn.hasIndex(12)){var t=pn.getIndex(12),i=pn.MODEL.delaytime(t);if(0<i)G.timer.once(i,this,this.delayShowGuide,[e]);else{var n=hN.ins._getPanel(hN.ins._getLayoutPanelId());n&&n.showGuide(12,!0)}}},i.delayShowGuide=function(e){if(e==hN.ins._getLayoutPanelId()){var t=hN.ins._getPanel(hN.ins._getLayoutPanelId());t&&t.showGuide(12,!0)}},i.layerInited=function(){Tu.sendToTotalModule("Layer_Init")},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),AU=function(e){function t(){this._awardV=null,t.__super.call(this),hN.ins.registPanel("GUIDE_AWARD",WJ,"_awardV",this,{wait:hN.wait(hN.waitAtlas("guide"),hN.waitConfig(["ConfigSysGuideDesc","ConfigSystemGuideTask"],["CSysGuideDesc","CSysGuide"])),clearAll:!1,mask:!0})}b(t,"modules.guide.proxys.GuideProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"Layer_Init":G.timer.once(300,this,this.reqGuide);break;case"11502":Rl.ins.toc_info=e.proto,sJ.ins.notice(["GuideIcon"],null),this._awardV&&this._awardV.update();break;case"11504":var t=Rl.ins.awardId;if(!t)return;var i=Wn.getIndex(t),n=Wn.MODEL.zhanshiGoodsAward(i);gR.ins.actorById(1).job==ha.FA.type?n=Wn.MODEL.fashiGoodsAward(i):gR.ins.actorById(1).job==ha.DAO.type&&(n=Wn.MODEL.daoshiGoodsAward(i)),zB.ins.playGetGoods(n),Rl.ins.awardId=0;break;case"11901":sJ.ins.notice(["NavMineView"],null);break;case"10206":case"EQUIP_UPDATE":sJ.ins.notice(["GuideIcon"],null);break;case"SHOW_GUIDE":var s=sJ.ins.getCompomentsByName("GuideIcon");s&&s.open();break;case"HIDE_GUIDE":(s=sJ.ins.getCompomentsByName("GuideIcon"))&&s.close()}},i.reqGuide=function(){var e=new sM;Tu.sendToService(e)},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),DU=function(e){function t(){this._mainV=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("jianbao")),hN.ins.registPanel("JIANBAO_PANEL",U0,"_mainV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigLuckDrawResource","ConfigLuckDrawSubResource"],["ConfigLuckDrawResource","ConfigLuckDrawSubResource"])),mask:!1,layer:"layout"})}b(t,"modules.jianbao.proxys.JianbaoProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_JIANBAO":var t=e.proto;mB.getInStance().setMainType(t);hN.ins.open("JIANBAO_PANEL",e.proto);break;case"31031":case"31032":case"31033":this._mainV&&this._mainV.parent&&this._mainV.updateByVSC(e.proto)}},i.showPanel=function(e,t){},i.onActivity=function(e){},i.closePanel=function(e,t){},t}(),OU=function(e){function t(){this._mainView=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("limitchallenge")),e.push(_r.getLayoutsPath("limitYQBtn")),hN.ins.registPanel("LIMIT_CHALLENGE_MAIN_VIEW",WQ,"_mainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(rc.flyroad_A,rc.flyroad_C)),layer:"layout",mask:!1,clearAll:!0})}b(t,"modules.limitChallenge.proxys.LimitChallengeProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_LIMIT_CHALLENGE_MAIN":hN.ins.open("LIMIT_CHALLENGE_MAIN_VIEW",e.proto);break;case"UPDATE_LIMIT_CHALLENGE":null!=t._mainView&&t._mainView.update(e.proto);break;case"GET_AWARD_EFFECT":if(t._mainView&&t._mainView.vsc){var i=t._mainView.vsc.selectedView;null!=i&&i.showEffect(e.proto)}break;case"23720":lB.instance().updateTaskInfoByServer(e.proto),null!=t._mainView&&t._mainView.update(e.proto);break;case"23722":e.proto,null!=t._mainView&&t._mainView.update(e.proto);break;case"23724":var n=e.proto;yN.ins.groupId=n.groupId,yN.ins.leaveTime=n.leaveTime,null!=t._mainView&&t._mainView.update(e.proto);break;case"23725":break;case"23731":eq.panelLayer.closeAll(),KJ.ins.show();break;case"23732":mN.ins.groupId=e.proto.groupId,mN.ins.leaveTime=1e3*e.proto.leftTime,mN.shouldOpen;break;case"23733":Bs.count<=0?HP.loadConfig(["GLCResoure"],["ConfigGELC"],ql.create(t,t.onConfigLoaded,[e.proto.taskInfo])):mN.ins.setData(e.proto.taskInfo);break;case"SHOW_GUIDE_AIM":if(t._mainView&&t._mainView.vsc)t._mainView.vsc.selectedView.showAimGuide()}},i.onConfigLoaded=function(e){mN.ins.setData(e)},i.showPanel=function(e,t){if("LIMIT_CHALLENGE_MAIN_VIEW"==e){if(this._mainView){var i=mN.ins.groupId-1<0?0:mN.ins.groupId-1;i>=this._mainView.navList.length&&(i=this._mainView.navList.length-1),this._mainView.vsc.selectedIndex=i,this._mainView.tabScrollTo(i)}this._mainView&&this._mainView.vsc.updateSelectedView(t)}},i.closePanel=function(e,t){},t}(),PU=function(t){function i(){var e=this;e.isBodyPart=!1,e.renderType=null,e.texture=null,e.partType=null,e.layer=null,e.offsetX=NaN,e.offsetY=NaN,e.tx=NaN,e.ty=NaN,e.w=0,e.h=0,e.rect=null,e.isRenderNow=!1,e.renderMode=0,e.passID=null,e.x=0,e.y=0,e.part_id=null,e.isFollow=!1,e.depth=0,e.act="",e.frame=0,e.dir=0,e.layerX=-1,e.layerY=-1,e.owner=null,e.isRemove=!1,e.mat=null,e.scaleN=1,e.scaleMatrix=new bu,i.__super.call(e)}b(i,"zwc.engine.core.displays.avatars.render.RenderOrder",t);var e=i.prototype;return e.apply=function(){},e.dispose=function(){var e=this;t.prototype.dispose.call(e),e.renderType=null,e.texture=null,e.layer=null,e.offsetX=0,e.offsetY=0,e.tx=0,e.ty=0,e.owner=null,e.rect=null,e._applyHandler_&&e._applyHandler_.dispose(),e._applyHandler_=null,e.renderMode=0,e.isRenderNow=!1,e.mat=null,e.scaleN=1,e.scaleMatrix.identity()},i.GetNew=function(){return new i},i.EFFECT="RENDER_EFFECT",i.BODY="RENDER_BODY",i}(wh),RU=function(e){function i(){this.toc_06=null,this.isLoading=!1,this.leftTimeStr="",this.persent=0,this.statusType=0,this.pointStr="",this.msgTxts=null,this.hasenter=!1,this.isConchApp=!1,this.m_IsLoaded=!1,this.loginLoaded=-1,this.m_LoadingUI=null,this.m_firstLoading=null,this.roleCreate=null,this.serviceLineUI=null,this.loginUI=null,this.maxRequestTime=2,this.requestSuccse=!1,this.serverList=null,this.reqVerifySuccess=!1,this.maxVerifyTime=2,this.verifyUrl=null,i.__super.call(this)}b(i,"modules.login.proxys.LoginProxy",bp);var t=i.prototype;return t.toConnect=function(){SF.GetIntance().connect(hr.socket_host,hr.socket_port)},t.subHandler=function(e){var t=this;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":break;case"__TO_LOGIN__":0<hr.clientGate?t.loadStarLogin():t.starLogin();break;case"STARTLODING":t.persent=0,t.statusType=1,G.timer.frameLoop(1,t,t.doShowLoading);break;case"__SOCKET_CONENTED__":xs.mirClick(31,hr.pid,hr.uid),null!=hr.uid&&""!=hr.uid?0<hr.clientGate||30==hr.client?t.requestEnter():10==hr.client||20==hr.client||dr.isConchApp?t.reqEnterVerify():t.showServerList():(G.timer.clear(t,t.doShowLoading),t.closeLoading(),hr.isDebug?t.showLoginView():t.starLogin());break;case"CLOSESERVERLIST":null!=t.serverList&&t.serverList.parent&&t.serverList.closeList();break;case"REQUESTENTER":t.reqEnterVerify();break;case"SETLOADING":if(t.startLoading(),t.m_LoadingUI){var i=e.proto;t.m_LoadingUI.setLoading(i.des,i.per,i.gPer)}break;case"SHOWCREATEROLE":t.isLoading=!1;var n=SF.GetIntance().loginSocket;if(n&&n.connected){_r.isCreated?(t.sendToService(new dL),console.log("SHOWCREATEROLE,send tos_10107"),tr.push("SHOWCREATEROLE,send tos_10107"),gR.ins.charId&&t.enterGame()):t.showCreateRole();break}console.log("server disconnet");case"SHOWLOGINUI":0<hr.clientGate?t.reqEnterVerify():t.showServerList();break;case"resize":t.onResize();break;case"10102":t.closeLoginView(),xs.mirClick(33,hr.pid,hr.uid);var s=e.proto;1==s.status?(_r.isCreated=s.isCreated,0==hr.clientGate&&(_r.justCreated=1==s.justCreated),t.startLoading(),G.timer.clear(t,t.doShowLoading),xs.mirClick(12,hr.pid,hr.uid),jB.getIntance().setup()):HP.checkBasicLoaded()?t.showAlertOutServer(5):HP.loadBasicUI(ql.create(t,t.showAlertOutServer,[5])),console.log("receive >>>>10102"),hr.hasFirstSend=!0;break;case"10104":var o=e.proto;t.roleCreate&&t.roleCreate.parent&&t.roleCreate.setName(o.nameStr);break;case"10110":var a=e.proto;dr.curServerTime=a.serverTime,dr.openServeTime=a.openServeTime,dr.comServeTime=a.ComServeTime,LN.curOpenServiceDay=dr.getOpenServiceDay();break;case"10114":var r=e.proto;if(tr.push(RP.n[193]+r.status),1==r.status){var l=!(0<r.missionId&&0==r.missonOver);if(l&&BR.ins.toc25000||0==l&&null==BR.ins.toc25000){tr.push(RP.n[194]),BR.ins.offlineClearObject();var c=uH.Ins().prveCid=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"";NF.Ins().changeScene(c,!0,ql.create(BR.ins,BR.ins.offlineClearObject))}else l&&null==BR.ins.toc25000?BR.ins.offlineClearObject():0==l&&BR.ins.toc25000||l&&4e3<pt.now()-SF.GetIntance().offLineTime&&SF.GetIntance().reLogin();SF.GetIntance().reSetWebSocket(),Tu.sendToModule("__LOGIN_RECONENTED__",["modules.scene.SceneModule","modules.offline.OfflineModule"])}else HP.checkBasicLoaded()?t.showAlertOutServer(5):HP.loadBasicUI(ql.create(t,t.showAlertOutServer,[5]));break;case"10118":var u=e.proto;t.leftTimeStr=RP.n[195]+u.day+"天"+u.hour+"时"+u.mintue+"分",HP.checkBasicLoaded()?t.showAlertOutServer(7):HP.loadBasicUI(ql.create(t,t.showAlertOutServer,[7]));break;case"10106":if(t.toc_06=e.proto,1==t.toc_06.result)_r.isCreated=!0,_r.justCreated=!0,t.closeRoleCreate(),t.sendToService(new dL),gR.ins.charId&&t.enterGame();else switch(t.toc_06.result){case 2:var d=ei.getIndex(10001);t.playErrorMsg(ei.MODEL.content(d));break;case 3:var h=ei.getIndex(10002);t.playErrorMsg(ei.MODEL.content(h)),t.roleCreate&&t.roleCreate.parent&&t.roleCreate.onGetRadomName();break;case 4:t.playErrorMsg(RP.n[196]);break;case 5:t.playErrorMsg(RP.n[197]);break;case 6:t.playErrorMsg(RP.n[198])}break;case"10201":xs.mirClick(21,hr.pid,hr.uid),!t.isLoading&&_r.isCreated&&t.enterGame();break;case"13602":m_.ins.setSwitch(e.proto.report);break;case"13303":var _=e.proto;tr.push(RP.n[199]+_.outType),HP.checkBasicLoaded()?t.showAlertOutServer(_.outType):HP.loadBasicUI(ql.create(t,t.showAlertOutServer,[_.outType]))}},t.doShowLoading=function(){var e=this;1<=e.persent&&(e.persent=0);""==e.pointStr?e.pointStr=".":"."==e.pointStr?e.pointStr="..":(e.pointStr,e.pointStr);var t=RP.n[200]+e.pointStr;e.setLoading(t,e.persent),e.persent+=.02*Math.random()},t.setLoading=function(e,t){void 0===t&&(t=.5),Tu.sendToModule("SETLOADING",["modules.login.LoginModule"],{des:e,per:t})},t.onExitMiniGame=function(e){2==dr.xgame?wx.exitMiniProgram({}):pt.window.location.reload()},t.showAlertOutServer=function(e){var t=RP.n[201];switch(e){case 0:return t=RP.n[202],KQ.ins.show(t,ql.create(this,this.onExitMiniGame),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),void(KQ.ins.cancelClose=!0);case 1:t=RP.n[203];break;case 2:t=RP.n[204];break;case 3:t=RP.n[205];break;case 4:t=RP.n[206];break;case 5:t=RP.n[207];break;case 6:t=RP.n[208];break;case 7:t=RP.n[209]+this.leftTimeStr}KQ.ins.show(t,ql.create(this,this.onReConect),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),KQ.ins.cancelClose=!0},t.playErrorMsg=function(e){var t=kB.createText(G.stage.width/2-150,G.stage.mouseY-20,200,20,e,20,"#ff2e24",!0),i=t.y-150;G.stage.addChild(t),Og.to(t,{alpha:0,y:i},1500,null,ql.create(this,this.onTFGone,[t]))},t.onTFGone=function(e){e&&(e.parent&&e.parent.removeChild(e),e.destroy(),e=null)},t.onReConect=function(e){1!=e&&0!=e||pt.window.location.reload()},t.enterGame=function(){this.hasenter||(nr.ins().endStep(nr.ENTER),this.pushguiClientid(),this.hasenter=!0,hr.game_time=pt.now(),_r.justCreated?(dr.isConchApp&&(dr.nativeIOS?BP.app_createRole(hr.serverID,hr.serverName):BP.app_reportRole("create_role")),G.timer.once(500,this,this.delayReport)):(dr.isConchApp?dr.nativeIOS?BP.app_enterGame(hr.serverID,hr.serverName):BP.app_reportRole("enter_game"):jP.sdk_cmd("report_entergame"),Te.instance.freeAll()),NF.Ins().setupMainCharData(gR.ins),tr.push("LoginProxy-----enterGame"),NF.Ins().changeScene(gR.ins.cId),this.sendToTotalModule("__LOGIN_ENTERSCENE__"),this.clearUI(),xs.mirClick(22,hr.pid,hr.uid),UB.ins.start(),NP.startLoop(),yc.clearRes(_r.getLayoutsPath("login"),!0),yc.clearRes(_r.getLayoutsPath("labelbtn"),!0),NF.Ins().startTouchDownHander(),HP.loadStyleImage("fightNumer","fightNumer"),HP.loadStyleImage("heji","heji"),HP.loadStyleImage("fightText","fightText"),HP.loadStyleImage("zhuijiText","zhuijiText"),this.sendServerInfo(),_r.justCreated&&qB.getIntance().reLdOtCfg())},t.sendServerInfo=function(){this.sendInvInfo()},t.delayReport=function(){dr.isConchApp?dr.nativeIOS?BP.app_enterGame(hr.serverID,hr.serverName):BP.app_reportRole("enter_game"):jP.sdk_cmd("report_entergame")},t.starLogin=function(){this.showFirstLoading(),this.loadStarLogin()},t.loadStarLogin=function(){var e=this;if(e.m_IsLoaded)e.doShowLoginSatrView();else{xs.mirClick(29,hr.pid,hr.uid),nr.ins().startStep(nr.LOGIN);var t=_r.getLayoutsPath("login");G.loader.getRes(t)||0!=hr.clientGate?e.onLoginLoaded(!0):(G.timer.loop(3e4,e,e.checkLoginLoaded),nr.log("loginUrl:"+t),i.urls.push(t),G.loader.load([{url:t}],ql.create(e,e.onLoginLoaded),ql.create(e,e.onLoginLoading))),e.m_IsLoaded=!0}},t.checkLoginLoaded=function(e){if(-1==this.loginLoaded){this.loginLoaded=0;var t=_r.getFullUrl("ui/layouts/login.atlas?"+pt.now());G.loader.load(t,ql.create(this,this.onLoginLoaded),ql.create(this,this.onLoginLoading))}else this.onLoginLoaded()},t.showLoading=function(){null==this.m_LoadingUI&&(this.m_LoadingUI=new HW),this.m_LoadingUI.isShowing()||(this.isLoading=!0,this.m_LoadingUI.show(),BP.hasPhoneBang||(this.m_LoadingUI.centerY=0))},t.startLoading=function(){this.m_LoadingUI&&this.m_LoadingUI.isShowing&&this.m_LoadingUI.isShowing()||this.showLoading()},t.closeLoading=function(){this.m_LoadingUI&&(this.m_LoadingUI.destroyed||this.m_LoadingUI.destroy(),this.m_LoadingUI=null,this.isLoading=!1)},t.onLoginLoading=function(e){this.m_firstLoading&&this.m_firstLoading.setLoading(e)},t.showFirstLoading=function(){null==this.m_firstLoading&&(this.m_firstLoading=new xj),this.m_firstLoading.isShowing()||this.m_firstLoading.show()},t.showCreateRole=function(){i.urls&&0<i.urls.length&&(this.closeLoading(),this.doShowCreateRole())},t.doShowCreateRole=function(){null==this.roleCreate&&(this.roleCreate=new YW),this.roleCreate.show()},t.closeRoleCreate=function(){this.roleCreate&&(this.roleCreate.destroy(),this.roleCreate=null)},t.onLoginLoaded=function(e){var t=this;if(void 0===e&&(e=!1),nr.log("main login end resouce:"+e,e?0:1),t.loginLoaded=1,G.timer.clear(t,t.checkLoginLoaded),nr.ins().endStep(nr.LOGIN),dr.isConchApp||jP.deviceInfo||jP.sdk_cmd("app_device_info"),t.m_firstLoading&&t.m_firstLoading.parent&&t.m_firstLoading.destroy(),t.m_firstLoading=null,hr.socket_host){if(20==hr.client)return void t.doShowLoginSatrView();xs.mirClick(30,hr.pid,hr.uid),(10==hr.client||0<hr.clientGate||30==hr.client)&&Tu.sendToModule("STARTLODING",["modules.login.LoginModule"]),SF.GetIntance().connect(hr.socket_host,hr.socket_port)}else(t.m_firstLoading=null)==t.serviceLineUI&&(t.serviceLineUI=new WW),t.serviceLineUI.show()},t.showLoginView=function(){this.m_firstLoading&&this.m_firstLoading.parent&&this.m_firstLoading.destroy(),this.m_firstLoading=null,(i.urls&&0<i.urls.length||0<hr.clientGate)&&(null==this.loginUI&&(this.loginUI=new VW),this.loginUI.show())},t.closeLoginView=function(){this.serverList&&(this.serverList.destroy(),this.serverList=null)},t.showServerList=function(){var e=this;if(e.maxRequestTime<=0)pt.window.location.reload();else{e.maxRequestTime--,G.timer.clear(e,e.checkImportTimeOut);var t=new Object;t.platCode=hr.platform,t.pid=hr.pid,t.account=hr.uid,e.isConchApp&&(t.token=hr.token),t.gid=hr.gid,t.version=hr.appVersion,t.imei=hr.IMEI,t.ip="",t.os="",pt.onAndroid?t.os="andriod":pt.onIOS?t.os="ios":pt.onPC&&(t.os="window"),Jl.httpGet(hr.importServerUrl,t,e,e.onImportServer,e.onImportError),G.timer.once(6e3,e,e.checkImportTimeOut)}},t.checkImportTimeOut=function(){this.requestSuccse||(0<this.maxRequestTime?this.showServerList():HP.checkBasicLoaded()?this.showAlertOutServer(99):HP.loadBasicUI(ql.create(this,this.showAlertOutServer,[99])))},t.onImportServer=function(e){if(G.timer.clear(this,this.checkImportTimeOut),"string"==typeof e)e=JSON.parse(e);else{var t="";for(var i in e)t+=""==t?i+"="+e[i]:"&"+i+"="+e[i]}e&&(e.hasOwnProperty("uid")&&e.uid&&0<e.uid.length&&(hr.uid=e.uid),e.hasOwnProperty("name")&&(hr.serverName=e.name),e.hasOwnProperty("server")&&(hr.serverID=e.server),e.hasOwnProperty("state")&&(hr.serverState=parseInt(e.state+"")),e.hasOwnProperty("domain")&&(hr.socket_host=e.domain),e.hasOwnProperty("port")&&(hr.socket_port=e.port),e.hasOwnProperty("time")&&(hr.serverTime=e.time),e.hasOwnProperty("sign")&&(hr.sign=e.sign),e.hasOwnProperty("autoOpenTime")&&(hr.openSerTime=e.autoOpenTime),this.m_firstLoading&&this.m_firstLoading.destroy(),this.requestSuccse=!0),this.loadStarLogin()},t.reqEnterVerify=function(){var e=null;dr.isConchApp?((e=new Object).sid=hr.serverID,e.uid=hr.uid,e.pid=hr.pid,e.gid=hr.gid,e.imei=hr.IMEI,e.sign=hr.sign,e.time=hr.serverTime,e.version="",this.verifyUrl=hr.mobileVerifyUrl):((e=hr.webGetParams)||(e={}),e.sid=hr.serverID,this.verifyUrl=hr.verifyUrl),console.log("request versify:"+JSON.stringify(e)),Jl.httpGet(this.verifyUrl,e,this,this.onVerfyBack,this.onVerifyError),G.timer.once(6e3,this,this.checkVerifyTimeOut),this.maxVerifyTime--},t.onVerifyError=function(e){G.timer.clear(this,this.checkVerifyTimeOut),this.requestEnter()},t.checkVerifyTimeOut=function(){G.timer.clear(this,this.checkVerifyTimeOut),this.reqVerifySuccess||(0<this.maxVerifyTime?this.reqEnterVerify():HP.checkBasicLoaded()?this.showAlertOutServer(99):HP.loadBasicUI(ql.create(this,this.showAlertOutServer,[99])))},t.onVerfyBack=function(e){if(G.timer.clear(this,this.checkVerifyTimeOut),"string"==typeof e)e=JSON.parse(e);else{var t="";for(var i in e)t+=""==t?i+"="+e[i]:"&"+i+"="+e[i]}e&&(e.hasOwnProperty("time")&&(hr.serverTime=e.time),e.hasOwnProperty("sign")&&(hr.sign=e.sign),this.reqVerifySuccess=!0),this.requestEnter()},t.requestEnter=function(){var e=new lL;e.arthor=hr.uid,e.serverId=hr.serverID,e.platform=hr.platform,e.token=hr.token,e.gid=hr.gid,e.pid=hr.pid,e.sign=hr.sign,e.param=hr.param,e.time=hr.serverTime,e.guid=hr.guid,e.appid=hr.appid,e.ptime=hr.platformTime,e.psign=hr.platformSign,e.adult=hr.platformAdult,jP.deviceInfo&&(jP.deviceInfo.DEVICE_TOKEN&&(e.device_token=jP.deviceInfo.DEVICE_TOKEN),jP.deviceInfo.PACKAGE_NAME&&(e.package_name=jP.deviceInfo.PACKAGE_NAME)),console.log("main 10101:="+JSON.stringify(e)),Tu.sendToService(e),xs.mirClick(32,hr.pid,hr.uid)},t.pushguiClientid=function(){if(""!=hr.guiclientid){var e=new pL;e.cid=hr.guiclientid,Tu.sendToService(e)}},t.onImportError=function(e){G.timer.clear(this,this.checkImportTimeOut),this.isConchApp?this.checkImportTimeOut():this.loadStarLogin()},t.doShowLoginSatrView=function(){i.urls&&0<i.urls.length&&(null==this.serverList&&(this.serverList=new FW),this.serverList.show())},t.closeServerList=function(){this.serverList&&(this.serverList.destroy(),this.serverList=null)},t.onResize=function(){var e=this;e.serviceLineUI&&e.serviceLineUI.parent&&e.serviceLineUI.resize(),e.roleCreate&&e.roleCreate.parent&&e.roleCreate.resize(),e.loginUI&&e.loginUI.parent&&e.loginUI.resize(),e.serverList&&e.serverList.parent&&e.serverList.resize(),e.m_firstLoading&&e.m_firstLoading.parent&&e.m_firstLoading.resize()},t.clearUI=function(){var e=this;e.serviceLineUI&&(e.serviceLineUI.destroyed||e.serviceLineUI.destroy(),e.serviceLineUI.visible=!1,e.serviceLineUI=null),e.roleCreate&&(e.roleCreate.destroyed||e.roleCreate.destroy(),e.roleCreate.visible=!1,e.roleCreate=null),e.loginUI&&(e.loginUI.destroyed||e.loginUI.destroy(),e.loginUI.visible=!1,e.loginUI=null),e.serverList&&(e.serverList.destroyed||e.serverList.destroy(),e.serverList.visible=!1,e.serverList=null),e.m_firstLoading&&(e.m_firstLoading.destroyed||e.m_firstLoading.destroy(),e.m_firstLoading.visible=!1,e.m_firstLoading=null),e.m_LoadingUI&&(e.m_LoadingUI.destroyed||e.m_LoadingUI.destroy(),e.m_LoadingUI.visible=!1,e.m_LoadingUI=null);var t=hr.loginResList;for(i.urls=i.urls.concat(t);0<i.urls.length;)G.loader.clearRes(i.urls.shift());i.urls=[]},t.sendInvInfo=function(){var e=hr.webGetParams.cp_fuid,t=hr.webGetParams.cp_sid;if(e&&t){var i=new OP;i.inviterUid=e,i.inviterSid=t;var n=hr.webGetParams.cp_share_type;n||(n="WX_SHARE"),i.type=n,Tu.sendToService(i)}},i.urls=[],i}(),NU=function(e){function t(){this._mv=null,t.__super.call(this)}return b(t,"modules.loginnotice.proxys.LoginNoticeProxy",bp),t.prototype.subHandler=function(e){switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":var t=pt.document.getElementById("loginNotice");if(t){var i=t.getAttribute("content");Sj.ins.showNotice(i)}}},t}(),BU=function(e){function i(){var e=this;e._magicMV=null,e._helpFriendView=null,e._magicAttentionView=null,e._mTowerRankV=null,e._mTowerSceneV=null,e._mTowerSettleV=null,e._mTowerUnlockV=null,i.__super.call(e);var t=[];t=[_r.getLayoutsPath("magic")],hN.ins.registPanel("MAGIC_VIEW",ZQ,"_magicMV",e,{wait:hN.wait(hN.waitRes(t)),layer:"layout",clearAll:!0}),hN.ins.registPanel("MAGIC_TOWER_RANK",q0,"_mTowerRankV",e,{mask:!0}),hN.ins.registPanel("MAGIC_TOWER_SCENE",nZ,"_mTowerSceneV",e,{wait:hN.wait(hN.waitRes(t)),clearAll:!1,mask:!1,layer:"nav"}),t=[_r.getLayoutsPath("magic"),_r.getLayoutsPath("fightresult")],hN.ins.registPanel("MAGIC_TOWER_SETTLE",Y0,"_mTowerSettleV",e,{wait:hN.wait(hN.waitRes(t)),mask:!0,clickClose:!1}),hN.ins.registPanel("HELPFRIEND_VIEW",j0,"_helpFriendView",e,{wait:hN.wait(hN.waitConfig(["CrossBossMissionResource"],["CrossBossMissionResource"])),mask:!1,layer:"nav"}),hN.ins.registPanel("MAGICATTENTION_VIEW",Z0,"_magicAttentionView",e,{mask:!0}),hN.ins.registPanel("MAGIC_TOWER_UNLOCK",X0,"_mTowerUnlockV",e,{mask:!0})}b(i,"modules.magic.proxys.MagicProxy",bp);var t=i.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"30601":IN.mTowerData=e.proto,t._magicMV&&t._magicMV.vsc.selectedView instanceof modules.magic.views.MagicTowerView&&t._magicMV.updateView();break;case"30602":var i=e.proto;if(null!=IN.mTowerData&&(IN.mTowerData.pTime=i.pTime,IN.mTowerData.pLevel=i.pLevel,IN.mTowerData.pId=i.pid,t._magicMV&&t._magicMV.vsc.selectedView instanceof modules.magic.views.MagicTowerView&&t._magicMV.updateView()),!hN.ins.isOpen("MAGIC_TOWER_SETTLE")){var n=e.proto;hN.ins.open("MAGIC_TOWER_SETTLE",n)}break;case"10702":var s=e.proto;o_.ins.setRank(s.type,s),16==s.type&&(t._magicMV&&t._magicMV.vsc.selectedView instanceof modules.magic.views.MagicTowerView&&t._magicMV.vsc.selectedView.setMagicTowerRank(),t.showPanel("MAGIC_TOWER_RANK"));break;case"__SCENE_CHANGED__":9701==e.proto&&(hN.ins.isOpen("MAGIC_TOWER_SCENE")||hN.ins.open("MAGIC_TOWER_SCENE"));break;case ou.OPEN_MTOWER_SETTLE:break;case"21241":var o=e.proto;BR.ins.jindiBossObj=o.bossInfo,t._magicMV&&t._magicMV.vsc.updateSelectedView(e.proto);break;case"21245":var a=e.proto;BR.ins.mijingBossObj=a.bossInfo,BR.ins.score=a.socre,t._magicMV&&t._magicMV.vsc.updateSelectedView(e.proto);break;case"21243":if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);var r=e.proto;0==BR.ins.noShow&&hN.ins.open("HELPFRIEND_VIEW",r);break;case"21246":var l=e.proto;n1.ins.changeText(!0,l.name,3);break;case"21247":var c=e.proto;BR.ins.data_21247=c,t._magicMV&&t._magicMV.updateView(e.proto)}},t.showPanel=function(e,t){var i=this;switch(e){case"MAGIC_TOWER_RANK":i._mTowerRankV&&i._mTowerRankV.parent&&i._mTowerRankV.updateRank();break;case"MAGIC_TOWER_SETTLE":i._mTowerSettleV&&i._mTowerSettleV.parent&&i._mTowerSettleV.updateView(t);break;case"MAGICATTENTION_VIEW":i._magicAttentionView&&i._magicAttentionView.parent&&i._magicAttentionView.updatePanel(t.type);break;case"HELPFRIEND_VIEW":i._helpFriendView.updateLabel(t);break;case"MAGIC_VIEW":t&&t.hasOwnProperty("isUnLock")&&1==t.isUnLock&&_R.mTowerExtra&&1==_R.mTowerExtra.isUnlock&&hN.ins.open("MAGIC_TOWER_UNLOCK")}},t.closePanel=function(e,t){},i}(),HU=function(e){function t(){this._mailV=null,this._cWG=null,this._cNG=null,t.__super.call(this),hN.ins.registPanel("MAIL",e1,"_mailV",this,{wait:hN.waitRes(_r.getLayoutsPath("mail")),mask:!0}),hN.ins.registPanel("MAIL_CONTENT_NOGIFT",K0,"_cNG",this,{wait:hN.waitRes(_r.getLayoutsPath("mail")),mask:!0}),hN.ins.registPanel("MAIL_CONTENT_WITHGIFT",$0,"_cWG",this,{wait:hN.waitRes(_r.getLayoutsPath("mail")),mask:!0})}b(t,"modules.mail.proxys.MailProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__ENGIN_READY__":console.log("mail---\x3e",t.name);break;case"OPEN":Tu.sendToService(new jL);break;case"CLOSE":hN.ins.close("MAIL");break;case"11201":t._mailV&&t._mailV.parent&&t._mailV.refreshList();break;case"11203":hN.ins.isOpen("MAIL")?t._mailV&&t._mailV.parent&&t._mailV.refreshList():hN.ins.open("MAIL");break;case"11205":lu.ins.curShowVo.attrList||lu.ins.curShowVo.propList?hN.ins.open("MAIL_CONTENT_WITHGIFT"):hN.ins.open("MAIL_CONTENT_NOGIFT"),t._mailV&&t._mailV.parent&&t._mailV.refreshList();break;case"11207":t._cWG&&t._cWG.notice(e);break;case"11212":t._cNG&&t._cNG.notice(e),t._cWG&&t._cWG.notice(e)}},i.showPanel=function(e,t){switch(e){case"MAIL":this._mailV.refreshList()}},i.closePanel=function(e,t){},t}(),VU=function(e){function t(){this._mallMainView=null,this._selectPage=-1,this.SOUNDS=["vo_4","vo_5","vo_6"],t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("mall")),hN.ins.registPanel("MALL_PANEL",t1,"_mallMainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigShop","ConfigMSRefresh"],["CShopModel","ConfigMSRefresh"])),mask:!1,layer:"layout"})}b(t,"modules.mall.proxys.MallMainProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__ENGIN_READY__":console.log(t.name);break;case"__LOGIN_ENTERSCENE__":wN.reqMallList(4);break;case"OPEN_MAIN_VIEW":t.openOrClose();break;case"10902":var i=e.proto;tH.instance.setTabGoods(i.tab,i.list),t._mallMainView&&t._mallMainView.parent&&t._mallMainView.vsc.updateSelectedView(),null!=wN.callBackFunc&&(wN.callBackFunc.call(null,wN.callBackparam),wN.callBackFunc=null);break;case"10909":var n=e.proto;tH.instance.changeMallVo(n),t._mallMainView&&t._mallMainView.parent&&t._mallMainView.vsc.updateSelectedView();break;case"10905":var s=e.proto;tH.instance.mysterystore_data=s,t._mallMainView&&t._mallMainView.parent&&(t._mallMainView.update(e),t._mallMainView.updateMyStery());break;case"10907":var o=e.proto;if(0==o.result)for(var a,r=tH.instance.mysterystore_data,l=0;l<r.list.length;l++)if((a=r.list[l]).shopIndex==o.shopIndex){a.hasBuy=1,r.list[l]=a;break}t._mallMainView&&t._mallMainView.parent&&t._mallMainView.updateMyStery();break;case"10205":t._mallMainView&&t._mallMainView.parent&&t._mallMainView.updateMilitaryMoney();break;case"OPEN_MALL_PAGE":t._selectPage=e.proto,t.openOrClose();break;case"BP_UPDATE":t._mallMainView&&t._mallMainView.parent&&t._mallMainView.vsc.selectedView instanceof modules.mall.views.MallMysteryView&&t._mallMainView.vsc.selectedView.updateBagItem()}},i.openOrClose=function(){hN.ins.open("MALL_PANEL",this._selectPage)},i.closePanel=function(e,t){},i.showPanel=function(e,t){if("MALL_PANEL"==e){-1!=this._selectPage&&(this._mallMainView.selectPage(this._selectPage),this._selectPage=-1);var i=Math.random()*this.SOUNDS.length>>0;UB.ins.playSound(this.SOUNDS[i])}},t}(),GU=function(e){function t(){this._mallQuickBuyView=null,this._simpleGetMaterialView=null,t.__super.call(this),hN.ins.registPanel("MALL_QBPanel",ZW,"_mallQuickBuyView",this,{wait:hN.waitConfig(["ConfigShop"],["CShopModel"]),mask:!0}),hN.ins.registPanel("MALL_NORMALBUYPANEL",JW,"_simpleGetMaterialView",this,{mask:!0})}b(t,"modules.mall.proxys.QuickBuyProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_MALL_QUICKBUY":var t=e.proto;this.showQuickBuy(t);break;case"OPEN_ZHANJI_QUICKBUY":break;case"OPEN_NORMAL_QUICKBUY":t=e.proto;var i=Math.floor(t.key);hN.ins.open("MALL_NORMALBUYPANEL",i)}},i.showQuickBuy=function(e){var t=tH.instance.getTabByIndex(e.key);wN.reqMallList(t,this.callBackFunc,e)},i.callBackFunc=function(e){hN.ins.open("MALL_QBPanel",e)},i.closePanel=function(e,t){},i.showPanel=function(e,t){"MALL_QBPanel"==e?this._mallQuickBuyView.bindData(t):"MALL_NORMALBUYPANEL"==e&&(this._simpleGetMaterialView.bindData(t),UB.ins.playSound("14",3,!0))},t}(),UU=function(t){function i(){this._mapPanel=null,i.__super.call(this);var e=[];e.push(_r.getLayoutsPath("mainframe")),hN.ins.registPanel("MapPanel",i1,"_mapPanel",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["MissionTransfers"],["MissionTransfers"])),mask:!0})}b(i,"modules.map.proxys.MapProxy",t);var e=i.prototype;return G.imps(e,{"ui.IPanelProxy":!0}),e.subHandler=function(e){switch(t.prototype.subHandler.call(this,e),e.actionOrder){case"25018":xN.Ins().update25018(e.proto),this._mapPanel&&this._mapPanel.parent}},e.showPanel=function(e,t){},e.closePanel=function(e,t){},i}(bp),FU=function(n){function e(){this._moLimitMissionMainPanel=null,this._needToShow=!1,e.__super.call(this),hN.ins.registPanel("MoLimitMissionMainView",nJ,"_moLimitMissionMainPanel",this,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("molimit")]),hN.waitConfig(["MagicLimitTaskResource","MoSubLMResource"],["MagicLimitTaskResource","MoSubLMResource"])),mask:!0,layer:"layout"})}b(e,"modules.moLimitMission.proxys.MoLimitMissionProxy",n);var t=e.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){switch(n.prototype.subHandler.call(this,e),e.actionOrder){case"SHOW_MO_LIMIT_MISSION_MAIN_VIEW":this._needToShow=!0,hN.ins.isOpen("MoLimitMissionMainView")||hN.ins.open("MoLimitMissionMainView",e.proto);break;case"23727":for(var t=0,i=0;i<kN.getInstance().moLevelArr.length;i++)1==kN.getInstance().moLevelArr[i].statue&&(t=i+1);t+1>=kN.getInstance().moLevelArr.length&&(t=kN.getInstance().moLevelArr.length-1),this._moLimitMissionMainPanel&&this._moLimitMissionMainPanel.parent&&this._moLimitMissionMainPanel.viewRefresh(t);break;case"23730":uZ.ins.show()}},t.closePanel=function(e,t){},t.showPanel=function(e,t){if("MoLimitMissionMainView"==e){var i=new ed;Tu.sendToService(i)}},e}(bp),qU=function(e){function t(){var e=this;e._bossHead=null,e._bossHeatTower=null,e._currentBossView=null,e.lockBossId=0,e._bossId=0,e._currHp=NaN,e._lastHP=NaN,e._maxHp=NaN,e._dropBtnBossId=0,e._dropBtnVisible=!0,e._dropBtnHandler=null,e._ownerId=NaN,e._ownerName=null,e._bossHeadVisible=!0,e.currentType=1,t.__super.call(e),t.ins=e}b(t,"modules.nav.proxys.NavBossProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.getBossView=function(){return null==this._bossHead&&(this._bossHead=new kZ),this._bossHead},i.getBossTowerView=function(){return null==this._bossHeatTower&&(this._bossHeatTower=new SZ),this._bossHeatTower},i.subHandler=function(e){var t=this;switch(e.actionOrder){case"BOSS_BLOOD_UP":t.doUpdateBossBlood();break;case"BOSS_BLOOD_CLOSE":t.closeBossBlood();break;case"BOSS_DROP":break;case"NAV_UPDATE_BOSS_BUFF_START":case"NAV_UPDATE_BOSS_BUFF_END":if(null==t._bossHead){var i=e.proto.proto;t.showHuDun(i)}else t._bossHead&&t._bossHead.showHunDunInfo(e);break;case"NAV_UPDATE_BOSS_BUFF_START_1":null==t._bossHead?t.showHuDun(BR.ins.bossHuDunData):t._bossHead&&t._bossHead.showHunDunInfoEx(BR.ins.bossHuDunData);break;case"UPDATE_NAV_ALL":t._bossHead&&t._bossHead.reSetName()}},i.showBossBlood=function(e){var t=kH.takeMonsterModelProtoData(e);t&&this.updateBossBlood(e,t.hp,t.hp)},i.updateBossBlood=function(e,t,i){var n=this;void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0);var s=dr.dtoEnterScene;s&&40==s.type?n.currentType=2:n.currentType=1,0<n.lockBossId&&n.lockBossId!=e||(e<=0?n.closeBossBlood():(G.__typeof(n._currHp,NaN),!G.__typeof(n._currHp,NaN)||n._currHp==t!=0||n._currentBossView&&n._currentBossView.parent?(n._bossId=e,n._bossHeadVisible=!0,n._currHp=Math.max(t,0),n._maxHp=i,n.doUpdateBossBlood()):n.closeBossBlood()))},i.doUpdateBossBlood=function(){this.onLoad()},i.onLoad=function(){var e=this;switch(e.currentType){case 1:null==e._bossHead&&(e._bossHead=e.getBossView()),e._currentBossView=e._bossHead;break;case 2:null==e._bossHeatTower&&(e._bossHeatTower=e.getBossTowerView()),e._currentBossView=e._bossHeatTower}e._currentBossView.on("removed",e,e.closeBossBlood),e._currentBossView.visible=e._bossHeadVisible,0<e._bossId?(e._currentBossView.parent||(eq.navLayer.addChild(e._currentBossView),sJ.ins.isOpen("CROSSBOSSTITLE")&&eq.navLayer.addChild(sJ.ins.getCompomentsByName("CROSSBOSSTITLE")),e._updateDropBtnStatus()),e._currentBossView.isShow||e._currentBossView.readyShow(),e._currentBossView.update(e._bossId,e._currHp,e._maxHp),e._lastHP=e._currHp):e.closeBossBlood()},i.closeBossBlood=function(){var e=this;e._bossId=0,e._bossHeadVisible=!1,e.currentType=1,e._bossHead&&e._bossHead.hideHD(),e._bossHead&&e._bossHead.removeSelf(),e._bossHead&&e._bossHead.destroy(),e._bossHead=null,e._bossHeatTower&&e._bossHeatTower.removeSelf(),e._bossHeatTower&&e._bossHeatTower.destroy(),e._bossHeatTower=null,e._currentBossView&&e._currentBossView.off("removed",e,e.closeBossBlood),e._currentBossView=null,e._updateDropBtnStatus(!0),G.loader.clearRes(_r.getLayoutsPath("bosshead"))},i.closePanel=function(e,t){},i.showPanel=function(e,t){},i.setBossHeadVisible=function(e){this._bossHeadVisible=e,this._currentBossView&&(this._currentBossView.visible=this._bossHeadVisible)},i.setDropBtnStatus=function(e,t,i){void 0===t&&(t=!0),this._dropBtnBossId=e,this._dropBtnVisible=t,this._dropBtnHandler=0<e?i:null,this._dropBtnHandler&&G.timer.once(6e4,this,this._updateDropBtnStatus,[!0]),this._updateDropBtnStatus()},i._updateDropBtnStatus=function(e){var t=this;void 0===e&&(e=!1);var i=e;t._currentBossView&&t._currentBossView.parent&&(t._currentBossView.btn_award.visible=0<t._dropBtnBossId&&t._dropBtnVisible,t._dropBtnBossId==t._bossId&&(i=!1),G.timer.clear(t,t._updateDropBtnStatus)),0<BR.ins.curCopyId&&(i=!1,G.timer.clear(t,t._updateDropBtnStatus)),i&&0<t._dropBtnBossId&&(t._dropBtnBossId=0,t._dropBtnVisible=!1,t._dropBtnHandler=null,G.timer.clear(t,t._updateDropBtnStatus))},i._onDropBtnClick=function(e){return!!this._dropBtnHandler&&(this._dropBtnHandler.run(),!0)},i.showHuDun=function(e){var t=e;kZ.toc24103=t,kZ._leftTime=t.buffVO.leftTime,kZ.HuDunEndTime=dr.curServerTime+t.buffVO.leftTime;var i=uF.charQueue.take(t.objectid);if(null!=i&&i.data instanceof protos.scene.DtoCharData){var n=i.data;3==n.charType&&i.isBoss&&this.updateBossBlood(n.modelId,n.currHP)}},t.ins=null,t}(),jU=function(e){function t(){this._init=!1,this._isFirst=!0,this._showSet=null,this._isLoading=!1,this.nextdisposeTime=0,t.__super.call(this),sJ.ins.regCompoment("NavBottom",xZ),sJ.ins.regCompoment("NavTopBar",uY),sJ.ins.regCompoment("NavMap",oY),sJ.ins.regCompoment("NavActLView",KW),sJ.ins.regCompoment("NavActRView",$W),sJ.ins.regCompoment("ChatSimpleUI",iW),sJ.ins.regCompoment("NavOtherBar",rY),sJ.ins.regCompoment("NavBoss",tY),sJ.ins.regCompoment("NavExit",EZ),sJ.ins.regCompoment("NavBlock",mZ),sJ.ins.regCompoment("NavPreviewAwardView",lY),sJ.ins.regCompoment("NavCheckPoint",iY),sJ.ins.regCompoment("Navheji",nY),sJ.ins.regCompoment("NavHejiMission",AZ),sJ.ins.regCompoment("NavMission",aY),sJ.ins.regCompoment("NavMineView",NZ),sJ.ins.regCompoment("NavTargetHead",YJ),sJ.ins.regCompoment("NavFairylandView",TZ),sJ.ins.regCompoment("NavAttackList",_Z),sJ.ins.regCompoment("NavCounterList",wZ),sJ.ins.regCompoment("NavAttackTarget",bZ),sJ.ins.regCompoment("NavAttackOther",pZ),sJ.ins.regCompoment("NavSceneFocusView",cY),sJ.ins.regCompoment("NavMonsterAttackList",CZ),sJ.ins.regCompoment("NavATKTargetHead",qJ),sJ.ins.regCompoment("NavBossAncient",eY),sJ.ins.regCompoment("NavAttRemind",n1),sJ.ins.regCompoment("NavCallFriend",s1),sJ.ins.regCompoment("NavFirstPayTime",MZ),sJ.ins.regCompoment("NavNewDailyEnter",sY),sJ.ins.regCompoment("NavMaterialView",gZ),sJ.ins.regCompoment("NavZhuiJi",HZ),sJ.ins.regCompoment("NavInCallBoss",OZ),sJ.ins.regCompoment("NavLimitZhuiJi",PZ),sJ.ins.regCompoment("NavLuckDrop",RZ),sJ.ins.regCompoment("NavHotupdate",DZ),sJ.ins.regCompoment("CROSSBOSSCAIJIBAR",rJ),sJ.ins.regCompoment("CROSSBOSSTITLE",cJ),sJ.ins.regCompoment("CROSSBOSSRESULTVIEW",lJ),sJ.ins.regCompoment("NavCollectionList",IZ),sJ.ins.regCompoment("NavAutoWay",vZ),sJ.ins.regCompoment("NavMiniMap",BZ),sJ.ins.regCompoment("NiepanEffect",WZ),sJ.ins.regCompoment("NavPetBirth",vY),this._showSet=MN.NORMAL}b(t,"modules.nav.proxys.NavProxy",bp);var i=t.prototype;return i.subHandler=function(e){var t=this;switch(e.actionOrder){case"Layer_Init":t.showNav(),t._init=!0;break;case"resize":break;case"10119":modules.copy.others.NewPigData.ins.isShowRedPoint=!0,modules.copy.others.HundunData.ins.isFirstRed=!0,sJ.ins.notice(["NavActRView","NavActLView"],e);break;case"14001":sJ.ins.notice(["NavTopBar"],e);break;case"11211":sJ.ins.notice(["NavOtherBar"],e);break;case"NAV_ATTACK_LIST_SELECT":sJ.ins.notice(["NavAttackList"],e),sJ.ins.notice(["NavCounterList"],e);break;case"NAV_ATTACK_MONSTER_LIST_SELECT":sJ.ins.notice(["NavMonsterAttackList"],e);break;case"24004":BR.ins.toc24004=e.proto;var i=e.proto;tr.push(RP.n[211]+i.playerId+RP.n[212]+i.objectId),sJ.ins.notice(["NavTargetHead"],e),sJ.ins.notice(["NavAttackOther"],e);break;case"24026":BR.ins.toc24026=e.proto,sJ.ins.notice(["NavTargetHead"],e);break;case"24027":BR.ins.toc24027=e.proto,sJ.ins.notice(["NavAttackList"],e);break;case"24033":BR.ins.toc24033=e.proto,sJ.ins.notice(["NavMonsterAttackList"],e),t.sendToModule("MOSNTER_LIST_UPDATE",["modules.newsiege.NewSiegeModule"]);break;case"25012":BR.ins.toc25012=e.proto,sJ.ins.notice(["NavCollectionList"],e);break;case"24028":BR.ins.toc24028=e.proto,sJ.ins.notice(["NavCounterList"],e);break;case"HURT_MESSAGE_UPDATE":sJ.ins.notice(["NavATKTargetHead"],e);break;case"CHANGE_UI_SET":var n=[];if(n=2==e.proto.length?e.proto[0]:e.proto,MN.isNormalShow=n==MN.NORMAL,!t._init)return void(t._showSet=e.proto);sJ.ins.showCompoments(e.proto),t.sendToModule("_UI_SET_CHANGED",["modules.boss.BossModule","modules.recharge.RechargeModule","modules.yzbqc.YzbqcModule"],MN.isNormalShow),t.sendToModule("CHECKTASKTRACK",["modules.task.TaskModule"],MN.isNormalShow);break;case"12001":CN.iconData=e.proto,LN.toc_12001=e;var s=CN.iconData.icons2;for(var o in s)107==s[o].iconId&&(-(modules.pet.others.PetDataModel.ins().btnPetShow=1)==MN.COPY_1.indexOf("NavActRView")&&MN.COPY_1.push("NavActRView"),-1==MN.COPY_2.indexOf("NavActRView")&&MN.COPY_2.push("NavActRView"),-1==MN.COPY_CP.indexOf("NavActRView")&&MN.COPY_CP.push("NavActRView"),-1==MN.COPY_32.indexOf("NavActRView")&&MN.COPY_32.push("NavActRView"),-1==MN.COPY_51.indexOf("NavActRView")&&MN.COPY_51.push("NavActRView"),-1==MN.COPY_58.indexOf("NavActRView")&&MN.COPY_58.push("NavActRView"));t.sendFinally(e);break;case"UPDATE_ACTLEFT_ICON":sJ.ins.notice(["NavActLView"],e);break;case"21109":case"10602":case"UPDATE_FORCE":case"10204":sJ.ins.notice(["NavTopBar","NavOtherBar"],e);break;case"10206":sJ.ins.notice(["NavBottom","NavTopBar","NavBoss","NavMission","NavCheckPoint","NavMap","NavBossAncient","NavOtherBar","NavActRView","NavActLView"],e);break;case"10205":sJ.ins.notice(["NavTopBar","NavBottom"],e);break;case"_Change_Batch_":sJ.ins.notice(["NavCheckPoint"],e),sJ.ins.notice(["NavMap"],e);break;case"CHANGE_MAP":sJ.ins.notice(["NavMap"],e),sJ.ins.notice(["NavTopBar"],e),sJ.ins.notice(["NavCheckPoint"],e),null==sJ.ins.getCompomentsByName("Navheji")&&sJ.ins.showCompoment("Navheji"),sJ.ins.notice(["Navheji"],e);break;case"13002":var a=e.proto;PN.ins.setCurRatio(a.exp,a.copper),sJ.ins.notice(["NavMap"],e),sJ.ins.notice(["NavCheckPoint"],e);break;case"10210":sJ.ins.notice(["NavTopBar"],e);break;case"22802":AN.ins.isInit=!0;break;case"14001":case"14010":case"NAV_BUFF_UPDATE":sJ.ins.notice(["NavTopBar"],e);break;case"HIDE_ACT_ICON":sJ.ins.notice(["NavActLView"],e),sJ.ins.notice(["NavActRView"],e);break;case"SHOW_ACT_ICON":sJ.ins.setTop("NavActRView");break;case"__SCENE_CHANGED__":var r=e.proto;1!=parseInt(r)||t._isFirst||G.timer.once(1e3,t,t.doHideIcon),t._isFirst=!1,sJ.ins.notice(["NavBottom"],e);break;case"SHOWDAILYICONEFFECT":break;case"UPDATE_TUJIAN_REDPOINT":case"UPDATE_GOV_REDPOINT":case"UPDATE_HEJI_RED_POINT":case"RESFRESH_BACKPACK_INFO":case"25000":case"UpdateCurrHP":case"UpdateCurrMP":case"HP_CHANGE":case"MP_CHANGE":case"10207":sJ.ins.notice(["NavBottom"],e);break;case"CHALLENGE_FINISH":sJ.ins.notice(["NavFairylandView"],e);break;case"CHANGE_GUAN_QIA_LEVEL":sJ.ins.notice(["NavPreviewAwardView"],e),dY.instance.update();break;case"SHOW_HEJI_FLY":sJ.ins.notice(["Navheji"],e);break;case"UPDATE_GUANQIA_GUIDE":sJ.ins.notice(["NavCheckPoint"],e);break;case"CLEAR_LIST_INFO":sJ.ins.clearList(["NavAttackList","NavMonsterAttackList","NavCounterList"]),hN.ins.close("BOSS_ANCIENT_RANKSCENE");break;case"UPDATE_FRIEND_RED_POINT":sJ.ins.notice(["NavOtherBar"],e);break;case"31011":HN.ins.to_31011=e.proto,sJ.ins.getCompomentsByName("NavActLView")?t.sendToModule("CHANGE_FIRSTPAY_TIME",["modules.nav.NavModule"]):G.timer.once(500,t,t.executeAgain);break;case"CHANGE_FIRSTPAY_TIME":var l=sJ.ins.getCompomentsByName("NavActLView"),c=HN.ins.to_31011.times;if(0<dr.iosCheck&&(c=0),0<c){var u=MN.NORMAL.indexOf("NavFirstPayTime");-1==u&&(MN.NORMAL.push("NavFirstPayTime"),l&&sJ.ins.showCompoment("NavFirstPayTime")),-1==(u=MN.COPY_1.indexOf("NavFirstPayTime"))&&MN.COPY_1.push("NavFirstPayTime"),-1==(u=MN.COPY_2.indexOf("NavFirstPayTime"))&&MN.COPY_2.push("NavFirstPayTime"),-1==(u=MN.COPY_8.indexOf("NavFirstPayTime"))&&MN.COPY_8.push("NavFirstPayTime"),-1==(u=MN.COPY_58.indexOf("NavFirstPayTime"))&&MN.COPY_58.push("NavFirstPayTime"),dr.dtoEnterScene&&l&&sJ.ins.showCompoment("NavFirstPayTime"),G.timer.clear(t,t.executeAgain)}else{var d=MN.NORMAL.indexOf("NavFirstPayTime");-1<d&&(MN.NORMAL.splice(d,1),d=MN.COPY_1.indexOf("NavFirstPayTime"),MN.COPY_1.splice(d,1),d=MN.COPY_2.indexOf("NavFirstPayTime"),MN.COPY_2.splice(d,1),d=MN.COPY_8.indexOf("NavFirstPayTime"),MN.COPY_8.splice(d,1),d=MN.COPY_58.indexOf("NavFirstPayTime"),MN.COPY_58.splice(d,1),l&&sJ.ins.hideCompoment("NavFirstPayTime"))}break;case"HIDE_OTHER_PLAYERS":sJ.ins.notice(["NavBlock"],e);break;case"UPDATE_RED_POINT":sJ.ins.notice(["NavMission","NavBottom","NavActRView",,"NavActLView"],e);break;case"UPDATE_NAV_ALL":sJ.ins.notice(["NavTopBar"],e),sJ.ins.notice(["NavPreviewAwardView"],e),sJ.ins.notice(["NavTargetHead"],e),eJ.reSetContents();break;case"USE_HEJI_BACK":sJ.ins.showCompoment("NavZhuiJi"),sJ.ins.notice(["NavZhuiJi"],e);break;case"CHAR_DEAD":sJ.ins.notice(["NavZhuiJi"],e);break;case"OPEN_LIMIT_ZHUIJI":sJ.ins.hideCompoment("NavZhuiJi"),sJ.ins.notice(["NavLimitZhuiJi"],e);break;case"CLOSE_LIMIT_ZHUIJI":sJ.ins.notice(["NavLimitZhuiJi","Navheji"],e),sJ.ins.hideCompoment("NavZhuiJi"),sJ.ins.hideCompoment("NavLimitZhuiJi");break;case"UPDATE_ZHUIJI":break;case"31023":sJ.ins.notice(["Navheji","NavTopBar"],e);break;case"NOTICE_REMOVE_FOCUS":sJ.ins.notice(["NavSceneFocusView"],e);break;case"10121":sJ.ins.notice(["NavTopBar"],e);break;case"25018":sJ.ins.notice(["NavMiniMap"],e)}},i.sendIconInfos=function(){this.sendFinally(LN.toc_12001)},i.sendFinally=function(e){sJ.ins.notice(["NavActLView"],e),sJ.ins.notice(["NavActRView"],e)},i.doHideIcon=function(){Tu.sendToModule("HIDE_ACT_ICON",["modules.nav.NavModule"])},i.showNav=function(){eq.navLayer.addChild(sJ.ins),sJ.ins.showCompoments(this._showSet),JP.ins.setBargainIds();var e=new iM;e.type=1,Tu.sendToService(e),(e=new iM).type=2,Tu.sendToService(e),Tu.sendToService(new nM),AN.ins.isInit||G.timer.once(3e3,this,AN.reqNav),G.timer.frameLoop(100,this,this.checkAtlasDispose),"awy"!=hr.appid||eq.navLayer.contains(aq.ins)||eq.navLayer.addChild(aq.ins)},i.checkAtlasDispose=function(){var e=Te.instance.disposeTime;e!=this.nextdisposeTime&&(this.nextdisposeTime=e,Tu.sendToModule("UPDATE_NAV_ALL",["modules.nav.NavModule"]))},i.executeAgain=function(){this.sendToModule("CHANGE_FIRSTPAY_TIME",["modules.nav.NavModule"])},t}(),WU=function(e){function t(){this._mainView=null,t.__super.call(this);var e=[_r.getLayoutsPath("digger"),_r.getLayoutsPath("achievenew")];hN.ins.registPanel("NewDailyActMainView",oJ,"_mainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(rc.digger_A.concat(["RingResource","ModuleOpenResource"]),rc.digger_C.concat(["CConfigGodRingModel","CModuleOpenResource"]))),mask:!1,layer:"layout"})}b(t,"modules.newDailyAct.proxy.NewDailyActProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_DAILY_VIEW":var i=0;i=e.proto?e.proto._subIndex_:t.checkOpenGov()?0:1,sJ.ins.notice(["NavNewDailyEnter"],null),null==t._mainView?hN.ins.toggle("NewDailyActMainView",{_subIndex_:i}):t._mainView.parent&&e.proto&&(t._mainView.vsc.selectedIndex=e.proto._subIndex_);break;case"21006":var n=e.proto;fl.instance.updateInfo(n),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.gov.GovMainPanelView&&t._mainView.updateView(),Tu.sendToModule("UPDATE_GOV_REDPOINT",["modules.nav.NavModule"]);break;case"21011":var s=e.proto;fl.instance.updateGuanYinID(s.rewardID),WP.runGetGuanYinBackFn(),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.gov.GovMainPanelView&&t._mainView.updateView(),Tu.sendToModule("UPDATE_GOV_REDPOINT",["modules.nav.NavModule"]);break;case"21013":var o=e.proto;gR.ins.govPosition=o.position,0<=gR.ins.govPosition&&NF.mainChar.showPosition(gR.ins.govPosition),fl.instance.updatePosition(o.position),fl.instance.updateCurrentLiLian(o.lilian),WP.runGetPromotionFn(),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.gov.GovMainPanelView&&t._mainView.updateView(),Tu.sendToModule("UPDATE_GOV_REDPOINT",["modules.nav.NavModule"]);break;case"21009":var a=e.proto;fl.instance.updateTodayGetLiLianRewardArr(a.rewardID),WP.runGetTodayLiLianRewardFn(),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.gov.GovMainPanelView&&t._mainView.updateView(),Tu.sendToModule("UPDATE_GOV_REDPOINT",["modules.nav.NavModule"]);break;case"30023":0<e.proto.result&&(YP.instance.back_prestige=0),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.prestige.PrestigeMainView&&t._mainView.updateView();break;case"30024":var r=e.proto;YP.instance.updateInfo(r),t._mainView&&t._mainView.vsc.selectedView instanceof modules.achievenew.views.prestige.PrestigeMainView&&t._mainView.updateView()}},i.checkOpenGov=function(){return parseInt($e.MODEL.value($e.getIndex(119)))<=aB.instance.activedRingId},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),YU=function(e){function i(){var e=this;e._newscene=null,e._guildInfo=null,e._result=null,e._move=null,e.newsiegeData=null,i.__super.call(e),e.newsiegeData=DN.instance;var t=[_r.getLayoutsPath("newsieges"),_r.getLayoutsPath("mission")];hN.ins.registPanel("NEW_SS_SCENE",a$,"_newscene",e,{wait:hN.waitRes(t),layer:"nav"}),hN.ins.registPanel("NEW_SS_GUILD_INFO",VZ,"_guildInfo",e,{wait:hN.waitRes(t),mask:!0}),hN.ins.registPanel("NEW_SS_GUILD_END",FZ,"_result",e,{wait:hN.waitRes(t),mask:!0}),hN.ins.registPanel("NEW_SS_GUILD_MOVE",UZ,"_move",e,{wait:hN.waitRes(t),mask:!0})}b(i,"modules.newsiege.proxys.NewSiegeSceneProxy",bp);var t=i.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"NEW_SS_ENTRY":t.newsiegeData.reqEntry(e.proto);break;case"OPEN_GUILD_PERSON_VIEW":hN.ins.open("NEW_SS_GUILD_INFO");break;case"OPEN_MAIN_SCENE_VIEW":hN.ins.open("NEW_SS_SCENE"),t._newscene&&t._newscene.parent&&t._newscene.updateInfo();break;case"23310":t.newsiegeData.endTime=e.proto.restT,t._newscene&&t._newscene.parent&&t._newscene.showEndCDTime();break;case"23317":t.newsiegeData.addScore=e.proto.score-t.newsiegeData.myScore,t.newsiegeData.addZhanGong=e.proto.gongxunNumber-t.newsiegeData.myGongXun,t.newsiegeData.myScore=e.proto.score,t.newsiegeData.myGongXun=e.proto.gongxunNumber,t._newscene&&t._newscene.parent&&t._newscene.updateScore(!0);break;case"23324":t.newsiegeData.awardList=e.proto.awardList,t._newscene&&t._newscene.parent&&(t._newscene.updateScore(),t.newsiegeData.isclickGet&&(t._newscene.playGetItemsByPos(t.newsiegeData.awardList[t.newsiegeData.awardList.length-1]),t.newsiegeData.isclickGet=!1));break;case"24042":DN.instance.hurtRank=e.proto.hurtList,t._newscene&&t._newscene.showHurtRankInfo();break;case"SCZB_CHENGMEN_DEAD":t._newscene&&t._newscene.closeHurtRank();break;case"23327":t._newscene&&t._newscene.updateScenePlayerNum(e.proto.scurrentSceneNumber);break;case"23329":t.newsiegeData.playerList=e.proto.playerList,t._guildInfo&&t._guildInfo.parent&&t._guildInfo.showGuildInfo();break;case"23326":t.newsiegeData.myGuildScore=e.proto.myGuildScore,t.newsiegeData.guideRank=e.proto.list,t._newscene&&t._newscene.parent&&t._newscene.updateScore();break;case"23311":t.newsiegeData.winGuild=e.proto.winGuild,t._newscene&&t._newscene.updateWinGuild();break;case"23305":t.newsiegeData.personRank=e.proto.pList,t.newsiegeData.guideRank=e.proto.gList,t.newsiegeData.winGuild=e.proto.wcGuild,Tu.sendToModule("GUILD_RANK_AWARDS_UPDATE",["modules.guild.GuildModule"]);break;case"23341":t.newsiegeData.personRank=e.proto.pList,Tu.sendToModule("GUILD_RANK_AWARDS_UPDATE",["modules.guild.GuildModule"]);break;case"23320":t._result&&t._result.parent?t._result.update(e.proto):hN.ins.open("NEW_SS_GUILD_END",e.proto);break;case"MOSNTER_LIST_UPDATE":t._newscene&&t._newscene.showMoveBtn();break;case"23335":t.newsiegeData._toc23335=e.proto,t._newscene&&t._newscene.showCaiJiInfo(!0,t.newsiegeData._toc23335.charName,t.newsiegeData._toc23335.guildName,t.newsiegeData._toc23335.caijiTime);break;case"23336":t._newscene&&t._newscene.showCaiJiInfo(!1),t.newsiegeData._toc23335=null;break;case"23331":hN.ins.open("NEW_SS_GUILD_MOVE");break;case"NEW_SS_CHAR_DEAD":t._move&&t._move.parent&&hN.ins.close("NEW_SS_GUILD_MOVE");break;case"23338":zB.ins.playRainbowByWords(RP.n[213],5e3);break;case"NEW_SS_MOVE_END":t._newscene&&t._newscene.onClickCaiJi()}},t.closePanel=function(e,t){},t.showPanel=function(e,t){"NEW_SS_GUILD_END"==e&&t&&this._result.update(t)},i}(),zU=function(e){function t(){this._mainView=null,this._niepanDaily=null,this._niepanTask=null,t.__super.call(this);var e=[_r.getLayoutsPath("niepan")];hN.ins.registPanel("NIEPAN_MAIN_VIEW",aJ,"_mainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigNiePanResource","ConfigNiePanEleResource"],["ConfigNiePanResource","ConfigNiePanEleResource"])),layer:"layout",mask:!1}),hN.ins.registPanel("NIEPAN_DAILY_VIEW",jZ,"_niepanDaily",this,{wait:hN.waitRes(e),mask:!0}),hN.ins.registPanel("NIEPAN_TASK_VIEW",zZ,"_niepanTask",this,{wait:hN.waitRes(e),mask:!0}),hN.ins.registPanel("NiepanNpcTalk",zJ,"",this,{wait:hN.wait(hN.waitAtlas("niepan")),mask:!1,clickClose:!0,layer:"nav"})}b(t,"modules.niepan.proxys.NiepanProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_NIEPAN":if(hN.ins.isOpen("NIEPAN_MAIN_VIEW"))hN.ins.close("NIEPAN_MAIN_VIEW");else{var i=0;e.proto&&e.proto.hasOwnProperty("_subIndex_")&&(i=e.proto._subIndex_),hN.ins.open("NIEPAN_MAIN_VIEW",{_subIndex_:i},0)}break;case"OPEN_NIEPAN_WUXING":t._mainView&&t._mainView.parent&&t._mainView.setSelectIndex(2);break;case"UDPDATE_TASK":t._mainView&&t._mainView.parent&&(t._mainView.vsc.invalid(),t._mainView.vsc.updateSelectedView(e)),t._niepanDaily&&t._niepanDaily.parent&&t._niepanDaily.updateView();break;case"31051":var n=e.proto;t.checkNiepanUplevel(n),1==n.isUpLevel&&(yH.Ins().clear(),ON.ins.isOpenTalent=1,sJ.ins.hideAllCompoments(),sJ.ins.showCompoment("NiepanEffect"),UB.ins.playSound("Uplv"),G.timer.once(4e3,t,t.hideFocus)),0<(ON.ins.data31051=n).curRoleIndex&&(ON.ins.openTalentIndex=n.curRoleIndex),t.setNiepanData(n.roleData),t._mainView&&t._mainView.parent&&(t._mainView.vsc.invalid(),t._mainView.vsc.updateSelectedView(e)),t._niepanDaily&&t._niepanDaily.parent&&t._niepanDaily.updateView();break;case"31054":var s=e.proto;ON.ins.data31054=s,t._mainView&&t._mainView.parent&&(t._mainView.vsc.updateSelectedView(e),t._mainView.vsc.invalid());break;case"BP_UPDATE":t._mainView&&t._mainView.parent&&t._mainView.vsc.updateSelectedView(e)}},i.hideFocus=function(){sJ.ins.showAllCompoments(),sJ.ins.hideCompoment("NiepanEffect"),Tu.sendToModule("SKILLVIEW_OPEN",["modules.skill.SkillModule"],{selectedInex:4,backID:0})},i.showPanel=function(e,t){},i.closePanel=function(e,t){},i.setNiepanData=function(e){var t=gR.ins.actorList;if(t)for(var i=0;i<t.length;i++)e[i+1]&&(t[i].niepanlevel=e[i+1])},i.checkNiepanUplevel=function(e){var t=ON.ins.data31051;for(var i in e.roleData)t&&t.roleData[i]<e.roleData[i]&&(e.isUpLevel=1)},t}(),XU=function(e){function t(){this._offlineExp=null,this._offlinePanel=null,t.__super.call(this),hN.ins.registPanel("OFFLINE_EXP",QZ,"_offlineExp",this,{wait:hN.waitAtlas("offline"),clearAll:!1,mask:!0}),hN.ins.registPanel("OfflinePanelView",o1,"_offlinePanel",this,{wait:hN.waitAtlas(["basic_ui","base_ui2","gui"]),clearAll:!0,mask:!0,clickClose:!1})}b(t,"modules.offline.proxys.OfflineProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"13028":var t=e.proto;(0<(PN.ins.toc_exp=t).exp||0<t.coin||0<t.equipNum||0<t.moChenNum)&&G.timer.once(500,this,function(){hN.ins.open("OFFLINE_EXP")});break;case"__LOGIN_RECONENTED__":PN.ins.resetOffline(),PN.ins.resetFlyup(),Tu.sendToModule("BOSS_BLOOD_CLOSE",["modules.nav.NavModule"]),qU.ins.lockBossId=0,tr.push(RP.n[214]);break;case"SOCKET_CLOSE":HP.checkBasicLoaded()?this.showOffLinePanel():HP.loadBasicUI(ql.create(this,this.showOffLinePanel));break;case"INTERVAL_LOST_CONNECTED":null!=KQ.ins.parent||hN.ins.isOpen("OfflinePanelView")||(tr.push(RP.n[215]+SF.GetIntance().loginSocket.connected),tr.push("Alert.ins.parent"+KQ.ins.parent+RP.n[216]+hN.ins.isOpen(RP.n[217])),hN.ins.open("OfflinePanelView"))}},i.showOffLinePanel=function(){SF.GetIntance().loginSocket.connected||SF.GetIntance().loginSocket.hasRevice13303||hN.ins.isOpen("OfflinePanelView")||null!=KQ.ins.parent||(tr.push(RP.n[218]),hN.ins.open("OfflinePanelView"))},i.showPanel=function(e,t){"OfflinePanelView"==e&&tr.push(RP.n[219])},i.closePanel=function(e,t){},t}(),QU=function(e){function t(){this._mainView=null,this._comView=null,this._fenjieView=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("passsuit")),hN.ins.registPanel("PASSSUIT_VIEW",JZ,"_mainView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigChuanshi","ConfigChuanshiSuit"],["ConfigChuanshi","ConfigChuanshiSuit"])),mask:!1,layer:"layout"}),hN.ins.registPanel("PASSSUIT_COMPOSE_VIEW",a1,"_comView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigChuanshi","ConfigChuanshiSuit"],["ConfigChuanshi","ConfigChuanshiSuit"])),mask:!0}),hN.ins.registPanel("PASSSUIT_FENJIE_VIEW",r1,"_fenjieView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigChuanshi","ConfigChuanshiSuit"],["ConfigChuanshi","ConfigChuanshiSuit"])),mask:!0})}b(t,"modules.passsuit.proxys.PassSuitProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_PASSSUIT":hN.ins.open("ACTOR_M",{subIndex:parseInt("4")});break;case"11302":case"10204":break;case"FORCE_OPEN_PASSSUIT":RN.isSpecialRefresh=!0,hN.ins.open("ACTOR_M",{subIndex:parseInt("4")});break;case"OPEN_PASSSUIT_COMPOSE":hN.ins.open("PASSSUIT_COMPOSE_VIEW");break;case"OPEN_PASSSUIT_FENJIE":hN.ins.open("PASSSUIT_FENJIE_VIEW");break;case"23621":this._comView&&this._comView.refreshTools();break;case"RESFRESH_BACKPACK_INFO":this._fenjieView&&this._fenjieView.refreshFenJiePanel()}},i._binLoadedHandler=function(){},i.closePanel=function(e,t){},i.showPanel=function(e,t){"PASSSUIT_VIEW"==e&&null!=t&&t.hasOwnProperty("roleIndex")&&this._mainView.forceRefresh(parseInt(t.roleIndex),parseInt(t.equipIndex))},t}(),JU=function(e){function t(){this._previewView=null,t.__super.call(this),hN.ins.registPanel("PREVIEW_VIEW",tK,"_previewView",this,{clearAll:!1,mask:!0})}b(t,"modules.preview.proxy.PreviewProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"12003":e.proto;null!=this._previewView&&this._previewView.update()}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),ZU=function(e){function t(){this._rankView=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("rank")),hN.ins.registPanel("RANK_VIEW",uJ,"_rankView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["OfficialResource","ConfigRankTitle","MedalResource","ConfigChuanshi","PrestigeResource"],["COfficialResource","CRankTitle","ConfigMedal","ConfigChuanshi","CPrestigeResource"])),layer:"layout"})}b(t,"modules.rank.proxys.RankProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN":if(gR.ins.lv<60)return void zB.ins.showById(2081,1);hN.ins.toggle("RANK_VIEW");break;case"10702":var t=e.proto;o_.ins.setRank(t.type,t),this._rankView&&this._rankView.parent&&this._rankView.vsc.updateSelectedView(e),Tu.sendToTotalModule("UPDATE_RANK_INFO");break;case"10212":var i=e.proto;this.showPanel(i.id);break;case"25010":var n=e.proto;this.showPanel(n.id);break;case"10207":if(o_.ins.isMoing)1e6<=e.proto.value&&(o_.ins.isMoing=!1);break;case"SWITCH_TAB_TYPE":if(this._rankView&&this._rankView.parent)this._rankView.vsc.updateSelectedView(e.proto.value);else{var s=null;e.proto&&e.proto.backId&&(s=e.proto.backId),hN.ins.open("RANK_VIEW",e,s)}}},i.closePanel=function(e,t){},i.showPanel=function(e,t){t&&"SWITCH_TAB_TYPE"==t.actionOrder&&this._rankView&&this._rankView.parent&&this._rankView.vsc.updateSelectedView(t.proto.value)},t}(),KU=function(e){function t(){t.__super.call(this)}b(t,"modules.recharge.proxys.RechargeActProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){e.actionOrder},i.showPanel=function(e,t){if("LIMITPAY"==e){var i=t;if(i){var n=mB.getInStance().getMainType(i),s=n?n.activityIds[0]:0;WB.getActivityData(s,ql.create(this,this.onActivity))}}},i.onActivity=function(e){},i.closePanel=function(e,t){},t}(),$U=function(e){function a(){this._rechargeV=null,this._firstV=null,this._everyV=null,this._firstPop=null,a.__super.call(this);var e=[];e.push(_r.getLayoutsPath("recharge"));var t=["ConfigVip","ConfigFirstRecharge","ConfigDailyRecharge","ConfigRecharge","BaiYuanHaoLiResource"],i=["ConfigVip","CFirstRecharge","CDailyRecharge","CRecharge","CBaiYuan"];hN.ins.registPanel("RECHARGE_VIEW",d1,"_rechargeV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(t,i)),mask:!1,layer:"layout"}),(e=[]).push(_r.getLayoutsPath("recharge_s")),hN.ins.registPanel("FIRST_RECHARGE",gJ,"_firstV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(t,i)),clearAll:!0,mask:!1,layer:"layout"}),(e=[]).push(_r.getLayoutsPath("recharge_s")),hN.ins.registPanel("EVERY_RECHARGE",iK,"_everyV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(t,i)),clearAll:!1,mask:!0}),(e=[]).push(_r.getNoClearImage("cz_sctc")),hN.ins.registPanel("FIRST_PAY",nK,"_firstPop",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(t,i)),clearAll:!1,mask:!1,layer:"nav"})}b(a,"modules.recharge.proxys.RechargeProxy",bp);var t=a.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"Layer_Init":G.timer.once(300,t,a.reqRecharge);break;case"23004":HN.ins.toc_recharge=e.proto,t._rechargeV&&t._rechargeV.updateRecharge(),t._firstV&&t._firstV.update();break;case"14003":Wg.ins.toc_info=e.proto,t._rechargeV&&t._rechargeV.updateRecharge();break;case"23005":HN.ins.toc_every=e.proto,t._everyV&&t._everyV.update(),t._rechargeV&&t._rechargeV.updateRecharge();break;case"23006":var i=e.proto.cfgId;HN.ins.toc_every&&HN.ins.toc_every.showArray.hasOwnProperty(i)&&(HN.ins.toc_every.showArray[i]=2),t._everyV&&t._everyV.update();var n=Kt.getIndex(i),s=Kt.MODEL.rechargeReward(n);zB.ins.playGetGoods(s);break;case"23008":HN.ins.toc_recharge&&(HN.ins.toc_recharge.canGet=2,HN.ins.toc_recharge.day=e.proto.day,HN.ins.toc_recharge.hash_state=e.proto.hash_state),t._firstV&&(t._firstV.update(),t._firstV.vsc&&t._firstV.vsc.selectedView instanceof modules.recharge.views.FirstRechargeV&&t._firstV.vsc.selectedView.flyGoods());break;case"OPEN_RECHARGE":if(null==HN.ins.toc_recharge)return;var o=e.proto;hN.ins.open("RECHARGE_VIEW",null,o);break;case"OPEN_QRECHARGE":if(null==HN.ins.toc_recharge)return;EB.showCharge&&e.proto&&e.proto.hasOwnProperty("type")&&("daily"==e.proto.type?hN.ins.open("EVERY_RECHARGE"):hN.ins.open("FIRST_RECHARGE"));break;case"23009":HN.ins._isTip=!1,t.showFirstAd();break;case"_UI_SET_CHANGED":t._firstPop&&!MN.isNormalShow?1==LN.isShowPop?(HN.ins._isTip=!1,MN.isNormalShow=!0,t.showFirstAd()):hN.ins.close("FIRST_PAY"):HN.ins._isTipOpen&&MN.isNormalShow&&(HN.ins._isTipOpen=!1,t.showFirstAd());break;case"ICON_POS_CHANGED":t._firstPop&&t._firstPop.updatePos();break;case"33017":HN.ins.toc_baiY=e.proto,t._firstV.vsc&&t._firstV.vsc.selectedView instanceof modules.recharge.views.BaiYuanHaoLiV&&t._firstV.vsc.selectedView.update()}},t.showFirstAd=function(){null!=HN.ins.toc_recharge&&0==HN.ins.toc_recharge.canGet&&!HN.ins._isTip&&EB.showCharge&&(HN.ins._isTip=!0,G.timer.once(1e3,this,this._showFirstAd))},t._showFirstAd=function(){MN.isNormalShow?hN.ins.open("FIRST_PAY"):(HN.ins._isTip=!1,HN.ins._isTipOpen=!0)},t.showPanel=function(e,t){},t.closePanel=function(e,t){},a.reqRecharge=function(){var e=new YA;Tu.sendToService(e);var t=new zA;Tu.sendToService(t),tr.push(RP.n[220])},a}(),eF=function(e){function t(){this._reliveView=null,this._newWorldBossReliveTipsView=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("relive")),hN.ins.registPanel("RELIVE_TIPS",h1,"_reliveView",this,{wait:hN.waitRes(e),mask:!0,layer:"under",clickClose:!1}),hN.ins.registPanel("NavWorldBoss",KZ,"_newWorldBossReliveTipsView",this,{wait:hN.waitRes(e),mask:!0,layer:"under",clickClose:!1})}b(t,"modules.relive.proxys.ReliveProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"RELIVEVIEW_OPEN":var t=rn.getIndex(BR.ins.curCopyId),i=rn.MODEL.cate(t);57==i?G.timer.once(750,null,function(){hN.ins.open("NavWorldBoss")}):56==i?G.timer.once(1500,null,function(){var e=new wA;e.type=2,Tu.sendToService(e)}):G.timer.once(750,null,function(){hN.ins.open("RELIVE_TIPS")});break;case"RELIVEVIEW_CLOSE":hN.ins.isOpen("NavWorldBoss")&&hN.ins.close("NavWorldBoss"),hN.ins.isOpen("RELIVE_TIPS")&&hN.ins.close("RELIVE_TIPS")}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),tF=function(e){function t(){this._resonateSubView=null,this._resonateSkillTip=null,this._resonateAttrDetailTip=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("resonate"));hN.ins.registPanel("RESONATE_SUB_VIEW",_1,"_resonateSubView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["MagicSuitResource","MagicPositionResource","MoZhuHunResource","MoMappingResource","ConfigFlyUpSuitResource","ConfigRule","ConfigFlyUpSuitLimit","GDReonanceResource","GDReonanceSuitResource"],["CMagicSuitResource","CMagicPositionResource","CMoZhuHunResource","CMoMappingResource","ConfigFlyUpSuitResource","CHelpDes","ConfigFlyUpSuitLimit","CGDReonanceResource","CGDReonanceSuitResource"])),clearAll:!0,mask:!1,layer:"layout"}),hN.ins.registPanel("RESONATE_SKILL_TIP",aK,"_resonateSkillTip",this,{clearAll:!1,mask:!0,layer:"panel"}),hN.ins.registPanel("RESONATE_ATTR_DETAIL_TIP",oK,"_resonateAttrDetailTip",this,{clearAll:!1,mask:!0,layer:"panel"})}b(t,"modules.resonate.proxys.ResonateProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"BP_UPDATE":this._resonateSubView&&this._resonateSubView.updateGoods&&this._resonateSubView.updateGoods();break;case"31042":this._resonateSubView&&this._resonateSubView.updateGoods&&this._resonateSubView.refresh()}},i.showPanel=function(e,t){switch(e){case"RESONATE_SKILL_TIP":if(null==this._resonateSkillTip||null==t)return;this._resonateSkillTip.show(t.actorId,t.level,t.isNeedActive);break;case"RESONATE_ATTR_DETAIL_TIP":if(null==this._resonateAttrDetailTip||null==t)return;this._resonateAttrDetailTip.show(t)}},i.closePanel=function(e,t){},t}(),iF=function(e){function t(){this.attacker=0,this.defender=0,this.skillId=0,this.att=[],this.buff=[],this.playState=0,this.hyArray=[],t.__super.call(this),this.actType=1}return b(t,"protos.scene.DtoFRoundData",Gv),t.prototype.decode=function(e,t){this.attacker=e.readShort(),this.defender=e.readShort(),this.skillId=e.readShort();for(var i=e.readByte(),n=0;n<i;n++){var s=e.readByte();if(2==s){var o=AH.DHurt(e,t);this.att.push(o)}else 3==s?this.buff.push(AH.DBuff(e)):4==s&&this.hyArray.push(AH.DHuanYing(e))}},t.GetNew=function(){return new t},t}(),nF=function(e){function T(){var e=this;e.playerQueue=[],e.playerGroupArray=[],e.bossOwner=null,e.currBossHP=999999999,e.maxBossHP=999999999,e.bossId=1,e.myInfoData=null,e.myZhanBaoDataQueue=[],e.playerNumber=0,e.bossInfoData=null,e.bossZhanBaoDataQueue=[],e.ownerInfoData=null,e.ownerZhanBaoDataQueue=[],e.zhanbaoQueue=[],e.currDtoZhanBao=null,e.playTime=0,e.isStopMy=!1,e.myPlayData=null,e.myPlayTime=0,this.bossPlayData=null,this.bossPlayTime=0,this.ownerPlayData=null,this.ownerPlayTime=0,this.backpackdur=0,this.playgroundPlayerHash=new jl,this.deathHash=new jl,this.recordGroup,this.heroGroup=new pH,T.__super.call(this)}b(T,"modules.scene.proxys.SceneBossProxy",bp);var t=T.prototype;return t.subHandler=function(e){var t=this,i=0;if("__BOSS_ENTER__"==e.actionOrder||"__BOSS_OWN_ENTER__"==e.actionOrder){t.playerQueue.length=0,t.playerGroupArray.length=0,t.bossOwner=null,Object,t.myZhanBaoDataQueue.length=0,Object,t.bossZhanBaoDataQueue.length=0,Object,t.ownerZhanBaoDataQueue.length=0,pH.reset(),t.playgroundPlayerHash.reset(),T.playerHash.reset(),t.zhanbaoQueue.length=0,T.isOwnerZhanbaoPlaying=!1,T.waitPlayerIntoPlayGround=!1;var n=e.proto;if(t.currDtoZhanBao=null,7!=n.type&&49!=n.type&&14!=n.type)return;sH.stop(),aH.isZhanBaokMode=!0,T.isHeroRunInPlayGround=!1,i=(dr.dtoEnterScene=n).cid,NF.Ins().changeScene(i.toString(),!0,ql.create(t,t.onReadyFunc)),T.isFirstShowBool=!1}else{if(dr.dtoEnterScene&&14!=dr.dtoEnterScene.type&&49!=dr.dtoEnterScene.type&&7!=dr.dtoEnterScene.type)return;switch(e.actionOrder){case"__ZHANBAO_PLAY_END__":if(dr.dtoEnterScene&&dr.dtoEnterScene.dtoZhanbao&&(12==dr.dtoEnterScene.type||13==dr.dtoEnterScene.type))return;t.zhanbaoPlayEnd();break;case"__BOSS_EXIT__":case"__BOSS_OWN_EXIT__":case"__BOSS_HOME_EXIT__":aH.isZhanBaokMode=!1,BB.IsModePVE=!0,T.isReady=!1,dr.dtoEnterScene=null,T.isHeroRunInPlayGround=!1,null!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(t,t.exit)),T.isFirstShowBool=!1,0<hg.ins.getLeftTime()&&BR.ins.reqAutoChallenge();break;case"22602":var s=e.proto;if(aH.boss&&(t.currBossHP=s.bossCurrHP,aH.boss.setCharBoolValue(t.currBossHP,t.maxBossHP)),s.bossCurrHP<=0)sH.stop(),aH.boss&&(aH.boss.setDeath(),aH.boss.play("death")),aH.boss&&aH.boss.ai&&aH.boss.ai.stop(),t.stop();else if(T.isStop){T.isStop=!1;for(var o=0;o<t.playerGroupArray.length;o++){t.playerGroupArray[o].start(),sH.start()}}T.curFightModule&&Tu.sendToModule("FIGHT_BLOOD_UPDATE",[T.curFightModule],e.proto);break;case"22617":var a=e.proto;if(a)for(var r=0;r<a.charQueue.length;r++){var l=a.charQueue[r],c=l.charIndex,u=l.titles,d=aH.getChar(c);d&&ZN.setCharTitle(d,u)}break;case"22603":for(var h=e.proto,_=0;_<h.palyers.length;_++){var f=h.palyers[_];f.playerId.toString()==gR.ins.charId?(t.myInfoData=f,h.palyers.splice(_,1),t.beanBase(),_--):0==T.playerHash.has(f.playerId)&&(T.playerHash.put(f.playerId,f.queue),t.playerQueue.push({playerId:f.playerId,queue:f.queue,attackValue:f.attackValue,isLive:f.isLive}))}t.delayCreatePlay(),t.playerNumber=t.playerQueue.length,2<t.playerNumber&&(ZN._heidShake_=!0);break;case"22611":for(var p=e.proto,g=0;g<p.palyers.length;g++){var v=p.palyers[g];0==T.playerHash.has(v.playerId)&&(T.playerHash.put(v.playerId,v.queue),t.playerQueue.push({playerId:v.playerId,queue:v.queue,attackValue:v.attackValue,isLive:v.isLive}))}t.playerNumber+=1,2<t.playerNumber&&(ZN._heidShake_=!0);break;case"22614":var m=e.proto;if(m.charId.toString()==gR.ins.charId)t.playgroundPlayerHash.put(gR.ins.charId,t.myInfoData.queue,!0),t.heroRunInPlayGround(!0),uH.heroRelive();else{var y=t.deathHash.take(m.charId);if(y)y.isLive=1,t.playerQueue.push(y);else for(var I=0;I<t.playerQueue.length;I++){var b=t.playerQueue[I];b.playerId==m.charId&&(b.isLive=1)}}e.proto.time=pt.now(),T.curFightModule&&Tu.sendToModule("FIGHT_RELIVE",[T.curFightModule],e.proto);break;case"22612":var w=e.proto,x=t.takePlayerData(w.playerId);x&&t.removeGroupPlayer(x),t.playerNumber-=1,t.playerNumber<=2&&(ZN._heidShake_=!1);break;case"22604":t.bossOwner=e.proto;break;case"22606":var S=e.proto;if(2==S.dtoZhanBao.result&&t.bossOwner.charId.toString()==gR.ins.charId&&S.dtoZhanBao.defenders_id.toString()==gR.ins.charId){var k=t.takePlayerData(S.dtoZhanBao.attacker_id);return k&&t.removeGroupPlayer(k),void(aH.isZhanBaokMode=!1)}t.zhanbaoQueue.push(S);break;case"22601":var E=e.proto;E.attacker.toString()==gR.ins.charId?t.myZhanBaoDataQueue.push(E):E.attacker==t.bossId?t.bossZhanBaoDataQueue.push(E):t.ownerZhanBaoDataQueue.push(E)}}},t.clearDeathChar=function(e){if(e){var t=e.charQueue;for(var i in t.proto){var n=t.proto[i];n&&n.isDeath&&(n.visible=!1)}}},t.clearDeathHero=function(){for(var e=0;e<uH.heroQueue.length;e++){var t=uH.heroQueue[e];t&&t.isDeath&&(t.visible=!1)}},t.clearTotalDeath=function(){this.clearDeathHero(),T.clearHy(),aH.clearHy(),this.clearDeathChar(this.recordGroup)},t.zhanbaoPlayEnd=function(){var e=this;if(aH.isZhanBaokMode=!1,dr.dtoEnterScene&&(7==dr.dtoEnterScene.type||49==dr.dtoEnterScene.type||14==dr.dtoEnterScene.type)){if(e.isStopMy=!1,sH.getInstance().isStop=!1,sH.getInstance().autoMode=!1,e.clearDeathHero(),T.clearHy(),aH.clearHy(),e.recordGroup){if(e.clearDeathChar(e.recordGroup),0==e.currDtoZhanBao.isMeWin)for(var t=0;t<uH.heroQueue.length;t++){var i=uH.heroQueue[s];i&&(i.setDeath(),i.play("death"))}for(var n,s=0;s<e.currDtoZhanBao.attackers.length;s++)(n=aH.getChar(e.currDtoZhanBao.attackers[s]))&&n.ai&&n.ai.start();for(var o=0;o<e.currDtoZhanBao.defenders.length;o++)(n=aH.getChar(e.currDtoZhanBao.defenders[o]))&&n.ai&&n.ai.start();e.currDtoZhanBao&&(e.currDtoZhanBao.attacker_id.toString()==gR.ins.charId?1==e.currDtoZhanBao.result?e.removeGroupPlayer(e.recordGroup):(LH.unbeanChar(e.heroGroup),e.heroGroup.dto=null,modules.scene.proxys.SceneBossProxy.playerHash.remove(gR.ins.charId),e.recordGroup.start()):2==e.currDtoZhanBao.result?e.removeGroupPlayer(e.recordGroup):(LH.unbeanChar(e.heroGroup),e.heroGroup.dto=null,modules.scene.proxys.SceneBossProxy.playerHash.remove(gR.ins.charId),e.recordGroup.start())),e.recordGroup=null}e.myZhanBaoDataQueue.length=0,e.bossZhanBaoDataQueue.length=0,NF.mainChar.setDeath(),NF.mainChar.play("death"),e.myPlayData=null,e.bossPlayData=null,T.curFightModule&&e.sendToModule("__BOSS_ZHANBAO_END__",[T.curFightModule],e.currDtoZhanBao)}},t.removeGroupPlayer=function(e){modules.scene.proxys.SceneBossProxy.playerHash.remove(e.playerId),e.stop(),e.remove(),e.isLive=0,this.deathHash.put(e.playerId,{playerId:e.playerId,queue:e.playerData,attackValue:e.attackValue}),this.playgroundPlayerHash.remove(e.playerId)},t.delayCreatePlay=function(){for(var e=0;e<3;e++)G.timer.once(3e3,this,this.createPlayerGroup,null,!1)},t.bossOwnerIntoPlayGround=function(e){T.waitPlayerIntoPlayGround=!0,this.playeGetOut();var t=this.deathHash.take(e);t&&(t.isLive=1,this.playerQueue.push(t)),this.createPlayerGroup(),G.timer.once(5e3,this,this.bossOwnerIntoPlayGroundEnd)},t.bossOwnerIntoPlayGroundEnd=function(){T.waitPlayerIntoPlayGround=!1},t.playBossOwnerZhanBao=function(){var e=this;if(!T.waitPlayerIntoPlayGround)if(null!=e.playgroundPlayerHash.take(e.bossOwner.charId)){if(!T.isOwnerZhanbaoPlaying){T.isOwnerZhanbaoPlaying=!0;var t=e.zhanbaoQueue.shift(),i=t.dtoZhanBao;if(e.currDtoZhanBao=i,0==e.currDtoZhanBao.isMeWin){var n;T.clearHy(),aH.clearHy(),aH.clearTotalBean(),aH.getInstance().addDto(t.dtoZhanBao);for(var s=0;s<e.currDtoZhanBao.attackers.length;s++)(n=aH.getChar(e.currDtoZhanBao.attackers[s]))&&n.ai&&(n.ai.stop(),n.faceTo(aH.getChar(e.currDtoZhanBao.defenders[0])));for(var o=0;o<e.currDtoZhanBao.defenders.length;o++)(n=aH.getChar(e.currDtoZhanBao.defenders[o]))&&n.ai&&(n.ai.stop(),n.faceTo(aH.getChar(e.currDtoZhanBao.attackers[0])));e.bossOwner.charId.toString()!=gR.ins.charId?e.recordGroup=e.takePlayerData(i.defenders_id):e.recordGroup=e.takePlayerData(i.attacker_id),e.moveEndFuncForZhanbao(e.recordGroup)}else e.bossOwner.charId.toString()!=gR.ins.charId?e.recordGroup=e.takePlayerData(i.defenders_id):e.recordGroup=e.takePlayerData(i.attacker_id),e.playQuickZhanBao()}}else e.bossOwnerIntoPlayGround(e.bossOwner.charId)},t.playQuickZhanBao=function(){var e=this.currDtoZhanBao.roundQueueData[0];if(e){for(var t=0;t<e.length;t++){var i=e[t],n=pH.takeChar(i.attacker),s=pH.takeChar(i.defender);if(n&&s){0<i.skillId&&!s.isDeath&&oH.playSkill2(n,s,i.skillId);var o=1;n&&(o=n.profession),n.doZhanBaoCtrlPlayHurt(i.att,i.buff,o)}}G.timer.once(1e3,this,this.playQuickZhanBaoEnd)}},t.playQuickZhanBaoEnd=function(){var e=this,t=e.currDtoZhanBao.resultHash;for(var i in t.proto){var n=t.proto[i],s=(n.char_id,n.currHP),o=n.maxHP,a=pH.takeChar(n.char_id);a&&(s<=0?(a.play("death"),a.setDeath(),a.visible=!1):a.setCharBoolValue(s,o))}e.currDtoZhanBao.isMeWin?(e.currDtoZhanBao.isMeAttack?e.recordGroup=e.takePlayerData(e.currDtoZhanBao.defenders_id):e.recordGroup=e.takePlayerData(e.currDtoZhanBao.attacker_id),e.recordGroup&&e.removeGroupPlayer(e.recordGroup)):(LH.unbeanChar(e.heroGroup),e.heroGroup.dto=null,modules.scene.proxys.SceneBossProxy.playerHash.remove(gR.ins.charId),e.currDtoZhanBao.isMeAttack?e.recordGroup=e.takePlayerData(e.currDtoZhanBao.defenders_id):e.recordGroup=e.takePlayerData(e.currDtoZhanBao.attacker_id),e.recordGroup&&e.recordGroup.start()),e.recordGroup=null,T.curFightModule&&e.sendToModule("__BOSS_ZHANBAO_END__",[T.curFightModule],e.currDtoZhanBao),T.isOwnerZhanbaoPlaying=!1,aH.isZhanBaokMode=!1},t.moveEndFuncForZhanbao=function(e){e&&e.stop(),aH.getInstance().playDto(),aH.getInstance().start(),T.isOwnerZhanbaoPlaying=!1},t.exit=function(){NF.camPoint=null,this.playerQueue.length=0,sH.start(),G.timer.clear(this,this.loop),this.playerNumber=0,ZN._heidShake_=!1},t.onReadyFunc=function(){aH.getInstance().stop(),sH.stop(),this.playerGroupArray.length=0,LH.setupRobotDatas(uH.robotBirthPoints);var e=dr.dtoEnterScene.monsterId,t=hn.getIndex(e),i=hn.MODEL.muId(t);i=_n.getIndex(i);var n=uH.monsterDataHash.take(e);if(n||(n=JSON.parse(hn.MODEL.attributes(t)),uH.setMonsetAttributes(e,n)),aH.boss){aH.boss.setCharBoolValue(this.currBossHP,this.maxBossHP),aH.boss.setCharBoolVisible(!1),aH.boss.setCharNameVisible(!1);var s=_n.MODEL.avatarId(i);aH.boss.char_name=hn.MODEL.name(t),aH.boss.type=Za.MONSTER,aH.boss.selectEnabled=!0,aH.boss.isBoss=!0,aH.boss.isUpdateBool=!1,ZN.updateCharDisplay(aH.boss,s),aH.boss.play("stand"),aH.boss.dir=5,aH.boss.alpha=1,NF.scene.addItem(aH.boss)}this.beanBase(),this.heroRunInPlayGround(!0),this.delayCreatePlay()},t.playeGetOut=function(){if(!LH.hasFreeRobotData()){for(var e,t=0;t<this.playerGroupArray.length;t++){var i=this.playerGroupArray[t];i.playerId.toString()!=gR.ins.charId&&i.playerId!=this.bossOwner.charId&&(null==e?e=i:i.attackValue<e.attackValue&&(e=i))}if(e)return this.removeGroupPlayer(e),e.dto.birthPt}return null},t.heroRunInPlayGround=function(e){var t=this;void 0===e&&(e=!1),T.isReady=!1;var i=t.playeGetOut();e&&LH.beanChar(t.heroGroup,uH.robotBirthPoints[0]),t.heroGroup.points=LH.points[0],t.heroGroup.isLive=1,sH.stop(),NF.camPoint=null,sH.getInstance().autoMode=!1,NF.Ins().selectChar=null,uH.heroRelive(),yH.Ins().clear();var n=uH.robotBirthPoints[0];e&&null!=i&&(n=i),n=PB.tileToPixels(n);var s=uH.replaceModelPoints[0];s=new Uh(1790,1110);for(var o=0;o<uH.heroQueue.length;o++){var a=uH.heroQueue[o],r=t.heroGroup.points[o];if(4==a.hero_id?r=t.heroGroup.points[3]:1==a.profession?r=t.heroGroup.points[0]:2==a.profession?r=t.heroGroup.points[1]:3==a.profession&&(r=t.heroGroup.points[2]),a.visible=!0,a.type==Za.HERO){var l=PB.pixelsToTile(s.x,s.y),c=PB.pixelsToTile(n.x,n.y),u=a.ai.getPoint2(c);a.ai.stop(),a.toBookHeroTile(l.x,l.y),a.setXY(u.x,u.y),a.moveTo(r.x,r.y)}else a.setXY(n.x,n.y)}yH.Ins().mainCharMove(s,!1,ql.create(t,t.moveEndFunc)),t.delayCreatePlay(),T.isHeroRunInPlayGround=!0},t.moveEndFunc=function(){sH.getInstance().isStop=!1,sH.getInstance().autoMode=!1,G.timer.frameLoop(1,this,this.loop),NF.camPoint=NF.mainChar.point,NF.mainChar.faceTo(aH.boss),T.isReady=!0,T.isHeroRunInPlayGround=!1},t.beanBase=function(){if(this.myInfoData){for(var e=this.myInfoData.queue,t=0;t<e.length;t++){var i=e[t];i.isDog?pH.beanChar(i.char_id,uH.getHero(4)):pH.beanChar(i.char_id,uH.getHero(t+1))}e&&this.playgroundPlayerHash.put(gR.ins.charId,this.myInfoData.queue,!0),pH.beanChar(this.bossId,aH.boss)}},t.loop=function(){if(!T.isStop&&T.isReady){aH.boss&&null==aH.boss.parent&&NF.scene.addItem(aH.boss);var e=BB.getTimer();100<e-this.playTime&&(this.playTime=e,this.createPlayerGroup()),this.playBossZhabao(),this.playBossOwnerZhanBaoCheck(),this.playMyZhabao()}},t.playBossOwnerZhanBaoCheck=function(){this.zhanbaoQueue.length&&(aH.isZhanBaokMode||this.playBossOwnerZhanBao())},t.clear=function(){this.playerQueue.length=0,this.playerGroupArray.length=0,this.bossOwner=null,Object,this.myZhanBaoDataQueue.length=0,Object,this.bossZhanBaoDataQueue.length=0,Object,this.ownerZhanBaoDataQueue.length=0,pH.reset(),T.playerHash.reset()},t.playMyZhabao=function(){var e=this;e.isStopMy||(T.isFirstShowBool=!0,e.myZhanBaoDataQueue.length&&(e.myPlayData||(e.myPlayData=e.myZhanBaoDataQueue.shift()),e.myPlayData&&(e.playFight(e.myPlayData),e.myPlayData&&0==e.myPlayData.roundQueueData.length&&(e.myPlayData=null))))},t.playBossZhabao=function(){var e=this;e.bossZhanBaoDataQueue.length&&(e.bossPlayData||(e.bossPlayData=e.bossZhanBaoDataQueue.shift()),e.bossPlayData&&(e.playFight(e.bossPlayData),e.bossPlayData&&0==e.bossPlayData.roundQueueData.length&&(e.bossPlayData=null)))},t.playOwnerZhabao=function(){var e=this;e.ownerZhanBaoDataQueue.length&&(e.ownerPlayData||(e.ownerPlayData=e.ownerZhanBaoDataQueue.shift()),e.ownerPlayData&&(e.playFight(e.ownerPlayData),e.ownerPlayData&&0==e.ownerPlayData.roundQueueData.length&&(e.ownerPlayData=null)))},t.playFight=function(e){this.bossPlayData;var t=BB.getTimer();if(e.roundQueueData.length&&0<t-this.backpackdur){this.backpackdur=t;var i=e.roundQueueData.shift(),n=T.getChar(i.attacker),s=T.getChar(i.defender);n&&s&&0<i.skillId&&!s.isDeath&&(0<n.hero_id&&(n.lockMove=!1),oH.playSkill2(n,s,i.skillId));var o=0;if((i.att.length||i.buff.length)&&(i.att.length&&(s=T.getChar(i.att[0][0]),o=i.att[0][6]),null==s&&i.buff.length&&(s=T.getChar(i.buff[0][0]))),n&&i.hyArray.length&&!aH.isZhanBaokMode)for(var a=0;a<i.hyArray.length;a++){var r,l=i.hyArray[a];if(l.isAdd){var c=n.x+30,u=n.y-30;u=0==n.dir||1==n.dir||7==n.dir?(c=n.x+30,n.y+30):4==n.dir||3==n.dir||5==n.dir?(c=n.x+10,n.y+30):(c=2==n.dir?n.x+30:n.x-10,n.y-30),null==(r=T.huanyinQueue.take(l.char_id))&&(r=aH.createHYMonster(i.hyArray[a],c,u),T.huanyinQueue.put(l.char_id,r)),r.owner_char=n.char_id,pH.beanChar(l.char_id,r),sH.playHurtImage(800,l.professional)}else(r=T.huanyinQueue.remove(l.char_id))&&(pH.unbeanChar(l.char_id),r.removeReason.push("remove"),uH.Ins().removeChar(r))}if(s instanceof zwc.engine.core.displays.world.char.Char&&(modules.scene.proxys.SceneBossProxy.playHurt(i.att,i.buff,o),s.proto&&s.proto.hasOwnProperty("playerId")&&s.proto.playerId!=gR.ins.charId)){var d=this.takePlayerData(s.proto.playerId);d&&d.isPlayerAllDeath()&&this.removeGroupPlayer(d)}}},t.onMoveEndHander=function(){},t.getLivePlayData=function(){for(var e=0;e<this.playerQueue.length;e++){if(this.playerQueue[e].isLive)return this.playerQueue.shift()}return null},t.getLivePlayDataLength=function(){for(var e=0,t=0;t<this.playerQueue.length;t++){this.playerQueue[t].isLive&&e++}return e},t.removeGroupChar=function(e){for(var t,i=[],n=0;n<zN.charQueue.length;n++)(t=zN.charQueue[n])&&t.owner_char==e.toString()&&0<e&&i.push(t);for(var s=0;s<i.length;s++)(t=i[s]).removeReason=["clearChar"],uH.Ins().removeChar(t)},t.createPlayerGroup=function(){if(LH.hasFreeRobotData()&&this.getLivePlayDataLength()){var e=this.getLivePlayData(),t=e.playerId,i=e.queue,n=this.takePlayerData(t);if(n?this.removeGroupPlayer(n):this.removeGroupChar(t),i){var s=rH.GetPlayerGroupAI();s.attackValue=e.attackValue,s.isLive=e.isLive,s.setupAndPlay(i,uH.replaceModelPoints[0],aH.boss),this.playerGroupArray.push(s),this.playgroundPlayerHash.put(t,i,!0)}}},t.takePlayerData=function(e){for(var t=0;t<this.playerGroupArray.length;t++){var i=this.playerGroupArray[t];if(i.playerId.toString()==e.toString())return i}return null},t.setBossOwner=function(){if(this.bossOwner.charId.toString()==gR.ins.charId)aH.boss.faceTo(NF.mainChar);else for(var e=0;e<this.playerGroupArray.length;e++){var t=this.playerGroupArray[e];t.toString()==this.bossOwner.charId.toString()&&aH.boss.faceTo(t.player)}},t.stop=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].stop(),sH.stop()}T.isStop=!0},t.hide=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].hide()}},t.show=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].show()}},t.playZhanBao=function(e){NF.Ins().selectChar=null,aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,aH.getInstance().stop(),aH.clear(),T.clearHy(),aH.clearHy(),aH.getInstance().addDto(e)},T.enabled=function(){return!(T.isOwnerZhanbaoPlaying||T.waitPlayerIntoPlayGround||!T.isReady)},T.clearHy=function(){for(var e in T.huanyinQueue.proto){var t=T.huanyinQueue.remove(e);t&&(pH.unbeanChar(parseInt(e)),t.removeReason.push("remove"),uH.Ins().removeChar(t))}T.huanyinQueue.reset()},T.getChar=function(e){return pH.takeChar(e)},T.playHurt=function(e,t,i){if(void 0===i&&(i=0),!T.isStop){for(var n=0;n<e.length;n++){var s=e[n],o=s[0],a=s[1],r=s[2],l=s[3],c=s[4],u=T.getChar(o);u instanceof zwc.engine.core.displays.world.char.Char&&(u.setCharBoolValue(l),u.setCharBoolVisible(!0),u.visible||(u.visible=!0),u.objectId!=gR.ins.objectId&&u.type!=Za.HERO||(Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:u.currHp,heroId:u.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:c,heroId:u.hero_id})),u.doDelay(100,T,modules.scene.proxys.SceneBossProxy.addHurtImage,[u,r,a,i]),u.currHp<=0&&(u.type==Za.MAIN_CHAR||(u.type,Za.HERO),u.setDeath(),u.play("death")))}for(var d=0;d<t.length;d++){var h=t[d],_=h[0],f=h[1],p=h[2],g=T.getChar(_);switch(p){case 301:1==f?g.delayDo(100,g,g.setPoisoning,[!0]):g.delayDo(100,g,g.setPoisoning,[!1]);break;case 405:if(1==f){var v=g.proto;v&&g.setActSpeedUp(!0,v.accSpeed,1e4)}else{g.proto&&g.setActSpeedUp(!1)}break;case 401:1==f?nH.addBuff(g.char_id,7,0,100):nH.removeBuff(g.char_id,7)}}}},T.addHurtImage=function(e,t,i,n){if(void 0===i&&(i=0),void 0===n&&(n=0),!T.isStop&&e&&NB.isSceneReady&&!NB.isAllStop)if(34==i&&e.hero_id<=0)sH.playHurtImage(i,n);else{var s=hq.GetNew();s.type=i.toString(),s.toImage(t,i,n);var o=e.y;s.x=e.x,s.y=o,0==t?s.setStartY(o,5):1<i?s.setStartY(o,1):s.setStartY(o,0),e.type,Za.MONSTER,s.setOffsetX(e.x),s.startPlay(),s.owner=e,NF.scene.addHurtImage(s)}},T.createMonster=function(e,t,i,n){var s=e.modelId,o=hn.getIndex(s),a=hn.MODEL.muId(o);a=_n.getIndex(a);var r=uH.monsterDataHash.take(s);r||(r=JSON.parse(hn.MODEL.attributes(o)),uH.setMonsetAttributes(s,r));var l=_n.MODEL.avatarId(a);null==n&&(n=zN.GetChar());var c=_n.MODEL.awayEffect(a);return""!=c&&null!=c&&"0"!=c&&n.loadEffect(c,Za.LAYER_BODY_BOTTOM,c),n.cid=uH.Ins().currCid,n.selectEnabled=!1,ZN.updateCharDisplay(n,l),uH.Ins().addChar(n),n.type=Za.MONSTER,n._proto_=e,n.setXY(t,i),n.bodyHeight=_n.MODEL.avatarHeight(a),n.char_name=hn.MODEL.name(o),n.dir=8*Math.random()>>0,n.setCharBoolValue(e.currHP,e.maxHP),n.char_id=n.id,NF.scene.addItem(n),n},T.curFightModule=null,T.isOwnerZhanbaoPlaying=!1,T.waitPlayerIntoPlayGround=!1,T.isFirstShowBool=!1,T.isHeroRunInPlayGround=!1,T.stopEnabled=!1,T.isStop=!1,T.isReady=!1,f(T,["playerHash",function(){return this.playerHash=new jl},"huanyinQueue",function(){return this.huanyinQueue=new jl}]),T}(),sF=function(e){function r(){this.addQueue=[],this.startPoint=[new Uh(12,11),new Uh(17,18),new Uh(13,25)],this.list,r.__super.call(this),G.timer.frameLoop(1,this,this.loop)}b(r,"modules.scene.proxys.SceneDiggerProxy",bp);var t=r.prototype;return t.loop=function(){uH.Ins().currCid==_a.S_KUANGDONG.toString()&&NB.isSceneReady&&this.createChar()},t.subHandler=function(e){var t=this,i=0;switch(e.actionOrder){case"__DIGGER_ENTER__":sH.stop(),r.charQueue=[];var n=e.proto;i=(dr.dtoEnterScene=n).cid,NF.Ins().changeScene(i.toString(),!0,ql.create(t,t.onReadHandler));break;case"__DIGGER_EXIT__":t.addQueue.length=0,r.charQueue=[],aH.isZhanBaokMode=!1,(dr.dtoEnterScene=null)!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(t,t.exit));break;case"__DIGGER_RESET__":t.addQueue.length=0;case"__DIGGER_ADD__":t.addQueue.push(e.proto);break;case"__DIGGER_REMOVE__":t.removeChar(e.proto);break;case"__DIGGER_REFRESH__":t.refreshChar(e.proto);break;case"__DIGGER_ZHANBAO__":dr.dtoEnterScene=e.proto,t.playZhanBao(dr.dtoEnterScene.dtoZhanbao),uH.replaceModelPoints=ol.srotOn(uH.replaceModelPoints,"x");break;case"__DIGGER_ZHANBAO_START__":t.onDeggerStart();break;case"__ZHANBAO_PLAY_END__":dr.dtoEnterScene&&3==dr.dtoEnterScene.type&&t.playZhanBaoEnd()}},t.playZhanBaoEnd=function(){if(aH.getInstance().currDto){aH.enemyQueue.length=0;var e=aH.getInstance().currDto;aH.clear(),dr.dtoEnterScene=null,aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,1==e.result&&aH.getInstance().stop(),uH.heroRelive(),Tu.sendToModule("__ZHAOBAO_END__",["modules.digger.DiggerModule"],3)}},t.getMidPoint=function(){for(var e=[],t=0;t<this.startPoint.length;t++){var i=PB.tileToPixels(this.startPoint[t]),n=ol.distance(i,NF.mainChar.point);e.push({dis:n,p:this.startPoint[t]})}return(e=ol.srotOn(e,"dis"))[1].p},t.getTarPoint=function(e,t){var i=VB.getDretion(e.point.x,e.point.y,NF.mainChar.point.x,NF.mainChar.point.y),n=ZN.getTileDis(e.tilePoint,NF.mainChar.tilePoint),s=1;return 1<t&&(s=4),n<=s?e.point:VB.getTileByDir(e.tilePoint,i,n-s)},t.onDeggerStart=function(){for(var e=aH.enemyQueue,t=YH.instance.get8Grids(this.getMidPoint()),i=0;i<e.length;i++){var n=e[i];n.setXY(t[i].x,t[i].y);var s=this.getTarPoint(n,n.profession);n.isCharMode=!0,n.speed=400;var o=rH.GetCharAI();o.setup(n),rH.pushAI(o),i==e.length-1?o.actCtrl.moveTo(s,!1,ql.create(this,this.onReadyFunc)):o.actCtrl.moveTo(s)}},t.onReadyFunc=function(){aH.getInstance().start(),sH.stop()},t.playZhanBao=function(e){aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,aH.getInstance().stop(),aH.clear(),aH.getInstance().addDto(e)},t.refreshChar=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=r.charQueue[i.playerId];null!=n&&(0==i.mimeLeftTimes&&i.playerId!=gR.ins.charId?(delete r.charQueue[i.playerId],NF.scene.removeItem(n),zN.recoverChar(n)):i.canRob?n.showTopTexture(Wo.getRobTex(),0,-45):n.hideTopTexture())}},t.removeChar=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=r.charQueue[i];null!=n&&(delete r.charQueue[i],NF.scene.removeItem(n),zN.recoverChar(n))}},t.getPoint=function(e){void 0===e&&(e=0);var t=this.list[e];return new Uh(t.x,t.y)},t.getDir=function(e){return void 0===e&&(e=0),this.list[e].dir},t.createChar=function(){if(0<this.addQueue.length){var e,t=this.addQueue.pop();for(var i in t){e=t[i];var n=r.charQueue[e.playerId];if(n){var s=Wo.getMineMid(e.mimeQuality),o=Wo.getWeaponId();ZN.updateCharDisplay(n,s,o)}else n=r.createDigger(e,0,0),r.charQueue[e.playerId]=n}this.updatePlayer()}},t.updatePlayer=function(){var e,t=0;for(var i in r.charQueue)if(e=r.charQueue[i]){var n=e.data,s=this.getPoint(t),o=this.getDir(t);e.setXY(s.x,s.y),e.cid=uH.Ins().currCid;PB.pixelsAlginTile(s.x,s.y);n&&(n.playerId==gR.ins.charId?e.selectEnabled=!1:n.canRob?e.showTopTexture(Wo.getRobTex(),0,-45):e.hideTopTexture()),e.type=Za.DIGGER,e._proto_=n,e.setXY(s.x,s.y),e.bodyHeight=NB.BODY_HEIGHT,e.charNameColor=JR.instance.getMimeNameByQualityColor(n.mimeQuality),n&&(e.char_name=n.playerName+"的矿工"),e.charProfessionNameColor="#00ff00",n&&(e.charProfessionName=Jp.getENTickMS(n.getLeftTime())),e.setCharBoolValue(1e3,1e3),e.setCharBoolVisible(!1),e.setCharNameVisible(!0),e.setCharProfessionNameVisible(!0),n&&(e.char_id=Za.DIGGER+n.playerId),e._proto_=n,e.dir=o;var a=rH.GetNpcAI();a.setup(e),rH.pushAI(a),e.cid=uH.Ins().currCid,e.speed=280,NF.scene.addItem(e),t++}},t.exit=function(){sH.start()},t.onReadHandler=function(){sH.start(),sH.getInstance().autoMode=!1,this.list=yh.copyObjFast(uH.gkDto.arr[0]),this.list.shift()},r.createDigger=function(e,t,i,n){var s=Wo.getMineMid(e.mimeQuality),o=Wo.getWeaponId();return null==n&&(n=zN.GetChar()),n.cid=uH.Ins().currCid,n.isCharMode=!0,n.selectEnabled=!0,n.relive(),n.type=Za.DIGGER,n.data=e,ZN.updateCharDisplay(n,s,o),uH.Ins().addChar(n),n},r.charQueue=[],r}(),oF=function(e){function t(){this.playerQueue=[],this.playerGroupArray=[],t.__super.call(this)}b(t,"modules.scene.proxys.SceneGuildBossProxy",bp);var i=t.prototype;return i.subHandler=function(e){var t=0;switch(e.actionOrder){case"__ZHANBAO_PLAY_END__":if(dr.dtoEnterScene&&111!=dr.dtoEnterScene.type)return;break;case"__GUIDEBOSS_ZHANBAO__":break;case"__GUIDEBOSS_ENTER__":var i=e.proto;if(111!=i.type)return;sH.stop(),t=(dr.dtoEnterScene=i).cid,NF.Ins().changeScene(t.toString(),!0,ql.create(this,this.onReadyFunc));break;case"__GUIDEBOSS_EXIT__":if(dr.dtoEnterScene&&111!=dr.dtoEnterScene.type)return;aH.isZhanBaokMode=!1,BB.IsModePVE=!0,(dr.dtoEnterScene=null)!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(this,this.exit))}},i.exit=function(){NF.camPoint=null,this.playerQueue.length=0,sH.start()},i.onReadyFunc=function(){this.playerGroupArray.length=0,aH.getInstance().stop(),sH.stop();var e=uH.robotBirthPoints[0];e=PB.tileToPixels(e),uH.robotBirthPoints.shift(),LH.setupRobotDatas(uH.robotBirthPoints);var t=dr.dtoEnterScene.monsterId,i=hn.getIndex(t),n=hn.MODEL.muId(i);n=_n.getIndex(n);var s=uH.monsterDataHash.take(t);s||(s=JSON.parse(hn.MODEL.attributes(i)),uH.setMonsetAttributes(t,s)),aH.boss.setCharBoolValue(99999999,99999999),aH.boss.setCharBoolVisible(!1),aH.boss.setCharNameVisible(!1);var o=_n.MODEL.avatarId(n);aH.boss.char_name=hn.MODEL.name(i),aH.boss.type=Za.MONSTER,aH.boss.selectEnabled=!0,aH.boss.isBoss=!0,aH.boss.isUpdateBool=!1,ZN.updateCharDisplay(aH.boss,o),aH.boss.play("stand"),aH.boss.dir=5;var a=rH.GetNpcAI();a.setup(aH.boss),a.start(),rH.pushAI(a),NF.scene.addItem(aH.boss);var r=uH.replaceModelPoints[0];r||(r=new Uh(1749,1117));for(var l=0;l<uH.heroQueue.length;l++){var c=uH.heroQueue[l];if(c.type==Za.HERO){var u=uH.getHeroPoint(c,PB.pixelsToTile(r.x,r.y)),d=uH.getHeroPoint(c,PB.pixelsToTile(e.x,e.y));c.setXY(d.x,d.y),c.moveTo(u.x,u.y)}else c.setXY(e.x,e.y)}yH.Ins().mainCharMove(r,!1,ql.create(this,this.moveEndFunc))},i.moveEndFunc=function(){sH.start(),this.createPlayerGroup(),G.timer.loop(4e3,this,this.createPlayerGroup,null,!1),NF.camPoint=NF.mainChar.point},i.createPlayerGroup=function(){if(LH.hasFreeRobotData()&&this.playerQueue.length){var e=this.playerQueue.shift();if(e){var t=rH.GetPlayerGroupAI();t.setupAndPlay(e,uH.replaceModelPoints[0],aH.boss),this.playerGroupArray.push(t)}}},t}(),aF=function(e){function H(){this.isStartPlayZhanBao=!1,this.personMoveEnd=!1,this.isOnReaded=!1,H.__super.call(this)}b(H,"modules.scene.proxys.SceneMainProxy",bp);var t=H.prototype;return t.subHandler=function(e){var t=this,i=0;switch(e.actionOrder){case"10306":var n=e.proto;NF.Ins().changeScene(n.cid.toString());break;case"13501":e.proto;if(uH.Ins().currCid==_a.S_BIQI.toString()){var s=uH.getHero(gR.ins.showId);gR.ins.showId.toString()==gR.ins.charId?ZN.setCharTitle(NF.mainChar,NF.mainChar.proto.titles):s&&ZN.setCharTitle(NF.mainChar,s.proto.titles)}else for(var o=0;o<uH.heroQueue.length;o++){var a=uH.heroQueue[o];if(a&&a.hero_id<=3){var r=gR.ins.actorById(a.hero_id);ZN.setCharTitle(a,r.titles)}}break;case"resize":t.onResize();break;case"do_chat":break;case"MAX_HP_CHANGE":var l=e.proto,c=uH.getHero(l);if(ZN.isSynchScene()){if(0==!aH.isZhanBaokMode&&c){for(var u=0,d=0,h=0;h<gR.ins.actorList.length;h++){var _=gR.ins.actorList[h];4!=_.id&&(u+=_.currHP,d+=_.maxHP)}c.setCharBoolValue(u,d)}}else if(c){var f=gR.ins.actorList[c.hero_id-1];4!=f.id&&(c._proto_.currHP=f.currHP,c._proto_.maxHP=f.maxHP,c.setCharBoolValue(f.maxHP,f.maxHP))}break;case"10208":var p=e.proto,g=uH.getHero(p.charIndex);uH.Ins().currCid==_a.S_BIQI.toString()&&p.charId==gR.ins.charId?gR.ins.showId==p.charIndex?(ZN.updateCharDisplay(NF.mainChar,p.avatorId,p.weaponId,p.wingId,p.weaponSoulId,p.chuanshiSuitID,p.magicSuitId,p.dragonEff),ZN.setCharTitle(NF.mainChar,g.proto.titles)):(g=uF.charQueue.take(p.charId))&&(ZN.updateCharDisplay(g,p.avatorId,p.weaponId,p.wingId,p.weaponSoulId,p.chuanshiSuitID,p.magicSuitId,p.dragonEff),ZN.setCharTitle(g,g.proto.titles)):g&&(ZN.updateCharDisplay(g,p.avatorId,p.weaponId,p.wingId,p.weaponSoulId,p.chuanshiSuitID,p.magicSuitId,p.dragonEff),ZN.setCharTitle(g,g.proto.titles));break;case"LEARN_SUMMON_SKILL":uH.Ins().createDogHero(NF.mainChar,4);break;case"ADD_PET":if(-1==gR.ins.petIndex)return;if(BB.isShaozhu())return;if(0<=_a.S_COPY_AUTO_FIGHT.indexOf(uH.Ins().currCid+"")||2==uH.Ins().currCkType)uH.Ins().createPetHero();else{var v=5+gR.ins.charId;uH.heroHash.take(v)&&uH.Ins().updatePetHero()}break;case"HIDE_PET":uH.Ins().hidePetHero();break;case"ADD_YUANSHEN":uH.Ins().createYuanshenHero(e.proto);break;case"10204":var m=e.proto.newActor,y=uH.Ins().createHero(m.id,NF.mainChar,m);uH.Ins().currCid==_a.S_BIQI.toString()&&y&&(y.visible=!1);break;case"10109":break;case"24002":var I=e.proto;if(1==I.index){gR.ins.controlobjId=gR.ins.objectId=e.proto.objectId;var b=uH.yuanshenHash.take(0),w=uH.Ins().isGetHero(b);w&&(uH.yuanshenHash.put(gR.ins.objectId,w.objectId),uH.yuanshenHash.remove(0),w.char_id=w.objectId+gR.ins.objectId.toString())}gR.ins.setObjectId(I.index,I.objectId),uH.updateHeroObjectId(I.index,I.objectId);break;case"24030":var x=e.proto;NF.mainCtrlIndex=x.index-1,NF.isFirst||2!=uH.Ins().currCkType&&6!=uH.Ins().currCkType&&-1==_a.S_COPY_AUTO_FIGHT.indexOf(uH.Ins().currCid)&&NF.changeCtrlChar(x.index-1),NF.isFirst=!1;var S=gR.ins.actorList[NF.mainCtrlIndex].job,k="";1==S?k="战士":2==S?k="法师":3==S&&(k="道士"),tr.push(RP.n[222]+NF.mainCtrlIndex+RP.n[223]+k+"]");break;case"PIG_STOP":sH.stop();break;case"PIG_START":sH.start();break;case"__ZHANBAO_START__":if(!dr.dtoEnterScene)return;if(10==dr.dtoEnterScene.type)return;if(9==dr.dtoEnterScene.type)return;if(111==dr.dtoEnterScene.type)return;5!=e.proto&&(t.isStartPlayZhanBao=!0,G.timer.loop(100,t,t.checkZhanBaoPlay));break;case"__ZHANBAO_PLAY_END__":if(!dr.dtoEnterScene)return;if(dr.dtoEnterScene.dtoZhanbao&&(12==dr.dtoEnterScene.type||13==dr.dtoEnterScene.type))return;if(10==dr.dtoEnterScene.type)return;if(9==dr.dtoEnterScene.type)return;if(111==dr.dtoEnterScene.type)return;if(3==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&7==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&49==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&14==dr.dtoEnterScene.type)return;1!=dr.dtoEnterScene.type&&11!=dr.dtoEnterScene.type||H.playZhanBaoEnd();break;case"PIG_SKILL":t.PigSkill();break;case"PIG_END":null!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(t,t.exitPig));break;case"10206":NF.mainChar.loadEffect("jm0075");var E=e.proto;E&&0<E.lv&&UB.ins.playSound("Uplv");break;case"10309":1==e.proto.cid&&(BR.ins.toc10309=e.proto);var T=BR.ins.curCopyId;rn.getIndex(T);NF.Ins().changeClearAll();break;case"24038":e.proto&&NF.Ins().startChangeScene();break;case"__SCENE_CHANGED__":break;case"ENTER_INTER":var C=e.proto;sH.stop(),i=(dr.dtoEnterScene=C).cid,2==dr.dtoEnterScene.type?NF.Ins().changeScene(i.toString(),!1,ql.create(H,modules.scene.proxys.SceneMainProxy.onReadForYeZhanHandler),null,dr.dtoEnterScene.type):(t.isOnReaded=!1,NF.Ins().changeScene(i.toString(),!1,ql.create(t,t.onReadHandler),null,dr.dtoEnterScene.type));break;case"LIST_UPDATE":if(2!=uH.Ins().currCkType)return;H.isYeZhanUpDate=!0,H.createYeZhanChar();break;case"START_JINGJI":t.jingjiStart();break;case"EXIT_INTER":if(1==LN.isShowPop&&(LN.isShowPop=!1),dr.dtoEnterScene&&9==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&111==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&10==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&7==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&49==dr.dtoEnterScene.type)return;if(dr.dtoEnterScene&&14==dr.dtoEnterScene.type)return;H.exit(e.proto);break;case"__SHOW_PICKUP_ITEMS__":sH.start(),sH.getInstance().autoMode=!0,uH.heroRelive(),7==uH.Ins().currCkType&&H.showSceneItem(e.proto.cid,e.proto.items);break;case"13003":var L=e.proto;ZN.isEnabledChangeScene()&&(H.showSceneItem(parseInt(uH.Ins().currCid),L.items,null,4,!0),uH.isWait13003=!1,yH.Ins().clear(),NF.Ins().selectChar=null);break;case"GUILD_CHANGE":ZN.updateMainCharName();break;case"12902":var M=e.proto,A=!1,D="";D=0==M.status?(A=!1,""):(A=!0,M.guildName);for(var O=0;O<uH.heroQueue.length;O++){var P=uH.heroQueue[O];P&&(P.setCharProfessionNameVisible(A),P.charProfessionName=D)}break;case"HIDE_MYSELF":BB.heidOtherHeroMode=ER.ins.hideMe;break;case"HIDE_OTHER":var R=BB.heidOtherCharMode;BB.heidOtherCharMode=ER.ins.hideOther,R&&0==BB.heidOtherCharMode?ER.ins.goOnAvatarResourceLoad():1==BB.heidOtherCharMode&&ER.ins.clearHideOtherAvatarTexture();break;case"APP_ONFOCUS":break;case"24017":var N=e.proto;N&&(IH.ins.unionUseTime=N.nextCastTime,IH.ins.unionCD_Server=N.cd);break;case"24016":var B=e.proto;B&&(ER.ins.isClickedHeJi&&gR.ins.hasZhuiJi()&&Tu.sendToModule("USE_HEJI_BACK",["modules.nav.NavModule"]),ER.ins.isClickedHeJi=!1,IH.ins.unionUseTime=B.nextCastTime,0<IH.ins.unionUseTime&&B.nextCastTime-dr.curServerTime<1e4?IH.ins.unionCD=24e3:IH.ins.unionCD=IH.ins.unionCD_Server);break;case"NIEPANTASK":hN.ins.close("NIEPAN_MAIN_VIEW"),hN.ins.isOpen("NiepanNpcTalk")&&hN.ins.close("NiepanNpcTalk"),NF.Ins().changeScene("1",!0),G.timer.once(1e3,t,t.niepanWalk)}},t.niepanWalk=function(){var e;if(ON.ins.checkNiepan()){var t=ON.ins.getNiepanNpcPoint();e=new Uh(80*t[0],40*t[1])}else{var i=ON.ins.getTaskNpcPoint();e=new Uh(80*i[0],40*i[1])}for(var n=1;n<=3;n++){var s=uH.getHero(n);if(s)new NH(s).moveTo(e)}yH.Ins().clear(),yH.Ins().mainCharMove(e,!1,ql.create(this,this.openTips),!1)},t.openTips=function(){hN.ins.open("NiepanNpcTalk"),NF.mainChar._CharMoveEnd_=null},t.chengPersonPlay=function(){var e=this;null!=dr.dtoEnterScene&&0!=dr.dtoEnterScene.type&&(6!=dr.dtoEnterScene.type&&15!=dr.dtoEnterScene.type||(e.isOnReaded?0==e.personMoveEnd&&0==NF.mainChar.isRuning&&(sH.stop(),e.runIntoPlayGround(ql.create(e,e.dealyMove))):0==e.personMoveEnd&&0==NF.mainChar.isRuning?e.onReadHandler():e.personMoveEnd&&G.timer.clear(e,e.chengPersonPlay)))},t.checkZhanBaoPlay=function(){this.isStartPlayZhanBao&&dr.dtoEnterScene&&(this.isStartPlayZhanBao=!1,6==dr.dtoEnterScene.type?this.personMoveEnd&&(aH.getInstance().start(),sH.stop(),G.timer.clear(this,this.checkZhanBaoPlay)):(aH.getInstance().start(),sH.stop()))},t.PigSkill=function(){if(3==uH.Ins().currCkType&&0==sH.getInstance().isStop){UB.ins.playSound("99999"),oH.playScopeSkill("mjn40011",NF.mainChar.tilePoint);for(var e=zN.charQueue.slice(),t=[],i=0;i<e.length;i++){var n=e[i];if(n.type==Za.MONSTER){sH.onHurt([n],9999999,4,!1,NF.mainChar.profession);var s=n.point;s=NF.scene.localToGlobal(s),t.push(s)}}}},t.exitPig=function(){sH.start()},t.onBIQI=function(e){if(1==e.cid){var t=gR.ins.actorById(gR.ins.showId);ZN.updateCharDisplayByVo(NF.mainChar,t),ZN.setCharTitle(NF.mainChar,t.titles)}NF.mainChar.setXY(e.x,e.y);for(var i=uH.heroQueue,n=0;n<i.length;n++){var s=i[n];1!=s.hero_id&&(s.visible=!1)}gF.TARGETHANDLER&&(gF.TARGETHANDLER.run(),gF.TARGETHANDLER=null)},t.dealyMove=function(){this.personMoveEnd=!0,aH.getInstance().addDto(dr.dtoEnterScene.dtoZhanbao),aH.getInstance().start()},t.jingjiStart=function(){for(var e=new Uh(2035,900),t=0;t<aH.enemyQueue.length;t++){var i=aH.enemyQueue[t];if(i){i.speed=280,i.setXY(e.x,e.y),i.isCharMode=!0;var n=Za.SceneArenaPoints[t];n=1==i.profession?Za.SceneArenaPoints[0]:2==i.profession?Za.SceneArenaPoints[1]:3==i.profession?Za.SceneArenaPoints[2]:Za.SceneArenaPoints[3],i.moveTo(n.x,n.y)}}for(var s=new Uh(1635,1185),o=0;o<uH.heroQueue.length;o++){var a=uH.heroQueue[o];if(s=1==a.profession?ZN.points_JJC[0]:2==i.profession?ZN.points_JJC[1]:3==i.profession?ZN.points_JJC[2]:ZN.points_JJC[3],a)if(0==o)a.setXY(1179,1414),yH.Ins().mainCharMove(s,!1,ql.create(aH.getInstance(),aH.getInstance().start));else{var r=new Uh(1179,1414),l=PB.pixelsToTile(s.x,s.y),c=a.ai.getPoint2(l);c=s;var u=PB.pixelsToTile(r.x,r.y),d=a.ai.getPoint2(u);a.ai.stop(),a.toBookHeroTile(l.x,l.y),a.setXY(d.x,d.y),a.moveTo(c.x,c.y)}}},t.onReadHandler=function(){this.isOnReaded=!1,dr.dtoEnterScene&&(6==dr.dtoEnterScene.type||7==dr.dtoEnterScene.type||49==dr.dtoEnterScene.type||9==dr.dtoEnterScene.type||11==dr.dtoEnterScene.type||1==dr.dtoEnterScene.type||14==dr.dtoEnterScene.type||20==dr.dtoEnterScene.type||21==dr.dtoEnterScene.type||17==dr.dtoEnterScene.type||18==dr.dtoEnterScene.type||40==dr.dtoEnterScene.type||17==dr.dtoEnterScene.type||22==dr.dtoEnterScene.type||15==dr.dtoEnterScene.type||5==dr.dtoEnterScene.type||23==dr.dtoEnterScene.type||12==dr.dtoEnterScene.type||24==dr.dtoEnterScene.type||31==dr.dtoEnterScene.type||25==dr.dtoEnterScene.type||26==dr.dtoEnterScene.type||27==dr.dtoEnterScene.type||29==dr.dtoEnterScene.type||34==dr.dtoEnterScene.type||32==dr.dtoEnterScene.type||41==dr.dtoEnterScene.type||42==dr.dtoEnterScene.type||43==dr.dtoEnterScene.type||44==dr.dtoEnterScene.type||46==dr.dtoEnterScene.type||45==dr.dtoEnterScene.type||47==dr.dtoEnterScene.type||50==dr.dtoEnterScene.type||51==dr.dtoEnterScene.type||52==dr.dtoEnterScene.type||53==dr.dtoEnterScene.type||54==dr.dtoEnterScene.type||56==dr.dtoEnterScene.type||57==dr.dtoEnterScene.type||58==dr.dtoEnterScene.type?(this.personMoveEnd=!1,sH.stop(),53!=dr.dtoEnterScene.type&&sH.startInstantFight(),15==dr.dtoEnterScene.type&&UR.instance.clearBatch(),NF.changeCtrlChar(NF.mainCtrlIndex)):4==dr.dtoEnterScene.type||(2==dr.dtoEnterScene.type?(aH.boss=NF.Ins().selectChar,aH.getInstance().addDto(dr.dtoEnterScene.dtoZhanbao),aH.getInstance().start(),G.timer.once(1200,this,this.timeoutAI)):aH.isZhanBaokMode?(NF.mainChar.faceTo(aH.boss),aH.boss.faceTo(NF.mainChar)):(G.timer.once(1200,this,this.timeoutAI),sH.start())))},t.timeoutAI=function(){uH.Ins().showDogHero(),uH.Ins().updateHeroAI()},t.moveEndFunc=function(e){e.faceTo(aH.boss)},t.runIntoPlayGround=function(e){var t=aH.boss;t.dir=5;var i=VB.getTileByDir(t.tilePoint,5,1);i=VB.getTileByDir(t.tilePoint,5,1);for(var n=ZN.points_TQG,s=0;s<uH.heroQueue.length;s++){var o=uH.heroQueue[s];if(o)if(0<o.currHp&&o.relive(!0),1==dr.dtoEnterScene.type&&(4==o.hero_id?i=n[3]:1==o.profession?i=n[0]:2==o.profession?i=n[1]:3==o.profession&&(i=n[2])),o==NF.mainChar)yH.Ins().mainCharMove(i,!1,e);else{o.ai.actCtrl.clearAll();var a=o.ai.getPoint();o.setXY(a.x,a.y),1!=dr.dtoEnterScene.type&&(i=o.ai.getPoint(PB.pixelsToTile(i.x,i.y),1)),o.ai.actCtrl.moveTo(i,!1,ql.create(this,this.moveEndFunc,[o]))}}},t.onResize=function(){NF.Ins().onResize()},p(1,H,"onYeZhaning",function(){return H._onYeZhaning},function(e){H._onYeZhaning=e}),H.showPickupItems=function(e){H.updatePickuptime(),sH.start(),sH.getInstance().autoMode=!0,uH.heroRelive(),H.showSceneItem(dr.dtoEnterScene.cid,dr.dtoEnterScene.dtoZhanbao.items,e,4)},H.playZhanBaoEnd=function(){if(aH.getInstance().currDto){var e=aH.getInstance().currDto;if(null!=dr.dtoEnterScene){if(1==dr.dtoEnterScene.type||11==dr.dtoEnterScene.type){if(0==e.items.length)aH.getInstance().stop(),sH.stop(),sH.getInstance().autoMode=!1,11==dr.dtoEnterScene.type?Tu.sendToModule("__ZHAOBAO_END__",["modules.guild.GuildModule"],dr.dtoEnterScene.type):Tu.sendToModule("__ZHAOBAO_END__",["modules.copy.CopyModule"],dr.dtoEnterScene.type);else if(1==dr.dtoEnterScene.type)Tu.sendToModule("__ZHAOBAO_END__",["modules.copy.CopyModule"],dr.dtoEnterScene.type);else{NF.mainChar.lockSkill=!0;var t=new Uh(24,19);11==dr.dtoEnterScene.type&&(t=new Uh(22,26)),H.showPickupItems(t)}return}if(Tu.sendToTotalModule("__ZHAOBAO_END__",dr.dtoEnterScene.type),2==dr.dtoEnterScene.type||6==dr.dtoEnterScene.type||15==dr.dtoEnterScene.type){if(e.items.length)H.showPickupItems();else{2==dr.dtoEnterScene.type&&Tu.sendToModule("__PICKUP_OVER__",["modules.field.FieldModule"]);for(var i=0;i<uH.heroQueue.length;i++){var n=uH.heroQueue[i];n!=NF.mainChar&&n.ai&&n.ai.start()}}return}}uH.Ins().clear(),aH.clear(),dr.dtoEnterScene=null,aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,1==e.result&&aH.getInstance().stop()}},H.updatePickuptime=function(){H.pickuptime=BB.getTimer()},H.doPickUp=function(e,t,i,n){void 0===n&&(n=!1);var s=BB.getTimer();if((!(s-H.pickuptime<500)||n)&&(H.pickuptime=s,(sH.getInstance().autoMode||n)&&e&&(e&&"Char"!=_s.getQualifiedClassName(e)&&e.type==Za.PICKUP_GOLD&&zB.ins.playGetItems([e.proto]),uH.Ins().removePickItem(e),NF.Ins().selectChar=null,UB.ins._playPickupSound(e.proto),zN.enabledPickupQueueLength2<=0))){var o=t,a=i;7==a?(sH.getInstance().autoMode=!1,Tu.sendToModule("__PICKUP_OVER__",["modules.copy.CopyModule"],dr.dtoEnterScene.type)):8==a?(sH.getInstance().autoMode=!1,Tu.sendToModule("__PICKUP_OVER__",["modules.boss.BossModule"],dr.dtoEnterScene.type)):2==a?e.type==Za.PICKUP_GOLD?uH.Ins().playNextScene():Tu.sendToModule("__PICKUP_OVER__",["modules.field.FieldModule"]):o==_a.S_TIANGUAN.toString()?(aH.getInstance().stop(),sH.stop(),sH.getInstance().autoMode=!1,Tu.sendToModule("__ZHAOBAO_END__",["modules.tianguan.TianguanModule"],1)):o==_a.S_GUILD_MJ.toString()?(aH.getInstance().stop(),sH.stop(),sH.getInstance().autoMode=!1,Tu.sendToModule("__ZHAOBAO_END__",["modules.guild.GuildModule"],11)):30==a&&Tu.sendToModule("PICK_UP_All_END",["modules.scene.SceneModule"]),dr.dtoEnterScene&&10==dr.dtoEnterScene.type&&Tu.sendToModule("__PICKUP_OVER__",["modules.scene.SceneModule"],dr.dtoEnterScene.type)}},H.createYeZhanChar=function(){if(H.isYeZhanUpDate){H.isYeZhanUpDate=!1;for(var e=0;e<uH.hookCharQueue.length;e++)uH.hookCharQueue[e].removeReason=["remove"],uH.Ins().removeChar(uH.hookCharQueue[e]);for(var t=0;t<H.monsterRobot.length;t++)H.monsterRobot[t].removeReason=["remove"],uH.Ins().removeChar(H.monsterRobot[t]);H.monsterRobot.length=0,uH.hookCharQueue.length=0;var i=ZB.ins.playerArr;if(0<i.length)for(var n=0;n<i.length;n++){var s=i[n];if(s&&uH.replaceModelPoints.length&&n<uH.replaceModelPoints.length){var o=uH.replaceModelPoints[n],a=uH.replaceModelDir[n],r=uH.Ins().createChar(s.playerId,o,s);ZN.setCharTitle(r,s.titles),r.charNameColor="#e3dcc2",r.dir=a,r.ai&&(r.ai.stop(),rH.removeAI(r));var l=rH.GetRobotAI();l.setup(r),rH.pushAI(l),l.start(),-1==uH.hookCharQueue.indexOf(r)&&uH.hookCharQueue.push(r);var c=YH.instance.get8Grids(r.tilePoint,1);if(c.length){var u=zN.GetChar();u.type=Za.ROBOT,u.selectEnabled=!1,u.cid=uH.Ins().currCid,u.isCharMode=!1,u.setCharBoolVisible(!1),u.setCharNameVisible(!1),u.scaleX=u.scaleY=1.3;var d,h=uH.currSceneMonsters[uH.currSceneMonsters.length*Math.random()>>0],_=hn.getIndex(h),f=hn.MODEL.muId(_);f=_n.getIndex(f),d=_n.MODEL.avatarId(f),u.char_id=Ee.getSoleId(),ZN.updateCharDisplay(u,d);var p=c[Math.random()*c.length>>0];u.setXY(p.x,p.y),u.faceTo(r);var g=rH.GetRobotAI();g.setup(u),rH.pushAI(g),g.start(),uH.Ins().addChar(u),NF.scene.addItem(u),(r.selectTarget=u).selectTarget=r,H.monsterRobot.push(u),r.faceTo(u),u.faceTo(r)}}}}},H.onReadForYeZhanHandler=function(){if(dr.dtoEnterScene){H.createYeZhanChar();for(var e=ZB.ins.playerArr,t=0;t<e.length;t++){var i=e[t];if(null==dr.dtoEnterScene||dr.dtoEnterScene.monsterId==i.playerId){var n=zN.getChar(i.playerId.toString()),s=uH.Ins().findNearReplacePoint();if(n?(uH.Ins().createChar(i.playerId,s,i,n),n.setXY(s.x,s.y)):n=uH.Ins().createChar(i.playerId,s,i),ZN.setCharTitle(n,i.titles),dr.dtoEnterScene){aH.boss=n,NF.Ins().selectChar=aH.boss;var o=YN.getCharNearPt(n);NF.mainChar.setXY(o.x,o.y),NF.Ins().heidBeside(aH.boss);for(var a=0;a<uH.heroQueue.length;a++){var r=uH.heroQueue[a];r&&r!=NF.mainChar&&(r.stopMove(),r.ai.stop(),o=YN.getCharNearPt(r),r.setXY(o.x,o.y))}}}}dr.dtoEnterScene?(sH.stop(),aH.boss=NF.Ins().selectChar,aH.getInstance().addDto(dr.dtoEnterScene.dtoZhanbao),aH.getInstance().start(),H.onYeZhaning=!0):sH.start()}},H.onOverForFirePigHandler=function(){hN.ins.open("PIG_FIRE_RESULT")},H.onOpenCopyView=function(){modules.copy.others.NewPigData.alertedFv?modules.copy.others.NewPigData.alertedFv=!1:Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:1})},H.callbackYeZhan=function(){aH.boss&&uH.Ins().removeChar(aH.boss),uH.HerostopNow(),uH.heroRelive(),BB.IsModePVE=!0,dr.dtoEnterScene=null,aH.clear(),aH.isZhanBaokMode=!1,aH.boss=null,aH.getInstance().stop(),aH.getInstance().currDto=null,sH.getInstance().isStop=!1,sH.getInstance().autoMode=!0,NF.Ins().selectChar=null;for(var e=0;e<uH.heroQueue.length;e++){var t=uH.heroQueue[e];t&&t!=NF.mainChar&&t.ai.start()}NF.selectIndex=uH.Ins().findAndSetNearLevelIndex(),NF.Ins().changeScene(uH.Ins().currCid,!1,ql.create(H,modules.scene.proxys.SceneMainProxy.resetYeZhan)),H.onYeZhaning=!1},H.resetYeZhan=function(){H.createYeZhanChar(),sH.start()},H.showSceneItem=function(e,t,i,n,s){void 0===n&&(n=4),void 0===s&&(s=!1),e.toString()==uH.Ins().currCid&&t.length&&(sH.pickItems=t,null==i&&(i=uH.killPoint),uH.addPickItem(i,t,n,s),sH.start(),aH.isZhanBaokMode=!1,UB.ins.playSound(90006),50<=gR.ins.lv&&(2==uH.Ins().currCkType||8==uH.Ins().currCkType||7==uH.Ins().currCkType||uH.Ins().currCid==_a.S_TIANGUAN.toString())&&(NF.mainChar.lockSkill=!0,G.timer.once(700,H,modules.scene.proxys.SceneMainProxy.pickupAll,[uH.Ins().currCid,uH.Ins().currCkType])))},H.pickupAll=function(e,t){for(var i=[],n=zN.pickUpQueue,s=0;s<n.length;s++){var o=n[s];if(o&&(o.type==Za.PICKUP_GOLD||o.type==Za.PICKUP_ITEM)){o.selectEnabled=!0,o==NF.Ins().selectChar&&(NF.Ins().selectChar=null);var a=150*ZN.getTileDis(o.tilePoint,NF.mainChar.tilePoint);600<a&&(a=600),Og.to(o,{x:NF.mainChar.x,y:NF.mainChar.y-40,alpha:0},a,null,ql.create(o,o.clearTweenFunc)),i.push(o)}}NF.mainChar.lockSkill=!0,G.timer.once(510,H,modules.scene.proxys.SceneMainProxy.pickupAllPart2,[i,e,t])},H.pickupAllPart2=function(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];s&&modules.scene.proxys.SceneMainProxy.doPickUp(s,t,i,!0)}},H.exit=function(e){dr.dtoEnterScene=null,2==e.type?H.callbackYeZhan():(H.tianGuanInit=!1,uH.Ins().clear(),dr.dtoEnterScene=null,aH.getInstance().stop(),aH.isZhanBaokMode=!1,aH.clear(),BB.IsModePVE=!0,aH.boss=null,"5001"==uH.Ins().recordCid?(modules.copy.others.NewPigData.ins.isOut?NF.Ins().changeScene(uH.Ins().prveCid,!0,null,ql.create(H,modules.scene.proxys.SceneMainProxy.onOverForFirePigHandler)):NF.Ins().changeScene(uH.Ins().prveCid,!0,null,ql.create(H,modules.scene.proxys.SceneMainProxy.onOpenCopyView)),modules.copy.others.NewPigData.ins.isOut=!1):null!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid)),uH.heroRelive(),aH.getInstance().currDto=null,0<hg.ins.getLeftTime()&&BR.ins.reqAutoChallenge()},H.isYeZhanUpDate=!0,H.heroPoints=[],H.pickuptime=0,H.monsterRobot=[],H._onYeZhaning=!1,H.tianGuanInit=!1,H}(),rF=function(e){function t(){this._lastDeadOtherHero=null,this.toc30004=null,this.saveToc30004=null,this.toc30785,t.__super.call(this)}b(t,"modules.scene.proxys.SceneMissionProxy",bp);var i=t.prototype;return i.subHandler=function(e){var t,i=this,n=0;switch(e.actionOrder){case"25000":ER.ins.isClickedHeJi=!1,$R.isFaildLink=!1;var s=e.proto;BR.ins.toc25000=s,BR.ins.curCopyId=s.copyId,n=rn.getIndex(s.copyId),t=rn.MODEL.cate(n),NF.Ins().changeClearAll(),zN.clearSceneMonster();var o=_r.getLayoutsPath("mission");if(G.loader.getRes(o))i.onLoad();else GB.retain(o).once("complete",i,i.onLoad,[o]);break;case"30004":var a=e.proto;i.toc30004=a;var r=200;n=rn.getIndex(a.missionId),23==(t=rn.MODEL.cate(n))&&(r=1e3),G.timer.once(r,i,i.timeOutOpenSucc,[a,!1]),tr.push(RP.n[224]+t);break;case"22613":if(n=rn.getIndex(BR.ins.curCopyId),20==(t=rn.MODEL.cate(n))||21==t)return i.shengyuRewardToScene(e.proto),i.onExitCopy_Common(!1),void sJ.ins.hideCompoment("NavTargetHead");if(30==t&&(VR.ins.toc22613=e.proto,e.proto.playerName==gR.ins.charName))return void i.shengyuRewardToScene(e.proto,!0);var l=e.proto;G.timer.once(1500,i,i.timeOutOpenCommSucc,[l,!1]),tr.push(RP.n[225]+t);break;case"30785":i.toc30785=e.proto,i.kunShowRewardToScene(i.toc30785);break;case"CATE_1_END":i.mission1End();break;case"CATE_27_END":i.mission27End();break;case"PICK_UP_All_END":var c=BR.ins.curCopyId;switch(n=rn.getIndex(c),t=rn.MODEL.cate(n),tr.push("：run Scene_InternalOrder.PICK_UP_All_END:"+t),t){case 2:return void(0<=BR.ins.checkPersonHasFirstKillReward(c)&&BR.ins.bossPersonHash&&0==BR.ins.bossPersonHash.take(c).passTimes?Tu.sendToModule("PERSON_FIRST_SKILL",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(i,i.onExitCate2,[{award:sH.pickItems}])}):Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(i,i.onExitCate2,[{award:sH.pickItems}])}));case 29:Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(i,i.onExitCate29,[{award:sH.pickItems}])});break;case 15:return void i.onExitCate15();case 24:case 25:return void G.timer.once(1e3,i,i.moveToDigger);case 30:return BR.ins.copyEnd=!0,void hN.ins.open("BOSS_GOD_SETTLE",VR.ins.toc22613);case 22:tr.push(RP.n[226]),Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(i,i.openFieldView,[{award:sH.pickItems}])});break;case 14:i.onExitCate14(i.saveToc30004);break;case 8:i.onExitCate8(i.toc30004);break;case 54:hN.ins.open("BOSS_KUN_SUCCESS",i.toc30785);break;case 58:Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(i,i.onExitCate2,[{award:sH.pickItems}]),cate:58})}break;case"BOSS_HUNDUN_START":if(null!=BR.ins.bossHuDunData){var u=BR.ins.bossHuDunData.objectid,d=uF.charQueue.take(u);null!=d&&d.data instanceof protos.scene.DtoCharData&&Tu.sendToModule("NAV_UPDATE_BOSS_BUFF_START_1",["modules.nav.NavModule"])}break;case"24013":var h=e.proto;BR.ins.bossHuDunData=h;var _=uF.charQueue.take(h.objectid);if(null!=_&&_.data instanceof protos.scene.DtoCharData)3==_.data.charType&&_.isBoss&&Tu.sendToModule("NAV_UPDATE_BOSS_BUFF_START",["modules.nav.NavModule"],e);break;case"24014":BR.ins.bossHuDunData=null;var f=e.proto,p=uF.charQueue.take(f.objectid);if(null!=p&&p.data instanceof protos.scene.DtoCharData)3==p.data.charType&&p.isBoss&&Tu.sendToModule("NAV_UPDATE_BOSS_BUFF_END",["modules.nav.NavModule"],e);break;case"OTHER_CHAR_DEAD":var g=e.proto;if(i._lastDeadOtherHero=uF.charQueue.take(g),i._lastDeadOtherHero)i._lastDeadOtherHero.data;if(i._lastDeadOtherHero&&i._lastDeadOtherHero.char_id){var v,m=uF.charIdQueue.take(i._lastDeadOtherHero.char_id),y=1,I=0,b=0;if(v=uH.Ins().isGetHero(uH.yuanshenHash.take(g)),m&&0<m.length&&v){for(I=g,b=0;b<m.length;b++){m[b].currHp,m[b].objectId;if(0<m[b].currHp&&m[b].objectId!=I){y=0,uH.yuanshenHash.put(m[b].objectId,v.objectId),uH.yuanshenHash.remove(I),v.char_id=v.objectId+m[b].objectId.toString(),v.ai.setup(v,m[b]);break}}v&&y&&(v.visible=!1,rH.removeAI(v),v.ai.stop())}}break;case"30721":e.proto;MN.NORMAL.push("NavLuckDrop"),sJ.ins.getCompomentsByName("NavActLView")&&sJ.ins.showCompoment("NavLuckDrop"),sJ.ins.notice(["NavLuckDrop"],e);break;case"30722":var w=e.proto;i.pushLuckyDropInfo(w.goods);break;case"10122":dr.hasHotUpdate=!0,sJ.ins.showCompoment("NavHotupdate"),sJ.ins.notice(["NavHotupdate"],e)}},i.enter=function(e){var t=this,i=BR.ins.toc25000;1==e?t.enterMission1(i.copyId):2==e?t.enterMission2(i.copyId):3==e?t.enterMission3(i.copyId):4==e?t.enterMission4(i.copyId):6==e?t.enterMission6(i.copyId):7==e?t.enterMission7(i.copyId):8==e?t.enterMission8(i.copyId):10==e?t.enterMission10(i.copyId):11==e?t.enterMission11(i.copyId):12==e?t.enterMission12(i.copyId):13==e?t.enterMission13(i.copyId):20==e?t.enterMission20(i.copyId):21==e?t.enterMission21(i.copyId):22==e?t.enterMission22(i.copyId):14==e?t.enterMission14(i.copyId):23==e?t.enterMission23(i.copyId):16==e?t.enterMission16(i.copyId):24==e?t.enterMission24(i.copyId):25==e?t.enterMission25(i.copyId):15==e?t.enterMission15(i.copyId):28==e?t.enterMission28(i.copyId):26==e?t.enterMission26(i.copyId):27==e?t.enterMission27(i.copyId):29==e?t.enterMission29(i.copyId):30==e?t.enterMission30(i.copyId):31==e?t.enterMission31(i.copyId):41==e?t.enterMission41(i.copyId):42==e?t.enterMission42(i.copyId):32==e?t.enterMission32(i.copyId):34==e?t.enterMission34(i.copyId):43==e?t.enterMission43(i.copyId):44==e?t.enterMission44(i.copyId):45==e?t.enterMission45(i.copyId):46==e?t.enterMission46(i.copyId):47==e?t.enterMission47(i.copyId):48==e?t.enterMission47(i.copyId):49==e?t.enterMission49(i.copyId):50==e?t.enterMission50(i.copyId):51==e?t.enterMission51(i.copyId):52==e?t.enterMission52(i.copyId):53==e?t.enterMission53(i.copyId):54==e?t.enterMission54(i.copyId):56==e?t.enterMission56(i.copyId):57==e?t.enterMission57(i.copyId):58==e&&t.enterMission58(i.copyId)},i.onLoad=function(){hN.ins.isOpen("GUILD_BOSS_HELP")&&hN.ins.close("GUILD_BOSS_HELP");var e=rn.getIndex(BR.ins.curCopyId),t=rn.MODEL.cate(e);switch(this.enter(t),t){case 1:LN.isShow=!0,LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_1);break;case 43:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_43);break;case 2:LN.isShow=!0,LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_2);break;case 13:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_13);break;case 14:var i=[];i=i.concat(MN.COPY_14),6666==BR.ins.curCopyId&&i.push("NavAttackOther"),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],i);break;case 6:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_6);break;case 3:case 7:case 30:case 49:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_3);break;case 8:LN.isShow=!0,LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1;var n=[];(n=n.concat(MN.COPY_CP)).push("NavSceneFocusView"),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],n);break;case 11:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_11);break;case 10:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_10);break;case 12:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_12);break;case 23:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],[MN.COPY_23,!1]);break;case 24:case 25:Tu.sendToModule("__DIGGER_EXIT__",["modules.digger.DiggerModule"]),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_24_25);break;case 15:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_15),qU.ins.setDropBtnStatus(BR.ins.curCopyId,!0,ql.create(this,this.onAward,null,!1));break;case 26:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_26);break;case 27:case 29:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_27);break;case 31:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_31);break;case 32:LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_32);break;case 34:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_34);break;case 43:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_43);break;case 44:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_44);break;case 45:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_45);break;case 46:qU.ins.setDropBtnStatus(BR.ins.curCopyId,!0,ql.create(this,this.onAward,null,!1)),modules.guild.others.GuildCallBossUtils.ins._isCalled?Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.GUILD_CALLED_BOSS):Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.GUILD_CALL_BOSS);break;case 47:case 48:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_47);break;case 50:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_50);break;case 51:LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_51);break;case 52:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_52);break;case 53:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_53);break;case 54:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_54);break;case 56:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_56);break;case 57:Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_57),qU.ins.setDropBtnStatus(BR.ins.curCopyId,!0,ql.create(this,this.onAward,null,!1));break;case 58:LN.isShow=!0,LN.isShowPetBtn=!0,modules.pet.others.PetDataModel.ins().btnPetShow=1,Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_58)}var s=Hi.getIndex(UR.instance.currentPoint);uH.Ins().prveCid=Hi.MODEL.quitCid(s)+""},i.onAward=function(){hN.ins.open("BOSS_WILD_SCENE_AWARD",{id:BR.ins.curCopyId})},i.enterMission1=function(e){BR.ins.curCopyId=e,qR.ins.setCopyEntry(e);var t=rn.getIndex(e),i=new $o;i.type=8,i.cid=rn.MODEL.cId(t),i.copyId=e,Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("COPYMAINVIEW")},i.enterMission30=function(e){BR.ins.bossBlood=-1,BR.ins.curCopyId=e,BR.ins.changeSceneUI(30,!0);var t=rn.getIndex(e),i=new $o;i.type=7,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("BOSS_ANCIENT_MAINVIEW"),hN.ins.open("BOSS_ANCIENT_RANKSCENE")},i.enterMission31=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(31,!0);var t=rn.getIndex(e),i=new $o;i.type=31,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission32=function(e){modules.copy.others.NewPigData.ins.killNum=0,BR.ins.curCopyId=e,BR.ins.changeSceneUI(32,!0);var t=rn.getIndex(e),i=new $o;i.type=32,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.mission1End=function(){0<BR.ins.curCopyId&&(TR.ins.mulFly=!0,jR.reqAward(BR.ins.curCopyId))},i.mission27End=function(){0<BR.ins.curCopyId&&(TR.ins.mulFly=!0,Tu.sendToModule("OPEN_SOUL_COPY_SUCCESS_PANEL",["modules.soul.SoulOutModule"]))},i.enterMission2=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(2,!0);var t=rn.getIndex(e),i=new $o;i.type=6,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission3=function(e){if(BR.ins.checkCopyId(e,3)){BR.ins.curCopyId=e,BR.ins.bossBlood=-1,BR.ins.curCopyId=e,BR.ins.changeSceneUI(3,!0);var t=rn.getIndex(e),i=new $o;i.type=7,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)}},i.enterMission4=function(e){if(BR.ins.checkCopyId(e,4)){BR.ins.curCopyId=e,BR.ins.bossBlood=-1,BR.ins.changeSceneUI(4,!0);var t=rn.getIndex(e),i=new $o;i.type=9,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)}},i.enterMission6=function(e){if(BR.ins.checkCopyId(e,6)){BR.ins.curCopyId=e,BR.ins.bossBlood=-1;var t=rn.getIndex(e),i=new $o;i.type=11,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.open("GUILD_BOSS_CD_VIEW")}},i.enterMission7=function(e){if(BR.ins.checkCopyId(e,7)){BR.ins.curCopyId=e,BR.ins.bossBlood=-1,BR.ins.changeSceneUI(7,!0);var t=rn.getIndex(e),i=new $o;i.type=14,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)}},i.enterMission8=function(e){0==LN.isShowPop&&(LN.isShowPop=!0),XN.instance().isEnterCopy=!0,XN.instance().clearJQR(),BR.ins.isCheckPointBoss=!0,BR.ins.curCopyId=e,BR.ins.changeSceneUI(8,!0);var t=rn.getIndex(e),i=new $o;i.type=15,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),G.timer.once(200,this,function(){Tu.sendToModule("SHOW_ACT_ICON",["modules.nav.NavModule"]),AY.getInstance().isShowing()&&AY.getInstance().hide(),LY.Ins().lockSceneClose()})},i.enterMission10=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(10,!0);var t=rn.getIndex(e),i=new $o;i.type=40,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission11=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(11,!0);var t=rn.getIndex(e),i=new $o;i.type=18,i.cid=rn.MODEL.cId(t),i.copyId=e,Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("SPORTS_MAIN_VIEW")},i.enterMission13=function(e){BR.ins.bossBlood=-1,BR.ins.curCopyId=e,BR.ins.changeSceneUI(13,!0);var t=rn.getIndex(e),i=new $o;i.type=17,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission14=function(e){hN.ins.isOpen("FIRST_PAY")&&hN.ins.close("FIRST_PAY"),BR.ins.bossBlood=-1,BR.ins.curCopyId=e,BR.ins.changeSceneUI(14,!0);var t=rn.getIndex(e),i=new $o;i.type=22,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission12=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(12,!0);var t=rn.getIndex(e),i=new $o;i.type=17,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission34=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(34,!0);var t=rn.getIndex(e),i=new $o;i.type=34,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission20=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(20,!0);var t=rn.getIndex(e),i=new $o;i.type=20,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_20),hN.ins.close("GodWeaponMainPanel"),hN.ins.close("GODWEAPON_SY_ENTER")},i.enterMission21=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(21,!0);var t=rn.getIndex(e),i=new $o;i.type=21,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_20),hN.ins.close("GodWeaponMainPanel"),hN.ins.close("GODWEAPON_SY_ENTER")},i.enterMission41=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(41,!0);var t=rn.getIndex(e),i=new $o;i.type=41,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_41_42),hN.ins.close("MAGIC_VIEW")},i.enterMission42=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(42,!0);var t=rn.getIndex(e),i=new $o;i.type=42,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_41_42),hN.ins.close("MAGIC_VIEW")},i.enterMission44=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(44,!0);var t=rn.getIndex(e),i=new $o;i.type=44,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.COPY_44),hN.ins.close("MAGIC_VIEW")},i.enterMission43=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(43,!0);var t=rn.getIndex(e),i=new $o;i.type=43,i.cid=rn.MODEL.cId(t),i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("ACTOR_M"),hN.ins.close("SOARING_VIEW");var n=new Tu;n.setup("checkZone",[]),sJ.ins.notice(["NavBottom"],n)},i.enterMission45=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(45,!0);var t=rn.getIndex(e),i=new $o;i.type=45,i.cid=rn.MODEL.cId(t),i.copyId=e,i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission46=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=46,i.cid=rn.MODEL.cId(t),i.copyId=e,i.monsterId=rn.MODEL.bossId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("GUILD_BOSS_MAINVIEW")},i.checkIsKilled=function(){if(0<zN.getMonsterInStage().length)G.timer.once(1e3,this,this.checkIsKilled);else{G.timer.clear(this,this.checkIsKilled);var e,t=zN.getNPCs();if(t.length){NF.Ins().selectChar=t[0],e=YN.getCharNearPt(t[0]);for(var i=1;i<=3;i++){var n=uH.getHero(i);if(n)new NH(n).moveTo(e)}yH.Ins().clear(),yH.Ins().mainCharMove(e,!1,ql.create(this,this.openTips),!1),0==gR.ins.actorFlyUpBosstask&&(G.loader.load(_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_bg11.png")),G.loader.load(_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_bg22.png")),G.loader.load(_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_js.png")))}}},i.openTips=function(){hN.ins.open("FLYUPNPCCBBTIP"),HR.ins.isFinishFlyup=1,NF.mainChar._CharMoveEnd_=null},i.enterMission22=function(e){zB.ins.showById(4536,1),ZB.ins.isYezhan=!0,XN.instance().clearJQR(),BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=23,i.cid=rn.MODEL.cId(t),i.copyId=e,Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),Tu.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],MN.NORMAL),hN.ins.close("SPORTS_MAIN_VIEW"),AY.getInstance().hide()},i.enterMission23=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=5,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("SPORTS_MAIN_VIEW"),hN.ins.close("ARENA_MATCH")},i.enterMission16=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=12,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),gB.ins.changeUI(!0)},i.enterMission24=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=25,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),JR.isPlayingZhanBao=!0,JR.digZhanBaoType=1},i.enterMission25=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=24,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission26=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(26,!0);var t=rn.getIndex(e),i=new $o;i.type=27,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("BOSSHOEMSUBVIEW")},i.enterMission47=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(47,!0);var t=rn.getIndex(e),i=new $o;i.type=47,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("FLYUPBOSSMAINVIEW")},i.enterMission48=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(47,!0);var t=rn.getIndex(e),i=new $o;i.type=48,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("FLYUPBOSSMAINVIEW")},i.enterMission49=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(49,!0);var t=rn.getIndex(e),i=new $o;i.type=49,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission27=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(27,!0);var t=rn.getIndex(e),i=new $o;i.type=28,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("SOULOUT_V")},i.enterMission29=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(29,!0);var t=rn.getIndex(e),i=new $o;i.type=29,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission15=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=26,i.cid=rn.MODEL.cId(t),hN.ins.close("BOSS_MAINVIEW"),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission28=function(e){BR.ins.curCopyId=e;var t=rn.getIndex(e),i=new $o;i.type=13,i.cid=rn.MODEL.cId(t),i.copyId=e,Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),DN.instance.changeSCZBscene(!0)},i.enterMission50=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(50,!0);var t=rn.getIndex(e),i=new $o;i.type=50,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission51=function(e){hN.ins.close("COPYMAINVIEW"),hN.ins.close("TEAM_COPY_ROOM"),hN.ins.close("CHAT"),BR.ins.curCopyId=e,BR.ins.changeSceneUI(51,!0);var t=rn.getIndex(e),i=new $o;i.type=51,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission52=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(52,!0);var t=rn.getIndex(e),i=new $o;i.type=52,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission53=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(53,!0);var t=rn.getIndex(e),i=new $o;i.type=53,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("CROSSBOS_ENTER_VIEW"),hN.ins.close("CROSSBOSS_MAIN_VIEW"),Tu.sendToModule("CROSSBOSSENTERSCENE",["modules.corssbattle.CrossBossModule"])},i.enterMission54=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(54,!0);var t=rn.getIndex(e),i=new $o;i.type=54,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("GUILD_BOSS_MAINVIEW"),hN.ins.isOpen("GUILD_KUN_NOTICE_VIEW")&&hN.ins.close("GUILD_KUN_NOTICE_VIEW"),hN.ins.isOpen("GUILD_KUN_CALL_VIEW")&&hN.ins.close("GUILD_KUN_CALL_VIEW")},i.enterMission56=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(56,!0);var t=rn.getIndex(e),i=new $o;if(i.type=56,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("CROSSNEWWORLDBOSSPANEL"),1==BR.ins.isCrossFirst){var n=BR.ins.bookDto;Tu.sendToModule("GET_GOODS",["modules.auctionhouse.AuctionHouseModule"],{dto:n})}},i.enterMission57=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(57,!0);var t=rn.getIndex(e),i=new $o;i.type=57,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i)},i.enterMission58=function(e){BR.ins.curCopyId=e,BR.ins.changeSceneUI(58,!0);var t=rn.getIndex(e),i=new $o;i.type=58,i.cid=rn.MODEL.cId(t),Tu.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],i),hN.ins.close("COPYMAINVIEW")},i.timeOutOpenCommSucc=function(e){Tu.sendToModule("SCENE_COMM_SUCCESS",["modules.boss.BossModule"],e)},i.timeOutOpenSucc=function(e){var t;this.saveToc30004=e;var i=rn.getIndex(e.missionId),n=rn.MODEL.cate(i);if(1==n)t=this.onExitCate1;else{if(2==n||58==n)return BR.ins.backToPersonBoss=e.pass,void this.personalShowRewardToScene(e);if(3==n);else if(49==n);else if(4==n)t=this.onExitCate4;else if(13==n);else if(6==n);else if(7==n)t=this.onExitCate7;else{if(8==n)return XN.instance().isEnterCopy=!1,e.pass?this.guanqiaShowRewardToScene(e):Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(this,this.onExitCate8,[e])}),void qU.ins.updateBossBlood(0);if(10==n){if(t=this.onExitCate10,Lo.instance.isNeedToShowLottery=!0,e.pass)return this.pickUpCopyTowerReward(e),void G.timer.once(2500,this,function(){Tu.sendToModule("OPEN_TOWER_SUCCESS",["modules.copy.CopyModule"],{award:e.reward,callback:ql.create(this,t,[e]),missionID:e.missionId})})}else if(12==n){if(t=this.onExitCate12,e.pass)return void Tu.sendToModule("OPEN_FAIRYLAND_SUCCESS_PANEL",["modules.godweapon.GodWeaponModule"],{award:e.reward,callback:ql.create(this,t,[e])})}else{if(22==n)return ZB.ins.isYezhan=!1,tr.push(RP.n[227]),void(1==e.pass?(zB.ins.playRainbowByWords(RP.n[228]),0<e.reward.length?(tr.push(RP.n[229]),this.filedShowRewardToScene(e)):(tr.push(RP.n[230]),Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:sH.pickItems,callback:ql.create(this,this.openFieldView,[{award:sH.pickItems}])}))):(zB.ins.playRainbowByWords(RP.n[231]),tr.push(RP.n[232]),Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{callback:ql.create(this,this.openFieldView)})));if(23==n)return t=this.onExitCate23,void(e.pass?Tu.sendToModule("ARENA_SUCCEED",["modules.fight.FightModule"],{award:e.reward,callback:ql.create(this,t,[e]),cate:n}):Tu.sendToModule("ARENA_FAIL",["modules.fight.FightModule"],{award:e.reward,callback:ql.create(this,t,[e])}));if(14==n)return void this.storeCopyShowRewardToScene(e);if(24==n)return 1==e.pass?(zB.ins.playRainbowByWords(RP.n[228]),void this.diggerShowRewardToScene(e)):(zB.ins.playRainbowByWords(RP.n[234],5e3),void G.timer.once(1e3,this,this.moveToDigger));if(25==n)return 1==e.pass?(zB.ins.playRainbowByWords(RP.n[235],5e3),void this.diggerShowRewardToScene(e)):(zB.ins.playRainbowByWords(RP.n[234],5e3),void G.timer.once(1e3,this,this.moveToDigger));if(29==n)return TR.ins.mulFly=!1,void this.personalShowRewardToScene(e);if(26==n||47==n);else{if(15==n||21==n||20==n)return void this.storeCopyShowRewardToScene(e);if(30==n)this.exit();else if(31==n)t=this.onExitCate31;else{if(32==n)return;if(34==n){if(t=this.onExitCate34,e.pass)return}else{if(43==n)return void G.timer.once(1e3,this,this.checkIsKilled);if(45==n)return;if(46==n)return;if(44==n)this.exit();else if(48==n)t=this.onExitCate48;else if(50==n)Na.ins.copyHurtList=[],hN.ins.isOpen("FIREDRAGONGUWUVIEW")&&hN.ins.close("FIREDRAGONGUWUVIEW"),this.exit();else{if(51==n)return LN.isShowPetBtn=!1,void(e.pass?Tu.sendToModule("OPEN_TEAM_RESULT",["modules.copy.CopyModule"],{award:e.reward,callback:ql.create(this,this.onExitCate51)}):Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(this,this.onExitCate51)}));if(52==n)$P.ins.copyHurtList=[],hN.ins.isOpen("FESTBOSS_GUWU_VIEW")&&hN.ins.close("FESTBOSS_GUWU_VIEW"),this.exit();else if(53==n);else if(54==n)return}}}}}}}e.pass?Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:e.reward,callback:ql.create(this,t,[e]),cate:n}):Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(this,t,[e])})},i.moveToDigger=function(){BR.ins.curCopyId=0,BR.ins.isQuitFromDig=!0,BR.ins.isQuitFromDig2=!0,BR.ins.isQuitFromDig3=!0;var e=new UA;Tu.sendToService(e),G.timer.once(500,this,function(){var e=NF.mainChar;Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:e.maxHP,heroId:e.hero_id})})},i.openFieldView=function(){tr.push(RP.n[237]),this.exit(300),ZB.ins.fighttingID=0,BR.ins.toc25000=null,BR.ins.curCopyId=0,$R.isViewLink||PH.Ins().info.taskId==SW.TASK_ID&&2==PH.Ins().info.status||Tu.sendToModule("OPEN_SPORTS_VIEW",["modules.digger.DiggerModule"]),dr.dtoEnterScene=null,UR.instance.isAuto=yJ.CHECK_POINT_STATUS,Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule","modules.checkpoint.CheckPointModule"])},i.onExitCate1=function(e){this.exit(100)},i.onExitCate2=function(e){this.onExitCopy_Common()},i.onExitCate29=function(e){this.onExitCopy_Common(!0,1800,!1)},i.onExitCate3=function(e){this.onExitCopy_Common()},i.onExitCate4=function(e){this.onExitCopy_Common()},i.onExitCate6=function(e){this.onExitCopy_Common()},i.onExitCate7=function(e){this.onExitCopy_Common()},i.onExitCate23=function(e){this.onExitCopy_Common(!0,100)},i.onExitCate10=function(e){this.onExitCopy_Common(!0,100),$R.isFaildLink||Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:2})},i.onExitCate12=function(e){this.onExitCopy_Common(!0,300)},i.onExitCate31=function(e){this.exit(0)},i.onExitCate34=function(e){this.onExitCopy_Common(!0,300)},i.onExitCate48=function(e){e.pass&&(0==gR.ins.actorFlyUpBosstask?gR.ins.actorFlyUpBosstask=1:1==gR.ins.actorFlyUpBosstask?gR.ins.actorFlyUpBosstask=2:2==gR.ins.actorFlyUpBosstask&&(gR.ins.actorFlyUpBosstask=3)),this.onExitCopy_Common(!0,300)},i.onExitCate14=function(e){e||this.onExitCopy_Common(),e.pass?Tu.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:e.reward,callback:ql.create(this,this.onExitCopy_Common)}):Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(this,this.onExitCopy_Common)})},i.onExitCate51=function(){this.onExitCopy_Common(!0,300)},i.storeCopyShowRewardToScene=function(e){if(1<gR.ins.actorList.length&&(yH.Ins().actCtrl.clearAll(),NF.changeCtrlChar(0),NF.mainChar.isDeath&&NF.mainChar.relive()),sH.start(),e.reward&&e.reward.length<=0)this.onExitCate14(e);else{var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=new Uh(NF.mainChar.x,NF.mainChar.y);if(null!=s){s=PB.pixelsToTile(s.x,s.y);var o=e.reward;NF.Droping_LockMove=BB.getTimer()+5e4,qN.showDropsToScene(parseInt(uH.Ins().currCid),o,s,n)}}},i.moyuBossShowRewardToScene=function(e){if(e.reward&&e.reward.length<=0)this.onExitCate15();else{NF.Droping_LockMove=BB.getTimer()+5e4;var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=BR.ins.copyBossDeadXY;if(null!=s){s=PB.pixelsToTile(s.x,s.y);var o=e.reward;qN.showDropsToScene(parseInt(uH.Ins().currCid),o,s,n)}}},i.personalShowRewardToScene=function(e){if(e.reward&&e.reward.length<=0)this.onExitCate2(e);else{var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=BR.ins.copyBossDeadXY;if(null!=s){s=PB.pixelsToTile(s.x,s.y);var o=e.reward;qN.showDropsToScene(parseInt(uH.Ins().currCid),o,s,n)}}},i.kunShowRewardToScene=function(e){if(e&&e.list&&e.list.length<=0)this.onExitCopy_Common();else{var t=BR.ins.curCopyId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=BR.ins.copyBossDeadXY;if(null!=s){s=PB.pixelsToTile(s.x,s.y);var o=e.list;qN.showDropsToScene(parseInt(uH.Ins().currCid),o,s,n)}}},i.diggerShowRewardToScene=function(e){if(e.reward&&e.reward.length<=0)G.timer.once(3e3,this,this.moveToDigger);else{var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t)));if(null!=this._lastDeadOtherHero){this._lastDeadOtherHero.point;var s=e.reward;qN.showDropsToScene(parseInt(uH.Ins().currCid),s,this._lastDeadOtherHero.tilePoint,n)}}},i.guanqiaShowRewardToScene=function(e){if(tr.push(":guanqiaShowRewardToScene:"+JSON.stringify(e)),gR.ins.actorList&&1<gR.ins.actorList.length&&(tr.push("guanqiaShowRewardToScene,PlayerData.ins.actorList"),yH.Ins().actCtrl.clearAll(),tr.push("guanqiaShowRewardToScene,PlayerData.ins.actorList 1"),NF.changeCtrlChar(0),tr.push("guanqiaShowRewardToScene,PlayerData.ins.actorList 2"),NF.mainChar.relive(),tr.push("guanqiaShowRewardToScene,PlayerData.ins.actorList 2")),sH.start(),tr.push("guanqiaShowRewardToScene,over FightCtrl.start()"),e.reward&&e.reward.length<=0)this.onExitCate8(e);else{var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=BR.ins.copyBossDeadXY;if(s?(s=PB.pixelsToTile(s.x,s.y),tr.push("：guanqia boss dead point:"+s)):(s=PB.pixelsToTile(NF.mainChar.x,NF.mainChar.y),tr.push("：guanqia mainChar point:"+s)),s){var o,a=e.reward;for(var r in a)o=a[r],aR.EXP.itemId==o.modelId&&KN.instance.putType(2,o.count);tr.push("：run showDropsToScene"),qN.showDropsToScene(parseInt(uH.Ins().currCid),a,s,n),G.timer.once(300,HP,HP.newGuideLoadPro)}}},i.pushLuckyDropInfo=function(e){var t=ql.create(this,this.openWearTipDelay,[e]);dr.dtoEnterScene?modules.scene.proxys.SceneMissionProxy.luckyDrops.push(t):t.run()},i.openWearTipDelay=function(e){hN.ins.isOpen("EQUIP_WEAR_TIP")&&hN.ins.close("EQUIP_WEAR_TIP"),G.timer.once(200,this,this.openWearTipNow,[e])},i.openWearTipNow=function(e){var t=RP.n[238],i=RP.n[239],n=RP.n[240],s=yB.create(e.shift()),o=ql.create(this,function(){Tu.sendToModule("BP_OPEN_RED",["modules.backpack.BackpackModule"],{_subIndex_:0})});XQ.ins.show(s,Ql.createColor(i,"#ffb11a"),o,t,n,!0)},i.pickUpCopyTowerReward=function(e){var t=e.missionId,i=rn.getIndex(t),n=(rn.MODEL.bossId(i),rn.MODEL.pickup(rn.getIndex(t))),s=BR.ins.copyBossDeadXY;if(s){s=PB.pixelsToTile(s.x,s.y);var o=e.reward;qN.showDropsToScene(parseInt(uH.Ins().currCid),o,s,n)}},i.shengyuRewardToScene=function(e,t){void 0===t&&(t=!1);var i=rn.getIndex(BR.ins.curCopyId),n=rn.MODEL.bossId(i),s=rn.MODEL.pickup(rn.getIndex(BR.ins.curCopyId)),o=hn.MODEL.birthGrid(hn.getIndex(n));if(o&&2==o.length){var a=e.rewards;t&&(s=2),NF.Droping_LockMove=BB.getTimer()+5e4,qN.showDropsToScene(parseInt(uH.Ins().currCid),a,new Uh(o[0],o[1]),s)}},i.filedShowRewardToScene=function(e){var t=e.missionId,i=(rn.getIndex(t),rn.MODEL.pickup(rn.getIndex(t)),BR.ins.charDeadXY);if(i){i=PB.pixelsToTile(i.x,i.y);var n,s=e.reward;for(var o in s)n=s[o],aR.EXP.itemId==n.modelId&&KN.instance.putType(2,n.count);qN.showDropsToScene(parseInt(uH.Ins().currCid),s,i,2)}},i.onExitCate15=function(){NF.Droping_LockMove=BB.getTimer()+0,this.onExitCopy_Common()},i.onExitCate8=function(e){e&&e.reward&&e.reward.length<=0&&(UR.instance.isAuto=!1,UR.instance.clearBatch()),tr.push("：run onExitCate8"),this.onExitCopy_Common(!1);var t=!1;if(e?(tr.push("：data toc30004,missionId:"+e.missionId),tr.push("：data toc30004,pass:"+e.pass)):(tr.push("：data toc30004: no data"),t=!0),e&&0==e.pass)this.moveEndFunc(8);else{var i=0,n=BR.ins.curCopyId;if(0<n){var s=n%1e4;i=Hi.getIndex(s)}i<0&&(i=Hi.getIndex(UR.instance.currentPoint-1));var o=Hi.MODEL.transfer(i);if(tr.push("：run teleport:"+o),o){var a=o.split(","),r=new Uh(a[0],a[1]);t&&G.timer.once(3e4,this,this.checkInExit8,[r]),yH.Ins().actCtrl.clearAll(),yH.Ins().mainCharMove(r,!1,ql.create(this,this.moveEndFunc,[8]));var l=zN.GetChar(),c=r.x%80,u=r.y%40;l.renderInSelf=!1,l.isSceneEffect=!0,l.loadEffect("jm1134",Za.LAYER_BOTTOM),l.setXY(r.x-c,r.y-u),l.cid=uH.Ins().currCid,l.isCharMode=!1,l.setCharBoolVisible(!1),l.setCharNameVisible(!1),l.char_id=l.id,l.cid=uH.Ins().currCid,uH.Ins().addChar(l),l.type=Za.TRANSPORT,l.mat.scale(1,1),NF.scene.addItem(l)}else this.moveEndFunc(8)}},i.checkInExit8=function(e){tr.push(" run checkInExit8"),BR.ins.isCheckPointBoss&&(tr.push("checkInExit8 moveEndFunc"),this.moveEndFunc(8,!1))},i.moveEndFunc=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=!0),G.timer.clear(this,this.checkInExit8),tr.push("：run moveEndFunc");var i=Hi.getIndex(UR.instance.currentPoint);uH.Ins().prveCid=Hi.MODEL.quitCid(i)+"",t&&(UR.instance.checkPointExitBirth=new Uh(NF.mainChar.x,NF.mainChar.y)),BR.ins.isCheckPointBoss=!1,G.timer.once(400,null,function(){Tu.sendToModule("SHOW_ACT_ICON",["modules.nav.NavModule"])}),this.exit(300,e)},i.onExitCopy_Common=function(e,t,i){void 0===e&&(e=!0),void 0===t&&(t=1800),void 0===i&&(i=!0),0<BR.ins.curCopyId&&(TR.ins.mulFly=i,jR.reqAward(BR.ins.curCopyId)),e&&this.exit(t)},i.exit=function(e,t){void 0===e&&(e=1800),void 0===t&&(t=-1),this.saveToc30004=null,hN.ins.isOpen("RESULT_FAIL")&&-1==t||(tr.push("：run sceneMissionProxy exit"),BR.ins.exitCopy(e),zN.clearPickUpQueue(),zN.clearSceneMonster())},f(t,["luckyDrops",function(){return this.luckyDrops=new Array}]),t}(),lF=function(e){function r(){this.isWait=!1,r.__super.call(this)}b(r,"modules.scene.proxys.SceneRamBoss",bp);var t=r.prototype;return t.subHandler=function(e){switch(e.actionOrder){case"__PICKUP_OVER__":10==e.proto&&aH.boss&&(aH.boss.setDeath(),aH.boss.play("death"),aH.boss.selectTarget=null,NF.Ins().selectChar=null,nH.removeCharBuff(aH.boss.char_id),aH.boss.removeReason.push("RAMBOSS---removeChar(ZhanBaoCtrl.boss)"),uH.Ins().removeChar(aH.boss),NF.Ins().showAll(),aH.isZhanBaokMode=!1,aH.boss=null,BB.IsModePVE=!0,dr.dtoEnterScene=null,aH.getInstance().stop(),sH.start(),this.isWait=!1,qU.ins.updateBossBlood(0),this.sendToModule("BOOSZHANBAOBACK",["modules.task.TaskModule"]));break;case"__ZHANBAO_PLAY_END__":if(dr.dtoEnterScene&&10!=dr.dtoEnterScene.type)return;if(!aH.getInstance().currDto)return;var t,i=aH.getInstance().currDto;NF.Ins().selectChar&&(t=NF.Ins().selectChar.tilePoint),aH.boss&&(aH.boss.removeReason.push("kill"),t=aH.boss.tilePoint,aH.boss.setDeath(),aH.boss.play("death"),uH.Ins().removeChar(aH.boss),NF.Ins().selectChar&&(NF.Ins().selectChar.removeReason=["kill"],uH.Ins().removeChar(NF.Ins().selectChar)),aH.boss.setCharBoolValue(0),qU.ins.updateBossBlood(0),nH.removeCharBuff(aH.boss.char_id)),i.items.length?(NF.Ins().selectChar=null,aH.boss.selectTarget=null,NF.mainChar.lockSkill=!0,aF.showPickupItems(t)):2==dr.dtoEnterScene.type&&(Tu.sendToModule("__PICKUP_OVER__",["modules.scene.SceneModule"]),aH.boss.removeReason=["kill"],aH.boss.selectTarget=null,NF.Ins().selectChar=null,NF.Ins().showAll(),aH.isZhanBaokMode=!1,aH.boss=null,BB.IsModePVE=!0,dr.dtoEnterScene=null,aH.getInstance().stop(),sH.start()),Tu.sendToTotalModule("__ZHAOBAO_END__",dr.dtoEnterScene.type);break;case"TASKBOOS":if(dr.dtoEnterScene=e.proto,10==dr.dtoEnterScene.type){NF.Ins().selectChar=null,sH.stop(),r.createMonster(dr.dtoEnterScene.monsterId,dr.dtoEnterScene.x,dr.dtoEnterScene.y,dr.dtoEnterScene.currHP).isBoss=!0,qU.ins.updateBossBlood(dr.dtoEnterScene.monsterId,dr.dtoEnterScene.currHP,dr.dtoEnterScene.currHP),aH.getInstance().addDto(dr.dtoEnterScene.dtoZhanbao),NF.Ins().selectChar=aH.boss;var n=YN.getCharNearPt(aH.boss);NF.Ins().heidBeside(aH.boss),aH.getInstance().playDto(),qU.ins.updateBossBlood(0);for(var s=0;s<uH.heroQueue.length;s++){var o=uH.heroQueue[s];if(o&&o!=NF.mainChar){var a=YN.getCharNearPt(aH.boss,o);o.moveTo(a.x,a.y)}}this.isWait=!0,yH.Ins().mainCharMove(n,!1,ql.create(this,this.moveEndAnFight,null,!1)),G.timer.once(6e3,this,this.waitCheck,[n])}}},t.waitCheck=function(e){this.isWait&&(this.isWait=!1,yH.Ins().mainCharMove(e,!1,ql.create(this,this.moveEndAnFight,null,!1)))},t.moveEndAnFight=function(){this.isWait=!1,aH.getInstance().start()},t.onReadyFunc=function(){},r.createMonster=function(e,t,i,n){var s=hn.getIndex(e),o=hn.MODEL.muId(s);o=_n.getIndex(o);var a=uH.monsterDataHash.take(e);a||(a=JSON.parse(hn.MODEL.attributes(s)),uH.setMonsetAttributes(e,a));var r=_n.MODEL.avatarId(o),l=zN.GetChar();l.cid=uH.Ins().currCid,l.selectEnabled=!1,ZN.updateCharDisplay(l,r),uH.Ins().addChar(l),l.type=Za.MONSTER,l.setXY(t,i);var c=_n.MODEL.awayEffect(o);return""!=(c=c.split('"').join(""))&&null!=c&&"0"!=c&&l.loadEffect(c,Za.LAYER_BOTTOM,c),l.bodyHeight=_n.MODEL.avatarHeight(o),l.char_name=hn.MODEL.name(s),l.dir=8*Math.random()>>0,l.setCharBoolValue(n,n),l.char_id=l.id,NF.scene.addItem(l),aH.boss=l},r}(),cF=function(e){function t(){this.playerQueue=[],this.playerGroupArray=[],t.__super.call(this)}b(t,"modules.scene.proxys.SceneWorldBossProxy",bp);var i=t.prototype;return i.subHandler=function(e){var t=0;switch(e.actionOrder){case"__ZHANBAO_PLAY_END__":if(dr.dtoEnterScene&&9!=dr.dtoEnterScene.type)return;break;case"__WORLD_ENTER__":var i=e.proto;if(9!=i.type)return;sH.stop(),t=(dr.dtoEnterScene=i).cid,NF.Ins().changeScene(t.toString(),!0,ql.create(this,this.onReadyFunc));break;case"__WORLD_EXIT__":if(dr.dtoEnterScene&&9!=dr.dtoEnterScene.type)return;aH.isZhanBaokMode=!1,(dr.dtoEnterScene=null)!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(this,this.exit)),0<hg.ins.getLeftTime()&&BR.ins.reqAutoChallenge();break;case"__WORLD_DEATH__":aH.boss.setDeath(),aH.getInstance().isReady=!1,sH.getInstance().isStop=!0,sH.getInstance().autoMode=!1}},i.exit=function(){NF.camPoint=null,this.playerQueue.length=0,sH.start()},i.onReadyFunc=function(){this.playerGroupArray.length=0,aH.getInstance().stop(),sH.stop();var e=uH.robotBirthPoints[0];e=PB.tileToPixels(e),uH.robotBirthPoints.shift(),LH.setupRobotDatas(uH.robotBirthPoints);var t=dr.dtoEnterScene.monsterId,i=hn.getIndex(t),n=hn.MODEL.muId(i);n=_n.getIndex(n);var s=uH.monsterDataHash.take(t);s||(s=JSON.parse(hn.MODEL.attributes(i)),uH.setMonsetAttributes(t,s)),aH.boss.setCharBoolValue(99999999,99999999),aH.boss.setCharBoolVisible(!1),aH.boss.setCharNameVisible(!1);var o=_n.MODEL.avatarId(n);aH.boss.char_name=hn.MODEL.name(i),aH.boss.type=Za.MONSTER,aH.boss.selectEnabled=!0,aH.boss.isBoss=!0,aH.boss.isUpdateBool=!1,ZN.updateCharDisplay(aH.boss,o),aH.boss.play("stand"),aH.boss.dir=5;var a=rH.GetNpcAI();a.modelId=t,a.setup(aH.boss),a.start(),rH.pushAI(a),NF.scene.addItem(aH.boss);var r=uH.replaceModelPoints[0];r||(r=new Uh(1957,818));for(var l=0;l<uH.heroQueue.length;l++){var c=uH.heroQueue[l];if(c.type==Za.HERO){var u=uH.getHeroPoint(c,PB.pixelsToTile(r.x,r.y)),d=uH.getHeroPoint(c,PB.pixelsToTile(e.x,e.y));c.setXY(d.x,d.y),c.moveTo(u.x,u.y)}else c.setXY(e.x,e.y)}yH.Ins().mainCharMove(r,!1,ql.create(this,this.moveEndFunc))},i.stop=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].stop()}},i.createPlayerGroup=function(){if(LH.hasFreeRobotData()&&this.playerQueue.length){var e=this.playerQueue.shift();if(e){var t=rH.GetPlayerGroupAI();t.setupAndPlay(e,uH.replaceModelPoints[0],aH.boss),this.playerGroupArray.push(t)}}},i.hide=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].hide()}},i.show=function(){for(var e=0;e<this.playerGroupArray.length;e++){this.playerGroupArray[e].show()}},i.moveEndFunc=function(){sH.start(),this.createPlayerGroup(),G.timer.loop(4e3,this,this.createPlayerGroup,null,!1),NF.camPoint=NF.mainChar.point},i.playZhanBao=function(e){aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,aH.getInstance().stop(),aH.clear(),aH.getInstance().addDto(e)},t.createMonster=function(e,t,i,n){var s=e.modelId,o=hn.getIndex(s),a=hn.MODEL.muId(o);a=_n.getIndex(a);var r=uH.monsterDataHash.take(s);r||(r=JSON.parse(hn.MODEL.attributes(o)),uH.setMonsetAttributes(s,r));var l=_n.MODEL.avatarId(a);return null==n&&(n=zN.GetChar()),n.cid=uH.Ins().currCid,n.selectEnabled=!1,ZN.updateCharDisplay(n,l),ZN.setCharTitle(n,e.titles),uH.Ins().addChar(n),n.type=Za.MONSTER,n._proto_=e,n.setXY(t,i),n.bodyHeight=_n.MODEL.avatarHeight(a),n.char_name=hn.MODEL.name(o),n.dir=8*Math.random()>>0,n.setCharBoolValue(e.currHP,e.maxHP),n.char_id=n.id,NF.scene.addItem(n),n},t}(),uF=function(e){function Y(){var e=this;e.queueCreate=[],e.autoRelive=[3,7,3,13,15,20,21,26,30,46,41,42,47,49,58],e.attackerArr=[],e.defenderArr=[],e.beAttack=1,e.attack=2,e.attName=null,e.defName=null,e.att_IdArr=[],e.def_IdArr=[],e.aiHash=new jo,e.attackerHash=new jl,e.defenderHash=new jl,Y.__super.call(e)}b(Y,"modules.scene.proxys.Scene_CharProxy",bp);var t=Y.prototype;return t.subHandler=function(e){var t,i=this;switch(e.actionOrder){case"10301":for(var n=e.proto,s=0;s<n.charQueue.length;s++){var o=n.charQueue[s];NF.Ins().isChangeFinish?i.startCreate(o):i.queueCreate.push(o)}break;case"10302":if(7777==BR.ins.curCopyId)return;for(var a=e.proto,r=0;r<a.charQueue.length;r++)i.removeChar(a.charQueue[r]);break;case"22614":if(console.log("TOC_22614"),!dr.dtoEnterScene||!dr.dtoEnterScene.dtoZhanbao||12!=dr.dtoEnterScene.type&&13!=dr.dtoEnterScene.type)return;var l=e.proto;if(l.charId.toString()==gR.ins.charId){var c=gR.ins.actorById(NF.mainChar.hero_id);NF.mainChar.relive(),NF.scene.addItem(NF.mainChar,1),Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:NF.mainChar.currHp,heroId:NF.mainChar.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:c.maxMP,heroId:NF.mainChar.hero_id})}else{var u=Y.charQueue.take(l.charId.toString());u&&(u.relive(),i.setCharAI(u,null,!1),NF.scene.addItem(u,1))}break;case"10310":var d,h=e.proto;(d=h.charId.toString()==gR.ins.charId?NF.mainChar:Y.charQueue.take(h.charId.toString()))&&(0!=h.camp?d.char_name==gR.ins.charName?d.charNameColor="#00ff00":h.camp==NF.mainChar.camp?d.charNameColor="#00ff00":d.charNameColor="#ff0000":d.charNameColor="#ffffff",d.camp=h.camp);break;case"10311":var _,f=e.proto;(_=f.charId.toString()==gR.ins.charId?NF.mainChar:Y.charQueue.take(f.charId.toString()))&&(_.removeTopEffect("jm0026"),2==f.campState?(_.selectEnabled=!1,_.setDeath(),_.play("death")):0==f.campState?(_.relive(),NF.scene.addItem(_,1),_.play("stand"),_.selectEnabled=!0,i.setCharAI(_,null,!1)):1==f.campState&&(_.selectEnabled=!1,_.showTopEffect("jm0026","jm0026")),_.campState=f.campState,_.setCharBoolValue(f.currHP,f.maxHP)),_==NF.mainChar&&(Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:NF.mainChar.currHp,heroId:NF.mainChar.hero_id}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule","modules.nav.NavModule"],{hp:f.currMP,heroId:NF.mainChar.hero_id})),Tu.sendToModule("UPDATE_CHAR_CURR_HP",["modules.yzbqc.YzbqcModule"],{maxHP:f.maxHP,currHP:f.currHP,charId:f.charId});break;case"23114":if(6==!uH.Ins().currCkType)return;var p=e.proto;i.moveTo(p.charId,p.x,p.y,ql.create(Y,modules.scene.proxys.Scene_CharProxy.maincharmoveEnd,[p.type,p.charId]));break;case"10312":if(6==!uH.Ins().currCkType)return;var g=e.proto;if(t=Y.charQueue.take(g.charId.toString())){var v=t.proto;v&&(v.sex=g.sex,v.professional=g.pro)}break;case"10313":if(6==!uH.Ins().currCkType)return;var m=e.proto;(t=Y.charQueue.take(m.charId.toString()))&&ZN.setCharTitle(t,m.titles);break;case"10314":var y=e.proto;(t=Y.charQueue.take(y.charId.toString()))&&ZN.updateCharDisplay(t,y.mid,y.wid,y.wgid,y.eid);break;case"25013":var I=e.proto;(t=Y.charQueue.take(I.charId.toString()))&&(t.charProfessionName=I.building1,t.char_name=I.building2);break;case"25014":BR.ins.exitCopy(1);break;case"23122":var b=e.proto,w=new TH;w.char_id=b.charId,w.modelId=b.modelId,w.x=b.x,w.y=b.y,i.createMonster(w);break;case"23123":var x=e.proto;i.removeChar(x.charId);break;case"23312":var S,k=e.proto;for(var E in k.bossCurrHp<=0&&(i.removeChar(1),i.charStop()),k.bossList){S=k.bossList[E];var T=new TH;T.char_id=S.id,T.modelId=S.mid,T.x=S.px,T.y=S.py,i.createMonster(T)}break;case"10304":i.charMove(e.proto);break;case"24000":i.stopMove(e.proto);break;case"YZBQ_END":case"SIEGE_EXIT":if(dr.dtoEnterScene)for(var C=0;C<Y.zhanBaoCharQueue.length;C++){var L=Y.zhanBaoCharQueue[C];L.hero_id=-1,L.removeReason.push("end remove"),uH.Ins().removeChar(L),L.recover()}aH.isZhanBaokMode=!1,(dr.dtoEnterScene=null)!=uH.Ins().prveCid&&NF.Ins().changeScene(uH.Ins().prveCid,!0,ql.create(sH,sH.start));break;case"23106":var M=e.proto,A=Y.charQueue.take(M.dtoZhanBao.defenders_id);A&&rH.stopAI(A),i.playZhanBao(M);break;case"__ZHANBAO_PLAY_END__":if(!dr.dtoEnterScene)return;!dr.dtoEnterScene.dtoZhanbao||12!=dr.dtoEnterScene.type&&13!=dr.dtoEnterScene.type||i.playZhanBaoEnd();break;case"23325":i.charPlay(e.proto);break;case"__SCENE_CHANGED__":for(i.aiHash.clear();0<i.queueCreate.length;)i.startCreate(i.queueCreate.shift());Tu.sendToModule("HIDE_OTHER_PLAYERS",["modules.nav.NavModule"],e);break;case"MAX_HD_CHANGE":var D=e.proto,O=D[0];for(s=0;s<uH.heroQueue.length;s++){var P=uH.heroQueue[s];if(null!=P&&P.objectId==O){var R=D[1],N=D[2];0<N&&P.setCharInnerVisible(!0),P.setCharInnerValue(R,N)}}break;case"24011":i.charCastSkillHuit(e.proto);break;case"24001":i.charDead(e.proto),i.resetState(e.proto);break;case"24020":i.changeCharHp(e.proto);break;case"24049":i.changeCharMaxHp(e.proto);break;case"24021":i.changeCharMp(e.proto);break;case"24022":i.changeCharHd(e.proto);break;case"24003":i.reliveChar(e.proto);break;case"24006":i.roleDead(e.proto);break;case"24007":i.charTelpet(e.proto);break;case"24018":var B=e.proto;i.buffChangeHp(B.objectId,B.damage,B.damageType);break;case"24019":var H=e.proto;i.buffChangeHp(H.objectId,H.damage,H.damageType);break;case"24031":i.charSkillStateType(e.proto);break;case"24029":i.updateCharData(e.proto);break;case"24037":i.YeManChongZhuang(e.proto);break;case"24045":i.bossHuDongHurt(e.proto);break;case"24027":i.checkPlayer();break;case"24010":i.startPlayAttack(e.proto);break;case"24053":i.stopPlayAttack(e.proto);break;case"25019":var V=e.proto,G=uH.Ins().getPetByid(V.petSceneVO.objectId);if(G){var U=Ph.MODEL.model(Ph.getIndex(V.petSceneVO.petIndex)),F=Oh.MODEL.awayEffect(Oh.getIndex(V.petSceneVO.petStar+1)),q=hn.getIndex(U),j=hn.MODEL.muId(q);q=_n.getIndex(j);var W=_n.MODEL.avatarId(q);ZN.updateCharDisplay(G,W),F&&G.loadEffect("jm"+F,Za.LAYER_BODY_BOTTOM)}}},t.playZhanBaoEnd=function(){for(var e=0;e<Y.zhanBaoCharQueue.length;e++){var t=Y.zhanBaoCharQueue[e];t.hero_id=-1,t.removeReason.push("end remove"),uH.Ins().removeChar(t),t.recover()}var i=0,n=0;if(dr.dtoEnterScene.dtoZhanbao&&dr.dtoEnterScene.dtoZhanbao.isMeWin){for(var s=0;s<dr.dtoEnterScene.dtoZhanbao.herosHPs.length;s++)if(s<3){var o=dr.dtoEnterScene.dtoZhanbao.herosHPs[s];Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.copy.CopyModule"],{hp:o.hp,heroId:s+1}),Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:o.mp,heroId:s+1}),i+=o.hp,n+=o.maxHP}NF.mainChar.setCharBoolValue(i,n)}else dr.dtoEnterScene.dtoZhanbao&&0==dr.dtoEnterScene.dtoZhanbao.isMeWin&&(NF.mainChar.setDeath(),NF.mainChar.play("death"));Y.currMonster=null,NF.Ins().selectChar=null,Y.zhanBaoCharQueue.length=0,uH.Ins().currCid==_a.S_YeZhanBIQI.toString()?this.sendToModule("__ZHANBAO_YZBQ_PLAY_END__",["modules.yzbqc.YzbqcModule"],dr.dtoEnterScene.dtoZhanbao):this.sendToModule("__ZHANBAO_YZBQ_PLAY_END__",["modules.siege.SiegeModule"],dr.dtoEnterScene.dtoZhanbao),this.sendToService(new QA),NF.Ins().showTotalAll(),aH.clear(),dr.dtoEnterScene=null,aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null},t.playZhanBao=function(e){for(var t=0;t<Y.zhanBaoCharQueue.length;t++){var i=Y.zhanBaoCharQueue[t];i.removeReason.push("end remove"),uH.Ins().removeChar(i)}Y.zhanBaoCharQueue.length=0;var n=e.dtoZhanBao;dr.dtoEnterScene=new $o,dr.dtoEnterScene.cid=parseInt(uH.Ins().currCid),dr.dtoEnterScene.type=12,dr.dtoEnterScene.dtoZhanbao=n,NF.Ins().heidTotalAll(),sH.stop(),aH.getInstance().addDto(n),aH.getInstance().playDto(),aH.getInstance().start()},t.moveTo=function(e,t,i,n){var s=YN.getNearPt(PB.pixelsToTile(t,i));yH.Ins().clear(!1),yH.Ins().mainCharMove(s,!1,n),Y.currMonsterPoint=new Uh(t,i)},t.startCreate=function(e){String(e.char_id)==gR.ins.charId?uH.updateHero(e):5==e.charType?qN.showDropToScene(e):3==e.charType||6==e.charType||7==e.charType?NF.Ins().isChangeFinish?this.createMonster(e,e.charType):this.queueCreate.push(e):4==e.charType?this.createDog(e):8==e.charType?this.creatPet(e):this.createChar(e)},t.createDog=function(e){var t=hn.getIndex(e.modelId),i=hn.MODEL.muId(t);i=_n.getIndex(i);var n=uH.monsterDataHash.take(e.modelId);if(!n){var s=hn.MODEL.attributes(t);if(""!=s||!s){var o=JSON.parse(s);o&&(n=aa.formatNewAttrToObject(o),uH.monsterDataHash.put(e.modelId,n))}}var a=_n.MODEL.avatarId(i),r=zN.GetChar();Y.charQueue.put(e.objectId,r,!0),uH.Ins().curentDogObjectID=e.objectId,r.relive(),r.isRecover=!1,r.char_id=e.masterObjectId.toString(),r.objectId=e.objectId,r.cid=uH.Ins().currCid,r.selectEnabled=!1,uH.Ins().addChar(r),r.type=Za.MONSTER,r._proto_=e.char_id,r.isCharMode=!1,r.bodyHeight=_n.MODEL.avatarHeight(i),r.char_name=hn.MODEL.name(t);var l=hn.getIndex(e.modelId),c=(hn.MODEL.type(l),hn.MODEL.scale(l)/100);c<1&&(c=1),r.scale(c,c),ZN.updateCharDisplay(r,a);var u=_n.MODEL.awayEffect(i);""!=u&&null!=u&&"0"!=u&&"0.0"!=u&&r.loadEffect(u,Za.LAYER_BODY_BOTTOM),r.speed=hn.MODEL.speed(l),r.data=e,r.dir=8*Math.random()>>0,r.setCharBoolValue(e.currHP,e.maxHP),r.setXY(e.x,e.y),G.timer.once(400,null,function(){NF.scene.addItem(r)})},t.creatPet=function(e){var t=Y.charQueue.take(e.objectId);if(!t)if(gR.ins.isMasterByObjectId(e.masterObjectId))uH.Ins().createPetHero(e);else{t=zN.GetChar(),Y.charQueue.put(e.objectId,t,!0),t.relive(),t.isRecover=!1,t.objectId=e.objectId,t.cid=uH.Ins().currCid,t.selectEnabled=!1,uH.Ins().addChar(t),t.type=Za.PET,t.isCharMode=!1,t.profession=0;var i=Ph.MODEL.model(Ph.getIndex(e.petIndex)),n=Oh.MODEL.awayEffect(Oh.getIndex(e.petStar+1)),s=hn.getIndex(i),o=hn.MODEL.name(s),a=hn.MODEL.muId(s);s=_n.getIndex(a);var r=_n.MODEL.avatarId(s);ZN.updateCharDisplay(t,r),n&&t.loadEffect("jm"+n,Za.LAYER_BODY_BOTTOM),t.data=e;var l,c=this.getChar(e.masterObjectId),u=rH.GetPetAI();if(t.char_name=e.charName+"的"+o,c)u.setup(t,c),u.start(),rH.pushAI(u),(l=u.getPoint())||(l=YH.instance.get8Grids(NF.mainChar.tilePoint)[0],t.setXY(l.x,l.y-10));else{var d=PB.tileToPixels(new Uh(e.x,e.y));t.setXY(d.x,d.y-10)}t.visible=!0,G.timer.once(400,null,function(){NF.scene.addItem(t),e.masterObjectId==gR.ins.objectId&&t.loadEffect("jn10171",Za.LAYER_BODY_BOTTOM,"jn10171",!1,200,!0,"stand",0,0)})}},t.createMonster=function(e,t){void 0===t&&(t=3);var i=hn.getIndex(e.modelId),n=hn.MODEL.muId(i);n=_n.getIndex(n);var s=uH.monsterDataHash.take(e.modelId);if(!s){var o=hn.MODEL.attributes(i);if(o){var a=JSON.parse(o);a&&(s=aa.formatNewAttrToObject(a),uH.monsterDataHash.put(e.modelId,s))}}var r=_n.MODEL.avatarId(n),l=zN.GetChar();l.isCharMode=!1,Y.charQueue.put(e.objectId,l,!0),l.relive(),l.isRecover=!1,l.char_id=e.char_id.toString(),l.objectId=e.objectId,l.cid=uH.Ins().currCid,l.selectEnabled=!0,uH.Ins().addChar(l),l.type=6==t?Za.COLLECTION:7==t?Za.BUILDING:Za.MONSTER,l._proto_=e.char_id,l.bodyHeight=_n.MODEL.avatarHeight(n),l.char_name=hn.MODEL.name(i);var c=hn.getIndex(e.modelId),u=hn.MODEL.type(c),d=hn.MODEL.scale(c)/100;d<1&&(d=1),l.scale(d,d),ZN.updateCharDisplay(l,r),201==u?l.isElites=!0:202==u&&(l.isBoss=!0,l.mat.scale(d,d)),l.setXY(e.x,e.y);var h=_n.MODEL.awayEffect(n);if(""!=h&&null!=h&&"0"!=h&&"0.0"!=h&&(l.data&&l.data.passID&&l.removeEffect(l.data.passID),l.loadEffect(h,Za.LAYER_BODY_BOTTOM)),l.speed=hn.MODEL.speed(c),l.data=e,1==l.isBoss&&null!=BR.ins.bossHuDunData&&Tu.sendToModule("BOSS_HUNDUN_START",["modules.scene.SceneModule"]),l.dir=6==t?4:e.dir,7==t&&(l.dir=e.dir,l.charProfessionNameColor="#02b0e9",0<e.guidePos?l.charProfessionName=e.guideName+"["+Bl.getCNPos(e.guidePos)+"]":l.charProfessionName=e.building1,l.setCharProfessionNameVisible(!0),l.char_name=e.building2,ZN.setCharTitle(l,e.titles)),l.setCharBoolValue(e.currHP,e.maxHP),300002==e.modelId){l.isBoss=!0;var _=rH.GetCharAI();_.setup(l),rH.pushAI(_)}return e.paths&&e.paths.length&&l.tarMoveTo(e.paths),NF.scene.addItem(l),l},t.createChar=function(e){var t=Y.charQueue.take(e.objectId);if(t?(t.x=e.x,t.y=e.y):(t=aH.createChar(e,e.x,e.y),Y.charQueue.put(e.objectId,t)),1==e.charType?t.type=Za.NPC:2==e.charType&&(t.type=Za.CHAR),t.isCharMode=!0,t.char_name=e.charName,1==parseInt(uH.Ins().currCid)?t.setCharBoolValue(1e4,1e4):t.setCharBoolValue(e.currHP,e.maxHP),t.setCharNameVisible(!0),t.setCharBoolVisible(!0),t.dir=e.dir,t.speed=280,0!=e.camp?e.charName==gR.ins.charName?t.charNameColor="#00ff00":NF.mainChar.camp==e.camp?t.charNameColor="#00ff00":t.charNameColor="#ff0000":t.charNameColor="#ffffff",dr.dtoEnterScene&&13==dr.dtoEnterScene.type&&(e.guild_id==gR.ins.guildId?t.charNameColor="#ffffff":t.charNameColor="#ff0000"),dr.dtoEnterScene&&6==dr.dtoEnterScene.type&&t.ai&&t.ai.stop(),t&&(t.removeTopEffect("jm0026"),2==e.campState?(t.selectEnabled=!1,t.setDeath(),t.play("death")):0==e.campState?(e.currHP<=0&&(t.relive(),this.setCharAI(t,null,!1)),t.play("stand"),t.selectEnabled=!0):1==e.campState&&(t.selectEnabled=!1,t.showTopEffect("jm0026","jm0026")),t.campState=e.campState),t.bodyHeight=NB.BODY_HEIGHT,e.paths&&e.paths.length&&t.tarMoveTo(e.paths),t.char_id=e.char_id.toString(),t.objectId=e.objectId,t.camp=e.camp,t.campState=e.campState,t.data=e,t.isCharObj=!0,0<=e.govPosition&&t.showPosition(e.govPosition),ZN.setCharTitle(t,e.titles),this.doCharPlay([t]),Y.charQueue.put(e.objectId,t,!0),2==e.charType){var i=[];if(null!=Y.charIdQueue.take(t.char_id)){var n=!1;i=Y.charIdQueue.take(t.char_id);for(var s=0;s<i.length;s++){if(i[s].objectId==t.objectId){n=!0;break}n=!1}0==n&&(i.push(t),Y.charIdQueue.put(t.char_id,i,!0))}else i.push(t),Y.charIdQueue.put(t.char_id,i),e.hasYuanshen&&Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[t,e.souloutAdvanStep,e.souloutSkin])}},t.removeChar=function(e){var t=Y.charQueue.take(e);if(t||(t=uH.getHeroByObjectid(e)),t&&5==t.hero_id)uH.Ins().hidePetHero();else{if(t&&t.objectId){var i=uH.Ins().isGetHero(uH.yuanshenHash.take(t.objectId));i&&(rH.removeAI(i),i.removeReason.push("charProxy"),i.ai.stop(),i.visible=!1,uH.Ins().removeChar(i),uH.yuanshenHash.remove(t.objectId),NF.scene.removeItem(i))}Y.charQueue.remove(e),t?(Y.charIdQueue.remove(t.char_id),t.removeReason.push("charProxy"),uH.Ins().removeChar(t)):qN.removePickUP(e)}},t.charMove=function(e){var t=this.getChar(e.objectId);t&&(1<e.paths.length&&e.paths.shift(),t.tarMoveTo(e.paths,!1))},t.stopMove=function(e){var t=this.getChar(e.objectId);t&&(t.isBoss&&BR.ins.isCheckPointBoss,t.stopMove(!0,e.x,e.y))},t.charPlay=function(e){var t;for(var i in e.list)t=e.list[i],this.aiHash.set(t.charId,t.status);G.timer.once(1e3,this,this.doCharPlay,[null])},t.doCharPlay=function(e){var t,i,n=Y.charQueue.take(1);if(n)if(e)for(var s in e)t=e[s],this.setCharAI(t,n,this.aiHash.get(t.char_id));else for(var o in this.aiHash.keys)i=this.aiHash.keys[o],(t=Y.charQueue.take(i))&&this.setCharAI(t,n,this.aiHash.get(i))},t.setCharAI=function(e,t,i){if(i&&t){var n=rH.getAI(e);n||((n=rH.GetPlayerAI()).enemy=t,n.setup(e),rH.pushAI(n)),rH.startAI(e)}else rH.removeAI(e)},t.charStop=function(){var e;for(var t in Y.charQueue.proto)(e=Y.charQueue.proto[t]).type==Za.CHAR&&rH.removeAI(e)},t.getChar=function(e){if(NF.mainChar.objectId==e)return NF.mainChar;var t=Y.charQueue.take(e);return t||(t=uH.getHeroByObjectid(e)),t||null},t.charDead=function(e){var t=this.getChar(e.objectId);if(t){var i=t.point;i=NF.scene.localToGlobal(i),-1<IH.ins.UNION_SKILL.indexOf(e.skillId)?t.doDelay(1200,t,t.timeOutDead):t.doDelay(500,t,t.timeOutDead),t.char_id!=gR.ins.charId&&t.type==Za.MONSTER&&dr.dtoEnterScene&&32==dr.dtoEnterScene.type&&(modules.copy.others.NewPigData.ins.monsterPoint=i,Tu.sendToModule("OPEN_FIRE_PIG_KILL_MONSTER",["modules.copy.CopyModule"])),t.char_id!=gR.ins.charId&&t.type==Za.CHAR?Tu.sendToModule("OTHER_CHAR_DEAD",["modules.scene.SceneModule"],e.objectId):NF.currentDeadHeroID=t.hero_id,7777==BR.ins.curCopyId&&dr.dtoEnterScene&&0!=dr.dtoEnterScene.cid&&22==dr.dtoEnterScene.type&&t.type==Za.CHAR&&t.data&&1==t.data.robot&&zB.ins.checkRainbowAction("robot",t.data.modelId),BR.ins.isCheckPointBoss&&(t.isBoss?zB.ins.playBossExp(new Uh(G.stage.width/2,G.stage.height/2),sJ.getExpPt()):t.type!=Za.MAIN_CHAR&&t.type!=Za.HERO&&zB.ins.playExp(new Uh(G.stage.width/2,G.stage.height/2),sJ.getExpPt())),BR.ins.charDeadXY=new Uh(t.x,t.y),t.type!=Za.MAIN_CHAR&&t.type!=Za.HERO||Tu.sendToModule("CHAR_DEAD",["modules.nav.NavModule"],{job:t.profession})}if(t&&t.isBoss){var n=0,s=0;if(BR.ins.copyBossDeadXY=new Uh(t.x,t.y),t.removeEffect("jm1056"),zB.ins.checkRainbowAction("monster",t.data.modelId),t.isBoss){n=rn.getIndex(BR.ins.curCopyId);var o=rn.MODEL.bossId(n);53==rn.MODEL.cate(rn.getIndex(BR.ins.curCopyId))&&(o=YR.ins.curBossId),qU.ins.updateBossBlood(o,0),15==(s=rn.MODEL.cate(n))?(Tu.sendToModule("BOSS_MIJING_RESULT",["modules.boss.BossModule"],s),sJ.ins.hideCompoment("NavTargetHead")):28==s&&Tu.sendToModule("SCZB_CHENGMEN_DEAD",["modules.newsiege.NewSiegeModule"])}}},t.changeCharHp=function(e){var t=this.getChar(e.objectId);if(t)if(e.objectId==NF.mainChar.objectId);else{t&&(t.serverHp={hp:e.curHp,time:dr.curServerTime});var i=rn.getIndex(BR.ins.curCopyId);if(t.isBoss&&1!=rn.MODEL.cate(i)&&27!=rn.MODEL.cate(i)){i=rn.getIndex(BR.ins.curCopyId);var n=0;n=53==rn.MODEL.cate(i)?YR.ins.curBossId:rn.MODEL.bossId(i),0<e.curHp&&qU.ins.updateBossBlood(n,e.curHp)}}},t.changeCharMaxHp=function(e){var t=this.getChar(e.objId);t&&t.proto&&(t.proto.currHp=e.currentHp,t.proto.maxHP=e.maxHp,t.serverHp={hp:e.currentHp,time:dr.curServerTime})},t.updateCharData=function(e){var t=this.getChar(e.ad.objectId),i=uH.heroQueue;uH.heroHash;if(!t){for(var n=0;n<i.length;n++)if(i[n].objectId==e.ad.objectId){t=i[n];break}if(null==t)return}if(""!=e.ad.guideName?(t.charProfessionNameColor="#02b0e9",0<e.ad.guidePos?t.charProfessionName=e.ad.guideName+"["+Bl.getCNPos(e.ad.guidePos)+"]":t.charProfessionName=e.ad.guideName,t.setCharProfessionNameVisible(!0)):t.setCharProfessionNameVisible(!1),0<e.ad.flyupLevel?(t.setCharFlyupNameVisible(!0),t.setflyupName(e.ad.flyupLevel)):t.setCharFlyupNameVisible(!1),t.wid=e.ad.wid,t.wgid=e.ad.wgid,t.eid=e.ad.eid,t.mid=e.ad.mid,t.dir=e.ad.dir,t.char_name=e.ad.charName,t.camp=e.ad.camp,0!=t.camp?t.char_name==gR.ins.charName?t.charNameColor="#00ff00":t.camp==NF.mainChar.camp?t.charNameColor="#00ff00":t.charNameColor="#ff0000":t.charNameColor="#ffffff",t.objectId==gR.ins.objectId&&0==t.camp){var s=uH.getHero(4);s&&(s.charNameColor="#ffffff")}if(ZN.setCharTitle(t,e.ad.titles),0<=e.ad.govPosition&&t.showPosition(e.ad.govPosition),t.loadAvatarParts("mid",t.mid,!0),t.loadAvatarParts("wid",t.wid),t.loadAvatarParts("wgid",t.wgid),t.loadAvatarParts("eid",t.eid),t.setChuanShiEffect(e.ad.chuanshi),t.setTianHuangLongWu(e.ad.dragonEff),e.ad.hasYuanshen){for(var o=0;o<gR.ins.actorList.length;o++){var a=gR.ins.actorList[o];if(e.ad.objectId==a.objectId)return void Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[NF.mainChar,e.ad.souloutAdvanStep,e.ad.souloutSkin])}var r=[];if(null!=Y.charIdQueue.take(t.char_id)){for(r=Y.charIdQueue.take(t.char_id),o=0;o<r.length;o++)if(r[o].objectId==t.objectId&&uH.Ins().isGetHero(uH.yuanshenHash.take(r[o].objectId))){!0;break}Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[r[o],e.ad.souloutAdvanStep,e.ad.souloutSkin])}else r.push(t),Y.charIdQueue.put(t.char_id,r),e.ad.hasYuanshen&&Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[t,e.ad.souloutAdvanStep,e.ad.souloutSkin])}},t.roleDead=function(e){var t=rn.getIndex(BR.ins.curCopyId);if(1==rn.MODEL.reliveType(t)){p_.toc24006=e;var i=this.getChar(NF.mainChar.objectId);i&&i.doDelay(500,i,i.timeOutDead),Tu.sendToModule("RELIVEVIEW_OPEN",["modules.relive.ReliveModule"])}else 23!=rn.MODEL.cate(t)&&24!=rn.MODEL.cate(t)&&25!=rn.MODEL.cate(t)&&22!=rn.MODEL.cate(t)&&6!=rn.MODEL.cate(t)&&32!=rn.MODEL.cate(t)&&8!=rn.MODEL.cate(t)&&51!=rn.MODEL.cate(t)&&54!=rn.MODEL.cate(t)&&(hN.ins.isOpen("OPEN_FAIL")||Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(BR.ins,BR.ins.exitCopy,[300])}));Y.firstAtt=!0,Y.firstDef=!0,this.attackerArr=[],this.defenderArr=[],this.attackerHash.reset(),this.defenderHash.reset();for(var n=0;n<gR.ins.actorList.length;n++){var s=gR.ins.actorList[n],o=uH.yuanshenHash.take(s.objectId),a=uH.Ins().isGetHero(o);if(a){a.visible=!1,rH.removeAI(a),a.ai.stop();break}}32==rn.MODEL.cate(t)&&BR.ins.exitCopy()},t.reliveChar=function(e){var t=this.getChar(e.objectId);if(t){t.proto.currHP=e.curHp,t.proto.maxHP=e.maxHp,t.setCharBoolValue(e.curHp,e.maxHp);var i=gR.ins.actorById(t.hero_id);i&&0<i.maxHD&&(t.setCharInnerVisible(!0),t.setCharInnerValue(i.maxHD,i.maxHD)),t.relive(),t.play("stand"),t.char_id==gR.ins.charId&&(G.timer.once(1e3,this,this.timeOutAutoAttack),Tu.sendToModule("RELIVEVIEW_CLOSE",["modules.relive.ReliveModule"]));var n=uH.Ins().isGetHero(uH.yuanshenHash.take(e.objectId));n&&(n.visible=!0,rH.pushAI(n.ai),n.ai.start())}if(t&&t.char_id==gR.ins.charId){var s=!0,o=BR.ins.curCopyId;if(0!=o){var a=rn.getIndex(o);31==rn.MODEL.cate(a)&&(s=!1)}s&&uH.reliveHeroAll(),Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:e.curHp,heroId:t.hero_id})}dr.dtoEnterScene&&(41!=dr.dtoEnterScene.type&&42!=dr.dtoEnterScene.type||null!=BR.ins.enterScenceBossInfo&&sH.fights(BR.ins.enterScenceBossInfo.objectId))},t.timeOutAutoAttack=function(){if(BR.ins.toc25000){var e=rn.getIndex(BR.ins.toc25000.copyId),t=rn.MODEL.cate(e);-1<this.autoRelive.indexOf(t)&&null!=BR.ins.enterScenceBossInfo&&sH.fights(BR.ins.enterScenceBossInfo.objectId)}},t.charTelpet=function(e){var t=this.getChar(e.objectId);t&&t.gotoPoint(e.x,e.y,!0,!0)},t.buffChangeHp=function(e,t,i){var n=this.getChar(e);n&&sH.onHurt([n],t,i,!1,0)},t.bossHuDongHurt=function(e){var t=this.getChar(e.objectId);if(t){for(var i=0,n=Vo.types.length,s=0;i<n;i++)7!=e.demageType?e.demageType!=1<<Vo.types[i]||(s=Vo.types[i]):s=7;0==s&&(s=1),sH.onHurt([t],e.finalValue,s,!1,0,e.skillID,dr.curServerTime,!0)}},t.charSkillStateType=function(e){var t=this.getChar(e.objectId);if(t){for(var i,n,s,o=e.list.length,a=0,r="",l=0;l<o;l++)if(s=(i="00000000").split(""),n="",0==e.list[l])r+=i;else{n=(255&parseInt(e.list[l])).toString(2).split("").reverse().join("");for(var c=0;c<i.length;c++)n.charAt(c)&&n.charAt(c)!=s[c]?s[c]=n.charAt(c):s[c]="0";r+=s.join("")}for(l=0;l<o;l++)for(var u=0;u<8;u++){var d=0;r[++a]&&(d="0"==r[a]?0:1),d?nH.addBuff(t.char_id,a,0,0,t.objectId):nH.removeBuff(t.char_id,a,t.objectId)}}},t.changeCharMp=function(e){this.getChar(e.objectId)&&e.objectId==NF.mainChar.objectId&&Tu.sendToModule("UpdateCurrMP",["modules.actor.ActorModule"],{hp:e.curMp,heroId:1})},t.changeCharHd=function(e){var t=this.getChar(e.objectId);t&&t.setCharInnerValue(e.curHd)},t.charCastSkillHuit=function(e){var t=this.getChar(e.casterObjId),i=this.getChar(e.targetObjId);if(t&&i&&(dr.dtoEnterScene&&(5==dr.dtoEnterScene.type&&23==dr.dtoEnterScene.type||(t.type==Za.CHAR&&i.type==Za.MAIN_CHAR&&1==Y.firstAtt&&(this.attackerArr.push(e.casterObjId),this.att_IdArr.push(t.char_id),Y.firstAtt=!1,this.attName=this.attackerHash.take(e.casterObjId),this.attName||(t.data?this.attName=t.data.charName:t.proto&&(this.attName=t.proto.charName),this.attackerHash.put(e.casterObjId,this.attName)),n1.ins.changeText(!0,this.attName,this.beAttack)),t.type==Za.MAIN_CHAR&&i.type==Za.CHAR&&1==Y.firstDef&&(this.defenderArr.push(e.targetObjId),this.def_IdArr.push(i.char_id),Y.firstDef=!1,this.defName=this.defenderHash.take(e.targetObjId),this.defName||(i.data?this.defName=i.data.charName:i.proto&&(this.defName=i.proto.charName),this.defenderHash.put(e.targetObjId,this.defName)),n1.ins.changeText(!0,this.defName,this.attack,i.char_id),G.timer.once(5e3,this,function(){n1.ins.changeText(!1)})))),0<e.skillId&&!i.isDeath)){0<t.hero_id&&(t.lockMove=!1),l=Vn.getIndex(e.skillId);var n=Vn.MODEL.effectStatusId(l);0<n&&sH.playzhudongSkill(e.casterObjId,n);var s=Vn.MODEL.singingTime(l);if(s&&0<s);else if(305!=e.skillId||t.isDeath){if(103!=e.skillId&&!t.isDeath){if(10195==e.skillId)for(var o=0;o<e.battleUnitVOs.length;o++){var a=e.battleUnitVOs[o],r=this.getChar(a.targetObjId);r&&oH.playSkill2(t,r,e.skillId)}oH.playSkill2(t,i,e.skillId)}}else t.lockMove=!0,oH.playSkill2(t,i,e.skillId);var l=0,c=0;-1<IH.ins.UNION_SKILL.indexOf(e.skillId)&&(c=Vn.MODEL.nextCastCD(l),1==t.profession?t.pauseAct("attack",c):t.pauseAct("skill",c)),10196==e.skillId&&dr&&dr.dtoEnterScene&&32==dr.dtoEnterScene.type&&Tu.sendToModule("MAIN_CHAR_USE_SKILL",["modules.copy.CopyModule"],i.point)}for(var u=0;u<uH.heroQueue.length;u++){var d=uH.heroQueue[u],h=d.getCharInnerValue();for(o=0;o<e.battleUnitVOs.length;o++){a=e.battleUnitVOs[o];d.objectId==a.targetObjId&&(h-=a.hdChangeValue)}d.setCharInnerValue(h)}var _=0;t&&(t.type==Za.MONSTER&&(_=0),_=6==t.profession?3:t.profession);var f=!1;(t&&0<t.hero_id||i&&0<i.hero_id)&&(f=!0),this.timeOutShowHurt(t,e,_,f),i&&i.isBoss&&(BR.ins.copyBossDeadXY=new Uh(i.x,i.y)),e.casterObjId==NF.mainChar.objectId&&(Y.attackTimeForYzbqc=pt.now(),i&&i.isBoss?(this.clearMapFocus(),Y.attackTime=pt.now(),Y.attackTarget={isBoss:!0,objectId:e.targetObjId},i.data&&(Y.attackTarget={isBoss:!0,objectId:e.targetObjId,modelId:i.data.modelId,charName:i.data.charName}),i&&i.type==Za.MONSTER&&0==i.isRuning&&sH.getInstance().showShakeByAttack(i,t,400)):i&&!i.isBoss&&(Y.attackTime=pt.now(),Y.attackTarget={isBoss:!1,objectId:e.targetObjId},i.data&&(Y.attackTarget={isElites:i.isElites,isBoss:!1,modelId:i.data.modelId,objectId:e.targetObjId,charName:i.data.charName,guideName:i.data.guideName,sex:i.data.sex,roleType:i.data.professional})),Tu.sendToModule("HURT_MESSAGE_UPDATE",["modules.nav.NavModule"],e))},t.checkPlayer=function(){var e=BR.ins.toc24027.list;if(0<this.attackerArr.length){var t=[];if(0<e.length){this.attackerHash.take(this.attackerArr[0]);for(var i=0;i<e.length;i++)t.push(e[i].name);-1==t.indexOf(this.attName)&&(Y.firstAtt=!0,Y.firstDef=!0)}else Y.firstAtt=!0,Y.firstDef=!0}},t.resetState=function(e){var t=[],i=this.att_IdArr[0],n=this.def_IdArr[0],s=e.objectId;if(s){var o=this.getChar(s);if(o&&o.type!=Za.MAIN_CHAR&&o.char_id==i&&o.char_id==n){var a=Y.charIdQueue.take(o.char_id);if(a&&0<a.length)for(var r=0;r<a.length;r++)a[r]&&a[r].objectId&&t.push(a[r].objectId);for(var l=0;l<t.length;l++)t[l]==s&&t.splice(l);if(0<t.length)return;Y.firstAtt=!0,Y.firstDef=!0,this.attackerArr=[],this.defenderArr=[]}}},t.timeOutShowHurt=function(e,t,i,n){var s;for(var o in void 0===i&&(i=0),void 0===n&&(n=!0),e&&0<t.suckValue&&sH.onHurt([e],t.suckValue,2,!1,i,t.skillId,dr.curServerTime,!1,n),t.battleUnitVOs){s=t.battleUnitVOs[o];var a=this.getChar(s.targetObjId);if(a)if(1==s.damageType)sH.onHurt([a],s.damage,s.damageType,!1,i,t.skillId,dr.curServerTime,!1,n);else{var r=0,l=Vo.types.length;for(1==(1&s.damageType>>26)&&(s.damageType=this.removePos(s.damageType,10)),1==(1&s.damageType>>27)&&(s.damageType=this.removePos(s.damageType,11)),1==(1&s.damageType>>28)&&(s.damageType=this.removePos(s.damageType,12));r<l;r++){0!=(s.damageType&1<<Vo.types[r])&&sH.onHurt([a],s.damage,Vo.types[r],!1,i,t.skillId,dr.curServerTime,!1,n)}}a&&0<s.reboundValue&&sH.onHurt([a],s.reboundValue,3,!1,i,t.skillId,dr.curServerTime,!1,n,e);var c=a&&(a.type==Za.MAIN_CHAR||a.type==Za.HERO||a.type==Za.CHAR),u=a&&a.isHashenmoDun;e&&(e.type==Za.CHAR||e.type==Za.MAIN_CHAR||e.type==Za.HERO)&&c&&u&&a.doDelay(300,a,sH.playNotEffectImg,[a])}},t.removePos=function(e,t){var i=e>>t+1;return(i<<=t+1)+(e&(1<<t)-1)},t.YeManChongZhuang=function(e){var t=this.getChar(e.casterVO.owner),i=this.getChar(e.targetVO.owner);if(t&&i&&t.hasOwnProperty("faceTo")&&t.faceTo(i),t)var n=t.dir;8==uH.Ins().currCkType&&(t&&i&&0<ol.distance(t.point,i.point)&&(n=VB.getDretion(t.point.x,t.point.y,i.point.x,i.point.y),t.dir=n));if(i&&t&&(n=VB.getDretion(i.point.x,i.point.y,t.point.x,t.point.y),i.dir=n),!t||t.tilePoint){var s=[];if(0<e.targetVO.owner&&t){var o=YN.getCZ(t.tilePoint,n);o.tarData={tar:i,pt:new Uh(e.targetVO.tx,e.targetVO.ty)},s=[o.tarData]}oH.playChongZhuangSkill(t,new Uh(e.casterVO.tx,e.casterVO.ty),s,e.speed)}},t.clearMapFocus=function(){dr.dtoEnterScene&&15==dr.dtoEnterScene.type&&Tu.sendToModule("NOTICE_REMOVE_FOCUS",["modules.nav.NavModule"])},t.startPlayAttack=function(e){var t=this.getChar(e.casterObjId),i=this.getChar(e.targetObjId);if(t&&i&&(0<=t.InterruptsingSkillIdArr.indexOf(e.skillId)&&t.InterruptsingSkillIdArr.splice(t.InterruptsingSkillIdArr.indexOf(e.skillId),1),dr.dtoEnterScene&&0<e.skillId&&!i.isDeath&&(oH.playSkill2(t,i,e.skillId),-1<Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(e.skillId)))){var n=Vn.getIndex(e.skillId),s=Vn.MODEL.nextCastCD(n);1==t.profession?t.pauseAct("attack",s):t.pauseAct("skill",s)}},t.stopPlayAttack=function(e){var t=this.getChar(e.casterObjId);if(t&&0<e.skillId){-1==t.InterruptsingSkillIdArr.indexOf(e.skillId)&&t.InterruptsingSkillIdArr.push(e.skillId);var i=Vn.getIndex(e.skillId),n=Vn.MODEL.effect_play(i);t.removeEffect(n),t.play("stand")}},Y.maincharCaiji=function(e,t,i){var n=Y.charQueue.take(t);7777!==BR.ins.curCopyId&&null!=n&&n.data&&6==n.data.charType&&DN.instance.reqCaiJiStartInfo(i)},Y.maincharmoveEnd=function(e,t,i){var n=Y.charQueue.take(t);sH.fights(i),null!=n&&(n.isDeath||(Y.currMonster=NF.Ins().selectChar=n,0==e&&1==t&&(of.ins.fightStatus=!0,sH.start()),NF.Ins().selectChar=n))},Y.maincharmoveEndForYeZhanBiQi=function(e,t,i){sH.fights(i);var n=Y.charQueue.take(i);null!=n&&(n.isDeath||(Y.currMonster=NF.Ins().selectChar=n,of.ins.fightStatus=!0,sH.start(),NF.Ins().selectChar=n))},Y.zhanBaoCharQueue=[],Y.currMonsterPoint=null,Y.currMonster=null,Y.firstAtt=!0,Y.firstDef=!0,Y.attackTime=0,Y.attackTarget=null,Y.attackTimeForYzbqc=NaN,f(Y,["charQueue",function(){return this.charQueue=new jl},"charIdQueue",function(){return this.charIdQueue=new jl}]),Y}(),dF=function(e){function t(){this._skillView=null,this._mijiLearnV=null,this._mijiComposeV=null,this._mijiShowV=null,this._mijiLaoyinV=null,this._seaGet=null,this._seaAirZhiSheng=null,this._innerAttrPillV=null,this._talentView=null,this._talentLearnView=null,this._talentResetView=null,this._talentOkView=null,this._talentFjView=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("skill")),hN.ins.registPanel("SKILL_MAINVIEW",b1,"_skillView",this,{wait:hN.wait(hN.waitRes(e)),layer:"layout",clearAll:!0,mask:!1}),hN.ins.registPanel("MIJI_LEARN",y1,"_mijiLearnV",this,{mask:!0}),hN.ins.registPanel("MIJI_COMPOSE",g1,"_mijiComposeV",this,{mask:!0}),hN.ins.registPanel("MIJI_SHOW",I1,"_mijiShowV",this,{mask:!0}),hN.ins.registPanel("NEIGONG_MAIN",cK,"_innerView",this,{mask:!0}),hN.ins.registPanel("MIJI_LAOYIN",m1,"_mijiLaoyinV",this,{mask:!0}),hN.ins.registPanel("NEIGONG_ACTIVED_SHOW_VIEW",lK,"inner_activedView",this,{wait:hN.waitRes([_r.getLayoutsPath("functionActive")]),mask:!0}),hN.ins.registPanel("SEA_AIR_GETVIEW",v1,"_seaGet",this,{wait:hN.wait(hN.waitRes(e)),mask:!0}),hN.ins.registPanel("SEA_AIR_ZS_GETVIEW",_K,"_seaAirZhiSheng",this,{mask:!0}),hN.ins.registPanel("TALENT_MAINVIEW",T1,"_talentView",this,{wait:hN.wait(hN.waitRes(e)),layer:"layout",clearAll:!0,mask:!1}),hN.ins.registPanel("TALENT_LEARN_MAINVIEW",w1,"_talentLearnView",this,{mask:!0}),hN.ins.registPanel("TALENT_RESET_MAINVIEW",S1,"_talentResetView",this,{mask:!0}),hN.ins.registPanel("TALENT_OK_MAINVIEW",x1,"_talentOkView",this,{mask:!0}),hN.ins.registPanel("TALENT_FENJIE_MAINVIEW",k1,"_talentFjView",this,{mask:!0}),hN.ins.registPanel("INNER_ATTR_PILL_VIEW",p1,"_innerAttrPillV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["InnerAttributePill"],["CInnerAttrPillModel"])),mask:!0})}b(t,"modules.skill.proxys.SkillMainProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":for(var i=new Array,n=0;n<Vn.count;n++){var s=new Zt;s.specialId=Vn.MODEL.key(n),s.type=1,i.push(s)}for(var o=1;o<4;o++)eB.getInstance().setSkillHash(i.slice(),o);UR.instance.currentPoint;break;case"SKILLVIEW_OPEN_RED":Nj.globalIdx=0,IH.ins.forRed=!0;case"SKILLVIEW_OPEN":var a=e.proto;if(a&&a.hasOwnProperty("selectedInex")){var r=null;a.hasOwnProperty("backID")&&(r=a.backID),hN.ins.open("SKILL_MAINVIEW",a,r)}else hN.ins.open("SKILL_MAINVIEW",e.proto);break;case"GAIN_NEWSKILL":zB.ins.showGetSkillIcon(e.proto);break;case"SKILL_UPGRADE":t._skillView&&t._skillView.parent&&t._skillView.update([e.proto]);break;case"10501":var l=e.proto;l&&(IH.ins.skillHash=l.skillHash,IH.ins.hasSummonSkill()&&Tu.sendToModule("LEARN_SUMMON_SKILL",["modules.scene.SceneModule"]));break;case"10504":var c=e.proto;c&&IH.ins.updateSkill(c.roleIndex,c.skillList);break;case"21106":var u=e.proto;t._skillView&&t._skillView.parent&&(u.type==fa.JM.type&&gR.ins.updateVein(),t._skillView.update([e.proto]));break;case"10205":var d=e.proto.list[0];parseInt(d.type)==aR.COPPER.id&&0<parseInt(d.value)&&hN.ins.isOpen("SKILL_MAINVIEW")&&t._skillView&&"3"!=t._skillView.vsc.selectId&&t._skillView.update();break;case"21409":e.proto;t._mijiLaoyinV&&t._mijiLaoyinV.parent&&t._mijiLaoyinV.updateStatus(),t._skillView&&t._skillView.parent&&t._skillView.updateImde(e.proto),t._mijiLaoyinV&&t._mijiLaoyinV.parent&&t._mijiLaoyinV.updateStatus();break;case"21413":var h=e.proto;t._skillView&&t._skillView.parent&&t._skillView.updateImde(h);break;case"21403":var _=e.proto;_&&(iB.ins.updateMiji(_.roleIndex,_.dto,1),hN.ins.close("MIJI_LEARN"));break;case"21404":var f=e.proto;f&&iB.ins.updateMiji(f.roleIndex,f.dto,3);break;case"21406":var p=e.proto;p&&(iB.ins.updateMiji(p.roleIndex,p.dto,2),t._skillView&&t._skillView.parent&&t._skillView.update());break;case"21408":var g=e.proto;g&&t._mijiComposeV.showResult(g.newMijiId);break;case"MIJI_UPGRADE":case"MIJI_ADD":t._skillView&&t._skillView.parent&&t._skillView.update([e.proto]);break;case"MIJILEARN_OPEN":hN.ins.toggle("MIJI_LEARN",e.proto);break;case"MIJICOMPOSE_OPEN":hN.ins.open("MIJI_COMPOSE");break;case"MIJI_LAOYIN":hN.ins.toggle("MIJI_LAOYIN");break;case"MIJISHOW_OPEN":hN.ins.toggle("MIJI_SHOW");break;case"FUWEN_CHANGED":t._skillView&&t._skillView.parent&&3==t._skillView.vsc.selectedIndex&&t._skillView.update();break;case"UPDATE_INNER_DATA":t._skillView&&t._skillView.parent&&1==t._skillView.vsc.selectedIndex&&t._skillView.update([e.proto]);break;case"30252":var v=e.proto.innerData;tB.ins.updateInnerData(v.index,v),tB.ins.updateLvLimit();break;case"30253":var m=e.proto.innerDatas;tB.ins.updateAllInnerDatas(m),tB.ins.updateLvLimit();break;case"24035":var y=e.proto;IH.ins.replaceSKILL(y);break;case"24043":var I=e.proto;61!=I.passiveSkillType&&62!=I.passiveSkillType||(IH.ins.isSpecial_LD_Type=61==I.passiveSkillType?1:2),sH.playPassiveSkill(I.roleIndex,I.passiveSkillType);break;case"30161":break;case"30163":break;case"30165":break;case"BP_UPDATE":sB.ins.updateTalent(),t._skillView&&t._skillView.vsc.selectedView&&t._skillView.vsc.selectedView instanceof modules.skill.views.talent.TalentMainView&&(t._talentView=t._skillView.vsc.selectedView,t._talentView.showTalentInfo()),t._talentLearnView&&t._talentLearnView.parent&&t._talentLearnView.updateGoods();break;case"OPEN_SOUL_POWER_REFRESH_PANEL":t._seaGet&&t._seaGet.parent&&t._seaGet.update();break;case"OPEN_SOUL_POWER_GET_PANEL":hN.ins.open("SEA_AIR_GETVIEW");break;case"OPEN_SOUL_ADD_PANEL":hN.ins.open("SEA_AIR_ZS_GETVIEW",e.proto.num);break;case"INNER_ATTR_PILL_VIEW":var b=e.proto;hN.ins.open("INNER_ATTR_PILL_VIEW",{roleIndex:b.roleIndex});break;case"30255":case"30257":case"30259":tB.ins.updateInnerAttrPillInfo(e.proto),t._innerAttrPillV&&t._innerAttrPillV.updateByVSC(e.proto);break;case"OPEN_TALENT_RESET_PANEL":null!=e.proto&&hN.ins.open("TALENT_RESET_MAINVIEW",{roleIndex:e.proto.roleIndex});break;case"OPEN_TALENT_LEARN_PANEL":null!=e.proto&&hN.ins.open("TALENT_LEARN_MAINVIEW",{data:e.proto.data});break;case"REFRES_TALENT_LEARN_PANEL":t._talentLearnView&&t._talentLearnView.parent&&t._talentLearnView.refreshTips(e.proto.data);break;case"30822":sB.ins.updateTalent(),t._skillView&&t._skillView.vsc.selectedView&&t._skillView.vsc.selectedView instanceof modules.skill.views.talent.TalentMainView&&(t._talentView=t._skillView.vsc.selectedView,t._talentView.showTalentInfo()),t._talentResetView&&t._talentResetView.parent&&hN.ins.close("TALENT_RESET_MAINVIEW");break;case"30824":sB.ins.updateTalent();var w=e.proto;if(hN.ins.open("TALENT_OK_MAINVIEW",{skillid:w.skillId,level:w.level}),t._skillView&&t._skillView.vsc.selectedView&&t._skillView.vsc.selectedView instanceof modules.skill.views.talent.TalentMainView&&(t._talentView=t._skillView.vsc.selectedView,t._talentView.showTalentInfo(!w.isNew)),t._talentLearnView&&t._talentLearnView.parent){var x=sB.ins.talentRedPointHash.take(w.skillId),S=sB.ins.getTypeBySkillIdAndLv(w.skillId,w.level);S&&(S.isLearn=x.showRed,t._talentLearnView.showInfo(S))}break;case"30827":sB.ins.updateTalent(),t._skillView&&t._skillView.vsc.selectedView&&t._skillView.vsc.selectedView instanceof modules.skill.views.talent.TalentMainView&&(t._talentView=t._skillView.vsc.selectedView,t._talentView.showTalentInfo());break;case"RESFRESH_BACKPACK_INFO":t._talentFjView&&t._talentFjView.refreshFenJiePanel();break;case"OPEN_TALENT_FENJIE_PANEL":hN.ins.open("TALENT_FENJIE_MAINVIEW",null)}},i.showPanel=function(e,t){if("MIJI_LEARN"==e){var i=parseInt(t);this._mijiLearnV.update(i)}else"SKILL_MAINVIEW"==e?t&&(t.hasOwnProperty("_subIndex_")?this._skillView.openSelectIndex=t._subIndex_:t.hasOwnProperty("selectedInex")&&(this._skillView.openSelectIndex=t.selectedInex)):"SEA_AIR_GETVIEW"==e?this._seaGet.update():"SEA_AIR_ZS_GETVIEW"==e?this._seaAirZhiSheng.update(t):"TALENT_RESET_MAINVIEW"==e?this._talentResetView.showReset(t.roleIndex):"TALENT_LEARN_MAINVIEW"==e?this._talentLearnView.showInfo(t.data):"TALENT_OK_MAINVIEW"==e&&this._talentOkView.showInfo(t.skillid,t.level)},i.closePanel=function(e,t){},t}(),hF=function(e){function t(){var e=this;e.souloutMainView=null,e.souloutAdvance=null,e._soulCopySuccessView=null,e._soulDetal=null,e._soulActivityPanel=null,e._soulSkinView=null,e._soulPropTip=null,t.__super.call(e),hN.ins.registPanel("SOULOUT_V",TJ,"souloutMainView",e,{wait:hN.wait(hN.waitAtlas("soulout"),hN.waitConfig(["SpiritResource","SpiritStampResource","SpiritAdvanceResource","StampSkillResource","SpiritSkillResource","SkillGridResource","MoreReceiveResource","ConfigBigMonthCard","YuanGodActive","ConfigSpiritSkinResource","ConfigSoulSkinSkill","ConfigSkinTalentResource"],["SpiritResource","SpiritStampResource","SpiritAdvanceResource","StampSkillResource","SpiritSkillResource","SkillGridResource","MoreReceiveResource","ConfigTqyueka","YuanGodActive","CSoulSkinResource","CSoulSkinSkillModel","CSoulTalentSkillModel"])),layer:"layout"}),hN.ins.registPanel("SoulSkinMainView",CJ,"_soulSkinView",e,{wait:hN.wait(hN.waitAtlas("soulskin"),hN.waitConfig(["ConfigSoulSkinName","ConfigSpiritSkinResource","ConfigSoulSkinSkill","ConfigSkinTalentResource"],["CSoulSkinNameModel","CSoulSkinResource","CSoulSkinSkillModel","CSoulTalentSkillModel"])),layer:"layout"}),hN.ins.registPanel("SoulSkinGoodsTip",O1,"_soulPropTip",e,{wait:hN.wait(hN.waitAtlas("soulskin"),hN.waitConfig(["ConfigSoulSkinName","ConfigSpiritSkinResource","ConfigSoulSkinSkill","ConfigSkinTalentResource"],["CSoulSkinNameModel","CSoulSkinResource","CSoulSkinSkillModel","CSoulTalentSkillModel"])),layer:"panel",clickClose:!1}),hN.ins.registPanel("SOULOUT_ADVANCE",gK,"souloutAdvance",e,{mask:!0}),hN.ins.registPanel("SOULOUT_DETAIL",vK,"_soulDetal",e,{mask:!0}),hN.ins.registPanel("SoulCopySuccessView",A1,"_soulCopySuccessView",e,{mask:!0,clickClose:!1}),hN.ins.registPanel("SoulOutAdvActiveView",M1,"_soulActivityPanel",e,{mask:!0,clickClose:!1})}b(t,"modules.soul.proxys.SouloutProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"BP_UPDATE":t.souloutMainView&&t.souloutMainView.parent&&t.souloutMainView.vsc.updateSelectedView(e),hN.ins.isOpen("SOULOUT_ADVANCE")&&t.souloutAdvance.update(),t._soulSkinView&&t._soulSkinView.parent&&t._soulSkinView.vsc.updateSelectedView(i);break;case"31010":var i=e.proto;$f.instance.copyTime=i.time,$f.instance.hasReward=i.hasReward,oB.ins.upateSkinInfo(i),t.souloutMainView&&t.souloutMainView.parent&&t.souloutMainView.vsc.updateSelectedView(e),hN.ins.isOpen("SOULOUT_ADVANCE")&&t.souloutAdvance.update(),t._soulSkinView&&t._soulSkinView.parent&&t._soulSkinView.vsc.updateSelectedView(i),AN.reqRedPt(__.equipCareList);break;case"OPEN_SOUL_COPY_SUCCESS_PANEL":hN.ins.isOpen("SoulCopySuccessView")||hN.ins.open("SoulCopySuccessView");break;case"21205":var n=e.proto.copyId;27==rn.MODEL.cate(rn.getIndex(n))&&t.souloutMainView&&t.souloutMainView.parent&&t.souloutMainView.vsc.updateSelectedView();break;case"OPEN_SOUL_ADVANCE_PANEL":hN.ins.open("SoulOutAdvActiveView");break;case"OPEN_SOUL_COPY_MAIN_PANEL":hN.ins.isOpen("SOULOUT_V")||hN.ins.open("SOULOUT_V",e.proto)}},i.showPanel=function(e,t){switch(e){case"SoulCopySuccessView":break;case"SOULOUT_DETAIL":this._soulDetal&&this._soulDetal.parent&&this._soulDetal.showValue(t);break;case"SOULOUT_V":t&&t.hasOwnProperty("selectedIndex")&&(this.souloutMainView.vsc.selectedIndex=t.selectedIndex);break;case"SoulOutAdvActiveView":hN.ins.isOpen("SoulOutAdvActiveView")&&this._soulActivityPanel.showSoulAdvance();break;case"SoulSkinMainView":break;case"SoulSkinGoodsTip":this._soulPropTip&&this._soulPropTip.update(t)}},i.closePanel=function(e,t){},t}(),_F=function(e){function t(){this._soulPreviewPanel=null,this._soulActivityPanel=null,t.__super.call(this),hN.ins.registPanel("SoulPreviewPanel",D1,"_soulPreviewPanel",this,{wait:hN.wait(hN.waitAtlas(["soul"]),hN.waitConfig(["YuanGodActive"],["YuanGodActive"])),mask:!1,layer:"layout"}),hN.ins.registPanel("SoulActivityView",L1,"_soulActivityPanel",this,{mask:!0,clickClose:!1})}b(t,"modules.soul.proxys.SoulProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_SOUL_PRIVIEW_MAIN_PANEL":hN.ins.isOpen("SoulPreviewPanel")||hN.ins.open("SoulPreviewPanel");break;case"OPEN_SOUL_JIEFENG_PANEL":case"OPEN_SOUL_PROVIEW_ACTIVITY_PANEL":break;case"30392":var t=e.proto;Vf.instance.update30392(t),this._soulPreviewPanel&&this._soulPreviewPanel.parent&&this._soulPreviewPanel.updateView(),0<Vf.instance.currentActivityPart&&hN.ins.open("SoulActivityView")}},i.showPanel=function(e,t){switch(e){case"SoulActivityView":this._soulActivityPanel&&this._soulActivityPanel.parent&&this._soulActivityPanel.showData()}},i.closePanel=function(e,t){},t}(),fF=function(e){function t(){this.shipFight=0,this.sgr_mianView=null,this.sgr_activeView=null,this.sgr_activedView=null,this.sgrModel=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("specialgodring")),hN.ins.registPanel("SGRING_ACTIVE_VIEW",P1,"sgr_activeView",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(rc.specialgodring_A,rc.specialgodring_C)),mask:!1,layer:"layout"}),hN.ins.registPanel("SGRING_ACTIVED_SHOW_VIEW",kK,"sgr_activedView",this,{wait:hN.waitRes([_r.getLayoutsPath("specialgodring"),_r.getLayoutsPath("functionActive")]),mask:!0}),this.sgrModel=aB.instance}b(t,"modules.specialgodring.proxys.SGRMainProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_SGR_MIAN_VIEW":hN.ins.open("SGRING_MAIN_VIEW");break;case"OPEN_SGR_ACTIVE_VIEW":hN.ins.open("SGRING_ACTIVE_VIEW",e.proto,"ACHIEVE_NEW_MAIN_VIEW");break;case"OPEN_SGR_TASK_VIEW":hN.ins.open("SGRING_TASK_VIEW");break;case"23227":var t=e.proto;hN.ins.open("SGRING_ACTIVED_SHOW_VIEW",t.ringid-1),1==t.ringid&&sJ.ins.showCompoment("Navheji")}},i.showPanel=function(e,t){"SGRING_ACTIVE_VIEW"==e&&this.sgr_activeView&&this.sgr_activeView.setData(t),"SGRING_ACTIVED_SHOW_VIEW"==e&&this.sgr_activedView&&this.sgr_activedView.showData(t)},i.closePanel=function(e,t){},t}(),pF=function(e){function t(){this._inited=!1,t.__super.call(this)}return b(t,"modules.task.proxys.TaskAutoEquProxy",bp),t.prototype.subHandler=function(e){switch(e.actionOrder){case"BP_INIT":return}},t}(),gF=function(e){function S(){this._lockSceneView=null,this.m_WellCome=null,this.wellcomePaths=[],this.m_loading=!1,this.hasWelcome=!1,this.welcomeEnd=!1,this.m_Frame=null,this.clickTaskPanel=!1,this.isPlayEffecting=!1,this._BossId=null,S.__super.call(this),hN.ins.registPanel("PLAY_UPGRADE_DIRECTION",CK,"",this,{wait:hN.wait(hN.waitRes([_r.getLayoutsPath("task")])),mask:!0}),hN.ins.registPanel("LOCK_SCENE_HOLLOW",TK,"_lockSceneView",this,{mask:!1})}b(S,"modules.task.proxys.TaskProxy",bp);var t=S.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"11901":var i=e.proto,n=!1,s=!1,o=!1,a=null;if(PH.hasTask()){a=PH.Ins().info;var r=zN.getNPC(a.commitNPC+"");r&&r.removeTopEffect("mjm1181"),a.waitZhanBao||i.taskKey==a.taskId&&i.status==a.status||(BB.attackMonsterMode=0,n=2!=i.status||(4==i.tarVo.tarType||15==i.tarVo.tarType||13==i.tarVo.tarType)),i.status!=a.status&&a.clearGuide(),0==(o=i.taskKey!=a.taskId)&&a&&3==i.status&&(o=!0)}PH.Ins().update(i),!n&&PH.Ins().isNewHands&&null==a&&(s=!0,2==(a=PH.Ins().info).status?n=4==a.target.tarType||15==a.target.tarType||13==a.target.tarType:3==a.status&&(n=0<a.commitNPC)),3==(a=PH.Ins().info).status&&(r=zN.getNPC(a.commitNPC+""))&&r.showTopEffect("mjm1181","mjm1181"),PH.Ins().isFirstTask()&&!this.m_loading?this.showWellcome():this.hasWelcome||(PH.hasTask()?(this.showTaskTrack(!n),n&&(s?G.timer.once(1e3,this,this.doAutoTask):this.doAutoTask())):(G.timer.clear(this,this.showAutoArr),BB.attackMonsterMode=0,this.closeTaskTrace())),HP.taskLoadPro(a.taskId,a.status),o&&AY.showing&&(a.finishEffect&&3==a.status?AY.getInstance().showTaskEffect("jm1274"):a.recieveEffect&&AY.getInstance().showTaskEffect("jm1131"));break;case"11905":var l=e.proto,c=l.zhanbao,u=NF.mainChar,d=S.TARGETHISTORY?S.TARGETHISTORY.data:null,h=S.TARGETHISTORY?S.TARGETHISTORY.targetId:this._BossId,_=null;_=d?PB.tileToPixels(new Uh(d.x,d.y)):uH.getCallBossPointByDir(u.tilePoint,u.dir),this.clearTaskTarget();var f=new $o;f.cid=parseInt(uH.Ins().currCid),f.dtoZhanbao=c,f.monsterId=parseInt(h),f.x=_.x,f.y=_.y,f.currHP=l.currentHP,f.type=10,this.sendToModule("TASKBOOS",["modules.scene.SceneModule"],f),Tu.sendToModule("HIDE_ACT_ICON",["modules.nav.NavModule"]);break;case"BOOSZHANBAOBACK":var p=gR.ins.cId,g=Pn.getIndex(parseInt(p));if(10==Pn.MODEL.type(g)||"1003"==p?this.showFrame(!1):this.closeFrame(),PH.hasTask()&&(a=PH.Ins().info,modules.task.proxys.TaskProxy.NEEDAUTO=!0,a&&a.waitZhanBao)){a.waitZhanBao=!1;var v=new dM;v.taskId=a.taskId,this.sendToService(v)}Tu.sendToModule("HIDE_ACT_ICON",["modules.nav.NavModule"],!0);break;case"CHECKTASKTRACK":if(PH.hasTask())e.proto?AY.showing||AY.getInstance().show():AY.showing&&AY.getInstance().hide();break;case"OPENNPCUI":var m=e.proto,y=fn.getIndex(parseInt(m));0==fn.MODEL.type(y)?wX.ins.show(m):bH.getInstance().show(m);break;case"CLOSENPCUI":var I=e.proto;I&&I==bH.getInstance().npcId&&bH.getInstance().destroy();break;case"CLOSE_SIEGE_NPC":bH.getInstance().clearSiege();break;case"OPTION_RUN":G.timer.callLater(this,function(){e.proto&&t.doGoTarget(Np.parse(e.proto))});break;case"GOTARGET":e.proto instanceof modules.task.others.TargetVo?this.doGoTarget(e.proto):"string"==typeof e.proto&&this.doGoTarget(Np.parse(e.proto));break;case"KILLMONSTER":PH.hasTask();break;case"CLOSEWELLCOME":this.closeWellcome(),xs.mirClick(35,hr.pid,hr.uid),zB.ins.playRainbowById(1);break;case"AUTOTASK":this.doGoTarget(e.proto),this.clickTaskPanel=!0,this.doAutoTask();break;case"CLIENT_FORMAT_TASK":this.clientTaskFormat(e.proto);break;case"__SCENE_CHANGED__":var b=e.proto,w=Pn.getIndex(parseInt(b));10==Pn.MODEL.type(w)||"1003"==b?this.showFrame(!1):this.closeFrame(),this.clearTaskTarget(),G.timer.clear(this,this.onCheckClear);break;case"resize":this.onResize();break;case"10205":var x=AY.getInstance();x.flyGold&&(x.flyGold=!1,zB.ins.playGetItemsByPos([aR.COPPER.itemId],new Uh(x.x+x.width/2,x.y+x.height/2)))}},t.showFrame=function(e){null==this.m_Frame&&(this.m_Frame=new gj),this.m_Frame.show(e)},t.closeFrame=function(){this.m_Frame&&(this.m_Frame.close(),this.m_Frame.destroy(),this.m_Frame=null)},t.showWellcome=function(){var e=this;modules.task.proxys.TaskProxy.NEEDAUTO=!1,sH.getInstance().autoMode=!1,sH.stop(),e.m_loading||e.m_WellCome&&e.m_WellCome.parent||(e.m_loading=!0,e.hasWelcome=!0,e.wellcomePaths.push(_r.getAtlasSubPath("task/hy_img_db.png")),e.wellcomePaths.push(_r.getAtlasSubPath("task/hy_img_rw.png")),e.wellcomePaths.push(_r.getAtlasSubPath("task/hy_text_zb.png")),e.wellcomePaths.push(_r.getAtlasSubPath("task/hy_btn_kslt.png")),G.loader.load([{url:_r.getAtlasSubPath("task/hy_img_db.png")},{url:_r.getAtlasSubPath("task/hy_img_rw.png")},{url:_r.getAtlasSubPath("task/hy_text_zb.png")},{url:_r.getAtlasSubPath("task/hy_btn_kslt.png")}],ql.create(e,e.onWellLoaded)),G.timer.once(5e3,e,e.onShowTask))},t.onShowTask=function(){this.m_WellCome&&this.m_WellCome.parent||this.welcomeEnd||(this.closeWellcome(),zB.ins.playRainbowById(1))},t.onWellLoaded=function(){null==this.m_WellCome&&(this.m_WellCome=new DY),this.m_WellCome.show()},t.closeWellcome=function(){var e=this;if(e.m_WellCome){e.m_WellCome.destroy(),e.m_WellCome=null;for(var t=0;t<e.wellcomePaths.length;++t){var i=e.wellcomePaths[t];G.loader.clearRes(i,!0)}e.wellcomePaths.length=0,e.wellcomePaths=null,e.hasWelcome=!1,e.welcomeEnd=!0}PH.hasTask()?(e.showTaskTrack(!1),modules.task.proxys.TaskProxy.NEEDAUTO=!0,e.doAutoTask()):(G.timer.clear(e,e.showAutoArr),BB.attackMonsterMode=0,e.closeTaskTrace())},t.doAutoTask=function(e){void 0===e&&(e=!1),e&&(S.NEEDAUTO=!0,this.clearTaskTarget());var t=PH.Ins().info;t.waitZhanBao||(modules.task.proxys.TaskProxy.AUTOTIME=BB.getTimer(),3==t.status?0<t.commitNPC&&this.doGoTarget(Np.create(1,t.commitNPC.toString())):2==t.status&&t.target&&this.parseTaskFormat(t.taskContent[0],t.target.tarType),this.clickTaskPanel=!1)},t.clientTaskFormat=function(e){if(null!=e.type&&0!=e.type.length){var t=Np.getTypeByKey(e.type);0<t&&this.parseTaskFormat(e,t)}},t.parseTaskFormat=function(e,t){var i=e,n=t,s="",o=null;switch(n){case 4:s=i.monsterId,i.cId;break;case 15:i.cId;break;case 6:n=2,s="STRENGTH",o=0;break;case 8:n=2,s="RECYCLE";break;case 5:case 35:n=2,s="SKILL_MAINVIEW",o={selectedInex:0};break;case 19:case 7:case 36:n=2,s="ACTOR_M",o=0;break;case 17:case 16:n=2,s="ACTOR_M",o="2";break;case 29:case 28:n=2,s="SKILL_MAINVIEW",o={selectedInex:1};break;case 32:s="STRENGTH",o=n=2;break;case 25:case 26:n=2,s="ACHIEVE_NEW_MAIN_VIEW",o=0;break;case 27:s="SKILL_MAINVIEW",o=n=2;break;case 14:n=2,s="COPYMAINVIEW",o=1;break;case 34:s="SPORTS_MAIN_VIEW",o=n=2;break;case 24:n=24,o="1"==i.enter?i.enter:"0";break;case 10:s="COPYMAINVIEW",o=n=2;break;case 33:mN.ins.isInAct()?(n=2,s="SOARING_VIEW"):(n=2,s="BOSS_MAINVIEW",o=1);break;case 20:case 22:case 23:return;case 21:n=2,s="BOSS_MAINVIEW",o=1;break;case 18:n=2,s="SPORTS_MAIN_VIEW";break;case 9:return s=i.cId,Pn.hasIndex(i.cId)&&2==Pn.MODEL.type(Pn.getIndex(i.cId))?(this.sendToModule("OPENSCENELIST",["modules.achieve.AchieveModule"]),void(S.NEEDAUTO=!0)):void(S.NEEDAUTO=!0);case 12:if(s=i.mId,rn.hasIndex(i.mId)){var a=rn.getIndex(i.mId);switch(rn.MODEL.cate(a)){case 1:n=2,s="COPYMAINVIEW";break;case 2:return S.boss_mId=parseInt(i.mId),BR.ins.btnCallBossPanel(),void(S.NEEDAUTO=!0);case 14:return jR.reqEntry(parseInt(s)),void(S.NEEDAUTO=!0)}}break;case 13:i.cId,s=i.monsterId,o={x:i.x,y:i.y};break;case 30:n=2,s="ACHIEVE_NEW_MAIN_VIEW",o="2";break;case 37:n=2,s="ACTOR_M",o="1";break;case 38:n=2,s="LIMIT_CHALLENGE_MAIN_VIEW";break;case 39:n=2,s="COPYMAINVIEW",o=1;break;case 41:n=2,s="LIMIT_CHALLENGE_MAIN_VIEW",o=0;break;case 40:s="SOARING_VIEW",o=n=2}this.doGoTarget(Np.create(n,s,i.cId,!1,o))},t.clearTaskTarget=function(){S.clearTarget(),G.timer.clear(this,this.onCheckClear)},t.doGoTarget=function(e){var t=this;if(e){if(2!=e.type&&18!=e.type&&3!=e.type){if(!S.NEEDAUTO)return;if(S.NEEDAUTO=!0,S.TARGETHISTORY&&e!=S.TARGETHISTORY&&S.TARGETHISTORY.type==e.type&&S.TARGETHISTORY.targetId==e.targetId)return}var i;switch(e.type){case 1:t.goToTarget(e,t.doOpenNPC);break;case 4:t.clickTaskPanel&&zB.ins.showById(3984,2),t.goToTarget(e,t.goKill,!1);break;case 3:AY.showing&&AY.getInstance().showGuideFromOther();break;case 15:t.goToTarget(e,t.goKill,!1);break;case 2:if("VIP_PANEL_2"==e.targetId)hN.ins.open("VIP_PANEL",2);else if("VIP_PANEL"==e.targetId)hN.ins.open("VIP_PANEL",e.data);else if("FIELD_VIEW"==e.targetId)Tu.sendToModule("OPEN_YZ",["modules.field.FieldModule"]);else if(null!=e.data){var n=parseInt(e.data);0<=n?"MEDAL_VIEW"==e.targetId||("VIP_PANEL"==e.targetId?Tu.sendToModule("OPEN_PANEL",["modules.vip.VipModule"]):"NewDailyActMainView"==e.targetId?"0"==n.toString()?GR.getInstance().checkModuleOpen(19)?Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"],{_subIndex_:e.data}):zB.ins.showMsg(RP.n[242],1):Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"],{_subIndex_:e.data}):hN.ins.open(e.targetId,{_subIndex_:e.data},e.backId,!0)):"string"==typeof e.data?hN.ins.open(e.targetId,{_subId_:e.data},e.backId,!0):hN.ins.open(e.targetId,e.data,e.backId,!0)}else hN.ins.open(e.targetId,e.data,e.backId,!0);hN.ins.isOpen("RESULT_SUCC")&&hN.ins.close("RESULT_SUCC"),e.destroy(),e=null,t.clearTaskTarget();break;case 10:for(var s=0;s<fn.count;++s)if(1==fn.MODEL.type(s)){i=fn.MODEL.key(s)+"";break}t.clearTaskTarget(),t.sendToNPC(i,e.targetId,e.data);break;case 13:S.NEEDAUTO=!1,e.cId+""!=gR.ins.cId?t.taskChangScene(e.cId+"",!0,ql.create(t,t.showCallBoss,[e])):t.showCallBoss(e);break;case 18:e.cId+""!=gR.ins.cId?(t.taskChangScene(e.cId+"",!0,ql.create(t,t.doShowOutdoorFight,[e.targetId,e.data])),e.destroy(),e=null):(hN.ins.open(e.targetId,e.data),e.destroy(),e=null,t.clearTaskTarget());break;case 24:null==e.data||"1"==e.data?UR.instance.fullPower?FR.killBoss():t.clickTaskPanel&&(zB.ins.playErrorMsg(zB.ins.getDesc(3200)),Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule"])):t.clickTaskPanel&&Tu.sendToModule("_Change_Batch_",["modules.nav.NavModule"]);break;case 11:return void hN.ins.open("PLAY_UPGRADE_DIRECTION")}}},t.openPanel=function(e,t){hN.ins.open(e,t)},t.doShowOutdoorFight=function(e,t){if(t&&t.durT){var i=t.durT;G.timer.once(i,this,this.openPanel,[e,t])}else hN.ins.open(e,t);this.clearTaskTarget()},t.taskChangScene=function(e,t,i,n){if(0!=NB.isSceneReady)if(ZN.isEnabledChangeScene()){this.clearTaskTarget();var s=Pn.getIndex(parseInt(gR.ins.cId));if(Pn.hasIndex(parseInt(e))&&(1==Pn.MODEL.type(s)||2==Pn.MODEL.type(s)||gR.ins.cId==_a.S_BIQI.toString()))if("1"==e){modules.task.proxys.TaskProxy.TARGETHANDLER=i;var o=new AG;o.cid=parseInt(e),n?(o.x=n.x,o.y=n.y):(o.x=0,o.y=0),Tu.sendToService(o),NF.Ins().changeScene(e,!0,null)}else{2==Pn.MODEL.type(s)?NF.Ins().changeScene(e,!0,null,ql.create(this,this.goToHookScene,[i])):NF.Ins().changeScene(e,!0,null,i)}}else zB.ins.showById(2126,1)},t.goToHookScene=function(e){aF.onReadForYeZhanHandler(),e.run()},t.showCallBoss=function(e){this.isPlayEffecting||(S.NEEDAUTO=!1,this.isPlayEffecting=!0,UB.ins.playSound("18"),UB.ins.playSound("47",1,!1,2742),G.timer.once(1500,this,this.doCallBoss,[e]),this.showFrame(!1))},t.doCallBoss=function(e){var t=PH.Ins().info;if(t.isKillBossTask){S.setTarget(e),this._BossId=e.targetId,t.waitZhanBao=!0,modules.task.proxys.TaskProxy.NEEDAUTO=!1;var i=new uM;i.taskId=t.taskId,this.sendToService(i)}},t.noticeNewGoods=function(e){var t;for(var i in e){t=e[i];var n=Bi.getIndex(t.goodsId);zB.ins.showMsg("获得："+Bi.MODEL.name(n)+"x"+t.changeNum,1)}},t.doOpenNPC=function(e,t){this.clearTaskTarget(),this.sendToModule("OPENNPCUI",["modules.task.TaskModule"],e)},t.goKill=function(e,t){this.clearTaskTarget(),sH.start()},t.sendToNPC=function(e,t,i){var n=IB.takeNPCDto(e);n&&(n.cid+""!=gR.ins.cId?this.taskChangScene(n.cid+"",!0,ql.create(this,this.doGoTarget,[Np.create(1,e)])):this.doGoTarget(Np.create(1,e)))},t.goToTarget=function(e,t,i){void 0===i&&(i=!0);var n=null;if(i)n=IB.takeNPCDto(e.targetId);else if(15==e.type)e.cId==gR.ins.cId?sH.start():this.taskChangScene(e.cId+"",!0,ql.create(this,sH.start));else{var s=[],o=IB.hash.take(e.cId);if(o&&o.arr)for(var a=o.arr,r=0;r<a.length;++r){var l=a[r],c=!1;if(l&&0<l.length)for(var u=0;u<l.length;++u)l[u].modelId==e.targetId&&(s.push(l[u]),c=!0);if(c){n=s[r=(r=(s.length-1)*Math.random()).toFixed(0)];break}}}if(n){S.setTarget(e);var d=new Uh(n.x,n.y);if(n.cid+""==gR.ins.cId){if(i){var h=zN.getNPC(e.targetId);h&&(NF.Ins().selectChar=h,d=YN.getCharNearPt(h))}else{BB.attackMonsterMode=e.targetId;var _=zN.getMonsters(n.modelId)[0];_&&(NF.Ins().selectChar=_,d=YN.getCharNearPt(_))}this.goToPoint(d,e.targetId,t)}else S.CHANGSCENELIST=this.getSceneList(gR.ins.cId,n.cid+""),this.changeScene(ql.create(this,this.goToTarget,[e,t,i]))}},t.changeScene=function(e){if(0<S.CHANGSCENELIST.length){var t=S.CHANGSCENELIST.shift(),i=Pn.MODEL.sid(Pn.getIndex(parseInt(t))),n=Q_.getIndex(parseInt(gR.ins.cId)),s=Q_.MODEL.tars(n);if(s)for(var o=0;o<s.length;++o){var a=s[o];if(a.tar_id+""==i+""){for(var r,l=PB.tileToPixels(new Uh(a.curr_x,a.curr_y)),c=0;c<Pn.count;++c)Pn.MODEL.sid(c)==i&&(r=Pn.MODEL.key(c)+"");var u=PB.tileToPixels(new Uh(a.tar_x,a.tar_y));return void this.goToPoint(l,r,this.onSceneChange,u)}}0<S.CHANGSCENELIST.length&&(S.CHANGSCENELIST.length=0),null==e&&(e=ql.create(this,this.doAutoTask)),this.taskChangScene(t+"",!0,e)}},t.goToPoint=function(e,t,i,n){yH.Ins().clear(),yH.Ins().mainCharMove(e,!1,ql.create(this,i,[t,n]),!1),G.timer.loop(100,this,this.onCheckClear)},t.onCheckClear=function(){yH.Ins().actCtrl.currOrder&&yH.Ins().actCtrl.currOrder&&yH.Ins().actCtrl.currOrder instanceof zwc.engine.core.controls.orders.MoveOrder?yH.Ins().actCtrl.currOrder.isClosured&&this.clearTaskTarget():this.clearTaskTarget()},t.getSceneList=function(e,t){var i=[];i.push(t);for(var n=this.getPerSceneId(t);n&&n!=e;)i.splice(0,0,n),n=this.getPerSceneId(n);return i},t.getPerSceneId=function(e){for(var t=0;t<Q_.c_Scene_id.length;++t){var i=Q_.c_Tars[t];for(var n in i)if(i[n].tar_id+""==e+"")return Q_.c_Scene_id[t]}return null},t.onSceneChange=function(e,t){0<S.CHANGSCENELIST.length?this.taskChangScene(e,!0,ql.create(this,this.changeScene)):S.TARGETHISTORY&&this.taskChangScene(e,!0,ql.create(this,this.doAutoTask,[!0]))},t.showTaskTrack=function(e){AY.isHiding||(G.timer.clear(this,this.showAutoArr),AY.showing?AY.getInstance().update():AY.getInstance().show(),e&&G.timer.once(1e4,this,this.showAutoArr))},t.showAutoArr=function(){HP.loadConfig(["newGuideEvent"],["CNewGuide"],ql.create(this,this.doShowArrow))},t.doShowArrow=function(){AY.showing},t.closeTaskTrace=function(){AY.showing&&AY.destroyInstance()},t.onResize=function(){this.m_WellCome&&this.m_WellCome.parent&&this.m_WellCome.resize(),AY.showing&&AY.getInstance().resize(),bH.showing&&bH.getInstance().resize(),LY.showing&&LY.Ins().resize()},t.showPanel=function(e,t){"LOCK_SCENE_HOLLOW"==e&&this._lockSceneView&&this._lockSceneView.showPanel(e,t)},t.closePanel=function(e,t){},S.clearTarget=function(){S.TARGETHISTORY&&(S.TARGETHISTORY.dispose(),S.TARGETHISTORY=null,yH.Ins().actCtrl.clearAll())},S.setTarget=function(e){(S.TARGETHISTORY=e)&&S.showAutoEffect()},S.showAutoEffect=function(){var e=NF.mainChar;if(e.titleData&&e.titleData.texture)e.titleData.texture.height;else{var t=0,i=gR.ins.actorById(1);i&&i.titles&&(t=i.titles.length),84*t,0<gR.ins.guildId?75:55}},S.TARGETHISTORY=null,S.TARGETHANDLER=null,S.CHANGSCENELIST=null,S.AUTOTIME=0,S.NEEDAUTO=!0,S.boss_mId=-1,S}(),vF=function(t){function e(){e.__super.call(this)}return b(e,"modules.tasknew.proxys.TaskNewProxy",t),e.prototype.subHandler=function(e){switch(t.prototype.subHandler.call(this,e),e.actionOrder){case"23720":lB.instance().updateTaskInfoByServer(e.proto),Tu.sendToModule("UDPDATE_TASK",["modules.niepan.NiepanModule"])}},e}(bp),mF=function(e){function i(){var e=this;e._mainView=null,e._trMysticalV=null,e._trHeFuV=null,e._resView=null,e._storeView=null,e._buyView=null,e._exchangeView=null,e._exTipView=null,e._bigwardView=null,i.__super.call(e);var t=[_r.getLayoutsPath("treasure")];hN.ins.registPanel("TREASURE_VIEW",BJ,"_mainView",e,{wait:hN.wait(hN.waitRes(t),hN.waitConfig(["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","DragonDesignUpgrade","DragonView"],["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","CConfigDragonInfo","CConfigDragonView"])),layer:"layout",mask:!1}),hN.ins.registPanel("TR_MYSTICAL_VIEW",VJ,"_trMysticalV",e,{wait:hN.wait(hN.waitRes(t),hN.waitConfig(["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","DragonDesignUpgrade","DragonView","ConfigRule"],["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","CConfigDragonInfo","CConfigDragonView","CHelpDes"])),layer:"layout",mask:!1}),hN.ins.registPanel("TR_HEFU_VIEW",HJ,"_trHeFuV",e,{wait:hN.wait(hN.waitRes(t),hN.waitConfig(["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","DragonDesignUpgrade","DragonView","ConfigRule"],["ExploreResource","DiggerGroup","EquipsDiggerExhibition","DragonDiggerExhibition","LegendDiggerExhibition","TimesRewardResource","CConfigDragonInfo","CConfigDragonView","CHelpDes"])),layer:"layout",mask:!1}),hN.ins.registPanel("TREASURE_RESULT",HK,"_resView",e,{wait:hN.waitRes(t),mask:!0}),hN.ins.registPanel("TREASURE_STORE",VK,"_storeView",e,{wait:hN.waitAtlas("treasure"),mask:!0}),hN.ins.registPanel("TREASURE_BUY",BK,"_buyView",e,{mask:!0}),hN.ins.registPanel("TREASURE_EXCHANGE",N1,"_exchangeView",e,{wait:hN.wait(hN.waitRes(t)),layer:"layout",mask:!0}),hN.ins.registPanel("TREASURE_AWARDTIP",NK,"_exTipView",e,{mask:!0}),hN.ins.registPanel("TREASURE_BIGWARD",OK,"_bigwardView",e,{mask:!0,clickClose:!1})}b(i,"modules.treasure.proxys.TreasureProxy",bp);var t=i.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"TR_OPEN":if(hN.ins.isOpen("TREASURE_VIEW"))hN.ins.close("TREASURE_VIEW");else{var i=0;e.proto&&e.proto.hasOwnProperty("_subIndex_")&&(i=e.proto._subIndex_),hN.ins.open("TREASURE_VIEW",{_subIndex_:i})}break;case"TR_MYSTICAL_OPEN":var n=0;e.proto&&e.proto.hasOwnProperty("_subIndex_")&&(n=e.proto._subIndex_),hN.ins.open("TR_MYSTICAL_VIEW",{_subIndex_:n});break;case"TR_HEFU_OPEN":n=0,e.proto&&e.proto.hasOwnProperty("_subIndex_")&&(n=e.proto._subIndex_),hN.ins.open("TR_HEFU_VIEW",{_subIndex_:n});case"TR_STORE":hN.ins.toggle("TREASURE_STORE",e.proto);break;case"TR_BIGWARD":hN.ins.open("TREASURE_BIGWARD",e.proto);break;case"TR_AWARDTIP":hN.ins.open("TREASURE_AWARDTIP",e.proto);break;case"TR_FLY":t._mainView&&t._mainView.parent;break;case"EQUIP_GUPDATE":case"LONGWEN_GUPDATE":case"CHUANSHI_GUPDATE":case"MYSTICAL_GUPDATE":case"HEFU_GUPDATE":t._storeView&&t._storeView.parent&&t._storeView.update(e),t.updateTreasureV(e);break;case"BP_UPDATE":t.updateTreasureV(e),t._exchangeView&&t._exchangeView.pudateList();break;case"11106":var s=e.proto;uB.ins.init(s.groupId,s.list),t._mainView&&t._mainView.parent&&t._mainView.vsc.updateSelectedView(e);break;case"11107":e.proto;t._mainView&&t._mainView.parent&&t._mainView.vsc.updateSelectedView(e);break;case"11108":t._resView&&t._resView.parent?t._resView.update(e.proto.list):t._mainView&&t._mainView.parent&&t._mainView.vsc.updateSelectedView(e);break;case"30322":var o=e.proto;t._resView&&t._resView.parent?t._resView.update(o.list):t.updateTreasureV(e);break;case"30324":t._resView&&t._resView.parent?t._resView.update(e.proto.list):t.updateTreasureV(e);break;case"30326":var a=e.proto;uB.ins.update(a.list),t.updateTreasureV(e);break;case"30328":var r=e.proto;uB.ins.longwenBless=r.longwenBless,uB.ins.chuanshiBless=r.chuanshiBless,uB.ins.freeTimeHash=r.freeTimeHash,uB.ins.TrasureCountArr=r.treasureTime,uB.ins.TrasureAwardArr=r.awardArr,t.updateTreasureV(e);break;case"RESHOWMAINVIEW":t._mainView&&t._mainView.parent&&t._mainView.vsc.updateSelectedView("show"),t._trMysticalV&&t._trMysticalV.parent&&t._trMysticalV.vsc.updateSelectedView("show"),t._trHeFuV&&t._trHeFuV.parent&&t._trHeFuV.vsc.updateSelectedView("show");break;case"30314":t._trMysticalV&&t._trMysticalV.parent&&t._trMysticalV.vsc.updateSelectedView(e)}},t.updateTreasureV=function(e){this._mainView&&this._mainView.parent&&this._mainView.vsc.updateSelectedView(e),this._trMysticalV&&this._trMysticalV.parent&&this._trMysticalV.vsc.updateSelectedView(e),this._trHeFuV&&this._trHeFuV.parent&&this._trHeFuV.vsc.updateSelectedView(e)},t.closePanel=function(e,t){"TREASURE_VIEW"==e&&(hN.ins.isOpen("TREASURE_BIGWARD")&&hN.ins.close("TREASURE_BIGWARD"),hN.ins.close("TREASURE_RESULT"))},t.showPanel=function(e,t){var i=this;"TREASURE_VIEW"==e&&i._mainView&&i._mainView.setSelectIndex(t._subIndex_),"TREASURE_RESULT"==e&&(i._resView.update(t),i._mainView&&i._mainView.parent&&i._mainView.vsc.updateSelectedView("hide"),i._trMysticalV&&i._trMysticalV.parent&&i._trMysticalV.vsc.updateSelectedView("hide"),i._trHeFuV&&i._trHeFuV.parent&&i._trHeFuV.vsc.updateSelectedView("hide"),Tu.sendToModule("REHIDEMAINVIEW",["modules.activity.ActivityModule"],null)),"TREASURE_STORE"==e&&(hN.ins.close("TREASURE_RESULT"),i._storeView.update(t)),"TREASURE_BUY"==e&&i._buyView.setup(t),"TREASURE_AWARDTIP"==e&&i._exTipView.setup(t),"TREASURE_BIGWARD"==e&&i._bigwardView.update(t)},i}(),yF=function(e){function t(){this._mainV=null,this._vipPriMV=null,this._vipGiftV=null,this._vipCardUseTip=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("vip2")),hN.ins.registPanel("VIP_PANEL",H1,"_mainV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigVip"],["ConfigVip"])),mask:!1,layer:"layout"}),hN.ins.registPanel("VIPGIFT_VIEW",B1,"_vipGiftV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigVip"],["ConfigVip"])),mask:!1,layer:"layout"}),(e=[]).push(_r.getLayoutsPath("vip3privilege")),hN.ins.registPanel("VIP3_VIEW",UJ,"_vipPriMV",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigVip"],["ConfigVip"])),mask:!1,layer:"layout"}),hN.ins.registPanel("VipCardUseTip",rZ,"_vipCardUseTip",this,{wait:hN.waitRes([_r.getAtlasSubPath("base_ui2/ty_zjm_tsbk.png"),_r.getLayoutsPath("bag")]),mask:!1,clickClose:!1,layer:"top"})}b(t,"modules.vip.proxys.VipProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_PANEL":hN.ins.open("VIP_PANEL",e.proto,0);break;case"14001":if(this._mainV){var t=new $M;Tu.sendToService(t)}if(this._vipPriMV){this._vipPriMV.updateVIP3();var i=new tA;Tu.sendToService(i)}break;case"14003":Wg.ins.toc_info=e.proto,this._mainV&&this._mainV.updateVip(),this._vipPriMV&&this._vipPriMV.updateVIP3();break;case"14006":Wg.ins.toc_gift=e.proto,hN.ins.open("VIPGIFT_VIEW",e.proto,0),this._vipGiftV&&this._vipGiftV.parent&&this._vipGiftV.update();break;case"14008":var n=e.proto;if(Wg.ins.toc_info&&(Wg.ins.toc_info.awards[n.vipLvl]=n.state),this._mainV&&this._mainV.updateVipState(),this._vipPriMV&&this._vipPriMV.updateVIP3(),2==n.state){var s=_o.getIndex(n.vipLvl),o=_o.MODEL.rewards(s);zB.ins.playGetGoods(o)}break;case"14009":var a=e.proto;Wg.ins.toc_gift&&(Wg.ins.toc_gift.awards[a.vipLvl]=a.state),this._vipGiftV&&this._vipGiftV.updateState(a.vipLvl);break;case"GIFTTIP_UPDATE":this._mainV&&this._mainV.updateGiftTip();break;case"14011":G.timer.once(300,this,function(){hN.ins.isOpen("MAIL_CONTENT_WITHGIFT")&&hN.ins.close("MAIL_CONTENT_WITHGIFT"),hN.ins.isOpen("MAIL")&&hN.ins.close("MAIL"),hN.ins.open("VipCardUseTip")})}},i.closePanel=function(e,t){},i.showPanel=function(e,t){"VIP_PANEL"==e&&t&&this._mainV.setOpenLvl(t)},t}(),IF=(function(e){function i(){var e=this;e._mainV=null,e._lvUpV=null,e._wsCore=null,e._wsDetail=null,e._mainView=null,i.__super.call(e);var t=[];t.push(_r.getLayoutsPath("weaponsoul")),hN.ins.registPanel("WEAPONSOUL_MAIN",qK,"",e,{wait:hN.wait(hN.waitRes(t)),mask:!0}),hN.ins.registPanel("WEAPONSOUL_TIPS",YK,"",e,{mask:!0}),hN.ins.registPanel("WEAPONSOUL_TIPS_1",WK,"",e,{mask:!0}),hN.ins.registPanel("WEAPONSOULLVUPV",jK,"_lvUpV",e,{mask:!0}),hN.ins.registPanel("WEAPONSOUL_DETAIL",FK,"_wsDetail",e,{mask:!0}),hN.ins.registPanel("WEAPONSOUL_CORE",V1,"_wsCore",e,{wait:hN.wait(hN.waitRes(t)),mask:!0,layer:"layout"})}b(i,"modules.weaponsoul.proxy.WeaponSoulProxy",bp);var t=i.prototype;G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_LVUP":hN.ins.toggle("WEAPONSOULLVUPV");break;case"22504":t._lvUpV&&t._lvUpV.notice(e),t._wsDetail&&t._wsDetail.updateByVSC(e);break;case"BP_UPDATE":t._lvUpV&&t._lvUpV.notice(e),t._wsCore&&t._wsCore.upateCoreCost();case"UPDATE_DETAIL":case"22507":t._wsDetail&&t._wsDetail.updateByVSC(e);break;case"OPEN_TIPS":hN.ins.toggle("WEAPONSOUL_TIPS");break;case"OPEN_TIPS_1":hN.ins.toggle("WEAPONSOUL_TIPS_1");break;case"OPEN_DETAIL":hN.ins.toggle("WEAPONSOUL_DETAIL",e.proto);break;case"OPEN_WSCORE":hN.ins.toggle("WEAPONSOUL_CORE");break;case"CORE_SELECT":t._wsCore&&t._wsCore.setSelectItem();break;case"22511":var i=e.proto;hB.ins.updateCoreAmount(i.role,i.coreAmount),t._wsCore&&t._wsCore.updateUI();break;case"22509":var n=e.proto;hB.ins.updateCoreList(n.role,n.soulList),t._wsCore&&t._wsCore.updateUI()}},t.closePanel=function(e,t){},t.showPanel=function(e,t){}}(),function(e){function t(){this._view=null,t.__super.call(this);var e=[_r.getLayoutsPath("welfare_mix")];hN.ins.registPanel("WELFARE",G1,"_view",this,{wait:hN.wait(hN.waitRes(e)),layer:"layout",mask:!1})}b(t,"modules.welfare.proxys.WelfareProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":G.timer.once(1e3,t,t.reqInfo);break;case"OPEN":fB.ins.forRed=!0,hN.ins.toggle("WELFARE");break;case"UPDATE_NAV":t.refreshRedPt();break;case"21602":var i=e.proto;fB.ins.init(i),t._view&&t._view.parent&&t._view.update();break;case"21604":var n=e.proto;fB.ins.totalKeys.push(n.key),t._view&&t._view.parent&&t._view.update();break;case"30491":0==fB.ins.packetIconNum&&(fB.ins.packetIconNum++,G.timer.once(300,t,t.showRedPacketIcon,[e.proto]));break;case"30493":var s=e.proto;fB.ins.packetType=s.packetType,t.showRedPacket(s);break;case"30495":var o=e.proto;t._view&&t._view.parent&&t._view.update(o);break;case"30496":var a=e.proto;fB.ins.isPacketOpen=1===a.isOpen}},i.updateTab=function(){},i.closePanel=function(e,t){},i.showPanel=function(e,t){if("WELFARE"==e){var i=!1;fB.ins.isDailyReturn&&!fB.ins.isDailyReturnAble&&(i=!0,WB.getActivityData(1034)),$N.ins.isOpen()&&!$N.ins.isAwardable()&&(i=!0,WB.getActivityData(1034)),i&&G.timer.once(100,this,this.refreshRedPt),t?1==t.bool&&(this._view.bool=!0,this._view.ykIndex=t.id):this._view.bool=!1,this._view.openIndex(t)}},i.reqInfo=function(){WB.getActivityData(1034),WB.getActivityData(1004),WB.getActivityData(JP.A_ID_1001)},i.refreshRedPt=function(){this._view&&this._view.parent&&this._view.updateNav()},i.showRedPacket=function(e){G.loader.load([{url:_r.getLayoutsPath("redpacket")},{url:_r.getLayoutsImagePath("redpacket/tjhb_hb_gx.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_hb_bg_01.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_hb_bg_02.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_hb_yb.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_num_dhs.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_num_hs.png")},{url:_r.getLayoutsImagePath("redpacket/tjhb_num_ls.png")}],ql.create(this,this.onRedPacketLoaded,[e]),null,null,1,!0,"redpacket_popup")},i.onRedPacketLoaded=function(e){(new HY).popup(e)},i.showRedPacketIcon=function(e){if(fB.ins.packets30491.pop(),0<fB.ins.packets30491.length)return fB.ins.packets30491.length=0,void(fB.ins.packetIconNum=0);fB.ins.packetNum=e.packetNum,fB.ins.packetType=e.packetType,fB.ins.packetUUID=e.uuid,(new NY).show()},t}()),bF=function(e){function t(){this._view=null,t.__super.call(this);var e=[];e.push(_r.getLayoutsPath("yueka")),hN.ins.registPanel("MONTHCARD",W1,"_view",this,{wait:hN.wait(hN.waitRes(e),hN.waitConfig(["ConfigRecharge"],["CRecharge"])),layer:"layout",mask:!1})}b(t,"modules.yueka.proxys.MonthCardProxy",bp);var i=t.prototype;return G.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"Layer_Init":G.timer.once(1e3,t,ad.reqMonthCardInfo),G.timer.once(1e3,t,_g.reqTqMonthCard);break;case"OPEN_MV":if(0==EB.showCharge)return;hN.ins.open("MONTHCARD");break;case"22303":null!=ad.callBackHandler&&(ad.callBackHandler.run(),ad.callBackHandler=null);var i=e.proto;ld.ins.data22303=i,t._view&&t._view.updatePanel(2),t._view&&t._view.updateBtnLabel(i);break;case"22352":null!=_g.callBackHandler&&(_g.callBackHandler.run(),_g.callBackHandler=null);var n=e.proto;hg.ins.datas22352=n,t._view&&t._view.updatePanel(3),t._view&&t._view.updateBtnLabel(n);break;case"22363":var s=e.proto;t._view&&t._view.updateBtnLabel(s)}},i.closePanel=function(e,t){},i.showPanel=function(e,t){switch(e){case"MONTHCARD":t&&t.hasOwnProperty("selectedIndex")&&this._view.updatePanel(t.selectedIndex)}},t}(),wF=function(e){function n(){var e=this;e._accountView=null,e._careView=null,e._microView=null,e._saveView=null,e._shareView=null,e._verifyView=null,n.__super.call(e);var t=["SdkGiftResource"],i=["CSdkGift"];hN.ins.registPanel("YUNYING_ACCOUNT_VIEW",XK,"_accountView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!1,mask:!0,layer:"panel"}),hN.ins.registPanel("YUNYING_CARE_VIEW",QK,"_careView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!0,mask:!0,layer:"panel"}),hN.ins.registPanel("YUNYING_MICRO_VIEW",JK,"_microView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!0,mask:!0,layer:"panel"}),hN.ins.registPanel("YUNYING_SAVE_VIEW",ZK,"_saveView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!0,mask:!0,layer:"panel"}),hN.ins.registPanel("YUNYING_SHARE_VIEW",KK,"_shareView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!0,mask:!0,layer:"panel"}),hN.ins.registPanel("YUNYING_VERIFY_VIEW",$K,"_verifyView",e,{wait:hN.wait(hN.waitConfig(t,i)),clearAll:!0,mask:!0,layer:"panel"})}b(n,"modules.yunying.proxys.YunyingProxy",bp);var t=n.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.showPanel=function(e,t){e},t.closePanel=function(e,t){e},t.subHandler=function(e){switch(e.actionOrder){case"30414":var t=e.proto;jP.checkSubscribeBack(t.status),this._careView&&this._careView.update(t.status);break;case"30418":hN.ins.isOpen("YUNYING_MICRO_VIEW")||pt.onIOS||hN.ins.open("YUNYING_MICRO_VIEW")}},n}(),xF=function(e){function s(){var e=this;e._enterV=null,e._rankMV=null,e._resultV=null,e._mainV=null,e._tipsV=null,s.__super.call(e);var t=["ConfigYeZhanBiQiCommon","ConfigYeZhanBiQiAward","ConfigYeZhanBiQiRankAward","ConfigYzbqcKillMsg"],i=["ConfigYZBQCommon","ConfigYZBQAward","ConfigYZBQRankAward","ConfigYzbqcKillMsg"],n=[];n.push(_r.getLayoutsPath("yzbqc")),n.push(_r.getLayoutsPath("basic_z0")),hN.ins.registPanel("YZBQC_ENTER",e$,"_enterV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),mask:!0}),hN.ins.registPanel("YZBQC_RESULT",i$,"_resultV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),mask:!0,clickClose:!1}),hN.ins.registPanel("YZBQC_MAIN",t$,"_mainV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),mask:!1,layer:"nav"}),hN.ins.registPanel("YZBQC_TIPS",Y1,"_tipsV",e,{clearAll:!1,mask:!1,layer:"nav"}),hN.ins.registPanel("YZBQC_RANK",z1,"_rankMV",e,{wait:hN.wait(hN.waitRes(n),hN.waitConfig(t,i)),mask:!0})}b(s,"modules.yzbqc.proxy.YzbqcProxy",bp);var t=s.prototype;return G.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN":Hv.reqInfo(),hN.ins.toggle("YZBQC_ENTER");break;case"OPEN_RANK_AWARD":hN.ins.open("YZBQC_RANK");break;case"23102":0!=gB.ins.restTime?zB.ins.playNoticeMsg(gB.ins.restTime+RP.n[244]):(gB.ins.changeUI(!0),t._mainV&&t._mainV.parent&&t._mainV.updateTimer());break;case"23103":gB.ins.endTime=e.proto.endTime,t.update(e);break;case"23112":gB.ins.monsterL=e.proto.monsterL,gB.ins.playerL=e.proto.playerL,t.update(e);break;case"23117":var i=e.proto.result;0!=i&&gB.ins.getRewards.push(i),t.update(e);break;case"23118":case"__ZHANBAO_YZBQ_PLAY_END__":case"23106":t._mainV&&t._mainV.update(e),t._rankMV&&t._rankMV.update(e);break;case"23120":gB.ins.openTime=e.proto.openTime,gB.ins.isRss=e.proto.isRss,t._enterV&&t._enterV.updateByVSC(e);break;case"23110":0==e.proto.type?t._enterV&&t._enterV.updateByVSC(e):(t._mainV&&t._mainV.update(e),t._rankMV&&t._rankMV.update(e));break;case"23121":hN.ins.open("YZBQC_RESULT",e.proto),hN.ins.isOpen("YZBQC_RANK")&&hN.ins.close("YZBQC_RANK"),hN.ins.close("YZBQC_TIPS");break;case"UPDATE_CHAR_CURR_HP":gB.ins.updateHp(e.proto.charId,e.proto.currHP,e.proto.maxHP),t._mainV&&t._mainV.update(e)}},t.update=function(e){this._mainV&&this._mainV.update(e),this._rankMV&&this._rankMV.update(e)},t.closePanel=function(e,t){},t.showPanel=function(e,t){"YZBQC_RESULT"==e&&this._resultV.show(t)},t.showTips=function(){gB.ins.needShowTips()?hN.ins.open("YZBQC_TIPS",1):hN.ins.close("YZBQC_TIPS")},s}(),SF=function(e){function n(){var e=this;e.loginSocket=null,e.priorityQueueTime=0,e.resolvePacketTime=0,e.resolve_dur=2,e.isDebug=!0,e.offLineTime=NaN,e.now=0,e.tickTime=0,e.num=0,e.waitQueue=new Array,n.__super.call(e),console.log("SocketDock is Ready!"),(net.SocketDock._intance_=e).initWebSocket()}b(n,"net.SocketDock",bp);var t=n.prototype;return t.initWebSocket=function(){this.loginSocket=new kF,this.tickTime=BB.getTimer(),G.timer.loop(1,this,this.loop)},t.setSlowPack=function(){G.timer.clear(this,this.loop),G.timer.loop(800,this,this.loop)},t.recovePack=function(){G.timer.clear(this,this.loop),G.timer.loop(1,this,this.loop)},t.reSetWebSocket=function(){this.loginSocket.reConnecting=!1},t.connect=function(e,t){this.isDebug,this.loginSocket.connect(e,t)},t.loop=function(){var e=this;if(e.loginSocket){var t=e.loginSocket.buffMessages.length,i=BB.getTimer();0<t&&(e.loginSocket.connected?(e.num=0,e.receivedHandler()):i-e.resolvePacketTime>e.resolve_dur&&(e.resolvePacketTime=i,e.receiveHandlerByOutServer())),e.now=BB.getTimer(),e.loginSocket.connected&&3e4<=e.now-e.tickTime&&(1==hr.hasFirstSend&&(pt.onPC||!pt.onPC&&G.stage.isVisibility)&&Tu.sendToService(new fL),e.tickTime=e.now)}},t.subHandler=function(e){var t=this,i=e.proto;if(t.loginSocket&&t.loginSocket.connected&&!t.loginSocket.reConnecting)switch(e.actionOrder){case"4":t.loginSocket.sendBeanData(e.proto),i.packId,e.proto=null,e.recover()}else t.waitQueue.push(e.proto),i&&-1!=n.PACKIDS.indexOf(i.packId)&&!t.loginSocket.connected&&(null!=G.loader.getRes(_r.getLayoutsPath("base_ui2"))?(KQ.ins.show(RP.n[245],ql.create(t,t.onReConect),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),KQ.ins.cancelClose=!0):G.loader.load(_r.getLayoutsPath("base_ui2"),ql.create(t,t.showAlertOutConnect)))},t.showAlertOutConnect=function(){KQ.ins.show(RP.n[246],ql.create(this,this.onReConect),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),KQ.ins.cancelClose=!0},t.onReConect=function(e){1!=e&&0!=e||pt.window.location.reload()},t.reLogin=function(){KQ.ins.show(RP.n[247],ql.create(this,this.onReConect),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),KQ.ins.cancelClose=!1},t.reconnectedFun=function(){this.loginSocket.connect(hr.socket_host,hr.socket_port)},t.receivedHandler=function(){if(!(HB.fps<5))for(;this.num<3;){if(this.num++,this.loginSocket.buffMessages.length<=0)return;var e,t,i=this.loginSocket.buffMessages.shift(),n=i[0],s=i[1];try{t=OH.p.take(n.toString())}catch(e){}t&&(e=new t).decode(s),e&&this.broadcastMsg(n,e)}},t.receiveHandlerByOutServer=function(){var e=this.loginSocket.buffMessages[0],t=e[0];if(13303==t||10118==t){var i,n,s=(e=this.loginSocket.buffMessages.shift())[1];try{n=OH.p.take(t.toString())}catch(e){}n&&(i=new n).decode(s),i&&this.broadcastMsg(t,i)}},t.broadcastMsg=function(e,t){var i=e.toString(),n=zF.subscribeHash.take(i);n&&this.sendToModule(i,n,t)},t.checkPackidIsBlock=function(e,t){if(void 0===t&&(t=10),this.loginSocket.buffMessages.length>=t){var i=0,n=0;for(i=0;i<this.loginSocket.buffMessages.length;i++){var s=this.loginSocket.buffMessages[i];parseInt(e)==s[0]&&n++}return t<=n}return!1},t.checkPackidBlock=function(){return 50<=this.loginSocket.buffMessages.length},p(0,t,"isConnect",function(){return this.loginSocket.connected}),n.GetIntance=function(){return net.SocketDock._intance_},n._intance_=null,n.logined=!1,n.isConnected=!1,n.bLOCK_PACKIDS_NUM=50,f(n,["PACKIDS",function(){return this.PACKIDS=[10101,10103,10105,10107]}]),n}(),kF=function(t){function i(e,t){this._host_="",void(this._port_=0)===t&&(t=0),i.__super.call(this,e,t)}b(i,"net.GameSocket",t);var e=i.prototype;return e._init_=function(){},e._onConnect_=function(e){t.prototype._onConnect_.call(this,e),console.log("is connected !")},e._onClose_=function(e){t.prototype._onClose_.call(this,e)},e._onError_=function(e){t.prototype._onError_.call(this,e)},e._onMessage_=function(e){t.prototype._onMessage_.call(this,e)},i}($B),EF=function(e){function s(){s.__super.call(this),this.actCtrl}b(s,"zwc.engine.core.controls.orders.MoveOrder",e,"MoveOrder$1");var t=s.prototype;return t._onMoveEnd_=function(){this.closure(),null!=this.closuredOrder&&this.closuredOrder.run(),this.actCtrl&&this.actCtrl.currOrderClosured()},t.closure=function(){this.isClosured=!0,this.isPlay=!1},t.dispose=function(){this.owner=null,this.closuredOrder&&(this.closuredOrder.recover(),this.closuredOrder=null),this.actCtrl=null,this.isClosured=!0,this.isPlay=!1,e.prototype.dispose.call(this)},t.moveTo=function(e,t){var i,n=this;n.owner&&(null!=e&&n.owner.point.toString()!=e.toString()?0==(i=s.findPath(new Uh(n.owner.x,n.owner.y),e)).length?n._onMoveEnd_():(n.owner.tarMoveTo(i),n.owner._CharMoveEnd_=ql.create(n,n._onMoveEnd_)):n._onMoveEnd_())},s.Create=function(e,t){var i;return(i=s.pool.length?s.pool.pop():new s(e)).owner=e,i.actCtrl=t,i},s.findPath=function(e,t){var i;i=null==e?(e=new Uh(NF.mainChar.x,NF.mainChar.y),NF.mainChar.tilePoint):PB.pixelsToTile(e.x,e.y);var n=PB.pixelsToTile(t.x,t.y);i.x,i.y,n.x,n.y;return s.tileAstar.getPath(YH.instance,i.x,i.y,n.x,n.y,!0,2e3)},s.cleanPath=function(e){if(2<e.length)for(var t=1;t<e.length-1;t++){var i=e[t-1],n=e[t],s=e[t+1];(i.y-n.y)/(i.x-n.x)==(n.y-s.y)/(n.x-s.x)&&(e.splice(t,1),t--)}return e},s.checkPointType=function(e,t,i){void 0===i&&(i=10);for(var n=BB.distance(e,t),s=Math.ceil(n/i),o=!0,a=0;a<s;a++){var r=ol.interpolate(e,t,a/s),l=PB.pixelsToTile(r.x,r.y),c=YH.instance.takeItem(l.x,l.y);if(!c||c.type<1){o=!1;break}}return o},s.pool=[],f(s,["tileAstar",function(){return this.tileAstar=new jH}]),s}(BH),TF=(function(e){function t(){this.uijson="",t.__super.call(this),t._instance=this}b(t,"GameEnter",pp);var i=t.prototype;i.runWeb=function(e){if(RP.n[0],hr.clientGate=1,e.hasOwnProperty("createRole")&&(_r.justCreated=e.createRole),e.mainFile&&(hr.mainFile=e.mainFile),e.uid&&(hr.uid=e.uid),e.gid&&(hr.gid=e.gid),e.appid&&(hr.platform=hr.pid=hr.appid=e.appid),e.appVersion&&0<e.appVersion.length&&(hr.appVersion=e.appVersion),e.version){var t=hr.version;if(0<t)t<e.version&&(hr.version=e.version,hr.otherVersion=e.version)}e.time&&(hr.serverTime=e.time),e.sign&&(hr.sign=e.sign),e.socket_ip&&(hr.socket_host=e.socket_ip),e.socket_port&&(hr.socket_port=e.socket_port),e.server_id&&(hr.serverID=e.server_id),e.server_name&&(hr.serverName=e.server_name),e.client&&(hr.client=e.client),e.cdns&&0<e.cdns.length?(hr.cdns=e.cdns,_r.host=hr.cdns[0]+"resources/"):e.host&&0<e.host.length&&(_r.host=e.host),e.resVersion&&(Hg.getIntance().Versions=e.resVersion),0<=e.run_model&&(dr.application_model=e.run_model),e.hasOwnProperty("nativeSuffix")&&(dr.nativeSuffix=e.nativeSuffix),e.deviceInfo&&(e.deviceInfo&&e.deviceInfo.IMEI&&(hr.IMEI=e.deviceInfo.IMEI),dr.isConchApp?BP.deviceInfo=e.deviceInfo:jP.deviceInfo=e.deviceInfo),e.app_sdk&&(BP.GameSdk=e.app_sdk),e.loadingDescribe&&(hr.loadingDescribe=e.loadingDescribe),e.noticeDescribe&&(hr.noticeDescribe=e.noticeDescribe),e.loadingView&&(dr.loadingView=e.loadingView),e.hasOwnProperty("xgame")&&(dr.xgame=e.xgame,2==dr.xgame&&pt.onIOS&&(dr.rechargeModel=2)),e.websdk&&jP.setSdk(e.websdk),e.globalParams&&(hr.globalParams=e.globalParams),e.webGetParams&&(hr.webGetParams=e.webGetParams),e.clickStream&&(hr.clickStream=e.clickStream),e.clickAppids&&(hr.clickAppids=e.clickAppids),e.loginResList&&(hr.loginResList=e.loginResList),FB.getIntance();var i=_r.getFullUrl("db/code/code.txt");G.loader.getRes(i)?this.onCnsHandler():G.loader.load([{url:i,type:"text"}],ql.create(this,this.onCnsHandler))},i.onCnsHandler=function(){for(var e=_r.getFullUrl("db/code/code.txt"),t=G.loader.getRes(e).split("\n"),i=0;i<t.length;i++){var n=t[i];n&&0<n.length&&(n=n.split("\\n").join("\n")),RP.n[i]=n}G.loader.clearRes(e),this.commonEnter()},i.run=function(){G.init(720,1280,nv),this.commonEnter()},i.commonEnter=function(){Wa.defaultFamily=dr.font,EB.isFitWidth?G.stage.scaleMode="fixedwidth":G.stage.scaleMode="fixedheight",v_.isConchApp?G.stage.screenMode="vertical":jP.initSdk(),Te._disable(),FB.getIntance().initGame(),ER.ins.unionLocalStorage(bc.getItem("uniconSett")),_r.justCreated?this.uijson=_r.getFullUrl("ui/layoutsJSON/ui_newhand_release.json"):this.uijson=_r.getFullUrl("ui/layoutsJSON/ui_release.json"),this.loadUI_Json()},i.loadUI_Json=function(){G.loader.getRes(this.uijson)?this.onLoaded():G.loader.load([{url:this.uijson,type:"json"}],ql.create(this,this.onLoaded))},i.onLoaded=function(){Vg.uiMap=G.loader.getRes(this.uijson),G.loader.clearRes(this.uijson),-1<this.uijson.indexOf("ui_newhand")&&(this.uijson=_r.getFullUrl("ui/layoutsJSON/ui_release.json"),G.timer.once(3e4,this,this.loadUI_Json))},t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t._instance=null}(),function(e){function t(){var e=this;e.textName=null,e.item=null,t.__super.call(e),e.size(116,156),e.item=new MF,e.addChild(e.item),e.textName=kB.createText(0,120,116,50,"",20,"#6c6250",!1,"center",!1,!1,e),e.addChild(e.textName),e.item.toolTipEnabled=!1}return b(t,"modules.actor.views.item.GoodsGridNoTips",pp),p(0,t.prototype,"dataSource",null,function(e){if((this.item.dataSource=e)&&e.goodsId){var t=Bi.MODEL.name(Bi.getIndex(e.goodsId));this.textName.changeText(t),this.textName.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(Bi.getIndex(e.goodsId)))}}),t}()),CF=function(t){function d(){var e=this;e._weaponId=null,e._clothesId=null,e._wingId=null,e._bhEff=null,e.wsRoleEffectHash=new jl,d.__super.call(e),e.mouseEnabled=!1,e.on("undisplay",e,e.onRemove)}b(d,"modules.actor.views.item.RoleAvatar",t);var e=d.prototype;return e.changeAvatar=function(e,t,i,n,s,o,a){var r,l=this;void 0===o&&(o=""),void 0===a&&(a=""),l.clear(),l._weaponId=t,l._clothesId=i,l._wingId=n,!i&&0<e&&(l._clothesId=2==e?"ty2001":"ty1001");var c=[];if(l._weaponId&&"null"!=l._weaponId&&"0"!=l._weaponId&&(r=_r.getActorPath(l._weaponId),d._hash_.indexOf(r)<0&&c.push(r)),l._clothesId&&"null"!=l._clothesId&&"0"!=l._clothesId&&(r=_r.getActorPath(l._clothesId),d._hash_.indexOf(r)<0&&c.push(r)),l._wingId&&"null"!=l._wingId&&"0"!=l._wingId&&(r=_r.getActorPath(l._wingId),d._hash_.indexOf(r)<0&&c.push(r)),c.length?G.loader.load(c,ql.create(l,l.onDraw),null,"image"):l.onDraw(),s)if(0<po.count){0==l.wsRoleEffectHash.length&&l.initWeaponInfo();var u=l.wsRoleEffectHash.take(s);u&&l.showBhEffect(u)}else HP.loadConfig(["ConfigWeaponSoul"],["ConfigWeaponSoul"],ql.create(l,l.showWeaponSoulEffect,[s]));a&&l.showBhEffect(a)},e.showWeaponSoulEffect=function(e){this.initWeaponInfo();var t=this.wsRoleEffectHash.take(e);t&&this.showBhEffect(t)},e.showBhEffect=function(e){this._bhEff?this._bhEff.loadEffect(e):this._bhEff=kB.createEffect(e,520,150,this)},e.initWeaponInfo=function(){for(var e=po.count,t=0;t<e;t++){var i=po.MODEL.effectId(t);i&&this.wsRoleEffectHash.put(i,po.MODEL.roleEffectId(t))}},e.onRemove=function(e){this.clear()},e.onDraw=function(){var e=this;e.displayedInStage&&(e.graphics.clear(),mR.ins.isComplete?(e._wingId&&e.drawPart(e._wingId,mR._wingCfg,300,40),e._clothesId&&e.drawPart(e._clothesId,mR._clothesCfg,298,43),e._weaponId&&e.drawPart(e._weaponId,mR._weaponCfg,295,-60)):mR.ins.onToLoad(ql.create(e,e.onDraw)))},e.drawPart=function(e,t,i,n,s,o){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===o&&(o=1),t){var a=this.retain(e);if(a){var r=a.width*(s-1)>>0,l=a.height*(o-1)>>0,c=a.width*s>>0,u=a.height*o>>0,d=0,h=0;if(t[e]){var _=t[e].split(",");d=i+parseInt(_[0])-(r>>1),h=n+parseInt(_[1])-(l>>1)}else d=i-(r>>1),h=n-(l>>1);this.graphics.drawTexture(a,d,h,c,u)}}},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this.clear(),d.clearLoader()},e.clear=function(){var e=this;e.release(e._clothesId),e.release(e._weaponId),e.release(e._wingId),e._clothesId=e._weaponId=e._wingId=null,e._bhEff&&e._bhEff.dispose(),e._bhEff=null},e.release=function(e){if(e){var t=_r.getActorPath(e),i=d._hash_.get(t);i&&(i.num-=1)}},e.retain=function(e){var t=_r.getActorPath(e),i=d._hash_.get(t);if(i)return i.num+=1,i.tex;var n=G.loader.getRes(t);return n&&(n&&n.bitmap&&(n.bitmap.enableMerageInAtlas=!1),d._hash_.set(t,{tex:n,num:1})),n},d.clearLoader=function(e){void 0===e&&(e=!1);for(var t=d._hash_.keys.length-1;0<=t;t--){var i=d._hash_.keys[t];(d._hash_.values[t].num<=0||e)&&(d._hash_.remove(i),G.loader.clearRes(i))}},d.offx=700,d.offy=516,f(d,["_hash_",function(){return this._hash_=new jo}]),d}(pp),LF=function(e){function t(){var e=this;e.grid=null,e.txtName=null,e.data=null,e.isDragon=!1,t.__super.call(e),e.grid=new MF(64),e.grid.needGodShow=!1,e.grid.pos(14,0),e.addChild(e.grid),e.txtName=new Yp,e.txtName.font="SimHei",e.txtName.fontSize=24,e.addChild(e.txtName),e.txtName.width=90,e.txtName.align="center",e.on("click",e,e.showDragonView)}b(t,"modules.backpack.views.grid.BagComGrid",pp);var i=t.prototype;return i.setGridSize=function(e){this.grid.size(e,e),e?this.txtName.pos(-4,e+4):this.txtName.pos(2,e+4)},i.bindData=function(e){var t=this;if(e){t.data=e,t.grid.bindData=e.bindData,t.grid.needNum=e.needGoodsNum;var i=Bi.getIndex(t.grid.bindData.goodsId),n=Bi.MODEL.simpleName(i);if(t.isDragon=1==Bi.MODEL.subType(i)||32==Bi.MODEL.subType(i),e.isGray)t.txtName.color="#4a4947",t.grid.gray=!0;else{var s=ms.getByQuality(Bi.MODEL.colourId(i));t.txtName.color=s,t.grid.gray=!1}if(t.txtName.text=n,t.isDragon&&(e.bindData.dragonIndex=1,Yt.count<=0)){var o=[{url:_r.getDBPath("DragonView"),type:"arraybuffer"}];G.loader.load(o,ql.create(t,t.onLoad,o),null,"arraybuffer")}}},i.onClickToolsEvent=function(e,t){var i={dtoequ:t[0],getinfo:t[1]};Wj.instance.show(i)},i.onLoad=function(e){if(G.loader.getRes(e.url)&&Yt.count<=0){Yt.setup(e.url);for(var t=Yt.count,i=0;i<t;i++)Yt.config(i)}G.loader.clearRes(e.url),this.showDragonView()},i.showDragonView=function(){if(this.data)if(this.isDragon){var e=this.data.bindData.goodsId,t=lR.instance().checkLongWenIsOpen(e),i="";i=1==t[0]?"已解锁":t[1],this.data.bindData.dragonIndex=1,this.grid.clickHandler=ql.create(this,this.onClickToolsEvent,[,[this.data.bindData,i]])}else this.grid.clickHandler=null},t}(),MF=function(i){function n(e){var t=this;t.goodsId=0,t.goodsNum=0,t.strengthLv=0,t.zhulingLv=0,t.positionLevel=0,t.roleTypeId=0,t.godEqupBorder=null,t.isShowJob=!1,t.needGridBg=!0,t.needEffect=!0,t.needNum=!0,t.toolTipEnabled=!0,t.needMoShow=!0,t.needGodShow=!0,t.needLWShow=!0,t.needHunShow=!0,t.isShowSmallIcon=!1,t.sexIndex=0,t.prop=0,t.font="22px SimHei",t.clickHandler=null,t._bindData={},t._showTip=!1,t._toolTip=null,t._effectId=null,t._effect=null,t._iconUrl=null,t.isClearUrl=!0,t._iconTexture=null,t.offX=8,t.isHideClear=!0,t._drawStrengthLv=!0,t._drawZhulingLv=!0,t._drawPoistionLv=!0,t._box=null,void 0===e&&(e=116),n.__super.call(t),t.godEqupBorder=new Kl,t.addChild(t.godEqupBorder),t.godEqupBorder.centerX=-2,t.godEqupBorder.centerY=-6,t.size(e,e),t.on("undisplay",t,t.onRemove)}b(n,"modules.backpack.views.grid.GoodsGrid",i);var e=n.prototype;return e.onAdd=function(){var e=this;e.on("undisplay",e,e.onRemove),e.off("display",e,e.onAdd),e.invalidGId(),e.refresh(),null!=e._iconTexture&&Zl.addIconUse(e,e._iconTexture.url)},e.invalidGId=function(){0==this.goodsId&&(this._bindData instanceof protos.backpack.DtoGoods?this.goodsId=this._bindData.goodsId:"number"==typeof this._bindData&&Math.floor(this._bindData)==this._bindData&&(this.goodsId=this._bindData))},e.onRemove=function(){var e=this;e.off("undisplay",e,e.onRemove),e.on("display",e,e.onAdd),e.invalidGId(),tt.ins.cancelLoad(e.getIconUrl()),Zl.clearIconTexture(e),e._iconUrl=null,e.clearEffect()},e.destroy=function(e){var t=this;void 0===e&&(e=!0),t.isClearUrl&&t.clearIconTexture(),t.off("display",t,t.onAdd),t.off("display",t,t.onRemove),t.invalidGId(),tt.ins.cancelLoad(t.getIconUrl()),t._bindData=null,t._iconUrl=null,t.clearEffect(),t._box&&t._box.graphics.clear(),i.prototype.destroy.call(t,e)},e.getIconUrl=function(){if(0==this.goodsId)return null;var e=Bi.getIndex(this.goodsId),t="";if(this.isShowSmallIcon){var i=Bi.MODEL.smallIcon(e).split(",");t=1<i.length?i[this.sexIndex]:i[0]}else t=Bi.MODEL.icon(e);return this.isShowSmallIcon?_r.getSmallIconPath(t):_r.getIconPath(t)},e.setGodEqupSkin=function(e){this.godEqupBorder.skin=0==e?"":_r.getAtlasSubPath("grids/chuanshi_"+e+".png")},e.invalid=function(){G.timer.callLater(this,this.refresh)},e.refresh=function(e){this.graphics.clear(),0!=this.goodsId?(this.showEffect(),this.drawBg(this.graphics)&&this.drawIcon(e,this.graphics)):this.clearEffect()},e.drawBg=function(e){var t=Bi.getIndex(this.goodsId);if(null==t||-1==t)return console.error(RP.n[249]+this.goodsId),!1;if(this.needGridBg){var i=Bi.MODEL.colourId(t),n=NI.gridBg(i,this.width),s=G.loader.getRes(n);s&&e.drawTexture(s,0,0,this.width,this.height)}return!0},e.drawIcon=function(e,t,i,n){var s=this;void 0===i&&(i=0),void 0===n&&(n=0);var o=Bi.getIndex(s.goodsId),a="";if(s.isShowSmallIcon){var r=Bi.MODEL.smallIcon(o).split(",");a=1<r.length?r[s.sexIndex]:r[0]}else a=Bi.MODEL.icon(o);return null==(e=e||s.isShowSmallIcon?NR.getSmallIcon(a):NR.getIcon(a))?(s.isShowSmallIcon?NR.loadSmallIcon(a,ql.create(s,s.doDrawIcon,[t,i,n,s.goodsId])):NR.loadIcon(a,ql.create(s,s.doDrawIcon,[t,i,n,s.goodsId])),!1):(s.doDrawIcon(t,i,n,s.goodsId,e),!0)},e.clearIconTexture=function(){Zl.clearIconTexture(this),this._iconUrl=null,this.graphics.clear()},e.doDrawIcon=function(e,t,i,n,s){var o=this;void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),n==o.goodsId&&(s&&(e||(e=o.graphics),s.bitmap&&(s.bitmap.enableMerageInAtlas=!1),o.isHideClear&&Zl.addIconUse(o,s.url),o._iconUrl!=s.url&&Zl.addGridTexture(s.url),o.offX=74<o.width?8:5,e.drawTexture(s,t+o.offX,i+o.offX,o.width-2*o.offX,o.height-2*o.offX),o._iconTexture=s,o._iconUrl&&o._iconUrl!=s.url&&Zl.cutGridTexture(o._iconUrl),o._iconUrl=s.url),o.afterDrawIcon())},e.drawYuyiIcon=function(e,t){var i=Bi.getIndex(this.goodsId);if(0<=la.SWING.indexOf(Bi.MODEL.decoratePosition(i))){var n="wing"+Bi.MODEL.minUseLevel(i);NR.loadimage(n,ql.create(this,this.doDrawYuyiIcon,[t,65,10,this.goodsId]))}},e.doDrawYuyiIcon=function(e,t,i,n,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),n==this.goodsId&&s&&(e||(e=this.graphics),e.drawTexture(s,t+3,i+3,42,32))},e.afterDrawIcon=function(){var e=this;e.drawYuyiIcon(null,e.graphics),e.drawTip(e.graphics)&&e.drawText(e.graphics)&&e.drawCorner(e.graphics)&&e.setMoEquitStar(e)},e.drawTip=function(e,t,i){if(void 0===t&&(t=0),void 0===i&&(i=0),PR.drawThunderStar(e,this.goodsId,t,i),this._showTip){var n=G.loader.getRes(NI.POINT);n&&e.drawTexture(n,t+this.width-n.width,i+2,n.width,n.height)}return!0},e.drawCorner=function(e,t,i){var n=this;void 0===t&&(t=0),void 0===i&&(i=0);var s=Bi.getIndex(n.goodsId);n.needHunShow&&ca.isZhuhunMaterial(n.goodsId)&&NR.loadHunImage(ql.create(n,n.drawHunImg,[e,t,i])),n.needLWShow&&ca.isDoubleLW(n.goodsId)&&NR.loadLWImage(ql.create(n,n.drawLWImg,[e,t,i]));var o=Bi.MODEL.flyUpLevel(s),a=Bi.MODEL.flyUpJewelryLevel(s),r=Bi.MODEL.LunHuiLevel(s);return!!n.needGodShow&&(r&&(n.isShowJob=!0,NR.loadSamsaraBgImage(r,ql.create(n,n.drawSamsaraImgBg,[e,t,i,r]))),0<s&&0<o&&(NR.loadGodImage(ql.create(n,n.drawGodImg,[e,t,i])),NR.loadGradeBgImage(ql.create(n,n.drawGradeBgImg,[e,t,i,o]))),0<s&&0<a?(NR.loadJobImage(n.roleTypeId,ql.create(n,n.drawJobImg,[e,t,i])),NR.loadGradeBgImage(ql.create(n,n.drawGradeBgImg,[e,t,i,a]))):0<n.roleTypeId&&n.isShowJob&&NR.loadJobImage(n.roleTypeId,ql.create(n,n.drawJobImg,[e,t,i])),0<n.positionLevel&&n._drawPoistionLv,1==ca.isBlackMacketGoods(n.goodsId)&&NR.loadAuctionBg(ql.create(n,n.drawAuctionBgImg,[t,i])),!0)},e.drawText=function(e,t,i){var n=this;return void 0===t&&(t=0),void 0===i&&(i=0),!!n.needNum&&(1<n.goodsNum&&(n.goodsNum%1e4==0?e.fillText(mp.getBigIntStr(n.goodsNum,0),t+n.width-10,i+n.height-32,n.font,"#ece2ca","right"):e.fillText(mp.getBigIntStr(n.goodsNum,1),t+n.width-10,i+n.height-32,n.font,"#ece2ca","right")),0<n.strengthLv&&n._drawStrengthLv&&e.fillText("+"+n.strengthLv,t+n.width-10,i+n.height-32,n.font,"#e0d800","right"),0<n.zhulingLv&&n._drawZhulingLv&&e.fillText(n.zhulingLv+"",t+10,i+n.height-32,n.font,"#20a9e9","left"),!0)},e.drawJobImg=function(e,t,i,n){n&&e.drawTexture(n,t+this.width-n.sourceWidth-8,i+8,n.sourceWidth,n.sourceHeight)},e.drawHunImg=function(e,t,i,n){this.needHunShow&&n&&e.drawTexture(n,t+this.width-n.sourceWidth-8,i+8,n.sourceWidth,n.sourceHeight)},e.drawGodImg=function(e,t,i,n){this.needGodShow&&n&&e.drawTexture(n,t+this.width-n.sourceWidth-8,i+8,n.sourceWidth,n.sourceHeight)},e.drawLWImg=function(e,t,i,n){this.needLWShow&&n&&e.drawTexture(n,t+8,i+8,n.sourceWidth,n.sourceHeight)},e.drawSamsaraImgBg=function(e,t,i,n,s){this.needGodShow&&(s&&e.fillTexture(s,t+4,i+4,s.sourceWidth,s.sourceHeight),NR.loadSamsaraImage(n,ql.create(this,this.drawSamsaraImg,[e,t,i,n])))},e.drawSamsaraImgXuan=function(e,t,i,n,s){this.needGodShow&&s&&e.fillTexture(s,t+4,i+22,s.sourceWidth,s.sourceHeight)},e.drawSamsaraImg=function(e,t,i,n,s){(s=Xp.create(s,26*(n-1),0,26,22))&&e.drawTexture(s,t+6,i+7,s.sourceWidth,s.sourceHeight)},e.drawAuctionBgImg=function(e,t,i){i&&this.graphics.drawTexture(i,e+8,t+5,i.sourceWidth,i.sourceHeight),NR.loadAuctionImg(ql.create(this,this.drawAuctionImg,[e,t]))},e.drawAuctionImg=function(e,t,i){(i=Xp.create(i,0,0,i.sourceWidth,i.sourceHeight))&&this.graphics.drawTexture(i,e+10,t+7,i.sourceWidth,i.sourceHeight)},e.drawGradeBgImg=function(e,t,i,n,s){s&&e.drawTexture(s,t+8,i+5,s.sourceWidth,s.sourceHeight),NR.loadGradeImage(n,ql.create(this,this.drawGradeImg,[e,t,i,n]))},e.drawGradeImg=function(e,t,i,n,s){(s=Xp.create(s,26*(n-1),0,26,22))&&e.drawTexture(s,t+10,i+7,s.sourceWidth,s.sourceHeight)},e.showEffect=function(){var e=this,t=e._bindData;if(t&&e.needEffect){var i=Bi.MODEL.effectId(t.cfgIdx);i?e._effectId!=i&&(e.clearEffect(),e._effectId=i,e._effect=kB.createEffect(i,e.width>>1,e.height>>1,e),116!=e.width&&(e._effect.scale_X=e.width/116,e._effect.scale_Y=e.width/116),qH.Ins().addNoClears(i)):e.clearEffect()}else e.clearEffect()},e.clearEffect=function(){this._effect&&(this._effect.destroy(),this._effect.dispose()),this._effect=null,qH.Ins().removeNoClears(this._effectId),this._effectId=null},e.onMouseTap=function(e){G.timer.callLater(this,this.showToolTip)},e.showToolTip=function(){this.toolTipEnabled&&(null==this.clickHandler?this._doShowToolTip():this.clickHandler.runWith(this._bindData))},e._doShowToolTip=function(){var e=this;if(ca.isZZTID(e.goodsId))Tu.sendToModule("ZZT_GOOD_TIP",["modules.zzt.ZztModule"],e._bindData);else if(ca.isChuanShiEqu(e.goodsId)){parseInt(e.goodsId.toString().substr(-1,1));var t={lv:1,ps:parseInt(e.goodsId.toString().substr(-1,1))-1};pY.instance.show(t)}else if(LR.getIsSamsara(e._bindData.goodsId)){var i=yR.ins.getJobByCfg(e._bindData);WX.ins.show({dto:e._bindData,actorId:i,pos:0,noRefine:!0})}else 22!=e._bindData.subType?ca.isZhuhunMaterial(e._bindData.goodsId)?hN.ins.open("LUNHUI_ZHUHUN_MATERIAL_TIP",{dtoGoods:e._bindData}):e._toolTip&&e._bindData&&e._toolTip.show(e._bindData):hN.ins.open("SoulSkinGoodsTip",e._bindData.goodsId)},e.setMoEquitStar=function(e,t,i){var n=this;if(void 0===t&&(t=0),void 0===i&&(i=0),n._box&&n._box.graphics.clear(),n._box&&n._box.getStyle()&&n._box.getStyle()._tf&&n._box.scale(1,1),n.needMoShow&&_R.getIsMoEquit(n.goodsId)){n._box||(n._box=new dt),e.addChild(n._box);var s=Bi.MODEL.magicStarLevel(Bi.getIndex(n.goodsId));if(!_R.getIsMoEquitSpecial(n.goodsId))return n._box.pos(3+t,0+i),n._box.graphics.drawTextures(_R.starBgTexture,[0,0]),void n._box.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"repeat-x",new Uh(26*(10-s),0));var o=Math.floor(s/6),a=Math.floor(s%6);n._box.pos(5+t,n.height-28+i);for(var r=0;r<a;r++)n._box.graphics.drawTextures(_R.getStarTexture(o),[_R.getStartX(a)+44*r,0]);n._box&&n._box.getStyle()&&n._box.getStyle()._tf&&(n._box.scaleX=n._box.scaleY=.45)}},p(0,e,"drawStrengthLv",function(){return this._drawStrengthLv},function(e){this._drawStrengthLv=e}),p(0,e,"toolTip",function(){return this._toolTip},function(e){(this._toolTip=e)?this.on("click",this,this.onMouseTap):this.off("click",this,this.onMouseTap)}),p(0,e,"dataSource",null,function(e){this.bindData=e}),p(0,e,"drawZhulingLv",function(){return this._drawZhulingLv},function(e){this._drawZhulingLv=e}),p(0,e,"drawPoistionLv",function(){return this._drawPoistionLv},function(e){this._drawPoistionLv=e}),p(0,e,"bindData",function(){return this._bindData},function(e){if(!e&&this._iconUrl&&(Zl.cutGridTexture(this._iconUrl),Zl.addIconUse(this,this._iconUrl)),this.goodsId=0,this._bindData=e,"number"==typeof this._bindData&&Math.floor(this._bindData)==this._bindData){this.goodsId=this._bindData;var t=Bi.getIndex(this.goodsId);this.roleTypeId=Bi.MODEL.roleTypeId(t),this.toolTip=null}else this._bindData instanceof protos.backpack.DtoGoods?(this.goodsId=this._bindData.goodsId,this.goodsNum=this._bindData.goodsNum,t=Bi.getIndex(this.goodsId),this.roleTypeId=Bi.MODEL.roleTypeId(t),this.toolTip=this._bindData.isFashionProp?hW.instance:VQ.instance,ca.isMabiOrHushenRing(this.goodsId)&&(this.toolTip=pW.instance),8==this._bindData.subType&&(this.toolTip=Pj.instance),34==this._bindData.subType&&(this.toolTip=ZZ.instance),this._bindData instanceof protos.backpack.DtoEquip&&(this.strengthLv=this._bindData.strengthLv,this.zhulingLv=this._bindData.zhulingLv,this.positionLevel=this._bindData.positionLevel,ca.isSoaringEquip(this.goodsId)?this.toolTip=KX.instance:ca.isSoaringInteriors(this.goodsId)?this.toolTip=YX.instance:this._bindData.isThunderEqu||this._bindData.isJzGodEequ||(LR.getIsDragon(this._bindData.goodsId)?this.toolTip=jj.instance:_R.isMoEquipByDto(this._bindData)?(_R.ins.curStatus=-1,_R.ins.curPosition=this._bindData.decoratePosition,this.toolTip=Zj.instance):this.toolTip=fW.instance))):this.toolTip=null;this.invalid()}),p(0,e,"showTip",function(){return this._showTip},function(e){this._showTip!=e&&(this._showTip=e,this.invalid())}),p(0,e,"gray",null,function(e){if(e){var t=[];t=(t=(t=(t=t.concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([0,0,0,1,0]);var i=new ys(t);this.filters=[i]}else this.filters=[]}),p(0,e,"filters",i.prototype._$get_filters,function(e){v_.isWebGL&&G.superSet(pp,this,"filters",e)}),n}(pp),AF=function(t){function i(e){var t=this;t.goodsId=0,t.isSmall=!1,t.needGridBg=!0,t.isShowJob=!1,t.isShowHun=!0,t.isShowLW=!0,t._size=0,t._color=0,t._iconId=null,t._clickData=null,t._clickHandler=null,t._job=NaN,t.isClearUrl=!0,t.offX=8,t._iconUrl=null,t._iconTexture=null,t._box=null,void 0===e&&(e=116),i.__super.call(t),t._size=e,t.on("undisplay",t,t.onRemove)}b(i,"modules.backpack.views.grid.GoodsSp",t);var e=i.prototype;return e.onAdd=function(){var e=this;e.on("undisplay",e,e.onRemove),e.off("display",e,e.onAdd),e.refresh(),null!=e._iconTexture&&Zl.addIconUse(e,e._iconTexture.url)},e.onRemove=function(){this.off("undisplay",this,this.onRemove),this.on("display",this,this.onAdd),Zl.clearIconTexture(this),this._box&&this._box.graphics.clear()},e.invalid=function(){G.timer.callLater(this,this.refresh)},e.setClickHandler=function(e,t){this._clickData=t,(this._clickHandler=e)?!this.hasListener("click")&&this.on("click",this,this.onClick):this.off("click",this,this.onClick)},e.destroy=function(e){void 0===e&&(e=!0),this.isClearUrl&&this.clearIconTexture(),this.off("display",this,this.onAdd),this.off("display",this,this.onRemove),t.prototype.destroy.call(this,e)},e.refresh=function(){var e=this;if(e.graphics.clear(),e.needGridBg&&0<e._color){var t=NI.gridBg(e._color,e._size),i=G.loader.getRes(t);i&&e.graphics.drawTexture(i,0,0,e._size,e._size)}e._iconId&&((i=e.isSmall?NR.getSmallIcon(e._iconId):NR.getIcon(e._iconId))?e.isSmall?e.drawSmallIcon(i):e.drawIcon(i):e.isSmall?NR.loadSmallIcon(e._iconId,ql.create(e,e.drawSmallIcon)):NR.loadIcon(e._iconId,ql.create(e,e.drawIcon))),e.drawYuyiIcon(),e.setMoEquitStar()},e.drawJobImg=function(e){e&&this.graphics.drawTexture(e,this._size-e.sourceWidth-8,8,e.sourceWidth,e.sourceHeight)},e.drawHunImg=function(e){e&&this.graphics.drawTexture(e,this._size-e.sourceWidth-8,8,e.sourceWidth,e.sourceHeight)},e.drawLWImg=function(e){e&&this.graphics.drawTexture(e,8,8,e.sourceWidth,e.sourceHeight)},e.drawGodImg=function(e){e&&this.graphics.drawTexture(e,this._size-e.sourceWidth-8,8,e.sourceWidth,e.sourceHeight)},e.drawGradeBgImg=function(e,t){t&&this.graphics.drawTexture(t,8,5,t.sourceWidth,t.sourceHeight),NR.loadGradeImage(e,ql.create(this,this.drawGradeImg,[e]))},e.drawGradeImg=function(e,t){(t=Xp.create(t,26*(e-1),0,26,22))&&this.graphics.drawTexture(t,10,7,t.sourceWidth,t.sourceHeight)},e.drawYuyiIcon=function(){var e=Bi.getIndex(this.goodsId);if(0<=la.SWING.indexOf(Bi.MODEL.decoratePosition(e))){var t="wing"+Bi.MODEL.minUseLevel(e);NR.loadimage(t,ql.create(this,this.doDrawYuyiIcon,[this.graphics,65,10,this.goodsId]))}},e.doDrawYuyiIcon=function(e,t,i,n,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),n==this.goodsId&&s&&(e||(e=this.graphics),e.drawTexture(s,t+3,i+3,42,32))},e.drawAuctionBgImg=function(e,t,i){i&&this.graphics.drawTexture(i,e,t,i.sourceWidth,i.sourceHeight),NR.loadAuctionImg(ql.create(this,this.drawAuctionImg,[e,t]))},e.drawAuctionImg=function(e,t,i){(i=Xp.create(i,0,0,i.sourceWidth,i.sourceHeight))&&this.graphics.drawTexture(i,e,t+7,i.sourceWidth,i.sourceHeight)},e.drawIcon=function(e){var t=this;e&&(e.bitmap&&(e.bitmap.enableMerageInAtlas=!1),t._iconTexture=e,Zl.addIconUse(t,e.url),Zl.addGridTexture(e.url),t._iconUrl=e.url),t.offX=74<t._size?8:5,e&&t.graphics.drawTexture(e,t.offX,t.offX,t._size-2*t.offX,t._size-2*t.offX),0<t.goodsId&&PR.drawThunderStar(t.graphics,t.goodsId),t.isShowHun&&ca.isZhuhunMaterial(t.goodsId)&&NR.loadHunImage(ql.create(t,t.drawHunImg)),t.isShowLW&&ca.isDoubleLW(t.goodsId)&&NR.loadLWImage(ql.create(t,t.drawLWImg));var i=Bi.getIndex(t.goodsId),n=Bi.MODEL.flyUpLevel(i),s=Bi.MODEL.flyUpJewelryLevel(i);0<i&&0<n&&(NR.loadGodImage(ql.create(t,t.drawGodImg)),NR.loadGradeBgImage(ql.create(t,t.drawGradeBgImg,[n]))),0<i&&0<s?(NR.loadGradeBgImage(ql.create(t,t.drawGradeBgImg,[s])),NR.loadJobImage(t._job,ql.create(t,t.drawJobImg))):0<t._job&&t.isShowJob&&NR.loadJobImage(t._job,ql.create(t,t.drawJobImg)),1==ca.isBlackMacketGoods(t.goodsId)&&NR.loadAuctionBg(ql.create(t,t.drawAuctionBgImg,[8,5]))},e.clearIconTexture=function(){Zl.clearIconTexture(this),this._iconTexture=null},e.drawSmallIcon=function(e){e&&this.graphics.drawTexture(e,0,0,this._size,this._size),e&&Zl.addIconUse(this,e.url),e&&Zl.addGridTexture(e.url),this._iconTexture=e},e.onClick=function(e){this._clickHandler&&(this._clickData?this._clickHandler.runWith(this._clickData):this._clickHandler.run())},e.setMoEquitStar=function(){var e=this;if(e._box&&e._box.graphics.clear(),e._box&&e._box.scale(1,1),_R.getIsMoEquit(e.goodsId)){e._box||(e._box=new dt,e.addChild(e._box));var t=Bi.MODEL.magicStarLevel(Bi.getIndex(e.goodsId));if(!_R.getIsMoEquitSpecial(e.goodsId))return e._box.pos(3,0),e._box.graphics.drawTextures(_R.starBgTexture,[0,0]),void e._box.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"repeat-x",new Uh(26*(10-t),0));var i=Math.floor(t/6),n=Math.floor(t%6);e._box.pos(5,e.height-28);for(var s=0;s<n;s++)e._box.graphics.drawTextures(_R.getStarTexture(i),[_R.getStartX(n)+44*s,0]);e._box.scaleX=e._box.scaleY=.45}},p(0,e,"color",null,function(e){this._color!=e&&(this._color=e,this.invalid())}),p(0,e,"bindData",null,function(e){var t=this;if("string"==typeof e)t.goodsId=0,t._iconId=e,t._job=0;else if("number"==typeof e&&Math.floor(e)==e){t.goodsId=e;var i=Bi.getIndex(t.goodsId);t._iconId=t.isSmall?Bi.MODEL.smallIcon(i):Bi.MODEL.icon(i),t._color=Bi.MODEL.colourId(i),t._job=Bi.MODEL.roleTypeId(i)}t.invalid()}),i}(pp),DF=function(n){function c(e,t,i,n,s,o,a,r){var l=this;l.SIZE=0,l.X_B=0,l.Y_B=0,l.dataList=null,l.row=0,l.col=0,l.needName=!1,l.handler=null,l.gsimpleName=!1,l.bgLayer=null,l.iconLayer=null,l.txtLayer=null,l.effLaya=null,l.redLayer=null,l.startLayer=null,l.txtD=[],l.tipD=[],l.isShowJob=!1,l.isShowHun=!0,l.isShowLW=!0,l.urlArr=[],l.isClearUrl=!0,l.owerModule=null,l.isPackage=!0,l.iconTextures=[],l.effD=new jo,void 0===o&&(o=!0),void 0===r&&(r=!0),c.__super.call(l),l.SIZE=i,l.X_B=n,l.Y_B=s,l.row=e,l.col=t,l.needName=o,l.handler=a,l.bgLayer=new pp,l.addChild(l.bgLayer),l.iconLayer=new pp,l.addChild(l.iconLayer),l.startLayer=new pp,l.addChild(l.startLayer),l.txtLayer=new pp,l.addChild(l.txtLayer),l.effLaya=new pp,l.addChild(l.effLaya),l.redLayer=new pp,l.addChild(l.redLayer),l.isPackage=r,l.on("click",l,l.onClick)}b(c,"modules.backpack.views.item.GridContainer",n);var e=c.prototype;return e.destroy=function(e){var t=this;if(void 0===e&&(e=!0),t.urlArr&&0<t.urlArr.length){if(t.isClearUrl)for(var i=0;i<t.urlArr.length;i++)t.urlArr[i]&&t.urlArr[i];t.urlArr.splice(0,t.urlArr.length)}Zl.clearIconTexture(t),t.bgLayer.graphics.clear(),t.iconLayer.graphics.clear(),t.redLayer.graphics.clear(),t.txtLayer.graphics.clear(),t.startLayer.graphics.clear(),t.clearEff(),t.dataList=null,n.prototype.destroy.call(t,e)},e.onScroll=function(){this.dataList&&this.refresh(!1)},e.refresh=function(e){var t=this;t.clear(e);for(var i,n,s=0;s<t.dataList.length;s++)i=t.dataList[s],t.refreshGrid(s,i);for(var o in t.txtD)(n=t.txtD[o])[0]&&t.txtLayer.graphics.fillText(n[0],n[1],n[2],n[3],n[4],n[5]);if(0<t.tipD.length){var a=G.loader.getRes(NI.POINT);a&&t.redLayer.graphics.drawTextures(a,t.tipD)}},e.refreshGrid=function(e,t){var i,n,s,o,a,r=this,l=e/r.col>>0,c=e%r.col>>0,u=0,d=(r.SIZE+r.X_B)*c,h=(r.SIZE+r.Y_B)*l,_=u_.TEMP.setTo(d,h,r.SIZE+r.X_B,r.SIZE+r.Y_B),f=r.scrollRect;if((!f||f.intersects(_))&&t){u=t.cfgIdx;var p=Bi.MODEL.colourId(u);if(n=NI.gridBg(p),(o=G.loader.getRes(n))&&r.bgLayer.graphics.drawTexture(o,d,h,r.SIZE,r.SIZE),(o=NR.getIcon(Bi.MODEL.icon(u)))?r.drawIcon(d,h,t,o):NR.loadIcon(Bi.MODEL.icon(u),ql.create(r,r.drawIcon,[d,h,t])),1<t.goodsNum&&r.txtD.push([t.goodsNum+"",d+r.SIZE-10,h+r.SIZE-32,"22px SimHei","#ece2ca","right"]),r.needName)if(t instanceof protos.backpack.DtoEquip)if(LR.getIsDragon(t.goodsId)||0<=la.SWING.indexOf(Bi.MODEL.decoratePosition(u)))i=r.gsimpleName?Bi.MODEL.simpleName(u):Bi.MODEL.name(u),r.txtD.push([i,d+.5*r.SIZE,h+r.SIZE+4,"20px SimHei",ms.getDragonColorByQuality(p),"center"]);else{i=104==t.position||105==t.position?Bi.MODEL.simpleName(u):0<Bi.MODEL.flyLevel(u)?t.isJzGodEequ||t.iswingequ?Bi.MODEL.simpleName(u):Bi.MODEL.flyLevel(u)+"转":1<Bi.MODEL.minUseLevel(u)?"lv."+Bi.MODEL.minUseLevel(u):"无限制";var g=ms.getByQuality(p);r.txtD.push([i,d+.5*r.SIZE,h+r.SIZE+4,"20px SimHei",g,"center"])}else if(-1!=ca.DRAGON_JINGHUA_IDS.indexOf(t.goodsId))i=r.gsimpleName?Bi.MODEL.simpleName(u):Bi.MODEL.name(u),r.txtD.push([i,d+.5*r.SIZE,h+r.SIZE+4,"20px SimHei",ms.getDragonColorByQuality(p),"center"]);else if(-1!=ca.TIME_LIMIT_GOOD.indexOf(t.goodsId)){var v=TR.ins.goodtimesHash;for(e=0;e<v.length;e++){var m=v.take(t.goodsId);i=m?0<m?Bi.MODEL.name(u):"已过期":Bi.MODEL.name(u)}}else{i=104==t.position||105==t.position?Bi.MODEL.simpleName(u):r.gsimpleName?Bi.MODEL.simpleName(u):Bi.MODEL.name(u);var y=ms.getByQuality(p);r.txtD.push([i,d+.5*r.SIZE,h+r.SIZE+4,"20px SimHei",y,"center"])}PR.isTipAble(t)&&r.tipD.push(d+r.SIZE-32+6,h-11),(s=Bi.MODEL.effectId(u))&&-1==r.effD.indexOf(e)&&(a=kB.createEffect(s,d+.5*r.SIZE-1,h+.5*r.SIZE,r.effLaya),116!=r.SIZE&&(a.scaleX=a.scaleY=r.SIZE/116,a.scale_X=a.scale_Y=r.SIZE/116),null!=r.effD.get(e)&&qH.Ins().removeNoClears(r.effD.get(e)),r.effD.set(e,s),qH.Ins().addNoClears(s)),r.drawYuyiIcon(t,d,h)}},e.clearIconTexture=function(){for(;0<this.iconTextures.length;){var e=this.iconTextures.shift();e&&e.bitmap&&(yc.clearTextureRes(e.url),tt.ins.clearTexture(e.url),this.iconLayer.graphics.clear(),e=null)}Zl.clearIconTexture(this)},e.drawYuyiIcon=function(e,t,i){var n=Bi.getIndex(e.goodsId);if(0<=la.SWING.indexOf(Bi.MODEL.decoratePosition(n))){var s="wing"+Bi.MODEL.minUseLevel(n);NR.loadimage(s,ql.create(this,this.doDrawYuyiIcon,[null,t,i,e.goodsId]))}},e.doDrawYuyiIcon=function(e,t,i,n,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),s&&this.iconLayer.graphics.drawTexture(s,t+65,i+10,42,32)},e.drawIcon=function(e,t,i,n){var s=this;n&&n.bitmap&&(n.bitmap.enableMerageInAtlas=!1,-1==NR.gridDestroyImage.indexOf(n.url)&&NR.gridDestroyImage.push(n.url)),n&&Zl.addGridTexture(n.url),n&&s.iconLayer.graphics.drawTexture(n,e+8,t+8,s.SIZE-16,s.SIZE-16),PR.drawThunderStar(s.iconLayer.graphics,i.goodsId,e,t),n&&s.urlArr.push(n.url),n&&Zl.addIconUse(s,n.url);var o=Bi.MODEL.flyUpLevel(i.cfgIdx),a=Bi.MODEL.flyUpJewelryLevel(i.cfgIdx),r=Bi.MODEL.LunHuiLevel(i.cfgIdx);s.isShowHun&&ca.isZhuhunMaterial(i.goodsId)&&NR.loadHunImage(ql.create(s,s.drawHun,[e,t])),s.isShowLW&&ca.isDoubleLW(i.goodsId)&&NR.loadLWImage(ql.create(s,s.drawLW,[e,t])),0<i.cfgIdx&&0<o&&(NR.loadGodImage(ql.create(s,s.drawGod,[e,t])),NR.loadGradeBgImage(ql.create(s,s.drawGradeBgImg,[e,t,o]))),0<i.cfgIdx&&0<a?(NR.loadJobImage(i.roleJob,ql.create(s,s.drawJob,[e,t])),NR.loadGradeBgImage(ql.create(s,s.drawGradeBgImg,[e,t,a]))):0<i.roleJob&&s.isShowJob&&NR.loadJobImage(i.roleJob,ql.create(s,s.drawJob,[e,t])),r&&NR.loadSamsaraBgImage(r,ql.create(s,s.drawSamsaraImgBg,[s.iconLayer.graphics,e,t,r])),1==ca.isBlackMacketGoods(i.goodsId)&&NR.loadAuctionBg(ql.create(s,s.drawAuctionBgImg,[e,t])),s.setMoEquitStar(i.goodsId,e,t)},e.drawSamsaraImgBg=function(e,t,i,n,s){s&&e.drawTexture(s,t+4,i+4,s.sourceWidth,s.sourceHeight),NR.loadSamsaraImage(n,ql.create(this,this.drawSamsaraImg,[e,t,i,n]))},e.drawSamsaraImgXuan=function(e,t,i,n,s){s&&e.drawTexture(s,t+4,i+22,s.sourceWidth,s.sourceHeight)},e.drawSamsaraImg=function(e,t,i,n,s){(s=Xp.create(s,26*(n-1),0,26,22))&&e.drawTexture(s,t+6,i+7,s.sourceWidth,s.sourceHeight)},e.drawJob=function(e,t,i){i&&this.iconLayer.graphics.drawTexture(i,e+3+this.SIZE-40,t+3+5,30,30)},e.drawGod=function(e,t,i){i&&this.iconLayer.graphics.drawTexture(i,e+3+this.SIZE-40,t+3+5,30,30)},e.drawHun=function(e,t,i){i&&this.iconLayer.graphics.drawTexture(i,e+3+this.SIZE-40,t+3+5,30,30)},e.drawLW=function(e,t,i){i&&this.iconLayer.graphics.drawTexture(i,e+8,t+8,i.sourceWidth,i.sourceHeight)},e.drawGradeBgImg=function(e,t,i,n){n&&this.iconLayer.graphics.drawTexture(n,e+8,t+5,n.sourceWidth,n.sourceHeight),NR.loadGradeImage(i,ql.create(this,this.drawGradeImg,[e,t,i]))},e.drawAuctionBgImg=function(e,t,i){i&&this.iconLayer.graphics.drawTexture(i,e+8,t+5,i.sourceWidth,i.sourceHeight),NR.loadAuctionImg(ql.create(this,this.drawAuctionImg,[e,t]))},e.drawAuctionImg=function(e,t,i){(i=Xp.create(i,0,0,i.sourceWidth,i.sourceHeight))&&this.iconLayer.graphics.drawTexture(i,e+10,t+7,i.sourceWidth,i.sourceHeight)},e.drawGradeImg=function(e,t,i,n){(n=Xp.create(n,26*(i-1),0,26,22))&&this.iconLayer.graphics.drawTexture(n,e+10,t+7,n.sourceWidth,n.sourceHeight)},e.clear=function(e){var t=this;t.bgLayer.graphics.clear(),t.iconLayer.graphics.clear(),t.txtLayer.graphics.clear(),t.effLaya.graphics.clear(),t.redLayer.graphics.clear(),t.txtD.length=0,t.tipD.length=0,t.urlArr.splice(0,t.urlArr.length),e&&t.clearEff()},e.clearEff=function(){var e,t;for(var i in this.effD.values)t=this.effD.values[i],qH.Ins().removeNoClears(t);for(this.effD.clear();this.effLaya.numChildren;)(e=this.effLaya.removeChildAt(0)).dispose(),e.destroy(),e=null},e.onClick=function(e){var t=this,i=t.mouseX/(t.SIZE+t.X_B)>>0;if(!(t.mouseX>(1+i)*(t.SIZE+t.X_B)-t.X_B)){var n=t.mouseY/(t.SIZE+t.Y_B)>>0;if(!(t.mouseY>(1+n)*(t.SIZE+t.Y_B)-t.Y_B)){var s=n*t.col+i,o=t.dataList[s];if(o)if(t.handler)t.handler.runWith(o);else if(ca.isMabiOrHushenRing(o.goodsId))pW.instance.show(o);else if(ca.isZhuhunMaterial(o.goodsId))hN.ins.open("LUNHUI_ZHUHUN_MATERIAL_TIP",{dtoGoods:o});else if(ca.isZZTID(o.goodsId))Tu.sendToModule("ZZT_GOOD_TIP",["modules.zzt.ZztModule"],o);else if(ca.isChuanShiEqu(o.goodsId)){parseInt(o.goodsId.toString().substr(-1,1));var a={lv:1,ps:parseInt(o.goodsId.toString().substr(-1,1))-1};pY.instance.show(a)}else if(22!=o.subType){if(o instanceof protos.backpack.DtoEquip)if(o.isThunderEqu);else if(o.isFuWen)_W.instance.showByType(o);else if(o.isSoaringEquip)KX.instance.showTips(o);else if(o.isSoaringInterior)YX.instance.showTips(o);else if(LR.getIsDragon(o.goodsId))if(0!=o.uuId)jj.instance.show(o);else{var r=KH.create(o.goodsId);r.dragonIndex=1;var l={dtoequ:r,getinfo:RP.n[250]};Wj.instance.show(l)}else if(_R.isMoEquipByDto(o))_R.ins.curStatus=-1,_R.ins.curPosition=o.decoratePosition,Zj.instance.show({dto:o});else{if(LR.getIsSamsara(o.goodsId)){var c=yR.ins.getJobByCfg(o);return void WX.ins.show({dto:o,actorId:c,pos:0,noRefine:!0})}fW.instance.show(o)}else if(o instanceof protos.backpack.DtoGoods)if(o.isFashionProp)hW.instance.show(o);else if(8==o.subType)Pj.instance.show(o);else if(34==o.subType)ZZ.instance.show(o);else if(13==o.subType&&311e3!=o.goodsId)hN.ins.open("XINFA_MIJI_PANEL",o);else{var u="";if((u=Bi.MODEL.event2(o.cfgIdx))&&t.isPackage){var d=u.split("|");if(d&&"PACKAGE"==d[1])return void hN.ins.open("BagPackageOpenPanel",o)}if(-1!=VQ.instance.giftList.indexOf(o.goodsId)&&(TR.ins.isChange=!0),0<=ca.FIRST_CHARGE_BOX_ARR.indexOf(o.goodsId)&&-1==TR.ins.firstChargeBoxClickArr.indexOf(o.goodsId)){TR.ins.firstChargeBoxClickArr.push(o.goodsId),t.refresh(!0),Tu.sendToTotalModule("BP_UPDATE",null);var h=new Ne;h.uuid=o.uuId,Tu.sendToService(h)}VQ.instance.show(o)}}else hN.ins.open("SoulSkinGoodsTip",o.goodsId)}}},e.setMoEquitStar=function(e,t,i){if(_R.getIsMoEquit(e)){var n=Bi.MODEL.magicStarLevel(Bi.getIndex(e));if(!_R.getIsMoEquitSpecial(e))return this.redLayer.graphics.drawTextures(_R.starBgTexture,[t+4,i+5]),void this.redLayer.graphics.fillTexture(_R.starLevelTexture,t+6,i+7,26,22,"repeat-x",new Uh(26*(10-n),0));for(var s=Math.floor(n/6),o=Math.floor(n%6),a=0;a<o;a++){var r=new bu;r.scale(.45,.45);var l=_R.getStarTexture(s),c=.45*(_R.getStartX(o)+44*a)+t+11;this.iconLayer.graphics.drawTexture(l,c/.45,(i+this.SIZE-31)/.45,l.sourceWidth,l.sourceHeight,r)}}},p(0,e,"gridDatas",function(){return this.dataList},function(e){this.dataList=e,this.refresh(!0),this.width=(e.length>this.col?this.col:e.length)*(this.SIZE+this.X_B)-this.X_B,this.height=Math.ceil(e.length/this.col)*(this.SIZE+this.Y_B)-(this.needName?7:this.Y_B)}),p(0,e,"resetPosY",null,function(e){this.y=e}),c}(pp),OF=function(e){function t(){var e=this;e.csScore=0,e._offsetY=0,e._stoneAttr=null,e._lines=[],e._stonesIcon=[],e._desc=null,e.TITLE_C=28,e.TITLE_B=26,e.TEXT_B=15,e.TITLE_SIZE=24,e.TEXT_SIZE=24,e.TITLE_S=240,e.TEXT_S=54,e._splines=[],t.__super.call(e)}b(t,"modules.backpack.views.tip.EquipAttrTip",pp);var i=t.prototype;return i.showStoneIcon=function(e){if(0<this._stonesIcon.length)for(var t=0;t<this._stonesIcon.length;t++)(e=G.loader.getRes(NI.stone(this._stonesIcon[t].icon)))&&this.graphics.drawTextures(e,this._stonesIcon[t].p)},i.update=function(e,t){var i,n=this;if(this._offsetY=this._lines.length=this._stonesIcon.length=0,this.graphics.clear(),0<this._splines.length){var s;for(var o in this._splines)(s=this._splines[o]).removeSelf(),s.destroy(),s=null;this._splines=[]}if(this.setBaseAttr(e),this.setStrengthAttr(e),51!=e.position&&(this.setStoneAttr(e),this.setSpritAttr(e)),(new bu).identity(),this._lines.length){i=G.loader.getRes(NI.LINE3);for(var a=0;a<this._lines.length;a++){var r=new pp,l=new pp;r.pos(357,this._lines[a]),l.pos(232,this._lines[a]),l.scaleX=-1,r.graphics.drawTexture(i),l.graphics.drawTexture(i),this.addChild(r),this.addChild(l),this._splines.push(r,l)}}this.showStoneIcon(i),TR.ins.getGoodsDes(e.goodsId,ql.create(this,function(e,t,i){null!=i?(n._desc||(n._desc=kB.createHtmlDiv(45,0,n.TEXT_SIZE,"#90877b",470),n._desc.style.leading=23),n._desc.y=n._offsetY+23,n._desc.innerHTML=i,n._desc.height=n._desc.contextHeight,n.addChild(n._desc),n._offsetY+=n._desc.height+n.TEXT_B):n._desc&&n._desc.removeSelf(),this.height=n._offsetY-n.TEXT_B,e&&e.run()},[t]))},i.drawAttr=function(e,t,i,n,s,o,a){this.graphics.fillText(e,s,this._offsetY,o+"px SimHei",t,"left");var r=s+(mp.getStringLength(e)*o>>1)+4;this.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},i.drawValue=function(e,t,i,n,s){this.graphics.fillText(e,i,this._offsetY,n+"px SimHei",t,"left")},i.drawText=function(e,t,i,n,s){this.graphics.fillText(e,t,this._offsetY,i+"px SimHei",n,"left"),this._offsetY+=i+s},i.addLine=function(){this._offsetY+=56-this.TEXT_B,this._lines.push(this._offsetY-10),this._offsetY+=-20},i.cloneArr=function(e){for(var t=[],i=0;i<e.length;i++){var n=new Object;n.module=e[i].module,n.type=e[i].type,n.value=e[i].value,t.push(n)}return t},i.setBaseAttr=function(e){var t=this,i=[],n=PR.getGoodsNewAttr(e.goodsId);i=t.cloneArr(n);var s=aa.formatNewAttrToChinese(n),o=0;if(0<e.roleId){var a,r=0;null!=pR.ins.charId?a=pR.ins.passHash.take(e.roleId):null!=RN.ins.equipHash&&(a=RN.ins.equipHash.take(e.roleId));var l=RN.ins.getChuanShiPositionByEquPosi(e.position);a&&a.length>l&&(r=a[l]);var c=0;if(0<r){var u=RN.ins.getAttrByPositionAndLv(l,r),d=aa.formatAttrToChineseByList(u);for(o=0;o<d.length;o++)if(d[o].id==aa.ATTR_INC_RATE.id){c=parseInt(d[o].val);break}}for(o=0;o<i.length;o++)i[o].value=Math.floor(i[o].value+i[o].value*c/100)}var h=0;for(o=0;o<s.length;o++){var _=s[o],f=_.name+"：",p=_.val+"",g="";0<e.minRandom&&(g+=" +"+(h=parseInt(aa.getFormatValue(_.id,_.val*e.minRandom>>0)))),0<r&&(g+=" +"+(parseInt(aa.getFormatValue(_.id,(_.val*c/100).toFixed()))+parseInt((h*c/100).toString())));var v=t.TEXT_S+(mp.getStringLength(f.concat(p))*t.TEXT_SIZE>>1)+4;""!=g&&t.drawValue(g,"#23b11f",v,t.TEXT_SIZE,t.TEXT_B),t.drawAttr(f,"#90877b",p,"#90877b",t.TEXT_S,t.TEXT_SIZE,t.TEXT_B)}t.csScore=RR.getFight(i,-1,e.minRandom,!1)},i.setStrengthAttr=function(e){var t=e.strengthLv;if(0<t){this.addLine(),this.drawText(RP.n[251],this.TITLE_S,this.TITLE_C,"#e6d80d",this.TITLE_B);for(var i=modules.strength.others.StrengthUtil.getStrenAttr(0<e.position?e.position:Bi.MODEL.decoratePosition(e.cfgIdx),t),n=aa.formatNewAttrToChinese(i),s=0;s<n.length;s++){var o=n[s],a=o.name+"：",r=o.val+"";this.drawAttr(a,"#e6d80d",r,"#e6d80d",this.TEXT_S,this.TEXT_SIZE,this.TEXT_B)}}},i.setStoneAttr=function(e){var t=this,i=e.stoneLv;if(0<i){t.addLine(),t.drawText(RP.n[252],t.TITLE_S,t.TITLE_C,"#e6d80d",t.TITLE_B);var n=modules.strength.others.StrengthUtil.getStoneProByP(0<e.position?e.position:Bi.MODEL.decoratePosition(e.cfgIdx),i);t._stonesIcon=[];for(var s=aa.formatNewAttrToChinese(n),o=0;o<s.length;o++){var a=s[o];t._stonesIcon.push({icon:aa.getAttributById(a.id).keyStr,p:[t.TEXT_S,t._offsetY-2]}),0<a.val?t.drawText(modules.strength.others.StrengthUtil.getName(a.id)+"    "+aa.getAttributById(a.id).name+"+"+a.val,t.TEXT_S+32,t.TEXT_SIZE,"#9a3ce3",t.TEXT_B):t.drawText(modules.strength.others.StrengthUtil.getName(a.id)+RP.n[253],t.TEXT_S+32,t.TEXT_SIZE,"#5f5952",t.TEXT_B)}}},i.setSpritAttr=function(e){var t=e.zhulingLv;if(0<t){this.addLine(),this.drawText(RP.n[254],this.TITLE_S,this.TITLE_C,"#e6d80d",this.TITLE_B);for(var i=modules.strength.others.StrengthUtil.getEnchantAttr(0<e.position?e.position:Bi.MODEL.decoratePosition(e.cfgIdx),t),n=aa.formatNewAttrToChinese(i),s=0;s<n.length;s++){var o=n[s],a=o.name+"：",r=o.val+"";this.drawAttr(a,"#20a9e9",r,"#20a9e9",this.TEXT_S,this.TEXT_SIZE,this.TEXT_B)}}},t}(),PF=function(e){function u(){this._cmdsx=null,u.__super.call(this),null==u.text&&((u.text=new Yp).fontSize=20,u.text.font="SimHei")}b(u,"modules.broadcast.views.NoticeTextItem",e);var t=u.prototype;return t.doRender=function(e){this._cmdsx=e,this.graphics.clear();for(var t=G.loader.getRes("ui/layouts/broad/xt_xx_bg.png"),i=0,n=0;n<e.length;n++){var s=e[n];u.text.text=s.text,i+=u.text.textWidth}var o=i,a=256;240<o&&(a=o+20),t&&Cl.draw9Grid(this.graphics,t,0,0,a,28,[8,58,8,58]);for(var r=i=0;r<e.length;r++){var l=e[r],c=l.color;null!=c&&""!=c||(c="#e0d6c1"),this.graphics.fillText(l.text+"",(a-o)/2+i,3,"20px SimHei",c,"left"),u.text.text=l.text,i+=u.text.textWidth}},p(0,t,"alpha",e.prototype._$get_alpha,function(e){if(G.superSet(pp,this,"alpha",e),e<=0)for(u.text.text="",this.graphics.clear(!0);0<this._cmdsx.length;){this._cmdsx.shift();null}}),u.text=null,u}(pp),RF=function(t){function i(e){var t=this;t.needGridBg=!0,t.equipType=0,t._role=0,t._lv=0,t._showDefault=!0,t._showTxt=!1,t._isMe=!1,t._isActive=!1,t.quality=-1,void 0===e&&(e=!0),i.__super.call(t),t._isMe=e,t.size(106,106)}b(i,"modules.medal.views.item.MedalGrid",t);var e=i.prototype;return e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},e.refresh=function(){var e=this;if(e.graphics.clear(),0!=e.equipType){var t=0,i=0;if(0<=e._role){var n=e._isMe?gR.ins.actorList[e._role]:pR.ins.actorList[e._role];switch(e.equipType){case fa.XZ.type:t=n.xzCfgId,i=n.xzCfgId;break;case fa.DP.type:t=n.dpCfgId,i=n.dpCfgId;break;case fa.MB.type:t=n.mbAdvCfgId,i=n.mbCfgId;break;case fa.HS.type:t=n.hsAdvCfgId,i=n.hsCfgId;break;case fa.HY.type:t=n.hyAdvCfgId,i=n.hyCfgId;break;case fa.SJ.type:t=n.sjAdvCfgId,i=n.sjCfgId}}if(e.showDefault||(e.isActive=0<i,0!=i||0!=t)){var s;switch(e.equipType){case fa.XZ.type:case fa.DP.type:s=Dn.MODEL.icon(Dn.getIndex(t));break;case fa.MB.type:case fa.HS.type:case fa.HY.type:case fa.SJ.type:s=On.MODEL.icon(On.getIndex(t))}if((e._lv=0)<=i&&e.showTxt&&(e._lv=Dn.MODEL.level(Dn.getIndex(i))-1),e.needGridBg){var o=0;o=e.equipType==fa.XZ.type||e.equipType==fa.DP.type?3:On.MODEL.colourId(On.getIndex(t)),e.quality=o;var a=NI.gridBg(o),r=G.loader.getRes(a);r&&e.graphics.drawTexture(r,0,0,e.width,e.height)}(r=NR.getIcon(s))?e.drawIcon(r):NR.loadIcon(s,ql.create(e,e.drawIcon))}}},e.drawIcon=function(e){if(e){var t=this.width-e.width>>1,i=this.height-e.height>>1;this.graphics.drawTexture(e,t,i,e.width,e.height)}this.drawText(this.graphics)},e.drawText=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),0<this._lv&&e.fillText("+"+this._lv,t+this.width-6,i+this.height-26,"22px SimHei","#ec8206","right")},p(0,e,"dataSource",null,function(e){this.bindData=e}),p(0,e,"bindData",null,function(e){this.equipType=0,this.quality=-1,e&&(this.equipType=parseInt(e.equipType),this._role=parseInt(e.selectIdx)),this.refresh()}),p(0,e,"showDefault",function(){return this._showDefault},function(e){this._showDefault=e}),p(0,e,"isActive",function(){return this._isActive},function(e){this._isActive=e}),p(0,e,"showTxt",function(){return this._showTxt},function(e){this._showTxt=e}),i}(pp),NF=function(e){function _(){var e=this;e._initialized_=!1,e.isTouchMoveTime=0,e.offsetX=0,e.offsetY=0,e.onReadyOrder=null,e.moveTime=0,e.loopMoveCheckTime=0,e.loopMoveTag=!1,e.sid=null,e.cid=null,e.cType=0,e._changeSceneObject=null,e._isChangeFinish_=!1,e._isStartChange=!1,e.send10305Time=0,e.onOverOrder,e._selectChar_,e.recordPoints=new jl,_.__super.call(e),e._setup_()}b(_,"modules.scene.others.GameStage",pp);var t=_.prototype;return t._setup_=function(){var e=this;if(0==e._initialized_){e._initialized_=!0,e.initScene(),e.initEvent(),e.initMainChar(),G.stage.addChild(e),_._EffectLayer_=new pp,G.stage.addChild(_._EffectLayer_),e.initUI();e.scaleX=e.scaleY=1.3,e.offsetX=.3*G.stage.width/2,e.offsetY=.3*G.stage.height/2}},t.onResize=function(){this.scaleX=this.scaleY=1,this.offsetX=0*G.stage.width/2,this.offsetY=0*G.stage.height/2},t.initScene=function(){modules.scene.others.GameStage._scene_=new WF,modules.scene.others.GameStage._terrain_=new YF,this.addChild(modules.scene.others.GameStage._terrain_),this.addChild(modules.scene.others.GameStage._scene_),this.stage.on("keydown",this,this.onKeyDown),modules.scene.others.GameStage._scene_.onMoveHander=ql.create(this,this.onMoveHander,null,!1)},t.onKeyDown=function(e){e.keyCode},t.initMainChar=function(){if(modules.scene.others.GameStage.mainChar=new Dj,modules.scene.others.GameStage.mainChar.inited(),modules.scene.others.GameStage.mainChar.actSpeed=1,modules.scene.others.GameStage.mainChar.char_name="",modules.scene.others.GameStage.mainChar.setCharBoolValue(1e5,1e5),modules.scene.others.GameStage.mainChar.charNameColor="#e8dcc2",modules.scene.others.GameStage.mainChar.isCharObj=!0,""!=gR.ins.guildName&&null!=gR.ins.guildName&&(modules.scene.others.GameStage.mainChar.setCharProfessionNameVisible(!0),0<gR.ins.guidePos?modules.scene.others.GameStage.mainChar.charProfessionName=gR.ins.guildName+"["+Bl.getCNPos(gR.ins.guidePos)+"]":modules.scene.others.GameStage.mainChar.charProfessionName=gR.ins.guildName),0<=gR.ins.govPosition&&modules.scene.others.GameStage.mainChar.showPosition(gR.ins.govPosition),0<gR.ins.actorFlyUpLevel){var e=gR.ins.actorFlyUpLevel;modules.scene.others.GameStage.mainChar.setCharFlyupNameVisible(!0),modules.scene.others.GameStage.mainChar.setflyupName(e)}modules.scene.others.GameStage.mainChar.charProfessionNameColor="#02b0e9",yH.Ins().mainChar=modules.scene.others.GameStage.mainChar,modules.scene.others.GameStage._scene_.addItem(modules.scene.others.GameStage.mainChar),uH.Ins().addChar(modules.scene.others.GameStage.mainChar)},t.initUI=function(){qH.loadStyleImage("LeverUI","LeverUI")},t.initEvent=function(){G.timer.frameLoop(1,this,this.onEnterFrameHander),_.scene.on("mousedown",this,this.onTouchDownHander),this.stage.on("mouseup",this,this.onTouchUpHander)},t.startTouchDownHander=function(){this.stage.on("mousedown",this,this.onTouchDownHander2),_.scene.off("mousedown",this,this.onTouchDownHander)},t.setupMainCharData=function(e){modules.scene.others.GameStage._terrain_.onReadyOrder=ql.create(this,this.onReadyHander,null,!1),modules.scene.others.GameStage.mainChar.speed=280,modules.scene.others.GameStage.mainChar.char_id=gR.ins.charId,e&&(modules.scene.others.GameStage.mainChar.char_name=e.charName);var t=gR.ins.actorList[0];if(ZN.updateCharDisplayByVo(modules.scene.others.GameStage.mainChar,t),modules.scene.others.GameStage.mainChar.play("stand"),modules.scene.others.GameStage.mainChar.hero_id=1,modules.scene.others.GameStage.mainChar.setDir(yH.currDir),modules.scene.others.GameStage.mainChar.setCharBoolValue(t.currHP,t.maxHP),modules.scene.others.GameStage.mainChar.setCharProfessionNameVisible(!1),modules.scene.others.GameStage.mainChar.setCharFlyupNameVisible(!1),ZN.setCharTitle(modules.scene.others.GameStage.mainChar,t.titles),modules.scene.others.GameStage.mainChar.profession=t.job,modules.scene.others.GameStage.mainChar._proto_=t,""!=gR.ins.guildName&&null!=gR.ins.guildName&&(modules.scene.others.GameStage.mainChar.setCharProfessionNameVisible(!0),modules.scene.others.GameStage.mainChar.charProfessionName=gR.ins.guildName,0<gR.ins.guidePos?modules.scene.others.GameStage.mainChar.charProfessionName=gR.ins.guildName+"["+Bl.getCNPos(gR.ins.guidePos)+"]":modules.scene.others.GameStage.mainChar.charProfessionName=gR.ins.guildName),0<=gR.ins.govPosition&&modules.scene.others.GameStage.mainChar.showPosition(gR.ins.govPosition),0<gR.ins.actorFlyUpLevel){modules.scene.others.GameStage.mainChar.setCharFlyupNameVisible(!0);var i=gR.ins.actorFlyUpLevel;modules.scene.others.GameStage.mainChar.setflyupName(i)}for(var n=gR.ins.actorList,s=1;s<n.length;s++){var o=n[s],a=uH.Ins().createHero(o.id,modules.scene.others.GameStage.mainChar,o);uH.Ins().currCid==_a.S_BIQI.toString()?a.visible=!1:a.visible=!0}},t.onGridChangeHander=function(){},t.onMoveEndHander=function(){var e=this;if(e.selectChar)switch(e.selectChar.type){case Za.MONSTER:e.onMoveEndForMonster();break;case Za.NPC:e.onMoveEndForNpc();break;case Za.DIGGER:e.onMoveEndForDigger();break;case Za.TRANSPORT:e.onMoveEndForTransport();break;case Za.PICKUP_GOLD:case Za.PICKUP_ITEM:e.onMoveEndForPickUpItem();break;case Za.CHAR:e.onMoveEndForChar();break;case Za.COLLECTION:e.onMoveEndForCOLLECTION();break;case Za.MONSTER_TRANSPORT:e.onMoveEndForMosterTransport()}},t.onMoveEndForMosterTransport=function(){_.mainChar.faceTo(this.selectChar),this.selectChar.proto&&Tu.sendToModule("MOVE_END_TO_MONSTER",["modules.corssbattle.NewBossModule"],this.selectChar)},t.onMoveEndForTransport=function(){_.mainChar.faceTo(this.selectChar),this.selectChar=this.selectChar;var e=this.selectChar.proto;if(uH.Ins().currCid!=e.tar_id){var t=parseInt(uH.Ins().currCid);if(0<=_a.S_SBK_SCENES.indexOf(t)){if(!ZN.isEnabledChangeScene())return;af.reqEntry(parseInt(e.tar_id))}else modules.scene.others.GameStage.Ins().changeScene(e.tar_id,!0)}},t.onMoveEndForPickUpItem=function(){this.selectChar&&sH.getInstance().pickUp(this.selectChar)},t.onMoveEndForNpc=function(){_.mainChar.faceTo(this.selectChar),this.selectChar=this.selectChar;var e=this.selectChar.proto;Tu.sendToModule("OPENNPCUI",["modules.task.TaskModule"],e.modelId)},t.onMoveEndForDigger=function(){this.selectChar=this.selectChar;var e=this.selectChar.proto;Tu.sendToModule("__DIGGER_PLUNDER__",["modules.digger.DiggerModule"],e.playerId)},t.onMoveEndForCOLLECTION=function(e){e||(e=this.selectChar),uF.maincharCaiji(1,parseFloat(e.char_id),e.objectId)},t.onMoveEndForChar=function(e){e||(e=this.selectChar);var t=!1;if(e.type==Za.DIGGER&&(t=!0),2!=uH.Ins().currCkType&&(t=!0),0<zN.enabledPickupQueueLength&&(t=!0),ZN.isSynch())return uF.currMonsterPoint=e.point,uF.currMonster=e,void(0==ZN.isYZBQCSceneID()?uF.maincharmoveEnd(1,parseFloat(e.char_id),e.objectId):uF.maincharmoveEndForYeZhanBiQi(0,parseFloat(e.char_id),e.objectId));t?modules.scene.others.GameStage.Ins().selectChar=null:sH.getInstance().isStop=!0},t.showAll=function(){for(var e=_.scene.midLayerQueue,t=0;t<e.length;t++){var i=e[t];i.hero_id<=0&&0==i.isDeath&&(i.visible=!0,i.ai&&i.ai.start())}},t.showTotalAll=function(){for(var e=_.scene.midLayerQueue,t=0;t<e.length;t++){var i=e[t];i&&(i.hero_id<=0||i==modules.scene.others.GameStage.mainChar)&&(i.visible=!0,i.ai&&i.ai.start())}},t.heidTotalAll=function(){for(var e=_.scene.midLayerQueue,t=0;t<e.length;t++){var i=e[t];i&&i&&(i.visible=!1,i.ai&&i.ai.stop())}},t.heidAll=function(){for(var e=_.scene.midLayerQueue,t=0;t<e.length;t++){var i=e[t];i.hero_id<=0&&0==i.isDeath&&(i.visible=!1,i.ai&&i.ai.stop())}},t.removeChild=function(e){return laya.display.Node.prototype.removeChild.call(this,e)},t.removeChildAt=function(e){return laya.display.Node.prototype.removeChildAt.call(this,e)},t.heidBeside=function(e){for(var t=_.scene.midLayerQueue,i=0;i<t.length;i++){var n=t[i];n!=e&&n.hero_id<=0&&(n.visible=!1,n.ai&&n.ai.stop())}},t.onMoveEndForMonster=function(){if(dr.dtoEnterScene&&(41!=dr.dtoEnterScene.type&&42!=dr.dtoEnterScene.type||(LN.isTarMove=!1,pZ.ins.showGuiShuInfo())),ZN.isSynch())return uF.currMonsterPoint=this.selectChar.point,uF.currMonster=this.selectChar,void uF.maincharmoveEnd(0,parseFloat(this.selectChar.char_id),this.selectChar.objectId);_.mainChar.faceTo(this.selectChar),sH.getInstance().attackChar(gR.ins.charId,this.selectChar.char_id)},t.onMoveEndFor=function(){},t.loopTouchMove=function(){if(!NB.isAllStop&&(ZN.isSynchScene()||1==uH.Ins().currCkType)){var e=PB.pixelsAlginTile(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY);10<ol.distance(e,modules.scene.others.GameStage.mainChar.point)&&yH.Ins().mainCharMove(new Uh(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY))}},t.resize=function(){},t.onTouchUpHander=function(){_.isTouchMove=!1,_.isTouchDown=!1,modules.scene.others.GameStage.mainChar&&(modules.scene.others.GameStage.mainChar.isLoopMove=!1),_.dealyMove=BB.getTimer();var e=PB.pixelsAlginTile(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY);PB.pixelsToTile(e.x,e.y).toString()==_.mainChar.tilePoint.toString()&&0==modules.scene.others.GameStage.mainChar.isRuning&&yH.Ins().stopNow()},t.isAllowAttack=function(e){return-1==[Za.EFFECT,Za.NPC,Za.PICKUP_ITEM,Za.PICKUP_GOLD,Za.TRANSPORT,Za.PICKUP_GOLD,Za.DIGGER].indexOf(e.type)},t.updateSelectEffectPos=function(){if(NB.selectGreenEffect&&(NB.selectGreenEffect&&NB.selectGreenEffect.visible&&(NB.selectGreenEffect.visible=!1),NB.selectYellowEffect&&NB.selectYellowEffect.visible&&(NB.selectYellowEffect.visible=!1),NB.selectEffect=NB.selectGreenEffect,uH.Ins().currCid==_a.S_KUANGDONG.toString()&&this.selectChar&&this.selectChar.type!=Za.NPC&&(NB.selectEffect=NB.selectYellowEffect)),NB.selectEffect)if(this.selectChar){var e=[Za.EFFECT,Za.NPC,Za.PICKUP_GOLD,Za.TRANSPORT,Za.PICKUP_GOLD,Za.DIGGER];ZN.isSynchScene()&&e.push(Za.CHAR),-1==e.indexOf(this.selectChar.type)?NB.selectEffect.visible&&(NB.selectEffect.visible=!1):(null==NB.selectEffect.parent&&_.scene.addItem(NB.selectEffect,0),NB.selectEffect.x=this.selectChar.x,NB.selectEffect.y=this.selectChar.y)}else NB.selectEffect.visible&&(NB.selectEffect.visible=!1)},t.onTouchDownHander2=function(e){e&&e.target&&e.target instanceof laya.display.Stage&&e.target.focus instanceof modules.nav.views.NavMainView?this.onTouchDownHander(e):e&&e.target&&(e.target instanceof zwc.engine.core.displays.world.Scene||e.target instanceof modules.gui.others.LayerManager)&&this.onTouchDownHander(e)},t.onTouchDownHander=function(e){var t=this;if(!modules.scene.others.GameStage.mainChar.isDeath&&!NB.isAllStop&&!aH.isZhanBaokMode){var i=BR.ins.curCopyId,n=rn.getIndex(i),s=rn.MODEL.cate(n);if(28!=s)if(gF.TARGETHISTORY&&gF.clearTarget(),sH.autoFighCounter=BB.getTimer(),_.isTouchDown=!0,t.loopMoveTag=!0,t.loopMoveCheckTime=BB.getTimer(),gF.AUTOTIME=t.loopMoveCheckTime,!(BB.getTimer()<_.Droping_LockMove))if(!(modules.scene.others.GameStage.mainChar.currHp<=0||modules.scene.others.GameStage.mainChar.isPauseMove)){_.isDebug&&modules.scene.others.GameStage.scene.drawLayer2.graphics.clear();var o,a=!1;modules.scene.others.GameStage.Ins().selectChar&&(a=!0),o=t.getUnderPoint();if(t.selectChar=o,sH.getInstance().autoMode&&ZN.isSynch()&&(sH.getInstance().autoMode=!1),o){var r=ZN.getTileDisByPos(o.tileX,o.tileY,_.mainChar.tileX,_.mainChar.tileY);if(o.type==Za.PICKUP_ITEM||o.type==Za.PICKUP_GOLD)r<=0?t.onMoveEndHander():yH.Ins().mainCharMove(o.point,!0,ql.create(modules.scene.others.GameStage.Ins(),modules.scene.others.GameStage.Ins().onMoveEndHander),!0);else if(o.type==Za.CHAR||o.type==Za.DIGGER)if(1==ZN.isYZBQCSceneID())t.onMoveEndHander();else if(r<=0)t.onMoveEndHander();else{var l=YN.getCharNearPt(o);yH.Ins().mainCharMove(l,!0,ql.create(modules.scene.others.GameStage.Ins(),modules.scene.others.GameStage.Ins().onMoveEndHander),!0)}else if(o.type==Za.MONSTER&&ZN.isSynch())t.onMoveEndForMonster();else{if(o.type==Za.TRANSPORT||o.type==Za.MONSTER)return;if(sH.attackCharEnabled(o))8!=s&&sH.getInstance().attackChar(modules.scene.others.GameStage.mainChar.char_id,o.char_id);else{if("100314"==o.char_id)return;if(r<=1)_.mainChar.faceTo(o),t.onMoveEndHander();else if(300<BB.getTimer()-t.moveTime){t.moveTime=BB.getTimer();var c=YN.getCharNearPt(o);yH.Ins().mainCharMove(c,!0,ql.create(modules.scene.others.GameStage.Ins(),modules.scene.others.GameStage.Ins().onMoveEndHander),!0)}}}o.type==Za.MONSTER&&(sH.getInstance().autoMode=!0)}else{var u=[1,20100,6001,20140,20150,20130,20160,4010].indexOf(parseInt(uH.Ins().currCid));if(ZN.isSynch()&&(u=1),i=BR.ins.curCopyId,n=rn.getIndex(i),s=rn.MODEL.cate(n),2==u&&(24==s||25==s))return;if(-1!=u&&28==s)return;if(1<uH.Ins().currCkType&&-1==u&&56!=s)return;var d=PB.pixelsAlginTile(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY);PB.pixelsToTile(d.x,d.y).toString()!=_.mainChar.tilePoint.toString()&&300<BB.getTimer()-t.moveTime&&(t.moveTime=BB.getTimer(),a&&yH.Ins().clear(),yH.Ins().mainCharMove(d)),20!=s&&21!=s||(uF.attackTarget&&(uF.attackTarget.isBoss=!1,uF.attackTarget.objectId=0),sH.stop())}G.timer.once(100,t,t.onTouchMoveCheck,null)}}},t.onTouchMoveCheck=function(){_.isTouchDown?(_.isTouchMove=!0,this.isTouchMoveTime=BB.getTimer()):_.isTouchMove=!1},t.getTileChars=function(e,t){return WF._charGrids_[e]&&WF._charGrids_[e][t]?WF._charGrids_[e][t]:[]},t.getUnderPoint=function(){var e=PB.pixelsToTile(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY),t=zN.findCharsBySize(e,5);if(t.length){for(var i=[],n=0;n<t.length;n++)if(t[n]!=_.mainChar){var s=t[n];if(s.parent){var o=s.parent.getChildIndex(s);s.selectEnabled&&s.inStageRect()&&s.hotArea.contains(modules.scene.others.GameStage.scene.mouseX,modules.scene.others.GameStage.scene.mouseY)&&(s.type==Za.NPC&&(o=0),i.push({depth:o,char:s}))}}if(i.length)return(i=ol.srotOn(i,"depth",Array.NUMERIC))[0].char}return null},t.onMoveHander=function(){NB.isSceneReady&&(modules.scene.others.GameStage._terrain_.x=modules.scene.others.GameStage._scene_.x,modules.scene.others.GameStage._terrain_.y=modules.scene.others.GameStage._scene_.y)},t.onReadyHander=function(){var e=this;if(BB.attackMonsterMode=0,_.selectIndex=0,_.scene.pixel_width=_.scene.width=_._terrain_.terrainData.pixel_width,_.scene.pixel_height=_.scene.height=_._terrain_.terrainData.pixel_height,modules.scene.others.GameStage.mainChar.isShowad=!0,aH.isZhanBaokMode=!1,uH.heroRelive(!1),NB.selectGreenEffect&&(NB.selectGreenEffect.dispose(),NB.selectGreenEffect.recover()),NB.selectGreenEffect=mj.GetNew(),NB.selectGreenEffect.loadEffect("jm0083",Za.LAYER_BOTTOM),NB.selectGreenEffect.isSceneEffect=!0,NB.selectGreenEffect.renderInSelf=!0,NB.selectGreenEffect.visible=!1,NB.selectYellowEffect&&(NB.selectYellowEffect.dispose(),NB.selectYellowEffect.recover()),NB.selectYellowEffect=mj.GetNew(),NB.selectYellowEffect.loadEffect("jm1096",Za.LAYER_BOTTOM),NB.selectYellowEffect.isSceneEffect=!0,NB.selectYellowEffect.renderInSelf=!0,NB.selectYellowEffect.visible=!1,NB.selectYellowEffect.scaleX=NB.selectYellowEffect.scaleY=2,null!=e.onReadyOrder?(2==uH.Ins().currCkType&&sH.start(),e.onReadyOrder.run(),e.onReadyOrder=null):gF.TARGETHISTORY||sH.start(),e.onOverOrder&&(e.onOverOrder.run(),e.onOverOrder=null),FN.isClickActiveNPC&&FN.isNeedCrossScene&&"1"==uH.Ins().currCid){var t,i=zN.getNPC(FN.NPC_ID);i?(t=YN.getCharNearPt(i),modules.scene.others.GameStage.Ins().selectChar=i):t=FN.YZBQC_NPC_P,G.timer.once(600,e,e.delayFunc,[t]),modules.scene.others.GameStage.mainChar._CharMoveEnd_=ql.create(e,e.moveEndFunc,null,!1),FN.clearNPCinfo()}Tu.sendToModule("CREATE_SCENE_COMPLETE",["modules.corssbattle.NewBossModule"])},t.delayFunc=function(e){G.timer.clear(this,this.delayFunc),FN.crossSceneFindPathForNPCID(FN.NPC_ID,e),modules.scene.others.GameStage.mainChar.moveTo(e.x,e.y)},t.moveEndFunc=function(){Tu.sendToModule("OPENNPCUI",["modules.task.TaskModule"],"100211")},t.drawBlock=function(){for(var e=_.mainChar.tilePoint,t=e.x-7,i=e.x+7,n=e.y-8,s=e.y+8,o=t;o<i;o++)for(var a=n;a<s;a++){var r=YH.instance.takeItem(o,a);r&&(0==r.heroType?modules.scene.others.GameStage.scene.drawLayer.graphics.drawCircle(r.pixel_cx,r.pixel_cy,5,"0"):r.isBookHero?modules.scene.others.GameStage.scene.drawLayer.graphics.drawCircle(r.pixel_cx,r.pixel_cy,3,"ff0000"):modules.scene.others.GameStage.scene.drawLayer.graphics.drawCircle(r.pixel_cx,r.pixel_cy,3,"00ff00"))}},t.onEnterFrameHander=function(){if(!NB.isAllStop){var e=BB.getTimer();if(this.loopMoveTag&&200<e-this.loopMoveCheckTime&&(this.loopMoveCheckTime=e,this.loopMoveTag=!1,modules.scene.others.GameStage.mainChar.isLoopMove=!!_.isTouchDown),yj.loopMoveHander(),this.updateSelectEffectPos(),0==ZN.isShaking?null!=_.camPoint?(modules.scene.others.GameStage.scene.sceneMoveTo(_.camPoint.x,_.camPoint.y),modules.scene.others.GameStage.scene.doRender()):modules.scene.others.GameStage.mainChar&&((0<_.fakeOffectX||0<_.fakeOffectY)&&(_.fakeOffectX=_.fakeOffectX-5,_.fakeOffectY=_.fakeOffectY-5),_.fakeOffectX<0&&(_.fakeOffectX=0),_.fakeOffectY<0&&(_.fakeOffectY=0),modules.scene.others.GameStage.scene.sceneMoveTo(modules.scene.others.GameStage.mainChar.x-_.fakeOffectX,modules.scene.others.GameStage.mainChar.y-_.fakeOffectY),modules.scene.others.GameStage.scene.doRender()):ZN.loopShake(),_.isTouchMove){if(BB.getTimer()-this.isTouchMoveTime<400)return;this.isTouchMoveTime=BB.getTimer(),this.loopTouchMove()}_.isDebug&&(modules.scene.others.GameStage.scene.drawLayer.graphics.clear(),this.drawBlock())}},t.clear=function(){pt.now();uF.charQueue.reset(),yH.Ins().clear(),qU.ins.updateBossBlood(0),uH.Ins().clear(),uH.yuanshenObjId=20,uH.yuanshenHash.reset(),hN.ins.close("BOSS_MIJING_SCENE"),hN.ins.close("BOSS_MIJING_RESULT_SCENE"),aH.clear(),oH.clear(),rH.clearAll(),tt.ins.clear(),_.scene.clear(),this.selectChar=null,sH.stop(),aH.isZhanBaokMode=!1,BB.IsModePVE=!0,aH.boss=null,modules.scene.others.GameStage._terrain_.scene_id!=this.sid&&modules.scene.others.GameStage._terrain_.clear(),qH.Ins().clearChangeScene(),G.timer.once(3e4,this,this.timeClear)},t.timeClear=function(){150<Math.floor(x_.systemResourceManager.memorySize/1048576*100)/100?(UH.getInstance().clearHeightMemory(!0),G.timer.once(1e4,this,this.timeClear)):G.timer.once(3e4,this,this.timeClear)},t.changeScene=function(e,t,i,n,s){var o=this;if(void 0===t&&(t=!0),void 0===s&&(s=-1),o._isChangeFinish_=!1,o._isStartChange=!0,t){if(BB.getTimer()-AG.sendServerTime<500)return;var a=new AG;a.cid=parseInt(e),a.x=0,a.y=0,Tu.sendToService(a),o.send10305Time=BB.getTimer(),tr.push(RP.n[255]+o.send10305Time+",cid:"+a.cid),o._changeSceneObject||o.enterChangeScene(e,i,n,s)}o._changeSceneObject=new Object,o._changeSceneObject.cid=e,o._changeSceneObject.onReadOrder=i,o._changeSceneObject.onOverHandler=n,o._changeSceneObject.type=s},t.changeClearAll=function(){this.send10305Time=0,this.clear()},t.startChangeScene=function(){0<this.send10305Time&&BB.getTimer()-this.send10305Time<1e3&&this.changeClearAll(),G.timer.frameLoop(1,this,this.timeOutEnterChangeScene)},t.timeOutEnterChangeScene=function(){if(qH.Ins().isclearEnd)return G.timer.clear(this,this.timeOutEnterChangeScene),void this.enterChangeScene(this._changeSceneObject.cid,this._changeSceneObject.onReadOrder,this._changeSceneObject.onOverHandler,this._changeSceneObject.type)},t.recordMainCharPosition=function(e){void 0===e&&(e=2),this.cType==e&&modules.scene.others.GameStage.mainChar&&(2==e?this.recordPoints.put(e,[modules.scene.others.GameStage.mainChar.x,modules.scene.others.GameStage.mainChar.y,this.cid],!0):this.recordPoints.put(e+"_"+this.cid+"_"+this.sid,[modules.scene.others.GameStage.mainChar.x,modules.scene.others.GameStage.mainChar.y],!0))},t.enterChangeScene=function(e,t,i,n){var s=this;void 0===n&&(n=-1);var o=Pn.getIndex(parseInt(e)),a=Pn.MODEL.birth(o),r=Pn.MODEL.type(o);1==Pn.MODEL.pkScene(o)&&zB.ins.showById(4536,1),s.cid&&s.cid!=e&&("1"==e||"1002"==e?UB.ins.playSound("25",3,!0):UB.ins.playSound("24",3,!0)),s.sid=Pn.MODEL.sid(o)+"",s.cType=r,s.cid?4!=n&&23!=n&&!BR.ins.isCheckPointBoss&&(2==r||6==r||0<=_a.S_COPY_AUTO_FIGHT.indexOf(uH.Ins().currCid))&&(_.exitMission(),BR.ins.exitClearBossData(),HR.ins.timeoutFlayBoss()):HR.ins.timeoutFlayBoss(),s.cid==_a.S_DIGGER.toString()&&0==BR.ins.curCopyId&&_.exitMission(),ZN.isSynchScene(parseInt(e))&&dr.dtoEnterScene&&20100!=dr.dtoEnterScene.cid&&-1==_a.S_SBK_SCENES.indexOf(dr.dtoEnterScene.cid)&&(dr.dtoEnterScene=null);var l=parseInt(e);if(20100!=l&&(modules.scene.others.GameStage.mainChar.charNameColor="#e8dcc2"),0<=_a.S_SBK_SCENES.indexOf(l)&&(modules.scene.others.GameStage.mainChar.charNameColor="#0000ff"),(gR.ins.changeScene(e)||e==_a.S_BIQI.toString())&&(uH.Ins().prveCid=e),(_.camPoint=null)!=t&&(s.onReadyOrder=t),s.onOverOrder=i,uH.gkDto=IB.hash.take(e),modules.scene.others.GameStage.mainChar.removeTopEffect("jm0026"),uH.Ins().changeScene(e,_.selectIndex),gR.ins){var c=gR.ins.actorById(modules.scene.others.GameStage.mainChar.hero_id);ZN.updateCharDisplayByVo(modules.scene.others.GameStage.mainChar,c),ZN.setCharTitle(modules.scene.others.GameStage.mainChar,modules.scene.others.GameStage.mainChar.proto.titles)}if(e!=s.cid&&(s.cid=e,zB.ins.checkRainbowAction("scene",e)),modules.scene.others.GameStage._terrain_.scene_id!=s.sid?modules.scene.others.GameStage._terrain_.change(s.sid):modules.scene.others.GameStage._terrain_.onMapDataReady(),0<BR.ins.curCopyId&&BR.ins.toc25000)_.mainChar.setXY(BR.ins.toc25000.x,BR.ins.toc25000.y),tr.push(RP.n[256]+BR.ins.toc25000.x+","+BR.ins.toc25000.y);else if(null!=BR.ins.toc10309)_.mainChar.setXY(BR.ins.toc10309.x,BR.ins.toc10309.y),tr.push(RP.n[257]+BR.ins.toc10309.x+","+BR.ins.toc10309.y),BR.ins.toc10309=null;else{var u=s.recordPoints.take(s.cType+"_"+e+"_"+s.sid);if(2==s.cType)if(u=s.recordPoints.take(s.cType))u[2]!=e&&(u=null,s.recordPoints.remove(s.cType));if(u&&UR.instance.checkPointExitBirth)_.mainChar.setXY(UR.instance.checkPointExitBirth.x,UR.instance.checkPointExitBirth.y),tr.push(RP.n[258]+UR.instance.checkPointExitBirth.x+","+UR.instance.checkPointExitBirth.y);else if(u)_.mainChar.setXY(u[0],u[1]),tr.push(RP.n[259]+u[0]+","+u[1]);else if(a){var d=PB.tileToPixelsByXY(parseInt(a.split("-")[0]),parseInt(a.split("-")[1]));tr.push(RP.n[260]+d.x+","+d.y),_.mainChar.setXY(d.x,d.y)}}UR.instance.checkPointExitBirth=null,s._isChangeFinish_=!0,s._isStartChange=!1;var h=Pn.MODEL.name(o);Tu.sendToModule("CHANGE_MAP",["modules.nav.NavModule"],h),Tu.sendToModule("__SCENE_CHANGED__",["modules.tianguan.TianguanModule","modules.task.TaskModule","modules.checkpoint.CheckPointModule","modules.digger.DiggerModule","modules.guild.GuildModule","modules.nav.NavModule","modules.siege.SiegeModule","modules.scene.SceneModule","modules.broadcast.BroadcastModule","modules.corssbattle.NewBossModule"],e),_.scene.addItem(NB.selectGreenEffect,0),_.scene.addItem(NB.selectYellowEffect,0),gR.ins.soulIsout&&Tu.sendToModule("ADD_YUANSHEN",["modules.scene.SceneModule"],[modules.scene.others.GameStage.mainChar,gR.ins.souloutAdvanStep,gR.ins.souloutSkin]),0<gR.ins.petIndex&&Tu.sendToModule("ADD_PET",["modules.scene.SceneModule"])},p(0,t,"isBossScene",function(){var e=Pn.getIndex(parseInt(this.cid)),t=Pn.MODEL.type(e);return!!(BR.ins.isCheckPointBoss||2!=t&&6!=t)}),p(0,t,"isReady",function(){return!!this._initialized_}),p(0,t,"selectChar",function(){return this._selectChar_},function(e){this._selectChar_&&(this._selectChar_.type==Za.NPC&&e&&e.type==Za.NPC&&hr.showNpcId!=this._selectChar_.char_id&&(hr.showNpcId=null,Tu.sendToModule("CLOSENPCUI",["modules.task.TaskModule"],this.selectChar.char_id),this._selectChar_.type==Za.NPC&&(yH.Ins().actCtrl.clearAll(),BB.attackMonsterMode=0)),this._selectChar_.type==Za.MONSTER&&this._selectChar_.currHp<this._selectChar_.maxHP&&this._selectChar_.setCharBoolVisible(!1)),this._selectChar_=e,this._selectChar_&&this.isAllowAttack(this._selectChar_)&&uH.Ins().currCid!=_a.S_TIANGUAN.toString()&&uH.Ins().currCid!=_a.S_WorldBoss.toString()&&(dr.dtoEnterScene&&9==dr.dtoEnterScene.type||this._selectChar_.setCharBoolVisible(!0),dr.dtoEnterScene&&14==dr.dtoEnterScene.type||this._selectChar_.setCharBoolVisible(!0)),_.mainChar.selectTarget=e,this.updateSelectEffectPos(),Tu.sendToModule("SS_SELECT_CHAR",["modules.siege.SiegeModule"],e?e.char_id:null)}),p(0,t,"isChangeFinish",function(){return this._isChangeFinish_}),p(0,t,"isStartChange",function(){return this._isStartChange}),p(1,_,"mainChar",function(){return _._mainChar},function(e){e.hero_id<4&&(_._mainChar=e)}),p(1,_,"terrain",function(){return _._terrain_},laya.display.Sprite._$SET_terrain),p(1,_,"scene",function(){return modules.scene.others.GameStage._scene_},laya.display.Sprite._$SET_scene),_.changeCtrlChar=function(e){if(_._mainChar&&_._mainChar.hero_id!=e+1&&_._mainChar.hero_id<4){var t,i;for(var n in _._mainChar.type=Za.HERO,_._mainChar.hero_id==_.currentDeadHeroID&&(_.isFakeMoveCarmer=!0,_.currentDeadHeroID=0),uH.heroQueue)(i=uH.heroQueue[n]).hero_id!=e+1||(_.isFakeMoveCarmer&&(_.fakeOffectX=i.x>=_._mainChar.x?i.x-_._mainChar.x:_._mainChar.x-i.x,_.fakeOffectY=i.y>=_._mainChar.y?i.y-_._mainChar.y:_._mainChar.y-i.y,_.isFakeMoveCarmer=!1),t=i,0==e&&(i.char_id=gR.ins.charId));if(t.type=Za.MAIN_CHAR,gR.ins.soulIsout){var s,o=uH.Ins().isGetHero(uH.yuanshenHash.take(gR.ins.controlobjId));if(o)o.visible=!0,(s=o.ai)&&s.setup(o,t),s.start(),rH.pushAI(s),uH.yuanshenHash.put(t.objectId,o.objectId),uH.yuanshenHash.remove(gR.ins.controlobjId),o.char_id=o.objectId+t.objectId.toString();else for(var a=0;a<gR.ins.actorList.length;a++){var r=gR.ins.actorList[a];t.objectId!=r.objectId&&(o=uH.Ins().isGetHero(uH.yuanshenHash.take(r.objectId)))&&(o.visible=!0,(s=o.ai)&&s.setup(o,t),s.start(),rH.pushAI(s),uH.yuanshenHash.put(t.objectId,o.objectId),uH.yuanshenHash.remove(gR.ins.controlobjId),o.char_id=o.objectId+t.objectId.toString())}}gR.ins.controlobjId=t.objectId,_.mainChar=t,yH.Ins().updateCtrl(),Tu.sendToModule("UpdateCurrHP",["modules.nav.NavModule","modules.copy.CopyModule"]),Tu.sendToModule("UpdateCurrMP",["modules.nav.NavModule"])}},_.exitMission=function(){_._mainChar&&1!=_._mainChar.hero_id&&_.changeCtrlChar(0)},_.Ins=function(){return null==_._instance_&&(_._instance_=new _),_._instance_},_._instance_=null,_._terrain_=null,_._scene_=null,_.isTouchDown=!1,_._mainChar=null,_.effectLoader=null,_.mainCtrlIndex=0,_.isFirst=!0,_.isFakeMoveCarmer=!1,_.fakeOffectX=0,_.fakeOffectY=0,_.currentDeadHeroID=0,_.isTouchMove=!1,_._EffectLayer_=null,_.isDebug=!1,_.isTouchEnabled=!0,_.dealyMove=null,_.selectIndex=0,_.heroQueue=[],_.Droping_LockMove=0,_.camPoint=null,_}(),BF=function(e){function t(){this.START_ANGLE=153,this._endAngle=0,t.__super.call(this)}b(t,"modules.skill.views.AngleLevelCom",pp);var i=t.prototype;return i.showLevelWithoutTween=function(e){var t=this.START_ANGLE+(Math.max(1,e)-1)*(230/9);this.levelEndAngle=t},p(0,i,"levelEndAngle",function(){return this._endAngle},function(e){this._endAngle!=e&&(this._endAngle=e,this.graphics.clear(),this.graphics.drawPie(270,233,270,this.START_ANGLE,this._endAngle,"#f00"))}),t}(),HF=function(t){function i(){var e=this;e.mijiId=0,e._toolTip=null,e._toolTipEnabled=!0,e.clickHandler=null,e.dto=null,e.goodsNum=0,e._isShow=!1,e.bgLayer=null,e.iconLayer=null,e.iconTexture=null,e.bgTexture=null,i.__super.call(e),e.size(116,116),e.bgLayer=new pp,e.addChild(e.bgLayer),e.iconLayer=new pp,e.addChild(e.iconLayer),e.on("undisplay",e,e.onRemove)}b(i,"modules.skill.views.item.MijiGrid",t);var e=i.prototype;return e.onAdd=function(){this.on("undisplay",this,this.onRemove),this.off("display",this,this.onAdd),null!=this.iconTexture&&Zl.addIconUse(this,this.iconTexture.url)},e.onRemove=function(){this.off("undisplay",this,this.onRemove),this.on("display",this,this.onAdd),Zl.clearIconTexture(this)},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this.clearIconTexture(),this.off("display",this,this.onAdd),this.off("display",this,this.onRemove)},e.refresh=function(){var e=this;if(e.graphics.clear(),e.iconLayer.graphics.clear(),e.bgLayer.graphics.clear(),Bi.hasIndex(e.mijiId)){var t=Bi.getIndex(e.mijiId),i=Bi.MODEL.colourId(t),n=NI.gridBg(i);s=G.loader.getRes(n),(e.bgTexture=s)&&e.bgLayer.graphics.drawTexture(s,0,0,116,116);var s=NR.getIcon(Bi.MODEL.icon(t));s?e.drawIcon(s):NR.loadIcon(Bi.MODEL.icon(t),ql.create(e,e.drawIcon)),1<e.goodsNum&&!e.isShow&&e.iconLayer.graphics.fillText(mp.getBigIntStr(e.goodsNum,0),e.width-8,e.height-28,"22px SimHei","#ece2ca","right")}},e.clearIconTexture=function(){Zl.clearIconTexture(this)},e.drawIcon=function(e){if(e){this.iconTexture=e;var t=this.width-e.width/.6>>1,i=this.height-e.height/.6>>1;this.iconLayer.graphics.drawTexture(e,t,i,e.width/.6,e.height/.6),Zl.addIconUse(this,e.url)}},e.onMouseTap=function(e){G.timer.callLater(this,this.showToolTip)},e.showToolTip=function(){null==this.clickHandler?this._toolTip&&this.dto&&this._toolTip.show(this.dto):this.clickHandler.runWith(this.dto)},p(0,e,"isShow",function(){return this._isShow},function(e){this._isShow=e}),p(0,e,"toolTip",function(){return this._toolTip},function(e){(this._toolTip=e)&&this._toolTipEnabled?this.on("click",this,this.onMouseTap):this.off("click",this,this.onMouseTap)}),p(0,e,"dataSource",null,function(e){this.bindData=e}),p(0,e,"bindData",null,function(e){e&&(this.mijiId=e,this.dto=yB.create(this.mijiId),this.goodsNum=TR.ins.getGoodsNum(this.mijiId),this.toolTip=VQ.instance,this.refresh())}),p(0,e,"toolTipEnabled",function(){return this._toolTipEnabled},function(e){this._toolTipEnabled=e,this._toolTip&&this._toolTipEnabled?this.on("click",this,this.onMouseTap):this.off("click",this,this.onMouseTap)}),i}(pp),VF=function(e){function t(){this._actived=!1,this.effect=null,this.img_seaAir=null,t.__super.call(this),this.initSeaAir()}b(t,"modules.skill.views.item.SeaAirItem",pp);var i=t.prototype;return i.disponse=function(){this.effect&&(this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect=null)},i.setXY=function(e,t){this.x=e,this.y=t},i.initSeaAir=function(){null==this.img_seaAir&&(this.img_seaAir=new vs),this.img_seaAir.skin=_r.getAtlasSubPath("actor/ng_jm_zz.png"),null==this.img_seaAir.parent&&this.addChild(this.img_seaAir),this.img_seaAir.index=0,this.img_seaAir.clipX=1,this.img_seaAir.clipY=2},p(0,i,"actived",function(){return this._actived},function(e){(this._actived=e)?null==this.effect&&(this.effect=mj.GetNew(),this.effect.renderInSelf=!0,this.effect.loadEffect("jm1497"),this.effect.pos(this.img_seaAir.x+28,this.img_seaAir.y+25),this.addChild(this.effect)):(this.effect&&this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect=null)}),t}(),GF=function(t){function i(e){this.skillId=0,this._bindData=null,this._learn=!1,this.texTrue=null,void 0===e&&(e=116),i.__super.call(this),this.size(e,e)}b(i,"modules.skill.views.item.SkillGrid",t);var e=i.prototype;return e.destroy=function(e){void 0===e&&(e=!0),Zl.clearIconTexture(this),t.prototype.destroy.call(this,e)},e.refresh=function(){var e=this.skillId=0;this._bindData&&(e=this._bindData),(e<=0||this.skillId!=e)&&(this.skillId=e,this.refreshIcon())},e.refreshIcon=function(){if(this.graphics.clear(),0!=this.skillId){var e=Vn.getIndex(this.skillId),t=_r.getIconPath(Vn.MODEL.icon(e)),i=G.loader.getRes(t);i?this.drawIcon(i):G.loader.load(t,ql.create(this,this.drawIcon),null,"image")}},e.drawIcon=function(e){e&&((this.texTrue=e).bitmap&&(e.bitmap.enableMerageInAtlas=!1),this.graphics.drawTexture(e,8,8,100,100),Zl.addIconUse(this,e.url))},p(0,e,"dataSource",null,function(e){this.bindData=e}),p(0,e,"bindData",function(){return this._bindData},function(e){this._bindData=e,G.timer.callLater(this,this.refresh)}),p(0,e,"isLearn",null,function(e){this._learn=e,Pg.gray(this,!e)}),i}(pp),UF=function(n){var s;function t(){var e=this;e.index=-1,e._imageList=null,e._imagePos=null,e._openPos=null,e.equipImg=null,e.toukuiImg=null,e.clothImg=null,e.xianlianImg=null,e.leftSZImg=null,e.rightSZImg=null,e.leftJZImg=null,e.rightJZImg=null,e._effect=null,e._effId="jm0015",e.isFirst=!1,t.__super.call(e),e.initUI(),e.on("display",e,e.add)}b(t,"modules.strength.views.CircleEquipPanel",n);var e=t.prototype;return e.add=function(e){this.off("display",this,this.add),this.on("undisplay",this,this.remove),this.open()},e.remove=function(e){var t=this;t.on("display",t,t.add),t.off("undisplay",t,t.remove);var i;G.timer.clearAll(t);for(var n=0;n<8;n++)i=t._imagePos[(8+n)%8],t._imageList[n].x=i[0],t._imageList[n].y=i[1];t._effect&&(t._effect.dispose(),t._effect=null)},e.destroy=function(e){var t;void 0===e&&(e=!0);for(var i=0;i<this._imageList.length;i++)t=this._imageList[i],Og.clearAll(t);n.prototype.destroy.call(this,e)},e.open=function(){var e,t=this,i=0;if(!this.isFirst){for(i=0;i<8;i++)e=this._openPos[(7-this.index+i)%8],this._imageList[i].x=e[0],this._imageList[i].y=e[1];for(i=0;i<8;i++)e=this._imagePos[(7-this.index+i)%8],Og.to(this._imageList[i],{x:e[0],y:e[1],ease:pa.cubicInOut},200,null,ql.create(this,function(){Og.clearAll(t._imageList[i])}));this.isFirst=!0}null==this._effect&&(this._effect=mj.GetNew(),this._effect.renderInSelf=!0,this._effect.loadEffect(this._effId),this._effect.scale_X=this._effect.scale_Y=1,this._effect.setXY(372,617),this.addChild(this._effect))},e.update=function(e,t,i){for(var n,s,o=0;o<8;o++)n=this._imagePos[(8-e+o)%8],this._imageList[o].select=o==e,Og.to(this._imageList[o],{x:n[0],y:n[1],ease:pa.cubicInOut},200,null,ql.create(this,this.onFinish,[this._imageList[o]],!0));for(o=0;o<this._imageList.length;o++)(s=this._imageList[o]).num=t[o],s.type=i},e.onFinish=function(e){Og.clearAll(e)},e.initUI=function(){var e,t,i=this;i.size(960,1280),i._imageList=[],i._imagePos=[],i._openPos=[],i.equipImg=new s,i.equipImg.data="equip",i.toukuiImg=new s,i.toukuiImg.data="toukui",i.clothImg=new s,i.clothImg.data="cloth",i.xianlianImg=new s,i.xianlianImg.data="xianlian",i.leftSZImg=new s,i.leftSZImg.data="leftSZ",i.rightSZImg=new s,i.rightSZImg.data="rightSZ",i.leftJZImg=new s,i.leftJZImg.data="leftJZ",i.rightJZImg=new s,i.rightJZImg.data="rightJZ",i._imageList=[i.equipImg,i.toukuiImg,i.clothImg,i.xianlianImg,i.leftSZImg,i.rightSZImg,i.leftJZImg,i.rightJZImg],i._imagePos=[[366,580],[550,521],[615,330],[550,138],[366,73],[182,138],[111,330],[182,521]],i._openPos=[[366,580],[550,521],[615,330],[550,138],[366,73],[182,138],[111,330],[182,521]];for(var n=0;n<i._imageList.length;n++)e=i._openPos[n],(t=i._imageList[n]).anchorX=.5,t.anchorY=.5,t.x=e[0],t.y=e[1],i.addChild(t)},t.__init$=function(){s=function(t){function i(){var e=this;e._type=0,e._num=0,e._txt=null,e._skin=null,e.data=null,e._select=!1,e.clears=[],i.__super.call(e),e._txt=kB.createLabel(3,10,100,22,e),e._txt.font="SimHei",e._txt.fontSize=20,e._txt.align="right"}b(i,"",t);var e=i.prototype;return e.destroy=function(e){for(void 0===e&&(e=!0);0<this.clears.length;)yc.clearRes(this.clears.shift());this.graphics.clear(),t.prototype.destroy.call(this,e)},e.refreshIcon=function(){var e,t=_r.getAtlasSubPath("base_ui2/ty_jm_gz.png");(e=G.loader.getRes(t))?this.drawBg(e):G.loader.load(this.skin,ql.create(this,this.drawBg),null,"image")},e.drawIcon=function(e,t){var i;i=G.loader.getRes(this.skin);var n=0,s=0;switch(this.data){case"leftSZ":n=-2,s=-4;break;case"xianlian":case"leftJZ":n=2}i&&this.graphics.drawTexture(i,(e-i.sourceWidth>>1)+n,(t-i.sourceHeight>>1)+s,i.sourceWidth,i.sourceHeight)},e.drawBg=function(e){this.graphics.clear(),e&&this.graphics.drawTexture(e,0,0,e.sourceWidth,e.sourceHeight);var t=e.sourceWidth,i=e.sourceHeight;(e=G.loader.getRes(this.skin))?this.drawIcon(t,i):G.loader.load(this.skin,ql.create(this,this.drawIcon,[t,i]),null,"image")},e.setActiveSkin=function(){switch(this.data){case"equip":return"ui/layouts/actor/dz_icon_wq_l.png";case"toukui":return"ui/layouts/actor/dz_icon_tk_l.png";case"cloth":return"ui/layouts/actor/dz_icon_yf_l.png";case"xianlian":return"ui/layouts/actor/dz_icon_xl_l.png";case"leftSZ":return"ui/layouts/actor/dz_icon_sz_l.png";case"rightSZ":return"ui/layouts/actor/dz_icon_yd_l.png";case"leftJZ":return"ui/layouts/actor/dz_icon_jz_l.png";case"rightJZ":return"ui/layouts/actor/dz_icon_xz_l.png"}return""},e.setNormalSkin=function(){switch(this.data){case"equip":return"ui/layouts/actor/dz_icon_wq_a.png";case"toukui":return"ui/layouts/actor/dz_icon_tk_a.png";case"cloth":return"ui/layouts/actor/dz_icon_yf_a.png";case"xianlian":return"ui/layouts/actor/dz_icon_xl_a.png";case"leftSZ":return"ui/layouts/actor/dz_icon_sz_a.png";case"rightSZ":return"ui/layouts/actor/dz_icon_yd_a.png";case"leftJZ":return"ui/layouts/actor/dz_icon_jz_a.png";case"rightJZ":return"ui/layouts/actor/dz_icon_xz_a.png"}return""},p(0,e,"type",function(){return this._type},function(e){var t;switch(this._type=e){case 2:t="#9a3ce3";break;case 3:t="#20a9e9";break;case 1:t="#e0d800"}this._txt.color=t}),p(0,e,"select",function(){return this._select},function(e){this._select=e}),p(0,e,"skin",function(){return this._skin},function(e){this._skin!=e&&(this._skin=e,this.refreshIcon())}),p(0,e,"num",function(){return this._num},function(e){0<(this._num=e)?(this._txt.text="+"+e,this.skin=this.setActiveSkin()):(this._txt.text="",this.skin=this.setNormalSkin()),-1==this.clears.indexOf(this.skin)&&this.clears.push(this.skin)}),i}(Ss)},t}(pp),FF=function(e){function t(){this._achieves=[],this.itemHeight=80,t.__super.call(this)}return b(t,"modules.task.views.DirectionAchieveGrid",pp),t.prototype.update=function(e){for(var t,i=0;i<e.length;i++)i<this._achieves.length?t=this._achieves[i]:(t=new MY,this._achieves.push(t)),"string"==typeof e[i]?t.update(e[i]):t.update(e[i].link),t.setGray(!e[i].open),t.pos(0,i*this.itemHeight),this.addChild(t);for(;i<this._achieves.length;i++)(t=this._achieves[i]).removeSelf()},t}(),qF=function(e){function t(){var e=this;e.rate=[0,1,2,3,1,2,3,4,2,3,4,5,3,4,5,6,4,5,6,7,5,6,7,8,6,7,8,9],e.bg=null,e.grid=null,t.__super.call(e),e.size(116,116),e.bg=new pp,e.bg.pivotX=e.bg.pivotY=53,e.bg.pos(53,53),e.addChild(e.bg),e.grid=new MF,e.grid.needGridBg=!1,e.addChild(e.grid),e.bgColor=1}b(t,"modules.treasure.views.item.TrGridItem",pp);var i=t.prototype;return i.reset=function(){var e=this;Og.clearAll(e.bg),e.bg.visible=!0,e.bg.rotation=0,e.bg.scaleX=e.bg.scaleY=1,Og.clearAll(e.grid),e.grid.visible=!0,e.grid.scaleX=e.grid.scaleY=1,e.grid._iconUrl=null},i.playFirst=function(e,t,i){this.bg.visible=this.grid.visible=!1,this.bindData=t,Og.to(this.bg,{complete:ql.create(this,this.onAlpha,[i-e-1])},40*this.rate[e])},i.onAlpha=function(e){this.bg.visible=!0,Og.to(this.grid,{complete:ql.create(this,this.onAlpha2)},40*(this.rate[e]+2))},i.onAlpha2=function(){this.grid.visible=!0},i.playOther=function(e,t,i){this.bindData=t,i.run()},i.onRo=function(e,t){this.bg.scaleX=this.bg.scaleY=1,this.bg.rotation=0,this.grid.visible=!0,this.bindData=e,t.run()},p(0,i,"bindData",null,function(e){this.bgColor=Bi.MODEL.colourId(e.cfgIdx),this.grid._iconUrl=null,this.grid.bindData=e}),p(0,i,"bgColor",null,function(e){var t=NI.gridBg(e);this.bg.texture=G.loader.getRes(t)}),t}(),jF=function(t){function i(){var e=this;e.skillId=0,e._skillIcon=null,e._bindData=null,e._iconLayer=1,e._iconUrl=null,i.__super.call(e),e.graphicsMode=!0,e.on("render",e,e.refresh),e.size(100,100),e.invalid()}b(i,"ui.gridrender.MSkillGrid",t);var e=i.prototype;return e.invalid=function(){iu.invalidRender(this)},e.refresh=function(){var e=this;e._skillIcon=null,"number"==typeof e._bindData&&Math.floor(e._bindData)==e._bindData?e.skillId=e._bindData:e._bindData&&"object"==typeof e._bindData&&(e.skillId=e._bindData.skillId,e._skillIcon=e._bindData.skillIcon),e.graphics.clear();var t=G.loader.getRes(_r.getAtlasSubPath("base_ui2/ty_jm_gz.png"));e.graphics.drawTexture(t,0,0,100,100),e.skillId<=0||0<e.skillId&&e.renderIcon()},e.renderIcon=function(){var e=this._skillIcon;if(!e){var t=Vn.getIndex(this.skillId);e=Vn.MODEL.icon(t)}var i=_r.getIconPath(e),n=G.loader.getRes(i);n?this.drawIcon(n):G.loader.load(i,ql.create(this,this.drawIcon),null,"image")},e.drawIcon=function(e){if(e){var t=this.graphics;e.bitmap&&(e.bitmap.enableMerageInAtlas=!1),this._iconUrl=e.url,t.drawTexture(e,i.zpt.x,i.zpt.y,100,100)}},e.destroy=function(e){void 0===e&&(e=!0),this._iconUrl&&""!=this._iconUrl&&(yc.clearRes(this._iconUrl),tt.ins.clearTexture(this._iconUrl)),this._bindData=null,this._iconUrl=null,t.prototype.destroy.call(this,e)},p(0,e,"bindData",function(){return this._bindData},function(e){this._bindData=e,this.invalid()}),f(i,["zpt",function(){return this.zpt=new Uh}]),i.__init$=function(){iu.bridgeMRenderer(i)},i}(pp),WF=function(e){function t(){var e=this;e.midLayerQueue=[],e.topLayer=null,e.bomLayer=null,e.bomBodyLayer=null,e.layers=[],e.onMoveHander=null,e.pixel_width=1e4,e.pixel_height=1e4,e.doDepthTime=0,e._topLayerEffect_=new Xo,e._bomLayerEffect_=new Xo,e._topLayer_=new Xo,e._midLayer_=new Xo,e._bomLayer_=new Xo,e._sceneEffectLayer_=new Xo,e._bomLayerBody_=new Xo,e._hurtLayer_=new Xo,e._weatherLay_=new Xo,e.drawLayer=new Xo,e.drawLayer2=new Xo,e._prop_visible_=xs.getSoleProperty(),t.__super.call(e),e.setup()}b(t,"zwc.engine.core.displays.world.Scene",pp);var i=t.prototype;return i.setup=function(){var e=this;(zwc.engine.core.displays.world.Scene.display=e).addChild(e.drawLayer),e.addChild(e.drawLayer2),e.addChild(e._bomLayerBody_),e.addChild(e._bomLayer_),e.addChild(e._sceneEffectLayer_),e.addChild(e._bomLayerEffect_),e.addChild(e._midLayer_),e.addChild(e._topLayer_),e.addChild(e._topLayerEffect_),e.addChild(e._hurtLayer_),e.addChild(e._weatherLay_),e.layers=[e._bomLayer_,e._midLayer_,e._topLayer_,e._bomLayerEffect_],e.topLayer=e._topLayer_,e.bomLayer=e._bomLayer_,e.bomBodyLayer=e._bomLayerBody_},i.onShowadRender=function(){if(NB.UiTextureSheet){this.bomLayer.graphics.clear(!0);for(var e=[],t=NB.showadTexture,i=0;i<this.midLayerQueue.length;i++){var n=this.midLayerQueue[i];n&&n.type!=Za.EFFECT&&n.visible&&n.isShowad&&n.inStageRect()&&e.push(n.x-t.width/2,n.y-t.height/2)}NF.scene.bomLayer.graphics.drawTextures(t,e)}},i.onBooldRender=function(){NB.UiTextureSheet&&CB.doRender(this.topLayer.graphics)},i.onInnerRender=function(){NB.UiTextureSheet&&MB.doRender(this.topLayer.graphics)},i.onCharHeadRender=function(){LB.doRender(this.topLayer.graphics)},i.addHurtImage=function(e){this._hurtLayer_.addChild(e)},i.doRender=function(){!NB.isAllStop&&NB.isSceneReady&&(this.onShowadRender(),this.topLayer.graphics.clear(!0),this.onCharHeadRender(),this.onBooldRender(),this.onInnerRender())},i.addItem=function(e,t){void 0===t&&(t=1),null!=e&&(1==(e.layer=t)&&(e[this._prop_visible_]=!1,-1==this.midLayerQueue.indexOf(e)&&this.midLayerQueue.unshift(e)),this.layers[t].addChild(e),uH.Ins().addChar(e))},i.removeItem=function(e,t){if(void 0===t&&(t=1),1==t){var i=this.midLayerQueue.indexOf(e);-1!=i&&this.midLayerQueue.splice(i,1),e[this._prop_visible_]=!1}e&&e.parent&&e.parent.removeChild(e),e.visible=!1},i.findBySize=function(e,t){for(var i=[],n=0;n<this.midLayerQueue.length;n++){var s=this.midLayerQueue[n];if(0==s.isDeath&&s!=NF.mainChar)ZN.getTileDis(s.tilePoint,e)<=t&&i.push(s)}return i},i.find=function(e,t,i){for(var n=[],s=new Uh(e,t),o=0;o<this.midLayerQueue.length;o++){var a=this.midLayerQueue[o];BB.distance(a.point,s)<=i&&n.push(a)}return n},i.sceneMoveTo=function(e,t,i){void 0===i&&(i=!1);var n=this.getCameraFocusTo(e,t-130,i);this.uniformSpeedMove(new Uh(this.x,this.y),n)},i.uniformSpeedMoveTo=function(e,t){var i=this.getCameraFocusPoint(e,t),n=new Uh;n.x=this.x,n.y=this.y;var s=n;this.uniformSpeedMove(s,i)},i.uniformSpeedMove=function(e,t){ol.distance(t,e);var i=t;i.x=i.x,i.y=i.y,this.x=i.x,this.y=i.y,this.doDepth(),this.onMoveHander.runWith([i.x,i.y])},i.getCameraFocusTo=function(e,t,i){void 0===i&&(i=!1);var n=G.stage.width,s=G.stage.height,o=1440,a=2880;0<this.pixel_width&&0<this.pixel_height&&(o=this.pixel_width,a=this.pixel_height);var r=n/2,l=s/2;return new Uh(o<n&&!(r<=e&&e<=o-r)?(n-o)/2:o<n||r<=e&&e<=o-r?r-e:e<=r?0:n-o,a<s&&!(l<=t&&t<=a-l)?(s-a)/2:a<s||l<=t&&t<=a-l?l-t:t<=l?0:s-a)},i.doDepth=function(){var e=this;if(0!=NB.isSceneReady){var t=!0;BB.getTimer()-e.doDepthTime<1200?t=!1:e.doDepthTime=BB.getTimer(),pN.isPanelOnStage?e.visible&&(e.visible=!1):0==e.visible&&(e.visible=!0);for(var i,n=e.midLayerQueue.length,s=[],o=[],a=0;a<n;a++)(i=e.midLayerQueue[a])&&(i.inStageRect()&&0==i.isRecover?(i[e._prop_visible_]||(i[e._prop_visible_]=!0,i.type==Za.MONSTER&&UB.ins._playMonsterSound(parseInt(i.proto.modelId),1)),s.push(i)):i.isRecover||i.cid!=uH.Ins().currCid?(i[e._prop_visible_]=!1,o.push(i),NF.Ins().selectChar==i&&(NF.Ins().selectChar=null),e.midLayerQueue.splice(a,1),a--):i[e._prop_visible_]=!1);for(var r=0;r<o.length;r++)i=o[r],uH.Ins().removeChar(i);if(t&&(s=ol.srotOn(s,"y",Array.NUMERIC)),e._topLayerEffect_.graphics.clear(!0),e._bomLayerEffect_.graphics.clear(!0),uq.doEffectRender(s,e._topLayerEffect_.graphics,e._bomLayerEffect_.graphics),mj.doRender(e._topLayerEffect_.graphics,e._bomLayerEffect_.graphics),t)for(var l=[0,0,0,0,0,0,0],c=0;c<s.length;c++){var u=s[c];if(u.hasOwnProperty("layer")){var d=u.layer;1==d?e._midLayer_.addChildAt(s[c],l[d]):e.layers[d].addChildAt(u,l[d]),l[d]++}else e._midLayer_.addChildAt(s[c],c)}}},i.onSort=function(e,t){return e.y-t.y?e.y:t.y},i.getCameraFocusPoint=function(e,t){var i=NB.stage.width,n=NB.stage.height,s=1e4,o=1e4;0<this.pixel_width&&0<this.pixel_height&&(s=this.pixel_width,o=this.pixel_height);var a=0,r=0,l=new Uh;l.x=e,l.y=t;this.localToGlobal(new Uh(l.x,l.y));var c=i/2,u=n/2,d=this.localToGlobal(new Uh(l.x,l.y));(l=new Uh).x=c,l.y=u;var h=ol.distance(l,d),_=this.scaleX,f=d.x-c,p=d.y-u,g=Math.atan2(p,f);d.x=c+0*Math.cos(g)*_,d.y=u+0*Math.sin(g)*_;var v=i-s,m=n-o;return 0+c<=e&&e<=s-c-0?0*_<=h&&(0<(a=d.x-e)&&(a=0),a<v&&(a=v)):e<=0+c?0<(a=d.x-e)&&(a=0):(a=d.x-e)<v&&(a=v),0+u<=t&&t<=o-u-0?0*_<=h&&(0<(r=d.y-t)&&(r=0),r<m&&(r=m)):t<=0+u?0<(r=d.y-t)&&(r=0):(r=d.y-t)<m&&(r=m),new Uh(a,r)},i.clear=function(){t._charGrids_.length=0,this._midLayer_.graphics.clear(!0),this._topLayerEffect_.graphics.clear(!0),this._bomLayerEffect_.graphics.clear(!0)},p(0,i,"weatherLayer",function(){return this._weatherLay_}),p(0,i,"sceneEffectLayer",function(){return this._sceneEffectLayer_}),p(0,i,"midLayer",function(){return this._midLayer_}),p(0,i,"hurtLayer",function(){return this._hurtLayer_}),t.display=null,t._charGrids_=[],t}(),YF=function(e){function t(){var e=this;e.onReadyOrder=null,e._scene_id=null,e.imageQueue=[],e.startTime=0,e.loopIndex=0,e.backgroundTime=0,e.loaderPool=[],e.isStop=!1,e.isClear=!1,e.terrainData=null,e.isEnterFrame=!1,e._limitIndex_=2,e.sceens256=["10020"],e.fixSize=1,e.loopTime=0,e.recodeAreaHash=[],e._reloadTimes=0,e.stageQueues=[],e._longTimeCount=0,e._useToRender_=!0,e.tileString="",e.varisReady=!1,e.binUrl="",t.__super.call(e),e.imageHash=new jl,e.requestHash=new jl,e.mapdataHash=new jl,e.stage_point=new Uh,e.once_point=new Uh,e.imageLoadRect=new u_,e.recodeRect,e.currentList=new Object,e.terrainData=new WH,G.timer.frameLoop(1,e,e.loop)}b(t,"zwc.engine.core.displays.world.terrain.SceneTerrain",e);var i=t.prototype;return i.loop=function(){var e=this;pN.isPanelOnStage?e.visible&&(e.visible=!1):(0==e.visible&&(e.visible=!0),NB.isSceneReady&&!NB.isAllStop&&null!=e.stage&&(BB.getTimer()-e.loopTime<80||(e.loopTime=BB.getTimer(),e.stage&&!e.isStop&&e.isEnterFrame&&null!=e.scene_id&&(e.updateStageRect(),e.addStageAreaImage(),e.loopload(),e.onRender()))))},i.updateStageRect=function(){var e=this.globalToLocal(new Uh(0,0));zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.x=e.x,zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.y=e.y,zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.width=G.stage.width,zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.height=G.stage.height,this.imageLoadRect=zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.clone(),this.imageLoadRect.x-=256,this.imageLoadRect.y-=256,this.imageLoadRect.width+=500,this.imageLoadRect.height+=500},i.loopload=function(){var e=this;if(!e.isStop&&!e.isClear&&0!=e.imageQueue.length){e.loopIndex=BB.getTimer();e.loopIndex,e.backgroundTime;if(e.backgroundTime=e.loopIndex,e.imageQueue.length){var t=e.getNearTile();if(t){t.tar.key;var i=t.tar.scene_id,n=new u_;n.x=512*t.tar.index_x,n.y=512*t.tar.index_y,n.width=512,n.height=512;e.imageLoadRect,e.imageQueue.indexOf(t.tar);e.imageQueue.splice(t.index,1),e.scene_id==i&&e.loadTile(t.tar.index_x,t.tar.index_y)}}}},i.addStageAreaImage=function(){var e=this.globalToLocal(new Uh(0,0)),t=this.globalToLocal(new Uh(NB.stage.width,NB.stage.height)),i=Math.floor(e.x/512),n=Math.floor(e.y/512),s=Math.ceil(t.x/512),o=Math.ceil(t.y/512),a=new u_(e.x,e.y,NB.stage.width,NB.stage.height);this.recodeRect,this.recodeRect=a.clone();var r=Math.min(i,s),l=Math.max(i,s),c=Math.min(n,o),u=Math.max(n,o);this.recodeAreaHash=[];for(var d=r;d<=l;){for(var h=c;h<=u;){this.addIndexAreaImages(d,h,!1,!0),h++}d++}},i.addIndexAreaImages=function(e,t,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),!(e<0||t<0||512*e>this.terrainData.pixel_width||512*t>this.terrainData.pixel_height)){var s=this.getIndexPath(e,t);if(!this.requestHash.has(s)){var o=e+"_"+t;if(zwc.engine.core.displays.world.terrain.SceneTerrain.tar_rect.x=512*e,zwc.engine.core.displays.world.terrain.SceneTerrain.tar_rect.y=512*t,zwc.engine.core.displays.world.terrain.SceneTerrain.tar_rect.width=512,zwc.engine.core.displays.world.terrain.SceneTerrain.tar_rect.height=512,zwc.engine.core.displays.world.terrain.SceneTerrain.stage_rect.intersects(zwc.engine.core.displays.world.terrain.SceneTerrain.tar_rect)||i){for(var a=!1,r=0;r<this.imageQueue.length;r++)if(this.imageQueue[r].key==o){a=!0;break}a||(n&&this.recodeAreaHash.push(o),this.imageQueue.push({scene_id:this.scene_id,key:o,index_x:e,index_y:t}))}}}},i.getIndexPath=function(e,t){return dr.nativeSuffix?NB.IMAGE_DIR+"maps/map_image/scene_"+this.scene_id+"/"+e+"_"+t+".jpg?"+hr.version:NB.IMAGE_DIR+"maps/map_image/scene_"+this.scene_id+"/"+e+"_"+t+".jpg"},i.loadTile=function(e,t){var i=this;if(!i.isStop&&!i.isClear&&0<i._limitIndex_){var n=i.getIndexPath(e,t);0==i.requestHash.has(n)&&(i._limitIndex_--,G.loader.load(n,ql.create(i,i.imageLoadedHander,[n,e,t]),null,"image",0,!0,"ASSETS_TERRAIN_GROUP"),G.loader.on("error",i,i.reload),i.requestHash.put(n,{path:n,indexX:e,indexY:t}))}},i.reload=function(e){if(this._reloadTimes<4){var t=this.requestHash.take(e);t?(this._reloadTimes++,G.loader.cancelLoadByUrl(e),G.loader.load(e,ql.create(this,this.imageLoadedHander,[e,t.indexX,t.indexY]),null,"image",0,!0,"ASSETS_TERRAIN_GROUP")):G.loader.off("error",this,this.reload)}else G.loader.off("error",this,this.reload)},i.clear=function(){var e=this;for(var t in e._limitIndex_=2,e.requestHash.proto){var i=e.requestHash.proto[t].path;G.loader.getRes(i)?yc.clearRes(i,!0):G.loader.cancelLoadByUrl(i)}for(var n in e.graphics.clear(!0),e.requestHash.reset(),e.stageQueues){var s=e.stageQueues[n];for(var o in s)delete s[o];delete e.stageQueues[n]}e.stageQueues.length=0,e.imageQueue.length=0,e.currentList=new Xg,yc.clearResByGroup("ASSETS_TERRAIN_GROUP"),e._useToRender_=!0,e.tileString=""},i.fitStage=function(){},i.clearHideTileTexture=function(){for(var e in this.currentList)if(1e4<BB.getTimer()-this.currentList[e]){var t,i=e.split("-");delete this.currentList[e];try{t=this.stageQueues[i[0]][i[1]]}catch(e){}if(t){yc.clearRes(t.url,!0);try{delete this.stageQueues[i[0]][i[1]]}catch(e){}this.requestHash.remove(t.url)}i=null}},i.imageLoadedHander=function(e,t,i){var n=this,s=G.loader.getRes(e);if((null==s||null==s.bitmap)&&n._longTimeCount<4)return n._longTimeCount++,G.loader.cancelLoadByUrl(e),void G.loader.load(e,ql.create(n,n.imageLoadedHander,[e,t,i]),null,"image",0,!0,"ASSETS_TERRAIN_GROUP");G.loader.off("error",n,n.reload),n._limitIndex_++,n._reloadTimes=0,n._longTimeCount=0;var o=e.match(/scene_[0-9]*/);o&&0<o.length&&(o=o[0].split("_"))[1]!=n.scene_id||(null==n.stageQueues[t]&&(n.stageQueues[t]=[]),n.stageQueues[t][i]=s,n._useToRender_=!0)},i.onRender=function(){var e=this,t=e.globalToLocal(new Uh(0,0)),i=e.globalToLocal(new Uh(NB.stage.width,NB.stage.height)),n=Math.floor(t.x/512),s=Math.floor(t.y/512),o=Math.ceil(i.x/512),a=Math.ceil(i.y/512),r=Math.min(n,o),l=Math.max(n,o),c=Math.min(s,a),u=Math.max(s,a);e.recodeAreaHash=[];for(var d=r,h=0;d<=l;){for(h=c;h<=u;)e.stageQueues[d]&&e.stageQueues[d][h]&&(e.tileString+=d+"-"+h),h++;d++}if(""!=e.tileString||""==e.tileString||e._useToRender_)for(e.graphics.clear(!0),e._useToRender_&&(e._useToRender_=!1),e.tileString="",d=r;d<=l;){for(h=c;h<=u;){if(e.stageQueues[d]&&e.stageQueues[d][h]){var _=e.stageQueues[d][h];e.graphics.drawTexture(_,511*d,511*h,e.fixSize,e.fixSize)}e.currentList[d+"-"+h]=BB.getTimer(),h++}d++}e.clearHideTileTexture()},i.getNearTile=function(){for(var e,t=this,i=t.globalToLocal(new Uh(Math.round(NB.stage.width/2),Math.round(NB.stage.height/2))),n=parseInt((i.x/512).toString()),s=parseInt((i.y/512).toString()),o=NaN,a=t.imageQueue.length,r=0;r<a;r++){var l=t.imageQueue[r].index_x,c=t.imageQueue[r].index_y,u=t.imageLoadRect,d=new u_;d.x=512*t.imageQueue[r].index_x+256,d.y=512*t.imageQueue[r].index_y+256,d.width=512,d.height=512,t.imageQueue[r].dis=Math.abs(l-n)+Math.abs(c-s),u.intersects(d)&&(null==e||t.imageQueue[r].dis<=e.dis)&&(e=t.imageQueue[r],o=r)}return e?{tar:e,index:o}:null},i.proload=function(e){void 0===e&&(e=0)},i.change=function(e,t){void 0===t&&(t=!0),NB.isSceneReady=!1,t&&this.clear(),this.scene_id=e,this.loadMapData(e),this.isEnterFrame=!0},i.loadMapData=function(e){if(!(parseInt(this.scene_id)<=0)){NB.isSceneReady=!1;var t=_r.getMapDataPath(e);""!=this.binUrl&&(G.loader.cancelLoadByUrl(this.binUrl),yc.clearRes(this.binUrl,!0)),G.loader.clearRes(t,!0),G.loader.load(t,ql.create(this,this.onMapDataComplete,[t,e],!0),null,"arraybuffer",0,!0,"mapData",!0),this.binUrl=t}},i.analyzeMapData=function(e){this.terrainData.scene_id=this.scene_id,this.terrainData.uncodeNew(e),this.terrainData.scene_id=this.scene_id},i.onMapDataComplete=function(e,t){var i=G.loader.getRes(e),n=new mt(i);this.analyzeMapData(n),null!=this.onReadyOrder&&this.onReadyOrder.run(),this.proload(1e3),NB.isSceneReady=!0},i.onMapDataReady=function(){null!=this.onReadyOrder&&this.onReadyOrder.run(),NB.isSceneReady=!0},i.sortMapIndexArray=function(){var e=this.terrainData.imageArray;this.stage_point=this.globalToLocal(Math.round(NB.stage.width/2),Math.round(NB.stage.height/2));for(var t=Math.floor(this.stage_point.x/512),i=Math.floor(this.stage_point.y/512),n=0;n<e.length;n++)e[n].dis=Math.abs(e[n].index_x-t)+Math.abs(e[n].index_y-i)},p(0,i,"scene_id",function(){return this._scene_id},function(e){e&&this.sceens256.indexOf(e),this.fixSize=512,this._scene_id=e}),p(0,i,"x",e.prototype._$get_x,function(e){G.superSet(pp,this,"x",parseInt(e.toString()))}),p(0,i,"y",e.prototype._$get_y,function(e){G.superSet(pp,this,"y",parseInt(e.toString()))}),t.ProloadQueue=[],f(t,["tar_rect",function(){return this.tar_rect=new u_(0,0,512,512)},"stage_rect",function(){return this.stage_rect=new u_}]),t}(pp),zF=function(e){function l(){l.__super.call(this),null==modules.CustomModule.subscribeHash&&(modules.CustomModule.subscribeHash=new jl)}b(l,"modules.CustomModule",sd);var t=l.prototype;return t.addSubscribe=function(e){for(var t=[],i=0,n=arguments.length;i<n;i++)t.push(arguments[i]);for(i=0;i<t.length;i++){var s;(s=new t[i]).oid=this.id,s&&od.Ins().addSubProxy(s)}},p(0,t,"subPackages",null,function(e){for(var t=[],i=0,n=arguments.length;i<n;i++)t.push(arguments[i]);var s=(t=t[0]).length;for(i=0;i<s;i++){var o,a=t[i].toString(),r=this.name;l.subscribeHash.has(a)?-1==(o=l.subscribeHash.take(a)).indexOf(r)&&o.push(r):((o=[]).push(r),l.subscribeHash.put(a,o))}}),l.subscribeHash=null,l}(),XF=function(e){function t(){t.__super.call(this),this.size(660,26)}return b(t,"modules.activity.views.sp.item.Sp_BargainRecordItem",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(Ss,this,"dataSource",e),e){var t=0;this.graphics.clear(),this.graphics.fillText(e.playerName,t,0,"24px SimHei","#02b0e9","left"),t+=12*mp.getStringLength(e.playerName)+10,this.graphics.fillText("砍掉",t,0,"24px SimHei","#90877b","left"),t+=68;var i=e.cutGold.toString();this.graphics.fillText(i,t,0,"24px SimHei","#e6d80d","left",2),t+=12*mp.getStringLength(i),i="元宝",this.graphics.fillText(i,t,0,"24px SimHei","#90877b","left",2),t+=12*mp.getStringLength(i)+20,i=RP.n[261],this.graphics.fillText(i,t,2,"20px SimHei","#5f5952","left",2)}}),t}(Ss),QF=function(e){var n;function t(){var e=this;e.maxLen=15,e._items=null,e._isPlay=!1,e._cnt=0,t.__super.call(e),null==zB.ins.expView&&(zB.ins.expView=e),e.mouseThrough=!0,e.size(720,1280),e.centerX=0,e.y=0,e._cnt=0,e._items=[],e._isPlay=!1,e.visible=!1}b(t,"modules.broadcast.views.ExpEffectV",Ss);var i=t.prototype;return i.pushPos=function(e,t){var i=this;null!=e&&(i._items.push(new n(e,t)),i._items.length>i.maxLen&&i._items.shift(),i._isPlay||(i.visible=!0,i._isPlay=!0,i._loop(),G.timer.loop(200,i,i._loop)))},i._loop=function(){var e=this;if(0==e._items.length)return G.timer.clear(e,e._loop),void(e._isPlay=!1);for(var t=e._items.length,i=0;i<t;i++){var n=e._items.shift(),s=e.globalToLocal(n.startP),o=new Uh(s.x+200*Math.random()-100,s.y+200*Math.random()-100),a=new Uh;if(null==n.endP)return;a.x=n.endP.x-(G.stage.width-e.width)/2,a.y=n.endP.y+4;var r=ud.create();e.addChild(r),r.eff=kB.createEffect("jm1246",0,0,r,"jm1246@"),r.initProps([s,o],400,pa.linearIn,ql.create(e,e.onMiddleEnd,[r,o,a,50*i]),!1),r.play(),e._cnt++}e.parent&&e.parent.addChild(e)},i.onMiddleEnd=function(e,t,i,n){void 0===n&&(n=0);var s=sJ.getExpPt();s&&(i.x=s.x-(G.stage.width-this.width)/2,i.y=s.y+4),e.initProps([t,new Uh((t.x+i.x)/2+200*Math.random()-100,(t.y+i.y)/2+200*Math.random()-100),i],200+n,pa.linearIn,ql.create(this,this.onEffEnd,[e]),!1),e.play()},i.onEffEnd=function(e){var t=e.eff;t&&(t.removeEffect("jm1246@"),t.loadEffect("jm01681")),G.timer.once(300,this,this.onPlayEnd,[e],!1)},i.onPlayEnd=function(e){var t=e.eff;t&&t.dispose(),t=null,delete e.eff,ud.recover(e),this._cnt--,0==this._cnt&&(zB.ins.expRunning=!1,this.visible=!1,Tu.sendToModule("10207",["modules.nav.NavModule"]))},t.__init$=function(){n=function(){function e(e,t){this.startP=null,this.endP=null,this.startP=e,this.endP=t}return b(e,""),e}()},t}(),JF=function(e){function l(){var e=this;e.maxLen=15,e._items=null,e._isPlay=!1,e._pIdx=0,e._cnt=0,l.__super.call(e),null==zB.ins.itemView&&(zB.ins.itemView=e),e.mouseThrough=!0,e.size(720,1280),e.centerX=0,e.bottom=0,e._cnt=0,e._items=[],e._isPlay=!1,e.visible=!1}b(l,"modules.broadcast.views.ItemEffectView",Ss);var t=l.prototype;return t.pushItems=function(e){var t=this;null!=e&&0!=e.length&&(t._items=t._items.concat(e),t._items.length>t.maxLen&&t._items.splice(0,t._items.length-t.maxLen),t._isPlay||(t.visible=!0,t._isPlay=!0,t._pIdx=0,t._loop(),G.timer.loop(200,t,t._loop)))},t._loop=function(){var e=this;if(0==e._items.length)return G.timer.clear(e,e._loop),void(e._isPlay=!1);var t=e._items.shift(),i=l.posArr[e._pIdx];e._pIdx++,e._pIdx>=l.posArr.length&&(e._pIdx=0);var n=Bi.getIndex(t),s=Bi.MODEL.icon(n);if(s){var o=ud.create(),a=NR.getIcon(s);a?e.drawIcon(o,a):NR.loadIcon(s,ql.create(e,e.drawIcon,[o])),e.addChild(o);var r=et.drawBezier(i,l.bagPos,new Uh(l.bagPos.x,i.y+50),20);r.push(l.bagPos),o.initProps(r,1e3,pa.quadIn,ql.create(e,e.onPlayEnd,[o]),!1),o.play(),e._cnt++}},t.drawIcon=function(e,t){e.isDisposed||(Zl.addIconUse(e,t.url),Zl.addGridTexture(t.url),t&&e.graphics.drawTexture(t,-25,-25,50,50))},t.onPlayEnd=function(e){var t=this;e._delayClear=function(e){e&&!e.isDisposed&&t.onEffEnd(e)},G.timer.once(500,e,e._delayClear,[e]),Og.to(e,{x:l.bagPos.x,y:l.bagPos.y+30,alpha:0,scaleX:0,scaleY:0},400,pa.linearIn,ql.create(this,this.onEffEnd,[e]))},t.onEffEnd=function(e){G.timer.clearAll(e),e._delayClear=null,ud.recover(e),Zl.clearIconTexture(e),this._cnt--,0==this._cnt&&(this.visible=!1)},f(l,["bagPos",function(){return this.bagPos=new Uh(536,1206)},"posArr",function(){return this.posArr=[new Uh(440,900),new Uh(440,860)]}]),l}(),ZF=function(e){function l(){var e=this;e.maxLen=15,e._items=null,e._isPlay=!1,e._cnt=0,l.__super.call(e),null==zB.ins.itemView2&&(zB.ins.itemView2=e),e.mouseThrough=!0,e.size(720,1280),e.centerX=0,e.bottom=0,e._cnt=0,e._items=[],e._isPlay=!1,e.visible=!1}b(l,"modules.broadcast.views.ItemEffectView2",Ss);var t=l.prototype;return t.pushItems=function(e,t,i,n){var s=this;if(null!=e&&0!=e.length){t=null==t?new Uh(360,640):s.globalToLocal(t),i=null==i?l.bagPos:s.globalToLocal(i);for(var o=[],a=0;a<e.length;a++){var r={};r.itemId=e[a],r.pos=t,r.tar=i,r.call=n,o.push(r)}s._items=s._items.concat(o),s._items.length>s.maxLen&&s._items.splice(0,s._items.length-s.maxLen),s._isPlay||(s.visible=!0,s._isPlay=!0,s._loop(),G.timer.loop(200,s,s._loop))}},t._loop=function(){var e=this;if(0==e._items.length)return G.timer.clear(e,e._loop),void(e._isPlay=!1);var t=e._items.shift(),i=t.itemId,n=t.pos,s=t.tar,o=t.call,a=Bi.getIndex(i),r=Bi.MODEL.icon(a);if(r){var l=ud.create(),c=NR.getIcon(r);c?e.drawIcon(l,c):NR.loadIcon(r,ql.create(e,e.drawIcon,[l])),e.addChild(l);var u=et.drawBezier(n,s,new Uh(s.x,n.y+50),40);u.push(s),l.initProps(u,800,pa.quadIn,ql.create(e,e.onPlayEnd,[l,s,o]),!1),l.play(),e._cnt++}},t.drawIcon=function(e,t){e.isDisposed||(Zl.addIconUse(e,t.url),Zl.addGridTexture(t.url),t&&e.graphics.drawTexture(t,-25,-25,50,50))},t.onPlayEnd=function(e,t,i){var n=this;e._delayClear=function(e){e&&!e.isDisposed&&n.onEffEnd(e)},G.timer.once(500,e,e._delayClear,[e]),Og.to(e,{x:t.x,y:t.y+30,alpha:0,scaleX:0,scaleY:0},400,pa.linearIn,ql.create(this,this.onEffEnd,[e])),i&&i.run(),Zl.clearIconTexture(e)},t.onEffEnd=function(e){G.timer.clearAll(e),e._delayClear=null,ud.recover(e),this._cnt--,0==this._cnt&&(this.visible=!1)},f(l,["bagPos",function(){return this.bagPos=new Uh(560,1206)}]),l}(),KF=function(e){function s(){var e=this;e.maxLen=20,e.items=null,e.newItems=null,e.itemH=0,e.spaceY=0,e._msgs=null,e._curItems=null,e._isPlay=!1,e._dicTweener=null,s.__super.call(e),null==zB.ins.noticeView&&(zB.ins.noticeView=e),e._dicTweener=new jo,e.centerX=-230,e.bottom=270,e.visible=!1,e.itemH=28,e.width=256,e.height=e.itemH,e.spaceY=4,e._curItems=[],e.items=[],e.newItems=[];for(var t=0;t<e.maxLen;t++){var i=new gh;i.visible=!1,e.items.push(i);var n=new PF;n.visible=!1,e.newItems.push(n)}e._msgs=[],e._isPlay=!1,e.mouseThrough=!0,G.timer.once(1e3,e,e.initEnd)}b(s,"modules.broadcast.views.NoticeView",Ss,"NoticeView$1");var t=s.prototype;return t.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},t.pushText=function(e,t,i){var n=this;void 0===t&&(t=!0),void 0===i&&(i=!1),null!=e&&(n.parent||eq.topLayer.addChild(n),t?(n.centerX=0,n.centerY=-100,n.bottom=NaN):(n.centerX=-230,n.centerY=NaN,n.bottom=270),i?n._msgs.unshift(e):n._msgs.push(e),n._isPlay||(n.visible=!0,n._isPlay=!0,G.timer.loop(30,n,n._loop)))},t.pushTextItem=function(e,t,i){var n=this;void 0===t&&(t=!0),void 0===i&&(i=!1),null!=e&&(n.parent||eq.topLayer.addChild(n),t?(n.centerX=0,n.centerY=-100,n.bottom=NaN):(n.centerX=-230,n.centerY=NaN,n.bottom=270),i?n._msgs.unshift(e):n._msgs.push(e),n._isPlay||(n.visible=!0,n._isPlay=!0,G.timer.loop(30,n,n._loop)))},t._loop=function(){this._msgs.length>this.maxLen&&this._msgs.splice(0,this._msgs.length-this.maxLen),this.loopNext()},t.loopNext=function(){var e=this;if(0==e._msgs.length)return G.timer.clear(e,e._loop),void(e._isPlay=!1);e._isPlay=!0;var t=e._msgs.shift(),i=new Og;if(t instanceof Array){var n=e.getNewItem();n.doRender(t),e.addChild(n),n.visible=!0,e._curItems.push(n),i.to(n,{alpha:0},800,pa.sineOut,ql.create(e,e.onComplete,[n]),1e3),e._dicTweener.set(n,i)}else{var s=t,o=e.getItem();o.div_desc.innerHTML=s,240<o.div_desc.contextWidth?o.img_bg.width=o.div_desc.contextWidth+20:o.img_bg.width=256,e.addChild(o),o.visible=!0,e._curItems.push(o),i.to(o,{alpha:0},800,pa.sineOut,ql.create(e,e.onComplete,[o]),1e3),e._dicTweener.set(o,i)}for(var a=e._curItems.length,r=0;r<a;r++){var l=e._curItems[r];Og.to(l,{y:(r-a)*(e.itemH+e.spaceY)-e.spaceY},200,pa.sineOut)}},t.onComplete=function(e){var t=this;t._dicTweener.get(e)&&(t._dicTweener.get(e).clear(),t._dicTweener.remove(e)),e.alpha=1,e.visible=!1,e.y=0,Og.clearAll(e);var i=t._curItems.indexOf(e);t._curItems.splice(i,1),e instanceof layouts.broad.NoticeItemUI?t.recoverItem(e):t.recoverNewItem(e),0!=t._curItems.length||t._isPlay||(t.visible=!1,t.removeSelf())},t.recoverItem=function(e){if(e.div_desc.innerHTML="",e.parent&&e.parent.removeChild(e),this.items.length>=this.maxLen)return e.img_bg.destroy(),e.destroy(),void(e=null);this.items.push(e)},t.recoverNewItem=function(e){if(e.parent&&e.parent.removeChild(e),this.newItems.length>=this.maxLen)return e.graphics.clear(!0),e.destroy(),void(e=null);e.graphics.clear(),this.newItems.push(e)},t.getNewItem=function(){if(0<this.newItems.length)return this.newItems.pop();var e=new PF;return e.visible=!1,e},t.getItem=function(){if(0<this.items.length)return this.items.pop();var e=new gh;return e.visible=!1,e},s}(),$F=function(e){var o;function t(){var e=this;e.maxLen=15,e._items=null,e._isPlay=!1,e._cnt=0,e._endfun=null,e._isNeed=!1,t.__super.call(e),null==zB.ins.powerEffectView&&(zB.ins.powerEffectView=e),e.mouseThrough=!0,e.size(720,1280),e.centerX=0,e.y=0,e._cnt=0,e._items=[],e._isPlay=!1,e.visible=!1}b(t,"modules.broadcast.views.PowerEffectView",Ss);var i=t.prototype;return i.clearEffect=function(){if(this._items=[],0==this._items.length)return G.timer.clear(this,this._loop),void(this._isPlay=!1)},i.pushPos=function(e,t,i,n){var s=this;void 0===n&&(n=!0),null!=e&&(s._items.push(new o(e,t)),s._items.length>s.maxLen&&s._items.shift(),s._endfun=i,s._isNeed=n,s._isPlay||(s.visible=!0,s._isPlay=!0,s._loop(),G.timer.loop(200,s,s._loop)))},i._loop=function(){var e=this;if(0==e._items.length)return G.timer.clear(e,e._loop),void(e._isPlay=!1);var t=e._items.shift(),i=e.globalToLocal(t.startP),n=new Uh;if(null!=t.endP){n.x=t.endP.x-(G.stage.width-e.width)/2,n.y=t.endP.y;var s=ud.create();e.addChild(s),s.pff=kB.createEffect("jm1135",0,0,s,"jm1135@"),s.initProps([i,n],400,pa.linearIn,ql.create(e,e.onEffEnd,[s,e._isNeed]),!1),s.play(),e._cnt++,e.parent&&e.parent.addChild(e)}},i.onEffEnd=function(e){var t=e.pff;t&&(t.removeEffect("jm1135@"),this._isNeed&&t.loadEffect("jm1036")),G.timer.once(200,this,this.onPlayEnd,[e],!1)},i.onPlayEnd=function(e){var t=e.pff;t&&t.dispose(),t=null,delete e.pff,ud.recover(e),this._cnt--,0==this._cnt&&(this.visible=!1),this._endfun&&(this._endfun.run(),this._endfun=null)},t.__init$=function(){o=function(){function e(e,t){this.startP=null,this.endP=null,this.startP=e,this.endP=t}return b(e,""),e}()},t}(),eq=(function(e){function t(){var e=this;e.goodsGrid=null,e.txtName=null,t.__super.call(e),e.goodsGrid=new MF(74),e.goodsGrid.pos(13,0),e.txtName=new Yp,e.txtName.align="center",e.txtName.font="SimHei",e.txtName.fontSize=20,e.txtName.width=100,e.txtName.pos(0,e.goodsGrid.height+2),e.addChild(e.goodsGrid),e.addChild(e.txtName)}b(t,"modules.copy.views.daily.pigTwo.PigTwoGoodsGrid",Ss),p(0,t.prototype,"data",null,function(e){var t=e;this.goodsGrid.bindData=t;var i=Bi.getIndex(t.goodsId),n=Bi.MODEL.colourId(i);this.txtName.changeText(Bi.MODEL.name(i)),this.txtName.color=ms.getByQuality(n)})}(),function(e){function t(){t.__super.call(this),null!=t._ins&&pt.window.alert(RP.n[262])}return b(t,"modules.gui.others.LayerManager",Ss),p(1,t,"instance",function(){return null==t._ins&&((t._ins=new t).left=t._ins.right=t._ins.top=t._ins.bottom=0,t._ins.mouseThrough=!0,t._ins.graphics.clear()),t._ins},laya.ui.Component._$SET_instance),t.setup=function(){G.stage.addChild(modules.gui.others.LayerManager.instance),t.bottomLayer||(jP.deviceInfo&&tr.push("WebSdkUtil.PHONE_MODEL="+jP.deviceInfo.PHONE_MODEL+" RESOLUTION="+jP.deviceInfo.RESOLUTION),dr.isConchApp?EB.nativeHasBang&&(t._ins.top=58,t._ins.graphics.drawRect(-2,-58,t._ins.width+4,58,"#000000"),t._ins.bottom=25,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,30,"#000000")):0<dr.xgame&&EB.iPhoneBang?(t._ins.top=58,t._ins.graphics.drawRect(-2,-58,t._ins.width+4,58,"#000000"),t._ins.bottom=25,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,30,"#000000")):EB.isOppoFindX?(t._ins.top=58,t._ins.graphics.drawRect(-2,-58,t._ins.width+4,58,"#26221c"),t._ins.bottom=25,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,30,"#000000")):EB.isIphoneX||EB.isAndroidX?(t._ins.top=58,t._ins.graphics.drawRect(-2,-58,t._ins.width+4,58,"#000000"),t._ins.bottom=30,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,30,"#000000")):EB.isAndroidX_New?(t._ins.top=30,t._ins.bottom=30,t._ins.graphics.drawRect(-2,0,t._ins.width+4,35,"#000000"),t._ins.graphics.drawRect(-2,t._ins.height-60,t._ins.width+4,35,"#000000")):EB.isIphoneXw?(t._ins.bottom=100,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,100,"#000000")):jP.deviceInfo&&"MI 8"==jP.deviceInfo.PHONE_MODEL&&(t._ins.top=0,t._ins.bottom=0,t._ins.graphics.drawRect(-2,t._ins.height,t._ins.width+4,60,"#000000")),t.bottomLayer=new tq,t.initLayer(t.bottomLayer),t.navLayer=new Ss,t.initLayer(t.navLayer),t.underPanelLayer=new Ss,t.initLayer(t.underPanelLayer),t.panelLayer=new nq,t.initLayer(t.panelLayer),t.effectLayer=new iq,t.initLayer(t.effectLayer),t.topLayer=new sq,t.initLayer(t.topLayer),t.layout=new pN,hN.ins.setup(),G.stage.on("visibilitychange",t,t._onVisibilitychange))},t._onVisibilitychange=function(){G.stage.isVisibility||(hN.ins._closeAllPanel(),LY.Ins().lockSceneClose(),Zl.cleckClearAll())},t.initLayer=function(e){return e.left=e.right=e.top=e.bottom=0,e.mouseEnabled=!0,e.mouseThrough=!0,modules.gui.others.LayerManager.instance.addChild(e),e},t.bottomLayer=null,t.navLayer=null,t.underPanelLayer=null,t.panelLayer=null,t.effectLayer=null,t.topLayer=null,t.layout=null,t._ins=null,t}()),tq=function(e){function t(){t.__super.call(this)}return b(t,"modules.gui.views.BottomLayer",Ss),t}(),iq=function(e){function t(){t.__super.call(this)}return b(t,"modules.gui.views.EffectLayer",Ss),t}(),nq=function(e){var r;function t(){this._mask=null,this._maskState=null,this._tw=null,t.__super.call(this)}b(t,"modules.gui.views.PanelLayer",Ss);var i=t.prototype;return i.open=function(e,t,i,n,s){var o=this;if(void 0===t&&(t=!1),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!1),t&&o.closeAll(),i){o._mask||(o._mask=new Ss,o._mask.left=o._mask.right=o._mask.top=o._mask.bottom=0,o._mask.alpha=.8,o._mask.graphics.drawRect(0,0,o.width,o.height,"#000000",null),o._mask.mouseEnabled=!0,o._mask.mouseThrough=!0),o._mask.alpha=.8,o.addChild(o._mask),!o._mask.hasListener("click")&&o._mask.on("click",o,o.onMaskClose),null==o._maskState&&(o._maskState=[]);var a=new r;a.target=e,a.clickClose=n,o._maskState[o._maskState.length]=a,s&&(o._mask.alpha=0,Og.to(o._mask,{alpha:.8},400,pa.sineIn))}o.addChild(e)},i.setMaskAlpha=function(e){this._mask&&(this._mask.alpha=e)},i.openTip=function(e){return!this._tw&&(this.open(e,!1,!0,!0),e.scaleX=e.scaleY=.7,null==this._tw?this._tw=new Og:this._tw.clear(),this._tw.to(e,{scaleX:1.1,scaleY:1.1,complete:ql.create(this,this.onZoom,[e])},150),!0)},i.onZoom=function(e){null==this._tw?this._tw=new Og:this._tw.clear(),this._tw.to(e,{scaleX:1,scaleY:1,complete:ql.create(this,this.onZoom2)},100)},i.onZoom2=function(){null!=this._tw&&this._tw.clear(),this._tw=null},i.close=function(e){var t=this;if(t.removeChild(e),t._mask&&Og.clearAll(t._mask),t._maskState){for(var i=-1,n=t._maskState.length;0<n;n--)if(t._maskState[n-1].target==e){i=n-1;break}if(-1==i)return;if(t._maskState.splice(i,1),0<t._maskState.length){var s=t.getChildIndex(t._mask);(i=t.getChildIndex(t._maskState[t._maskState.length-1].target))<=s&&t.addChildAt(t._mask,i)}else t.removeChild(t._mask),t._mask.off("click",t,t.onMaskClose)}},i.closeTip=function(e){return!this._tw&&(null==this._tw?this._tw=new Og:this._tw.clear(),this._tw.to(e,{scaleX:.1,scaleY:.1,complete:ql.create(this,this.onAway,[e])},200),!0)},i.onAway=function(e){this.close(e),e.scaleX=e.scaleY=1,null!=this._tw&&this._tw.clear(),this._tw=null},i.closeAll=function(){this.removeChildren(),this._maskState=null},i.resize=function(){this._mask&&(this._mask.graphics.clear(),this._mask.graphics.drawRect(0,0,this.width,this.height,"#000000",null))},i.onMaskClose=function(){this._tw||this._maskState[this._maskState.length-1].clickClose&&this.event("MASK_CLOSE",this._maskState[this._maskState.length-1].target)},p(0,i,"maskSpr",function(){return this._mask}),t.MASK_ALPHA=.8,t.__init$=function(){r=function(){function e(){this.target=null,this.clickClose=!1}return b(e,""),e}()},t}(),sq=function(e){function t(){t.__super.call(this)}return b(t,"modules.gui.views.TopLayer",Ss),t}(),oq=function(e){function t(){t.__super.call(this),this.size(630,26),this.on("click",this,this.onClick)}b(t,"modules.jianbao.view.JianbaoRecordItem",e);var i=t.prototype;return i.onClick=function(e){if(this.dataSource){var t=yB.create(this.dataSource.configID,1);t.disAchi=!1,t instanceof protos.backpack.DtoEquip?fW.instance.show(t):VQ.instance.show(t)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(Ss,this,"dataSource",e),e){var t,i=e.playerName,n=e.configID,s=Bi.getIndex(n),o=Bi.MODEL.name(s)+"";if(2==Bi.MODEL.type(s)){var a=Bi.MODEL.flyLevel(s),r=Bi.MODEL.minUseLevel(s);t=0<a?"("+a+"转 "+F.getPro(Bi.MODEL.roleTypeId(s))+")":"("+r+"级 "+F.getPro(Bi.MODEL.roleTypeId(s))+")"}var l=0;this.graphics.clear(),this.graphics.fillText(i,l,0,"24px SimHei","#02b0e9","left"),l+=12*mp.getStringLength(i)+20,this.graphics.fillText(RP.n[263],l,0,RP.n[264],"#90877b","left"),l+=164;var c=Bi.MODEL.colourId(s),u=ms.getByQuality(c);this.graphics.fillText(o,l,0,"24px SimHei",u,"left",2);var d=24*mp.getStringLength(o)*.5>>0;t&&this.graphics.fillText(t,l+d,0,"24px SimHei",u,"left",2)}}),t}(Ss),aq=function(e){function t(){var e=this;e._img=null,e._res=null,e._sdk=null,e._interval=-1,e._imgList=null,e._imgLen=-1,e._imgIdx=0,t.__super.call(e),e.width=158,e.height=198,e.bottom=300,e.left=81,e._img=new Kl,e._img.centerX=e._img.centerY=0,e._img.width=158,e._img.height=198,e._img.anchorX=.5,e._img.anchorY=.5,e.addChild(e._img),e.playAdEff(),qP.getAwyAd("awy_getAd",{},e,e.showAdvImg),e.on("click",e,e.onClick)}b(t,"modules.nav.views.sub.NavAwyAdvView",Ss);var i=t.prototype;return i.onClick=function(){this._res&&qP.getAwyAd("awy_clickAd",this._res,this,this.showAdvImg)},i.playAdEff=function(){Og.to(this._img,{rotation:-25},75,null,ql.create(this,this.playAdEff2))},i.playAdEff2=function(){Og.to(this._img,{rotation:25},150,null,ql.create(this,this.playAdEff3))},i.playAdEff3=function(){Og.to(this._img,{rotation:-20},120,null,ql.create(this,this.playAdEff4))},i.playAdEff4=function(){Og.to(this._img,{rotation:20},120,null,ql.create(this,this.playAdEff5))},i.playAdEff5=function(){this._img.rotation=0,Og.to(this._img,{rotation:0},60,null,ql.create(this,this.playAdEff),4e3)},i.setAnimation=function(){var e=this;!e._imgList||e._interval<0?G.timer.clearAll(e):(e._imgIdx++,e._imgIdx>=e._imgLen&&(e._imgIdx=0),e._img.skin=e._imgList[e._imgIdx])},i.showAdvImg=function(e){var t=this;if(t._interval=-1,t._imgList=null,t._imgLen=-1,Og.clearAll(t._img),G.timer.clearAll(t),t._res=e){if(!eq.navLayer.contains(modules.nav.views.sub.NavAwyAdvView.ins)&&eq.navLayer.addChild(modules.nav.views.sub.NavAwyAdvView.ins),1==e.type)t._img.skin=e.data,t.playAdEff();else if(2==e.type){if(!e.data)return;t._imgList=e.data.imglist,t._imgLen=t._imgList.length,t._interval=e.data.intervals,t._img.skin=t._imgList[0],t._imgIdx=0,G.timer.loop(t._interval,t,t.setAnimation)}}else eq.navLayer.removeChild(modules.nav.views.sub.NavAwyAdvView.ins)},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},laya.ui.Component._$SET_ins),t._ins=null,t}(),rq=function(i){function t(){var e=this;e._equipImg=null,e._level=0,e._position=0,e._effect=null,e._effId="jm0015",e._select=!1,e._starIcon=null,e.img_red=null,e.effect=null,e._redPointVisible=!1,t.__super.call(e),e.size(116,116),e.initUI()}b(t,"modules.passsuit.others.PassSuitItem",i);var e=t.prototype;return e.initUI=function(){var e=this;e._equipImg=new Kl,e._equipImg.centerX=e._equipImg.centerY=0,e._equipImg.width=e._equipImg.height=100,e.addChild(e._equipImg),e._starIcon=new Kl,e._starIcon.x=71,e._starIcon.y=6,e._starIcon.width=30,e._starIcon.height=30,e._starIcon.mouseEnabled=!1,e.addChild(e._starIcon),e.img_red=new Kl,e.img_red.skin=NI.POINT,e.img_red.x=86,e.img_red.y=-9,e.img_red.visible=!1,e.addChild(e.img_red)},e.drawBg=function(e){e.clear();var t=this.getColor(this.position,this.level),i=NI.gridBg(t),n=G.loader.getRes(i);return n&&e.drawTexture(n,0,0,this.width,this.height),!0},e.getColor=function(e,t){for(var i=0;i<Ms.count;i++)if(Ms.MODEL.position(i)==e&&Ms.MODEL.level(i)==t)return Ms.MODEL.color(i);return 0},e.destroy=function(e){var t=this;void 0===e&&(e=!0),t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null),t.effect&&(t.effect.parent&&t.effect.parent.removeChild(t.effect),t.effect.dispose(),t.effect=null),i.prototype.destroy.call(t,e)},p(0,e,"isRedPointVisible",function(){return this._redPointVisible},function(e){this._redPointVisible=e,this.img_red.visible=this._redPointVisible,1==e?this._starIcon.visible=!1:0<this._level?this._starIcon.visible=!0:this._starIcon.visible=!1}),p(0,e,"select",function(){return this._select},function(e){this._select=e,null==this._effect&&(this._effect=kB.createEffect("jm0015",56,52,this),this.addChildAt(this._effect,this.getChildIndex(this.img_red)-1)),e?this._effect&&(this._effect.visible=!0):this._effect&&(this._effect.visible=!1)}),p(0,e,"level",function(){return this._level},function(e){if(0==(this._level=e))this._equipImg.skin=_r.getAtlasSubPath(RN.noActivePath[this.position]),this._starIcon.visible=!1,this.graphics.clear(),this.effect&&(this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect=null);else{this.drawBg(this.graphics),this._equipImg.skin=_r.getIconPath(RN.getActviePathByPos(this.position,this.level)),this._starIcon.visible=!0;var t="";1==e?t="passsuit/inheritance_clip_star1.png":2==e?t="passsuit/inheritance_clip_star2.png":3==e?t="passsuit/inheritance_clip_star3.png":4==e&&(t="passsuit/inheritance_clip_star4.png"),this._starIcon&&(this._starIcon.skin=_r.getAtlasSubPath(t)),null==this.effect&&(this.effect=kB.createEffect("jm1226",56,56),this.addChildAt(this.effect,this.numChildren-1))}}),p(0,e,"position",function(){return this._position},function(e){this._position=e}),t}(Ss),lq=function(e){function t(){t.__super.call(this),this.size(630,26)}b(t,"modules.treasure.views.item.TrRecordItem",e);var i=t.prototype;return i.onClick=function(e){if(this.dataSource){var t=yB.create(this.dataSource.id,this.dataSource.num);t.disAchi=!1,t instanceof protos.backpack.DtoEquip?fW.instance.show(t):VQ.instance.show(t)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(Ss,this,"dataSource",e),e){var t,i=e.n,n=e.id,s=e.num,o=Bi.getIndex(n),a=Bi.MODEL.name(o)+(1<s?"x"+s:"");if(2==Bi.MODEL.type(o)){var r=Bi.MODEL.flyLevel(o),l=Bi.MODEL.minUseLevel(o);t=0<r?"("+r+"转 "+F.getPro(Bi.MODEL.roleTypeId(o))+")":"("+l+"级 "+F.getPro(Bi.MODEL.roleTypeId(o))+")"}var c=0;this.graphics.clear(),this.graphics.fillText(i,c,0,"24px SimHei","#02b0e9","left"),c+=12*mp.getStringLength(i)+20,this.graphics.fillText("获得",c,0,"24px SimHei","#90877b","left"),c+=68;var u=Bi.MODEL.colourId(o),d=ms.getByQuality(u);this.graphics.fillText(a,c,0,"24px SimHei",d,"left",2);var h=24*mp.getStringLength(a)*.5>>0;t&&this.graphics.fillText(t,c+h,0,"24px SimHei",d,"left",2)}}),t}(Ss),cq=function(n){function u(e,t){var i=this;i._invalid=!1,i._mrenderMode=!1,i._tSpaceX=0,i._tSpaceY=0,i._spaceX=18,i._spaceY=18,i._gridTooltipEnable=!0,i._gridNeedEffect=!0,i._padding=30,i._gnameVisible=!0,i._gnameFont="22px SimHei",i._gtextH=22,i._gsimpleName=!1,i._nameVisible=!0,i._clickHandler=null,i._selectMode=!1,i._selectHandler=null,i._selectSkin=null,i._selectSizeGrid=null,i._selectLayer=10,i._rowCount=0,i._contentW=0,i._contentH=0,i._grids=null,i._items=null,i.needEffect=!0,i.isClearUrl=!0,i.owerModule=null,i.urlArr=[],i._gridW=116,i._gridH=116,i._iconLayer=void 0,i._tipLayer=void 0,i._textLayer=void 0,i._effectLayer=void 0,i._offseX=NaN,i._offseY=NaN,i._cellW=NaN,i._cellH=NaN,i._gnameY=i._gridH+3,i._selectSize=134,i._gridCls=pq,void 0===e&&(e=999),void 0===t&&(t=!0),u.__super.call(i),i._rowCount=e,i._mrenderMode=t,i._mrenderMode&&iu._initContainer(i),i.on("undisplay",i,i.onUnDisplay)}b(u,"ui.gridrender.MGridsContainer",n);var e=u.prototype;return e.onUnDisplay=function(){if(this.urlArr&&0<this.urlArr.length){if(this.isClearUrl)for(var e=0;e<this.urlArr.length;e++)this.urlArr[e]&&""!=this.urlArr[e]&&Zl.cutGridTexture(this.urlArr[e]);this.urlArr.splice(0,this.urlArr.length)}},e.initCellSize=function(){var e=this,t=0,i=0;e._selectMode?(t=(e._selectSize-e._gridW)/2,i=(e._selectSize-e._gridH)/2):t=i=0,e._padding>t&&(t=e._padding),e._padding>i&&(i=e._padding),isNaN(e._offseX)&&(e._offseX=t),isNaN(e._offseY)&&(e._gnameVisible&&e._gnameY<0?e._offseY=-e._gnameY:e._offseY=i),e._cellW=2*e._offseX+e._gridW;var n=0;e._gnameVisible&&(n=e._offseY+e._gnameY+e._gtextH);var s=e._offseY+e._gridH+i;e._cellH=n<s?s:n,e._tSpaceX=e._spaceX-2*e._offseX,e._tSpaceY=e._spaceY-(e._cellH-e._gridH)},e.destroy=function(e){var t=this;if(void 0===e&&(e=!0),t.urlArr&&0<t.urlArr.length){if(t.isClearUrl)for(var i=0;i<t.urlArr.length;i++)t.urlArr[i]&&""!=t.urlArr[i]&&(yc.clearTextureRes(t.urlArr[i]),tt.ins.clearTexture(t.urlArr[i]));t.urlArr.splice(0,t.urlArr.length)}n.prototype.destroy.call(t,e)},e.setGoodsItems=function(e,t,i){var n=this;if(void 0===t&&(t=0),e){switch(t){case 0:n._items=i.runWith(e);break;case 1:n._items=e;break;case 2:n._items=u.getGoodsByType2(e);break;case 3:var s=e.split(";");n._items=u.getGoodsByType2(s);break;case 4:n._items=u.getGoodsByType4(e);break;case 5:n._items=u.getGoodsByType5(e);break;case 6:n._items=u.getGoodsByType6(e);break;case 7:n.items=u.getGoodByType7(e);break;case 8:n._items=u.getGoodsByType6(e,!0)}n.invalid()}},e.combineData=function(e,t){null!=e&&null!=t&&(this.items=yB.createCombine(e,t),this.invalid())},e.invalid=function(){this._invalid||(this._invalid=!0,G.timer.callLater(this,this.onChange))},e.runChange=function(){this._invalid&&G.timer.runCallLater(this,this.onChange)},e.onChange=function(){var e=this;e._invalid=!1,isNaN(e._cellW)&&isNaN(e._cellH)&&e.initCellSize(),e._grids||(e._grids=[]);for(var t=u.getGridClsPool(e._gridCls),i=e._grids.length,n=e._items?e._items.length:0,s=0;s<n;s++){var o;(o=0<i?(i--,e._grids.shift()):t.obtain()).size(e._gridW,e._gridH);var a=(e._cellW+e._tSpaceX)*(s%e._rowCount),r=(e._cellH+e._tSpaceY)*(s/e._rowCount>>0);o.x=a+e._offseX,o.y=r+e._offseY,e._selectMode&&(o.toolTipEnabled=!1,o.on("click",e,e.onGridClick,[o,s]),o.on("render",e,e.onGridMRender,[o,s])),u._initGrid(e,o,e.needEffect),o.needEffect=e.needEffect,o.bindData=e._items[s],e._grids.push(o),e.addChild(o),e.owerModule,e.isClearUrl&&e.urlArr.push(o.getIconUrl())}var l=n>e._rowCount?e._rowCount:n;e._contentW=e._cellW*l+e._tSpaceX*(l-1),e._contentW<0&&(e._contentW=0);var c=Math.ceil(n/e._rowCount);for(e._contentH=e._cellH*c+e._tSpaceY*(c-1),e._contentH<0&&(e._contentH=0);0<i;)i--,(o=e._grids.shift()).bindData=null,o.off("click",e,e.onGridClick),o.off("render",e,e.onGridMRender),o.removeSelf(),t.release(o);e._mrenderMode&&iu.invalidContainer(e)},e.expandContentSize=function(e,t){var i=e?e.x+e.width:t.right;this._contentW<i&&(this._contentW=i);var n=e?e.y+e.height:t.bottom;this._contentH<n&&(this._contentH=n)},e.onGridClick=function(e,t){this._items[t][u._gridSelected_]?this._clickHandler&&this._clickHandler.runWith([e,t]):(this.selectedIndex=t,this._selectHandler&&this._selectHandler.runWith([e,t]))},e.invalidGrid=function(e){iu.invalidRender(this._grids[e])},e.onGridMRender=function(e,t){var i=this;if(i._items[t][u._gridSelected_]){var n=e.mRenderLayerGraphics(i._selectLayer,u.zpt.setTo(0,0)),s=G.loader.getRes(i._selectSkin),o=(i._selectSize-e.width)/2,a=(i._selectSize-e.height)/2;i._selectSizeGrid?Cl.draw9Grid(n,s,u.zpt.x-o,u.zpt.y-a,i._selectSize,i._selectSize,i._selectSizeGrid):n.drawTexture(s,u.zpt.x-o,u.zpt.y-a,i._selectSize,i._selectSize)}},p(0,e,"cellWidth",function(){return this.runChange(),this._cellW}),p(0,e,"items",function(){return this._items},function(e){this._items=e,this.invalid()}),p(0,e,"grids",function(){return this._grids}),p(0,e,"contentWidth",function(){return this.runChange(),this._contentW}),p(0,e,"contentHeight",function(){return this.runChange(),this._contentH}),p(0,e,"cellHeight",function(){return this.runChange(),this._cellH}),p(0,e,"selectedIndex",function(){for(var e=0;e<this._items.length;e++){if(this._items[e][u._gridSelected_])return e}return-1},function(e){if(this._items&&!(e<0||e>=this._items.length)){var t=this._items[e];if(!t[u._gridSelected_]){t[u._gridSelected_]=!0,this.invalidGrid(e);for(var i=0;i<this._items.length;i++){var n=this._items[i];if(n!=t&&n[u._gridSelected_]){n[u._gridSelected_]=!1,this.invalidGrid(i);break}}}}}),p(0,e,"selectedItem",function(){var e=this.selectedIndex;return-1!=e?this._items[e]:null},function(e){if(this._items){var t=this._items.indexOf(e);-1!=t&&(this.selectedIndex=t)}}),u.getGoodsByType2=function(e){for(var t=e,i=[],n={},s=0;s<t.length;s++){var o=t[s];if(o){var a=o.split(",");if(!a[2]||0==parseInt(a[2])||gR.ins.actorList[0].job==parseInt(a[2])){var r=parseInt(a[0]),l=parseInt(a[1]),c=n[r];c?c.goodsNum+=l:(c=yB.create(r,l),i.push(c),1==Bi.MODEL.type(c.cfgIdx)&&(n[r]=c))}}}return i},u.getGoodsByType4=function(e){for(var t=[],i={},n=0;n<e.length;n++){var s=e[n],o=parseInt(s.modelId),a=parseInt(s.count),r=i[o];r?r.goodsNum+=a:(r=yB.create(o,a),t.push(r),1==Bi.MODEL.type(r.cfgIdx)&&(i[o]=r))}return t},u.getGoodsByType5=function(e){var t=e[0]?e[0].split(";"):null;t=u.getGoodsByType2(t);for(var i=[],n={},s=e[1]?e[1].split(","):null,o=0;o<s.length;o++){var a=s[o].split(":"),r=0,l=parseInt(a[1]);if("EXP"==a[0]?r=4:"COPPER"==a[1]?r=15:"GOLD"==a[1]&&(r=14),r){var c=n[r];c?c.goodsNum+=l:(c=yB.create(r,l),i.push(c),n[r]=c)}}return t.concat(i)},u.getGoodsByType6=function(e,t){void 0===t&&(t=!1);for(var i=yh.getObj(e),n="",s=0;s<i.length;s++)n+=i[s].value+";";for(var o=n.split(";"),a=[],r={},l=0;l<o.length;l++)if(o[l]&&0!=o[l].length){var c=o[l].split(":"),u=0,d=parseInt(c[1]);if(u=c[0]==aR.EXP.key?aR.EXP.itemId:c[0]==aR.COPPER.key?aR.COPPER.itemId:c[0]==aR.GOLD.key?aR.GOLD.itemId:c[0]==aR.DRAGON_DESIGN_ESSENCE.key?aR.DRAGON_DESIGN_ESSENCE.itemId:parseInt(c[0])){var h=r[u];!h||t?(h=yB.create(u,d),a.push(h),r[u]=h):h.goodsNum+=d}}return[].concat(a)},u.getGoodByType7=function(e){for(var t=yh.getObj(e),i="",n=0;n<t.length;n++)i+=t[n].value+";";for(var s=i.split(";"),o=[],a={},r=0;r<s.length;r++){var l=s[r].split(":"),c=0,u=parseInt(l[1]);if(c=l[0]==aR.EXP.key?aR.EXP.itemId:l[0]==aR.COPPER.key?aR.COPPER.itemId:l[0]==aR.GOLD.key?aR.GOLD.itemId:parseInt(l[0])){var d=a[r];d?d.goodsNum+=u:(d=yB.create(c,u),o.push(d),a[r]=d)}}return[].concat(o)},u.getGridClsPool=function(e){var t=e[u.PROP_CLS_ID];if(!t){var i=new tu(20,{cls:e});t=i.hashCode,e[u.PROP_CLS_ID]=t,u.poolMap[t]=i}return u.poolMap[t]},u._initGrid=function(e,t,i){if(void 0===i&&(i=!0),t instanceof ui.gridrender.MGoodsGrid){var n=t;n._iconLayer=e._iconLayer||(e._iconLayer=n._iconLayer),n._tipLayer=e._tipLayer||(e._tipLayer=e._iconLayer+1),n._textLayer=e._textLayer||(e._textLayer=e._tipLayer+1),n._effectLayer=e._effectLayer||(e._effectLayer=e._textLayer+1),n._nameVisible=e._gnameVisible,n._nameY=e._gnameY,n._nameFont=e._gnameFont,n._simpleName=e._gsimpleName,n._nameVisible=e._nameVisible,n.toolTipEnabled=!e._selectMode&&e._gridTooltipEnable,n.needEffect=i}},f(u,["_gridSelected_",function(){return this._gridSelected_=xs.getSoleProperty()},"PROP_CLS_ID",function(){return this.PROP_CLS_ID=xs.getSoleProperty()},"poolMap",function(){return this.poolMap=new eu},"zpt",function(){return this.zpt=new Uh}]),u}(Ss),uq=function(t){function _(){var e=this;e.camp=0,e.renderInSelf=!1,e.isSceneEffect=!1,e._AUnit_=null,e._actSpeed=NaN,e.mid="",e.wid="",e.wgid="",e.eid="",e.magicId="",e.partRenderOrders={mid:null,wid:null,wgid:null,eid:null},e.index=0,e._eidTopRenderOrders=[],e.scale_X=1,e.scale_Y=1,e.mat=null,e.isCharObj=!1,e.defaultHotAreaWidth=80,e.defaultHotAreaHeight=100,e.defaultHotAreaOffsetX=-40,e.defaultHotAreaOffsetY=-90,e.eidBottomRenderOrder=[],e.showad=null,e._isShowad=!0,e.isShowBool=!0,e.isCleared=!0,e._filters_=[],e.iconTexture=null,e.iconTextureSprite=null,e.titleData=null,e._isDeath_=!1,e.pauseTime=NaN,e.removeReason=[],e.tx=0,e.ty=0,e.bodyRenderTime=0,e.effectHash=new jl,e.stageRect=new u_(0,0),e.renderRect=new u_,e.hotArea=new u_(0,0,e.defaultHotAreaWidth,e.defaultHotAreaHeight),_.__super.call(e),e._actSpeed=BB.defaultActSpeed,e._setup_(),_.dislayQueue.push(e),_.isReady||G.timer.frameLoop(1,_,zwc.engine.core.displays.avatars.AvatarUnitDisplay.loop),e.mat||(e.mat=bu.create()),e.transform=e.mat}b(_,"zwc.engine.core.displays.avatars.AvatarUnitDisplay",t);var e=_.prototype;return G.imps(e,{"zwc.saiman.interfaces.displays.IAvatar":!0}),e._setup_=function(){this._AUnit_&&this._AUnit_.dispose(),this._id_="[AvatarUnitDisplay]"+Ee.getSoleId(),this.type=Za.CHAR,this._AUnit_=FH.GetNew(),this._AUnit_.setOwner(this),UH.addUnit(this._AUnit_)},e._init_=function(){this._className_="zwc.engine.core.displays.avatars.AvatarUnitDisplay"},e.loadAvatarParts=function(e,t,i,n,s,o){void 0===i&&(i=!1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),UH.idNameEmpty(t)||this._AUnit_&&(this.type==Za.MAIN_CHAR&&(qH.mainCharPartNames[e]=t),this._AUnit_.loadAvatarParts(e,t,i,0,0,o))},e.loadEffect=function(e,t,i,n,s,o,a,r,l,c){if(void 0===t&&(t="body_top"),void 0===n&&(n=!1),void 0===s&&(s=0),void 0===o&&(o=!0),void 0===a&&(a="stand"),void 0===r&&(r=0),void 0===l&&(l=0),void 0===c&&(c=-2),UH.idNameEmpty(e))return null;if(!this._AUnit_)return null;o&&null==i&&(i="eid_"+e);var u=this._AUnit_.loadEffect(e,t,i,o,a,r,l,c,s);return u?u.passID:i},e.removeEffect=function(e){this.effectHash.remove(e),this._AUnit_&&this._AUnit_.removeEffect(e)},e.hasEffect=function(e){return null!=this._AUnit_&&this._AUnit_.hasEffect(e)},e.takeEffect=function(e){return null==this._AUnit_?null:this._AUnit_.takeEffect(e)},e.play=function(e,t,i,n){void 0===t&&(t=1),void 0===n&&(n=-1),this._AUnit_.play(e),this._AUnit_.setCurrAct(e)},e.doDelay=function(e,t,i,n){G.timer.once(e,t,i,n,!1)},e.getCurrAct=function(){return this._AUnit_.currAct},e.pauseAvatar=function(e,t){this._AUnit_.pauseAvatar(e,t)},e.pauseMove=function(e){this.pauseTime=BB.getTimer()+e},e.setDir=function(e){null!=this._AUnit_&&this._AUnit_.setCurrDir(e)},e.onBodyRender=function(e){var t=this;if(t.type!=Za.EFFECT&&t.type!=Za.TRANSPORT&&t.type!=Za.PICKUP_ITEM&&t.type!=Za.PICKUP_GOLD){var i;t.graphics.clear();var n=RB.actDepths;if(t._AUnit_&&(n=RB.actDepths[t._AUnit_.currAct])){var s=n[t._AUnit_.currDir];if(s)for(var o=0;o<s.length;o++){var a=RB.idPart[s[o]];if((e=t.partRenderOrders[a])&&null!=e.texture){i=e.rect,t.tx=e.tx*e.scaleN,t.ty=e.ty*e.scaleN;var r=_.dirTextureHash.take(e.passID+"."+e.frame);if(_.showPanelLayer&&t.isCharObj){r&&(r.lastTime=pt.now());continue}if(null==r&&e.texture&&e.texture.bitmap&&(r=Xp.createFromTexture(e.texture,i.x,i.y,i.width,i.height))&&_.dirTextureHash.put(e.passID+"."+e.frame,r),5==e.dir||6==e.dir||7==e.dir?e.scaleMatrix&&0<e.scaleMatrix.a&&e.passID.indexOf("eid_bh")<0&&(e.scaleMatrix.a=-e.scaleMatrix.a):e.scaleMatrix&&e.scaleMatrix.a<0&&(e.scaleMatrix.a=-e.scaleMatrix.a),r){if(r.lastTime=pt.now(),HB.fps<5)return void(e=null);t.graphics.drawTexture(r,-t.tx,-t.ty,i.width,i.height,e.scaleMatrix)}e=null}}}}},e.recover=function(){var e=this;e.partRenderOrders.mid=null,e.partRenderOrders.wid=null,e.partRenderOrders.wgid=null,e.partRenderOrders.eid=null,e.isSceneEffect=!1,e.renderInSelf=!1,e.eidTopRenderOrders.length=0,e.eidBottomRenderOrder.length=0,e.graphics.clear(!0),e._AUnit_&&e._AUnit_.recover(),e.tx=1,e.ty=1,e.mat&&e.mat.identity(),e.transform=e.mat,e.scale_X=1,e.scale_Y=1,e.isCharObj=!1},e.setXY=function(e,t){this.x=e,this.y=t,this.hotArea.x=e+this.defaultHotAreaOffsetX,this.hotArea.y=t+this.defaultHotAreaOffsetY},e.onActPlayEnd=function(e){},e.toRender=function(e){var t=this;if(e)if("eid"==e.partType&&"RENDER_BODY"!=e.renderType)if(null!=e.texture){if(e.layer==Za.LAYER_TOP||e.layer==Za.LAYER_BOTTOM){var i=t.effectHash.take(e.passID);i&&(e.layerX=i.layerX,e.layerY=i.layerY)}t.effectHash.put(e.passID,e,!0),e.layer==Za.LAYER_TOP||e.layer==Za.LAYER_BODY_TOP?-1==t.eidTopRenderOrders.indexOf(e.passID)&&t.eidTopRenderOrders.push(e.passID):-1==t.eidBottomRenderOrder.indexOf(e.passID)&&t.eidBottomRenderOrder.push(e.passID)}else e.passID&&(t.effectHash.remove(e.passID),t.indexOf(t.eidTopRenderOrders,e.passID,!0),t.indexOf(t.eidBottomRenderOrder,e.passID,!0));else t.partRenderOrders[e.partType]=e;if(t.inStageRect()||t.renderInSelf){if(BB.heidOtherHeroMode&&t.type==Za.HERO)return void t.graphics.clear(!0);if(BB.heidOtherCharMode&&t.type!=Za.MAIN_CHAR&&t.type!=Za.HERO)if(ER.ins.canHideOtherChars()){if("ms1142"==t.mid||"ms136"==t.mid){var n=gR.ins.actorByJob(3);if(null==n||n.objectId.toString()!=t.char_id)return void t.graphics.clear(!0)}if(t.type==Za.CHAR)return e&&e.passID&&(t.effectHash.remove(e.passID),t.indexOf(t.eidTopRenderOrders,e.passID,!0),t.indexOf(t.eidBottomRenderOrder,e.passID,!0)),void t.graphics.clear(!0)}else if(t.type==Za.ROBOT)return void t.graphics.clear(!0);if(BB.heidOtherCharMode&&t instanceof zwc.engine.core.displays.world.char.Char&&ER.ins.getHideChar(t)&&ER.ins.canHideOtherChars())return void t.graphics.clear(!0);t.onBodyRender(e),t.isCleared=!0}else t.isCleared&&(t.isCleared=!1,t.graphics.clear(!0))},e.indexOf=function(e,t,i){if(void 0===i&&(i=!1),e)for(var n=0;n<e.length;n++)if(i&&e[n]==t)return e.splice(n,1);return-1},e.updateShowad=function(e){this.showad=e},e.inStageRect=function(){var e=this;if(-1!=e.className.indexOf("Effect"))return!0;if(e.renderInSelf)return!0;var t=NF.scene.localToGlobal(new Uh(e.x,e.y));e.renderRect.x=t.x,e.renderRect.y=t.y,e.renderRect.width=90,e.renderRect.height=130,e.stageRect.width=G.stage.width,e.stageRect.height=G.stage.height;var i=e.stageRect.intersects(e.renderRect);return uH.isFullScene||_.viewRect&&e!=NF.mainChar&&i&&(i=_.viewRect.contains(e.x,e.y)),i},e.reset=function(){var e=this;e._setup_(),-1==_.dislayQueue.indexOf(e)&&_.dislayQueue.push(e),e.mid="",e.wid="",e.wgid="",e.eid="",e.magicId="",e.partRenderOrders={mid:null,wid:null,wgid:null,eid:null},e.index=0,e.effectHash.reset(),e.eidTopRenderOrders.length=0,e.eidBottomRenderOrder.length=0,e.showad=null,NB.UiTextureSheet&&e.updateShowad(NB.UiTextureSheet),e.isShowad=!0,e.isShowBool=!0,e.isCleared=!0,e.stageRect.setTo(0,0,0,0),e.renderRect.setTo(0,0,0,0),e.mat.identity(),e.transform=e.mat,e.scale_X=1,e.scale_Y=1,e.alpha=1,e.visible=!0,e.rotation=0,e._isDisposed_=!1},e.dispose=function(){var e=this;_.dislayQueue.indexOf(e);-1!=e.index&&_.dislayQueue.splice(e.eidTopRenderOrders,1),e._AUnit_&&e._AUnit_.recover(),e.mid="",e.wid="",e.wgid="",e.eid="",e.partRenderOrders={mid:null,wid:null,wgid:null,eid:null},e.index=0,e.effectHash.reset(),e.eidTopRenderOrders.length=0,e.eidBottomRenderOrder.length=0,e.showad=null,e.isShowad=!0,e.isShowBool=!0,e.isCleared=!0,e.stageRect.setTo(0,0,0,0),e.renderRect.setTo(0,0,0,0),e.mat.identity(),e.scale_X=1,e.scale_Y=1,e.isCharObj=!1,t.prototype.dispose.call(e)},p(0,e,"isDeath",function(){return this._isDeath_}),p(0,e,"isPause",null,function(e){this._AUnit_.isPauseFrame=e}),p(0,e,"eidTopRenderOrders",function(){return this._eidTopRenderOrders},function(e){this.type,Za.MAIN_CHAR,this._eidTopRenderOrders=e}),p(0,e,"transform",function(){return this.mat},t.prototype._$set_transform),p(0,e,"actSpeed",function(){return this._actSpeed*BB.actSpeed},function(e){this._actSpeed=e}),p(0,e,"isShowad",function(){return this._isShowad},function(e){(this._isShowad=e)&&NB.UiTextureSheet&&this.updateShowad(NB.UiTextureSheet)}),p(0,e,"aunit",function(){return this._AUnit_}),p(0,e,"isPauseMove",function(){return this.pauseTime>BB.getTimer()}),p(0,e,"isPauseAvatar",function(){return this._AUnit_.isPauseAvatar}),p(0,e,"currFrame",function(){return this._AUnit_.currFrame}),p(0,e,"currAct",function(){return null==this._AUnit_?"stand":this._AUnit_.currAct}),p(0,e,"currDir",function(){return null==this._AUnit_?0:this._AUnit_.currDir}),_.doEffectRender=function(e,t,i){var n,s,o=NaN;for(o=0;o<e.length;o++){var a=e[o];if(a&&a.inStageRect()&&a.visible&&a.type!=Za.PICKUP_ITEM&&a.type!=Za.PICKUP_GOLD){for(var r=a.eidBottomRenderOrder,l=0;l<r.length;l++)if(n=a.effectHash.take(r[l]),a.visible&&n&&null!=n.texture){s=n.rect;var c=_.dirTextureHash.take(n.passID+"."+n.frame);if(_.showPanelLayer){c&&(c.lastTime=pt.now());continue}if(null==c&&n.texture&&n.texture.bitmap&&(c=Xp.createFromTexture(n.texture,s.x,s.y,s.width,s.height))&&_.dirTextureHash.put(n.passID+"."+n.frame,c),a.renderInSelf){if(a.graphics.clear(!0),_._tx_=n.tx*n.scaleN,_._ty_=n.ty*n.scaleN,c){if(c.lastTime=pt.now(),HB.fps<5)return void(n=null);a.graphics.drawTexture(c,-_._tx_,-_._ty_,s.width,s.height,n.scaleMatrix)}}else if(_._ty_=n.layer==Za.LAYER_BOTTOM?(-1==n.layerX&&(n.layerX=a.x,n.layerY=a.y),_._tx_=(n.layerX-n.tx)*n.scaleN,(n.layerY-n.ty)*n.scaleN):(_._tx_=(a.x-n.tx)*n.scaleN,(a.y-n.ty)*n.scaleN),c&&a.type!=Za.PICKUP_ITEM&&a.type!=Za.PICKUP_GOLD){if(c.lastTime=pt.now(),HB.fps<5)return void(n=null);i.drawTexture(c,_._tx_,_._ty_,s.width,s.height,n.scaleMatrix)}n=null}for(var u=a.eidTopRenderOrders,d=0;d<u.length;d++)if(n=a.effectHash.take(u[d]),a.visible&&n&&null!=n.texture){s=n.rect;var h=_.dirTextureHash.take(n.passID+"."+n.dir+"."+n.frame);if(_.showPanelLayer){h&&(h.lastTime=pt.now());continue}if(null==h&&n.texture&&n.texture.bitmap&&(h=Xp.createFromTexture(n.texture,s.x,s.y,s.width,s.height))&&_.dirTextureHash.put(n.passID+"."+n.dir+"."+n.frame,h),a.renderInSelf){if(a.graphics.clear(!0),h){if(h.lastTime=pt.now(),HB.fps<5)return void(n=null);a.graphics.drawTexture(h,-_._tx_,-_._ty_,s.width,s.height,n.scaleMatrix)}}else if(_._ty_=n.layer==Za.LAYER_TOP?(-1==n.layerX&&(n.layerX=a.x,n.layerY=a.y),_._tx_=(n.layerX-n.tx)*n.scaleN,(n.layerY-n.ty)*n.scaleN):(_._tx_=(a.x-n.tx)*n.scaleN,(a.y-n.ty)*n.scaleN),h&&a.type!=Za.PICKUP_ITEM&&a.type!=Za.PICKUP_GOLD){if(h.lastTime=pt.now(),HB.fps<5)return void(n=null);t.drawTexture(h,_._tx_,_._ty_,s.width,s.height,n.scaleMatrix)}n=null}}}},_.loop=function(){},_.dislayQueue=[],_.isReady=!1,_.showPanelLayer=!1,_._tx_=1,_._ty_=1,_.countIndex=0,_.recoreTime=0,f(_,["dirTextureHash",function(){return this.dirTextureHash=new jl},"viewRect",function(){return this.viewRect=new u_}]),_}(Xo),dq=function(e){function t(e){void 0===e&&(e=92),t.__super.call(this,e)}return b(t,"modules.jianbao.view.JianbaoGrid",MF),t}(),hq=function(e){function f(){var e=this;e._owner=null,e.dir=0,e._isHurtMy=!1,e.dy=2,e.time=0,e.va=.02,e.stop=!1,e.startY=0,e.startTime=0,e.monutHeight=0,e.body_height=0,e.dx=15,e.startSpeedY=3,e.showType=0,e._skillID=0,e._offsetX_=0,f.__super.call(e),null==zwc.engine.core.displays.world.parts.HurtImage.hurtQueue&&(zwc.engine.core.displays.world.parts.HurtImage.hurtQueue=[],G.timer.frameLoop(1,f,zwc.engine.core.displays.world.parts.HurtImage.heartCeatHandler))}b(f,"zwc.engine.core.displays.world.parts.HurtImage",Xo);var t=f.prototype;return t.startPlay=function(){zwc.engine.core.displays.world.parts.HurtImage.hurtQueue.push(this)},t.toImage=function(e,t,i,n,s){var o=this;void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=!0),void 0===s&&(s=0);var a,r,l=e.toString().split(""),c=0,u=0;switch(n&&o.graphics.clear(),o._skillID=s,o._skillID){case 6001:r={img1:"pz_jzlj",numImg1:"pz_bj_num3_",img2:"pz_jzlj",numImg2:"pz_bj_num3_",img3:"pz_jzlj",numImg3:"pz_bj_num3_"};break;case 9999:r={img:"pz_jn_gjwx",img1:"pz_jn_gjwx",img2:"pz_jn_gjwx",img3:"pz_jn_gjwx"};break;default:YN.isDuanhunSkill(s)&&(t=102401),r=Aa.getHurtNumberImageHash(t)}if(r){var d=r.img,h=r.numImg;if(0<i?d=-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(t)||-1!=Aa.STATR_UNION_TYPE.indexOf(t)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(t)?(h=r.numImg,r.img):4==i?(h=r.numImg,r.img):5==i?(h=r.numImg1,r.img1):o.owner&&0<o.owner.hero_id?(h=r.numImg,r.img):(h=r["numImg"+i],r["img"+i]):BB.getTimer()-f.index<1e3?f.showIndex++:(f.index=BB.getTimer(),f.showIndex=0),d&&(c+=(a=HP.drawTexture("fightNumer",d,o.graphics,c,-110)).width,o.height=a.height),null!=h&&0<l.length){for(var _=0;_<l.length;_++)c+=(a=-1!=Aa.STATR_UNION_TYPE.indexOf(t)?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-105):-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(t)?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-105):4==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-105):14==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-102):23==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-105):-1!=Aa.ZHUI_JI_TYPE_ARR.indexOf(t)?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-95):22==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-95):102401==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-95):29==t?HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-105):HP.drawTexture("fightNumer",h+l[_],o.graphics,c,-110)).width,-1<h.indexOf("pz_hj_num")?c-=10:c-=4;u=a.height}o.width=c,o.height=u}},t.setOffsetX=function(e){this._offsetX_=e,this.x=-this.width/2+this._offsetX_},t.setStartY=function(e,t){var i=this;void 0===t&&(t=0),i.startTime=BB.getTimer(),i.startY=0,i.dx=8,i.alpha=1,i.monutHeight=-Math.abs(e),i.startY=i.y=e,i.startSpeedY=3,i.showType=t,0==i.showType?0<i.owner.hero_id?i.y=e+130:(i.dx=5,i.x=-i.width/2+i._offsetX_,i.va=1/45,i.dy=4):5==i.showType?(i.dx=6,i.x=-i.width/2+i._offsetX_,i.va=1/45,i.dy=4):1==i.showType?(i.scaleX=i.scaleY=2,i.dy=.5,i.dx=4,i.va=1/30):21==i.showType?(i.va=.02,i.scaleX=i.scaleY=1,i.dy=.06,i.dx=4):9==t||2==t||19==t?(i.va=.02,i.scaleX=i.scaleY=1,i.x-=i.width/2,i.dy=.06,i.dx=4):4==t?(i.alpha=0,i.va=.01,i.y=e,i.scaleX=i.scaleY=3):-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(t)||-1!=Aa.STATR_UNION_TYPE.indexOf(t)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(t)?(i.alpha=0,i.va=.01,i.y=e,i.scaleX=i.scaleY=3):9999==t&&(i.x-=i.width/2,i.y=e+130)},t.onPlay=function(){var e=this,t=BB.getTimer();if(!e.stop&&0<t-e.time){var i=(e.time=t)-e.startTime;0<e.owner.hero_id&&(0==e.showType?e._isHurtMy=!0:5==e.showType&&(e.showType=21)),0==e.showType?e._isHurtMy?(300<i&&(e.alpha-=1*e.va*2,e.y+=1*e.dx*.5),3e3<i&&(e.visible=!1,e.alpha=0)):(e.startSpeedY<0&&(e.startSpeedY=0),e.dx-=.25,e.dy+=1.1*e.dx,0<e.startSpeedY&&(e.startSpeedY-=.15),e.y-=e.dy,e.scaleX<1.2&&(e.scaleX*=1.01,e.scaleY*=1.01),120<i?(e.dy=1.5+e.startSpeedY,e.alpha-=1*e.va,1500<i&&(e.visible=!1,e.alpha=0)):e.dy=2+e.startSpeedY):5==e.showType?(e.startSpeedY<0&&(e.startSpeedY=0),e.dx-=.25,e.dy+=1.1*e.dx,0<e.startSpeedY&&(e.startSpeedY-=.15),e.y-=1.1*e.dy,e.x-=e.dy,e.scaleX<1.2&&(e.scaleX*=1.01,e.scaleY*=1.01),120<i?(e.dy=1.5+e.startSpeedY,e.alpha-=1*e.va,1500<i&&(e.visible=!1,e.alpha=0)):e.dy=2+e.startSpeedY):1==e.showType?(i<300?(1<e.scaleX&&(e.scaleX*=.8,e.scaleY*=.8,e.x+=.01*i),e.scaleX<1&&(e.scaleX=e.scaleY=1)):(e.scaleX*=1.05,e.scaleY*=1.05,1.2<e.scaleX&&(e.scaleX=e.scaleY=1.2),e.alpha-=1*e.va,400<i&&(e.y-=e.dx)),2e3<i&&(e.visible=!1,e.alpha=0)):8==e.showType?(300<i&&(e.alpha-=1*e.va*2,e.y+=1*e.dx*.5),3e3<i&&(e.visible=!1,e.alpha=0)):21==e.showType?(300<i&&(e.alpha-=1*e.va*2,e.y+=1*e.dx*.5,e.x+=1*e.dx*.3),3e3<i&&(e.visible=!1,e.alpha=0)):9==e.showType||2==e.showType||19==e.showType?(i<1e3&&(e.y-=1*e.dx*.8),1200<i&&(e.alpha-=1*e.va*.5),2400<i&&(e.visible=!1,e.alpha=0)):4==e.showType||23==e.showType?(i<120&&(e.alpha+=1*e.va*30,e.x+=1*e.dx*7.5,e.y-=1*e.dx*2),i<500&&1.4<e.scaleX&&(e.scaleX*=.8,e.scaleY*=.8),700<i&&(e.alpha-=1*e.va*2,.9<e.scaleX&&(e.scaleX*=.999,e.scaleY*=.999)),2500<i&&(e.visible=!1,e.alpha=0)):-1!=Aa.STATR_UNION_DOUBLE_TYPE.indexOf(e.showType)||-1!=Aa.STATR_UNION_TYPE.indexOf(e.showType)||-1!=Vo.ZHUI_JI_SPICIAL_TYPE.indexOf(e.showType)?(i<120&&(e.alpha+=1*e.va*20,e.x+=1*e.dx*5,e.y-=1*e.dx*2),i<500&&1.4<e.scaleX&&(e.scaleX*=.8,e.scaleY*=.8),600<i&&(e.alpha-=1*e.va,e.y-=1*e.dx*.1,e.x+=1*e.dx*.1),2e3<i&&(e.visible=!1,e.alpha=0)):9999==e.showType&&(e.startSpeedY<0&&(e.startSpeedY=0),e.dx-=.25,e.dy+=1.1*e.dx,0<e.startSpeedY&&(e.startSpeedY-=.15),e.y-=e.dy,e.scaleX<1.2&&(e.scaleX*=1.01,e.scaleY*=1.01),120<i?(e.dy=1.5+e.startSpeedY,e.alpha-=1*e.va,1500<i&&(e.visible=!1,e.alpha=0)):e.dy=2+e.startSpeedY),e.alpha<=0&&(e.dispose(),e.stop=!0)}},t.clearRecover=function(e){this.alpha=0,this.dispose(),this.stop=!0},t.dispose=function(){this.owner=null,this.graphics.clear(),Og.clearAll(this),this.parent&&this.parent.removeChild(this),-1==zwc.engine.core.displays.world.parts.HurtImage.hurtImageHash.indexOf(this)&&zwc.engine.core.displays.world.parts.HurtImage.hurtImageHash.push(this)},p(0,t,"owner",function(){return this._owner},function(e){this._owner=e,this._owner&&0<this.owner.hero_id&&0==this.showType&&(this.y+=130,this.startY+=130,this.va=.02,this.scaleX=this.scaleY=1,this.dy=.06,this.dx=4)}),p(1,f,"hurtImageLength",function(){return null==zwc.engine.core.displays.world.parts.HurtImage.hurtQueue?0:zwc.engine.core.displays.world.parts.HurtImage.hurtQueue.length},zwc.engine.core.displays.DisplaySprite._$SET_hurtImageLength),f.heartCeatHandler=function(){var e;if(zwc.engine.core.displays.world.parts.HurtImage.hurtQueue.length)for(var t=0;t<zwc.engine.core.displays.world.parts.HurtImage.hurtQueue.length;t++){(e=zwc.engine.core.displays.world.parts.HurtImage.hurtQueue[t]).owner?e.onPlay():(zwc.engine.core.displays.world.parts.HurtImage.hurtQueue.splice(t,1),e.dispose(),t--)}},f.GetNew=function(){var e;return 0<zwc.engine.core.displays.world.parts.HurtImage.hurtImageHash.length?((e=zwc.engine.core.displays.world.parts.HurtImage.hurtImageHash.pop()).scaleX=e.scaleY=1,e.dy=2,e.time=0,e.va=.025,e.stop=!1,e.startY=0,e.startTime=0,e.monutHeight=0,e.body_height=0,e.dx=15,e.startSpeedY=3,e.showType=0,e.id=null,e.oid=null,e.owner=null,e.alpha=1,e.visible=!0,e.x=0,e.y=0,e.visible=!0,e.pivotX=0,e.pivotY=0,e.isDisposed=!1,e._isHurtMy=!1):e=new f,e},f.hurtImageHash=[],f.hurtQueue=null,f.showIndex=0,f.index=0,f}(),_q=function(e){function t(e){void 0===e&&(e=106),t.__super.call(this,e),this.toolTipEnabled=!1,this.mouseEnabled=!0}return b(t,"modules.weaponsoul.views.WeaponSoulGrid",MF),t.prototype.drawText=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=0),e.fillText(this.goodsNum+"",t+this.width-6,i+this.height-26,"22px SimHei","#ece2ca","right"),!0},t}(),fq=function(e){function t(){this._selected=!1,t.__super.call(this)}b(t,"modules.xinfa.view.GoodsSelectedGrid",e);var i=t.prototype;return i.afterDrawIcon=function(){e.prototype.afterDrawIcon.call(this)},p(0,i,"dataSource",null,function(e){e&&(this.isClearUrl=!1,this.goodsId=e.goodsId,this.goodsNum=e.num,this.bindData=e.goodsId)}),p(0,i,"selected",function(){return this._selected},function(e){this._selected=e}),t}(MF),pq=function(o){function a(){var e=this;e._iconLayer=0,e._tipLayer=1,e._textLayer=2,e._effectLayer=3,e._nameVisible=!1,e._nameY=109,e._nameFont="22px SimHei",e._simpleName=!1,e._mRenderEnabled=!0,a.__super.call(e),e.graphicsMode=!0,e.on("render",e,e.refresh)}b(a,"ui.gridrender.MGoodsGrid",o);var e=a.prototype;return G.imps(e,{"ui.layerrender.IMRenderEnabled":!0}),e.invalid=function(){iu.invalidRender(this)},e.refresh=function(e){var t=this;if(t.graphics.clear(),0!=t.goodsId){if(t.showEffect(),t.drawBg(t.graphics)){if(t._nameVisible){var i=t.mRenderLayerGraphics(t._textLayer,a.zpt.setTo(0,0));t.drawName(i,a.zpt.x,a.zpt.y)}t.drawIcon(null,null)}}else t.clearEffect()},e.drawName=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0);var n=Bi.getIndex(this.goodsId),s=this._simpleName?Bi.MODEL.simpleName(n):Bi.MODEL.name(n),o=ms.getByQuality(Bi.MODEL.colourId(n));return e.fillText(s,a.zpt.x+this.width/2,a.zpt.y+this._nameY,this._nameFont,o,"center"),!0},e.destroy=function(e){void 0===e&&(e=!0),o.prototype.destroy.call(this,e),this._effect&&(this._effect.dispose(),this._effect.destroy(),this._effect=null)},e.showEffect=function(){var e=this;if(o.prototype.showEffect.call(e),e._effect){var t=iu.layerSprite(e,e._effectLayer,a.zpt.setTo(e.width>>1,e.height>>1));e._effect.parent&&e._effect.parent.removeChild(e._effect),e._effect.pos(a.zpt.x,a.zpt.y),t.addChild(e._effect)}},e.updateMRenderEnabled=function(e){this._mRenderEnabled!=e&&(this._mRenderEnabled=e,this._mRenderEnabled||this.clearEffect())},e.drawCorner=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=0),o.prototype.drawCorner.call(this,e,t,i),!0},e.drawIcon=function(e,t,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),t=this.mRenderLayerGraphics(this._iconLayer,a.zpt.setTo(0,0)),o.prototype.drawIcon.call(this,e,t,a.zpt.x,a.zpt.y)},e.doDrawIcon=function(e,t,i,n,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.displayedInStage&&o.prototype.doDrawIcon.call(this,e,t,i,n,s)},e.afterDrawIcon=function(){var e=this,t=e.mRenderLayerGraphics(e._tipLayer,a.zpt.setTo(0,0));if(e.drawTip(t,a.zpt.x,a.zpt.y)&&e.drawCorner(t,a.zpt.x,a.zpt.y)&&(t=e.mRenderLayerGraphics(e._textLayer,a.zpt.setTo(0,0)),e.drawText(t,a.zpt.x,a.zpt.y))){var i=iu.layerSprite(e,e._effectLayer,a.zpt.setTo(0,0));i&&e.setMoEquitStar(i,a.zpt.x+3,a.zpt.y+2)}},f(a,["zpt",function(){return this.zpt=new Uh}]),a.__init$=function(){iu.bridgeMRenderer(a)},a}(MF),gq=function(e){function t(){t.__super.call(this),this.addSubscribe(KG),this.subPackages=["21006","21007","21009","21011","21013","30023","30024","30151","30153","30155","30024","30202","10205","30121","30123","UPDATE_REDPOINT_CIMECILA","30481","30483","UPDATE_YUPEI_MATERIAL","BP_UPDATE","OPEN_DRADON_SOUL","23221","23223","30161","30163","30165"]}return b(t,"modules.achievenew.AchieveNewModule",zF),t}(),vq=function(e){function t(){t.__super.call(this),this.addSubscribe(eU,$G),this.subPackages=["12202","12204","12206","12208","12210","12222","12224","12226","31031","31032","31033","23621","12229","12235","30732","11106","11107","11108","30322","30324","30326","30328","30314","TR_STORE","RESHOWMAINVIEW","21271","21272","25007","25008","OPEN_FEST_ENTER_PANEL","RESHOWMAINVIEW","REHIDEMAINVIEW","12234","23005","23006","30801","30805","30807","30808","30904","30905","30907","30909","30952","30954","12247","23622","12248","34007","34016","34018","21273","12237","12239","BP_UPDATE"]}return b(t,"modules.activity.ActivityModule",zF),t}(),mq=function(e){function t(){t.__super.call(this),this.addSubscribe(tU),this.subPackages=["23005","23006","30131","30133","30134","30726","12231","39015","39017","39009","39011","39013","36012","31061","36020","34020"]}return b(t,"modules.activityDaily.DailyModule",zF),t}(),yq=function(e){function t(){t.__super.call(this),this.addSubscribe(sU,iU,oU,nU,rU,EU,aU,cU,lU,uU),this.subPackages=["21101","21106","21109","21110","10204","21120","21115","21117","10210","10208","10205","10201","10207","10212","25010","14001","23711","23712","23752","23754","23750","23756","30102","30104","30010","30011","30121","30123","30481","30483","31026","31024",Ve.TOC_23701,Ve.TOC_23621,Ve.TOC_23621,"30106","214","30104","11302","30452","30453","25001","11305","30161","30163","30165","BP_UPDATE","10121",he.TOC_31021,"31023","30615","30611","30613","30619","30617","30623","30625","30627","23713","23714","30662","30667","30668","11308","11310","11312","11314","30670","30672","30787","10424","10425","30789"]}return b(t,"modules.actor.ActorModule",zF),t}(),Iq=function(e){function t(){t.__super.call(this),this.addSubscribe(dU),this.subPackages=[]}return b(t,"modules.arena.ArenaModule",zF),t}(),bq=function(e){function t(){t.__super.call(this),this.addSubscribe(hU),this.subPackages=["10112","10121"]}return b(t,"modules.assit.AssitModule",zF),t}(),wq=function(e){function t(){t.__super.call(this),this.addSubscribe(_U,fU),this.subPackages=["10401","10402","10403","10408","22352",Ve.TOC_10413,"10415","10416","10417","30652","10206","23621"]}return b(t,"modules.backpack.BackpackModule",zF),t}(),xq=function(e){function t(){t.__super.call(this),this.registerSubProxy(pU),this.subPackages=["OPEN_BOSS_ANCIENT_VIEE","OPEN_SPORTS_VIEW","21232","24044","10110"]}return b(t,"modules.bossancient.BossAncientModule",zF),t}(),Sq=function(e){function t(){t.__super.call(this),this.addSubscribe(gU),this.subPackages=["13301","10602","10204","30010","30011","11806","12001","OPEN_HERALD"]}return b(t,"modules.broadcast.BroadcastModule",zF),t}(),kq=function(e){function t(){t.__super.call(this),this.addSubscribe(vU),this.subPackages=["30462","30465"]}return b(t,"modules.changename.ChangeNameModule",zF),t}(),Eq=function(e){function t(){t.__super.call(this),this.addSubscribe(mU),this.subPackages=["11803","11805","10206","21109"]}return b(t,"modules.chat.ChatModule",zF),t}(),Tq=function(e){function t(){t.__super.call(this),this.addSubscribe(yU),this.subPackages=["23611","__SCENE_CHANGED__","_CheckPoint_Exp_add_","10702"]}return b(t,"modules.checkpoint.CheckPointModule",zF),t}(),Cq=function(e){function t(){t.__super.call(this),this.addSubscribe(IU),this.subPackages=["12202","12204","12206","31061"]}return b(t,"modules.dailygift.DailyGiftModule",zF),t}(),Lq=function(e){function t(){t.__super.call(this),this.addSubscribe(bU,wU),this.subPackages=["22202","22204","22205","22210","22214","22217","22220","22221","22222","23601","10802","10806","10807","10808","30360","21302","21305","21308","21311","21313","21315","21316","30330","30331","30333","22352"]}return b(t,"modules.digger.DiggerModule",zF),t}(),Mq=function(e){function t(){t.__super.call(this),this.addSubscribe(xU),this.subPackages=[]}return b(t,"modules.field.FieldModule",zF),t}(),Aq=function(e){function t(){t.__super.call(this),this.addSubscribe(SU,kU)}return b(t,"modules.fight.FightModule",zF),t}(),Dq=function(e){function t(){t.__super.call(this),this.addSubscribe(TU),this.subPackages=["30302","23722","23720","30340","30350","30342","30352","24004","23770","23771","23703","10702","30343","30353"]}return b(t,"modules.godweapon.GodWeaponModule",zF),t}(),Oq=function(e){function t(){t.__super.call(this),this.addSubscribe(CU),this.subPackages=["12216","12218","12219","12220"]}return b(t,"modules.goldrotary.GoldrotaryModule",zF),t}(),Pq=function(e){function t(){t.__super.call(this),this.addSubscribe(MU,LU),this.subPackages=["10205","_CLOSE_LAYOUT_"]}return b(t,"modules.gui.GuiModule",zF),t}(),Rq=function(e){function t(){t.__super.call(this),this.addSubscribe(AU),this.subPackages=["11502","11504","10206","11901"]}return b(t,"modules.guide.GuideModule",zF),t}(),Nq=function(e){function t(){t.__super.call(this),this.addSubscribe(DU),this.subPackages=["31031","31032","31033"]}return b(t,"modules.jianbao.JianbaoModule",zF),t}(),Bq=function(e){function t(){t.__super.call(this),this.addSubscribe(OU),this.subPackages=["OPEN_LIMIT_CHALLENGE_MAIN","UPDATE_LIMIT_CHALLENGE","GET_AWARD_EFFECT","23720","23722","23724","23725","23731","23732","23733"]}return b(t,"modules.limitChallenge.LimitChallengeModule",zF),t}(),Hq=function(e){function t(){t.__super.call(this),this.addSubscribe(RU),this.subPackages=["10102","10104","10106","10110","10114","10118","10201","13303","13602"]}return b(t,"modules.login.LoginModule",zF),t}(),Vq=function(e){function t(){t.__super.call(this),this.subPackages=[],this.addSubscribe(NU)}return b(t,"modules.loginnotice.LoginNoticeModule",zF),t}(),Gq=function(e){function t(){t.__super.call(this),this.addSubscribe(BU),this.subPackages=["21241","21243","21245","21246","30601","30602","10702","21247"]}return b(t,"modules.magic.MagicModule",zF),t}(),Uq=function(e){function t(){t.__super.call(this),this.addSubscribe(HU),this.subPackages=["11201","11203","11205","11207","11211","11212"]}return b(t,"modules.mail.MailModule",zF),t}(),Fq=function(e){function t(){t.__super.call(this),this.addSubscribe(VU,GU),this.subPackages=["10902","10905","10907","10909","10205"]}return b(t,"modules.mall.MallModule",zF),t}(),qq=function(e){function t(){t.__super.call(this),this.addSubscribe(UU,jU),this.subPackages=["25018"]}return b(t,"modules.map.MapModule",zF),t}(),jq=function(e){function t(){t.__super.call(this),this.addSubscribe(FU),this.subPackages=["23730","23727"]}return b(t,"modules.moLimitMission.MoLimitMissionModule",zF),t}(),Wq=function(e){function t(){t.__super.call(this),this.addSubscribe(jU,qU),this.subPackages=["NAV_ATTACK_LIST_SELECT","10207","10205","10206","21109","10602","21110","11211","13002","10201","10210","12001","14001","14010","10204","_Change_Batch_","UPDATE_GOV_REDPOINT","UPDATE_TUJIAN_REDPOINT","UPDATE_FORCE","10119","24004","24026","24027","24033","25012","24028","24011","31011","CHANGE_FIRSTPAY_TIME","UPDATE_HEJI_RED_POINT","25000","UPDATE_GUANQIA_GUIDE","12934","UPDATE_FRIEND_RED_POINT","HIDE_OTHER_PLAYERS","UPDATE_RED_POINT","UPDATE_NAV_ALL","USE_HEJI_BACK","CHAR_DEAD","OPEN_LIMIT_ZHUIJI","CLOSE_LIMIT_ZHUIJI","UPDATE_ZHUIJI","31023","10121","BOSS_BLOOD_CLOSE"]}return b(t,"modules.nav.NavModule",zF),t}(),Yq=function(e){function t(){t.__super.call(this),this.addSubscribe(WU),this.subPackages=["OPEN_DAILY_VIEW","21006","21011","21013","21009","30023","30024"]}return b(t,"modules.newDailyAct.NewDailyActModule",zF),t}(),zq=function(e){function t(){t.__super.call(this),this.registerSubProxy(YU),this.subPackages=["23310","23317","23324","24042","23327","23329","23326","23311","23320","23305","23335","23336","23331","23338","23341"]}return b(t,"modules.newsiege.NewSiegeModule",zF),t}(),Xq=function(e){function t(){t.__super.call(this),this.registerSubProxy(zU),this.subPackages=["UDPDATE_TASK","BP_UPDATE","31051","31054"]}return b(t,"modules.niepan.NiepanModule",zF),t}(),Qq=function(e){function t(){t.__super.call(this),this.addSubscribe(XU),this.subPackages=["13001","13003","13005","22305","13028","__LOGIN_RECONENTED__","INTERVAL_LOST_CONNECTED","SOCKET_CLOSE"]}return b(t,"modules.offline.OfflineModule",zF),t}(),Jq=function(e){function t(){t.__super.call(this),this.addSubscribe(QU),this.subPackages=["11302","23621","10204"]}return b(t,"modules.passsuit.PassSuitModule",zF),t}(),Zq=function(e){function t(){t.__super.call(this),this.addSubscribe(JU),this.subPackages=["12003"]}return b(t,"modules.preview.PreviewModule",zF),t}(),Kq=function(e){function t(){t.__super.call(this),this.registerSubProxy(ZU),this.subPackages=["10207","10702","10704","10212","25010"]}return b(t,"modules.rank.RankModule",zF),t}(),$q=function(e){function t(){t.__super.call(this),this.addSubscribe($U,KU),this.subPackages=["23004","23005","23006","23008","23009","14003","33017"]}return b(t,"modules.recharge.RechargeModule",zF),t}(),ej=function(e){function t(){t.__super.call(this),this.addSubscribe(eF),this.subPackages=["RELIVEVIEW_OPEN","21230"]}return b(t,"modules.relive.ReliveModule",zF),t}(),tj=function(e){function t(){t.__super.call(this),this.addSubscribe(tF),this.subPackages=["BP_UPDATE","31042"]}return b(t,"modules.resonate.ResonateModule",zF),t}(),ij=function(e){function t(){t.__super.call(this),this.addSubscribe(aF,uF,cF,sF,lF,oF,nF,rF),this.subPackages=["22617","10310","10311","13501","23106","23114","10206","CATE_1_END","CATE_27_END","__SCENE_CHANGED__","10312","10313","10314","12912","23122","23123","22611","22612","10208","10109","10309","10301","10302","10304","13003","22601","22602","22603","22604","22606","22110","22111","10204","22614","22613","23312","23325","25000","24000","24001","24002","24003","24010","24011","24020","24021","24022","24026","24006","24016","24017","24018","24019","21230","30004","24030","24007","24031","24029","24013","24014","24037","24038","24045","PICK_UP_All_END","OTHER_CHAR_DEAD","24027","24049","24053","25019","30721","30722","10122","25013","25014","30785"]}return b(t,"modules.scene.SceneModule",zF),t}(),nj=function(e){function t(){t.__super.call(this),this.addSubscribe(dF),this.subPackages=["10501","10502","10504","21403","21404","21406","21408","21409","10205","21106","30252","30253","21413","24035","24043","30165","30163","30161","30161","30255","30257","30259","30822","30824","30826","30827"]}return b(t,"modules.skill.SkillModule",zF),t}(),sj=function(e){function t(){t.__super.call(this),this.addSubscribe(_F),this.subPackages=["30392"]}return b(t,"modules.soul.SoulModule",zF),t}(),oj=function(e){function t(){t.__super.call(this),this.addSubscribe(hF),this.subPackages=["31010"]}return b(t,"modules.soul.SoulOutModule",zF),t.MODULE_NAME="SoulOutModule",t}(),aj=function(e){function t(){t.__super.call(this),this.addSubscribe(fF),this.subPackages=["23223","23221","23227"]}return b(t,"modules.specialgodring.SpecialGodRingModule",zF),t}(),rj=function(e){function t(){t.__super.call(this),this.addSubscribe(gF,pF),this.subPackages=["11901","11905","10205"]}return b(t,"modules.task.TaskModule",zF),t}(),lj=function(e){function t(){t.__super.call(this),this.addSubscribe(vF),this.subPackages=["23720","23722"]}return b(t,"modules.tasknew.TaskNewModule",zF),t}(),cj=function(e){function t(){t.__super.call(this),this.registerSubProxy(mF),this.subPackages=["11106","11107","11108","30322","30324","30326","30328","30314"]}return b(t,"modules.treasure.TreasureModule",zF),t}(),uj=function(e){function t(){t.__super.call(this),this.addSubscribe(yF),this.subPackages=["14001","14003","14006","14008","14009","14011"]}return b(t,"modules.vip.VipModule",zF),t}(),dj=function(e){function t(){t.__super.call(this),this.registerSubProxy(IF),this.subPackages=["21602","21604","30491","30493","30495","30496"]}return b(t,"modules.welfare.WelfareModule",zF),t}(),hj=function(e){function t(){t.__super.call(this),this.registerSubProxy(bF),this.subPackages=["22303","22352","22363"]}return b(t,"modules.yueka.MonthCardModule",zF),t}(),_j=function(e){function t(){t.__super.call(this),this.addSubscribe(wF),this.subPackages=["30414","30418"]}return b(t,"modules.yunying.YunyingModule",zF),t}(),fj=function(e){function t(){t.__super.call(this),this.registerSubProxy(xF),this.subPackages=["23110","23102","23106","23112","23103","23120","23117","23118","23125","23121","23602"]}return b(t,"modules.yzbqc.YzbqcModule",zF),t}(),pj=function(e){function t(){var e=this;e._selected=!1,e.cb=null,e.uuid=0,e.dto=null,e.labName=null,e.grid=null,e._cbPath=_r.getAtlasSubPath("basic_ui_3/ty_xz_dh.png"),t.__super.call(e),e.width=116,e.height=140,e.grid=new MF,e.grid.x=e.grid.y=0,e.addChild(e.grid),e.cb=new Kl(e._cbPath),e.cb.centerX=0,e.cb.centerY=-10,e.labName=new fc,e.labName.centerX=0,e.labName.y=e.y+120,e.labName.fontSize=20,e.addChild(e.labName)}b(t,"modules.actor.views.samsaraequip.SamEquipGrid",e);var i=t.prototype;return p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.dto=e,t.grid.isClearUrl=!1,t.grid.bindData=e.goodsId,t.uuid=e.uuId;var i=ms.getByQuality(t.dto.colourId);t.labName.text=t.dto.simpleName,t.labName.color=i,t._selected||(t.grid.filters=[],t.cb.removeSelf())}}),p(0,i,"selected",function(){return this._selected},function(e){this._selected=e,this.grid.filters=[],e?(this.grid.filters=[yR.gray],this.addChild(this.cb)):this.cb.removeSelf()}),t}(dt),gj=function(e){function t(){t.__super.call(this),this.mouseEnabled=!1,this.mouseThrough=!0,this.centerX=0,this.centerY=0}b(t,"modules.task.views.FrameView",Kl);var i=t.prototype;return i.show=function(e){this.graphics.clear(),e?(this.loadImage(t.FRAMEURL2,0,0,G.stage.width,G.stage.height),eq.effectLayer.addChild(this)):(this.loadImage(t.FRAMEURL,0,0,G.stage.width,G.stage.height),eq.bottomLayer.addChild(this))},i.close=function(){this.parent&&this.parent.removeChild(this),G.loader.getRes(t.FRAMEURL)?(G.loader.clearRes(t.FRAMEURL,!0),tt.ins.clearTexture(t.FRAMEURL)):G.loader.cancelLoadByUrl(t.FRAMEURL),G.loader.getRes(t.FRAMEURL2)?(G.loader.clearRes(t.FRAMEURL2,!0),tt.ins.clearTexture(t.FRAMEURL2)):G.loader.cancelLoadByUrl(t.FRAMEURL2)},f(t,["FRAMEURL",function(){return this.FRAMEURL=_r.getAtlasSubPath("task/Frame.png")},"FRAMEURL2",function(){return this.FRAMEURL2=_r.getAtlasSubPath("task/Frame2.png")}]),t}(),vj=function(i){function t(e){this._listMode=!1,this._list=null,this._repeatX=NaN,this._repeatY=NaN,this._hScrollBarSkin="",this._vScrollBarSkin=null,this.renderHandler=null,void 0===e&&(e=9),t.__super.call(this,e,!1)}b(t,"ui.gridrender.MGridsList",i);var e=t.prototype;return e.onChange=function(){var e=this;e._invalid=!1,isNaN(e._cellW)&&isNaN(e._cellH)&&e.initCellSize(),e._list||e.initList();var t=-1,i=e._list.array,n=0;if(i)for(n=0;n<i.length;n++)if(i[n][cq._gridSelected_]){t=n;break}var s=e.items?e.items.length:0;if(e._list.dataSource=e.items||[],iu.invalidContainer(e._list),e.items&&0<e.items.length)for(n=0;n<e.items.length;n++)e._list.cells[n]._mgrid_._iconUrl&&e.urlArr.push(e._list.cells[n]._mgrid_._iconUrl);if(i=e._list.array){var o=-1;for(n=0;n<i.length;n++)i[n][cq._gridSelected_]&&(-1==o?o=n:i[n][cq._gridSelected_]=!1);-1!=o&&(t=-1)}-1!=t&&(e.selectedIndex=t);var a=s>e._rowCount?e._rowCount:s;e._contentW=e._cellW*a+e._tSpaceX*(a-1),e._contentW<0&&(e._contentW=0),e._contentW>e.width&&(e._contentW=e.width);var r=Math.ceil(s/e._rowCount);e._contentH=e._cellH*r+e._tSpaceY*(r-1),e._contentH<0&&(e._contentH=0),e._contentH>e.height&&(e._contentH=e.height)},e.onCellRender=function(e,t){var i;(i=e._mgrid_?e._mgrid_:e).bindData=this.items[t],this._selectMode&&(i.on("click",this,this.onGridClick,[i,t]),i.on("render",this,this.onGridMRender,[i,t]))},e.onGridMRender=function(e,t){i.prototype.onGridMRender.call(this,e,t),this.renderHandler&&this.renderHandler.runWith([e,t])},e.invalidGrid=function(e){this._list.changeItem(e,this.items[e])},e.initList=function(){var i=this;this._list=new mc,null!=this._hScrollBarSkin&&(this._list.hScrollBarSkin=this._hScrollBarSkin),null!=this._vScrollBarSkin&&(this._list.vScrollBarSkin=this._vScrollBarSkin),this._list.scrollBar&&(this._list.scrollBar.elasticBackTime=200,this._list.scrollBar.elasticDistance=100);var n=this;this._list.itemRender=function(){var e=new pp;e.size(i._cellW,i._cellH);var t=function(){var e=new i._gridCls;return e.isClearUrl=i.isClearUrl,e.size(n._gridW,n._gridH),e.pos(n._offseX,n._offseY),cq._initGrid(n,e,i.needEffect),e}();return e._mgrid_=t,e.addChild(t),e},this._list.spaceX=this._tSpaceX,this._list.spaceY=this._tSpaceY,this._list.repeatX=isNaN(this._repeatX)?this._rowCount:this._repeatX,this._list.size(this.width,this.height),this._list.renderHandler=ql.create(this,this.onCellRender,null,!1),this.addChild(this._list)},p(0,e,"list",function(){return this.runChange(),this._list}),t}(cq),mj=function(u){function l(){this.isAutoDispose=!0,this.autoClear=!0,this.playEndHandler,this.renderOrder,l.__super.call(this),this.isShowad=!1,this.type=Za.EFFECT,this._className_="modules.scene.others.Effect",l._effectQueue_.push(this)}b(l,"zwc.engine.core.displays.avatars.Effect",u);var e=l.prototype;return e.inStageRect=function(){return!(!this.renderInSelf||0!=this.isSceneEffect)||(this.renderInSelf&&this.isSceneEffect,u.prototype.inStageRect.call(this))},e.reset=function(){var e=this;u.prototype.reset.call(e),e.renderOrder&&e.renderOrder.dispose(),e.renderOrder=null,e.isSceneEffect=!1,e.type=Za.EFFECT,e.visible=!0,e.alpha=1,e.scale_X=1,e.scale_Y=1,e.autoClear=!0,e.x=0,e.y=0,e.filters=null,e._isDisposed_=!1,-1==l._effectQueue_.indexOf(e)&&l._effectQueue_.push(e),l._ty=l._ty=1},e.onEffectPlayEnd=function(e){null!=this.playEndHandler&&this.playEndHandler.runWith(e),this.isAutoDispose&&this.dispose()},e.loadEffect=function(e,t,i,n,s,o,a,r,l,c){void 0===t&&(t="body_top"),void 0===n&&(n=!1),void 0===s&&(s=0),void 0===o&&(o=!0),void 0===a&&(a="stand"),void 0===r&&(r=0),void 0===l&&(l=0),void 0===c&&(c=-2);u.prototype.loadEffect.call(this,e,t,i,n,s,o,a,r,l,c);return i},e.dispose=function(){var e=this;if(NF.scene.removeItem(e),!e.destroyed){var t=l._effectQueue_.indexOf(e);-1!=t&&(l._effectQueue_.splice(t,1),t=-1),"modules.scene.others.Effect"==e.className&&e instanceof modules.scene.others.EffectShoot==0&&-1==l.recoverQueue.indexOf(e)&&l.recoverQueue.push(e),e.playEndHandler=null,e.mid="",e.wid="",e.wgid="",e.eid="",e.partRenderOrders={mid:null,wid:null,wgid:null,eid:null},e.recover(),e._AUnit_=null,e.alpha=1,e.visible=!0,e.filters=null,e.effectHash.reset(),e.eidTopRenderOrders.length=0,e.eidBottomRenderOrder.length=0,e.showad=null,e.isShowad=!0,e.isShowBool=!0,e.isCleared=!0,e.stageRect=new u_(0,0),e.renderRect=new u_,e.removeReason=[],G.timer.clearAll(e),Og.clearAll(e),e.scale_X=1,e.scale_Y=1,e.autoClear=!0,e.removeChildren(),e.parent&&e.parent.removeChild(e)}},e.destroy=function(e){void 0===e&&(e=!0),this.destroyed||this.dispose()},e.toRender=function(e){this.renderOrder=e},e.forceDestory=function(e){if(void 0===e&&(e=!0),!this.destroyed){this.dispose();var t=l.recoverQueue.indexOf(this);-1!=t&&l.recoverQueue.splice(t,1),laya.display.Sprite.prototype.destroy.call(this,e)}},p(0,e,"visible",u.prototype._$get_visible,function(e){G.superSet(uq,this,"visible",e)}),p(0,e,"filters",u.prototype._$get_filters,function(e){v_.isWebGL&&G.superSet(uq,this,"filters",e)}),p(1,l,"useQueue",function(){return l._effectQueue_},zwc.engine.core.displays.avatars.AvatarUnitDisplay._$SET_useQueue),l.doRender=function(e,t){for(var i,n=0;n<l._effectQueue_.length;n++){var s=l._effectQueue_[n],o=s.renderOrder,a=null;if(null!=o&&null!=o.rect&&null!=o.texture&&s&&s.visible&&s.type==Za.EFFECT&&s.inStageRect()&&s.stage){i=o.rect;var r=uq.dirTextureHash.take(o.passID+"."+o.frame);if(uq.showPanelLayer&&s&&s.renderInSelf&&s.isCharObj){r&&(r.lastTime=pt.now());continue}if(null==r&&o.texture&&o.texture.bitmap&&(r=Xp.createFromTexture(o.texture,i.x,i.y,i.width,i.height))&&uq.dirTextureHash.put(o.passID+"."+o.frame,r),s.renderInSelf){if(s.graphics.clear(),o&&null!=o.texture&&s&&0<s.alpha&&r){if(r.lastTime=pt.now(),a=o.scaleMatrix.clone(),1==s.scale_X&&1==s.scale_Y||a.scale(s.scale_X,s.scale_Y),HB.fps<5)return;s.graphics.drawTexture(r,-o.tx*o.scaleN,-o.ty*o.scaleN,i.width,i.height,a)}}else if(o.layer,o&&null!=o.texture&&s.visible&&0<s.alpha&&r){if(r.lastTime=pt.now(),a=o.scaleMatrix.clone(),1==s.scale_X&&1==s.scale_Y||a.scale(s.scale_X,s.scale_Y),HB.fps<5)return;e.drawTexture(r,(s.x-o.tx)*o.scaleN,(s.y-o.ty)*o.scaleN,i.width,i.height,a)}}o=null}},l.GetNew=function(){if(l.recoverQueue.length){var e=l.recoverQueue.shift();return e.reset(),e}return new l},l._tx=1,l._ty=1,f(l,["recoverQueue",function(){return this.recoverQueue=new Array},"_effectQueue_",function(){return this._effectQueue_=new Array}]),l}(uq),yj=function(o){function i(){var e=this;e.data=null,e.isOffline=!1,e.playSkillData=null,e._bookTile_=null,e._bookHeroTile_=null,e.isAres=!1,e.isBoss=!1,e.isElites=!1,e.owner_char=null,e.char_id=null,e.objectId=NaN,e.hero_id=-1,e.stopDurTime=0,e.isMainChar=!1,e.isLoopMove=!1,e._point_=null,e._lookDir_=0,e._tarPoint_=null,e.isOwner=!0,e.campState=0,e.serverHp=null,e.effectPlayKey="",e._movePath_=[],this._totalTime_=0,this._loopMoveTime_=0,this._isCharMode_=!0,this.hoeTimeIndex=0,this._isLoopMove_=!1,this._isWalkMode_=!1,this._key_=null,this._isMainChar_=!1,this._lockMove=!1,this._isActSpeedUp_=!1,this._locklSkill=!1,this.walkSpeed=0,this.runSpeed=230,this._speed_=280,this._isRuning_=!1,this._stopMove_=!1,this._lockMoveTime_=0,this._actSpeedUpTime_=0,this._lockSkillTime_=0,this.profession=0,this.sex=1,this._char_name_="",this._bodyHeight_=130,this.setTimeoutIndex=NaN,this.countTime=0,this._currDir_=0,this._charHead_=null,this.lockMoveDelayTime=1500,this.lockSkillDelayTime=2e3,this.actSpeedUpDealay=1500,this.flyupLevel=0,this.InterruptsingSkillIdArr=[],this.singSkillIdArr=[],this.selectEnabled=!0,this.selectTarget=null,this.layer=1,this.ai=null,this.isUpdateBool=!0,this.gov=-1,this.lockTime_=0,this.titleArray=[],this.freezeeEff="jn10605",this.freezeKey="",this.burnEff="jn10765",this.burnKey="",this._isStun=!1,this.stunEff="jn10745",this.stunKey="",this._moZhuangDunEff="jn10662",this._moZhuangDunKey="",this._isHasMoZhuangDun=!1,this._shenmoDunEff="jn11062",this._shenmoDunKey="",this._isHashenmoDun=!1,this._colorFilterArray_=[],this._actState_=null,this._currAct_="stand",this.time=0,this.timeIndex=0,this.tileX=0,this.tileY=0,this.tileX_old=0,this.tileY_old=0,this.frameIndex=0,this._Key_="",this._vx_=0,this._vy_=0,this.checkActDur=0,this.isNeedChanegSpeed=!1,this._isPoisoning=!1,this._isMabi=!1,this._isLight=!1,this._isFreeze=!1,this._isBurn=!1,this._isRecover=!1,this.chuanShiKey="",this.chuanshiid="",this._dragonEffKey="",this.dragonEffid="",this.titleHash=new jl,this._CharMoveEnd_,this.tmpPt=new Uh,this._GridChangeHander_,i.__super.call(this),this.setup()}b(i,"zwc.engine.core.displays.world.char.Char",o);var e=i.prototype;return e._init_=function(){this._className_="zwc.engine.core.displays.Char"},e.resetCharHead=function(){this._charHead_.reset(this)},e.charHeadHide=function(){this._charHead_.hideHead()},e.setActSpeedUp=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),e?(this._actSpeedUpTime_=BB.getTimer(),this.actSpeedUpDealay=i,this.actSpeed=1+t,sH.playHurtImage(801,this.profession)):this.actSpeed=1,this._isActSpeedUp_=e},e.loadIcon=function(e){NR.loadIcon(e.toString(),ql.create(this,this.loadedIcon))},e.disposeIcon=function(){this.isRecover=!0,Zl.clearIconTexture(this.iconTextureSprite),this.iconTexture=null,this.iconTextureSprite&&(this.iconTextureSprite.texture=null),this.iconTextureSprite&&this.iconTextureSprite.parent&&this.removeChild(this.iconTextureSprite)},e.loadedIcon=function(e){var t=this;if(t.iconTexture=e){t.iconTextureSprite||(t.iconTextureSprite=new pp),Zl.addIconUse(t.iconTextureSprite,e.url);var i=40/(t.iconTextureSprite.texture=e).width,n=40/e.height;t.iconTextureSprite.scaleX=i,t.iconTextureSprite.scaleY=n,t.iconTextureSprite.x=-20,t.iconTextureSprite.y=-20,t.addChild(t.iconTextureSprite),-1==tt.ins.pickupItems.indexOf(e.url)&&tt.ins.pickupItems.push(e.url)}else t.iconTextureSprite&&t.iconTextureSprite.parent&&(t.removeChild(t.iconTextureSprite),Zl.clearIconTexture(t.iconTextureSprite))},e.showTopTexture=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.titleData||(this.titleData=new $l),e?(this.titleData.texture=e,this.titleData.offsetX=t,this.titleData.offsetY=i):this.titleData.texture=null},e.hideTopTexture=function(){this.titleData&&(this.titleData.texture=null)},e.alginTile=function(){this.setXY(this.point.x,this.point.y)},e.setup=function(){var e=this;e._charHead_=new LB,e._charHead_.color="#ffffff",(e._charHead_.owner=e)._charHead_.charBool=new CB,e._charHead_.charBool.setValue(100,100),(e._charHead_.charBool.owner=e)._charHead_.innerBool=new MB,e._charHead_.innerBool.setValue(100,100),(e._charHead_.innerBool.owner=e)._charHead_.innerBool.visible=!1,-1==zwc.engine.core.displays.world.char.Char.loopMovenQueue.indexOf(e)&&zwc.engine.core.displays.world.char.Char.loopMovenQueue.push(e),e.countTime=20+(100*Math.random()>>0),e._bodyHeight_=130},e.setDeath=function(){var e=this;if(UB.ins._playCharDeath(e),nH.removeCharBuff(e.char_id),e._isDeath_=!0,e.setCharBoolValue(0,e.maxHP),e.setCharBoolVisible(!1),e.timeOutDeath(),e.setCharInnerValue(0),e.setCharInnerVisible(!1),e._tarPoint_=null,e._movePath_.length=0,e._isRuning_=!1,e._colorFilterArray_.length=0,e.filters=null,e.isShowad=!1,e.killBlock(),e.layer=0,e.serverHp=null,0<e.effectPlayKey.length&&(e.removeEffect(e.effectPlayKey),e.effectPlayKey=""),e.titleArray)for(var t=0;t<e.titleArray.length;t++)e.removeEffect(e.titleArray[t]);NF.scene.bomLayer.addChild(e)},e.relive=function(e){var t=this;void 0===e&&(e=!0),t.removeReason.length=0,t._isDeath_=!1,t.actSpeed=BB.defaultActSpeed,t._isActSpeedUp_=!1,t.clearCharState(),t.lockMove=t.lockSkill=!1,e&&0<t.maxHP&&t.setCharBoolValue(t.maxHP,t.maxHP),t.setCharBoolVisible(!0),t.cid=uH.Ins().currCid,t.isShowad=!0,t.speed=280,t._charHead_.reset(t),t.play("stand"),t.isRecover=!1,t.graphics.clear(),t.data=null,t.visible=!0,t.alpha=1,t.lockMove=!1,t.lockSkill=!1,t.serverHp=null,t.InterruptsingSkillIdArr=[],Og.clearAll(t),t.clearTimeOutFun(),t.effectPlayKey="",t.titleArray&&0<t.titleArray.length&&t.showTitles(t.titleArray.slice())},e.setCharNameVisible=function(e){this._charHead_.charNameVisible=e},e.getCharNameVisible=function(){return this._charHead_.charNameVisible},e.setCharRelieveDesc=function(e){this._charHead_.relieveText=e},e.setCharProfessionNameVisible=function(e){this._charHead_.charProfessionNameVisible=e},e.getCharProfessionNameVisible=function(){return this._charHead_.charProfessionNameVisible},e.setCharFlyupNameVisible=function(e){this._charHead_.flyupNameVisible=e},e.getCharFlyupNameVisible=function(){return this._charHead_.flyupNameVisible},e.setOnlyHpBarVisible=function(e){this._charHead_.charBool.visible=e},e.setCharBoolVisible=function(e){this.setCharNameVisible(e),this._charHead_.charBool.visible=e},e.setCharInnerVisible=function(e){this._charHead_.innerBool.visible=e},e.setCharBoolValue=function(e,t){if(void 0===t&&(t=-1),-1==t&&(t=this._charHead_.charBool.maxValue),this._charHead_.charBool.setValue(e,t),0<this.hero_id&&e<=0&&0==aH.isZhanBaokMode&&0==ZN.isSynchScene()){if(dr.dtoEnterScene&&8==dr.dtoEnterScene.type&&this.relive(),dr.dtoEnterScene&&28==dr.dtoEnterScene.type&&this.relive(),dr.dtoEnterScene&&23==dr.dtoEnterScene.type)return;NF.Ins().isBossScene||this.relive()}},e.setCharInnerValue=function(e,t){void 0===t&&(t=-1),-1==t&&(t=this._charHead_.innerBool.maxValue),-1==e&&(e=this._charHead_.innerBool.currValue),this._charHead_.innerBool.setValue(e,t)},e.getCharInnerValue=function(){return this._charHead_.innerBool.currValue},e.setflyupName=function(e){this._charHead_.flyUpTitle=AR.ins.getSoaringNameColor(this.profession,e),this.titleArray&&this.titleArray.length&&this.showTitles(this.titleArray.slice())},e.updateTitles=function(){var e=this.titleArray.concat();this.showTitles(e)},e.showTitles=function(e){var t=this,i=40;if(t.titleArray)for(;t.titleArray.length;)t.removeEffect(t.titleArray.shift());t.titleArray=e;for(var n=!1,s=0;s<e.length;s++){var o=e[e.length-s-1],a=o;n||-1!=JB.TITLE_SPECIAL_IDS.indexOf(a)&&(n=!0),i=n&&1<e.length?60:40,t.loadEffect(o,Za.LAYER_BODY_TOP,a);var r=t.takeEffect(a);if(r){var l=0,c=10;0<=t.gov&&(l=10),t.getCharFlyupNameVisible()&&(c+=10),t.getCharProfessionNameVisible()&&(c+=10),r.offsetY=i*s+105+c+l}}},e.showPosition=function(e){this.gov=e,this._charHead_.govPosition=e},e.toBookTile=function(e,t,i){this._bookTile_&&(this._bookTile_.isBook=!1);var n=YH.instance.takeItem(e,t);n&&((this._bookTile_=n).isBook=!0)},e.unBookTile=function(){this._bookTile_&&(this._bookTile_.isBook=!1),this._bookTile_=null},e.toBookHeroTile=function(e,t){this._bookHeroTile_&&(this._bookHeroTile_.isBookHero=!1);var i=YH.instance.takeItem(e,t);i&&((this._bookHeroTile_=i).isBookHero=!0)},e.unBookHeroTile=function(){this._bookHeroTile_&&(this._bookHeroTile_.isBookHero=!1),this._bookHeroTile_=null},e.setPoisoning=function(e){if(e!=this._isPoisoning){if(this._isPoisoning=e)-1==this._colorFilterArray_.indexOf(i.POISONING_COLOR)&&this._colorFilterArray_.push(i.POISONING_COLOR);else{var t=this._colorFilterArray_.indexOf(i.POISONING_COLOR);this._colorFilterArray_.splice(t,1)}this.filters=this._colorFilterArray_}},e.setMabi=function(e){if(e!=this._isMabi){if(this._isMabi=e)-1==this._colorFilterArray_.indexOf(i.MABI_COLOR)&&this._colorFilterArray_.push(i.MABI_COLOR);else{var t=this._colorFilterArray_.indexOf(i.MABI_COLOR);this._colorFilterArray_.splice(t,1)}this.isPause=e,this.filters=this._colorFilterArray_}},e.setFreeze=function(e){e!=this._isFreeze&&((this._isFreeze=e)?this.freezeKey=this.loadEffect(this.freezeeEff,Za.LAYER_BODY_BOTTOM,null,!1,0,!0,"stand"):this.removeEffect(this.freezeKey),this.isPause=e)},e.setBurn=function(e){e!=this._isBurn&&((this._isBurn=e)?this.burnKey=this.loadEffect(this.burnEff,Za.LAYER_BODY_TOP,null,!1,0,!0,"stand"):this.removeEffect(this.burnKey))},e.setStun=function(e){e!=this._isStun&&((this._isStun=e)?this.stunKey=this.loadEffect(this.stunEff,Za.LAYER_BODY_TOP,null,!1,0,!0,"stand"):this.removeEffect(this.stunKey),this.isPause=e)},e.setMoZhuangDun=function(e){e!=this._isHasMoZhuangDun&&((this._isHasMoZhuangDun=e)?this._moZhuangDunKey=this.loadEffect(this._moZhuangDunEff,Za.LAYER_BODY_TOP,null,!1,0,!0,"stand"):this.removeEffect(this._moZhuangDunKey))},e.setShenmoDun=function(e){var t=this;e!=t._isHashenmoDun&&(e?0<BR.ins.curCopyId?(null!=t._shenmoDunKey&&""!=t._shenmoDunKey&&t.removeEffect(t._shenmoDunKey),t._shenmoDunKey=t.loadEffect(t._shenmoDunEff,Za.LAYER_BODY_TOP,null,!1,0,!1,"stand")):e=!1:(t.removeEffect(t._shenmoDunKey),t._shenmoDunKey=""),t._isHashenmoDun=e)},e.setLight=function(e){if(e!=this._isLight){if(this._isLight=e)-1==this._colorFilterArray_.indexOf(i.LIGHT_COLOR)&&this._colorFilterArray_.push(i.LIGHT_COLOR);else{var t=this._colorFilterArray_.indexOf(i.LIGHT_COLOR);this._colorFilterArray_.splice(t,1)}this.isPause=e,this.filters=this._colorFilterArray_}},e.getDretion=function(e,t,i,n){return VB.getDretion(e,t,i,n)},e.checkAndSetDir=function(e){var t=this;if(void 0===e&&(e=!1),t._tarPoint_){var i=PB.pixelsToTile(t.x,t.y),n=PB.pixelsToTile(t._tarPoint_.x,t._tarPoint_.y);t._isLoopMove_&&!e||(i.x!=n.x||i.y!=n.y||e)&&(t.x==t._tarPoint_.x&&t.y==t._tarPoint_.y||(t.dir=VB.getCharDir(t.x,t.y,t._tarPoint_.x,t._tarPoint_.y)))}},e.changeScene=function(){var e=this;e.isMabi&&e.setMabi(!1),e.isPauseAvatar&&e.pauseAvatar(-1,0),e.isPauseMove&&e.pauseMove(0),e.play("stand"),e._isRuning_=!1,e.isDeath=!1,e._stopMove_=!1,e._tarPoint_=null,e._movePath_.length=0,e._totalTime_=0,e.serverHp=null,""!=e._shenmoDunKey&&null!=e._shenmoDunKey&&e.removeEffect(e._shenmoDunKey),e._shenmoDunKey="",e._isHashenmoDun=!1,e.isStun&&e.setStun(!1)},e.pauseAct=function(e,t){o.prototype.play.call(this,e,1),this.doDelay(300,this,this.pauseAvatar,[1,t-300]),this.pauseMove(t)},e.loopMove=function(){var e=this;if(!e.isMabi&&!e.isStun&&!e.isPauseMove&&e._movePath_&&0<=e._movePath_.length&&e._isRuning_&&!e._isDeath_&&!e._stopMove_){var t=BB.getTimer();e._totalTime_+=t-e._loopMoveTime_,0<e._totalTime_&&e._tarPoint_&&e._tarMove_(),e._loopMoveTime_=BB.getTimer()}},e.gotoPoint=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0),i&&(this._isRuning_=!1,this._movePath_=[],this._tarPoint_=null),this.setXY(e,t),n&&this.play("stand")},e.stopMove=function(e,t,i){(void 0===e&&(e=!0),void 0===t&&(t=0),void 0===i&&(i=0),this._isRuning_=!1,this._movePath_=[],0<t&&0<i)&&(this._tarPoint_=null,70<ol.distance(new Uh(t,i),new Uh(this.x,this.y))&&this.setXY(t,i));e&&this.play("stand")},e.tarMoveTo=function(e,t){var i=this;if(void 0===t&&(t=!0),i.isDeath)i.moveEndHander();else if(i._tarPoint_=e.shift(),i._tarPoint_){PB.pixelsToTile(i._tarPoint_.x,i._tarPoint_.y),PB.pixelsToTile(i.x,i.y);i.checkAndSetDir(!0),i.updateWalkMode(),i.isCharMode?i.play("run",1):i.play("walk",1),i.setMoveSpeed(i.act),i._AUnit_.loadTextures(),i._movePath_=e,i._isRuning_=!0,i._totalTime_=0,i._loopMoveTime_=BB.getTimer(),i.loopMove()}else i.moveEndHander()},e.moveTo=function(e,t){var i=this;i._tarPoint_||(i._tarPoint_=new Uh),i._tarPoint_.x=e,i._tarPoint_.y=t,i._movePath_=[],i._isRuning_=!0,i._totalTime_=0,i._loopMoveTime_=BB.getTimer(),i.checkAndSetDir(),i.isCharMode?0==i.dir||4==i.dir?"walk"!=i.act&&"run"!=i.act&&i.play("walk"):i.isWalkMode?"walk"!=i.act&&"run"!=i.act&&i.play("walk"):"run"!=i.act&&"walk"!=i.act&&i.play("run"):i.play("walk"),i._AUnit_.loadTextures()},e.getKey=function(){var e=PB.pixelsToTile(this.x,this.y);return this.tileX_old=this.tileX,this.tileY_old=this.tileY,this.tileX=e.x,this.tileY=e.y,e.x+"_"+e.y},e.pixelsAlginTile=function(){this.x=80*Math.floor(this.x/80)+40,this.y=40*Math.floor(this.y/40)+20},e.distanceTo=function(e){return BB.distance(this.point,e)},e.moveToTile=function(e,t){var i=new Uh(e,t);PB.tileToPixels(i,i),this.moveTo(i.x,i.y)},e.updatePartXY=function(){},e.playSkill=function(e,t){this.lockMove=!0,this.lockMoveDelayTime=this.lockSkillDelayTime=t,this.play(e)},e.doLock=function(e){this.lockMove=!0,this.lockMoveDelayTime=e+BB.getTimer()},e.delayDo=function(e,t,i,n){G.timer.once(e,t,i,n,!1)},e.play=function(e,t,i,n){if(void 0===t&&(t=1),void 0===n&&(n=-1),this.isDeath&&"death"!=e)"death"!=this._AUnit_.currAct&&this._AUnit_.setCurrAct("death");else{if("death"==e){if(-1<HH.noPlayerDealth.indexOf(this.mid))return;if(7777==BR.ins.curCopyId||BB.isShaozhu()&&0<modules.copy.others.PigData.ins.PigCopyID)return G.timer.clearAll(this),void zN.recoverChar(this)}o.prototype.play.call(this,e,t,i,n),this.setMoveSpeed(e)}},e.setMoveSpeed=function(e){var t=this;t.isCharMode?"walk"==e?0==t.dir||4==t.dir?t._speed_=t.walkSpeed/2:t._speed_=t.walkSpeed:"run"==e&&(t.isWalkMode?0==t.dir||4==t.dir?t._speed_=t.walkSpeed/2:t._speed_=t.walkSpeed:0==t.dir||4==t.dir?t._speed_=t.walkSpeed:t._speed_=t.runSpeed):0==t.dir||4==t.dir?t._speed_=t.runSpeed/2:t._speed_=t.runSpeed},e.setXY=function(e,t){var i=this,n=i._Key_;i.x=e,i.y=t,i._Key_=i.getKey(),i.updateTileChars();var s=i._Key_;n!=s&&null!=i._GridChangeHander_&&i._GridChangeHander_.runWith(i),i.setBlock(n,s),i.setHeroBlock(n,s),o.prototype.setXY.call(i,e,t)},e.updateTileChars=function(){var e=this;if(NB.isSceneReady){if(WF._charGrids_[e.tileX_old]&&WF._charGrids_[e.tileX_old][e.tileY_old]){var t=WF._charGrids_[e.tileX_old][e.tileY_old],i=t.indexOf(e);i&&t.splice(i,1)}null==WF._charGrids_[e.tileX]&&(WF._charGrids_[e.tileX]=[]),null==WF._charGrids_[e.tileX][e.tileY]&&(WF._charGrids_[e.tileX][e.tileY]=[]);var n=WF._charGrids_[e.tileX][e.tileY];-1==n.indexOf(e)&&n.push(e)}},e.faceTo=function(e){e!=this&&e&&e.point&&!e.isDeath&&!e.isRecover&&(this.dir=this.getDretion(this.x,this.y,Object(e).point.x,Object(e).point.y))},e.facePoint=function(e){this.x==e.x&&this.y==e.y||(this.dir=this.getDretion(this.x,this.y,e.x,e.y))},e.showTopEffect=function(e,t,i){void 0===i&&(i=80),this.titleHash.put("topEffect",t),this.loadEffect(e,Za.LAYER_BODY_TOP,t),this.takeEffect(t).offsetY=i},e.removeTopEffect=function(e){this.titleHash.remove("topEffect"),this.removeEffect(e)},e.updateWalkMode=function(){var e=this,t=e.point,i=PB.pixelsAlginTile(e._tarPoint_.x,e._tarPoint_.y);0!=ol.distance(t,i)&&(0==e.dir||4==e.dir||(1==e.dir||3==e.dir||5==e.dir||7==e.dir)&&e.proto&&e.proto.hasOwnProperty("owner_char")&&Number(e.proto.owner_char),e.isWalkMode=!1)},e.moveEndHander=function(){if(this._isRuning_=!1,this.isLoopMove||this.stopMove(),null!=this._CharMoveEnd_){var e=this._CharMoveEnd_;this._CharMoveEnd_=null,e.run()}},e._tarMove_=function(){var e=this;if(null==e._tarPoint_||0==e._speed_||e._stopMove_)e.moveEndHander();else{var t=e._speed_;if(e.x==e._tarPoint_.x&&e.y==e._tarPoint_.y){if(!e._movePath_.length)return void e.moveEndHander();e._tarPoint_=e._movePath_.shift(),e.updateWalkMode();var i=VB.getCharDir(e.x,e.y,e._tarPoint_.x,e._tarPoint_.y);e._currDir_!=i&&(e.dir=i)}e.tmpPt.x=e.x,e.tmpPt.y=e.y;var n=ol.distance(e.tmpPt,e._tarPoint_),s=n/t*1e3;if(e._totalTime_>=s?e._totalTime_-=s:(s=e._totalTime_,e._totalTime_=0),0<s){var o=t*s/1e3/n,a=ol.interpolate(e._tarPoint_,e.tmpPt,o);e.tmpPt.x=e.x,e.tmpPt.y=e.y,5<=(n=ol.distance(e.tmpPt,e._tarPoint_))&&(e.setXY(a.x,a.y),e.isCharMode?"run"!=e.act&&e.play("run"):"walk"!=e.act&&e.play("walk"))}if(n<5)if((e._totalTime_=0)<e._movePath_.length){if(e._tarPoint_=e._movePath_.shift(),(n=ol.distance(e.tmpPt,e._tarPoint_))<5)return;PB.pixelsToTile(e.x,e.y).toString()!=PB.pixelsToTile(e._tarPoint_.x,e._tarPoint_.y).toString()&&(e.dir=VB.getCharDir(e.x,e.y,e._tarPoint_.x,e._tarPoint_.y),e.changeCharMoveAction(),e.updateWalkMode())}else 0==e._movePath_.length&&(e._tarPoint_=null,e.moveEndHander())}},e.killBlock=function(){var e=YH.instance.takeItemByKey(this._Key_);e&&(e.quoteIndex-=1,e.quoteIndex<=0&&(e.quoteIndex=0,e.walkType=e.initValue),this.type!=Za.HERO&&this.type!=Za.MAIN_CHAR||(e.heroQuoteIndex-=1,e.heroQuoteIndex<=0&&(e.heroQuoteIndex=0,e.heroType=e.initValue)))},e.setBlock=function(e,t,i){var n;if(void 0===i&&(i=!1),""!=e){if((n=YH.instance.takeItemByKey(e))&&i)return n.quoteIndex=0,void(n.walkType=n.initValue);n&&(n.quoteIndex-=1,n.quoteIndex<=0&&(n.quoteIndex=0,n.walkType=n.initValue))}""!=t&&(n=YH.instance.takeItemByKey(t))&&(n.quoteIndex+=1,n.walkType=0);var s=YH.instance.takeItemByKey(t);6!=this.hero_id&&e!=t&&s&&(s.isAlpha?this.type!=Za.MONSTER&&this.type!=Za.MONSTER_TRANSPORT||!this.isBoss?.6!=this.alpha&&(this.alpha=.6):this.alpha=1:1!=this.alpha&&(this.alpha=1))},e.setHeroBlock=function(e,t,i){if(void 0===i&&(i=!1),this.type==Za.HERO||this.type==Za.MAIN_CHAR){var n;if(""!=e){if((n=YH.instance.takeItemByKey(e))&&i)return n.heroQuoteIndex=0,void(n.heroType=n.initValue);n&&(n.heroQuoteIndex-=1,n.heroQuoteIndex<=0&&(n.heroQuoteIndex=0,n.heroType=n.initValue))}""!=t&&(n=YH.instance.takeItemByKey(t))&&(n.heroQuoteIndex+=1,n.heroType=0)}},e.checkGridSame=function(e){for(var t=NF.scene.midLayerQueue,i=0;i<t.length;i++){var n=t[i];if(n&&n.type!=Za.CHAR&&n.type!=Za.MAIN_CHAR&&n!=this&&0==n.isDisposed&&0==n.isDeath&&n.key==e)return!0}return!1},e.changeCharMoveAction=function(){var e=this;if(e._tarPoint_){var t=BB.distance(e._tarPoint_,new Uh(e.x,e.y));if(e.isCharMode?"run"!=e.act&&e.play("run",1):"walk"!=e.act&&e.play("walk",1),e.isCharMode){var i=0;i=0==e.dir||4==e.dir?80:160,e.isNeedChanegSpeed&&t<i?e.play("walk"):(0==e.dir||e.dir,e.isWalkMode?e.play("walk"):e.play("run"))}}},e.loop=function(){var e=this;e.isRecover||(BB.getTimer()-e._lockMoveTime_>e.lockMoveDelayTime&&e._lockMove&&(e.lockMove=!1,e._lockMoveTime_=BB.getTimer()),BB.getTimer()-e._actSpeedUpTime_>e.actSpeedUpDealay&&e._isActSpeedUp_&&(e._isActSpeedUp_=!1,e.actSpeed=1,e._actSpeedUpTime_=BB.getTimer()),BB.getTimer()-e._lockSkillTime_>e.lockSkillDelayTime&&e._locklSkill&&(e._locklSkill=!1,e._lockSkillTime_=BB.getTimer()))},e.getRunDir=function(){var e=this;if(!e._tarPoint_)return e.dir;var t=PB.pixelsToTile(e.x,e.y),i=PB.pixelsToTile(e._tarPoint_.x,e._tarPoint_.y);return t.toString()!=i.toString()?VB.getCharDir(e.x,e.y,e._tarPoint_.x,e._tarPoint_.y):e.dir},e.reset=function(){o.prototype.reset.call(this)},e.recover=function(){var e=this;if(nH.removeCharBuff(e.char_id),e.data=null,e.type,Za.TRANSPORT,e.owner_char=null,e.layer=1,e.actSpeed=BB.defaultActSpeed,e._isActSpeedUp_=!1,e.campState=e.camp=0,!(0<e.hero_id)){if(o.prototype.recover.call(e),e.setPoisoning(!1),e.setMabi(!1),e.ai&&(e.ai.stop(),e.ai.destory()),rH.removeAI(e),e.stopMove(),e.titleHash){for(var t in e.titleHash.proto)e.removeTopEffect(t);e.titleHash.reset()}if(e.titleArray){for(var i=0;i<e.titleArray.length;i++)e.titleArray[i];e.titleArray.length=0}e.ai=null,e.filters=null,e.disposeIcon(),e.renderInSelf=!1,e.titleData&&(e.titleData.texture=null),e.titleData=null,e._bookTile_&&(e._bookTile_.isBook=!1),e._bookTile_=null,e._bookHeroTile_&&(e._bookHeroTile_.isBookHero=!1),e._bookHeroTile_=null,e.effectHash.reset(),e.isOffline=!1,e.playSkillData=null,e._bookTile_=null,e.isAres=!1,e.isBoss=!1,e.isElites=!1,e.owner_char=null,e.char_id=null,e.hero_id=-1,e.stopDurTime=0,e.isMainChar=!1,e.isLoopMove=!1,e._point_=null,e._lookDir_=0,e._tarPoint_=null,e._movePath_.length=0,e._totalTime_=0,e._loopMoveTime_=0,e._isCharMode_=!0,e.hoeTimeIndex=0,e._isLoopMove_=!1,e._isWalkMode_=!1,e._key_,e._isMainChar_=!1,e._lockMove=!1,e._locklSkill=!1,e._isRuning_=!1,e._isDeath_=!1,e._stopMove_=!1,e._lockMoveTime_=0,e._lockSkillTime_=0,e.profession=1,e.scaleX=1,e.scaleY=1,e.sex=1,e._char_name_="",e._bodyHeight_=130,e.setTimeoutIndex=0,e.countTime=0,e._currDir_=0,e.lockMoveDelayTime=1200,e.lockSkillDelayTime=1200,e.selectEnabled=!0,e.selectTarget=null,e.isCharMode=!1,e.isRecover=!0,e.mid="",e.wid="",e.wgid="",e.eid="",e._currAct_="stand",e.actSpeedUpDealay=0,e._isActSpeedUp_=!1,e.speed=180,e._charHead_.recover(),e._movePath_=[],e.removeReason=[],G.timer.clearAll(e),Og.clearTween(e),e.isOwner=!0,e.objectId=0,e.serverHp=null,e.removeEffect(Aa.EFFECT_MOFADUN),""!=e._shenmoDunKey&&null!=e._shenmoDunKey&&e.removeEffect(e._shenmoDunKey),e._isHashenmoDun=!1,e._shenmoDunKey=""}},e.dispose=function(){this._bookTile_&&(this._bookTile_.isBook=!1),this._bookTile_=null,this._bookHeroTile_&&(this._bookHeroTile_.isBookHero=!1),this._bookHeroTile_=null},e.doOnHurt=function(e,t,i,n,s,o){void 0===n&&(n=!1),void 0===s&&(s=0),void 0===o&&(o=0),sH.onHurt(e,t,i,n,s,o)},e.doAddHurtImage=function(e,t,i,n,s,o,a,r,l){if(void 0===i&&(i=-1),void 0===n&&(n=0),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===r&&(r=!0),G.stage.isVisibility){var c=0;if(o||(s&&e.serverHp&&e.serverHp.time<s&&(this.setCharBoolValue(e.serverHp.hp),e.serverHp=null),(c=2==i||9==i||13==i||19==i?this.currHp+t:3==i?(l.currHp=l.currHp-t,e.currHp):this.currHp-t)<=0&&(c=0),this._isDeath_||(this.setCharBoolVisible(!0),this.setCharBoolValue(c)),e.objectId!=NF.mainChar.objectId&&e.type!=Za.HERO||e.currHp!=e.maxHP&&(e.proto.currHP=c,Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:c,heroId:e.hero_id})),l&&l.objectId==NF.mainChar.objectId&&(l.currHp<=0&&(l.setCharBoolVisible(!0),l.setCharBoolValue(0)),l.currHp!=l.maxHP&&(l.proto.currHP=c,Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:c,heroId:l.hero_id})))),e.type==Za.MONSTER)var u=parseInt(Object(e.data).modelId);e.currHp<=0?(jN.getInstance().clear(e),10==i||11==i||12==i?(e.doDelay(300,e,e.timeOutDead),e.doDelay(1200,e,e.doFightCtrlSetDeath,[e])):26==i||27==i||28==i?(e.doDelay(300,e,e.timeOutDead),e.doDelay(1200,e,e.doFightCtrlSetDeath,[e])):(e.doDelay(300,e,e.timeOutDead),e.doDelay(500,e,e.doFightCtrlSetDeath,[e])),e.type==Za.MONSTER&&UB.ins._playMonsterSound(u,3)):e.type==Za.MONSTER&&UB.ins._playMonsterSound(u,2),0<t&&(r?sH.addHurtImage(e,t,i,n,a):NF.scene.hurtLayer.numChildren<41&&sH.addHurtImage(e,t,i,n,a))}},e.timeOutDead=function(){var e=this;e._AUnit_.isPauseFrame=!1,e._isDeath_||(e.setDeath(),e.play("death")),e.doDelay(500,e,e.timeOutDeath),jN.getInstance().clear(e),e.doDelay(500,e,e.doFightCtrlSetDeath,[e])},e.clearTimeOutFun=function(){G.timer.clear(this,this.timeOutDead),G.timer.clear(this,this.doFightCtrlSetDeath),G.timer.clear(this,this.doAddHurtImage),G.timer.clear(this,this.pauseAvatar)},e.timeOutDeath=function(){var e=this;if(e._charHead_&&e._charHead_.charBool){var t=e._charHead_.charBool.maxValue;e._charHead_.charBool.setValue(0,t)}e.setCharBoolVisible(!1),e.removeEffect(Aa.EFFECT_MOFADUN),e.removeEffect(e._moZhuangDunEff),e.char_id==gR.ins.charId&&Tu.sendToModule("UpdateCurrHP",["modules.actor.ActorModule","modules.nav.NavModule","modules.copy.CopyModule"],{hp:0,heroId:e.hero_id})},e.doFightCtrlSetDeath=function(e){sH.setDeath(e)},e.doDeathRemoveChar=function(e){uH.Ins().removeChar(e)},e.doSceneBossAddHurtImage=function(e,t,i){void 0===i&&(i=-1),nF.addHurtImage(e,t,i)},e.doFightEffectUtilsPlayNormalSkillEnd=function(e,t,i,n){void 0===n&&(n=0),0<=this.InterruptsingSkillIdArr.indexOf(n)||(0<this.hero_id&&(0<=Aa.UNION_SKILL.indexOf(n)||0<=Aa.ZHUI_JI_SKILLIDS_ARR.indexOf(n))&&ZN.toShake(),oH.playNormalSkillEnd(e,t,i,n))},e.doZhanBaoCtrlAddHurtImage=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),aH.addHurtImage(e,t,i,n)},e.doZhanBaoCtrlPlayHurt=function(e,t,i){void 0===i&&(i=0),aH.getInstance().playHurt(e,t,i)},e.doZhanBaoCtrlCurrPlayStateEnd=function(){aH.getInstance().currPlayStateEnd()},e.delayPickup=function(){this.type!=Za.PICKUP_ITEM&&this.type!=Za.PICKUP_GOLD||(this.selectEnabled=!0)},e.clearTweenFunc=function(){Og.clearAll(this)},e.sayWord=function(e){e&&this._charHead_&&this._charHead_.sayWord(e)},e.removeShiFaEff=function(){},e.setChuanShiEffect=function(e){e!=this.chuanshiid&&this.removeEffect(this.chuanShiKey),e&&(this.chuanShiKey=this.loadEffect(e,Za.LAYER_BODY_BOTTOM,null,!1,0,!0,"stand")),this.chuanshiid=e},e.setTianHuangLongWu=function(e){e!=this.dragonEffid&&this.removeEffect(this._dragonEffKey),e&&(this._dragonEffKey=this.loadEffect(e,Za.LAYER_BODY_TOP,null,!1,0,!0,"stand")),this.dragonEffid=e},e.clearCharState=function(){this.setMabi(!1),this.setPoisoning(!1),this.setFreeze(!1),this.setBurn(!1),this.setMoZhuangDun(!1),this.setStun(!1)},p(0,e,"isPoisoning",function(){return this._isPoisoning}),p(0,e,"lockMove",function(){return this._lockMove||this._AUnit_.lockPlaywarm},function(e){e&&(this._lockMoveTime_=BB.getTimer()),this._lockMove=e,this.type==Za.MAIN_CHAR&&e&&(this.lockTime_=BB.getTimer())}),p(0,e,"tarPoint_",function(){return this._tarPoint_},function(e){var t;this.type!=Za.MAIN_CHAR&&this.type!=Za.HERO||(t=e?PB.pixelsToTile(e.x,e.y):PB.pixelsToTile(this._tarPoint_.x,this._tarPoint_.y),this.toBookHeroTile(t.x,t.y));this._tarPoint_=e}),p(0,e,"lock",function(){return this._lockMove||this._locklSkill}),p(0,e,"lockSkill",function(){return this._locklSkill},function(e){e&&(this._lockSkillTime_=BB.getTimer()),this._locklSkill=e}),p(0,e,"actSpeed",o.prototype._$get_actSpeed,function(e){G.superSet(uq,this,"actSpeed",e)}),p(0,e,"currHp",function(){return this._charHead_.charBool.currValue},function(e){this._charHead_.charBool.currValue=e}),p(0,e,"char_name",function(){return this._charHead_.text},function(e){this._charHead_.text=e,this.titleArray&&this.titleArray.length&&this.showTitles(this.titleArray.slice())}),p(0,e,"isDeath",o.prototype._$get_isDeath,function(e){this._isDeath_=e,this.unBookTile(),this.unBookHeroTile()}),p(0,e,"isHashenmoDun",function(){return this._isHashenmoDun}),p(0,e,"maxHP",function(){return this._charHead_.charBool.maxValue},function(e){this._charHead_.charBool.maxValue=e}),p(0,e,"dir",function(){return this._AUnit_?(this.lockSkill||(this._currDir_=this._AUnit_.currDir),this._AUnit_.currDir):0},function(e){this._currDir_=e,this.setDir(e)}),p(0,e,"charProfessionName",function(){return this._charHead_.professionText},function(e){this._charHead_.professionText=e,this.titleArray&&this.titleArray.length&&this.showTitles(this.titleArray.slice())}),p(0,e,"bodyHeight",function(){return this._charHead_.bodyHeight},function(e){this._charHead_.bodyHeight=e}),p(0,e,"charNameColor",null,function(e){this._charHead_.color=e}),p(0,e,"charProfessionNameColor",null,function(e){this._charHead_.professionColor=e}),p(0,e,"speed",function(){return this._speed_},function(e){this._speed_=e,this.runSpeed=e,this.walkSpeed=e/2,this._speed_=e}),p(0,e,"isRuning",function(){return this._isRuning_}),p(0,e,"isMabi",function(){return this._isMabi}),p(0,e,"isFreeze",function(){return this._isFreeze}),p(0,e,"isBurn",function(){return this._isBurn}),p(0,e,"isStun",function(){return this._isStun}),p(0,e,"isLight",function(){return this._isLight}),p(0,e,"isHasMoZhuangDun",function(){return this._isHasMoZhuangDun}),p(0,e,"filters",o.prototype._$get_filters,function(e){G.superSet(uq,this,"filters",e)}),p(0,e,"isCharMode",function(){return this._isCharMode_},function(e){this._isCharMode_=e,this._AUnit_&&(this._AUnit_.isCharMode=e)}),p(0,e,"isWalkMode",function(){return this._isWalkMode_},function(e){this.isCharMode&&(this._isWalkMode_=e,this.changeCharMoveAction())}),p(0,e,"isRecover",function(){return this._isRecover},function(e){this._isRecover=e,this._charHead_.isRecover=e}),p(0,e,"act",function(){return this._currAct_},function(e){this.isDeath&&"death"!=e||this._currAct_!=e&&(this._AUnit_.setCurrFrame(0),this._currAct_=e,this._AUnit_&&this._AUnit_.setCurrAct(e))}),p(0,e,"key",function(){return this._key_}),p(0,e,"tilePoint",function(){var e=parseInt((this.x/80).toString()),t=parseInt((this.y/40).toString());return new Uh(e,t)}),p(0,e,"point",function(){var e=80*parseInt((this.x/80).toString())+40,t=40*parseInt((this.y/40).toString())+20;return this._point_=new Uh,this._point_.x=e,this._point_.y=t,this._point_}),p(0,e,"x",o.prototype._$get_x,function(e){G.superSet(uq,this,"x",e)}),p(0,e,"y",o.prototype._$get_y,function(e){G.superSet(uq,this,"y",e)}),i.loopMoveHander=function(){for(var e=0;e<zwc.engine.core.displays.world.char.Char.loopMovenQueue.length;e++){var t=zwc.engine.core.displays.world.char.Char.loopMovenQueue[e];t.loopMove(),t.loop()}},i.loopMovenQueue=[],f(i,["POISONING_COLOR",function(){return this.POISONING_COLOR=new ys([1,0,0,0,-150,0,1,0,0,-10,0,0,1,0,-110,0,0,0,1,0])},"MABI_COLOR",function(){return this.MABI_COLOR=new ys([.3086,.6094,.082,0,40,.3086,.6094,.082,0,40,.3086,.6094,.082,0,40,0,0,0,1,0])},"LIGHT_COLOR",function(){return this.LIGHT_COLOR=new ys([1,0,0,0,-50,0,1,0,0,-50,0,0,1,0,-50,0,0,0,1,0])},"FREEZE_COLOR",function(){return this.FREEZE_COLOR=new ys([.3086,.6094,.082,0,40,.3086,.6094,.082,0,40,.3086,.6094,.082,0,40,0,0,0,1,0])}]),i}(uq),Ij=function(t){function e(){this._asset=null,e.__super.call(this)}b(e,"modules.fight.views.Fight_Attack_Mask",t);var i=e.prototype;return i.loadAsset=function(){if(!this._asset){var e=_r.getAtlasSubPath("fightresult/mask-img-mask720.png");this._asset=GB.retain(e),this._asset.on("complete",this,this.onLoadComplete)}},i.onLoadComplete=function(e){var t=e.getRes();t.width==G.stage.width&&t.height==G.stage.height?this.graphics.drawTexture(t,0,0,t.width,t.height):Cl.draw9Grid(this.graphics,t,0,0,G.stage.width,G.stage.height,[600,300,600,300])},i.clearAsset=function(){this._asset&&(this._asset.off("complete",this,this.onLoadComplete),GB.release(this._asset),this._asset=null)},i.fadeShow=function(e){void 0===e&&(e=!1),this.loadAsset(),this.visible=!0,this.alpha=0,Og.clearAll(this),Og.to(this,{alpha:1},200),Og.to(this,{alpha:0},200,null,ql.create(this,this.onFadeHideComplete,[e]),500)},i.onFadeHideComplete=function(e){this.visible=!1,e&&(this.removeSelf(),this.clearAsset())},i.destroy=function(e){void 0===e&&(e=!0),this.clearAsset(),t.prototype.destroy.call(this,!0)},e}(Vg),bj=function(e){function t(){this._panelId=null,t.__super.call(this),this.alpha=.8,this.mouseEnabled=!0}b(t,"modules.gui.views.commonui.PanelMask",Vg);var i=t.prototype;return i.show=function(e,t){var i=this;void 0===t&&(t=!1),e.parent||console.log("panel must has parent"),e.on("removed",i,i.onPanelRemoved),i._panelId=hN.ins._getPanelId(e),i.size(G.stage.width,G.stage.height),i.graphics.clear(),i.graphics.drawRect(0,0,i.width,i.height,"#000000"),e.parent.addChildAt(i,e.parent.getChildIndex(e)),t?i.on("click",i,i.onClick):i.off("click",i,i.onClick)},i.onPanelRemoved=function(){this.removeSelf(),this._panelId=null},i.onClick=function(){this.removeSelf(),this._panelId&&hN.ins.close(this._panelId),this._panelId=null},p(1,t,"ins",function(){return t._ins||(t._ins=new t)},laya.ui.View._$SET_ins),t._ins=null,t}(),wj=function(t){function d(e,t,i,n,s,o,a,r,l,c){var u=this;u._container=null,u.isCenter=!1,void 0===i&&(i=116),void 0===n&&(n=10),void 0===s&&(s=30),void 0===o&&(o=!0),void 0===r&&(r=0),void 0===l&&(l=!1),void 0===c&&(c=!0),d.__super.call(u),u.vScrollBarSkin="",u.vScrollBar.elasticDistance=300,u._container=new DF(e,t,i,n,s,o,a,c),u._container.x=4,u._container.gsimpleName=l,u.addChild(u._container),u.width=t*(116+n)-n+8,u.height=e*(116+s)-(o?16:s)+r}b(d,"modules.backpack.views.item.GridPanel",t);var e=d.prototype;return e.onScrollBarChange=function(e){t.prototype.onScrollBarChange.call(this,e),this._container.onScroll()},e.destroy=function(e){void 0===e&&(e=!0),null!=this._container&&this._container.destroy(e),this._container=null,t.prototype.destroy.call(this,e)},p(0,e,"isClearUrl",null,function(e){this._container.isClearUrl=e}),p(0,e,"owerModule",null,function(e){this._container.owerModule=e}),p(0,e,"isShowJob",null,function(e){this._container.isShowJob=e}),p(0,e,"contentW",function(){return this._container.width+2*this._container.x}),p(0,e,"gridDatas",function(){return this._container.gridDatas},function(e){this._container.gridDatas=e,this.refresh(),this.isCenter&&(this._container.x=(this.width-this._container.width)/2)}),p(0,e,"resetPosY",null,function(e){this._container.resetPosY=e}),d}(Eh),xj=function(t){function e(){this._Image=null,this.txt_Des=null,this.txt_Loading=null,this.isInit=!1,e.__super.call(this)}b(e,"modules.login.views.FirstLoadingView",t,"FirstLoadingView$1");var i=e.prototype;return i.inteUI=function(){var e=this;e.isInit||(e.width=720,e.height=450,e.txt_Des=new Yp,e.txt_Des.fontSize=24,e.txt_Des.color="#c8c4c4",e.txt_Des.width=720,e.txt_Des.align="center",e.txt_Des.text=RP.n[265],e.txt_Des.pos(0,220),e.addChild(e.txt_Des),e.txt_Loading=new Yp,e.txt_Loading.fontSize=24,e.txt_Loading.color="#f48d09",e.txt_Loading.width=720,e.txt_Loading.align="center",e.txt_Loading.text=RP.n[266],e.txt_Loading.pos(0,275),e.addChild(e.txt_Loading),e.centerX=0,e.centerY=0,e.isInit=!0)},i.isShowing=function(){return null!=this.parent},i.show=function(){this.resize(),this.inteUI(),G.stage.addChild(this)},i.setLoading=function(e,t){void 0===t&&(t="");""!=t&&(this.txt_Loading.text=RP.n[267])},i.resize=function(){this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},i.destroy=function(e){void 0===e&&(e=!0),this.txt_Des.text="",this.txt_Loading.text="",this.txt_Des.visible=!1,this.removeChild(this.txt_Des),this.txt_Des=null,t.prototype.destroy.call(this,e)},e}(Vg),Sj=function(e){function t(){this.hdv_des=null,this.btn_close=null,t.__super.call(this)}b(t,"modules.loginnotice.views.LoginNoticeMV",Vg);var i=t.prototype;return i.createChildren=function(){Vg.regComponent("Text",Yp),Vg.regComponent("HTMLDivElement",Fl),laya.ui.Component.prototype.createChildren.call(this),this.createView(t.uiView)},i.initialize=function(){var e=this;e.centerX=e.centerY=0,e.hdv_des.style.font="SimHei",e.hdv_des.style.fontSize=26,e.hdv_des.style.align="left",e.hdv_des.style.color="#a19980",e.hdv_des.height=800,e.btn_close.clickHandler=ql.create(e,e.close,null,!1)},i.showNotice=function(e){this.hdv_des.innerHTML=e,this.parent||(eq.panelLayer?(eq.panelLayer.once("MASK_CLOSE",this,this.onClick),eq.panelLayer.open(this,!1,!0)):G.stage.addChild(this))},i.onClick=function(e){this.close()},i.close=function(){eq.panelLayer?eq.panelLayer.close(this):this.parent&&this.parent.removeChild(this)},p(1,t,"ins",function(){return t._instance||(t._instance=new t),t._instance},laya.ui.View._$SET_ins),t._instance=null,t.uiView={type:"View",props:{width:420,height:620},child:[{type:"Image",props:{y:0,x:0,width:420,skin:"ui/layouts/login/comp_img_2.png",sizeGrid:"20,20,20,20",height:620}},{type:"Image",props:{y:0,x:0,width:420,top:0,skin:"ui/layouts/login/comp_tittle_2.png",sizeGrid:"0,70,0,70",height:65}},{type:"Box",props:{y:0,x:0,width:658,height:24,centerX:0,bottom:-30},child:[{type:"Image",props:{y:5,x:122,width:77,skin:"ui/layouts/login/comp_symbol_line.png",height:15}},{type:"Image",props:{y:5,x:539,width:80,skin:"ui/layouts/login/comp_symbol_line.png",scaleX:-1,height:15}},{type:"Text",props:{x:210,text:"点击空白区域关闭窗口",fontSize:24,font:"SimHei",color:"#65533e"}}]},{type:"Image",props:{y:77,x:25,width:370,skin:"ui/layouts/login/comp_img_2laye.png",height:520,sizeGrid:"54,48,58,46"}},{type:"HTMLDivElement",props:{y:86,x:35,width:350,var:"hdv_des",innerHTML:"htmlText",height:500}},{type:"Button",props:{y:4,x:312,var:"btn_close",stateNum:2,skin:"ui/layouts/login/btn_close.png"}}]},t}(),kj=function(t){function i(){var e=this;e._addBtn=null,e._minuesBtn=null,e._minBtn=null,e._maxBtn=null,e.txt_count=null,e._curNum=0,e._minNum=0,e._maxNum=0,e._stepNum=0,e._mouseDown=!1,e._operateType=0,e._mallKey=0,i.__super.call(e)}b(i,"modules.mall.views.item.QuickBuyComponent",t);var e=i.prototype;return e.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this),this.createView(i.uiView)},e.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e._minBtn.name="_minBtn",e._maxBtn.name="_maxBtn",e._addBtn.name="_addBtn",e._minuesBtn.name="_minuesBtn",e._minBtn.label="",e._maxBtn.label="",e._addBtn.clickHandler=ql.create(e,e.changeHandler,[0],!1),e._minuesBtn.clickHandler=ql.create(e,e.changeHandler,[1],!1),e._minBtn.clickHandler=ql.create(e,e.changeHandler,[2],!1),e._maxBtn.clickHandler=ql.create(e,e.changeHandler,[3],!1),e.on("mousedown",e,e.onMouseDownHandler),e.on("mouseup",e,e.onMouseUpHandler),e.on("mouseout",e,e.onMouseUpHandler)},e.onMouseUpHandler=function(e){G.timer.clear(this,this.checkMouseDown),G.timer.clear(this,this.changeHandler)},e.onMouseDownHandler=function(e){if(e.target instanceof laya.ui.Button){switch(e.target.name){case"_minBtn":this._operateType=2;break;case"_maxBtn":this._operateType=3;break;case"_addBtn":this._operateType=0;break;case"_minuesBtn":this._operateType=1}this._mouseDown=!0,G.timer.once(500,this,this.checkMouseDown)}},e.checkMouseDown=function(){this._mouseDown&&G.timer.loop(150,this,this.changeHandler,[this._operateType])},e.changeHandler=function(e){var t=this;switch(void 0===e&&(e=-1),e){case 0:t._curNum>=t._maxNum&&-1!=t._maxNum?t._curNum=t._maxNum:t._curNum+1>t.getCurMaxNum()?(t._curNum=t.getCurMaxNum(),t._curNum=0==t._curNum?1:t._curNum):t._curNum=t._curNum+1;break;case 1:t._curNum<=1?t._curNum=t._minNum:--t._curNum;break;case 2:t._curNum-t._stepNum<1?t._curNum=t._minNum:t._curNum=t._curNum-t._stepNum;break;case 3:t._curNum+t._stepNum>t._maxNum&&-1!=t._maxNum?t._curNum=t._maxNum:t._curNum+t._stepNum>t.getCurMaxNum()?(t._curNum=t.getCurMaxNum(),t._curNum=0==t._curNum?1:t._curNum):t._curNum=t._curNum+t._stepNum}t.txt_count.text=t._curNum+"",t.event("num_change",t._curNum)},e.getCurMaxNum=function(){if(-1==this._mallKey)return 0;var e=Nn.getIndex(this._mallKey);if(-1==e)return 0;var t,i,n=0;return t=Nn.MODEL.price(e),2==(i=Nn.MODEL.currencyType(e))?n=Math.floor(gR.ins.YB/t):3==i?n=Math.floor(gR.ins.coin/t):4==i&&(n=Math.floor(gR.ins.ZJ/t)),n},e.bindData=function(e,t,i,n){void 0===e&&(e=1),void 0===t&&(t=99),void 0===i&&(i=-1),void 0===n&&(n=10),this._curNum=0,this._minNum=e,this._maxNum=t,this._stepNum=n,this._mallKey=i,this.changeHandler(0)},e.destroy=function(e){void 0===e&&(e=!0),G.timer.clearAll(this),t.prototype.destroy.call(this,e)},p(0,e,"curNum",null,function(e){this._curNum=e,this.txt_count.text=this._curNum+"",this.event("num_change",this._curNum)}),i.NUM_CHANGE="num_change",i.ADD_TYPE=0,i.MINUSE_TYPE=1,i.MIN_TYPE=2,i.MAX_TYPE=3,i.uiView={type:"View",props:{width:443,height:52},child:[{type:"Button",props:{x:317,var:"_addBtn",top:-8,stateNum:2,skin:"ui/layouts/basic_ui_b2/ty_btn_zj.png"}},{type:"Button",props:{x:55,var:"_minuesBtn",top:-8,stateNum:2,skin:"ui/layouts/basic_ui_b2/ty_btn_js.png"}},{type:"Button",props:{var:"_minBtn",top:0,stateNum:2,skin:"ui/layouts/basic_ui_b/sc_btn_10j.png",left:0}},{type:"Button",props:{x:388,var:"_maxBtn",top:0,stateNum:2,skin:"ui/layouts/basic_ui_b/sc_btn_10z.png"}},{type:"Image",props:{y:0,x:133,width:177,skin:"ui/layouts/basic_ui_g/ty_jm_szbk.png",sizeGrid:"14,14,14,14",height:50}},{type:"Label",props:{x:140,width:163,var:"txt_count",top:9,text:"10",height:33,fontSize:30,font:"SimHei",color:"#e3dcc2",align:"center"}}]},i}(Vg),Ej=function(n){function t(){var e=this;e._list=null,e._totH=0,e.lock=!1,e.showMax=10,e.rect=new u_,t.__super.call(e),e.vScrollBarSkin="",e.vScrollBar.isVertical=!0,e.vScrollBar.elasticDistance=30,e._list=[],e.vScrollBar.on("change",e,e._$6_onScrollBarChange)}b(t,"modules.chat.views.ChatInfoUI",n);var e=t.prototype;return e._$6_onScrollBarChange=function(){for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];i&&(i.visible=this.isVisible(i))}},e.onDisplay=function(){this.refreshInfo(QB.ins.getCurChatInfo())},e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e),this._list=null},e.refresh=function(){this.runCallLater(this.changeSize),n.prototype.refresh.call(this)},e.changeSize=function(){n.prototype.changeSize.call(this),this._totH=0;for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];i.width=this.width,i.y=this._totH,i.invalid(),i.height=i.textHeight+2,this._totH+=i.textHeight+20}},e.adjustPos=function(){this._totH=0;for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];i.y=this._totH,this._totH+=i.textHeight+20}},e.clear=function(){this._content.removeChildren();for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];Mj.recover(i)}this._list=[],this._totH=0,this.vScrollBar.max=1,this.vScrollBar.value=0},e.pushInfos=function(e){for(var t=e.length,i=0;i<t;i++){var n=e[i],s=Mj.create();s.x=0,s.color="#e0d6c1",s.width=this.width,s.innerHTML=n.showStr,s.y=this._totH,this._totH+=s.textHeight+20,this.addChild(s),this._list.push(s)}this.refresh()},e.refreshInfo=function(e){this.vScrollBar.value;this.clear(),this.pushInfos(e),this.lock||(this.vScrollBar.value=this.vScrollBar.max)},e.pushAInfo=function(e){var t=this;if(null!=e){var i=t.vScrollBar.value;if(t._list.length>=t.showMax){var n=t._list.shift();n.removeSelf(),Mj.recover(n),t.adjustPos()}var s=Mj.create();s.color="#e0d6c1",s.x=0,s.width=t.width,s.innerHTML=e.showStr,s.y=t._totH,s.visible=t.isVisible(s),t._totH+=s.textHeight+20,t.addChild(s),t._list.push(s),t.refresh(),t.lock?t.vScrollBar.value=i:t.vScrollBar.value=t.vScrollBar.max}},e.isVisible=function(e){return e.y>=this.vScrollBar.value&&e.y<=this.height+this.vScrollBar.value||e.y+e.height>=this.vScrollBar.value&&e.y+e.height<=this.height+this.vScrollBar.value},p(1,t,"ins",function(){return t._inst=t._inst||new t},laya.ui.Panel._$SET_ins),t._inst=null,t}(Eh),Tj=function(e){function t(){this._arrow=null,this._num=null,t.__super.call(this,_r.getAtlasSubPath("basic_ui/numsl.png")),this._min=1,this._bar.stateNum=1,this._arrow=kB.createImage(_r.getAtlasSubPath("basic_ui/numsl$arrow.png"),0,0,0,0,this),this._num=kB.createText(0,0,72,0,"",24,"#e3dcc2",!1,"center",!1,!1,this)}b(t,"modules.backpack.views.item.NumSelector",Gl);var i=t.prototype;return i.showValueText=function(){var e=this;e.showLabel?(e._num.changeText(e._value+""),e._arrow.x=e._bar.x+(e._bar.width-e._arrow.width>>1),e._arrow.y=e._bar.y-18,e._num.x=e._bar.x+(e._bar.width-e._num.width>>1),e._num.y=e._bar.y-45):(e._arrow&&e._arrow.destroy(!0),e._arrow=null)},i.hideValueText=function(){},i.changeValue=function(){laya.ui.Slider.prototype.changeValue.call(this),this.showValueText()},t}(),Cj=function(t){function r(){var e=this;e._datas=null,e._array=null,e._h=NaN,e._spaceY=10,e._pre=null,e._maxv=-1,e._allrender=!1,r.__super.call(e),e._array=[],e._datas=[],e._h=0}b(r,"modules.title.views.TitlePanel",t);var e=r.prototype;return e.toggleClose=function(){this._pre&&(this._pre.toggle=!1,this._pre=null),this.scrollTo(0,0)},e.changeSize=function(){t.prototype.changeSize.call(this),this._maxv=-1},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._datas=null,this._array=null},e.onScrollBarChange=function(e){t.prototype.onScrollBarChange.call(this,e),this._allrender||this.callLater(this.renderCells)},e.renderCells=function(){var e=this,t=e._content.scrollRect;if(!(t.y<=e._maxv)){e._maxv=t.y,e.runCallLater(e.changeSize);var i=e._datas.length,n=0,s=0;e._allrender=!0;for(var o=0;o<i;o++){0<o&&(n+=e._spaceY);var a=e._array[o];a?s=n+a.height:(s=n+r.defH,e._allrender=!1),s>=t.y&&n<t.y+t.height&&null==a&&(a=new R1,e.addChild(a),a.update(e._datas[o]),a.on("change",e,e.onChange),e._array[o]=a),a&&(a.y=n,a.x=0),n=s}e._h!=n&&(e._h=n,e.refresh()),e._h=n}},e.onChange=function(e){null==this._pre?this._pre=e:this._pre==e?this._pre=null:(this._pre.toggle=!1,this._pre=e),this._maxv=-1,this.callLater(this.renderCells)},p(0,e,"datas",null,function(e){var t=this;null==e&&(e=[]),t._datas=e,t.removeChildren();var i=t._datas.length;t._array.length=i;for(var n=0;n<i;n++){var s=t._array[n];s&&(s.update(t._datas[n]),t.addChild(s))}t._maxv=-1,t.callLater(t.renderCells)}),p(0,e,"contentHeight",function(){return this.runCallLater(this.renderCells),this._h}),r.defH=50,r}(Eh),Lj=function(e){function t(){t.__super.call(this)}return b(t,"modules.actor.views.mo.MoBreakEquipGrid",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){if(e){G.superSet(pj,this,"dataSource",e.dto);var t=KH.create(this.dto.goodsId);this.grid.bindData=t,this.grid.mouseEnabled=!1,null!=e.effect&&(this.grid.needEffect=e.effect),this.selected=e.selected}}),t}(pj),Mj=function(e){function t(){var e=this;e._disposed=!1,t.__super.call(e),e.font="Microsoft YaHei",e.fontSize=20,e.color="#a19980",e.leading=6,e.valign="top",e.on("link",e,e.onLink)}b(t,"modules.chat.views.ChatRecord",e);var i=t.prototype;return i.onLink=function(e){hN.ins.isOpen("CHAT")&&QB.ins.linkHandler(e)},i.relive=function(){this._disposed&&(this._disposed=!1,this.on("link",this,this.onLink))},i.dispose=function(){this._disposed||(this._disposed=!0,this.off("link",this,this.onLink))},p(0,i,"innerHTML",e.prototype._$get_innerHTML,function(e){G.superSet(nu,this,"innerHTML",e),this.height=this.textHeight+2}),t.create=function(){if(0<t._pools.length){var e=t._pools.pop();return e.relive(),e}return new t},t.recover=function(e){null!=e&&(t.recover.innerHTML="",e.dispose(),t._pools.push(e))},t._pools=[],t}(nu),Aj=function(t){function i(){var e=this;e.dirMode=!1,e._speed_=800,e._tarPoint_=null,e._movePath_=null,e._totalTime_=0,e._moveEndFunc_=null,e._updateFunc_=null,e._isRuning_=!1,e._loopMoveTime_=0,e._stopMove_=!1,e._dir_=0,e.isBezierMove=!1,e.timer=0,e.mode=0,e.scaleSpeed=.005,e.moveEndAndDospose=!0,e.tilePoint=null,i.__super.call(e),e._className_="modules.scene.others.EffectShoot",e.renderInSelf=!0,e.isSceneEffect=!0,i.addObject(e),0==i.isEffectShootIsReady&&G.timer.frameLoop(1,i,modules.scene.others.EffectShoot.loop)}b(i,"modules.scene.others.EffectShoot",t);var e=i.prototype;return e.loop=function(){},e.reset=function(){var e=this;e._speed_=800,e._tarPoint_=null,e._movePath_=[],e._totalTime_=0,e._moveEndFunc_=null,e._updateFunc_=null,e._isRuning_=!1,e._loopMoveTime_=0,e._stopMove_=!1,e.isSceneEffect=!1,t.prototype.reset.call(e)},e.stopMove=function(){this._isRuning_=!1,this._stopMove_=!0,this._tarPoint_=null,this._movePath_=[]},e.loopMove=function(){if(this._tarPoint_&&this._isRuning_&&!this._stopMove_){var e=BB.getTimer();this._totalTime_+=e-this._loopMoveTime_,0<this._totalTime_&&this._tarPoint_&&this._tarMove_(),this._loopMoveTime_=BB.getTimer()}},e.tarMoveTo=function(e){this._tarPoint_=e.shift(),this._stopMove_=!1,this._movePath_=e,this._isRuning_=!0,this._loopMoveTime_=BB.getTimer(),this.scaleX=this.scaleY=1},e.setAngle=function(e,t){},e.getDirPoint=function(e,t){return void 0===t&&(t=1),VB.getTileByDir(this.tilePoint,e,t)},e._tarMove_=function(){var e=this;if(!e._stopMove_)if(null!=e._tarPoint_){if(0==e._speed_)throw new Error(RP.n[269]);if(e._speed_=e._speed_,e.x==e._tarPoint_.x&&e.y==e._tarPoint_.y){if(!e._movePath_.length)return void e._MoveEndFunc_();e._tarPoint_=e._movePath_.shift()}var t=ol.distance(new Uh(e.x,e.y),e._tarPoint_);if(0==t&&e._movePath_.length)e._MoveEndFunc_();else{var i=t/e._speed_*1e3;1<=e.mode&&(e.scaleX-=e.scaleSpeed,e.scaleY-=e.scaleSpeed,e.scaleX<0&&(e.scaleX=0),e.scaleY<0&&(e.scaleY=0)),e._totalTime_>=i?e._totalTime_-=i:(i=e._totalTime_,e._totalTime_=0);var n=new Uh(e.x,e.y);if(0<i){var s=e._speed_*i/1e3/t,o=ol.interpolate(e._tarPoint_,n,s);e.x=o.x,e.y=o.y}if(n.x=e.x,n.y=e.y,e._tarPoint_){var a=ol.distance(n,e._tarPoint_);if(e._tarPoint_&&e.setAngle(e._tarPoint_.x,e._tarPoint_.y),null==e.updateFunc||e.isBezierMove||e.updateFunc(e),a<=1)if((e._totalTime_=0)<e._movePath_.length){e._tarPoint_=e._movePath_.shift();var r=0;e.isBezierMove&&(r=300),BB.getTimer()-e._$6_timer>r&&(e._$6_timer=BB.getTimer(),null!=e.updateFunc&&e.updateFunc(e))}else e._MoveEndFunc_();0<e._totalTime_&&e._tarMove_()}}}else e._MoveEndFunc_()},e._MoveEndFunc_=function(){this._isRuning_=!1,null!=this.moveEndFunc&&this.moveEndFunc.run(),this.moveEndAndDospose&&this.dispose()},e.dispose=function(){var e=this;i.removeObject(e),e._tarPoint_=null,e._movePath_=[],e._totalTime_=0,e._moveEndFunc_=null,e._updateFunc_=null,e._isRuning_=!1,e._loopMoveTime_=0,e._stopMove_=!1,t.prototype.dispose.call(e),e._isDisposed_=!0,i.objectQueue.length<=20&&-1==i.objectQueue.indexOf(e)&&i.objectQueue.push(e)},e.resetForDisposed=function(){var e=this;e.dirMode=!1,e._speed_=200,e._tarPoint_=null,e._movePath_=[],e._totalTime_=0,e._moveEndFunc_=null,e._updateFunc_=null,e._isRuning_=!1,e._loopMoveTime_=0,e._stopMove_=!1,e._dir_=0,e.isBezierMove=!1,e._$6_timer=0,e.mode=0,e.scaleSpeed=.01,e.moveEndAndDospose=!0,e.isSceneEffect=!1,e.renderInSelf=!1,e._isDisposed_=!1,t.prototype.resetForDisposed(),i.addObject(e)},p(0,e,"speed",function(){return this._speed_},function(e){this._speed_=e}),p(0,e,"mix_speed",function(){return this._speed_},function(e){this._speed_=e}),p(0,e,"moveEndFunc",function(){return this._moveEndFunc_},function(e){this._moveEndFunc_=e}),p(0,e,"updateFunc",function(){return this._updateFunc_},function(e){this._updateFunc_=e}),p(0,e,"dir",function(){return this._dir_},function(e){if(this.dirMode);else{var t=VB.getAngle(e);this.rotation=t}}),i.loop=function(){for(var e=0;e<i._EffectShootQueue_.length;)i._EffectShootQueue_[e].loopMove(),e++},i.GetNew=function(){var e;return i.objectQueue.length?((e=i.objectQueue.pop()).reset(),e.isSceneEffect=!0,i._EffectShootQueue_.push(e),i.instanceIndex+=1):e=new i,e},i.addObject=function(e){-1==i._EffectShootQueue_.indexOf(e)&&i._EffectShootQueue_.push(e)},i.removeObject=function(e){var t=i._EffectShootQueue_.indexOf(e);-1!=t&&i._EffectShootQueue_.splice(t,1)},i.instanceIndex=0,i.isEffectShootIsReady=!1,f(i,["_EffectShootQueue_",function(){return this._EffectShootQueue_=new Array},"objectQueue",function(){return this.objectQueue=new Array},"_Point_",function(){return this._Point_=new Uh}]),i}(mj),Dj=function(s){function e(){e.__super.call(this)}b(e,"zwc.engine.core.displays.world.char.MainChar",s);var t=e.prototype;return t.inited=function(){this.type=Za.MAIN_CHAR,this.hero_id=1,this.selectEnabled=!1},t._init_=function(){this._className_="zwc.engine.core.displays.MainChar"},t.play=function(e,t,i,n){void 0===t&&(t=1),void 0===n&&(n=-1),s.prototype.play.call(this,e,t,i,n)},t.getViewRect=function(){var e=PB.tileToPixelsByXY(this.tileX-8,this.tileY-8);return new u_(e.x,e.y-200,1360,1080)},t.setXY=function(e,t){s.prototype.setXY.call(this,e,t),this.type==Za.MAIN_CHAR&&(uq.viewRect=this.getViewRect())},t.tarMoveTo=function(e,t){if(void 0===t&&(t=!0),this.type==Za.MAIN_CHAR)if(t&&0==this.isDeath&&ZN.isSynch())uH.Ins().currCid==_a.S_SBSY_SBT.toString()&&0<zN.pickUpQueue.length||this.sendPath(e);else{var i=NF.Ins().selectChar;i&&0<i.objectId&&(i.type==Za.PICKUP_ITEM||i.type==Za.PICKUP_GOLD)&&this.sendPath(e)}s.prototype.tarMoveTo.call(this,e)},t.moveTo=function(e,t){s.prototype.moveTo.call(this,e,t)},t.moveEndHander=function(){this.objectId==gR.ins.objectId&&dr.dtoEnterScene&&13==dr.dtoEnterScene.type&&uH.Ins().currCid==_a.S_SBK_WG.toString()&&Tu.sendToModule("NEW_SS_MOVE_END",["modules.newsiege.NewSiegeModule"]),s.prototype.moveEndHander.call(this)},t.sendPath=function(e){var t=new yL;t.paths=e.slice(),t.paths.unshift(new Uh(this.x,this.y)),Tu.sendToService(t)},e}(yj),Oj=function(e){function t(){var e=this;e.nav_guiShu=null,e.nav_otherGuild=null,e.nav_selfGuild=null,e.nav_hurtRank=null,e.nav_gift=null,e.box_clip=null,e.cp_3=null,e.cp_2=null,e.cp_1=null,e.cp_0=null,e.line_0=null,e.line_1=null,e.line_2=null,e.cp_caiji=null,e.box_scene=null,e.txt_value=null,e.nav_caiji=null,e.box_btn_scene=null,e.img_sceneBg=null,e.btn_cn=null,e.btn_dq=null,e.box_dq=null,e.btn_dn=null,e.btn_cn1=null,e.box_dn=null,e.btn_cq=null,e.btn_dq1=null,t.__super.call(e)}return b(t,"layouts.newsiege.scene.NewSsSceneVUI",Gg),t.prototype.createChildren=function(){Vg.regComponent("layouts.newsiege.scene.NewSsGuiShuVUI",Jd),Vg.regComponent("layouts.newsiege.scene.NewSsGuildPanelVUI",Kd),Vg.regComponent("layouts.newsiege.scene.NewSsPersonPanelVUI",th),Vg.regComponent("layouts.newsiege.scene.NewSsHurtRankVUI",$d),Vg.regComponent("modules.newsiege.views.NewSiegeAwardsView",GZ),Vg.regComponent("layouts.newsiege.scene.NewSsCaiJiInfoUI",Qd),laya.ui.Component.prototype.createChildren.call(this),this.loadUI("newsiege/scene/NewSsSceneV")},t}(),Pj=function(e){function t(){var e=this;e._item=null,e._box=null,e._dto=null,e._openLvl=0,e._index=0,e._isActive=!1,t.__super.call(e),e.txt_roles.visible=e.txt_special.visible=!1,e._openLvl=parseInt($e.MODEL.value($e.getIndex(163))),e._item=new AF,e._item.needGridBg=!1,e._item.pos(30,88),e.addChild(e._item),e._box=new dt,e._box.pos(0,655),e.addChild(e._box),e.btn_resolve.on("click",e,e.onClickHandler)}b(t,"modules.achievenew.views.tujian.Tujian_ToolTips",yI);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(t.graphics.clear(),t.btn_resolve.visible=!1,t._dto=e,t._dto){if(t.setBaseInfo(),0<Bt.count)t.setAtts();else{var i=[{url:_r.getJxrDBPath("BossCardLevelResource"),type:"arraybuffer",cls:Bt}];uc.ins().onLoadJxrs(i,ql.create(t,t.setAtts))}t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))}},i.setBaseInfo=function(){var e=this;e._item.bindData=e._dto.goodsId;var t=Bi.MODEL.colourId(e._dto.cfgIdx);e.g_color.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+t+".png"),e.txt_name.changeText(e._dto.name),e.txt_name.color=ms.getByQuality(t),e.txt_pz.changeText(ms.getByQualityName(t)),e.txt_num.changeText(e._dto.goodsNum.toString())},i.setAtts=function(){var e=this;if(e._index=zP.getCardInfoByGoodId(e._dto.goodsId),-1!=e._index){var t;e._openLvl>gR.ins.lv||zP.activeHash?e.setActive():zP.reqTujianInfo(ql.create(e,e.setActive)),zP.getIsSpecialCard(e._dto.goodsId)?(e.txt_roles.visible=!1,t=_r.getTuJianPathJpg("bg_5_1"),zP.getIsSpecialCard1(e._dto.goodsId)&&(e.txt_roles.visible=!1,t=_r.getTuJianPathJpg("bg_"+Bt.MODEL.type(e._index)+"_"+Bt.MODEL.index(e._index)))):(e.txt_roles.visible=!0,t=_r.getTuJianPathJpg("bg_"+Bt.MODEL.type(e._index)+"_"+Bt.MODEL.index(e._index))),e.g_icon.loadImage(t,0,0,0,0,ql.create(e,e.onComplete,[t])),e.cp.centerX=e.txt_roles.visible?-38:0,e.cp.value=zP.getBossCardLevelFight(e._index,!0);var i=zP.getAttrsByIndex(e._index),n=i.attrS,s=i.attrN;e.txt_special.visible=0<n.length;var o=0;0<n.length&&(e.txt_special.changeText(RP.n[270]+n[0].addName+"+"+n[0].val),o+=42),e.box_att.y=o+e._box.y,o+=47;for(var a=0;a<s.length;a++)e._box.graphics.fillText(s[a].addName,29,o,"24px SimHei","#90877b","left"),e._box.graphics.fillText(s[a].val,151,o,"24px SimHei","#23b11f","left"),o+=42;e.box_serial.y=o+e._box.y,o+=47,e._box.graphics.fillText(Bt.MODEL.typeName(e._index),29,o,"24px SimHei","#23b11f","left"),o+=58,0<e._dto.uuId?(e.btn_resolve.y=e._box.y+o,e.height=e.btn_resolve.y+e.btn_resolve.height+30):e.height=e._box.y+o+30}},i.onComplete=function(e){this.g_icon.skin=e},i.setActive=function(){var e=this;e._openLvl>gR.ins.lv?e._isActive=!1:zP.getIsSpecialCard(e._dto.goodsId)?e._isActive=zP.getRoleCard():e._isActive=-1<zP.getCardsLevel(Bt.MODEL.type(e._index),Bt.MODEL.index(e._index)),e._isActive?e.g_active.skin=_r.getAtlasSubPath("base_ui2/tj_img_yjh.png"):e.g_active.skin=_r.getAtlasSubPath("base_ui2/tj_img_wjh.png"),e.btn_resolve.visible=0<e._dto.uuId,e.btn_resolve.visible&&(e.btn_resolve.label=e._isActive?"分 解":"使 用")},i.close=function(e){var t=this;(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(t)&&eq.panelLayer.close(t):eq.panelLayer.close(t);eq.panelLayer.off("MASK_CLOSE",t,t.onClick),t._dto=null,t._isActive=!1,t._box.graphics.clear(),yc.clearRes(t.g_icon.skin),t.g_icon.skin=""},i.onClick=function(e){this.close(!0)},i.onClickHandler=function(e){if(this._openLvl>gR.ins.lv)zB.ins.showMsg(this._openLvl+RP.n[271],1);else{this.close(!0),hN.ins.isOpen("BAGPACK")&&hN.ins.close("BAGPACK");var t=Bt.MODEL.type(this._index);zP.selectType=t,hN.ins.open("ACHIEVE_NEW_MAIN_VIEW",{_subIndex_:parseInt("1"),refreshType:t,pages:!0},null,!0)}},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.achievenew.tujian._Tujian_ToolTipUI._$SET_instance),t._instance=null,t}(),Rj=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.activity.views.os.item.OS_PurchaseItem",e);var i=t.prototype;return i.init=function(){this.img_point.visible=!1,this.img_select.visible=!1},p(0,i,"selected",null,function(e){this.img_select.visible=e}),p(0,i,"reddot",null,function(e){this.img_point.visible=e}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){G.superSet(dy,this,"dataSource",e);var t=e;this.img_icon.skin=_r.getOsNewPath("purchase/xs_tb_"+t),this.img_title.skin=_r.getOsNewPath("purchase/xs_text_lb"+t)}),t}(dy),Nj=function(e){function s(e,t,i){var n=this;n.redptHandler=null,n._items=null,n._total=3,n._selectIdx=-1,n._actors=null,n._gap=0,n._top=0,n._isDown=!1,n._mx=0,n._align=0,s.__super.call(n),void 0===t&&(t=0),void 0===i&&(i=0),n._actors=e||gR.ins.actorList,0<t&&(n._gap=t),0<i&&(n._top=i),n.init()}b(s,"modules.actor.views.active.ActorSelector",Gg);var t=s.prototype;return t.setRedPtByIdx=function(e,t){this._items[e].showTips!=t&&(this._items[e].showTips=t)},t.refresh=function(){for(var e=0;e<3;e++)this._items[e].refresh()},t.invalid=function(){if(this.redptHandler)for(var e=0;e<this._items.length;e++)this.setRedPtByIdx(e,e<this._actors.length&&this.redptHandler.runWith(this._actors[e]))},t.onAdd=function(e){for(var t=0;t<this._items.length;t++){this._items[t].on("click",this,this.onClick)}this.refresh(),dr.selectorShow=!0,Tu.sendToModule("SELECTOR_CHANGE",["modules.broadcast.BroadcastModule"])},t.onRemove=function(e){for(var t=0;t<this._items.length;t++){this._items[t].off("click",this,this.onClick)}dr.selectorShow=!1,Tu.sendToModule("SELECTOR_CHANGE",["modules.broadcast.BroadcastModule"])},t.onMouseDown=function(){this._isDown=!0,this._mx=G.stage.mouseX,this.parent.on("mouseup",this,this.onMouseUp),this.parent.off("mousedown",this,this.onMouseDown)},t.onMouseUp=function(){var e=this;e._isDown&&(e._isDown=!1,250<G.stage.mouseX-e._mx?0!=e._selectIdx&&e.setSelect(e._selectIdx-1):G.stage.mouseX-e._mx<-250&&e._selectIdx!=e._actors.length-1&&e.setSelect(e._selectIdx+1),e.parent.off("mouseup",e,e.onMouseUp),e.parent.on("mousedown",e,e.onMouseDown))},t.onClick=function(e){var t=this._items.indexOf(e.target);-1!=t&&(t>=this._actors.length?gR.ins.actorList==this._actors&&Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]):(this.setSelect(t),UB.ins.playSound(90006)))},t.setSelect=function(e){this._selectIdx!=e&&(-1!=this._selectIdx&&(this._items[this._selectIdx].selectd=!1),this._items[e].selectd=!0,this._selectIdx=e,modules.actor.views.active.ActorSelector.globalIdx=e,this.event("select"))},t.init=function(){var e=this;e.top=0<e._top?e._top:65,e.centerX=0,e._items=[];for(var t,i=0<e._gap?e._gap:-14,n=0,s=0;s<3;s++)(t=new pX(e._actors)).x=n,t.idx=s,e._items[s]=t,e.addChild(t),n+=t.width+i;e.setSelect(modules.actor.views.active.ActorSelector.globalIdx)},t.getItem=function(e){return e<0||2<e?null:this._items[e]},p(0,t,"selectIdx",function(){return this._selectIdx},function(e){e=e>=this._total||e<0?0:e>this._actors.length?0:e,this.setSelect(e)}),p(0,t,"align",null,function(e){if(this._align!=e){this._align=e;for(var t=0,i=0;i<3;i++)null!=this._items[i]&&(this._items[i].x=t,t+=this._items[i].width+this._align)}}),s.DIS=250,s.globalIdx=0,s}(),Bj=function(e){function t(){this._grid=null,this._seletedKuang=null,this._selectedGou=null,this._txtName=null,t.__super.call(this)}b(t,"modules.backpack.views.item.BagPackageItem",e);var i=t.prototype;return i.createChildren=function(){var e=this;laya.ui.Component.prototype.createChildren.call(e),e._grid=new MF,e._grid.toolTipEnabled=!1,e.addChild(e._grid),e._txtName=new fc,e._txtName.fontSize=22,e._txtName.y=121,e._txtName.align="center",e.addChild(e._txtName),e._selectedGou=new Ss,e._selectedGou.left=e._selectedGou.right=e._selectedGou.top=0,e._selectedGou.alpha=.5,e._selectedGou.graphics.drawRect(0,0,116,116,"#000000",null),e.addChild(e._selectedGou),e._seletedKuang=new Kl,e._seletedKuang.centerX=0,e._seletedKuang.centerY=-10,e._seletedKuang.skin=_r.getAtlasSubPath("basic_ui_3/ty_xz_dh.png"),e.addChild(e._seletedKuang)},i.changeSelected=function(){this._selectedGou.removeSelf(),this._seletedKuang.removeSelf(),this.dataSource.selected&&(this.addChild(this._selectedGou),this.addChild(this._seletedKuang))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(Gg,this,"dataSource",e),e){this._grid.bindData=e.dto;var t=Bi.getIndex(e.dto.goodsId),i=Bi.MODEL.simpleName(t),n=ms.getByQuality(Bi.MODEL.colourId(t));this._txtName.text=i,this._txtName.color=n,this._txtName.x=58-this._txtName.displayWidth/2,this.changeSelected()}}),p(0,i,"height",function(){return this._grid.height+30},e.prototype._$set_height),t}(Gg),Hj=function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.actor.views.cimelia.YuPeiSkillTips",bv);var i=t.prototype;return i.show=function(e,t,i){this.txt_title.changeText(e),this.txt_content.innerHTML=t,this.txt_unlock.innerHTML=i,this.parent||(eq.panelLayer.once("MASK_CLOSE",this,this.onClick),eq.panelLayer.open(this,!1,!0))},i.setTitle=function(e){this.txt_title.changeText(e)},i.setContent=function(e){this.txt_content.innerHTML=e},i.setLockInfo=function(e){this.txt_unlock.innerHTML=e},i.showBySkillID=function(e,t){void 0===t&&(t="");var i=Ls.getIndex(e);this.txt_title.changeText(Ls.MODEL.skillName(i)),this.txt_content.innerHTML=Ls.MODEL.skillDesc(i),this.txt_unlock.innerHTML=""==t||null==t?RP.n[272]:t,this.parent||(eq.panelLayer.once("MASK_CLOSE",this,this.onClick),eq.panelLayer.open(this,!1,!0))},i.close=function(e){void 0===e&&(e=!1),eq.panelLayer.close(this)},i.onClick=function(e){e instanceof modules.actor.views.cimelia.YuPeiSkillTips&&this.close()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.cimelia.YuPeiSkillTipsUI._$SET_instance),t._instance=null,t}(),Vj=function(e){function t(){this._offsetY=0,this.TEXT_SIZE=24,this.TITLE_S=162,this.TEXT_S=54,this.TEXT_B=18,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.actor.views.longwen.LongWenAttrTips",Hc);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(t.panel_attr.graphics.clear(),t._offsetY=0,t.mcJob_1.visible=t.mcJob_2.visible=t.mcJob_3.visible=!1,null!=e){t._offsetY=20;var i=e.career,n=gR.ins.actorList[i];n&&(t["mcJob_"+n.job].visible=!0);var s=0,o=[],a=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",r=G.loader.getRes(a),l=t.getAllFuWenAttr(i);for(s=0;s<l.length;s++)o[2*s]=0,o[2*s+1]=42*s+18;for(t.panel_attr.graphics.drawTextures(r,o),s=0;s<l.length;s++){var c,u=l[s],d=u.name+"：";c=aa.getAttributByType(u.type).isPer?u.value/100+"%":u.value+"",t.drawAttr(d,"#90877b",c,"#90877b",t.TEXT_S,t.TEXT_SIZE,t.TEXT_B)}}t.height=t._offsetY+145,t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.getAllFuWenAttr=function(e){for(var t,i,n,s=new jo,o=[],a=!1,r=0;r<8;r++){var l=MR.ins.getEquip(e+1,52+r);if(l){var c=jt.MODEL.attrs(l.dragonIndex-1);if((t=JSON.parse(c))&&0<t.length)for(var u=0;u<t.length;u++){a=!1;var d=t[u];if(null==s[d.type]&&(new Object,s[d.type]=new jo),null==s[d.type][d.module]&&(i=new Object,n=aa.getAttributByType(d.type),i.value=d.value,i.module=d.module,i.type=d.type,i.name=n.getModuleName(d.module),s[d.type][d.module]=i,a=!0,o.push(i)),!a){var h;-1;for(var _=0;_<o.length;_++)if((h=o[_])&&i&&h.type==i.type&&h.module==i.module){h.value+=i.value,o[_]=h;break}}}}}return o},i.drawAttr=function(e,t,i,n,s,o,a){this.panel_attr.graphics.fillText(e,s,this._offsetY,o+"px SimHei",t,"left");var r=s+(mp.getStringLength(e)*o>>1)+4;this.panel_attr.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.longwen.LongwenAttrTipsUIUI._$SET_instance),t._instance=null,t}(),Gj=function(e){function t(){var e=this;e.sortId=0,e._isInner=0,e.xq_state=0,e.lock_lay=0,e.currentDragon=null,e.inner=!1,e._data=null,e._icon=null,e._position=0,e.longwenData=null,e._offsetY=0,e.TEXT_SIZE=20,e.TITLE_S=162,e.TEXT_S=48,e.TEXT_B=8,t.__super.call(e),e.longwenData=lR.instance(),e.initUI(),e.img_bg.cacheAs="bitmap"}b(t,"modules.actor.views.longwen.LongwenChangeItem",Cc);var i=t.prototype;return i.destory=function(){this.btn_xiangqian.off("click",this,this.onClickXiangQian)},i.drawAttr=function(e,t,i,n,s,o,a){this.txt_attr.graphics.fillText(e,0,this._offsetY,o+"px SimHei",t,"left");var r=0+(mp.getStringLength(e)*o>>1)+4;this.txt_attr.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},i.onClickXiangQian=function(){var e=new Object;e.roleIndex=this.longwenData.roleIndex,e.goodsId=this._data.uuId,e.goodsPosition=this._position,this.longwenData.sendToInner(e),UB.ins.playSound("4")},i.initUI=function(){this._icon=new AF,this._icon.pos(12,14),this.addChild(this._icon),this.btn_xiangqian.on("click",this,this.onClickXiangQian),this.txt_attr.y=60},p(0,i,"data",function(){return this._data},function(e){var t=!1;if(this.txt_noPs.visible=this.txt_noPs1.visible=!1,this._offsetY=-5,this.txt_attr.graphics.clear(),e){this._data=e,this._icon.bindData=this._data.goodsId;var i=Bi.getIndex(this._data.goodsId),n=Bi.MODEL.name(i);if(n+="Lv."+jt.MODEL.level(this._data.dragonIndex-1),this.txt_longwenName.changeText(n),this.txt_longwenName.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(i)),0==this._data.dragonIndex)return;this.sortId=jt.MODEL.sort(this._data.dragonIndex-1);var s=jt.MODEL.attrs(this._data.dragonIndex-1),o=aa.formatAttrToChineseByList(s);3==o.length?this.txt_attr.y=48:2!=o.length&&1!=o.length||(this.txt_attr.y=60);for(var a=0;a<o.length;a++){var r=o[a],l=aa.getAttributById(r.id);this.drawAttr(l.getModuleName(r.module)+"+","#90877b",r.val,"#90877b",this.TEXT_S,this.TEXT_SIZE,this.TEXT_B)}var c=[],u=Bi.MODEL.colourId(i),d=parseInt(this._data.goodsId.toString().substr(3,2));if(c=this.longwenData.getInnerDragonTypeList(this.longwenData.roleIndex).longwenTyps,null!=this.currentDragon)if(1==this.inner)this.btn_xiangqian.visible=!1,this.txt_xiangqian.changeText(RP.n[273]),this.txt_xiangqian.color="#01b527";else{var h=Bi.getIndex(this.currentDragon.goodsId);t=Bi.MODEL.colourId(h)<u,d==parseInt(this.currentDragon.goodsId.toString().substr(3,2))?(this.btn_xiangqian.visible=!0,this.txt_xiangqian.text="",this.isInner=1):-1==c.indexOf(d)?(this.btn_xiangqian.visible=!0,this.txt_xiangqian.text="",this.isInner=1):(this.txt_xiangqian.changeText(RP.n[274]),this.txt_xiangqian.color="#ff0000",this.btn_xiangqian.visible=!1,this.isInner=0)}else-1==c.indexOf(d)?(this.btn_xiangqian.visible=!0,this.txt_xiangqian.text="",this.isInner=1):(this.txt_xiangqian.changeText(RP.n[275]),this.txt_xiangqian.color="#ff0000",this.btn_xiangqian.visible=!1,this.isInner=0)}this.imgRed.visible=t&&this.btn_xiangqian.visible;var _=this.longwenData.checkLongWenIsOpen(this._data.goodsId);0==_[0]&&1==this.isInner?(this.txt_xiangqian.text="",this.imgRed.visible=this.btn_xiangqian.visible=!1,this.txt_noPs.visible=!0,this.txt_noPs.text=_[1],this.xq_state=0,this.lock_lay=parseInt(_[2])):(this.xq_state=1,this.lock_lay=this.longwenData.checkLongWenIsOpen2(this._data.goodsId))}),p(0,i,"isInner",function(){return this._isInner},function(e){this._isInner=e}),p(0,i,"position",null,function(e){this._position=e}),p(0,i,"isShowBtn",null,function(e){this.btn_xiangqian.visible=e}),t}(),Uj=function(e){function t(){this._data=null,this._imgSP=null,this.longwenModel=null,t.__super.call(this),this.longwenModel=lR.instance(),this.initUI()}b(t,"modules.actor.views.longwen.LongwenFenJieItem",Ac);var i=t.prototype;return i.onClickcbx=function(e){e.target==this.ckb||(this.ckb.selected=!this.ckb.selected),this.selected=this.ckb.selected},i.initUI=function(){var e=this;e._imgSP=new AF,e._imgSP.pos(9,15),e.addChild(e._imgSP),e._imgSP.needGridBg=!1,e._imgSP.scaleX=e._imgSP.scaleY=.9,e.on("click",e,e.onClickcbx)},p(0,i,"data",null,function(e){var t=this;if(e){t.txtAttr.text="",t.ckb.selected=!1,t._data=e,t._imgSP.bindData=t._data.goodsId;var i=Bi.getIndex(t._data.goodsId),n=Bi.MODEL.name(i);if(n+="Lv."+jt.MODEL.level(t._data.dragonIndex-1),t.txtName.changeText(n),t.txtName.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(i)),0==t._data.dragonIndex)return;for(var s=jt.MODEL.attrs(t._data.dragonIndex-1),o=aa.formatNewAttrToChinese(s),a="",r=[],l=0;l<o.length;l++){var c=o[l],u=c.name;a=(u=u.replace(/\s/g,""))+"+"+c.val+"\n",r.push(a)}var d=r.join().replace(",","");t.txtAttr.text=d.replace(",","")}}),p(0,i,"selected",function(){return this.ckb.selected},function(e){this.ckb.selected=e;var t=jt.MODEL.fragment(this._data.dragonIndex-1);if(t){var i=JSON.parse(t);if(null!=i)for(var n=0;n<i.length;n++){var s=i[n].value.split(":")[0],o=parseInt(i[n].value.split(":")[1]);"DRAGON_DESIGN_ESSENCE"==s?1==this.ckb.selected?this.longwenModel.longwenChipNum+=o:this.longwenModel.longwenChipNum-=o:"DRAGON_DESIGN_FRAGMENT"==s?1==this.ckb.selected?this.longwenModel.longwenSuiPianNum+=o:this.longwenModel.longwenSuiPianNum-=o:"2636"==s?1==this.ckb.selected?this.longwenModel.longwenLyanNum+=o:this.longwenModel.longwenLyanNum-=o:"2637"==s&&(1==this.ckb.selected?this.longwenModel.longwenLyiNum+=o:this.longwenModel.longwenLyiNum-=o)}Tu.sendToModule("LONGWEN_SUIPIAN_NUM",["modules.actor.ActorModule"])}}),t}(),Fj=function(e){function t(){this._data={},this.itemArr=[],t.__super.call(this),this.initUI()}b(t,"modules.actor.views.longwen.LongwenGetItem",Oc);var i=t.prototype;return i.dispon=function(){for(var e,t=0;t<this.itemArr.length;t++)(e=this.itemArr[t]).off("click",this,this.onClick),e.parent&&e.parent.removeChild(e),e.destroy();this.itemArr=[]},i.onClick=function(e,t){var i={dtoequ:t[0],getinfo:t[1]};Wj.instance.show(i)},i.initUI=function(){},p(0,i,"data",null,function(e){if(null!=e){var t,i,n=0,s=e.dragons;for(this.txtTitle.changeText(s[0].name),n=0;n<s.length;n++)(t=new qj).x=9+n%5*129,t.y=76,(i=KH.create(s[n].dragonId)).dragonIndex=1,t.data={vo:i,index:-1},this.addChild(t),t.on("click",this,this.onClick,[,[i,s[0].name.replace("通关","")]]),this.itemArr.push(t)}}),t}(),qj=function(e){function t(){var e=this;e.isChangeDragon=!1,e.longWenIndex=0,e._data=null,e._icon=null,e.longwenData=null,t.__super.call(e),e.longwenData=lR.instance(),e.initUI(),e.img_selected.visible=!1,e.txt_name.mouseEnabled=e.txt_name.mouseThrough=!1}b(t,"modules.actor.views.longwen.LongWenGrid",Pc);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onClickBGEvent)},i.clearFilter=function(){this.img_selected.visible=!1},i.setFilter=function(){this.img_selected.visible=!0},i.initUI=function(){this.on("click",this,this.onClickBGEvent),this.imgRed.visible=!1},i.onClickBGEvent=function(e){this.lock||null==this._data&&Tu.sendToModule("LONGWEN_CHANGE_PANEL",["modules.actor.ActorModule"],this.longWenIndex)},p(0,i,"data",null,function(e){var t=this;if(e)if(t._data=e.vo,t.longWenIndex=e.index,null!=t._data){t.img_add.visible=!1,null==t._icon&&(t._icon=new AF,t._icon.pos(-2,-1),t._icon.needGridBg=!1,t.addChildAt(t._icon,3),t._icon.scaleX=t._icon.scaleY=1),t._icon.bindData=t._data.goodsId;var i=Bi.getIndex(t._data.goodsId),n=Bi.MODEL.name(i);if(n+="Lv."+jt.MODEL.level(t._data.dragonIndex-1),t.txt_name.text=n,t.txt_name.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(i)),0<t._data.roleId){var s=t.longwenData.checkHasUpDragon2(t._data);t.imgRed.visible=s}}else{if(0==t.lock){t.img_add.visible=!0;var o=t.longwenData.checkHasInnerDragon(t.longwenData.roleIndex);t.imgRed.visible=o}else t.imgRed.visible=!1,t.img_add.visible=!1,t.txt_name.text="";t._icon&&(t._icon.bindData=null,t._icon.parent&&t._icon.parent.removeChild(t._icon),t._icon.destroy(),t._icon=null),t.txt_name.text=""}0==t.imgRed.visible&&(t.imgRed.visible=t.isChangeDragon),t.setChildIndex(t.imgRed,t.numChildren-1)}),p(0,i,"lock",function(){return this.img_lock.visible},function(e){this.img_lock.visible=e}),t}(),jj=function(e){function t(){var e=this;e._icon=null,e.data=null,e._offsetY=0,e.TITLE_SIZE=24,e.TEXT_SIZE=22,e.TITLE_S=162,e.TEXT_S=54,e.TEXT_B=12,e._fullAttrTxt=null,e.totalH=0,e.baseAttrY=0,t.__super.call(e),e.centerX=e.centerY=0,e._icon=new AF,e._icon.needGridBg=!1,e._icon.pos(222,101),e.addChild(e._icon)}b(t,"modules.actor.views.longwen.LongWenToolsTips",Nc);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this,i=[];if(0==jt.count&&i.push({url:_r.getJxrDBPath("DragonDesignUpgrade"),type:"arraybuffer",cls:jt}),0==Yt.count&&i.push({url:_r.getJxrDBPath("DragonView"),type:"arraybuffer",cls:Yt}),0<i.length)uc.ins().onLoadJxrs(i,ql.create(t,t.show,[e]));else{var n;if(t.graphics.clear(),t._offsetY=0,t.totalH=0,t.baseAttrY=0,t.txt_attr1.changeText(""),t.txt_attr2.changeText(""),t.txt_attr3.changeText(""),null!=e){t.data=e,t._offsetY=270,t._icon.bindData=e.goodsId;var s=Bi.getIndex(t.data.goodsId),o=Bi.MODEL.name(s);0!=t.data.dragonIndex?o+="Lv."+jt.MODEL.level(t.data.dragonIndex-1):o+="Lv.1",t.txt_title.changeText(o),t.txt_title.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(s)),t.img_quality.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+Bi.MODEL.colourId(s)+".png");var a="";a=0!=t.data.dragonIndex?jt.MODEL.attrs(t.data.dragonIndex-1):Bi.MODEL.attributes(t.data.cfgIdx);for(var r=aa.formatAttrToChineseByList(a),l=0;l<r.length;l++){var c=r[l],u=aa.getAttributById(c.id).getModuleName(c.module)+":",d=c.val+"";(n=t["txt_attr"+(l+1)]).changeText(u+d),n.color="#90877b",t.baseAttrY=n.y+n.height}t.totalH=329+31*r.length,t.showFullAttr(),t.height=t.totalH}t.btn_hecheng.visible=!1,t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))}},i.showFullAttr=function(){var e=this;e.box_fullAttr.visible=!0,e.box_fullAttr.y=e.baseAttrY+20,null==e._fullAttrTxt&&(e._fullAttrTxt=new Yp,e._fullAttrTxt.fontSize=24,e._fullAttrTxt.font=dr.font,e._fullAttrTxt.width=300,e._fullAttrTxt.wordWrap=!0,e._fullAttrTxt.color="#23b11f",e._fullAttrTxt.align="left",e.addChild(e._fullAttrTxt)),e._fullAttrTxt.pos(e.txt_attr1.x,e.box_fullAttr.y+48);for(var t="",i=0,n=0;n<Yt.count;n++)if(Yt.MODEL.toolsId(n)==e.data.goodsId){i=Yt.MODEL.maxDragonID(n);break}var s,o=jt.MODEL.attrs(i);for(s=aa.formatAttrToChineseByList(o),n=0;n<s.length;n++){var a=s[n];t+=aa.getAttributById(a.id).getModuleName(a.module)+":"+(a.val+""),n<s.length-1&&(t+="\n")}e.totalH=e._fullAttrTxt.y+54*s.length,e._fullAttrTxt.text=t,e._fullAttrTxt.leading=20},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.drawAttr=function(e,t,i,n,s,o,a){this.graphics.fillText(e,s,this._offsetY,o+"px SimHei",t,"left");var r=s+(mp.getStringLength(e)*o>>1)+4;this.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.longwen.LongWenTipsUI._$SET_instance),t._instance=null,t}(),Wj=function(e){function t(){var e=this;e._icon=null,e.data=null,e._offsetY=0,e._achieves=null,e._fullAttrTxt=null,e.totalH=0,e.baseAttrY=0,t.__super.call(e),e.centerX=e.centerY=0,e._icon=new AF,e._icon.pos(222,101),e._icon.needGridBg=!1,e.addChild(e._icon)}b(t,"modules.actor.views.longwen.LongwenViewTips",Vc);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(t.graphics.clear(),t._offsetY=0,t.totalH=0,t.baseAttrY=0,t.txt_attr1.changeText(""),t.txt_attr2.changeText(""),t.txt_attr3.changeText(""),t.box_fullAttr.visible=!1,null!=e){e instanceof protos.backpack.DtoEquip||e instanceof protos.backpack.DtoGoods?(t.data=e,t.txt_lock.text=""):(t.data=e.dtoequ,t.txt_lock.text=e.getinfo),t._offsetY=240,t._icon.bindData=t.data.goodsId;var i=t.data.cfgIdx,n=Bi.MODEL.name(i);n+="Lv.1",t.txtName.text=n,t.txtName.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(i)),t.img_quality.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+Bi.MODEL.colourId(i)+".png");var s,o=Bi.MODEL.attributes(i);s=aa.formatAttrToChineseByList(o);for(var a=0;a<s.length;a++){var r=s[a],l=aa.getAttributById(r.id).getModuleName(r.module)+":",c=r.val+"";t["txt_attr"+(a+1)].changeText(l+c),t.baseAttrY=t["txt_attr"+(a+1)].y+t["txt_attr"+(a+1)].height}t.totalH=440+41*s.length,t.showFullAttr(),t.img_line.y=t.totalH+20,t.txt_lock.y=t.img_line.y+20,t.img_bg.height=t.totalH+88,Bi.MODEL.achieving(t.data.cfgIdx)?(t._achieves||(t._achieves=new OQ(ql.create(t,t.onClickGetInfoListener,null,!1))),t._achieves.pos(0,t.img_bg.height),t._achieves.width=t.width,t._achieves.height=214,t.addChild(t._achieves),t._achieves.update(t.data.goodsId)):t._achieves&&t._achieves.removeSelf()}if(t._achieves._childs)for(var u=0;u<t._achieves._childs.length;u++)t._achieves._childs[u]&&t._achieves._childs[u]instanceof layouts.bag.AchieveItemNewLayoutUI&&(t._achieves._childs[u].width=390);null!=t._achieves.lst_bg.dataSource?t.height=t.img_bg.height+180+70*t._achieves.lst_bg.dataSource.length:t.height=t.img_bg.height,t.tip_bottom.top=t.height-50,t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.showFullAttr=function(){var e=this;e.box_fullAttr.visible=!0,e.box_fullAttr.y=e.baseAttrY+20,null==e._fullAttrTxt&&(e._fullAttrTxt=new Yp,e._fullAttrTxt.fontSize=24,e._fullAttrTxt.font=dr.font,e._fullAttrTxt.width=300,e._fullAttrTxt.wordWrap=!0,e._fullAttrTxt.color="#23b11f",e._fullAttrTxt.align="left",e.addChild(e._fullAttrTxt)),e._fullAttrTxt.pos(e.txt_attr1.x,e.box_fullAttr.y+48);for(var t="",i=0,n=0;n<Yt.count;n++)if(Yt.MODEL.toolsId(n)==e.data.goodsId){i=Yt.MODEL.maxDragonID(n);break}var s,o=jt.MODEL.attrs(i);for(s=aa.formatAttrToChineseByList(o),n=0;n<s.length;n++){var a=s[n];t+=aa.getAttributById(a.id).getModuleName(a.module)+":"+(a.val+""),n<s.length-1&&(t+="\n")}e.totalH=e._fullAttrTxt.y+44*s.length,e._fullAttrTxt.text=t,e._fullAttrTxt.leading=20},i.drawAttr=function(e,t,i,n,s,o,a){this.graphics.fillText(e,s,this._offsetY,o+"px SimHei",t,"left");var r=s+(mp.getStringLength(e)*o>>1)+4;this.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClickGetInfoListener=function(e){this.close(!0)},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.longwen.LongwenViewTipsUI._$SET_instance),t._instance=null,t}(),Yj=function(e){function t(){var e=this;e.longwenData=null,e.img=null,e.dragonList=[],e.count=0,t.__super.call(e),e.centerX=0,e.centerY=0,e.y=60,e.longwenData=lR.instance(),e.initUI()}b(t,"modules.actor.views.longwen.LongWenZongLanView",Bc);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.longwenPanel.vScrollBar.off("change",this,this.onScrollChanged),laya.ui.View.prototype.destroy.call(this,e)},i.showDragonInfo=function(e){var t=this;void 0===e&&(e=1),t.longwenPanel.vScrollBar.on("change",t,t.onScrollChanged);var i,n,s=t.count=0,o=0,a=Yt.count,r=new jl,l=[];for(s=0;s<a;s++)if(Yt.MODEL.lType(s)==e){var c=Yt.MODEL.unlock(s),u={showDragonId:Yt.MODEL.showDragonID(s),dragonId:Yt.MODEL.toolsId(s),lock:c,name:Yt.MODEL.chineseNum(s)};o!=c&&(l=[],o=c),l.push(u),r.put(c,l)}var d=0;for(var h=0 in r.proto)if(0==h){t.box_dft.visible=!0;var _=r.proto[h];for(s=0;s<_.length;s++)(i=new qj).x=15+s%5*129,i.y=45+154*Math.floor(s/5),(n=KH.create(_[s].dragonId)).dragonIndex=1,i.data={vo:n,index:-1},t.longwenPanel.addChild(i),d=i.y,t.dragonList.push(i),i.on("click",t,t.onClick,[,[n,RP.n[276]]])}else{t.box_dft.visible=!1;var f=new Fj;f.data={dragons:r.proto[h],key:h},t.longwenPanel.addChild(f),f.x=6,f.y=i?d+i.height+20+t.count*f.height:d+t.count*f.height,t.count++}t.img.height=d+120,t.img.visible=!!i,t.btnClose.on("click",t,t.onCloseEvent)},i.onClick=function(e,t){var i={dtoequ:t[0],getinfo:t[1]};Wj.instance.show(i)},i.onCloseEvent=function(e){hN.ins.isOpen("LONGWEN_YULAN_PANEL")&&hN.ins.close("LONGWEN_YULAN_PANEL")},i.closeDragonView=function(){for(var e,t=0;t<this.dragonList.length;t++)null!=(e=this.dragonList[t]).parent&&e.parent.removeChild(e),e.destroy(),e=null;this.dragonList=[]},i.initUI=function(){this.img=new Kl,this.img.skin=_r.getAtlasSubPath("basic_ui_3/ty_jmlb_db.png"),this.longwenPanel.addChild(this.img),this.img.pos(6,35),this.img.width=640,this.img.sizeGrid="22,20,25,19",this.longwenPanel.vScrollBarSkin="",this.longwenPanel.vScrollBar.elasticDistance=300},i.onScrollChanged=function(){0==this.longwenPanel.vScrollBar.max||this.longwenPanel.vScrollBar.value>=this.longwenPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),zj=function(e){function t(){this._type=0,this._grid=null,this._dtoGoods=null,this._exchangeType=0,this._propIds=[4,8,9],this._canExchange=!1,this._enpughGold=!1,this._handEff=null,t.__super.call(this)}b(t,"modules.actor.views.lunhui.LunhuiExchangeItem",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF,this._grid.x=14,this._grid.y=12,this.addChild(this._grid),this.btn_exchange.on("click",this,this.onClick)},i.setBtnGray=function(e){this.btn_exchange.gray=e,this.btn_exchange.mouseEnabled=!e},i.showRedPoint=function(){var e=gR.ins.lunhuiId;e||(e=1);var t=gR.ins.lunhuiRemainTime,i=!1;if(0==this._type)80<gR.ins.lv&&0<t[0]&&(i=!0);else{var n=(1==this._type?Ji.MODEL.costSeniorItem(Ji.getIndex(e)).split(","):Ji.MODEL.costSuperItem(Ji.getIndex(e)).split(","))[0];0<TR.ins.getGoodsNum(n)&&t[this._type]&&(i=!0)}this.btn_exchange.showTip=i},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0),this._grid=null,this._dtoGoods=null,this.btn_exchange.off("click",this,this.onClick)},i.onClick=function(e){this._canExchange?this._enpughGold?nR.reqLunhuiExchange(this._exchangeType):KQ.ins.showNoGold():zB.ins.showById(102,1)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(or,t,"dataSource",e),t._type=parseInt(e),gR.ins.lunhuiRemainTime&&(t.txt_des4.innerHTML=RP.n[277]+Ql.createColor(gR.ins.lunhuiRemainTime[t._type]+"","#23b11f")+"次",0==gR.ins.lunhuiRemainTime[t._type]?t.setBtnGray(!0):t.setBtnGray(!1));var i=0,n="",s=0;t._enpughGold=!0,i=t._propIds[t._type];var o=gR.ins.lv,a=gR.ins.zsLv,r=gR.ins.lunhuiId,l=(Ki.MODEL.level(Ki.getIndex(r)),Ki.MODEL.tier(Ki.getIndex(r)),-1);if(1==t._type?0<=(l=Ji.getIndex(r))&&(i=Ji.MODEL.costSeniorItem(l).split(",")[0],n=Ji.MODEL.seniorItemToYeli(l),s=Ji.MODEL.seniorItemNeedGold(l).split(":")[1]):2==t._type?0<=(l=Ji.getIndex(r))&&(i=Ji.MODEL.costSuperItem(l).split(",")[0],n=Ji.MODEL.SuperItemToYeli(l),s=Ji.MODEL.SuperItemNeedGold(l).split(":")[1]):80<o?(l=Zi.getIndex(o),n=Zi.MODEL.expExToYeli(l),0<gR.ins.lunhuiRemainTime[t._type]&&t.setBtnGray(!1)):(n=Zi.MODEL.expExToYeli(Zi.getIndex(81)),t.setBtnGray(!0),t.txt_des4.innerHTML=Ql.createColor(RP.n[278],"#e70909")),t._dtoGoods=yB.create(i),t._grid.bindData=t._dtoGoods,n&&-1!=n.indexOf(".")&&(n=n.slice(0,-2)),t.txt_des1.innerHTML="增加"+Ql.createColor(n,"#23b11f")+"业力",t.txt_des5.text="",t.btn_exchange.visible=!0,t._canExchange=!0,0<t._type){var c=Bi.getIndex(i),u=TR.ins.getGoodsNum(i);if(0<u?(t.btn_exchange.label="兑 换",t._exchangeType=1==t._type?2:3,t.img_gold.visible=!1,t.txt_des2.text="剩余"+u+"个",t.txt_des2.color="#23b11f",t.txt_des3.text=""):(t.btn_exchange.label=RP.n[279],t._exchangeType=1==t._type?2:3,t.img_gold.visible=!0,t.txt_des2.text=Bi.MODEL.name(c),t.txt_des2.color="#e3dcc2",t.txt_des3.text=s+"",gR.ins.YB<s&&(t._enpughGold=!1)),2==t._type){var d=$e.MODEL.value($e.getIndex(236)).split(","),h=parseInt(d[0]);a<h&&(t.img_gold.visible=!1,t.txt_des5.text=RP.n[280]+h+"转开放",t.txt_des4.innerHTML="",t.txt_des3.text="",t.btn_exchange.visible=!1,t._canExchange=!1)}}else t.btn_exchange.label="兑 换",t._exchangeType=1,t.img_gold.visible=!1,t.txt_des2.text=RP.n[281],t.txt_des3.text="";t.showRedPoint()}),t}(or),Xj=function(e){function t(){var e=this;e.initCurX=0,e.initNextX=0,e.listLength=0,e.fightValue=0,t.__super.call(e),e.initCurX=e.boxCur.x,e.initNextX=e.boxNext.x,e.listLength=5}return b(t,"modules.actor.views.lunhui.LunhuiAttrItem",Yc),t.prototype.update=function(e){var t,i=this;void 0===e&&(e=1);var n=[],s=[];if(1<e){n=aa.formatAttrToChineseByList(Ki.MODEL.attr(Ki.getIndex(e)));var o=Ki.MODEL.attr(Ki.getIndex(e));if(o){var a=JSON.parse(o);a&&(i.fightValue=RR.getFight(a))}}var r=Ki.getIndex(e+1);0<=r&&(s=aa.formatAttrToChineseByList(Ki.MODEL.attr(r)));if(1==e?(i.boxCur.visible=!1,i.boxNext.visible=!0,i.img_arrow.visible=!1,i.boxNext.centerX=0):0<=r?(i.boxCur.visible=!0,i.boxNext.visible=!0,i.img_arrow.visible=!0,i.boxCur.x=i.initCurX,i.boxNext.x=i.initNextX):(i.boxCur.visible=!0,i.boxNext.visible=!1,i.img_arrow.visible=!1,i.boxCur.centerX=0),1<e)for(var l=0;l<i.listLength;l++){var c=i["txt_curName"+(l+1)],u=i["txt_curAttr"+(l+1)],d=i["img_numBg1_"+(l+1)];l<n.length?(t=n[l],c.text=t.name+": ",u.text=t.val,d.visible=!0,0):(c.text="",u.text="",d.visible=!1)}if(0<=r)for(l=0;l<i.listLength;l++){var h=i["txt_nextName"+(l+1)],_=i["txt_nextAttr"+(l+1)],f=i["img_numBg2_"+(l+1)];l<s.length?(t=s[l],h.text=t.name+": ",_.text=t.val,f.visible=!0,0):(h.text="",_.text="",f.visible=!1)}},t}(),Qj=function(e){function t(){this.goodsGrid=null,t.__super.call(this),this.img_tools.visible=!1,this.html_num.style.font="SimHei",this.html_num.style.fontSize=20,this.html_num.style.align="right"}b(t,"modules.actor.views.mo.MoEquipComposeItem",Uu);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"data",null,function(e){var t=this;if(e){if(null==t.goodsGrid&&(t.goodsGrid=new MF(93)),null==t.goodsGrid.parent&&t.addChildAt(t.goodsGrid,0),t.goodsGrid.needNum=!1,t.goodsGrid.bindData=e.dto,t.goodsGrid.bindData instanceof protos.backpack.DtoEquip)t.html_num.innerHTML="<font style ='color:#23b11f'>1/</font><font style ='color:#90877b'>"+e.needNum+"</font>";else{var i=TR.ins.getGoodsNum(e.dto.goodsId);i>=e.needNum?t.html_num.innerHTML="<font style ='color:#23b11f'>"+i+"/</font><font style ='color:#90877b'>"+e.needNum+"</font>":t.html_num.innerHTML="<font style ='color:#ff0000'>"+i+"/</font><font style ='color:#90877b'>"+e.needNum+"</font>"}t.txt_name.text=e.name,t.txt_name.color=e.color,t.goodsGrid.pos(t.img_tools.x,t.img_tools.y)}}),t}(),Jj=function(e){function t(){this.suitType=0,this.starLevel=0,this.magicStatus=0,this.buffId=0,this.activeEff=null,this.eff=null,t.__super.call(this)}b(t,"modules.actor.views.mo.MoEquipSkillTipsUI",Qm);var i=t.prototype;return i.show=function(e,t){var i=this;i.parent||(eq.panelLayer.once("MASK_CLOSE",i,i.onClick),eq.panelLayer.open(i)),i.Stitle.text=nn.MODEL.name(e),i.starLevel=nn.MODEL.starLevel(e),i.suitType=nn.MODEL.suitType(e),i.SAct.text=RP.n[282]+i.starLevel+RP.n[283];for(var n="[",s=nn.MODEL.positions(e),o=0;o<s.length;o++){var a=_R.ins.getEquipByPosition(s[o],t),r=!1;a&&a.magicStarLevel>=i.starLevel&&(r=!0),n+=r?"<font style='color:#23b11f;'>"+la.getName(s[o])+"&nbsp;</font>":"<font style='color:#90877b;'>"+la.getName(s[o])+"&nbsp;</font>"}n+="]",i.SPart.innerHTML=n,i.buffId=nn.MODEL.buffIds(e),502==i.buffId?(i.SImg.visible=i.g_sbroad.visible=!1,i.img_0.skin="ui/layouts/actormo/mz_text_mhcr.png",i.img_1.skin=_r.getLayoutsImagePath("actormo/bh_jm_jy_1.png"),i.img_1.width=122,i.img_1.height=442,i.img_1.rotation=-45,i.img_1.x=50,i.img_1.y=173,i.setSkillEff()):(i.SImg.visible=i.g_sbroad.visible=!0,i.img_0.skin="",i.img_1.skin="",i.img_1.scaleX=1,i.img_1.scaleY=1,i.img_1.width=400,i.img_1.height=300,i.img_1.rotation=0,i.img_1.x=-10,i.img_1.y=170,i.clearSkillEff(),i.SImg.skin=_r.getFullUrl("ui/images/skill/buff/"+nn.MODEL.buffIds(e)+".jpg"),500==i.buffId&&(i.img_1.skin=_r.getLayoutsImagePath("actormo/000.png"))),i.SDesc.style.leading=18,i.SDesc.innerHTML=nn.MODEL.buffMessage(e);var l=_R.ins.getActivePartsBySkill(s,i.starLevel,t).length==s.length;if(_R.ins.isSkillActive(i.buffId,t)?i.magicStatus=1:i.magicStatus=0,1==i.magicStatus){i.btn_active.gray=!1,i.btn_active.mouseEnabled=!0;var c=gR.ins.currentSelectRoleIndex+1,u=_R.ins.data30617Hash,d=!1,h=_R.ins.getMagicSoulId(i.buffId);if(u&&0<h&&(d=u.take(c+"_"+h)),d){var _=gR.ins.actorById(c),f=on.getIndex(h),p=on.MODEL.effectId(f);_.magicId==p?(i.magicStatus=3,i.btn_active.label="脱 下"):(i.magicStatus=2,i.btn_active.label="穿 戴")}i.btn_active.showTip=!1}else i.btn_active.label="激 活",i.btn_active.showTip=l,i.btn_active.gray=!l,i.btn_active.mouseEnabled=l;i.btn_active.visible=1!=i.magicStatus,i.btn_active.on("click",i,i.activeSkill)},i.onClick=function(e){this.close(!0)},i.close=function(e){void 0===e&&(e=!1),this.activeEff&&(this.activeEff=null),this.clearSkillEff(),this.btn_active.off("click",this,this.activeSkill),eq.panelLayer.off("MASK_CLOSE",this,this.onClick),eq.panelLayer.close(this)},i.setSkillEff=function(){this.clearSkillEff(),this.eff||(this.eff=kB.createEffect("jm1352",270,320,this))},i.clearSkillEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.activeSkill=function(e){var t=this,i=gR.ins.currentSelectRoleIndex+1;if(0==t.magicStatus)_R.reqActiveMoEquip(i,t.suitType,t.starLevel),t.activeEff&&t.activeEff.dispose(),t.activeEff=kB.createEffect("jm1426",eq.effectLayer.width/2,eq.effectLayer.height/2,eq.effectLayer);else if(0<t.buffId){var n=_R.ins.getMagicSoulId(t.buffId);2==t.magicStatus?_R.reqWearMoSkill(i,n):3==t.magicStatus?_R.reqTakeOffMoSkill(i,n):4==t.magicStatus&&_R.reqActiveMoSkill(i,t.suitType,t.starLevel,n)}t.buffId=0,t.close()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.mo._MoEquipSkillTipsUI._$SET_instance),t._instance=null,t}(),Zj=function(e){function t(){var e=this;e.img_tools=null,e._iconId="",e._color=3,e._equipAttr_pt_Txt=null,e._equipAttr_ts_Txt=null,e.effect=null,e.status=0,e.position=0,e.dto=null,e._y=0,e._achieves=null,e.tipBtnRPArr=null,e.btnHeight=0,e.isAllOK=!0,e._box=null,t.__super.call(e),e.initUI()}b(t,"modules.actor.views.mo.MoEquipToolTip",Zm);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.initUI=function(){var e=this;e.centerX=e.centerY=0,e.img_tools=new Kl,e.img_tools.pos(e.imgTool.x,e.imgTool.y),e.addChild(e.img_tools),e._equipAttr_pt_Txt=new Fl,e._equipAttr_pt_Txt.style.fontSize=24,e._equipAttr_pt_Txt.style.font="SimHei",e._equipAttr_pt_Txt.style.color="#90877b",e._equipAttr_pt_Txt.style.leading=20,e._equipAttr_pt_Txt.width=600,null==e._equipAttr_pt_Txt.parent&&e.panel_content.addChild(e._equipAttr_pt_Txt),e._equipAttr_pt_Txt.x=32,e._equipAttr_pt_Txt.y=10,e.panel_content.vScrollBar.elasticDistance=300},i.setButtonsState=function(){var e=this;switch(e.btnHeight=0,e.img_line.visible=!0,e.btn_hqzb.visible=!1,e.status){case 1:case 3:e.btn_jh.visible=!0,e.btn_jj.visible=e.btn_hc.visible=e.btn_hqzb.visible=e.btn_th.visible=e.btn_xx.visible=!1,e.btn_jh.x=215,e.btnHeight=60;break;case 2:case 5:case 6:e.btn_hc.visible=!0,e.btn_jj.visible=e.btn_jh.visible=e.btn_hqzb.visible=e.btn_th.visible=e.btn_xx.visible=!1,e.btn_hc.x=215,e.btnHeight=60;break;case 10:e.btn_jj.visible=e.btn_hc.visible=e.btn_jh.visible=e.btn_th.visible=e.btn_xx.visible=!1,e.btn_hqzb.x=215;break;case 9:case 12:case 13:e.btn_th.visible=e.btn_xx.visible=!0,e.btn_jj.visible=e.btn_hc.visible=e.btn_jh.visible=e.btn_hqzb.visible=!1,e.btn_th.x=100,e.btn_xx.x=330,e.btnHeight=60;break;case 4:e.btn_hc.visible=!0,e.btn_th.visible=e.btn_xx.visible=e.btn_jh.visible=e.btn_hqzb.visible=!1,_R.ins.isMaxStarLevel(e.position,gR.ins.currentSelectRoleIndex+1)?(e.btn_hc.x=215,e.btn_jj.visible=!1):(e.btn_hc.x=330,e.btn_jj.x=100,e.btn_jj.visible=!0),e.btnHeight=60;break;case 8:e.btn_hc.visible=e.btn_th.visible=e.btn_xx.visible=!0,e.btn_jj.visible=e.btn_jh.visible=e.btn_hqzb.visible=!1,e.btn_hc.x=60,e.btn_xx.x=370,e.btn_th.x=215,e.btnHeight=60;break;default:e.btn_hc.visible=e.btn_jj.visible=e.btn_jh.visible=e.btn_hqzb.visible=e.btn_th.visible=e.btn_xx.visible=!1,e.img_line.visible=!1}if(e.btn_hc.showTip=e.btn_jj.showTip=e.btn_jh.showTip=e.btn_hqzb.showTip=e.btn_th.showTip=e.btn_xx.showTip=!1,e.tipBtnRPArr&&0<e.tipBtnRPArr.length)for(var t=0;t<e.tipBtnRPArr.length;t++)e[e.tipBtnRPArr[t]].showTip=!0},i.setBaseInfo=function(){var e=this,t=e.dto.cfgIdx;e._color=Bi.MODEL.colourId(t),e.txt_title.text=e.dto.name,e.txt_title.color=ms.getByQuality(e._color),e._iconId=Bi.MODEL.icon(t),e.txt_type.changeText("魔装"),e.txt_part.changeText(la.getName(e.position));var i=Bi.MODEL.flyLevel(t),n=Bi.MODEL.minUseLevel(t);0<i?(e.txt_level.changeText(i+"转"),e.txt_level.color=gR.ins.zsLv>=i?"#90877b":"#ff2e24"):(e.txt_level.changeText(n+"级"),e.txt_level.color=gR.ins.lv>=n?"#90877b":"#ff2e24"),1<e._color?(e.img_color.visible=!0,e.img_color.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+e._color+".png")):e.img_color.visible=!1,e.refresh();var s=_R.ins.getEquipFighting(e.dto);e.fightNum.value=s;for(var o=Bi.MODEL.attributes(t),a=aa.formatAttrToChineseByList(o),r="",l={},c=0;c<a.length;c++)r+=(l=a[c]).addName+": "+l.val+"<br/>";null==e._equipAttr_pt_Txt.parent&&(e.panel_content.addChild(e._equipAttr_pt_Txt),e._equipAttr_pt_Txt.x=32),e._equipAttr_pt_Txt.innerHTML=r,e.txt_pingfen.text=RP.n[284]+(e.dto.moEquipScore||s),e._equipAttr_pt_Txt.y=e.txt_1.y+50,e._$7__y=e._equipAttr_pt_Txt.y+e._equipAttr_pt_Txt.contextHeight},i.setOtherInfo=function(){_R.isSimpleMoEquip(this.position)&&(0<this.dto.position&&this.addZhuHunInfo(),this.addElementInfo());var e=this.getRealSuitID();this.addSuitInfo(e,32,this._$7__y);var t=nn.getIndex(e),i=nn.MODEL.suitType(t),n=t+1,s=nn.MODEL.key(n),o=nn.MODEL.suitType(n);i==o&&o<4&&this.addSuitInfo(s,32,this._$7__y)},i.addZhuHunInfo=function(){this.createInfoTitleBar(RP.n[285],this._$7__y);var e=kB.createHtmlDiv(32,this._$7__y+40,24,"#90877b",400);e.style.leading=20,this.panel_content.addChild(e);var t=fR.ins.getMappingResIndex(this.dto.magicStarLevel),i=ln.MODEL.maxTier(t),n=ln.MODEL.maxLevel(t),s=gR.ins.currentSelectRoleIndex+1,o=fR.ins.getZhuHunResIndex(s,this.position),a=cn.MODEL.tier(o),r=cn.MODEL.level(o);(i<a||a==i&&n<r)&&(o=fR.ins.getZhuHunResIndex2(this.position,i,n)),e.innerHTML=aa.formatAttrToText(cn.MODEL.attrs(o),"<br/>"),this._$7__y=e.y+e.contextHeight+50},i.addElementInfo=function(){this.createInfoTitleBar(RP.n[286],this._$7__y);var e=kB.createHtmlDiv(32,this._$7__y+40,24,"#90877b",400);e.style.leading=20,this.panel_content.addChild(e);var t=0;if(this.dto.buffs){var i="";for(var n in this.dto.buffs){var s=this.dto.buffs[n];t=Ls.getIndex(parseInt(n));var o,a=Ls.MODEL.skillDesc(t);for(var r in s){o=s[r],i+=a?mp.getFormat(a,[o/100])+"<br/>":o/100+"<br/>";break}}e.innerHTML=i}else t=tn.getIndex(this.position-67),e.innerHTML=tn.MODEL.expSpecAttr(t);this._$7__y=e.y+e.contextHeight+50},i.addSuitInfo=function(e,t,i){var n=nn.getIndex(e),s=nn.MODEL.positions(n),o=nn.MODEL.starLevel(n);this.isAllOK=!0;for(var a="",r=0;r<s.length;r++)a+=this.getColorEquipName(s[r],o);var l=this.isAllOK?"#23b11f":"#90877b",c=kB.createHtmlDiv(t,i+40,24,l,400);c.style.leading=20,this.panel_content.addChild(c);var u=nn.MODEL.buffMessage(n);c.innerHTML="[&nbsp;"+a+"]<br/>"+u,this._$7__y=c.y+c.contextHeight+50;var d=nn.MODEL.name(n);this.createInfoTitleBar(d,i)},i.getColorEquipName=function(e,t){var i=la.getName(e),n=_R.ins.getEquipByPosition(e);return null!=n&&n.magicStarLevel>=t?"<font style='color:#23b11f;'>"+i+"</font>&nbsp;":(this.isAllOK=!1,"<font style='color:#90877b;'>"+i+"</font>&nbsp;")},i.getRealSuitID=function(){var e=tn.getIndex(this.position-67),t=tn.MODEL.suitMinId(e),i=tn.MODEL.suitType(e),n=nn.getIndex(t),s=nn.MODEL.positions(n),o=nn.MODEL.starLevel(n);if(_R.ins.isSuitEquip(s,o,gR.ins.currentSelectRoleIndex+1)){for(var a=9999,r=0;r<s.length;r++){var l=_R.ins.getEquipByPosition(s[r]);if(null!=l){var c=Bi.MODEL.magicStarLevel(l.cfgIdx);c<a&&(a=c)}}if(9999==a)return t;for(var u=nn.count,d=0,h=0;h<u;h++)nn.MODEL.suitType(h)==i&&nn.MODEL.starLevel(h)<=a&&(d=nn.MODEL.key(h));return t<d?d:t}return t},i.createInfoTitleBar=function(e,t){kB.createSprite("ui/layouts/basic_ui/ty_tips_btfg.png",160,t+10,0,0,this.panel_content).scaleX=-1;kB.createSprite("ui/layouts/basic_ui/ty_tips_btfg.png",383,t+10,0,0,this.panel_content);var i=kB.createText(73,t,400,0,e,28,"#e6d80d");i.font="SimHei",this.panel_content.addChild(i)},i.show=function(e){var t,i=this;if(i.status=_R.ins.curStatus,i.position=_R.ins.curPosition,e?e instanceof protos.backpack.DtoEquip?t=e:e.dto instanceof protos.backpack.DtoEquip&&(t=e.dto):t=_R.ins.getEquipByPosition(i.position),t)i.dto=t;else{var n=tn.getIndex(i.position-67),s=tn.MODEL.initGoodsID(n);i.dto=KH.create(s)}i.setButtonsState(),i.setBaseInfo(),i.setOtherInfo(),i.panel_content.vScrollBar.hide=i.panel_content.height>i.panel_content.contentHeight,i.parent||(eq.panelLayer.once("MASK_CLOSE",i,i.onClick),eq.panelLayer.open(i)),i.addBtnEvents(),i.panel_content.vScrollBar.value=0,i.timerOnce(30,i,i.onScrollEnd),i.panel_content.vScrollBar.on("change",i,i.onScrollEnd),i.setMoEquitStar(t?t.goodsId:s);var o=0;i.setAchieving(t?t.goodsId:s),i._achieves&&i._achieves.parent&&(o=i._achieves.height),i.img_bg.height=820+i.btnHeight,i._achieves&&(i._achieves.y=i.img_bg.height),i.height=i.img_bg.height+o},i.onClick=function(e){this.close(!0)},i.onBtnClicked=function(e){var t=this;switch(e.target){case t.btn_hc:Bi.MODEL.magicSpecialPosition(t.dto.cfgIdx)?hN.ins.open("MO_EQUIP_OPERATE",{_subIndex_:parseInt("1"),part:t.dto.decoratePosition},"MO_MAIN_VIEW"):Tu.sendToModule("OPEN_MO_Main_COMPOSE",["modules.actor.ActorModule"],{part:t.dto.decoratePosition});break;case t.btn_jh:case t.btn_jj:hN.ins.open("MO_EQUIP_OPERATE",{_subIndex_:parseInt("0"),part:t.dto.decoratePosition},"MO_MAIN_VIEW");break;case t.btn_th:Tu.sendToModule("OPEN_MO_EQUIP_SELECT",["modules.actor.ActorModule"],{position:t.dto.decoratePosition,minLevel:0,type:0});break;case t.btn_xx:var i=gR.ins.currentSelectRoleIndex+1;if(fR.ins.isSuitByPosition(i,t.position)){var n=Ql.createColor(RP.n[287],"#ff2e24");KQ.ins.show(RP.n[288]+n+RP.n[289],ql.create(t,t.onXXAlertHandler,[i,t.position]),!1)}else _R.reqMagicUnloadPacket(i,t.position);break;case t.btn_hqzb:t.onHQZBClicked(e)}t.close()},i.addBtnEvents=function(){var e=this;e.btn_hc.on("click",e,e.onBtnClicked),e.btn_jh.on("click",e,e.onBtnClicked),e.btn_th.on("click",e,e.onBtnClicked),e.btn_jj.on("click",e,e.onBtnClicked),e.btn_xx.on("click",e,e.onBtnClicked),e.btn_hqzb.on("click",e,e.onBtnClicked)},i.removeBtnEvents=function(){var e=this;e.btn_hc.off("click",e,e.onBtnClicked),e.btn_jh.off("click",e,e.onBtnClicked),e.btn_th.off("click",e,e.onBtnClicked),e.btn_jj.off("click",e,e.onBtnClicked),e.btn_xx.off("click",e,e.onBtnClicked),e.btn_hqzb.off("click",e,e.onBtnClicked)},i.close=function(e){var t=this;void 0===e&&(e=!1),t.removeBtnEvents(),G.timer.clearAll(t),t.panel_content.vScrollBar.off("change",t,t.onScrollEnd),t.effect&&(t.effect.parent&&t.effect.parent.removeChild(t.effect),t.effect.dispose(),t.effect=null),t.dto=null,t.panel_content.content.removeChildren(5),eq.panelLayer.off("MASK_CLOSE",t,t.onClick),eq.panelLayer.close(t),t._box&&t._box.graphics.clear(),Zl.clearIconTexture(t)},i.refresh=function(){var e=this;if(e.img_tools.graphics.clear(),e.graphics.clear(),0<e._color){var t=NI.gridBg(e._color),i=G.loader.getRes(t);i&&e.img_tools.graphics.drawTexture(i,0,0,106,106),e._iconId&&((i=NR.getIcon(e._iconId))?e.drawIcon(i):NR.loadIcon(e._iconId,ql.create(e,e.drawIcon)))}},i.drawIcon=function(e){e&&this.img_tools.graphics.drawTexture(e,3,3,100,100),e&&Zl.addIconUse(this,e.url)},i.onScrollEnd=function(){this.panel_content.vScrollBar.value==this.panel_content.vScrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},i.setMoEquitStar=function(e){var t=this;if(t._box&&t._box.graphics.clear(),t._box&&t._box.scale(1,1),_R.getIsMoEquit(e)){t._box||(t._box=new dt,t.addChild(t._box));var i=Bi.MODEL.magicStarLevel(Bi.getIndex(e));if(!_R.getIsMoEquitSpecial(e))return t._box.pos(t.imgTool.x+5,t.imgTool.y),t._box.graphics.drawTextures(_R.starBgTexture,[0,0]),void t._box.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"repeat-x",new Uh(26*(10-i),0));var n=Math.floor(i/6),s=Math.floor(i%6);t._box.pos(t.imgTool.x+2,t.imgTool.y+78);for(var o=0;o<s;o++)t._box.graphics.drawTextures(_R.getStarTexture(n),[_R.getStartX(s)+44*o,0]);t._box.scaleX=t._box.scaleY=.45}},i.onXXAlertHandler=function(e,t,i){1==i&&_R.reqMagicUnloadPacket(e,t)},i.onHQZBClicked=function(e){var t=Bi.MODEL.achieving(this.dto.cfgIdx);if(t&&0<t.length){var i=t.split("|"),n=parseInt(i[0]);if(2!=n&&6!=n)return;if(6==n){var s=parseInt(i[3]);if(!GR.getInstance().checkModuleOpen(s))return void zB.ins.showMsg(GR.getInstance().getErrorTips(s),1)}else if(2==n){var o=parseInt(i[3]);if(gR.ins.lv<o)return void zB.ins.showMsg(RP.n[290]+o+"级开启",1)}var a=i[1];hN.ins.open(a,{_subIndex_:parseInt(i[2])},null,!0)}},i.setAchieving=function(e){null!=this.dto&&(Bi.MODEL.achieving(Bi.getIndex(e))?(this._achieves||(this._achieves=new OQ(ql.create(modules.actor.views.mo.MoEquipToolTip.instance,modules.actor.views.mo.MoEquipToolTip.instance.close,null,!1))),this.addChild(this._achieves),this._achieves.update(e)):this._achieves&&this._achieves.removeSelf())},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.mo._MoEquipToolTipUI._$SET_instance),t._instance=null,t}(),Kj=function(e){function t(){this.m_uId=0,this.g_item=null,this.decoratePosition=0,this.func="",this.state=0,t.__super.call(this)}b(t,"modules.actor.views.mo.suit.MoZhuHunAttrItem",e);var i=t.prototype;return i.onClickHandler=function(e){},i.isWanRate=function(e){return e==aa.UNION_DAM_INC_RATE.keyStr||e==aa.UNION_DAM_INC_RATE_PVE.keyStr||e==aa.UNION_DAM_DEC_RATE.keyStr},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.txt_current.x=27,t.txt_next.x=398;var i,n=e.current;n&&(i=n.value,t.isWanRate(n.type)&&(i=(parseInt(n.value)/100).toFixed(2)+"%"),t.txt_current.text=aa[n.type].nameSpe+"："+i);var s=e.next;s?(i=s.value,t.isWanRate(s.type)&&(i=(parseInt(s.value)/100).toFixed(2)+"%"),t.txt_next.text=i+"",t.img_up.visible=!n||s.value>n.value,t.img_up.x=t.txt_next.width+t.txt_next.x+6):(t.txt_next.visible=!1,t.img_up.visible=!1,t.txt_current.x=183)}}),t}(nd),$j=function(e){function t(){var e=this;e.img_tools=null,e._iconId="",e._goodsID=0,e._color=3,e.effect=null,e.value=null,e.position=0,e.dto=null,e._$7__y=0,e.hasMoEquip=!1,e.grids=[],e.consuptions=[],e.isAllOK=!0,t.__super.call(e),e.initUI()}b(t,"modules.actor.views.mo.suit.MoEquipSuitTip",Jm);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.initUI=function(){this.centerX=this.centerY=0,this.img_tools=new Kl,this.img_tools.pos(this.imgTool.x,this.imgTool.y),this.addChild(this.img_tools),this.panel_content.vScrollBar.elasticDistance=200},i.setBaseInfo=function(){var e=this,t=e.value.jie||0,i=e.value.level||0,n=fR.ins.getZhuHunResIndex2(e.position,t,i);e._goodsID=cn.MODEL.goodsId(n),e.value.goodsID=e._goodsID;var s=Bi.getIndex(e._goodsID);e._color=Bi.MODEL.colourId(s),e.txt_title.text=cn.MODEL.name(n),e.txt_title.color=ms.getByQuality(e._color),e._iconId=Bi.MODEL.icon(s),e.txt_part.changeText(la.getName(e.position)),e.txt_level.text=t+"阶"+i+"级",1<e._color?(e.img_color.visible=!0,e.img_color.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+e._color+".png")):e.img_color.visible=!1,e.refresh();var o=fR.ins.isFull(e.position,t,i);!o&&e.value.showBtn&&e.setConsuption(n),e.txt_tips0.visible=!o&&e.value.showBtn,e.btn_zhuhun.showTip=e.value.showRed,e.btn_zhuhun.visible=e.value.showBtn},i.addZhuHunInfo=function(){var e=this;e.createInfoTitleBar(RP.n[285],e._$7__y);var t=e.hasMoEquip?"#90877b":"#5f5952",i=kB.createHtmlDiv(32,e._$7__y+40,24,t,400);i.style.leading=20,e.panel_content.addChild(i);var n=fR.ins.getMappingResIndex(e.dto.magicStarLevel),s=ln.MODEL.maxTier(n),o=ln.MODEL.maxLevel(n),a=e.value.actorId,r=fR.ins.getZhuHunResIndex(a,e.position);if(e.hasMoEquip){var l=cn.MODEL.tier(r),c=cn.MODEL.level(r);(s<l||l==s&&o<c)&&(r=fR.ins.getZhuHunResIndex2(e.position,s,o))}i.innerHTML=aa.formatAttrToText(cn.MODEL.attrs(r),"<br/>"),e._$7__y=i.y+i.contextHeight+30},i.setConsuption=function(e){var t=cn.MODEL.consumptionDef(e+1);if(t&&0<t.length)for(var i=JSON.parse(t),n=Math.min(3,i.length),s=[[200,735],[376,735],[200,786]],o=0;o<n;o++){var a=i[o].value.split(":"),r=parseInt(a[0]),l=parseInt(a[1]),c=TR.ins.getGoodsNum(r),u=l<=c?"#23b11f":"#ff2e24",d=kB.createHtmlDiv(60,0,22,"#90877b",200,50);d.innerHTML="<font color='"+u+"'>"+c+"</font>/"+l,this.addChild(d),d.pos(s[o][0],s[o][1]),this.consuptions.push(d);var h=new MF(45);h.needGridBg=!1,h.needEffect=!1,h.pos(s[o][0]-40,s[o][1]-10),this.addChild(h);var _=yB.create(r);h.bindData=_,this.grids.push(h)}},i.setGongMingState=function(){var e=this;e.createInfoTitleBar(RP.n[292],e._$7__y);var t=kB.createHtmlDiv(32,e._$7__y+40,24,"#90877b",440);t.style.leading=20,e.panel_content.addChild(t);var i=gR.ins.actorById(e.value.actorId),n=UN.getShenPart(e.position),s=i.equips.getPart(n),o=s&&0<s.positionLevel?"#23b11f":"#90877b",a=s&&0<s.positionLevel?s.positionLevel:0,r=RP.n[293]+Ql.createColor(AR.ins.getSuitEquipName2(n,a),o),l=e.value.jie||0,c=e.value.level||0,u=fR.ins.isSuitByPosition(e.value.actorId,e.position)?"#23b11f":"#90877b",d=RP.n[294]+Ql.createColor(l+"阶"+c+"级",u);t.innerHTML=r+d,e._$7__y=t.y+t.contextHeight;var h=kB.createHtmlDiv(32,e._$7__y+10,24,"#90877b",440);h.style.leading=10,e.panel_content.addChild(h);var _=RP.n[295];h.innerHTML=_,e._$7__y=h.y+h.contextHeight+30},i.setGongMingProperty=function(e,t){this.createInfoTitleBar(RP.n[296],this._$7__y);var i=0<t?"#90877b":"#5f5952",n=kB.createHtmlDiv(32,this._$7__y+40,24,i,500);n.style.leading=20,this.panel_content.addChild(n);var s=UN.getResonatePart(this.position,0),o=UN.getAttrByLevel(t||1,s)||"",a="";if(o&&0<o.length){var r=JSON.parse(o);if(r&&0<r.length)for(var l=r.length,c=0;c<l;c++){var u=r[c],d=u.value;if(u.type!=aa.GDR_ONE_HIT_RATE_REDUCE.keyStr&&u.type!=aa.GDR_ONE_HIT_RATE.keyStr||(d=(parseInt(d)/100).toFixed(2)+"%"),a+=aa[u.type].nameSpe+"："+d,c==l-1)break;a+="<br/>"}}n.innerHTML=a,this._$7__y=n.y+n.contextHeight+30},i.getColorEquipName=function(e,t){var i=la.getName(e),n=_R.ins.getEquipByPosition(e);return null!=n&&n.magicStarLevel>=t?"<font style='color:#23b11f;'>"+i+"</font>&nbsp;":(this.isAllOK=!1,"<font style='color:#90877b;'>"+i+"</font>&nbsp;")},i.createInfoTitleBar=function(e,t){kB.createSprite("ui/layouts/basic_ui/ty_tips_btfg.png",160,t+10,0,0,this.panel_content).scaleX=-1;kB.createSprite("ui/layouts/basic_ui/ty_tips_btfg.png",383,t+10,0,0,this.panel_content);var i=kB.createText(73,t,400,0,e,28,"#e6d80d");i.font="SimHei",this.panel_content.addChild(i)},i.show=function(e){var t=this;if(t.grids=[],t.consuptions=[],(t.value=e)&&e.data&&(t.value.jie=e.data.jie,t.value.level=e.data.level),t.position=e.position,t.dto=_R.ins.getEquipByPosition(t.position),t.hasMoEquip=null!=t.dto,!t.dto){var i=tn.getIndex(t.position-67),n=tn.MODEL.initGoodsID(i);t.dto=KH.create(n)}if(t._$7__y=5,t.setBaseInfo(),_R.isSimpleMoEquip(t.position)){t.addZhuHunInfo();var s=VN.ins.getActorResonateData(e.actorId),o=UN.getResonatePart(t.position,0);(!s||s[o]<1)&&t.setGongMingState();var a=s?s[o]:0,r=s?s.level:0;t.setGongMingProperty(r,a)}t.panel_content.vScrollBar.hide=t.panel_content.height>t.panel_content.contentHeight,e.showBtn||(t.height=710),t.addBtnEvents(),t.panel_content.vScrollBar.value=0,t.timerOnce(30,t,t.onScrollEnd),t.panel_content.vScrollBar.on("change",t,t.onScrollEnd),t.on("undisplay",t,t.close)},i.onClick=function(e){hN.ins.close("MO_ZHUHUN_TIPS")},i.onBtnClicked=function(e){switch(e.target){case this.btn_zhuhun:hN.ins.open("MO_EQUIP_ZHUHUN",this.value)}hN.ins.close("MO_ZHUHUN_TIPS")},i.addBtnEvents=function(){this.btn_zhuhun.on("click",this,this.onBtnClicked)},i.removeBtnEvents=function(){this.btn_zhuhun.off("click",this,this.onBtnClicked)},i.close=function(e){var t=this;void 0===e&&(e=!1),t.removeBtnEvents(),G.timer.clearAll(t),t.panel_content.vScrollBar.off("change",t,t.onScrollEnd),t.off("undisplay",t,t.close),t.effect&&(t.effect.parent&&t.effect.parent.removeChild(t.effect),t.effect.dispose(),t.effect=null),t.value=null,t.dto=null,t.panel_content.content.removeChildren();for(var i=0;i<t.grids.length;i++)t.removeChild(t.grids[i]),t.removeChild(t.consuptions[i]);t.grids=null,t.consuptions=null},i.refresh=function(){var e=this;if(e.img_tools.graphics.clear(),e.graphics.clear(),0<e._color){var t=NI.gridBg(e._color),i=G.loader.getRes(t);i&&e.img_tools.graphics.drawTexture(i,0,0,106,106),e._iconId&&((i=NR.getIcon(e._iconId))?e.drawIcon(i):NR.loadIcon(e._iconId,ql.create(e,e.drawIcon)))}},i.drawIcon=function(e){e&&this.img_tools.graphics.drawTexture(e,3,3,100,100)},i.onScrollEnd=function(){this.panel_content.vScrollBar.value==this.panel_content.vScrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},t._instance=null,t}(),eW=function(e){function t(){this._skillId=0,this.lvlDelt=0,t.__super.call(this)}b(t,"modules.actor.views.ringup.RingSkillShowTip",T_);var i=t.prototype;return i.show=function(e){var t=this,i=$e.getIndex(232);t.lvlDelt=parseInt($e.MODEL.value(i));var n=ps.MODEL.mabiBuffParam(e.configIndex);if(n){var s=n.split(","),o=k_.ins.getRingSkillIndex(e.type),a=so.MODEL.desc(o),r=0,l=0,c=a;for(r=0,l=s.length;r<l;r++)c=c.replace("{"+r+"}",(parseInt(s[r])/100).toString());t.crtDescr.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;"+c;var u=0<e.level%t.lvlDelt?1:0;t.lab_title.text=so.MODEL.name(o)+(Math.floor(e.level/t.lvlDelt)+u)+"";var d=t.lvlDelt-e.level%t.lvlDelt+1;e.level%t.lvlDelt==0&&(d=1);var h=new wB(e.type,e.level+d,e.jobId);if(-1==h.configIndex)t.height=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y+80,t.nextBox.visible=!1;else{t.nextBox.y=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y,t.nextBox.visible=!0;var _=ps.MODEL.mabiBuffParam(h.configIndex).split(",");for(r=0,l=_.length;r<l;r++)a=a.replace("{"+r+"}",(parseInt(_[r])/100).toString());t.nextDescr.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;"+a,t.height=t.crtDescr.contextHeight+t.crtBox.y+t.crtDescr.y+t.nextDescr.y+t.nextDescr.contextHeight+90}t.txt_condition1.innerHTML="每提升"+mp.getChineseNum(t.lvlDelt)+RP.n[297],t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.actor.ringup.RingSkillAlertUI._$SET_ins),t._ins=null,t}(),tW=function(e){function t(){var e=this;e.curAttrUIList=[],e.nextAttrUIList=[],e.fightValue=0,t.__super.call(e),e.createLeftText(0),e.createLeftText(1),e.createLeftText(2),e.createLeftText(3),e.createRightText(0),e.createRightText(1),e.createRightText(2),e.createRightText(3),e.txt_title1.y=20,e.txt_title2.y=20}b(t,"modules.actor.views.ringup.SRAttrItem",S_);var i=t.prototype;return i.update=function(e){var t=this;if(e){var i,n=e.chineseAttrs;if(n){var s=0;for(t.txt_title1.text=e.level+"级",t.txt_title2.text=e.level+1+"级",s=0;s<t.curAttrUIList.length;s++){var o=t.curAttrUIList[s],a=o[0],r=o[1];s<n.length?(i=n[s],a.text=i.addName[0]+" "+i.addName[1]+"：",r.text=i.val,0):(a.text="",r.text="")}if(-1==e.nextConfigIndex)t.boxCur.x=246,t.boxNext.visible=!1,t.img_arrow.visible=!1;else{t.boxCur.x=79,t.boxNext.visible=!0,t.img_arrow.visible=!0;var l=e.nextAttrs;for(s=0;s<t.nextAttrUIList.length;s++){var c=t.nextAttrUIList[s],u=c[0],d=c[1];if(s<l.length){i=l[s],u.text=i.addName[0]+" "+i.addName[1]+"：",d.text=i.val,0}else u.text="",d.text=""}}}}},i.createLeftText=function(e){var t=58+34*e,i=kB.createText(30,t,100,24,"",24,"#90877b",!1,"left"),n=kB.createText(110,t,100,24,"",24,"#90877b",!1,"left");this.boxCur.addChild(i),this.boxCur.addChild(n),this.curAttrUIList.push([i,n])},i.createRightText=function(e){var t=58+34*e,i=kB.createText(30,t,100,24,"",24,"#23b11f",!1,"left"),n=kB.createText(110,t,100,24,"",24,"#23b11f",!1,"left");this.boxNext.addChild(i),this.boxNext.addChild(n),this.nextAttrUIList.push([i,n])},t}(),iW=function(e){function t(){var e=this;e.bg=null,e._infoUI=null,t.__super.call(e),e.bg=new Kl,e.bg.skin=_r.getAtlasSubPath("basic_ui_g/ty_ts_dk.png"),e.bg.sizeGrid="5,50,5,50",e.addChild(e.bg),e._infoUI=Ej.ins,e.height=60,e.bg.height=e.height,e.bottom=135,e.on("click",e,e.onClick),QB.ins.changeChannel(0),e._infoUI.x=20,e._infoUI.y=5,e._infoUI.width=e.width-40,e._infoUI.height=e.height-10,e._infoUI.refresh(),e._infoUI.vScrollBar.value=e._infoUI.vScrollBar.max,e._infoUI.parent&&e._infoUI.parent==e||e.addChild(e._infoUI)}b(t,"modules.chat.views.ChatSimpleUI",Gg);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.onTest=function(){for(var e=5;e--;)QB.ins.pushMsg(e+RP.n[298],1)},i.onClick=function(e){hN.ins.open("CHAT")},i.notice=function(e){},i.clearList=function(){},i.show=function(){var e=this;e._infoUI.lock=!1,hN.ins.isOpen("CHAT")||(0!=QB.ins._curChannel&&QB.ins.changeChannel(0),e._infoUI.parent&&e._infoUI.parent==e||(e._infoUI.x=20,e._infoUI.y=5,e._infoUI.width=e.width-40,e._infoUI.height=e.height-10,e._infoUI.refresh(),e._infoUI.vScrollBar.value=e._infoUI.vScrollBar.max,e.addChild(e._infoUI)))},i.hide=function(){},i.onResize=function(){this.width=450,this.x=(G.stage.width-this.width)/2+10,this.bg.width=this.width,this._infoUI.parent==this&&(this._infoUI.width=this.width-40)},i.isClear=function(){return!1},p(0,i,"name",function(){return"ChatSimpleUI"}),t.NAME="ChatSimpleUI",t}(),nW=function(e){function t(){t.__super.call(this),this.btn_change.on("click",this,this.onBtnEntrance)}b(t,"modules.actor.views.soaring.subview.FlyupBossOpenView",e);var i=t.prototype;return i.onBtnEntrance=function(e){this.close()},i.close=function(){this.x=G.stage.width-this.width>>1,this.y=G.stage.height-this.height>>1,this.centerX=NaN,this.centerY=NaN,this.parent&&(eq.panelLayer.close(this),hN.ins.open("BOSS_MAINVIEW",{_subIndex_:2}))},i.onComplete=function(){this.parent&&(eq.panelLayer?(eq.panelLayer.closeAll(),eq.panelLayer.close(this)):this.parent.removeChild(this))},i.isShow=function(){return!!this.parent},i.createChildren=function(){e.prototype.createChildren.call(this)},i.show=function(){var e=this;e.parent||eq.panelLayer&&eq.panelLayer.open(e,!1,!0,!1),e.boss.skin=_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_js.png"),e.bg2.skin=_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_bg11.png"),e.bg1.skin=_r.getFullUrl("ui/layouts/basic_ui/fsboss_img_bg22.png"),gR.ins.actorFlyUpLevel<=2?(e.tip1.skin=_r.getFullUrl("ui/layouts/basic_ui/fsboss_text_2.png"),e.tip1.visible=!0,e.tip2.visible=!1):(e.tip2.skin=_r.getFullUrl("ui/layouts/basic_ui/fsboss_text_1.png"),e.tip2.visible=!0,e.tip1.visible=!1),e.x=NaN,e.y=NaN,e.alpha=1,e.scale(0,0),e.centerX=0,e.centerY=0,Og.to(e,{scaleX:1,scaleY:1},500,pa.bounceOut)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.actor.soaring.other.FlyupBossOpenViewUI._$SET_ins),t._inst=null,t}(Fa),sW=function(e){function t(){this.swingData=null,this._data={},t.__super.call(this),this.centerX=this.centerY=0,this.swingData=wR.ins}b(t,"modules.actor.views.wing.SWingMasterTips",N_);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(e){var i=!0;t._data=e;var n=ji.MODEL.level(ji.getIndex(e.suitid)),s=ji.MODEL.suitNeedNum(ji.getIndex(e.suitid)),o=!1;if(e.suitnum>=s&&(o=!0),t.showContent(n,t._data.suitnum,t.txA_1,t.txC_1,t.txT_1,o,s),o){for(var a=0;a<ji.count;a++)"godWing"==ji.MODEL.suitType(a)&&ji.MODEL.level(a)==n+1&&(i=!1,s=ji.MODEL.suitNeedNum(a));1==i?t.box_2.visible=!1:(t.box_2.visible=!0,t.showContent(n+1,t._data.nextsuitnum,t.txA_2,t.txC_2,t.txT_2,!1,s))}else t.box_2.visible=!1}1==t.box_2.visible?t.height=330:t.height=200,t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.showContent=function(e,t,i,n,s,o,a){var r,l=o?"#00ff00":"#ff0000";i.changeText(o?"已激活":"未激活"),i.color=l,o?r=RP.n[299]+Ql.createColor("+"+5*e+"%","#00cc00"):(r=RP.n[300]+e+RP.n[301]+t+"/"+a+"）",r+=RP.n[302]+Ql.createColor("+"+5*e+"%","#00cc00")),n.innerHTML=r,n.style.leading=10,s.text=RP.n[303]+e+"级"},t.instance=function(){return null==t._instance&&(t._instance=new t),t._instance},t._instance=null,t}(),oW=function(e){function o(){var e=this;e._data=null,e._swingData=null,e.currentObj={},e.nextObj={},e.img_0=null,e.img_1=null,o.__super.call(e),e._swingData=wR.ins,e.centerX=e.centerY=0,e.init()}b(o,"modules.actor.views.wing.SWingSkillTips",V_);var t=o.prototype;return G.imps(t,{"modules.backpack.views.tip.IToolTip":!0}),t.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},t.show=function(e){var t=this;if(e){var i,n=!1;t._data=e;var s=t._data.skillId;s<=0?(n=!1,t.next.visible=!1,s=o.SKILL_ID,t.height=420,t.txtActive0.visible=!0,t.txt_active_tj_0.visible=!0):(n=!0,t.next.visible=!0,o.SKILL_ID=s,t.height=565),i=Ls.getIndex(o.SKILL_ID),t.currentObj=new Object,t.currentObj.icon=Ls.MODEL.icon(i),t.currentObj.name=Ls.MODEL.skillName(i),t.currentObj.lv=Ls.MODEL.skillLv(i),t.currentObj.skillDesc=Ls.MODEL.skillDesc(i),t.currentObj.isActive=n,2==t.currentObj.lv?(t.height=420,t.next.visible=!1,t.nextObj=null,t.txtActive0.visible=!1,t.txt_active_tj_0.visible=!1):(t.nextObj=new Object,t.nextObj.icon=Ls.MODEL.icon(i+1),t.nextObj.name=Ls.MODEL.skillName(i+1),t.nextObj.lv=Ls.MODEL.skillLv(i+1),t.nextObj.skillDesc=Ls.MODEL.skillDesc(i+1),t.nextObj.isActive=!1),t.showContent(t.currentObj,t.txt_name_0,t.txt_status_0,t.txt_lv_0,t.txt_active_tj_0,t.txt_desc_0),null!=t.nextObj&&(t.txt_desc_1.innerHTML=t.nextObj.skillDesc)}t.img_0.skin=_r.getIconPath(t.currentObj.icon),t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},t.showContent=function(e,t,i,n,s,o){t.text=e.name,i.text=e.isActive?"已激活":"未激活",i.color=e.isActive?"#00ff00":"#ff0000",n.text=e.lv+"级",e.isActive?1==e.lv?s.text=RP.n[305]+5+"阶":s.text="":s.text=RP.n[304]+4+"阶",o.innerHTML=this.currentObj.skillDesc},t.onClick=function(e){this.close(!0)},t.init=function(){this.img_0=new Kl,this.img_0.width=100,this.img_0.height=100,this.addChild(this.img_0),this.img_0.pos(this.img_skill_0.x+8,this.img_skill_0.y+8)},p(1,o,"instance",function(){return null==o._instance&&(o._instance=new o),o._instance},layouts.actor.wing.SWingSkillTipsUI._$SET_instance),o._instance=null,o.SKILL_ID=22,o}(),aW=function(e){function t(){this._type=0,this._grid=null,this._dtoGoods=null,this._exchangeType=0,this._propIds=[4,8,9],this._canExchange=!1,this._enpughGold=!1,this._handEff=null,t.__super.call(this)}b(t,"modules.actor.views.zs.ZsExchangeItem",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF,this._grid.x=14,this._grid.y=12,this.addChild(this._grid),this.btn_exchange.on("click",this,this.onClick)},i.addGuide=function(){var e=this;if(PH.Ins().hasNewGuide(46)){if(1==e._type){var t=gR.ins.zsLv+1,i=es.getIndex(t),n=parseInt(es.MODEL.cost(i));gR.ins.zsExp<n?null==e._handEff&&(e._handEff=kB.createEffect("jm1081",e.btn_exchange.x+e.btn_exchange.width/2,e.btn_exchange.y+e.btn_exchange.height/2,e)):null!=e._handEff&&(e._handEff.destroy(),e._handEff=null)}}else null!=e._handEff&&(e._handEff.destroy(),e._handEff=null)},i.setBtnGray=function(e){this.btn_exchange.gray=e,this.btn_exchange.mouseEnabled=!e},i.showRedPoint=function(){var e=gR.ins.checkCanZsExchange(this._type);this.btn_exchange.showTip=e},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0),this._grid=null,this._dtoGoods=null,this.btn_exchange.off("click",this,this.onClick)},i.onClick=function(e){this._canExchange?this._enpughGold?nR.reqZsExchange(this._exchangeType):KQ.ins.showNoGold():zB.ins.showById(102,1)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(cr,t,"dataSource",e),t._type=parseInt(e),gR.ins.zsRemainTime&&(t.txt_des4.innerHTML=RP.n[306]+Ql.createColor(gR.ins.zsRemainTime[t._type]+"","#23b11f")+"次",0==gR.ins.zsRemainTime[t._type]?t.setBtnGray(!0):t.setBtnGray(!1));var i=0,n="",s=0;t._enpughGold=!0,i=t._propIds[t._type];var o=gR.ins.lv,a=gR.ins.zsLv,r=-1;if(1==t._type?0<=(r=ts.getIndex(a))&&(i=ts.MODEL.costItem(r).split(",")[0],n=ts.MODEL.modelAddExp(r),s=ts.MODEL.costMoney(r).split(":")[1]):2==t._type?0<=(r=ts.getIndex(a))&&(i=ts.MODEL.superCostItem(r).split(",")[0],n=ts.MODEL.superModelAddExp(r),s=ts.MODEL.costSuperMoney(r).split(":")[1]):80<o?(r=is.getIndex(o),n=is.MODEL.levelCostAddExp(r),0<gR.ins.zsRemainTime[t._type]&&t.setBtnGray(!1)):(n=is.MODEL.levelCostAddExp(is.getIndex(81)),t.setBtnGray(!0),t.txt_des4.innerHTML=Ql.createColor(RP.n[278],"#e70909")),t._dtoGoods=yB.create(i),t._grid.bindData=t._dtoGoods,n&&-1!=n.indexOf(".")&&(n=n.slice(0,-2)),t.txt_des1.innerHTML="增加"+Ql.createColor(n,"#23b11f")+"修为",t.txt_des5.text="",t.btn_exchange.visible=!0,t._canExchange=!0,0<t._type){var l=Bi.getIndex(i),c=TR.ins.getGoodsNum(i);if(0<c?(t.btn_exchange.label="兑 换",t._exchangeType=1==t._type?2:4,t.img_gold.visible=!1,t.txt_des2.text="剩余"+c+"个",t.txt_des2.color="#23b11f",t.txt_des3.text=""):(t.btn_exchange.label=RP.n[279],t._exchangeType=1==t._type?3:5,t.img_gold.visible=!0,t.txt_des2.text=Bi.MODEL.name(l),t.txt_des2.color="#e3dcc2",t.txt_des3.text=s+"",gR.ins.YB<s&&(t._enpughGold=!1)),2==t._type){var u=parseInt($e.MODEL.value($e.getIndex(42)));a<u&&(t.img_gold.visible=!1,t.txt_des5.text=RP.n[309]+u+"转开放",t.txt_des4.innerHTML="",t.txt_des3.text="",t.btn_exchange.visible=!1,t._canExchange=!1)}}else t.btn_exchange.label="兑 换",t._exchangeType=1,t.img_gold.visible=!1,t.txt_des2.text=RP.n[281],t.txt_des3.text="";t.showRedPoint(),t.addGuide()}),t}(cr),rW=function(e){function t(){var e=this;e.curAttrUIList=[],e.nextAttrUIList=[],e.fightValue=0,t.__super.call(e),e.createLeftText(0),e.createLeftText(1),e.createLeftText(2),e.createLeftText(3),e.createRightText(0),e.createRightText(1),e.createRightText(2),e.createRightText(3)}b(t,"modules.actor.views.zs.ZsAttrItem",qv);var i=t.prototype;return i.update=function(e){var t,i=this,n=[],s=[];if((i.fightValue=0)<e){n=aa.formatAttrToChineseByList(es.MODEL.attrs(es.getIndex(e)));var o=es.MODEL.attrs(es.getIndex(e));if(o){var a=JSON.parse(o);a&&(i.fightValue=RR.getFight(a))}}var r=es.getIndex(e+1);0<=r&&(s=aa.formatAttrToChineseByList(es.MODEL.attrs(r)));var l=0,c=0;if(0<e)for(var u=0;u<i.curAttrUIList.length;u++){var d=i.curAttrUIList[u],h=d[0],_=d[1];u<n.length?(t=n[u],h.text=t.name+"：",_.text=t.val,i["img_numBg1_"+(u+1)].visible=!0,l++):(h.text="",_.text="",i["img_numBg1_"+(u+1)].visible=!1);var f=i.nextAttrUIList[u],p=f[0],g=f[1];0<=r?u<s.length?(t=s[u],p.text=t.name+"：",g.text=t.val,i["img_numBg2_"+(u+1)].visible=!0,c++):(p.text="",g.text="",i["img_numBg2_"+(u+1)].visible=!1):(p.text="",g.text="",i.img_bg2.visible=!1,i.img_bg_bk2.visible=!1,i.img_line2.visible=!1,i.txt_title2.visible=!1,i.img_numBg2_1.visible=!1,i.img_numBg2_2.visible=!1,i.img_numBg2_3.visible=!1,i.img_numBg2_4.visible=!1,i.img_arrow.visible=!1,h.x=251,_.x=366,i.img_bg1.x=i.img_bg_bk1.x=183,i.img_line1.x=169,i.txt_title1.x=184,i.img_numBg1_1.x=i.img_numBg1_2.x=i.img_numBg1_3.x=i.img_numBg1_4.x=221)}else for(u=0;u<i.curAttrUIList.length;u++)h=(d=i.curAttrUIList[u])[0],_=d[1],p=(f=i.nextAttrUIList[u])[0],g=f[1],u<s.length?(t=s[u],p.text=t.name+"：",g.text=t.val,h.text=t.name+"：",aa.isPersentAttrById(t.id)?_.text="0%":_.text="0",i["img_numBg1_"+(u+1)].visible=!0,i["img_numBg2_"+(u+1)].visible=!0,c++,l++):(p.text="",g.text="",h.text="",_.text="",i["img_numBg1_"+(u+1)].visible=!1,i["img_numBg2_"+(u+1)].visible=!1);i.img_bg1.height=85+40*l+15,i.img_bg2.height=85+40*c+15},i.createLeftText=function(e){var t=75+42*e,i=kB.createText(70,t,100,24,"",24,"#90877b",!1,"left"),n=kB.createText(187,t,100,24,"",24,"#90877b",!1,"left");this.addChild(i),this.addChild(n),this.curAttrUIList.push([i,n])},i.createRightText=function(e){var t=75+42*e,i=kB.createText(442,t,100,24,"",24,"#90877b",!1,"left"),n=kB.createText(559,t,100,24,"",24,"#23b11f",!1,"left");this.addChild(i),this.addChild(n),this.nextAttrUIList.push([i,n])},t}(),lW=function(e){function t(){this.bigType=0,this.model=null,t.__super.call(this),this.model=CR.ins,this.tipBtn.selected=!1}b(t,"modules.backpack.views.item.BagComBigItem",Ue);var i=t.prototype;return i.rfpt=function(){this.model.bigTypeHash.has(this.bigType)?this.tipBtn.showTip=this.model.bigTypeHash.take(this.bigType):this.tipBtn.showTip=!1},i.isSselected=function(e){this.btn_jt.rotation=1==e?-90:90},i.setDataInfo=function(e){this.txt_name.text=Cs.MODEL.bTitle(e),this.bigType=Cs.MODEL.key(e)},t}(),cW=function(e){var l;function t(e){this._achieves=[],this._callback=null,t.__super.call(this),this._callback=e}return b(t,"modules.backpack.views.achieve.GoodsAchieve",rl),t.prototype.update=function(e){var t=Bi.getIndex(e),i=Bi.MODEL.achieving(t);if(i){for(var n,s=i.split(";"),o=0,a=0;a<s.length;a++){var r=s[a].split("|");!(6==parseInt(r[0]))&&gR.ins.lv<parseInt(r[r.length-2])||(o<this._achieves.length?n=this._achieves[o]:(n=new l(this._callback),this._achieves.push(n)),n.update(s[a]),n.pos(0,46+66*o),this.addChild(n),o++)}this.height=46+66*o}for(;o<this._achieves.length;o++)this._achieves[o].removeSelf()},t.__init$=function(){l=function(e){function t(e){this._data=null,this._click=null,t.__super.call(this),this._click=e,this.on("click",this,this.onClick)}b(t,"",o);var i=t.prototype;return i.update=function(e){var t=this,i=(t._data=e).split("|");t.txt_name.changeText(i[i.length-1]),4==parseInt(i[0])?(t.mc_go.visible=!1,t.txt_go.visible=!1,t.off("click",t,t.onClick)):(t.mc_go.visible=!0,t.txt_go.visible=!0,t.hasListener("click")||t.on("click",t,t.onClick))},i.onClick=function(e){var t=this._data.split("|"),i=6==parseInt(t[0]);if(i){var n=parseInt(t[3]);if(!GR.getInstance().checkModuleOpen(n))return void zB.ins.showMsg(GR.getInstance().getErrorTips(n),1)}2==t[0]||ZN.isEnabledChangeScene()?(1==t[0]&&hN.ins._closeLayout(),i&&(this._data=this._data.replace(/[0-9]?|/,"2")),Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],this._data)):zB.ins.showById(2126,1),this._click.run()},t}()},t}(),uW=function(e){function t(){var e=this;e.gridPanel=null,t.__super.call(e),e.gridPanel=new wj(6,5,116,16,32,!0,null,0,!0),e.gridPanel.pos(33,116),e.gridPanel.top=116,e.gridPanel.bottom=295,e.gridPanel.isShowJob=!0,e.addChild(e.gridPanel),e.setChildIndex(e.g_mask,e.numChildren-1),e.txt_no.visible=!1,e.gridPanel.vScrollBar.on("change",e,e.onScrollChanged)}b(t,"modules.backpack.views.sub.BackPackEquipView",Ye);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){void 0===e&&(e=!0),this.gridPanel&&this.gridPanel.vScrollBar&&this.gridPanel.vScrollBar.off("change",this,this.onScrollChanged),this.gridPanel.destroy(e),this.gridPanel=null,laya.ui.View.prototype.destroy.call(this,e)},i.updateExtend=function(){var e=this.gridPanel.gridDatas;this.txt_num.changeText(e.length+"/"+TR.ins.gridNum);var t=0<gR.ins.VIPLevel?Rt.MODEL.vipGridNum(0)[gR.ins.VIPLevel-1]:0,i=Rt.MODEL.initGridNum(0)+Rt.MODEL.maxBuyGridNum(0)+t;TR.ins.gridNum>=i&&(this.btn_add.visible=!1)},i.hideByVSC=function(e,t){this.btn_recycle.off("click",this,this.onRecycle),this.btn_add.off("click",this,this.onExtend)},i.showByVSC=function(e,t){this.btn_recycle.on("click",this,this.onRecycle),this.btn_add.on("click",this,this.onExtend),this.updateByVSC(null)},i.updateByVSC=function(e){var t,i=this,n=TR.ins.getBackPackEquips(),s=[],o=[],a=[];for(var r in n)t=n[r],5<=Bi.MODEL.colourId(t.cfgIdx)&&0==Bi.MODEL.thunderStar(t.cfgIdx)?s.push(t):0<Bi.MODEL.thunderStar(t.cfgIdx)?o.push(t):a.push(t);i.doSortLevel(s),i.doSortLevel(o),i.doSort(a),i.gridPanel.gridDatas=s.concat(o).concat(a),i.txt_no.visible=!(i.gridPanel.gridDatas&&0<i.gridPanel.gridDatas.length),i.g_mask.visible=i.gridPanel.gridDatas&&36<i.gridPanel.gridDatas.length,i.btn_recycle.showTip=TR.ins.isShowRecycleTip(),i.btn_recycle.showTip||null!=xZ.dialogueRecycle&&xZ.dialogueRecycle.removeSelf(),i.updateExtend()},i.onRecycle=function(e){Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"])},i.onExtend=function(e){Tu.sendToModule("BP_GRIDEXTEND",["modules.backpack.BackpackModule"])},i.doSortLevel=function(e){var s=this;e.sort(function(e,t){var i=e.cfgIdx,n=t.cfgIdx;if(Bi.MODEL.thunderStar(i)<Bi.MODEL.thunderStar(n))return 1;if(Bi.MODEL.thunderStar(i)==Bi.MODEL.thunderStar(n)){if(Bi.MODEL.flyLevel(i)<Bi.MODEL.flyLevel(n))return 1;if(Bi.MODEL.flyLevel(i)==Bi.MODEL.flyLevel(n)){if(Bi.MODEL.minUseLevel(i)<Bi.MODEL.minUseLevel(n))return 1;if(Bi.MODEL.minUseLevel(i)==Bi.MODEL.minUseLevel(n))return s.sortRoleAndPos(e,t)}}})},i.doSort=function(e){var a=this;e.sort(function(e,t){var i=e.cfgIdx,n=t.cfgIdx,s=Bi.MODEL.colourId(i),o=Bi.MODEL.colourId(n);if(e.baseFight<t.baseFight)return 1;if(e.baseFight==t.baseFight){if(s<o)return 1;if(s==o)return a.sortRoleAndPos(e,t)}return-1})},i.sortRoleAndPos=function(e,t){var i=e.cfgIdx,n=t.cfgIdx;return Bi.MODEL.roleTypeId(i)>Bi.MODEL.roleTypeId(n)?1:Bi.MODEL.roleTypeId(i)==Bi.MODEL.roleTypeId(n)&&Bi.MODEL.decoratePosition(i)>Bi.MODEL.decoratePosition(n)?1:-1},i.onScrollChanged=function(){0==this.gridPanel.vScrollBar.max||this.gridPanel.vScrollBar.value>=this.gridPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),dW=function(e){function t(){var e=this;e.gridPanel=null,t.__super.call(e),e.gridPanel=new wj(7,5,116,16,32,!0,null,0,!0),e.gridPanel.pos(34,111),e.gridPanel.resetPosY=5,e.gridPanel.top=116,e.gridPanel.bottom=151,e.addChild(e.gridPanel),e.setChildIndex(e.g_mask,e.numChildren-1),e.txt_no.visible=!1,e.gridPanel.vScrollBar.on("change",e,e.onScrollChanged)}b(t,"modules.backpack.views.sub.BackPackLwView",Xe);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){void 0===e&&(e=!0),this.gridPanel&&this.gridPanel.vScrollBar&&this.gridPanel.vScrollBar.off("change",this,this.onScrollChanged),this.gridPanel.destroy(e),this.gridPanel=null,laya.ui.View.prototype.destroy.call(this,e)},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.updateByVSC(null)},i.updateByVSC=function(e){var t=TR.ins.getBackPackDragonTools();this.doSortLongWen(t);var i=TR.ins.getBackPackLongWens();this.doSortLongWen(i),this.gridPanel.gridDatas=t.concat(i),this.txt_no.visible=!(this.gridPanel.gridDatas&&0<this.gridPanel.gridDatas.length),this.g_mask.visible=this.gridPanel.gridDatas&&42<this.gridPanel.gridDatas.length},i.doSortLongWen=function(e){e.sort(function(e,t){var i=e.cfgIdx,n=t.cfgIdx;if(Bi.MODEL.colourId(i)<Bi.MODEL.colourId(n))return 1;if(Bi.MODEL.colourId(i)!=Bi.MODEL.colourId(n))return-1;if(Bi.MODEL.key(i)<Bi.MODEL.key(n))return-1;if(Bi.MODEL.key(i)!=Bi.MODEL.key(n))return 1;var s=jt.MODEL.level(e.dragonIndex-1),o=jt.MODEL.level(t.dragonIndex-1);return s<o?1:s==o?0:-1})},i.onScrollChanged=function(){0==this.gridPanel.vScrollBar.max||this.gridPanel.vScrollBar.value>=this.gridPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),hW=function(e){function t(){var e=this;e._icon=null,e._dto=null,e._nameList=[],e._attrList=[],e._achieves=null,e.arr=null,t.__super.call(e),e._icon=new MF,e._icon.pos(35,160),e.addChild(e._icon)}b(t,"modules.backpack.views.tip.FashionTip",Ea);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;t._dto=e;var i=t._dto.cfgIdx,n=Bi.MODEL.colourId(i);t.txt_name.changeText(Bi.MODEL.name(i)),t.txt_name.color=ms.getByQuality(n);var s=Bi.MODEL.minUseLevel(i),o=Bi.MODEL.flyLevel(i);0<o?(t.txt_lv.changeText(o+"转"),t.txt_lv.color=gR.ins.zsLv>=o?"#a19980":"#e70909"):(t.txt_lv.changeText(1<s?s+"级":"无限制"),t.txt_lv.color=gR.ins.lv>=s?"#a19980":"#e70909"),t._icon.bindData=t._dto.goodsId;var a=t.getSuitId(t._dto.goodsId),r=(JB.ins.getSuitIndex(a,1),Bi.getIndex(t._dto.goodsId)),l=Bi.MODEL.expireTime(r);if(l>=Jp.DATE_SECOND?t.txt_suitName.changeText(Jp.getDH(l)):l<Jp.DATE_SECOND&&l>=Jp.HOUR_SECOND?t.txt_suitName.changeText(Math.floor(l/Jp.HOUR_SECOND)+"小时"):-1==l?t.txt_suitName.changeText(RP.n[311]):-2==l?t.txt_suitName.changeText(RP.n[312]):t.txt_suitName.changeText(Jp.getCNTickMS(l)),0<ni.count)t.onJxrComplete();else{var c=[{url:_r.getJxrDBPath("ConfigFashion"),type:"arraybuffer",cls:ni}];uc.ins().onLoadJxrs(c,ql.create(t,t.onJxrComplete))}},i.onJxrComplete=function(){var e,t,n=this,i=this.getFashionId(this._dto.goodsId),s=ni.getIndex(i);t=ni.MODEL.attr(s),e=RR.getFight(t,null,0,!0,!1),this.fight_item.value=e;ni.MODEL.name(i);var o=ni.MODEL.attr_precent(i-1);parseInt(o),Bi.getIndex(this._dto.goodsId);TR.ins.getGoodsDes(this._dto.goodsId,ql.create(this,function(e,t){n.txt_dest.innerHTML=t,n.txt_dest.style.align="left";var i=n.txt_dest.y+n.txt_dest.contextHeight+41;this.height=i})),this.parent||(eq.panelLayer.once("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.getSuitId=function(e){for(var t=0;t<ni.count;t++){if(e==ni.MODEL.goodsCost(t).split(",")[0])return ni.MODEL.suitId(t)}return 0},i.getFashionId=function(e){for(var t=0;t<ni.count;t++){var i=ni.MODEL.goodsCost(t).split(",")[0],n=ni.MODEL.level(t);if(e==i&&1==n)return ni.MODEL.key(t)}return 0},i.getFashionList=function(e){for(var t=[],i=0;i<ni.count;i++)if(ni.MODEL.suitId(i)==e&&1==ni.MODEL.level(i)){var n=new ea;n.f_id=ni.MODEL.key(i),n.status=-1,t.push(n)}return t},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag.FashionTipUI._$SET_instance),t._instance=null,t}(),_W=function(e){function t(){var e=this;e._dto=null,e._grid=null,e._currentAttr=null,e._nextAttr=null,e._offsetY=0,e._fontSize=24,e._bg=null,e._achieves=null,t.__super.call(e),e.panel.vScrollBarSkin="",e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e._grid.toolTipEnabled=!1,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1)}b(t,"modules.backpack.views.tip.FuWenNormalTip",Qa);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){this.showByType(e)},i.showByType=function(e,t){var i=this;void 0===t&&(t=1),i.btn_go.on("click",i,i.onUpgradeClicked),i.panel.removeChildren(),i._dto=e,i._grid.bindData=i._dto;var n=i._dto.cfgIdx,s=Bi.MODEL.colourId(n);1<s?(i.grade.visible=!0,i.grade.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+s+".png")):i.grade.visible=!1,i.txt_name.changeText(Bi.MODEL.name(n)),i.txt_name.color=ms.getByQuality(s),i.txt_part.changeText(ua.getPartNameByGoodID(i._dto.goodsId));var o=ua.getFuWenLevel(i._dto.goodsId),a=ua.getFuWenZhuan(i._dto.goodsId);switch(i.txt_level.text=0<a?o+"转":o+"级",i.setCurrent(),i.btn_go.visible=!1,t){case 1:i._achieves&&i._achieves.parent&&i._achieves.removeSelf();break;case 2:i.setActivityNeed(i._dto),i.setAchieving(i._dto);break;case 3:i.setNext();break;case 5:i.setAchieving(i._dto);break;case 4:i._achieves&&i._achieves.parent&&i._achieves.removeSelf(),i.btn_go.visible=!0;var r=iR.instance.getRuneResouseByGoodID(i._dto.goodsId).part,l=iR.instance.getInfoByPart(r).level;i.btn_go.label=0==l?"激 活":"升 级"}switch(t){case 1:i.btn_go.visible=!1}660<i.panel.height&&(i.panel.height=660),i.panel.refresh();var c=0,u=0;i._achieves&&i._achieves.parent&&(c=i._achieves.height),i.btn_go.visible&&(u=i.btn_go.height+40),i.img_bg_kuang.height=i.panel.y+i.panel.height+u+20,i.height=i.panel.y+i.panel.height+40+c+u,i.parent||(eq.panelLayer.on("MASK_CLOSE",i,i.onClick),eq.panelLayer.openTip(i))},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick),this.btn_go.off("click",this,this.onUpgradeClicked)},i.onClick=function(e){this.close(!0)},i.onUpgradeClicked=function(){this.close(!0);var e=new ue;e.part=ua.judgePart(this._dto.goodsId),Tu.sendToService(e)},i.onLink=function(e){77!=this._dto.goodsId&&78!=this._dto.goodsId||hN.ins.open("GOD_EQUIP",this._dto.goodsId),this.close()},i.setCurrent=function(){var e=this;e._currentAttr=new EX,e._currentAttr.dataSource=e._dto,e.panel.addChild(e._currentAttr),e.panel.height=e._currentAttr.y+e._currentAttr.height,e.panel.refresh(),e._offsetY=e._currentAttr.y+e._currentAttr.height},i.setNext=function(e){var t=this;void 0===e&&(e=!0);var i=ws.count/ua.PART_NAME.length,n=ua.judgePart(t._dto.goodsId),s=iR.instance.part[n-1];if(s.level!=i){var o=s.level,a=iR.instance.configVo[o][n-1],r=KH.create(a.levelUpGoodsId);t.setNextTitle(r);var l=new EX;l.dataSource=r,t.panel.addChild(l),l.y=t._offsetY,t.panel.height=l.y+l.height,t.panel.refresh(),t._offsetY=t.panel.height,t.setActivityNeed(r),e&&t.setAchieving(r)}},i.setNextTitle=function(e){var t=new Xl;this.panel.addChild(t),t.y=this._offsetY+10,t.fontSize=this._fontSize,t.x=0,t.width=this.width,t.align="center",t.height=this._fontSize;var i=e.cfgIdx,n=Bi.MODEL.colourId(i),s=ms.getByQuality(n);t.innerHTML="<font style='color:"+s+"; size:"+this._fontSize+"'>下级("+e.name+")</font>",this._offsetY+=t.height+20},i.setActivityNeed=function(e){var t=this,i=new Xl;t.panel.addChild(i),i.y=t._offsetY+10,i.fontSize=t._fontSize,i.width=t.width-100,i.x=53,i.align="left",i.height=t._fontSize,i.color="#90877b";var n,s=TR.ins.getGoodsNum(e.goodsId);n=0<s?"#23b11f":"#ff2e24";var o=ms.getByQuality(Bi.MODEL.colourId(e.cfgIdx));i.innerHTML=RP.n[314]+"#90877b; size:"+t._fontSize+"'>"+RP.n[313]+"</font>"+RP.n[314]+o+"; size:"+t._fontSize+"'>"+e.name+"</font>x1"+RP.n[314]+n+"; size:"+t._fontSize+"'>"+RP.n[316]+s+")</font>",t.panel.height=t._offsetY+t._fontSize+50,660<t.panel.height&&(t.panel.height=660),t._offsetY=t.panel.height},i.setAchieving=function(e){var t=this;Bi.MODEL.achieving(e.cfgIdx)?(t._achieves||(t._achieves=new OQ(ql.create(modules.backpack.views.tip.FuWenNormalTip.instance,modules.backpack.views.tip.FuWenNormalTip.instance.close,null,!1))),t._achieves.pos(0,t.panel.y+t.panel.height+20),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag.FuWenNormalTipUI._$SET_instance),t.TYPE_NORMAL=1,t.TYPE_EMPTY=2,t.TYPE_HAS=3,t.TYPE_GRADE=4,t.TYPE_ACHIEVE=5,t._instance=null,t}(),fW=function(e){function t(){var e=this;e._icon=null,e._bg=null,e._attr=null,e._dto=null,t.__super.call(e),e.panel.vScrollBarSkin="",e._icon=new AF,e._icon.pos(30,88),e.addChildAt(e._icon,e.getChildIndex(e.img_up)),e._attr=new OF,e._attr.width=e.panel.width,e.panel.addChild(e._attr)}b(t,"modules.backpack.views.tip.EquipToolTip",um);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var i=this;this.panel.scrollTo(0,0),this._dto=e;var t=this._dto.cfgIdx,n=Bi.MODEL.colourId(t);this.txt_name.changeText(Bi.MODEL.name(t)),this.txt_name.color=ms.getByQuality(n),this.txt_part.changeText(la.getName(LR.getPart(this._dto.goodsId)));var s=Bi.MODEL.minUseLevel(t),o=Bi.MODEL.flyLevel(t);this._dto.iswingequ?(this.lab_lv.changeText("等级："),this.txt_lv.changeText("羽翼"+yo.MODEL.levelLimit(yo.getIndex(this._dto.goodsId))+"阶可用"),this.txt_lv.color="#00FF00"):0<o?(this.lab_lv.changeText("转生："),this.txt_lv.changeText(o+"转"),this.txt_lv.color=gR.ins.zsLv>=o?"#90877b":"#e70909"):(this.lab_lv.changeText("等级："),this.txt_lv.changeText(1<s?s+"级":"无限制"),this.txt_lv.color=gR.ins.lv>=s?"#90877b":"#e70909"),this.txt_role.changeText(F.getPro(Bi.MODEL.roleTypeId(t))),1<n?(this.img_color.visible=!0,this.img_color.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+n+".png")):this.img_color.visible=!1,this._icon.bindData=this._dto.goodsId,this.img_up.visible=0<this._dto.uuId&&(this._dto.position<=0||this._dto.isOther)&&MR.ins.isBetter(this._dto),this._attr.update(this._dto,ql.create(this,function(e){580<i._attr.height?i.panel.height=584:i.panel.height=i._attr.height+4,i.panel.refresh(),this.height=i.panel.y+i.panel.height+35,i.txt_sorce.text="";var t=i.setOtherInfo();t&&(this.height+=80),i.fight_item.value=Math.ceil(i._attr.csScore+e.getFuShuFight()),t||e.isJzGodEequ||e.iswingequ||(i.txt_sorce.text="评分："+e.sorce)},[this._dto])),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},i.onLink=function(e){77!=this._dto.goodsId&&78!=this._dto.goodsId||hN.ins.open("GOD_EQUIP",this._dto.goodsId),this.close()},i.setOtherInfo=function(){var e=this;eN.ins.isGodEquip(e._dto.goodsId)?(e._bg||(e._bg=new Kl(_r.getLayoutsImagePath("other/tips_mc_gradient.png")),e._bg.sizeGrid="0,100,0,100",e._bg.left=e._bg.right=0),e.addChildAt(e._bg,1)):e._bg&&e._bg.removeSelf();return!1},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag._EquipTipUI._$SET_instance),t._instance=null,t}(),pW=function(e){function t(){var e=this;e._content=null,e._dto=null,t.__super.call(e),e._content=new I0,e._content.pos(0,88),e.addChild(e._content),e.btn_use.on("click",e,e.onGoodsToolTipsUse),e.btn_recycle.on("click",e,e.onCheckRecycle)}b(t,"modules.backpack.views.tip.RingToolTip",C_);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.onGoodsToolTipsUse=function(e){var t=this._dto;null!=t&&(Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],t),hN.ins.open("ACTOR_M",{_subIndex_:0}),this.close())},i.onCheckRecycle=function(e){var t=this._dto;if(null!=t){var i=t.cfgIdx,n=Bi.MODEL.colourId(i),s=Bi.MODEL.recycleGoodsAward(i).split(","),o=(s[1],yB.create(parseInt(s[0]),parseInt(s[1]))),a="回收"+Ql.createColor(t.name,ms.getByQuality(n))+"可获得"+Ql.createColor(o.name+"x"+o.goodsNum,"#fcd132")+RP.n[317];KQ.ins.show(a,ql.create(this,this.onRecycle),!1,3,null,null,!0)}},i.onRecycle=function(e){var t=this._dto;null!=t&&(1==e&&OR.reqRecycleChuanShi([t.uuId]),this.close())},i.show=function(e){var t=this;t._dto=e;var i=t._dto.cfgIdx,n=Bi.MODEL.colourId(i);t.txt_name.changeText(Bi.MODEL.name(i)),t.txt_name.color=ms.getByQuality(n),t._content.update(t._dto),t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t)),t.box.visible=0<t._dto.uuId,t.box.visible?t.height=t._content.y+t._content.img_line.y+t.box.height:t.height=t._content.y+t._content.img_line.y},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag.RingTipUI._$SET_instance),t._instance=null,t}(),gW=function(t){function i(){var e=this;e._grid=null,e._dtoGoods=null,e._dtoMallVo=null,e._keyIndex=0,e._buySign=null,e._mask=null,e.JF=0,e._effect=null,e.needEffect=!0,i.__super.call(e)}b(i,"modules.activity.views.sp.item.ActivityPointshopItem",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF,e._grid.x=e.img_goods.x+(e.img_goods.width-e._grid.width>>1),e._grid.y=e.img_goods.y+(e.img_goods.height-e._grid.height>>1),e.addChildAt(e._grid,2)},e.initialize=function(){var e=this;e.hdv_des0.style.font="SimHei",e.hdv_des0.style.fontFamily="SimHei",e.hdv_des0.style.fontSize=20,e.hdv_des0.style.color="#23b11f",e.hdv_des0.style.align="left",e.hdv_des1.style.font="SimHei",e.hdv_des1.style.fontFamily="SimHei",e.hdv_des1.style.fontSize=20,e.hdv_des1.style.color="#a19980",e.hdv_des1.style.align="right",e.discount_bg.mouseEnabled=!1,e.clip_discount.mouseEnabled=!1,e.txt_price.mouseEnabled=!1,e.btn_buy.on("click",e,e.onClickHandler),e.clip_discount.visible=!1,e.discount_bg.visible=!1,e.arrow_up.visible=!1,e.addChildAt(e.discount_bg,e.getChildIndex(e._grid)+1),e.addChildAt(e.clip_discount,e.getChildIndex(e.discount_bg)+1),e.img_hasBuy.visible=!1},e.updateJF=function(){this.JF=TR.ins.getGoodsNum(2400)},e.isMoneyEnough=function(){if(null==this._dtoMallVo)return!1;return!(this._dtoMallVo.price>this.JF)},e.showEffect=function(){var e=this;if(e.clearEffect(),e._grid.bindData&&e.needEffect){var t=no.getIndex(e._dtoMallVo.shopIndex),i=no.MODEL.effectId(t);i&&-1!=i.indexOf("jm")&&(e._effect=kB.createEffect(i,e._grid.x+(e._grid.width>>1),e._grid.y+(e._grid.height>>1),e),e.clip_discount.visible&&e.addChildAt(e._effect,e.getChildIndex(e.discount_bg)-1),116!=e._grid.width&&(e._effect.scaleX=e._effect.scaleY=e._grid.width/116))}},e.clearEffect=function(){this._effect&&this._effect.dispose(),this._effect=null},e.adjustPos=function(){},e.onClickHandler=function(e){if(this._dtoMallVo){if(!this.isMoneyEnough())return void zB.ins.showById(4744,1);if(6==this._dtoMallVo.tab){var t=new DM;t.index=this._dtoMallVo.serviceIndex,t.shopIndex=this._dtoMallVo.shopIndex,t.activityId=this._dtoMallVo.activityId,Tu.sendToService(t)}}},e.destroy=function(e){void 0===e&&(e=!0),this._grid.isClearUrl=!0,this._grid.clearIconTexture(),this.clearEffect(),laya.ui.View.prototype.destroy.call(this),this.btn_buy.off("click",this,this.onClickHandler)},p(0,e,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(t._dtoMallVo=e,t.btn_buy.visible=!0,t._dtoMallVo){6==t._dtoMallVo.tab&&(t.box1.visible=!0,t.img_hasBuy.visible=!1),t._dtoGoods=yB.create(t._dtoMallVo.goodId),t._dtoGoods.disAchi=!1,t._dtoGoods.goodsNum=t._dtoMallVo.num,t._grid.bindData=t._dtoGoods;var i=Bi.getIndex(t._dtoMallVo.goodId),n=Bi.MODEL.roleTypeId(i);if(0<n){var s="";switch(n){case 1:s="bb_jb_zs";break;case 2:s="bb_jb_fs";break;case 3:s="bb_jb_ds"}t.img_role.skin=_r.getAtlasSubPath("basic_ui/"+s+".png")}else t.img_role.skin="";t.addChildAt(t.img_role,3);var o=Bi.getIndex(t._dtoMallVo.goodId);if(2==Bi.MODEL.type(o)){var a=tH.instance.getDiffFightValue(t._dtoMallVo.goodId);0<a?(t.arrow_up.visible=!0,t.hdv_des0.innerHTML=RP.n[318]+a):(t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980"))}else t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980");t.txt_name.text=t._dtoMallVo.mallGoodName,t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(i)),0<t._dtoMallVo.isDiscount?(t.discount_bg.index=0,t.clip_discount.index=no.MODEL.discount(no.getIndex(t._dtoMallVo.shopIndex))/10-1,t.discount_bg.visible=!0,t.clip_discount.visible=!0):(t.discount_bg.visible=!1,t.clip_discount.visible=!1),6==t._dtoMallVo.tab&&(0<t._dtoMallVo.leftDailyTimes?t.hdv_des1.innerHTML=RP.n[319]+Ql.createColor(t._dtoMallVo.leftDailyTimes+"/"+t._dtoMallVo.limitBuy,"#23b11f"):0==t._dtoMallVo.leftDailyTimes?t.hdv_des1.innerHTML=RP.n[320]+Ql.createColor(t._dtoMallVo.leftDailyTimes+"/"+t._dtoMallVo.limitBuy,"#ff0000"):t.hdv_des1.innerHTML="");t.img_money.skin=_r.getFullUrl("ui/images/activity/tehui/icon10648.png"),t.img_money.size(60,60),t.txt_price.x=73;var r=Math.floor(t._dtoMallVo.price);t.txt_price.text=9999<r?(.001*r>>0)/10+"万":r+"",6==t._dtoMallVo.tab&&t.showEffect(),t.adjustPos(),t.updateJF()}else t._grid.bindData=null}),i}(pu),vW=function(t){function e(){this._grid=null,this._dtoGoods=null,this._dtoMallVo=null,this._keyIndex=0,this._buySign=null,this._mask=null,this._effect=null,this.needEffect=!0,e.__super.call(this)}b(e,"modules.activity.views.tehui.ActivityMysteryMallItem",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF,e._grid.x=e.img_goods.x+(e.img_goods.width-e._grid.width>>1),e._grid.y=e.img_goods.y+(e.img_goods.height-e._grid.height>>1),e.addChildAt(e._grid,2)},i.initialize=function(){var e=this;e.hdv_des0.style.font="SimHei",e.hdv_des0.style.fontFamily="SimHei",e.hdv_des0.style.fontSize=20,e.hdv_des0.style.color="#23b11f",e.hdv_des0.style.align="left",e.hdv_des1.style.font="SimHei",e.hdv_des1.style.fontFamily="SimHei",e.hdv_des1.style.fontSize=20,e.hdv_des1.style.color="#a19980",e.hdv_des1.style.align="right",e.discount_bg.mouseEnabled=!1,e.clip_discount.mouseEnabled=!1,e.txt_price.mouseEnabled=!1,e.btn_buy.on("click",e,e.onClickHandler),e.clip_discount.visible=!1,e.discount_bg.visible=!1,e.arrow_up.visible=!1,e.addChildAt(e.discount_bg,e.getChildIndex(e._grid)+1),e.addChildAt(e.clip_discount,e.getChildIndex(e.discount_bg)+1),e.img_hasBuy.visible=!1},i.isMoneyEnough=function(){if(null==this._dtoMallVo)return!1;var e=Math.round(this._dtoMallVo.price);return 2==this._dtoMallVo.moneyType?!(e>gR.ins.YB):4==this._dtoMallVo.moneyType?!(e>gR.ins.ZJ):!(e>gR.ins.coin)},i.showEffect=function(){var e=this;if(e.clearEffect(),e._grid.bindData&&e.needEffect){var t=no.getIndex(e._dtoMallVo.shopIndex),i=no.MODEL.effectId(t);i&&-1!=i.indexOf("jm")&&(e._effect=kB.createEffect(i,e._grid.x+(e._grid.width>>1),e._grid.y+(e._grid.height>>1),e),e.clip_discount.visible&&e.addChildAt(e._effect,e.getChildIndex(e.discount_bg)-1),116!=e._grid.width&&(e._effect.scaleX=e._effect.scaleY=e._grid.width/116))}},i.clearEffect=function(){this._effect&&this._effect.dispose(),this._effect=null},i.adjustPos=function(){},i.onClickHandler=function(e){var t=this;if(t._dtoMallVo){if(!t.isMoneyEnough())return void(2==t._dtoMallVo.moneyType?KQ.ins.showNoGold():3==t._dtoMallVo.moneyType?zB.ins.showById(1003,1):4==t._dtoMallVo.moneyType&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:34}));if(5==t._dtoMallVo.tab){var i=new LM;i.index=t._dtoMallVo.serviceIndex,i.shopIndex=t._dtoMallVo.shopIndex,i.activityId=t._dtoMallVo.activityId,Tu.sendToService(i)}else 1==t._dtoMallVo.isBulkbuy?t.showMallBuyPanel(t._dtoMallVo):wN.reqBuyMallGood(t._dtoMallVo.shopIndex)}},i.showMallBuyPanel=function(e){QW.ins.bindData(e)},i.destroy=function(e){void 0===e&&(e=!0),this._grid.isClearUrl=!0,this._grid.clearIconTexture(),this.clearEffect(),laya.ui.View.prototype.destroy.call(this),this.btn_buy.off("click",this,this.onClickHandler)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(t._dtoMallVo=e,t.btn_buy.visible=!0,t._dtoMallVo){5==t._dtoMallVo.tab&&(t._dtoMallVo.hasBuy?(t.box1.visible=!1,t.img_hasBuy.visible=!0):(t.box1.visible=!0,t.img_hasBuy.visible=!1)),t._dtoGoods=yB.create(t._dtoMallVo.goodId),t._dtoGoods.disAchi=!1,t._dtoGoods.goodsNum=t._dtoMallVo.num,t._grid.bindData=t._dtoGoods;var i=Bi.getIndex(t._dtoMallVo.goodId),n=Bi.MODEL.roleTypeId(i);if(0<n){var s="";switch(n){case 1:s="bb_jb_zs";break;case 2:s="bb_jb_fs";break;case 3:s="bb_jb_ds"}t.img_role.skin=_r.getAtlasSubPath("basic_ui/"+s+".png")}else t.img_role.skin="";t.addChildAt(t.img_role,3);var o=Bi.getIndex(t._dtoMallVo.goodId);if(2==Bi.MODEL.type(o)){var a=tH.instance.getDiffFightValue(t._dtoMallVo.goodId);0<a?(t.arrow_up.visible=!0,t.hdv_des0.innerHTML=RP.n[318]+a):(t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980"))}else t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980");if(t.txt_name.text=t._dtoMallVo.mallGoodName,t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(i)),0<t._dtoMallVo.isDiscount?(t.discount_bg.index=0,t.clip_discount.index=no.MODEL.discount(no.getIndex(t._dtoMallVo.shopIndex))/10-1,t.discount_bg.visible=!0,t.clip_discount.visible=!0):(t.discount_bg.visible=!1,t.clip_discount.visible=!1),5==t._dtoMallVo.tab)t.hdv_des1.innerHTML="";else{var r=t._dtoMallVo.getLeftBuyTimes();if(null==r)t.hdv_des1.innerHTML="";else{var l=r.type,c=r.leftTime,u=r.staticTime;1==l?t.hdv_des1.innerHTML=0==c?RP.n[322]+Ql.createColor(c+"/"+u,"#ff0000"):RP.n[323]+Ql.createColor(c+"/"+u,"#23b11f"):2==l&&(t.hdv_des1.innerHTML=RP.n[324]+Ql.createColor(c+"/"+u,"#23b11f"))}}t.img_money.skin=fu.getMoneyImg(t._dtoMallVo.moneyType),t.txt_price.x=73,2==t._dtoMallVo.moneyType?(t.img_money.x=7,t.img_money.y=0):4==t._dtoMallVo.moneyType?(t.img_money.x=-5,t.img_money.y=-9):3==t._dtoMallVo.moneyType&&(t.img_money.x=-10,t.img_money.y=0,t.txt_price.x=45);var d=Math.round(t._dtoMallVo.price);4==t._dtoMallVo.moneyType?t.txt_price.text=d+"":t.txt_price.text=9999<d?(.001*d>>0)/10+"万":d+"",5==t._dtoMallVo.tab&&t.showEffect(),t.adjustPos()}else t._grid.bindData=null}),e}(pu),mW=function(e){function t(){var e=this;e.goodsSP=null,e.effect=null,e._goodsIds=0,t.__super.call(e),null==zB.ins._godRing&&(zB.ins._godRing=e),e.initUI(),e.centerX=0,e.visible=!1,e.y=945,G.timer.once(1e3,e,e.initEnd)}b(t,"modules.broadcast.views.GodRingBroadView",_t);var i=t.prototype;return i.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},i.showInfo=function(e){this.parent||eq.topLayer.addChild(this),this._goodsIds=e,G.timer.once(200,this,this.timeout)},i.timeout=function(){var e=this;e.visible=!0,e.alpha=0,e.y=945;var t=Bi.getIndex(e._goodsIds),i=Bi.MODEL.equipType(t),n=Bi.MODEL.subType(t),s=0;1==i?(e.txt_getTitle.text=RP.n[325],s=Bi.MODEL.colourId(t),e.txt_name.color=ms.getByQuality(s)):(e.txt_getTitle.text=RP.n[326],6==n?(s=Bi.MODEL.colourId(t),e.txt_name.color=ms.getByQuality(s)):e.txt_name.color="#fdae13"),e.txt_name.text=Bi.MODEL.name(t),e.goodsSP.bindData=e._goodsIds,e.goodsSP.isClearUrl=!1;e.goodsSP.isSmall?Bi.MODEL.smallIcon(t):Bi.MODEL.icon(t);zB.isFlying=!0,Og.to(e,{y:e.y-200,alpha:1},400,null,ql.create(e,e.onScrollComplete),0,!0),G.timer.once(2800,e,e.playEnd)},i.initUI=function(){null==this.goodsSP&&(this.goodsSP=new AF),this.addChild(this.goodsSP),this.goodsSP.pos(this.img_BG.x,this.img_BG.y)},i.onScrollComplete=function(){this.effect||(this.effect=kB.createEffect("jm1109",this.img_BG.x+140,this.img_BG.y+60,this),this.effect.mouseThrough=!0),G.timer.once(1200,this,this.onScrollComplete1)},i.onScrollComplete1=function(){Og.to(this,{y:this.y-200,alpha:0},300,null,null,0,!0),this.effect&&(this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect.dispose(),this.effect=null)},i.playEnd=function(){var e=this;if(Og.clearAll(e),e.visible=!1,e.effect&&(e.effect.parent&&e.effect.parent.removeChild(e.effect),e.effect.dispose(),e.effect=null),e.removeSelf(),zB.isFlying=!1,hN.ins.isOpen("BOSS_GOD_SETTLE")||hN.ins.isOpen("BOSS_WILD_OWN_SCENE_JIESUAN")||hN.ins.isOpen("GUILD_BOSS_SETTLE_VIEW"))zB.gridGoods.length=0;else if(!hN.ins.isOpen("ACTOR_M")&&!hN.ins.isOpen("GOD_PANEL"))for(e.goodsSP.goodsId>=A_.GOD_RING_CHIP_ID[0]&&e.goodsSP.goodsId<=A_.GOD_RING_CHIP_ID[1]&&e.goodsSP&&e.goodsSP.clearIconTexture();zB.gridGoods.length;){var t=zB.gridGoods.shift();t instanceof modules.backpack.views.grid.GoodsGrid?t.clearIconTexture():NP.destoryImage(t)}},t}(),yW=function(e){function t(){var e=this;e.TYPE_SKILL=1,e.TYPE_GOODS=2,e.effect=null,e._contents=null,e._curShowContent=null,e.obj=null,t.__super.call(e),null==zB.ins._iconView&&((zB.ins._iconView=e)._contents=[],e.centerX=0,e.visible=!1,e.y=945,G.timer.once(100,e,e.initEnd))}b(t,"modules.broadcast.views.IconBroadView",ht);var i=t.prototype;return i.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},i.showSkill=function(e,t){var i=this;if(i.obj={type:i.TYPE_SKILL,id:e,content:t},null==i._curShowContent){i._curShowContent=i.obj;var n=Vn.getIndex(e),s=_r.getIconPath(Vn.MODEL.icon(n)),o=G.loader.getRes(s);o?i.drawSkillIcon(o):G.loader.load(s,ql.create(i,i.drawSkillIcon),null,"image"),i.alpha=0,i.y=945,i.visible=!0,i.txt_getTitle.text=t,i.txt_name.text=Vn.MODEL.name(n),Og.to(i,{y:i.y-252,alpha:1},400,null,ql.create(i,i.onScrollComplete),0,!0),G.timer.once(2700,i,i.playEnd)}else i._contents.push(i.obj)},i.showGoods=function(e,t){var i=this;if(i.parent||eq.navLayer.addChild(i),hN.ins.open("ICON_BROAD_VIEW"),i.obj={type:i.TYPE_GOODS,id:e,content:t},null==i._curShowContent){i._curShowContent=i.obj;var n=Bi.getIndex(e),s=Bi.MODEL.icon(n),o=Bi.MODEL.colourId(n),a=NR.getIcon(s);a?i.drawGoodsIcon(o,a):NR.loadIcon(s,ql.create(i,i.drawGoodsIcon,[o])),i.alpha=0,i.y=945,i.visible=!0,i.txt_getTitle.text=t,i.txt_name.text=Bi.MODEL.name(n),Og.to(i,{y:i.y-252,alpha:1},400,null,ql.create(i,i.onScrollComplete),0,!0),G.timer.once(2700,i,i.playEnd)}else i._contents.push(i.obj)},i.drawSkillIcon=function(e){e&&(this.img_BG.graphics.clear(),this.img_BG.graphics.drawTexture(G.loader.getRes("ui/layouts/base_ui2/ty_jm_gz.png"),0,0,this.img_BG.width,this.img_BG.height),this.img_BG.graphics.drawTexture(e,this.img_BG.width-100>>1,this.img_BG.height-100>>1,100,100))},i.drawGoodsIcon=function(e,t){var i=this;if(t){i.img_BG.graphics.drawTexture(G.loader.getRes("ui/layouts/base_ui2/ty_jm_gz.png"),0,0,i.img_BG.width,i.img_BG.height);var n=NI.gridBg(e),s=G.loader.getRes(n);s&&i.img_BG.graphics.drawTexture(s,0,0,i.img_BG.width,i.img_BG.height),i.img_BG.graphics.drawTexture(t,i.img_BG.width-110>>1,i.img_BG.height-110>>1,110,110),Zl.addIconUse(i,t.url)}},i.onScrollComplete=function(){var e=this;e.effect||e.obj||(e.effect=kB.createEffect("jm1109",e.img_BG.x+120,e.img_BG.y+60,e),e.effect.scaleY=1.5,e.effect.mouseThrough=!0);var t=0;t=e.obj?2200:1200,G.timer.once(t,e,e.onScrollComplete1,null,!0)},i.onScrollComplete1=function(){var e=this;Og.to(e,{y:e.y-200,alpha:0},300,null,ql.create(e,e.playNext),0,!0),e.effect&&(e.effect.parent&&e.effect.parent.removeChild(e.effect),e.effect.dispose(),e.effect=null)},i.playNext=function(){var e=this;if(e._curShowContent=null,e.visible=!1,0==e._contents.length)return Og.clearAll(e),void Zl.clearIconTexture(e);var t=e._contents.shift();switch(t.type){case e.TYPE_SKILL:e.showSkill(t.id,t.content);break;case e.TYPE_GOODS:e.showGoods(t.id,t.content)}},i.playEnd=function(){this.visible=!1,this._curShowContent&&(this._curShowContent=null,0<this._contents.length?this.playNext():this.removeSelf())},t}(),IW=function(e){function t(){var e=this;e._running=!1,e.txtfiters=[new fr("#b11717",10,0,0)],t.__super.call(e),e.centerX=0,e.centerY=242,null==zB.ins.rainbowView&&(zB.ins.rainbowView=e),e.mouseThrough=!0,e.txt_show.visible=e._running,G.timer.once(1e3,e,e.initEnd)}b(t,"modules.broadcast.views.RainbowView",s_);var i=t.prototype;return i.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},i.pushWords=function(e,t){void 0===t&&(t=1500),!e||e&&0==e.length||t<200||0==this._running&&e&&0<e.length&&this.playShow(e,t)},i.pushCfgId=function(e){if(0==this._running){var t=Tn.getIndex(e);0<=t&&this.pushCfgIndex(t)}},i.pushCfgIndex=function(e){if(0==this._running){Tn.MODEL.key(e);var t=Tn.MODEL.text(e),i=Tn.MODEL.time(e);if(i<200)return;if(!t||t&&0==t.length)return;this.pushWords(t,i)}},i.playShow=function(e,t){var i=this;i.parent||eq.navLayer.addChild(i),i._running=!0,i.txt_show.visible=i._running,i.txt_show.changeText(e),i.txt_show.strokeColor="#9e1200",i.txt_show.stroke=0,i.txt_show.color="#fff8ae",i.txt_show.filters=i.txtfiters,G.timer.once(t,i,i.stopShow)},i.stopShow=function(){this._running=!1,this.txt_show.filters=null,this.txt_show.textField.graphics.clear(!0),this.txt_show.visible=this._running,this.removeSelf()},t}(),bW=function(e){function t(){this._faceArr=null,t.__super.call(this),this._faceArr=QB.ins.faceArr,this.initUI()}b(t,"modules.chat.views.ChatFaceUI",rs);var i=t.prototype;return i.initUI=function(){this.list_face.selectEnable=!0,this.list_face.renderHandler=ql.create(this,this.updateItem,null,!1),this.list_face.array=this._faceArr},i.updateItem=function(e,t){e.clipX=1,e.clipY=this._faceArr[t++],e.interval=120,e.skin=_r.getFacePath("face"+t),e.autoPlay=!0},t}(),wW=function(e){function t(){t.__super.call(this),this.centerX=0,this.centerY=-240}b(t,"modules.checkpoint.view.CheckPointExpAddView",cs);var i=t.prototype;return i.show=function(){this.txExp.text=Hi.MODEL.wakeExp(UR.instance.currentPoint-2)+"",this.txExpN.innerHTML=Ql.createColor(Hi.MODEL.wakeExp(UR.instance.currentPoint-1)+"","#23b11f")+"/小时",this.txMoney.text=Hi.MODEL.wakeCopper(UR.instance.currentPoint-2)+"",this.txMoneyN.innerHTML=Ql.createColor(Hi.MODEL.wakeCopper(UR.instance.currentPoint-1)+"","#23b11f")+"/小时",this.alpha=1,this.scaleX=1,this.scaleY=1,G.timer.once(2e3,this,this.onMove)},i.onMove=function(){Og.to(this,{scaleX:.3,scaleY:.3},600,null,ql.create(this,this.onstartMove))},i.onstartMove=function(){Og.to(this,{alpha:.2,x:pt.width+60,y:90},400,null,ql.create(this,this.onMoveEnd))},i.onMoveEnd=function(){this.parent&&this.parent.removeChild(this)},i.destroy=function(e){void 0===e&&(e=!0),G.timer.clearAll(this),this.graphics.clear(),Og.clearAll(this),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="CheckPointExpAddView",t}(),xW=function(i){function n(e){var t=this;t._breakEff=null,t._breakID=null,t._activityEff=null,t._activityID=null,t._clickedEff=null,t._iconImg=null,t._profession=0,t._isPlaying=!1,n.__super.call(t),t._profession=e,t._breakID=n.BREAK_EFFECT_ID_ARR[e-1],t._activityID=n.ACTIVITY_EFFECT_ID_ARR[e-1],qH.Ins().addNoClears(t._activityID),t._iconImg=new Kl,t._iconImg.size(60,60),t.addChild(t._iconImg),t._iconImg.skin=_r.getAtlasSubPath("mainframe2/zhuiji_"+e+".png"),t.name=e.toString(),t._iconImg.alpha=.02}b(n,"modules.nav.views.ZhuiJiIcon",i);var e=n.prototype;return e.onAdd=function(e){var t=this;i.prototype.onAdd.call(t,e),t._isPlaying=!1,t.on("click",t,t.onIconImgClicked),t._activityEff=kB.createEffect(t._activityID,t._iconImg.x+30,t._iconImg.y+30,t)},e.onRemove=function(e){i.prototype.onRemove.call(this,e),this.off("click",this,this.onIconImgClicked),this.disposeEffect()},e.onIconImgClicked=function(e){if(LY.Ins().isShow()&&LY.Ins().closeArrow(),!this._isPlaying){for(var t=-1,i=0;i<gR.ins.actorList.length;i++)gR.ins.actorList[i].job==this._profession&&(t=i);ER.ins.isAutoZhuiJi&&0<=t&&0<=ER.ins.autoZhuiJiStr.indexOf((t+1).toString())?zB.ins.showMsg(Ql.createColor(RP.n[327],"#d6d6d6"),2):(this._isPlaying=!0,this.playClickEff(),sH.getInstance().playZhuiJi(this._profession))}},e.playClickEff=function(e){void 0===e&&(e=!0),this._clickedEff=kB.createEffect("jm1365",this._iconImg.x+30,this._iconImg.y+30,this),LY.Ins().isShow()&&LY.Ins().closeArrow(),e?this._clickedEff.playEndHandler=ql.create(this,this.playEndHandler):G.timer.once(200,this,this.playBreakEff)},e.playBreakEff=function(){kB.createEffect(this._breakID,this._iconImg.x+30,this._iconImg.y+30,this).playEndHandler=ql.create(this,this.playEndHandler)},e.playBreakEff2=function(e,t,i){this.disposeEffect(),kB.createEffect("jm1365",t,i,e),this.removeSelf()},e.playEndHandler=function(){this.removeSelf()},e.disposeEffect=function(){this._breakEff&&(this._breakEff.dispose(),this._breakEff=null),this._activityEff&&(this._activityEff.dispose(),this._activityEff=null),this._clickedEff&&(this._clickedEff.dispose(),this._clickedEff=null)},p(0,e,"profession",function(){return this._profession}),n.CLICK_EFFECT_ID="jm1365",f(n,["BREAK_EFFECT_ID_ARR",function(){return this.BREAK_EFFECT_ID_ARR=["jm1366","jm1367","jm1368"]},"ACTIVITY_EFFECT_ID_ARR",function(){return this.ACTIVITY_EFFECT_ID_ARR=["jm1359","jm1360","jm1361"]}]),n}(Gg),SW=function(e){function h(){this.fieldDto=null,this.xundi_time=0,this.isXundi_State=!1,this.effect=null,h.__super.call(this),h.TASK_ID=parseInt($e.MODEL.value($e.getIndex(230)))}b(h,"modules.field.views.FieldFightItem",e);var t=h.prototype;return t.onWatch=function(e){},t.onFight=function(e){if(this.isXundi_State)KQ.ins.showBox("消耗 "+Ql.createColor("100元宝",aR.GOLD.color)+RP.n[328],RP.n[329],ql.create(this,this.onGoXunDi),!1,3,null,null,RP.n[330]);else if(yJ.CHECK_POINT_STATUS=UR.instance.isAuto,UR.instance.isAuto&&(UR.instance.isAuto=!1),"1"!=uH.Ins().currCid){if(0!=BR.ins.curCopyId){var t=rn.getIndex(BR.ins.curCopyId);if(22==rn.MODEL.cate(t))return void zB.ins.playErrorMsg(RP.n[332])}var i=ZB.ins.toc_field;if(ZN.isEnabledChangeScene())if(TR.ins.getLeftGridNum()<20)KQ.ins.showBagRecycle();else if(100<=i.yeZhanPk){var n=parseInt($e.MODEL.value($e.getIndex(131))),s=(i.yeZhanPk-99)*n,o=RP.n[333]+Ql.createColor(i.yeZhanPk+"","#ff2e24")+RP.n[334]+Ql.createColor(s+"元宝",aR.GOLD.color)+"减少"+Ql.createColor(i.yeZhanPk-99+"","#23b11f")+"点PK值"+Ql.createColor(RP.n[335],"#23b11f");KQ.ins.show(o,ql.create(this,this.onTiaoZhan,[s]),!1)}else{var a=new YV;a.copyId=i.missionId;var r=rn.getIndex(i.missionId),l=rn.MODEL.playerBirthGrid(r);JSON.parse(l);a.playerId=this.fieldDto.playerId,ZB.ins.fighttingID=this.fieldDto.playerId,Tu.sendToService(a)}else zB.ins.showById(2126,1)}else zB.ins.playErrorMsg(RP.n[331])},t.onTiaoZhan=function(e,t){if(1==t){if(gR.ins.YB<e)return void G.timer.once(100,this,function(){KQ.ins.showNoGold()});var i=ZB.ins.toc_field,n=new YV;n.copyId=i.missionId;var s=rn.getIndex(i.missionId),o=rn.MODEL.playerBirthGrid(s),a=JSON.parse(o);n.x=a[0][0],n.y=a[0][1],n.playerId=this.fieldDto.playerId,Tu.sendToService(n)}},t.showEndCDTime=function(){this.div_xd.innerHTML=Ql.createColor(Jp.getTickNumber(this.xundi_time),"#23b11f")+RP.n[336],this.xundi_time--,this.xundi_time<=0&&(this.div_xd.innerHTML="",G.timer.clearAll(this))},t.onGoXunDi=function(e){if(1==e){if(gR.ins.YB<100)return KQ.ins.close(),void G.timer.once(100,this,function(){KQ.ins.showNoGold()});var t=new HD;Tu.sendToService(t)}},t.destroy=function(e){void 0===e&&(e=!0),G.timer.clearAll(this),laya.ui.View.prototype.destroy.call(this,e)},p(0,t,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.isXundi_State=!1,null!=e){var i=PH.Ins().info;if(i&&i.taskId==h.TASK_ID&&2==PH.Ins().info.status?null==t.effect&&(t.effect=kB.createEffect("jm1081",t.btn_fight.x+65,t.btn_fight.y+30,t),t.effect.mouseEnabled=t.effect.mouseThrough=!1):(t.effect&&t.effect.dispose(),t.effect=null),e&&e.hasOwnProperty("refreshT"))return t.isXundi_State=!0,t.box_tz.visible=!1,t.div_xd.visible=!0,t.btn_fight.label="寻 敌",t.xundi_time=Math.ceil(e.refreshT/1e3),t.div_xd.innerHTML=Ql.createColor(Jp.getTickNumber(t.xundi_time),"#23b11f")+RP.n[336],t.xundi_time--,G.timer.loop(1e3,t,t.showEndCDTime),void t.btn_fight.on("click",t,t.onFight);if(t.isXundi_State=!1,t.fieldDto=e,t.box_tz.visible=!0,t.div_xd.visible=!1,t.txt_name.text=t.fieldDto.name,0<t.fieldDto.zsLvl?t.txt_zsLvl.changeText(t.fieldDto.zsLvl+"转"+t.fieldDto.level+"级"):t.txt_zsLvl.changeText(t.fieldDto.level+"级"),dr.dtoEnterScene&&23==dr.dtoEnterScene.type?t.fieldDto.playerId==ZB.ins.fighttingID?t.btn_fight.label="挑战中":t.btn_fight.label="挑战":t.btn_fight.label="挑 战",t.fieldDto.fxId<0)(l=ZB.ins.getwfxbyid(t.fieldDto.fxId))&&(t.img_head.skin=_r.getActorWFXHeadPath(l.headImage),t.txt_name.text=l.name);else t.img_head.skin=_r.getActorHeadPath(t.fieldDto.pro,t.fieldDto.sex);var n=hi.getIndex(t.fieldDto.rewardId);null==n&&(n=0);var s=hi.MODEL.rewards(n),o=JSON.parse(s);if(t.g_exp.visible=o.length<3,t.g_exp.visible){var a=hi.MODEL.exp(n);t.txt_exp.text=a.toString()}for(var r=0;r<o.length;r++){var l;if("res"==(l=o[r]).type){var c=parseInt(l.value.split(":")[1]);t.txt_jb.text=1e4<c?(c/1e4).toFixed(1)+"万":c+""}else if("goods"==l.type){var u=l.value.split(":")[0],d=new MF(46);d.needEffect=!1,d.needGridBg=!1,d.x=137+106*r,0==r?t.txt_mc.text=l.value.split(":")[1]:1==r?t.txt_jb.text=l.value.split(":")[1]:t.txt_exp.text=l.value.split(":")[1],d.y=86,d.bindData=yB.create(u),t.box_tz.addChild(d)}}t.btn_fight.on("click",t,t.onFight)}}),h.TASK_ID=10039,h}(Ca),kW=function(e){function t(){var e=this;e._font0=null,e._font1=null,e._font2=null,e._font3=null,t.__super.call(e),e._font0=e.initFont(e.txt0),e._font1=e.initFont(e.txt1),e._font2=e.initFont(e.txt2),e._font3=e.initFont(e.txt3)}b(t,"modules.god.views.item.DuanHunAttrItem",sa);var i=t.prototype;return i.setTitle=function(e){this.txt_jie.text=e+"阶"},i.update=function(e,t,i){if(e&&0!=e.length){for(var n,s=aa.formatAttrToChineseByList(e),o=Math.min(4,s.length),a=0;a<o;a++){(n=this["_font"+a]).clear();var r=s[a],l=r.name,c=!1;l==aa.ATTR_INC_RATE.name&&(l=0==i?RP.n[338]:RP.n[339],c=!0),n.append(l+"：",c?"#ffff00":"#90877b"),n.append(r.val,c?"#ffff00":"#90877b")}for(;a<4;a++)(n=this["_font"+a]).clear()}},i.initFont=function(e){var t=new Is(e.fontSize);return kB.replace(e,t),t},t}(),EW=function(e){function i(e){var t=this;t._font0=null,t._font1=null,t._font2=null,t._font3=null,i.__super.call(t),t.setTitle(e),t._font0=t.initFont(t.txt0),t._font1=t.initFont(t.txt1),t._font2=t.initFont(t.txt2),t._font3=t.initFont(t.txt3)}b(i,"modules.god.views.item.GeAttrItem",sr);var t=i.prototype;return t.setTitle=function(e){this.txt_head.changeText(e)},t.update=function(e,t,i){for(var n,s=PR.getGoodsNewAttr(e),o=aa.formatAttrToChineseByList(s),a=0;a<o.length;a++){(n=this["_font"+a]).clear();var r=o[a];n.append(r.name+"：","#90877b").append(r.val+"","#90877b"),0<t&&n.append(" +"+aa.getFormatValue(r.id,r.val*t>>0),"#90877b"),this["bg"+a].visible=!0}for(;a<4;a++)(n=this["_font"+a]).clear(),this["bg"+a].visible=!1},t.initFont=function(e){var t=new Is(e.fontSize);return kB.replace(e,t),t},i}(),TW=function(e){function t(){this._data=null,this._isShowRedPoint=!1,this.flyLvIsOk=!1,this._challengeCDTime=0,this.skin=0,t.__super.call(this),this.initUI()}b(t,"modules.godweapon.views.shengyu.GodWeaponSYItem",Ar);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.img_bg&&this.img_bg.skin&&G.loader.clearRes(this.img_bg.skin)},i.updateRedPoint=function(e){this.txt_time.visible&&"已刷新"==this.txt_time.text&&(this.red_point.visible=e)},i.onTimer1=function(){this._challengeCDTime--,this._challengeCDTime<0&&(this._challengeCDTime=0)},i.setRefesh=function(e){void 0===e&&(e=!1),this.txt_fly.color=e?"#90877b":"#e6d80d";var t="godweapon/sy_icon_"+this.skin+"_"+(e?0:1);this.img_bg.skin=_r.getAtlasSubPath(t+".png")},i.onTimer=function(){var e=this._data.time-=1e3;if(e<0)return this.event("end"),0<this._data.bossHp&&(this.txt_time.text="已刷新"),void(0<cN.instance.ShenBin_ShenYuInfo.guishuNum&&this.flyLvIsOk&&(0==this._data.select?this.red_point.visible=!0:this.red_point.visible=!1));this.txt_time.text=Go.deltaFormat(e,"hh:mm:ss")},i.onClickThis=function(e){0<this._challengeCDTime?zB.ins.playErrorMsg(RP.n[340]+this._challengeCDTime+"秒"):0<this._data.time?zB.ins.playErrorMsg(RP.n[341]):TR.ins.getLeftGridNum()<20?zB.ins.playErrorMsg(RP.n[342]):this._data.bossHp<=0?zB.ins.playErrorMsg(RP.n[343]):0==this.flyLvIsOk?zB.ins.playErrorMsg(RP.n[344]):jR.reqEntry(this._data.missionId)},i.initUI=function(){this.red_point.visible=!1,this.on("click",this,this.onClickThis)},p(0,i,"data",function(){return this._data},function(e){this._data=e,this.red_point.visible=!1;var t=rn.getIndex(this._data.missionId),i=gR.ins.zsLv;this.txt_fly.text=rn.MODEL.zsLevelLimit(t)+"转",i<rn.MODEL.zsLevelLimit(t)?(this.flyLvIsOk=!1,this.txt_time.text="",this.setRefesh(!0)):(this.flyLvIsOk=!0,this.setRefesh(),this.challengeCDTime=this._data.challengeCDTime,0<this._data.time?(this.red_point.visible=!1,this.timerLoop(1e3,this,this.onTimer),this.onTimer()):(this.clearTimer(this,this.onTimer),0<this._data.bossHp&&(this.txt_time.text="已刷新"),0<cN.instance.ShenBin_ShenYuInfo.guishuNum&&this.flyLvIsOk&&(0==this._data.select?this.red_point.visible=!0:this.red_point.visible=!1)))}),p(0,i,"Skin",null,function(e){this.skin=e,this.img_name.skin=_r.getAtlasSubPath("godweapon/sy_level_"+e+".png");var t=lN.SY_ITEM_LOC[e];this.img_bg.pos(t.icon[0],t.icon[1]),this.img_txt_bg.pos(t.tbg[0],t.tbg[1]),this.txt_fly.pos(t.fly[0],t.fly[1]),this.txt_time.pos(t.time[0],t.time[1])}),p(0,i,"challengeCDTime",null,function(e){0<(this._challengeCDTime=e)&&this.timerLoop(1e3,this,this.onTimer1)}),t.REFRESH="已刷新",t}(),CW=function(e){function t(){this._data=null,this.missId=0,this.sydata=null,t.__super.call(this),this.sydata=cN.instance,this.ckb_tixing.on("click",this,this.onCBSelected)}b(t,"modules.godweapon.views.shengyu.GodWeaponTXItem",Rr);var i=t.prototype;return i.onCBSelected=function(e){var t=rn.getIndex(this._data.missionId);rn.MODEL.bossId(t);this.missId=rn.MODEL.key(t);var i=new bA;i.copyId=this.missId,i.selected=this.ckb_tixing.selected,Tu.sendToService(i),this.sydata.txHash.put(this.missId,this.ckb_tixing.selected,!0)},p(0,i,"data",function(){return this._data},function(e){this._data=e;var t=rn.getIndex(e.missionId),i=rn.MODEL.bossId(t);this.missId=e.missionId;var n=hn.getIndex(i),s=hn.MODEL.name(n);this.txt_name.changeText(s),this.txt_lv.text=rn.MODEL.zsLevelLimit(t)+"转-"+rn.MODEL.zsLevelUpLimit(t)+"转",gR.ins.zsLv<rn.MODEL.zsLevelLimit(t)?(this.txt_no.visible=!0,this.ckb_tixing.visible=!1):(this.txt_no.visible=!1,this.ckb_tixing.visible=!0),this.ckb_tixing.selected=this.sydata.txHash.take(this.missId)}),t}(),LW=function(e){function t(){t.__super.call(this)}b(t,"modules.godweapon.views.weapon.GodWeaponDetailAttrsTip",yr);var i=t.prototype;return i.show=function(e){var t=this;void 0===e&&(e=-1);var i=iN.instance,n=e;n<=0&&(n=i.crtRoleId);var s=i.rolesDict[n];if(s){t.lab_title.text=Li.MODEL.name(s.weaponId-1),t.txt_attrs.height=0;for(var o=i.getWeaponTotalByRoleId(n),a=aa.formatAttrToChineseByList(o),r="",l=0;l<a.length;l++){var c=a[l];r+=F.getPro(s.weaponId)+c.sname+"："+c.val+"<br>"}t.txt_attrs.innerHTML=r,t.txt_attrs.style.leading=8,t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t)),t.height=t.txt_attrs.y+t.txt_attrs.height+80}},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return t._instance||(t._instance=new t),t._instance},layouts.godweapon.weapon.GodWeaponDetailAttrTipUI._$SET_instance),t._instance=null,t}(),MW=function(e){function i(e){var t=this;t.equipPos=-1,t.locked=!0,t.equipIcon=null,i.__super.call(t),t.equipPos=e,t.equipIcon=new MF,t.equipIcon.needEffect=!1,t.equipIcon.mouseEnabled=!1,t.equipIcon.needGridBg=!1,t.equipIcon.scale(.9,.9),t.equipIcon.pos(-7.5,-7.5),t.addChild(t.equipIcon),t.mouseEnabled=!0}b(i,"modules.godweapon.views.weapon.GodWeaponHolyIcon",Lr);var t=i.prototype;return t.setData=function(e,t){var i=this;i.locked=t,i.locked?(i.img_locked.visible=!0,i.img_add.visible=!1,i.img_unLocked.visible=!1,i.equipIcon.bindData=null):(i.img_unLocked.visible=!1,i.img_locked.visible=!1,e?(i.equipIcon.bindData=e,i.img_add.visible=!1,i.img_unLocked.visible=!0):(i.img_add.visible=!0,i.equipIcon.bindData=null))},p(0,t,"dtoEquip",function(){return this.equipIcon.bindData}),i}(),AW=function(e){function t(){var e=this;e.equipIcon=null,t.__super.call(e),e.equipIcon=new MF,e.equipIcon.isClearUrl=!1,e.equipIcon.y=17,e.equipIcon.x=16,e.addChildAt(e.equipIcon,0),e.btn_wear.label="更 换",e.btn_wear.on("click",e,e.onClickHandler),e.addChild(e.equipName),e.txt_attrs.style.leading=10}b(t,"modules.godweapon.views.weapon.GodWeaponHolySelectItem",e);var i=t.prototype;return i.onClickHandler=function(e){var t=this.equipIcon.bindData;t&&(sN.reqHolyWear(this.dataSource.roleId,t.uuId,this.dataSource.position),Tu.sendToModule("CLOSE_HOLY_SELECTED_PANEL",["modules.godweapon.GodWeaponModule"]))},i.getColorName=function(e){switch(e){case 1:return"凡品";case 3:return"精品";case 4:return"极品";case 5:return"神品"}return"凡品"},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(Dr,t,"dataSource",e);var i=e;if(i){var n=i.dto;t.equipIcon.bindData=n;var s=i.wear;t.btn_wear.visible=!s,t.mc_flag.visible=s;var o="";o=n.attribles;var a=aa.formatAttrToChineseByList(o);o=RP.n[345]+"<br>";for(var r=0;r<a.length;r++){var l=a[r];l&&(o+=F.getPro(n.roleJob)+l.sname+"："+l.val+"<br>")}t.txt_attrs.innerHTML=o,t.lab_score.text="评分："+n.getGoodScore(),t.equipName.innerHTML=n.name;var c="";switch(n.colourId){case 1:c="#d6d6d6";break;case 3:c="#a93aff";break;case 4:c="#ff831e";break;case 5:c="#e41b00"}t.txt_pingzhi.text=t.getColorName(n.colourId),t.txt_pingzhi.color=c;var u=i.roleId,d=Bi.MODEL.holyAddSkill(n.cfgIdx),h=0;if(d&&0<d.length){var _=d.split(":");h=parseInt(_[0])}var f="";if(0<h)for(var p=iN.instance.rolesDict[u],g=iN.instance.getPositonsByWeaponId(p.weaponId),v=0;v<g.length;v++){if(Mi.MODEL.position(g[v])==h){f=Mi.MODEL.skillName(g[v]);break}}var m=RP.n[346]+f+"等级";t.equipDescr.innerHTML=m}}),t}(Dr),DW=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.godweapon.views.weapon.GodWeaponHolySelectPanel",Or);var i=t.prototype;return i.init=function(){this.list.itemRender=AW,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,iu.optimizeList(this.list,AW)},i.updataData=function(e){var t,i=e.roleId,n=e.position,s=gR.ins.actorById(i),o=iN.instance.getGodHoly(i,n),a=TR.ins.getPackGodWeaponHolys(),r=[];if(o&&r.push({roleId:i,position:n,dto:o,wear:!0}),s)for(var l in a)0<(t=a[l]).roleJob?s.job==t.roleJob&&r.push({roleId:i,position:n,dto:t,wear:!1}):r.push({roleId:i,position:n,dto:t,wear:!1});this.lab_tip.visible=r.length<=0,this.list.array=r},t}(),OW=function(e){function t(){var e=this;e._upgradeEff=null,e.py=0,e.positionId=0,e.weaponId=0,e.positionIndex=-1,e.extPoint=0,e.roleId=-1,e.actived=!1,t.__super.call(e),e.mouseEnabled=!0,e.init()}b(t,"modules.godweapon.views.weapon.GodWeaponPositionTip",Br);var i=t.prototype;return i.init=function(){this.btn_upgrade.on("click",this,this.onClickHandler)},i.onClickHandler=function(e){this._upgradeEff&&this.disposeUpgradeEff(),null==this._upgradeEff&&(this._upgradeEff=kB.createEffect("jm1078",300,300,this),this._upgradeEff.playEndHandler=ql.create(this,this.disposeUpgradeEff)),sN.reqPosUpgrade(iN.instance.crtRoleId,this.positionId)},i.disposeUpgradeEff=function(){this._upgradeEff&&(this._upgradeEff.removeSelf(),this._upgradeEff.destroy(),this._upgradeEff=null)},i.showPanel=function(){},i.update=function(){this.parent&&0<=this.positionIndex&&this.parseData(this.positionIndex,this.extPoint,this.actived)},i.show=function(e,t,i,n){void 0===n&&(n=-1),this.parseData(e,t,i,n),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.parseData=function(e,t,i,n){var s=this;void 0===n&&(n=-1);var o=iN.instance;s.roleId=n,s.roleId<=0&&(s.roleId=o.crtRoleId);var a=o.rolesDict[s.roleId];if(a){s.actived=i,s.weaponId=a.weaponId,s.positionIndex=e,s.extPoint=t,s.positionId=Mi.MODEL.position(s.positionIndex);var r=a.skills[s.positionId];s.lab_title.text="";var l=Mi.MODEL.upgradeLimit(s.positionIndex);l+=s.extPoint;s.txt_lv.innerHTML=Mi.MODEL.skillName(s.positionIndex)+"("+Ql.createColor(r+"/"+l,"#e0d6c1")+")";var c=Mi.MODEL.icon(s.positionIndex);s.box_icon.skin=_r.getGodWeaponPath("pos_icon/"+c);var u=s.weaponId+"_"+s.positionId+"_"+r,d=ki.getIndex(u);s.py=240,s.actived?s.activedUpdateUI(d,s.positionIndex,r,s.extPoint):s.noActivedUpdateUI(d,s.positionIndex)}},i.activedUpdateUI=function(e,t,i,n){var s=this;s.nextBox.visible=!1,s.btn_upgrade.visible=!1,s.descrBox.visible=!1;var o="";if(s.crtBox.visible=!0,s.crtBox.y=s.py,o=ki.MODEL.descr(e),s.crtDescr.height=0,s.crtDescr.innerHTML=o,s.py+=40+s.crtDescr.height+20,s.py+=20,o="",Mi.MODEL.maxLevel(t)<=i)o=Ql.createSizeColor(RP.n[347],30,"#db6e09");else{s.nextBox.visible=!0,s.nextBox.y=s.py;var a=s.weaponId+"_"+s.positionId+"_"+(i+1),r=ki.getIndex(a);o=ki.MODEL.descr(r),s.nextDescr.height=0,s.nextDescr.innerHTML=o,s.py+=40+s.nextDescr.height+20,s.py+=40,o="";var l=0;if(0<=e&&(l=ki.MODEL.points(e)),Mi.MODEL.upgradeLimit(t)<=i-n)o+=Ql.createSizeColor(RP.n[348],30,"#e41b00")+"<br>",s.txt_condition1.y=s.py,s.img_line.y=s.py-30;else{s.btn_upgrade.y=s.py,s.py+=70,s.btn_upgrade.visible=!0;var c=iN.instance,u=0,d=c.rolesDict[c.crtRoleId];d&&(u=d.leftPoint);var h=l<=u;s.btn_upgrade.gray=!h,s.btn_upgrade.mouseEnabled=h,s.txt_condition1.y=s.py-110,s.img_line.y=s.py-125,0==u?o+=Ql.createSizeColor(RP.n[349],22,"#5f5952")+"<br>":(o+=Ql.createSizeColor(RP.n[350],22,"#5f5952"),o+=Ql.createSizeColor(u.toString(),22,"#00FF00")+"<br>")}}s.txt_condition1.height=0,s.txt_condition1.innerHTML=o,s.py+=s.txt_condition1.height,s.py+=40,s.height=s.py,s.txt_condition.innerHTML=""},i.noActivedUpdateUI=function(e,t){var i=this;i.crtBox.visible=!1,i.nextBox.visible=!1,i.descrBox.visible=!0,i.btn_upgrade.visible=!1;var n="",s=Mi.MODEL.special(t);if(s){i.crtBox.visible=!0,i.crtBox.y=i.py,n=ki.MODEL.descr(e),i.crtDescr.height=0,i.crtDescr.innerHTML=n,i.py+=40+i.crtDescr.height+20,i.py+=20,i.nextBox.visible=!0,i.nextBox.y=i.py;var o=i.weaponId+"_"+i.positionId+"_1",a=ki.getIndex(o);n=ki.MODEL.descr(a),i.nextDescr.height=0,i.nextDescr.innerHTML=n,i.py+=40+i.nextDescr.height+20}i.descrBox.y=i.py,i.txtDescr.text=Mi.MODEL.descr(t),i.py+=104,n="";var r=null;0<=e&&(r=ki.MODEL.conditionDef(e));var l=JSON.parse(r);if(l){if(i.py+=10,i.txt_condition.y=i.py,i.txt_condition.height=0,n+=Ql.createSizeColor(RP.n[351],24,"#e41b00")+"<br>",s)n+=Ql.createSizeColor(RP.n[352],24,"#e41b00"),i.img_line.y=i.py-50;else{var c;for(var u in l)if(c=l[u]){var d=c.value.split(":");n+=Ql.createSizeColor(iN.instance.getPositionName(i.weaponId,parseInt(d[0]))+"到达"+d[1]+"级",24,"#e41b00")+"<br>"}i.img_line.y=i.py-20}n+=Ql.createSizeColor("后解锁",24,"#e41b00")+"<br>"}else n=r;i.txt_condition.innerHTML=n,i.py+=i.txt_condition.height,i.py+=40,i.height=i.py,i.txt_condition1.innerHTML=""},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);this.disposeUpgradeEff(),this.imgIconBg.skin=null,this.box_icon.skin=null,eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return t._instance||(t._instance=new t),t._instance},layouts.godweapon.weapon.GodWeaponSkillAlertUI._$SET_instance),t._instance=null,t}(),PW=function(e){function t(){var e=this;e.positionId=0,e.weaponId=1,e.level=0,e.extPoint=5,e.posInex=0,e.actived=!1,e._$7_size=1,e.posX=0,e.posY=0,e.eff=null,e.preLinks=[],e.conditionDef=null,e.grayFilter=new ys([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),t.__super.call(e),e.pivot(55,55),e.mouseEnabled=!0,e.on("click",e,e.onClick)}b(t,"modules.godweapon.views.weapon.GodWeaponSkillIcon",Hr);var i=t.prototype;return i.onClick=function(e){OW.instance.show(this.posInex,this.extPoint,this.actived)},i.setData=function(e,t,i){var n=this;n.posInex=e,n.weaponId=t,n.positionId=Mi.MODEL.position(e),n.extPoint=iN.instance.getExtPt(i.roleId,n.positionId);var s=Mi.MODEL.axis(e),o=s.split(",");n.posX=parseInt(o[0]),n.posY=parseInt(o[1]),n.pos(n.posX,n.posY),n.preLinks.length=0,o=(s=Mi.MODEL.preLinks(e)).split(","),n.preLinks.push(parseInt(o[0])),n.preLinks.push(parseInt(o[1]));var a=Mi.MODEL.sizeType(e);n.scaleX=n.scaleY=1==a?.6:2==a?.8:1,n.bg_big.visible=1!=a;var r,l=null;n.conditionDef=null,n.level=0,i&&(n.level=parseInt(i.skills[n.positionId]),l=i.skills);var c=n.weaponId+"_"+n.positionId+"_"+n.level,u=ki.getIndex(c);0<=u&&(n.conditionDef=ki.MODEL.conditionDef(u)),r=ks.enoughCondition(n.conditionDef,l);var d=Mi.MODEL.icon(e);n.skillIcon.skin=_r.getGodWeaponPath("pos_icon/"+d),n.actived=r,n.actived&&n.skillIcon?n.skillIcon.filters=[]:n.skillIcon&&(n.skillIcon.filters=[n.grayFilter]);var h=Mi.MODEL.upgradeLimit(e);h=parseInt(h.toString()),h+=parseInt(n.extPoint.toString());var _=0<n.extPoint?"#17f129":"#dbb90a";n.actived?n.lab_level.innerHTML=Ql.createColor(n.level+"/"+h,_):n.lab_level.innerHTML=Ql.createColor(n.extPoint+"/"+n.extPoint,_),n.img_txtbg.visible=n.lab_level.visible=r||0<n.extPoint,n.actived&&n.level<h&&0<i.leftPoint?n.eff||(n.eff=kB.createEffect("jm1081",n.width/2,n.height/2,n)):n.eff&&(n.eff.dispose(),n.eff=null)},t}(),RW=function(e){function t(){this.items=[],this.eff=null,this._data=null,this.crtTaskId=0,this.crtWeaponId=0,this.targetIndex=0,this._linkStr=null,t.__super.call(this),this.init()}b(t,"modules.godweapon.views.weapon.GodWeaponTaskSubPanel",Gr);var i=t.prototype;return i.init=function(){this._data=iN.instance;for(var e=0;e<3;e++){var t=new uN;t.skin=this["item"+(e+1)],this.items.push(t)}this.btn_taskOption.on("click",this,this.onClickHandler)},i.clearAll=function(e){void 0===e&&(e=!0),this.clearEff()},i.onClickHandler=function(e){var t=this;if(t._data.crtRoleId<=0)zB.ins.showMsg(RP.n[353],1);else if(0<t.crtTaskId){var i=lB.instance().progressDic[t.crtTaskId];if(i)if(1==i.phase)sN.reqFinishedTask(t.crtTaskId);else{var n=Np.parse(t._linkStr);n&&2==n.type&&(n.backId=0),Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],n)}else 0<t._data.currentStatus&&sN.reqActiveWeapon(t._data.crtRoleId)}else{if(0==t.btn_taskOption.showTip)return void zB.ins.showMsg(RP.n[354],1);var s=Li.getIndex(t.crtWeaponId),o=Li.MODEL.name(s),a="领取"+Ql.createColor(o,"#e6d80d")+RP.n[355];KQ.ins.show(a,ql.create(t,t.closeGetTaskAlert))}},i.closeGetTaskAlert=function(e){1==e&&sN.requestGetTask(this._data.currentTaskId,this._data.crtRoleId)},i.updateTypeUI=function(e,t){var i=this._data.getPreviewIndexs(e),n=Li.getIndex(e),s=Li.MODEL.icon(n);this.icon_title.skin=_r.getGodWeaponPath(s);for(var o=0;o<this.items.length;o++){var a=this.items[o];o<i.length?(a.data=i[o],a.showHide(!0)):a.showHide(!1)}this.crtTaskId=t,this.crtWeaponId=e,this.updateTaskUI(e,t)},i.updateTaskUI=function(e,t){var i=this,n=Li.getIndex(e),s=Li.MODEL.descr(n);if(i._linkStr=null,0<t){var o=lB.instance().progressDic[t];if(o){var a=o.targetList[0],r=n_.getIndex(a.targetId),l=n_.MODEL.hasJob(r);i._linkStr=n_.MODEL.link(r);var c=[],u=n_.MODEL.value(r),d=n_.MODEL.descr(r);d&&0<d.length&&(c=d.split(","));var h=parseInt(c[0]);l&&(h=parseInt(c[e-1])),a.targetValue=u;var _=0<a.currentValue&&a.currentValue==a.targetValue?"#23b11f":"#ff2e24";i.lab_taskDescr.innerHTML=zB.ins.getDesc(h)+Ql.createColor("("+a.currentValue+"/"+a.targetValue+")",_),1==o.phase?(i.btn_taskOption.label=RP.n[356],i.createEff()):(i.btn_taskOption.label="前 往",i.clearEff())}else 0<i._data.currentStatus?(i.btn_taskOption.label="激 活",i.createEff()):(i.btn_taskOption.label="前 往",i.clearEff());i.lab_taskTitle.innerHTML=s+i._data.getTaskProgressDescr(),i.btn_taskOption.showTip=!1}else i.lab_taskTitle.innerHTML=s,i.lab_taskDescr.innerHTML=RP.n[357],i.btn_taskOption.label=RP.n[358],i.btn_taskOption.showTip=0<i._data.crtRoleId&&0==i._data.currentTaskIds.indexOf(i._data.currentTaskId)&&-1==i._data.currentStatus,i.clearEff()},i.createEff=function(){this.eff||(this.eff=kB.createEffect("jm1130",this.btn_taskOption.x+(this.btn_taskOption.width>>1),this.btn_taskOption.y+(this.btn_taskOption.height>>1),this),this.eff.scale_X=1.25,this.eff.scale_Y=1.25)},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},t}(),NW=function(e){function t(){this._callBack=null,t.__super.call(this),this.descr.style.align="center",this.bntOk.on("click",this,this.onBtnClick)}b(t,"modules.godweapon.views.weapon.GoldCostAlert",Jr);var i=t.prototype;return i.show=function(e,t,i,n,s,o){var a=this;void 0===s&&(s=2),void 0===o&&(o=!1),n?n==RP.n[359]?(a.titleName.text="",a.title_Chongzhi.visible=!0):(a.titleName.text=n,a.title_Chongzhi.visible=!1):(a.titleName.text="提示",a.title_Chongzhi.visible=!1),a.descr.style.leading=s,a.descr.innerHTML=e,a.costGold.text=t.toString(),a.bntOk.gray=o,a._callBack=i,a.parent||(eq.panelLayer.on("MASK_CLOSE",a,a.onClick),eq.panelLayer.openTip(a))},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},i.onBtnClick=function(e){var t=this._callBack;t&&t.run(),this.close(!0)},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.godweapon.weapon.GoldCostAlertUI._$SET_ins),t._inst=null,t}(),BW=function(e){function t(){this.grid=null,this.redot=null,this.lvEnou=!1,this._eff=null,this.hasArrow=!1,t.__super.call(this)}b(t,"modules.limitChallenge.views.godEquip.LCGodEquipTaskItem",e);var i=t.prototype;return i.onClick=function(e){var t=this;if(e.target==t.btnGo1||e.target==t.btnGo){if(!mN.ins.getIsFinishById(t.tag.preId))return;switch(t.tag.status){case 1:for(var i in t.tag.openConditions){var n=t.tag.openConditions[i];switch(n.type){case"playerLevel":if(gR.ins.lv<n.value)return void zB.ins.showMsg(RP.n[20],1);break;case"ringLevel":if(aB.instance.activedRingId<n.value)return void zB.ins.showMsg(RP.n[20],1);break;case"roleFlyUpLevel":if(gR.ins.actorFlyUpLevel<n.value)return void zB.ins.showMsg(RP.n[20],1);break;case"passedGuanqiaNum":if(UR.instance.currentPoint<n.value)return void zB.ins.showMsg(RP.n[20],1)}}t.goToTarget();break;case 2:if(!t.lvEnou)return void zB.ins.playErrorMsg(RP.n[364]);if(TR.ins.getLeftGridNum()<1)return void KQ.ins.showBagRecycle();t.rewardReq(),1==mN.showArrow&&(mN.showArrow=!1)}}else e.target==t.boxLink&&EB.showCharge&&HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet&&hN.ins.open("FIRST_RECHARGE",null,"LIMIT_CHALLENGE_MAIN_VIEW")},i.rewardReq=function(){mN.ins.reqReward(this.tag.id)},i.goToTarget=function(){var e="1",t=this.tag.action.split("|");if(50==parseInt(t[0]))return hN.ins.open("PLAY_UPGRADE_DIRECTION"),void(hN.ins.isOpen("LIMIT_CHALLENGE_MAIN_VIEW")&&hN.ins.close("LIMIT_CHALLENGE_MAIN_VIEW"));if(ZN.isEnabledChangeScene()||2==parseInt(t[0])){if(51==parseInt(t[0]))return mN.showGuild=!0,hN.ins.close("LIMIT_CHALLENGE_MAIN_VIEW"),"1"==uH.Ins().currCid&&(dr.dtoEnterScene=null,e=uH.Ins().prveCid=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"",NF.Ins().changeScene(e,!0,ql.create(aF,aF.onReadForYeZhanHandler)),sH.getInstance().autoMode=!0,eB.getInstance().resetAllSkillCd()),void Tu.sendToModule("UPDATE_GUANQIA_GUIDE",["modules.nav.NavModule"]);if(15==parseInt(t[0])){var i=parseInt($e.MODEL.value($e.getIndex(106)));if(gR.ins.lv<i)return void zB.ins.playErrorMsg(i+RP.n[365]);if(dr.dtoEnterScene=null,e=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"",uH.Ins().currCid==e)return void hN.ins.close("LIMIT_CHALLENGE_MAIN_VIEW");uH.Ins().prveCid=e,NF.Ins().changeScene(e,!0,ql.create(aF,aF.onReadForYeZhanHandler)),sH.getInstance().autoMode=!0,eB.getInstance().resetAllSkillCd()}var n=Np.create(0|t[0],t[1]);if(2<t.length&&(15==t[0]?n.cId=t[2]:n.data=t[2]),n.backId="LIMIT_CHALLENGE_MAIN_VIEW",hN.ins.close("LIMIT_CHALLENGE_MAIN_VIEW"),"SOARING_VIEW"!=t[1])Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],n);else{if(this.tag.roleId){var s=gR.ins.actorList.length>=this.tag.roleId?this.tag.roleId:1;return void hN.ins.open("SOARING_VIEW",{_subIndex_:0,actorId:s})}hN.ins.open("SOARING_VIEW",{_subIndex_:parseInt(t[2])})}}else zB.ins.showById(2126,1)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.tag=e,G.superSet(dc,t,"dataSource",e),t.graphics.clear(),t.boxLink.visible=!1;var i=mN.ins.getIsFinishById(e.preId);t.labDesc.color=i?"#23b11f":"#5f5952",t.labDesc.text=i?e.taskName:e.descForNo,t.labPro.text=i?"("+e.progress+"/"+e.tarValue+")":"",t.labDesc.y=i?27:48,t.labPro.color=e.progress<e.tarValue?"#ff2e24":"#23b11f";for(var n=e.reward.toString().split(";"),s=0,o=0,a=0;a<n.length;a++){var r=n[a].split(",");s=parseInt(r[0]),o=parseInt(r[1])}t.grid||(t.grid=new MF(92),t.grid.pos(21,13)),t.grid.bindData=yB.create(s,o),t.addChild(t.grid),t.grid.filters=null,i||Pg.gray(t.grid);for(var l in e.lvLim){var c=e.lvLim[l];switch(c.type){case"playerLevel":t.lvEnou=gR.ins.lv>=c.value,c.value+"级可领";break;case"playerZhuanShengLevel":t.lvEnou=gR.ins.zsLv>=c.value,c.value+"转可领"}}if(t._eff&&t._eff.dispose(),t._eff=null,t.btnGo1.visible=i,t.btnGo1.gray=3==e.status,2==e.status&&i?t.btnGo.label="领 取":3==e.status?t.btnGo.label="已领取":t.btnGo.label="前 往",2==e.status&&t.lvEnou&&i){t.redot||(t.redot=new pp),t.redot.graphics.clear();var u=G.loader.getRes(NI.POINT);u&&t.redot.graphics.drawTexture(u,0,0,u.width,u.height),t.redot.x=106,t.redot.y=-6,t.btnGo.addChild(t.redot),t._eff=kB.createEffect("jm1130",65,30),t._eff.scale_X=.8,t._eff.scale_Y=1,t.btnGo.addChildAt(t._eff,0)}else t.redot&&(t.redot.removeSelf(),t.redot.destroy(),t.redot=null),t._eff&&t._eff.dispose(),t._eff=null;t.on("click",t,t.onClick),2==e.status&&i&&2==e.status?0==mN.showArrow&&(LY.Ins().show(42,t.btnGo1,!1,t),mN.showArrow=!0,t.hasArrow=!0):LY.showing&&t.hasArrow&&(LY.Ins().closeArrow(),mN.showArrow=!1,t.hasArrow=!1)}}),t}(dc),HW=function(e){function t(){this.tipsIdx=1,this.per=0,t.__super.call(this),this.big_bg.skin=_r.checkTranferSkin(ff.LOADING_BG,"ui/layouts/login/dl_jm_bg1.jpg"),RU.urls.push(this.big_bg.skin),pt.onMobile&&"awy"==hr.appid&&(this.big_bg.left=0,this.big_bg.right=0)}b(t,"modules.login.views.LoadingView",Ic,"LoadingView$1");var i=t.prototype;return i.inteUI=function(){this.txt_broadcast.text=RP.n[366]},i.isShowing=function(){return this.parent},i.show=function(){this.resize(),this.inteUI(),G.stage.addChild(this),this.startShowTips();var e=RP.n[367];hr.loadingDescribe?e=hr.loadingDescribe:1==dr.application_model&&(e=""),this.txt_des3.text=e,dr.loadingView&&(dr.nativeIOS&&1==dr.iosCheck?this.addChild(dr.loadingView):(this.addChildAt(dr.loadingView,0),dr.loadingView.show("",!0)))},i.startShowTips=function(){if(Xi.count<=0||Qi.count<=0){var e=[{url:_r.getJxrDBPath("LoadingCoolTime"),type:"arraybuffer",cls:Xi},{url:_r.getJxrDBPath("LoadingMsg"),type:"arraybuffer",cls:Qi}];uc.ins().onLoadJxrs(e,ql.create(this,this.startShowTips))}else{var t=Xi.MODEL.coolTime(0);this.timerLoop(t,this,this.showTips),this.txt_broadcast.text=Qi.MODEL.tipMsg(0)||""}},i.showTips=function(){var e,t=Qi.count;1!=this.tipsIdx?(this.tipsIdx=Math.floor(Math.random()*(t-2))+2,this.tipsIdx==t&&(this.tipsIdx=2)):e=Qi.MODEL.tipMsg(this.tipsIdx++),this.txt_broadcast.text=e||Qi.MODEL.tipMsg(this.tipsIdx)||""},i.onRefresh=function(e){pt.window.location.reload()},i.resize=function(){this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},i.setLoading=function(e,t,i,n){var s=this;void 0===n&&(n="");var o=s.mc_loading.width*t;s.mc_Mask.x=-s.mc_loading.width+o;var a=s.mc_loading.x+s.mc_loading.width*t-20;a<33&&(a=33),s.mc_Point.x=a,null==i?s.green_pro.visible&&(s.green_pro.visible=!1):(s.green_pro.visible||(s.green_pro.visible=!0),s.per+=.04*Math.random(),1<s.per&&(s.per=0),.99<=t&&(s.per=1),o=s.g_bar.width*s.per,s.mc_Mask_g.x=-s.g_bar.width+o,(a=s.g_bar.x+o-20)<33&&(a=33),s.mc_Point_g.x=a,s.txt_LoadingTF.text=e),n||(n=""),s.txt_yellowLoader.text=n},i.onTimer=function(){this.g_circle.rotation+=12},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.big_bg&&t.big_bg.skin&&G.loader.clearRes(t.big_bg.skin),t.parent&&t.parent.removeChild(t),dr.loadingView&&(t.removeChild(dr.loadingView),dr.loadingView.destroyed||dr.loadingView.destroy(),dr.loadingView=null),t.clearTimer(t,t.showTips),G.loader.clearRes(_r.getJxrDBPath("LoadingCoolTime")),G.loader.clearRes(_r.getJxrDBPath("LoadingMsg")),laya.ui.View.prototype.destroy.call(t,e)},t}(),VW=function(e){function t(){t.__super.call(this)}b(t,"modules.login.views.LoginBaseView",Sc,"LoginBaseView$1");var i=t.prototype;return i.show=function(){var e=this,t=HP.getCookie("arthor");t&&(hr.uid=t),null==hr.uid&&(hr.uid="char_"+(new Date).getMilliseconds()),e.txt_Arthor.text=hr.uid,e.txt_ServerId.text=hr.serverID,e.txt_Platform.text=hr.platform,e.resize(),G.stage.addChild(e),e.btn_Login.on("click",e,e.onLogin);var i=new Yp;i.color="#ffffff",i.y=e.btn_Login.y+45,i.x=e.lable1.x,i.text=dr.version,e.addChild(i),e.centerX=0},i.destroy=function(e){void 0===e&&(e=!0),this.parent&&this.parent.removeChild(this),this.btn_Login.off("click",this,this.onLogin),laya.ui.View.prototype.destroy.call(this,e)},i.onLogin=function(){hr.uid=this.txt_Arthor.text,hr.serverID=this.txt_ServerId.text,hr.platform=this.txt_Platform.text;var e={arthor:hr.uid};HP.setCookie(e),dr.isConchApp||Tu.sendToModule("SHOWLOGINUI",["modules.login.LoginModule"]),this.destroy()},i.resize=function(){this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},t}(),GW=function(e){function t(){var e=this;e.showPanelTime=NaN,e._mask=null,e._tf=null,t.__super.call(e),e._mask||(e._mask=new Ss,e._mask.alpha=.8,e._mask.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000",null),e._mask.mouseEnabled=!0),e._mask.pos((e.width-G.stage.width)/2,(e.height-G.stage.height)/2),e.addChildAt(e._mask,0),e.panel_div.vScrollBarSkin="",e.panel_div.vScrollBar.isVertical=!0,e.panel_div.vScrollBar.elasticDistance=200,e._tf||(e._tf=new Xl,e._tf.pos(0,0),e._tf.fontSize=24,e._tf.color="#90877b",e._tf.font="SimHei",e._tf.leading=11,e._tf.width=e.panel_div.width,e._tf.height=730,e.panel_div.addChild(e._tf))}b(t,"modules.login.views.LoginConcealView",kc,"LoginConcealView$1");var i=t.prototype;return i.show=function(e){G.stage.addChild(this),this.showPanelTime=pt.now(),this._tf.innerHTML=e,this._$7_onEvent()},i._$7_onEvent=function(){this.btn_close.once("click",this,this.onClose),G.stage.on("click",this,this.closePanel)},i.onClose=function(e){this.close()},i.close=function(){this.btn_close.off("click",this,this.onClose),G.stage.off("click",this,this.closePanel),this.parent&&this.parent.removeChild(this)},i.closePanel=function(e){e.target!=this.panel_div&&e.target!=this._tf&&e.target!=this&&150<pt.now()-this.showPanelTime&&this.onClose(e)},p(1,t,"ins",function(){return t._instance||(t._instance=new t),t._instance},layouts.login.LoginConcealUI._$SET_ins),t._instance=null,t}(),UW=function(e){function t(){var e=this;e._mask=null,e._tf=null,t.__super.call(e),e._mask||(e._mask=new Ss,e._mask.alpha=.8,e._mask.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000",null),e._mask.mouseEnabled=!0,e._mask.mouseThrough=!0),e._mask.pos((e.width-G.stage.width)/2,(e.height-G.stage.height)/2),e._mask.width=G.stage.width,e._mask.height=G.stage.height,e.addChildAt(e._mask,0),e.panel_div.vScrollBarSkin="",e.panel_div.vScrollBar.isVertical=!0,e.panel_div.vScrollBar.elasticDistance=200,e._tf||(e._tf=new Xl,e._tf.pos(0,0),e._tf.fontSize=24,e._tf.color="#90877b",e._tf.font="SimHei",e._tf.leading=11,e._tf.width=e.panel_div.width,e.panel_div.addChild(e._tf))}b(t,"modules.login.views.LoginNoticeView",Ec,"LoginNoticeView$1");var i=t.prototype;return i.show=function(){G.stage.addChild(this),this._tf.innerHTML=hr.logMsg.content,G.stage.on("click",this,this.stageClickEvent)},i.stageClickEvent=function(e){(e.target==this.btn_close||e.target instanceof modules.login.views.LoginStartView)&&(G.stage.off("click",this,this.stageClickEvent),this.removeSelf())},i.destroy=function(e){void 0===e&&(e=!0),this._mask=null,laya.ui.View.prototype.destroy.call(this,e)},p(1,t,"ins",function(){return t._instance||(t._instance=new t),t._instance},layouts.login.LoginNoticeUI._$SET_ins),t._instance=null,t}(),FW=function(e){function t(){var e=this;if(e.listChangeView=null,e.isConcelTxt=!1,e.isAutoShow=!1,e.txt_Ys="",t.__super.call(e),v_.isConchApp)e.bg.skin=_r.checkTranferSkin(ff.LOADING_BG,"ui/layouts/login/dl_jm_bg1.jpg"),e.serverBg.skin=_r.checkTranferSkin(ff.LOADING_XQD,"ui/layouts/login/dl_jm_xqd1.png");else{e.bg.skin=_r.checkTranferSkin(ff.LOADING_BG,"ui/layouts/login/dl_jm_bg1.jpg?1",!1),e.serverBg.skin=_r.checkTranferSkin(ff.LOADING_XQD,"ui/layouts/login/dl_jm_xqd1.png?1",!0)}HP.loadConfig(["Conceal"],["CConCeal"],ql.create(e,e.loadedConCel))}b(t,"modules.login.views.LoginStartView",Tc,"LoginStartView$1");var i=t.prototype;return i.show=function(){var e=this;e.txt_ChangeServer.on("click",e,e.onChangeServer),e.btn_Start.on("click",e,e.onEnterGame),e.txtYs.on("click",e,e.onShowYs),e.resize(),G.stage.addChild(e),G.timer.loop(83,e,e.onPlayEffect),e.btn_Gonggao.on("click",e,e.showGongGao),e.update();var t={};t.platCode=hr.platform,t.pid=hr.pid,t.gid=hr.gid,Jl.httpGet(hr.pNoteUrl,t,e,e.onGetNoticeHandler,e.onGetNoticeError)},i.checkImportTimeOut=function(e){HP.checkBasicLoaded()?this.showAlertOutServer(e):HP.loadBasicUI(ql.create(this,this.showAlertOutServer,[e]))},i.showAlertOutServer=function(e){KQ.ins.show(e,ql.create(this,null),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1)},i.onGetNoticeHandler=function(t){if("string"==typeof t)try{t=JSON.parse(t),hr.logMsg=t}catch(e){hr.logMsg={},hr.logMsg.isPrompt="1",hr.logMsg.title=RP.n[368],hr.logMsg.content=t,t=null}hr.logMsg&&hr.logMsg.hasOwnProperty("isPrompt")&&hr.logMsg.isPrompt+""=="1"&&UW.ins.show()},i.closeList=function(){null!=this.listChangeView&&this.listChangeView.parent&&(this.listChangeView.close(),this.update())},i.onGetNoticeError=function(e){console.log("NoticeError")},i.showGongGao=function(e){if(hr.logMsg)hr.logMsg.hasOwnProperty("title")?UW.ins.show():this.checkImportTimeOut(RP.n[369]);else{var t={};t.platCode=hr.platform,t.pid=hr.pid,t.gid=hr.gid,Jl.httpGet(hr.pNoteUrl,t,this,this.onGetNoticeHandler2,this.onGetNoticeError2)}},i.onGetNoticeHandler2=function(t){if("string"==typeof t)try{t=JSON.parse(t),hr.logMsg=t}catch(e){t=null,hr.logMsg={},hr.logMsg.isPrompt="1",hr.logMsg.title=RP.n[368],hr.logMsg.content=t}hr.logMsg&&(hr.logMsg.hasOwnProperty("title")?UW.ins.show():this.checkImportTimeOut(RP.n[371]))},i.onGetNoticeError2=function(e){},i.update=function(){this.txt_ServerName.text=hr.serverName;var e=4==hr.serverState;this.btn_Start.gray=e,this.mc_Effect.visible=!e},i.onPlayEffect=function(){0<this.mc_Effect.index?this.mc_Effect.index--:this.mc_Effect.index=this.mc_Effect.total-1},i.resize=function(){this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},i.showAlert=function(e){HP.checkBasicLoaded()?this.doShowAlert(e):HP.loadBasicUI(ql.create(this,this.doShowAlert,[e]))},i.doShowAlert=function(e){KQ.ins.show(e,ql.create(this,null),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1)},i.onEnterGame=function(e){if(5==hr.serverState){if(pt.now()<hr.openSerTime){var t=Go.dateFormat(Go.getDateByServer(hr.openSerTime),RP.n[372]);return void this.showAlert(t+RP.n[373])}}else{if(4==hr.serverState)return void this.showAlert(RP.n[374]);if(3<hr.serverState)return void this.showAlert(RP.n[374])}dr.isConchApp?(Tu.sendToModule("STARTLODING",["modules.login.LoginModule"]),hr.socket_host&&SF.GetIntance().connect(hr.socket_host,hr.socket_port)):20==hr.client?hr.socket_host&&(Tu.sendToModule("STARTLODING",["modules.login.LoginModule"]),SF.GetIntance().connect(hr.socket_host,hr.socket_port)):Tu.sendToModule("REQUESTENTER",["modules.login.LoginModule"]),hr.socket_host&&jP.sdk_cmd("report_server"),G.timer.clear(this,this.onPlayEffect)},i.onChangeServer=function(e){null==this.listChangeView&&(this.listChangeView=new jW),this.listChangeView.show(this)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.txt_ChangeServer.off("click",t,t.onChangeServer),t.btn_Start.off("click",t,t.onEnterGame),t.txtYs.off("click",t,t.onShowYs),G.timer.clear(t,t.onPlayEffect),t.listChangeView&&t.listChangeView.destroy(),t.mc_Effect&&t.mc_Effect.skin&&G.loader.clearRes(t.mc_Effect.skin),t.bg&&t.bg.skin&&G.loader.clearRes(t.bg.skin),t.serverBg&&t.serverBg.skin&&G.loader.clearRes(t.serverBg.skin),t.parent&&t.parent.removeChild(t),laya.ui.View.prototype.destroy.call(t,e)},i.onShowYs=function(e){GW.ins.show(this.txt_Ys)},i.loadedConCel=function(){var e=this,t=0;for(t=0;t<Ft.count;t++)if(-1!=Ft.MODEL.platform(t).split(",").indexOf(hr.appid)){e.isConcelTxt=!0,e.txt_Ys=Ft.MODEL.content(t),e.txtYs.text=Ft.MODEL.title(t),e.txtYs.underline=!0,1==Ft.MODEL.isAuto(t)&&(e.isAutoShow=!0);break}e.isConcelTxt?(e.txtYs.visible=!0,e.isAutoShow&&GW.ins.show(e.txt_Ys)):e.txtYs.visible=!1},t}(),qW=function(e){function t(){this._state=0,t.__super.call(this),this.on("click",this,this.onSelectHandler)}b(t,"modules.login.views.LoginServerItem",e,"LoginServerItem$1");var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onSelectHandler)},i.onSelectHandler=function(e){var t=this;if(t.dataSource){if(t.dataSource.hasOwnProperty("state")){if(5==t._state){var i=Go.dateFormat(Go.getDateByServer(t.dataSource.autoOpenTime),RP.n[376]);return void t.showAlert("["+i+RP.n[377])}if(4==t._state)return void t.showAlert(RP.n[378])}t.dataSource.hasOwnProperty("domain")&&(hr.socket_host=t.dataSource.domain),t.dataSource.hasOwnProperty("port")&&(hr.socket_port=t.dataSource.port),t.dataSource.hasOwnProperty("serverId")&&(hr.serverID=t.dataSource.serverId),t.dataSource.hasOwnProperty("state")&&(hr.serverState=parseInt(t.dataSource.state+"")),t.dataSource.hasOwnProperty("name")&&(hr.serverName=t.dataSource.name),Tu.sendToModule("CLOSESERVERLIST",["modules.login.LoginModule"])}},i.showAlert=function(e){HP.checkBasicLoaded()?this.doShowAlert(e):HP.loadBasicUI(ql.create(this,this.doShowAlert,[e]))},i.doShowAlert=function(e){KQ.ins.show(e,ql.create(this,null),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1)},p(0,i,"name",null,function(e){this.txt_Name&&(this.txt_Name.text=e)}),p(0,i,"state",null,function(e){this._state=e,this.mc_will.visible=this.mc_stop.visible=this.mc_busy.visible=this.mc_new.visible=!1,1==e?this.mc_new.visible=!0:2==e||3==e?this.mc_busy.visible=!0:4==e?this.mc_stop.visible=!0:5==e&&(this.mc_will.visible=!0)}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){G.superSet($_,this,"dataSource",e)}),t}($_),jW=function(e){function t(){var e=this;e.listData=null,e.sectionList=null,e.isRequest=!1,e.m_Context=null,e._mask=null,t.__super.call(e),e._mask||(e._mask=new Ss,e._mask.alpha=.8,e._mask.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000",null),e._mask.mouseEnabled=!0,e._mask.mouseThrough=!0),e._mask.pos((e.width-G.stage.width)/2,(e.height-G.stage.height)/2),e.addChildAt(e._mask,0)}b(t,"modules.login.views.LoginServerView",K_,"LoginServerView$1");var i=t.prototype;return i.show=function(e){var t=this;if(t.m_Context=e,t.sectionList)t.doShow();else{G.timer.clear(t,t.checkImportTimeOut),t.isRequest=!0;var i=new Object;i.uid=hr.uid,i.pid=hr.pid,i.gid=hr.gid,i.version=hr.appVersion,pt.onAndroid?i.os="andriod":pt.onIOS?i.os="ios":pt.onPC&&(i.os="window"),i.platCode=hr.platform,i.time=hr.serverTime,i.imei=hr.IMEI,i.sign=hr.sign,Jl.httpGet(hr.getServerListUrl,i,t,t.onGetListHandler,t.onErrorHandler),G.timer.once(1e4,t,t.checkImportTimeOut)}},i.checkImportTimeOut=function(){this.isRequest=!1,HP.checkBasicLoaded()?this.showAlertOutServer():HP.loadBasicUI(ql.create(this,this.showAlertOutServer,[]))},i.showAlertOutServer=function(){KQ.ins.show(RP.n[379],ql.create(this,null),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1)},i.onGetListHandler=function(e){var t=this;if(G.timer.clear(t,t.checkImportTimeOut),"string"==typeof e&&(e=JSON.parse(e)),t.isRequest=!1,t.listData=e,t.listData){t.sectionList=[];var i={label:"最近登陆",servers:[]},n={label:"推荐服务器",servers:[]};if(t.listData.hasOwnProperty("servers")){t.sectionList.push(i);for(var s=0;s<t.listData.servers.length;++s){var o=t.listData.servers[s];t.listData.loginedServers&&-1!=t.listData.loginedServers.indexOf(o.serverId)&&i.servers.push(o),t.listData.recommendServers&&-1!=t.listData.recommendServers.indexOf(o.serverId)&&n.servers.push(o);for(var a,r=!1,l=0;l<t.sectionList.length;++l){var c=o.groupNo;if((a=t.sectionList[l]).label==c){a.servers.push(o),r=!0;break}}r||(a={label:o.groupNo,servers:[o]},t.sectionList.push(a))}t.doShow()}else t.showAlert(RP.n[380])}else t.showAlert(RP.n[381])},i.onErrorHandler=function(e){G.timer.clear(this,this.checkImportTimeOut),this.checkImportTimeOut(),this.isRequest=!1},i.doShow=function(){var e=this;10!=hr.client&&e.sectionList&&(e.list_Servers.repeatX=1,e.list_Servers.spaceY=8,e.list_Servers.vScrollBarSkin="",e.list_Servers.itemRender=qW,e.list_Servers.scrollBar.elasticDistance=60,e.list_Servers.scrollBar.on("change",e,e.onScrollEnd2),e.list_Servers.selectEnable=!0,e.list_Servers.selectHandler=ql.create(e,e.onSelecetHandler2,null,!1),e.list_ServerList.repeatY=e.sectionList.length,e.list_ServerList.repeatX=1,e.list_ServerList.spaceY=1,e.list_ServerList.vScrollBarSkin="",e.list_ServerList.scrollBar.elasticDistance=60,e.list_ServerList.scrollBar.on("change",e,e.onScrollEnd),e.list_ServerList.dataSource=e.sectionList,e.list_ServerList.selectEnable=!0,e.list_ServerList.selectHandler=ql.create(e,e.onSelecetHandler,null,!1),0<e.sectionList.length&&(e.list_ServerList.tweenTo(0),e.list_ServerList.selectedIndex=0),e._mask.once("click",e,e.onClose),e.btn_Close.once("click",e,e.onClose),e.m_Context.addChild(e))},i.onClose=function(e){this.close()},i.onSelecetHandler=function(e){var t=this.list_ServerList.array[e];t.selected=!0,t.labelSize=30;for(var i=0;i<this.list_ServerList.array.length;i++){var n=this.list_ServerList.array[i];i!=e&&n.selected?(n.selected=!1,t.labelSize=24,this.list_ServerList.changeItem(i,n)):i==e&&this.list_ServerList.changeItem(i,n)}this.list_Servers.dataSource=t.servers},i.onScrollEnd=function(){0==this.list_ServerList.scrollBar.max||this.list_ServerList.scrollBar.value>=this.list_ServerList.scrollBar.max?this.mc_ListMask.visible=!1:this.mc_ListMask.visible=!0},i.onScrollEnd2=function(){0==this.list_Servers.scrollBar.max||this.list_Servers.scrollBar.value>=this.list_Servers.scrollBar.max?this.mc_Mask.visible=!1:this.mc_Mask.visible=!0},i.onSelecetHandler2=function(e){},i.showAlert=function(e){HP.checkBasicLoaded()?this.doShowAlert(e):HP.loadBasicUI(ql.create(this,this.doShowAlert,[e]))},i.doShowAlert=function(e){KQ.ins.show(e,ql.create(this,null),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1)},i.close=function(){this._mask.off("click",this,this.onClose),this.btn_Close.off("click",this,this.onClose),this.parent&&this.parent.removeChild(this)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._mask.off("click",t,t.onClose),t.btn_Close.off("click",t,t.onClose),t.parent&&t.parent.removeChild(t),t.m_Context=null,(t.listData=null)!=t.sectionList&&(t.sectionList.length=0,t.sectionList=null),laya.ui.View.prototype.destroy.call(t,e)},t}(),WW=function(e){function t(){this.lines=null,t.__super.call(this),this.inte()}b(t,"modules.login.views.ServiceListPanel",ef);var i=t.prototype;return i.inte=function(){var e=this;e.lines=[{name:"开发服",ip:"10.11.3.112",port:"5301",serverId:"1"},{name:"马少",ip:"10.11.63.119",port:"5001",serverId:"1"},{name:RP.n[382],ip:RP.n[383],port:"5001",serverId:"1"},{name:"夏子宁",ip:"10.11.63.126",port:"5001",serverId:"1"}],e.list_Service.repeatY=14,e.list_Service.repeatX=1,e.list_Service.dataSource=e.lines;for(var t=e.list_Service.centerX=0;t<e.list_Service.dataSource.length;++t){var i=e.list_Service.getItem(t);i&&(i.label=e.lines[t].name+"("+e.lines[t].ip+":"+e.lines[t].port+")"+e.lines[t].serverId)}e.btn_Connect.on("click",e,e.onConnect)},i.onConnect=function(e){hr.socket_host=this.txt_IP.text,hr.socket_port=parseInt(this.txt_Port.text),hr.serverID=this.txt_ServerId.text,"0"==hr.socket_host?jB.getIntance().setup():SF.GetIntance().connect(hr.socket_host,hr.socket_port),this.destroy()},i.show=function(){this.resize(),G.stage.addChild(this),this.list_Service.mouseThrough=!0,this.list_Service.on("click",this,this.onSelectService),this.on("click",this,this.check)},i.check=function(e){e.target},i.resize=function(){},i.onSelectService=function(e){var t=e.target;if(t instanceof laya.ui.Button){var i=t.dataSource;hr.socket_host=i.ip,hr.socket_port=i.port,hr.serverID=i.serverId,"0"==hr.socket_host?jB.getIntance().setup():SF.GetIntance().connect(hr.socket_host,hr.socket_port),this.destroy()}},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.btn_Connect.off("click",t,t.onConnect),t.list_Service.off("mousedown",t,t.onSelectService),t.parent&&t.parent.removeChild(t),t.lines.length=0,t.lines=null,laya.ui.View.prototype.destroy.call(t,t.destroyed)},t.getIntance=function(){return null==modules.login.views.ServiceListPanel._intance_&&(modules.login.views.ServiceListPanel._intance_=new t),modules.login.views.ServiceListPanel._intance_},t._intance_=null,t}(),YW=function(e){function t(){var e=this;e.unSelectArr=null,e.selecetChar=null,e.sex=1,e.carrId=1,e._recordIndexs=null,e._showList=null,e._showLen=5,e._namesMaxLen=100,e._initedName=!1,e.randTime=0,e.drawTime=0,e._enterTime=0,e.enterSec=25,t.__super.call(e),e.g_bg.skin=_r.getLayoutsImagePath("createrole1/cj_bg.jpg?201904021508",!1),e._recordIndexs=[],e._showList=[],e.invented_box.scrollRect=new u_(0,30,300,120)}b(t,"modules.login.views._RoleCreateView",By,"_RoleCreateView$1");var i=t.prototype;return i._$7_onEvent=function(){var e=this;e.on("click",e,e.onClick),e.txt_Name.on("input",e,e.onInputChange),e.txt_Name.on("focus",e,e.onFocusChange),e.txt_Name.on("blur",e,e.onFocusChange),G.timer.loop(33,e,e.onLoop)},i.offEvent=function(){var e=this;e.off("click",e,e.onClick),e.txt_Name.off("input",e,e.onInputChange),e.txt_Name.off("focus",e,e.onFocusChange),e.txt_Name.off("blur",e,e.onFocusChange),G.timer.clear(e,e.onLoop)},i.show=function(){var e=this;e.resize(),e.unSelectArr=[];for(var t=0;t<6;++t){var i=new pp;i.graphics.drawRect(0,0,114,578,"#000000"),i.alpha=.5,e.unSelectArr.push(i)}e.update(),G.stage.addChild(e),G.timer.loop(83,e,e.onPlayEffect),e._$7_onEvent(),e.onGetRadomName(),e.mc_Effect.skin=_r.getLayoutsImagePath("login/btn_effect.png?201904021508",!1),e.mc_Effect.blendMode="lighter",HP.loadConfig(["inventedName"],["CInventedName"],ql.create(e,e.loadedNames))},i.loadedNames=function(){0<qi.count&&(this._namesMaxLen=qi.count,this._initedName=!0)},i.onPlayEffect=function(){this.mc_Effect.index<this.mc_Effect.total-1?this.mc_Effect.index++:this.mc_Effect.index=0},i.update=function(){var e,t=this,i=null;for(e in t.unSelectArr)(i=t.unSelectArr[e]).parent&&i.parent.removeChild(i);t.btn_sex_1.selected=Boolean(1==t.sex),t.btn_sex_2.selected=Boolean(2==t.sex),t.img_role.skin=_r.getLayoutsImagePath("createrole1/cj_js_"+t.carrId+"_"+t.sex+".png",!1);for(var n=1;n<=3;n++)t.carrId==n?(t["btn_job_"+n].skin=_r.getLayoutsImagePath("createrole1/cj_zydk_"+n+".png",!1),t["btn_wp_"+n].right=67,t["btn_wp_"+n].selected=!0):(t["btn_job_"+n].skin=_r.getLayoutsImagePath("createrole1/cj_zydk_ct.png",!1),t["btn_wp_"+n].selected=!1,t["btn_wp_"+n].right=51),t.setLabColor(n,t.carrId==n)},i.setLabColor=function(e,t){var i;switch(e){case 1:i=t?"#ff450c":"#bc5c3f";break;case 2:i=t?"#288bca":"#405e90";break;case 2:i=t?"#1bb32d":"#33761f"}this["btn_job_"+e].labelSize=t?28:24,this["btn_job_"+e].labelColors=i,this["btn_job_"+e].labelPadding=t?"45,15,46,66":"46,6,47,65"},i.onLoop=function(){var e=this,t=pt.now();900<t-e.randTime&&(e.randTime=t,e.inventedNamse()),30<t-e.drawTime&&(e.drawTime=t,e.drawInventedNames(e.invented_box.graphics)),e.enterTime<=0?e.enterTime=t:e.txt_Name&&0==e.txt_Name.focus&&e.enterSec<=0?e.onEntername(null):e.txt_Name&&0==e.txt_Name.focus&&(1e3<t-e._enterTime&&(e._enterTime=t,e.enterSec=e.enterSec-1),e.txt_tipenter.text=e.enterSec+RP.n[384])},i.inventedNamse=function(){if(0!=this._initedName)for(var e=this.randomEnterIndexs(),t=0;t<e.length;t++){var i=e[t];if(this._showList.indexOf(i)<0){this._recordIndexs.push(i);var n=qi.MODEL.name(i);n&&this._showList.push([n,-25*(e.length-t)])}}},i.drawInventedNames=function(e){var t=this;e.clear();for(var i=0,n=0;n<t._showList.length;n++){var s=t._showList[n][0]+"",o=t._showList[n][1];if(o<120||0<=o){if(i=150-o,0<s.length){var a=0;t.invented_box.graphics.fillText("玩家",a,i,"20px SimHei","#ffffff","left"),a+=45,t.invented_box.graphics.fillText(s,a,i,"20px SimHei","#00bbff","left"),a+=20*s.length+5,t.invented_box.graphics.fillText(RP.n[385],a,i,RP.n[386],"#ffffff","left")}t._showList[n]=0==n?[s,o+1]:[s,t._showList[n-1][1]-25]}}for(var r in t._showList){145<t._showList[r][1]&&t._showList.splice(parseInt(r),1)}},i.randomEnterIndexs=function(){var e=[];this._recordIndexs.length>=this._namesMaxLen&&(this._recordIndexs=this._recordIndexs.splice(this._namesMaxLen-10,this._namesMaxLen));for(var t=0;t<20&&!(1<=e.length);t++){var i=Math.floor(this._namesMaxLen*Math.random());this._recordIndexs.indexOf(i)<0&&e.push(i)}return e},i.onFocusChange=function(){if(pt.onMobile&&(this.txt_Name.focus?this.bottom=104:this.bottom=0),!this.txt_Name.focus){var e=this.txt_Name.text;if(12<mp.getStringLength(e))for(var t=0,i=0;i<e.length;++i)if(12<=(t+=mp.getStringLength(e.charAt(i))))return void(this.txt_Name.text=12==t?e.substring(0,i+1):e.substring(0,i))}},i.onInputChange=function(e){},i.onClick=function(e){var t=this;if(e.target!=t.selecetChar){switch(e.target){case t.btn_GetName:t.onGetRadomName(null),t.enterTime=pt.now();break;case t.btn_Login:t.enterTime=pt.now(),t.onEntername(null);break;case t.btn_sex_1:t.enterTime=pt.now(),t.sex=1;break;case t.btn_sex_2:t.enterTime=pt.now(),t.sex=2;break;case t.btn_job_1:t.enterTime=pt.now(),t.carrId=1;break;case t.btn_job_2:t.enterTime=pt.now(),t.carrId=2;break;case t.btn_job_3:t.enterTime=pt.now(),t.carrId=3}t.update()}},i.onGetRadomName=function(e){this.enterTime=pt.now();var t=new cL;t.sex=1,Tu.sendToService(t)},i.onEntername=function(e){this.enterTime=pt.now();var t=new uL;t.sex=this.sex,t.carrerId=this.carrId,t.charName=this.txt_Name.text,Tu.sendToService(t)},i.setName=function(e){this.txt_Name.text=e},i.resize=function(){this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},i.destroy=function(e){var t,i=this;for(var n in void 0===e&&(e=!0),G.timer.clear(i,i.onPlayEffect),i.parent&&i.parent.removeChild(i),i.unSelectArr)(t=i.unSelectArr[n]).parent&&t.parent.removeChild(t),t.destroy(),t=null;i.unSelectArr.length=0,i.unSelectArr=null,i.offEvent(),i.selecetChar=null,G.timer.clearAll(i),i.g_bg&&i.g_bg.skin&&G.loader.clearRes(i.g_bg.skin),i.img_role&&i.img_role.skin&&G.loader.clearRes(i.g_bg.skin),i.btn_GetName&&i.btn_GetName.skin&&G.loader.clearRes(i.btn_GetName.skin),i.btn_Login&&i.btn_Login.skin&&G.loader.clearRes(i.btn_Login.skin),i.mc_Effect&&i.mc_Effect.skin&&G.loader.clearRes(i.mc_Effect.skin);var s=_r.getLayoutsPath("createrole1");if(G.loader.clearRes(s),-1<s.indexOf(".atlas")){var o=s.replace(".atlas",".png"),a=yc.getRes(o);a&&(a.destroy(),G.loader.clearRes(o))}if(RU.urls&&0<RU.urls.length){for(var r=0;r<RU.urls.length;r++)RU.urls[r]&&""!=RU.urls[r]&&G.loader.clearRes(RU.urls[r]);RU.urls.splice(0,RU.urls.length)}i.parent&&i.parent.removeChild(i),laya.ui.View.prototype.destroy.call(i,e)},p(0,i,"enterTime",null,function(e){this._enterTime=e,this.enterSec=25}),t}(),zW=function(e){var h;function t(e){this._defaultWidth=0,this._achieves=[],void 0===e&&(e=474),t.__super.call(this),this.width=this._defaultWidth,this.titlebg.x=0,this.titlebg.width=this.width,this._defaultWidth=e}return b(t,"modules.mall.views.item.MallAchieve",hu),t.prototype.update=function(e){for(var t,i=Bi.getIndex(e),n=Bi.MODEL.achieving(i).split(";"),s=0,o=0;o<n.length;o++){var a=n[o].split("|");if(5==parseInt(a[0])){var r=a[4].split(","),l=parseInt(r[0]),c=parseInt(r[1]),u=dr.getOpenServiceDay(),d=parseInt(a[5]);if(u<l||c<u)continue;if("FIRST_RECHARGE"==a[1]){if(HN.ins.toc_recharge)if(2==HN.ins.toc_recharge.canGet)continue}else if(-1<JP.A_GIFT_ID_ARR.indexOf(d)&&null!=JP.A_GIFT_ID_HASH.take(d)&&2==JP.A_GIFT_ID_HASH.take(d).status)continue}s<this._achieves.length?t=this._achieves[s]:((t=new h).width=this._defaultWidth,this._achieves.push(t)),t.update(n[o],1==e||15==e),t.pos(2,64+80*s),this.addChild(t),s++}for(this.height=64+80*s-10,o=s;o<this._achieves.length;o++)this._achieves[o].removeSelf()},t.__init$=function(){h=function(e){function t(){this._data=null,this._effect=null,t.__super.call(this),this.on("click",this,this.onClick),this.on("undisplay",this,this.onUndisplay)}b(t,"",du);var i=t.prototype;return i.onUndisplay=function(){null!=this._effect&&this._effect.destroy(),this._effect=null},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),null!=this._effect&&this._effect.destroy(),this._effect=null},i.update=function(e,t){var i=this;void 0===t&&(t=!1),i._data=e,i.img_tuijian.visible=!1,i.img_tuijian2.visible=!1,i.redPoint.visible=!1,null!=i._effect&&i._effect.destroy();var n=e.split("|");if(i.txt_name.changeText(n[n.length-1]),4==parseInt(n[0]))i.mc_go.visible=!1,i.txt_go.visible=!1,i.off("click",i,i.onClick);else{if(t)if(2==parseInt(n[0])&&"RECYCLE"==n[1])9<=TR.ins.getRecycleEquips(la.NORMAL).length&&(i.img_tuijian.visible=!0,i.redPoint.visible=!0);5!=parseInt(n[0])&&8!=parseInt(n[0])||(null==i._effect&&(i._effect=kB.createEffect("jm1382",i.width/2,i.height/2,i),474==i.width?i._effect.scale_X=1:i._effect.scale_X=1.05,i._effect.scale_Y=1),i.img_tuijian.visible=!0,i.addChild(i.img_tuijian2)),i.mc_go.visible=!0,i.txt_go.visible=!0,i.hasListener("click")||i.on("click",i,i.onClick)}},i.onClick=function(e){if(this._data){var t,i=this._data.split("|"),n=0,s=!1,o=parseInt(i[0]),a=6==o;if(1==o)hN.ins._closeLayout();else if(a){var r=parseInt(i[3]);if(!GR.getInstance().checkModuleOpen(r))return void zB.ins.showMsg(GR.getInstance().getErrorTips(r),1)}var l=parseInt(i[3]);if(!a&&gR.ins.lv<l)return void zB.ins.showMsg(RP.n[68],1);if("COPYMAINVIEW"==i[1]){if(!qR.ins.isOpenCopy)return void zB.ins.showMsg(RP.n[69],1)}else if("GUILD_MALL_MAINVIEW"==i[1]){if(!vN.ins.joinGuild)return void zB.ins.showMsg(RP.n[70],1);hN.ins.open("GUILD_MNG_MAINVIEW")}else if("GUILD_BOSS_MAINVIEW"==i[1]){if(!vN.ins.joinGuild)return void zB.ins.showMsg(RP.n[70],1);hN.ins.open("GUILD_BOSS_MAINVIEW",{_subIndex_:1},null,!0)}else if("BOSS_MAINVIEW"==i[1]&&1==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[72],1);hN.ins.open("BOSS_MAINVIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&1==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[73],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&0==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[74],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&2==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[75],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("SPORTS_MAIN_VIEW"==i[1]&&3==parseInt(i[2])){if(n=parseInt($e.MODEL.value($e.getIndex(121))),s=!!(t=PH.Ins().info)&&n<=t.taskId,!a&&(!s||gR.ins.lv<parseInt(i[3])))return void zB.ins.showMsg(RP.n[76],1);hN.ins.open("SPORTS_MAIN_VIEW",{_subIndex_:parseInt(i[2])})}else if("MALL_PANEL"==i[1]&&0==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[77],1);hN.ins.open("MALL_PANEL",{_subIndex_:parseInt(i[2])})}else if("TREASURE_VIEW"==i[1]&&2==parseInt(i[2])){var c=$e.MODEL.value($e.getIndex(155)).split(",");if(dr.getOpenServiceDay()<c[0]||gR.ins.zsLv<c[1])return void zB.ins.showMsg(RP.n[78],1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(i[2])})}else if("TREASURE_VIEW"==i[1]&&0==parseInt(i[2])){if(!a&&gR.ins.lv<parseInt(i[3]))return void zB.ins.showMsg(RP.n[79],1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(i[2])})}else if("WELFARE"==i[1]&&1==parseInt(i[2])){if(!$N.ins.isOpen())return void zB.ins.showMsg(RP.n[80],1)}else if("SOARING_VIEW"==i[1]){var u=$e.MODEL.value($e.getIndex(207)),d=JSON.parse(u);if(d.level>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[81]+d.level+"级开启");if(d.flyLevel>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[82]+d.flyLevel+"级开启")}else if("ACHIEVE_NEW_MAIN_VIEW"==i[1]){if(!LN.isOpenAchieve)return void zB.ins.showById(4212,1)}else if("NewDailyActMainView"==i[1]);else if("OS_Purchase"==i[1]){if(!CN.getAIconOpen(47))return void zB.ins.playErrorMsg(RP.n[83]);JP.openIndex=parseInt(i[2]),CN.dealActIcon(CN.getIconBtn(47))}if(5==parseInt(i[0])){var h=i[4].split(","),_=parseInt(h[0]),f=parseInt(h[1]),p=dr.getOpenServiceDay();if(p<_||f<p)return void zB.ins.showMsg(RP.n[84]+_+"且<="+f+"开启",1);i[0]="2"}if("OS_TEHUI"==i[1])return 6<i.length&&(eU.targetId=parseInt(i[5])),eU.toSelectIndex=parseInt(i[2]),CN.dealActIcon(CN.getIconBtn(46)),void this.setClose();if("OPENSERVER"==i[1])return eU.toSelectIndex=parseInt(i[2]),CN.dealActIcon(CN.getIconBtn(12)),void this.setClose();if("VIPGIFT_VIEW"==i[1])Wg.openIndex=parseInt(i[2]);else if("FIRST_RECHARGE"==i[1]){if(null==HN.ins.toc_recharge)return void this.setClose();2==HN.ins.toc_recharge.canGet?hN.ins.open("EVERY_RECHARGE"):hN.ins.open("FIRST_RECHARGE")}}this.setClose();var g=i.join("|");a&&(g=g.replace(/[0-9]?|/,"2")),Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],g)},i.onGetActivityList=function(e,t){var i=Et.MODEL.UIId(t);i&&hN.ins.toggle(i,e)},i.setClose=function(){hN.ins.isOpen("MALL_QBPanel")&&hN.ins.close("MALL_QBPanel"),hN.ins.isOpen("MALL_NORMALBUYPANEL")&&hN.ins.close("MALL_NORMALBUYPANEL"),pW.instance.parent&&pW.instance.close(),HQ.instance.parent&&HQ.instance.close(),KX.instance.parent&&KX.instance.close(),YX.instance.parent&&YX.instance.close(),Zj.instance.parent&&Zj.instance.close(),modules.strength.views.fazhen.FazhenSkillAlert.ins.parent&&modules.strength.views.fazhen.FazhenSkillAlert.ins.close()},t}()},t}(),XW=function(t){function e(){this._grid=null,this._dtoGoods=null,this._dtoMallVo=null,this._keyIndex=0,this._buySign=null,this._mask=null,this._effect=null,this.needEffect=!0,e.__super.call(this)}b(e,"modules.mall.views.item.MallItem",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF,e._grid.x=e.img_goods.x+(e.img_goods.width-e._grid.width>>1),e._grid.y=e.img_goods.y+(e.img_goods.height-e._grid.height>>1),e.addChildAt(e._grid,2)},i.initialize=function(){var e=this;e.hdv_des0.style.font="SimHei",e.hdv_des0.style.fontFamily="SimHei",e.hdv_des0.style.fontSize=20,e.hdv_des0.style.color="#23b11f",e.hdv_des0.style.align="left",e.hdv_des1.style.font="SimHei",e.hdv_des1.style.fontFamily="SimHei",e.hdv_des1.style.fontSize=20,e.hdv_des1.style.color="#a19980",e.hdv_des1.style.align="right",e.discount_bg.mouseEnabled=!1,e.clip_discount.mouseEnabled=!1,e.txt_price.mouseEnabled=!1,e.btn_buy.on("click",e,e.onClickHandler),e.clip_discount.visible=!1,e.discount_bg.visible=!1,e.arrow_up.visible=!1,e.addChildAt(e.discount_bg,e.getChildIndex(e._grid)+1),e.addChildAt(e.clip_discount,e.getChildIndex(e.discount_bg)+1),e.img_hasBuy.visible=!1},i.isMoneyEnough=function(){if(null==this._dtoMallVo)return!1;return 2==this._dtoMallVo.moneyType?!(this._dtoMallVo.price>gR.ins.YB):4==this._dtoMallVo.moneyType?!(this._dtoMallVo.price>gR.ins.ZJ):!(this._dtoMallVo.price>gR.ins.coin)},i.showEffect=function(){var e=this;if(e.clearEffect(),e._grid.bindData&&e.needEffect){var t=Ks.getIndex(e._dtoMallVo.shopIndex),i=Ks.MODEL.effectId(t);i&&-1!=i.indexOf("jm")&&(e._effect=kB.createEffect(i,e._grid.x+(e._grid.width>>1),e._grid.y+(e._grid.height>>1),e),e.clip_discount.visible&&e.addChildAt(e._effect,e.getChildIndex(e.discount_bg)-1),116!=e._grid.width&&(e._effect.scaleX=e._effect.scaleY=e._grid.width/116))}},i.clearEffect=function(){this._effect&&this._effect.dispose(),this._effect=null},i.adjustPos=function(){},i.onClickHandler=function(e){var t=this;if(t._dtoMallVo){if(!t.isMoneyEnough())return void(2==t._dtoMallVo.moneyType?KQ.ins.showNoGold():3==t._dtoMallVo.moneyType?zB.ins.showById(1003,1):4==t._dtoMallVo.moneyType&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:34}));t._dtoMallVo.tab==fu.MYSTERY?wN.reqMySteryBuy(t._dtoMallVo.serviceIndex,t._dtoMallVo.shopIndex):1==t._dtoMallVo.isBulkbuy?t.showMallBuyPanel(t._dtoMallVo):wN.reqBuyMallGood(t._dtoMallVo.shopIndex)}},i.showMallBuyPanel=function(e){QW.ins.bindData(e)},i.destroy=function(e){void 0===e&&(e=!0),this._grid.isClearUrl=!0,this._grid.clearIconTexture(),this.clearEffect(),laya.ui.View.prototype.destroy.call(this),this.btn_buy.off("click",this,this.onClickHandler)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(t._dtoMallVo=e,t.btn_buy.visible=!0,t._dtoMallVo){if(-1==Nn.getIndex(t._dtoMallVo.shopIndex))return;t._dtoMallVo.tab==fu.MYSTERY&&(t._dtoMallVo.hasBuy?(t.box1.visible=!1,t.img_hasBuy.visible=!0):(t.box1.visible=!0,t.img_hasBuy.visible=!1)),t._dtoGoods=yB.create(t._dtoMallVo.goodId),t._dtoGoods.disAchi=!1,t._dtoGoods.goodsNum=t._dtoMallVo.num,t._grid.bindData=t._dtoGoods;var i=Bi.getIndex(t._dtoMallVo.goodId),n=Bi.MODEL.roleTypeId(i);if(0<n){var s="";switch(n){case 1:s="bb_jb_zs";break;case 2:s="bb_jb_fs";break;case 3:s="bb_jb_ds"}t.img_role.skin=_r.getAtlasSubPath("basic_ui/"+s+".png")}else t.img_role.skin="";t.addChildAt(t.img_role,3);var o=Bi.getIndex(t._dtoMallVo.goodId);if(2==Bi.MODEL.type(o)){var a=tH.instance.getDiffFightValue(t._dtoMallVo.goodId);0<a?(t.arrow_up.visible=!0,t.hdv_des0.innerHTML=RP.n[318]+a):(t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980"))}else t.arrow_up.visible=!1,t.hdv_des0.innerHTML=Ql.createColor(t._dtoMallVo.extraDes,"#a19980");if(t.txt_name.text=t._dtoMallVo.mallGoodName,t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(i)),0<t._dtoMallVo.isDiscount?(t.discount_bg.index=0,t.clip_discount.index=Ks.MODEL.discount(Ks.getIndex(t._dtoMallVo.shopIndex))/10-1,t.discount_bg.visible=!0,t.clip_discount.visible=!0):(t.discount_bg.visible=!1,t.clip_discount.visible=!1),t._dtoMallVo.tab==fu.MYSTERY)t.hdv_des1.innerHTML="";else{var r=t._dtoMallVo.getLeftBuyTimes();if(null==r)t.hdv_des1.innerHTML="";else{var l=r.type,c=r.leftTime,u=r.staticTime;1==l?t.hdv_des1.innerHTML=0==c?RP.n[322]+Ql.createColor(c+"/"+u,"#ff0000"):RP.n[323]+Ql.createColor(c+"/"+u,"#23b11f"):2==l&&(t.hdv_des1.innerHTML=RP.n[324]+Ql.createColor(c+"/"+u,"#23b11f"))}}t.img_money.skin=fu.getMoneyImg(t._dtoMallVo.moneyType),t.txt_price.x=73,2==t._dtoMallVo.moneyType?(t.img_money.x=7,t.img_money.y=0):4==t._dtoMallVo.moneyType?(t.img_money.x=-5,t.img_money.y=-9):3==t._dtoMallVo.moneyType&&(t.img_money.x=-10,t.img_money.y=0,t.txt_price.x=45);var d=Math.floor(t._dtoMallVo.price);4==t._dtoMallVo.moneyType?t.txt_price.text=d+"":t.txt_price.text=9999<d?(.001*d>>0)/10+"万":d+"",t._dtoMallVo.tab==fu.MYSTERY&&t.showEffect(),t.adjustPos()}else t._grid.bindData=null}),e}(pu),QW=function(t){function e(){this._bindData=null,this._grid=null,this._quickBuyComponent=null,this._data=null,this._buyNum=0,e.__super.call(this)}b(e,"modules.mall.views.MallBuyPanel",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._quickBuyComponent=new kj,e._quickBuyComponent.centerX=0,e._quickBuyComponent.y=284,e.addChild(e._quickBuyComponent),e._grid=new MF,e._grid.x=e.item_bg.x,e._grid.y=e.item_bg.y,e.addChild(e._grid)},i.initialize=function(){this.btn_buy.clickHandler=ql.create(this,this.onBuyHandler,null,!1),this.btn_close.on("click",this,this.close),this._quickBuyComponent.on("num_change",this,this.changeHandler)},i.changeHandler=function(e){this._buyNum=e,this.txt_totalPrice.text=this._data.price*e+""},i.onBuyHandler=function(){var e=this,t=!0,i=e._buyNum*e._data.price;2==e._data.moneyType&&gR.ins.YB<i&&(t=!1),t?(wN.reqBuyMallGood(e._data.shopIndex,e._buyNum),e.parent&&(e.stage&&e.stage.off("resize",e,e.onResize),eq.panelLayer.close(e))):KQ.ins.showNoGold()},i.bindData=function(e){var t=this;if(null!=e){if(e instanceof protos.mall.Mall_MallItem_vo){var i;t._data=e;if(-1==Nn.getIndex(t._data.shopIndex))return;Bi.getIndex(t._data.goodId);i=yB.create(t._data.goodId),t._grid.bindData=i,t.good_name.text=t._data.mallGoodName,t.good_des.text=t._data.extraDes,t.img_money.skin=fu.getMoneyImg(t._data.moneyType),2==t._data.moneyType?(t.img_money.x=302,t.img_money.y=198):3==t._data.moneyType?(t.img_money.x=302,t.img_money.y=198):(t.img_money.x=346,t.img_money.y=209);var n=t._data.getLeftBuyTimes(),s=0;99==(s=null==n?99:n.leftTime)?(t.left_des.visible=!1,t.left_num.visible=!1):(t.left_des.visible=!0,t.left_num.visible=!0,t.left_num.text=s+""),0==s?t._quickBuyComponent.bindData(0,s,t._data.shopIndex):t._quickBuyComponent.bindData(1,s,t._data.shopIndex)}t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.open(t,!1,!0),t.stage&&t.stage.on("resize",t,t.onResize),t.onResize())}},i.onClick=function(e){e instanceof modules.mall.views.MallBuyPanel&&this.close(e)},i.close=function(e){eq.panelLayer.close(this)},i.onResize=function(){this.x=(G.stage.width-this.width)/2,this.y=(G.stage.height-this.height)/2-100},p(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins},layouts.mall.MallBuyPanelLayoutUI._$SET_ins),e._ins=null,e}(_u),JW=function(e){function t(){this._grid=null,this._goodId=0,this._achieves=null,t.__super.call(this)}b(t,"modules.mall.views.item.SimpleGetMaterialView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF,this._grid.x=this.grid_bg.x,this._grid.y=this.grid_bg.y,this.addChild(this._grid)},i.initialize=function(){this.grid_bg.visible=!1},i.bindData=function(e){var t=this;if("number"==typeof e&&Math.floor(e)==e){t._goodId=e;var i=Bi.getIndex(t._goodId);if(-1==i||null==i)return void(t._grid.bindData=null);var n=yB.create(t._goodId);n.disAchi=!1,t._grid.bindData=n,t.txt_name.text=Bi.MODEL.name(i),Bi.MODEL.achieving(i)?(t._achieves||(t._achieves=new zW,t._achieves.centerX=0,t._achieves.pos(23,273)),t.addChild(t._achieves),t._achieves.update(t._goodId),t.height=279+t._achieves.height+50):(t._achieves&&t._achieves.removeSelf(),t.height=329)}},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.mall.SimpleGetMaterialUI._$SET_instance),t._instance=null,t}(lf),ZW=function(t){function i(){var e=this;e._grid=null,e._quickBuyComponent=null,e._unitPirce=0,e._mallKey=0,e._num=0,e._moneyType=0,e._achieves=null,e._maxNum=0,e._bindNum=0,e._isAbleBuyTime=!1,i.__super.call(e)}b(i,"modules.mall.views.MallQuickBuyView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._quickBuyComponent=new kj,e._quickBuyComponent.centerX=0,e._quickBuyComponent.y=299,e.addChild(e._quickBuyComponent),e._grid=new MF,e._grid.x=e.grid_bg.x,e._grid.y=e.grid_bg.y,e.addChild(e._grid)},e.initialize=function(){var e=this;e.grid_bg.visible=!1,e.btn_buy.clickHandler=ql.create(e,e.buyHandler,null,!1),e.btn_close.clickHandler=ql.create(e,e.closeHandler,null,!1),e._quickBuyComponent.on("num_change",e,e.numChangeHandler)},e.numChangeHandler=function(e){this._num=e,this.txt_totalPrice.text=this._unitPirce*this._num+""},e.rechargeHandler=function(){Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])},e.closeHandler=function(){hN.ins.close("MALL_QBPanel")},e.buyHandler=function(){var e=this;if(0!=e._isAbleBuyTime){var t=!0,i=e._num*e._unitPirce;2==e._moneyType?(gR.ins.YB<i||0==e._num)&&(t=!1):3==e._moneyType?gR.ins.coin<i&&(t=!1):4==e._moneyType&&gR.ins.ZJ<i&&(t=!1),t?(wN.reqBuyMallGood(e._mallKey,e._num),e.parent&&hN.ins.close("MALL_QBPanel")):4==e._moneyType?zB.ins.showById(2078,1):KQ.ins.showNoGold()}else zB.ins.showMsg(RP.n[408],1)},e.bindData=function(e){var t=this;if(null!=e){var i;if(t._mallKey=-1,t._maxNum=0,t._bindNum=0,"number"==typeof e&&Math.floor(e)==e)t._mallKey=e;else"object"==typeof e&&((i=e).hasOwnProperty("key")&&(t._mallKey=parseInt(i.key)),i.hasOwnProperty("max")&&(t._maxNum=parseInt(i.max)),i.hasOwnProperty("num")&&(t._bindNum=parseInt(i.num)));var n=Nn.getIndex(t._mallKey);if(-1!=n&&null!=n){var s=tH.instance.getMallDataVoByIndex(t._mallKey);if(null!=s){t._unitPirce=s.price,t._moneyType=s.moneyType;var o=yB.create(s.goodId);o.disAchi=!1,o.goodsNum=s.num,t._grid.bindData=o,t.bmp_money1.skin=t.bmp_money0.skin=fu.getMoneyImg(t._moneyType),t.txt_simplePrice.text=t._unitPirce+"",t.txt_name.text=s.mallGoodName;var a=s.getLeftBuyTimes(),r=0;t._isAbleBuyTime=!0,null==a?r=-1==t._maxNum?-1:99:(r=a.leftTime,0==a.leftTime&&(t._isAbleBuyTime=!1)),r<=0||99==r?t._isAbleBuyTime?t.hdv_leftTime.visible=!1:(t.hdv_leftTime.innerHTML=Ql.createColor(RP.n[409],"#ff2e24"),t.hdv_leftTime.visible=!0):(t.hdv_leftTime.visible=!0,t.hdv_leftTime.innerHTML=RP.n[410]+Ql.createColor(r+"","#23b11f")),0==s.isBulkbuy?t._quickBuyComponent.bindData(1,1,t._mallKey):0==r?t._quickBuyComponent.bindData(0,r,t._mallKey):t._quickBuyComponent.bindData(1,r,t._mallKey),0<t._bindNum&&(t._quickBuyComponent.curNum=t._bindNum);var l=Bi.getIndex(s.goodId);t.btn_buy.y=t.hdv_leftTime.visible?404:384,Bi.MODEL.achieving(l)?(t._achieves||(t._achieves=new zW,t._achieves.centerX=0,t._achieves.top=491),t.addChild(t._achieves),t._achieves.update(s.goodId),t.height=491+t._achieves.height+58):(t._achieves&&t._achieves.removeSelf(),t.height=549)}}else t._grid.bindData=null}},e.setMaxNum=function(e){this._quickBuyComponent&&this._quickBuyComponent(1,e)},p(1,i,"instance",function(){return null==i._instance&&(i._instance=new i),i._instance},layouts.mall.MallQuickBuyUI._$SET_instance),i._instance=null,i}(gu),KW=function(e){function f(){var e=this;e._showAll=!1,e._cdT=0,e._effLayer=null,e._timeLayer=null,e._contentLayer=null,e._bubbleLayer=null,e._btnHash=new jo,f.__super.call(e),e._contentLayer=new pp,e.addChild(e._contentLayer),e._contentLayer.cacheAs="normal",e._effLayer=new pp,e._effLayer.mouseEnabled=!1,e.addChild(e._effLayer),e._timeLayer=new pp,e._timeLayer.mouseEnabled=!1,e.addChild(e._timeLayer),e._bubbleLayer=new pp,e.addChild(e._bubbleLayer),e._bubbleLayer.cacheAs="normal",e.on("click",e,e.onClick)}b(f,"modules.nav.views.sub.NavActLView",hd);var t=f.prototype;return G.imps(t,{"modules.nav.others.INav":!0}),t.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onClick),this._btnHash=null,this._effLayer&&this._effLayer.removeSelf(),this._effLayer=null,laya.ui.View.prototype.destroy.call(this,e)},t.clearList=function(){},t.getIconBtn=function(e){return this._btnHash.get(e)},t.load12001=function(){this.initUI()},t.initUI=function(){var e=CN.iconData;if(e){var t=[],i=[],n=0,s=e.icons1;if(1==LN.isShow){for(var o=!(s=[]),a=0;a<e.icons1.length;a++){var r=e.icons1[a];if(28==r.iconId){o=!0,s.push(r);break}if(0<dr.iosCheck&&29==r.iconId){s.push(r);break}}o&&0<dr.iosCheck&&1==s.length&&(s=[{iconId:29,status:1,time:-1,priority:29}])}for(var l=0;l<s.length;l++){var c=s[l],u=c.iconId;if(0==EB.showCharge){if(2==dr.xgame&&124!=u)continue;if(28==u||29==u)continue}else 0<dr.iosCheck&&28==u&&(u=(c={iconId:29,status:1,time:-1,priority:29}).iconId);var d=kt.getIndex(u);if(1!=kt.MODEL.canhide(d)||(!0,this._showAll)){var h=this.getBtn(u);n<f.MAXICONNUM?h.pos(12,407+102*n):h.pos(116,407+102*(n-f.MAXICONNUM)),1003!=u||XR.hasOpenV?h.updateStatus(c.status):h.updateStatus(2),h.setCountTime(c.time),t.push(u),n++}else{i.push(c);var _=this.getIconBtn(u);_&&_.removeIconTip()}}for(l=this._btnHash.keys.length-1;0<=l;l--)u=this._btnHash.keys[l],-1==t.indexOf(u)&&(this._btnHash.values[l].clear(),this._btnHash.remove(u))}},t.getBtn=function(e){var t=this._btnHash.get(e);return t||(t=new $H(e,this._contentLayer,this._effLayer,94,94,this._timeLayer,this._bubbleLayer),this._btnHash.set(e,t)),t},t.notice=function(e){switch(e.actionOrder){case"12001":this.load12001();break;case"HIDE_ACT_ICON":e.proto?CN.iconData&&CN.iconData.icons1.length>f.MAXICONNUM&&this.showAct(!1):this.showAct(!0);break;case"UPDATE_ACTLEFT_ICON":this.load12001();break;case"10119":$H.SHOW_LEFT_ID=[],G.timer.once(3e3,this,this.refreshBubble);case"10206":this.refreshBubble()}},t.refreshBubble=function(){for(var e=0;e<this._btnHash.keys.length;++e)this._btnHash.values[e].setBubble(!0)},t.show=function(){this.showAct(!0)},t.hide=function(){for(var e=0;e<this._btnHash.keys.length;++e)this._btnHash.values[e].clear();this._btnHash.clear()},t.onClick=function(e){e.target&&CN.dealActIcon(e.target);for(var t=0,i=0;i<this._btnHash.keys.length;++i)t=kt.getIndex(this._btnHash.keys[i]),e.target.dataSource&&kt.MODEL.key(t)==e.target.dataSource.iconId&&this._btnHash.values[i].removeIconTip(this._btnHash.keys[i])},t.showAct=function(e){this._showAll=e,this.initUI()},t.loop=function(e){for(var t=0;t<this._btnHash.keys.length;++t)this._btnHash.values[t].updateTime()},p(0,t,"name",function(){return"NavActLView"}),f.NAME="NavActLView",f.MAXICONNUM=3,f}(),$W=function(e){function M(){var e=this;e._showAll=!1,e._cdT=0,e._effLayer=null,e._timeLayer=null,e._contentLayer=null,e._bubbleLayer=null,e._btnHash=new jo,M.__super.call(e),e._contentLayer=new pp,e.addChild(e._contentLayer),e._contentLayer.cacheAs="normal",e._effLayer=new pp,e._effLayer.mouseEnabled=!1,e.addChild(e._effLayer),e._timeLayer=new pp,e._timeLayer.mouseEnabled=!1,e.addChild(e._timeLayer),e._bubbleLayer=new pp,e._bubbleLayer.mouseEnabled=!1,e._bubbleLayer.mouseThrough=!0,e.on("click",e,e.onClick),G.timer.loop(1e3,e,e.loop)}b(M,"modules.nav.views.sub.NavActRView",_d);var t=M.prototype;return G.imps(t,{"modules.nav.others.INav":!0}),t.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onClick),this._btnHash=null,this._effLayer&&this._effLayer.removeSelf(),this._effLayer=null,laya.ui.View.prototype.destroy.call(this,e)},t.getIconBtn=function(e){return this._btnHash.get(e)},t.load12001=function(){this.inteUI()},t.inteUI=function(){var e=this;if("NaN"!=dr.getOpenServiceDay().toString()){G.timer.clear(e,e.inteUI);AN.ins._stateH.take(244);var t=CN.iconData;if(t){var i=[],n=[],s=[],o=new jo,a=e.width,r=48,l=t.icons2;if(1==LN.isShowPetBtn){l=[];for(var c=0;c<t.icons2.length;c++){var u=t.icons2[c];if(107==u.iconId){l.push(u);break}}}for(var d=0;d<l.length;d++){var h=l[d],_=h.iconId,f=kt.getIndex(_),p=kt.MODEL.parent(f);0!=jP.checkFunctionOpen(_)&&(0<p&&(s.hasOwnProperty(p)?s[p].push(_):s[p]=[]))}for(d=0;d<l.length;d++){_=(h=l[d]).iconId,f=kt.getIndex(_);var g=kt.MODEL.iconName(f);if(1!=kt.MODEL.canhide(f)||(!0,e._showAll)){if(0!=jP.checkFunctionOpen(_)&&("btnParent"!=g||s.hasOwnProperty(_))&&(!(p=kt.MODEL.parent(f))||!s.hasOwnProperty(p))){var v=e.getBtn(_);if(107==_&&(modules.pet.others.PetDataModel.LG_PETSHOP||modules.pet.others.PetDataModel.LG_PETMAIN)?v.updateStatus(2):v.updateStatus(h.status),v.setCountTime(h.time),i.push(_),e._showAll){var m=kt.MODEL.rowIndex(f),y=o.get(m);null==y&&(y=[],o.set(m,y)),y.push(_)}}}else{n.push(h);var I=e.getIconBtn(_);I&&I.removeIconTip()}}var b=0;if(e._showAll){var w=0;for(d=1;d<=3;d++){var x=o.get(d);if(null!=x){w=x.length,b=Math.max(b,M.MAXICONNUM*(d-1));for(var S=0;S<w;S++){var k=x[S];v=e.getBtn(k);var E=b%M.MAXICONNUM,T=Math.floor(b/M.MAXICONNUM);a=e.width-102-102*E,r=98*T+48,v.pos(a,r),b++}}}o.clear()}else{for(L in i)_=i[L],v=e.getBtn(_),0<b&&b%M.MAXICONNUM==0?(a=e.width-102,r+=98):a-=102,v.pos(a,r),b++}r+=98,b=0,a=e.width;var C=[];if(0==LN.isShowPetBtn){for(d=0;d<t.iconsPrevR.length;d++)_=(h=t.iconsPrevR[d]).iconId,f=kt.getIndex(_),1!=kt.MODEL.canhide(f)||(!0,e._showAll)?((v=e.getBtn(_)).updateStatus(h.status),v.setCountTime(h.time),-1==h.time&&v.showText("进行中"),i.push(_),C.push(_),b++):n.push(h);var L;for(L in C)_=C[L],h=t.iconsPrevR[d],v=e.getBtn(_),0<b&&b%M.MAXICONNUM==0?(a=e.width-102,r+=98):a-=102,v.pos(a,r),b++;for(b=0,a=e.width,d=0;d<t.icons3.length;d++)39!=(_=(h=t.icons3[d]).iconId)&&(f=kt.getIndex(_),1!=kt.MODEL.canhide(f)||(!0,e._showAll)?0!=jP.checkFunctionOpen(_)&&((v=e.getBtn(_,132,132)).pos(e.width-132*(d+2)+10,392),v.updateStatus(h.status),v.setCountTime(h.time),i.push(_),b++):n.push(h))}for(d=e._btnHash.keys.length-1;0<=d;d--)_=e._btnHash.keys[d],-1==i.indexOf(_)&&(e._btnHash.values[d].clear(),e._btnHash.remove(_));if(!e._showAll){e.btnOpen.tipOffX=10,e.btnOpen.tipOffY=-10,e.btnOpen.showTip=!1}e.addChild(e._bubbleLayer)}}else G.timer.loop(300,e,e.inteUI)},t.getBtn=function(e,t,i){void 0===t&&(t=94),void 0===i&&(i=94);var n=this._btnHash.get(e);return n||(n=new $H(e,this._contentLayer,this._effLayer,t,i,this._timeLayer,this._bubbleLayer),this._btnHash.set(e,n)),n},t.notice=function(e){switch(e.actionOrder){case"12001":if(this.load12001(),hr.webGetParams&&hr.webGetParams.hasOwnProperty("wd_gift"))1==parseInt(hr.webGetParams.wd_gift)&&qP.download_wd(null,jP.downWdSuccess);break;case"HIDE_ACT_ICON":return;case"SHOW_ACT_ICON":this.showAct(!0);break;case"10119":G.timer.loop(100,this,this.onTime),$H.SHOW_IDS=[],G.timer.once(3e3,this,this.refreshBubble);break;case"10206":this.refreshBubble();break;case"UPDATE_RED_POINT":var t=this.getIconBtn(107);if(t)if(modules.pet.others.PetDataModel.LG_PETSHOP||modules.pet.others.PetDataModel.LG_PETMAIN)t.btn.showTip=!0;else{var i=CN.iconData;if(i)for(var n=0;n<i.icons2.length;n++)if(107==i.icons2[n].iconId){t.updateStatus(i.icons2[n].status);break}}}},t.refreshBubble=function(){for(var e=0;e<this._btnHash.keys.length;++e)this._btnHash.values[e].setBubble(!0)},t.onTime=function(){if(dr.getOpenServiceDay()>LN.curOpenServiceDay){LN.curOpenServiceDay=dr.getOpenServiceDay(),G.timer.clear(this,this.onTime);for(var e=0;e<this._btnHash.keys.length;++e)12==this._btnHash.keys[e]&&this._btnHash.values[e].updateSkin()}},t.clearList=function(){},t.show=function(){this.showAct(LN.actRListOpen)},t.hide=function(){for(var e=0;e<this._btnHash.keys.length;e++)this._btnHash.values[e].clear();this._btnHash.clear()},t.onClick=function(e){var t=this;if(e.target==t.btnOpen){if(BB.getTimer()-t._cdT<200)return;"ui/layouts/mainframe/ty_btn_zk.png"==t.btnOpen.skin?t.showAct(!0):t.showAct(!1),t._cdT=BB.getTimer()}else{CN.dealActIcon(e.target);for(var i=0,n=0;n<t._btnHash.keys.length;++n)i=kt.getIndex(t._btnHash.keys[n]),e.target.dataSource&&kt.MODEL.key(i)==e.target.dataSource.iconId&&t._btnHash.values[n].removeIconTip(t._btnHash.keys[n])}},t.showAct=function(e){this.btnOpen.skin=e?"ui/layouts/mainframe/ty_btn_sq.png":"ui/layouts/mainframe/ty_btn_zk.png",this._showAll=LN.actRListOpen=e,hZ.instance.close(),this.inteUI()},t.loop=function(e){for(var t=0;t<this._btnHash.keys.length;++t)this._btnHash.values[t].updateTime()},t.showCpIcon=function(){if(BR.ins.isCheckPointBoss){var e=[],t=CN.iconData;if(t){for(var i=0;i<t.icons2.length;i++){var n=t.icons2[i],s=n.iconId,o=kt.getIndex(s);1==kt.MODEL.guanqiaShow(o)&&e.push({id:s,status:n.status,time:n.time})}this.showIcons(e)}}},t.showIcons=function(e){if(e&&!(e.length<1))for(var t=0,i=this.width,n=48,s=0;s<e.length;s++){var o=this.getBtn(e[s].id);0<t&&t%M.MAXICONNUM==0?(i=this.width-102,n+=98):i-=102,107==e[s].id&&(modules.pet.others.PetDataModel.LG_PETSHOP||modules.pet.others.PetDataModel.LG_PETMAIN)?o.updateStatus(2):o.updateStatus(e[s].status),o.setCountTime(e[s].time),o.pos(i,n),t++}},p(0,t,"name",function(){return"NavActRView"}),M.NAME="NavActRView",M.MAXICONNUM=6,M}(),eY=function(e){function t(){this._eff=null,this._circle=null,this.info=null,this.lastInfo=null,t.__super.call(this),this.on("click",this,this.onClick)}b(t,"modules.nav.views.sub.NavBossAncient",yd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){e&&(VR._status=parseInt(e.proto.status)),this.updateStatus(),this.change()},i.show=function(){this.updateStatus(),this.updateProgress(),this.updateHeadImg()},i.hide=function(){this._eff&&(this._eff.dispose(),this._eff=null),hN.ins.close("BOSS_ANCIENT_REFRESH"),this.imgHead.skin=null},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.off("click",t,t.onClick),t._eff&&t._eff.dispose(),t._eff=null,t.imgHead.skin=null,t._circle&&t._circle.removeSelf(),t._circle=null,t.info=null,t.lastInfo=null,laya.ui.View.prototype.destroy.call(t,e)},i.change=function(){this.updateProgress(),this.updateHeadImg()},i.onClick=function(e){jR.reqCopy(30),Tu.sendToModule("OPEN_BOSS_ANCIENT_VIEE",["modules.bossancient.BossAncientModule"])},i.updateStatus=function(){this.visible=0==VR._status},i.updateProgress=function(){var e=this;if(e.info=VR.ins.firstInfo,e.info){var t=e.info.curAnger/e.info.maxAnger*180;if(t<=0)e.bar.visible=!1,e._eff&&(e._eff.dispose(),e._eff=null);else if(e._eff||(e._eff=kB.createEffect("jm1310",41,41,e.bar)),e.bar.visible=!0,180<=t)e.bar.mask=null;else{var i=t/180*360;null==e._circle&&(e._circle=new pp,e.bar.mask=e._circle),null==e.bar.mask&&(e.bar.mask=e._circle),e._circle.graphics.clear(),e._circle.graphics.drawPie(e.bar.width>>1,e.bar.height>>1,52,-90,i-90,"#000000"),e._circle.repaint()}1<=e.info.curAnger/e.info.maxAnger&&e.info.id==VR.ins.canClgId&&e.visible?hN.ins.open("BOSS_ANCIENT_REFRESH",e.info):hN.ins.close("BOSS_ANCIENT_REFRESH"),hN.ins.isOpen("BOSS_ANCIENT_MAINVIEW")&&hN.ins.close("BOSS_ANCIENT_REFRESH")}else e.bar.visible=!1},i.updateHeadImg=function(){if(this.info||(this.info=VR.ins.firstInfo),this.info){this.imgHead.width=this.imgHead.height=154;var e=new pp;this.imgHead.skin=_r.getBossPath(this.info.bossHead),this.imgHead.scale(.76,.76),e.graphics.clear(),e.graphics.drawCircle(41,41,41,"#ff0000"),e.pos(42,44),this.imgHead.mask=e}},p(0,i,"name",function(){return"NavBossAncient"}),t.NAME="NavBossAncient",t}(),tY=function(e){function t(){t.__super.call(this),this.on("click",this,this.onClick)}b(t,"modules.nav.views.sub.NavBoss",Id);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){this.updateStatus()},i.show=function(){AN.ins.addListener("BTN_BOSS",[60],ql.create(this,this.redPtHandler,null,!1)),this.updateStatus(),this.visible&&!hN.ins.isOpen("PETPOPTIP")&&modules.pet.others.PetDataModel.ins().petEggDropVo&&modules.pet.others.PetDataModel.shouldOpenPop&&hN.ins.open("PETPOPTIP")},i.hide=function(){hN.ins.isOpen("BOSS_GOD_REFRESH")&&hN.ins.close("BOSS_GOD_REFRESH"),hN.ins.isOpen("PETPOPTIP")&&hN.ins.close("PETPOPTIP"),AN.ins.removeListener("BTN_BOSS")},i.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onClick),this.hide(),laya.ui.View.prototype.destroy.call(this,e)},i.updateStatus=function(){var e=parseInt($e.MODEL.value($e.getIndex(59)));this.visible=gR.ins.lv>=e,this.redPtHandler("BTN_BOSS",AN.ins.getStateByBtnName("BTN_BOSS"))},i.redPtHandler=function(e,t){"BTN_BOSS"==e&&(this.btnBoss.showTip=t)},i.onClick=function(e){BR.ins.btnCallBossPanel(),hN.ins.isOpen("BOSS_GOD_REFRESH")&&hN.ins.close("BOSS_GOD_REFRESH")},p(0,i,"name",function(){return"NavBoss"}),t.NAME="NavBoss",t}(),iY=function(e){function t(){this._circle=null,this._eff=null,t.__super.call(this),this.on("click",this,this.onClick)}b(t,"modules.nav.views.sub.NavCheckPoint",xd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){this.updateView(),this.visible&&this.change(),this.doShowGuide()},i.updateView=function(){if(gR){var e=Pn.getIndex(parseInt(gR.ins.cId));2==Pn.MODEL.type(e)||(UR.instance.clearBatch(),this.showEff(!1))}var t=!0;t&&(t=2==uH.Ins().currCkType),t&&(t=!BR.ins.isCheckPointBoss),t&&(t=UR.instance.guanQiaBtnOpen()),this.visible=t},i.show=function(){this.updateView(),this.btnAuto.selected=UR.instance.isAuto,this.updateProgress(),this.updateBtn(),this.doShowGuide()},i.hide=function(){LY.Ins().isShow()&&LY.Ins().close(23)},i.showEff=function(e){var t=this;void 0===e&&(e=!1),e?t._eff||(t._eff=mj.GetNew(),t._eff.renderInSelf=!0,t._eff.setXY(t.btnCheckPoint.x+t.btnCheckPoint.width/2,t.btnCheckPoint.y+t.btnCheckPoint.height/2),t._eff.loadEffect("jm1037"),t._eff.autoClear=!1,t._eff.scale_X=1,t._eff.scale_Y=1,t.effectBox.addChild(t._eff)):(t._eff&&t._eff.dispose(),t._eff=null)},i.change=function(){this.updateBtn(),this.updateProgress()},i.getPowerPt=function(){var e=new Uh(Math.floor(this.bar.x+this.bar.width/2),Math.floor(this.bar.y+this.bar.height/2));return this.localToGlobal(e,!0)},i.updateProgress=function(){var e=this,t=UR.instance.currentBo/UR.instance.currentCheckPointMaxBo*180;if(t<=0)e.bar.visible=!1,e.showEff(!1);else{if(e.bar.visible=!0,180<=t)e.bar.mask=null;else{var i=t/180*360;null==e._circle&&(e._circle=new pp,e.bar.mask=e._circle),null==e.bar.mask&&(e.bar.mask=e._circle),e._circle.graphics.clear(),e._circle.graphics.drawPie(e.bar.width>>1,e.bar.height>>1,52,-90,i-90,"#000000"),e._circle.repaint()}180<=t&&e.showEff(!0)}},i.updateBtn=function(){UR.instance.isAuto?this.btnAuto.label=RP.n[411]:this.btnAuto.label=RP.n[412]},i.onClick=function(e){if(dr.dtoEnterScene&&23==dr.dtoEnterScene.type)zB.ins.playErrorMsg(RP.n[413]);else{var t=PH.Ins().info;if(!t||23!=t.DirectionEvent&&34!=t.DirectionEvent||(t.DirectionEvent=0),e.target==this.btnCheckPoint)UR.instance.fullPower?FR.killBoss():zB.ins.playErrorMsg(zB.ins.getDesc(3620));else if(e.target==this.btnAuto){var i=18,n=$e.MODEL.value($e.getIndex(132));if(n&&0<n.length&&(i=parseInt(n)),UR.instance.currentPoint<i)zB.ins.showById2(3206,[i],1);else{if(this.btnAuto.selected=!this.btnAuto.selected,UR.instance.isAuto=this.btnAuto.selected,this.updateBtn(),UR.instance.isAuto&&UR.instance.fullPower){if(TR.ins.getLeftGridNum()<=20)return void KQ.ins.showBagRecycle();FR.requestKillLittleMonster(),FR.killBoss()}this.doShowGuide()}}mN.showGuild=!1,LY.Ins().isShow()&&LY.Ins().close(23)}},i.doShowGuide=function(){var e=this,t=PH.Ins().info;if(t&&0<t.getCurrentGuide(23)||mN.showGuild)if(2==t.status&&e.bar.visible||mN.showGuild&&e.visible){var i=new u_;i.x=e.btnCheckPoint.x,i.y=e.btnCheckPoint.y-5,i.width=e.btnCheckPoint.width,i.height=e.btnCheckPoint.height,LY.Ins().show(23,i,!1,e)}else LY.Ins().isShow()&&LY.Ins().close(23);else if(t&&0<t.getCurrentGuide(32)&&0==UR.instance.isAuto&&BR.ins.curCopyId<=0){var n=new u_;n.x=e.btnAuto.x,n.y=e.btnAuto.y-5,n.width=e.btnAuto.width,n.height=e.btnAuto.height,LY.Ins().show(32,n,!1,e)}else if(t&&23==t.DirectionEvent){var s=new u_;s.x=e.btnCheckPoint.x,s.y=e.btnCheckPoint.y-5,s.width=e.btnCheckPoint.width,s.height=e.btnCheckPoint.height,LY.Ins().show(23,s,!1,e)}else if(t&&34==t.DirectionEvent&&2==t.status){var o=new u_;o.x=e.btnCheckPoint.x,o.y=e.btnCheckPoint.y-5,o.width=e.btnCheckPoint.width,o.height=e.btnCheckPoint.height,LY.Ins().show(34,o,!1,e)}else LY.Ins().isShow()&&(LY.Ins().close(23),LY.Ins().close(32),LY.Ins().close(34))},p(0,i,"name",function(){return"NavCheckPoint"}),t.NAME="NavCheckPoint",t}(),nY=function(e){function s(){var e=this;e.inited=!1,e.lastActivedRingId=0,e.state=0,e.stateType=0,e.doGuildeTime=0,e.updateInterTime=1e3,e._circle=null,e.currCD=0,e._eff=null,e._eff2=null,e._zhuiJiActivityEffect1=null,e._zhuiJiActivityEffect2=null,e._zhuiJiActivityEffect3=null,s.__super.call(e),e.on("display",e,e.onAdd),e.on("undisplay",e,e.onRemove)}b(s,"modules.nav.views.sub.NavHeji",Md);var t=s.prototype;return t.createView=function(e){laya.ui.View.prototype.createView.call(this,e),this.showHide(),this.sp_click.on("click",this,this.onClickAttack)},t.onAdd=function(e){G.timer.loop(300,this,this.onEnterFrame),this.updateZhuiJiEffect()},t.onRemove=function(e){G.timer.clear(this,this.onEnterFrame)},t.show=function(){},t.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":this.isOpenRing(),gR&&this.showHide(),this.updateProgress();break;case"SHOW_HEJI_FLY":this.showFly();break;case"31023":case"CLOSE_LIMIT_ZHUIJI":this.updateZhuiJiEffect()}},t.updateZhuiJiEffect=function(){if(v_.isWebGL){0==s._grayFilter.length&&(s._grayFilter=(s._grayFilter=(s._grayFilter=(s._grayFilter=s._grayFilter.concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([0,0,0,1,0]));for(var e=0;e<gR.ins.zhuijiSkill.length;e++)0==gR.ins.zhuijiSkill[e]?this["img_zhuiji_"+(e+1)].filters=[new ys(s._grayFilter)]:this["img_zhuiji_"+(e+1)].filters=[]}},t.showFly=function(){var e=new Kl;e.mouseThrough=!0,e.skin=_r.getAtlasSubPath("mainframe2/zjm_hjjn_icon.png"),e.pos(360,640),eq.topLayer.addChild(e),Og.to(e,{x:this.x+21,y:this.y+29},1e3,pa.expoInOut,ql.create(this,this.onFlyEnd,[e]))},t.onFlyEnd=function(e){e.parent&&(e.removeSelf(),e.dispose(),e=null)},t.isOpenRing=function(){aB.instance.activedRingId<1?this.visible=!1:this.visible=!0,this.lastActivedRingId=aB.instance.activedRingId},t.showHide=function(){var e=this,t=Pn.getIndex(parseInt(gR.ins.cId)),i=Pn.MODEL.type(t),n=0;if(0<BR.ins.curCopyId){t=rn.getIndex(BR.ins.curCopyId);var s=rn.MODEL.cate(t);n=ER.ins.getUnionLocalStorage(s)}e.stateType=0,6==i?(e.state=0,e.visible=!1):(0<n?(e.stateType=2,e.state=n):(e.stateType=1,e.state=ER.ins.hideHeji?2:1),e.visible=!0),e.updateZhuiJi()},t.updateZhuiJi=function(){0<gR.ins.limitZhuiJiSkillID?null==sJ.ins.getCompomentsByName("NavZhuiJi")?sJ.ins.showCompoment("NavLimitZhuiJi"):sJ.ins.getCompomentsByName("NavZhuiJi").parent?sJ.ins.hideCompoment("NavLimitZhuiJi"):sJ.ins.showCompoment("NavLimitZhuiJi"):sJ.ins.hideCompoment("NavLimitZhuiJi")},t.getState=function(){return 1},t.onEnterFrame=function(e){var t=this;!t.inited&&dr.curServerTime&&(IH.ins.unionCD=24e3,IH.ins.unionUseTime=dr.curServerTime+3900,t.inited=!0,sJ.ins.setTop("Navheji")),t.lastActivedRingId!=aB.instance.activedRingId&&0!=t.state&&t.isOpenRing();var i=rn.getIndex(BR.ins.curCopyId),n=rn.MODEL.cate(i),s=ER.ins.getHeJiSettiongByCate(n);t.state=s||(ER.ins.hideHeji?2:1),IH.ins.isCanUse()?(t.showEff(!0),t.updateProgress(),2==t.state&&t.onAutoClick()):(t.updateProgress(),t.showEff(!1));var o=BB.getTimer();o-t.doGuildeTime>=t.updateInterTime&&(t.doGuildeTime=o,t.doShowGuide())},t.onClickAttack=function(e){this.onEnterFrame(null),IH.ins.isCanUse()?this.onAutoClick(!0):zB.ins.playErrorMsg(RP.n[414])},t.onAutoClick=function(e){void 0===e&&(e=!1),IH.ins.isCanUse()&&(sH.getInstance().clickUnionAttack(e),this._circle&&this._circle.graphics.clear(),LY.Ins().isShow()&&LY.Ins().close(29))},t.updateProgress=function(){var e=this;null==e._circle&&(e._circle=new pp,e.bar.mask=e._circle);var t=180*IH.ins.progress;if((t=180<t?180:t)<=0)e.bar.visible=!1;else if(e.bar.visible=!0,180<=t)e.bar.mask=null;else{var i=t/180*360;e.bar.mask=e._circle,e._circle.graphics.clear(),e._circle.graphics.drawPie(e.bar.width>>1,e.bar.height>>1,43,-90,i-90,"#000000"),e._circle.repaint()}},t.showEff=function(e){var t=this;void 0===e&&(e=!1),e?(null==t._eff?(t._eff=kB.createEffect("jm1141",93,67,t),t._eff.autoClear=!1,qH.Ins().addNoClears("jm1141")):t._eff.visible=!0,null==t._eff2?(t._eff2=kB.createEffect("jm1264",93,67,t),t._eff2.autoClear=!1,qH.Ins().addNoClears("jm1264")):t._eff2.visible=!0,t.addChild(t.sp_click)):(t._eff&&(t._eff.visible=!1),t._eff2&&(t._eff2.visible=!1)),t.showZhuiJiActivityEffect(e)},t.showZhuiJiActivityEffect=function(e){var t=this;if(e)for(var i=0;i<gR.ins.zhuijiSkill.length;i++)0!=gR.ins.zhuijiSkill[i]?null==t["_zhuiJiActivityEffect"+(i+1)]?t["_zhuiJiActivityEffect"+(i+1)]=kB.createEffect(s.zhuiJiEffectArr[i],t["img_zhuiji_"+(i+1)].x+15,t["img_zhuiji_"+(i+1)].y+15,t):t["_zhuiJiActivityEffect"+(i+1)].visible=!0:null!=t["_zhuiJiActivityEffect"+(i+1)]&&(t["_zhuiJiActivityEffect"+(i+1)].visible=!1);else for(var n=0;n<gR.ins.zhuijiSkill.length;n++)null!=t["_zhuiJiActivityEffect"+(n+1)]&&(t["_zhuiJiActivityEffect"+(n+1)].visible=!1)},t.doShowGuide=function(){var e=PH.Ins().info;if(e&&0<e.getCurrentGuide(29)&&BR.ins.isCheckPointBoss)if(this.bar.visible&&2==e.status&&1<=IH.ins.progress){if(!LY.Ins().isShow()){var t=new u_;t.x=this.bar.x+3,t.y=this.bar.y-7,t.width=this.bar.width,t.height=this.bar.height,LY.Ins().show(29,t,!1,this)}}else LY.Ins().isShow()&&LY.Ins().close(29);else LY.Ins().isShow()&&LY.Ins().close(29)},s.NAME="Navheji",s._grayFilter=[],f(s,["zhuiJiEffectArr",function(){return this.zhuiJiEffectArr=["jm1378","jm1379","jm1380"]},"zhuJiPointArr",function(){return this.zhuJiPointArr=[new Uh,new Uh,new Uh]}]),s}(),sY=function(e){function t(){this._activityEff=null,t.__super.call(this),this.on("click",this,this.onClick),AN.ins.addListener("BTN_DAILY",[207,65,243,258],ql.create(this,this.redPtHandler,null,!1))}b(t,"modules.nav.views.sub.NavNewDailyEnter",Sd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.notice=function(e){this.visible=this.getIsOpen()},i.show=function(){this.visible=this.getIsOpen()},i.hide=function(){this.visible=!1},i.clearList=function(){},i.onClick=function(e){Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"])},i.redPtHandler=function(e,t){t?(null==this._activityEff&&(this._activityEff=kB.createEffect("jm0088",60,60,this,"jm0088"),this._activityEff.scale_X=1.2,this._activityEff.scale_Y=1.2),this._activityEff.visible=!0):this._activityEff&&(this._activityEff.visible=!1),this.btnCheckPoint.showTip=t},i.getIsOpen=function(){var e=parseInt($e.MODEL.value($e.getIndex(119)));return 60<=gR.ins.lv||e<=aB.instance.activedRingId},p(0,i,"name",function(){return"NavNewDailyEnter"}),t.NAME="NavNewDailyEnter",t}(),oY=function(e){function t(){var e=this;e._curState=0,e._cdT=0,e.cExp=0,e.expIndex=1,e.effBattle=null,e.autoFight=null,e.mouseHand=null,e.killNum=1,e.curkillNum=0,e.sid="1",t.__super.call(e),e.btnBack.on("click",e,e.onClick)}b(t,"modules.nav.views.sub.NavMap",Nd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){if(0!=this.checkShow)switch(0==this.visible&&(this.visible=!0),e.actionOrder){case"CHANGE_MAP":if(gR){var t=Pn.getIndex(parseInt(gR.ins.cId)),i=(Pn.MODEL.name(t),0);i=2==Pn.MODEL.type(t)?1:0,dr.dtoEnterScene&&23==dr.dtoEnterScene.type&&(i=1),this.showState(i,!(i==this._curState))}}else this.visible=!1},i.show=function(){this.visible=this.checkShow,this.showState(this.getState())},i.hide=function(){},i.onClick=function(e){var t=this;if(!(BB.getTimer()-t._cdT<1e3))if(t._cdT=BB.getTimer(),ZN.isEnabledChangeScene())if(e.target==t.btnBack&&(t._curState=t.getState(),t.showState(t._curState)),0==t._curState){var i=parseInt($e.MODEL.value($e.getIndex(106)));if(gR.ins.lv<i)return void zB.ins.playErrorMsg(i+RP.n[365]);hN.ins.isOpen("PETPOPTIP")&&hN.ins.close("PETPOPTIP"),dr.dtoEnterScene=null,t.sid=uH.Ins().prveCid=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"",NF.Ins().changeScene(t.sid,!0,ql.create(aF,aF.onReadForYeZhanHandler)),sH.getInstance().autoMode=!0,eB.getInstance().resetAllSkillCd()}else{if(NF.Ins().recordMainCharPosition(),dr.dtoEnterScene&&23==dr.dtoEnterScene.type){var n=rn.getIndex(dr.dtoEnterScene.copyId);if(22==rn.MODEL.cate(n))return void zB.ins.playErrorMsg(RP.n[416])}hN.ins.isOpen("PETPOPTIP")&&hN.ins.close("PETPOPTIP"),10<gR.ins.lv?NF.Ins().changeScene("1",!0,ql.create(aF,aF.onReadForYeZhanHandler)):(t.sid="1",NF.Ins().changeScene(t.sid),sH.getInstance().autoMode=!1)}else zB.ins.showById(2126,1)},i.getState=function(){var e=0;if(gR){var t=Pn.getIndex(parseInt(gR.ins.cId));Pn.MODEL.name(t);e=2==Pn.MODEL.type(t)?1:0,dr.dtoEnterScene&&23==dr.dtoEnterScene.type&&(e=1)}return e},i.showState=function(e,t){void 0===t&&(t=!1),0==e?this.btnBack.skin="ui/layouts/mainframe3/zjm_btn_yw.png":1==e&&(this.btnBack.skin="ui/layouts/mainframe3/zjm_btn_hc.png")},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"name",function(){return"NavMap"}),p(0,i,"checkShow",function(){var e=$e.MODEL.value($e.getIndex(106)),t=parseInt(e);return t<=0||0<t&&gR.ins.lv>=t}),t.BATTLEEff="jm0025",t.AUTOFIGHT="jm0081",t.MOUSEHAND="jm0024",t.NAME="NavMap",t.HOME=0,t.BATTLE=1,t}(),aY=function(e){function t(){t.__super.call(this)}b(t,"modules.nav.views.sub.NavMissionView",Gd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){this.updateStatus()},i.show=function(){this.updateStatus(),this.on("click",this,this.onClicked),this.redPtHandler("BTN_MISSION",!1);var e=ql.create(this,this.redPtHandler,null,!1);AN.ins.addListener("BTN_MISSION",[213],e)},i.hide=function(){this.off("click",this,this.onClicked),AN.ins.removeListener("BTN_MISSION")},i.updateStatus=function(){this.visible=qR.ins.isOpenCopy,AN.ins.getStateByBtnName("BTN_MISSION")||Lo.instance.isFirstLoginClicked||modules.copy.others.NewPigData.ins.isShowRedPoint||modules.copy.others.HundunData.ins.isFirstRed||(this.btn_mission.showTip=!1)},i.redPtHandler=function(e,t){"BTN_MISSION"==e&&(t?this.btn_mission.showTip=!0:Lo.instance.isFirstLoginClicked&&this.checkOpenById(19)||modules.copy.others.NewPigData.ins.isShowRedPoint&&this.checkOpenById(21)||modules.copy.others.HundunData.ins.isFirstRed&&this.checkOpenById1(309)?this.btn_mission.showTip=!0:this.btn_mission.showTip=!1)},i.checkOpenById=function(e){var t=$e.getIndex(e),i=parseInt($e.MODEL.value(t));return gR.ins.lv>=i},i.checkOpenById1=function(e){var t=!1,i=$e.getIndex(e),n=$e.MODEL.value(i);if(n)for(var s=JSON.parse(n),o=0;o<s.length;o++){var a,r=s[o];if(null==r)return!1;r.type&&(a=r.type.toLowerCase());var l=parseInt(r.value);"playerlevel"==a&&gR.ins.lv<l&&(t=!1)}return t},i.onClicked=function(e){Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"])},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"name",function(){return"NavMission"}),t.NAME="NavMission",t}(),rY=function(e){function t(){t.__super.call(this),this.on("click",this,this.onClick)}b(t,"modules.nav.views.sub.NavOtherBar",Ud);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){"11211"==e.actionOrder?this.btnMail.showTip=2==lu.ins.mailState:"UPDATE_FRIEND_RED_POINT"==e.actionOrder?this.checkFriend():"10206"!=e.actionOrder&&"21109"!=e.actionOrder||this.checkFriend()},i.checkFriend=function(){modules.friendnew.others.FriendNewDataModel.instance.isFriendOpen()?(this.btn_friends.visible=!0,modules.friendnew.others.FriendNewDataModel.instance.hasApply||modules.friendnew.others.FriendNewChatRecordDataCenter.instance.hasUnreadMessage()?hN.ins.isOpen("FRIENDNEWMAINVIEW")?this.btn_friends.showTip=!1:this.btn_friends.showTip=!0:this.btn_friends.showTip=!1):this.btn_friends.visible=!1},i.show=function(){this.btnMail.showTip=2==lu.ins.mailState,this.checkFriend()},i.hide=function(){},i.onClick=function(e){e.target==this.btnMail?Tu.sendToModule("OPEN",["modules.mail.MailModule"]):e.target==this.btn_friends&&(modules.friendnew.others.FriendNewDataModel.instance.needToShowView=!0,Tu.sendToModule("OPEN_FRIENDNEW_MAINVIEW",["modules.friendnew.FriendNewModule"]))},p(0,i,"name",function(){return"NavOtherBar"}),t.NAME="NavOtherBar",t}(),lY=function(e){function t(){this.TYPE_RING="ring",this.crtIndex=-1,this._effect=null,t.__super.call(this),this.initUI()}b(t,"modules.nav.views.sub.NavPreviewAwardView",qd);var i=t.prototype;return i.initUI=function(){this.mouseEnabled=!0,this.on("click",this,this.onClick),this.visible=!1},i.onClick=function(){var e=En.MODEL.detailId(this.crtIndex);En.MODEL.panelType(this.crtIndex)==this.TYPE_RING&&0<e&&dY.instance.show(e,this.crtIndex)},i.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":case"CHANGE_GUAN_QIA_LEVEL":this.checkCfg();break;case"UPDATE_NAV_ALL":this.updateUI()}},i.checkCfg=function(){En.count<=0||kn.count<=0?HP.loadConfig(["PreviewAwardNav","PreviewAwardDetail"],["CPreviewAwardNav","CPreviewAwardDetail"],ql.create(this,this.updateUI)):this.updateUI()},i.show=function(){this.checkCfg()},i.hide=function(){},i.updateUI=function(){var e=this,t=UR.instance.currentPoint,i=En.count;e.crtIndex=-1;for(var n=0,s=0;s<i;s++){var o=En.MODEL.key(s),a=En.MODEL.showCondition(s);if(t<=o&&a<=t){e.crtIndex=s,n=o;break}}if(0<=e.crtIndex){var r=UR.instance.previewIndex;(r<0||0<=r&&r!=e.crtIndex)&&(UR.instance.previewIndex=e.crtIndex);var l=En.MODEL.icon(e.crtIndex);e.img_icon.skin=l?_r.getPreviewAward("icon/"+l):null,l=En.MODEL.titlePic(e.crtIndex),e.img_title.skin=l?_r.getPreviewAward("title/"+l):null,l=En.MODEL.title(e.crtIndex),e.txt_title.innerHTML=mp.getFormat(l,[n-t+1]),l=En.MODEL.descr(e.crtIndex),e.txt_sub.innerHTML=l,e.visible=!0}else sJ.ins.hideCompoment("NavPreviewAwardView")},i.showEffect=function(){this._effect||(this._effect=kB.createEffect("jm1032",this.width/2-5,this.height/2-15,this)),G.timer.once(5e3,this,this.hideEffect)},i.hideEffect=function(){this._effect&&this._effect.dispose(),this._effect=null},i.destroy=function(e){void 0===e&&(e=!0),this.hideEffect(),this.off("click",this,this.onClick),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="NavPreviewAwardView",t}(),cY=function(e){function t(){this._tw=null,this._tw1=null,t.__super.call(this)}b(t,"modules.nav.views.sub.NavSceneFocusView",jd);var i=t.prototype;return i.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":break;case"NOTICE_REMOVE_FOCUS":this.hide()}},i.show=function(){this.img_focus.alpha=.1,this._tw=Og.to(this.img_focus,{alpha:.8},400)},i.hide=function(){this._tw1=Og.to(this.img_focus,{alpha:0},300,null,null),G.timer.once(1e3,this,this.onComplete)},i.onComplete=function(){sJ.ins.hideCompoment("NavSceneFocusView"),G.timer.clearAll(this),this._tw&&(this._tw.clear(),this._tw=null),this._tw1&&(this._tw1.clear(),this._tw1=null)},i.destroy=function(e){void 0===e&&(e=!0),this.hide(),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="NavSceneFocusView",t}(),uY=function(e){function n(){var e=this;e._force=null,e._vipNum=null,e.buffList=[],n.__super.call(e),e.cacheAs="normal",e.imgRedPt.visible=!1,e.showLv(),e.showM(),e.setExpText(),(n._ins=e).on("click",e,e.onClick),e._force||(e._force=new mh,e._force.resPath=e.getPath,e._force.spaceX=-7,e._force.x=202,e._force.y=24),!e._force.parent&&e.addChild(e._force),AN.reqRedPt([219,220]);var t=ql.create(e,e.redPtUpdate,null,!1);AN.ins.addListener("BTN_TOPBAR",[219,220],t);var i=gR.ins.actorList[gR.ins.showId-1];e.mcHead.skin=_r.getActorHeadPath(i.job,i.sex)}b(n,"modules.nav.views.sub.NavTopBar",Wd);var t=n.prototype;return G.imps(t,{"modules.nav.others.INav":!0}),t.clearList=function(){},t.refreshBossHome=function(){hN.ins.isOpen("BOSSHOEMSUBVIEW")&&jR.reqCopy(26)},t.notice=function(e){var t=this;if("10206"==e.actionOrder||"21109"==e.actionOrder)t.showLv(),80<=gR.ins.lv&&t.refreshBossHome();else if("10205"==e.actionOrder)t.showM();else if("UPDATE_FORCE"==e.actionOrder)t.updateForce();else if("10602"==e.actionOrder)t.updateForce();else if("10210"==e.actionOrder){var i=gR.ins.actorList[gR.ins.showId-1];t.mcHead.skin=_r.getActorHeadPath(i.job,i.sex)}else"14001"==e.actionOrder?t.updateVip():"14010"==e.actionOrder?(dr.vipState=e.proto.state,dr.vipLv=e.proto.vipLv,t.updateVipEff(),t.refreshBossHome()):"10204"==e.actionOrder?t.updateForce():"NAV_BUFF_UPDATE"==e.actionOrder?t.updateBuff():"CHANGE_MAP"==e.actionOrder?(t.setExpText(),sJ.ins.setTop("NavActRView")):"UPDATE_NAV_ALL"==e.actionOrder?t.updateAll():"10121"!=e.actionOrder&&"31023"!=e.actionOrder||(0<gR.ins.getZhuiJiNum()&&(!ER.ins.isAutoZhuiJi||gR.ins.getZhuiJiNum()>ER.ins.autoZhuiJiStr.length)?t.imgRedPt.visible=!0:t.imgRedPt.visible=!1);t.visible=6666!=BR.ins.curCopyId},t.show=function(){this.updateForce(),this.updateVip(),this.updateVipEff(),this.updateBuff(),this.showLv()},t.hide=function(){this.removeBuff()},t.updateVip=function(){var e=this;e._vipNum||(e._vipNum=new mh,e._vipNum.resPath=e.getVipPath,e._vipNum.spaceX=-15,e._vipNum.top=120),!e._vipNum.parent&&e.addChild(e._vipNum);var t=gR.ins.VIPLevel;e._vipNum.value=t+"",e.img_vip.left=10<=t?28:32,e._vipNum.left=e.img_vip.left+44},t.updateVipEff=function(){if(this.btnVip){var e=dr.vipState,t=dr.vipLv;1==e?this.btnVip.showTip=!(t<=0):0==e?this.btnVip.showTip=!1:2==e&&(this.btnVip.showTip=!1)}},t.updateForce=function(){var e=gR.ins.force;this._force.value=e+""},t.showLv=function(){this.txName.changeText(gR.ins.charName);var e=0<gR.ins.zsLv?gR.ins.zsLv+"转":"";e+=gR.ins.lv+"级",this.txStatus.changeText(e),this.txStatus.left=this.txName.left+12*mp.getStringLength(this.txName.text)+20},t.changeName=function(e){this.txName.changeText(e),this.txStatus.left=this.txName.left+12*mp.getStringLength(this.txName.text)+20},t.showM=function(){this.txGlod.changeText(gR.ins.YB+""),this.txMoney.changeText(gR.ins.coinStr+"")},t.updateAll=function(){this.txGlod.changeText(""),this.txMoney.changeText(""),this.txStatus.changeText(""),this.txName.changeText(""),this.txtExp.text="",this.currNum.text="",this.setExpText(),this.showLv(),this.showM()},t.updateBuff=function(){this.removeBuff()},t.removeBuff=function(){for(var e=0;e<this.buffList.length;e++){var t=this.buffList[e];t&&(t.clear(),t.parent&&t.parent.removeChild(t))}},t.onClick=function(e){e.target==this.btnVip?Tu.sendToModule("OPEN_PANEL",["modules.vip.VipModule"]):e.target==this.mcGlod||e.target==this.btnGlod?Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]):e.target==this.boxHead?Tu.sendToModule("OPEN",["modules.assit.AssitModule"]):e.target!=this.mcCoin&&e.target!=this.btnCoin||(HN.ins.reqBuyCoin(),UB.ins.playSound(90006))},t.getPath=function(e){return _r.getAtlasSubPath("mainframe2")+"/num2_zdl_"+e+".png"},t.getVipPath=function(e){return _r.getAtlasSubPath("mainframe2")+"/num1_vip_"+e+".png"},t.redPtUpdate=function(e,t){switch(e){case"BTN_TOPBAR":AN.ins.getStateByCareList([219,220])?this.imgRedPt.visible=!0:0<gR.ins.getZhuiJiNum()&&(!ER.ins.isAutoZhuiJi||gR.ins.getZhuiJiNum()>ER.ins.autoZhuiJiStr.length)?this.imgRedPt.visible=!0:this.imgRedPt.visible=!1}},t.checkTips=function(){3!=gR.ins.actorList.length?this.imgRedPt.visible=oR.checkOpen(gR.ins.actorList.length):this.imgRedPt.visible=!1},t.setExpText=function(){this.txtExp.text=mp.getBigIntStr(Hi.MODEL.wakeExp(UR.instance.currentPoint-1))+"/小时",this.currNum.text="第"+UR.instance.currentPoint+"关",this.expIcon.right=this.txtExp.textField.textWidth+49,this.currNum.right=this.expIcon.right+46},p(0,t,"name",function(){return"NavTopBar"}),p(1,n,"ins",function(){return n._ins||new n,n._ins},layouts.nav.NavTopBarVBUI._$SET_ins),n.NAME="NavTopBar",n._ins=null,n}(),dY=function(e){function t(){var e=this;e.detailId=-1,e.currentIndex=-1,e.linkStr=null,e._BAR_W=0,t.__super.call(e),e.mouseEnabled=!0,e.btn_attack.on("click",e,e.btnClick),e.btn_close.on("click",e,e.btnClick),e._BAR_W=e.img_progress.width}b(t,"modules.nav.views.sub.previewaward.PreviewRingAwardTip",Zh);var i=t.prototype;return i.update=function(){null!=this.parent&&this.updateUI()},i.btnClick=function(e){if(e.currentTarget==this.btn_attack){var t=JSON.parse(this.linkStr);t&&(Tu.sendToModule("CLIENT_FORMAT_TASK",["modules.task.TaskModule"],t[0]),this.close(!0))}else this.close(!0)},i.show=function(e,t){this.detailId=e,this.currentIndex=t,this.updateUI(),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.parsePicData=function(e){var t=e.split(";");return t&&0<t.length?t[0].split(";"):null},i.onComplete=function(e,t){-1<t.indexOf("title/")?this.img_title.skin=t:this.img_icon.skin=t},i.updateUI=function(){var e=this;e.linkStr=null;var t=kn.getIndex(e.detailId);if(0<=t&&0<e.detailId){var i=e.img_title.skin;i!=e.img_icon.skin&&(G.loader.clearRes(i,!0),tt.ins.clearTexture(i));var n=_r.getPreviewAward("title/"+kn.MODEL.title(t));e.img_title.loadImage(n,0,0,0,0,ql.create(e,e.onComplete,[e.img_title,n]));var s=e.parsePicData(kn.MODEL.pics(t));if(i=e.img_icon.skin,s){var o=s[0].split(",");i!=e.img_icon.skin&&G.loader.clearRes(i),n=_r.getPreviewAward(o[0]),e.img_icon.loadImage(n,0,0,0,0,ql.create(e,e.onComplete,[e.img_icon,n])),e.img_icon.centerX=parseInt(o[1]),e.img_icon.centerY=parseInt(o[2])}else e.img_icon.skin=null;i!=e.img_icon.skin&&G.loader.clearRes(i),e.linkStr=kn.MODEL.goHead(t);var a=0,r=UR.instance.currentPoint,l=e.currentIndex-1,c=En.MODEL.key(e.currentIndex),u=r-(a=0<=l?En.MODEL.key(l):En.MODEL.showCondition(e.currentIndex)-1)-1,d=c-a;u<0&&(u=0);var h=u/d;1<h?h=1:h<0&&(h=0),e.txt_progress.text=u+"/"+d;var _=e.img_progress.scrollRect||new u_(0,0,e.img_progress.width,e.img_progress.height);_.width=e._BAR_W*h,e.img_progress.scrollRect=_;var f=null,p=kn.MODEL.content(t);if(p&&0<p.length&&(f=JSON.parse(p)),f){var g=zB.ins.getDesc(parseInt(f.descrIds));e.txt_descr.innerHTML=g,g=zB.ins.getDesc(parseInt(f.progressDescr)),e.box_progressDescr.innerHTML=mp.getFormat(g,[c-r+1])}else e.txt_descr.innerHTML="",e.box_progressDescr.innerHTML=""}},i.close=function(e){(void 0===e&&(e=!1),G.loader.clearRes(this.img_icon.skin,!0),tt.ins.clearTexture(this.img_icon.skin),G.loader.clearRes(this.img_title.skin,!0),tt.ins.clearTexture(this.img_title.skin),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return t._instance||(t._instance=new t),t._instance},layouts.nav.previewaward.PreviewRingPanelUI._$SET_instance),t._instance=null,t}(),hY=function(e){function t(){t.__super.call(this)}return b(t,"modules.newsiege.item.NewSiegeGuildItem",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){if(null!=e){this.txt_score.text=e.socre+"",this.txt_fight.text=e.power+"",this.txt_name.text=e.Name+" ["+Bl.getCNPos(e.guildCareer)+"]";var t=rn.getIndex(e.sceneId);this.txt_didian.changeText(rn.MODEL.name(t)),this.img_head.skin=_r.getActorHeadPath(e.pro,e.sex)}}),t}(Zd),_Y=function(e){function t(){this.suti=null,this._data=null,t.__super.call(this),this.initUI()}b(t,"modules.passsuit.views.PassSuitFenJieItem",MI);var i=t.prototype;return i.onClickFenjieListener=function(e){if(null!=this._data){var t=[this._data.uuId];OR.reqRecycleChuanShi(t)}},i.initUI=function(){this.suti=new rq,this.addChild(this.suti),this.suti.x=this.gridEequ.x,this.suti.y=this.gridEequ.y},p(0,i,"data",function(){return this._data},function(e){if(e){this._data=e,this.suti.position=parseInt(this._data.goodsId.toString().substr(-1,1))-1,this.suti.level=1,this.txt_has.text="拥有："+this._data.goodsNum,this.txt_getTools.text="",this.txt_get.text=RP.n[417],this.txt_name.text=this._data.name;var t=Bi.getIndex(this._data.goodsId),i=Bi.MODEL.recycleGoodsAward(t),n=parseInt(i.split(",")[0]);t=Bi.getIndex(n),this.txt_getTools.text=Bi.MODEL.name(t)+" X "+parseInt(i.split(",")[1]),this.btn_fenjie.on("click",this,this.onClickFenjieListener)}}),t}(),fY=function(e){function t(){var e=this;e.img_tools=null,e._iconId="",t.__super.call(e),e.centerX=e.centerY=0,e.img_tools=new Kl,e.addChild(e.img_tools),e.img_tools.x=e.img_skill.x+8,e.img_tools.y=e.img_skill.y+8,e.img_tools.width=100,e.img_tools.height=100}b(t,"modules.passsuit.views.PassSkillTips",OI);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(t.txt_desc.style.fontSize=24,t.txt_desc.style.leading=10,t.txt_desc.style.color="#90877b",e.limit?$f.instance.souloutVo.souloutGrade<parseInt(e.limit)?t.txt_openlimit.innerHTML=Ql.createColor(e.limit+"阶解锁","#ff2e24"):t.txt_openlimit.innerHTML=Ql.createColor("已解锁","#23b11f"):t.txt_openlimit.innerHTML="",null!=e){var i=Ls.getIndex(parseInt(e.lv));t._iconId=Ls.MODEL.icon(i),t.txt_Lv.text=Ls.MODEL.skillName(i),t.txt_desc.innerHTML=Ls.MODEL.skillDesc(i),t.img_tools.skin=_r.getIconPath(t._iconId)}t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.open(t,!1,!0))},i.close=function(e){void 0===e&&(e=!1),eq.panelLayer.close(this)},i.refresh=function(){this.img_tools.graphics.clear(),this._iconId&&NR.loadIcon(this._iconId,ql.create(this,this.drawIcon))},i.drawIcon=function(e){e&&this.img_tools.graphics.drawTexture(e,5,5,100,100)},i.onClick=function(e){e instanceof modules.passsuit.views.PassSkillTips&&this.close()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.passsuit._passSuitSkillTipsUI._$SET_instance),t._instance=null,t}(),pY=function(e){function t(){var e=this;e.passSuitData=null,e.img_tools=null,e._iconId="",e._color=6,e._equipAttr_pt_Txt=null,e._equipAttr_ts_Txt=null,e.effect=null,t.__super.call(e),e.centerX=e.centerY=0,e.panel_base.height=190,e.passSuitData=RN.ins,e.img_tools=new Kl,e.img_tools.pos(e.imgTool.x,e.imgTool.y),e.addChild(e.img_tools),e._equipAttr_pt_Txt=new Fl,e._equipAttr_pt_Txt.style.fontSize=24,e._equipAttr_pt_Txt.style.font="SimHei",e._equipAttr_pt_Txt.style.color="#90877b",e._equipAttr_pt_Txt.style.leading=18,e._equipAttr_pt_Txt.width=600,null==e._equipAttr_pt_Txt.parent&&e.panel_base.addChild(e._equipAttr_pt_Txt),e._equipAttr_pt_Txt.x=10,e._equipAttr_pt_Txt.y=10,e._equipAttr_ts_Txt=new Fl,e._equipAttr_ts_Txt.style.fontSize=24,e._equipAttr_ts_Txt.style.font="SimHei",e._equipAttr_ts_Txt.style.color="#e6d80d",e._equipAttr_ts_Txt.style.leading=18,e._equipAttr_ts_Txt.width=600,null==e._equipAttr_ts_Txt.parent&&e.panel_sp.addChild(e._equipAttr_ts_Txt),e._equipAttr_ts_Txt.x=10,e._equipAttr_ts_Txt.y=0}b(t,"modules.passsuit.views.PassSuitToolTip",My);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){if(null!=e){var t=[aa.ATTR_INC_RATE.id,aa.MAXHD.id,aa.CRI.id],i=parseInt(e.lv),n=parseInt(e.ps);Ms.count<=0||As.count<=0?HP.loadConfig(["ConfigChuanshi","ConfigChuanshiSuit"],["ConfigChuanshi","ConfigChuanshiSuit"],ql.create(this,this.onConfigLoaded,[n,i,t])):this.onOK(n,i,t)}},i.onConfigLoaded=function(e,t,i){this.onOK(e,t,i)},i.onOK=function(e,t,i){var n=this,s=n.passSuitData.getKeyByPositionAndLv(e,t);n.txt_ToolName.text=Ms.MODEL.name(s),n.txt_ToolName.color="#fff000",n.txt_type.changeText("传世"),n.txt_part.changeText(n.passSuitData.getNameByPositionAndLv(e)),n._iconId=Ms.MODEL.icon(s),n.refresh();var o=Ms.MODEL.attrs(s);n.txt_zs.changeText("3转");for(var a=aa.formatAttrToChineseByList(o),r=[],l=[],c="",u=0;u<a.length;u++)-1!=i.indexOf(a[u].id)?l.push(a[u]):r.push(a[u]);var d={};for(u=0;u<r.length;u++)c+=(d=r[u]).addName+": "+d.val+"<br/>";for(n._equipAttr_pt_Txt.innerHTML=c,c="",u=0;u<l.length;u++)c+=(d=l[u]).addName+": "+d.val+"<br/>";n._equipAttr_ts_Txt.innerHTML=c,n.fightNum.value=RR.getFight(r),n.txt_pingfen.changeText("评分："+RR.getFight(r));var h=0;if(0==e||1==e){n.img_skill.width=65,n.img_skill.height=65,n.txt_skillDesc.style.fontSize=24,n.txt_skillDesc.style.leading=10,n.txt_skillDesc.style.color="#90877b",0==e?h=RN.ins.getIndexBySuitTypeAndLv(1,t):1==e&&(h=RN.ins.getIndexBySuitTypeAndLv(2,t));var _=As.MODEL.skillEffectId(h),f=Ls.getIndex(parseInt(_));n.img_skill.skin=_r.getIconPath(Ls.MODEL.icon(f)),n.txt_skillName.text=Ls.MODEL.skillName(f),n.txt_skillName.color="#c1240e";var p=Ls.MODEL.skillDesc(f);""==p?0==e?n.txt_skillDesc.innerHTML=RP.n[418]:1==e&&(n.txt_skillDesc.innerHTML=RP.n[419]):n.txt_skillDesc.innerHTML=p,n.box_skill.visible=!0,n.txt_desc.y=983,n.height=1020}else n.box_skill.visible=!1,n.txt_desc.y=760,n.height=800;n.parent||(eq.panelLayer.once("MASK_CLOSE",n,n.onClick),eq.panelLayer.openTip(n))},i.onClick=function(e){this.close(!0)},i.close=function(e){var t=this;(void 0===e&&(e=!1),t.effect&&(t.effect.parent&&t.effect.parent.removeChild(t.effect),t.effect.dispose(),t.effect=null),e)?!eq.panelLayer.closeTip(t)&&eq.panelLayer.close(t):eq.panelLayer.close(t);eq.panelLayer.off("MASK_CLOSE",t,t.onClick)},i.refresh=function(){var e=this;if(e.img_tools.graphics.clear(),e.graphics.clear(),0<e._color){var t=NI.gridBg(e._color),i=G.loader.getRes(t);i&&e.img_tools.graphics.drawTexture(i,0,0,106,106),e._iconId&&((i=NR.getIcon(e._iconId))&&null!=i.bitmap?e.drawIcon(i):NR.loadIcon(e._iconId,ql.create(e,e.drawIcon)))}null==e.effect&&(e.effect=kB.createEffect("jm1226",e.imgTool.x+52,e.imgTool.y+52,e))},i.drawIcon=function(e){e&&this.img_tools.graphics.drawTexture(e,3,3,100,100)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.passsuit._PassEquipToolTipUI._$SET_instance),t._instance=null,t}(),gY=function(e){function t(){var e=this;e.passSuitData=null,e._equipName=["[武器","衣服","护腕","戒指","头盔","项链","腰带","靴子]"],e._equipName_c_Txt=null,e._equipAttr_c_Txt=null,e._equipName_n_Txt=null,e._equipAttr_n_Txt=null,e.effect_c=null,e.effect_n=null,e._data=null,t.__super.call(e),e.passSuitData=RN.ins,e.centerX=e.centerY=0}b(t,"modules.passsuit.views.PassSuitNewTips",PI);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(t._equipName_c_Txt&&(t._equipName_c_Txt.innerHTML=""),t._equipAttr_c_Txt&&(t._equipAttr_c_Txt.innerHTML=""),t._equipName_n_Txt&&(t._equipName_n_Txt.innerHTML=""),t._equipAttr_n_Txt&&(t._equipAttr_n_Txt.innerHTML=""),null!=e){var i,n=(t._data=e).level;e.list;0==n?(t.txt_csuitname.changeText(RP.n[420]),t.panel_c_info.refresh(),i=t.passSuitData.getCurSuitPro(3,0),t.showNextInfo(1,i)):(i=t.passSuitData.getCurSuitPro(3,n),t.showCurrentInfo(n,i),n<4?t.showNextInfo(n+1,i):t.txt_nsuitname.changeText(RP.n[421])),t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.open(t,!1,!0))}},i.close=function(e){var t=this;void 0===e&&(e=!1),t.effect_n&&(t.effect_n.parent&&t.effect_n.parent.removeChild(t.effect_n),t.effect_n.dispose(),t.effect_n=null),t.effect_c&&(t.effect_c.parent&&t.effect_c.parent.removeChild(t.effect_c),t.effect_c.dispose(),t.effect_c=null),eq.panelLayer.close(t)},i.showNextInfo=function(e,t){for(var i=this,n="",s=0,o=0;o<i._data.list.length;o++)i._data.list[o]>=e&&s++,i._data.list[o]>=e?n+="<font style='color:#23b11f;'>"+i._equipName[o]+"</font>&nbsp;":n+="<font style='color:#90877b;'>"+i._equipName[o]+"</font>&nbsp;";null==i._equipName_n_Txt&&(i._equipName_n_Txt=new Fl,i._equipName_n_Txt.style.fontSize=24,i._equipName_n_Txt.style.font="SimHei"),null==i._equipName_n_Txt.parent&&i.panel_n_info.addChild(i._equipName_n_Txt),i._equipName_n_Txt.x=0,i._equipName_n_Txt.y=0,i._equipName_n_Txt.width=690,i._equipName_n_Txt.innerHTML=n,i.txt_nsuitname.changeText(t.nextName+"("+s+"/8)"),null==i._equipAttr_n_Txt&&(i._equipAttr_n_Txt=new Fl,i._equipAttr_n_Txt.style.fontSize=24,i._equipAttr_n_Txt.style.font="SimHei",i._equipAttr_n_Txt.style.color="#e0d6c1",i._equipAttr_n_Txt.style.leading=15,i._equipAttr_n_Txt.width=600),null==i._equipAttr_n_Txt.parent&&i.panel_n_info.addChild(i._equipAttr_n_Txt),i._equipAttr_n_Txt.x=5,i._equipAttr_n_Txt.y=50,n="";var a=aa.formatAttrToChineseByList(t.next),r={};for(o=0;o<a.length;o++)r=a[o],n+=4==o||5==o?"<font style='color:#23b11f;'>"+r.name+": "+r.val+"</font><br/>":6==o?"<font style='color:#a93aff;'>"+r.name+": "+r.val+"</font><br/>":r.name+": "+r.val+"<br/>";i._equipAttr_n_Txt.innerHTML=n,null==i.effect_n&&(i.effect_n=kB.createEffect(t.nEffct,360,200,i.panel_n_info),i.effect_n.scaleX=i.effect_n.scaleY=2),i.panel_n_info.refresh()},i.showCurrentInfo=function(e,t){for(var i=this,n="",s=0,o=0;o<i._data.list.length;o++)0<i._data.list[o]&&s++,i._data.list[o]>=e?n+="<font style='color:#00ff00;'>"+i._equipName[o]+"</font>&nbsp;":n+="<font style='color:#eecda0;'>"+i._equipName[o]+"</font>&nbsp;";null==i._equipName_c_Txt&&(i._equipName_c_Txt=new Fl,i._equipName_c_Txt.style.fontSize=24,i._equipName_c_Txt.style.font="SimHei"),null==i._equipName_c_Txt.parent&&i.panel_c_info.addChild(i._equipName_c_Txt),i._equipName_c_Txt.x=0,i._equipName_c_Txt.y=0,i._equipName_c_Txt.width=690,i._equipName_c_Txt.innerHTML=n+"",i.txt_csuitname.changeText(t.curName+"("+s+"/8)"),null==i._equipAttr_c_Txt&&(i._equipAttr_c_Txt=new Fl,i._equipAttr_c_Txt.style.fontSize=24,i._equipAttr_c_Txt.style.font="SimHei",i._equipAttr_c_Txt.style.color="#e0d6c1",i._equipAttr_c_Txt.style.leading=12,i._equipAttr_c_Txt.width=600),null==i._equipAttr_c_Txt.parent&&i.panel_c_info.addChild(i._equipAttr_c_Txt),i._equipAttr_c_Txt.x=5,i._equipAttr_c_Txt.y=55,n="";var a,r=aa.formatAttrToChineseByList(t.cur);for(o=0;o<r.length;o++)a=r[o],n+=4==o||5==o?"<font style='color:#23b11f;'>"+a.name+": "+a.val+"</font><br/>":6==o?"<font style='color:#a93aff;'>"+a.name+": "+a.val+"</font><br/>":a.name+": "+a.val+"<br/>";i._equipAttr_c_Txt.innerHTML=n,null==i.effect_c&&(i.effect_c=kB.createEffect(t.cEffct,360,200,i.panel_c_info),i.effect_c.scaleX=i.effect_c.scaleY=1.5),i.panel_c_info.refresh()},i.onClick=function(e){e instanceof modules.passsuit.views.PassSuitNewTips&&this.close()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.passsuit._passSuitTipsUI._$SET_instance),t._instance=null,t}(),vY=function(e){function t(){var e=this;e._leftTime=0,e._BARWIDTH=0,e._allTime=0,e._eff=null,t.__super.call(e),e.top=428,e._allTime=modules.pet.others.PetDataModel.ins().petBirthtime,e._BARWIDTH=e.imgBar.width,e.imgBar.mask=e.imgMask,e.imgMask.x=0}b(t,"modules.pet.views.NavPetBirth",Fd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.notice=function(e){e&&("updateNavUI"==e.actionOrder?this.updatePos(e.proto.isShow):"updateNavUI2"==e.actionOrder&&(this.top=e.proto.topValue-87))},i.updatePos=function(e){this.top=e?sJ.ins.isOpen("NavLuckDrop")?254:341:sJ.ins.isOpen("NavLuckDrop")?341:428,qH.Ins().addNoClears("jm1375")},i.show=function(){var e=this;if(e.on("click",e,e.onClick),e._leftTime=modules.pet.others.PetDataModel.ins().petLeftTime-pt.now(),e._leftTime<=0)return modules.pet.others.PetDataModel.ins().setPetLeader2(),sJ.ins.hideCompoment("NavPetBirth"),void G.timer.loop(100,e,e.checkRemove);e.dtime.text=MZ.simpleFormat(e._leftTime/10),G.timer.clearAll(e),G.timer.loop(10,e,e.onLoop),G.timer.loop(2e3,e,e.createEff),sJ.ins.isOpen("NavFirstPayTime")?e.top=sJ.ins.isOpen("NavLuckDrop")?254:341:e.top=sJ.ins.isOpen("NavLuckDrop")?341:428},i.checkRemove=function(){this.parent&&(G.timer.clearAll(this),this.removeSelf())},i.onLoop=function(){this._leftTime-=10,this._leftTime<=0&&(G.timer.clearAll(this),modules.pet.others.PetDataModel.ins().setPetLeader2(),this.removeSelf()),this.dtime.text=MZ.simpleFormat(this._leftTime/10),this.updateBar()},i.updateBar=function(){var e=this._leftTime/this._allTime*this._BARWIDTH;Og.to(this.imgMask,{x:e-this._BARWIDTH},5,null,ql.create(this,this.barEnd))},i.barEnd=function(){Og.clearAll(this.imgMask)},i.hide=function(){var e=this;G.timer.clearAll(e),e.off("click",e,e.onClick),G.timer.clear(e,e.createEff),e._eff&&(e._eff.parent&&e._eff.parent.removeChild(e._eff),e._eff&&e._eff.dispose(),e._eff=null,qH.Ins().removeNoClears("jm1375"))},i.createEff=function(){this._eff&&this._eff.dispose(),this._eff=null,this._eff=kB.createEffect("jm1375",5,this.height/2,this),this._eff.scale_X=2.16,this._eff.scale_Y=1.15},i.onClick=function(e){modules.pet.views.PetBirthingTip.ins.show(this._leftTime)},i.clearList=function(){},p(0,i,"name",function(){return"NavPetBirth"}),t.NAME="NavPetBirth",t}(),mY=function(e){function t(){this._title1=null,t.__super.call(this),this.on("click",this,this.onClick),this._title1=kB.createImage(null,530,-6,0,0,this)}b(t,"modules.rank.views.RankItem",e);var i=t.prototype;return i.onClick=function(e){this.dataSource&&nR.reqViewOther(this.dataSource.id)},i.destroy=function(e){void 0===e&&(e=!0),this._title1&&this._title1.skin&&(this._title1.destroy(),this._title1.dispose(),this._title1=null),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.v_v.visible=!1;var i="";if(G.superSet(a_,t,"dataSource",e),null!=e&&null!=e){var n=e.r,s="",o="";switch(n){case 1:i=_r.getAtlasSubPath("base_ui2/phb_db_no1.png"),s=_r.getAtlasSubPath("base_ui2/phb_dj_1.png"),o="#f7efcf";break;case 2:i=_r.getAtlasSubPath("base_ui2/phb_db_no2.png"),s=_r.getAtlasSubPath("base_ui2/phb_dj_2.png"),o="#f0d1a4";break;case 3:i=_r.getAtlasSubPath("base_ui2/phb_db_no3.png"),s=_r.getAtlasSubPath("base_ui2/phb_dj_3.png"),o="#c5a386";break;default:i=_r.getAtlasSubPath("basic_ui_3/ty_btn_lb_2.png"),o="#90877b"}t.bg.skin=i,t.icon.skin=s,""!=o&&(t.txt_name.color=o),t.txt_val.color=o,t.txt_rank.text=3<e.r?e.r+"":"",t.txt_name.text=e.n,0<e.vip?t.v_v.visible=!0:t.v_v.visible=!1;var a="",r=o_.ins.type;switch(r){case 1:var l=e.lv+"级";0==e.fv?t.txt_val.text=l:t.txt_val.text=e.fv+"转"+l;break;case 2:1==n?0==e.fv?t.txt_val.text=e.lv+"级":t.txt_val.text=e.fv+"转"+e.lv+"级":t.txt_val.text="";break;case 7:t.txt_val.text="杀意："+mp.getBigIntStr(e.v);break;case 11:t.txt_val.text="";var c=Sn.getIndex(e.v);t._title1.skin=_r.getPrestigePath(Sn.MODEL.picName(c));break;case 10:t.txt_val.text=RP.n[422]+mp.getBigIntStr(e.v);break;case 12:a=mn.MODEL.positionName(e.v),t.txt_val.text=a;break;case 13:a=zs.MODEL.name(e.v),t.txt_val.text=a;break;case 18:t.txt_val.text=RP.n[423]+mp.getBigIntStr(e.v);break;case 17:var u=99999<e.v?Math.floor(e.v/1e4)+"万":e.v;t.txt_val.text="战力："+u}var d,h=Cn.getIndex(r);11==r?(t._title1.x=320,t._title1.y=3,t._title1.scale(.8,.8)):n<=10&&2<=n?(t._title1.x=330,t._title1.y=-3,d=Cn.MODEL.otherT(h),t._title1.skin=d?_r.getTitlePath(d):null):t._title1.skin=null}}),t}(a_),yY=function(e){function t(){this.g0=null,this.g1=null,this._mng=null,this._info=null,t.__super.call(this),this._mng=HN.ins,this.initUI()}b(t,"modules.recharge.views.BaiYuanHaoLiItem",Ke);var i=t.prototype;return i.update=function(e){var t=this;if(e&&(1==e.day?t.txt_day.text=RP.n[424]:2==e.day?t.txt_day.text=RP.n[425]:3==e.day&&(t.txt_day.text=RP.n[426]),t._info=e,t.btn_get.visible=t.txt_get.visible=t.img_ylq.visible=!1,!t.g0&&!t.g1))for(var i=e.award.split(";"),n=0;n<i.length;n++){var s=i[n].split(",")[0],o=i[n].split(",")[1];t["g"+n]=new MF,t["g"+n].needEffect=!0,t["g"+n].bindData=yB.create(s,o),t["g"+n].pos(t["img_"+n].x,t["img_"+n].y);var a=Bi.getIndex(s);t.addChild(t["g"+n]),t["txt_"+n].text=Bi.MODEL.simpleName(a),t["txt_"+n].color=ms.getByQuality(Bi.MODEL.colourId(a))}e.logInDay>=e.day?0==e.state?t.btn_get.visible=!0:1==e.state&&(t.img_ylq.visible=!0):(1==e.day?t.txt_get.text=RP.n[427]:2==e.day?t.txt_get.text=RP.n[428]:3==e.day&&(t.txt_get.text=RP.n[429]),t.txt_get.visible=!0)},i.ondisponse=function(){var e=this;e.g0&&e.g0.parent&&(e.g0.parent.removeChild(e.g0),e.g0=null),e.g1&&e.g1.parent&&(e.g1.parent.removeChild(e.g1),e.g1=null),e.parent&&e.parent.removeChild(e)},i.initUI=function(){this.btn_get.clickHandler=ql.create(this,this.onGet,null)},i.onGet=function(){var e=new yP;e.day=this._info.day,Tu.sendToService(e)},t}(),IY=function(e){function t(){var e=this;t.__super.call(e),e.list.selectEnable=!0,e.list.itemRender=bY,e.list.hScrollBarSkin="",e.list.selectHandler=ql.create(e,e.onSelect,null,!1),e.btnNext.on("click",e,e.onClick),e.btnPrev.on("click",e,e.onClick),e.list.array=[{type:14,index:0,eff:"dljl_img_bg.jpg"},{type:10307,index:1,eff:"dljl_img_bg.jpg"},{type:8,index:2,eff:"dljl_img_bg.jpg"},{type:2014,index:3,eff:"dljl_img_bg.jpg"},{type:10308,index:4,eff:"dljl_img_bg.jpg"},{type:8,index:5,eff:"dljl_img_bg.jpg"},{type:10407,index:6,eff:"dljl_img_bg.jpg"},{type:60102,index:7,eff:"dljl_img_bg.jpg"},{type:14,index:8,eff:"dljl_img_bg.jpg"},{type:2014,index:9,eff:"dljl_img_bg.jpg"},{type:10309,index:10,eff:"dljl_img_bg.jpg"},{type:14,index:11,eff:"dljl_img_bg.jpg"},{type:2014,index:12,eff:"dljl_img_bg.jpg"},{type:60103,index:13,eff:"dljl_img_bg.jpg",over:!0}]}b(t,"modules.seven.views.SevenBoxBar",nf);var i=t.prototype;return i.setup=function(){var e=$N.ins.signinData;if(e){for(var t=0,i=e.gifts?e.gifts.length:0,n=0;n<i;n++){var s=e.gifts[n];if((2==s.status||1==s.status)&&(t=n,1==s.status))break}this.list.refresh(),this.list.selectedIndex!=t?(this.list.selectedIndex=t,this.list.tweenTo(t,400)):this.onSelect(t)}},i.onClick=function(e){var t=this.list.selectedIndex;e.target==this.btnNext?t<this.list.length-1&&t++:e.target==this.btnPrev&&0<t&&t--,t!=this.list.selectedIndex&&(this.list.selectedIndex=t,this.list.tweenTo(t,200))},i.onSelect=function(e){for(var t in this.list.cells)this.list.cells[t].selectIndex=e;this.event("select")},p(0,i,"selectedItem",function(){return this.list.selectedItem}),p(0,i,"selectIndex",function(){return this.list.selectedIndex}),t}(),bY=function(e){function t(){this._index=0,t.__super.call(this)}b(t,"modules.seven.views.SevenBoxItem",e);var i=t.prototype;return i.changeSelect=function(){var e=this.dataSource;null!=e&&0==this.imgSelected.visible&&(e.index==this._index?this.imgSelected.visible=!0:this.imgSelected.visible=!1)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(sf,t,"dataSource",e),null!=e&&null!=e){var i=$N.ins.signinData;if(i){t.imgSelected.visible=!1;var n=$N.ins.signinDays,s=e.index<n?i.gifts[e.index]:null,o=s&&2==s.status,a=new MF(74);a.x=0,a.y=0,t.imgIcon.addChild(a),a.mouseEnabled=!1,a.needEffect=!1;var r=yB.create(e.type,1);a.bindData=r,t.txtName.changeText(Bi.MODEL.name(r.cfgIdx)),t.txtName.color=ms.getByQuality(Bi.MODEL.colourId(r.cfgIdx)),t.bar_bg1.visible=0<e.index,t.bar_bg2.visible=!e.over,t.bar_ov1.visible=0<e.index&&e.index<n,t.bar_ov2.visible=!e.over&&e.index+1<n,t.txt_day.changeText("第"+mp.getChineseNum(e.index+1)+"天"),t.mc_flag.visible=o,t.changeSelect(),a.isClearUrl=!0}}}),p(0,i,"selectIndex",null,function(e){this._index=e,this.changeSelect()}),t}(sf),wY=function(e){function t(){var e=this;e._type=0,e._grid=null,e._dtoGoods=null,e._exchangeType=0,e._canExchange=!1,e._enpughGold=!1,e._handEff=null,e._modelData=null,t.__super.call(e),e._modelData=nB.ins}b(t,"modules.skill.views.item.SeaAirGetExpItem",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF,this._grid.x=14,this._grid.y=12,this.addChild(this._grid),this.btn_exchange.on("click",this,this.onClick)},i.setBtnGray=function(e){this.btn_exchange.gray=e,this.btn_exchange.mouseEnabled=!e},i.showRedPoint=function(){var e=this._modelData.checkCanSeaAirExchange(this._type,gR.ins.currentSelectRoleIndex);this.btn_exchange.showTip=e},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0),this._grid=null,this._dtoGoods=null,this.btn_exchange.off("click",this,this.onClick)},i.onClick=function(e){var t=this;if(t._enpughGold){var i=gR.ins.currentSelectRoleIndex,n=TR.ins.getGoodsDto(nB.PROP_IDS[t._type]);!n||1!=t._exchangeType&&2!=t._exchangeType&&4!=t._exchangeType?0==t._exchangeType?null==CN.getIconBtn(66)?zB.ins.showMsg(RP.n[430],1):Tu.sendToModule("CROSSBATTLREQDATA",["modules.corssbattle.CrossBattleModule"]):3!=t._exchangeType&&5!=t._exchangeType||t._modelData.buyMallGood(t._modelData.seaAirGetShopIndex(nB.PROP_IDS[t._type],2),1,i+1):t._modelData.useSoulTools(i+1,n.uuId),t._modelData.tooldsId=nB.PROP_IDS[t._type]}else KQ.ins.showNoGold()},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(rr,t,"dataSource",e),t._type=parseInt(e);var i="",n=Bi.getIndex(nB.PROP_IDS[t._type]),s=Bi.MODEL.roleUseLimitOfDay(n);i=Bi.MODEL.eventArgs(n);var o=gR.ins.currentSelectRoleIndex,a=0;t._modelData.seaAirRemainTime&&t._modelData.seaAirRemainTime.has(nB.PROP_IDS[t._type])&&(a=t._modelData.seaAirRemainTime.take(nB.PROP_IDS[t._type])[o]);a<s?(t.txt_des4.innerHTML=RP.n[431]+Ql.createColor(s-a+"","#23b11f")+"次",t.setBtnGray(!1)):(t.txt_des4.innerHTML=RP.n[432]+Ql.createColor("0","#ff2e24")+"次",t.setBtnGray(!0));var r,l;t._enpughGold=!0,r=nB.PROP_IDS[t._type],l=t._modelData.seaAirGetPrice(r),t._dtoGoods=yB.create(r),t._grid.bindData=t._dtoGoods,i&&-1!=i.indexOf(".")&&(i=i.slice(0,-2)),t.txt_des1.innerHTML="增加"+Ql.createColor(i,"#23b11f")+"魂力",t.txt_des5.text="",t.btn_exchange.visible=!0,t._canExchange=!0;var c=TR.ins.getGoodsNum(r);0<t._type?(n=Bi.getIndex(r),0<c?(t.btn_exchange.label="兑 换",t._exchangeType=1==t._type?2:4,t.img_gold.visible=!1,t.txt_des2.text="剩余"+c+"个",t.txt_des2.color="#23b11f",t.txt_des3.text=""):(t.btn_exchange.label=RP.n[279],t._exchangeType=1==t._type?3:5,t.img_gold.visible=!0,t.txt_des2.text=Bi.MODEL.name(n),t.txt_des2.color="#e3dcc2",t.txt_des3.text=l+"",gR.ins.YB<l&&(t._enpughGold=!1))):(0<c?(t.btn_exchange.label="兑 换",t._exchangeType=1,t.txt_des2.text="剩余"+c+"个"):(t.btn_exchange.label=RP.n[434],t.txt_des2.text=Bi.MODEL.name(n),t._exchangeType=0),t.img_gold.visible=!1,n=Bi.getIndex(nB.PROP_IDS[t._type]),t.txt_des3.text=""),t.showRedPoint()}),t}(rr),xY=function(t){function e(){this._grid=null,this.mijiId=0,this._isLearn=!1,this._isChangeGray=!1,this._gray=!1,e.__super.call(this)}b(e,"modules.skill.views.item.MijiInfoRender",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new HF,e._grid.x=e.img_grid.x,e._grid.y=e.img_grid.y,e.img_grid.visible=!1,e.addChildAt(e._grid,1),e.img_select.visible=!1},i.update=function(){var e=Bi.getIndex(this.mijiId);this.txt_name.text=Bi.MODEL.name(e),this._grid.bindData=this.mijiId},i.setGrad=function(e,t){},i.setSelectBg=function(e){this.img_select.visible=!!e},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){if(G.superSet(Mu,this,"dataSource",e),this.mijiId=0,e){var t=e.mijiDto;this.mijiId=t.miji_id,this.isLearn=e.isLearn,e.needTips||(this._grid.toolTipEnabled=e.needTips),e.isShow&&(this._grid.isShow=e.isShow),this.update()}}),p(0,i,"isChangeGray",function(){return this._isChangeGray},function(e){this._isChangeGray=e,this.setGrad(e,this._grid)}),p(0,i,"isLearn",function(){return this._isLearn},function(e){this._isLearn=e,this.txt_tag.visible=!!e,this.isChangeGray||this.setGrad(e,this._grid)}),e}(Mu),SY=(function(t){function e(){this._grid=null,this.holdId=1,this.roleIndex=1,this.isLock=!1,this.dtoMiji=null,e.__super.call(this)}b(e,"modules.skill.views.item.MijiItemRender",t);var i=e.prototype;i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF,e._grid.x=e.img_grid.x,e._grid.y=e.img_grid.y,e._grid.needGridBg=!1,e._grid.mouseEnabled=!1,e.addChildAt(e._grid,6),e.img_select.visible=!1,e.img_arrow.visible=!1,e.txt_addValue.text="",e.txt_canUp.visible=!1,e.txt_addValue.mouseEnabled=!1,e.img_plus.on("click",e,e.onClickPlus)},i.update=function(){var e=this,t=gR.ins.VIPLevel,i=gR.ins.zsLv,n=an.getIndex(e.holdId),s=an.MODEL.vipLevel(n),o=an.MODEL.playerLevel(n);if(e.isLock=!0,e.dtoMiji=null,e.img_plus.visible=!1,s<=t||o<=i)if(e.isLock=!1,e.txt_desc.color="#65533a",e.dtoMiji=iB.ins.getMijiDto(e.roleIndex,e.holdId),e.dtoMiji){var a=Bi.getIndex(e.dtoMiji.miji_id);e.txt_name.text=Bi.MODEL.name(a),e.txt_desc.text="LV."+e.dtoMiji.cur_lvl;var r=yB.create(e.dtoMiji.miji_id);e._grid.bindData=r}else e.txt_name.text="",e.txt_desc.text="未学习",e._grid.bindData=null,e.img_plus.visible=!0;else e.txt_name.text="",e.txt_desc.text=o+"转或VIP"+s,e.txt_desc.color="#e70909",e._grid.bindData=null;e.img_lock.visible=e.isLock},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0)},i.setSelectBg=function(e){e?(this.img_select.visible=!0,this.img_arrow.visible=!0):(this.img_select.visible=!1,this.img_arrow.visible=!1)},i.showUpgradeEff=function(){var e=mj.GetNew();e.pos(this.img_grid.x+this.img_grid.width/2,this.img_grid.y+this.img_grid.height/2),e.renderInSelf=!0,e.loadEffect("jm01011"),this.addChild(e)},i.onClickPlus=function(e){Tu.sendToModule("MIJILEARN_OPEN",["modules.skill.SkillModule"],this.roleIndex)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){G.superSet(cf,this,"dataSource",e),e&&(this.holdId=parseInt(e.holdIndex),this.roleIndex=parseInt(e.roleIndex),this.update())})}(cf),function(t){function e(){this._grid=null,this._skillId=0,this._tw=null,e.__super.call(this)}b(e,"modules.skill.views.item.SkillItemRender",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new GF,e.addChildAt(e._grid,6),e.img_select.visible=!1,e.img_arrow.visible=!1,e.txt_addValue.text="",e.txt_canUp.visible=!1,e.txt_addValue.y=60,e.txt_addValue.mouseEnabled=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0)},i.setSelectBg=function(e){e?(this.img_select.visible=!0,this.img_arrow.visible=!0):(this.img_select.visible=!1,this.img_arrow.visible=!1)},i.showUpgradeEff=function(e,t){var i=this;if(e!=t){i.txt_addValue.y=60,i.txt_addValue.alpha=1,i.txt_addValue.text=i.getUpgradeDesc(e,t),i._tw=Og.to(i.txt_addValue,{y:0,alpha:0},500,pa.sineIn,ql.create(i,i.onComplete),0,!1,!1);var n=mj.GetNew();n.pos(i.img_grid.x+i.img_grid.width/2,i.img_grid.y+i.img_grid.height/2),n.renderInSelf=!0,n.loadEffect("jm01011"),i.addChild(n)}},i.onComplete=function(){this.txt_addValue.text="",this.txt_addValue.y=60,this.txt_addValue.alpha=1,this._tw&&this._tw.clear(),this._tw=null},i.getUpgradeDesc=function(e,t){var i=Vn.getIndex(this.skillId),n=Vn.MODEL.desc2(i),s=Vn.MODEL.damageFactor(i),o=Vn.MODEL.fixedDamage(i),a=Vn.MODEL.para1(i),r=Vn.MODEL.para2(i),l=s[e-1],c=o[e-1],u=a[e-1],d=r[e-1],h=(s[t-1]-l)/100,_=o[t-1]-c,f=(a[t-1]-u)/100,p=r[t-1]-d;return mp.getFormat(n,[h,_,f,p])},p(0,i,"skillId",function(){return this._skillId},function(e){this._skillId=e}),p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;G.superSet(cf,t,"dataSource",e);var i=e;if(i){t.skillId=i.skill_id;var n=Vn.getIndex(i.skill_id);t._grid.bindData=i.skill_id,t._grid.x=t.img_grid.x+(t.img_grid.width-t._grid.width>>1),t._grid.y=t.img_grid.y+(t.img_grid.height-t._grid.height>>1);var s=Vn.MODEL.name(n);if(t.txt_name.text=s,t._grid.filters=null,0<i.cur_lvl)t.txt_desc.text="LV."+i.cur_lvl,t.txt_desc.color="#90877b",t.txt_canUp.visible=IH.ins.canUpgrade(i);else{var o=Vn.MODEL.learnLevel(n);t.txt_desc.text="LV."+o+"级开启",t.txt_desc.color="#e70909",Pg.gray(t._grid,!0)}}else t._grid.bindData=null}),e}(cf)),kY=function(e){function t(){this.grid=null,this._data=null,t.__super.call(this),this.initUI()}b(t,"modules.skill.views.talent.TalenttFenJieItem",Dp);var i=t.prototype;return i.onClickFenjieListener=function(e){if(null!=this._data){var t=[this._data.uuId];OR.reqRecycleChuanShi(t)}},i.initUI=function(){this.grid=new MF,this.addChild(this.grid),this.grid.x=this.gridEequ.x,this.grid.y=this.gridEequ.y},p(0,i,"data",function(){return this._data},function(e){if(e){this._data=e,this.grid.bindData=this._data,this.txt_name.text=this._data.name;var t=Bi.getIndex(this._data.goodsId),i=Bi.MODEL.recycleGoodsAward(t),n=parseInt(i.split(",")[0]);t=Bi.getIndex(n),this.txt_getTools.text=Bi.MODEL.name(t)+" X "+parseInt(i.split(",")[1]),this.btn_fenjie.on("click",this,this.onClickFenjieListener)}}),t}(),EY=function(e){function t(){var e=this;e._type=0,e._pos=0,e._skillGrid=null,e._gridRes=null,e._isTalent=!1,e._info=null,e._costId=0,e._canUp=!1,t.__super.call(e),e._gridRes=new MF(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.htmlCost.x-47,e._gridRes.y=e.htmlCost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes)}b(t,"modules.soul.views.soulskin.SoulSkinSkillAlert",jf);var i=t.prototype;return i.show=function(e){var t=this;if(e){t.imgMax.visible=!1,t._info=e.info,t._skillGrid||(t._skillGrid=new bK,t._skillGrid.y=80,t._skillGrid.centerX=0,t.addChild(t._skillGrid)),t._skillGrid.update(t._info,99999,!1);var i=Ls.getIndex(t._info.skillId),n=Ls.MODEL.skillDesc(i);t.crtDescr.innerHTML=n;var s=Ls.MODEL.skillName(i);if(t.lab_title.text=s,t._isTalent=e.isTalent,e.isTalent)if(0==e.curLevel)t.txtCurLevel.text=RP.n[435],t.txtCurLevel.color="#e41b00",t.nextBox.visible=!1,t.boxConsume.visible=!1,t.height=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y+80;else{t.txtCurLevel.text=RP.n[436],t.txtCurLevel.color="#e0d6c1";var o=e.skillInfo[t._info.pos].level,a=e.type+"_"+t._info.pos+"_"+(o+1),r=jn.getIndex(a);if(0<=(r=jn.getIndex(a))){var l=jn.MODEL.consumeDef(r),c=JSON.parse(l)[0].value.split(":"),u=parseInt(c[0]),d=parseInt(c[1]),h=TR.ins.getGoodsNum(u);t._gridRes.bindData=yB.create(u),t._costId=u,d<=h?(t._canUp=!0,t.htmlCost.innerHTML=Ql.createColor(h+"","#23b11f")+"/"+d,t.btnUp.showTip=!0):(t._canUp=!1,t.htmlCost.innerHTML=Ql.createColor(h+"","#ff2e24")+"/"+d,t.btnUp.showTip=!1),t.nextBox.visible=!0,t.nextBox.y=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y;var _=jn.MODEL.buffId(r),f=Ls.getIndex(_),p=Ls.MODEL.skillDesc(f);t.nextDescr.innerHTML=p,t._type=e.type,t._pos=t._info.pos,t.boxConsume.visible=!0,t.on("click",t,t.onClickUp),t.height=t.crtDescr.contextHeight+t.crtBox.y+t.crtDescr.y+t.nextDescr.y+t.nextDescr.contextHeight+210,t.img_line.y=29,t._gridRes.visible=!0}else t._gridRes.visible=!1,t.nextBox.visible=!1,t.boxConsume.visible=!1,t.height=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y+80,t.img_line.y=115,t.imgMax.visible=!0}else e.curLevel<t._info.lockLevel?(t.txtCurLevel.text=oB.ins.getStepByLevel(t._info.lockLevel,e.type)+"阶解锁",t.txtCurLevel.color="#e41b00"):(t.txtCurLevel.text="已激活",t.txtCurLevel.color="#e0d6c1"),t.boxConsume.visible=!1,t.nextBox.visible=!1,t._gridRes.visible=!1,t.height=t.crtDescr.contextHeight+10+t.crtBox.y+t.crtDescr.y+80;t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))}},i.onClickUp=function(e){switch(e.target){case this.btnUp:if(!this._canUp)return void hN.ins.open("SoulSkinGoodsTip",this._costId);var t=new sP;t.type=this._type,t.pos=this._pos,Tu.sendToService(t)}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);this.off("click",this,this.onClickUp),eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.soulout.soulskin.SoulSkinSkillAlertUI._$SET_ins),t._ins=null,t}(),TY=function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.specialgodring.view.tips.SpecialGodRingAttrTips",cp);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){this.setBaseAttr(e)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},i.setBaseAttr=function(e){null!=e&&(this.txthp.text="生命："+e.hp,this.txtatk.text="攻击："+e.atk,this.txtdef.text="物防："+e.def,this.txtmdef.text="魔防："+e.mdef),this.txtdesc.text=RP.n[437],this.parent||(eq.panelLayer.once("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.onClick=function(e){this.close(!0)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.specialgodring.SpecialGodRingAttrTipsUI._$SET_instance),t._instance=null,t}(),CY=function(e){function t(){var e=this;e.chipIdIndex=0,e.effect=null,e._desc=null,t.__super.call(e),e.centerX=0,e.centerY=0,e._desc=kB.createHtmlDiv(e.txtDesc.x,e.box_desc.y+20,e.txtDesc.fontSize,e.txtDesc.color,e.txtDesc.width,e.txtDesc.height),e._desc.style.leading=15,e._desc.style.font="SimHei",e._desc.style.fontSize=24,kB.replace(e.txtDesc,e._desc)}b(t,"modules.specialgodring.view.tips.SpecialGodChipAttrTips",hp);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){this.setGodChipBaseAttr(e),this.btnActive.visible&&(LY.Ins().isShow()&&LY.Ins().closeLockArrow(27),G.timer.once(200,this,this.doShowGuide))},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);this.effect&&this.effect.parent&&(this.effect.parent.removeChild(this.effect),this.effect=null),LY.Ins().isShow()&&LY.Ins().closeLockArrow(28)},i.setGodChipBaseAttr=function(e){var t=this;if(null!=e){var i=parseInt(e.info.split("_")[0]),n=parseInt(e.info.split("_")[1]),s=PR.getGoodsNewAttr(i),o=aa.formatNewAttrToChinese(s);t.chipIdIndex=parseInt(e.info.split("_")[2]);for(var a=0;a<o.length;a++)o[a].id==aa.MAXHP.id?t.txthp.text=RP.n[438]+o[a].val:o[a].id==aa.ATK.id?t.txtatk.text=RP.n[439]+o[a].val:o[a].id==aa.DEF.id?t.txtdef.text=RP.n[440]+o[a].val:o[a].id==aa.MDEF.id&&(t.txtmdef.text=RP.n[441]+o[a].val);var r=Bi.getIndex(i);t._desc.innerHTML=Bi.MODEL.debrisdescribe(r);var l=-1;parseInt(e.info.split("_")[3])==aB.instance.activingRingId-1&&(l=aB.instance.activingRingChipArr[t.chipIdIndex]);var c=TR.ins.getGoodsNum(i)>=n,u=0==l;t.btnActive.visible=c&&u,t.txtDesc.visible=!t.btnActive.visible,t.txtTitle.text=Bi.MODEL.name(r),t.fight_num.value=RR.getFight(s),1==t.btnActive.visible?(null==t.effect&&(t.effect=kB.createEffect("jm1130",t.btnActive.width/2,t.btnActive.height/2,t.btnActive),t.effect.mouseEnabled=t.effect.mouseThrough=!1,t.effect.scale_X=1.25,t.effect.scale_Y=1.25),t.box_need.visible=!0,t.box_desc.visible=!1):(t.box_need.visible=!1,t.box_desc.visible=!0,null!=t.effect&&(t.effect.removeSelf(),t.effect.dispose(),t.effect=null));var d=0,h=aB.instance.activingRingChipArr;for(a=0;a<h.length;a++)0==h[a]&&d++;t.txtneed.text="再激活"+d+RP.n[442],t.txtneed1.text=RP.n[443],t.txtneed1.align="left",t.txtneed.align="left",t.btnActive.on("click",t,t.onActiveChipListener)}t.parent||(eq.panelLayer.once("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.onClick=function(e){this.close(!0)},i.onActiveChipListener=function(e){eq.panelLayer.off("MASK_CLOSE",this,this.onClick),this.btnActive.off("click",this,this.onActiveChipListener),aB.instance.reqActiveRingChip(this.chipIdIndex),UB.ins.playSound(90006),this.close()},i.doShowGuide=function(){var e=PH.Ins().info;if(null!=e&&2==e.status&&0<e.getCurrentGuide(28)){var t=new u_;t.x=this.btnActive.x,t.y=this.btnActive.y-5,t.width=this.btnActive.width,t.height=this.btnActive.height,LY.Ins().show(28,t,!1,this);var i=this.btnActive.localToGlobal(new Uh);LY.Ins().lockSceneShow(i.x,i.y-5,this.btnActive.width,this.btnActive.height)}},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.specialgodring.SpecialGodRingsuipianTipsUI._$SET_instance),t._instance=null,t}(),LY=function(e){function t(){var e=this;e.curr_X=0,e.curr_Y=0,e.moveDir=1,e.currGuideId=0,e._Dis=null,e._IsModel=!1,e._removeTime=0,e.oldTaskId=-1,e.eff=null,e.delayGuideId=0,t.__super.call(e),e.mouseEnabled=!1,e.mouseThrough=!0,e.mc_Arrow.pivotX=e.mc_Arrow.width/2,e.mc_Arrow.pivotY=e.mc_Arrow.height/2}b(t,"modules.task.views.ArrowView",we);var i=t.prototype;return i.show=function(e,t,i,n){var s=this;if(void 0===i&&(i=!1),null!=t&&e!=s.currGuideId&&pn.hasIndex(e)){G.timer.clear(s,s.doAutoMove),s.currGuideId=e;var o=pn.getIndex(e),a=pn.MODEL.dir(o),r=pn.MODEL.dec(o),l=1==pn.MODEL.needEffect(o),c=eq.panelLayer;n?c=n:t instanceof laya.display.Node&&t.parent&&(c=t.parent),41==e&&(c=eq.topLayer);var u=new u_;s._Dis=t,s._IsModel=i,u.x=t.x,u.y=t.y,u.width=t.width,u.height=t.height,l&&(s.eff&&(s.eff.dispose(),s.eff=null),s.eff=mj.GetNew(),s.eff.loadEffect("jm1081","body_top"),s.eff.scale_X=1,s.eff.scale_Y=1,s.eff.setXY(u.x+u.width/2-2,u.y+u.height/2+7),s.eff.renderInSelf=!0,c.addChild(s.eff),s.eff.visible=!0),c.addChild(s),s.update(a,r,u)}},i.showforDir=function(e,t,i,n,s,o,a,r){var l=this;void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=!1);var c=new u_,u=eq.panelLayer;i instanceof laya.display.Node&&i.parent&&(u=i.parent),c.x=i.x-o,c.y=i.y,c.width=i.width,c.height=i.height,s?(null==l.eff&&(l.eff=mj.GetNew(),l.eff.loadEffect("jm1081","body_top")),l.eff.loadEffect("jm1081","body_top"),l.eff.setXY(c.x+o+c.width/2,c.y-a+c.height/2),l.eff.renderInSelf=!0,u.addChild(l.eff)):null!=l.eff&&(l.eff.parent&&l.eff.parent.removeChild(l.eff),l.eff.dispose(),l.eff=null),u.addChild(l),l.update(e,t,c),r&&l.lockSceneShow(c.x,c.y,c.width,c.height)},i.update=function(e,t,i){var n=this;switch(n.txt_Des.x=n.mc_Bg.x=0,n.mc_Bg.y=0,n.txt_Des.y=n.mc_Bg.y+17,n.mc_Arrow.hasOwnProperty("rotation")&&(n.mc_Arrow.rotation=0==e?270:3==e?180:2==e?90:0),e){case 0:n.mc_Arrow.x=n.mc_Bg.x+n.mc_Bg.width+n.mc_Arrow.width/2,n.mc_Arrow.y=n.mc_Bg.height/2,n.x=i.x-(n.mc_Bg.width+n.mc_Arrow.width),n.y=i.y+i.height/2-n.mc_Bg.height/2;break;case 1:n.mc_Arrow.x=n.mc_Bg.width/2,n.mc_Arrow.y=n.mc_Bg.height+n.mc_Arrow.height/2,n.x=i.x+i.width/2-n.width/2,n.y=i.y-(n.mc_Bg.height+n.mc_Arrow.height)-20;break;case 2:n.mc_Arrow.x=0,n.mc_Arrow.y=n.mc_Bg.height/2,n.mc_Bg.x=n.txt_Des.x=n.mc_Arrow.x+n.mc_Arrow.width/2,n.x=i.x+i.width+n.mc_Arrow.width/2,n.y=i.y+i.height/2-n.mc_Bg.height/2;break;case 3:n.mc_Arrow.x=n.mc_Bg.width/2,n.mc_Arrow.y=-n.mc_Arrow.height/2,n.x=i.x+5,n.y=i.y+i.height/2+2*n.mc_Arrow.height+20}n.curr_X=n.x,n.curr_Y=n.y,n.txt_Des.text=t,n.moveDir=1,G.timer.frameLoop(1,n,n.doAutoMove,[e])},i.doAutoMove=function(e){var t=this;switch(t.mc_Arrow.hasOwnProperty("rotation")&&(t.mc_Arrow.rotation=0==e?270:3==e?180:2==e?90:0),e){case 1:t.y>=t.curr_Y+30?(t.moveDir=-1,t.y=t.curr_Y+30):t.y<=t.curr_Y&&(t.moveDir=1,t.y=t.curr_Y),t.y+=1*t.moveDir;break;case 3:t.y>=t.curr_Y?(t.moveDir=1,t.y=t.curr_Y):t.y<=t.curr_Y-30&&(t.moveDir=-1,t.y=t.curr_Y-30),t.y-=1*t.moveDir;break;case 0:t.x>=t.curr_X?(t.moveDir=1,t.x=t.curr_X):t.x<=t.curr_X-30&&(t.moveDir=-1,t.x=t.curr_X-30),t.x-=1*t.moveDir;break;case 2:t.x>=t.curr_X+30?(t.moveDir=-1,t.x=t.curr_X+30):t.x<=t.curr_X&&(t.moveDir=1,t.x=t.curr_X),t.x+=1*t.moveDir}},i.isShow=function(){return!!this.parent},i.closeArrow=function(){this.currGuideId=0,dr.needGuideDaily=!1,G.timer.clear(this,this.doAutoMove),this.parent&&this.parent.removeChild(this)},i.close=function(e,t){var i=this;void 0===t&&(t=!1),(t||i.currGuideId==e)&&(i.oldTaskId=PH.Ins().info.taskId,i.currGuideId=0,dr.needGuideDaily=!1,G.timer.clear(i,i.doAutoMove),i.parent&&i.parent.removeChild(i),i.eff&&(i.eff.parent&&i.eff.parent.removeChild(i.eff),i.eff.visible=!1),i._removeTime=pt.now())},i.resize=function(){this.isShow()&&0<this.currGuideId&&this._Dis&&this.show(this.currGuideId,this._Dis,this._IsModel)},i.doShowGuide=function(e,t,i,n,s,o){if(void 0===n&&(n=!1),void 0===s&&(s=0),t&&e&&(PH.Ins().hasNewGuide(e)||n)&&pn.hasIndex(e)&&e!=this.delayGuideId){var a=pn.getIndex(e),r=pn.MODEL.delaytime(a);0<r?(this.delayGuideId=e,G.timer.once(r,this,this.showGuide,[e,t,i,s,o])):this.showGuide(e,t,i,s,o)}},i.showGuide=function(e,t,i,n,s){void 0===n&&(n=!1),this.show(e,t,!1,i),n&&s&&this.lockSceneShow(s.x,s.y,t.width,t.height)},i.lockSceneShow=function(e,t,i,n){hN.ins.open("LOCK_SCENE_HOLLOW",{vx:e,vy:t,vw:i,vh:n},null,!0)},i.lockSceneShowByDisPlay=function(e){if(e){var t=e.localToGlobal(new Uh);this.lockSceneShow(t.x,t.y,e.width,e.height)}},i.lockSceneClose=function(){hN.ins.close("LOCK_SCENE_HOLLOW")},i.closeLockArrow=function(e,t){void 0===t&&(t=!1),(t||this.currGuideId==e)&&(this.lockSceneClose(),this.close(e,t))},i.destroy=function(e){void 0===e&&(e=!0)},i.closeThisPanel=function(){this.removeSelf(),this.eff&&this.eff.removeSelf()},p(1,t,"showing",function(){return t.m_Instance&&t.m_Instance.isShow()},layouts.task.ArrowUI._$SET_showing),t.Ins=function(){return null==t.m_Instance&&(t.m_Instance=new t),t.m_Instance},t.RIGHT=0,t.DOWN=1,t.LEFT=2,t.UP=3,t.EFFID="jm1081",t.m_Instance=null,f(t,["ARROWSKIN",function(){return this.ARROWSKIN=_r.getAtlasSubPath("basic_ui_b2/ty_jt_zy.png")}]),t}(),MY=function(e){function t(){var e=this;e._data=null,e._effect=null,e.colorMatrix=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],e.GrayFilter=null,e.img_Gray=null,e.reg=/starlevel_\d+/g,t.__super.call(e),e.GrayFilter=new ys(e.colorMatrix),e.img_Gray=new Kl,e.img_Gray.pos(0,0),e.img_Gray.width=470,e.img_Gray.height=70,e.img_Gray.filters=[e.GrayFilter],e.on("click",e,e.onClick)}b(t,"modules.task.views.DirectionAchieveItem",zo);var i=t.prototype;return i.update=function(e,t){var i=this;void 0===t&&(t=!1),i._effect&&i._effect.destroy(),i._data=e,i.img_tuijian.visible=!1,i.redPoint.visible=!1;var n=0,s=i._data.match(i.reg);if(s){var o=s[0];o&&(n=parseInt(o.split("_")[1]))}var a=e.split("|");i.txt_name.changeText(a[a.length-1]),i.txt_go.color="#23b11f",i.txt_go.align="left",i.txt_go.text="前往";var r=!(i.mc_go.visible=!0);if("ACTOR_ACTIVE"==a[1]||"modules.copy.views.CopyMainView"==a[1]&&1==parseInt(a[2])||"guide_action_1"==a[1]?(null==i._effect&&(i._effect=kB.createEffect("jm1382",i.width/2,i.height/2,null),i.addChildAt(i._effect,1)),i.img_tuijian.visible=!1,i.img_tuijian1.visible=!0,a[3]>gR.ins.lv&&(i.img_tuijian1.filters=[i.GrayFilter],i._effect.filters=[i.GrayFilter])):i.img_tuijian1.visible=i.img_tuijian.visible=!1,4==parseInt(a[0]))i.mc_go.visible=!1,i.txt_go.visible=!1,i.off("click",i,i.onClick);else if(1==parseInt(a[0]))a[2]>gR.ins.lv?(i.mc_go.visible=!1,i.txt_go.color="#808080",i.txt_go.align="right",i.txt_go.text=a[2]+"级开启",i.off("click",i,i.onClick),r=!0):i.hasListener("click")||i.on("click",i,i.onClick);else if(2==parseInt(a[0]))a[3]>gR.ins.lv?(i.mc_go.visible=!1,i.txt_go.color="#808080",i.txt_go.align="right",i.txt_go.text=a[3]+"级开启",i.off("click",i,i.onClick),r=!0):i.hasListener("click")||i.on("click",i,i.onClick);else{if(t)if(2==parseInt(a[0])&&"RECYCLE"==a[1])9<=TR.ins.getRecycleEquips(la.NORMAL).length&&(i.img_tuijian.visible=!0,i.redPoint.visible=!0);i.mc_go.visible=!0,i.txt_go.visible=!0,i.hasListener("click")||i.on("click",i,i.onClick)}i.showStarImg(r?0:n)},i.setGray=function(e){this.item_box.gray=e},i.showStarImg=function(e){for(var t=0;t<5;t++){var i=this["star_"+t];i&&(i.visible=t<e)}},i.onClickSpecial=function(){return!!(this._data&&0<=this._data.indexOf("2|GUILD_BOSS_MAINVIEW|1"))&&(vN.ins.joinGuild?Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],this._data):hN.ins.open("GUILD_LIST_VIEW"),!0)},i.onClick=function(e){if(!this.onClickSpecial()){if(this._data){var t=this._data.split("|"),i=parseInt(t[0]),n=t[1];switch(i){case 5:"guide_action_1"==n&&(PH.Ins().info.DirectionEvent=23,Tu.sendToModule("UPDATE_GUANQIA_GUIDE",["modules.nav.NavModule"]));break;default:Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],this._data)}}hN.ins.isOpen("MALL_QBPanel")&&hN.ins.close("MALL_QBPanel"),hN.ins.isOpen("MALL_NORMALBUYPANEL")&&hN.ins.close("MALL_NORMALBUYPANEL"),hN.ins.isOpen("PLAY_UPGRADE_DIRECTION")&&hN.ins.close("PLAY_UPGRADE_DIRECTION")}},t}(),AY=function(e){function i(){var e=this;e.hiding=!1,e.isFirst=!0,e.newGuideTime=0,e.maxNewGuide=1e4,e.flyGold=!1,e.dir=0,e.taskEffect=null,e.taskStatusEffect=null,i.__super.call(e);var t=G.loader.getRes(_r.getAtlasSubPath("mainframe2/zjm_rw_dk.png"));t&&e.graphics.fillTexture(t,0,0,356,110),e.txt_TaskName.style.leading=10}b(i,"modules.task.views.TaskTrack",Fp);var t=i.prototype;return t.show=function(){this.hiding=!1,this.resize(),eq.navLayer&&eq.navLayer.addChild(this),this.update(),this.on("click",this,this.onTaskHandler)},t.hide=function(){var e=this;G.timer.clear(e,e.checkGuide),LY.Ins().close(1,!0),e.hideEffect(),e.hiding=!0,e.parent&&e.parent.removeChild(e),e.off("click",e,e.onTaskHandler)},t.isShowing=function(){return null!=this.parent},t.isHideing=function(){return this.hiding},t.resize=function(){this.x=(G.stage.width-this.width)/2,this.bottom=214},t.onTaskHandler=function(e){if(ZN.isEnabledChangeScene()){var t=PH.Ins().info;if(3==t.status&&10001==t.taskId?xs.mirClick(36,hr.pid,hr.uid):3==t.status&&10002==t.taskId?xs.mirClick(38,hr.pid,hr.uid):2==t.status&&10002==t.taskId&&xs.mirClick(37,hr.pid,hr.uid),2==t.status&&0<=t.taskEvent.indexOf(da.EVENT_GUAN_QIA_2.toString())?t.DirectionEvent=34:2!=t.status&&34==t.DirectionEvent&&0<=t.taskEvent.indexOf(da.EVENT_GUAN_QIA_2.toString())&&(t.DirectionEvent=0),t&&t.waitZhanBao)zB.ins.showById(2126,1);else{var i=t.taskContent[0];if((t.isSceneKillTypeTask&&i&&i.cId==gR.ins.cId||t.isKillTypeTask&&0<BB.attackMonsterMode)&&2==t.status&&sH.getInstance().autoMode&&!sH.getInstance().isStop)zB.ins.showById(2076,1);else{if(G.timer.clear(this,this.checkGuide),LY.Ins().close(1,!0),0==t.commitNPC&&3==t.status){var n=new cM;return Tu.sendToService(n),this.flyGold=!0,3==t.status&&zB.ins.checkRainbowAction("task",t.taskId.toString()),t.taskId==parseInt($e.MODEL.value($e.getIndex(222)))&&Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:1}),void UB.ins.playSound("14",3,!0)}if(gF.TARGETHISTORY){if(3==t.status){if(gF.TARGETHISTORY.targetId==t.commitNPC.toString())return void zB.ins.showById(2155,1)}else if(2==t.status&&gF.TARGETHISTORY.targetId==i.monsterId)return void zB.ins.showById(2155,1)}else if(2==t.status&&0<=t.taskEvent.indexOf(da.EVENT_OPENFLYUP.toString())){return void sJ.ins.getCompomentsByName("NavBottom").showGuide(41,!0)}Tu.sendToModule("AUTOTASK",["modules.task.TaskModule"],t.target)}}}else zB.ins.showById(2126,1)},t.update=function(){var e=this;G.timer.clear(e,e.checkGuide);var t=PH.Ins().info,i=(t.tarIcon,"#e41b00");3==t.status&&(i="#01fb01"),e.txt_TaskName.innerHTML=Ql.htmlText(t.targetWord,"SimHei",22,"#e3dcc2")+" "+Ql.htmlText(t.statusTxt,"SimHei",22,i)+"<br>"+Ql.htmlText(t.commitDialogue,"SimHei",22,"#ffb11a");var n=t.taskContent[0],s=25<gR.ins.lv;n&&(s=s&&n&&"Mission"!=n.type&&"ShaoZhu"!=n.type),0==t.commitNPC&&3==t.status?s?(e.newGuideTime=BB.getTimer(),G.timer.loop(100,e,e.checkGuide)):e.doShowGuide():2==t.status&&4!=t.target.tarType&&15!=t.target.tarType&&13!=t.target.tarType&&(s?(e.newGuideTime=BB.getTimer(),G.timer.loop(100,e,e.checkGuide)):e.doShowGuide()),e.showEffect()},t.testArrow=function(){},t.showGuideFromOther=function(){PH.Ins().info;if(0==LY.Ins().currGuideId||3==LY.Ins().currGuideId||1==LY.Ins().currGuideId){G.timer.clear(this,this.checkGuide);var e=new u_;e.width=200,e.x=0+this.width/2-e.width/2,e.y=0,e.height=this.height,LY.Ins().show(2,e,!1,this)}},t.doShowGuide=function(){var e=PH.Ins().info;if(!LY.showing&&0==LY.Ins().currGuideId){var t=new u_;t.width=200,t.x=0+this.width/2-t.width/2,t.y=0,t.height=this.height,3==e.status?LY.Ins().show(3,t,!1,this):0<e.getCurrentGuide(1)&&LY.Ins.oldTaskId!=e.taskId&&LY.Ins().show(1,t,!1,this)}},t.checkGuide=function(){var e=BB.getTimer();e-this.newGuideTime>this.maxNewGuide&&(0==LY.Ins().currGuideId?(this.doShowGuide(),G.timer.clear(this,this.checkGuide)):this.newGuideTime=e)},t.showEffect=function(){var e=this;e.taskEffect||(e.taskEffect=mj.GetNew(),e.taskEffect.reset(),e.taskEffect.renderInSelf=!0,e.taskEffect.id="taskTrackjm1080",e.taskEffect.setXY(170,65),e.taskEffect.loadEffect("jm1080"),e.addChild(e.taskEffect)),e.taskEffect.visible=!0},t.hideEffect=function(){this.taskEffect&&(this.taskEffect.visible=!1)},t.clearEffect=function(){this.taskEffect&&(this.taskEffect.parent&&this.taskEffect.parent.removeChild(this.taskEffect),this.taskEffect.removeEffect("taskTrackjm1080"),this.taskEffect.renderInSelf=!1,this.taskEffect.dispose(),this.taskEffect=null)},t.destroy=function(e){void 0===e&&(e=!0),this.parent&&eq.navLayer.removeChild(this),this.clearEffect(),this.off("click",this,this.onTaskHandler),laya.ui.View.prototype.destroy.call(this,e)},t.showTaskEffect=function(e){var t=this;t.taskStatusEffect&&(t.taskStatusEffect.parent&&t.taskStatusEffect.parent.removeChild(t.taskStatusEffect),t.taskStatusEffect.renderInSelf=!1,t.taskStatusEffect.dispose(),t.taskStatusEffect=null),t.taskStatusEffect=new mj,t.taskStatusEffect.renderInSelf=!0,t.taskStatusEffect.loadEffect(e,"body_top"),t.taskStatusEffect.id="taskCommit",t.taskStatusEffect.setXY(t.width/2,-115),t.taskStatusEffect.playEndHandler=ql.create(t,t.onShowCommitEnd),t.taskStatusEffect.mat.identity(),"jm1131"==e&&(t.taskStatusEffect.scale_X=.6,t.taskStatusEffect.scale_Y=.6),t.addChild(t.taskStatusEffect)},t.onShowCommitEnd=function(){this.taskStatusEffect&&(this.taskStatusEffect.parent&&this.taskStatusEffect.parent.removeChild(this.taskStatusEffect),this.taskStatusEffect.renderInSelf=!1,this.taskStatusEffect.dispose(),this.taskStatusEffect=null)},p(1,i,"showing",function(){return i.m_Instance&&i.m_Instance.isShowing()},layouts.task.TaskTrackUI._$SET_showing),p(1,i,"isHiding",function(){return i.m_Instance&&i.m_Instance.isHideing()},layouts.task.TaskTrackUI._$SET_isHiding),i.getInstance=function(){return null==i.m_Instance&&(i.m_Instance=new i),i.m_Instance},i.destroyInstance=function(){i.m_Instance&&(i.m_Instance.destroyed||i.m_Instance.destroy(),i.m_Instance=null)},i.EFFECT="jm1080",i.m_Instance=null,i}(),DY=function(e){function t(){this.bg=null,this._currEff=null,this._init=!1,t.__super.call(this)}b(t,"modules.task.views.WellcomeView",cv);var i=t.prototype;return i.show=function(){var e=this;e.bg=new pp,e.bg.mouseEnabled=!0,e.bg.mouseThrough=!1,e.mouseThrough=!0,e.bg.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000"),e.bg.alpha=.3,e.bg.width=G.stage.width,e.bg.height=G.stage.height,G.stage.addChild(e.bg),e._currEff||(e._currEff=kB.createEffect("jm1242",e.btn_StarGame.width/2,e.btn_StarGame.height/2,e.btn_StarGame),e._currEff.blendMode="lighter"),e.resize(),G.stage.addChild(e),e.bg.on("click",e,e.onStarGame),e.btn_StarGame.once("click",e,e.onStarGame),sH.stop(),e._init=!0},i.onStarGame=function(e){Tu.sendToModule("CLOSEWELLCOME",["modules.task.TaskModule"])},i.resize=function(){this.bg.graphics.clear(),this.bg.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000"),this.bg.alpha=.3,this.bg.width=G.stage.width,this.bg.height=G.stage.height,this.pos((G.stage.width-this.width)/2,(G.stage.height-this.height)/2)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.bg.off("click",t,t.onStarGame),t.bg.graphics.clear(),t.bg.parent.removeChild(t.bg),t.bg=null,t.btn_StarGame.off("click",t,t.onStarGame),t.parent.removeChild(t),t._currEff&&t._currEff.dispose(),t._currEff=null,laya.ui.View.prototype.destroy.call(t,t.destroyed)},p(0,i,"init",function(){return this._init}),t}(),OY=function(e){function t(){var e=this;e.m_id=NaN,e._effect=null,e.m_selected=!1,e._effectid=null,t.__super.call(e),e.mouseEnabled=!0,e.on("click",e,e.onClickHandler),e.selectBox.visible=!1,e.redImg.visible=!1}b(t,"modules.weaponsoul.views.WeaponSoulCoreItem",e);var i=t.prototype;return i.onClickHandler=function(e){0<this.m_id&&(hB.ins.coreSelectId=this.m_id,Tu.sendToModule("CORE_SELECT",["modules.strength.StrengthModule"]))},i.showRedTip=function(e){void 0===e&&(e=!1),this.redImg.visible=e,this.redImg.visible&&this.addChild(this.redImg)},i.showEffect=function(e){var t=this,i=po.getIndex(t.m_id);0==e&&t.dataSource&&(e=t.dataSource&&t.dataSource.isEffect);var n=e?po.MODEL.panelEffect(i):po.MODEL.unactivatedPanelEffect(i);t._effectid!=n&&(t._effectid=n,t._effect&&t._effect.dispose(),t._effect=mj.GetNew(),t._effect.renderInSelf=!0,t._effect.pos(t.width/2,t.height/2-20),t._effect.loadEffect(n),t.addChild(t._effect))},i.removeSelf=function(){return this.clearEffect(),laya.display.Node.prototype.removeSelf.call(this)},i.clearEffect=function(){this._effect&&(this._effect.dispose(),this._effect=null)},p(0,i,"wsId",function(){return this.m_id}),p(0,i,"selected",function(){return this.m_selected},function(e){this.m_selected=e,this.selectBox&&(this.selectBox.visible=this.m_selected)}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){G.superSet(Kg,this,"dataSource",e);var t=e,i="",n=!1;this.m_id=0,t&&(this.m_id=t.wsid,i=Ql.createColor(t.wsName,"#88847d")+Ql.createColor(t.minStep+"阶","#b48409"),n=t.coreUsed),this.txt_wsName.innerHTML=i,this.wearFlag.visible=n,this.showEffect(t&&t.actived)}),t}(Kg),PY=function(e){function t(){this.m_id=NaN,this._effect=null,this.m_selected=!1,this._effectid=null,t.__super.call(this),this.on("click",this,this.onClickHandler)}b(t,"modules.weaponsoul.views.WeaponSoulItem",e);var i=t.prototype;return i.onClickHandler=function(e){0<this.m_id&&(hB.ins.curWSId=this.m_id,Tu.sendToModule("OPEN_DETAIL",["modules.strength.StrengthModule"]))},i.showRedTip=function(e){void 0===e&&(e=!1),this.redImg.visible=e,this.redImg.visible&&this.addChild(this.redImg)},i.showEffect=function(e){var t=this,i=po.getIndex(t.m_id),n=e?po.MODEL.panelEffect(i):po.MODEL.unactivatedPanelEffect(i);t._effectid!=n&&(t._effectid=n,t._effect&&t._effect.dispose(),t._effect=mj.GetNew(),t._effect.renderInSelf=!0,t._effect.pos(t.width-118,t.height-300),t._effect.loadEffect(n),t.addChild(t._effect))},i.removeSelf=function(){return this.clearEffect(),laya.display.Node.prototype.removeSelf.call(this)},i.clearEffect=function(){this._effect&&(this._effect.dispose(),this._effect=null)},p(0,i,"wsId",function(){return this.m_id}),p(0,i,"selected",null,function(e){this.m_selected=e,this.selectBox&&(this.selectBox.visible=this.m_selected)}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(Kg,t,"dataSource",e);var i=e,n="",s=!1;t.m_id=0,i&&(t.m_id=i.wsid,n=Ql.createColor(i.wsName,"#90877b")+Ql.createColor(i.step+"阶",0<i.step?"#23b11f":"#e41b00"),s=i.showUsed),t.selected=!1,t.txt_wsName.innerHTML=n,t.wearFlag.visible=s,t.showEffect(i&&i.actived),t.wearFlag.visible&&t.addChild(t.wearFlag)}),t}(Kg),RY=function(e){function t(){this._icon=null,this._currEff=null,t.__super.call(this),this._icon=new MF,this._icon.scale(.8,.8),this.icon.addChild(this._icon)}b(t,"modules.welfare.views.item.SigninItem",e);var i=t.prototype;return i.onClick=function(){var e=this.dataSource,t=Bn.getIndex(e),i=Bn.MODEL.firstVipLevel(t);0<i&&gR.ins.VIPLevel<i?KQ.ins.show(RP.n[445],ql.create(this,this.onSelect,[e]),!0,2,RP.n[446]):lv.reqSignin(e)},i.onSelect=function(e,t){0==t?Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]):lv.reqSignin(e)},i.disposeEff=function(e){},i.destroy=function(e){void 0===e&&(e=!0),this._icon.isClearUrl=!0,this._icon.clearIconTexture(),this._currEff&&this._currEff.dispose(),this._currEff=null,laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(rf,t,"dataSource",e),null!=e&&null!=e){var i,n=Bn.getIndex(e),s=(fB.ins.round,Bn.MODEL.firstVipLevel(n)),o=(fB.ins.round,Bn.MODEL.firstMultiple(n)),a=Bn.MODEL.firstReward(n),r=(fB.ins.round,Bn.MODEL.firstCurrency(n));0<s?(t.mc_vip.visible=!0,t.num_vip.value="v"+s,t.num_mul.value=o+"b"):t.mc_vip.visible=!1,t.mc_sign.visible=!1,t._icon.clickHandler&&t._icon.clickHandler.recover(),t._icon.clickHandler=null,fB.ins.isSignin(e)?(t.mc_fin.visible=!0,t.img_got.visible=!0,t._currEff&&t._currEff.dispose(),t._currEff=null):(t.mc_fin.visible=!1,t.img_got.visible=!1,e<=fB.ins.day?(t._currEff||(t._currEff=kB.createEffect("jm1243",t.width/2,t.height/2,t)),t._icon.clickHandler=ql.create(t,t.onClick,null,!1)):(t._currEff&&t._currEff.dispose(),t._currEff=null)),i=a.length?yB.create(a[0],a[1]):aR.getMoneyDto(r),t._icon.bindData=i,t.lbl_name.color=ms.getByQuality(i.colourId),t.lbl_name.changeText(i.name),t.disposeEff(e)}}),t}(rf),NY=function(e){function t(){t.__super.call(this)}b(t,"modules.welfare.views.sub.WelfareRedPacketIcon",ov);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.show=function(){eq.topLayer?(eq.topLayer.addChild(this),this.y=180,BB.getTimer()%2?this.right=150:this.left=130,this.addEvents(),this.startAction()):this.dispose()},i.startAction=function(){(new Og).to(this,{y:958},5e3,null,ql.create(this,this.shake))},i.shake=function(){this.ani1.play(),G.timer.once(5e3,this,this.dispose)},i.disappear=function(){},i.addEvents=function(){this.on("click",this,this.reqRedPacket)},i.reqRedPacket=function(){lv.reqGetRedPacket(fB.ins.packetNum,fB.ins.packetType,fB.ins.packetUUID),this.dispose()},i.removeEvents=function(){this.off("click",this,this.reqRedPacket)},i.dispose=function(){this.removeEvents(),this.ani1.clear(),Og.clearAll(this),G.timer.clearAll(this),this.removeSelf(),fB.ins.packetIconNum--},t}(),BY=function(e){function t(){t.__super.call(this),xe.retain("ui/layouts/redpacket/tjhb_num_dhs.png"),xe.retain("ui/layouts/redpacket/tjhb_num_ls.png"),xe.retain("ui/layouts/redpacket/tjhb_hb_gx.png"),xe.retain("ui/layouts/redpacket/tjhb_hb_yb.png")}b(t,"modules.welfare.views.sub.WelfareRedPacket",rv);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.addEvents=function(){this.btn_get.on("click",this,this.onClick)},i.removeEvents=function(){this.btn_get.off("click",this,this.onClick)},i.hideByVSC=function(e,t){this.box_top.removeSelf(),this.removeEvents()},i.showByVSC=function(e,t){this.parent.parent.addChild(this.box_top),this.addEvents();var i=(this.centerX=0)<gR.ins.VIPLevel;this.btn_get.visible=this.txt_3.visible=!i,lv.reqRedPacketPanelInfo()},i.destroy=function(e){void 0===e&&(e=!0),this.dispose(),laya.ui.View.prototype.destroy.call(this,e)},i.updateByVSC=function(e){var t=e;this.txt_num1.value=t.freeNum.toString(),this.txt_num2.value=t.vipNum.toString()},i.onClick=function(e){EB.showCharge&&hN.ins.open("FIRST_RECHARGE")},i.dispose=function(){this.removeEvents(),xe.release("ui/layouts/redpacket/tjhb_num_dhs.png"),xe.release("ui/layouts/redpacket/tjhb_num_ls.png"),xe.release("ui/layouts/redpacket/tjhb_hb_gx.png"),xe.release("ui/layouts/redpacket/tjhb_hb_yb.png")},t}(),HY=function(e){function t(){this.mainEff=null,this.action1=null,this.action2=null,t.__super.call(this),xe.retain("ui/layouts/redpacket/tjhb_num_dhs.png")}b(t,"modules.welfare.views.sub.WelfareRedPacketPopup",av);var i=t.prototype;return i.popup=function(e){var t=this;t.parent||(eq.panelLayer?(eq.panelLayer.once("MASK_CLOSE",t,t.closePopup),eq.panelLayer.open(t)):G.stage.addChild(t));var i=0==fB.ins.packetType,n=0<gR.ins.VIPLevel;t.btn_get.visible=t.txt_3.visible=!n&&!i;var s=i?"redpacket/tjhb_num_hs.png":"redpacket/tjhb_num_ls.png";t.txt_num2.skin=_r.getLayoutsImagePath(s),s=i?"ui/layouts/redpacket/tjhb_text_dqhd_1.png":"ui/layouts/redpacket/tjhb_text_vip.png",t.img_2.skin=s,t.alpha=1,t.scale(1,1),t.centerX=0,t.centerY=0,t.action1=new KB,t.action1.play(e.thisTimeNum,0,t.txt_num1),t.action2=new KB,t.action2.play(e.receiveNum,0,t.txt_num2),t.addEvents(),t.mainEff=kB.createEffect("jm1319",309,274,t)},i.closePopup=function(){this.dispose(),this.parent&&(eq.panelLayer?eq.panelLayer.close(this):this.parent.removeChild(this)),lv.reqRedPacketPanelInfo()},i.dispose=function(){var e=this;e.removeEvents(),e.action1&&e.action1.clear(),e.action2&&e.action2.clear(),e.action1=e.action2=null,e.mainEff&&(e.mainEff.parent&&e.mainEff.parent.removeChild(e.mainEff),e.mainEff.dispose(),e.mainEff=null),G.loader.clearResByGroup("redpacket_popup"),G.loader.clearRes("ui/layouts/redpacket/tjhb_hb_bg_01.png"),G.loader.clearRes("ui/layouts/redpacket/tjhb_hb_bg_02.png"),xe.release("ui/layouts/redpacket/tjhb_hb_gx.png"),xe.release("ui/layouts/redpacket/tjhb_hb_yb.png"),xe.release("ui/layouts/redpacket/tjhb_num_dhs.png")},i.addEvents=function(){this.btn_get.on("click",this,this.onClick)},i.removeEvents=function(){this.btn_get.off("click",this,this.onClick)},i.onClick=function(e){this.closePopup(),EB.showCharge&&hN.ins.open("FIRST_RECHARGE")},t}(),VY=function(e){function t(){t.__super.call(this)}b(t,"modules.welfare.views.sub.WfActiveView",uv);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.hideByVSC=function(e,t){this.txt_input.off("enter",this,this.onClick),this.btn_get.off("click",this,this.onClick),this.box_top.removeSelf()},i.showByVSC=function(e,t){this.txt_input.on("enter",this,this.onClick),this.btn_get.on("click",this,this.onClick),this.txt_input.text="",this.parent.parent.addChild(this.box_top)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.updateByVSC=function(e){},i.onClick=function(e){var t=mp.trim(this.txt_input.text);t.length&&lv.reqActive(t)},t}(),GY=function(e){function r(){var e=this;e._round=-1,e._total=null,e._font=null,e._mask=null,e._icon=null,e.awardId=0,e.finTotals=0,e.dayTime=0,e.leftDay=0,e.signDays=0,e.totalKey=null,e.len=0,r.__super.call(e),e.list.itemRender=RY,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=200,e.list.scrollBar.on("change",e,e.onScrollEnd);for(var t=[],i=0;i<Bn.count;i++)t.push(Bn.MODEL.key(i));e.list.array=t,e._icon=new MF,e.img_award.addChild(e._icon)}b(r,"modules.welfare.views.sub.WfSigninView",dv);var t=r.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.hideByVSC=function(e,t){this.box_top.removeSelf(),this.btn_get.off("click",this,this.onGet)},t.showByVSC=function(e,t){this.updateByVSC(null),this.parent.parent.addChild(this.box_top),this.btn_get.on("click",this,this.onGet)},t.destroy=function(e){void 0===e&&(e=!0),this._icon.isClearUrl=!0,this._icon.clearIconTexture(),this.list.array=[],this.list.scrollBar.off("change",this,this.onScrollEnd),laya.ui.View.prototype.destroy.call(this,e)},t.updateByVSC=function(e){var t,i=this;r.current=-1;for(var n=0;n<Bn.count;n++){var s=Bn.MODEL.key(n);if(!fB.ins.isSignin(s)&&s<=fB.ins.day){r.current=s;break}}i.list.refresh(),i.signDays=fB.ins.totalDats,i._round=fB.ins.round,i.totalKey=fB.ins.totalKeys,i.len=i.totalKey.length,0==i.len?(t=Hn.MODEL.firstReward(0),i.dayTime=Hn.MODEL.firstDayTimes(0)):(t=Hn.MODEL.firstReward(i.totalKey[i.len-1]),i.dayTime=Hn.MODEL.firstDayTimes(i.totalKey[i.len-1])),i.leftDay=i.dayTime-i.signDays,i.leftDay<=0&&(i.leftDay=0),i.txt_day.innerHTML=RP.n[447]+Ql.createColor(i.signDays+"",i.signDays>=i.dayTime?"#23b11f":"#ff2e24")+"/"+Ql.createColor(i.dayTime+"","#e3dcc2")+RP.n[448]+Ql.createColor(i.leftDay+"","#e6d80d")+RP.n[449],i.awardId=t[0];var o=t[1],a=yB.create(i.awardId,o);i._icon.bindData=a,i.lbl_name.color=ms.getByQuality(a.colourId),i.lbl_name.changeText(a.name),i.signDays>=i.dayTime?i.btn_get.disabled=!1:i.btn_get.disabled=!0},t.onScrollEnd=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_jb.visible=!1:this.img_jb.visible=!0},t.onGet=function(e){var t=0;t=0==this.len?Hn.MODEL.key(0):Hn.MODEL.key(this.totalKey[this.len-1]),lv.reqTotal(t)},r.current=0,r}(),UY=function(e){function t(){var e=this;e.image=null,t.__super.call(e),e.image=new MF(90),e.image.pos(e.img_bg.x,e.img_bg.y),e.addChild(e.image),e.img_bg.visible=!1,e.setChildIndex(e.img_geted,e.numChildren-1)}return b(t,"modules.yzbqc.view.itemrender.YzbqcAwardItem",Mv),t.prototype.showInfo=function(e){-1==gB.ins.getRewards.indexOf(e)?this.img_geted.visible=!1:this.img_geted.visible=!0;var t=So.getIndex(e);this.txt_score.text=So.MODEL.targetPoints(t).toString()+"积分";var i=parseInt(So.MODEL.award(t).split(",")[0]),n=parseInt(So.MODEL.award(t).split(",")[1]);this.image.dataSource=yB.create(i,n),this.txtName.text=Bi.MODEL.name(Bi.getIndex(i))},t}(),FY=(function(e){function t(){this.view_rank=null,this.btn_close=null,t.__super.call(this)}b(t,"layouts.guild.domain._GuildKunDamagRankUI",Ip),t.prototype.createChildren=function(){Vg.regComponent("modules.guild.views.domain.GuildKunPlayerRankV",modules.guild.views.domain.GuildKunPlayerRankV),Vg.regComponent("layouts.bag._BlankWinTipUI",tm),laya.ui.Component.prototype.createChildren.call(this),this.loadUI("guild/domain/_GuildKunDamagRank")}}(),function(e){function t(){this.btn_rank=null,this.btn_award=null,this.view_rank=null,this.view_reward=null,this.btn_close=null,this.img_title=null,t.__super.call(this)}b(t,"layouts.guild.domain._GuildKunRankBaseUI",Ip),t.prototype.createChildren=function(){Vg.regComponent("layouts.bag._BlankWinTipUI",tm),Vg.regComponent("modules.guild.views.domain.GuildKunPlayerRankV",modules.guild.views.domain.GuildKunPlayerRankV),Vg.regComponent("modules.guild.views.domain.GuildKunRewardRankV",modules.guild.views.domain.GuildKunRewardRankV),laya.ui.Component.prototype.createChildren.call(this),this.loadUI("guild/domain/_GuildKunRankBase")}}(),function(e){function t(){this.btn_rank=null,this.btn_award=null,this.yzbqc_rank=null,this.yzbqc_awards=null,this.btn_close=null,t.__super.call(this)}return b(t,"layouts.yzbqc.YzbqcNewRankVUI",Ip),t.prototype.createChildren=function(){Vg.regComponent("modules.yzbqc.view.YzbqcPlayerRankV",n$),Vg.regComponent("modules.yzbqc.view.YzbqcRewardRankV",o$),laya.ui.Component.prototype.createChildren.call(this),this.loadUI("yzbqc/YzbqcNewRankV")},t}()),qY=function(n){function t(){var e=this;e.vsc=null,e.openMedalRangID=0,e.openGovRangID=0,e.openTujian=0,e.yupei_open_day=0,e.yupei_open_level=0,e.resList=[91,55,57,204,224],t.__super.call(e),e.top=e.bottom=0,e.left=e.right=0}b(t,"modules.achievenew.views.AchieveNewMainView",n);var e=t.prototype;return e.initialize=function(){var i=this;this.size(720,1280),this.centerX=this.centerY=0;var e=[_r.getLayoutsPath("actorCimelia")];this.navList=["ui/layouts/achievenew/yq_btn_tejie.png","ui/layouts/achievenew/btn_tab_tujian.png","ui/layouts/achievenew/yq_btn_lp.png","ui/layouts/achievenew/yq_btn_xz.png","ui/layouts/achievenew/yq_btn_yp.png","ui/layouts/actorCimelia/yq_btn_xj.png"],this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.openMedalRangID=parseInt($e.MODEL.value($e.getIndex(90))),this.openGovRangID=parseInt($e.MODEL.value($e.getIndex(119))),this.openTujian=parseInt($e.MODEL.value($e.getIndex(163)));var t=$e.MODEL.value($e.getIndex(173)).split(","),n=this.yupei_open_day=parseInt(t[0]),s=this.yupei_open_level=parseInt(t[1]);this.vsc.registAll([{cls:P1,id:"0",wait:hN.wait(hN.waitRes([_r.getLayoutsPath("specialgodring")]),hN.waitConfig(rc.specialgodring_A,rc.specialgodring_C))},{cls:$Y,id:"1",grayTip:function(){zB.ins.showMsg(i.openTujian+RP.n[450],1)},wait:hN.wait(hN.waitConfig(["BossCardLevelResource","BossCardResolveResource","BossCardSuitResource"],["CBossCardLevelResource","CBossCardResolveResource","CBossCardSuitResource"]),hN.waitAtlas("tujian"))},{cls:H$,id:"2",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["DragonSoulUpgrade"],["CDragonSoulUpgrade"]),hN.waitRes(e))},{cls:zY,id:"3",isHideBg:!0,grayTip:function(){var e=Qt.getIndex(i.openMedalRangID),t=Qt.MODEL.ringName(e);zB.ins.showMsg("激活"+t+RP.n[451],1)},wait:hN.wait(hN.waitConfig(["MedalResource"],["ConfigMedal"]))},{cls:V$,id:"4",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["YuPeiUpgrade"],["CYuPei"]),hN.waitRes(e)),grayTip:function(){zB.ins.showMsg("开服第"+n+RP.n[452]+s+"级开启",1),UB.ins._playLevelNot()}},{cls:j1,id:"5",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["XinFaLevelResource","XinFaWasteSheetResource","XinFaSkillResource"],["XinfaModel","XinfaBookModel","XinfaSkillModel"]),hN.waitAtlas(["xinfa","actorCimelia"])),grayTip:function(){zB.ins.showMsg(RP.n[453],1)}}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},e.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.onAdd=function(e){n.prototype.onAdd.call(this,e),this.panelName="AchieveNewMainView";var t=__.equipCareList.concat(this.resList);AN.reqRedPt(t);var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_MEDAL",[55],i),AN.ins.addListener("BTN_TUJIAN",[57],i),AN.ins.addListener("BTN_DRAGONSOUL",[204],i),AN.ins.addListener("spe_ring",[91],i),AN.ins.addListener("BTN_XINFA",[225],i),this.updateItemEnabled()},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.onRemove=function(e){n.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_DRAGONSOUL"),AN.ins.removeListener("BTN_MEDAL"),AN.ins.removeListener("BTN_TUJIAN"),AN.ins.removeListener("spe_ring"),AN.ins.removeListener("BTN_XINFA")},e.setSelectIndex=function(e){switch(e<0&&(e=this.opIndex),1<(this.vsc.selectedIndex=e)&&this.tabScrollTo(e),e.toString()){case"2":this.checkTips("2");break;case"3":this.checkTips("3");break;case"1":this.checkTips("1");break;case"0":this.checkTips("0");break;case"5":this.checkTips("5")}},e.isOpenXinfa=function(){return GR.getInstance().checkModuleOpen(33)},e.onSubChanged=function(e,t){var i="";switch(e){case"0":i="specialgodring/tj_text_tj.png";break;case"3":i="achievenew/xz_text_xz.png";break;case"1":i="achievenew/tj_text_tj.png";break;case"2":i="achievenew/lh_title_lp.png";break;case"4":i="achievenew/yp_text_yp.png";break;case"5":i="xinfa/xf_title_xj.png"}this.setTitle(_r.getAtlasSubPath(i))},e.updateByVSC=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.checkTips=function(e){if("3"==e){if(this.openMedalRangID>aB.instance.activedRingId)return 1;if(AN.ins.getStateByCareList([55]))return 3}else if("1"==e){if(this.openTujian>gR.ins.lv)return 1;if(AN.ins.getStateByCareList([57]))return 3}else if("2"==e){if(AN.ins.getStateByCareList([204]))return 3}else if("4"==e){if(!SR.isOpen())return 1;if(SR.yupeiHash){if(SR.getYuPeiRed())return 3}else if(AN.ins.getStateByCareList([224]))return 3}else if("0"==e){if(AN.ins.getStateByCareList([91]))return 3}else if("5"==e){if(!this.isOpenXinfa())return 1;if(AN.ins.getStateByCareList([225]))return 3}return 0},e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},p(0,e,"opIndex",function(){return AN.ins.getStateByCareList([91])?0:AN.ins.getStateByCareList([57])?1:AN.ins.getStateByCareList([204])?2:AN.ins.getStateByCareList([55])?3:AN.ins.getStateByCareList([224])?4:AN.ins.getStateByCareList([225])?5:0}),t.NAME="ACHIEVE_NEW_MAIN_VIEW",t.TAB_INDEX_RING="0",t.TAB_INDEX_MEDAL="3",t.TAB_INDEX_TUJIAN="1",t.TAB_DRAGON_SOUL="2",t.TAB_YUPEI="4",t.TAB_XINFA="5",t}(Ip),jY=function(t){function e(){this._grid=null,this._id=0,this._targetNum=0,e.__super.call(this)}b(e,"modules.achievenew.views.gov.GovLiLianRewardItem",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF(74),e._grid.toolTipEnabled=!1,e._grid.x=e.img_icon.x,e._grid.y=e.img_icon.y,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._grid.on("click",this,this.onGetRewardClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._grid.off("click",this,this.onGetRewardClicked)},i.onGetRewardClicked=function(e){fl.instance.todayLiLian<this._targetNum?this._grid._doShowToolTip():-1==fl.instance.todayGetLiLianRewardArr.indexOf(this._id)?WP.requestGetTodayLiLianReward(this._id,ql.create(this,this.getRewardBack)):zB.ins.showById(3211,1)},i.getRewardBack=function(){var e=[],t=this._grid.bindData;e.push(t.goodsId),zB.ins.playGetItems(e)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(pl,t,"dataSource",e),e){t._id=e.id;var i=yB.createStr(e.rewardStr);t._grid.bindData=i,t._grid.goodsNum=i.goodsNum,t._targetNum=e.targetNum,t.txt_value.text=e.targetNum+"历练",t.img_get.visible=!1,fl.instance.todayLiLian>=t._targetNum?-1==fl.instance.todayGetLiLianRewardArr.indexOf(t._id)?t.img_red.visible=!0:(t.img_red.visible=!1,t.img_get.visible=!0):t.img_red.visible=!1}}),e}(pl),WY=function(t){function e(){this._gridsList=null,this._liLianRewardItemArr=null,this._guanYinGrid=null,this._guanYinCanGetImg=null,this._eff=null,this.BAR_W,e.__super.call(this)}b(e,"modules.achievenew.views.gov.GovMainPanelView",t);var i=e.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._gridsList=new vj,e._gridsList.x=89,e._gridsList.y=359,e._gridsList.width=460,e._gridsList._spaceX=30,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=103,e._gridsList._gnameFont="20px SimHei",e._gridsList._gnameVisible=!1,e.box_c.addChild(e._gridsList),e.list_task.itemRender=YY,e.list_task.repeatY=7,e.list_task.repeatX=1,e.list_task.vScrollBarSkin="",e.initLiLianReward(),e._guanYinGrid=new MF,e._guanYinGrid.toolTipEnabled=!1,e._guanYinGrid.needEffect=!1,e._guanYinGrid.size(e.img_reward.width,e.img_reward.height),e._guanYinGrid.x=e.img_reward.x,e._guanYinGrid.y=e.img_reward.y,e.addChild(e._guanYinGrid),e._guanYinCanGetImg=new Kl,e._guanYinCanGetImg.skin=_r.getAtlasSubPath("achievenew/fs_bq_klq.png"),e._guanYinCanGetImg.x=e._guanYinGrid.x+3,e._guanYinCanGetImg.y=e._guanYinGrid.y+25,e.addChild(e._guanYinCanGetImg),e.addChild(e.img_reward_red),e.txt_reward.leading=6},i.initLiLianReward=function(){var e;this._liLianRewardItemArr=[];for(var t=0;t<4;t++)(e=new jY).x=this["img_lilianIcon_"+t].x-20,e.y=this["img_lilianIcon_"+t].y-8,this.b_show.addChild(e),this._liLianRewardItemArr.push(e)},i.updateGuanYin=function(){var e=this,t=!1,i=0;i=fl.instance.currentGetGuanYiID==yn.count?(t=!0,yn.count-1):fl.instance.currentGetGuanYiID;var n=yh.getObj(yn.MODEL.reward(i))[0].value.split(","),s=KH.create(parseInt(n[0]),parseInt(n[1]));if(e._guanYinGrid.bindData=s,e._guanYinGrid.gray=!1,e.img_reward_red.visible=!1,fl.instance.hasGuanYinUnget())e.txt_reward.innerHTML=RP.n[454],e._guanYinCanGetImg.visible=!0,e.img_reward_red.visible=!0;else{if(t)e.txt_reward.innerHTML=RP.n[455],e._guanYinGrid.gray=!0;else{var o=mn.MODEL.leftLevel(fl.instance.position);e.txt_reward.innerHTML="<font style='color:#e6d80d'>再提升</font><font style='color:#23b11f'>"+o+"</font><font style='color:#e6d80d'>阶</font>"+Ql.newline()+"<font style='color:#e6d80d'>可领取</font>"}e._guanYinCanGetImg.visible=!1}},i.updateAtt=function(){var e,t=fl.instance.position==mn.count-1,i=1;i=t?fl.instance.position:fl.instance.position+1;var n,s,o,a=aa.formatAttrToChineseByList(mn.MODEL.attr(mn.getIndex(i)),!1,!0);JSON.parse(mn.MODEL.attr(mn.getIndex(i)));n=RR.getFight(a),t||(e=aa.formatAttrToChineseByList(mn.MODEL.attr(mn.getIndex(i+1))));for(var r=0;r<vn.count;r++)s=a[r],this["txt_currentAttr_"+r].text=s?s.addName+"："+s.val:"",e&&(o=e[r]),this["txt_nextAttr_"+r].text=o&&!t?o.val:"";this.fight_item.value=n},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_promotion.on("click",t,t.onPromotionBtnClicked),t._guanYinGrid.on("click",t,t.onGuanYinGridClicked),t.list_task.scrollBar.on("change",t,t.onScrollChanged),t.BAR_W=t.pro_bar.width,t.updateByVSC(null)},i.updateByVSC=function(e){var t=this,i=fl.instance.position;if(t.img_positionName.skin=_r.getFullUrl("ui/images/achieveNew/gov/gov_poistion_title_"+(mn.MODEL.position(i)-1)+".png"),t.img_poinstion.skin=_r.getFullUrl("ui/images/achieveNew/gov/gov_poistion_"+(mn.MODEL.position(i)-1)+".png"),t.txt_thisLevel.text=mn.MODEL.positionName(fl.instance.position),fl.instance.position==mn.count-1)t.txt_nextLevel.text="已满阶",t.txt_nextLevel.fontSize=24,t.txt_nextLevel.y=t.img_arrow.y+t.img_arrow.height/2-t.txt_nextLevel.height/2-15,t.setRateBar(1),t.txt_promotion.text="已满阶",t.btn_promotion.gray=!0,t._eff&&(t._eff.parent&&t._eff.parent.removeChild(t._eff),t._eff.dispose(),t._eff=null);else{t.btn_promotion.gray=!1;var n=fl.instance.position+1;t.txt_nextLevel.text=mn.MODEL.positionName(n);var s=mn.MODEL.upgradeExperience(fl.instance.position),o=1<fl.instance.currentLiLian/s?1:fl.instance.currentLiLian/s;t.setRateBar(o),t.txt_promotion.text=fl.instance.currentLiLian+"/"+s,fl.instance.currentLiLian>=s?t._eff||(t._eff=kB.createEffect("jm1130",t.btn_promotion.x+t.btn_promotion.width/2,t.btn_promotion.y+t.btn_promotion.height/2,t.box_c),t._eff.scale_X=.8,t._eff.scale_Y=1):t._eff&&(t._eff.parent&&t._eff.parent.removeChild(t._eff),t._eff.dispose(),t._eff=null)}for(var a=fl.instance.todayLiLian,r=0;r<vn.count;r++)vn.MODEL.experience(r)<=a&&0;for(var l=NaN,c=0,u=0,d=0;d<vn.count;d++)l=0,l=(c=vn.MODEL.experience(d))<=a?1:0!=d?(u=vn.MODEL.experience(d-1),a<=c&&u<a?(a-u)/(c-u):0):a/c,t["img_progress_lilian_"+d].scaleX=l;t.txt_progress_lilian.text=fl.instance.todayLiLian+"",t.updateMission(),t.updateReward(),t.updateLiLianReward(),t.updateAtt(),t.updateGuanYin(),t.txt_level.text=mn.MODEL.level(fl.instance.position)+"阶"},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.pro_bar.scrollRect||new u_(0,0,this.pro_bar.width,this.pro_bar.height);t.width=this.BAR_W*e,this.pro_bar.scrollRect=t},i.updateReward=function(){fl.instance.position==mn.count-1?(this._gridsList.setGoodsItems(mn.MODEL.upgradeReward(fl.instance.position-1),6),this._gridsList.gray=!0):this._gridsList.setGoodsItems(mn.MODEL.upgradeReward(fl.instance.position),6)},i.updateMission=function(){for(var e,t=In.count,i=[],n=0;n<t;n++)(e=new vl).missionId=In.MODEL.key(n),e.value=In.MODEL.exeNum(n),e.targetNum=In.MODEL.exeRound(n),e.lilian=In.MODEL.roundValue(n),e.dect=In.MODEL.dect(n),e.goCom=In.MODEL.taskContent(n),e.levelLimit=In.MODEL.openLevel(n),e.errorDect=In.MODEL.errorDect(n),e.taskType=In.MODEL.taskType(n),e.reverse=In.MODEL.reverse(n),e.sortID=In.MODEL.sortID(n),e.updateServerData(fl.instance.getServerVOByID(e.missionId)),i.push(e);i=be.sortOn(i,["statue","sortID","missionId"],[Array.NUMERIC,Array.NUMERIC,Array.NUMERIC]),this.list_task.dataSource=i},i.updateLiLianReward=function(){for(var e,t=0;t<vn.count;t++)(e=new Object).id=vn.MODEL.key(t),e.targetNum=vn.MODEL.experience(t),e.rewardStr=vn.MODEL.reward(t),this._liLianRewardItemArr[t].dataSource=e},i.onPromotionBtnClicked=function(e){if(UB.ins.playSound("11"),fl.instance.position!=mn.count){var t=mn.MODEL.upgradeExperience(fl.instance.position),i=!1;for(var n in this._gridsList.dataSource)if(this._gridsList.dataSource[n]instanceof protos.backpack.DtoEquip){i=!0;break}if(fl.instance.currentLiLian>=t){if(i&&!TR.ins.hasEmptyNum(20))return void KQ.ins.showBagRecycle();WP.requestPromotion(ql.create(this,this.getPromotionback))}else zB.ins.showById(3213,1)}else zB.ins.showById(3214,1)},i.getPromotionback=function(){var e,t=[];for(var i in this._gridsList.list.dataSource)e=this._gridsList.list.dataSource[i],t.push(e.goodsId);zB.ins.playGetItems(t)},i.onGuanYinGridClicked=function(e){if(fl.instance.hasGuanYinUnget()){if(!TR.ins.hasEmptyNum(20))return void KQ.ins.showBagRecycle();WP.requestGuanYin(ql.create(this,this.getGuanBackHandler))}else this._guanYinGrid._doShowToolTip()},i.getGuanBackHandler=function(){var e=[],t=this._guanYinGrid.bindData;e.push(t.goodsId),zB.ins.playGetItems(e)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_promotion.off("click",t,t.onPromotionBtnClicked),t._guanYinGrid.off("click",t,t.onGuanYinGridClicked),t.list_task.scrollBar.off("change",t,t.onScrollChanged),t._eff&&t._eff.dispose(),t._eff=null},i.onScrollChanged=function(){0==this.list_task.scrollBar.max||this.list_task.scrollBar.value>=this.list_task.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},e.NAME="GovMainPanelView",e}(gl),YY=function(e){function t(){this._vo=null,this._isFinish=!1,this.sid="1",t.__super.call(this)}b(t,"modules.achievenew.views.gov.GovTaskItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_go.on("click",this,this.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.txt_go.off("click",this,this.onGoClicked)},i.onGoClicked=function(e){var i=this;if(this._vo.dect==RP.n[456]||ZN.isEnabledChangeScene()&&(!dr.dtoEnterScene||13!=dr.dtoEnterScene.type)){if(!this._isFinish)if(""!=this._vo.taskType)if(gR.ins.lv<this._vo.levelLimit)zB.ins.showMsg(this._vo.errorDect,1);else{switch(this._vo.taskType){case"XuaZhanKuangDong":case"BurnPigTimes":case"CaiLiaoFuBen":case"AreraTimesAfterReceive":case"TianGuanFloor":case"RecyEquip":case"FieldFightTimes":case"KillWildBoss":case"MOYUBOSS":n();break;case"ShangChengGouMai":Tu.sendToModule("OPEN_MALL_PAGE",["modules.mall.MallModule"],fu.MYSTERY);break;case"TanBao":Tu.sendToModule("TR_OPEN",["modules.treasure.TreasureModule"]);break;case"TongGuanGuanQia":this.sid=uH.Ins().prveCid=Hi.MODEL.quitCid(UR.instance.currentPoint-1)+"",NF.Ins().changeScene(this.sid,!0,ql.create(aF,aF.onReadForYeZhanHandler)),sH.getInstance().autoMode=!0,eB.getInstance().resetAllSkillCd(),hN.ins.close("NewDailyActMainView");break;case"SummonBoss":0<gR.ins.guildId?n():zB.ins.showMsg(this._vo.errorDect,1);break;case"ChargeMoney":EB.showCharge&&(HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet?hN.ins.open("FIRST_RECHARGE",null):hN.ins.open("RECHARGE_VIEW",null,0));break;case"FeedFish":0<gR.ins.guildId?n():zB.ins.showMsg(this._vo.errorDect,1);break;default:n()}1==this._vo.reverse&&WP.backToGov(ql.create(null,function(){Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"],{_subIndex_:0})},null,!1))}else{var t=mp.getFormat(zB.ins.getDesc(3216),[this._vo.dect]);zB.ins.showMsg(t,1)}}else zB.ins.showById(2126,1);function n(){if(!(BB.isShaozhu()&&modules.copy.others.PigData.ins.PigCopyID<=0)){var e=i._vo.goCom.split("|");if(ZN.isEnabledChangeScene()||2==parseInt(e[0])){var t=Np.create(0|e[0],e[1]);2<e.length&&("KillMonsterOnMission"==i._vo.taskType?t.cId=e[2]:t.data=e[2]),hN.ins.close("NewDailyActMainView"),Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],t)}else zB.ins.showById(2126,1)}}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t._vo=e,t._vo&&(t.txt_taskName.text=t._vo.dect,t._vo.currentNum>=t._vo.targetNum?(t._isFinish=!0,t.txt_go.text="已完成",t.txt_go.color="#f7b041"):(t._isFinish=!1,t.txt_go.text=RP.n[457],t.txt_go.color="#23b11f"),t.txt_go.underline=!t._isFinish,t.txt_progress.text=t._vo.currentNum+"/"+t._vo.targetNum,t.txt_reward.text=t._vo.lilian+"历练")}),t}(ml),zY=function(e){function t(){t.__super.call(this)}b(t,"modules.achievenew.views.medal.MedalMainPanelView",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.createChildren=function(){e.prototype.createChildren.call(this),this.list_task.itemRender=XY,this.img_bg.skin=_r.getFullUrl("ui/images/achieveNew/xz_img_bg.jpg")},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.updateByVSC(null),this.btn_upgrade.on("click",this,this.onUpgradeClicked),AN.ins.addListener("BTN_MEDAL",[55],ql.create(this,this.redPtHandler,null,!1))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_upgrade.off("click",this,this.onUpgradeClicked),AN.ins.removeListener("BTN_MEDAL")},i.redPtHandler=function(){AN.ins.getStateByCareList([55])?this.btn_upgrade.showTip=!0:this.btn_upgrade.showTip=!1},i.updateByVSC=function(e){var t=wu.instance.currentLevel;this.updateStar(),this.updateMetalImage(),t<zs.count-1?0!=wu.instance.currentLevel&&wu.instance.currentLevel%11==10?this.btn_upgrade.label=RP.n[458]:this.btn_upgrade.label=RP.n[459]:this.btn_upgrade.label="已满级",this.updateTask(),this.updateAttr()},i.updateMetalImage=function(){var e=parseInt(wu.instance.currentLevel/11+"");this.img_medal.skin=_r.getFullUrl("ui/images/achieveNew/medal/xz_medal_"+e+".png");var t=parseInt(wu.instance.currentLevel/11+""),i=parseInt(wu.instance.currentLevel/11+"");this.font_first.value=t+"",this.font_second.value=i+""},i.updateStar=function(){var e=0;e=wu.instance.currentLevel==zs.count?10:wu.instance.currentLevel%11;for(var t=0;t<10;t++)this["img_star_"+t].visible=t<e},i.updateAttr=function(){var e,t=this,i=wu.instance.currentLevel,n=0,s=[];if(i>=zs.count-1)for(s=aa.formatNewAttrToChinese(zs.MODEL.attrs(i)),t.box_middle.visible=!0,t.txt_medalLeft.text="",t.txt_medalMiddle.text=zs.MODEL.name(i),n=0;n<2;n++)e=s[n],t["txt_attrMiddle_"+n].text=e?e.name+"："+e.val:"";else{for(s=aa.formatNewAttrToChinese(zs.MODEL.attrs(i)),t.box_middle.visible=!1,n=0;n<2;n++)e=s[n],t["txt_attrLeft_"+n].text=e?e.name+"："+e.val:"";t.txt_medalLeft.text=zs.MODEL.name(i);var o=0;for(o=i+1>zs.count?zs.count-1:i+1,t.txt_medalRight.text=zs.MODEL.name(o),s=aa.formatNewAttrToChinese(zs.MODEL.attrs(o)),n=0;n<2;n++)e=s[n],t["txt_attrRight_"+n].innerHTML=e?Ql.createColor(e.name+"：","#90877b")+Ql.createColor(e.val+"","#23b11f"):""}t.box_left.visible=!t.box_middle.visible,t.box_right.visible=!t.box_middle.visible,t.img_arrow.visible=!t.box_middle.visible},i.updateTask=function(){this.list_task.dataSource=wu.instance.getTaskData()},i.onUpgradeClicked=function(e){if(wu.instance.currentLevel>=zs.count-1)zB.ins.showMsg(RP.n[460],1);else{var t=new Eu;Tu.sendToService(t),UB.ins.playSound("11")}},t.NAME="MedalMainPanelView",t}(xu),XY=function(e){function t(){this._vo=null,this._BAR_W=0,this._achieveNewMainView=null,t.__super.call(this)}b(t,"modules.achievenew.views.medal.MedalTaskItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._BAR_W=this.img_pro.width,this.on("click",this,this.onImageClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onImageClicked)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onImageClicked=function(e){if(this._vo)switch(this._vo.id){case 0:hN.ins.open("ACTOR_M",{subIndex:parseInt("2")});break;case 1:Tu.sendToModule("ST_OPEN",["modules.strength.StrengthModule"],{selectedInex:"1",backID:0});break;case 2:Tu.sendToModule("ST_OPEN",["modules.strength.StrengthModule"],{selectedInex:"2",backID:0});break;case 3:Tu.sendToModule("ST_OPEN",["modules.strength.StrengthModule"],{selectedInex:"3",backID:0});break;case 4:Tu.sendToModule("SKILLVIEW_OPEN",["modules.skill.SkillModule"],{selectedInex:"1",backID:0});break;case 5:Tu.sendToModule("OPEN_DRADON_SOUL",["modules.achievenew.AchieveNewModule"],{_subIndex_:"2"});break;case 6:Tu.sendToModule("SKILLVIEW_OPEN",["modules.skill.SkillModule"],{selectedInex:"0",backID:0})}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Su,t,"dataSource",e),e){t._vo=e,t.txt_name.text=t._vo.name;var i=n_.getIndex(t._vo.targetID),n=n_.MODEL.value(i),s=lB.instance().getTaskAsstInfo(t._vo.targetID);t.img_task.skin=_r.getFullUrl("ui/images/achieveNew/medal/xz_icon_"+t._vo.id+".png");var o=0,a=o/n;if(wu.instance.currentLevel>=zs.count-1?(a=1,t.txt_progress.text=n+"",t.txt_finish.visible=!1):(s instanceof modules.tasknew.others.vo.TaskRecordVo?(o=n,a=1):s instanceof modules.tasknew.others.vo.TaskVo&&(a=(o=s.targetList[0].currentValue)/n),t.txt_progress.text=o+"/"+n,t.txt_finish.visible=n<=o),t.txt_progress.visible=!t.txt_finish.visible,t.img_pro.visible=!t.txt_finish.visible,t.img_pro_bg.visible=!t.txt_finish.visible,t._vo.currentNum=o,t._vo.targetNum=n,wu.instance.updateVO(t._vo),t.img_pro.visible){1<a&&(a=1);var r=t.img_pro.scrollRect||new u_(0,0,t.img_pro.width,t.img_pro.height);r.width=t._BAR_W*a,t.img_pro.scrollRect=r}}else t._vo=null}),t}(Su),QY=function(e){function t(){this.rolePos=[-130,-360,100],this.prestige_rank_type=11,this.roleList=[],this._data=null,this._BAR_W=0,this._effLink=null,this.eff=null,t.__super.call(this),this.initUI()}b(t,"modules.achievenew.views.prestige.PrestigeMainView",qh);var i=t.prototype;return i.initUI=function(){var e=this;e._data=YP.instance,e.img_bg.skin=_r.getFullUrl("ui/images/prestige/ww_jm_bg.jpg"),e.img_titleBgLeft.skin=_r.getFullUrl("ui/images/prestige/ww_mimg_xxd.png"),e.img_titleBgRight.skin=_r.getFullUrl("ui/images/prestige/ww_mimg_xxd.png");for(var t=0;t<e.rolePos.length;t++){var i=new CF;0==t?i.pos(e.rolePos[t],70):i.pos(e.rolePos[t],120),i.scale(.7,.7),e.roleContainer.addChild(i),e.roleList.push(i)}e.roleContainer.addChild(e.roleList[0])},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._BAR_W=t.img_progressBar.width,t.lab_preview.on("click",t,t.openPreviewPanel),t.lab_getBack.on("click",t,t.onClick),t.btn_goRank.on("click",t,t.onClick),t.lab_reward.on("click",t,t.onClick),t.sp_rank_0.on("click",t,t.checkRoleHandler),t.sp_rank_1.on("click",t,t.checkRoleHandler),t.sp_rank_2.on("click",t,t.checkRoleHandler),t._effLink||(t._effLink=kB.createEffect("jm1130",t.lab_reward.x+(t.lab_reward.textWidth>>1),t.lab_reward.y+(t.lab_reward.textHeight>>1)+1,t.box_d),t._effLink.scale_X=.7,t._effLink.scale_Y=.7)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.lab_preview.off("click",t,t.openPreviewPanel),t.lab_getBack.off("click",t,t.onClick),t.btn_goRank.off("click",t,t.onClick),t.lab_reward.off("click",t,t.onClick),t.sp_rank_0.off("click",t,t.checkRoleHandler),t.sp_rank_1.off("click",t,t.checkRoleHandler),t.sp_rank_2.off("click",t,t.checkRoleHandler),t.clearEff(),t.clearAttr(t.preBox.graphics),t.clearAttr(t.nextBox.graphics),hN.ins.close("PRESTIGE_PREVIEW_PANEL"),t._effLink&&(t._effLink.parent&&t._effLink.parent.removeChild(t._effLink),t._effLink.dispose(),t._effLink=null)},i.destroy=function(e){void 0===e&&(e=!0);for(var t=0;t<this.roleList.length;t++){var i=this.roleList[t];i&&i.destroy()}this.roleList.length=0,this.img_bg.dispose(),this.img_titleBgLeft.dispose(),this.img_titleBgRight.dispose(),laya.ui.View.prototype.destroy.call(this,e)},i.openPreviewPanel=function(e){Tu.sendToModule("OPEN_PRESTIGE_PREVIEW_VIEW",["modules.achievenew.AchieveNewModule"])},i.showByVSC=function(e,t){this.updateRoles(),this.updateUI(),this.updateSkillUI()},i.updateByVSC=function(e,t){this.showByVSC()},i.updateUI=function(){var e=this,t=e._data.getPrestigeIndex(),i=Sn.MODEL,n=Sn.count,s=t+1,o=!1;n<=t+1&&(o=!0,s=n-1),e.txt_lessenDescr.text=RP.n[461]+i.deductPrestige(t)+"威望",e.img_crtLv.skin=_r.getPrestigePath(i.picName(t)),e.nextTitle.visible=!o,e.img_nextLv.skin=o?null:_r.getPrestigePath(i.picName(s));var a=gR.ins.WW,r=i.minPrestige(s),l=a/r,c=e.img_progressBar.scrollRect||new u_(0,0,e.img_progressBar.width,e.img_progressBar.height);c.width=e._BAR_W*l,e.img_progressBar.scrollRect=c,e.txt_progressLab.text=o?a+RP.n[462]:a+"/"+r;var u=i.attrs(t),d=i.attrs(s);u&&""!=u?e.showAttr(e.preBox.graphics,u,"#90877b",!1):e.clearAttr(e.preBox.graphics),o?(e.clearAttr(e.nextBox.graphics),e.nextBox.graphics.fillText("已满级",3,50,"30px SimHei","#00ff00","left")):d&&""!=d?e.showAttr(e.nextBox.graphics,d,"#23b11f",!1):e.clearAttr(e.nextBox.graphics),0<e._data.back_prestige?e.eff||(e.eff=kB.createEffect("jm1130",e.lab_getBack.x+(e.lab_getBack.textWidth>>1),e.lab_getBack.y+(e.lab_getBack.textHeight>>1)+1,e.box_d),e.eff.scale_X=.7,e.eff.scale_Y=.7):e.clearEff()},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose()),this.eff=null},i.updateSkillUI=function(){this.img_skill.skin=_r.getIconPath("icskill0001"),this.img_skill.width=this.img_skill.height=100,this.txt_skillName.text=RP.n[463],this.html_skillDescr.style.fontSize=24,this.html_skillDescr.x=this.txt_skillName.x,this.html_skillDescr.innerHTML=Ql.createColor(RP.n[464],"#90877b")+Ql.createColor(RP.n[465],"#23b11f")},i.updateRoles=function(){for(var e=this._data.getRoles(),t=0;t<this.roleList.length;t++){var i=this.roleList[t];if(e.length>t){var n=e[t];this["txt_roleName_"+t].text=n.name,i.changeAvatar(n.sex,n.weaponid,n.mid,n.wingid),i.visible=!0,this["sp_rank_"+t].visible=!0}else this["txt_roleName_"+t].text="",i.visible=!1,this["sp_rank_"+t].visible=!1}},i.showAttr=function(e,t,i,n){void 0===n&&(n=!1),e.clear();var s,o,a=aa.formatAttrToChineseByList(t),r=0,l=0,c=3,u=a.length;l=(r=1==u?32:2==u?19:4,36);for(var d=0;d<a.length;d++)s=a[d],n||(o=aa.getAttributById(parseInt(s.id)),e.fillText(o.name+": ",c,r,"24px SimHei",i,"left"),c+=22*mp.getStringLength(o.name+": ")>>1),e.fillText(s.val+"",c,r,"24px SimHei",i,"left"),r+=l,c=3},i.clearAttr=function(e){e.clear()},i.onClick=function(e){var t=this;if(e.currentTarget==t.lab_getBack)if(0<t._data.back_prestige){var i=t._data.pricePrestige,n=t._data.back_prestige;KQ.ins.show(RP.n[466]+Ql.createColor(n*i+"元宝","#23b11f")+"找回"+n+"威望",ql.create(t,t.onAlertHandler),!1)}else zB.ins.playErrorMsg(RP.n[467]);else e.currentTarget==t.btn_goRank?(t._data.rankBack=!0,Tu.sendToModule("SWITCH_TAB_TYPE",["modules.rank.RankModule"],{value:t.prestige_rank_type,backId:"ACHIEVE_NEW_MAIN_VIEW"})):e.currentTarget==t.lab_reward&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._data.getPrestigeWayKey})},i.onAlertHandler=function(e){1==e&&(this._data.pricePrestige*this._data.back_prestige<=gR.ins.YB?WP.reqPretigeBack():zB.ins.playErrorMsg(RP.n[468]))},i.checkRoleHandler=function(e){var t=this._data.getRoles();if(t&&0<t.length){var i=0;e.currentTarget==this.sp_rank_1?i=1:e.currentTarget==this.sp_rank_2&&(i=2);var n=t[i];n&&nR.reqViewOther(n.id)}},t.NAME="PrestigeMainView",t}(),JY=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.achievenew.views.prestige.PrestigePreviewAlert",Wh);var i=t.prototype;return i.init=function(){this.list.itemRender=ZY,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.spaceY=4,this.list.itemRender=ZY;for(var e=[],t=Sn.count-1;0<=t;t--)e.push(t);this.list.array=e},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){this.list.array=null,this.list.scrollBar.off("change",this,this.onScrollChanged),ui.ViewBase.prototype.onRemove.call(this)},i.onClose=function(e){hN.ins.close("PRESTIGE_PREVIEW_PANEL")},t.NAME="PrestigePreviewAlert",t}(),ZY=function(e){function t(){this.m_select_attr_id=69,t.__super.call(this)}return b(t,"modules.achievenew.views.prestige.PrestigePreviewListItem",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){if(null!=e){G.superSet(jh,this,"dataSource",e);var t=Sn.MODEL;if(t){var i=t.picName(e);this.img_lv.skin=_r.getPrestigePath(i),this.txt_value.text=t.minPrestige(e)+""}}}),t}(jh),KY=function(e){function t(){this.index=0,this.activeKey=0,this.c_gid=0,this.c_gnum=0,this.c_exp=0,this.headList=null,this.eff=null,this.img_key="",t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_CardItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_name.text="",this.on("click",this,this.onClickHanlder)},i.onRemove=function(e){var t=this;if(t.setHide(),t.clearActiveEff(),t.off("click",t,t.onClickHanlder),t.headList&&t.headList.length){for(var i=0;i<t.headList.length;i++)t.headList[i]&&t.headList[i].parent&&t.headList[i].parent.removeChild(t.headList[i]);t.headList.splice(0,t.headList.length)}ui.ViewBase.prototype.onRemove.call(t,e)},i.setHide=function(){this.img_red.visible=!1,this.img_gray.visible=this.img_full.visible=!1},i.refresh=function(){var e=this;e.setHide(),e.clearActiveEff();var t=NaN,i=-1;e.activeKey=zP.getCardsLevel(Bt.MODEL.type(e.index),Bt.MODEL.index(e.index)),-1==e.activeKey?(e.sp_star.visible=!1,e.img_red.visible=TR.ins.getGoodsNum(e.c_gid)>=e.c_gnum&&zP.getRedByRole(e.index),e.img_red.visible&&e.setActiveEff("jm1247"),e.img_gray.visible=!e.img_red.visible,t=zP.getBossCardLevelFight(e.index),e.img_pic.filters=A_.getGrayFilter()):(e.img_pic.filters=null,i=Bt.getIndex(e.activeKey),0==Bt.MODEL.nextLevelId(i)?e.img_full.visible=!0:zP.curExp>=Bt.MODEL.levelUpCardExp(i)&&(e.img_red.visible=!0),t=zP.getBossCardLevelFight(i),e.img_red.visible&&e.setActiveEff("jm1245"),e.setLevel(i)),e.font_power.value=t+"",e.fight.width=e.font_power.x+17*e.font_power.value.length+e.font_power.spaceX},i.setLevel=function(e){var t=this;t.sp_star.visible=!0,t.headList=t.headList||[];for(var i=Bt.MODEL.level(e),n=0;n<10;n++)if(n<i){if(!t.headList[n]){var s=new Kl;s.pos(16*n,1),t.headList.push(s),t.headList[n].skin=_r.getAtlasSubPath("tujian/tj_xx_2.png")}t.headList[n].visible=!0,t.headList[n].parent||t.sp_star.addChild(t.headList[n])}else t.headList[n]&&(t.headList[n].visible=!1)},i.setActiveEff=function(e){this.clearActiveEff(),this.eff||(this.eff=kB.createEffect(e,this.img_full.x+55,this.img_full.y+18,this))},i.clearActiveEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.onClickHanlder=function(e){hN.ins.open("TUJIAN_DETAIL_VIEW",{index:this.index,activeKey:this.activeKey})},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.index=Bt.getIndex(e),t.txt_name.text=Bt.MODEL.name(t.index);var i=JSON.parse(Bt.MODEL.goodsComsumption(t.index));t.c_gid=parseInt(i[0].value.toString().split(":")[0]),t.c_gnum=parseInt(i[0].value.toString().split(":")[1]);var n=yB.create(t.c_gid),s=Bi.MODEL.colourId(n.cfgIdx);if(t.txt_name.color=ms.getByQuality(s),t.img_bg.skin=_r.getAtlasSubPath("tujian/tj_fk_s_"+s+".png"),t.img_key="bg_"+Bt.MODEL.type(t.index)+"_"+Bt.MODEL.index(t.index),t.img_pic.skin&&t.img_pic.skin!=_r.getTuJianPathJpg(t.img_key)){var o=yc.getRes(t.img_pic.skin);o&&(o.destroy(),yc.clearRes(t.img_pic.skin),tt.ins.clearTexture(t.img_pic.skin))}t.img_pic.skin=_r.getTuJianPathJpg(t.img_key),t.refresh()}}),t}(_I),$Y=function(e){function t(){this.MAX_NUM=5,this.suitObj=null,this.suitNum=0,this.eff=null,t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_MainView",hI);var i=t.prototype;return i.initialize=function(){var e=this;e.list_card.repeatX=3,e.list_card.itemRender=KY,e.list_card.vScrollBarSkin="",e.list_card.scrollBar.elasticDistance=200,e.list_type.spaceY=5,e.list_type.itemRender=sz,e.list_type.hScrollBarSkin="",e.list_type.scrollBar.elasticBackTime=300,e.list_type.scrollBar.elasticDistance=100,e.list_type.selectEnable=!0,e.txt_suit_num.x=e.img_name.x+148},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.sp_l.visible=t.sp_r.visible=!1,t.img_red_l.visible=t.img_red_r.visible=!1,t.list_card.scrollTo(1),t.list_type.scrollTo(0),t.onScrollEnd(),t.btn_prev.on("click",t,t.onClickHandler),t.btn_next.on("click",t,t.onClickHandler),t.txt_resolve.on("click",t,t.onClickHandler),t.btn_dail.on("click",t,t.onClickHandler),t.list_type.scrollBar.on("end",t,t.onScrollEnd),t.list_card.scrollBar.on("change",t,t.onScrollChanged),t.setCardList(),zP.reqTujianInfo()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),zP.selectType=1,t.btn_prev.off("click",t,t.onClickHandler),t.btn_next.off("click",t,t.onClickHandler),t.txt_resolve.off("click",t,t.onClickHandler),t.btn_dail.off("click",t,t.onClickHandler),t.list_type.scrollBar.off("end",t,t.onScrollEnd),t.list_card.scrollBar.off("change",t,t.onScrollChanged),t.clearResolveEff()},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onScrollEnd=function(){0==this.list_type.scrollBar.value?this.sp_l.visible=!1:this.sp_l.visible=!0,this.list_type.scrollBar.value==this.list_type.scrollBar.max?this.sp_r.visible=!1:this.sp_r.visible=!0,this.setCardList()},i.onScrollChanged=function(){0==this.list_card.scrollBar.max||this.list_card.scrollBar.value>=this.list_card.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.updateByVSC=function(e){if(e&&e.hasOwnProperty("pages"))this.resetPage();else if(this.initInfo(),this.showSuit(),e&&e instanceof protos.achieve.toc_30153)for(var t=this.list_card.startIndex;t<this.list_card.length;t++)this.list_card.getCell(t).refresh();else this.refreshTypeList()},i.resetPage=function(){zP.selectType>this.MAX_NUM&&(this.list_type.scrollTo(3),this.list_type.scrollBar.value=this.list_type.scrollBar.max,this.onScrollEnd())},i.initInfo=function(){var e=this;e.fightNum.value=zP.totalFightNum+Math.floor(zP.totalFightNum*e.checkTitle(16)),e.txt_exp.innerHTML=RP.n[469]+zP.curExp+")",e.list_type.array=zP.typeList,zP.getRedResolve()?e.eff||(e.eff=kB.createEffect("jm1130",e.txt_resolve.x+(e.txt_resolve.textWidth>>1),e.txt_resolve.y+(e.txt_resolve.textHeight>>1)+1,e),e.eff.scale_X=.7,e.eff.scale_Y=.7):e.clearResolveEff()},i.checkTitle=function(e){var t=0,i=tg.ins.toc_title;if(!i)return 0;var n,s=i.titles[0];for(var o in s)if((n=s[o]).id==e&&0<=n.state){var a=co.getIndex(e);t=JSON.parse(co.MODEL.attr(a))[4].value/1e4}else;return t},i.clearResolveEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.refreshTypeList=function(){for(var e=this.list_type.startIndex;e<this.list_type.length;e++)this.list_type.getCell(e).refresh();var t=zP.getCardsListByType(zP.selectType);this.list_card.array=t,this.list_card.scrollTo(zP.getCardsActive(t))},i.setCardList=function(){var e=0,t=0;this.sp_l.visible&&(e=0,t=this.list_type.startIndex,this.img_red_l.visible=zP.getRedByTypeList(zP.typeList.slice(e,t))),this.sp_r.visible&&(e=this.list_type.startIndex+this.MAX_NUM,t=zP.typeList.length,this.img_red_r.visible=zP.getRedByTypeList(zP.typeList.slice(e,t)))},i.showSuit=function(){var e=this;if(e.suitObj=zP.getSuitTotalByType(zP.selectType),e.suitObj){var t=_r.getTuJianPath("name_"+zP.selectType);if(e.img_name.skin&&e.img_name.skin!=t){var i=yc.getRes(e.img_name.skin);i&&(i.destroy(),yc.clearRes(e.img_name.skin),tt.ins.clearTexture(e.img_name.skin))}e.img_name.skin=t,e.suitNum=zP.getSuitActiveNumByType(zP.selectType),e.txt_suit_num.innerHTML=RP.n[470]+Ql.createColor(e.suitNum+"/"+e.suitObj.suitNum,"#23b11f")+")";var n,s,o=0,a=zP.getSuitListByType(zP.selectType);for(o=0;o<a.length;o++)if(n=a[o].cardSuitNum.split(","),0<parseInt(n[1])){if(e.suitNum>=parseInt(n[0])&&e.suitNum<=parseInt(n[1])){s=a[o];break}}else if(e.suitNum>=parseInt(n[0])){s=a[o];break}var r=s?"#23b11f":"#5f5952";s||(s=a[0]);var l=0,c=aa.formatAttrToChineseByList(s.attrs);for(o=0;o<c.length;o++)e["txt_attrs_"+o].text=c[o].addName+"："+c[o].val,e["txt_attrs_"+o].color=r;if(l=c.length,""!=s.zhanAttrs){for(c=aa.formatAttrToChineseByList(s.zhanAttrs),o=l;o<c.length+l;o++)e["txt_attrs_"+o].text=ha.getDesByType(1)+c[o].addName+"："+c[o].val,e["txt_attrs_"+o].color=r;l+=c.length}if(""!=s.faAttrs){for(c=aa.formatAttrToChineseByList(s.faAttrs),o=l;o<c.length+l;o++)e["txt_attrs_"+o].text=ha.getDesByType(2)+c[o].addName+"："+c[o].val,e["txt_attrs_"+o].color=r;l+=c.length}if(""!=s.daoAttrs){for(c=aa.formatAttrToChineseByList(s.daoAttrs),o=l;o<c.length+l;o++)e["txt_attrs_"+o].text=ha.getDesByType(2)+c[o].addName+"："+c[o].val,e["txt_attrs_"+o].color=r;l+=c.length}for(o=0;o<4;o++)e["txt_attrs_"+o].visible=o<l,0<o&&(e["txt_attrs_"+o].x=e["txt_attrs_"+(o-1)].x+e["txt_attrs_"+(o-1)].textWidth+15)}},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.txt_resolve:hN.ins.open("TUJIAN_DECOMPOSE_VIEW");break;case t.btn_dail:hN.ins.open("TUJIAN_SUIT_VIEW");break;case t.btn_prev:var i=t.list_type.startIndex-5;i<0&&(i=0),t.list_type.startIndex!=i&&t.list_type.tweenTo(i,90*(t.list_type.startIndex-i),ql.create(t,t.onScrollEnd));break;case t.btn_next:var n=t.list_type.startIndex+5;n>=t.list_type.length&&(n=t.list_type.length-1),t.list_type.startIndex!=n&&t.list_type.tweenTo(n,90*(n-t.list_type.startIndex),ql.create(t,t.onScrollEnd))}},t}(),ez=function(s){function t(){var e=this;e._CheckId=0,e.data_12202=null,e.activityIds=null,e.vsc=null,e.needCheck=!0,e.mainType=16,t.__super.call(e),e.top=e.bottom=e.left=e.right=0}b(t,"modules.activity.views.hefu.ActivityHeFuMainView",s);var e=t.prototype;return e.initialize=function(){var e=this;e.vsc=new SB(e),e.centerX=e.centerY=0,e.width=720,e.height=1280,$G.targetId<=0&&(e.vsc.openSelectReddot=!0),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onCheckTable,null,!1),e.isTop=!0},e.onAdd=function(e){s.prototype.onAdd.call(this,e),QP.ins.isClickedBack?(QP.ins.isClickedBack=!1,WB.getActivity(this.mainType,ql.create(this,this.onBack))):this.onBack()},e.onBack=function(){this.inteUI(!0),this.checkTable(),this.needCheck=!0},e.onRemove=function(e){s.prototype.onRemove.call(this,e),$G.toSelectIndex=-1},e.destroy=function(e){void 0===e&&(e=!0);for(var t=0;this&&this.navList&&t<this.navList.length;t++){var i=_r.getFullUrl(this.navList[t]),n=yc.getRes(i);n&&(n.destroy(),yc.clearRes(i),tt.ins.clearTexture(i))}s.prototype.destroy.call(this,e)},e.onSubChanged=function(e,t){var i=parseInt(e);if(It.hasIndex(i)){var n=It.getIndex(i),s="activity/"+It.MODEL.titleUI(n)+".png";this.setTitle(_r.getAtlasSubPath(s))}},e.checkInte=function(){this.inteUI(!0)},e.update=function(e){var t=this;0==e&&t.checkInte(),t._CheckId=e,t.vsc.updateItemEnabled(),t.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuChargeProfitView&&t.vsc.selectedView.updateSelect?t.vsc.selectedView.updateSelect():t.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuLoginView&&t.vsc.selectedView.update?t.vsc.selectedView.update():t.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuAthleticsView?t.vsc.selectedView.updateList&&t.vsc.selectedView.updateList():t.vsc.selectedView.onReqBack?t.vsc.selectedView.onReqBack():t.vsc.updateSelectedView(e),t.activityIds&&0<t.activityIds.length&&(t.data_12202=mB.getInStance().getMainType(t.mainType),t.data_12202&&!JP.isEqual(t.activityIds,t.data_12202.activityIds)&&t.inteUI(!0))},e.tabCheckInte=function(e){if(this._CheckId=e,this.needCheck)return this.checkTable(),void(this.needCheck=!1)},e.inteUI=function(e){var t=this;void 0===e&&(e=!1),t.data_12202=mB.getInStance().getMainType(16);var i=0;if(t.data_12202){t.isTop=!0,t.mouseThrough=!0,t.navList=[],t.activityIds=t.data_12202.activityIds,e&&t.vsc.selectedView&&(t.vsc.selectedView.parent&&t.vsc.selectedView.parent.removeChild(t.vsc.selectedView),t.vsc.selectedView.destroy());var n,s=[];for(i=0;i<t.activityIds.length;++i){var o=t.activityIds[i],a=It.getIndex(o);if(16==It.MODEL.mainType(a)){n="ui/layouts/activityTab/"+It.MODEL.tableUI(a)+".png",t.navList.push(n);var r=It.MODEL.uiType(a),l=-1<QP.IS_HIDE_BG.indexOf(r);s.push({cls:QP.getClass(r),id:o,data:o,isHideBg:l})}}t.vsc.registAll(s),e?(t.layout.setNavList(t.navList,!0),t.vsc.invalidTab()):t.vsc.invalid(),-1!=$G.toSelectIndex&&(t.vsc.selectedIndex=$G.toSelectIndex)}},e.checkTable=function(){this._CheckId=0,this.vsc.updateItemEnabled()},e.onCheckTable=function(e,t){var i=parseInt(e);if(It.MODEL.vipLimit(It.getIndex(i))>gR.ins.VIPLevel)return 2;var n=mB.getInStance().getMainType(16);if(n&&n.fActivityIds){var s=mB.getInStance().getActivityData(i);if(8==It.MODEL.type(It.getIndex(i)))return QP.ins.needToShowVIPTip||QP.ins.needToShowWelfareTip?3:0;if(-1!=n.fActivityIds.indexOf(i))return s&&this._CheckId==s.activityId&&s.gifts&&!s.hasComGift()?(n.fActivityIds.splice(n.fActivityIds.indexOf(i),1),0):3;if(s&&this._CheckId==s.activityId){if(s.gifts&&s.hasComGift())return n.fActivityIds.push(s.activityId),3;if(8==It.MODEL.type(It.getIndex(i)))return QP.ins.needToShowVIPTip||QP.ins.needToShowWelfareTip?3:0}return 0}return 0},e.updateByVSC=function(e){this.vsc&&this.vsc.selectedView&&this.vsc.updateItemEnabled()},p(0,e,"tab",function(){return this.layout?this.layout.bottom_nav.tab:null}),t.NAME="ActivityHeFuMainView",t}(Ip),tz=function(e){function t(){this.gItem=null,this.gList=null,this.addExp=0,t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_ResolveItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_resolve.on("click",this,this.onClickHanlder)},i.onRemove=function(e){this.btn_resolve.off("click",this,this.onClickHanlder),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClickHanlder=function(e){!this.gList||this.gList.length<1||(zP.addExp=this.addExp,zP.reqTujianResolve(this.gList))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){var i,n=TR.ins.getGoodsNum(e.gid);i=yB.create(e.gid,n),t.gItem||(t.gItem=new MF,t.gItem.pos(16,20),t.gItem.size(116,116),t.addChild(t.gItem)),t.gItem.bindData=i,t.addExp=e.cardExp*n,t.txt_name.changeText(i.name),t.txt_exp.changeText(RP.n[471]+t.addExp),t.gList&&0<t.gList.length&&t.gList.splice(0,t.gList.length),t.gList=[{gid:e.gid,gnum:n}]}}),t}(pI),iz=function(e){function t(){this.curList=null,t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_ResolveView",gI);var i=t.prototype;return i.initialize=function(){this.list.spaceY=12,this.list.itemRender=tz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticDistance=200},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_no.visible=!1,t.list.visible=!1,t.btn_close.on("click",t,t.onClickHandler),t.list.scrollBar.on("change",t,t.onScrollChanged),t.initInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onAdd.call(this,this.onRemove),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.initInfo=function(){var e=this;e.curList=zP.getResolvelist(),0<e.curList.length?(e.txt_no.visible=!1,e.list.visible=!0,e.list.array=e.curList,e.g_mask.visible=5<e.list.array.length):(e.txt_no.visible=!0,e.list.visible=!1)},i.updateToc=function(){this.initInfo()},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),nz=function(e){function t(){t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_SuitItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_level.changeText(""),this.txt_total.changeText(""),this.txt_current.changeText("")},i.getJobAttrs=function(e,t){for(var i="",n=0;n<e.length;n++)i+=ha.getDesByType(t)+e[n].addName+" ： "+e[n].val,i+="\n";return i},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.txt_level.changeText(e.suitLevel+"阶");var i=e.cardSuitNum.split(",");t.txt_total.changeText(RP.n[472]+i[0]),t.img_line.visible=0!=parseInt(i[1]);var n=zP.getSuitActiveNumByType(e.type),s=n>=parseInt(i[0])?"#23b11f":"#5f5952";t.txt_current.changeText(Math.min(parseInt(i[0]),n)+"/"+i[0]),t.txt_current.color=s;var o=0,a=0,r=aa.formatAttrToChineseByList(e.attrs);for(o=0;o<4;o++)t["txt_arr_"+o].color=s,t["txt_arr_"+o].changeText(vp.trim(r[o].name)+"+"+r[o].val);if(a=r.length,""!=e.zhanAttrs){for(r=aa.formatAttrToChineseByList(e.zhanAttrs),o=a;o<r.length+a;o++)t["txt_arr_"+o].changeText(ha.getDesByType(1)+r[o].addName+"："+r[o].val),t["txt_arr_"+o].color=s;a+=r.length}if(""!=e.faAttrs){for(r=aa.formatAttrToChineseByList(e.faAttrs),o=a;o<r.length+a;o++)t["txt_arr_"+o].changeText(ha.getDesByType(2)+r[o].addName+"："+r[o].val),t["txt_arr_"+o].color=s;a+=r.length}if(""!=e.daoAttrs){for(r=aa.formatAttrToChineseByList(e.daoAttrs),o=a;o<r.length+a;o++)t["txt_arr_"+o].changeText(ha.getDesByType(2)+r[o].addName+"："+r[o].val),t["txt_arr_"+o].color=s;a+=r.length}for(o=0;o<4;o++)t["txt_arr_"+o].visible=o<a}}),t}(vI),sz=function(e){function t(){this.type=0,t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_TypeItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_red.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.refresh=function(){this.img_red.visible=zP.getRedByType(this.type),this.img_selected.skin=_r.getAtlasSubPath("tujian/tj_tz_yuan_"+(this.type==zP.selectType?2:1)+".png")},i.onClickHandler=function(e){this.type!=zP.selectType&&(zP.selectType=this.type,hN.ins.open("ACHIEVE_NEW_MAIN_VIEW",{_subIndex_:parseInt("1"),refreshType:this.type},null,!0))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){if(this.type=e,this.img_icon.skin&&this.img_icon.skin!=_r.getTuJianPath("icon_"+e)){var t=yc.getRes(this.img_icon.skin);t&&(t.destroy(),yc.clearRes(this.img_icon.skin),tt.ins.clearTexture(this.img_icon.skin))}this.img_icon.skin=_r.getTuJianPath("icon_"+e),this.refresh()}}),t}(II),oz=function(e){function t(){t.__super.call(this),this.list_hurt.right=0,this.list_hurt.vScrollBarSkin="",this.list_hurt.scrollBar.elasticDistance=200,this.list_hurt.itemRender=Ha,this.list_hurt.dataSource=[]}b(t,"modules.activity.views.festivalboss.FestivalBossMainView",dm);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=uH.getHero(4);t&&NF.scene.removeItem(t),this.txt_rank.text="未上榜",this.txt_hurt.align="center",this.btn_zhuwei.on("click",this,this.onClickZhuWeiEvent),this.txt_addHurt.text=RP.n[473],sH.startInstantFight()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clearAll(this),this.btn_zhuwei.off("click",this,this.onClickZhuWeiEvent)},i.showZhuWeiHurt=function(e){this.txt_addHurt.text=RP.n[474]+20*e+"%"},i.showGuildCurrentHurt=function(e){this.txt_noHurt.visible=e.length<=0;var t=0;for(t=0;t<e.length;t++)if(e[t].name==gR.ins.charName){this.txt_rank.text="第"+e[t].rank+"名",1e8<e[t].hurt?this.txt_hurt.text=(e[t].hurt/1e8).toFixed(2)+"亿":1e4<e[t].hurt?this.txt_hurt.text=Math.floor(e[t].hurt/1e4)+"万":this.txt_hurt.text=e[t].hurt+"";break}this.list_hurt.dataSource=e},i.onClickZhuWeiEvent=function(e){hN.ins.open("FESTBOSS_GUWU_VIEW")},t}(),az=function(e){function t(){if(this.bossData=null,this.actId=0,this.iconId=0,this.goodsArr=null,t.__super.call(this),ii.count<=0){var e=[{url:_r.getJxrDBPath("FestivalRewardShow"),type:"arraybuffer",cls:ii}];uc.ins().onLoadJxrs(e,ql.create(this,this.initUI))}else this.initUI()}b(t,"modules.activity.views.festivalboss.FestivalBossShowAward",hm);var i=t.prototype;return i.initUI=function(){this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticBackTime=300,this.list_rank.scrollBar.elasticDistance=100,this.list_rank.spaceY=6,this.bossData=$P.ins,this.initText(),this.setAward()},i.setAward=function(){var e=this;if(e.actId=$P.ins.actId,0==e.actId){e.iconId=$P.ins.iconId;var t=ci.getIndex(e.iconId);e.actId=ci.MODEL.actId(t)}var i=ii.getIndex(e.actId),n=ii.MODEL.showReward(i);e.goodsArr=n.split("|");ii.count,e.list_rank.array=e.goodsArr,e.list_rank.renderHandler=ql.create(e,e.onListRender,null,!1)},i.onListRender=function(e,t){e.img_r_1.visible=t+1==1,e.img_r_2.visible=t+1==2,e.img_r_3.visible=t+1==3,3<t+1?(e.txt_rank.visible=!0,e.txt_rank.text="参与奖"):e.txt_rank.visible=!1;for(var i=this.goodsArr[t].split(";"),n=0;n<2;n++){var s=e["grid"+n];if(null==s&&((s=new MF(116)).font="20px SimHei",s.x=e["img_award"+n].x,s.y=e["img_award"+n].y,e.addChild(s),e["grid"+n]=s),n<i.length){s.visible=!0;var o=i[n].split(","),a=parseInt(o[0]),r=parseInt(o[1]),l=yB.create(a,r);s.bindData=l,e["txt_award"+n].changeText(Bi.MODEL.name(l.cfgIdx))}else s.visible=!1,e["txt_award"+n].changeText("")}},i.close=function(){hN.ins.close("FESTBOSS_SHOWAWARD_VIEW")},i.onClick=function(e){e.target==this.btn_close&&this.close()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick),0!=JP.ins.isLinkToView&&(JP.ins.isLinkToView=0)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick),this.setAward()},i.initText=function(){0<this.bossData.toc21272.myrank?this.txt_rank.changeText(this.bossData.toc21272.myrank+""):this.txt_rank.changeText("未上榜")},t}(),rz=function(e){function t(){this.bossData=null,t.__super.call(this),this.centerX=this.centerY=0,this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticDistance=200,this.list_rank.itemRender=Ba,this.list_rank.dataSource=[],this.bossData=$P.ins}b(t,"modules.activity.views.festivalboss.FestivalBossRankView",_m);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_rank.visible=t.txt_hurtValue.visible=t.label_hurt.visible=t.lable_my.visible=!1,t.btn_close.on("click",t,t.onClickCloseEvent),t.list_rank.dataSource=t.bossData.toc21272.hurtList,t.txt_rank.text="0",t.txt_hurtValue.text="0"},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent)},i.onClickCloseEvent=function(e){hN.ins.close("FESTBOSS_RANK_VIEW")},t}(),lz=function(e){function t(){this.bossData=null,t.__super.call(this),this.centerX=this.centerY=0,this.html_desc.style.font="SimHei",this.html_desc.style.fontSize=24,this.html_desc.style.color="#90877b",this.html_desc.style.align="center",this.bossData=$P.ins}b(t,"modules.activity.views.festivalboss.FestivalBossGuWuView",pm);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.btn_enter.on("click",this,this.onClickCloseEvent);var t=di.MODEL.damagePercent(1);this.txt_cost.text=di.MODEL.costGold(1)+"",this.html_desc.innerHTML=RP.n[475]+Ql.createColor(t+"%伤害","#23b11f")},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent),this.btn_enter.off("click",this,this.onClickCloseEvent)},i.refreshGuildZWNum=function(e){var t=di.getIndex(e),i=di.MODEL.damagePercent(t);this.txt_hurt.text=e*i+"%"},i.refreshNum=function(e){if(1==e.type){this.bossData.gwNums+=1;var t=di.count;this.bossData.gwNums>=t?this.txt_zwNum.color="#ff2e24":this.txt_zwNum.color="#23d11f",this.txt_zwNum.text="("+(t-this.bossData.gwNums)+"/"+t+")"}this.refreshGuildZWNum(this.bossData.gwNums)},i.showCurrentZhuWei=function(){$P.ins.toc25007;var e=di.getIndex(1),t=di.MODEL.damagePercent(e);this.txt_hurt.text=this.bossData.gwNums*t+"%";var i=di.count;this.bossData.gwNums>=i?this.txt_zwNum.color="#ff2e24":this.txt_zwNum.color="#23d11f",this.txt_zwNum.text="("+(i-this.bossData.gwNums)+"/"+i+")"},i.onClickCloseEvent=function(e){if(e.target==this.btn_close)hN.ins.close("FESTBOSS_GUWU_VIEW");else if(e.target==this.btn_enter)if(this.bossData.gwNums>=di.count)zB.ins.showById(4364,1);else if(di.MODEL.costGold(1)>gR.ins.YB)KQ.ins.showNoGold();else{var t=this.bossData.toc21272.bossInfo.bossId;$P.ins.reqFestBossGUWU(t)}},t}(),cz=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuAthleticsItemView",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new vj(4),e._gridsList.pos(-30,-35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.sp.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this.gvo=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;e.img_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status||3==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.showTip?e.btn_award.label="可领取":e.btn_award.label=3==e.gvo.status?"已领完":"未达成"),e.activityId==JP.A_ID_1057?(e.txt_times.visible=!1,e.txt_gold.innerHTML=St.MODEL.content(e.index)+"达到："+JP.getSoluLevel(e.gvo.targetValue)):"COMBINE_LOGIN_TIMES"==St.MODEL.targetParamType1(e.index)?e.txt_gold.innerHTML=St.MODEL.content(e.index):e.txt_gold.innerHTML=St.MODEL.content(e.index)+"达到："+e.gvo.targetValue},i.onClickHanlder=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.activityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo())}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t,i=this;e&&(i.gvo=e,i.gvo&&(i.activityId=i.gvo.owerActivity,i.index=St.getIndex(i.gvo.giftId),(t=-1<n.loginPlat.indexOf(i.activityId)?n.getAwardsByGid(i.gvo.giftId,n.getAwards()):St.MODEL.goodsReward(i.index))&&(i._gridsList.setGoodsItems(t,3),i._gridsList.width=460,i._gridsList.list.scrollTo(0)),i.showInfo()))}),t}(E),uz=function(e){function t(){this.giftVO=null,this.grid=null,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuChargeProfitDayView",d);var i=t.prototype;return i.initialize=function(){this.grid||(this.grid=new MF,this.grid.isClearUrl=!0,this.grid.size(93,93),this.grid.pos(0,0),this.grid.toolTipEnabled=!1,this.addChildAt(this.grid,1))},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onBoxClicked)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.grid&&(this.grid.removeSelf(),this.grid.destroy(),this.grid=null)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.on("click",this,this.onBoxClicked)},i.updateData=function(e){e&&(this.giftVO=e),this.refresh()},i.refresh=function(){var e=this;if(e.giftVO){e.giftVO.giftId==QP.ins.selectId?e.img_selected.visible=!0:e.img_selected.visible=!1,2<=e.giftVO.status?e.img_isGet.visible=!0:e.img_isGet.visible=!1,e.img_red.visible=1==e.giftVO.status;var t=St.getIndex(e.giftVO.giftId),i=St.MODEL.targetParam1(t),n=St.MODEL.goodsReward(t).split(";")[0].split(","),s=yB.create(parseInt(n[0]),parseInt(n[1]));if(s&&(e.grid.dataSource=s),i){var o=i.split(",");o&&1<o.length?e.txt_day.text="累充"+o[1]+"天":e.txt_day.text=RP.n[476]}}else e.img_isGet.visible=!1,e.img_red.visible=!1},i.onBoxClicked=function(e){this.giftVO&&QP.ins.selectId!=this.giftVO.giftId&&(QP.ins.selectId=this.giftVO.giftId,Tu.sendToModule("UPDATE_HEFU_TEHUI_SELECTED",["modules.activity.ActivityModule"],this.giftVO.owerActivity))},t}(),dz=function(e){function t(){this.levelVO=null,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuChargeProfitItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_redPt.visible=!1,this.g_select.visible=this.g_icon.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.refresh=function(){this.levelVO&&(this.g_icon.visible=this.levelVO.isAllGet,this.g_select.visible=this.levelVO.level==QP.ins.currentSelectedLevel+1,this.setRedPt(),this.g_item.filters=this.g_icon.visible?A_.getGrayFilter3():null)},i.setRedPt=function(){this.levelVO.isAllGet?this.g_redPt.visible=!1:this.g_redPt.visible=this.levelVO.isHasBuy},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.g_item&&this.g_item.skin&&G.loader.clearRes(this.g_item.skin)},i.onClickHandler=function(e){this.levelVO&&this.levelVO.currentLevel!=QP.ins.currentSelectedLevel+1&&(QP.ins.currentSelectedLevel=this.levelVO.level-1,QP.ins.selectId=-1,Tu.sendToModule("UPDATE_HEFU_TEHUI_SELECTED",["modules.activity.ActivityModule"],this.levelVO.ownActivity))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&(this.levelVO=e,this.g_item.skin=_r.getFullUrl("ui/images/activity/hefu/profit/item_"+(this.levelVO.currentLevel-1)+".png"),this.refresh())}),t}(i),hz=function(e){function t(){var e=this;e.acitivityId=0,e.actInfo=null,e._currentSelectedGiftVO=null,e._giftLevelArr=null,e._dayLevelArr=null,e._currentSelectLevelIndex=0,e._currentDaySelectedIndex=0,e.g_items=null,e._gbox=null,e.GRAP_X=145,e.GRAP_Y=146,e.GIFTARR=null,e.MAX_NUM=4,e.gLen=0,e.curPage=0,e.ITEM_GRAP_X=150,e.imgList=null,e.isRefresh=!1,e.selectIndex=0,e._BAR_W=0,e.curIndex=0,e.eTime=NaN,e.bTween=null,e.tween=null,t.__super.call(e),e._gbox||(e._gbox=new dt,e._gbox.pos(0,670),e.box_c.addChild(e._gbox)),e._panel.hScrollBarSkin="",e._panel.hScrollBar.elasticBackTime=300,e._panel.hScrollBar.elasticDistance=100,e.initView()}b(t,"modules.activity.views.hefu.ActivityHeFuChargeProfitView",h);var i=t.prototype;return i.initView=function(){var e;this._dayLevelArr=[];for(var t=0;t<3;t++)(e=new uz).name=(t+1).toString(),this.box_c.addChild(e),this._dayLevelArr.push(e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.curIndex=1,t.img_title_left.skin=_r.getFullUrl("ui/images/activity/hefu/profit/hfhd_text_mrcz1.png"),t.img_title_right.skin=_r.getFullUrl("ui/images/activity/hefu/profit/hfhd_text_mrcz2.png"),t.isRefresh=!1,t.btn_buy.on("click",t,t.onClickHandler),t.btn_pre.on("click",t,t.onClickHandler),t.btn_next.on("click",t,t.onClickHandler),t._panel.hScrollBar.on("end",t,t.onScrollEnd),G.timer.loop(100,t,t.onTime)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.actInfo=null,t._currentSelectedGiftVO=null,G.timer.clearAll(t),G.timer.clear(t,t.onResetTime),t.btn_buy.off("click",t,t.onClickHandler),t.btn_pre.off("click",t,t.onClickHandler),t.btn_next.off("click",t,t.onClickHandler),QP.ins.selectId=-1,QP.ins.currentSelectedLevel=-1,t._panel.hScrollBar.off("end",t,t.onScrollEnd);for(var i=0;i<t.gLen;i++){var n=t.imgList[i];n&&(n.parent&&n.removeSelf(),n.destroy(),t.imgList[i]=null)}t.imgList&&0<t.imgList.length&&t.imgList.splice(0,t.imgList.length),t.tween&&t.tween.clear(),t.bTween&&t.bTween.clear(),t._gbox&&t._gbox.graphics.clear(),t.clearItems(),eU.targetId=0},i.onTime=function(){var e=this;null!=e.actInfo&&(e.eTime=e.actInfo.endTime-dr.serverTimeSec,0<e.eTime?1<=Math.floor(e.eTime/86400)?e.txt_time.innerHTML=Ql.createColor(Jp.getSTRDHMS(e.eTime),"#23b11f"):e.txt_time.innerHTML=Ql.createColor(Jp.getSTRDHMS(e.eTime),"#ff2e24"):(e.txt_time.innerHTML=Ql.createColor("已结束","#ff2e24"),G.timer.clear(e,e.onResetTime)))},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.bg&&t.bg.skin&&""!=t.bg.skin&&G.loader.clearRes(t.bg.skin),t.img_title&&t.img_title.skin&&""!=t.img_title.skin&&(G.loader.clearRes(t.img_title.skin),tt.ins.clearTexture(t.img_title.skin)),laya.ui.View.prototype.destroy.call(t,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),null!=e.actInfo){var t=It.getIndex(e.acitivityId),i=It.MODEL.secondtitleui(t);if(null!=i){var n=i.split(",");if(1<n.length){var s=_r.getOsNewPath("title/"+n[0]);e.img_title.loadImage(s,0,0,0,0,ql.create(e,e.onComplete,[n[1],s]))}e.updateGiftsData(),e.updateBox(),e.setSelect(),e.updateDay(),e.updateBar()}}},i.onComplete=function(e,t){this.img_title.skin=t,this.img_title.x=(this.width-this.img_title.width)/2},i.updateGiftsData=function(){var e,t;this._giftLevelArr=[],this.gLen=this.actInfo.gifts.length;for(var i,n=0,s=0,o=1,a=0;a<this.gLen;a++)e=this.actInfo.gifts[a],n=parseInt(St.MODEL.targetParam2(e.index)),0<a&&(t=this.actInfo.gifts[a-1],s=parseInt(St.MODEL.targetParam2(t.index))),(null==t||s<n)&&((i=new XP).level=o,this._giftLevelArr.push(i),o++),i.pushGift(e)},i.updateBox=function(){var e=this,t=0,i=e._giftLevelArr.slice(),n=0;if(!e.imgList||e.imgList.length<1){var s=0;if(i.length<4)switch(i.length){case 3:n=98-e._panel.x,s=46;break;case 2:n=150-e._panel.x,s=132;break;case 1:n=288-e._panel.x,s=0}else s=5;for(e.imgList=[],t=0;t<i.length;t++){var o=e.gItem;o.name=String(t),o.pos(n+t*(s+148)+o.pivotX,o.pivotY),o.dataSource=i[t],e.imgList.push(o)}}else for(var a=0;a<i.length;a++)(o=e.imgList[a]).dataSource=i[a],o.refresh();i.length<5?(e.btn_next.visible=!1,e.btn_pre.visible=!1,e._panel.hScrollBar.max=1):e._panel.hScrollBar.max=137*i.length},i.findLevelByGiftID=function(e){for(var t,i,n=0;n<this._giftLevelArr.length;n++){t=this._giftLevelArr[n];for(var s=0;s<t.giftArr.length;s++)if(i=t.giftArr[s],e<=0){if(i.status<2)return[n,s]}else if(i.giftId==e)return[n,s]}return[0,0]},i.updateDay=function(){var e,t=this._giftLevelArr[this._currentSelectLevelIndex],i=0;2==t.giftArr.length?i=176:3==t.giftArr.length&&(i=84);for(var n=0;n<3;n++){var s=t.giftArr[n];e=this._dayLevelArr[n],s?(e.visible=!0,e.updateData(s),e.y=this.txt_days.y-e.height/3,e.x=this.txt_days.x+(n+1)*e.width+i*(n+1)-e.width/2):e.visible=!1}},i.setSelect=function(){var e,t=this;if(QP.ins.selectId<0)if(QP.ins.currentSelectedLevel<0){for(var i=0;i<t.actInfo.gifts.length;i++)if((e=t.actInfo.gifts[i]).status<2){QP.ins.selectId=e.giftId;break}}else{for(var n=t._giftLevelArr[QP.ins.currentSelectedLevel],s=0;s<n.giftArr.length;s++)if((e=n.giftArr[s])&&e.status<2){QP.ins.selectId=e.giftId;break}QP.ins.selectId<0&&(QP.ins.selectId=n.giftArr[0].giftId)}var o=t.findLevelByGiftID(QP.ins.selectId);if(t._currentDaySelectedIndex=o[1],QP.ins.currentSelectedLevel=t._currentSelectLevelIndex=o[0],t._currentSelectedGiftVO=t.getInfo(QP.ins.selectId),t._currentSelectedGiftVO){St.MODEL.targetParam1(t._currentSelectedGiftVO.index);var a=St.MODEL.targetParam1(t._currentSelectedGiftVO.index).split(",");t.font_charge.value=a[0],t.font_day.value=a[1];_r.getOsNewPath("gift/icon_"+t._currentSelectedGiftVO.giftId);for(var r=0;r<t.gLen;r++)t.imgList[r]&&t.imgList[r].refresh();t.setAwards(),t.showCost(),t.txt_days.changeText(t._currentSelectedGiftVO.rechargeDays.toString());var l=t._currentSelectedGiftVO.updateTime,c=new Date(1e3*l),u=new Date(dr.curServerTime);0<l&&c.getDate()!=u.getDate()?t.txt_pay.innerHTML=RP.n[477]+"0":t.txt_pay.innerHTML=RP.n[478]+t._currentSelectedGiftVO.recharge}},i.updateBar=function(){var e,t,i,n,s,o=this._giftLevelArr[this._currentSelectLevelIndex],a=0,r=0,l=0,c=-1,u=0;if(o){var d;switch(o.giftArr.length){case 2:u=200;break;case 3:u=100}for(var h=0;h<3;h++)(d=this["bar_"+h]).visible=!0,h<=o.giftArr.length-1?(i=d.scrollRect||new u_(0,0,u,d.height),1<(a=0==h?(e=o.giftArr[h],c=St.getIndex(e.giftId),(n=St.MODEL.targetParam1(c))&&(s=n.split(","))&&1<s.length&&(r=parseInt(s[1])),(l=e.rechargeDays)/r):(t=o.giftArr[h-1],e=o.giftArr[h],c=St.getIndex(t.giftId),(n=St.MODEL.targetParam1(c))&&(s=n.split(","))&&1<s.length&&(l=parseInt(s[1])),c=St.getIndex(e.giftId),(n=St.MODEL.targetParam1(c))&&(s=n.split(","))&&1<s.length&&(r=parseInt(s[1])),e.rechargeDays-l<0?0:(e.rechargeDays-l)/(r-l)))&&(a=1),i.width=u*a,d.x=this.txt_days.x+40+93*h+h*u-20*h,d.scrollRect=i):d.visible=!1}},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[],e._gbox&&e._gbox.graphics.clear();for(var t=e._currentSelectedGiftVO.rewardGoods,i=0;i<t.length;i++){var n=new MF;n.bindData=t[i],8<=t.length?n.pos(81+i%4*e.GRAP_X,Math.floor(i/4)*e.GRAP_Y):n.pos((0<Math.floor(i/3)?220:138)+i%3*164,Math.floor(i/3)*e.GRAP_Y),e.g_items.push(n),e._gbox.addChild(n);var s=Bi.MODEL.simpleName(Bi.getIndex(t[i].goodsId)),o=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(t[i].goodsId)));e._gbox.graphics.fillText(s,n.x+57,n.y+119,"20px SimHei",o,"center")}},i.showCost=function(){var e=this;switch(e.btn_buy.gray=!1,e.btn_buy.mouseEnabled=!0,e.img_isGet.visible=!1,e.btn_buy.visible=!0,e._currentSelectedGiftVO.status){case 1:e.btn_buy.label="可领取",e.btn_buy.showTip=!0;break;case 2:e.btn_buy.label="已领取",e.btn_buy.gray=!0,e.btn_buy.mouseEnabled=!1,e.btn_buy.showTip=!1,e.img_isGet.visible=!0;break;default:e.btn_buy.label=RP.n[479],e.btn_buy.showTip=!1}e.txt_time.visible=2!=e._currentSelectedGiftVO.status},i.resetrShow=function(){},i.update=function(e){void 0===e&&(e=!1),this.initShow(e),this.setSelect(),this.resetPage();var t=this.actInfo.endTime-dr.serverTimeSec;0<t?(this.txt_time.innerHTML=Jp.getSTRDHMS(t),G.timer.frameLoop(10,this,this.onResetTime)):this.txt_time.innerHTML="已结束"},i.initShow=function(e){if(!(e&&0<QP.ins.selectId))for(var t=!1,i=0;i<this.gLen;++i){var n=this.actInfo.currentGift[i];t||1==n.status&&(QP.ins.selectId=n.giftId,t=!0)}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onResetTime=function(){var e=this.actInfo.endTime-dr.serverTimeSec;0<e?this.txt_time.innerHTML=Ql.createColor(Jp.getSTRDHMS(e),"#23b11f"):(G.timer.clear(this,this.onResetTime),this.txt_time.innerHTML=Ql.createColor("已结束","#ff2e24"))},i.updateSelect=function(){this.setSelect()},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_buy:if(!t._currentSelectedGiftVO)return;if(t._currentSelectedGiftVO.status<1)return void(HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet?hN.ins.open("FIRST_RECHARGE",null):hN.ins.open("RECHARGE_VIEW",null,0));t.selectIndex=t.getSIndex(t._currentSelectedGiftVO.giftId),QP.ins.selectId=-1,QP.ins.currentSelectedLevel=-1,WB.getGift(t._currentSelectedGiftVO.giftId,ql.create(t,t.updateByVSC,[t.acitivityId]));break;case t.btn_pre:t.bTween&&t.bTween.clear(),t.bTween=Og.to(t._panel.hScrollBar,{value:0},300,null,ql.create(t,t.onScrollEnd),0,!0);break;case t.btn_next:t.bTween&&t.bTween.clear(),t.bTween=Og.to(t._panel.hScrollBar,{value:t._panel.hScrollBar.max},300,null,ql.create(t,t.onScrollEnd),0,!0)}},i.resetPage=function(){this.getSIndex(QP.ins.selectId)>=this.MAX_NUM?this._panel.hScrollBar.value=this._panel.hScrollBar.max:this.GIFTARR.indexOf(QP.ins.selectId)<=1&&(this._panel.hScrollBar.value=0),this.onScrollEnd()},i.onScrollEnd=function(){0==this._panel.hScrollBar.value?this.btn_pre.visible=!1:this.btn_pre.visible=!0,this._panel.hScrollBar.value==this._panel.hScrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.getIsHasCompleted=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++)if(e[t].status<2)return!0;return!1},i.onPlayTween=function(e){for(var t=this,i=0;i<t.gLen;i++)t.imgList[i]&&t.imgList[i].setRedPt();t.getIsHasCompleted(t.actInfo.gifts)?(t.imgList[e].pivotX=70,t.imgList[e].x+=70,t.tween=Og.to(t.imgList[e],{alpha:0,scaleX:0,scaleY:0},500,null,ql.create(t,t.onTweenComplete,[e]))):t.onResetItem(e)},i.onTweenComplete=function(e){var t=this,i=t.imgList[e];t.imgList.push(i),t.imgList.splice(e,1),G.timer.once(300,t,t.onResetItem,[t.imgList.length-1]);for(var n=e;n<t.gLen;n++)t.imgList[n]&&(t.imgList[n].name=n,t.imgList[n].pivotX=0,Og.to(t.imgList[n],{x:n*t.ITEM_GRAP_X+t.imgList[n].pivotX},300))},i.onResetItem=function(e){var t=this.imgList[e];t&&(t.alpha=1,t.scaleX=t.scaleY=1,t.pivotX=0,this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.actInfo.gifts=ol.srotOn(this.actInfo.gifts,"extParams",Array.NUMERIC)),t.dataSource=this.getInfo(t.gvo.giftId),this.update())},i.sortArray=function(e,t){var i=0,n=0;return(i=0==e.status?5:1==e.status?7:9)==(n=0==t.status?5:1==t.status?7:9)?-(e.id-t.id):i-n},i.getSIndex=function(e){for(var t=0;t<this.gLen;t++)if(this.imgList[t]&&this.imgList[t].gvo&&this.imgList[t].gvo.giftId==e)return t;return 0},i.getInfo=function(e){for(var t=0;t<this.actInfo.gifts.length;t++)if(this.actInfo.gifts[t]&&this.actInfo.gifts[t].giftId==e)return this.actInfo.gifts[t];return this.actInfo.gifts[0]},p(0,i,"gItem",function(){var e=new dz;return e.pivotY=74,this._panel.addChild(e),e}),t.MAX_DAY_LEVEL=3,t.MAX_REWARD_SHOW=6,t.TWO_DAY_SPACE=176,t.THREE_DAY_SPACE=84,t}(),_z=function(e){function t(){this.HIDE_ARR=[3,23,26,29],this._grids=new Array,this._labs=new Array,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuRankNewItem",e);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearMe()},i.clearMe=function(){for(;this._grids.length;){var e=this._grids.pop();e&&e.removeSelf(),e&&e.destroy(),e=null}for(;this._labs.length;){var t=this._labs.pop();t&&t.removeSelf(),t&&t.destroy(),t=null}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){var i;t.clearMe(),e.rankInfo&&0<e.rankInfo.length&&(i=e.rankInfo[0]);var n=0,s=e.giftInfo;if(i){t.txtName.visible=!0;var o="";if(e.rank<4)for(n=0;n<e.rankInfo.length;n++)0==n&&e.rankInfo[n]&&(o+=0<n?"、":"",o+=e.rankInfo[n].charName);t.txtName.innerHTML=o,t.txt_times.visible=e.rank<4,t.txt_times.visible&&(1==i.rankType?0==i.value?t.txt_times.innerHTML=i.level+"级":t.txt_times.innerHTML=i.value+"转"+i.level+"级":19==i.rankType?t.txt_times.innerHTML=JP.getSoluLevel(i.value):-1<t.HIDE_ARR.indexOf(i.rankType)?t.txt_times.visible=!1:t.txt_times.innerHTML=e.valueName+"："+i.value+JP.getWordsByRtype(i.rankType))}else e.rank<4?t.txtName.innerHTML=RP.n[480]:t.txtName.innerHTML="",t.txt_times.visible=!1;if(s){if(t.txtRank.innerHTML=s.name+"：",t.txtName.x=t.txtRank.x+t.txtRank.contextWidth+4,!s.rewardGoods)return;for(n=0;n<s.rewardGoods.length;n++){var a=s.rewardGoods[n];if(a){var r=new MF;r.bindData=a,r.size(116,116),r.pos(146*n+50,56);var l=new fc;l.fontSize=20,l.width=116,l.align="center",l.x=146*n+50,l.y=176,l.text=a.name,l.color=ms.getByQuality(a.colourId),t.addChild(l),t.addChild(r),t._grids.push(r),t._labs.push(r)}}}}}),t}(T),fz=function(e){function t(){var e=this;e.grid_list=[],e.record_list=null,e.result_list=null,e._groupId=0,e.showTextArr=[],e._cdTime=0,e._gid=0,e._effect=null,e.resGird1=null,e.resGird2=null,e.endTime=0,e.cdTime=NaN,e.eTime=NaN,t.__super.call(e),e._gid=2192,e.initView(),e.list.itemRender=lq,e.list.vScrollBarSkin="",e.list.spaceY=10,e.list.scrollBar.elasticDistance=200}b(t,"modules.activity.views.hefu.ActivityHeFuTreasureView",y);var i=t.prototype;return i.initView=function(){var e,t,i=this,n=0;for(n=0;n<18;n++)e=i["g"+n],(t=new MF).needGridBg=!1,t.pos(e.x,e.y),n<16&&(t.scaleX=t.scaleY=.8,t.size(e.width,e.height)),i.box.addChild(t),i.grid_list.push(t);for(n=1;n<3;n++)i["resGird"+n]=new MF,i["resGird"+n].needGridBg=!1,i["resGird"+n].pos(i["itempic"+n].x-3,i["itempic"+n].y-2),i.box_d.addChild(i["resGird"+n])},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.updateStore(),t.updateKey(),t.updateDisplay(),Eg.reqrecord(109);var i=Et.getIndex(63);t.endTime=parseInt(Et.MODEL.endTimeStr(i)),t.setCdTime(t.endTime),t.btn_help.on("click",t,t.onClickHelp)},i.onRemove=function(e){var t=this;if(ui.ViewBase.prototype.onRemove.call(t,e),G.timer.clear(t,t.loop),G.timer.clear(t,t.onResetTime),G.timer.clearAll(t),t.off("click",t,t.onClick),t.btn_help.off("click",t,t.onClickHelp),t.result_list){var i;for(var n in t.result_list){i=t.result_list[n];var s=Bi.getIndex(i.id),o=ms.getByQuality(Bi.MODEL.colourId(s)),a=Bi.MODEL.name(s)+"x"+i.num;zB.ins.showById2(2139,[o,a],2)}t.result_list=null}t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null)},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(18));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e,type:1})},i.destroy=function(e){var t=this;void 0===e&&(e=!0);var i=0;for(i=0;i<t.grid_list.length;i++)t.grid_list[i]&&t.grid_list[i].skin&&G.loader.clearRes(t.grid_list[i].skin);for(i=1;i<3;i++)t["resGird"+i]&&(t["resGird"+i].parent&&t["resGird"+i].parent.removeChild(t["resGird"+i]),t["resGird"+i].destroy(),t["resGird"+i]=null);laya.ui.View.prototype.destroy.call(t,e)},i.showView=function(){var e=this;if(e.grid_list)for(var t=0;t<e.grid_list.length;t++)e.grid_list[t].visible=!0;if(e.showTextArr)for(t=0;t<e.showTextArr.length;t++)e.showTextArr[t]&&(e.showTextArr[t].visible=!0);e.resGird1.visible=!0,e.resGird2.visible=!0,e.list.visible=!0,e.updateStore()},i.hideView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!1;for(e=0;e<this.showTextArr.length;e++)this.showTextArr[e].visible=!1;this.resGird1.visible=!1,this.resGird2.visible=!1,this.list.visible=!1},i.updateByVSC=function(e){if("show"==e)this.showView(),this.updateKey(),Eg.reqrecord(109);else if("hide"==e)this.hideView();else{if(hN.ins.isOpen("TREASURE_RESULT"))return;"30322"==e.actionOrder?(this.forHunt(e.proto.list),Eg.reqrecord(109)):"30324"==e.actionOrder?this.updateStore():"30326"==e.actionOrder?this.updateRecord(e.proto.list):"30328"==e.actionOrder||"HEFU_GUPDATE"==e.actionOrder&&(this.updateStore(),this.updateKey())}},i.update=function(){this._groupId!=uB.ins.groupId&&(this._groupId=uB.ins.groupId,this.updateDisplay()),this.list.array=uB.ins.msgList},i.updateStore=function(){this.btn_store.showTip=0<uB.hefuTrModel.goodsList.length},i.updateRecord=function(e){this.record_list=e,20<this.record_list.length&&this.record_list.splice(0,this.record_list.length-20),this.list.array=this.record_list},i.loop=function(){var e=this;if(e.record_list&&e.record_list.length){var t=e.record_list.shift(),i=uB.ins.msgList;i.push(t),20<i.length&&i.splice(0,1),e.list.array=i,e.list.scrollBar.value=e.list.scrollBar.max}e.record_list&&0==e.record_list.length&&G.timer.clear(e,e.loop)},i.updateKey=function(){var e=this,t=TR.ins.getGoodsNum(e._gid);e.btn_one.showTip=0<t,e.btn_ten.showTip=10<=t;var i=yB.create(e._gid);e.resGird1.bindData=i,e.resGird2.bindData=i,e.resGird1.scaleX=e.resGird2.scaleX=.5,e.resGird1.scaleY=e.resGird2.scaleY=.5;var n=1<=t?"#23b11f":"#ff2e24";e.txt_num.innerHTML=Ql.createColor(t+"/1",n)+")",n=10<=t?"#23b11f":"#ff2e24",e.txt_num2.innerHTML=Ql.createColor(t+"/10",n)+")";var s=yB.createStr(Sa.MODEL.consumptions(0)),o=yB.createStr(Sa.MODEL.consumptions(1));e.txt_yb1.changeText(s.goodsNum+"("),e.txt_yb2.changeText(o.goodsNum+"(")},i.forHunt=function(e){this._cdTime=BB.getTimer()+1200,this.result_list=e,this.openResult()},i.openResult=function(){hN.ins.open("TREASURE_RESULT",this.result_list),this.result_list=null},i.updateDisplay=function(){var e=this,t=0,i=0,n=uB.ins.gethefuGroup(109);if(0<e.showTextArr.length)for(t=0;t<e.showTextArr.length;t++)e.showTextArr[t]&&(e.showTextArr[t].parent&&e.showTextArr[t].parent.removeChild(e.showTextArr[t]),e.showTextArr[t].destroy(),e.showTextArr[t]=null);for(e.showTextArr=[],t=0;t<Wl.count;t++)Wl.MODEL.groupId(t)==Yo.MODEL.diggerGroupId(n)&&(e.updateGrid(Wl.MODEL.goodsId(t),i),i+=1);null==e._effect&&(e._effect=kB.createEffect("jm1436",360,105,e))},i.setImage=function(e){var t=G.loader.getRes(e.skin);null!=t?t&&t.bitmap&&(t.bitmap.enableMerageInAtlas=!1):e.on("loaded",this,this.onLoadedImage,[,[e]])},i.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1)},i.updateGrid=function(e,t){if(!(t>=this.grid_list.length)){var i,n=this.grid_list[t];if((i=1<e.length?yB.create(e[gR.ins.actorById(1).job-1]):yB.create(e[0])).disAchi=!1,n.bindData=i,17!=t&&16!=t&&!this.showTextArr[t]){var s=kB.createText(n.x-13,n.y+n.height-20,116,50,Bi.MODEL.simpleName(i.cfgIdx),20,ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx)),!1,"center",!1,!1,this);this.box.addChild(s),this.showTextArr.push(s)}var o=this["g"+t];o.skin=NI.gridBg(Bi.MODEL.colourId(i.cfgIdx)),this.setImage(o)}},i.onClick=function(e){if(!(BB.getTimer()-this._cdTime<500))switch(this._cdTime=BB.getTimer(),e.target){case this.btn_one:this.onReqHandler(1);break;case this.btn_ten:this.onReqHandler(10);break;case this.btn_store:Tu.sendToModule("TR_STORE",["modules.treasure.TreasureModule"],"HEFU_GUPDATE")}},i.onReqHandler=function(e){var t=TR.ins.getGoodsNum(this._gid);1<=(t=10<=t?10:t)?1==e?uB.ins.reqOne(uB.ins.getReqType(109,e,0)):uB.ins.reqOne(uB.ins.getReqType(109,t,0)):this.buyHandler(e),UB.ins.playSound("11")},i.buyHandler=function(e){if(uB.ins.getShowTip(109,e))hN.ins.open("TREASURE_BUY",[109,e]);else{var t,i=uB.ins.getReqType(109,e,1);t=yB.createStr(Sa.MODEL.consumptions(Sa.getIndex(i))),gR.ins.YB<t.goodsNum?KQ.ins.showNoGold():uB.ins.reqOne(i)}},i.setCdTime=function(e){dr.comServeTime,dr.serverTimeSec;if(this.cdTime=dr.comServeTime+e,this.cdTime<=0)return hN.ins.close("TR_HEFU_VIEW"),this.txt_time.innerHTML=RP.n[481]+Ql.createColor("已结束","#ff2e24"),void G.timer.clear(this,this.onResetTime);this.onResetTime(),G.timer.frameLoop(10,this,this.onResetTime)},i.onResetTime=function(){this.eTime=this.cdTime-dr.serverTimeSec,0<this.eTime?this.txt_time.innerHTML=RP.n[482]+Ql.createColor(Jp.getSTRDHMS(this.eTime),"#23b11f"):(hN.ins.close("TR_HEFU_VIEW"),this.txt_time.innerHTML=RP.n[481]+Ql.createColor("已结束","#ff2e24"),G.timer.clear(this,this.onResetTime))},t}(),pz=function(e){function t(){this.acitivityId=null,this.actInfo=null,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuWelfareResetView",L);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_charge.on("click",t,t.onBtnChargeClicked),t.btn_vipGift.on("click",t,t.onVipGiftClicked);var i="ui/images/activity/hefu/welfare/";t.img_charge_left.skin=_r.getFullUrl(i+"hfhd_img_1.jpg"),t.img_charge_right.skin=_r.getFullUrl(i+"hfhd_img_2.jpg"),t.img_title.skin=_r.getFullUrl(i+"hfhd_text_hlhf.png"),t.img_vip_left.skin=_r.getFullUrl(i+"hfhd_img_3.jpg"),t.img_vip_right.skin=_r.getFullUrl(i+"hfhd_img_4.jpg")},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_charge.off("click",this,this.onBtnChargeClicked),this.btn_vipGift.off("click",this,this.onVipGiftClicked)},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.btn_vipGift.showTip=QP.ins.needToShowWelfareTip,this.btn_charge.showTip=QP.ins.needToShowVIPTip;var e=It.getIndex(this.actInfo.activityId),t=It.MODEL.desc(e).split("|");t&&1<t.length&&(this.txt_dectLeft.innerHTML=t[0],this.txt_dectRight.innerHTML=t[1])}},i.onBtnChargeClicked=function(e){QP.ins.needToShowVIPTip&&(QP.ins.needToShowVIPTip=!1,this.btn_charge.showTip=QP.ins.needToShowVIPTip,Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule","modules.nav.NavModule"],{activityId:this.acitivityId,redPt:!1,mType:16}),this.requestRedPoint(0)),EB.showCharge&&(HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet?hN.ins.open("FIRST_RECHARGE",null,0):hN.ins.open("RECHARGE_VIEW",null,0))},i.onVipGiftClicked=function(e){QP.ins.needToShowWelfareTip&&(QP.ins.needToShowWelfareTip=!1,Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule","modules.nav.NavModule"],{activityId:this.acitivityId,redPt:!1,mType:16}),this.requestRedPoint(1)),Tu.sendToModule("14006",["modules.vip.VipModule"])},i.requestRedPoint=function(e){var t=new k;t.type=e,Tu.sendToService(t)},t}(),gz=function(e){function t(){this._gridsList=null,this._giftId=0,this._data=null,this.index=0,this.activityId=0,t.__super.call(this)}b(t,"modules.activity.views.invest.InvestItemView",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(3,!1),e._gridsList.pos(5,0),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this._data=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.showInfo=function(){var e,t=parseInt(St.MODEL.targetParam2(this.index));this.txt_pay.innerHTML="第"+t+"天",(e=-1<n.payPlat.indexOf(this.activityId)?n.getAwardsByGid(this._data.giftId,n.getAwards(1)):St.MODEL.goodsReward(this.index))&&(this._gridsList.setGoodsItems(e,3),this._gridsList.size(this._gridsList.contentWidth,this._gridsList.contentHeight))},i.onClickHanlder=function(e){WB.getGift(this._giftId,ql.create(this,this.onRefresh))},i.onRefresh=function(){Tu.sendToModule("UPDATE_VIEW",["modules.activity.ActivityModule"],36)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t._data=e,t._data)switch(t._giftId=t._data.giftId,t.index=St.getIndex(t._data.giftId),t.activityId=St.MODEL.activityId(t.index),t.showInfo(),t._data.status){case 0:t.btn_award.disabled=!0,t.btn_award.label="未达成",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!1;break;case 1:t.btn_award.disabled=!1,t.btn_award.label="可领取",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!0;break;case 2:t.btn_award.disabled=!0,t.btn_award.label="已领取",t.img_got.visible=!0,t.btn_award.visible=!1,t.btn_award.showTip=!1}}),t}(TI),vz=function(i){function t(){var e=this;e.a=null,e.d=0,e.f=null,e.v=null,e.s=null,e.b=null,e.sf=null,e.bf=null,e.SID=40401,e.BID=70401,t.__super.call(e)}b(t,"modules.activity.views.invite.In_LoginView",i);var e=t.prototype;return e.createChildren=function(){var e=this;i.prototype.createChildren.call(e),e.s=new GF,e.s0.addChild(e.s),e.s.bindData=e.SID,e.n_0.changeText(Vn.MODEL.name(Vn.getIndex(e.SID))),e.b=new Kl,e.b.width=e.b.height=100,e.b.pos(8,8),e.s1.addChild(e.b);var t=Ls.getIndex(e.BID);e.b.skin=_r.getIconPath(Ls.MODEL.icon(t)),e.n_1.changeText(Ls.MODEL.skillName(t)),e.cp.value=parseInt($e.MODEL.value($e.getIndex(396)))+"",e.t_d.innerHTML=RP.n[484]+Ql.createColor(RP.n[485],"#e6d80d")},e.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.clearF(),t.sf||(t.sf=kB.createEffect("jm1144",t.s0.width>>1,t.s0.height>>1,t.s0)),t.b_g.on("click",t,t.onClick),t.s0.on("click",t,t.onClick),t.s1.on("click",t,t.onClick)},e.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.clear(),t.clearF(),G.timer.clearAll(t),t.b_g.off("click",t,t.onClick),t.s0.off("click",t,t.onClick),t.s1.off("click",t,t.onClick)},e.clearF=function(){this.sf&&(this.sf.parent&&this.sf.parent.removeChild(this.sf),this.sf.dispose(),this.sf=null)},e.showByVSC=function(e,t){this.d=t,0<Bh.count?this.onComplete():uc.ins().onLoadJxrs([{url:_r.getJxrDBPath("PetStarUpgradeResource"),type:"arraybuffer",cls:Bh}],ql.create(this,this.onComplete))},e.onComplete=function(){this.onPet(),WB.getActivityData(this.d,ql.create(this,this.onReqBack))},e.refresh=function(e){if(this.v&&e&&e.hasOwnProperty("share"))return WB.getGift(this.v.giftId,ql.create(this,this.refresh)),void(hN.ins.isOpen("IN_LOGIN")&&hN.ins.close("IN_LOGIN"));this.onReqBack(),this.goToPos()},e.onReqBack=function(){var e=this;if(e.f=mB.getInStance().getActivityData(e.d),e.f&&e.f.gifts){e.v=e.f.gifts[0],e.cd.value=e.v.targetValue.toString(),e.t_l.innerHTML=RP.n[486]+Ql.createColor(e.v.loginDay+"",e.v.loginDay>=e.v.targetValue?"#23b11f":"#ff2e24")+Ql.createColor("/"+e.v.targetValue+"天","#e0d6c1");var t=Math.floor(parseInt(St.MODEL.targetParam2(e.v.index))/100);e.t_p.innerHTML=RP.n[487]+Ql.createColor(Math.floor(e.v.recharge/100)+"",Math.floor(e.v.recharge/100)>=t?"#23b11f":"#ff2e24")+Ql.createColor("/"+t+"元","#e0d6c1"),e.b_g.disabled=1!=e.v.status,e.b_g.showTip=1==e.v.status,e.b_g.label=2==e.v.status?"已领取":RP.n[488]}},e.onPet=function(e){var t=this;void 0===e&&(e=0),t.clear(),t.a||(t.a=new mj,t.a.renderInSelf=!0,t.a.pos(355,560),t.b_c.addChild(t.a)),0==e?(t.a.loadEffect("jm1613"),G.timer.once(800,t,t.onPet,[1])):(t.a.loadEffect("jm1614"),G.timer.clearAll(t))},e.clear=function(){this.a&&(this.a.parent&&this.a.parent.removeChild(this.a),this.a.playEndHandler=null,this.a.forceDestory(),this.a=null)},e.onClick=function(e){switch(e.currentTarget){case this.s0:$Z.instance.show(4244);break;case this.s1:eK.instance.show(this.BID.toString());break;case this.b_g:if(!this.f||1!=this.v.status)return;hN.ins.open("IN_LOGIN",this.f.gifts)}},e.goToPos=function(){if(this.v&&this.v.rewardGoods){for(var e=[],t=0;t<this.v.rewardGoods.length;t++)this.v.rewardGoods[t]&&e.push(this.v.rewardGoods[t].goodsId);var i=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(e,new Uh(i.x,i.y))}},t}(Tm),mz=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.invite.In_SaleItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.t_l.on("click",this,this.onClick)},i.onRemove=function(e){this.onEvent(e),this.t_l.off("click",this,this.onClick)},i.onClick=function(e){jP.sdk_cmd("wx_share_2","DISCOUNT_GIFT")},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){this.t_l.visible=this.g_no.visible=!e,this.t_n.visible=this.g_h.visible=!this.t_l.visible,this.g_h.visible&&(this.t_n.changeText("S."+e.ps+e.pn),this.g_h.skin=_r.getFullUrl("ui/images/actorhead/jb"+e.job+"_"+e.sex+".png"))}),t}(Mm),yz=function(e){function t(){this.a=null,this.t=null,t.__super.call(this),this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100}b(t,"modules.activity.views.invite.In_SaleLogView",Am);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.b_c.on("click",this,this.onClick),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.b_c.off("click",this,this.onClick),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.updateView=function(e){if(e&&!(e.length<1)){for(var t=[],i=0;i<e.length;i++){var n="S."+e[i].ps+RP.n[489];n+=Ql.createColor(e[i].pn,"#02b0e9")+RP.n[490],n+=Ql.createColor("一折","#23b11f"),t.push(n)}this.getList(t),this.list.dataSource=t}},i.getList=function(e){this.a=[];for(var t=0;t<e.length;t++)this.a.push({desStr:{t:e[t]}});this.list.array=this.a,this.list.renderHandler=ql.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.a.length)){var i=this.a[t];this.t=e.getChildByName("txt_des"),this.t.innerHTML=i.desStr.t}},i.onClick=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_m.visible=!1:this.g_m.visible=!0},t}(),Iz=function(e){function t(){var e=this;e.gvo=null,e._grids=null,e.lastTime=0,e.BAR_W=0,e.acitivityId=0,e.actInfo=null,e.targetArr=null,e.currentScore=0,e._effect=null,t.__super.call(e),e.initUI()}b(t,"modules.activity.views.os.Celebration_View",lm);var i=t.prototype;return i.initUI=function(){var e=this;e._grids=new wj(1,4,116,30,15,!0,null,100,!0,!1),e._grids.isCenter=!0,e._grids.pos(82,370),e._grids.vScrollBarSkin="",e._grids.vScrollBar.elasticDistance=0,e.addChild(e._grids),e.btn_get.parent&&e.btn_get.parent.removeChild(e.btn_get),e.addChild(e.btn_get),e.list.itemRender=bz,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.list.scrollBar.on("change",t,t.onScrollChanged),t.BAR_W=t.bar.width,t.setRateBar(),t.img_g_0.on("click",t,t.onClick),t.img_g_1.on("click",t,t.onClick),t.img_g_2.on("click",t,t.onClick),t.img_g_3.on("click",t,t.onClick),t.img_g_4.on("click",t,t.onClick),t.btn_get.on("click",t,t.onGetAward)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.actInfo=null,G.timer.clear(t,t.showTime),t.list.scrollBar.off("change",t,t.onScrollChanged),t.img_g_0.off("click",t,t.onClick),t.img_g_1.off("click",t,t.onClick),t.img_g_2.off("click",t,t.onClick),t.img_g_3.off("click",t,t.onClick),t.img_g_4.off("click",t,t.onClick),t.btn_get.off("click",t,t.onGetAward)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._effect&&(this._effect.dispose(),this._effect=null)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e;var t=new MM;t.actId=this.acitivityId,Tu.sendToService(t),WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.setTime(),this.updateData(),this.updateGiftIcon(),this.updateGiftSelevtion())},i.updateData=function(){for(var e=this.actInfo.gifts,t=0;t<e.length;t++){var i=e[t].status;if(1==i){this.gvo=e[t];break}null==this.gvo&&(this.gvo=e[0]),this.updateBtnStatus(i)}},i.onClick=function(e){var t=e.target.name,i=t.indexOf("_"),n=t.substring(i+1,t.length),s=parseInt(n),o=this.actInfo.gifts,a=o[s].rewardGoods,r=o[s].status;this.updateBtnStatus(r),this.img_jt.x=217+110*s,this.gvo=o[s],this._grids.gridDatas=a},i.onGetAward=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.acitivityId);t&&(t.getGift(e)&&(this.updateData(),this.updateGiftIcon(),this.updateGiftSelevtion(),this.goToPos(e)))},i.updateGiftIcon=function(){var e=this,t=e.actInfo.gifts;e.targetArr=[];for(var i=0;i<t.length;i++){var n,s=t[i].status,o=(n=t[i].rewardGoods)[0].goodsId,a=n[0].goodsNum,r=new MF;r.height=r.width=76,r.bindData=yB.create(o,a),r.mouseEnabled=!1,r.mouseThrough=!0,e["img_g_"+i].addChild(r);var l=St.getIndex(t[i].giftId),c=parseInt(St.MODEL.targetParam1(l));if(e["txt_s_"+i].text=c+"积分",e.targetArr.push(c),1==t[i].status?e["txt_s_"+i].color="#23b11f":e["txt_s_"+i].color="#e41b00",e["img_y_"+i].visible=2==s,2==s){e.getChildIndex(e["img_g_"+i]);e["img_y_"+i].pos(e["img_g_"+i].x+18,216),e.addChildAt(e["img_y_"+i],5)}e.txt_score.text=t[i].count,e.currentScore=t[i].count}for(var u=0,d=0;d<e.targetArr.length;d++)0==d?u=e.currentScore==e.targetArr[d]?1:0:d==e.targetArr.length-1?e.currentScore<e.targetArr[e.targetArr.length-1]&&e.currentScore>e.targetArr[e.targetArr.length-2]?u=e.targetArr.length-1:e.currentScore>=e.targetArr[e.targetArr.length-1]&&(u=e.targetArr.length):e.currentScore<e.targetArr[d]&&e.currentScore>e.targetArr[d-1]?u=d:e.currentScore==e.targetArr[d]&&(u=d+1);e.setRateBar(u/e.targetArr.length)},i.updateTaskList=function(e){var t=e;this.list.dataSource=t},i.setTime=function(){this.lastTime=this.actInfo.endTime-dr.serverTimeSec,this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!0)},i.showTime=function(){this.lastTime<=0?G.timer.clear(this,this.showTime):(this.lastTime--,this.txt_time1.innerHTML=RP.n[491]+Ql.createColor(Jp.getSTRDHMS(this.lastTime),"#23b11f"))},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.bar.scrollRect||new u_(0,0,this.bar.width,this.bar.height);t.width=this.BAR_W*e,this.bar.scrollRect=t},i.updateGiftSelevtion=function(){var e=this,t=e.actInfo.gifts,i=[];e._grids.gridDatas=[];for(var n=0;n<t.length;n++){var s=t[n].status;i.push(s)}var o=[];if(-1==i.indexOf(1))if(-1==i.indexOf(0))o=t[t.length-1].rewardGoods,e.gvo=t[t.length-1],e._grids.gridDatas=o,e.img_jt.x=217+110*(t.length-1);else for(var a=0;a<t.length;a++){var r=t[a].status;if(0==r){o=t[a].rewardGoods,e.gvo=t[a],e._grids.gridDatas=o,e.img_jt.x=217+110*a,e.updateBtnStatus(r);break}}else for(var l=0;l<t.length;l++){var c=t[l].status;if(1==c){o=t[l].rewardGoods,e.gvo=t[l],e._grids.gridDatas=o,e.img_jt.x=217+110*l,e.updateBtnStatus(c);break}}},i.updateBtnStatus=function(e){var t=this;t.btn_get.disabled=1!=e,2==e?(t.btn_get.label="已领取",t._effect&&(t._effect.dispose(),t._effect=null)):1==e?(t.btn_get.label="领 取",null==t._effect&&(t._effect=mj.GetNew(),t._effect.loadEffect("jm1242"),t._effect.renderInSelf=!0,t._effect.setXY(t.btn_get.x+t.btn_get.width/2,t.btn_get.y+t.btn_get.height/2),t.addChild(t._effect))):(t.btn_get.label="未领取",t._effect&&(t._effect.dispose(),t._effect=null))},i.goToPos=function(e){var t,i=St.getIndex(e),n=St.MODEL.goodsReward(i);if(n&&(t=n.split(";")),t&&!(t.length<1)){for(var s=[],o=0;o<t.length;o++)if(n=t[o]){var a=n.split(",");s.push(parseInt(a[0]))}var r=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(s,new Uh(r.x,r.y))}},t}(),bz=function(e){function t(){this._isFinish=!1,this._vo=null,this.taskId=0,t.__super.call(this)}b(t,"modules.activity.views.os.item.Celebration_Item",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_go.on("click",this,this.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.txt_go.off("click",this,this.onGoClicked)},i.onGoClicked=function(e){0==this._isFinish?KP.ins.goToLink(this.taskId):zB.ins.playErrorMsg(RP.n[492])},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t._vo=e,t.taskId=e.taskid;var i=e.currentNum,n=Ut.getIndex(t.taskId),s=Ut.MODEL.taskName(n);t.txt_taskName.changeText(s);var o=Ut.MODEL.targetMaxTimes(n);o<=i?(t._isFinish=!0,t.txt_go.text="已完成",t.txt_go.color="#f7b041"):(t._isFinish=!1,t.txt_go.text=RP.n[457],t.txt_go.color="#23b11f"),t.txt_go.underline=!t._isFinish,t.txt_progress.text=i+"/"+o,t.txt_reward.text=Ut.MODEL.singleScore(n)+"积分"}}),t}(rm),wz=function(e){function t(){this.g_item=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_BossScoreExchangeItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_award.off("click",t,t.onClickHandler),t.g_item&&(t.g_item.parent&&t.g_item.parent.removeChild(t.g_item),t.g_item.destroy(),t.g_item=null)},i.onClickHandler=function(e){this.tag&&0<this.tag.limitTimes-this.tag.exTimes&&this.tag.score>=this.tag.vo.costCount&&WB.reqExchange(this.tag.vo.exChangeId,this.tag.activityId)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.tag=e;var i=yB.create(e.vo.targetId);t.g_item||(t.g_item=new MF,t.g_item.size(116,116),t.g_item.pos(30,16),t.g_item.bindData=i,t.addChild(t.g_item),t.txt_name.changeText(i.name),t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(i.goodsId)))),t.txt_score.changeText(String(e.vo.costCount));var n=t.tag.limitTimes-t.tag.exTimes;n<0&&(n=0),t.btn_award.disabled=!(n&&t.tag.score>=e.vo.costCount),t.btn_award.showTip=n&&t.tag.score>=e.vo.costCount,t.txt_nums.innerHTML="剩余"+Ql.createColor(n+"","#e0d6c1")+"份"}}),t}(Km),xz=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_DailyPayItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(5,!1),e._gridsList.pos(5,35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this.gvo=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;e.activityId==JP.A_ID_1048?e.setSpecial():e.txt_pay.innerHTML=RP.n[494]+e.gvo.targetValue+"元宝";var t=St.MODEL.goodsReward(e.index);e._gridsList.setGoodsItems(t,3),e._gridsList.size(e._gridsList.contentWidth,e._gridsList.contentHeight),e.img_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.label=e.btn_award.showTip?"可领取":"未达成")},i.setSpecial=function(){var e=this;e.activityId==JP.A_ID_1048&&(e.txt_pay.innerHTML="充值"+e.gvo.targetValue+"元宝",e.txt_times.visible=2!=e.gvo.status,e.txt_times.visible&&(e.txt_times.innerHTML="已充："+Ql.createColor(e.gvo.recharge+"元宝","#23b11f")),e.btn_award.bottom=67,e.img_got.y=62,e._gridsList.pos(5,23),e._gridsList._gridW=e._gridsList._gridH=116,e._gridsList._gnameY=e._gridsList._gridH+1,e.height=198)},i.onClickHanlder=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.activityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo())}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&(this.gvo=e,this.gvo&&(this.activityId=this.gvo.owerActivity,this.index=St.getIndex(this.gvo.giftId),this.showInfo()))}),t}(ty),Sz=function(e){function t(){this._data=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_DailyPayItem2",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(5,!1),e._gridsList.pos(5,35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this._data=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=Kt.MODEL.totalGold(this.index);this.txt_pay.innerHTML=RP.n[495]+e+"元宝";var t=Kt.MODEL.rechargeReward(this.index);this._gridsList.setGoodsItems(t,3),this._gridsList.size(this._gridsList.contentWidth,this._gridsList.contentHeight)},i.onClickHanlder=function(e){var t=new WA,i=Kt.MODEL.key(this.index);t.cfgId=i,Tu.sendToService(t)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t._data=e,t._data)switch(t.index=t._data.configIndex,t.showInfo(),t._data.status){case 0:t.btn_award.disabled=!0,t.btn_award.label="未达成",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!1;break;case 1:t.btn_award.disabled=!1,t.btn_award.label="可领取",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!0;break;case 2:t.btn_award.disabled=!0,t.btn_award.label="已领取",t.img_got.visible=!0,t.btn_award.visible=!1,t.btn_award.showTip=!1}}),t}(ty),kz=function(i){function e(){this.vsc=null,e.__super.call(this)}b(e,"modules.activityDaily.view.wechatShare.WechatShareMainView",i);var t=e.prototype;return t.onAdd=function(e){var t=new wP;t.type="WX_SHARE_LEVEL",Tu.sendToService(t),(t=new wP).type="WX_SHARE_VIP",Tu.sendToService(t),i.prototype.onAdd.call(this,e)},t.onRemove=function(e){i.prototype.onRemove.call(this,e)},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.update=function(e){this.vsc.updateSelectedView(e.proto),this.callLater(this.updateItemEnabled)},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.size(720,1280),e.centerX=0,e.top=e.bottom=e.left=e.right=0,e.vsc=new SB(e),e.vsc.registAll([{cls:R$,id:0,isHideBg:!0,showDragon:!0},{cls:O$,id:1,isHideBg:!0,showDragon:!0},{cls:P$,id:2,isHideBg:!0,showDragon:!0}]),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1),e.navList=["ui/layouts/activityDaily/yq_btn_ljyq.png","ui/layouts/wxshare/yq_btn_hysj.png","ui/layouts/wxshare/yq_btn_hyVIP.png"]},t.checkTips=function(e){if("0"==e){if(eR.ins.getWXShare())return 3}else if("1"==e){if(eR.ins.getRedShare("WX_SHARE_LEVEL"))return 3}else if("2"==e&&eR.ins.getRedShare("WX_SHARE_VIP"))return 3;return 0},t.getCanOperJulian=function(){return!1},t.onSubChanged=function(e,t){switch(e){case 0:this.setTitle(_r.getAtlasSubPath("activityDaily/ljyq_text_ljyq.png"));break;case 1:this.setTitle(_r.getAtlasSubPath("wxshare/hysj_title_hysj.png"));break;case 2:this.setTitle(_r.getAtlasSubPath("wxshare/wxyq_title_hyVIP.png"))}this.callLater(this.updateItemEnabled)},e}(Ip),Ez=function(e){function t(){this.gvo=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_GiftsItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_redPt.visible=!1,this.g_select.visible=this.g_icon.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.refresh=function(){this.gvo&&(this.g_select.visible=this.gvo.giftId==JP.selectId)},i.setRedPt=function(){this.g_redPt.visible=2!=this.gvo.status&&gR.ins.YB>=this.gvo.costGold},i.onClickHandler=function(e){this.gvo&&this.gvo.giftId!=JP.selectId&&(JP.selectId=this.gvo.giftId,Tu.sendToModule("UPDATE_TEHUI_GIFT",["modules.activity.ActivityModule"],{_subIndex_:0,refreshType:this.gvo.giftId}))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&(this.gvo=e,this.g_icon.visible=2==this.gvo.status,this.g_item.skin=_r.getOsNewPath("gift/item_"+this.gvo.giftId),this.g_item.filters=this.g_icon.visible?A_.getGrayFilter3():null,this.setRedPt(),this.refresh())}),t}(oy),Tz=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_GoalItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(3,!1),e._gridsList.pos(-30,-30),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.sp.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this.gvo=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;e.img_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status||3==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.showTip?e.btn_award.label="可领取":e.btn_award.label=3==e.gvo.status?"已领完":"未达成"),e.activityId==JP.A_ID_1057?(e.txt_times.visible=!1,e.txt_gold.innerHTML=St.MODEL.content(e.index)+"达到："+JP.getSoluLevel(e.gvo.targetValue)):e.txt_gold.innerHTML=St.MODEL.content(e.index)+"达到："+e.gvo.targetValue},i.onClickHanlder=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.activityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo())}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.gvo=e,t.activityId=t.gvo.owerActivity,t.index=St.getIndex(t.gvo.giftId);var i=St.MODEL.goodsReward(t.index);t._gridsList.setGoodsItems(i,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),t.showInfo()}}),t}(ry),Cz=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,this.line=null,this.buyTime=0,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_LimitBuyItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(3,!1),e._gridsList.pos(-30,-30),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.sp.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.gvo=null,this.btn_buy.visible=this.img_got.visible=!1,this.g_sign.visible=!1,this.btn_buy.on("click",this,this.onClickHanlder)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_buy.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;if(e.img_got.visible=e.gvo.perBuyNum>=e.gvo.personalLimit,e.btn_buy.visible=!e.img_got.visible,e.box_vip.visible=0<e.gvo.minVipLevel,e.box_vip.visible?(e.font_vip.value=e.gvo.minVipLevel+"",e.btn_buy.bottom=16,e.txt_limit.y=69,e.img_got.y=61):(e.btn_buy.bottom=40,e.txt_limit.y=45,e.img_got.y=50),0<e.gvo.minVipLevel&&!e.img_got.visible?(e.g_sign.visible=!0,e.g_sign.y=e.box_vip.visible?77:53):e.g_sign.visible=!1,e.txt_limit.visible=!e.img_got.visible,e.txt_limit.visible){var t=0<e.gvo.personalLimit-e.gvo.perBuyNum?"#23b11f":"#ff2e24";e.txt_limit.innerHTML="限购："+Ql.createColor(Math.max(e.gvo.personalLimit-e.gvo.perBuyNum,0)+"/"+e.gvo.personalLimit,t)}e.txt_price.changeText(e.gvo.oriCostGold[1]),e.txt_sale.changeText(e.gvo.actCostGold[1]);var i=parseInt(e.gvo.actCostGold[1]),n=e.gvo.oriCostGold[0];if(e.gvo.minVipLevel>gR.ins.VIPLevel&&e.btn_buy.visible){e.btn_buy.showTip=!1;e.gvo.minVipLevel,gR.ins.VIPLevel}else"COPPER"==n?e.btn_buy.showTip=gR.ins.coin>=i:"GOLD"==n&&(e.btn_buy.showTip=gR.ins.YB>=i);for(var s=0;s<2;s++)e["img_coin_"+s].skin=_r.getAtlasSubPath("base_ui2/"+("GOLD"==n?"ty_hb_yb":"ty_hb_tb")+".png");e.line||(e.line=new pp,e.box_price.addChild(e.line)),e.line.graphics.clear(),e.line.graphics.drawLine(-4,e.txt_price.y+11,e.txt_price.x+12*e.txt_price.text.length+5,e.txt_price.y+12,"#90877b",1)},i.setRabate=function(){var e=parseInt(this.gvo.oriCostGold[1]),t=parseInt(this.gvo.actCostGold[1]),i=(Math.floor(t/e*100%10)+1).toFixed(0),n=(Math.floor(t/e*10)+1).toFixed(0);this.c_ten.index=n,this.c_num.index=i},i.onClickHanlder=function(e){var t=this;if(t.gvo&&!(BB.getTimer()-t.buyTime<500))if(0<t.gvo.minVipLevel&&t.gvo.minVipLevel>gR.ins.VIPLevel)zB.ins.showMsg(RP.n[496],1);else{var i=!0;"GOLD"==t.gvo.oriCostGold[0]&&(i=gR.ins.YB>=parseInt(t.gvo.actCostGold[1])),t.buyTime=BB.getTimer(),i?0==t.gvo.isPlayerAct?WB.buyGift(t.gvo.giftId,ql.create(t,t.onRefresh,[t.activityId,t.gvo.giftId])):WB.reqPlayerLimit(t.gvo.giftId,ql.create(t,t.onRefresh,[t.activityId,t.gvo.giftId])):KQ.ins.showNoGold()}},i.onRefresh=function(e,t){if(!this.destroyed){var i=mB.getInStance().getActivityData(e);if(i){var n=i.getGift(t);n&&(this.gvo=n,this.showInfo(),this.goToPos())}}},i.goToPos=function(){var e,t=this.gvo.goodsReward;if(t&&(e=t.split(";")),e&&!(e.length<1)){for(var i=[],n=0;n<e.length;n++)if(t=e[n]){var s=t.split(",");i.push(parseInt(s[0]))}var o=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(i,new Uh(o.x,o.y))}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e&&(t.gvo=e,t.gvo)){t.activityId=t.gvo.owerActivity,t.index=zi.getIndex(t.gvo.giftId);var i=zi.MODEL.goodsReward(t.index);t._gridsList.setGoodsItems(i,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),t.showInfo(),t.setRabate()}}),t}(cy),Lz=function(e){function t(){this.actInfo=null,this._lastSelected=null,this._grids=null,this._eff=null,this.img_key="",this.eTime=NaN,this.acitivityId=null,t.__super.call(this),this.init()}b(t,"modules.activity.views.os.item.OS_Purchase",hy);var i=t.prototype;return i.init=function(){var e=this;e._grids=[];for(var t=0;t<4;t++){var i=new MF;e["grid"+t].addChild(i),e._grids[t]=i}e.imgGot.visible=!1,e.img_double.visible=!1,e.lstItem.itemRender=Rj,2==dr.xgame?e.lstItem.array=[1,2,3,4,5]:e.lstItem.array=[1,2,3,4,5,6],e.lstItem.selectEnable=!0,e.lstItem.renderHandler=ql.create(e,e.onListRender,null,!1),e.lstItem.selectHandler=ql.create(e,e.onSelected,null,!1),e.mouseThrough=!0},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.lstItem.selectedIndex=0},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clear(this,this.onResetTime),this._eff&&(this._eff.dispose(),this._eff=null),JP.openIndex=-1},i.onClick=function(e){switch(e.target){case this.btnBuy:if(null==this.actInfo)return;var t=this.actInfo.gifts[this.lstItem.selectedIndex];switch(t.status){case 0:for(var i=0;i<Ln.count;i++){var n=Ln.MODEL.type(i);if(Ln.MODEL.money(i)==t.targetValue&&5==n){EB.pay(5,Ln.MODEL.key(i));break}}break;case 1:WB.reqGetPurchaseAward(t.giftId)}}},i.showByVSC=function(e,t){this.txt_leave.changeText(""),this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&(e.update(),e.onResetTime(),e.eTime=e.actInfo.endTime-dr.serverTimeSec,0<e.eTime&&G.timer.frameLoop(10,e,e.onResetTime))},i.update=function(){var e=this.actInfo.gifts,t=-1,i=-1,n=0;if(-1==JP.openIndex){for(var s=0;s<e.length;s++){var o=e[s],a=this.lstItem.getCell(s);a&&(1==o.status?(a.reddot=!0,-1==t&&(t=s)):(a.reddot=!1,0==o.status&&-1==i&&(i=s)))}n=-1==t?-1==i?this.lstItem.selectedIndex:i:t}else n=JP.openIndex;this.lstItem.selectedIndex==n?this.onSelected(n):this.lstItem.selectedIndex=n},i.onListRender=function(e,t){t==this.lstItem.selectedIndex?e.selected=!0:e.selected=!1},i.onSelected=function(e){var t=this;if(null!=t.actInfo){var i=t.actInfo.gifts[e];switch(t._eff&&(t._eff.dispose(),t._eff=null),i.status){case 0:t.btnBuy.visible=!0,t.btnBuy.label=i.targetValue+"元抢购",t.imgGot.visible=!1;break;case 1:t.btnBuy.visible=!0,t.btnBuy.label=RP.n[497],t.imgGot.visible=!1,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btnBuy.width/2,t.btnBuy.height/2,t.btnBuy),t._eff.scale_X=1,t._eff.scale_Y=1,t.btnBuy.addChild(t._eff));break;case 2:t.btnBuy.visible=!1,t.imgGot.visible=!0}for(var n=St.MODEL.exp(i.index).split(","),s="0",o=0;o<n.length;o++){var a=n[o].split(":");"VIPEXP"==a[0]&&(s=a[1])}t.txt_exp.value=s;var r=i.rewardGoods;for(o=0;o<4;o++){var l=r[o];t._grids[o].bindData=l;var c=t["name"+o];c.color=ms.getByQuality(l.colourId),c.changeText(l.name)}var u=parseInt(i.extParams);t.txt_time.text=u-i.buyTimes+"/"+u,t.img_double.visible=parseInt(s)>100*i.targetValue,t.img_content.skin=_r.getOsNewPath("purchase/xs_text_hbmsz"+(e+1)),t.img_type.skin=_r.getOsNewPath("purchase/xs_jlzs_"+(e+1)),t.txt_name.changeText(i.name)}},i.onResetTime=function(e){var t=this;void 0===e&&(e=!1),t.eTime=t.actInfo.endTime-dr.serverTimeSec,0<t.eTime?(Math.floor(t.eTime/86400),t.txt_leave.changeText(Jp.getSTRDHMS(t.eTime))):(t.txt_leave.changeText("已结束"),e||G.timer.clear(t,t.onResetTime),hN.ins.close("LIMITBUY"))},t}(),Mz=function(e){function t(){this.rankVo=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_RankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.rankVo=null,this.img_rank.visible=this.txt_rank.visible=!1},i.getColors=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386"}return"#90877b"},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t.rankVo=e,t.txt_name.changeText(t.rankVo.charName),t.img_rank.visible=t.rankVo.rank<=3,t.txt_rank.visible=3<t.rankVo.rank,t.img_rank.visible?(t.img_bg.visible=!0,t.img_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+t.rankVo.rank+".png"),t.img_bg.skin=_r.getAtlasSubPath("base_ui2/phb_db_no"+t.rankVo.rank+".png")):(t.img_bg.visible=!1,t.txt_rank.changeText(String(t.rankVo.rank))),1==t.rankVo.rankType?0==t.rankVo.value?t.txt_goal.changeText(t.rankVo.level+"级"):t.txt_goal.changeText(t.rankVo.value+"转"+t.rankVo.level+"级"):19==t.rankVo.rankType?t.txt_goal.changeText(JP.getSoluLevel(t.rankVo.value)):t.txt_goal.changeText(t.rankVo.value+JP.getWordsByRtype(t.rankVo.rankType)),t.txt_name.color=t.getColors(t.rankVo.rank))}),t}(_y),Az=function(e){function t(){var e=this;e.acitivityId=0,e.actInfo=null,e.gvo=null,e.g_items=null,e._gbox=null,e.GRAP_X=145,e.GRAP_Y=146,e.GIFTARR=null,e.MAX_NUM=4,e.gLen=0,e.curPage=0,e.ITEM_GRAP_X=150,e.imgList=null,e.isRefresh=!1,e.selectIndex=0,e.bTween=null,e.tween=null,t.__super.call(e),e._gbox||(e._gbox=new dt,e._gbox.pos(0,740),e.box_c.addChild(e._gbox)),e._panel.hScrollBarSkin="",e._panel.hScrollBar.elasticBackTime=300,e._panel.hScrollBar.elasticDistance=100}b(t,"modules.activity.views.os.OS_GiftsView",ay);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),0<eU.targetId?JP.selectId=eU.targetId:JP.selectId=-1,t.isRefresh=!1,t.btn_buy.on("click",t,t.onClickHandler),t.btn_pre.on("click",t,t.onClickHandler),t.btn_next.on("click",t,t.onClickHandler),t._panel.hScrollBar.on("end",t,t.onScrollEnd)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,G.timer.clear(t,t.onResetTime),t.btn_buy.off("click",t,t.onClickHandler),t.btn_pre.off("click",t,t.onClickHandler),t.btn_next.off("click",t,t.onClickHandler),t._panel.hScrollBar.off("end",t,t.onScrollEnd);for(var i=0;i<t.gLen;i++)t.imgList[i]&&(t.imgList[i].parent&&t.imgList[i].parent.removeChild(t.imgList[i]),t.imgList[i]=null);t.imgList.splice(0,t.imgList.length),t.tween&&t.tween.clear(),t.bTween&&t.bTween.clear(),t._gbox&&t._gbox.graphics.clear(),t.clearItems(),eU.targetId=0},i.destroy=function(e){void 0===e&&(e=!0),this.bg&&this.bg.skin&&""!=this.bg.skin&&G.loader.clearRes(this.bg.skin),laya.ui.View.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.initInfo=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.actInfo.gifts=ol.srotOn(this.actInfo.gifts,"extParams",Array.NUMERIC),this.actInfo.gifts=this.actInfo.gifts.sort(this.sortArray))},i.onReqBack=function(e){var t=this;if(void 0===e&&(e=!0),t.initInfo(),t.actInfo){var i=0;if(t.gLen=t.actInfo.gifts.length,e){if(!t.imgList||t.imgList.length<1)for(t.imgList=[],i=0;i<t.gLen;i++){var n=t.gItem;n.name=String(i),n.pos(i*t.ITEM_GRAP_X+n.pivotX,n.pivotY),n.dataSource=t.actInfo.gifts[i],t.imgList.push(n)}t._panel.hScrollBar.max=299}for(t.GIFTARR=[],i=0;i<t.gLen;++i){var s=t.actInfo.getTargetGift(t.actInfo.currentGift[i]);t.GIFTARR.push(s.giftId)}t.update(e)}},i.update=function(e){void 0===e&&(e=!1),this.initShow(e),this.setSelect(),this.resetPage();var t=this.actInfo.endTime-dr.serverTimeSec;0<t?(this.txt_time.innerHTML=Jp.getSTRDHMS(t),G.timer.frameLoop(10,this,this.onResetTime)):this.txt_time.innerHTML="已结束"},i.initShow=function(e){if(!(e&&0<JP.selectId))for(var t=!1,i=0;i<this.gLen;++i){var n=this.actInfo.currentGift[i];t||1==n.status&&(JP.selectId=n.giftId,t=!0)}},i.setSelect=function(){var e=this;if(e.actInfo&&e.actInfo.currentGift&&(JP.selectId<0&&(JP.selectId=e.actInfo.currentGift[0].giftId),e.gvo=e.getInfo(JP.selectId),e.gvo)){var t=_r.getOsNewPath("gift/icon_"+e.gvo.giftId);if(e.img_card.skin&&e.img_card.skin!=t){var i=yc.getRes(e.img_card.skin);i&&(i.destroy(),yc.clearRes(e.img_card.skin),tt.ins.clearTexture(e.img_card.skin))}e.img_card.skin=t;for(var n=0;n<e.gLen;n++)e.imgList[n]&&e.imgList[n].refresh();e.setAwards(),e.showCost()}},i.showCost=function(){var e=this;e.btn_buy.disabled=2==e.gvo.status,e.btn_buy.label=e.btn_buy.disabled?"已购买":"购 买",e.btn_buy.showTip=2!=e.gvo.status&&gR.ins.YB>=e.gvo.costGold,e.txt_time.visible=2!=e.gvo.status,e.g_tip.skin=_r.getOsNewPath("gift/tip_"+e.gvo.giftId)},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[],e._gbox&&e._gbox.graphics.clear();for(var t=e.gvo.rewardGoods,i=0;i<t.length;i++){var n=new MF;n.bindData=t[i],8<=t.length?n.pos(81+i%4*e.GRAP_X,Math.floor(i/4)*e.GRAP_Y):n.pos((0<Math.floor(i/3)?220:138)+i%3*164,Math.floor(i/3)*e.GRAP_Y),e.g_items.push(n),e._gbox.addChild(n);var s=Bi.MODEL.simpleName(Bi.getIndex(t[i].goodsId)),o=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(t[i].goodsId)));e._gbox.graphics.fillText(s,n.x+57,n.y+119,"20px SimHei",o,"center")}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onResetTime=function(){var e=this.actInfo.endTime-dr.serverTimeSec;0<e?this.txt_time.innerHTML=RP.n[498]+Ql.createColor(Jp.getSTRDHMS(e),"#23b11f"):(G.timer.clear(this,this.onResetTime),this.txt_time.innerHTML=RP.n[499]+Ql.createColor("已结束","#ff2e24"),this.parent&&hN.ins._closePanel(this.parent))},i.refresh=function(){this.setSelect()},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_buy:if(!t.gvo)return;if(2!=t.gvo.status&&gR.ins.YB<t.gvo.costGold)return void KQ.ins.showNoGold();t.selectIndex=t.getSIndex(t.gvo.giftId),WB.getGift(t.gvo.giftId,ql.create(t,t.onPlayTween,[t.selectIndex]));break;case t.btn_pre:t.bTween&&t.bTween.clear(),t.bTween=Og.to(t._panel.hScrollBar,{value:0},300,null,ql.create(t,t.onScrollEnd),0,!0);break;case t.btn_next:t.bTween&&t.bTween.clear(),t.bTween=Og.to(t._panel.hScrollBar,{value:t._panel.hScrollBar.max},300,null,ql.create(t,t.onScrollEnd),0,!0)}},i.resetPage=function(){this.getSIndex(JP.selectId)>=this.MAX_NUM?this._panel.hScrollBar.value=this._panel.hScrollBar.max:this.GIFTARR.indexOf(JP.selectId)<=1&&(this._panel.hScrollBar.value=0),this.onScrollEnd()},i.onScrollEnd=function(){0==this._panel.hScrollBar.value?this.btn_pre.visible=!1:this.btn_pre.visible=!0,this._panel.hScrollBar.value==this._panel.hScrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.getIsHasCompleted=function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++)if(e[t].status<2)return!0;return!1},i.onPlayTween=function(e){var t=this;t.initInfo();for(var i=0;i<t.gLen;i++)t.imgList[i]&&t.imgList[i].setRedPt();t.getIsHasCompleted(t.actInfo.gifts)?(t.imgList[e].pivotX=70,t.imgList[e].x+=70,t.tween=Og.to(t.imgList[e],{alpha:0,scaleX:0,scaleY:0},500,null,ql.create(t,t.onTweenComplete,[e]))):t.onResetItem(e)},i.onTweenComplete=function(e){var t=this,i=t.imgList[e];t.imgList.push(i),t.imgList.splice(e,1),G.timer.once(300,t,t.onResetItem,[t.imgList.length-1]);for(var n=e;n<t.gLen;n++)t.imgList[n]&&(t.imgList[n].name=n,t.imgList[n].pivotX=0,Og.to(t.imgList[n],{x:n*t.ITEM_GRAP_X+t.imgList[n].pivotX},300))},i.onResetItem=function(e){var t=this.imgList[e];t&&(t.alpha=1,t.scaleX=t.scaleY=1,t.pivotX=0,this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.actInfo.gifts=ol.srotOn(this.actInfo.gifts,"extParams",Array.NUMERIC)),t.dataSource=this.getInfo(t.gvo.giftId),this.update())},i.sortArray=function(e,t){var i=0,n=0;return(i=0==e.status?5:1==e.status?7:9)==(n=0==t.status?5:1==t.status?7:9)?-(e.id-t.id):i-n},i.getSIndex=function(e){for(var t=0;t<this.gLen;t++)if(this.imgList[t]&&this.imgList[t].gvo&&this.imgList[t].gvo.giftId==e)return t;return 0},i.getInfo=function(e){for(var t=0;t<this.actInfo.gifts.length;t++)if(this.actInfo.gifts[t]&&this.actInfo.gifts[t].giftId==e)return this.actInfo.gifts[t];return this.actInfo.gifts[0]},p(0,i,"gItem",function(){var e=new Ez;return e.pivotY=74,this._panel.addChild(e),e}),t}(),Dz=function(e){function t(){this.rankVo=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_RankNewItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.rankVo=null,this.img_rank.visible=this.txt_rank.visible=!1},i.getColors=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386"}return"#90877b"},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t.rankVo=e,t.txt_name.changeText(t.rankVo.charName),t.img_rank.visible=t.rankVo.rank<=3,t.txt_rank.visible=3<t.rankVo.rank,t.img_rank.visible?(t.img_bg.visible=!0,t.img_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+t.rankVo.rank+".png"),t.img_bg.skin=_r.getAtlasSubPath("base_ui2/phb_db_no"+t.rankVo.rank+".png")):(t.img_bg.visible=!1,t.txt_rank.changeText(String(t.rankVo.rank))),t.txt_name.color=t.getColors(t.rankVo.rank))}),t}(py),Oz=function(e){function t(){this.gvo=null,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_SevenKHItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(3,!1),e._gridsList.pos(1,19),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=25,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=74,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_got.visible=this.btn_award.visible=!1,this.btn_award.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;e.g_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.label=e.btn_award.showTip?"可领取":"未达成"),e.txt_num.visible=!e.g_got.visible,e.txt_num.visible&&(e.txt_num.innerHTML=Ql.createColor(Math.min(e.gvo.sevenTarget,e.gvo.targetValue)+"",1==e.gvo.status?"#23b11f":"#ff2e24")+"/"+e.gvo.targetValue)},i.onClickHandler=function(e){WB.reqSevenKHAward(this.gvo,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.gvo.owerActivity);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo())}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.gvo=e,t.index=St.getIndex(t.gvo.giftId);var i=St.MODEL.goodsReward(t.index);t._gridsList.setGoodsItems(i,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),i=St.MODEL.content(t.index).split(",")[1],t.txt_goal.innerHTML=mp.getFormat(i,[t.gvo.targetValue]),t.showInfo()}}),t}(yy),Pz=function(e){function t(){this.MAX_NUM=3,t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_SevenKHPreviewItem",e);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e);for(var t=0;t<this.MAX_NUM;t++){var i=this.getChildByName("child_g_item"+t);i&&(i.parent&&i.parent.removeChild(i),i.destroy(),i=null)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){for(var i=0,n=0;n<t.MAX_NUM;n++){var s=e[n];t["box_"+n].visible=null!=s;var o=t.getChildByName("child_g_item"+n);if(o&&(o.visible=t["box_"+n].visible),s){var a=s,r=yB.create(a.targetId,a.num),l=t.getChildByName("child_g_item"+n);l||((l=new MF).size(116,116),t.addChild(l),l.name="child_g_item"+n),l.pos(184+130*n,16),l.bindData=r,l.visible=t["box_"+n].visible,t["txt_name"+n].changeText(r.name),t["txt_name"+n].color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(r.goodsId))),i=a.costCount}}t.txt_score.innerHTML=RP.n[500]+i+RP.n[501]}}),t}(Iy),Rz=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.item.OS_UniversalBossItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_killed.visible=!1},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){var t=rn.getIndex(e.copyId),i=rn.MODEL.bossId(t);t=hn.getIndex(i);var n=hn.MODEL.muId(t);this.txt_name.changeText(hn.MODEL.name(t)),t=_n.getIndex(n),this.img_killed.visible=e.kill;var s=_r.getBossPath(_n.MODEL.headId(t));this.img_head.skin=s}}),t}(Ty),Nz=function(e){function t(){this._data=null,this._giftId=0,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.FestivalPayItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(5,!1),e._gridsList.pos(5,35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this._data=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.showInfo=function(){var e,t=St.MODEL.content(this.index);this.txt_pay.innerHTML=t,(e=-1<n.payPlat.indexOf(this.activityId)?n.getAwardsByGid(this._data.giftId,n.getAwards(1)):St.MODEL.goodsReward(this.index))&&(this._gridsList.setGoodsItems(e,3),this._gridsList.size(this._gridsList.contentWidth,this._gridsList.contentHeight))},i.onClickHanlder=function(e){WB.getGift(this._giftId,ql.create(this,this.onRefresh))},i.onRefresh=function(){Tu.sendToModule("UPDATE_VIEW",["modules.activity.ActivityModule"],25)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t._data=e,t._data)switch(t._giftId=t._data.giftId,t.index=St.getIndex(t._data.giftId),t.activityId=St.MODEL.activityId(t.index),t.showInfo(),t._data.status){case 0:t.btn_award.disabled=!0,t.btn_award.label="未达成",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!1;break;case 1:t.btn_award.disabled=!1,t.btn_award.label="可领取",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!0;break;case 2:t.btn_award.disabled=!0,t.btn_award.label="已领取",t.img_got.visible=!0,t.btn_award.visible=!1,t.btn_award.showTip=!1}}),t}(ty),Bz=function(e){function t(){this._data=null,this._giftId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.FestivalUseYBItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(5,!1),e._gridsList.pos(5,35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.txt_times.visible=!1,this.btn_award.visible=this.img_got.visible=!1,this._data=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.showInfo=function(){var e=St.MODEL.content(this.index);this.txt_pay.innerHTML=e;var t=St.MODEL.goodsReward(this.index);t&&(this._gridsList.setGoodsItems(t,3),this._gridsList.size(this._gridsList.contentWidth,this._gridsList.contentHeight))},i.onClickHanlder=function(e){WB.getGift(this._giftId,ql.create(this,this.onRefresh))},i.onRefresh=function(){Tu.sendToModule("UPDATE_VIEW",["modules.activity.ActivityModule"],24)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t._data=e,t._data)switch(t._giftId=t._data.giftId,t.index=St.getIndex(t._data.giftId),t.showInfo(),t._data.status){case 0:t.btn_award.disabled=!0,t.btn_award.label="未达成",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!1;break;case 1:t.btn_award.disabled=!1,t.btn_award.label="可领取",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!0;break;case 2:t.btn_award.disabled=!0,t.btn_award.label="已领取",t.img_got.visible=!0,t.btn_award.visible=!1,t.btn_award.showTip=!1}}),t}(ty),Hz=function(s){function t(){var e=this;e.vsc=null,e.zsCareList=[6,3],e.veinCareList=[5],e.yuyiList=[214],e.lunhuiCareList=[255,257],e.allRedPoint=[6,3,5,214,210,208,80,239,262,9,256,271,255,257,270],e.zsOpenLv=0,e.zlOpenLv=0,e.zlOpenDay=0,e.lwOpenLv=0,e.yyOpenLv=0,e.lhOpenLv=0,e.lhOpenDay=0,e.hjRingId=0,t.__super.call(e),e.top=e.bottom=0,e.left=e.right=0}b(t,"modules.actor.views.ActorMV",s);var e=t.prototype;return e.updateEquip=function(e){var t=this;t.vsc.selectedView instanceof modules.actor.views.ActorEquipV?t.vsc.updateSelectedView():t.vsc.selectedView instanceof modules.actor.views.ActorVeinV?t.vsc.selectedView.updateGoods():t.vsc.selectedView instanceof modules.actor.views.zs.ActorZhuanshengV?t.vsc.updateSelectedView(e):t.vsc.selectedView instanceof modules.actor.views.longwen.LongWenMV?t.vsc.updateSelectedView(e):t.vsc.selectedView instanceof modules.actor.views.wing.ActorWingV?t.vsc.updateSelectedView(e):t.vsc.selectedView instanceof modules.actor.views.lunhui.ActorLunhuiView&&t.vsc.updateSelectedView(e),t.callLater(t.updateItemEnabled)},e.showZhisheng=function(e){this.vsc.selectedView instanceof modules.actor.views.wing.ActorWingV&&this.vsc.updateSelectedView(e)},e.showyyBlessTip=function(){this.vsc.selectedView instanceof modules.actor.views.wing.ActorWingV&&this.vsc.updateSelectedView("showBlessTIP")},e.openIndex=function(e){var t=0;1<(t=e?(this.vsc.selectedIndex=e.subIndex,parseInt(e.subIndex)):this.vsc.selectedIndex=0)&&this.tabScrollTo(t)},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.initialize=function(){var e=this;this.size(720,1280),this.centerX=this.centerY=0,this.zsOpenLv=parseInt($e.MODEL.value($e.getIndex(2))),this.zlOpenDay=parseInt($e.MODEL.value($e.getIndex(74))),this.zlOpenLv=parseInt($e.MODEL.value($e.getIndex(75))),this.lwOpenLv=parseInt($e.MODEL.value($e.getIndex(78))),this.yyOpenLv=parseInt($e.MODEL.value($e.getIndex(120))),this.hjRingId=parseInt($e.MODEL.value($e.getIndex(128)));var t=$e.MODEL.value($e.getIndex(236)).split(",");this.lhOpenLv=parseInt(t[0]),this.lhOpenDay=parseInt(t[1]),this.navList=["ui/layouts/actor/btn_tab_zb.png","ui/layouts/actor/btn_tab_zs.png","ui/layouts/actor/btn_tab_yy.png","ui/layouts/actor/yq_btn_lh.png","ui/layouts/actor/yq_btn_cs.png","ui/layouts/actor/yq_btn_qh1.png"];var i=[];i.push(_r.getLayoutsPath("passsuit"));this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1);var n=[{cls:gX,id:"0",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["ClassicalRingResource","ConfigEnhance","ConfigEnchant","ConfigNiePanResource","YuanGodActive"],["ClassicalRingResource","CEnhanceModel","CEnchantModel","ConfigNiePanResource","YuanGodActive"]))},{cls:wQ,id:"1",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigZsExchange","ConfigZhuansheng","ConfigZsLevelExchange"],["CZsExchangeModel","CZsAttrModel","CZsLevelExchange"])),grayTip:function(){zB.ins.showMsg(RP.n[502]+e.zsOpenLv+"级开启",1),UB.ins._playLevelNot()}},{cls:dQ,id:"2",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitAtlas("yuyi"),hN.waitConfig(["ConfigWingCombine"],["ConfigWingCombine"])),grayTip:function(){zB.ins.showMsg(RP.n[503]+e.yyOpenLv+"级开启",1),UB.ins._playLevelNot()}},{cls:LX,id:"3",isHideBg:!0,wait:hN.wait(hN.waitAtlas("lunhui"),hN.waitConfig(["lunhui","lunhuiLevelExchange","lunhuiGoodsExchange","lunhuiTimes"],["CLunhuiModel","CLunhuiLevelExchangeModel","CLunhuiGoodsExchangeModel","CLunhuiTimesModel"])),grayTip:function(){zB.ins.playErrorMsg(ei.MODEL.content(ei.getIndex(4377)))}},{cls:JZ,id:"4",isHideBg:!0,wait:hN.wait(hN.waitRes(i),hN.waitConfig(["ConfigChuanshi","ConfigChuanshiSuit"],["ConfigChuanshi","ConfigChuanshiSuit"])),grayTip:function(){zB.ins.playErrorMsg(RP.n[504])}},{cls:hK,id:"5",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigQihai"],["ConfigSeaAir"])),grayTip:function(){zB.ins.playErrorMsg(RP.n[505])}}];this.vsc.registAll(n),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},e.onAdd=function(e){var t=this;s.prototype.onAdd.call(this,e);var i=__.equipCareList.concat(this.allRedPoint);AN.reqRedPt(i);var n=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_ZS",this.zsCareList,n),AN.ins.addListener("BTN_EQUIP",__.equipCareList,n),AN.ins.addListener("BTN_VEIN",this.veinCareList,n),AN.ins.addListener("BTN_WING",this.yuyiList,n),AN.ins.addListener("BTN_DRAGON",[53,229,230],n),AN.ins.addListener("BTN_SOULOUT",[208,80],n),AN.ins.addListener("BTN_FLYUP",[239],n),AN.ins.addListener("BTN_HEJI",[210],n),AN.ins.addListener("BTN_CHUANSHI",[9],n),AN.ins.addListener("BTN_LH",this.lunhuiCareList,n),AN.ins.addListener("BTN_QIHAI",[270],n),gR.ins.forRed&&(gR.ins.forRed=!1,G.timer.once(200,this,function(){gR.ins.forRed=!0,t.updateItemEnabled()})),NN.reqPassSuitInfo()},e.onRemove=function(e){s.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_ZS"),AN.ins.removeListener("BTN_EQUIP"),AN.ins.removeListener("BTN_VEIN"),AN.ins.removeListener("BTN_WING"),AN.ins.removeListener("BTN_DRAGON"),AN.ins.removeListener("BTN_SOULOUT"),AN.ins.removeListener("BTN_FLYUP"),AN.ins.removeListener("BTN_HEJI"),AN.ins.removeListener("BTN_CHUANSHI"),AN.ins.removeListener("BTN_QIHAI"),gR.ins.currentSelectRoleIndex=0,iR.instance.isFirstActivityHeJiRang&&(iR.instance.isFirstActivityHeJiRang=!1,Tu.sendToModule("SHOW_HEJI_FLY",["modules.nav.NavModule"]))},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.onSubChanged=function(e,t){var i="";switch(e){case"0":i="actor/RoleEquip_text_title.png";break;case"1":i="actor/Role_rebirth_title.png";break;case"2":i="actor/yy_text_yy.png";break;case"4":i="passsuit/cs_title_cs.png";break;case"3":i="lunhui/lh_text_lh.png";break;case"5":nB.FIRST_LONGIN&&(nB.FIRST_LONGIN=!1,Tu.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),this.updateItemEnabled()),i="actor/qh_title_qh.png"}this.setTitle(_r.getAtlasSubPath(i))},e.checkTips=function(e){if("1"==e&&!this.isOpenZs())return 1;if("0"==e&&(AN.ins.getStateByCareList(__.equipCareList)||oB.ins.isFirstLogin&&GR.getInstance().checkModuleOpen(66)))return 3;if("4"==e){if(gR.ins.zsLv<3)return 1;if(AN.ins.getStateByCareList([9]))return 3}else{if("1"==e&&AN.ins.getStateByCareList(this.zsCareList))return 3;if("2"==e){if(gR.ins.lv<this.yyOpenLv)return 1;if(AN.ins.getStateByCareList(this.yuyiList))return 3}else if("3"==e){if(!this.isOpenLh())return 1;if(AN.ins.getStateByCareList(this.lunhuiCareList))return 3}else if("5"==e){if(-1==gR.ins.isniePan())return 1;if(AN.ins.getStateByCareList([270]))return 3;if(-1<gR.ins.isniePan()&&nB.FIRST_LONGIN)return 3}}return 0},e.isOpenZs=function(){var e=gR.ins.lv,t=gR.ins.zsLv;return e>=this.zsOpenLv||0<t},e.isOpenlw=function(){return gR.ins.lv>=this.lwOpenLv},e.isOpenZl=function(){return gR.ins.lv>=this.zlOpenLv&&dr.getComServiceDay()>=this.zlOpenDay},e.isOpenLh=function(){return 0<gR.ins.lunhuiId||!(dr.getOpenServiceDay()<this.lhOpenDay)&&!(gR.ins.zsLv<this.lhOpenLv)},e.setFirstTab=function(e){var t=this;gR.ins.forRed&&(gR.ins.forRed=!1,this.callLater(function(){t.vsc.selectedIndex=e}))},e.destroy=function(e){void 0===e&&(e=!0),NP.clearTextureByModule("layouts/actor/dz_icon_"),s.prototype.destroy.call(this,e);for(var t=[_r.getAtlasSubPath("soaring/fs_text_1.png"),_r.getAtlasSubPath("soaring/fs_text_2.png"),_r.getAtlasSubPath("soaring/fs_text_3.png"),_r.getAtlasSubPath("soaring/fs_text_4.png"),_r.getAtlasSubPath("soaring/fs_text_5.png"),_r.getAtlasSubPath("soaring/fs_text_6.png"),_r.getAtlasSubPath("soaring/fs_text_7.png"),_r.getAtlasSubPath("soaring/fs_text_8.png"),_r.getAtlasSubPath("soaring/fs_text_9.png"),_r.getAtlasSubPath("soaring/sex_1.png"),_r.getAtlasSubPath("soaring/sex_2.png"),_r.getAtlasSubPath("soaring/tj_tjmz_bg.png"),_r.getAtlasSubPath("soaring/hj_img_boss.png"),_r.getAtlasSubPath("soaring/ty_ts_dk.png")],i=0;i<t.length;i++){var n=G.loader.getRes(t[i]);n&&n.destroy(),n=null}},t.V_EQUIP="0",t.V_CS="4",t.V_ZS="1",t.V_YY="2",t.V_LH="3",t.V_QH="5",t}(Ip),Vz=function(n){function s(){this.vsc=null,this.yupei_open_day=0,this.yupei_open_level=0,this.resList=[204,225,224],s.__super.call(this),this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/actorCimelia/yq_btn_lp.png","ui/layouts/actorCimelia/yq_btn_yp.png"];this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1);var e=$e.MODEL.value($e.getIndex(173)).split(","),t=this.yupei_open_day=parseInt(e[0]),i=this.yupei_open_level=parseInt(e[1]);this.vsc.registAll([{cls:H$,id:"0",showDragon:!0},{cls:V$,id:"1",showDragon:!0,wait:hN.wait(hN.waitConfig(["YuPeiUpgrade","ConfigRule"],["CYuPei","CHelpDes"])),grayTip:function(){zB.ins.showMsg("开服第"+t+RP.n[452]+i+"级开启",1),UB.ins._playLevelNot()}}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)}b(s,"modules.actor.views.cimelia.CimeliaMainView",n);var e=s.prototype;return G.imps(e,{"ui.IVSCView":!0}),e.isOpenXinfa=function(){var e=gR.ins.zsLv,t=dr.getOpenServiceDay();return 4<=e&&11<=t},e.onAdd=function(e){n.prototype.onAdd.call(this,e),this.panelName="CimeliaMainView";var t=__.equipCareList.concat(this.resList);AN.reqRedPt(t);var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_DRAGONSOUL",[204],i),AN.ins.addListener("BTN_XINFA",[225],i),this.updateItemEnabled()},e.onRemove=function(e){n.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_DRAGONSOUL"),AN.ins.removeListener("BTN_XINFA")},e.updateByVSC=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.checkTips=function(e){switch(e){case"0":if(sR.draSoulHash){if(sR.getDragonSoulRed())return 3}else if(AN.ins.getStateByCareList([204]))return 3;break;case"2":if(!this.isOpenXinfa())return 1;if(pB._xinfaDataHash)for(var t=gR.ins.actorList.length,i=0;i<t;i++)if(pB.ins.getXinfaRedFP(i+1))return 3;if(AN.ins.getStateByCareList([225]))return 3;break;case"1":if(!SR.isOpen())return 1;if(SR.yupeiHash){if(SR.getYuPeiRed())return 3}else if(AN.ins.getStateByCareList([224]))return 3}return 0},e.onSubChanged=function(e,t){var i="";switch(e){case"0":i="actorCimelia/lh_title_lp.png";break;case"2":i="xinfa/xf_title_xj.png";break;case"1":i="actorCimelia/yp_text_yp.png"}this.setTitle(_r.getAtlasSubPath(i))},e.showByVSC=function(e,t){},e.hideByVSC=function(e,t){},e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},s.TAB_DRAGON_SOUL="0",s.TAB_YUPEI="1",s.TAB_XINFA="2",s}(Ip),Gz=function(i){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=0,this.left=this.right=0}b(e,"modules.actor.views.godlyequip.GodMainView",i);var t=e.prototype;return t.onAdd=function(e){i.prototype.onAdd.call(this,e),AN.reqRedPt([58,11,266]);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_GODLY_SUB",[58],t),AN.ins.addListener("BTN_BAYE",[11],t),AN.ins.addListener("BTN_GODLY_EQUIP",[266],t)},t.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_GODLY_SUB"),AN.ins.removeListener("BTN_BAYE"),AN.ins.removeListener("BTN_GODLY_EQUIP")},t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/godequip/yq_btn_shenzhuang.png","ui/layouts/godequip/yq_btn_rxsz.png","ui/layouts/godequip/yq_btn_rxdh.png"],e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:yX,id:"0",isHideBg:!0,wait:hN.wait(hN.waitAtlas(["actor"])),showDragon:!0},{cls:AJ,id:"1",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigBaye"],["CGodEquip"]),hN.waitAtlas("godequip")),showDragon:!0},{cls:MJ,id:"2",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigBaye","ConfigRule","ConfigDuanHun","ConfigDuanHunBuff","ConfigBaye"],["CGodEquip","CHelpDes","CConfigDuanHun","CConfigDuanHunBuff","CGodEquip"]),hN.waitAtlas("godequip")),showDragon:!0}]),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},t.redPtUpdate=function(e,t){this.updateItemEnabled()},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.updateByVSC=function(e){this.vsc.updateSelectedView(e)},t.checkTips=function(e){switch(e){case"0":if(AN.ins.getStateByCareList([58]))return 3;break;case"1":if(AN.ins.getStateByBtnName("BTN_BAYE"))return 3;break;case"2":if(AN.ins.getStateByCareList([266]))return 3}return 0},t.onSubChanged=function(e,t){var i="actor/sz_text_sz.png";switch(e){case"0":case"1":break;case"2":i="godequip/rxdh_text_rxdh.png"}this.setTitle(_r.getAtlasSubPath(i)),this.vsc.updateSelectedView(null)},e.SUB_GODLY_EQUIP="0",e.SUB_REXUE_EQUIP="1",e.SUB_REXUE_DUANHUN="2",e}(Ip),Uz=function(e){function t(){this._gridsList=null,this._data=null,this.index=0,this.activityId=0,this.arr=null,this.titleArr=null,t.__super.call(this)}b(t,"modules.activity.views.qq.QqDaTingItemView",e);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e._gridsList=new cq(3,!1),e._gridsList.pos(0,15),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.sp_container.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this._data=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showInfo=function(){var e,t=this,i=t.titleArr[0];t.txt_title.changeText(i),t.txt_itemTitle.innerHTML=t.titleArr[1],t.txt_title.x=t.width/2-t.txt_title.width/2-29,t.img_titleLeft.x=t.txt_title.x-t.img_titleLeft.width-15,t.img_titleRig.x=t.txt_title.x+t.txt_title.width+t.img_titleRig.width+70,(e=xn.MODEL.goodsReward(t.index))&&(t._gridsList.setGoodsItems(e,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight))},i.onClickHanlder=function(e){WB.reqPlayerAward(this._data.giftId,ql.create(this,this.onRefresh))},i.onRefresh=function(){Tu.sendToModule("UPDATE_VIEW",["modules.activity.ActivityModule"],37)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.arr=e,t._data=null,t.arr){for(var i,n=0;n<t.arr.length;n++)if(2!=(i=t.arr[n]).status){t._data=i;break}switch(null==t._data&&(t._data=t.arr[t.arr.length-1]),t.index=xn.getIndex(t._data.giftId),t.activityId=xn.MODEL.activityId(t.index),t.titleArr=xn.MODEL.goodsName(t.index).split("|"),t.showInfo(),t._data.status){case 0:t.btn_award.disabled=!0,t.btn_award.label="未达成",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!1;break;case 1:t.btn_award.disabled=!1,t.btn_award.label="可领取",t.img_got.visible=!1,t.btn_award.visible=!0,t.btn_award.showTip=!0;break;case 2:t.btn_award.disabled=!0,t.btn_award.label="已领取",t.img_got.visible=!0,t.btn_award.visible=!1,t.btn_award.showTip=!1}}}),t}(t_),Fz=function(e){function t(){this.gvo=null,this.gItem=null,t.__super.call(this)}b(t,"modules.activity.views.returns.item.Re_LoginItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_counter.visible=this.g_select.visible=this.g_sign.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClickHandler),t.gItem&&(t.gItem.parent&&t.gItem.parent.addChild(t.gItem),t.gItem.destroy(),t.gItem=null)},i.resetSelect=function(e){this.gvo&&this.gvo.giftId==e?this.g_select.visible=!0:this.g_select.visible=!1},i.onClickHandler=function(e){this.gvo&&(0!=this.gvo.status||0!=this.gvo.currentNum?this.event("change",this):zB.ins.showMsg(RP.n[507],1))},i.goToPos=function(){if(this.gItem){var e=this.localToGlobal(new Uh(this.width>>1,this.gItem.x+this.gItem.height>>1));zB.ins.playGetItemsByPos([this.gItem.goodsId],new Uh(e.x,e.y))}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.gvo=e,t.g_sign.visible=2==t.gvo.status,t.filters=2==t.gvo.status?A_.getGrayFilter3():null,t.gItem||(t.gItem=new MF,t.g_item.addChild(t.gItem));var i=t.gvo.rewardGoods[0];t.gItem.bindData=i;var n=Bi.getIndex(i.goodsId);t.txt_name.changeText(Bi.MODEL.simpleName(n)),t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(n)),t.g_days.skin=_r.getOsNewPath("invest/login/wjhg_text_"+t.gvo.targetValue),1==t.gvo.currentNum&&0==t.gvo.status?t.g_counter.visible=!0:t.g_counter.visible=!1,t.gItem.clickHandler&&t.gItem.clickHandler.recover(),t.gItem.clickHandler=null,0==t.gvo.currentNum&&0==t.gvo.status||(t.gItem.clickHandler=ql.create(t,t.onClickHandler,null,!1))}}),t}(Oy),qz=function(e){function t(e){this.gvo=null,this.gItem=null,this.eff=null,this.acitivityId=0,t.__super.call(this),this.acitivityId=e}b(t,"modules.activity.views.returns.item.Re_LoginItem2",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_got.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClickHandler),t.gItem&&(t.gItem.parent&&t.gItem.parent.addChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.clearEff()},i.setShow=function(){var e=this;e.g_got.visible=2==e.gvo.status,e.gItem.clickHandler&&e.gItem.clickHandler.recover(),e.gItem.clickHandler=null,1==e.gvo.status&&(e.gItem.clickHandler=ql.create(e,e.onClickHandler,null,!1)),e.clearEff(),e.eff||1!=e.gvo.status||(e.eff=kB.createEffect("jm1554",2+(e.width>>1),5+(e.g_bold.height>>1),e))},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.onClickHandler=function(e){e instanceof protos.backpack.DtoGoods||this.gvo&&1==this.gvo.status&&WB.reqPlayerAward(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.acitivityId);t&&(this.gvo=t.getGift(e),this.gvo&&(this.setShow(),this.goToPos()))},i.goToPos=function(){if(this.gItem){var e=this.localToGlobal(new Uh(this.width>>1,this.gItem.x+this.gItem.height>>1));zB.ins.playGetItemsByPos([this.gItem.goodsId],new Uh(e.x,e.y))}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){switch(t.gvo=e,xn.MODEL.targetParamType1(t.gvo.index)){case"LOGIN_DAY":t.txt_login.color="#e6d80d",t.txt_login.changeText(t.gvo.targetValue+"天");break;case"BACK_TASK_SCORE":t.txt_login.color="#91856d",t.txt_login.changeText("活跃值"+t.gvo.targetValue)}t.gItem||(t.gItem=new MF(100),t.gItem.needEffect=!1,t.gItem.needGridBg=!1,t.g_item.addChild(t.gItem)),t.gvo.rewardGoods[0]&&(t.txt_gnum.changeText("x"+t.gvo.rewardGoods[0].goodsNum),t.gItem.bindData=yB.create(t.gvo.rewardGoods[0].goodsId)),t.setShow()}}),t}(Dy),jz=function(e){function t(){this.taskId=0,t.__super.call(this)}b(t,"modules.activity.views.returns.item.Re_TaskItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_finish.visible=this.txt_link.visible=!1,this.txt_link.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.txt_link.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){KP.ins.goToLink(this.taskId)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){this.taskId=e.taskid;var t=Ut.getIndex(this.taskId);this.txt_task.changeText(Ut.MODEL.taskName(t)),this.txt_award.changeText(RP.n[508]+Ut.MODEL.singleScore(t));var i=Ut.MODEL.targetMaxTimes(t);this.txt_finish.visible=e.currentNum>=i,this.txt_link.visible=!this.txt_finish.visible;var n="("+e.currentNum+"/"+i+")";this.txt_times.color=e.currentNum>=i?"#23b11f":"#ff2e24",this.txt_times.changeText(n)}}),t}(Ry),Wz=function(e){function t(){this._data=null,this.isFloor=!1,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_BargainGuildItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.isFloor=!1,this.btn_bargain.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_bargain.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){this.isFloor?zB.ins.showById(4625,1):ZP.bargainNum>=ZP.allBargainNum?zB.ins.showById(4633,1):this._data&&ZP.reqBargain(this._data.giftId,this._data.playerId,2)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t._data=e;var i=zi.getIndex(e.giftId),n=zi.MODEL.actCostGold(i).split(":"),s=zi.MODEL.oriCostGold(i).split(":");if(!(!n||n.length<1||!s||s.length<1)){t.isFloor=e.cutPrice>=parseInt(s[1])-parseInt(n[1]);var o=Ql.createColor(e.playerName,"#0098FF");o+=RP.n[509],o+=Ql.createColor(zi.MODEL.dec(i),"#ff2e24"),t.txt_name.innerHTML=o,o="已砍:",o+=Ql.createColor(e.cutPrice,"#23b11f")+"/"+(parseInt(s[1])-parseInt(n[1])),t.txt_times.innerHTML=o,t.g_icon.x=t.txt_times.x+t.txt_times.contextWidth,t.txt_hand.innerHTML="("+Ql.createColor(e.hand+"","#23b11f")+RP.n[510],t.txt_hand.x=t.g_icon.x+48,0!=e.isBargain?(t.btn_bargain.label="已 砍",t.btn_bargain.disabled=!0):(t.btn_bargain.label="砍一刀",t.btn_bargain.disabled=!1)}}}),t}(Vy),Yz=function(i){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=0,this.left=this.right=0}b(e,"modules.actor.views.longwen.LongWenMV",i);var t=e.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.size(960,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/longwen/yq_btn_lwxq.png","ui/layouts/longwen/yq_btn_lwfj.png"];e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:z$,id:"0",isHideBg:!0,wait:hN.wait(hN.waitConfig(["DragonDesignGrid","DragonView","DragonDesignUpgrade","DragonDesignUnlock"],["CConfigDragonPartOpen","CConfigDragonView","CConfigDragonInfo","CConfigDragonDesignOpen"])),showDragon:!0},{cls:Y$,id:"1"}]),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},t.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_DRAGON",[229,230],t)},t.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_DRAGON")},t.hideByVSC=function(e,t){},t.showByVSC=function(e,t){var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_DRAGON",[229,230],i)},t.updateByVSC=function(e){this.vsc.updateSelectedView()},t.updatelongWen=function(e){},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.checkTips=function(e){return"0"==e&&AN.ins.getStateByCareList([230])?3:"1"==e&&AN.ins.getStateByCareList([229])?3:0},t.onSubChanged=function(){this.setTitle(_r.getAtlasSubPath("longwen/lw_text_lw.png"))},e}(Ip),zz=function(e){function t(){this._data=null,this.gItem=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_BargainItem",e);var i=t.prototype;return i.creatItem=function(){this.gItem||(this.gItem=new MF,this.gItem.toolTipEnabled=!1,this.sp.addChild(this.gItem))},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_baring.visible=this.txt_gold.visible=!1,this.g_got.visible=this.g_select.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t._data=null,t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.off("click",t,t.onClickHandler)},i.refresh=function(){this._data&&this._data.gvo&&(this.g_select.visible=this._data.gvo.giftId==ZP.gid_select)},i.setAwards=function(){var e=zi.getIndex(this._data.gvo.giftId),t=zi.MODEL.goodsReward(e).split(";")[0],i=JP.praseGoodsStr(t);if(i&&!(i.length<1)){this.creatItem();var n=i[0];this.gItem&&n&&(this.gItem.bindData=n),this.txt_name.changeText(zi.MODEL.dec(e))}},i.setRabate=function(){var e=parseInt(this._data.gvo.oriCostGold[1]),t=parseInt(this._data.gvo.actCostGold[1]),i=(Math.floor(t/e*100%10)+1).toFixed(0),n=(Math.floor(t/e*10)+1).toFixed(0);this.c_ten.index=n,this.c_num.index=i},i.onClickHandler=function(e){this._data&&this._data.gvo&&ZP.gid_select!=this._data.gvo.giftId&&(ZP.gid_select=this._data.gvo.giftId,Tu.sendToModule("UPDATE_BARGAIN_SELECTED",["modules.activity.ActivityModule"],this._data))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t._data=e,t._data&&t._data.gvo){t.setAwards(),t.setRabate(),t.g_icon.x=258,t.g_got.visible=t._data.gvo.perBuyNum>=t._data.gvo.personalLimit,t.g_got.visible?(t.txt_baring.visible=!1,t.txt_gold.visible=!0):(t.txt_baring.visible=null!=t._data.info,t.txt_gold.visible=null==t._data.info),t.txt_gold.visible&&t.txt_gold.changeText("底价:"+t._data.gvo.actCostGold[1]),t.g_icon.visible=!t.txt_baring.visible;var i=Math.max(t._data.gvo.personalLimit-t._data.gvo.perBuyNum,0),n=0<i?"#23b11f":"#ff2e24";t.txt_limit.innerHTML="限购"+Ql.createColor(i.toString(),n)+"/"+t._data.gvo.personalLimit,t.refresh()}}),t}(Uy),Xz=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activityDaily.view.item.OS_DayReturnItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(5,!1),e._gridsList.pos(5,-16),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gnameFont=JP.gnameFont,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+2,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHanlder),this.btn_award.visible=this.img_got.visible=!1,this.gvo=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.showInfo=function(){var e=this;e.txt_times.innerHTML=RP.n[511]+e.gvo.maxRechargeDay+"天",e.img_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.label=e.btn_award.showTip?"可领取":"未达成")},i.onClickHanlder=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.activityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo())}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e&&(t.gvo=e,t.gvo)){t.activityId=t.gvo.owerActivity,t.index=St.getIndex(t.gvo.giftId);var i=St.MODEL.goodsReward(t.index);t._gridsList.setGoodsItems(i,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),t.showInfo()}}),t}(ny),Qz=function(e){function t(){this.exchangeId=0,this.exTimes=0,this.limitTimes=0,this.g_items=null,this.cList=null,this.aList=null,this.activityId=0,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_CoupletItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exchange.on("click",this,this.onClickHanlder)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearItems(),this.btn_exchange.off("click",this,this.onClickHanlder)},i.setExchagne=function(){if(this.cList&&!(this.cList.length<1)){for(var e,t=0;t<this.cList.length;t++)(e=this.cList[t])&&this.g_items[t]&&(e.goodsNum>TR.ins.getGoodsNum(e.goodsId)?this.g_items[t].filters=A_.getGrayFilter():this.g_items[t].filters=null);this.btn_exchange.showTip=this.isExchagne}},i.goToPos=function(){if(this.aList&&!(this.aList.length<1)){for(var e=[],t=0;t<this.aList.length;t++)this.aList[t]&&e.push(this.aList[t].goodsId);var i=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(e,new Uh(i.x,i.y))}},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[];var t,i=0;for(i=0;i<e.cList.length;i++)(t=new MF).bindData=e.cList[i],t.needGridBg=!1,t.needEffect=!1,t.scaleX=t.scaleY=.8,t.pos(20+82*i,16),e.g_items.push(t),e.addChild(t);for(e.setExchagne(),i=0;i<e.aList.length;i++)(t=new MF).bindData=e.aList[i],t.scaleX=t.scaleY=.8,t.pos(527+82*i,13),e.g_items.push(t),e.addChild(t)},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onClickHanlder=function(e){if(this.isExchagne)OR.requestExchange(this.exchangeId);else{var t=It.getIndex(this.activityId),i=It.MODEL.isReset(t);zB.ins.showById(i,1)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){this.activityId=e.activityId,this.exchangeId=e.exId,this.exTimes=e.exTimes;var t=xa.getIndex(this.exchangeId);xa.MODEL.desc(t)&&(this.txt_desc.innerHTML=xa.MODEL.desc(t)),this.limitTimes=xa.MODEL.limitNum(t),this.cList=yB.createStrArr(xa.MODEL.consumption(t)),this.aList=yB.createStrArr(xa.MODEL.reward(t)),this.setAwards()}}),p(0,i,"isExchagne",function(){if(!this.cList)return!1;if(0!=this.limitTimes&&this.exTimes>=this.limitTimes)return!1;for(var e,t=!0,i=0;i<this.cList.length;i++)if((e=this.cList[i])&&e.goodsNum>TR.ins.getGoodsNum(e.goodsId)){t=!1;break}return t}),t}(Wy),Jz=function(e){function t(){t.__super.call(this),this.g_title.skin=_r.getAtlasSubPath("activity/pxx_text_ghbk.png")}b(t,"modules.activity.views.sp.Sp_BargainGuildView",Gy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Wz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.list.visible=this.txt_no.visible=!1,this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged),ZP.reqGuildBList()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.updateView=function(e){if(e&&e instanceof protos.activity.toc_30807){var t=[];zi.count<=0&&t.push({url:_r.getJxrDBPath("ConfigActivityLimitBuy"),type:"arraybuffer",cls:zi}),bn.count<=0&&t.push({url:_r.getJxrDBPath("PinXiXiComResource"),type:"arraybuffer",cls:bn}),t.length<1?this.onJxrComplete(e):uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete,[e]))}},i.onJxrComplete=function(e){var t=e.g_list;this.list.visible=0<t.length,this.txt_no.visible=t.length<1,this.list.visible&&(t=t.sort(this.sortArray),this.list.dataSource=t);var i=ZP.allBargainNum-e.bargainNum;i<0&&(i=0),this.txt_times.innerHTML=RP.n[512]+Ql.createColor(i.toString(),0<i?"#23b11f":"#ff2e24")+"/"+ZP.allBargainNum+"次"},i.sortArray=function(e,t){var i,n=0,s=0,o=0;return(n=e.isBargain?7:(o=zi.getIndex(e.giftId),i=zi.MODEL.actCostGold(o).split(":"),e.cutPrice>=parseInt(i[1])?5:3))==(s=t.isBargain?7:(o=zi.getIndex(t.giftId),i=zi.MODEL.actCostGold(o).split(":"),t.cutPrice>=parseInt(i[1])?5:3))?-(t.giftId-e.giftId):n-s},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),Zz=function(e){function t(){this.exchangeId=0,this.g_items=null,this.leftNum=0,this.cList=null,this.aList=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_CrackerItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_work.on("click",this,this.onClickHanlder)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearItems(),this.btn_work.off("click",this,this.onClickHanlder)},i.setTimes=function(){var e=this;e.leftNum<0&&(e.leftNum=0);var t=0<e.leftNum?"#23b11f":"#ff2e24";e.txt_times.innerHTML=RP.n[513]+Ql.createColor(e.leftNum.toString(),t)+"次",e.setExchagne(),e.btn_work.disabled=e.leftNum<1,e.btn_work.label=e.btn_work.disabled?RP.n[514]:"制 作"},i.setExchagne=function(){var e=this;if(e.cList&&e.cList[0]){if(e.txt_num.visible=0<e.leftNum,e.txt_num.visible){var t=TR.ins.getGoodsNum(e.cList[0].goodsId);e.txt_num.changeText(t+"/"+e.cList[0].goodsNum),e.txt_num.color=t>=e.cList[0].goodsNum?"#23b11f":"#ff2e24"}e.g_items&&e.g_items[0]&&(e.g_items[0].goodsNum=1)}e.btn_work.showTip=e.isEnough},i.refresh=function(e){this.leftNum-=e,this.setTimes(),this.goToPos()},i.goToPos=function(){if(this.aList&&!(this.aList.length<1)){for(var e=[],t=0;t<this.aList.length;t++)this.aList[t]&&e.push(this.aList[t].goodsId);var i=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(e,new Uh(i.x,i.y))}},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[];var t,i=0,n=0;if(e.cList&&0<e.cList.length)for(i=0;i<e.cList.length;i++)e.cList[i]&&e["g_cost_"+i]&&((t=new MF).bindData=e.cList[i],e.g_items.push(t),e["g_cost_"+i].addChild(t),n=Bi.getIndex(e.cList[i].goodsId),e["txt_cgn_"+i].changeText(Bi.MODEL.simpleName(n)),e["txt_cgn_"+i].color=ms.getByQuality(Bi.MODEL.colourId(n)));if(e.aList&&0<e.aList.length)for(i=0;i<e.aList.length;i++)e.aList[i]&&e["g_award_"+i]&&((t=new MF).bindData=e.aList[i],e.g_items.push(t),e["g_award_"+i].addChild(t),n=Bi.getIndex(e.aList[i].goodsId),e["txt_agn_"+i].changeText(Bi.MODEL.simpleName(n)),e["txt_agn_"+i].color=ms.getByQuality(Bi.MODEL.colourId(n)))},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onClickHanlder=function(e){if(!(this.leftNum<1)&&this.cList&&!(this.cList.length<1)){for(var t,i=0;i<this.cList.length;i++)if(t=this.cList[i])if(15==t.goodsId){if(gR.ins.coin<t.goodsNum)return void zB.ins.showById(4441,1)}else if(14==t.goodsId){if(gR.ins.YB<t.goodsNum)return void Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],1)}else if(t.goodsNum>TR.ins.getGoodsNum(t.goodsId))return void zB.ins.showById(4440,1);OR.requestExchange(this.exchangeId)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){this.exchangeId=e.exId;var t=xa.getIndex(this.exchangeId);this.leftNum=xa.MODEL.limitNum(t)-e.exTimes,xa.MODEL.desc(t)&&(this.txt_name.innerHTML=xa.MODEL.desc(t)),this.cList=yB.createStrArr(xa.MODEL.consumption(t)),this.aList=yB.createStrArr(xa.MODEL.reward(t)),this.setAwards(),this.setTimes()}}),p(0,i,"isEnough",function(){if(this.leftNum<1)return!1;for(var e,t=0;t<this.cList.length;t++)if(e=this.cList[t])if(15==e.goodsId){if(gR.ins.coin<e.goodsNum)return!1}else if(14==e.goodsId){if(gR.ins.YB<e.goodsNum)return!1}else if(e.goodsNum>TR.ins.getGoodsNum(e.goodsId))return!1;return!0}),t}(zy),Kz=function(e){function t(){this.giftId=0,this.curPrice=0,this._data=null,this.eTime=NaN,t.__super.call(this),this.g_title.skin=_r.getAtlasSubPath("activity/pxx_text_qrgm.png")}b(t,"modules.activity.views.sp.Sp_BargainPromptView",Fy);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_bargain.on("click",t,t.onClickHandler),t.btn_buy.on("click",t,t.onClickHandler),t.btn_close.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),G.timer.clear(t,t.onResetTime),t.btn_bargain.off("click",t,t.onClickHandler),t.btn_buy.off("click",t,t.onClickHandler),t.btn_close.off("click",t,t.onClickHandler)},i.updateView=function(e){var t=this;if(e&&e.info&&e.gvo){t._data=e,t.giftId=e.info.giftId;var i=zi.getIndex(t.giftId),n=parseInt(zi.MODEL.oriCostGold(i).split(":")[1]),s=n-parseInt(zi.MODEL.actCostGold(i).split(":")[1]),o=Math.max(s-e.info.cutPrice,0);t.txt_goal.innerHTML=RP.n[515]+Ql.createColor(o.toString(),"#e6d80d")+"元宝";var a=a=0<(o=Math.max(e.gvo.personalLimit-e.gvo.perBuyNum,0))?"#23b11f":"#ff2e24";t.curPrice=n-e.info.cutPrice,t.curPrice<0&&(t.curPrice=0);var r="";r+=RP.n[516],r+=Ql.createColor(t.curPrice.toString(),"#e6d80d"),r+=RP.n[517],r+=Ql.createColor(zi.MODEL.dec(i),"#ff2e24")+"<br>",r+=RP.n[518]+Ql.createColor(o.toString(),a)+"/"+e.gvo.personalLimit+")",t.txt_cost.innerHTML=r,t.eTime=e.endTime,t.onResetTime(),0<t.eTime&&G.timer.frameLoop(10,t,t.onResetTime)}},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:case this.btn_bargain:hN.ins._closePanel(this);break;case this.btn_buy:if(gR.ins.YB<this.curPrice)return void KQ.ins.showNoGold();WB.buyGift(this.giftId,ql.create(this,this.onRefresh))}},i.onRefresh=function(){hN.ins._closePanel(this),Tu.sendToModule("UPDATE_BARGAIN_SELECTED",["modules.activity.ActivityModule"],{isBuy:!0})},i.onResetTime=function(){var e=this;e._data?(e.eTime=e._data.endTime-dr.serverTimeSec,0<e.eTime?e.txt_time.innerHTML=RP.n[519]+Ql.createColor(Jp.getSTRDHMS(e.eTime),"#23b11f"):(e.txt_time.innerHTML=RP.n[520]+Ql.createColor("已结束","#ff2e24"),G.timer.clear(e,e.onResetTime),hN.ins._closePanel(e))):G.timer.clear(e,e.onResetTime)},t}(),$z=function(e){function t(){this.gItem=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_TreeGoodsItem",e);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.gItem&&(this.gItem.parent&&this.gItem.parent.removeChild(this.gItem),this.gItem.destroy(),this.gItem=null)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e&&e.dto)if(t.gItem||(t.gItem=new MF(84),t.gItem.needGridBg=!1,t.gItem.needEffect=!1,t.gItem.needMoShow=!1,t.gItem.needGodShow=!1,t.g_item.addChild(t.gItem)),t.gItem.bindData=e.dto,t.g_bold.visible=!0,e.isShow){var i=Bi.getIndex(e.dto.goodsId);t.g_name.changeText(Bi.MODEL.simpleName(i)),t.g_name.color=ms.getByQuality(Bi.MODEL.colourId(i))}else e.hasOwnProperty("gName")?(t.g_name.changeText(e.gName),t.g_name.color="#e6d80d"):t.g_bold.visible=!1}),t}(tI),eX=function(i){function t(){var e=this;e.vsc=null,e.resList=[242,241],t.__super.call(e),e.size(720,1280),e.left=e.right=e.top=e.bottom=0,e.centerX=e.centerY=0}b(t,"modules.actor.views.mo.MoEquipOperateV",i);var e=t.prototype;return e.initialize=function(){var e=this;e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onVSCSelected,null,!1),e.navList=["ui/layouts/actormo/yq_btn_mzjj.png","ui/layouts/actormo/yq_btn_mzhc.png"],e.vsc.registAll([{cls:NX,id:"0",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["MagicEquipUpgradeResource"],["CMagicEquipUpgradeResource"]))},{cls:PX,id:"1",isHideBg:!0,wait:hN.wait(hN.waitConfig(["MagicEquipCombineResource"],["CMagicEquipCombineResource"]))}]),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},e.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=__.equipCareList.concat(this.resList);AN.reqRedPt(t)},e.destroy=function(e){void 0===e&&(e=!0),i.prototype.destroy.call(this,e)},e.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.checkTips=function(e){if("1"==e){if(AN.ins.getStateByCareList([241]))return 3}else if("0"==e&&AN.ins.getStateByCareList([242]))return 3;return 0},e.onVSCSelected=function(e,t){this.setTitle(_r.getAtlasSubPath("actormo/mz_title_ns.png"))},t}(Ip),tX=function(e){function t(){this.g_items=null,this.activityId=0,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_FireworksPromptView",Zy);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_cp.selected=!0,t.btn_close.on("click",t,t.onClickHandler),t.btn_cancel.on("click",t,t.onClickHandler),t.btn_sure.on("click",t,t.onClickHandler),t.btn_cp.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.clearItems(),t.btn_close.off("click",t,t.onClickHandler),t.btn_cancel.off("click",t,t.onClickHandler),t.btn_sure.off("click",t,t.onClickHandler),t.btn_cp.off("click",t,t.onClickHandler)},i.update=function(e){var t=this;if(e&&(t.activityId=e.activityId,e.awards&&!(e.awards.length<1))){var i;t.clearItems(),t.g_items=[];for(var n=0,s="",o="",a=0;a<e.awards.length;a++)if(t["txt_gr_"+a]){if(!(i=e.awards[a]))continue;var r=new MF;r.bindData=i,t.g_items.push(r),t["txt_gr_"+a].addChild(r),n=Bi.getIndex(i.goodsId),t["txt_gn_"+a].changeText(Bi.MODEL.simpleName(n)),t["txt_gn_"+a].color=ms.getByQuality(Bi.MODEL.colourId(n)),0==a?s=Ql.createColor(Bi.MODEL.name(n),t["txt_gn_"+a].color):1==a&&(o=Ql.createColor(Bi.MODEL.name(n),t["txt_gn_"+a].color))}t.txt_cost.innerHTML=RP.n[521]+s+RP.n[522]+o}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_close:case t.btn_cancel:hN.ins._closePanel(t);break;case t.btn_sure:JP.isShowFireTips=t.btn_cp.selected,WB.reqFireworks(t.activityId),hN.ins._closePanel(t);break;case t.btn_cp:t.btn_cp.selected=!t.btn_cp.selected}},t}(),iX=function(e){function t(){this.gvo=null,this.acitivityId=0,this._BAR_W=0,this.gItem=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_TreeScoreItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._BAR_W=this.bar.width,this.g_red.visible=this.g_got.visible=!1,this.g_item.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.gvo=null,t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.g_item.off("click",t,t.onClickHandler)},i.resetShow=function(){this.g_red.visible=1==this.gvo.status,this.g_got.visible=2==this.gvo.status},i.onClickHandler=function(e){this.gvo&&hN.ins.open("SP_TREE_BOXS",{acitivityId:this.acitivityId,gvo:this.gvo})},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.gvo=e.gvo,t.acitivityId=e.acitivityId,t.gItem||(t.gItem=new MF(100),t.gItem.pos(t.g_item.x-15,t.g_item.y+10),t.g_item.addChild(t.gItem),t.gItem.needEffect=!1,t.gItem.needGridBg=!1),t.gItem.bindData=t.gvo.rewardGoods[0],t.gItem.goodsNum=1,t.gItem.clickHandler&&t.gItem.clickHandler.recover(),t.gItem.clickHandler=null,t.gItem.clickHandler=ql.create(t,t.onClickHandler,null,!1),t.txt_num.changeText(t.gvo.targetValue+""),t.txt_num.color=0==t.gvo.status?"#ff2e24":"#23b11f";var i=(t.gvo.currentNum-e.pre)/(t.gvo.targetValue-e.pre);1<i&&(i=1),i<0&&(i=0);var n=t.bar.scrollRect||new u_(0,0,t.bar.width,t.bar.height);n.width=t._BAR_W*i,t.bar.scrollRect=n,t.resetShow()}}),t}(aI),nX=function(i){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(e,"modules.actor.views.mo.MoMainView",i);var t=e.prototype;return t.onAdd=function(e){i.prototype.onAdd.call(this,e),AN.reqRedPt([238,261]);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_MO_EQUIP",[238,261,262],t)},t.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_MO_EQUIP")},t.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/actormo/yq_btn_mz.png","ui/layouts/actormo/yq_btn_zh2.png","ui/layouts/actormo/yq_btn_fjmz.png"],this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.vsc.registAll([{cls:VX,id:"0",showDragon:!0,isHideBg:!0},{cls:GX,id:"1",showDragon:!0,isHideBg:!0,grayTip:function(){var e=GR.getInstance().getErrorTips(60);zB.ins.showMsg(e,1)},wait:hN.wait(hN.waitConfig(["ConfigRule"],["CHelpDes"]))},{cls:J$,id:"2"}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},t.redPtUpdate=function(e,t){this.updateItemEnabled()},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.updateByVSC=function(e){this.vsc.updateSelectedView(e)},t.checkTips=function(e){switch(e){case"0":if(AN.ins.getStateByCareList([238])||AN.ins.getStateByCareList([241])||AN.ins.getStateByCareList([242]))return 3;break;case"1":if(!GR.getInstance().checkModuleOpen(60))return 1;if(AN.ins.getStateByCareList([261])||AN.ins.getStateByCareList([262]))return 3}return 0},t.onSubChanged=function(e,t){var i="";switch(e){case"0":case"2":i="actormo/mz_title_mz.png";break;case"1":i="actormo/mzzh_text_zh.png"}this.setTitle(_r.getAtlasSubPath(i)),this.vsc.updateSelectedView(null)},e.SUB_MO_EQUIP="0",e.SUB_MO_SUIT="1",e.SUB_MO_BREAK="2",e}(Ip),sX=function(e){function t(){this.index=0,this.gItem=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_TreeWholeItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.gItem&&(this.gItem.parent&&this.gItem.parent.removeChild(this.gItem),this.gItem.destroy(),this.gItem=null)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){if(t.index=Jn.getIndex(e.id),t.txt_level.changeText("第"+Jn.MODEL.level(t.index)+"层奖池"),t.txt_score.changeText(Jn.MODEL.minGrouthValue(t.index)+""),!t.gItem){t.gItem=new MF(84),t.gItem.needGridBg=!1,t.gItem.needEffect=!1,t.g_item.addChild(t.gItem);var i=JP.praseGoodsStr(Jn.MODEL.speAward(t.index));i&&0<i.length&&(t.gItem.dataSource=i[0])}t.filters=e.growth>=Jn.MODEL.minGrouthValue(t.index)?null:A_.getGrayFilter5(),t.txt_score.color=e.growth>=Jn.MODEL.minGrouthValue(t.index)?"#e0d6c1":"#808080",t.txt_level.color=e.growth>=Jn.MODEL.minGrouthValue(t.index)?"#e6d80d":"#808080"}}),t}(rI),oX=function(e){function t(){this.gvo=null,this.activityId=0,this.index=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.sp.item.Sp_WelfareItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new cq(3,!1),e._gridsList.pos(-23,-24),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.sp.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.gvo=null,this.btn_award.on("click",this,this.onClickHanlder),this.btn_award.visible=this.g_got.visible=!1},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHanlder)},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),laya.ui.View.prototype.destroy.call(this,e)},i.showInfo=function(){var e=this;e.g_got.visible=2==e.gvo.status,e.btn_award.visible=2!=e.gvo.status,e.btn_award.visible&&(e.btn_award.disabled=0==e.gvo.status||3==e.gvo.status,e.btn_award.showTip=1==e.gvo.status,e.btn_award.showTip?e.btn_award.label="可领取":e.btn_award.label=3==e.gvo.status?"已领完":"未达成");var t=St.MODEL.content(e.index),i=[];if(t&&""!=t){if(e.gvo.scoreObj){if(!e.gvo.scoreObj.hasOwnProperty("uTimes"))return;var n=e.gvo.scoreObj.uTimes,s=parseInt(St.MODEL.targetParam2(e.index));i.push(s<=n?"#23b11f":"#ff2e24"),i.push(s<=n?s:n)}e.txt_term.innerHTML=mp.getFormat(t,i)}},i.onClickHanlder=function(e){WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.activityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.showInfo(),this.goToPos(),Tu.sendToModule("UPDATE_VIEW",["modules.activity.ActivityModule"],20))}},i.goToPos=function(){var e,t=St.MODEL.goodsReward(this.index);if(t&&(e=t.split(";")),e&&!(e.length<1)){for(var i=[],n=0;n<e.length;n++)if(t=e[n]){var s=t.split(",");i.push(parseInt(s[0]))}var o=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(i,new Uh(o.x,o.y))}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e&&e instanceof protos.activity.GiftVo){t.gvo=e,t.activityId=t.gvo.owerActivity,t.index=St.getIndex(t.gvo.giftId);var i=St.MODEL.goodsReward(t.index);i&&(t._gridsList.setGoodsItems(i,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight)),t.showInfo()}}),t}(lI),aX=function(e){function t(){this.arr1=null,this.text=null,t.__super.call(this),this.initUI()}b(t,"modules.activity.views.sp.Sp_Firework_RecordView",Qy);var i=t.prototype;return i.initUI=function(){this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.updateView=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i].playerName,s=e[i].goodsName,o=e[i].goodsNum,a=e[i].goodsColor,r=ms.getByQuality(a),l=Ql.createColor(n,"#02b0e9")+"获得"+Ql.createColor(s+"x"+o,r);t.push(l)}this.getListData(t),this.list.dataSource=t},i.getListData=function(e){this.arr1=[];for(var t=0;t<e.length;t++)this.arr1.push({desStr:{text:e[t]}});this.list.array=this.arr1,this.list.renderHandler=ql.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr1.length)){var i=this.arr1[t];this.text=e.getChildByName("txt_des"),this.text.innerHTML=i.desStr.text}},i.onClick=function(e){hN.ins.close("FIRERECORD_VIEW")},t}(),rX=function(t){function i(){var e=this;e.vsc=null,e.resList=[],i.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/actor_other/btn_tab_zb.png","ui/layouts/actor_other/yq_btn_sz1.png"];e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:K$,id:"0",showDragon:!0,isHideBg:!0},{cls:FX,id:"1",showDragon:!0,isHideBg:!0}]),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)}b(i,"modules.actor.views.other.OtherMainView",t);var e=i.prototype;return e.onSubChanged=function(e,t){var i="";switch(e){case"0":i="other/js_bt_js.png";break;case"1":i="other/sz_text_sz.png"}this.setTitle(_r.getAtlasSubPath(i))},e.checkTips=function(e){return 0},e.onAdd=function(e){t.prototype.onAdd.call(this,e)},e.onRemove=function(e){t.prototype.onRemove.call(this,e)},e.updateByVSC=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.showByVSC=function(e,t){},e.hideByVSC=function(e,t){},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},i.V_EQUIP="0",i.V_GODEQUIP="1",i}(Ip),lX=function(e){function t(){this.vsc=null,t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.actor.views.ringup.RingUpMainView",Ip);var i=t.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=[],e.vsc=new SB(e),e.vsc.registAll([{cls:jX,id:0,showDragon:!0,isHideBg:!0}]),e.vsc.selectHandler=ql.create(e,e.onViewChanged,null,!1)},i.onViewChanged=function(e,t){"0"==e&&this.setTitle(_r.getAtlasSubPath("ringup/tj_text_tj.png"))},t.NAME="RINGUPMAINVIEW",t}(),cX=function(i){function e(){this.vsc=null,this.SUB_EQUIP_DRESS="0",this.SUB_ZHUHUN="1",e.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(e,"modules.actor.views.samsaraequip.SamsaraEquipMainView",i);var t=e.prototype;return t.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/samsaraequip/yq_btn_lhzb.png","ui/layouts/lunhuizhuhun/yq_btn_lhzh.png"],this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1);this.vsc.registAll([{cls:t0,id:this.SUB_EQUIP_DRESS,isHideBg:!0,wait:hN.wait(hN.waitConfig(["lunhuiRefine","lunhuiRefineCycle","lunhuiRefineValue"],["SamEquipRefine","SamEquipCycle","SamEquipLimitLevel"]))},{cls:OX,id:this.SUB_ZHUHUN,isHideBg:!0,wait:hN.wait(hN.waitConfig(["ZhuHunUpgradeResource","SuolianPositionResource","SoulSuolianResource","MohuaResource"],["CZhuHunUpgradeResource","CSuolianPositionResource","CSoulSuolianResource","CMohuaResource"])),grayTip:function(){zB.ins.showMsg(GR.getInstance().getErrorTips(73),1)}}]),this.vsc.filterHandler=ql.create(this,this.checkRedPoint,null,!1)},t.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_SAMSARA_EQUIP1",[256,271],t),dR.reqZhuhunTotalInfo()},t.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_SAMSARA_EQUIP")},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.onSubChanged=function(e,t){var i;switch(e){case this.SUB_EQUIP_DRESS:i=_r.getAtlasSubPath("samsaraequip/lhzb_title_lhzb.png");break;case this.SUB_ZHUHUN:i=_r.getAtlasSubPath("lunhuizhuhun/lhzh_text_zh.png")}this.setTitle(i)},t.checkRedPoint=function(e){if(e==this.SUB_EQUIP_DRESS&&AN.ins.getStateByCareList([256]))return 3;if(e==this.SUB_ZHUHUN){if(!hR.isOpenModule)return 1;if(AN.ins.getStateByCareList([271]))return 3}return 0},t.updateView=function(){var e=this.vsc.selectedView;e&&e.updateView&&e.updateView(),this.vsc.updateItemEnabled()},t.updateRole=function(e){if(e&&(!e||e.hasOwnProperty("actor"))){var t=this.vsc.selectedView;t&&t.chooseRole&&t.chooseRole(e.actor)}},e.NAME="SamsaraEquipMainView",e}(Ip),uX=function(e){function t(){var e=this;e.gp=null,e.rid=0,t.__super.call(e),e.gp||(e.gp=new wj(1,4,93,24),e.gp.pos(55,115),e.gp.centerX=0,e.gp.height=120,e.addChild(e.gp)),e.gp.vScrollBarSkin="",e.gp.vScrollBar.elasticDistance=0}b(t,"modules.activityDaily.view.CopyShareView",Co);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn.on("click",t,t.onClick);var i=hN.ins._getOpenData("COPY_SHARE");t.rid=i.id||0,i.content?t.lbl_content1.changeText(i.content):t.lbl_content1.changeText(RP.n[523]),t.gp.gridDatas=yB.createStrArr(gs.MODEL.rewardDef(gs.getIndex(t.rid))),t.gp.width=t.gp.contentW},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn.off("click",this,this.onClick)},i.onClick=function(e){hN.ins.close("COPY_SHARE"),eR.ins.curRid=this.rid,jP.sdk_cmd("cp_share")},t}(),dX=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0,this.mouseEnabled=!0}b(e,"modules.actor.views.wing.ActorSWingV",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/yuyi/btn_tab_zb.png","ui/layouts/yuyi/btn_tab_jm.png","ui/layouts/yuyi/btn_tab_zs.png"],e.vsc=new SB(e),e.vsc.registAll([{cls:gQ,id:1,showDragon:!0,isHideBg:!0},{cls:pQ,id:2,showDragon:!0,isHideBg:!0},{cls:vQ,id:3,showDragon:!1,isHideBg:!0}]),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onVscFilter,null,!1),e.vsc.invalid()},i.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},i.onVscFilter=function(e,t){if("1"==e){if(this.showMasterTip())return 3}else if("2"==e&&wR.ins.getCombime())return 3;return 0},i.showMasterTip=function(){for(var e=!1,t=0;t<gR.ins.actorList.length;t++)e||(e=this.getShowTip(t));return e},i.getShowTip=function(e){for(var t,i=0;i<la.SWING.length;i++)if(t=wR.ins.getBetter(e+1,la.SWING[i]))return!0;wR.ins.itemIsTop(22,0);var n=[],s=gR.ins.actorList[e];for(i=0;i<la.SWING.length;i++)if(t=MR.ins.getEquip(s.id,la.SWING[i])){var o=wR.ins.posH.take(la.SWING[i]).indexOf(t.goodsId);n.push(wR.ins.posH.take(la.SWING[i])[o+1])}else n.push(wR.ins.posH.take(la.SWING[i])[0]);var a=0;for(i=0;i<n.length;i++)for(var r=vo.count,l=0;l<r;l++)if(vo.MODEL.itemId(l)==n[i]){a=l;var c=vo.MODEL.exchangeID(a),u=xa.MODEL.consumption(xa.getIndex(c)),d=JSON.parse(u)[0].value.split(":"),h=parseInt(d[1]),_=parseInt(d[0]),f=h<=(10<h?TR.ins.getGoodsNum(_):TR.ins.getGoodsNum(_)+1),p=yo.MODEL.levelLimit(a)<=gR.ins.actorById(e+1).wingData.wingStep;if(f&&p)return!0}return!1},i.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("yuyi/yy_text_sy.png")),this.layout.dragon_border.visible=!1},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},e}(Ip),hX=function(e){function t(){this.t=null,this.d=null,this.g=0,this.e=null,this.f=null,this._tw=null,t.__super.call(this)}b(t,"modules.activityDaily.view.item.In_EggItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.hit.on("click",this,this.onClick)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.t&&(t.t.removeSelf(),t.t.destroy(),t.t=null),t.e&&(t.e.parent&&t.e.parent.removeChild(t.e),t.e.dispose(),t.e=null),t.clearEff(),t._tw&&t._tw.clear(),t._tw=null,t.hit.off("click",t,t.onClick)},i.show=function(e){var t=this;if(void 0===e&&(e=!1),t.d&&t.d.vo){t.hit.skin=_r.getAtlasSubPath("activityDaily/zjd_pd1.png"),t.e||(t.e=kB.createEffect("jm1707",(t.width>>1)-10,90,t.sp)),t.t||(t.t=new MF(74),t.sp.addChild(t.t));var i=yB.create(t.d.vo.gid,t.d.vo.num);t.t.bindData=i,e&&(t.t.y=60,t._tw=Og.to(t.t,{x:0,y:0},150,null)),t.hit.mouseEnabled=!1}},i.onClick=function(e){if(this.d&&!this.d.vo)if(0<this.d.free)YB.reqEggDraw(this.d.id);else{this.g=Oi.MODEL.goldAct(Oi.getIndex(this.d.t+1));var t=RP.n[524]+Ql.createColor(this.g+"元宝","#e6d80d")+RP.n[525];KQ.ins.showBox(t,RP.n[526],ql.create(this,this.onConfirm),!1,3,null,RP.n[527],RP.n[528])}},i.onConfirm=function(e){1==e&&(gR.ins.YB<this.g?KQ.ins.showNoGold():YB.reqEggDraw(this.d.id))},i.refresh=function(e,t){var i=this;i.d&&t&&(i.d.vo=t.vo,i.d.t=t.t,e==i.d.id&&(i.clearEff(),i.f||(i.f=kB.createEffect("jm1706",(i.width>>1)-1,83,i),G.timer.once(1e3,i,i.effEnd))))},i.effEnd=function(){this.show(!0)},i.clearEff=function(){G.timer.clearAll(this),this.f&&(this.f.parent&&this.f.parent.removeChild(this.f),this.f.dispose(),this.f=null)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&(this.d=e,this.show())}),t}(Sm),_X=function(e){function t(){var e=this;e._gridsList=null,e._lastTimes=-1,e._isClick=!1,t.__super.call(e),e._gridsList=new cq(5,!1),e._gridsList.pos(5,35),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=20,e._gridsList._gsimpleName=!0,e._gridsList._gridW=e._gridsList._gridH=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList._gnameFont=JP.gnameFont,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)}b(t,"modules.activityDaily.view.wechatShare.WechatShareItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._lastTimes=-1},i.onClick=function(e){if(e.target==this.btnGet&&this.tag){this.tag.leftTimes+this.tag.peopleNum>this.tag.maxTimes&&(this._isClick=!0);var t=new xP;t.ID=this.tag.id,Tu.sendToService(t)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.tag=e;var i=JSON.parse(e.condition)[0],n=e.rewards;switch(t._gridsList.setGoodsItems(n,8),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),i.type){case"inviteeLevel":n=RP.n[529]+i.value+"级";break;case"inviteeZhuanShengLevel":n=RP.n[530]+i.value+"转";break;case"inviteeVipLevel":n=RP.n[531]+i.value}if(t.txtDesc.text=n,0==e.peopleNum?t.htmlPro.innerHTML=Ql.createColor("(0","#ff2e24")+"/1)":t.htmlPro.innerHTML="("+Ql.createColor(e.peopleNum,"#23b11f")+"/1)",-1!=t._lastTimes&&t._lastTimes!=e.leftTimes&&t._isClick){t._isClick=!1;for(var s=JSON.parse(e.rewards),o=[],a=0;a<s.length;a++)o.push(s[a].value.split(":")[0]);zB.ins.playGetItems(o)}t._lastTimes=e.leftTimes,e.leftTimes<=0?(t.btnGet.visible=!1,t.imgGot.visible=!0,t.htmlTimes.innerHTML=RP.n[532]):(t.btnGet.visible=!0,t.imgGot.visible=!1,t.htmlTimes.innerHTML="剩余"+e.leftTimes+"/"+e.maxTimes+"次"),t.imgRed.visible=e.leftTimes+e.peopleNum>e.maxTimes}}),t}(xI),fX=function(e){function t(){var e=this;e.gridPanel=null,e.rewardId=0,e.state=0,t.__super.call(e),e.gridPanel||(e.gridPanel=new wj(1,4,93,20),e.gridPanel.pos(34,58),e.gridPanel.width=450,e.addChild(e.gridPanel)),e.gridPanel.vScrollBarSkin="",e.gridPanel.vScrollBar.elasticDistance=0}b(t,"modules.activityDaily.view.wechatShare.WechatShareSubView",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn.off("click",this,this.onClick)},i.onClick=function(e){if(1==this.state){var t=new LP;t.rewardId=this.rewardId,Tu.sendToService(t)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t.rewardId=e.rewardId,t.state=e.state,t.txt_tip.text=RP.n[533]+e.needShareCount+"个好友",t.gridPanel.gridDatas=yB.createStrArr(e.reward),0==t.state?t.txt_count.innerHTML="(<font style='color:#ff2e24;'>"+eR.ins.toc39013.curShareCount+"</font>/"+e.needShareCount+")":t.txt_count.innerHTML="(<font style='color:#01b527;'>"+eR.ins.toc39013.curShareCount+"</font>/"+e.needShareCount+")",0==t.state?(t.btn.visible=!0,t.btn.disabled=!0,t.btn.label="未达标",t.img_red.visible=!1,t.img_get.visible=!1):1==t.state?(t.btn.visible=!0,t.btn.disabled=!1,t.btn.label="领 取",t.img_red.visible=!0,t.img_get.visible=!1):(t.btn.visible=!1,t.img_red.visible=!1,t.img_get.visible=!0))}),t}(SI),pX=function(e){function i(e){var t=this;t._selectd=!1,t._idx=0,t._jobItem=null,t._ad=null,t._actors=null,t._active=!1,t._otherM=!1,t._isGray=!1,t._eff=null,i.__super.call(t),t._actors=e,t.init()}b(i,"modules.actor.views.active.ActorSelectItem",te);var t=i.prototype;return t.refresh=function(){var e=this;if(e._ad=e._actors[e._idx],e.img_career.visible=!1,!e._ad){var t=e._actors==gR.ins.actorList;return e._active=oR.checkOpen(e._idx)&&t,e._active?(e._eff&&e._eff.dispose(),e._eff=kB.createEffect("jm1162",68,70),e.addChildAt(e._eff,5),e.txLv.visible=!1,e.updateRedPt()):(e._eff&&e._eff.dispose(),e._eff=null,e.txLv.visible=!0,t?e.txLv.changeText(oR.getDesc(e._idx)+"\n解锁"):e.txLv.text=RP.n[534]),e.mcHead.skin=null,void(e.mcJ.visible=!1)}e._active&&(e._active=!1,e.updateRedPt()),e.txLv.visible=!1,e.mcJ.visible=!0,e.mcHead.skin=_r.getActorHeadPath(e._ad.job,e._ad.sex),e.showJob(e._selectd);var i="";switch(e._ad.job){case 1:i="ty_an_text_z";break;case 2:i="ty_an_text_f";break;case 3:i="ty_an_text_d"}e.img_career.skin=_r.getAtlasSubPath("basic_ui_b2/"+i+".png"),e.img_career.visible=!0},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t.updateRedPt=function(){this.mcRed.visible=this._otherM||this._active},t.showJob=function(e){void 0===e&&(e=!1);var t=e?"s":"";t=this._ad.job+t;var i=_r.getAtlasSubPath("actorselect")+"/j_"+t+".png",n=G.loader.getRes(i);n&&(this.mcJ.graphics.clear(),this.mcJ.graphics.drawTexture(n,0,0,n.sourceWidth,n.sourceHeight))},t.init=function(){this.selectd=!1,this.mcJ.visible=!1,this.txLv.visible=!1,this.mcRed.visible=!1},p(0,t,"actorData",function(){return this._ad||this._actors[this._idx]}),p(0,t,"isGray",function(){return this._isGray},function(e){this._isGray=e}),p(0,t,"selectd",function(){return this._selectd},function(e){this._selectd=e,this.mcS.visible=e,this._ad&&(this._jobItem&&(this._jobItem.selected=e),this.showJob(e)),this.img_career.index=e?1:0,this.img_bg.index=e?1:0}),p(0,t,"idx",null,function(e){this._idx=e,this.refresh()}),p(0,t,"showTips",function(){return this.mcRed.visible},function(e){this._otherM=e,this.updateRedPt()}),i}(),gX=function(e){function u(){var e=this;e._selector=null,e.hash=null,e.avatar=null,e.avatarW=null,e.eff=null,e.effChuanShi=null,e._suitData=null,e._effMabi=null,e._effHushen=null,e._effShenli=null,e._effFuhuo=null,e._flyupbtnEffect=null,e._effectBtnMo=null,e._flyupbtnTip=null,e._mobtnTip=null,e._mabiRingRetpt=null,e._fuhuoRingRetpt=null,e._shenliRingRetpt=null,e._hushenRingRetpt=null,e.niepanIcon=null,e.colorMatrix=[.2086,.7094,.082,0,0,.2086,.7094,.082,0,0,.2086,.7094,.082,0,0,0,0,0,1,0],e.GrayFilter=null,e.btnStates={},e.gridexIndex=[1,2,5,3,8,7,6,4],e.delayGuideId=0,u.__super.call(e),e._suitData=RN.ins,e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.box_p.addChild(e._selector);var t=G.loader.getRes(_r.getAtlasSubPath("base_ui2/ty_bjzs_zz2.png")),i=new pp,n=new pp;e.p14.visible=!0,e.p15.visible=!0,e.p17.visible=!1,e.p18.visible=!1;for(var s=0;t&&s<850;)850-s>=t.height?(i.graphics.drawTexture(t,0,s,t.width,s),n.graphics.drawTexture(t,0,s,t.width,s),s+=t.height):(i.graphics.drawTexture(t,0,s,t.width,850-s),n.graphics.drawTexture(t,0,s,t.width,850-s),s+=850-s);n.pos(0,e.img_right.height),i.pos(0,e.img_left.height),e.img_left.addChild(i),e.img_right.addChild(n),e.hash=new jl;for(var o=0;o<F.ACTOR_PARTS.length;o++){var a,r=F.ACTOR_PARTS[o],l=e["p"+r];-1!=la.MEDAL_TJ.indexOf(r)?((a=new RF).showDefault=!1,a.showTxt=!0):a=new MF,a.isClearUrl=!1,zB.gridGoods.push(a),a.pos(l.x,l.y),e.box_p.addChild(a);var c=kB.createText(l.x,l.y+116+2,116,0,la.getName(r),20,"#90877b",!1,"center",!1,!1,e);e.box_p.addChild(c),e.hash.put(r,{g:a,t:c,b:l}),la.isNormal(r)||l.on("click",e,e.onTip,[r])}e.avatar=new CF,e.avatar.pos(-340,344),e.box_p.addChild(e.avatar),e.avatarW=new CF,e.avatarW.pos(e.avatar.x,e.avatar.y),e.box_p.addChildAt(e.avatarW,10),e.box_p.addChild(e.btn_dress),e.btn_dress.visible=!1,e.removeChild(e.btnSamEquip),e.addChild(e.btnSamEquip),e.box_p.setChildIndex(e.fight_item,e.numChildren-1),e.GrayFilter=new ys(e.colorMatrix)}b(u,"modules.actor.views.ActorEquipV",q);var t=u.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.redPtUpdate=function(e,t){var i=this;if(i.btnStates[e]=t,"BTN_CHUANSHI"==e);else if("BTN_DIANJIN"==e);else if("BTN_FASHION"==e)i.btn_zb.showTip=t;else if("BTN_GODLY_EQUIP"==e)i.btn_god.showTip=t;else if("BTN_DRAGONSOUL"==e||"BTN_XINFA"==e||"BTN_YUPEI"==e)!i.btnStates.BTN_DRAGONSOUL&&!i.btnStates.BTN_XINFA&&i.btnStates.BTN_YUPEI;else if("BTN_DRAGON"==e)i.btn_lw.showTip=t;else if("BTN_FLYUP"==e){if(i._flyupbtnEffect&&(i._flyupbtnEffect.removeSelf(),i._flyupbtnEffect.dispose(),i._flyupbtnEffect=null),i._flyupbtnTip&&(i._flyupbtnTip.visible=!1),t){if(null==i._flyupbtnEffect&&(i._flyupbtnEffect=kB.createEffect("jm1415",i.btn_flyup.x+i.btn_flyup.width/2+20,i.btn_flyup.y+i.btn_flyup.height/2,i.box_d)),!i._flyupbtnTip){i._flyupbtnTip=new pp;var n=yc.getRes("ui/layouts/basic_ui/ty_ts_hd.png");if(!n)return;i._flyupbtnTip.texture=n}i._flyupbtnTip.visible=!0,i._flyupbtnTip.pos(i.btn_flyup.x+20,i.btn_flyup.y),i.box_d.addChild(i._flyupbtnTip)}}else if("BTN_SOULOUT"==e)i.btn_soulout.showTip=t||oB.ins.isFirstLogin&&Vf.instance.checkOut();else if("BTN_MO_EQUIP"==e){if(i._effectBtnMo&&(i._effectBtnMo.removeSelf(),i._effectBtnMo.dispose(),i._effectBtnMo=null),i._mobtnTip&&(i._mobtnTip.visible=!1),t){if(null==i._effectBtnMo&&(i._effectBtnMo=kB.createEffect("jm1416",i.btn_mo.x+i.btn_mo.width/2-20,i.btn_mo.y+i.btn_mo.height/2,i.box_d)),!i._mobtnTip){if(i._mobtnTip=new pp,!(n=yc.getRes("ui/layouts/basic_ui/ty_ts_hd.png")))return;i._mobtnTip.texture=n}i._mobtnTip.visible=!0,i._mobtnTip.pos(i.btn_mo.x+50,i.btn_mo.y+95),i.box_d.addChild(i._mobtnTip)}}else"BTN_SAMSARA_EQUIP"==e&&(i.btnSamEquip.showTip=t)},t.addChild=function(e){return laya.display.Node.prototype.addChild.call(this,e)},t.hideByVSC=function(e,t){var i=this;i.off("click",i,i.onClick),i.on("mousemove",i,i.onMouseMove),i._selector.off("select",i,i.onSelect),AN.ins.removeListener("BTN_THUNDER"),AN.ins.removeListener("BTN_CHUANSHI"),AN.ins.removeListener("BTN_BAYE"),AN.ins.removeListener("BTN_DIANJIN"),AN.ins.removeListener("BTN_FASHION"),AN.ins.removeListener("BTN_JZGOD"),AN.ins.removeListener("BTN_GODLY_EQUIP"),AN.ins.removeListener("BTN_DRAGON"),AN.ins.removeListener("BTN_SOULOUT"),AN.ins.removeListener("BTN_FLYUP"),AN.ins.removeListener("BTN_MABI_HUSHEN"),AN.ins.removeListener("BTN_MO_EQUIP"),AN.ins.removeListener("BTN_SAMSARA_EQUIP"),i._effMabi&&(i._effMabi.removeSelf(),i._effMabi.dispose(),i._effMabi=null),i._effHushen&&(i._effHushen.removeSelf(),i._effHushen.dispose(),i._effHushen=null),i._effFuhuo&&(i._effFuhuo.removeSelf(),i._effFuhuo.dispose(),i._effFuhuo=null),i._effShenli&&(i._effShenli.removeSelf(),i._effShenli.dispose(),i._effShenli=null),i._flyupbtnEffect&&(i._flyupbtnEffect.removeSelf(),i._flyupbtnEffect.dispose(),i._flyupbtnEffect=null),i._effectBtnMo&&(i._effectBtnMo.removeSelf(),i._effectBtnMo.dispose(),i._effectBtnMo=null),i.p14.off("click",i,i.onClickMabiHushen),i.p15.off("click",i,i.onClickMabiHushen),i.p13.off("click",i,i.onClickMabiHushen),i.p16.off("click",i,i.onClickMabiHushen)},t.showByVSC=function(e,t){var i=this;i.on("click",i,i.onClick),i.on("mousemove",i,i.onMouseMove),null==i._effMabi&&(i._effMabi=kB.createEffect("jm1154",i.p13.width/2,i.p13.height/2+10,i.p13)),null==i._effHushen&&(i._effHushen=kB.createEffect("jm1155",i.p16.width/2,i.p16.height/2+10,i.p16)),i._effFuhuo||(i._effFuhuo=kB.createEffect("jm1322",i.p15.width/2,i.p15.height/2+10,i.p15)),i._effShenli||(i._effShenli=kB.createEffect("jm1321",i.p14.width/2,i.p14.height/2+10,i.p14)),i._selector.selectIdx=gR.ins.currentSelectRoleIndex,i._selector.on("select",i,i.onSelect),i.updateByVSC(null);var n=ql.create(i,i.redPtUpdate,null,!1);AN.ins.addListener("BTN_THUNDER",[8,17,19],n),AN.ins.addListener("BTN_CHUANSHI",[9],n),AN.ins.addListener("BTN_BAYE",[11],n),AN.ins.addListener("BTN_DIANJIN",[10],n),AN.ins.addListener("BTN_FASHION",[12,13,15,14,276,280],n),AN.ins.addListener("BTN_JZGOD",[20],n),AN.ins.addListener("BTN_GODLY_EQUIP",[58,11,266],n),AN.ins.addListener("BTN_DRAGON",[53,229,230],n),AN.ins.addListener("BTN_FLYUP",[239,262],n),AN.ins.addListener("BTN_SOULOUT",[208,80,269],n),AN.ins.addListener("BTN_MABI_HUSHEN",[211],n),AN.ins.addListener("BTN_MO_EQUIP",[238,242,241,261,262],n),AN.ins.addListener("BTN_SAMSARA_EQUIP",[256,271],n),AN.reqRedPt(__.equipCareList),i.p13.on("click",i,i.onClickMabiHushen),i.p16.on("click",i,i.onClickMabiHushen),i.p14.on("click",i,i.onClickMabiHushen),i.p15.on("click",i,i.onClickMabiHushen);var s=new zf;Tu.sendToService(s),i.btnSamEquip.visible=GR.getInstance().checkModuleOpen(56)},t.updateByVSC=function(e){if(e&&"EQUIP_DRESS"==e.actionOrder){var t,i=e.proto;for(var n in i){t=i[n];var s=this.hash.take(t.position);s&&kB.createEffect("jm01011",s.b.x+60,s.b.y+53,this.box_p)}}if(e&&"RING_DRESS"==e.actionOrder){var o=e.proto,a=la.getEquipPart(o);(s=this.hash.take(a))&&kB.createEffect("jm01011",s.b.x+60,s.b.y+53,this.box_p)}e&&e.actionOrder,G.timer.once(1,this,this.update,[e])},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.eff&&this.eff.dispose(),this.eff=null,this.delayGuideId=0,G.timer.clear(this,this.showGuide)},t.update=function(e){var t=this;t._selector.invalid(),t.updateAttr(),t.updateNiepan(),t.updateEquips(),t.updateAvatar(),t.updateNotice(),t.updateRings(),AN.ins.updatePt(7,MR.ins.isDressable(la.NORMAL));AN.ins.updatePt(2,!1),null!=t._suitData.equipHash&&1<=t._suitData.equipHash.length&&t.showChuanShiEffect()},t.updateRings=function(){var e=this;e._effMabi&&(e._effMabi.filters=null),e._effHushen&&(e._effHushen.filters=null),e._effFuhuo&&(e._effFuhuo.filters=null),e._effShenli&&(e._effShenli.filters=null);var t=gR.ins.actorRingData;if(null==t)return e._effMabi&&(e._effMabi.filters=[e.GrayFilter]),e._effHushen&&(e._effHushen.filters=[e.GrayFilter]),e._effFuhuo&&(e._effFuhuo.filters=[e.GrayFilter]),void(e._effShenli&&(e._effShenli.filters=[e.GrayFilter]));var i=e._selector.selectIdx+1,n=gR.ins.getJobByIdx(i),s=t[n][1];null!=s&&0!=s.level||e._effMabi&&(e._effMabi.filters=[e.GrayFilter]),null!=(s=t[n][2])&&0!=s.level||e._effHushen&&(e._effHushen.filters=[e.GrayFilter]),null!=(s=t[n][3])&&0!=s.level||e._effShenli&&(e._effShenli.filters=[e.GrayFilter]),null!=(s=t[n][4])&&0!=s.level||e._effFuhuo&&(e._effFuhuo.filters=[e.GrayFilter])},t.showChuanShiEffect=function(){var e=this;e.effChuanShi&&(e.effChuanShi.parent&&e.effChuanShi.parent.removeChild(e.effChuanShi),e.effChuanShi=null);var t=e._suitData.getSuitIdByRoleIndex(e._selector.selectIdx+1);if(0<t){var i=RN.ins.getCurSuitPro(3,t);null==e.effChuanShi&&(e.effChuanShi=kB.createEffect(i.cEffct,360,860,e)),e.effChuanShi.scale_X=2,e.effChuanShi.scale_Y=2,e.setChildIndex(e.effChuanShi,1)}},t.updateAttr=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e);this.fight_item.value=t.force},t.updateNiepan=function(){var e=this,t=e._selector.selectIdx+1,i=gR.ins.actorById(t);if(0<i.niepanlevel){var n=to.MODEL.title1(to.getIndex(i.niepanlevel)).split(",");e.niepanIcon||(e.niepanIcon=new Kl),e.niepanIcon.pos(275,300),e.niepanIcon.skin=_r.getFullUrl("ui/layouts/niepan/"+n[i.job-1]+".png",!1),e.box_p.addChild(e.niepanIcon)}else e.niepanIcon&&(e.box_p.removeChild(e.niepanIcon),e.niepanIcon=null)},t.updateEquips=function(){for(var e=this._selector.selectIdx+1,t=0;t<F.ACTOR_PARTS.length;t++){var i=F.ACTOR_PARTS[t],n=this.hash.take(i),s=n.g,o=n.t;o.color="#5f5850";var a=n.b,r=this["p_in_"+this.gridexIndex[t]];if(-1!=la.MEDAL_TJ.indexOf(i)){o.color="#90877b";gR.ins.actorList[this._selector.selectIdx];var l=la.getEquipType(i);s.bindData={selectIdx:this._selector.selectIdx,equipType:l}}else{var c=F.getLinkToRexue(i),u=MR.ins.getEquip(e,c);if(u||(u=MR.ins.getEquip(e,i)),null!=RN.ins.equipHash&&t<8){var d=RN.ins.equipHash.take(this._selector.selectIdx+1);if(d&&0<d.length){var h=d[t];u?s.setGodEqupSkin(h):s.setGodEqupSkin(0)}}u?(s.visible=!0,s.bindData=u,a.mouseEnabled=!1,r&&(r.visible=!1)):(s.visible=!1,a.mouseEnabled=!0,r&&(r.visible=!0)),this.setPartName(o,u,i)}}},t.setPartName=function(e,t,i){t?e.changeText(F.getLevel(t.goodsId)):e.changeText(la.getName(i))},t.updateAvatar=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e);this.avatar.changeAvatar(t.sex,t.wid,t.mid,null,t.weaponSoulId),this.avatarW.changeAvatar(-1,null,null,t.wgid,null)},t.updateNotice=function(){for(var e,t,i=this,n=i._selector.selectIdx+1,s=gR.ins.actorById(n),o=0,a=!1,r=[],l=0;l<F.ACTOR_PARTS.length;l++)o=F.ACTOR_PARTS[l],e=i.hash.take(o),i.needNotify(s,o,r)?(e.p?e.p.visible=!0:(t=kB.createSprite(NI.POINT,e.b.x+85,e.b.y-13,0,0,i.box_p),e.p=t),la.isNormal(o)&&(a=!0)):e.p&&(e.p.visible=!1);a?(i.eff||(i.eff=kB.createEffect("jm1130",i.btn_dress.width>>1,i.btn_dress.height>>1,i.btn_dress),i.eff.scale_X=1.25,i.eff.scale_Y=1.25),i.btn_dress.visible=!0,i.doShowGuide(10)):(i.eff&&i.eff.dispose(),i.eff=null,i.btn_dress.visible=!1,i.showGuide(10,!1)),i._selector&&i.isAbleMabiRing()?i._mabiRingRetpt?i.box_p.addChild(i._mabiRingRetpt):i._mabiRingRetpt=kB.createSprite(NI.POINT,i.p13.x+74,i.p13.y+2,0,0,i.box_p):i._mabiRingRetpt&&i._mabiRingRetpt.removeSelf(),i._selector&&i.isAbleFuhuoRing()?i._fuhuoRingRetpt?i.box_p.addChild(i._fuhuoRingRetpt):i._fuhuoRingRetpt=kB.createSprite(NI.POINT,i.p15.x+74,i.p15.y+2,0,0,i.box_p):i._fuhuoRingRetpt&&i._fuhuoRingRetpt.removeSelf(),i._selector&&i.isAbleShenliRing()?i._shenliRingRetpt?i.box_p.addChild(i._shenliRingRetpt):i._shenliRingRetpt=kB.createSprite(NI.POINT,i.p14.x+74,i.p14.y+2,0,0,i.box_p):i._shenliRingRetpt&&i._shenliRingRetpt.removeSelf(),i._selector&&i.isAbleHushenRing()?i._hushenRingRetpt?i.box_p.addChild(i._hushenRingRetpt):i._hushenRingRetpt=kB.createSprite(NI.POINT,i.p16.x+74,i.p16.y+2,0,0,i.box_p):i._hushenRingRetpt&&i._hushenRingRetpt.removeSelf()},t.isAbleMabiRing=function(){return 1==this.checkMabiRingRed()[this._selector.selectIdx]},t.checkMabiRingRed=function(){for(var e=[0,0,0],t=0;t<3;t++){var i,n=gR.ins.getJobByIdx(t+1);if(0!=n)null!=gR.ins.actorRingData&&(i=gR.ins.actorRingData[n][1]),null==i&&(i=new wB(1,0,n)),e[t]=i.isAbleGrow&&-1!=i.nextConfigIndex?1:0}return e},t.checkHushenRingRed=function(){for(var e=[0,0,0],t=0;t<3;t++){var i,n=gR.ins.getJobByIdx(t+1);if(0!=n)null!=gR.ins.actorRingData&&(i=gR.ins.actorRingData[n][2]),null==i&&(i=new wB(2,0,n)),e[t]=i.isAbleGrow&&-1!=i.nextConfigIndex?1:0}return e},t.checkFuhuoRingRed=function(){for(var e=[0,0,0],t=0;t<3;t++){var i,n=gR.ins.getJobByIdx(t+1);if(0!=n)null!=gR.ins.actorRingData&&(i=gR.ins.actorRingData[n][4]),null==i&&(i=new wB(4,0,n)),e[t]=i.isAbleGrow&&-1!=i.nextConfigIndex?1:0}return e},t.isAbleFuhuoRing=function(){return 1==this.checkFuhuoRingRed()[this._selector.selectIdx]},t.isAbleShenliRing=function(){return 1==this.checkShenliRingRed()[this._selector.selectIdx]},t.checkShenliRingRed=function(){for(var e=[0,0,0],t=0;t<3;t++){var i,n=gR.ins.getJobByIdx(t+1);if(0!=n)null!=gR.ins.actorRingData&&(i=gR.ins.actorRingData[n][3]),null==i&&(i=new wB(3,0,n)),e[t]=i.isAbleGrow&&-1!=i.nextConfigIndex?1:0}return e},t.isAbleHushenRing=function(){return 1==this.checkHushenRingRed()[this._selector.selectIdx]},t.doShowGuide=function(e){if(pn.hasIndex(e)&&e!=this.delayGuideId){var t=pn.getIndex(e);pn.MODEL.delaytime(t);G.timer.once(600,this,this.showGuide,[e,!0])}},t.showGuide=function(e,t){if(t){if(this.delayGuideId=0,PH.Ins().hasNewGuide(e)&&this.parent)switch(e){case 10:var i=new u_;i.x=this.btn_dress.x,i.y=this.btn_dress.y-5,i.width=this.btn_dress.width,i.height=this.btn_dress.height,LY.Ins().show(e,i,!1,this.box_p),LY.Ins().lockSceneShowByDisPlay(this.btn_dress)}}else LY.showing&&LY.Ins().closeLockArrow(10)},t.onClick=function(e){var t=this;if(e.target==t.btn_dress){var i=t._selector.selectIdx+1;OR.reqWearAll(i),UB.ins.playSound("13"),LY.showing&&10==LY.Ins().currGuideId&&Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])}else if(e.target==t.btn_info)hN.ins.open("ATTR_V",t._selector.selectIdx);else if(e.target==t.btn_lw){var n=$e.MODEL.value($e.getIndex(78));gR.ins.lv>=parseInt(n)?hN.ins.open("LONGWEN_MV_PANEL",t._selector.selectIdx,0):zB.ins.playErrorMsg(parseInt(n)+RP.n[535])}else if(e.target==t.btn_zb)Tu.sendToModule("FASHION_OPEN",["modules.fashion.FashionModule"],1);else if(e.target==t.btn_god){var s=$e.MODEL.value($e.getIndex(130)),o=parseInt(s);if(o>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[536]+o+"级开启");hN.ins.open("GOD_PANEL",null,0)}else if(e.target==t.btn_soulout)parseInt($e.MODEL.value($e.getIndex(158)))>aB.instance.activedRingId?zB.ins.showById(3971,1):Vf.instance.checkOut()?hN.ins.open("SOULOUT_V",null,0):Tu.sendToModule("OPEN_SOUL_PRIVIEW_MAIN_PANEL",["modules.soul.SoulModule"]);else if(e.target==t.btn_flyup){var a=$e.MODEL.value($e.getIndex(207)),r=JSON.parse(a);if(r.flyUpLevel&&gR.ins.actorFlyUpLevel<r.flyUpLevel)return void zB.ins.playErrorMsg(RP.n[537]+mp.getChineseNum(r.flyUpLevel)+"重飞升");if(!GR.getInstance().checkModuleOpen(105))return void zB.ins.playErrorMsg(RP.n[538]);hN.ins.open("SOARING_VIEW",t._selector.selectIdx,0)}else if(e.target==t.btn_mo)if(_R.isOpen())hN.ins.open("MO_MAIN_VIEW",t._selector.selectIdx,0);else{var l=GR.getInstance().getErrorTips(42);zB.ins.playErrorMsg(l)}else e.target==t.btnSamEquip&&hN.ins.open("SamsaraEquipMainView",null,"ACTOR_M")},t.onClickMabiHushen=function(e){var t=this._selector.selectIdx+1,i=gR.ins.actorById(t).job,n=null;switch(e.target){case this.p13:var s=gR.ins.actorRingData;null!=s&&(n=gR.ins.actorRingData[i][1]),null==n&&(n=new wB(1,0,i));break;case this.p16:null!=(s=gR.ins.actorRingData)&&(n=gR.ins.actorRingData[i][2]),null==n&&(n=new wB(2,0,i));break;case this.p14:null!=(s=gR.ins.actorRingData)&&(n=gR.ins.actorRingData[i][3]),null==n&&(n=new wB(3,0,i));break;case this.p15:null!=(s=gR.ins.actorRingData)&&(n=gR.ins.actorRingData[i][4]),null==n&&(n=new wB(4,0,i))}0<n.level?hN.ins.open("RINGUPMAINVIEW",n,"ACTOR_M"):HQ.instance.show(n,t),n=null},t.onMouseMove=function(e){},t.onSelect=function(e){this.updateByVSC(null)},t.onTip=function(e){},t.needNotify=function(e,t,i){return!!la.isNormal(t)&&MR.ins.hasBetterEquip(e,t,i)},t.needRedpt=function(e){if(MR.ins.isRoleDressable(e,la.NORMAL))return!0;if(MR.ins.isRoleDressable(e,la.JZ_GOD))return!0;var t,i=gR.ins.actorRingData;return null!=i&&(t=gR.ins.actorRingData[e.job][1]),null==t&&(t=new wB(1,0,e.job)),!!t.isAbleGrow||(null!=i&&(t=gR.ins.actorRingData[e.job][2]),null==t&&(t=new wB(2,0,e.job)),!!t.isAbleGrow||(null!=i&&(t=gR.ins.actorRingData[e.job][3]),null==t&&(t=new wB(3,0,e.job)),!!t.isAbleGrow||(null!=i&&(t=gR.ins.actorRingData[e.job][4]),null==t&&(t=new wB(4,0,e.job)),!!t.isAbleGrow)))},t.destroy=function(e){var t=this;if(void 0===e&&(e=!0),!hN.ins.isOpen("AO_EQUIP")){if(t.bg&&t.bg.skin){var i=yc.getRes(t.bg.skin);i&&i.destroy(),G.loader.clearRes(t.bg.skin)}t.equipIconBg&&t.equipIconBg.skin&&G.loader.clearRes(t.equipIconBg.skin),t.bottomBg&&t.bottomBg.skin&&G.loader.clearRes(t.bottomBg.skin)}if(!zB.isFlying)for(;zB.gridGoods.length;){var n=zB.gridGoods.shift();n instanceof modules.backpack.views.grid.GoodsGrid?n.clearIconTexture():NP.destoryImage(n)}t.p_in_1.dispose(),t.p_in_2.dispose(),t.p_in_3.dispose(),t.p_in_4.dispose(),t.p_in_5.dispose(),t.p_in_6.dispose(),t.p_in_7.dispose(),t.p_in_8.dispose(),laya.ui.View.prototype.destroy.call(t,e)},u}(),vX=function(e){function t(){var e=this;e._selector=null,e._role=-1,e._canUp=0,e._cost=null,e._goodsGird=null,e._canUp2=0,e.eff_cur=null,e.eff_stars=null,e._effect=null,e._time=0,t.__super.call(e),e.initUI()}b(t,"modules.actor.views.ActorVeinV",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.jingmaibg.skin=_r.getFullUrl("ui/images/jingmai/jm_bg.jpg"),this.jingmaibg2.skin=_r.getFullUrl("ui/images/jingmai/jm_rw.png")},i.initUI=function(){var e=this;e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e.html_cost.innerHTML="",e.html_cost.style.align="center",e.txt_cur.leading=19,e.txt_curW.leading=19,e.txt_next.leading=19,e.txt_nextW.leading=19,e._selector.on("select",e,e.onSelectRole),e.btn_update.on("click",e,e.onLevelUp),e.txt_get.on("click",e,e.onClick),e.eff_cur=mj.GetNew(),e.eff_cur.renderInSelf=!0,e.eff_cur.loadEffect("jm0008"),e.eff_cur.visible=!1,e.addChild(e.eff_cur),e.eff_stars=[],e._goodsGird=new MF(45),e._goodsGird.isShowSmallIcon=!0,e._goodsGird.needGridBg=!1;var t=yB.create(5);e._goodsGird.bindData=t,e.spr_cost.addChild(e._goodsGird)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.eff_cur&&t.eff_cur.dispose(),t.eff_cur=null;for(var i=0;i<t.eff_stars.length;i++){var n=t.eff_stars[i];n&&n.dispose()}t.eff_stars=null,t.jingmaibg&&t.jingmaibg.skin&&G.loader.clearRes(t.jingmaibg.skin),t.jingmaibg2&&t.jingmaibg2.skin&&G.loader.clearRes(t.jingmaibg2.skin),laya.ui.View.prototype.destroy.call(t,e)},i.onSelectRole=function(){this._selector.selectIdx!=this._role&&(this._role=this._selector.selectIdx,IH.ins.currentSelectedRole=this._selector.selectIdx,this.update())},i.onLevelUp=function(){this._canUp?(this._canUp2=this._canUp,nR.reqRoleSystemUpgrade(this._role+1,fa.JM.type),UB.ins.playSound("4",3,!0)):Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:5})},i.onClick=function(){Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:5})},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._selector.selectIdx=IH.ins.currentSelectedRole,gR.ins.updateVein(),this._role=this._selector.selectIdx,this._canUp=0,this._canUp2=0,this._cost=null,this.update()},i.updateByVSC=function(e){var t=this;e instanceof protos.actor.toc_21106&&e.type==fa.JM.type&&(0<t._canUp2&&(t._effect&&(t._effect.dispose(),t._effect=null),t._effect=mj.GetNew(),t._effect.playEndHandler=ql.create(t,t.onEffectEnd),t._effect.pos(t.width/2,t.height/2+40),t._effect.renderInSelf=!0,1==t._canUp2?t._effect.loadEffect("jm0011"):t._effect.loadEffect("jm0010"),t.addChild(t._effect),t._canUp2=0),t.update(),t.updateTip())},i.onEffectEnd=function(){this._effect&&(this._effect.dispose(),this._effect=null)},i.updateGoods=function(){if(this._cost){var e=this._cost.split(","),t=parseInt(e[0]),i=parseInt(e[1]),n=TR.ins.getGoodsNum(t);i<=n?(this._canUp=1,this.html_cost.innerHTML=Ql.createColor(n.toString(),"#23b11f")+"/"+i):(this._canUp=0,this.html_cost.innerHTML=Ql.createColor(n.toString(),"#ff2e24")+"/"+i)}this.imgTipCanUp.visible=0<this._canUp,this.updateTip()},i.updateTip=function(){for(var e=-1,t=0;t<gR.ins.jmUps.length;t++){var i=gR.ins.jmUps[t];this._selector.setRedPtByIdx(t,i),i&&-1==e&&(e=t)}return e},i.update=function(){var e=this;e._canUp=0,e._cost=null;var t=0,i=gR.ins.actorList[e._role].jmCfgId,n=-1;0<i&&(n=Dn.getIndex(i));var s=0;-1!=n&&(s=Dn.MODEL.level(n));var o=-1,a=Dn.count;for(t=0;t<a;t++)if(Dn.MODEL.type(t)==fa.JM.type&&Dn.MODEL.level(t)==s+1){o=t;break}e.btn_update.label="提 升",e.btn_update.disabled=!1;var r=Math.floor(s/11),l=s%11;for(t=0;t<l;t++){e["clip_star"+t].index=0,t+1<10&&(e["clip_line"+(t+1)].index=0);var c=e.eff_stars[t];null==c&&((c=mj.GetNew()).renderInSelf=!0,c.loadEffect("jm0009"),c.pos(e["clip_star"+t].x+22,e["clip_star"+t].y+23),e.addChild(c),e.eff_stars[t]=c),c.visible=!0}for(;t<10;t++)t+(e["clip_star"+t].index=1)<10&&(e["clip_line"+(t+1)].index=1),(c=e.eff_stars[t])&&(c.visible=!1);if(10==l?(e.eff_cur.visible=!1,e.img_cur.visible=!1,e.btn_update.label="冲 脉"):(e.eff_cur.visible=!0,e.eff_cur.pos(e["clip_star"+l].x+22,e["clip_star"+l].y+23),e.img_cur.visible=!0,e.img_cur.pos(e["clip_star"+l].x-23,e["clip_star"+l].y-31)),e.clip_lvl.value=mp.getChineseNum(r+1)+"阶",1==mp.getChineseNum(r+1).length?(e.clip_lvl.spaceY=10,e.img_lvlbg.height=106):(e.clip_lvl.spaceY=0,e.img_lvlbg.height=30*e.clip_lvl.value.length+38),-1==o)e.txt_cost.visible=!1,e.spr_cost.visible=!1,e.img_costBg.visible=!1,e.html_cost.innerHTML="",e.btn_update.disabled=!0,e.spr_update.visible=!1,e.spr_next.visible=!1,e.spr_cur.x=(e.width-e.spr_cur.width)/2,e.img_max.visible=!0;else{e.spr_update.visible=!0,e.spr_next.visible=!0,e.spr_cur.x=40,e.img_max.visible=!1;var u=Dn.MODEL.cost(o);if(u&&0<u.length){e.txt_cost.visible=!0,e.spr_cost.visible=!0,e.img_costBg.visible=!0;var d=u.split(","),h=parseInt(d[0]),_=parseInt(d[1]);if(0==_)e._canUp=2,e.txt_cost.visible=!1,e.spr_cost.visible=!1,e.img_costBg.visible=!1,e.html_cost.innerHTML="";else{e._cost=Dn.MODEL.cost(o);var f=TR.ins.getGoodsNum(h);_<=f?(e._canUp=1,e.html_cost.innerHTML=Ql.createColor(f.toString(),"#23b11f")+"/"+_):e.html_cost.innerHTML=Ql.createColor(f.toString(),"#ff2e24")+"/"+_}}else e._canUp=2,e.txt_cost.visible=!1,e.spr_cost.visible=!1,e.img_costBg.visible=!1,e.html_cost.innerHTML=""}if(-1==n)-1!=o?(e.txt_cur.text=aa.formatAttrOnlyKey(Dn.MODEL.attrs(o),"：\n",!1,!0)+"：\n",e.txt_curW.text="0\n0\n0\n0\n"):(e.txt_cur.text="",e.txt_curW.text=""),e.fight_item.value=0;else{var p=Dn.MODEL.attrs(n);e.txt_cur.text=aa.formatAttrOnlyKey(p,"：\n",!1,!0)+"：\n",e.txt_curW.text=aa.formatAttrOnlyValue(p),e.fight_item.value=RR.getFight(p,e._role)}if(-1==o)e.txt_next.text="",e.txt_nextW.text="";else{var g=Dn.MODEL.attrs(o);e.txt_next.text=aa.formatAttrOnlyKey(g,"：\n",!1,!0)+"：\n",e.txt_nextW.text=aa.formatAttrOnlyValue(g)}e.imgTipCanUp.visible=0<e._canUp,e.updateTip()},t}(ne),mX=function(e){function t(){var e=this;e._handEff=null,e._orgX=0,e._orgY=0,e.tween1=null,e.tween2=null,e.tween3=null,e.titleTween=null,e.ballTween=null,e.isOver=!1,t.__super.call(e),e.img_bg.skin=_r.getActImg()}b(t,"modules.actor.views.cimelia.DragonSoulActivedView",Jo);var i=t.prototype;return i.initialize=function(){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.initShow()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.tween1&&t.tween1.clear(),t.tween2&&t.tween2.clear(),t.tween3&&t.tween3.clear(),t.titleTween&&t.titleTween.clear(),t.ballTween&&t.ballTween.clear(),t._handEff&&(t._handEff.parent&&t._handEff.parent.removeChild(t._handEff),t._handEff.dispose(),t._handEff=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.initShow=function(){this.img_icon.scale(0,0),this.txt_name_bg.scale(0,0),this._orgY=535,this.img_bg.centerX=0,this.onEffectComplete()},i.onEffectComplete=function(){this.box_active.alpha=0,null!=this.titleTween?this.titleTween.clear():this.titleTween=new Og,this.titleTween=Og.to(this.box_active,{alpha:1},500,pa.linearIn,ql.create(this,this.onComposeShow)),this.img_icon.scale(0,0)},i.showHandler=function(){this.img_icon.y=this._orgY,this.img_icon&&(this.titleTween=Og.to(this.img_icon,{y:this._orgY-5},500,null,ql.create(this,this.shareHandler)))},i.shareHandler=function(){var e=this;e.img_icon.y==e._orgY-5?e.titleTween=Og.to(e.img_icon,{y:e._orgY+10},1e3,null,ql.create(e,e.shareHandler)):e.img_icon.y==e._orgY+10?e.titleTween=Og.to(e.img_icon,{y:e._orgY},500,null,ql.create(e,e.shareHandler)):e.img_icon.y==e._orgY&&(e.titleTween=Og.to(e.img_icon,{y:e._orgY-5},500,null,ql.create(e,e.shareHandler)))},i.onComposeShow=function(){var e=this;e.graphics.clear(),e.graphics.drawRect(0,0,e.width,e.height,"#000000"),UB.ins.playSound("23",3,!0),e._handEff||(e._handEff=kB.createEffect("jm1034",360,388,e),e.setChildIndex(e._handEff,e.getChildIndex(e._handEff)-1),e._handEff.alpha=0),null!=e.tween2?e.tween2.clear():e.tween2=new Og,e.tween2=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onComposeShowRingName))},i.onComposeShowRingName=function(){var e=this;null!=e.tween3?e.tween3.clear():e.tween3=new Og,e.tween3=Og.to(e.txt_name_bg,{x:77,scaleX:1,scaleY:1},200,pa.linearIn),e.isOver=!0,null!=e.ballTween?e.ballTween.clear():e.ballTween=new Og,e.ballTween=Og.to(e.img_icon,{scaleX:1,scaleY:1},200,pa.linearIn,ql.create(e,e.showHandler))},t.HANDEFFID="jm1034",t}(),yX=function(e){function t(){var e=this;e._selector=null,e.g_cost=null,e.org_grid=null,e.target_grid=null,e.hash=null,e.eff=null,e.effectUp=null,e._isReXue=!1,e._type=0,e._godlyData=null,e.option=0,e.op_id=0,e.cost_id=0,e.cost_num=0,e.maxLvBool=!1,e.enoughBool=!1,e._selectedPart=-1,e._optionTime=0,e.resolveEffect=null,t.__super.call(e),e.centerY=e.centerX=0,e.init()}b(t,"modules.actor.views.godlyequip.GodlyEquipMain",e);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.createChildren=function(){e.prototype.createChildren.call(this),this.godlybg.skin=_r.getFullUrl("ui/images/godequip/sz_jm_db.jpg")},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){},i.init=function(){var e=this;e.box_pre.visible=!1,e._selector=new Nj,e.addChild(e._selector),e.g_cost=new MF(45),e.g_cost.isShowSmallIcon=!0,e.g_cost.needGridBg=!1,e.g_cost.pos(280,-22),e.sp.addChild(e.g_cost),e.org_grid=new MF,e.org_grid.pos(65,86),e.org_grid.drawStrengthLv=!1,e.org_grid.drawZhulingLv=!1,e.org_grid.isClearUrl=!1,e.box_pre.addChild(e.org_grid),e.target_grid=new MF,e.target_grid.pos(65,86),e.target_grid.isClearUrl=!1,e.target_grid.drawStrengthLv=!1,e.target_grid.drawZhulingLv=!1,e.box_next.addChild(e.target_grid),e.hash=new jl;for(var t=F.GODLYPARTS,i=0;i<t.length;i++){var n=t[i],s=e["p"+n];s.on("click",e,e.gridClickHandler,[n]),s.name=n+"";var o=new MF;o.isClearUrl=!1,o.pos(s.x,s.y),e.addChild(o),o.mouseEnabled=!0,o.toolTipEnabled=!1,o.drawStrengthLv=!1,o.drawZhulingLv=!1,o.on("click",e,e.gridClickHandler,[n]);var a=kB.createText(s.x,s.y+116+2,116,0,la.getName(n),20,"#6c6250",!1,"center",!1,!1,e);e.addChild(a),e.hash.put(n,{g:o,t:a,b:s})}e.lab_nextAttr.style.leading=21,e.lab_crtAttr.style.leading=21,e.lab_nextAttr.y=354,e.lab_crtAttr.y=354,e._godlyData=rR.instance,e._godlyData.updateRedData()},i.gridClickHandler=function(e){var t=this._selector.selectIdx+1,i=e,n=MR.ins.getEquip(t,i);this.showSelectedEffect(i),this.updateOption(n,t,i)},i.updateOption=function(e,t,i){var n=this,s=0,o=n.maxLvBool=!1,a=-1,r=n.option=0;if(n.btn_goReXue.visible=!1,n.sp.visible=!0,n._isReXue=!1,n._godlyData.showGodlyEquipPanel(e)&&(a=Ti.getIndex(e.goodsId),0<(r=Ti.MODEL.targetModelId(a))&&(o=!0),7==e.subType))switch(n.sp.visible=!1,n.btn_goReXue.visible=!0,n._isReXue=!0,e.position){case 1:n._type=0;break;case 2:n._type=1}if(n.box_next.right=NaN,o){n.box_pre.visible=!0,n.img_attrbg.width=454,n.box_next.x=356,n.lab_nextAttr.width=178,n.attrsnBox.x=50,n.lab_nextAttr.x=35,n.org_grid.bindData=e;var l=ms.getByQuality(e.colourId);n.txt_preName.innerHTML=Ql.createColor(e.name,l);var c="";c=0<e.flyLevel?e.flyLevel+"转":e.useLevel+"级",n.txt_preLevel.text=c,a=Ti.getIndex(e.goodsId),r=Ti.MODEL.targetModelId(a);var u=KH.create(r);n.target_grid.bindData=u,l=ms.getByQuality(u.colourId),n.txt_nextName.innerHTML=Ql.createColor(u.name,l),c="",c=0<u.flyLevel?u.flyLevel+"转":u.useLevel+"级",n.txt_nextLevel.text=c;var d=yB.createStr(Ti.MODEL.materialConsumption(a));n.cost_id=d.goodsId,n.cost_num=d.goodsNum,d.goodsNum=1,n.g_cost.bindData=d;var h="";h+=Ql.createSizeColor(RP.n[539],28,"#e3dcc2")+"<br>",h+=Ql.createSizeColor(RP.n[540]+e.sorce,24,"#f9d30b")+"<br>",n.attrTxt(n.attrsbox.graphics,200,0,e.goodsId,"#90877b",!1,e.minRandom),n.lab_crtAttr.innerHTML=h,h="",h+=Ql.createSizeColor(RP.n[541],28,"#e3dcc2")+"<br>",h+=Ql.createSizeColor("评分："+u.sorce,24,"#f9d30b")+"<br>",n.attrTxt(n.attrsnBox.graphics,180,0,r,"#23b11f",!0,u.minRandom),n.lab_nextAttr.innerHTML=h,n.op_id=e.goodsId,n.option=1,n.btn_option.mouseEnabled=!0,n.btn_option.gray=!1,n.btn_option.label="升 级"}else{var _;n._godlyData.showGodlyEquipPanel(e)&&(n.maxLvBool=!0),n.box_pre.visible=!1,n.img_attrbg.width=292,n.box_next.x=240,n.lab_nextAttr.width=180,n.attrsnBox.x=30,n.lab_nextAttr.x=30,n.org_grid.bindData=null;var f=0;if(n.maxLvBool)_=e,n.btn_option.label="已满级",n.btn_option.gray=!0,n.btn_option.mouseEnabled=!1,7==e.subType&&(f=e.goodsId,n.attrTxt(n.attrsnBox.graphics,200,0,f,"#90877b",!1,0));else{n.btn_option.mouseEnabled=!0,e&&(s=e.sorce);var p=n._godlyData.getRoleIdByIndex(t-1);f=n._isReXue?e.goodsId:n._godlyData.findExchangeId(p,i,s),n.op_id=f;var g=xa.getIndex(f);_=KH.createStr(xa.MODEL.reward(g)),n.btn_option.label="合 成",n.btn_option.gray=!1;var v=yB.createStr(xa.MODEL.consumption(g));n.cost_id=v.goodsId,n.cost_num=v.goodsNum,v.goodsNum=1,n.g_cost.bindData=v}n.target_grid.bindData=_;var m=Ql.createSizeColor(RP.n[542],28,"#e3dcc2")+"<br>";0==f?(f=e.goodsId,n.attrTxt(n.attrsnBox.graphics,200,-24,f,"#90877b",!1,0)):n.attrTxt(n.attrsnBox.graphics,200,-24,f,"#90877b",!1,_.minRandom),n.lab_nextAttr.innerHTML=m,l=ms.getByQuality(_.colourId),n.txt_nextName.innerHTML=Ql.createColor(_.name,l),_.flyLevel?n.txt_nextLevel.text=_.flyLevel+"转":0==_.useLevel?n.txt_nextLevel.text="无限制":n.txt_nextLevel.text=_.useLevel+"级"}return n.updateCostUI(),o||n.enoughBool},i.attrTxt=function(e,t,i,n,s,o,a){void 0===s&&(s="#e3dcc2"),void 0===o&&(o=!1),void 0===a&&(a=0);var r=PR.getGoodsNewAttr(n),l=[];r&&(l=aa.formatAttrToChineseByList(r));var c=yc.getRes(_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzd.png")),u=i;e.clear();for(var d="",h="",_=0;_<l.length;_++){var f=l[_];h=d="",o?0<a?(d=f.val,h="+"+aa.getFormatValue(f.id,f.val*a>>0)):d=f.val:0<a?(d=f.sname+":"+f.val,h="+"+aa.getFormatValue(f.id,f.val*a>>0)):d=f.sname+":"+f.val;var p;p=o?80:135,e.drawTexture(c,0,u,t,34),e.fillText(d,0,u+5,"24px SimHei",s,"left"),e.fillText(h,p,u+5,"24px SimHei",s,"left"),u+=44}return""},i.updateCostUI=function(){var e=0;e=TR.ins.getGoodsNum(this.cost_id),this.enoughBool=e>=this.cost_num,this.maxLvBool?this.hdv_cost.innerHTML="":this.hdv_cost.innerHTML=Ql.createColor(e.toString(),this.enoughBool?"#23b11f":"#ff2e24")+"/"+this.cost_num},i.showSelectedEffect=function(e){if(this._selectedPart!=e){e<=0&&(e=1),this._selectedPart=e;var t=0,i=0,n=this.hash.take(e);n&&(t=n.b.x+56,i=n.b.y+56),this.eff?this.eff.pos(t,i):this.eff=kB.createEffect("jm0015",t,i,this)}},i.hideSelectedEffect=function(){this._selectedPart=-1,this.eff&&(this.eff.dispose(),this.eff=null)},i.onClick=function(e){var t=this;if(e.currentTarget==t.btn_link)hN.ins.toggle("GODLY_RESOLVE"),UB.ins.playSound(90006);else{if(t.maxLvBool)return void zB.ins.playErrorMsg(RP.n[543]);if(UB.ins.playSound("3"),!t.enoughBool)return void zB.ins.playErrorMsg(zB.ins.getDesc(3274));var i=BB.getTimer();if(i-t._optionTime<200)return;if(t._optionTime=i,t.target_grid.bindData&&(t.target_grid.bindData.useLevel>gR.ins.lv||t.target_grid.bindData.flyLevel>gR.ins.zsLv))return void(1==t.option?zB.ins.playErrorMsg(zB.ins.getDesc(3276)):zB.ins.playErrorMsg(zB.ins.getDesc(3275)));if(1==t.option){var n=t.org_grid.bindData;OR.reqCompose(t.op_id,n.uuId,[])}else OR.requestExchange(t.op_id,1,t._selector.selectIdx+1);t.btn_option.disabled=!0,G.timer.once(3e3,t,t.updateBtn_optionState)}},i.updateBtn_optionState=function(){this.btn_option.disabled=!1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_link.y=1087,t.btn_link.valign="middle",t.btn_link.hitArea=new u_(0,-10,180,60),t.btn_option.on("click",t,t.onClick),t.btn_link.on("click",t,t.onClick),t._selector.selectIdx=gR.ins.currentSelectRoleIndex,t._selector.on("select",t,t.onSelect),t.btn_goReXue.on("click",t,t.onReXueClicked),t.updateByVSC(null),t.updateBtn_optionState(),t.showSelectedEffect(t.updatePartRedPtToPart())},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_option.off("click",t,t.onClick),t.btn_link.off("click",t,t.onClick),t.hideSelectedEffect(),t.btn_goReXue.off("click",t,t.onReXueClicked),t.resolveEffect&&(t.resolveEffect.parent&&t.resolveEffect.parent.removeChild(t.resolveEffect),t.resolveEffect.dispose(),t.resolveEffect=null),t.eff&&(t.eff.parent&&t.eff.parent.removeChild(t.eff),t.eff.dispose(),t.eff=null),t.effectUp&&(t.effectUp.parent&&t.effectUp.parent.removeChild(t.effectUp),t.effectUp.dispose(),t.effectUp=null)},i.onSelect=function(e){gR.ins.currentSelectRoleIndex=this._selector.selectIdx,this.updateByVSC(null)},i.updateByVSC=function(e){G.timer.once(100,this,this.update,[e])},i.showEffect=function(){var e=this;e.effectUp&&(e.effectUp.parent&&e.effectUp.parent.removeChild(e.effectUp),e.effectUp.dispose(),e.effectUp=null);var t=0,i=0,n=e.hash.take(e._selectedPart);n&&(t=n.b.x+56,i=n.b.y+56),e.effectUp?e.effectUp.pos(t,i):e.effectUp=kB.createEffect("jm0001",t,i,e)},i.updateEquips=function(){for(var e=this,t=e._selector.selectIdx+1,i=F.GODLYPARTS,n=i[0],s=0;s<i.length;s++){var o=i[s],a=e.hash.take(o),r=a.g,l=a.t,c=a.b,u=MR.ins.getEquip(t,o);e._godlyData.showGodlyEquipPanel(u)?(r.visible=!0,r.bindData=u,c.mouseEnabled=!1):(r.visible=!1,c.mouseEnabled=!0),e.setPartName(l,u,o)}e._selectedPart<=0?(e.showSelectedEffect(n),e.updateOption(MR.ins.getEquip(t,n),t,n)):e.updateOption(MR.ins.getEquip(t,e._selectedPart),t,e._selectedPart)},i.setPartName=function(e,t,i){this._godlyData.showGodlyEquipPanel(t)?e.changeText(F.getLevel(t.goodsId)):e.changeText(la.getName(i)),e.color="#6c6250"},i.update=function(e){this._selector.invalid(),this.updateEquips(),this.updateRedPt()},i.updateRedPt=function(){var e=this;e.updatePartRedPt(),e.updateActorRedTip(),0<rR.instance.getResolveList().length?e.resolveEffect||(e.resolveEffect=kB.createEffect("jm1130",e.btn_link.x+(e.btn_link.textWidth>>1),e.btn_link.y+(e.btn_link.textHeight>>1)+1,e),e.resolveEffect.scale_X=1.02,e.resolveEffect.scale_Y=.7):(e.resolveEffect&&(e.resolveEffect.parent&&e.resolveEffect.parent.removeChild(e.resolveEffect),e.resolveEffect.dispose()),e.resolveEffect=null)},i.updatePartRedPt=function(){0<rR.instance.needUpdate&&rR.instance.updateRedData();for(var e,t,i=this._selector.selectIdx+1,n=0,s=F.GODLYPARTS,o=0;o<s.length;o++)n=s[o],e=this.hash.take(n),rR.instance.getPartShowTip(i,n)?e.p?e.p.visible=!0:(t=kB.createSprite(NI.POINT,e.b.x+85,e.b.y-13,0,0,this),e.p=t):e.p&&(e.p.visible=!1)},i.updateActorRedTip=function(){for(var e=gR.ins.actorList.length,t=0;t<e;t++)this._selector.setRedPtByIdx(t,rR.instance.getRoleShowTip(t))},i.onReXueClicked=function(e){Tu.sendToModule("SHOW_REXUE_VIEW",["modules.actor.ActorModule"],{selectedIndex:"1",type:this._type})},i.updatePartRedPtToPart=function(){var e=0;0<rR.instance.needUpdate&&rR.instance.updateRedData();for(var t=this._selector.selectIdx+1,i=0,n=F.GODLYPARTS_1,s=0;s<n.length;s++)if(i=n[s],this.hash.take(i),rR.instance.getPartShowTip(t,i)){e=i;break}return e},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.godlybg&&t.godlybg.skin&&G.loader.clearRes(t.godlybg.skin),t.p_in_1.dispose(),t.p_in_2.dispose(),t.p_in_3.dispose(),t.p_in_4.dispose(),t.p_in_5.dispose(),t.p_in_6.dispose(),t.p_in_7.dispose(),t.p_in_8.dispose(),laya.ui.View.prototype.destroy.call(t,e)},t}(zr),IX=function(e){function t(){this.m_uId=0,this.g_item=null,this.g_box=null,t.__super.call(this)}b(t,"modules.actor.views.godlyequip.GodlyEquipResolveItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.lab_level.text="",this.btn_resolve.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.g_box&&this.g_box.graphics.clear(),this.btn_resolve.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){0<this.m_uId&&OR.reqRecycle([this.m_uId]),UB.ins.playSound("5")},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){G.superSet(Xr,t,"dataSource",e);var i=e;if(t.g_box&&t.g_box.graphics.clear(),i){t.m_uId=i.uuId,t.g_item||(t.g_item=new MF,t.gridBox.addChild(t.g_item)),0<(t.g_item.bindData=i).flyLevel?(t.lab_level.changeText("转生："),t.lab_level.changeText(i.flyLevel+"转")):(t.lab_level.changeText("等级："),t.lab_level.changeText(0<i.useLevel?i.useLevel+"级":"无限制"));var n=0;t.g_box||(t.g_box=new dt,t.g_box.pos(147,19),t.addChild(t.g_box)),t.g_box.graphics.clear();var s=ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx));t.g_box.graphics.fillText(i.name,0,n,"24px SimHei",s,"left"),n+=43,t.g_box.graphics.fillText(RP.n[544],0,n,RP.n[545],"#90877b","left"),n+=43;var o=Bi.MODEL.recycleGoodsAward(i.cfgIdx),a=o.split(","),r=yB.create(a[0],a[1]);r?t.g_box.graphics.fillText(r.name+"x"+r.goodsNum,0,n,"24px SimHei",s,"left"):t.g_box.graphics.fillText(o,0,n,"24px SimHei","#90877b","left")}else t.m_uId=0,t.lab_level.text="",t.g_item&&(t.g_item.bindData=null)}}),t}(Xr),bX=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.actor.views.godlyequip.GodlyResolveView",Qr);var i=t.prototype;return i.init=function(){this.list.itemRender=IX,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,iu.optimizeList(this.list,IX)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this),this.txt_no.visible=!1,this.updateData(),this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.updateData=function(e){var t=rR.instance.getResolveList();this.list.array=t,this.txt_no.visible=t.length<1},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),wX=function(e){function t(){if(this.m_NPCId=null,t.__super.call(this),null!=t._inst)throw new Error(RP.n[64]);this.centerX=this.centerY=0}b(t,"layouts.common.NPCTalkView",dd);var i=t.prototype;return i.show=function(e){var t=this;t.parent||(eq.panelLayer?(eq.panelLayer.open(t,!0,!0,!0),eq.panelLayer.once("MASK_CLOSE",t,t.close)):G.stage.addChild(t)),t.m_NPCId=e;var i=fn.getIndex(parseInt(t.m_NPCId));t.div_npc.innerHTML="【"+fn.MODEL.name(i)+"】",t.div_content.innerHTML=fn.MODEL.playdesc(i),t.content.height=t.div_content.y+t.div_content.contextHeight-t.content.top+40},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_close:this.close()}},i.close=function(){this.parent&&(eq.panelLayer?(eq.panelLayer.closeAll(),eq.panelLayer.close(this)):this.parent.removeChild(this))},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.broad.NPCTalkViewUI._$SET_ins),t._inst=null,t}(),xX=function(e){function t(){this._list=[aa.MAXHP,aa.MAXMP,aa.ATK,aa.DEF,aa.MDEF,aa.CRI_RATE,aa.CRI_QD_RATE,aa.PARALYSIS_RATE,aa.PARALYSIS_RES_RATE],this._total=0,this._curIdx=0,this._wBox=null,t.__super.call(this),this.init()}b(t,"modules.actor.views.item.ActorAttrDetailV",U);var i=t.prototype;return i.show=function(e){this._total=gR.ins.actorList.length,this._curIdx=e,this.showValue(this._curIdx)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._curIdx=0},i.init=function(){this.btnL.mouseEnabled=!0,this.btnR.mouseEnabled=!0,this._wBox=new dt,this._wBox.x=30,this._wBox.y=112,this.addChild(this._wBox)},i.showValue=function(e){var t=this,i=t._list.length,n=0;t.height=n,n=24*i+18*(i-1)+112+40,t.img_bg.height=n,t.box_blank_tip.y=n+15;var s,o,a,r=gR.ins.actorList[e],l=0,c=[];t._wBox.graphics.clear(),o=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",s=G.loader.getRes(o);for(var u=0;u<i;u++)c[2*u]=0,c[2*u+1]=2+42*u;for(t._wBox.graphics.drawTextures(s,c),u=0;u<i;u++)a=t._list[u],l=t._list[u].id,t._wBox.graphics.fillText(a.attrName+"：",170,4+42*u,"24px SimHei","#90877b","right"),t._wBox.graphics.fillText(r.getAttrValWordById(l,!0),173,4+42*u,"24px SimHei","#e0d6ca","left");for(u=1;u<=3;u++)t["mcJob_"+u].visible=r.job==u;t.showLR()},i.onClick=function(e){e.target==this.btnL?(this._curIdx-=1,this.showValue(this._curIdx)):e.target==this.btnR&&(this._curIdx+=1,this.showValue(this._curIdx))},i.showLR=function(){var e=this;1==e._total?(e.btnL.visible=!1,e.btnR.visible=!1):0==e._curIdx?(e.btnL.visible=!1,e.btnR.visible=!0):e._curIdx+1==e._total?(e.btnL.visible=!0,e.btnR.visible=!1):(e.btnL.visible=!0,e.btnR.visible=!0)},t.GAP=42,t.START_PY=2,t.START_TY=4,t}(),SX=function(e){function t(){this._grid=null,this._needNum=0,this._currentNum=0,this._id=0,this._isHight=!1,this._isHas=!1,t.__super.call(this)}b(t,"modules.actor.views.heji.ActorHeJiExchangeDetailItem",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF,this._grid.toolTipEnabled=!1,this.addChild(this._grid)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exchange.on("click",this,this.onExchangeBtnClicked),this._grid.on("click",this,this.onGridClciked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_exchange.off("click",this,this.onExchangeBtnClicked),this._grid.off("click",this,this.onGridClciked)},i.onExchangeBtnClicked=function(e){0<TR.ins.getLeftGridNum()?this._currentNum<this._needNum?this._isHight?zB.ins.showMsg(RP.n[547],1):zB.ins.showMsg(RP.n[548],1):OR.requestExchange(this._id):KQ.ins.showBagRecycle()},i.onGridClciked=function(e){_W.instance.showByType(this._grid.bindData)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Y,t,"dataSource",e),null!=e){var i=KH.create(e.fuwenID),n=(t._grid.bindData=i).cfgIdx,s=Bi.MODEL.colourId(n);t.txt_name.text=i.name,t.txt_name.color=ms.getByQuality(s),t._grid.pos(t.img_icon.x,t.img_icon.y),t._id=e.id;var o,a=xa.getIndex(t._id),r=xa.MODEL.consumption(a),l=yB.createStr(r),c=ua.judgePart(e.fuwenID),u=iR.instance.getInfoByPart(c).level,d=t.txt_num.mouseEnabled=!1,h=!1;t._isHas=0<TR.ins.getGoodsNum(e.fuwenID),e.level>u&&0!=u?h=!0:0==u&&(h=!0);l.goodsId==aR.RUNE_PIECE.itemId?(t._currentNum=gR.ins.fuwen,o=(d=gR.ins.fuwen>=l.goodsNum)?"#23b11f":"#ff2e24",t.txt_num.innerHTML=Ql.createColor(gR.ins.fuwen.toString(),o)+Ql.createColor("/"+l.goodsNum,"#e0d6c1"),t._isHight=!1):l.goodsId==aR.HIGH_RUNE_PIECE.itemId&&(t._currentNum=gR.ins.fuwengaoji,o=(d=gR.ins.fuwengaoji>=l.goodsNum)?"#23b11f":"#ff2e24",t.txt_num.innerHTML=Ql.createColor(gR.ins.fuwengaoji.toString(),o)+Ql.createColor("/"+l.goodsNum,"#e0d6c1"),t._isHight=!0),t._needNum=l.goodsNum,t.btn_exchange.gray=!d,t.btn_exchange.showTip=d&&h&&!t._isHas;var _=n=Bi.getIndex(l.goodsId),f=Bi.MODEL.icon(_);t.img_money.skin=_r.getAtlasSubPath("actor/"+f+".png")}}),t}(Y),kX=function(e){function t(){this._itemIndex=-1,t.__super.call(this)}b(t,"modules.actor.views.heji.ActorHeJiExchangeMainTypeItem",e);var i=t.prototype;return p(0,i,"itemIndex",function(){return this._itemIndex}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(J,this,"dataSource",e),null!=e){this._itemIndex=-1,this.txt_name.changeText(e.text);var t=iR.instance.canExchangeData[e.level-1];t&&0<t.length?this.img_red.visible=!0:this.img_red.visible=!1,this.selected=!e.isSelected}}),p(0,i,"selected",null,function(e){this.btn_.selected=e,this.txt_name.color=e?"#90877b":"#e0d6c1"}),t}(J),EX=function(e){function t(){this._offsetY=0,this.TITLE_B=26,this.TEXT_B=12,this.TITLE_SIZE=24,this.TEXT_SIZE=22,this.TITLE_S=232,this.TEXT_S=54,t.__super.call(this)}b(t,"modules.actor.views.heji.HeJiAttrItemView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){this.graphics.clear(),ui.ViewBase.prototype.onRemove.call(this,e)},i.drawText=function(e,t,i,n,s){this.graphics.fillText(e,t,this._offsetY,i+"px SimHei",n,"left"),this._offsetY+=i+s},i.drawAttr=function(e,t,i,n,s,o,a){this.graphics.fillText(e,s,this._offsetY,o+"px SimHei",t,"left");var r=s+(mp.getStringLength(e)*o>>1)+4;this.graphics.fillText(i,r,this._offsetY,o+"px SimHei",n,"left"),this._offsetY+=o+a},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Yl,t,"dataSource",e),e){var i=PR.getGoodsNewAttr(t.dataSource.goodsId),n=Bi.getIndex(t.dataSource.goodsId),s=aa.formatNewAttrToChinese(i,!1,!1);t.fight_num.value=(RR.getFight(i)+Bi.MODEL.fight(n))*gR.ins.actorList.length,t._offsetY=t.box_jichu.y+t.box_jichu.height+20;for(var o=0;o<s.length-1;o++){var a=s[o],r=a.name+":",l=a.val+"";0<t.dataSource.random&&(l+=" +"+aa.getFormatValue(a.id,a.val*t.dataSource.randomRate>>0)),t.drawAttr(r,"#90877b",l,"#90877b",t.TEXT_S,t.TEXT_SIZE,t.TEXT_B)}t.box_jipin.y=t._offsetY+10,t._offsetY=t.box_jipin.y+t.box_jipin.height+20;for(var c=s.length-1;c<=s.length-1;c++){var u=s[c],d=u.id,h=aa.getAttributById(d),_="["+h.getModuleName("MODULE_COMBINE_ATTACK")+"]"+h.desc+":",f=u.val+"%";t.drawAttr(_,"#e6d80d",f,"#23b11f",t.TEXT_S,t.TEXT_SIZE,t.TEXT_B)}}}),p(0,i,"height",function(){return this._offsetY},e.prototype._$set_height),t}(Yl),TX=function(e){function t(){this._list=[aa.ATK,aa.DEF,aa.MDEF,aa.MAXHP],this._total=0,this._curIdx=0,this._wBox=null,this.isallOK=!0,t.__super.call(this),this.init()}b(t,"modules.actor.views.mo.MoEquipAttrDetailV",U);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this._curIdx=gR.ins.currentSelectRoleIndex,this.showValue(this._curIdx)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.init=function(){this.btnL.mouseEnabled=!0,this.btnR.mouseEnabled=!0,this._wBox=new dt,this._wBox.x=30,this._wBox.y=112,this.addChild(this._wBox)},i.showValue=function(e){var t=this;void 0===e&&(e=0);var i,n=t._list.length;i=24*n+18*(n-1)+550,t.height=i,t.img_bg.height=i,t.box_blank_tip.y=15+i;var s=gR.ins.actorList.length;(t._total=s)<=e?e=s-1:e<0&&(e=0);var o,a,r=gR.ins.actorList[e],l=[];t._wBox.graphics.clear(),t._wBox.removeChildren();var c=0;a=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",o=G.loader.getRes(a);for(var u=0;u<n;u++)l[2*u]=0,l[2*u+1]=0+40*u;t._wBox.graphics.drawTextures(o,l),c+=40*n;var d,h=_R.ins.getRoleEquipsAttrs(e+1),_=aa.formatNewAttrToObject(h);for(u=0;u<n;u++)d=t._list[u],t._list[u].id,t._wBox.graphics.fillText(d.attrName+"：",170,0+40*u,"24px SimHei","#90877b","right"),t._wBox.graphics.fillText(t.getAttrValWordById(d,_),173,0+40*u,"24px SimHei","#e0d6ca","left");c+=10;var f=_R.ins.getSuitsByType(1),p=_R.ins.getMaxSuitBySuitIndexs(f,t._curIdx+1),g="#23b11f";p<=0&&(g="#90877b",p=f[0]);var v=nn.MODEL.name(p),m=nn.MODEL.starLevel(p);t.createInfoTitleBar(v,c);var y=nn.MODEL.positions(p),I=0;for(c+=40,v="[&nbsp;",t.isallOK=!0,I=0;I<y.length;I++)v+=t.getColorEquipName(y[I],m);v+="]",kB.createHtmlDiv(0,c,24,g,450,30,t._wBox).innerHTML=v,c+=40;var b=0,w=null;if(v=nn.MODEL.buffMessage(p))for(w=v.split("<br>"),b=0;b<w.length;b++)kB.createHtmlDiv(0,c+40*b,24,t.isallOK?"#23b11f":"#90877b",450,300,t._wBox).innerHTML=Ql.createSizeColor(w[b],24,t.isallOK?"#23b11f":"#90877b");for(c+=130,p=0,g="#23b11f",f=_R.ins.getSuitsByType(2),(p=_R.ins.getMaxSuitBySuitIndexs(f,t._curIdx+1))<=0&&(g="#90877b",p=f[0]),v=nn.MODEL.name(p),t.createInfoTitleBar(v,c),kB.createHtmlDiv(0,c,24,"#e6d80d",450,30,t._wBox),c+=40,y=nn.MODEL.positions(p),v="[&nbsp;",t.isallOK=!0,m=nn.MODEL.starLevel(p),I=0;I<y.length;I++)v+=t.getColorEquipName(y[I],m);if(v+="]",kB.createHtmlDiv(0,c,24,g,450,30,t._wBox).innerHTML=v,c+=40,v=nn.MODEL.buffMessage(p))for(w=v.split("<br>"),b=0;b<w.length;b++)kB.createHtmlDiv(0,c+40*b,24,t.isallOK?"#23b11f":"#c6c4c4",450,300,t._wBox).innerHTML=Ql.createSizeColor(w[b],24,t.isallOK?"#23b11f":"#90877b");for(u=1;u<=3;u++)t["mcJob_"+u].visible=r.job==u;t.showLR()},i.getColorEquipName=function(e,t){var i=la.getName(e),n=_R.ins.getEquipByPosition(e,this._curIdx+1);return n&&n.magicStarLevel>=t?"<font style='color:#23b11f;'>"+i+"&nbsp;</font>":(this.isallOK=!1,"<font style='color:#90877b;'>"+i+"&nbsp;</font>")},i.createInfoTitleBar=function(e,t){var i=kB.createImage("ui/layouts/basic_ui/ty_tips_btfg.png",95,t+10,0,0,this._wBox);i.scaleX=-1,i.width=110,kB.createImage("ui/layouts/basic_ui/ty_tips_btfg.png",305,t+10,0,0,this._wBox).width=110;var n=kB.createText(100,t,0,0,e,28,"#e6d80d");n.font="SimHei",this._wBox.addChild(n)},i.getAttrValWordById=function(e,t){var i=0;return t[e.keyStr]?(i+=t[e.keyStr],e.isPer?i/100+"%":i+""):0==i?"0":e.isPer?i/100+"%":i+""},i.onClick=function(e){e.target==this.btnL?(this._curIdx-=1,this.showValue(this._curIdx)):e.target==this.btnR&&(this._curIdx+=1,this.showValue(this._curIdx))},i.showLR=function(){var e=this;1==e._total?(e.btnL.visible=!1,e.btnR.visible=!1):0==e._curIdx?(e.btnL.visible=!1,e.btnR.visible=!0):e._curIdx+1==e._total?(e.btnL.visible=!0,e.btnR.visible=!1):(e.btnL.visible=!0,e.btnR.visible=!0)},t.GAP=40,t.START_PY=0,t.START_TY=0,t}(),CX=function(e){function t(){var e=this;e.longwenModel=null,e.innerLongWen=null,e._longwenIndex=0,e.innerArr=[],e.noInnerArr=[],t.__super.call(e),e.initUI(),e.longwenModel=lR.instance(),e.centerX=e.centerY=0}b(t,"modules.actor.views.longwen.LongWenChangeView",Lc);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.panel_item.vScrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent),this.panel_item.vScrollBar.off("change",this,this.onScrollChanged)},i.resfreshPanel=function(){this.show(this._longwenIndex),this.onClickCloseEvent(null)},i.show=function(e){var t=this;t.clearItem(),t._longwenIndex=e;var i=TR.ins.getBackPackLongWensFiltersame(),n=MR.ins.getEquip(t.longwenModel.roleIndex,t._longwenIndex);null==n?(t.box_no.visible=!0,t.currentLongWen.visible=!1,t.innerLongWen.visible=!1):(t.box_no.visible=!1,t.currentLongWen.visible=!0,t.innerLongWen.visible=!0,t.showLongWenInfo(n,!0));t.longwenModel.getInnerDragonTypeList(t.longwenModel.roleIndex).longwenTyps;var s,o=0;for(var a in i.proto)(s=new Gj).currentDragon=n,s.data=i.take(a),s.position=t._longwenIndex,1==s.isInner?t.innerArr.push(s):0==s.isInner&&t.noInnerArr.push(s);t.doSortLongWen(t.innerArr),t.doSortLongWen(t.noInnerArr);for(o=0;o<t.innerArr.length;o++)null==t.innerArr[o].parent&&(t.panel_item.addChild(t.innerArr[o]),t.innerArr[o].x=4,t.innerArr[o].y=160*o,t.innerArr[o].y);for(o=0;o<t.noInnerArr.length;o++)null==t.noInnerArr[o].parent&&(t.panel_item.addChild(t.noInnerArr[o]),t.noInnerArr[o].x=4,t.noInnerArr[o].y=160*(t.innerArr.length+o),t.noInnerArr[o].y);t.txt_no.visible=t.noInnerArr.length+t.innerArr.length<1},i.clearItem=function(){var e=this,t=0;for(t=0;t<e.innerArr.length;t++)null!=e.innerArr[t].parent&&e.innerArr[t].parent.removeChild(e.innerArr[t]);for(e.innerArr=[],t=0;t<e.noInnerArr.length;t++)null!=e.noInnerArr[t].parent&&e.noInnerArr[t].parent.removeChild(e.noInnerArr[t]);e.noInnerArr=[]},i.doSortLongWen=function(e){e.sort(function(e,t){var i=e.sortId,n=t.sortId;return n<i?-1:i==n?0:1})},i.doSortLongwenTwo=function(e,t){var i=0;return e.xq_state>t.xq_state?i=-1:e.xq_state==t.xq_state?i=e.lock_lay<t.lock_lay?-1:e.lock_lay==t.lock_lay?0:1:e.xq_state<t.xq_state&&(i=1),i},i.onClickBtnGet=function(e){qR.ins.isOpenCopy?hN.ins.open("COPYMAINVIEW",{selectedIndex:2},0):zB.ins.showMsg(RP.n[549],1)},i.showLongWenInfo=function(e,t){void 0===t&&(t=!0),this.innerLongWen.currentDragon=e,this.innerLongWen.inner=!0,this.innerLongWen.data=e,this.innerLongWen.isShowBtn=!1},i.onClickCloseEvent=function(e){hN.ins.isOpen("LONGWEN_CHANGE_PANEL")&&hN.ins.close("LONGWEN_CHANGE_PANEL")},i.initUI=function(){var e=this;e.centerX=e.centerY=0,e.panel_item.vScrollBarSkin="",e.panel_item.vScrollBar.elasticDistance=300,e.innerLongWen=new Gj,e.addChild(e.innerLongWen),e.innerLongWen.x=37,e.innerLongWen.y=131,e.btnGetLongWen.on("click",e,e.onClickBtnGet)},i.onScrollChanged=function(){this.noInnerArr.length+this.innerArr.length<=3||0==this.panel_item.vScrollBar.max||this.panel_item.vScrollBar.value>=this.panel_item.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),LX=function(e){function t(){var e=this;e.attrItem=null,e.centerEffect=null,e.ballNum=0,e.ballEffects=null,e.fhEffects=null,e.fhSprites=null,e.btnEffect=null,e.lkEffect=null,e.piaoEffect=null,e.curTier=0,e.curLv=0,e.canUp=!1,e.canExchange=!1,e.clickAble=!1,t.__super.call(e),e.ballNum=6}b(t,"modules.actor.views.lunhui.ActorLunhuiView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.img_bg.skin=_r.getFullUrl("ui/images/lunhui/lh_jm_bg.jpg")},i.onAdd=function(e){var t=this;t.curTier=-1,t.curLv=-1,t.clickAble=!0,hN.ins.close("LunhuiRemindTip"),nR.reqLunhuiMessage(),t.btn_help.on("click",t,t.onClickHelp),t.btn_up.on("click",t,t.onClickUp),t.lk_getYl.on("click",t,t.onClickLk),t.btn_up.gray=!1,t.attrItem||(t.attrItem=new Xj,t.attrItem.y=750,t.addChild(t.attrItem)),t.centerEffect||(t.centerEffect=kB.createEffect("jm1430",t.img_center.width>>1,t.img_center.height>>1,t.img_center)),t.fhSprites||(t.fhSprites=[]);for(var i=0;i<t.ballNum;i++){var n=t["fh"+(i+1)],s=new pp;s.width=n.width,s.height=n.height,s.pos(n.x,n.y),s.rotation=60*i,i>=t.ballNum/2&&(s.scaleX=-1),t.addChild(s),t.fhSprites[i]=s}t.showDetail()},i.onRemove=function(e){var t=this;if(t.btn_help.off("click",t,t.onClickHelp),t.btn_up.off("click",t,t.onClickUp),t.lk_getYl.off("click",t,t.onClickLk),t.attrItem&&t.attrItem.parent&&t.attrItem.parent.removeChild(t.attrItem),t.attrItem=null,t.centerEffect&&(t.centerEffect.dispose(),t.centerEffect=null),t.piaoEffect&&(t.piaoEffect.dispose(),t.piaoEffect=null,t.rotate_sprite.removeChild(t.piaoEffect)),null!=t.fhSprites){for(var i=0;i<t.ballNum;i++){t.fhSprites[i].removeSelf()}t.fhSprites&&(t.fhSprites.length=0)}G.timer.clearAll(t),t.clearBallEffect()},i.updateByVSC=function(e){var t=this;if(t.showDetail(),e instanceof protos.actor.toc_30662){var i=Ki.MODEL.tier(Ki.getIndex(e.lunhuiId));-1==t.curTier||t.curTier>i?(t.showBallEffect(i),t.curTier=i):i>t.curTier&&(t.showUpgradeTierEffect(i),t.curTier=i);var n=Ki.MODEL.level(Ki.getIndex(e.lunhuiId));if(t.curLv&&0<t.curLv){if(n>t.curLv){t.showUpgradeLvEffect(),t.clearBallEffect();for(var s=0;s<t.ballNum;s++)t["ball"+(s+1)].visible=!0;t.curLv=n}}else t.curLv=n}},i.showDetail=function(){var e=this,t=gR.ins.lunhuiId;t&&0!=t||(t=1);var i=1,n=0;if(1<=t&&(i=Ki.MODEL.level(Ki.getIndex(t)),n=Ki.MODEL.tier(Ki.getIndex(t))),e.img_name1.skin=_r.getFullUrl("ui/layouts/lunhui/lh_name_"+i+".png"),e.img_name2.skin=_r.getFullUrl("ui/layouts/lunhui/lh_name_cs_"+(n+1)+".png"),e.attrItem.update(t),e.num_fight.value=e.attrItem.fightValue,0<=Ki.getIndex(t+1)){e.box_cost.visible=!0,e.img_max1.visible=e.img_max2.visible=!1;var s=gR.ins.yeli,o=Ki.MODEL.yeliCost(Ki.getIndex(t));e.canUp=o<=s,o&&0!=o?e.canUp?e.txt_numYl.innerHTML="<font style='color:#23b11f;'>"+s+"</font>/"+o:e.txt_numYl.innerHTML="<font style='color:#ff2e24;'>"+s+"</font>/"+o:e.txt_numYl.innerHTML=""+s,e.canExchange=cR.checkCanExchangeYeli(),e.img_red.visible=e.canExchange}else e.box_cost.visible=!1,e.img_max1.visible=e.img_max2.visible=!0,e.canUp=!1,e.canExchange=!1;e.canUp?e.showButtonEffect():e.clearButtonEffect(),e.canExchange?e.showExchangeEffect():e.clearExchangeEffect()},i.showUpgradeLvEffect=function(){var e=this;this.clickAble=!1,this.btn_up.gray=!0,this.clearButtonEffect();var t=mj.GetNew();t.renderInSelf=!0,t.loadEffect("jm1434"),t.pos(this.width/2,this.height/2-150),t.playEndHandler=ql.create(this,function(){e.clickAble=!0,e.btn_up.gray=!1,e.canUp&&e.showButtonEffect()}),this.addChild(t)},i.showUpgradeTierEffect=function(e){var t=this;t.clickAble=!1,t.btn_up.gray=!0,t.clearButtonEffect();var i=e-1;t.rotate_sprite.rotation=60*i,t.piaoEffect&&(t.rotate_sprite.removeChild(t.piaoEffect),t.piaoEffect.dispose(),t.piaoEffect=null),t.piaoEffect=mj.GetNew(),t.piaoEffect.renderInSelf=!0,t.piaoEffect.loadEffect("jm1432"),t.piaoEffect.pos(t.rotate_sprite.width>>1,t.rotate_sprite.height),t.piaoEffect.playEndHandler=ql.create(t,t.showUpgradeTierEffect2,[e]),t.rotate_sprite.addChild(t.piaoEffect)},i.showUpgradeTierEffect2=function(e){var t=this;if(void 0===e&&(e=0),0!=e){var i=this["ball"+e];this.piaoEffect&&(this.piaoEffect.parent.removeChild(this.piaoEffect),this.piaoEffect.dispose(),this.piaoEffect=null),this.piaoEffect=mj.GetNew(),this.piaoEffect.renderInSelf=!0,this.piaoEffect.loadEffect("jm1433"),this.piaoEffect.pos(i.x+(i.width>>1),i.y+(i.height>>1)),this.addChild(this.piaoEffect),G.timer.once(200,this,function(){t.showBallEffect(e),t.showUpgradeTierEffect3(e)})}},i.showUpgradeTierEffect3=function(e){if(void 0===e&&(e=0),6==e){var t=gR.ins.lunhuiId;0<=Ki.getIndex(t+1)&&G.timer.once(500,this,function(){nR.reqLunhuiUpgrade()})}else this.clickAble=!0,this.btn_up.gray=!1,this.canUp&&this.showButtonEffect()},i.showBallEffect=function(e){var t=this;null==t.ballEffects&&(t.ballEffects=[]),null==t.fhEffects&&(t.fhEffects=[]),null==t.fhSprites&&(t.fhSprites=[]);for(var i=0;i<t.ballNum;i++){var n=t["fh"+(i+1)],s=t["ball"+(i+1)];if(i<e){if(n.index=0,null==t.fhEffects[i]){var o=t.fhSprites[i],a=kB.createEffect("jm1431",o.width>>1,o.height>>1,o);t.fhEffects[i]=a}if(s.visible=!1,null==t.ballEffects[i]){var r=kB.createEffect("jm1429",s.x+(s.width>>1),s.y+(s.height>>1),t);t.addChild(r),t.ballEffects[i]=r}}else n.index=1,s.visible=!0}},i.clearBallEffect=function(){var e=this;if(null!=e.ballEffects)for(var t=0 in e.ballEffects){var i=e.ballEffects[t];i.removeSelf(),i.dispose()}if(e.ballEffects&&(e.ballEffects.length=0),null!=e.fhEffects)for(var n=0 in e.fhEffects){var s=e.fhEffects[n];s.removeSelf(),s.dispose()}e.fhEffects&&(e.fhEffects.length=0)},i.showButtonEffect=function(){this.canUp&&this.clickAble&&(this.btnEffect||(this.btnEffect=kB.createEffect("jm1130",this.btn_up.width>>1,this.btn_up.height>>1,this.btn_up),this.btnEffect.scale_X=1.25,this.btnEffect.scale_Y=1.25))},i.clearButtonEffect=function(){this.btnEffect&&(this.btnEffect.parent&&this.btnEffect.parent.removeChild(this.btnEffect),this.btnEffect.dispose(),this.btnEffect=null)},i.showExchangeEffect=function(){this.lkEffect||(this.lkEffect=kB.createEffect("jm1130",this.lk_getYl.width>>1,this.lk_getYl.height>>1,this.lk_getYl),this.lkEffect.scale_X=.75,this.lkEffect.scale_Y=.75)},i.clearExchangeEffect=function(){this.lkEffect&&(this.lkEffect.parent&&this.lkEffect.parent.removeChild(this.lkEffect),this.lkEffect.dispose(),this.lkEffect=null)},i.onClickUp=function(){this.canUp?this.clickAble&&nR.reqLunhuiUpgrade():zB.ins.showMsg(RP.n[550],1)},i.onClickLk=function(){hN.ins.open("ACTOR_LHEXCHANGE")},i.onClickHelp=function(){QR.goToOpenHelpDes(6)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,this.destroyChildren)},t}($),MX=function(e){function t(){this._list=[aa.MAXHP,aa.ATK,aa.DEF,aa.MDEF,aa.HOLY_DAM_NUM,aa.DAM_INC_RATE,aa.MAXHP_C,aa.CRI_DAM_INC_RATE,aa.CRI_DAM_DEC_RATE],this._total=0,this._actorId=0,this._wBox=null,t.__super.call(this),this.init()}b(t,"modules.actor.views.lunhuizhuhun.LunhuiZhuhunAttrDetailTip",Wc);var i=t.prototype;return i.show=function(e){this._total=gR.ins.actorList.length,this.showValue(e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._wBox.graphics.clear(),this._actorId=-1},i.init=function(){this.btnL.mouseEnabled=!0,this.btnR.mouseEnabled=!0,this._wBox=new dt,this._wBox.x=30,this._wBox.y=112,this.addChild(this._wBox)},i.onClick=function(e){var t=gR.ins.actorById(this._actorId),i=gR.ins.actorList.indexOf(t);e.target==this.btnL?(i-=1,this.showIndex(i)):e.target==this.btnR&&(i+=1,this.showIndex(i))},i.showIndex=function(e){var t=gR.ins.actorList[e];this.showValue(t.id)},i.showValue=function(e){var t=this,i=t._list.length;t._actorId=e;var n=gR.ins.actorById(t._actorId);t._wBox.graphics.clear();var s,o,a=[];o=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",s=G.loader.getRes(o);for(var r=0;r<i;r++)a[2*r]=-20,a[2*r+1]=2+42*r;t._wBox.graphics.drawTextures(s,a);var l,c=[];if(null!=uR.ins.info[e]){var u;for(r=0;r<la.SAMSARA_EQUIPS.length;r++){var d,h=la.SAMSARA_EQUIPS[r],_=uR.ins.getMohuaLevel(e,h),f=uR.ins.getLinkLevel(e,h),p=hR.getPosAttr(e,_,h),g=hR.getMoAttr(e,_,h),v=hR.getLinkAttr(e,f,h);if(null!=(u=(u=(u=aa.formatNewAttrToChinese(p)).concat(aa.formatNewAttrToChinese(g))).concat(aa.formatNewAttrToChinese(v)))&&0!=u.length)for(var m in u)d=u[m],c.hasOwnProperty(d.id)?c[d.id]+=parseFloat(d.val):c[d.id]=parseFloat(d.val)}}var y=0;for(r=0;r<i;r++){var I=(l=t._list[r]).attrName,b="0";if(c.hasOwnProperty(l.id)){if(null==aa.getAttributById(l.id))continue;b=c[l.id].toString()}t._wBox.graphics.fillText(I+"：",190,4+42*y,"24px SimHei","#90877b","right"),l.isPer&&(b+="%"),t._wBox.graphics.fillText(b,193,4+42*y,"24px SimHei","#e0d6ca","left"),y++}for(r=1;r<=3;r++)t["mcJob_"+r].visible=n.job==r;t.showLR()},i.showLR=function(){var e=this,t=gR.ins.actorById(e._actorId),i=gR.ins.actorList.indexOf(t);1==e._total?(e.btnL.visible=!1,e.btnR.visible=!1):0==i?(e.btnL.visible=!1,e.btnR.visible=!0):i+1==e._total?(e.btnL.visible=!0,e.btnR.visible=!1):(e.btnL.visible=!0,e.btnR.visible=!0)},t.GAP=42,t.START_PY=2,t.START_TY=4,t}(),AX=function(e){function t(){this._item=null,this._dto=null,this._attrInfo=null,t.__super.call(this)}b(t,"modules.actor.views.lunhuizhuhun.LunhuiZhuhunMaterialTip",Xc);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.centerX=e.centerY=0,e._attrInfo=new dt,e.addChild(e._attrInfo),e._item=new MF,e._item.toolTipEnabled=!1,e.img_icon.addChild(e._item)},i.onAdd=function(e){},i.onRemove=function(e){},i.show=function(e){var i=this;this._dto=e;this.txt_name.text=e.name,this.txt_name.color=ms.getByQuality(e.colourId),this.txt_num.changeText(e.goodsNum+"");var t=0<e.flyLevel?e.flyLevel+"转":e.useLevel+"级";this.txt_level.changeText(t),this._attrInfo.graphics.clear();var n,s="#90877b",o=hR.getPosAttr2(e.roleJob,1,e.decoratePosition),a=aa.formatNewAttrToChinese(o),r=0,l=0,c=0;for(var u in a)n=a[u],r=196,l=360+c,s="#23b11f",this._attrInfo.graphics.fillText(n.name+":"+n.val,r,l+5,"24px SimHei",s,"left"),c+=32;this.cur_fight.value=RR.getFight(o);var d="#5f5952",h="#5f5952",_="#5f5952",f="";f=Ql.createColor(RP.n[551]+1,d);var p="",g="";p=hR.getLinkDes1_2(e.roleJob,1,e.decoratePosition),p=Ql.createColor(p,h),g=hR.getLinkNextCondition4_2(e.roleJob,e.decoratePosition),g=Ql.createColor(g,_),this.skillDes0.innerHTML=p+"<br>"+g,f+=Ql.createColor("】",d),this.skillName0.innerHTML=f,_=h=d="#5f5952",f=Ql.createColor(RP.n[552]+1,d),p=hR.getMohuaDes2(e.roleJob,1,e.decoratePosition),g="",p=Ql.createColor(p,h),g=Ql.createColor(g,_),this.skillDes1.innerHTML=p+"<br>"+g,f+=Ql.createColor("】",d),this.skillName1.innerHTML=f,TR.ins.getGoodsDes(this._dto.goodsId,ql.create(this,function(e,t){i.txt_desc.innerHTML=t,this.height=i.txt_desc.contextHeight+897})),this._item.bindData=this._dto.goodsId},t}(),DX=function(e){function t(){this._effGrow=null,this._attrInfo=null,this._cost=null,this._icon=null,this._curMoLevel=0,this._actorId=0,this._position=0,this._materialCorner=null,t.__super.call(this)}b(t,"modules.actor.views.lunhuizhuhun.LunhuiZhuhunTip",Qc);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.centerX=e.centerY=0,e._attrInfo=new dt,e.addChild(e._attrInfo),e._cost=new MF(45),e._cost.needGridBg=!1,e._cost.needEffect=!1,e._cost.needNum=!1,e._cost.needHunShow=!1,e._cost.pos(50,-10),e.cost.addChild(e._cost),e._materialCorner=new Kl(_r.getAtlasSubPath("basic_ui/bb_jb_h.png")),e._materialCorner.scale(.5,.5),e.cost.addChild(e._materialCorner),e._materialCorner.pos(e._cost.x+e._cost.width-20,e._cost.y+5),e._icon=new Kl,e._icon.pos(250,170),e.addChild(e._icon),e.btn_tip.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),null!=t._effGrow&&(t._effGrow.removeSelf(),t._effGrow.dispose(),t._effGrow=null),t._actorId=0,t._position=0,t._curMoLevel=0},i.update=function(){0!=this._actorId&&0!=this._position&&(uR.ins.getMohuaLevel(this._actorId,this._position)>this._curMoLevel&&(kB.createEffect("jm1499",300,277,this),this.show(this._actorId,this._position)))},i.show=function(e,t){var i=this;null!=i._effGrow&&(i._effGrow.removeSelf(),i._effGrow.dispose(),i._effGrow=null),i.btnUpgrade.tag=0,i.btn_tip.visible=!1,i._actorId=e,i._position=t,0!=i._actorId&&0!=i._position||(i.btnUpgrade.tag=1);var n=uR.ins.getMohuaLevel(e,t);i._curMoLevel=n;var s=uR.ins.getLinkLevel(e,t);i.img_name.skin=_r.getAtlasSubPath("lunhuizhuhun/lhzh_text_"+t+".png"),i._icon.skin=_r.getAtlasSubPath("lunhuizhuhun/"+t+".png"),i._attrInfo.graphics.clear(),i.arrow.visible=!1,i.img_max.visible=!1,i.btnUpgrade.visible=!1;var o,a="#90877b",r=[],l=[],c=0,u=0,d=0,h=Math.max(1,n);if(0==n){var _;for(var f in o=hR.getPosAttr(e,h,t),l=aa.formatNewAttrToChinese(o))_=l[f],c=196,u=420+d,a="#5f5952",i._attrInfo.graphics.fillText(_.name+":"+_.val,c,u+5,"24px SimHei",a,"left"),d+=32;i.btnUpgrade.visible=!0}else if(n>=hR.MAX_LEVEL){for(f in r=hR.getPosAttr(e,hR.MAX_LEVEL,t),l=aa.formatNewAttrToChinese(r))_=l[f],c=196,u=420+d,a="#90877b",i._attrInfo.graphics.fillText(_.name+":"+_.val,c,u+5,"24px SimHei",a,"left"),d+=32;i.img_max.visible=!0}else{for(f in i.arrow.visible=!0,r=hR.getPosAttr(e,n,t),o=hR.getPosAttr(e,n+1,t),l=aa.formatNewAttrToChinese(r))_=l[f],c=54,u=420+d,a="#90877b",i._attrInfo.graphics.fillText(_.name+":"+_.val,c,u+5,"24px SimHei",a,"left"),d+=32;for(f in d=0,l=aa.formatNewAttrToChinese(o))_=l[f],c=364,u=420+d,a="#23b11f",i._attrInfo.graphics.fillText(_.name+":"+_.val,c,u+5,"24px SimHei",a,"left"),d+=32;i.btnUpgrade.visible=!0}i.cur_fight.value=RR.getFight(r);var p=Math.max(s,1),g="#5f5952",v="#5f5952",m="#5f5952",y="#5f5952";0<s&&(m=g="#e0d6c1",y="#23b11f");var I="";I=Ql.createColor(RP.n[551]+p,g);var b="",w="";0==s?(b=hR.getLinkDes1(e,p,t),w=0<n?hR.getLinkNextCondition3(e,t):hR.getLinkNextCondition4(e,t)):s<n?(b=hR.getLinkDes2(e,s,n,t),w=hR.getLinkNextCondition2(e,n,t),I+=Ql.createColor("（lv."+n+"）",v)):(b=hR.getLinkDes1(e,s,t),s<hR.MAX_LEVEL&&(w=hR.getLinkNextCondition1(e,s+1,t))),b=Ql.createColor(b,m),w=Ql.createColor(w,y),i.skillDes0.innerHTML=b+"<br>"+w,I+=Ql.createColor("】",g),i.skillName0.innerHTML=I,y=m=v=g="#5f5952",0<n&&(m=g="#e0d6c1",y="#23b11f"),I=Ql.createColor(RP.n[552]+h,g),b=hR.getMohuaDes(e,h,t),w="",0<n&&n<hR.MAX_LEVEL&&(w=hR.getMohuaNextDes(e,h+1,t)),b=Ql.createColor(b,m),w=Ql.createColor(w,y),i.skillDes1.innerHTML=b+"<br>"+w,I+=Ql.createColor("】",g),i.skillName1.innerHTML=I;var x=gR.ins.actorById(e);if(x&&null==x.equips.getPart(t)&&(i.btnUpgrade.tag=3),i.cost.visible=!1,n<hR.MAX_LEVEL){var S=hR.getPosGrowCost(e,n+1,t);if(null!=S&&0<S.length){var k=S[0].value,E=parseInt(k.split(":")[0]),T=parseInt(k.split(":")[1]),C=TR.ins.getGoodsNum(E);i._cost.bindData=yB.create(E,C);var L=T<=C;i.divCost.innerHTML=Ql.createColor(C.toString(),L?"#23b11f":"#ff2e24")+"/"+T,i.cost.visible=!0,0==i.btnUpgrade.tag&&(i.btnUpgrade.tag=L?0:2),0==i.btnUpgrade.tag&&(null==i._effGrow&&(i._effGrow=kB.createEffect("jm1130",i.btnUpgrade.width>>1,i.btnUpgrade.height>>1,i.btnUpgrade),i._effGrow.scale_X=1.25,i._effGrow.scale_Y=1.25),i.btn_tip.visible=!0)}}i.btnUpgrade.gray=0!=i.btnUpgrade.tag},i.onClick=function(e){switch(e.target){case this.btn_close:hN.ins.close("LUNHUI_ZHUHUN_TIP");break;case this.btnUpgrade:if(this.btnUpgrade.gray){var t=this.btnUpgrade.tag,i=RP.n[555];switch(t){case 1:i=RP.n[556];break;case 2:i=RP.n[557];break;case 3:i=RP.n[558]}zB.ins.showMsg(i,1);break}dR.reqGrowZhuhun(this._actorId,this._position)}},t}(),OX=function(e){function h(){this._selector=null,this._equipEffs=null,this._arrowEffs=null,h.__super.call(this)}b(h,"modules.actor.views.lunhuizhuhun.LunhuiZhuhunView",Jc);var t=h.prototype;return t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.center.addChild(e._selector);for(var t=0;t<la.SAMSARA_EQUIPS.length;t++){var i=la.SAMSARA_EQUIPS[t],n=e["equip"+i];n.g_icon.skin=_r.getAtlasSubPath("lunhuizhuhun/"+i+".png"),n.g_icon.filters=A_.getGrayFilter4(),n.g_red.visible=!1,n.addChild(n.g_red),e["arrow"+hR.getPreLinkPos(i)+"_"+i].visible=!1}e._equipEffs=[],e._arrowEffs=[]},t.showByVSC=function(e,t){var i=this;i.on("click",i,i.onClick);for(var n=0;n<la.SAMSARA_EQUIPS.length;n++){i["equip"+la.SAMSARA_EQUIPS[n]].on("click",i,i.onClickEquip)}i._selector.invalid(),i._selector.on("select",i,i.onSelectActor),i.txt_help.on("click",i,i.onClick),i.updateView()},t.hideByVSC=function(e,t){var i=this;i.off("click",i,i.onClick),i.txt_help.off("click",i,i.onClick);for(var n=0;n<la.SAMSARA_EQUIPS.length;n++){i["equip"+la.SAMSARA_EQUIPS[n]].off("click",i,i.onClickEquip)}i._selector.off("select",i,i.onSelectActor),i.clearEffects()},t.clearEffects=function(){var e;for(var t in this._equipEffs)(e=this._equipEffs[t]).removeSelf(),e.dispose(),e=null;for(t in this._arrowEffs)(e=this._arrowEffs[t]).removeSelf(),e.dispose(),e=null;this._equipEffs=[],this._arrowEffs=[]},t.updateView=function(){this.updateEquip()},t.needRedpt=function(e){return!!uR.ins.isAbleGrowZhuhun(e.id)},t.onSelectActor=function(e){this._selector.selectIdx;this.updateEquip()},t.updateEquip=function(){this.clearEffects();for(var e=0,t=this._selector.selectIdx+1,i=0;i<la.SAMSARA_EQUIPS.length;i++){var n=la.SAMSARA_EQUIPS[i],s=this["equip"+n],o="arrow"+hR.getPreLinkPos(n)+"_"+n,a=this[o];a.visible=!1;var r=uR.ins.getMohuaLevel(t,n);if(0<r){s.g_icon.filters=null,a.visible=!0;var l=kB.createEffect("jm1508",s.width/2,s.height/2,s);if(this._equipEffs.push(l),s.addChild(s.g_red),0<uR.ins.getLinkLevel(t,n)){var c=h.LINK_TO_EFF[o].id,u=h.LINK_TO_EFF[o].x,d=h.LINK_TO_EFF[o].y;l=kB.createEffect(c,u,d,a),this._arrowEffs.push(l)}s.txt_level.visible=!0,s.txt_level.changeText("+"+r),e+=RR.getFight(hR.getPosAttr(t,r,n),t)}else s.txt_level.visible=!1,s.g_icon.filters=A_.getGrayFilter4();s.g_red.visible=uR.ins.isAbleGrowPosZhuhun(t,n)}this.fightNum.value=e,this._selector.invalid()},t.onClick=function(e){var t=this._selector.selectIdx+1;switch(e.target){case this.btn_help:case this.txt_help:QR.goToOpenHelpDes(20);break;case this.btn_detail:hN.ins.open("LUNHUI_ZHUHUN_ATTR_DETAIL",{actorId:t})}},t.onClickEquip=function(e){for(var t=this._selector.selectIdx+1,i=0;i<la.SAMSARA_EQUIPS.length;i++){var n=la.SAMSARA_EQUIPS[i],s=this["equip"+n];if(e.target==s)return void hN.ins.open("LUNHUI_ZHUHUN_TIP",{actorId:t,position:n})}},f(h,["LINK_TO_EFF",function(){return this.LINK_TO_EFF={arrow89_84:{id:"jm1514",x:95,y:70},arrow88_89:{id:"jm1511",x:88,y:76},arrow86_88:{id:"jm1512",x:19,y:40},arrow87_86:{id:"jm1514",x:95,y:70},arrow85_87:{id:"jm1512",x:19,y:40},arrow83_85:{id:"jm1512",x:19,y:40},arrow82_83:{id:"jm1513",x:52,y:100},arrow84_82:{id:"jm1512",x:19,y:40}}}]),h}(),PX=function(e){function t(){var e=this;e.attr_box=null,e._achieves=null,e.goodsGrid_src_equip_1=null,e.goodsGrid_src_equip_2=null,e.goodsGrid_tar_equip=null,e.currentClick=0,e.currentSelectedBtn=null,e.currentMainTools=[],e.minStarLevel=0,e.moData=null,e.currentPart=0,e.currentFZTools_0=null,e.currentFZTools_1=null,e.materialPositions=[],e.isNotTools=!1,e.uuid_arr=[],e.effSuccess=null,e.effCompose=null,e.parts=null,t.__super.call(e),e.moData=_R.ins,e.currentPart=77,e.initUI()}b(t,"modules.actor.views.mo.MoEquipComV",Gu);var i=t.prototype;return i.onAdd=function(e){var t=this;t.txt_get.on("click",t,t.onGetPathEvent),t.btn_compose.on("click",t,t.onComposeEvent),t.img_tool_0.on("click",t,t.onClickToolsEvent,[-1]),t.img_tool_1.on("click",t,t.onClickToolsEvent,[-1]),t.parts=[77,81,76,80,78,79],t.list_equips.selectEnable=!0,t.list_equips.selectHandler=ql.create(t,t.onSelectedEvent,null,!1),t.list_equips.array=t.parts;var i=new Object;i.part=t.currentPart,t.updateByVSC(i),t.effCompose=kB.createEffect("jm1329",472,500),t.addChildAt(t.effCompose,1),ui.ViewBase.prototype.onAdd.call(t,e)},i.onRemove=function(e){var t=this;for(t.txt_get.off("click",t,t.onGetPathEvent),t.btn_compose.off("click",t,t.onComposeEvent),t.img_tool_0.off("click",t,t.onClickToolsEvent),t.img_tool_1.off("click",t,t.onClickToolsEvent),t.goodsGrid_src_equip_1&&t.goodsGrid_src_equip_1.removeSelf(),t.goodsGrid_src_equip_2&&t.goodsGrid_src_equip_2.removeSelf(),t.goodsGrid_tar_equip&&t.goodsGrid_tar_equip.removeSelf(),t.parts=null;t.currentMainTools&&0<t.currentMainTools.length;){var i=t.currentMainTools.shift();i.removeSelf(),i=null}t.effSuccess&&(t.effSuccess.parent&&t.effSuccess.parent.removeChild(t.effSuccess),t.effSuccess.dispose(),t.effSuccess=null),t.effCompose&&(t.effCompose.parent&&t.effCompose.parent.removeChild(t.effCompose),t.effCompose.dispose(),t.effCompose=null),ui.ViewBase.prototype.onRemove.call(t,e)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.initUI=function(){var e=this;null==e.goodsGrid_src_equip_1&&(e.goodsGrid_src_equip_1=new MF(93)),null==e.goodsGrid_src_equip_1.parent&&e.addChild(e.goodsGrid_src_equip_1),e.goodsGrid_src_equip_1.pos(e.img_tool_0.x,e.img_tool_0.y),null==e.goodsGrid_src_equip_2&&(e.goodsGrid_src_equip_2=new MF(93)),null==e.goodsGrid_src_equip_2.parent&&e.addChild(e.goodsGrid_src_equip_2),e.goodsGrid_src_equip_2.pos(e.img_tool_0.x,e.img_tool_0.y),null==e.attr_box&&(e.attr_box=new dt,e.attr_box.pos(128,910),e.box_c.addChild(e.attr_box))},i.updateBtnRP=function(){for(var e=this.parts.length,t=0;t<e;t++){this.list_equips.getCell(t).img_red.visible=_R.canCompose(this.parts[t],gR.ins.currentSelectRoleIndex+1)}},i.updateByVSC=function(e){var t,i=this;i.currentPart=e.part,i.updateList(i.currentPart),i.showMainTool(i.currentPart),i.updateBtnRP();var n,s=i.moData.getMoEquipGoodsIDByPart(i.currentPart),o=$i.MODEL.materialPosition(s);i.materialPositions=o.split(",");var a=parseInt(i.materialPositions[0]),r=$i.MODEL.minLevel(s),l=_R.ins.getMaterialEquips(a,r);null==i.currentFZTools_0&&(n=la.getName(parseInt(i.materialPositions[0])),i.txt_tool_0.text="魔装"+n,i.txt_tool_0.color="#ff0000",i.img_red_0.visible=1<l.length||1==l.length&&l[0].dto.uuId!=i.uuid_arr[1]),a=parseInt(i.materialPositions[1]),l=_R.ins.getMaterialEquips(a,r),null==i.currentFZTools_1&&(n=la.getName(parseInt(i.materialPositions[1])),i.txt_tool_1.text="魔装"+n,i.txt_tool_1.color="#ff0000",i.img_red_1.visible=1<l.length||1==l.length&&l[0].dto.uuId!=i.uuid_arr[0]),null==i.goodsGrid_tar_equip&&(i.goodsGrid_tar_equip=new MF(116)),null==i.goodsGrid_tar_equip.parent&&i.addChild(i.goodsGrid_tar_equip),i.goodsGrid_tar_equip.pos(i.img_compose.x-2,i.img_compose.y-1);var c=$i.MODEL.tarMagicId(s);i.goodsGrid_tar_equip.bindData=yB.create(c,1),i.txt_tar_name.text=Bi.MODEL.name(Bi.getIndex(c)),i.txt_tar_name.color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(c))),i.clip_tot.value=i.goodsGrid_tar_equip.bindData.baseFight,t=Bi.getIndex(c),i.showAttr(i.attr_box,Bi.MODEL.attributes(t),"#90877b",!1),i.txt_socre.text=RP.n[559]+i.goodsGrid_tar_equip.bindData.baseFight},i.refreshTools=function(e){var t,i=this,n=0,s=0,o=0;if(null!=e){if(0==i.currentClick){i.uuid_arr[0]=e.uuId,null==i.currentFZTools_0&&(i.currentFZTools_0=new MF(93)),i.currentFZTools_0.bindData=e,null==i.currentFZTools_0.parent&&i.addChild(i.currentFZTools_0),i.currentFZTools_0.pos(i.img_tool_0.x,i.img_tool_0.y),n=Bi.getIndex(e.goodsId),s=Bi.MODEL.colourId(n),i.txt_tool_0.text=Bi.MODEL.name(n),i.txt_tool_0.color=ms.getByQuality(s),i.currentFZTools_0.clickHandler=ql.create(i,i.onClickToolsEvent,[0]),i.img_red_0.visible=!1,o=parseInt(i.materialPositions[1]);var a=_R.ins.getMoEquipGoodsIDByPart(o),r=$i.MODEL.minLevel(a);1==(t=_R.ins.getMaterialEquips(o,r)).length&&t[0].dto.uuId==i.uuid_arr[0]&&(i.img_red_1.visible=!1)}else if(1==i.currentClick){i.uuid_arr[1]=e.uuId,null==i.currentFZTools_1&&(i.currentFZTools_1=new MF(93)),i.currentFZTools_1.bindData=e,null==i.currentFZTools_1.parent&&i.addChild(i.currentFZTools_1),i.currentFZTools_1.pos(i.img_tool_1.x,i.img_tool_1.y),n=Bi.getIndex(e.goodsId),s=Bi.MODEL.colourId(n),i.txt_tool_1.text=Bi.MODEL.name(n),i.txt_tool_1.color=ms.getByQuality(s),i.currentFZTools_1.clickHandler=ql.create(i,i.onClickToolsEvent,[1]),i.img_red_1.visible=!1,o=parseInt(i.materialPositions[0]);var l=_R.ins.getMoEquipGoodsIDByPart(o),c=$i.MODEL.minLevel(l);1==(t=_R.ins.getMaterialEquips(o,c)).length&&t[0].dto.uuId==i.uuid_arr[1]&&(i.img_red_0.visible=!1)}if(i.btn_compose.showTip=!1,i.currentFZTools_0&&i.currentFZTools_1&&i.isNotTools){var u=Bi.getIndex(i.goodsGrid_tar_equip.bindData.goodsId);gR.ins.zsLv>=Bi.MODEL.flyLevel(u)&&(i.btn_compose.showTip=!0)}}},i.onGetPathEvent=function(e){var t;t=Bi.getIndex(400001),Bi.MODEL.achieving(t)?Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:400001}):this._achieves&&this._achieves.removeSelf()},i.onSelectedEvent=function(e){this.parts.indexOf(this.currentPart)!=e&&(this.uuid_arr=[],this.clearFuZhuTools(),this.currentPart=this.parts[e],this.updateByVSC({part:this.currentPart}))},i.refreshPanel=function(e){this.clearFuZhuTools(),this.showMainTool(this.currentPart),this.effSuccess=kB.createEffect("jm1333",400,640,this),this.updateByVSC({part:this.currentPart}),this.btn_compose.showTip=!1},i.clearFuZhuTools=function(){var e=this;e.currentFZTools_0&&e.currentFZTools_0.parent&&(e.currentFZTools_0.parent.removeChild(e.currentFZTools_0),e.currentFZTools_0=null,e.txt_tool_0.text=""),e.currentFZTools_1&&e.currentFZTools_1.parent&&(e.currentFZTools_1.parent.removeChild(e.currentFZTools_1),e.currentFZTools_1=null,e.txt_tool_1.text=""),e.goodsGrid_tar_equip&&e.goodsGrid_tar_equip.parent&&(e.goodsGrid_tar_equip.parent.removeChild(e.goodsGrid_tar_equip),e.goodsGrid_tar_equip=null,e.txt_tar_name.text="")},i.onClickToolsEvent=function(e,t){t.target==this.img_tool_0?this.currentClick=0:t.target==this.img_tool_1?this.currentClick=1:this.currentClick=e,Tu.sendToModule("OPEN_MO_EQUIP_SELECT",["modules.actor.ActorModule"],{func:"compose",position:parseInt(this.materialPositions[this.currentClick]),minLevel:this.minStarLevel,arr:this.uuid_arr,type:1})},i.onComposeEvent=function(e){if(null!=this.currentFZTools_0&&null!=this.currentFZTools_1)if(0!=this.isNotTools){var t=Bi.getIndex(this.goodsGrid_tar_equip.bindData.goodsId);gR.ins.zsLv<Bi.MODEL.flyLevel(t)?zB.ins.showMsg(RP.n[562],1):this.moData.reqComposeMoEquip(gR.ins.currentSelectRoleIndex+1,this.goodsGrid_tar_equip.bindData.goodsId,this.uuid_arr)}else zB.ins.showMsg(RP.n[561],1);else zB.ins.showMsg(RP.n[560],1)},i.showAttr=function(e,t,i,n){var s;e.graphics.clear();for(var o=aa.formatAttrToChineseByList(t),a=yc.getRes(_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzjbd.png")),r=(yc.getRes(_r.getAtlasSubPath("ase_ui2/ty_bq_ss.png")),o.length,0);r<o.length;r++){s=o[r];var l=1+250*(r%2),c=2+39*Math.floor(r/2);e.graphics.drawTexture(a,l,c,210,34),e.graphics.fillText(s.addName+": ",14+l,4+c,"24px SimHei","#90877b","left"),e.graphics.fillText(s.val+"",83+l,4+c,"24px SimHei",i,"left")}},i.showAttr2=function(e,t,i,n,s){var o;void 0===s&&(s=!0),e.graphics.clear();var a=5,r=5,l=5,c=aa.formatAttrToChineseByList(t),u=yc.getRes(_r.getAtlasSubPath("basic_ui_g/ty_ts_dk.png")),d=yc.getRes(_r.getAtlasSubPath("ase_ui2/ty_bq_ss.png"));if(0<c.length){var h=c.length;3<=h?(l=-10,4==h&&(l=-20),r=39):2==h&&(l=20,r=40),n&&(i="#01fb01");for(var _=0;_<c.length;_++)s?e.graphics.drawTexture(u,a,l,270,34):(e.graphics.drawTexture(u,a,l,110,34),e.graphics.drawTexture(d,a+85,l+1,23,28)),o=c[_],s&&(e.graphics.fillText(o.addName+": ",a,l+2,"24px SimHei","#90877b","left"),a+=22*mp.getStringLength(o.addName+": ")>>1),e.graphics.fillText(o.val+"",a+5,l+2,"24px SimHei",i,"left"),a+=22*mp.getStringLength(o.val)>>1,l+=r,a=5}},i.showMainTool=function(e){var t=this,i=$i.MODEL.tarMagicId(t.moData.getMoEquipGoodsIDByPart(e)),n=t.moData.getMoNeishiCompose(i);t.minStarLevel=$i.MODEL.minLevel(n);var s,o,a,r=$i.MODEL.materialConsumption(n),l=JSON.parse(r),c=[],u=0,d=0,h=0;for(u=0;u<l.length;u++){var _=l[u].value.split(":"),f=parseInt(_[0]),p=parseInt(_[1]);s=yB.create(f,p),t.currentMainTools.length>u?a=t.currentMainTools[u]:(a=new Qj,t.currentMainTools.push(a)),s instanceof protos.backpack.DtoEquip?c.push(!0):c.push(p<=TR.ins.getGoodsNum(f)),s=yB.create(f,p),a.pos(230+70*u,580),null==a.parent&&t.addChild(a),c.push(p<=TR.ins.getGoodsNum(f)),d=Bi.getIndex(f),h=Bi.MODEL.colourId(d),(o=new Object).dto=s,o.needNum=p,o.name=Bi.MODEL.name(d),o.color=ms.getByQuality(h),a.data=o}if(t.currentMainTools.length>u)for(;u<t.currentMainTools.length;u++)(a=t.currentMainTools[u])&&a.parent&&a.removeSelf();for(t.isNotTools=!0,u=0;u<c.length;u++)if(0==c[u]){t.isNotTools=!1;break}},i.getSelectedIndexBypart=function(e){},i.onListRender=function(e,t){e.box_select.visible=t==this.list_equips.selectedIndex,e.btn_click.label="天魔"+la.getName(this.parts[t])},i.updateList=function(e){for(var t=this.parts.indexOf(e),i=0;i<this.parts.length;i++){var n=this.list_equips.getCell(i);n.box_select.visible=t==i,n.btn_click.labelColors=t==i?"#b5a998":"#756c60",n.btn_click.label="天魔"+la.getName(this.parts[i])}},t.COMPOSE_GOODSID=400001,t}(),RX=function(e){function t(){var e=this;e.currentFZToolIndex=0,e.currentMainTools=[],e.currentFZTools_0=null,e.currentFZTools_1=null,e.uuid_arr=[],e.currentTarget=null,e.moData=null,e.minStarLevel=0,e._achieves=null,e.isNotTools=!1,e.currentPart=0,e.effSuccess=null,e.effCompose=null,e.effectId=null,e.materialPositions=null,t.__super.call(e),e.moData=_R.ins}b(t,"modules.actor.views.mo.MoEquipMainComV",Fu);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.img_tools_0.on("click",t,t.onGetToolsEvent,[-1]),t.img_tools_1.on("click",t,t.onGetToolsEvent,[-1]),t.btn_hecheng.on("click",t,t.onGetComposeEvent),t.txt_get.on("click",t,t.onGetToolsPathEvent),t.txt_get0.on("click",t,t.onGetToolsPathEvent),t.btn_close.on("click",t,t.onClosePanelEvent),t.uuid_arr=[]},i.onRemove=function(e){var t=this;for(ui.ViewBase.prototype.onRemove.call(t,e),t.img_tools_0.off("click",t,t.onGetToolsEvent),t.img_tools_1.off("click",t,t.onGetToolsEvent),t.btn_hecheng.off("click",t,t.onGetComposeEvent),t.txt_get.off("click",t,t.onGetToolsPathEvent),t.txt_get0.off("click",t,t.onGetToolsPathEvent),t.btn_close.off("click",t,t.onClosePanelEvent),t.materialPositions=null;t.currentMainTools&&0<t.currentMainTools.length;){var i=t.currentMainTools.shift();i.removeSelf(),i=null}t.uuid_arr=[],t.effSuccess&&(t.effSuccess.parent&&t.effSuccess.parent.removeChild(t.effSuccess),t.effSuccess.dispose(),t.effSuccess=null),t.effCompose&&(t.effCompose.parent&&t.effCompose.parent.removeChild(t.effCompose),t.effCompose.dispose(),t.effCompose=null)},i.updateByVSC=function(e){var t=this;if(t.txt_src_0.text=t.txt_src_1.text=t.txt_src_2.text="",e&&e.hasOwnProperty("part")){t.currentPart=e.part;var i,n,s=t.moData.hasEquipByPosition(e.part),o=68==e.part?1:2,a=0,r=0;if(0==s)a=t.moData.getMoWeaponAndClothes(o,0),n="jm1330";else if(n=(i=_R.ins.getPart(e.part)).magicStarLevel<3?"jm1331":"jm1347",-1==(a=t.moData.getMoWeaponAndClothes(o,i.goodsId)))return void hN.ins.close("MO_EQUIP_MAIN_COMPOSE");null==t.currentTarget&&(t.currentTarget=new MF(135)),null==t.currentTarget.parent&&t.addChild(t.currentTarget),t.currentTarget.pos(t.img_target.x+23,t.img_target.y+18);var l=$i.MODEL.tarMagicId(a);t.currentTarget.bindData=yB.create(l,1),t.txt_tar_name.text=Bi.MODEL.name(Bi.getIndex(l)),t.txt_tar_name.color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(l))),t.minStarLevel=$i.MODEL.minLevel(a);var c,u,d,h=$i.MODEL.materialConsumption(a),_=JSON.parse(h),f=[],p=_.length;for(r=0;r<p;r++){var g=_[r].value.split(":"),v=parseInt(g[0]),m=parseInt(g[1]);c=_R.isMoEquipByGoodsID(v)?KH.create(v,m):yB.create(v,m),t.currentMainTools.length>r?u=t.currentMainTools[r]:(u=new Qj,t.currentMainTools.push(u)),c instanceof protos.backpack.DtoEquip?f.push(!0):f.push(m<=TR.ins.getGoodsNum(v));var y=Bi.getIndex(v),I=Bi.MODEL.colourId(y);(d=new Object).dto=c,d.needNum=m,d.name=Bi.MODEL.simpleName(y),d.color=ms.getByQuality(I),u.data=d;var b=1==p?122:33+90*r;u.pos(b,423),u.name="imgTools_"+r,null==u.parent&&t.addChild(u),u.scale(.8,.8)}if(t.currentMainTools.length>r)for(;r<t.currentMainTools.length;r++)(u=t.currentMainTools[r])&&u.parent&&u.removeSelf();for(t.isNotTools=!0,r=0;r<f.length;r++)if(0==f[r]){t.isNotTools=!1;break}var w,x=$i.MODEL.materialPosition(a);if(t.txt_get0.visible=4<=$i.MODEL.minLevel(a),t.materialPositions=x.split(","),null==t.currentFZTools_0){var S=parseInt(t.materialPositions[0]),k=$i.MODEL.minLevel(a),E=_R.ins.getMaterialEquips(S,k);t.img_red_0.visible=0<E.length,w=la.getName(S),t.txt_tools_0.text=k+"星"+w,t.txt_tools_0.color="#ff0000"}if(null==t.currentFZTools_1){var T=parseInt(t.materialPositions[1]),C=$i.MODEL.minLevel(a),L=_R.ins.getMaterialEquips(T,C);t.img_red_1.visible=0<L.length,w=la.getName(T),t.txt_tools_1.text=C+"星"+w,t.txt_tools_1.color="#ff0000"}t.effectId!=n&&(t.effCompose&&(t.effCompose.parent&&t.effCompose.parent.removeChild(t.effCompose),t.effCompose.dispose(),t.effCompose=null),t.effCompose=kB.createEffect(n,300,320),t.effectId=n,t.addChildAt(t.effCompose,4))}},i.refreshPanel=function(e){var t=this;t.currentFZTools_0&&t.currentFZTools_0.parent&&(t.currentFZTools_0.parent.removeChild(t.currentFZTools_0),t.currentFZTools_0=null,t.txt_tools_0.text=""),t.currentFZTools_1&&t.currentFZTools_1.parent&&(t.currentFZTools_1.parent.removeChild(t.currentFZTools_1),t.currentFZTools_1=null,t.txt_tools_1.text="");var i=new Object;i.part=t.currentPart,t.updateByVSC(i),t.effSuccess=kB.createEffect("jm1333",t.width/2,t.height/2,t),t.btn_hecheng.showTip=!1},i.refreshTools=function(e){var t=this,i=0,n=0;if(null!=e&&(0==t.currentFZToolIndex?(t.uuid_arr[0]=e.uuId,null==t.currentFZTools_0&&(t.currentFZTools_0=new MF(93)),t.currentFZTools_0.bindData=e,null==t.currentFZTools_0.parent&&t.addChild(t.currentFZTools_0),t.currentFZTools_0.pos(t.img_tools_0.x,t.img_tools_0.y),i=Bi.getIndex(e.goodsId),n=Bi.MODEL.colourId(i),t.txt_tools_0.text=Bi.MODEL.simpleName(i),t.txt_tools_0.color=ms.getByQuality(n),t.currentFZTools_0.clickHandler=ql.create(t,t.onGetToolsEvent,[0]),t.currentFZTools_0.scale(.8,.8),t.img_red_0.visible=!1):1==t.currentFZToolIndex&&(t.uuid_arr[1]=e.uuId,null==t.currentFZTools_1&&(t.currentFZTools_1=new MF(93)),t.currentFZTools_1.bindData=e,null==t.currentFZTools_1.parent&&t.addChild(t.currentFZTools_1),t.currentFZTools_1.pos(t.img_tools_1.x,t.img_tools_1.y),i=Bi.getIndex(e.goodsId),n=Bi.MODEL.colourId(i),t.txt_tools_1.text=Bi.MODEL.simpleName(i),t.txt_tools_1.color=ms.getByQuality(n),t.currentFZTools_1.clickHandler=ql.create(t,t.onGetToolsEvent,[1]),t.currentFZTools_1.scale(.8,.8),t.img_red_1.visible=!1),t.btn_hecheng.showTip=!1,t.currentFZTools_0&&t.currentFZTools_1&&t.isNotTools)){var s=Bi.getIndex(t.currentTarget.bindData.goodsId);gR.ins.zsLv>=Bi.MODEL.flyLevel(s)&&(t.btn_hecheng.showTip=!0)}},i.onGetToolsEvent=function(e,t){var i=!1;t.target==this.img_tools_0?this.currentFZToolIndex=0:t.target==this.img_tools_1?this.currentFZToolIndex=1:(this.currentFZToolIndex=e,i=!0),Tu.sendToModule("OPEN_MO_EQUIP_SELECT",["modules.actor.ActorModule"],{func:"compose",position:parseInt(this.materialPositions[this.currentFZToolIndex]),minLevel:this.minStarLevel,isSelected:i,arr:this.uuid_arr,type:1})},i.onGetToolsPathEvent=function(e){var t=0,i=0;e.target==this.txt_get?(t=Bi.getIndex(400002),i=400002):e.target==this.txt_get0&&(t=Bi.getIndex(400003),i=400003),Bi.MODEL.achieving(t)?Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:i}):this._achieves&&this._achieves.removeSelf()},i.onGetComposeEvent=function(e){if(null!=this.currentFZTools_0&&null!=this.currentFZTools_1)if(0!=this.isNotTools){var t=Bi.getIndex(this.currentTarget.bindData.goodsId);gR.ins.zsLv<Bi.MODEL.flyLevel(t)?zB.ins.showMsg(RP.n[562],1):this.moData.reqComposeMoEquip(gR.ins.currentSelectRoleIndex+1,this.currentTarget.bindData.goodsId,this.uuid_arr)}else zB.ins.showMsg(RP.n[561],1);else zB.ins.showMsg(RP.n[560],1)},i.onClosePanelEvent=function(e){hN.ins.close("MO_EQUIP_MAIN_COMPOSE")},t.COMPOSE_GOODSID=400002,t.COMPOSE_GOODSID_1=400003,t}(),NX=function(e){function t(){var e=this;e._selector=null,e._lbox=null,e._rbox=null,e._sbox=null,e.effStar=null,e.effLevel=null,e.S_GAP_Y=53,e.GAP_Y=43,e.eItem=null,e.g_items=null,e.costArr=null,e.isFull=!1,e.isActive=!1,e.curPage=0,e.MAX_PAGE=5,e.index=0,e.curLvl=0,e.curStar=0,e.lastLvl=0,e.t_sy=[92,72,62],t.__super.call(e),e.centerX=e.centerY=0}b(t,"modules.actor.views.mo.MoEquipAdvancedV",Xm);var i=t.prototype;return i.initialize=function(){this._selector=new Nj,this._selector.redptHandler=ql.create(this,this.updateSelectorRedpt,null,!1),this.addChild(this._selector)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.g_full.visible=t.sp_a.visible=!1,t._selector.on("select",t,t.onRoleHandler),t.btn_advanced.showTip=!1,t.btn_left.on("click",t,t.onClickHandler),t.btn_right.on("click",t,t.onClickHandler),t.btn_advanced.on("click",t,t.onClickHandler),t.curPage=0,t._selector.selectIdx=gR.ins.currentSelectRoleIndex,t.setEquit()},i.onRemove=function(e){var t=this;if(ui.ViewBase.prototype.onRemove.call(t,e),t.clearStarEff(),t._sbox&&t._sbox.graphics.clear(),t._lbox&&t._lbox.graphics.clear(),t._rbox&&t._rbox.graphics.clear(),t._selector.off("select",t,t.onRoleHandler),t.btn_left.off("click",t,t.onClickHandler),t.btn_right.off("click",t,t.onClickHandler),t.btn_advanced.off("click",t,t.onClickHandler),t.g_items&&t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}t.eItem&&(t.eItem.parent&&t.eItem.parent.removeChild(t.eItem),t.eItem.destroy(),t.eItem=null)},i.updateByVSC=function(e){this._selector.invalid(),e&&(e instanceof protos.actor.toc_30615?this.setEquit(!0):(this._selector.selectIdx=gR.ins.currentSelectRoleIndex,this.curPage=_R.getAdPosIndex(e.part),this.setEquit()))},i.setEquit=function(e){var t=this;void 0===e&&(e=!1),t.btn_left.visible=0<t.curPage,t.btn_right.visible=t.curPage<t.MAX_PAGE;var i=_R.ins.getEquipByPosition(_R.A_EquipPart[t.curPage],t._selector.selectIdx+1);t.isActive=null!=i,t.btn_advanced.label=t.isActive?"进 阶":"激 活",i?(t.index=_R.getAdvanceIndexByGid(i.goodsId),t.curStar=en.MODEL.start(t.index),t.curLvl=en.MODEL.level(t.index)):(t.index=_R.getAdvanceIndex(t.curPage),i=KH.create(en.MODEL.modelId(t.index)),t.curStar=t.curLvl=0),t.isFull=_R.getIsAdvanceFull(t.index),t.g_full.visible=t.isFull,t.sp_a.visible=!t.isFull,t.isActive?(t.eItem||(t.eItem=new MF,t.eItem.pos(301,400),t.addChild(t.eItem)),t.eItem.bindData=i,t.eItem.visible=!0,t.img_lock.skin=""):(t.eItem&&(t.eItem.visible=!1),t.img_lock.skin="ui/layouts/actormo/ty_jm_gz_locked.png");var n=Bi.getIndex(i.goodsId);t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(n)),t.txt_name.changeText(Bi.MODEL.name(n)),t.showAttrs(),t.sp_a.visible&&t.setCost(t.isActive?t.index+1:t.index),e?t.setStar(t.lastLvl>t.curLvl):t.showLevel(),t.lastLvl=t.curLvl,e&&(t.effLevel=kB.createEffect("jm1332",360,640,t))},i.setCost=function(e){var t=this;t.costArr=[];var i=0,n=yh.getObj(en.MODEL.materialConsumption(e));for(i=0;i<n.length;i++){var s=n[i].value.split(":");t.costArr.push({goodsId:parseInt(s[0]),goodsNum:parseInt(s[1])})}for(t.g_items=t.g_items||[],i=0;i<2;i++)if(t["sp_"+i].visible=i<t.costArr.length,t["sp_"+i].visible){if(!t.g_items[i]){var o=new MF(45);o.isShowSmallIcon=!0,o.needGridBg=!1,o.needEffect=!1,o.pos(0<i?0:66,-1),t["sp_"+i].addChild(o),t.g_items.push(o)}var a=yB.create(t.costArr[i].goodsId);t.g_items[i].bindData=a,t.g_items[i].visible=!0,t["txt_cost_"+i].innerHTML=t.getStr(TR.ins.getGoodsNum(t.costArr[i].goodsId),t.costArr[i].goodsNum)}else t.g_items[i]&&(t.g_items[i].visible=!1);t.btn_advanced.showTip=t.isRedPoint,t.sp_0.x=1<t.costArr.length?122:230},i.getStr=function(e,t){return t<=e?Ql.createColor(e.toString(),"#23b11f")+"/"+t:Ql.createColor(e.toString(),"#ff2e24")+"/"+t},i.onRoleHandler=function(){gR.ins.currentSelectRoleIndex=this._selector.selectIdx,this.setEquit()},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_left:if(t.curPage<=0)return;t.curPage--,t.setEquit();break;case t.btn_right:if(t.curPage>=t.MAX_PAGE)return;t.curPage++,t.setEquit();break;case t.btn_advanced:if(!t.isEnoughTool)return void zB.ins.showMsg(RP.n[566],1);for(var i=[],n=0;n<t.costArr.length;n++)i.push(t.costArr[n].goodsId);_R.reqMoEquipAdvanced(t._selector.selectIdx+1,en.MODEL.position(t.index),i)}},i.showAttrs=function(){var e=this;e.fightNum.value=e.isActive?RR.getFight(JSON.parse(en.MODEL.attr(e.index))):0;var t=aa.formatAttrToChineseByList(en.MODEL.attr(e.index));if(e._lbox||(e._lbox=new dt,e._lbox.pos(75,683),e.addChild(e._lbox)),e._lbox.graphics.clear(),e.drawAttrs(e._lbox,t),e._lbox.x=e.isFull?225:75,e.g_arrow.visible=!e.isFull,e.isFull)e._rbox&&e._rbox.graphics.clear();else{var i=aa.formatAttrToChineseByList(en.MODEL.attr(e.index+1));e._rbox||(e._rbox=new dt,e._rbox.pos(376,683),e.addChild(e._rbox)),e._rbox.graphics.clear(),e.drawAttrs(e._rbox,i,!0)}},i.drawAttrs=function(e,t,i){if(void 0===i&&(i=!1),e&&t&&!(t.length<1)){e.graphics.fillText(i?"下级属性":RP.n[567],78,0,RP.n[568],"#e0d6c1","left"),e.graphics.drawTextures(this.getTexture(!0),[0,35]);for(var n=0;n<t.length;n++)e.graphics.drawTextures(this.getTexture(),[1,this.t_sy[t.length-2]-5+this.GAP_Y*n]),e.graphics.fillText(t[n].addName+"： ",40,this.t_sy[t.length-2]+this.GAP_Y*n,"24px SimHei","#90877b","left"),e.graphics.fillText(i||this.isActive?t[n].val:"0",232,this.t_sy[t.length-2]+this.GAP_Y*n,"24px SimHei",i?"#23b11f":"#90877b","right")}},i.getTexture=function(e){var t;return void 0===e&&(e=!1),t=e?_r.getAtlasSubPath("basic_ui/ty_tips_fgx.png"):_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzd.png"),G.loader.getRes(t)},i.showLevel=function(){var e=this;e._sbox&&e._sbox.graphics.clear(),e._sbox||(e._sbox=new dt,e._sbox.pos(0,0),e.box_star.addChild(e._sbox)),e._sbox.graphics.clear();for(var t=0;t<5;t++)e._sbox.graphics.drawTextures(e.getStarTexture(t<e.curStar),[t*e.S_GAP_Y,0])},i.getStarTexture=function(e){var t;return t=e?_r.getAtlasSubPath("base_ui2/g_level_"+this.curLvl+"_0.png"):_r.getAtlasSubPath("base_ui2/g_level_"+this.curLvl+"_1.png"),G.loader.getRes(t)},i.setStar=function(e){var t=this;if(t.clearStarEff(),t.showLevel(),0!=t.curStar&&!t.effStar){var i="";switch(t.curLvl){case 0:i="jm1217";break;case 1:i="jm1348";break;case 2:i="jm1349"}t.effStar=kB.createEffect(i,(e?5:t.curStar)*t.S_GAP_Y+t._sbox.x-31.5,t._sbox.y+23,t.box_star)}},i.clearStarEff=function(){var e=this;e.effStar&&(e.effStar.parent&&e.effStar.parent.removeChild(e.effStar),e.effStar.dispose(),e.effStar=null),e.effLevel&&(e.effLevel.parent&&e.effLevel.parent.removeChild(e.effLevel),e.effLevel.dispose(),e.effLevel=null)},i.updateSelectorRedpt=function(e){var t=0,i=!1;for(t=0;t<la.MO_SPECIAL_EQUIPS.length;t++){var n=la.MO_SPECIAL_EQUIPS[t],s=_R.ins.isMaxStarLevel(n,e.id);if(i=_R.canAdvance(s,n,e.id))break}return i},p(0,i,"isRedPoint",function(){if(this.isFull)return!1;for(var e=0;e<this.costArr.length;e++)if(TR.ins.getGoodsNum(this.costArr[e].goodsId)<this.costArr[e].goodsNum)return!1;return!0}),p(0,i,"isEnoughTool",function(){if(!this.costArr||this.costArr.length<1)return!1;for(var e=0;e<this.costArr.length;e++)if(TR.ins.getGoodsNum(this.costArr[e].goodsId)<this.costArr[e].goodsNum)return!1;return!0}),t}(),BX=function(e){function t(){this.m_uId=0,this.g_item=null,this.decoratePosition=0,this.func="",this.state=0,t.__super.call(this),this.btn_change.label="选择"}b(t,"modules.actor.views.mo.MoEquipSelectorItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_change.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_change.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){if(1!=this.state){if(this.func&&""!=this.func)Tu.sendToModule("SELECTOR_COMPOSE_ITEM_CLICKED",["modules.actor.ActorModule"],this.dataSource);else{var t=this.dataSource,i=_R.ins.getEquipByPosition(t.decoratePosition,gR.ins.currentSelectRoleIndex+1);i&&t.magicStarLevel<i.magicStarLevel?KQ.ins.show(RP.n[570],ql.create(this,this.onReplaceAlertHandler,[this.dataSource]),!1):Tu.sendToModule("SELECTOR_ITEM_CLICKED",["modules.actor.ActorModule"],this.dataSource)}hN.ins.close("MO_EQUIP_SELECTOR"),UB.ins.playSound("5")}else zB.ins.showMsg(RP.n[569],1)},i.onReplaceAlertHandler=function(e,t){1==t&&Tu.sendToModule("SELECTOR_ITEM_CLICKED",["modules.actor.ActorModule"],e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.btn_change.label="选 择",e){var i;e instanceof protos.backpack.DtoEquip?i=e:e.dto instanceof protos.backpack.DtoEquip&&(i=e.dto,t.func=e.func),G.superSet(qu,t,"dataSource",i);var n=i==HX.dto&&_R.ins.isBetter(i);if(t.box_recommend.visible=n,t.txt_zs.visible=!1,t.btn_change.visible=!0,i)switch(t.decoratePosition=i.decoratePosition,HX.type){case 0:var s=_R.ins.hasEquipByPosition(t.decoratePosition);if(t.btn_change.label=s?"更换":"选择",gR.ins.zsLv<i.flyLevel){var o=i.flyLevel+RP.n[571];t.txt_zs.text=o,t.txt_zs.visible=!0,t.btn_change.visible=!1}}var a=0;if(i?(a=i.moEquipScore,t.m_uId=i.uuId,t.g_item||(t.g_item=new MF,t.gridBox.addChild(t.g_item)),t.g_item.bindData=i,t.fightNum.value=_R.ins.getEquipFighting(i)+"",t.txt_name.text=i.name):(t.m_uId=0,t.decoratePosition=0,t.g_item&&(t.g_item.bindData=null)),t.lab_score.text=RP.n[572]+a,t.state=0,null!=e.arr)-1!=e.arr.indexOf(i.uuId)&&(t.btn_change.label="已选择",t.state=1)}}),t}(qu),HX=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.actor.views.mo.MoEquipSelector",ju);var i=t.prototype;return i.init=function(){this.list.itemRender=BX,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,iu.optimizeList(this.list,BX)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t),t.txt_no.visible=!1,t.btn_close.on("click",t,t.onClickHandler),t.list.scrollBar.on("change",t,t.onScrollChanged),t.list.scrollBar.on("end",t,t.onScrollEnd)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),modules.actor.views.mo.MoEquipSelector.dto=null,t.btn_close.off("click",t,t.onClickHandler),t.list.scrollBar.off("change",t,t.onScrollChanged),t.list.scrollBar.off("end",t,t.onScrollEnd)},i.updateData=function(e){var t=this,i=0;e&&e.type&&(i=e.type);var n=[];e&&0<e.position&&(e.hasOwnProperty("arr")||(e.arr=null),e.hasOwnProperty("func")||(e.func=""),e.position);var s=gR.ins.currentSelectRoleIndex+1;switch(modules.actor.views.mo.MoEquipSelector.type=i){case 0:if(t.img_title.skin="ui/layouts/actormo/mz_text_xxzb.png",t.txt_no.text=RP.n[573],e&&0<e.position){_R.ins.hasEquipByPosition(e.position)?(t.box_current.visible=!0,t.setMyEquipInfo(e.position)):(t.list.y=95,t.list.height=735,t.box_current.visible=!1);var o=_R.ins.getEquipsByPositionInBag(e.position,s,!0);e.except&&(o=t.filterData(o,e.except)),n=o.sort(t.sortByScoreD),n=t.sortByLimit(n),t.box_tips.visible=!1}break;case 1:if(t.img_title.skin="ui/layouts/actormo/mz_text_xxfc.png",t.txt_no.text=RP.n[574],t.list.y=95,t.list.height=735,e&&0<e.position){var a=_R.ins.getMaterialEquips(e.position,e.minLevel,e.arr,e.func);e.except&&(a=t.filterData(a,e.except)),n=a.sort(t.sortByScoreU)}t.box_current.visible=!1,t.box_tips.visible=!0}0<(t.list.array=n).length&&(modules.actor.views.mo.MoEquipSelector.dto=n[0]),t.txt_no.visible=n.length<1},i.sortByScoreD=function(e,t){var i=null!=e.dto?e.dto:e;return(null!=t.dto?t.dto:t).moEquipScore-i.moEquipScore},i.sortByScoreU=function(e,t){var i=null!=e.dto?e.dto:e,n=null!=t.dto?t.dto:t;return i.moEquipScore-n.moEquipScore},i.sortByLimit=function(e){for(var t=[],i=[],n=0;n<e.length;n++){var s=e[n];gR.ins.zsLv>=s.flyLevel?t.push(s):i.push(s)}return t.concat(i)},i.filterData=function(e,t){if(!t||0==t.length)return e;for(var i=[],n=0;n<e.length;n++){var s=e[n].uuId;t.indexOf(s)<0&&i.push(e[n])}return i},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){},i.setMyEquipInfo=function(e){var t,i=_R.ins.getPart(e),n=0;i?(n=i.moEquipScore,i.uuId,i.decoratePosition,t||(t=new MF,this.item_now.gridBox.addChild(t)),t.bindData=i,this.item_now.fightNum.value=_R.ins.getEquipFighting(i)+"",this.item_now.txt_name.text=i.simpleName,this.item_now.img_recommend.skin="ui/layouts/actormo/mz_yq_dqzb.png",this.item_now.img_recommend.x=-3,this.item_now.img_recommend.y=-4,this.item_now.box_recommend.visible=!0):t&&(t.bindData=null),this.item_now.lab_score.text=RP.n[575]+n,this.item_now.btn_change.visible=!1},i.onScrollEnd=function(){this.list.scrollBar.value==this.list.scrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},t.dto=null,t.type=0,t}(),VX=function(e){function o(){var e=this;e._selector=null,e.hash=null,e.avatar=null,e.eff=null,e.effChuanShi=null,e._suitData=null,e._effMabi=null,e._effHushen=null,e._mabiRingRetpt=null,e._hushenRingRetpt=null,e.skillsRPArr=null,e.gridsRPArr=null,e.tipBtnRPArr=null,e.parts=null,e.goodsObj=null,e.btnStates={},e._delayRun=!1,this.nextUnlockPosValue=0,this._effUnlock=null,o.__super.call(this),this.parts=la.MO_SIMPLE_EQUIPS.concat(la.MO_SPECIAL_EQUIPS),this.goodsObj={};for(var t=0;t<this.parts.length;t++){var i=this.parts[t],n=this["p"+i],s=new MF;s.mouseEnabled=!1,s.mouseThrough=!0,n.box_sp.addChild(s),this.goodsObj[i]=s}this.skillsRPArr=[!1,!1,!1],this.gridsRPArr=[!1,!1,!1],this.tipBtnRPArr=[{},{},{}],this.inteUI()}b(o,"modules.actor.views.mo.MoEquipV",Yu);var t=o.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.inteUI=function(){var e=this;e._suitData=RN.ins,e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.updateSelectorRedpt,null,!1),e.addChild(e._selector),e.avatar=new CF,e.avatar.pos(-340,344),e.addChildAt(e.avatar,4),e.setChildIndex(e.fight_item,e.numChildren-1),e.initSkill(),e.showByVSC(null,null)},t.initSkill=function(){for(var e=_R.ins.skillIDs,t=0;t<5;t++){var i=e[t],n=Ls.getIndex(i),s=new sQ;s.dataSource={id:0,activeNum:0,showTween:!0},s.pos(130*t,-10),this.box_skill.addChild(s),s.icon_skill.skin=_r.getIconPath(Ls.MODEL.icon(n))}var o=this._selector.selectIdx+1;this.updateSkills(o)},t.addEvents=function(){var e=this;e.btn_info.on("click",e,e.showInfo),e._selector.on("select",e,e.onSelect);for(var t=0;t<e.parts.length;t++){var i=e["p"+e.parts[t]];i.img_in.on("click",e,e.onGridClicked),i.txt_word.on("click",e,e.getEquip)}e.img_skill_0.on("click",e,e.onSkillClicked),e.img_skill_1.on("click",e,e.onSkillClicked),e.img_skill_2.on("click",e,e.onSkillClicked),e.img_skill_3.on("click",e,e.onSkillClicked),e.img_skill_4.on("click",e,e.onSkillClicked)},t.removeEvents=function(){var e=this;e.btn_info.off("click",e,e.showInfo),e._selector.off("select",e,e.onSelect),e.img_skill_0.off("click",e,e.onSkillClicked),e.img_skill_1.off("click",e,e.onSkillClicked),e.img_skill_2.off("click",e,e.onSkillClicked),e.img_skill_3.off("click",e,e.onSkillClicked),e.img_skill_4.off("click",e,e.onSkillClicked);for(var t=0;t<e.parts.length;t++){var i=e["p"+e.parts[t]];i.img_in.off("click",e,e.onGridClicked),i.txt_word.off("click",e,e.getEquip)}},t.onGridClicked=function(e){var t=e.target;_R.ins.curStatus=t.status;var i=parseInt(t.parent.name);switch(_R.ins.curPosition=i,Zj.instance.tipBtnRPArr=this.tipBtnRPArr[this._selector.selectIdx][i],t.status){case 0:var n=tn.getIndex(_R.ins.curPosition-67),s=tn.MODEL.description(n);zB.ins.playNoticeMsg(s);break;case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 12:case 13:Zj.instance.show(null);break;case 7:case 11:_R.ins.selectorType=1,Tu.sendToModule("OPEN_MO_EQUIP_SELECT",["modules.actor.ActorModule"],{position:i,minLevel:0,type:0})}},t.onSkillClicked=function(e){var t=e.target,i=_R.ins.skillConfigIndexs;switch(t){case this.img_skill_0:Jj.instance.show(i[0],gR.ins.currentSelectRoleIndex+1);break;case this.img_skill_1:Jj.instance.show(i[1],gR.ins.currentSelectRoleIndex+1);break;case this.img_skill_2:Jj.instance.show(i[2],gR.ins.currentSelectRoleIndex+1);break;case this.img_skill_3:Jj.instance.show(i[3],gR.ins.currentSelectRoleIndex+1);break;case this.img_skill_4:Jj.instance.show(i[4],gR.ins.currentSelectRoleIndex+1)}},t.getEquip=function(e){e.target.canTouch&&(IN.isOpenMagicTower?hN.ins.open("MAGIC_VIEW"):zB.ins.playErrorMsg(RP.n[576]))},t.hideByVSC=function(e,t){this.removeEvents(),this._effMabi&&(this._effMabi.removeSelf(),this._effMabi.dispose(),this._effMabi=null),this._effHushen&&(this._effHushen.removeSelf(),this._effHushen.dispose(),this._effHushen=null)},t.showByVSC=function(e,t){this.addEvents(),this._selector.selectIdx=gR.ins.currentSelectRoleIndex,this.updateByVSC(null)},t.updateByVSC=function(e){this.tipBtnRPArr[this._selector.selectIdx]={},0==this._delayRun&&(this._delayRun=!0,G.timer.once(200,this,this.update,[e]))},t.update=function(e){var t=this;t._delayRun=!1,t.updateAttr(),t.updateEquips(),t.updateAvatar();var i=t._selector.selectIdx+1;t.updateSkills(i),null!=t._suitData.equipHash&&1<=t._suitData.equipHash.length&&t.showChuanShiEffect(),t._selector.invalid()},t.showChuanShiEffect=function(){var e=this;e.effChuanShi&&(e.effChuanShi.parent&&e.effChuanShi.parent.removeChild(e.effChuanShi),e.effChuanShi=null);var t=e._suitData.getSuitIdByRoleIndex(e._selector.selectIdx+1);if(0<t){var i=RN.ins.getCurSuitPro(3,t);null==e.effChuanShi&&(e.effChuanShi=kB.createEffect(i.cEffct,360,860,e)),e.effChuanShi.scale_X=2,e.effChuanShi.scale_Y=2,e.setChildIndex(e.effChuanShi,1)}},t.updateAttr=function(){this.fight_item.value=_R.ins.getTotalFighting(),this.txt_score.text=RP.n[577]+_R.ins.getRoleEquipsScore()},t.updateSkills=function(e){for(var t=_R.ins.skillConfigIndexs,i=0;i<5;i++){var n=this.box_skill.getChildAt(i),s=nn.MODEL.buffIds(t[i]),o=(Ls.getIndex(s),_R.ins.isSkillActive(s,e),nn.MODEL.positions(t[i])),a=(o.length,nn.MODEL.starLevel(t[i])),r=_R.ins.getActivePartsBySkill(o,a,e).length;n.dataSource={id:0,activeNum:r,showTween:!0}}},t.nextUnlockPos=function(){for(var e=0,t=[],i=0;i<la.MO_SIMPLE_EQUIPS.length;i++){var n=la.MO_SIMPLE_EQUIPS[i],s=_R.getMoEquipKey(this._selector.selectIdx+1,n);if(_R.ins.data30611Hash){var o=_R.ins.data30611Hash.take(s);o&&1!=o.unlocked&&t.push(n)}}var a,r,l=0,c=0;for(i=0;i<t.length;i++)l=tn.getIndex(t[i]-67),null!=(a=tn.MODEL.magicUnlockConditions(l))&&0<a.length&&(r=JSON.parse(a)),r&&(0==c&&(c=parseInt(r[0].value),e=t[i]),r[0].value<c&&(c=parseInt(r[0].value),e=t[i]));this.nextUnlockPosValue=e},t.updateEquips=function(){this._selector.selectIdx;this.nextUnlockPos();for(var e=0;e<this.parts.length;e++){var t=this.parts[e],i=this["p"+t];this.setGridInfo(t,i)}},t.setGridInfo=function(e,t){var i=this,n=_R.getMoEquipKey(i._selector.selectIdx+1,e),s=!1;if(_R.ins.data30611Hash){var o=_R.ins.data30611Hash.take(n);o&&(s=1==o.unlocked)}var a,r=!1,l=i.goodsObj[e];l&&(l.visible=!1),t.img_in.skin="",t.img_in.width=100,t.img_in.height=100,_R.isSpecialMoEquip(e)?s?_R.ins.hasEquipByPosition(e)?(r=_R.ins.isMaxStarLevel(e,i._selector.selectIdx+1),t.img_in.status=r?5:4,a=_R.ins.getPart(e,gR.ins.currentSelectRoleIndex+1),i.setGridIcon(l,a)):(t.img_in.skin=_r.getMoEquipPath("mz_icon_"+_R.ins.setActiveSkin(e)),0<_R.ins.getEquipsByPositionInBag(e,i._selector.selectIdx+1).length?t.img_in.status=3:t.img_in.status=2):(t.img_in.skin=_r.getLayoutsImagePath("actormo/ty_jm_gz_locked.png",!1),t.img_in.status=1,t.img_in.width=56,t.img_in.height=66):s?68==e||69==e?_R.ins.hasEquipByPosition(e)?(r=_R.ins.isMaxStarLevel(e,i._selector.selectIdx+1),t.img_in.status=r?9:8,a=_R.ins.getPart(e,gR.ins.currentSelectRoleIndex+1),i.setGridIcon(l,a)):(t.img_in.skin=_r.getMoEquipPath("mz_icon_"+_R.ins.setActiveSkin(e)),0<_R.ins.getEquipsByPositionInBag(e,i._selector.selectIdx+1).length?t.img_in.status=7:t.img_in.status=6):_R.ins.hasEquipByPosition(e)?(r=_R.ins.isMaxStarLevel(e,i._selector.selectIdx+1),t.img_in.status=r?13:12,a=_R.ins.getPart(e,gR.ins.currentSelectRoleIndex+1),i.setGridIcon(l,a)):(t.img_in.skin=_r.getMoEquipPath("mz_icon_"+_R.ins.setActiveSkin(e)),0<_R.ins.getEquipsByPositionInBag(e,i._selector.selectIdx+1).length?t.img_in.status=11:t.img_in.status=10):(t.img_in.skin=_r.getLayoutsImagePath("actormo/ty_jm_gz_locked.png",!1),t.img_in.status=0,t.img_in.width=56,t.img_in.height=66),i.setGridText(t.txt_word,s,e)},t.setGridText=function(e,t,i){var n,s;if(e.canTouch=!t,e.underline=!t,t)n=la.getName(i),s="#5f5850";else if(this.nextUnlockPosValue==i){var o=tn.getIndex(i-67);n=tn.MODEL.description(o),s="#23b11f"}else e.canTouch=!1,e.underline=!1,n=la.getName(i),s="#5f5850";e.text=n,e.color=s},t.setGridRP=function(e,t){e.img_red.visible=t},t.setGridIcon=function(e,t){e&&(e.visible=!0,e.bindData=t)},t.canCompose=function(){return!1},t.updateAvatar=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e),i=_R.ins.getPanelEffectIdByMagicId(t.magicId);this.avatar.changeAvatar(t.sex,t.wid,t.mid,t.wgid,t.weaponSoulId,t.chuanshiId,i)},t.updateNotice=function(){for(var e,t,i=this,n=i._selector.selectIdx+1,s=gR.ins.actorById(n),o=0,a=!1,r=[],l=0;l<i.parts.length;l++)o=i.parts[l],e=i.hash.take(o),i.needNotify(s,o,r)?(e.p?e.p.visible=!0:(t=kB.createSprite(NI.POINT,e.b.x+85,e.b.y-13,0,0,i),e.p=t),la.isNormal(o)&&(a=!0)):e.p&&(e.p.visible=!1);a?i.eff||(i.eff=kB.createEffect("jm1130",360,910,i),i.eff.scale_X=1.25,i.eff.scale_Y=1.25):(i.eff&&i.eff.dispose(),i.eff=null)},t.onSelect=function(e){gR.ins.currentSelectRoleIndex=this._selector.selectIdx,this.updateByVSC(null)},t.onTip=function(e){},t.needNotify=function(e,t,i){return!!la.isNormal(t)&&MR.ins.hasBetterEquip(e,t,i)},t.setSelectorRedpt=function(){var e=this._selector.selectIdx,t=this.skillsRPArr[e]||this.gridsRPArr[e];this._selector.setRedPtByIdx(e,t)},t.getSelectorRedpt=function(e){var t=e.id-1;return this.skillsRPArr[t]||this.gridsRPArr[t]},t.updateSelectorRedpt=function(e){var t=this,i=e.id-1,n=0,s=!1;for(n=0;n<t.parts.length;n++){var o=t.parts[n],a=t["p"+o],r=t.getGridRP(o,e.id);s=s||r,i==t._selector.selectIdx&&t.setGridRP(a,r)}t.gridsRPArr[i]=s;var l=_R.ins.skillConfigIndexs,c=!1;for(n=0;n<5;n++){var u,d=nn.MODEL.buffIds(l[n]),h=_R.ins.isSkillActive(d,e.id),_=nn.MODEL.positions(l[n]),f=_.length,p=nn.MODEL.starLevel(l[n]),g=_R.ins.getActivePartsBySkill(_,p,e.id).length;u=!h&&f==g,c=c||u,i==t._selector.selectIdx&&(t["img_red_"+n].visible=u)}return t.skillsRPArr[i]=c,t.getSelectorRedpt(e)},t.getGridRP=function(e,t){var i=_R.getMoEquipKey(t,e),n=!1;if(_R.ins.data30611Hash){var s=_R.ins.data30611Hash.take(i);s&&(n=1==s.unlocked)}var o=!1,a=!1;this.tipBtnRPArr[t-1][e]=[];var r=this.tipBtnRPArr[t-1][e],l=!1,c=!1,u=!1;return _R.isSpecialMoEquip(e)?n?(o=null!=_R.ins.getEquipByPosition(e,t),(u=_R.canCompose(e,t))&&r.push("btn_hc"),o?(a=_R.ins.isMaxStarLevel(e,t))||(c=_R.canAdvance(a,e,t))&&r.push("btn_jj"):0<_R.ins.getEquipsByPositionInBag(e,t).length&&(l=_R.canAdvance(!1,e,t))&&r.push("btn_jh")):l=!1:n?68==e||69==e?(o=null!=_R.ins.getEquipByPosition(e,t),(u=_R.canCompose(e,t))&&r.push("btn_hc"),o?(l=_R.ins.hasBetter(e,t))&&r.push("btn_th"):0<_R.ins.getEquipsByPositionInBag(e,t).length&&(l=!0)):(o=null!=_R.ins.getEquipByPosition(e,t))?(l=_R.ins.hasBetter(e,t))&&r.push("btn_th"):0<_R.ins.getEquipsByPositionInBag(e,t).length&&(l=!0):l=!1,l=l||c||u},t.destroy=function(e){void 0===e&&(e=!0),this.parts=null,this.skillsRPArr=null,this.gridsRPArr=null,this.tipBtnRPArr=null,this.goodsObj=null,this._delayRun=!1,G.timer.clear(this,this.update),laya.ui.View.prototype.destroy.call(this,e)},t.showInfo=function(e){hN.ins.open("MO_TIPS_VIEW",gR.ins.currentSelectRoleIndex)},t.createUnlockEff=function(){},t.clearUnlockEff=function(){this._effUnlock&&(this._effUnlock.parent&&this._effUnlock.parent.removeChild(this._effUnlock),this._effUnlock.dispose(),this._effUnlock=null)},o}(),GX=function(e){function t(){this.MAX_NUM=8,this._selector=null,this._equipNames=null,this._curClickGrid=null,this._itemEffs=null,this._eff1448=null,t.__super.call(this),this.init()}b(t,"modules.actor.views.mo.suit.MoEquipSuitV",Wu);var i=t.prototype;return i.init=function(){this._equipNames=[];for(var e=0;e<this.MAX_NUM;e++){var t=this["equip"+la.MO_SIMPLE_EQUIPS[e]];t.g_red.visible=!1,t.g_bg.visible=!1}this._selector=new Nj,this._selector.redptHandler=ql.create(this,this.needRedpt,null,!1),this.addChild(this._selector)},i.showByVSC=function(e,t){for(var i=this,n=0;n<i.MAX_NUM;n++){i["equip"+la.MO_SIMPLE_EQUIPS[n]].on("click",i,i.onClickGrid)}i.btn_gongming.on("click",i,i.onOpenGongMing),i.btn_help.on("click",i,i.onClickWF),i.txt_help.on("click",i,i.onClickWF);var s=ql.create(i,i.setGongMingRP,null,!1);AN.ins.addListener("BTN_SHEN_MO_GONGMING",[262],s),i.setGongMingRP(),i._selector.selectIdx=gR.ins.currentSelectRoleIndex,i._selector.invalid(),i._selector.on("select",i,i.onSelectActor),fR.ins.currentRoleIndex=i._selector.selectIdx+1,fR.ins.reqZhuHunInfo(1),1<gR.ins.actorList.length&&fR.ins.reqZhuHunInfo(2),2<gR.ins.actorList.length&&fR.ins.reqZhuHunInfo(3)},i.addArrow=function(){Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])},i.hideByVSC=function(e,t){for(var i=this,n=0;n<i.MAX_NUM;n++){i["equip"+la.MO_SIMPLE_EQUIPS[n]].off("click",i,i.onClickGrid)}i.btn_gongming.off("click",i,i.onOpenGongMing),i.btn_help.off("click",i,i.onClickWF),i.txt_help.off("click",i,i.onClickWF),i._selector.off("select",i,i.onSelectActor),AN.ins.removeListener("BTN_SHEN_MO_GONGMING"),i._curClickGrid=null,i.clearItemEffect(),null!=i._eff1448&&(i._eff1448.removeSelf(),i._eff1448.dispose()),i._eff1448=null},i.updateByVSC=function(e){e instanceof protos.actor.toc_30623?this.updateView(e):e instanceof protos.actor.toc_30625?this.updateView():e||this.updateView()},i.onSelectActor=function(e){var t=this._selector.selectIdx+1;fR.ins.currentRoleIndex=t,gR.ins.currentSelectRoleIndex=this._selector.selectIdx,fR.ins.hasSuitByActorId(t)?this.updateView():fR.ins.reqZhuHunInfo(t)},i.onOpenGongMing=function(e){UN.isOpenModule?(VN.ins.isFirstShowBtnEff=!1,hN.ins.open("RESONATE_SUB_VIEW",null,0)):zB.ins.showMsg(UN.errorTips,1)},i.setGongMingRP=function(){this.btn_gongming.showTip=AN.ins.getStateByCareList([262])},i.onClickGrid=function(e){var t=e.target,i=t.dataSource;i&&hN.ins.open("MO_ZHUHUN_TIPS",i),this._curClickGrid=t},i.updateView=function(e){var t=this;e&&e.actorId!=t._selector.selectIdx+1||(t.updateEquip(),t.updateFight()),t._selector.invalid(),null!=t._eff1448&&(t._eff1448.removeSelf(),t._eff1448.dispose()),t._eff1448=null,UN.isShowMingBtnEff&&UN.isOpenModule&&(tr.push(RP.n[578]),null==t._eff1448&&(t._eff1448=kB.createEffect("jm1448",t.btn_gongming.width/2,t.btn_gongming.height/2,t.btn_gongming)))},i.updateFight=function(){var e=this._selector.selectIdx+1;this.fightNum.value=fR.ins.getSuitFight(e)},i.updateEquip=function(){var e=this._selector.selectIdx+1;this.clearItemEffect();for(var t=0;t<this.MAX_NUM;t++){var i=la.MO_SIMPLE_EQUIPS[t],n=this["equip"+i];if(n.txt_jie.value="",n.txt_jie.visible=!1,fR.ins.isSuitByPosition(e,i)){var s=fR.ins.getSuitInfoByPosition(e,i);n.g_bg.visible=0<s.jie,n.txt_jie.visible=!0,n.txt_jie.value=s.jie+"",n.lbl_level.text="+"+s.level,n.g_icon.filters=null;var o=fR.ins.getZhuHunResIndex(e,i),a=kB.createEffect(cn.MODEL.effectId(o),n.width/2,n.height/2,n);this._itemEffs.push(a),n.g_red.visible=fR.ins.isAbleGrowEquip(e,i),n.addChild(n.g_red),n.g_icon.skin=_r.getAtlasSubPath("actormo/suit/icequ"+(10646+i)+".png"),n.addChild(n.g_bg),n.addChild(n.txt_jie),n.dataSource={showRed:n.g_red.visible,data:s,actorId:e,position:i,showBtn:!0}}else n.lbl_level.text="",n.g_red.visible=fR.ins.isAbleGrowEquip(e,i),n.g_bg.visible=!1,n.g_icon.filters=A_.getGrayFilter4(),n.dataSource={showRed:n.g_red.visible,data:null,actorId:e,position:i,showBtn:!0},n.g_icon.skin=_r.getAtlasSubPath("actormo/suit/icequ"+(10646+i)+".png")}},i.clearItemEffect=function(){if(null!=this._itemEffs)for(var e in this._itemEffs)this._itemEffs[e].dispose(),null;this._itemEffs=[]},i.needRedpt=function(e){return fR.ins.showSuitRoleRP(e.id)},i.onClickWF=function(e){var t=Vi.getIndex(7),i=Vi.MODEL.description(t);hN.ins.open("AE_EXPLAIN_VIEW",{desc:i})},t}(),UX=function(e){function t(){var e=this;e.position=0,e.actorId=0,e.grids=null,e.iconGrid=null,e._goodsID=0,e.effLevel=null,e.effTier=null,e.mohunzhuObj=null,e.lastLevel=void 0,e.lastTier=void 0,t.__super.call(e)}b(t,"modules.actor.views.mo.suit.MoEquipZhuHun",zu);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.list_attr.itemRender=Kj,e.txt_tips0.visible=!1,e.img_maxlevel.visible=!1,e.iconGrid=e.iconGrid||new MF,e.iconGrid.needGridBg=!0,e.iconGrid.needEffect=!1,e.iconGrid.mouseEnabled=!1,e.iconGrid.pos(240,125),e.addChild(e.iconGrid)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.grids=[],this.mohunzhuObj={isNeed:!1,id:6889,num:0,needNum:0,buyID:1047},this.btn_close.on("click",this,this.onClosePanelEvent),this.btn_zhuhun.on("click",this,this.zhuhun)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.mohunzhuObj=null,this.grids=null,this.btn_close.off("click",this,this.onClosePanelEvent),this.btn_zhuhun.off("click",this,this.zhuhun)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.effLevel&&this.effLevel.dispose(),this.effLevel=null,this.effTier&&this.effTier.dispose(),this.effTier=null},i.resetUIState=function(){var e=this;e.txt_tips0.visible=!1,e.img_materialBg.visible=!0,e.img_arrow.visible=!0,e.txt_current.left=108,e.txt_next.right=80,e.txt_next.visible=!0,e.btn_zhuhun.visible=!1,e.btn_zhuhun.label="铸 魂",e.box_m0.visible=!1,e.box_m1.visible=!1,e.box_m2.visible=!1,e.img_material.visible=!1},i.updateByVSC=function(e){var t,i=this;if(!e){t=fR.ins.getSuitInfoByPosition(i.actorId,i.position);var n=i._goodsID||0;e={data:t,actorId:i.actorId,position:i.position,goodsID:n}}if(e){t=e.data,i.actorId=e.actorId,i.position=e.position;var s=fR.ins.getZhuHunResIndex(i.actorId,i.position);i.txt_tar_name.text=cn.MODEL.name(s);var o=cn.MODEL.tier(s),a=cn.MODEL.level(s),r=i.getChildByName("tips");if(r&&(r.visible=!1),i.resetUIState(),i.btn_zhuhun.showTip=fR.ins.isAbleGrowEquip(i.actorId,i.position),i._goodsID!=e.goodsID){i._goodsID=e.goodsID;var l=yB.create(e.goodsID);i.iconGrid.bindData=l}i.mohunzhuObj.isNeed=!1,e.data?i.txt_level.text="铸魂："+o+"阶"+a+"级":i.txt_level.text="铸 魂";var c=fR.ins.isFull(i.position,o,a);if(i.img_maxlevel.visible=c,i.img_materialBg.visible=!c,i.img_arrow.visible=!c,i.txt_next.visible=!c,i.txt_current.left=c?252:108,!c)if(fR.ins.isMaxJieAndMaxLevel(i.actorId,i.position)){i.txt_tips0.visible=!0;var u=fR.ins.getMapIndexByTier(o)+1,d=ln.MODEL.key(u);if(0<d){r=r||kB.createHtmlDiv(130,613,24,"#90877b",350);var h="穿戴"+RP.n[580]+d+RP.n[579]+RP.n[580]+la.getName(i.position)+RP.n[581]+"<font color='#e6d80d'>"+ln.MODEL.maxTier(u)+"阶"+ln.MODEL.maxLevel(u)+RP.n[582];r.innerHTML=h,r.visible=!0,r.parent||(r.name="tips",i.addChild(r),r.style.leading=20,r.style.align="center",r.layout())}}else i.btn_zhuhun.visible=!0,fR.ins.isMaxLevel(i.actorId,i.position)&&(i.btn_zhuhun.label="升 阶"),i.setConsuption(t,i.actorId,s);var _,f=[],p=cn.MODEL.attrs(s),g=JSON.parse(p),v=g.length,m=cn.MODEL.attrs(s+1);cn.MODEL.position(s+1)==i.position&&m&&0<m.length&&(_=JSON.parse(m),v=Math.max(v,_.length));for(var y=0;y<v;y++){var I=g?g[y]:null,b=_?_[y]:null;f.push({current:I,next:b})}i.list_attr.array=f,o>i.lastTier?(i.lastTier=o,i.lastLevel=a,i.upgradeTierSuccess()):a>i.lastLevel?(i.lastLevel=a,i.upgradeLevelSuccess()):(i.lastTier=o,i.lastLevel=a)}},i.setConsuption=function(e,t,i){var n=this,s=cn.MODEL.consumptionDef(i+1);if(s&&0<s.length){var o=JSON.parse(s),a=Math.min(3,o.length);n.box_m0.visible=n.box_m1.visible=n.box_m2.visible=!1,n.img_material.visible=!0;for(var r=0;r<a;r++){n["box_m"+r].visible=!0;var l=o[r].value.split(":"),c=parseInt(l[0]),u=parseInt(l[1]),d=TR.ins.getGoodsNum(c);c==n.mohunzhuObj.id&&(n.mohunzhuObj.isNeed=!0,n.mohunzhuObj.num=d,n.mohunzhuObj.needNum=u);var h="box_m"+r+"_htmlDiv",_=u<=d?"#23b11f":"#ff2e24",f=n["box_m"+r].getChildByName(h)||kB.createHtmlDiv(-63,75,22,"#90877b",200);f.parent||(f.name=h,n["box_m"+r].addChild(f),f.style.align="center"),f.innerHTML="<font color='"+_+"'>"+d+"</font>/"+u,h="box_m"+r+"_GoodsGrid";var p=n["box_m"+r].getChildByName(h)||new MF(74);p.needGridBg=!0,p.needEffect=!1,p.name=h,p.parent||n["box_m"+r].addChild(p);var g=yB.create(c);p.bindData=g,n.grids.push(p)}}},i.onClosePanelEvent=function(e){hN.ins.close("MO_EQUIP_ZHUHUN")},i.zhuhun=function(e){var t=parseInt($e.MODEL.value($e.getIndex(255))||"0");this.mohunzhuObj.isNeed&&dr.getOpenServiceDay()>=t&&this.mohunzhuObj.num<this.mohunzhuObj.needNum?this.openQuickBuyPanel(e):fR.ins.reqZhuHun(this.actorId,this.position)},i.upgradeLevelSuccess=function(){this.effLevel=kB.createEffect("jm1078",300,430,this)},i.upgradeTierSuccess=function(){this.effLevel=kB.createEffect("jm1332",300,430,this)},i.openQuickBuyPanel=function(e){Tu.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:this.mohunzhuObj.buyID}),UB.ins.playSound(90006)},t}(),FX=function(e){function a(){var e=this;e.CONFIG=RP.n[583],e.SHOW_INTERIOR=!1,e._selector=null,e.avatar=null,e.avatarW=null,e._curClickGrid=null,e._gridBases=null,e._gridInteriors=null,e._lastDataSource=null,a.__super.call(e),e.centerX=e.centerY=0,e.init()}b(a,"modules.actor.views.other.OtherGodEquipView",Sh);var t=a.prototype;return t.init=function(){for(var e=this,t=0,i=G.loader.getRes(_r.getAtlasSubPath("base_ui2/ty_bjzs_zz2.png")),n=new pp,s=new pp;i&&t<944;)944-t>=i.height?(n.graphics.drawTexture(i,0,t,i.width,t),s.graphics.drawTexture(i,0,t,i.width,t),t+=i.height):(n.graphics.drawTexture(i,0,t,i.width,944-t),s.graphics.drawTexture(i,0,t,i.width,944-t),t+=944-t);e._selector=new Nj(pR.ins.actorList),e.addChild(e._selector),e.avatarW=new CF,e.avatarW.pos(-340,344),e.addChildAt(e.avatarW,2),e.avatar=new CF,e.avatar.pos(e.avatarW.x,e.avatarW.y),e.addChildAt(e.avatar,3),e._gridBases=[],e._gridInteriors=[];for(var o=0;o<la.SOARING_EQUIPS_UI_POS.length;o++){var a=la.SOARING_EQUIPS[o],r=e["equip"+a],l=kB.createText(r.x-r.width/2,r.y+116+2-r.height/2,116,0,la.getSoaringName(a),20,"#90877b",!1,"center",!1,!1,e);e.addChild(l);var c=new MF;c.mouseEnabled=!1,r.addChild(c),e._gridBases.push(c)}for(o=0;o<la.SOARING_INTERIOR_UI_POS.length;o++)r=e["equip"+(a=la.SOARING_INTERIOR_UI_POS[o])],e.SHOW_INTERIOR?(l=kB.createText(r.x-r.width/2,r.y+116+2-r.height/2,116,0,la.getSoaringName(a),20,"#90877b",!1,"center",!1,!1,e),e.addChild(l),(c=new MF).mouseEnabled=!1,r.addChild(c),e._gridInteriors.push(c)):r.visible=!1;e.lstGrade.itemRender=sQ,e.lstGrade.hScrollBarSkin="",e.lstGrade.scrollBar.elasticBackTime=300,e.lstGrade.scrollBar.elasticDistance=100,e.lstGrade.mouseHandler=ql.create(e,e.onSelectSkill,null,!1)},t.showByVSC=function(e,t){var i=this;i._selector.refresh(),i._selector.selectIdx=pR.ins.index,i._selector.on("select",i,i.onSelectActor);for(var n=0;n<la.SOARING_EQUIPS_UI_POS.length;n++){var s=la.SOARING_EQUIPS[n],o=i["equip"+s];o.on("click",i,i.onClickBaseEquip)}for(n=0;n<la.SOARING_INTERIOR_UI_POS.length;n++)(o=i["equip"+(s=la.SOARING_INTERIOR_UI_POS[n])]).on("click",i,i.onClickInteriorEquip);i.lstGrade.scrollBar.on("end",i,i.onScrollEnd),i.btnNext.on("click",i,i.onNext),i.btnPrev.on("click",i,i.onPrev),i.btn_suit.on("click",i,i.onOpenSuit),i.updateView()},t.hideByVSC=function(e,t){var i=this;i._selector.off("select",i,i.onSelectActor);for(var n=0;n<la.SOARING_EQUIPS_UI_POS.length;n++){var s=la.SOARING_EQUIPS[n],o=i["equip"+s];o.off("click",i,i.onClickBaseEquip)}for(n=0;n<la.SOARING_INTERIOR_UI_POS.length;n++)(o=i["equip"+(s=la.SOARING_INTERIOR_UI_POS[n])]).off("click",i,i.onClickInteriorEquip);i.lstGrade.scrollBar.off("end",i,i.onScrollEnd),i.btnNext.off("click",i,i.onNext),i.btnPrev.off("click",i,i.onPrev),i.btn_suit.off("click",i,i.onOpenSuit),a.lastIndex=0,i._curClickGrid=null,i._lastDataSource=null},t.onOpenSuit=function(e){var t=this._selector.selectIdx;pR.ins.actorById(t);lQ.ins.showTips(t,!0)},t.updateSkills=function(){for(var e=this._selector.selectIdx,t=pR.ins.actorById(e),i=AR.ins.MAX_SKILL_LEVEL,n=[],s=-1,o=1;o<=i;o++){var a={id:AR.ins.getSkillIdByJob(t.job,o),activeNum:AR.ins.getActiveNum(t,o),showTween:!1};if(null!=this._lastDataSource)this._lastDataSource[n.length].activeNum<a.activeNum&&(s=n.length,s=Math.max(0,s-1),a.showTween=!0);n[n.length]=a}if(this.lstGrade.dataSource=n,-1==s){var r=AR.ins.getActorActivingMaxLevel(t),l=AR.ins.getActorUseLevel(t);s=l<r?Math.max(0,r-2):Math.max(0,l-1)}this.lstGrade.tweenTo(s,200,ql.create(this,this.onScrollEnd)),this._lastDataSource=n},t.onSelectSkill=function(e,t){if("click"==e.type){for(var i=this.lstGrade.array[t],n=this._selector.selectIdx,s=pR.ins.actorById(n),o=AR.ins.getActorUseLevel(s),a=t<o,r="",l=0;l<gi.count;l++){var c=gi.MODEL.level(l),u=gi.MODEL.job(l);if(c==o&&u==s.job){r=gi.MODEL.name(l);break}}uQ.instance.showById(i.id,a?"":r+"解锁")}},t.onScrollEnd=function(){this.lstGrade.scrollBar.value<=0?this.btnPrev.visible=!1:this.btnPrev.visible=!0,this.lstGrade.scrollBar.value>=this.lstGrade.scrollBar.max?this.btnNext.visible=!1:this.btnNext.visible=!0,this.btnPrev.disabled=!1,this.btnNext.disabled=!1},t.onNext=function(e){this.btnNext.disabled=!0,this.btnPrev.disabled=!0;var t=this.lstGrade.startIndex+1,i=AR.ins.MAX_SKILL_LEVEL-2;i-1<=t&&(t=i-1),this.lstGrade.tweenTo(t,116*(t-this.lstGrade.startIndex),ql.create(this,this.onScrollEnd))},t.onPrev=function(e){var t=Math.ceil(this.lstGrade.scrollBar.value/146),i=t-1;i<0&&(i=0),this.btnPrev.disabled=!0,this.btnNext.disabled=!0,this.lstGrade.tweenTo(i,116*(t-i),ql.create(this,this.onScrollEnd))},t.onSelectActor=function(e){pR.ins.index=this._selector.selectIdx,this._lastDataSource=null,this.updateAvatar(),this.updateEquip(),this.updateInterior(),this.updateSkills()},t.updateView=function(){this.updateAvatar(),this.updateEquip(),this.updateInterior(),this.updateSkills()},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e);for(var t=0;t<this._gridBases.length;t++){var i=this._gridBases[t];i.destroy(e)}for(t=0;t<this._gridInteriors.length;t++)(i=this._gridInteriors[t]).destroy(e)},t.updateAvatar=function(e){void 0===e&&(e=-1);var t=this._selector.selectIdx,i=pR.ins.actorById(t);this.avatar.changeAvatar(i.sex,i.wid,i.mid,null,i.weaponSoulId),this.avatarW.changeAvatar(-1,null,null,i.wgid,null);i.flyupLevel;var n=AR.ins.getSoaringFight(t,!0),s=AR.ins.getSoaringLongWen(t,!0)+lR.instance().getOtherFight(t);this.fightNum.value=n+s},t.updateEquip=function(){for(var e,t=this._selector.selectIdx,i=pR.ins.actorById(t),n=0;n<la.SOARING_EQUIPS_UI_POS.length;n++){var s=la.SOARING_EQUIPS[n],o=this["equip"+s],a=this._gridBases[n];null==(e=i.equips.getPart(s))?(a.gray=!0,a.needEffect=!1,a.needGridBg=!1,a.bindData=AR.ins.getSoaringGradeEquipByPos(1,s)):(a.gray=!1,a.needEffect=!0,a.needGridBg=!0,a.bindData=e),o.dataSource={state:!1,data:a.bindData}}},t.updateInterior=function(){if(this.SHOW_INTERIOR)for(var e,t=this._selector.selectIdx,i=pR.ins.actorById(t),n=0;n<la.SOARING_INTERIOR_UI_POS.length;n++){var s=la.SOARING_INTERIOR_UI_POS[n],o=this["equip"+s],a=this._gridInteriors[n];null==(e=i.equips.getPart(s))?(a.gray=!0,a.needEffect=!1,a.needGridBg=!1,a.bindData=IR.ins.getInteriorGradeEquipByPos(i.job,1,s)):(a.gray=!1,a.needEffect=!0,a.needGridBg=!0,a.bindData=e),o.mouseEnabled=!0,o.dataSource={state:0,data:a.bindData}}},t.onClickBaseEquip=function(e){var t=e.target.dataSource,i=this._selector.selectIdx;KX.instance.showTips(t.data,t.state,i,!0)},t.onClickInteriorEquip=function(e){var t=e.target.dataSource;if(null!=t){var i=this._selector.selectIdx;YX.instance.showTips(t.data,t.state,i,!0)}},a._curSelector=0,a.lastIndex=-1,a}(),qX=function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.ringup.RingTypeItem",e);var i=t.prototype;return i.getSkinStrByType=function(e){switch(e){case 1:return"tj_ts_jz_mb";case 2:return"tj_ts_jz_hs";case 3:return"tj_ts_jz_sl";case 4:return"tj_ts_jz_fh"}return""},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){G.superSet(L_,this,"dataSource",e);var t=this.getSkinStrByType(e.type);this.filters=null,e.level<1&&Pg.gray(this,!0),this.img_icon.skin=_r.getAtlasSubPath("actor/"+t+".png"),this.img_icon.centerX=-5,this.img_icon.y=8;var i=new wB(e.type,e.level,e.jobId);this.img_red.visible=0<e.level&&i.isAbleGrow&&-1!=i.nextConfigIndex}}),p(0,i,"CanOper",function(){return!1},function(e){this.img_red.visible=e}),t}(L_),jX=function(e){function t(){var e=this;e._selector=null,e._attrUI=null,e._iconSkill=null,e._skillName=null,e._openRing=-1,e._eff=null,e._effInfo={1:"jm1355",2:"jm1356",3:"jm1357",4:"jm1358"},e.lvlDelt=0,e._sucEff=null,e.grid=null,e._oldActor=-1,e._info=null,e.actorRing=null,e._oldSelInx=-1,e._consumeId=2117,e.f=new ys([.5,0,0,0,16.75,0,.5,0,0,16.75,0,0,.5,0,16.75,0,0,0,1,0]),e._maskVec=new Array,e._txtVec=new Array,t.__super.call(e),e.bg.skin=_r.getActImg()}b(t,"modules.actor.views.ringup.RingUpgradeView",M_);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.updateByVSC=function(e){if(e&&"30452"==e.actionOrder&&0<e.proto.level){var t=new wB(e.proto.type,e.proto.level,e.proto.jobId);1==ps.MODEL.breakthrough(t.configIndex)&&this.showSucess()}if(this._selector.invalid(),this.updateActorGray(),e instanceof protos.ringclassic.DtoActorRingData){this._openRing=e.type;for(var i=gR.ins.actorList.length,n=0;n<i;n++)if(this._selector.getItem(n).actorData.job==e.jobId){this._selector.selectIdx=n;break}this.onRoleHandler(!0)}else this.onRoleHandler(!1,this._oldSelInx)},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.showSucess=function(){this._sucEff&&(this._sucEff.dispose(),this._sucEff=null),this._sucEff=kB.createEffect("jm1079",375,800,this)},i.initialize=function(){var e=this,t=$e.getIndex(232);e.lvlDelt=parseInt($e.MODEL.value(t)),e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.box_c.addChild(e._selector),e.listType.itemRender=qX,e.listType.selectEnable=!0,e.listType.mouseEnabled=!0,e.listType.selectHandler=ql.create(e,e.onSelectedHandler,null,!1),e._attrUI=new tW,e.box_c.addChild(e._attrUI),e._attrUI.centerX=0,e._attrUI.bottom=401,e.grid=new MF(45),e.grid.needEffect=!1,e.imgSIcon.addChild(e.grid),e.grid.needGridBg=!1,e._iconSkill=new Kl,e._iconSkill.size(96,96),e._iconSkill.pos(10,10);var i=new pp;(e._iconSkill.mask=i).graphics.drawCircle(50,50,50,"#FFFFFF"),e.imgSkill.addChild(e._iconSkill),e._iconSkill.scale(.86,.86),e._skillName=kB.createText(578,e.imgSkill.y+107,116,50,"",20,"#90877b",!1,"center",!1,!1,e),e.box_c.addChild(e._skillName)},i.needRedpt=function(e){for(var t,i=gR.ins.actorRingData[e.job],n=0;n<i.length;n++)if(i[n]&&0<(t=new wB(i[n].type,i[n].level,i[n].jobId)).level&&t.isAbleGrow&&-1!=t.nextConfigIndex)return!0;return!1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._selector.on("select",t,t.onRoleHandler),t.on("click",t,t.onClick),t.labLink.on("click",t,t.onClick),t.updateActorGray()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t._selector.off("select",t,t.onRoleHandler),t.labLink.off("click",t,t.onClick),t.imgSkill.off("click",t,t.onClick),t._oldSelInx=-1,t.clearObj()},i.clearObj=function(){for(var e=0,t=0;t<this._maskVec.length;t++)this._maskVec[t].removeSelf();for(e=0;e<this._txtVec.length;e++)this._txtVec[e].removeSelf()},i.updateActorGray=function(){var e=0;this.clearObj(),this._txtVec.length=0,this._maskVec.length=0;var t=gR.ins.actorList;for(e=0;e<t.length;e++){for(var i=gR.ins.actorRingData[t[e].job],n=!1,s=0;s<i.length;s++)i[s]&&0<i[s].level&&(n=!0);var o=this._selector.getItem(e);if(o){if(o.mcHead.filters=null,!n){o.mcHead.filters=[this.f];var a=new Kl(_r.getAtlasSubPath("basic_ui_g/ty_ts_dk.png"));a.centerX=a.centerY=0,a.height=34,a.width=112,o.addChild(a),this._maskVec.push(a);var r=new fc("未激活");r.fontSize=24,r.color="#ff0000",r.centerX=r.centerY=0,o.addChild(r),this._txtVec.push(r),r.gray=!1}o.isGray=!n}}},i.onRoleHandler=function(e,t){var i=this;void 0===e&&(e=!1),void 0===t&&(t=-1);var n=i._selector.getItem(i._selector.selectIdx);if(n.isGray&&!e)return zB.ins.playErrorMsg(RP.n[584]),void(i._selector.selectIdx=i._oldActor);if(i._oldActor=i._selector.selectIdx,n){var s=n.actorData;if(s){for(var o=gR.ins.actorRingData[s.job],a=[],r=0,l=!1;r<o.length;)o[r]&&(a.push(o[r]),0<o[r].level&&(l=!0)),r++;if(l||e){i.listType.dataSource=a;var c=-1;if(-1!=t&&-1==i._openRing)return i.listType.selectedIndex=t,void i.onSelectedHandler(t);for(r=0;r<a.length;r++)if(0<a[r].level)if(i.actorRing=new wB(a[r].type,a[r].level,a[r].jobId),-1==i._openRing){if(!i.actorRing.consumptions)continue;if(i.actorRing.isAbleGrow||!i.needRedpt(s)){c=r;break}}else if(i.actorRing.type==i._openRing){c=r,i._openRing=-1;break}i.listType.clearSelect(),-1==c&&(c=0),i.listType.selectedIndex=c}}}},i.checkIfExit=function(e){return!!e},i.onClick=function(e){var t=this;switch(e.target){case t.btnUp:if(null==t.actorRing)return;if(!t.actorRing.isAbleGrow)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._consumeId});vR.reqGrowRing(t.actorRing.jobId,t.actorRing.type);break;case t.imgSkill:eW.ins.show(t.actorRing)}e.currentTarget==t.labLink&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._consumeId})},i.onSelectedHandler=function(e){var t=this;if(t._info=t.listType.getItem(e),t._info){if(t._info&&0==t._info.level&&-1!=t._oldSelInx)return zB.ins.playErrorMsg(RP.n[585]),void(t.listType.selectedIndex=t._oldSelInx);t._oldSelInx=e,t.actorRing=new wB(t._info.type,t._info.level,t._info.jobId),t._eff&&(t._eff.dispose(),t._eff=null),t._eff=kB.createEffect(t._effInfo[t._info.type],t.box_c.width/2,t.box_c.height/5*2+50,t.box_c),t.updatePanelInfo()}},i.updatePanelInfo=function(){var e=this;if(e._attrUI.update(e.actorRing),e.imgMax.visible=-1==e.actorRing.nextConfigIndex,e.boxConsume.visible=-1!=e.actorRing.nextConfigIndex,e.labLink.visible=-1!=e.actorRing.nextConfigIndex,e.actorRing.buffIds){e.actorRing.buffIds[0];var t=k_.ins.getRingSkillIndex(e.actorRing.type);e._iconSkill.skin=_r.getIconPath(so.MODEL.icon(t));var i=0<e.actorRing.level%e.lvlDelt?1:0;e._skillName.text=so.MODEL.name(t)+(Math.floor(e.actorRing.level/e.lvlDelt)+i).toString(),e.imgName.skin=_r.getFullUrl("ui/images/specialring_title/tj_ts_text_"+e.actorRing.type+".png"),e.actorRing.nextConfigIndex,e.fightNum.value=e.actorRing.fightValue(e._selector.selectIdx)+ps.MODEL.extraFight(e.actorRing.configIndex),e.updateConsume()}},i.updateConsume=function(){var e=this.actorRing.consumptions;if(e){var t=this.actorRing.level%this.lvlDelt;this.btnUp.label=0==t?"突 破":"升 级";var i=parseInt(e[0].value.toString().split(":")[0]),n=parseInt(e[0].value.toString().split(":")[1]);this._consumeId=i;var s=TR.ins.getGoodsNum(i)<n?"#ff2e24":"#23b11f";this.imgRedP.visible=TR.ins.getGoodsNum(i)>=n,this.htmlCost.innerHTML=Ql.createColor(TR.ins.getGoodsNum(i)+"",s)+Ql.createColor("/"+n,"#e0d6c1"),this.grid.bindData=yB.create(i)}},i.getNameImgByType=function(e){switch(e){case 1:case 2:case 3:case 4:return""}return""},t}(),WX=function(e){function t(){this.GRAY="#5f5952",this.GAP_Y=42,this._grid=null,this._btnShows=null,this._info=null,this._btnEff=null,this._offsetY=0,this._achieves=null,t.__super.call(this)}b(t,"modules.actor.views.samsaraequip.SamsaraEquipTip",z_);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.initialize=function(){this._btnShows=new jo,this.panel.vScrollBarSkin="",this.panel.mouseEnabled=!0,this._grid=new MF,this._grid.pos(0,0),this._grid.toolTipEnabled=!1,this.img_icon.addChild(this._grid),this.txt_tip.text=RP.n[586]},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.panel.vScrollBar.on("change",this,this.onScrollEnd)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.panel.vScrollBar.off("change",this,this.onScrollEnd)},i.show=function(e){this._info=e,this._info&&(this.updateBtnState(),this.showIconInfo(),this.showAttrs(),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClickLayer),eq.panelLayer.openTip(this)))},i.showIconInfo=function(){var e=this,t=e._info.dto;e._grid.bindData=t,e.txt_name.text=t.name;var i=Bi.MODEL.colourId(t.cfgIdx);e.txt_name.color=ms.getByQuality(i),e.txt_part.text=la.getName(Bi.MODEL.decoratePosition(t.cfgIdx));var n=Bi.MODEL.flyLevel(t.cfgIdx),s=Bi.MODEL.minUseLevel(t.cfgIdx);0<n?(e.txt_level.changeText(n+"转"),e.txt_level.color=gR.ins.zsLv>=n?"#90877b":"#ff2e24"):(e.txt_level.changeText(s+"级"),e.txt_level.color=gR.ins.lv>=s?"#90877b":"#ff2e24"),e.txt_job.text=ha.getDesByType(Bi.MODEL.roleTypeId(t.cfgIdx)),1<i?(e.grade.visible=!0,e.grade.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+i+".png")):e.grade.visible=!1},i.showAttrs=function(){var e=this;e.panel.scrollTo(0,0),e.boxAttr.graphics.clear(),e.box_zhuhun.graphics.clear(),e.box_suit.graphics.clear();var t,i,n,s=e._info.dto,o=PR.getGoodsNewAttr(s.goodsId),a=aa.formatNewAttrToChinese(o,!1,!1),r=0,l=0,c=0,u=0;null!=e._info&&e._info.actorId&&0<s.decoratePosition&&(l=uR.ins.getMohuaLevel(e._info.actorId,s.decoratePosition),c=uR.ins.getLinkLevel(e._info.actorId,s.decoratePosition),u+=hR.getMoRateByPos(e._info.actorId,l,s.decoratePosition)),e._offsetY=e.box_jichu.y+e.box_jichu.height+20;var d=0;for(r=0;r<a.length;r++){i=(t=a[r]).name+":",n=t.val+"",e.drawAttr(e.boxAttr,i,"#90877b",n,"#90877b",30,e._offsetY,24);var h=0;if(null!=e._info){var _=hR.getLinkRateAddAttrIdByPos(e._info.actorId,c,s.decoratePosition);t.id==_&&(h+=hR.getLinkRateByPos(e._info.actorId,c,s.decoratePosition))}if(0<u+h){var f=Math.ceil((u+h)/1e4*t.val);n="注 魂+"+f,e.drawAttr(e.boxAttr,n,"#23b11f","","#90877b",300,e._offsetY,24);var p={};p[aa.getAttributById(t.id).keyStr]=f,d+=RR.getFight(p)}e._offsetY+=38}if(e._info.noRefine)e.boxRefine.visible=!1,e.img_black.visible=!1,e.fight_num.value=e._info.dto.fight+Bi.MODEL.fight(e._info.dto.cfgIdx)+d;else{var g=gR.ins.actorById(e._info.actorId),v=yR.ins.getRefineAttrPos(e._info.actorId,e._info.pos),m=yR.ins.getRefineInfoPos(e._info.actorId,e._info.pos),y=g.equips.getPart(e._info.pos);if(v&&m&&0<m.level&&y==e._info.dto){for(e.boxRefine.visible=!0,e.boxRefine.y=e._offsetY+10,e._offsetY+=100,e.img_black.visible=!0,a=aa.formatNewAttrToChinese(v,!1,!0,!0),e.htmlRefineLvl.innerHTML=Ql.createColor(RP.n[587]+m.level+"级","#e6d80d"),m.level==yR.ins.getLimLvlBySamLvl(yR.ins.getSamLevelByDto(e._info.dto))&&m.level<yR.ins.getMaxLvl()&&(e.htmlRefineLvl.innerHTML+=Ql.createColor(RP.n[588]+(yR.ins.getSamLevelByDto(e._info.dto)+1)+RP.n[589],"#ff2e24")),e.htmlRefineLvl.x=30,r=0;r<a.length;r++)i=(t=a[r]).name+":",n=t.val+"",0<s.random&&(n+=" +"+aa.getFormatValue(t.id,t.val*s.randomRate>>0)),e.drawAttr(e.boxAttr,i,"#90877b",n,"#90877b",30,e._offsetY,24),e._offsetY+=38;e.fight_num.value=e._info.dto.fight+Bi.MODEL.fight(e._info.dto.cfgIdx)+RR.getFight(v)+d}else e.boxRefine.visible=!1,e.img_black.visible=!1,e.fight_num.value=e._info.dto.fight+Bi.MODEL.fight(e._info.dto.cfgIdx)+d}e.box_zhuhun.y=e._offsetY+10;var I=e.GRAY,b=e.GRAY;0<c&&(I="#e6d80d",b="#e0d6c1");var w=Math.max(c,1),x=0;x+=40,e.box_zhuhun.graphics.fillText(RP.n[590]+w,30,x,RP.n[591],I,"left"),x+=30;var S=hR.getLinkDes1(s.actorId,w,s.decoratePosition);e.box_zhuhun.graphics.fillText(S,30,x,"24px SimHei",b,"left"),x+=44,I=e.GRAY,b=e.GRAY,0<l&&(I="#e6d80d",b="#e0d6c1");var k=Math.max(l,1);e.box_zhuhun.graphics.fillText("魔化LV."+k,30,x,"24px SimHei",I,"left"),x+=30,S=hR.getMohuaDes(s.actorId,k,s.decoratePosition),e.box_zhuhun.graphics.fillText(S,30,x,"24px SimHei",b,"left"),x+=44;var E=e.panel.y+e.panel.height,T=0;E+=10,e._offsetY+=x+10,e.box_suit.y=e._offsetY;var C=80,L=yR.ins.getSamLevelByDto(s),M=yR.ins.getJobByCfg(s),A=yR.ins.getSuitLevelName(L,M),D=[];for(r=0;r<ji.count;r++){var O=ji.MODEL.suitType(r),P=ji.MODEL.level(r),R=ji.MODEL.suitNeedNum(r),N=ji.MODEL.roleType(r);if("lunhuiEquip"==O&&L==P&&M==N){var B=ji.MODEL.suitNeedNum(r);D[B]=r}}for(B in D){var H=!1,V=D[B];P=ji.MODEL.level(V),(R=ji.MODEL.suitNeedNum(V))<=yR.ins.getWearedNumByLvlActor(L,e._info.actorId)&&0!=e._info.pos&&(H=!0);var G=ji.MODEL.attributes(V);if(""!=G){var U=H?"#e0d6c1":e.GRAY,F=H?"#23b11f":e.GRAY,q=aa.formatNewAttrToChinese(G,!1,!0,!0);e.box_suit.graphics.fillText(R+RP.n[592],30,C,RP.n[593],U,"left");var j,W=0;for(var Y in q)-1!=(j=q[Y]).name.indexOf("加成")?e.box_suit.graphics.fillText(j.name+""+j.val,120+W%2*180,C,"24px SimHei",F,"left"):e.box_suit.graphics.fillText(j.name+"+"+j.val,120+W%2*180,C,"24px SimHei",F,"left"),W++,C+=30}}e.txt_suitName.innerHTML=Ql.createColor(A,"#e6d80d"),0!=e._info.pos&&(e.txt_suitName.innerHTML+=Ql.createColor("("+yR.ins.getWearedNumByLvlActor(L,e._info.actorId)+"/8)","#e6d80d")),e.txt_suitName.x=30,e._offsetY+=C,e.setAchieving(s),e.boxAttr.height=e._offsetY,e.panel.refresh(),e.onScrollEnd(),e.txt_tip.y=E,E+=50,e._achieves&&e._achieves.parent&&(T=e._achieves.height);var z,X=[];for(var Q in e._btnShows.keys){z=e._btnShows.keys[Q];var J=e._btnShows.get(z);(z.visible=J)&&X.push(z)}var Z=X.length;0<Z&&Math.floor((Z+1)/2);for(var K=0 in X){if(z=X[K],1==Z){z.centerX=0,z.y=E,E+=z.height;break}z.y=E,K%2==0?z.centerX=-130:(z.centerX=130,E+=z.height)}if(e.btnRefine.visible){var $=yR.ins.getRefineRPtStatusByActor(g,e._info.actorId);e.btnRefine.showTip=$[e._info.pos]}e.img_bg_kuang.height=E+22,e.height=E+10+T+22,e._achieves&&(e._achieves.y=e.img_bg_kuang.height)},i.onScrollEnd=function(e){this.panel.vScrollBar.value>=this.panel.vScrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},i.updateBtnState=function(){var e=this;if(e._btnShows.clear(),e._btnShows.set(e.btn_go,!1),e._btnShows.set(e.btnRefine,!1),e._btnEff&&e._btnEff.dispose(),e._btnEff=null,0!=e._info.pos){var t=gR.ins.actorById(e._info.actorId),i=t.equips.getPart(e._info.pos),n=TR.bagModel.getDto(e._info.dto.goodsId);i&&i.goodsId==e._info.dto.goodsId||n&&PR.dressAble(t,n,e._info.pos)&&(e._btnShows.set(e.btn_go,!0),e._btnEff=kB.createEffect("jm1130",e.btn_go.width>>1,e.btn_go.height>>1,e.btn_go),e._btnEff.scale_X=1.25,e._btnEff.scale_Y=1.25),i&&yR.ins.isMaxLvlByPos(e._info.actorId,e._info.pos)||!i||e._btnShows.set(e.btnRefine,!0)}},i.setAchieving=function(e){var t=this;e&&Bi.MODEL.achieving(e.cfgIdx)&&e.needGetWay?(t._achieves||(t._achieves=new OQ(ql.create(modules.actor.views.samsaraequip.SamsaraEquipTip.ins,modules.actor.views.samsaraequip.SamsaraEquipTip.ins.close,null,!1))),t._achieves.pos(0,t.panel.y+t.panel.height+50),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.onClick=function(e){switch(e.target){case this.btn_go:if(!this._info)return;var t=TR.bagModel.getDto(this._info.dto.goodsId),i=new fO;i.roleIndex=this._info.actorId,i.goodsId=t.uuId,Tu.sendToService(i),this.close(!0);break;case this.btnRefine:hN.ins.open("SamEquipRefineTip",this._info),this.close(!0)}},i.onClickLayer=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),eq.panelLayer.off("MASK_CLOSE",this,this.onClickLayer),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.actor.samsaraequip.SamsaraEquipTipUI._$SET_ins),t._ins=null,t}(),YX=function(e){function t(){var e=this;e._grid=null,e._dto=null,e._achieves=null,e._actorId=0,e._btnEffect=null,t.__super.call(e),e.panel.vScrollBarSkin="",e.panel.mouseEnabled=!0,e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e._grid.toolTipEnabled=!1,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1),e.txt_tip.text=RP.n[594]}b(t,"modules.actor.views.soaring.interior.SoaringInteriorTip",wf);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.panel.vScrollBar.on("change",this,this.onScrollEnd)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.panel.vScrollBar.off("change",t,t.onScrollEnd),null!=t._btnEffect&&(t._btnEffect.removeSelf(),t._btnEffect.dispose(),t._btnEffect=null)},i.onClick=function(e){var t=this;switch(e.target){case t.btn_go:var i=t._dto.goodsId,n=TR.bagModel.getDto(i);n&&bR.reqWearInterior(t._actorId,n.uuId),t.close(!1);break;case t.btn_change:var s=t._dto.roleJob,o=t._dto.decoratePosition;gR.ins.actorByJob(s);if(n=IR.ins.getBetterEquips(s,o)){if(TR.ins.getLeftGridNum()<1)return void KQ.ins.showBagRecycle();bR.reqWearInterior(t._actorId,n.uuId),zB.ins.showMsg(RP.n[595],2)}else zB.ins.showMsg(RP.n[596],1);t.close(!1);break;case t.btn_unpack:if(TR.ins.getLeftGridNum()<1)return void KQ.ins.showBagRecycle();null!=t._dto&&(bR.reqUnpack(t._actorId,t._dto.decoratePosition),zB.ins.showMsg(RP.n[595],2)),t.close(!1)}},i.show=function(e){this.showTips(e)},i.showTips=function(e,t,i,n){var s=this;void 0===t&&(t=0),void 0===i&&(i=-1),void 0===n&&(n=!1);var o;null!=s._btnEffect&&(s._btnEffect.removeSelf(),s._btnEffect.dispose(),s._btnEffect=null),s.panel.scrollTo(0,0),s._dto=e,s._grid.bindData=s._dto,s._actorId=i,o=0==n?gR.ins.actorById(s._actorId):pR.ins.actorById(i),s.boxAttr.graphics.clear();var a=s._dto.cfgIdx,r=Bi.MODEL.colourId(a);1<r?(s.grade.visible=!0,s.grade.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+r+".png")):s.grade.visible=!1,s.txt_name.changeText(Bi.MODEL.name(a)),s.txt_name.color=ms.getByQuality(r),s.txt_part.changeText(la.getSoaringName(Bi.MODEL.decoratePosition(a))),s.txt_type.changeText(RP.n[598]);var l=Bi.MODEL.flyLevel(a),c=Bi.MODEL.minUseLevel(a);0<l?(s.txt_level.changeText(l+"转"),s.txt_level.color=gR.ins.zsLv>=l?"#90877b":"#ff2e24"):(s.txt_level.changeText(c+"级"),s.txt_level.color=gR.ins.lv>=c?"#90877b":"#ff2e24");var u=PR.getGoodsNewAttr(s._dto.goodsId),d=aa.formatNewAttrToChinese(u,!1,!1);s.fight_num.value=RR.getFight(u)+Bi.MODEL.fight(a);for(var h=s.box_jichu.y+s.box_jichu.height+20,_=0;_<d.length;_++){var f=d[_],p=f.name+":",g=f.val+"";0<s._dto.random&&(g+=" +"+aa.getFormatValue(f.id,f.val*s._dto.randomRate>>0));s.drawAttr(s.boxAttr,p,"#90877b",g,"#90877b",32,h,24),h+=38}switch(s.box_jipin.visible=!1,s.box_suit.y=h+10,s.btn_change.visible=!1,s.btn_unpack.visible=!1,s.btn_go.visible=!1,t){case 1:s.btn_go.visible=!0;break;case 2:case 3:s.btn_change.visible=!0,s.btn_unpack.visible=!0}1==t&&null==s._btnEffect&&(s._btnEffect=kB.createEffect("jm1130",s.btn_go.width>>1,s.btn_go.height>>1,s.btn_go)),3==t&&null==s._btnEffect&&(s._btnEffect=kB.createEffect("jm1130",s.btn_change.width>>1,s.btn_change.height>>1,s.btn_change)),s._btnEffect&&(s._btnEffect.scale_X=1.25,s._btnEffect.scale_Y=1.25),h+=60;var v=[];null!=o&&(v=IR.ins.getInteriorSuitData(o));var m="",y=0;for(_=0;_<ji.count;_++){var I=ji.MODEL.suitType(_),b=ji.MODEL.roleType(_);if("flyUpJewelry"==I&&b==e.roleJob){var w=ji.MODEL.attributes(_);if(""==w)continue;var x=ji.MODEL.level(_);if(x!=s._dto.flyUpJewelryLevel)continue;var S=ji.MODEL.suitNeedNum(_),k=la.SOARING_INTERIOR_UI_POS.length,E=v.hasOwnProperty(x)?v[x]:0,T=ji.MODEL.SuitName(_);""!=T&&null!=T&&(m=T),y!=x&&(s.boxAttr.graphics.fillText(m+"（"+E+"/"+k+"）",32,h,"24px SimHei","#e6d80d","left"),h+=40,y=x);var C=S<=E?"#e6d80d":"#5f5952";s.boxAttr.graphics.fillText(S+"件套：",32,h,"24px SimHei",C,"left");var L,M=aa.formatNewAttrToChinese(w,!1,!0,!1),A=0,D=S<=E?"#23b11f":"#5f5952";for(var O in M)L=M[O],s.boxAttr.graphics.fillText(L.name+"+"+L.val,120+A%2*165,h,"24px SimHei",D,"left"),h+=++A%2==0&&0<Math.floor(A/2)?40:0;M.length%2==1&&(h+=40),h+=4}}h+=4,s.setAchieving(s._dto),s.boxAttr.height=h,s.panel.refresh();var P=s.panel.y+s.panel.height+12,R=0,N=0;s._achieves&&s._achieves.parent&&(R=s._achieves.height),0!=t&&(s.btn_go.y=P+46,s.btn_change.y=s.btn_unpack.y=s.btn_go.y,N=s.btn_go.height+20),s.img_bg_kuang.height=s.panel.y+s.panel.height+N+60,s.height=s.panel.y+s.panel.height+70+R+N,s._achieves&&(s._achieves.y=s.panel.y+s.panel.height+60+N),s.parent||(eq.panelLayer.on("MASK_CLOSE",s,s.onClickMask),eq.panelLayer.openTip(s)),s.onScrollEnd()},i.onClickMask=function(e){this.close(!0)},i.onScrollEnd=function(e){this.panel.vScrollBar.value>=this.panel.vScrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.setAchieving=function(e){var t=this;Bi.MODEL.achieving(e.cfgIdx)&&e.needGetWay?(t._achieves||(t._achieves=new OQ(ql.create(modules.actor.views.soaring.interior.SoaringInteriorTip.instance,modules.actor.views.soaring.interior.SoaringInteriorTip.instance.close,null,!1))),t._achieves.pos(0,t.panel.y+t.panel.height+50),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.soaring.interior.SoaringInteriorTipUI._$SET_instance),t.GRAY="#5f5952",t._instance=null,t}(),zX=function(e){function t(){t.__super.call(this),this.img_dot.visible=!1}b(t,"modules.actor.views.soaring.subview.SoaringEquipItem",pf);var i=t.prototype;return p(0,i,"dot",function(){return this.img_dot.visible},function(e){this.img_dot.visible=e}),p(0,i,"selected",null,function(e){e?(this.arrow.rotation=-90,this.arrow.right=17,this.arrow.bottom=-3):(this.arrow.rotation=90,this.arrow.right=-8,this.arrow.bottom=18)}),t}(),XX=function(e){function t(){this.toc=null,this.iconId=0,this.gItem=null,t.__super.call(this),this.centerX=0,this.top=436,this.txt_content.mouseEnabled=!1}b(t,"modules.activity.views.sp.Sp_TreePickTips",ma);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_wear.on("click",this,this.onClickHandler),this.btn_close.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.btn_wear.off("click",t,t.onClickHandler),t.btn_close.off("click",t,t.onClickHandler)},i.updateView=function(e){if(e&&e instanceof protos.activity.toc_12248)if(this.toc=e,0<Zn.count&&0<Jn.count)this.onJxrComplete();else{var t=[];Zn.count<=0&&t.push({url:_r.getJxrDBPath("ConfigActivityPlant"),type:"arraybuffer",cls:Zn}),Jn.count<=0&&t.push({url:_r.getJxrDBPath("ConfigActivityPick"),type:"arraybuffer",cls:Jn}),uc.ins().onLoadJxrs(t,ql.create(this,this.onJxrComplete))}},i.onJxrComplete=function(){var e=this,t=Jn.getIndex(e.toc.pickId),i=Jn.MODEL.pickActivityId(t);t=Zn.getIndex(i),e.btn_wear.label=Zn.MODEL.typeName(t),e.txt_title.changeText(Zn.MODEL.title(t)),e.txt_content.innerHTML=Zn.MODEL.desc(t),e.iconId=Zn.MODEL.iconId(t),e.gItem||(e.gItem=new MF,e.grid.addChild(e.gItem));var n=yB.create(e.toc.goodsId);n&&(e.gItem.bindData=n,t=Bi.getIndex(n.goodsId),e.txt_name.changeText(Bi.MODEL.simpleName(t)),e.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(t)))},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_wear:CN.getIconBtn(this.iconId)&&CN.dealActIcon(CN.getIconBtn(this.iconId)),hN.ins._closePanel(this);break;case this.btn_close:hN.ins._closePanel(this)}},t}(),QX=function(e){function t(){this.m_uId=0,this.g_item=null,this.g_box=null,t.__super.call(this)}b(t,"modules.actor.views.soaring.subview.SoaringEquipResolveItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.lab_level.text="",this.btn_resolve.on("click",this,this.onClickHandler),this.btn_resolve.bottom=45},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.g_box&&this.g_box.graphics.clear(),this.btn_resolve.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){if(0<this.m_uId){var t=this.dataSource;Bi.MODEL.flyUpLevel(t.cfgIdx);OR.reqRecycle([this.m_uId])}UB.ins.playSound("5")},i.onConfirm=function(e){1==e&&OR.reqRecycle([this.m_uId])},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){G.superSet(gf,t,"dataSource",e);var i=e;if(t.g_box&&t.g_box.graphics.clear(),i){t.m_uId=i.uuId,t.g_item||(t.g_item=new MF,t.gridBox.addChild(t.g_item)),0<(t.g_item.bindData=i).flyLevel?(t.lab_level.changeText("转生："),t.lab_level.changeText(i.flyLevel+"转")):(t.lab_level.changeText("等级："),t.lab_level.changeText(0<i.useLevel?i.useLevel+"级":"无限制"));var n=0;t.g_box||(t.g_box=new dt,t.g_box.pos(147,19),t.addChild(t.g_box)),t.g_box.graphics.clear();var s=ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx));t.g_box.graphics.fillText(i.name,0,n,"24px SimHei",s,"left"),n+=43,t.g_box.graphics.fillText(RP.n[544],0,n,RP.n[545],"#90877b","left"),n+=43;for(var o=Bi.MODEL.recycleGoodsAward(i.cfgIdx),a=o.split(";"),r="",l=0;l<a.length;l++){var c=a[l].split(","),u=yB.create(c[0],c[1]);0!=l&&(r+=","),r+=u.name+"x"+u.goodsNum}""!=r?t.g_box.graphics.fillText(r,0,n,"24px SimHei",s,"left"):t.g_box.graphics.fillText(o,0,n,"24px SimHei","#90877b","left")}else t.m_uId=0,t.lab_level.text="",t.g_item&&(t.g_item.bindData=null)}}),t}(gf),JX=function(e){function t(){t.__super.call(this),this.img_dot.visible=!1,this.imgSelect.visible=!1}b(t,"modules.actor.views.soaring.subview.SoaringEquipSubItem",mf);var i=t.prototype;return p(0,i,"selected",null,function(e){this.imgSelect.visible=e,this.lblName.color=e?"#b5a998":"#5f5952"}),p(0,i,"dot",null,function(e){this.img_dot.visible=e}),t}(),ZX=function(e){function t(){var e=this;e.S_TEXT_PX=46,e.GAP_Y=42,e.GAP_CY=50,e.GAP4=10,e._grid=null,e._box=null,e._cbox=null,e._dto=null,e._cost=null,e._actorId=0,e._showGrow=!1,e._handEff=null,t.__super.call(e),e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e._grid.toolTipEnabled=!1,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1),e._box=new dt,e.addChild(e._box),e._cost=[]}b(t,"modules.actor.views.soaring.subview.SoaringEquipTip2",yf);var i=t.prototype;return i.showTips=function(e,t,i){var n=this;n._dto=e,n._actorId=i,n._showGrow=t,n._box.graphics.clear(),n._cbox&&n._cbox.graphics.clear(),n.img_active.visible=!1;var s=gR.ins.actorById(i);n._grid.bindData=AR.ins.toSuitShowDto(e);var o=n._dto.cfgIdx,a=Bi.MODEL.colourId(o);n.txt_name.changeText(AR.ins.getSuitEquipName(n._dto)),n.txt_name.color=ms.getByQuality(a),n.txt_part.changeText(la.getSoaringName(Bi.MODEL.decoratePosition(o)));var r=AR.ins.MAX_POSITION_LEVEL,l={};0==n._dto.positionLevel?n.txt_level.changeText("1阶"):n.txt_level.changeText(n._dto.positionLevel+"阶");for(var c=0==n._dto.positionLevel?1:n._dto.positionLevel,u=Math.max(n._dto.positionLevel,1),d=318,h=0;h<8;h++){var _=la.SOARING_EQUIPS[h],f=s.equips.getPart(_),p="",g="";n._dto.position==_&&(f=n._dto),p=AR.ins.getSuitEquipName2(_,u),null!=f?(r>f.positionLevel&&(r=f.positionLevel),l.hasOwnProperty(f.positionLevel)||(l[f.positionLevel]=0),f.positionLevel>=c&&0<f.positionLevel?(l.hasOwnProperty(c)||(l[c]=0),l[c]++):(f.positionLevel<c||0==f.positionLevel)&&0<f.positionLevel&&(l[f.positionLevel]?l[f.positionLevel]++:l[f.positionLevel]=1),f.positionLevel>=c&&0<f.positionLevel?g="#23b11f":(f.positionLevel<c||0==f.positionLevel)&&(g="#5f5952")):(g="#5f5952",r=0),n._box.graphics.fillText(p.substr(3,2),n.S_TEXT_PX+60*h,d,"24px SimHei",g,"left")}d+=98,n.g_line.y=d,r=Math.max(r,1);var v=AR.ins.getSuitNameByLevel(u,s.job),m=0;for(var y=0 in l)c==y&&(m+=l[y]);n.txt_suitName.innerHTML=v+Ql.createColor("（"+m+"/8）","#23b11f");var I=[];for(h=0;h<ji.count;h++){var b=ji.MODEL.suitType(h),w=ji.MODEL.level(h),x=ji.MODEL.suitNeedNum(h);ji.MODEL.roleType(h),Bi.MODEL.roleTypeId(n._dto.cfgIdx);if("flyUpEquip"==b&&c==w){var S=ji.MODEL.suitNeedNum(h);I[S]=h}}for(S in d+=16,I){var k=!1,E=I[S];w=ji.MODEL.level(E),x=ji.MODEL.suitNeedNum(E);var T=0;for(y in l)y==w&&(T+=l[y]);x<=T&&(k=!0);var C=k?"#e0d6c1":"#5f5952",L=k?"#23b11f":"#5f5952";if(""!=M){var M=ji.MODEL.attributes(E),A=aa.formatNewAttrToChinese(M,!1,!0,!1);n._box.graphics.fillText(x+RP.n[601],29,d,RP.n[602],C,"left");var D,O=0;for(var P in A)D=A[P],n._box.graphics.fillText(D.name+"+"+D.val,120+O%2*200,d,"24px SimHei",L,"left"),d+=++O%2==0&&0<Math.floor(O/2)?n.GAP_Y:0;0}}if(n.cost.visible=!1,n.btn_go.visible=!1,n.img_max.visible=!1,n.lbl_alert.visible=!1,!t)return n.g_line.visible=!1,d+=35,n._box.height=d,void(n.height=d);if(n._dto.positionLevel>=AR.ins.MAX_POSITION_LEVEL)return n.img_max.visible=!0,n.g_line.y=d,d+=118,void(n.height=d);var R=AR.ins.getWearSuitLimit(n._dto.positionLevel+1);if(null==s.equips.getPart(n._dto.position)||n._dto.flyupLevel<=n._dto.positionLevel||R>n._dto.flyupLevel)return n.btn_go.visible=!0,n.btn_go.disabled=!0,n.btn_go.label=0==n._dto.positionLevel?"激 活":"升 级",n.lbl_alert.visible=!0,n.lbl_alert.changeText("穿戴"+R+RP.n[603]),n.g_line.y=d,d+=165,void(n.height=d);for(n.cost.visible=!0,n.btn_go.visible=!0,n.g_line.y=d,d+=28,n.cost.y=d,n.img_active.visible=0==n._dto.positionLevel,n.btn_go.label=0==n._dto.positionLevel?"激 活":"升 级",h=0;h<n._cost.length;h++)n._cost[h].visible=!1;n._cbox||(n._cbox=new dt,n._cbox.pos(195,0),n.cost.addChild(n._cbox)),n._cbox.graphics.clear();var N=AR.ins.getNextSuit(n._dto),B=JSON.parse(AR.ins.getSuitConsume(N));for(h=0;h<B.length;h++){var H;n._cost.length<=h?((H=new MF(45)).needGridBg=!1,H.needEffect=!1,n.cost.addChild(H),n._cost.push(H)):H=n._cost[h],H.pos(141,n.GAP_CY*h-12),H.visible=!0;var V=B[h];if("goods"==V.type){var G=V.value,U=parseInt(G.split(":")[0]),F=parseInt(G.split(":")[1]),q=TR.ins.getGoodsNum(U),j=F<=q?"#23b11f":"#ff2e24";H.bindData=yB.create(U),n._cbox.graphics.fillText(mp.getBigIntStr(q)+"/"+F,0,h*n.GAP_CY,"24px SimHei",j,"left")}}n.btn_go.showTip=AR.ins.isAbleGrowEquip(n._dto),d+=B.length*n.GAP_CY,d+=110,n._box.height=d,n.height=d,5==gR.ins.actorFlyUpBosstask&&null==n._handEff&&(n._handEff=kB.createEffect("jm1081",n.width/2,n.height-70,n))},i.refresh=function(){null!=this._dto&&-1!=this._actorId&&this.showTips(this._dto,this._showGrow,this._actorId)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_go.off("click",this,this.onActive),this._box.graphics.clear(),this._dto=null},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onActive)},i.onActive=function(e){this.btn_go.gray||null!=this._dto&&(null!=this._handEff&&(this._handEff.destroy(),this._handEff=null),hN.ins.open("SOARING_EQUIP_GROW_VIEW",{data:this._dto,actorId:this._actorId})),this.close(!1)},i.close=function(e){void 0===e&&(e=!1),hN.ins._closePanel(this)},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===n&&(n=""),void 0===s&&(s=""),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},p(1,t,"ins",function(){return t._instance=t._instance||new t},layouts.actor.soaring.other.SoaringEquipTip2UI._$SET_ins),t._instance=null,t.GRAY="#5f5952",t}(),KX=function(e){function t(){var e=this;e.GAP_Y=42,e._grid=null,e._dto=null,e._achieves=null,e._offsetY=0,e._actorId=0,e._btnEffect=null,t.__super.call(e),e.panel.vScrollBarSkin="",e.panel.mouseEnabled=!0,e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e._grid.toolTipEnabled=!1,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1),e.txt_tip.text=RP.n[604],e.txt_tip.color="#23b11f"}b(t,"modules.actor.views.soaring.SoaringEquipTip",If);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onActive),t.panel.vScrollBar.off("change",t,t.onScrollEnd),null!=t._btnEffect&&(t._btnEffect.removeSelf(),t._btnEffect.dispose(),t._btnEffect=null)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onActive),this.panel.vScrollBar.on("change",this,this.onScrollEnd)},i.addGuide=function(){4==gR.ins.actorFlyUpBosstask&&(LY.Ins().showforDir(0,RP.n[605],this.btn_go,!0,!1,0,0,!1),LY.Ins().lockSceneShowByDisPlay(this.btn_go))},i.onActive=function(e){var t=this._dto.goodsId,i=TR.bagModel.getDto(t);i&&bR.reqWear(this._actorId,i.uuId),4==gR.ins.actorFlyUpBosstask&&(gR.ins.actorFlyUpBosstask=1,LY.Ins().closeArrow()),this.close(!1)},i.show=function(e){this.showTips(e)},i.showTips=function(e,t,i,n){var s,o=this;void 0===t&&(t=!1),void 0===i&&(i=-1),void 0===n&&(n=!1),null!=o._btnEffect&&(o._btnEffect.removeSelf(),o._btnEffect.dispose(),o._btnEffect=null),o.panel.scrollTo(0,0),o._dto=e,o._grid.bindData=o._dto,o._actorId=i,s=0==n?gR.ins.actorById(o._actorId):pR.ins.actorById(i),o.boxAttr.graphics.clear();var a=o._dto.cfgIdx,r=Bi.MODEL.colourId(a);1<r?(o.grade.visible=!0,o.grade.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+r+".png")):o.grade.visible=!1,o.txt_name.changeText(Bi.MODEL.name(a)),o.txt_name.color=ms.getByQuality(r),o.txt_part.changeText(la.getSoaringName(Bi.MODEL.decoratePosition(a)));var l=Bi.MODEL.flyLevel(a),c=Bi.MODEL.minUseLevel(a);0<l?(o.txt_level.changeText(l+"转"),o.txt_level.color=gR.ins.zsLv>=l?"#90877b":"#ff2e24"):(o.txt_level.changeText(c+"级"),o.txt_level.color=gR.ins.lv>=c?"#90877b":"#ff2e24");var u=PR.getGoodsNewAttr(o._dto.goodsId),d=aa.formatNewAttrToChinese(u,!1,!1);o.fight_num.value=RR.getFight(u)+Bi.MODEL.fight(a);var h,_=lR.instance().getModuleByGodPart(e.decoratePosition),f=0;o._offsetY=o.box_jichu.y+o.box_jichu.height+20;for(var p=0,g="",v=0;v<d.length;v++){var m=d[v],y=m.name+":",I=m.val+"";0<o._dto.random&&(I+=" +"+aa.getFormatValue(m.id,m.val*o._dto.randomRate>>0));var b,w,x,S=24;if(o.drawAttr(o.boxAttr,y,"#90877b",I,"#90877b",30,o._offsetY,S),0<(h=lR.instance().getInnerDragonTypeList(o._actorId,n)).longwenData.length)for(var k in b=h.longwenData){var E;for(var T in x=b[k],u=jt.MODEL.attrs(x.dragonIndex-1),f=0,w=aa.formatAttrToChineseByList(u,!1,!0,!1))if((E=w[T]).module==_){f=E.val;break}0<f&&(p=f,g=jt.MODEL.name(x.dragonIndex),y=" +"+Math.floor(m.val*f/1e4),o.drawAttr(o.boxAttr,y,"#23b11f","","#23b11f",230,o._offsetY,S))}o._offsetY+=S+14}y="龙纹·";var C=parseInt($e.MODEL.value($e.getIndex(234))),L="#23b11f";""==g?(y+=la.getLongwenDefaultName(e.decoratePosition),y+=RP.n[606],L="#5f5952"):(y+=g,y+="加成："+(p=Math.min(p,C))/100+"%"),S=24,o.drawAttr(o.boxAttr,y,L,RP.n[607]+C/100+"%）","#e6d80d",30,o._offsetY,S),o._offsetY+=S+14,o.box_jipin.visible=!1,o.box_suit.y=o._offsetY+10;var M=0;(o.btn_go.visible=t)&&null==o._btnEffect&&(o._btnEffect=kB.createEffect("jm1130",o.btn_go.width>>1,o.btn_go.height>>1,o.btn_go),o._btnEffect.scale_X=1.25,o._btnEffect.scale_Y=1.25),o._offsetY+=100;var A="";if(null!=s){M=0;Math.max(o._dto.positionLevel,1);var D=[],O=0;for(v=0;v<8;v++){var P=la.SOARING_EQUIPS[v],R=s.equips.getPart(P);if(null!=R){if(R.position==o._dto.position&&(O=R.positionLevel),0==R.positionLevel)continue;D.hasOwnProperty(R.positionLevel)||(D[R.positionLevel]=0),D[R.positionLevel]++}}for(var N=0 in 0<O&&o.txt_name.changeText("【"+AR.ins.getSuitGradeName(O)+"】"+Bi.MODEL.name(a)),D)(O<=N||1==N&&0==O)&&(M+=D[N]);O=Math.max(O,1),A=AR.ins.getSuitNameByLevel(O,s.job);var B=[];for(v=0;v<ji.count;v++){var H=ji.MODEL.suitType(v),V=ji.MODEL.level(v),G=ji.MODEL.suitNeedNum(v);ji.MODEL.roleType(v);if("flyUpEquip"==H&&O==V){var U=ji.MODEL.suitNeedNum(v);B[U]=v}}for(U in B){var F=!1,q=B[U];V=ji.MODEL.level(q),G=ji.MODEL.suitNeedNum(q);var j=0;for(N in D)V<=N&&(j+=D[N]);G<=j&&(F=!0);var W=ji.MODEL.attributes(q);if(""!=W){var Y=F?"#e0d6c1":"#5f5952",z=F?"#23b11f":"#5f5952",X=aa.formatNewAttrToChinese(W,!1,!0,!1);o.boxAttr.graphics.fillText(G+RP.n[608],30,o._offsetY,RP.n[609],Y,"left");var Q,J=0;for(var Z in X)Q=X[Z],o.boxAttr.graphics.fillText(Q.name+"+"+Q.val,120+J%2*180,o._offsetY,"24px SimHei",z,"left"),J++,o._offsetY+=J%2==0&&0<Math.floor(J/2)?o.GAP_Y:0;0}}}else{for(O=1,A=AR.ins.getSuitNameByLevel(O,o._dto.roleJob),F=!1,B=[],v=0;v<ji.count;v++)H=ji.MODEL.suitType(v),V=ji.MODEL.level(v),G=ji.MODEL.suitNeedNum(v),ji.MODEL.roleType(v),"flyUpEquip"==H&&O==V&&(B[U=ji.MODEL.suitNeedNum(v)]=v);for(U in B)if(F=!1,q=B[U],""!=(W=ji.MODEL.attributes(q))){for(Z in V=ji.MODEL.level(q),G=ji.MODEL.suitNeedNum(q),Y=F?"#e0d6c1":"#5f5952",z=F?"#23b11f":"#5f5952",X=aa.formatNewAttrToChinese(W,!1,!0,!1),o.boxAttr.graphics.fillText(G+RP.n[608],30,o._offsetY,RP.n[609],Y,"left"),J=0,X)Q=X[Z],o.boxAttr.graphics.fillText(Q.name+"+"+Q.val,120+J%2*180,o._offsetY,"24px SimHei",z,"left"),J++,o._offsetY+=J%2==0&&0<Math.floor(J/2)?o.GAP_Y:0;0}}o.txt_suitName.innerHTML=Ql.createColor(A,"#e6d80d")+Ql.createColor("("+M+"/8)","#e6d80d"),o.txt_suitName.x=30,o._offsetY+=4,o.setAchieving(o._dto),o.boxAttr.height=o._offsetY,o.panel.refresh();var K=o.panel.y+o.panel.height+12,$=0,ee=0;o._achieves&&o._achieves.parent&&($=o._achieves.height),o.btn_go.visible&&(o.btn_go.y=K+44,ee=o.btn_go.height+20),o.img_bg_kuang.height=o.panel.y+o.panel.height+ee+60,o.height=o.panel.y+o.panel.height+70+$+ee,o._achieves&&(o._achieves.y=o.panel.y+o.panel.height+60+ee),o.parent||(eq.panelLayer.on("MASK_CLOSE",o,o.onClick),eq.panelLayer.openTip(o)),o.onScrollEnd()},i.onClick=function(e){this.close(!0)},i.onScrollEnd=function(e){this.panel.vScrollBar.value>=this.panel.vScrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},i.onScrollChange=function(e){this.panel.vScrollBar.value>=this.panel.vScrollBar.max&&(this.txt_tip.text=RP.n[612],this.txt_tip.color="#5f5952")},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.setAchieving=function(e){var t=this;Bi.MODEL.achieving(e.cfgIdx)&&e.needGetWay?(t._achieves||(t._achieves=new OQ(ql.create(modules.actor.views.soaring.SoaringEquipTip.instance,modules.actor.views.soaring.SoaringEquipTip.instance.close,null,!1))),t._achieves.pos(0,t.panel.y+t.panel.height+50),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.soaring.SoaringEquipTipUI._$SET_instance),t.GRAY="#5f5952",t._instance=null,t}(),$X=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.actor.views.soaring.subview.SoaringResolveView",vf);var i=t.prototype;return i.init=function(){this.list.itemRender=QX,this.list.vScrollBarSkin="",this.img_title.skin=_r.getAtlasSubPath("soaring/sz_text_fj.png"),this.txt_no.changeText(RP.n[613]),this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,iu.optimizeList(this.list,QX)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this),this.txt_no.visible=!1,this.updateData(),this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged),AR.ins.hasLookResolve=!0,AR.ins.needShowResolveExtraRedDot=!1,Tu.sendToModule("SOARING_OPEN_RESOLVED",["modules.actor.ActorModule"]),bR.reqOpenResoveSign()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.updateData=function(e){var t=AR.ins.getBagSoaringNotUseEquip();this.list.array=t,this.txt_no.visible=t.length<1},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),eQ=function(e){function t(){var e=this;e.SPACE_ITEM=4,e.SPACE_SUB_ITEM=1,e._lstMainItems=null,e._lstSubItems=null,e._curSelectSubItem=null,e._curSelectMainItem=null,e._gridResult=null,e._gridMaterials=null,e._gridLocks=null,e._downPos=null,e._isHideAll=!1,e._effect=null,e._lastSelectCompoundId=0,t.__super.call(e),e.init()}b(t,"modules.actor.views.soaring.subview.SoaringEquipV",bf);var i=t.prototype;return i.init=function(){var e=this;e.equips.vScrollBarSkin="",e.equips.vScrollBar.elasticDistance=200,e._lstSubItems=[],e._lstMainItems=[],e.showJobEquipByIndex(),e.hideAllItem(),e.equips.refresh(),e._gridResult=new MF,e.result.addChild(e._gridResult),e._gridMaterials=[],e._gridLocks=[];for(var t=0;t<2;t++){var i=e["grid"+t],n=e["lock"+t];n.visible=!1;var s=new MF;s.visible=!1,s.needNum=!1,i.addChild(s),e["lbl_num"+t].visible=!1,e._gridMaterials.push(s),e._gridLocks.push(n)}e.img_dot.visible=!1,e.img_dot_reslove.visible=!1,e._effect=kB.createEffect("jm1328",472,575,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),G.stage.on("mousedown",t,t.onMouseDown),t.btnReslove.on("click",t,t.onOpenReslove),t.btnExchange.on("click",t,t.onOpenExchange),t.btnCompound.on("click",t,t.onCompound),t.hideAllItem(),t.updateRedDot(),t.gotoFirstRedDot(),t.updateRedDot()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),G.stage.off("mousedown",t,t.onMouseDown),t.btnCompound.off("click",t,t.onCompound),t.btnReslove.off("click",t,t.onOpenReslove),t.btnExchange.off("click",t,t.onOpenExchange),t._curSelectMainItem=null,t._curSelectSubItem=null},i.onCompound=function(e){var t=this._gridResult.bindData;null!=t&&(bR.reqCompound(t.goodsId),0<TR.ins.getLeftGridNum()?kB.createEffect("jm1317",G.stage.width/2,G.stage.height/2,eq.panelLayer):KQ.ins.showBagRecycle())},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),null!=this._effect&&(this._effect.removeSelf(),this._effect.dispose()),this._effect=null},i.showJobEquipByIndex=function(){var e,t;for(t in this._lstMainItems)(e=this._lstMainItems[t]).visible=!1;var i=AR.ins.lstEquips,n=0;for(var s=0 in i){this._lstMainItems.length<=n?(e=new zX,this.equips.addChild(e),this._lstMainItems.push(e)):(e=this._lstMainItems[n]).visible=!0;for(var o=0;o<pi.count;o++){if(pi.MODEL.flyUpLevel(o)==s){e.lblName.changeText(pi.MODEL.tabName(o));break}}e.dataSource=s,n++}},i.onMouseDown=function(e){var t=this;if((!eq.panelLayer.maskSpr||!eq.panelLayer.maskSpr.parent)&&(G.stage.off("mousedown",t,t.onMouseDown),G.stage.on("mouseup",t,t.onMouseUp),t.equips.parent||t.equips.parent instanceof laya.display.Sprite)){var i,n,s=t.equips.parent.localToGlobal(new Uh(t.equips.x,t.equips.y)),o=new u_(s.x,s.y,t.equips.width,t.equips.height);for(var a in t._lstMainItems){i=t._lstMainItems[a];var r=t.equips.localToGlobal(new Uh(i.x,i.y-t.equips.vScrollBar.value)),l=new u_(r.x,r.y,i.width,i.height);if(l.contains(G.stage.mouseX,G.stage.mouseY)&&o.contains(G.stage.mouseX,G.stage.mouseY))return void(t._downPos=new Uh(G.stage.mouseX,G.stage.mouseY))}for(var c in t._lstSubItems)if(n=t._lstSubItems[c],r=t.equips.localToGlobal(new Uh(n.x,n.y-t.equips.vScrollBar.value)),(l=new u_(r.x,r.y,n.width,n.height)).contains(G.stage.mouseX,G.stage.mouseY)&&o.contains(G.stage.mouseX,G.stage.mouseY))return void(t._downPos=new Uh(G.stage.mouseX,G.stage.mouseY))}},i.onMouseUp=function(e){var t=this;if(G.stage.on("mousedown",t,t.onMouseDown),G.stage.off("mouseup",t,t.onMouseUp),null!=t._downPos&&t.equips&&t.equips.vScrollBar){var i,n;for(var s in t._lstMainItems){i=t._lstMainItems[s];var o=t.equips.localToGlobal(new Uh(i.x,i.y-t.equips.vScrollBar.value)),a=new u_(o.x,o.y,i.width,i.height);if(a.contains(G.stage.mouseX,G.stage.mouseY)&&a.contains(t._downPos.x,t._downPos.y))return t.onClickItem(i),void(t._downPos=null)}for(var r in t._lstSubItems)if(n=t._lstSubItems[r],o=t.equips.localToGlobal(new Uh(n.x,n.y-t.equips.vScrollBar.value)),(a=new u_(o.x,o.y,n.width,n.height)).contains(G.stage.mouseX,G.stage.mouseY)&&a.contains(t._downPos.x,t._downPos.y))return t.onClickItem(n),void(t._downPos=null)}},i.updateView=function(){if(this.updateRedDot(),null!=this._curSelectSubItem){var e=this._curSelectSubItem.dataSource;this.showEquipItem(e)}},i.onOpenReslove=function(e){hN.ins.open("SOARING_RESOLVE_VIEW")},i.onOpenExchange=function(e){hN.ins.open("SOARING_PIECE_EXCHANGE",32559)},i.onClickItem=function(e){var t=this;if(e instanceof modules.actor.views.soaring.subview.SoaringEquipItem){var i=e,n=i.dataSource;if(t._curSelectMainItem==i&&!t._isHideAll)return void t.hideAllItem();t._curSelectMainItem!=i&&(t._curSelectSubItem=null,t.hideAllItem());var s=t._lstMainItems.indexOf(i);if(t._lstMainItems.length-1==s||t._lstMainItems[s+1]instanceof modules.actor.views.soaring.subview.SoaringEquipItem){var o=0,a=t.showDotIndexs2(n);a&&0<a.length?o=a[0]:null!=t._curSelectSubItem&&(o=t._lstSubItems.indexOf(t._curSelectSubItem)),t.showSubItem(i,o),t.updateRedDot()}t.equips.refresh()}else if(e instanceof modules.actor.views.soaring.subview.SoaringEquipSubItem){var r=e;if(t._curSelectSubItem==r)return;o=t._lstSubItems.indexOf(r),null!=t._curSelectMainItem&&t.showSubItem(t._curSelectMainItem,o)}},i.showDotIndexs2=function(e){var t=[],i=AR.ins.getCompoundDotPositionItems();for(var n=0 in i){var s=i[n];if(s.flyupLevel==e){var o,a=AR.ins.lstEquips[e],r=0;for(var l in a){o=a[l],null!=AR.ins.getExchangeConsume(o)&&(o==s&&t.push(r),r++)}}}return t},i.updateRedDot=function(){var e;for(var t in this._lstSubItems)this._lstSubItems[t].dot=!1;for(var i in this._lstMainItems){var n=(e=this._lstMainItems[i]).dataSource,s=this.showDotIndexs2(n);if(e.dot=0<s.length,this._curSelectMainItem==e){var o=0;for(t in this._lstSubItems)this._lstSubItems[t].dot=-1!=s.indexOf(o),o++}}var a=0<AR.ins.getBagSoaringNotUseEquip().length;this.img_dot_reslove.visible=a},i.gotoFirstRedDot=function(){var e;for(var t in this._lstMainItems)if((e=this._lstMainItems[t]).dot){this.hideAllItem();var i=e.dataSource,n=this.showDotIndexs2(i),s=0;return 0<n.length&&(s=n[0]),void this.showSubItem(e,s)}0<this._lstMainItems.length&&this.showSubItem(this._lstMainItems[0],0)},i.showSubItem=function(e,t){var i,n=this;void 0===t&&(t=0),(n._curSelectMainItem=e).selected=!0,null!=n._curSelectSubItem&&(n._curSelectSubItem.selected=!1);var s=e.dataSource,o=AR.ins.lstEquips[s],a=0,r=0;for(var l in o){var c=o[l];AR.ins.getExchangeConfigId(c.goodsId)&&(n._lstSubItems.length<=a?(i=new JX,n._lstSubItems[a]=i):i=n._lstSubItems[a],n.equips.addChild(i),i.lblName.changeText(c.name),i.dataSource=c,i.x=e.width-i.width>>1,i.y=e.y+e.height+n.SPACE_ITEM+a*(i.height+n.SPACE_SUB_ITEM),r=i.y+i.height+n.SPACE_ITEM,a==t?(i.selected=!0,n._curSelectSubItem=i,n.showEquipItem(c)):i.selected=!1,a++)}if(n._isHideAll=!1,0!=r){a=0;for(var u=n._lstMainItems.indexOf(e)+1;u<n._lstMainItems.length;u++){var d=n._lstMainItems[u];d.y=a*(d.height+n.SPACE_ITEM)+r,a++}}},i.hideAllItem=function(){var e;for(e in this._lstSubItems)this._lstSubItems[e].removeSelf();for(var t=0,i=0;i<this._lstMainItems.length;i++){var n=this._lstMainItems[i];n.y=t*(n.height+this.SPACE_ITEM)+14,n.selected=!1,t++}this.equips.refresh(),this._isHideAll=!0},i.showEquipItem=function(e){var t=this;this._gridResult.bindData=e;var i=AR.ins.getExchangeConsume(e),n=!0;null==i&&(n=!1);for(var s=0;s<2;s++){var o=this._gridMaterials[s],a=this._gridLocks[s],r=this["lbl_num"+s],l=this["lbl_name"+s];if(i&&i.length>s){var c=i[s].value.split(":"),u=parseInt(c[0]),d=TR.ins.getGoodsNum(u),h=parseInt(c[1]);o.bindData=yB.create(u),o.visible=!0,r.visible=!0,a.visible=!1;var _=h<=d?"#23b11f":"#ff2e24";r.innerHTML=Ql.createColor(mp.getBigIntStr(d),_)+Ql.createColor("/"+h,"#e0d6c1"),d<h&&(n=!1);var f=Bi.getIndex(u);l.color=ms.getByQuality(Bi.MODEL.colourId(f)),l.text=Bi.MODEL.name(f),l.visible=!0}else o.bindData=null,o.visible=!1,r.visible=!1,l.visible=!1,a.visible=!0}this.btnCompound.disabled=!n;Bi.MODEL.flyUpLevel(e.cfgIdx),Bi.MODEL.decoratePosition(e.cfgIdx);var p=0<TR.ins.getGoodsNum(e.goodsId),g=AR.ins.getCompoundDotPositionItems();if(this.img_dot.visible=-1!=g.indexOf(e),this._lastSelectCompoundId!=e.goodsId&&this.img_dot.visible)this._lastSelectCompoundId=e.goodsId;else if(this._lastSelectCompoundId==e.goodsId&&!this.img_dot.visible&&p&&0<g.length)return void G.timer.once(900,this,function(){t.updateRedDot(),t.gotoFirstRedDot(),t.updateRedDot()});this.lbl_result.color=ms.getByQuality(Bi.MODEL.colourId(e.cfgIdx)),this.lbl_result.text=Bi.MODEL.name(e.cfgIdx)},i.refreshToSEquip=function(e){if(e){this.hideAllItem();var t=e._pos.split(",");this.showSubItem(this._lstMainItems[parseInt(t[0])-1],parseInt(t[1])%60-2)}},t}(),tQ=function(t){function i(){var e=this;e._id=0,e.rate1=0,e.rate2=0,e.goods1ID=0,e._grid1=null,e._text1Num=null,e.goods2ID=0,e._grid2=null,e._text2Num=null,e.curNum=1,e.maxNum=1,e.minNum=1,e.lastNum1=0,e.lastNum2=0,e.lastTime=NaN,i.__super.call(e)}b(i,"modules.actor.views.soaring.subview.SoaringPieceExchange",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid1=new MF,e._grid1.pos(92,130),e.addChild(e._grid1),e._grid2=new MF,e._grid2.pos(396,130),e.addChild(e._grid2),e._text1Num=kB.createText(92,215,106,0,"",22,"#e0d6c1",!1,"right"),e.addChild(e._text1Num),e._text2Num=kB.createText(396,215,106,0,"",22,"#e0d6c1",!1,"right"),e.addChild(e._text2Num)},e.onAdd=function(e){var t=this;t.btn_buy.on("click",t,t.exchange),t.btn_close.on("click",t,t.closeSelf),t.btn_add1.on("click",t,t.changeNumClicked),t.btn_add10.on("click",t,t.changeNumClicked),t.btn_sub1.on("click",t,t.changeNumClicked),t.btn_sub10.on("click",t,t.changeNumClicked)},e.onRemove=function(e){var t=this;t.btn_buy.off("click",t,t.exchange),t.btn_close.off("click",t,t.closeSelf),t.btn_add1.off("click",t,t.changeNumClicked),t.btn_add10.off("click",t,t.changeNumClicked),t.btn_sub1.off("click",t,t.changeNumClicked),t.btn_sub10.off("click",t,t.changeNumClicked)},e.initialize=function(){this.lastTime=0},e.numChangeHandler=function(e){var t=e,i=t*this.rate1;this._text1Num.text=i+"",this._text2Num.text=t*this.rate2+""},e.closeSelf=function(){hN.ins.close("SOARING_PIECE_EXCHANGE")},e.exchange=function(){if(this.maxNum<=0){var e=RP.n[614],t=Bi.getIndex(this.goods1ID),i=Bi.MODEL.simpleName(t);return e=mp.getFormat(e,[i,this.rate1]),void zB.ins.showMsg(e,1)}var n=pt.now();100<n-this.lastTime&&(OR.requestExchange(this._id,this.curNum*this.rate2),this.lastTime=n)},e.bindData=function(e){var t=this;if(e){t._id=e;var i=xa.getIndex(t._id),n=xa.MODEL.consumption(i);if(n&&0<n.length){var s=JSON.parse(n);if(s&&0<s.length){var o=s[0];if(o&&o.value&&0<o.value.length){var a=o.value.split(":");a&&1<a.length&&(t.goods1ID=parseInt(a[0]),t.rate1=parseInt(a[1]))}}}var r=xa.MODEL.reward(i);if(r&&0<r.length){var l=JSON.parse(r);if(l&&0<l.length){var c=l[0];if(c&&c.value&&0<c.value.length){var u=c.value.split(":");u&&1<u.length&&(t.goods2ID=parseInt(u[0]),t.rate2=parseInt(u[1]))}}}t.lastNum1=TR.ins.getGoodsNum(t.goods1ID),t.lastNum2=TR.ins.getGoodsNum(t.goods2ID);var d=yB.create(t.goods1ID);t._grid1.bindData=d;var h=yB.create(t.goods2ID);t._grid2.bindData=h;var _=Bi.getIndex(t.goods1ID),f=Bi.MODEL.name(_),p=ms.getByQuality(Bi.MODEL.colourId(_)),g=kB.createText(26,254,250,0,f,22,p);t.addChild(g),_=Bi.getIndex(t.goods2ID),f=Bi.MODEL.name(_),p=ms.getByQuality(Bi.MODEL.colourId(_));var v=kB.createText(330,254,250,0,f,22,p);t.addChild(v),t.setMaxNum(),t.numChangeHandler(t.minNum)}else xs.printStack(RP.n[615])},e.setMaxNum=function(){var e=TR.ins.getGoodsNum(this.goods1ID),t=Math.floor(e/this.rate1);this.maxNum=t},e.update=function(){var e=TR.ins.getGoodsNum(this.goods1ID),t=TR.ins.getGoodsNum(this.goods2ID);e<this.lastNum1&&t>this.lastNum2&&(this.exchangeSuccess(),this.lastNum1=e,this.lastNum2=t)},e.exchangeSuccess=function(){this.setMaxNum(),this.curNum=this.minNum,this.txt_curNum.text=this.curNum+"",this.numChangeHandler(this.curNum),zB.ins.playGetItems([this.goods2ID])},e.changeNumClicked=function(e){var t=this,i=0;switch(e.target){case t.btn_add1:i=t.curNum+1;break;case t.btn_add10:(i=t.curNum+10)>t.maxNum&&(i=t.maxNum);break;case t.btn_sub1:i=t.curNum-1;break;case t.btn_sub10:(i=t.curNum-10)<t.minNum&&(i=t.minNum)}i<=t.maxNum&&i>=t.minNum&&i!=t.curNum&&(t.curNum=i,t.txt_curNum.text=i+"",t.numChangeHandler(i))},i}(Sf),iQ=function(e){function t(){this.longwenData=null,t.__super.call(this),this.longwenData=lR.instance()}b(t,"modules.actor.views.soaring.SoaringLongwenTip",xf);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onOpenLongWenListener)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_go.off("click",this,this.onOpenLongWenListener)},i.showTips=function(e){var t=this;t.txt_0_part.text=RP.n[616],t.txt_1_part.text=RP.n[617],t.txt_2_part.text=RP.n[618],t.txt_3_part.text=RP.n[619],t.txt_4_part.text=RP.n[620],t.txt_5_part.text=RP.n[621],t.txt_6_part.text=RP.n[622],t.txt_7_part.text=RP.n[623];var i=new Object;i.wq=0,i.yf=0,i.tk=0,i.xl=0,i.sz=0,i.yd=0,i.jz=0;for(var n=i.xz=0;n<8;n++){var s=MR.ins.getEquip(e+1,52+n);if(s)for(var o=jt.MODEL.attrs(s.dragonIndex-1),a=JSON.parse(o),r=0;r<a.length;r++)"FLYUP_WEAPON_BASE"==a[r].module?i.wq+=parseInt(a[r].value)/100:"FLYUP_UPPER_BODY_BASE"==a[r].module?i.yf+=parseInt(a[r].value)/100:"FLYUP_HEAD_BASE"==a[r].module?i.tk+=parseInt(a[r].value)/100:"FLYUP_NECKLACE_BASE"==a[r].module?i.xl+=parseInt(a[r].value)/100:"FLYUP_BRACE_LET_BASE"==a[r].module?i.sz+=parseInt(a[r].value)/100:"FLYUP_BELT_BASE"==a[r].module?i.yd+=parseInt(a[r].value)/100:"FLYUP_RING_BASE"==a[r].module?i.jz+=parseInt(a[r].value)/100:"FLYUP_SHOE_BASE"==a[r].module&&(i.xz+=parseInt(a[r].value)/100)}for(var l in i)"wq"==l?t.txt_0_part.text=RP.n[624]+i.wq+"%":"yf"==l?t.txt_1_part.text=RP.n[625]+i.yf+"%":"tk"==l?t.txt_2_part.text=RP.n[626]+i.tk+"%":"xl"==l?t.txt_3_part.text=RP.n[627]+i.xl+"%":"sz"==l?t.txt_4_part.text=RP.n[628]+i.sz+"%":"yd"==l?t.txt_5_part.text=RP.n[629]+i.yd+"%":"jz"==l?t.txt_6_part.text=RP.n[630]+i.jz+"%":"xz"==l&&(t.txt_7_part.text=RP.n[631]+i.xz+"%")},i.onOpenLongWenListener=function(){hN.ins.open("LONGWEN_MV_PANEL",0,0)},t}(),nQ=function(e){function o(){var e=this;e.HEJI_JOB_EFFECT_IDS=["","jm1378","jm1379","jm1380"],e._lightEffect1=null,e._lightEffect2=null,e._jobEffects=null,e._circle=null,e._value=NaN,e._cdComplete=-1,e.SKILL_JOB_IDS=[514,524,534],e.HEJI_EFFECT_IDS=[[],["jn10182","jn10183"],["jn10202","jn10203"],["jn10192"]],e.HEJI_HIT_EFFECT_IDS=["","jn10180","jn10201","jn10191"],e.START_DELAY=500,e.RESTART_DELAY=500,e.HEJI_TO_ZHUIJI_DELAY=500,e.ZHUIJI_TO_ZHUIJI_DELAY=300,e.ICON_POSITION=[new Uh(60,80),new Uh(170,80),new Uh(280,80)],e._effect1=null,e._effect2=null,e._hitEffectTwo=null,e._curShowJob=0,e._iconParent=null,e._effectIcons=null,e._effectUsedIds=null,e._flyFonts=null,e._time=0,o.__super.call(e),e.init()}b(o,"modules.actor.views.soaring.subview.SoaringPreview",kf);var t=o.prototype;return t.init=function(){var e=this;e._iconParent=new dt,e._iconParent.size(400,200),e._iconParent.centerX=0,e._iconParent.bottom=400,e._iconParent.mouseEnabled=!1,e.addChild(e._iconParent);var t=gR.ins.actorList[gR.ins.showId-1];e.player.skin=_r.getFullUrl("ui/images/soaring/sex_"+t.sex+".png"),e._effectIcons=[];for(var i=1;i<=3;i++){var n=new xW(i);n.pos(e.ICON_POSITION[i-1].x,e.ICON_POSITION[i-1].y),e._effectIcons.push(n)}null==e._circle&&(e._circle=new pp,e.heji.bar.mask=e._circle),e._effectUsedIds=[],e._flyFonts=[],e.zhuiji.visible=!1,e.div_tip0.innerHTML=zB.ins.getDesc(4316),e.div_tip1.innerHTML=zB.ins.getDesc(4317),e.div_tip2.innerHTML=zB.ins.getDesc(4318),e.div_tip3.innerHTML=zB.ins.getDesc(4319)},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.resetIcons(),this._iconParent.visible=!1,this.zhuiji.visible=!1,this.showLightEffect(),G.timer.once(this.START_DELAY,this,this.showHejiEffect)},t.onRemove=function(e){var t,i=this;for(var n in ui.ViewBase.prototype.onRemove.call(i,e),i.disposeSkillEffects(),i._curShowJob=0,i.removeEffectDelays(),G.timer.clear(i,i.hejiLoopCd),i._effectIcons)i._effectIcons[n].removeSelf();for(var s in i._flyFonts)t=i._flyFonts[s],Og.clearAll(t),t.removeSelf(),t=null;i._flyFonts=[],G.timer.clear(i,i.onZhuiJiSkillEnd),G.timer.clear(i,i.onZhuiJiSkillFakeOut),G.timer.clear(i,o.onPlayHeJiNameEnd),G.timer.clear(i,o.onPlayHeJiFake),i.clearAddUrls(),i.removeLightEffect()},t.setProgress=function(e){var t=this;if((e=180<(e*=180)?180:e)<=0)t.heji.bar.visible=!1;else if(t.heji.bar.visible=!0,180<=e)t.heji.bar.mask=null,G.timer.clear(t,t.hejiLoopCd);else{var i=e/180*360;t.heji.bar.mask=t._circle,t._circle.graphics.clear(),t._circle.graphics.drawPie(t.heji.bar.width>>1,t.heji.bar.height>>1,43,-90,i-90,"#000000"),t._circle.repaint()}},t.useHejiEffect=function(){this.removeLightEffect(),this.setProgress(0),this._cdComplete=dr.curServerTime+6e4,G.timer.loop(300,this,this.hejiLoopCd)},t.removeLightEffect=function(){var e=this;if(e._lightEffect1&&(e._lightEffect1.dispose(),e._lightEffect1=null),e._lightEffect2&&(e._lightEffect2.dispose(),e._lightEffect2=null),null!=e._jobEffects&&0<e._jobEffects.length){for(var t in e._jobEffects)e._jobEffects[t].dispose(),null;e._jobEffects=null}},t.showLightEffect=function(){var e,t=this;if(null==t._lightEffect1&&(e="jm1141",t._lightEffect1=kB.createEffect(e,93,67,t.heji),t._effectUsedIds.push(e),qH.Ins().addNoClears(e)),null==t._lightEffect2&&(e="jm1264",t._lightEffect2=kB.createEffect(e,93,67,t.heji),t._effectUsedIds.push(e),qH.Ins().addNoClears(e)),null==t._jobEffects||0==t._jobEffects.length){t._jobEffects=[];for(var i=1;i<=3;i++){var n=t.heji["img_zhuiji_"+i],s=kB.createEffect(t.HEJI_JOB_EFFECT_IDS[i],n.x+15,n.y+15,t.heji);t._jobEffects.push(s),t._effectUsedIds.push(t.HEJI_JOB_EFFECT_IDS[i]),qH.Ins().addNoClears(t.HEJI_JOB_EFFECT_IDS[i])}}t.setProgress(1)},t.removeEffectDelays=function(){var e=this;G.timer.clear(e,e.playerHejiHitEffect),G.timer.clear(e,e.playerZhuijiHitEffect),G.timer.clear(e,e.playerZhuijiHitEffectTwo),G.timer.clear(e,e.playZhuijiEnd),G.timer.clear(e,e.showNextJobEffect),G.timer.clear(e,e.showHejiEffect),G.timer.clear(e,e.showLightEffect),G.timer.clear(e,e.resetIcons),G.timer.clear(e,e.onCountDown)},t.clearAddUrls=function(){var e;for(var t in this._effectUsedIds)e=this._effectUsedIds[t],qH.Ins().removeNoClears(e);this._effectUsedIds=[]},t.disposeSkillEffects=function(){this._effect1&&(this._effect1.dispose(),this._effect1=null),this._effect2&&(this._effect2.dispose(),this._effect2=null),this._hitEffectTwo&&(this._hitEffectTwo.dispose(),this._hitEffectTwo=null)},t.showHejiEffect=function(){var e=this;if(e.parent){var t,i,n;e.disposeSkillEffects(),e.clearAddUrls(),null==e._lightEffect1&&(t="jm1141",e._lightEffect1=kB.createEffect(t,93,67,e.heji),e._effectUsedIds.push(t),qH.Ins().addNoClears(t)),null==e._lightEffect2&&(t="jm1264",e._lightEffect2=kB.createEffect(t,93,67,e.heji),e._effectUsedIds.push(t),qH.Ins().addNoClears(t));var s=0,o=gR.ins.actorList[gR.ins.showId-1].job,a=0,r=0;switch(o){case ha.FA.type:s=500,n=e.HEJI_EFFECT_IDS[o][0],a=-25,r=80;break;case ha.ZHAN.type:s=800,n=e.HEJI_EFFECT_IDS[o][0],i=e.HEJI_EFFECT_IDS[o][1],a=-20,r=30;break;case ha.DAO.type:s=800,n=e.HEJI_EFFECT_IDS[o][0],i=e.HEJI_EFFECT_IDS[o][1],a=-25,r=80}e._effect1=kB.createEffect(n,e.player.x+r,e.player.y+e.player.height+a,e),e._effectUsedIds.push(n),qH.Ins().addNoClears(n),i&&(e._effect2=kB.createEffect(i,e.player.x+70,e.player.y+e.player.height+-30,e),e._effectUsedIds.push(i),qH.Ins().addNoClears(i)),G.timer.once(s,e,e.playerHejiHitEffect,[o]),e.useHejiEffect()}},t.playerHejiHitEffect=function(e){var t=this;if(t.parent){var i=0,n=0;switch(e){case ha.FA.type:n=85,i=140;break;case ha.ZHAN.type:n=85,i=160;break;case ha.DAO.type:n=80,i=150;var s="jn10193";kB.createEffect(s,t.monster.x+n,t.monster.y+i,t),t._effectUsedIds.push(s),qH.Ins().addNoClears(s),t.addChild(t.monster)}t._hitEffectTwo=kB.createEffect(t.HEJI_HIT_EFFECT_IDS[e],t.monster.x+n,t.monster.y+i,t),t._effectUsedIds.push(t.HEJI_HIT_EFFECT_IDS[e]),qH.Ins().addNoClears(t.HEJI_HIT_EFFECT_IDS[e]),t._hitEffectTwo.playEndHandler=ql.create(t,t.playZhuijiEffect),t.playHeJiNameImage(t.monster,e)}},t.playZhuijiEffect=function(){var e=this;e.disposeSkillEffects(),e.removeEffectDelays(),e._iconParent.visible=!0,e.zhuiji.visible=!0,G.timer.once(e.HEJI_TO_ZHUIJI_DELAY,e,e.showNextJobEffect),e._time=5e3,G.timer.loop(10,e,e.onCountDown)},t.showNextJobEffect=function(){var e=0;e=this._curShowJob==ha.DAO.type?ha.ZHAN.type:this._curShowJob+1,this.showEffectByJob(e)},t.onCountDown=function(){this._time-=10,this.txt_countDown.changeText((this._time/1e3).toFixed(2))},t.resetIcons=function(){var e;for(var t in this._effectIcons)null==(e=this._effectIcons[t]).parent&&this._iconParent.addChild(e)},t.showEffectByJob=function(e){var t=this;if(t._curShowJob!=e){t._curShowJob=e;var i=t._effectIcons[t._curShowJob-1];i.playBreakEff2(i.parent,i.x+30,i.y+30);var n=Vn.getIndex(t.SKILL_JOB_IDS[t._curShowJob-1]),s=Vn.MODEL.effect_play(n);t.disposeSkillEffects();var o=1400;switch(e){case ha.ZHAN.type:t._effect1=kB.createEffect(s,t.player.x+60,t.player.y+220,t),t._effect1.scale_X=.7,t._effect1.scale_Y=.7,t._effect1.setDir(3);break;case ha.FA.type:s&&(t._effect1=kB.createEffect(s,t.player.x+60,t.player.y+220,t),t._effect1.scale_X=.7,t._effect1.scale_Y=.7,t._effect1.setDir(3),o=1400);break;case ha.DAO.type:s&&(t._effect1=kB.createEffect(s,t.player.x+60,t.player.y+220,t),t._effect1.scale_X=.7,t._effect1.scale_Y=.7,t._effect1.setDir(3),o=1400),G.timer.clear(t,t.onCountDown)}t.addChild(t._iconParent),t.addChild(t.zhuiji),G.timer.once(o,t,t.playerZhuijiHitEffect,[e]),s&&(t._effectUsedIds.push(s),qH.Ins().addNoClears(s))}},t.playerZhuijiHitEffect=function(e){var t=this,i=200;if(t.parent){var n=Vn.getIndex(t.SKILL_JOB_IDS[t._curShowJob-1]),s=Vn.MODEL.effect_hit(n),o=Vn.MODEL.effect_hit2(n),a=0,r=0;switch(e){case ha.FA.type:a=150,r=85,i=400;break;case ha.ZHAN.type:a=140,r=85,i=400;break;case ha.DAO.type:a=200,r=90,i=700,o=null,t.playerZhuijiHitEffectTwo(e)}t._effect2&&(t._effect2.dispose(),t._effect2=null),t._effect2=kB.createEffect(s,t.monster.x+r,t.monster.y+a,t),t.addChild(t.zhuiji),o?G.timer.once(i,t,t.playerZhuijiHitEffectTwo,[e]):(G.timer.once(i,t,t.playZhuijiEnd,[e]),t.playZhuiJiSkill(t.monster,e)),t.addChild(t._iconParent),s&&(t._effectUsedIds.push(s),qH.Ins().addNoClears(s))}},t.playerZhuijiHitEffectTwo=function(e){var t=this;t._effect2&&(t._effect2.removeSelf(),t._effect2.dispose(),t._effect2=null);var i=Vn.getIndex(t.SKILL_JOB_IDS[t._curShowJob-1]),n=Vn.MODEL.effect_hit2(i);t._hitEffectTwo=kB.createEffect(n,t.monster.x+85,t.monster.y+170,t),t.addChild(t.zhuiji),n&&(t._effectUsedIds.push(n),qH.Ins().addNoClears(n)),t.addChild(t.monster),G.timer.once(800,t,t.playZhuijiEnd,[e]),t.addChild(t._iconParent),t.playZhuiJiSkill(t.monster,e)},t.hejiLoopCd=function(){if(this._cdComplete<dr.curServerTime)return this.setProgress(1),void G.timer.clear(this,this.hejiLoopCd);if(-1!=this._cdComplete){var e=1-(this._cdComplete-dr.curServerTime)/6e4;this.setProgress(e)}else G.timer.clear(this,this.hejiLoopCd)},t.playZhuijiEnd=function(e){var t=this;t.parent&&(e==ha.DAO.type?(t._curShowJob=0,t.disposeSkillEffects(),t.removeEffectDelays(),G.timer.clear(t,t.hejiLoopCd),t.resetIcons(),t._iconParent.visible=!1,t.zhuiji.visible=!1,G.timer.once(t.RESTART_DELAY,t,t.showLightEffect),G.timer.once(t.RESTART_DELAY+t.START_DELAY,t,t.showHejiEffect)):G.timer.once(t.ZHUIJI_TO_ZHUIJI_DELAY,t,t.showNextJobEffect))},t.playHeJiNameImage=function(e,t){var i=0;switch(t){case ha.ZHAN.type:i=501;break;case ha.FA.type:i=502;break;case ha.DAO.type:i=503}var n=_r.getFullUrl("ui/images/actor_heji/"+i+".png");G.loader.getRes(n)?this.onHeJiLoad(e,i,n):G.loader.load(n,ql.create(this,this.onHeJiLoad,[e,i,n]),null,"image")},t.onHeJiLoad=function(e,t,i){var n=new Kl;n.skin=i,n.scaleX=n.scaleY=3,n.x=e.x-n.width+150,n.y=e.y-200*n.scaleX+150,n.alpha=0,this._flyFonts.push(n),Og.to(n,{scaleX:1,scaleY:1,alpha:1,x:e.x-n.width/2-50+150,y:e.y-250},100,pa.cubicInOut),G.timer.once(800,null,function(){o.onPlayHeJiNameEnd(n)}),this.addChild(n)},t.playZhuiJiSkill=function(e,t){var i="";switch(t){case ha.ZHAN.type:i="zj_pz_zbfz";break;case ha.FA.type:i="zj_pz_hbxc";break;case ha.DAO.type:i="zj_pz_shdz"}var n;n=[_r.getFullUrl("ui/images/skill/zj_pz_dt.png"),_r.getFullUrl("ui/images/skill/"+i+".png")],G.loader.load(n,ql.create(this,this.onZhuiJiSkillLoad,[e,n]),null,"image")},t.onZhuiJiSkillLoad=function(e,t){var i=this,n=new pp;this.addChild(n),this._flyFonts.push(n);var s=new Kl;s.skin=t[0],n.addChild(s);var o=new Kl;o.skin=t[1],o.pos(10,10),n.addChild(o),n.scaleX=n.scaleY=3,n.x=e.x,n.y=e.y,n.alpha=0;var a=e.x-o.width/2,r=e.y-200;this.addChild(n),Og.to(n,{scaleX:1,scaleY:1,alpha:1,x:a,y:r},100,pa.cubicInOut),G.timer.once(800,null,function(){i.onZhuiJiSkillEnd(e,n)})},t.onZhuiJiSkillEnd=function(e,t){var i=this;Og.to(t,{alpha:0},500),G.timer.once(800,null,function(){i.onZhuiJiSkillFakeOut(t)})},t.onZhuiJiSkillFakeOut=function(e){e&&NF.scene.contains(e)&&e.removeSelf()},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),G.timer.clearAll(this)},o.onPlayHeJiNameEnd=function(e){Og.to(e,{alpha:0},500),G.timer.once(720,null,function(){o.onPlayHeJiFake(e)})},o.onPlayHeJiFake=function(e){e.dispose(),e.removeSelf(),e=null},o}(),sQ=function(e){function t(){var e=this;e._skill=null,e._expTween=null,e._effBorder=null,e._dot=null,e._grayRect=null,e._maskRect=null,e._rectMaskValue=-1,t.__super.call(e),e._skill=new GF,e._skill.size(110,110),e._skill.pos(-8,-8),e.icon_skill.addChild(e._skill),e._grayRect=new pp,e._grayRect.alpha=.6,e._grayRect.y=12,e._grayRect.graphics.drawRect(0,0,110,110,"#000000"),e.addChild(e._grayRect),e._maskRect=new pp,e._maskRect.size(160,160),e._maskRect.alpha=1,e._grayRect.mask=e._maskRect,e._dot=kB.createSprite(NI.POINT,75,0,0,0,e),e._dot.visible=!1,e.rectMaskValue=0}b(t,"modules.actor.views.soaring.SoaringSkillItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),null!=this._expTween&&this._expTween.clear(),null!=this._effBorder&&this._effBorder.dispose(),this._effBorder=null},i.finishiFly=function(e){null!=this._effBorder&&this._effBorder.dispose(),this._effBorder=null},p(0,i,"rectMaskValue",function(){return this._rectMaskValue},function(e){if(this._rectMaskValue!=e){if(this._rectMaskValue=e,this._maskRect.graphics.clear(),this._grayRect.visible=!0,1<=e)e=.99,this._grayRect.visible=!1;else if(e<=0)return e=0,void(this._grayRect.mask=null);var t=360*(1-e)-90;this._maskRect.graphics.drawPie(55,55,80,-90,t,"#f00"),this._grayRect.mask!=this._maskRect&&(this._grayRect.mask=this._maskRect)}}),p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;null!=t._expTween&&t._expTween.clear(),null!=t._effBorder&&t._effBorder.dispose(),t._effBorder=null;var i=t.dataSource;if(G.superSet(Ef,t,"dataSource",e),null!=t.dataSource){var n=t.dataSource;t._skill.bindData=n.id;var s=n.activeNum;if(n.showTween)if(null!=i&&i.id==n.id)if(i.activeNum<n.activeNum){null==t._expTween?t._expTween=new Og:t._expTween.clear();var o=1e3*(n.activeNum-i.activeNum);null==t._effBorder&&(t._effBorder=kB.createEffect("jm1377",55,67,t)),t._expTween.to(t,{rectMaskValue:s/8},o,null,ql.create(t,t.finishiFly))}else t.rectMaskValue=s/8;else t.rectMaskValue=s/8;else t.rectMaskValue=s/8;if(t._dot.visible=!1,n.hasOwnProperty("state"))switch(n.state){case 1:t._dot.visible=!0,t.addChild(t._dot)}n.hasOwnProperty("showSkillActive")&&(n.showSkillActive&&kB.createEffect("jm1060",60,72,t),n.showSkillActive=!1)}}),t}(Ef),oQ=function(e){function t(){this._downPos=null,this._skillIcons=null,this._zhuijiEffect=null,t.__super.call(this),this.init()}b(t,"modules.actor.views.soaring.subview.SoaringSkillV",Tf);var i=t.prototype;return i.init=function(){var e=this;e.skills.vScrollBarSkin="",e.skills.vScrollBar.elasticDistance=200,e.skills.refresh();var t=new pp;t.size(e.skills.content.width,e.skills.content.height),e.skills.addChild(t);var i=AR.ins.MAX_SKILL_LEVEL;e._skillIcons=[];for(var n=1;n<=i;n++){e.startDrawGrade(t,n);for(var s=1;s<=3;s++)e.startDrawSkillName(t,s,n),e._skillIcons.push(e.addSkillIcon(s,n))}},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.addSkillIcon=function(e,t){var i=AR.ins.getSkillIdByJob(e,t),n=new GF;return n.size(110,110),n.pos(-8,-8),n.bindData=i,this["icon"+((e-1)*AR.ins.MAX_SKILL_LEVEL+t)].addChild(n),n},i.startDrawGrade=function(e,t){var i=_r.getAtlasSubPath("soaring/tj_tjmz_bg.png"),n=G.loader.getRes(i);n?this.drawGradeBg(e,t,n):G.loader.load(i,ql.create(this,this.drawGradeBg,[e,t]),null,"image")},i.drawGradeBg=function(e,t,i){i&&e.graphics.drawTexture(i,33,20+172*(t-1),.68*i.width,.68*i.height),this.startDrawGradeTitle(e,t)},i.startDrawGradeTitle=function(e,t){var i=_r.getAtlasSubPath("soaring/fs_text_"+t+".png"),n=G.loader.getRes(i);n?this.drawGradeTitle(e,t,n):G.loader.load(i,ql.create(this,this.drawGradeTitle,[e,t]),null,"image")},i.drawGradeTitle=function(e,t,i){i&&e.graphics.drawTexture(i,32,41+172*(t-1),i.width,i.height)},i.startDrawSkillName=function(e,t,i){var n=_r.getAtlasSubPath("basic_ui_g/ty_ts_dk.png"),s=G.loader.getRes(n);s?this.drawSkillBg(e,t,i,s):G.loader.load(n,ql.create(this,this.drawSkillBg,[e,t,i]),null,"image")},i.drawSkillBg=function(e,t,i,n){var s;switch(t){case ha.ZHAN.type:s=this.zhanshi;break;case ha.FA.type:s=this.fashi;break;case ha.DAO.type:s=this.daoshi}var o=s.x-18,a=s.y+118+172*(i-1);n&&e.graphics.drawTexture(n,o,a,152,28);var r=AR.ins.getSkillIdByJob(t,i),l=Vn.getIndex(r),c=Vn.MODEL.name(l),u=kB.createText(o,a+4,152,0,c,20,"#90877b",!1,"center",!1,!1,this);e.addChild(u)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),G.stage.on("mousedown",t,t.onMouseDown),t.skills.vScrollBar.on("change",t,t.onScrollChanged),t.txt_setting.on("click",t,t.onShowAutoZhuiJi);var i=ql.create(t,t.redPtUpdate,null,!1);AN.ins.addListener("LINK_SETTING_ZHUIJISoaringSkillV",[253],i),t.updateView()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),G.stage.off("mousedown",t,t.onMouseDown),t.skills.vScrollBar.off("change",t,t.onScrollChanged),t.txt_setting.off("click",t,t.onShowAutoZhuiJi),AN.ins.removeListener("LINK_SETTING_ZHUIJISoaringSkillV"),t.disposeEffect()},i.onShowAutoZhuiJi=function(e){hN.ins.open("ZhuiJiAutoSettingView")},i.onMouseDown=function(e){var t=this;if((!eq.panelLayer.maskSpr||!eq.panelLayer.maskSpr.parent)&&(G.stage.off("mousedown",t,t.onMouseDown),G.stage.on("mouseup",t,t.onMouseUp),t.skills.parent||t.skills.parent instanceof laya.display.Sprite))for(var i=t.skills.parent.localToGlobal(new Uh(t.skills.x,t.skills.y)),n=new u_(i.x,i.y,t.skills.width,t.skills.height),s=AR.ins.MAX_SKILL_LEVEL,o=1;o<=3;o++)for(var a=1;a<=s;a++){var r=t["icon"+((o-1)*s+a)],l=r.parent.localToGlobal(new Uh(r.x,r.y));if(new u_(l.x,l.y,r.width,r.height).contains(G.stage.mouseX,G.stage.mouseY)&&n.contains(G.stage.mouseX,G.stage.mouseY))return void(t._downPos=new Uh(G.stage.mouseX,G.stage.mouseY))}},i.onMouseUp=function(e){var t=this;if(G.stage.on("mousedown",t,t.onMouseDown),G.stage.off("mouseup",t,t.onMouseUp),null!=t._downPos)for(var i=AR.ins.MAX_SKILL_LEVEL,n=1;n<=3;n++)for(var s=1;s<=i;s++){var o=t["icon"+((n-1)*i+s)],a=o.parent.localToGlobal(new Uh(o.x,o.y)),r=new u_(a.x,a.y,o.width,o.height);if(r.contains(G.stage.mouseX,G.stage.mouseY)&&r.contains(t._downPos.x,t._downPos.y))return t.onClickItem(n,s),void(t._downPos=null)}},i.onClickItem=function(e,t){var i=AR.ins.getSkillIdByJob(e,t),n=gR.ins.actorByJob(e),s=!1;n&&(s=AR.ins.getActorUseLevel(n)>=t),uQ.instance.showById(i,s?"":RP.n[632]+Math.max(1,t)+RP.n[633])},i.updateView=function(){for(var e,t=AR.ins.MAX_SKILL_LEVEL,i=1;i<=3;i++){for(var n=1;n<=t;n++){var s=this["icon"+((i-1)*t+n)];this.setGray(s,!0)}var o=this["progress"+i];o.height=0}for(var a in gR.ins.actorList){var r=(e=gR.ins.actorList[a]).job,l=AR.ins.getActorUseLevel(e);for(o=this["progress"+r],n=1;n<=t;n++)s=this["icon"+((r-1)*t+n)],this.setGray(s,l<n),n<=l&&(o.height=s.parent.y)}},i.redPtUpdate=function(e,t){switch(e){case"LINK_SETTING_ZHUIJISoaringSkillV":AN.ins.getStateByCareList([253])?null==this._zhuijiEffect&&(this._zhuijiEffect=kB.createEffect("jm1382",this.txt_setting.x+75,this.txt_setting.y+this.txt_setting.height/2,this),this._zhuijiEffect.scale_X=.4,this._zhuijiEffect.scale_Y=.5):this.disposeEffect()}},i.disposeEffect=function(){this._zhuijiEffect&&(this._zhuijiEffect.parent&&this._zhuijiEffect.parent.removeChild(this._zhuijiEffect),this._zhuijiEffect.dispose(),this._zhuijiEffect=null)},i.setGray=function(e,t){if(t){var i=[];i=(i=(i=(i=i.concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([0,0,0,1,0]);var n=new ys(i);e.filters=[n]}else e.filters=[]},i.onScrollChanged=function(){0==this.skills.vScrollBar.max||this.skills.vScrollBar.value>=this.skills.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),aQ=function(e){function a(){var e=this;e.CONFIG=RP.n[583],e._selector=null,e.avatar=null,e.avatarW=null,e._gridBases=null,e._gridInteriors=null,e._dotBases=null,e._dotInteriors=null,e._lastDataSource=null,e._curSuitData=null,e._flyEffects=null,e._flyTweens=null,e.FLY_EFFECT_SPEED=.5,e._isFirstOpen=!1,e._clickData=null,a.__super.call(e),e.init()}b(a,"modules.actor.views.soaring.subview.ActorSoaringV2",Df);var t=a.prototype;return t.init=function(){var e=this;e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.addChild(e._selector),e._dotBases=[],e._dotInteriors=[],e.avatarW=new CF,e.avatarW.pos(-334,335),e.addChildAt(e.avatarW,2),e.avatar=new CF,e.avatar.pos(-334,335),e.addChildAt(e.avatar,3),e._gridBases=[],e._gridInteriors=[];for(var t=0;t<la.SOARING_EQUIPS_UI_POS.length;t++){var i=la.SOARING_EQUIPS[t],n=e["equip"+i],s=kB.createText(n.x-n.width/2,n.y+116+2-n.height/2,116,0,la.getSoaringName(i),20,"#90877b",!1,"center",!1,!1,e);e.addChild(s);var o=new MF;o.mouseEnabled=!1,n.addChild(o),e._gridBases.push(o)}for(t=0;t<la.SOARING_INTERIOR_UI_POS.length;t++)n=e["equip"+(i=la.SOARING_INTERIOR_UI_POS[t])],s=kB.createText(n.x-n.width/2,n.y+116+2-n.height/2,116,0,la.getSoaringName(i),20,"#90877b",!1,"center",!1,!1,e),e.addChild(s),(o=new MF).mouseEnabled=!1,n.addChild(o),e._gridInteriors.push(o);e.lstGrade.itemRender=sQ,e.lstGrade.hScrollBarSkin="",e.lstGrade.scrollBar.elasticBackTime=300,e.lstGrade.scrollBar.elasticDistance=100,e.lstGrade.mouseHandler=ql.create(e,e.onSelectSkill,null,!1),e.buy.visible=!1},t.showByVSC=function(e,t){var i=this;i._isFirstOpen=!0,-1!=a.lastIndex?(i._selector.selectIdx=a.lastIndex,a._curSelector=i._selector.selectIdx):i._selector.invalid(),i._selector.on("select",i,i.onSelectActor);for(var n=0;n<la.SOARING_EQUIPS_UI_POS.length;n++){var s=la.SOARING_EQUIPS[n],o=i["equip"+s];o.on("click",i,i.onClickBaseEquip)}for(n=0;n<la.SOARING_INTERIOR_UI_POS.length;n++)(o=i["equip"+(s=la.SOARING_INTERIOR_UI_POS[n])]).on("click",i,i.onClickInteriorEquip);i.lstGrade.scrollBar.on("end",i,i.onScrollEnd),i.lstGrade.on("mousewheel",i,i.onScrollEnd),i.btnNext.on("click",i,i.onNext),i.btnPrev.on("click",i,i.onPrev),i.btn_suit.on("click",i,i.onOpenSuit),i.txt_buy.on("click",i,i.onGotoBuy),i.btn_longwen.on("click",i,i.onShowLongWenTips),i.updateView()},t.hideByVSC=function(e,t){var i=this;i._selector.off("select",i,i.onSelectActor);for(var n=0;n<la.SOARING_EQUIPS_UI_POS.length;n++){var s=la.SOARING_EQUIPS[n],o=i["equip"+s];o.off("click",i,i.onClickBaseEquip)}for(n=0;n<la.SOARING_INTERIOR_UI_POS.length;n++)(o=i["equip"+(s=la.SOARING_INTERIOR_UI_POS[n])]).off("click",i,i.onClickInteriorEquip);i.lstGrade.scrollBar.off("end",i,i.onScrollEnd),i.lstGrade.off("mousewheel",i,i.onScrollEnd),i.btnNext.off("click",i,i.onNext),i.btnPrev.off("click",i,i.onPrev),i.btn_suit.off("click",i,i.onOpenSuit),i.txt_buy.off("click",i,i.onGotoBuy),a.lastIndex=0,i._clickData=null,i._lastDataSource=null},t.onOpenSuit=function(e){var t=this._selector.selectIdx+1;gR.ins.actorById(t);lQ.ins.showTips(t)},t.selectActor=function(e){this._selector.selectIdx=e-1,a._curSelector=this._selector.selectIdx},t.updateSkills=function(){for(var e=this,t=e._selector.selectIdx+1,i=gR.ins.actorById(t),n=AR.ins.MAX_SKILL_LEVEL,s=[],o=-1,a=!1,r=1;r<=n;r++){var l=AR.ins.getSkillIdByJob(i.job,r),c=AR.ins.getActiveNum(i,r),u=0;8<=c&&(u=1,i.zhuijiSkillLevel+1==r?o=Math.max(0,r-2):u=2);var d={id:l,activeNum:c,showTween:!1,state:u,showSkillActive:!1};if(null!=e._lastDataSource){var h=e._lastDataSource[s.length];h.activeNum<d.activeNum?a=d.showTween=!0:h.state!=d.state&&(a=!0,1==h.state&&2==d.state&&(d.showSkillActive=!0,kB.createEffect("jm1426",355,575,e)))}s[s.length]=d}if(-1==o){var _=AR.ins.getActorActivingMaxLevel(i),f=AR.ins.getActorUseLevel(i);o=f<_?Math.max(0,_-2):Math.max(0,f-2)}1!=a&&1!=e._isFirstOpen||(e.lstGrade.dataSource=s,e.lstGrade.tweenTo(o,200,ql.create(e,e.onScrollEnd)),e.onScrollEnd()),e._lastDataSource=s,e._isFirstOpen=!1},t.onShowLongWenTips=function(){var e=$e.MODEL.value($e.getIndex(78));gR.ins.lv>=parseInt(e)?hN.ins.open("SOARING_LONGWEN_TIP",this._selector.selectIdx):zB.ins.playErrorMsg(parseInt(e)+RP.n[635])},t.onGotoBuy=function(e){if(this.isOpenAndNotBuyAward){if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);var t=this.CONFIG.split("|");6<t.length&&(eU.targetId=parseInt(t[5])),eU.toSelectIndex=parseInt(t[2]),CN.dealActIcon(CN.getIconBtn(46))}else zB.ins.showMsg(RP.n[636],1),this.buy.visible=!1},t.onSelectSkill=function(e,t){if("click"==e.type){var i=this.lstGrade.array[t],n=this._selector.selectIdx+1,s=gR.ins.actorById(n),o=AR.ins.getActorUseLevel(s),a=s.zhuijiSkillLevel,r=t<o,l=0;r?t==a?l=1:a<t&&(l=2):l=3,uQ.instance.showById(i.id,r?"":RP.n[637]+Math.max(1,t+1)+RP.n[638],n,l)}},t.onScrollEnd=function(){var e=this;e.lstGrade.scrollBar.value<=0?e.btnPrev.visible=!1:e.btnPrev.visible=!0,e.lstGrade.scrollBar.value>=e.lstGrade.scrollBar.max?e.btnNext.visible=!1:e.btnNext.visible=!0,e.btnPrev.disabled=!1,e.btnNext.disabled=!1;var t=e._selector.selectIdx+1,i=gR.ins.actorById(t),n=AR.ins.getActorUseLevel(i),s=i.zhuijiSkillLevel;s<n?(e.btnNext.showTip=e.lstGrade.startIndex+e.lstGrade.repeatX<=s,e.btnPrev.showTip=e.lstGrade.startIndex>s):(e.btnPrev.showTip=!1,e.btnNext.showTip=!1)},t.onNext=function(e){this.btnNext.disabled=!0,this.btnPrev.disabled=!0;var t=this.lstGrade.startIndex+1,i=AR.ins.MAX_SKILL_LEVEL-2;i-1<=t&&(t=i-1),this.lstGrade.tweenTo(t,116*(t-this.lstGrade.startIndex),ql.create(this,this.onScrollEnd))},t.onPrev=function(e){var t=Math.ceil(this.lstGrade.scrollBar.value/131),i=t-1;i<0&&(i=0),this.btnPrev.disabled=!0,this.btnNext.disabled=!0,this.lstGrade.tweenTo(i,116*(t-i),ql.create(this,this.onScrollEnd))},t.onSelectActor=function(e){this._lastDataSource=null,this._clickData=null,this._isFirstOpen=!0,this.updateAvatar(),this.updateEquip(),this.updateInterior(),this.updateSkills()},t.updateView=function(){this.updateAvatar(),this.updateEquip(),this.updateInterior(),this._selector.invalid(),this.updateSkills()},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e);for(var t=0;t<this._gridBases.length;t++){var i=this._gridBases[t];i.destroy(e)}for(t=0;t<this._gridInteriors.length;t++)(i=this._gridInteriors[t]).destroy(e)},t.updateAvatar=function(e){void 0===e&&(e=-1);var t=this._selector.selectIdx+1,i=gR.ins.actorById(t);this.avatar.changeAvatar(i.sex,i.wid,i.mid,null,i.weaponSoulId),this.avatarW.changeAvatar(-1,null,null,i.wgid,null);i.flyupLevel;var n=AR.ins.getSoaringFight(t,!1,!0);this.fightNum.value=n},t.updateInterior=function(){var e,t=this,i=t._selector.selectIdx+1,n=gR.ins.actorById(i),s=IR.ins.getAbleWearEquips(n),o=[];for(var a in s){if(e=s[a],o.hasOwnProperty(e.decoratePosition))o[e.decoratePosition].flyUpJewelryLevel<e.flyUpJewelryLevel&&(o[e.decoratePosition]=e);else o[e.decoratePosition]=e}for(var r=0;r<la.SOARING_INTERIOR_UI_POS.length;r++){var l=0,c=la.SOARING_INTERIOR_UI_POS[r],u=t["equip"+c];t._dotInteriors[r]||(t._dotInteriors[r]=kB.createSprite(NI.POINT,u.x+85-u.width/2,u.y-13-u.height/2,0,0,t));var d=t._gridInteriors[r];null==(e=n.equips.getPart(c))?(d.visible=!1,t["p_in_"+c].visible=!0,o.hasOwnProperty(c)?d.bindData=o[c]:d.bindData=IR.ins.getInteriorGradeEquipByPos(n.job,1,c)):(d.visible=!0,t["p_in_"+c].visible=!1,d.bindData=e,null!=t._clickData&&t._clickData.position==c&&null!=t._clickData.flyUpJewelryLevel&&t._clickData.flyUpJewelryLevel<e.flyUpJewelryLevel&&(kB.createEffect("jm1082",55,55,d),t._clickData=null)),u.mouseEnabled=!0;var h=null!=e;l=o.hasOwnProperty(c)?(t._dotInteriors[r].visible=!0,h?3:1):(t._dotInteriors[r].visible=!1,h?2:0),u.dataSource={state:l,data:d.bindData}}},t.updateEquip=function(){var e,t=this,i=t._selector.selectIdx+1,n=gR.ins.actorById(i),s=AR.ins.getAbleWearEquips2(n),o=[];for(var a in s)if(e=s[a],o.hasOwnProperty(e.decoratePosition)){var r=o[e.decoratePosition];r.flyupLevel<e.flyupLevel&&(o[e.decoratePosition]=e)}else o[e.decoratePosition]=e;for(var l=0,c=0;c<la.SOARING_EQUIPS_UI_POS.length;c++){var u=la.SOARING_EQUIPS[c],d=t["equip"+u];t._dotBases[c]||(t._dotBases[c]=kB.createSprite(NI.POINT,d.x+85-d.width/2,d.y-13-d.height/2,0,0,t));var h=t._gridBases[c];null==(e=n.equips.getPart(u))?(h.visible=!1,t["p_in_"+u].visible=!0,h.bindData=AR.ins.getSoaringGradeEquipByPos(1,u)):(h.visible=!0,t["p_in_"+u].visible=!1,h.bindData=e,l++,null!=t._clickData&&t._clickData.position==u&&null!=t._clickData.flyupLevel&&t._clickData.flyupLevel<e.flyupLevel&&(kB.createEffect("jm1082",55,55,h),t._clickData=null)),d.mouseEnabled=!0,o.hasOwnProperty(u)?(t._dotBases[c].visible=!0,r=o[u],d.dataSource={state:!0,data:r}):(t._dotBases[c].visible=!1,d.dataSource={state:!1,data:h.bindData})}t.buy.visible=l<8&&t.isOpenAndNotBuyAward},t.onClickInteriorEquip=function(e){var t=e.target.dataSource;if(null!=t){var i=this._selector.selectIdx+1;YX.instance.showTips(t.data,t.state,i);var n=t.data,s=gR.ins.actorById(i).equips.getPart(n.decoratePosition);this._clickData={flyUpJewelryLevel:s?s.flyUpJewelryLevel:0,position:n.decoratePosition}}},t.onClickBaseEquip=function(e){var t=e.target.dataSource;if(null!=t){var i=this._selector.selectIdx+1;KX.instance.showTips(t.data,t.state,i);var n=t.data,s=gR.ins.actorById(i).equips.getPart(n.decoratePosition);this._clickData={flyupLevel:s?s.flyupLevel:0,position:n.decoratePosition}}},t.needRedpt=function(e){return 0<AR.ins.getAbleWearEquips2(e).length||AR.ins.isShowSkillActivePt(e)||0<IR.ins.getAbleWearEquips(e).length},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},t.addGuide=function(){4==gR.ins.actorFlyUpBosstask&&(LY.Ins().showforDir(0,RP.n[639],this.equip65,!0,!1,0,0,!1),LY.Ins().lockSceneShowByDisPlay(this.equip65))},p(0,t,"isOpenAndNotBuyAward",function(){var e=this.CONFIG.split("|"),t=e[4].split(","),i=parseInt(t[0]),n=parseInt(t[1]),s=dr.getOpenServiceDay();return!(parseInt(e[3])>gR.ins.lv)&&(!(s<i||n<s)&&!(-1<JP.A_GIFT_ID_ARR.indexOf(parseInt(e[5]))&&null!=JP.A_GIFT_ID_HASH.take(parseInt(e[5]))&&2==JP.A_GIFT_ID_HASH.take(parseInt(e[5])).status))}),a._curSelector=0,a.lastIndex=-1,a}(),rQ=function(e){function s(){this._dto=null,this._curGrid=null,this._nextGrid=null,this._cost=null,this._costDiv=null,this._nextData=null,this._isMaterialAbleGrow=!1,this._actorId=-1,this._curLevel=0,this._handEff=null,s.__super.call(this),this.centerX=this.centerY=0,this._curGrid=new MF,this._curGrid.pos(this.cur_icon.x,this.cur_icon.y),this._curGrid.mouseEnabled=!1,this.cur.addChild(this._curGrid),this._nextGrid=new MF,this._nextGrid.pos(this.next_icon.x,this.next_icon.y),this._nextGrid.mouseEnabled=!1,this.next.addChild(this._nextGrid),this._cost=[],this._costDiv=[]}b(s,"modules.actor.views.soaring.subview.SoaringSuitGrowView",Lf);var t=s.prototype;return t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.cur_icon.on("click",t,t.onClickGrid),t.next_icon.on("click",t,t.onClickGrid),t.addGuide()},t.addGuide=function(){},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.cur_icon.off("click",t,t.onClickGrid),t.next_icon.off("click",t,t.onClickGrid),t._actorId=-1,t._curLevel=-1,s.curPosition=0,t._nextData=null},t.onClickGrid=function(e){switch(e.target){case this.cur_icon:this.cur_icon.dataSource&&hN.ins.open("SOARING_EQUIP_TIP",this.cur_icon.dataSource);break;case this.next_icon:this.next_icon.dataSource&&hN.ins.open("SOARING_EQUIP_TIP",this.next_icon.dataSource)}},t.refresh=function(){if(0!=s.curPosition&&-1!=this._actorId){var e=gR.ins.actorById(this._actorId).equips.getPart(s.curPosition);null!=e&&(-1!=this._curLevel&&e.positionLevel>this._curLevel&&kB.createEffect("jm1072",300,277,this),this.updateView(e,this._actorId))}},t.updateView=function(e,t){var i=this;if(i._dto=e,i._actorId=t,i._curLevel=i._dto.positionLevel,s.curPosition=i._dto.position,i._curGrid.gray=!1,i._curGrid.needGridBg=!0,i._curGrid.needEffect=!0,0==e.positionLevel?i.txt_curSuitName.changeText("未激活"):i.txt_curSuitName.changeText(AR.ins.getSuitEquipName(e)),0==e.positionLevel?i.btn_grow.label="激 活":i.btn_grow.label="升 级",i.cur_icon.dataSource={data:e,showGrow:!1,actorId:i._actorId},i._curGrid.bindData=AR.ins.toSuitShowDto(e),i.cur.visible=!0,i.cur.left=11,i.cur.centerX=NaN,i.next.right=11,i.next.centerX=NaN,e.positionLevel>=AR.ins.MAX_POSITION_LEVEL)return i.next_icon.dataSource=null,i._nextGrid.bindData=null,i.cost.visible=!1,i.btn_grow.label="已满级",i.btn_grow.disabled=!0,i.btn_grow.showTip=!1,i.txt_nextSuitName.text="",i.next.visible=!1,i.cur.left=NaN,void(i.cur.centerX=0);0==e.positionLevel&&(i.cur.visible=!1,i.next.right=NaN,i.next.centerX=0),i.cost.visible=!0,i.btn_grow.disabled=!1,i.next.visible=!0;var n=AR.ins.getNextSuit(e);i.next_icon.dataSource={data:n,showGrow:!1,actorId:i._actorId},i._nextGrid.bindData=AR.ins.toSuitShowDto(n),i._nextData=n,i.txt_nextSuitName.changeText(AR.ins.getSuitEquipName(n)),i.updateMaterial(),i.btn_grow.showTip=AR.ins.isAbleGrowEquip(i._dto)},t.updateMaterial=function(){var e=this;e._isMaterialAbleGrow=!0,e.clearMaterials();for(var t=JSON.parse(AR.ins.getSuitConsume(e._nextData)),i=0;i<t.length;i++){var n,s;e._cost.length<=i?(n=new MF(74),e.cost.addChild(n),e._cost.push(n)):n=e._cost[i],n.pos(198+122*i,21),n.visible=!0,e._costDiv.length<=i?((s=kB.createHtmlDiv(0,0,24)).mouseEnabled=!1,s.width=150,s.height=24,e.cost.addChild(s),e._costDiv.push(s)):s=e._costDiv[i],s.visible=!0;var o=t[i];if("goods"==o.type){var a=o.value,r=parseInt(a.split(":")[0]),l=parseInt(a.split(":")[1]),c=TR.ins.getGoodsNum(r),u=l<=c?"#23b11f":"#ff2e24";n.bindData=yB.create(r),s.innerHTML=Ql.createColor(mp.getBigIntStr(c)+"/"+l,u),s.pos(n.x+(n.width-s.contextWidth>>1),99),c<l&&(e._isMaterialAbleGrow=!1)}}},t.clearMaterials=function(){for(var e=0;e<this._cost.length;e++)this._cost[e].visible=!1;for(e=0;e<this._cost.length;e++)this._costDiv[e].visible=!1},t.onClick=function(e){var t=this;switch(e.target){case t.btn_grow:if(!t._isMaterialAbleGrow)return void zB.ins.showMsg(RP.n[566],1);var i=AR.ins.getWearSuitLimit(t._dto.positionLevel+1);if(t._dto.flyupLevel<i)return void zB.ins.showMsg("穿戴"+i+RP.n[641],1);if(t._dto.positionLevel>=AR.ins.MAX_POSITION_LEVEL)return void zB.ins.showMsg(RP.n[642],1);if(-1==t._actorId)return;null!=t._nextData&&(bR.reqPoistionGrow(t._nextData,t._actorId),null!=t._handEff&&(t._handEff.destroy(),t._handEff=null));break;case t.btn_close:hN.ins._closePanel(t)}},s.curPosition=0,s}(),lQ=function(e){function t(){this.S_TEXT_PX=63,this.GAP_Y=42,this._box=null,t.__super.call(this),this._box=new dt,this.addChild(this._box)}b(t,"modules.actor.views.soaring.subview.SoaringSuitTip2",Mf);var i=t.prototype;return i.showTips=function(e,t){var i=this;void 0===t&&(t=!1),i._box.graphics.clear(),i.parent||(eq.panelLayer.on("MASK_CLOSE",i,i.onClick),eq.panelLayer.openTip(i));var n,s=AR.ins.MAX_POSITION_LEVEL,o=[];n=0==t?gR.ins.actorById(e):pR.ins.actorById(e);for(var a=142,r=0;r<8;r++){var l=la.SOARING_EQUIPS[r],c=n.equips.getPart(l),u="",d="";if(null!=c){u=AR.ins.getSuitEquipName(c),s>c.positionLevel&&(s=c.positionLevel);var h=c.positionLevel;for(d="#5f5952";0<h;)o.hasOwnProperty(h)||(o[h]=0),o[h]++,d="#23b11f",h--}else d="#5f5952",u=AR.ins.getSuitEquipName2(l,1),s=0;i._box.graphics.fillText(u,i.S_TEXT_PX+r%3*156,a,"24px SimHei",d,"left"),a+=(r+1)%3==0&&0<Math.floor((r+1)/3)?i.GAP_Y:0}s=Math.max(s,1);AR.ins.getSuitNameByLevel(s,n.job);for(var _=0 in o)s<=_&&o[_];i.txt_suitName.innerHTML=RP.n[643];var f=[];for(r=0;r<ji.count;r++){var p=ji.MODEL.suitType(r),g=ji.MODEL.level(r),v=ji.MODEL.suitNeedNum(r);ji.MODEL.roleType(r);"flyUpEquip"==p&&s<=g&&(o.hasOwnProperty(g)&&o[g]>=v&&(f[v]=r),f.hasOwnProperty(v)||s!=g||(f[v]=r))}for(var m=0 in a=329,f){var y=!1,I=f[m];g=ji.MODEL.level(I),v=ji.MODEL.suitNeedNum(I);var b=0;for(_ in o)_==g&&(b+=o[_]);v<=b&&(y=!0);var w=ji.MODEL.attributes(I);if(""!=w){var x=y?"#e0d6c1":"#5f5952",S=y?"#23b11f":"#5f5952",k=aa.formatNewAttrToChinese(w,!1,!0,!1);i._box.graphics.fillText(AR.ins.getSuitGradeName(g)+v+RP.n[644],29,a,RP.n[645],x,"left");var E,T=0;for(var C in k)E=k[C],i._box.graphics.fillText(E.name+"+"+E.val,160+T%2*188,a,"24px SimHei",S,"left"),a+=++T%2==0&&0<Math.floor(T/2)?i.GAP_Y:0;0}}a+=35,i._box.height=a,i.height=a},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===n&&(n=""),void 0===s&&(s=""),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._box.graphics.clear()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},p(1,t,"ins",function(){return t._instance=t._instance||new t},layouts.actor.soaring.other.SoaringSuitTip2UI._$SET_ins),t.GRAY="#5f5952",t._instance=null,t}(),cQ=function(e){function t(){this.MAX_NUM=8,this._selector=null,this._equipNames=null,this._curClickGrid=null,this._itemEffs=null,this._eff1448=null,t.__super.call(this),this.init()}b(t,"modules.actor.views.soaring.subview.SoaringSuitV",Af);var i=t.prototype;return i.init=function(){this._equipNames=[];for(var e=0;e<this.MAX_NUM;e++){var t=this["equip"+la.SOARING_EQUIPS[e]];t.g_red.visible=!1,t.g_bg.visible=!1}this._selector=new Nj,this._selector.redptHandler=ql.create(this,this.needRedpt,null,!1),this.addChild(this._selector)},i.showByVSC=function(e,t){for(var i=this,n=0;n<i.MAX_NUM;n++){i["equip"+la.SOARING_EQUIPS[n]].on("click",i,i.onClickGrid)}i.btn_suit.on("click",i,i.onOpenSuit),i.btn_resonate.on("click",i,i.onOpenResonate),i.btn_help.on("click",i,i.onClickWF),i.txt_help.on("click",i,i.onClickWF),i._selector.invalid(),i._selector.on("select",i,i.onSelectActor),i.updateView()},i.addBossGuide=function(){if(5==gR.ins.actorFlyUpBosstask){var e=new u_;e.x=this.equip65.x,e.y=this.equip65.y,e.width=this.equip65.width,e.height=this.equip65.height,LY.Ins().show(43,e,!1,this),LY.Ins().lockSceneShowByDisPlay(this.equip65)}},i.addArrow=function(){Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])},i.hideByVSC=function(e,t){for(var i=this,n=0;n<i.MAX_NUM;n++){i["equip"+la.SOARING_EQUIPS[n]].off("click",i,i.onClickGrid)}i.btn_suit.off("click",i,i.onOpenSuit),i.btn_help.off("click",i,i.onClickWF),i.txt_help.off("click",i,i.onClickWF),i.btn_resonate.off("click",i,i.onOpenResonate),i._selector.off("select",i,i.onSelectActor),i._curClickGrid=null,i.clearItemEffect(),null!=i._eff1448&&(i._eff1448.removeSelf(),i._eff1448.dispose()),i._eff1448=null},i.onOpenResonate=function(e){UN.isOpenModule?(VN.ins.isFirstShowBtnEff=!1,hN.ins.open("RESONATE_SUB_VIEW",null,0)):zB.ins.showMsg(UN.errorTips,1)},i.onSelectActor=function(e){this.updateEquip(),this.updateFight()},i.onOpenSuit=function(e){var t=this._selector.selectIdx+1;lQ.ins.showTips(t)},i.onClickGrid=function(e){var t=e.target,i=t.dataSource;i&&hN.ins.open("SOARING_EQUIP_TIP",i),this._curClickGrid=t,LY.showing&&LY.Ins().closeArrow()},i.updateView=function(){var e=this;e.updateEquip(),e.updateFight(),e._selector.invalid(),null!=e._eff1448&&(e._eff1448.removeSelf(),e._eff1448.dispose()),e._eff1448=null,e.btn_resonate.showTip=UN.isNeedIconRedDot&&UN.isOpenModule,UN.isShowMingBtnEff&&UN.isOpenModule&&(tr.push(RP.n[646]),null==e._eff1448&&(e._eff1448=kB.createEffect("jm1448",e.btn_resonate.width/2,e.btn_resonate.height/2,e.btn_resonate)))},i.updateFight=function(){var e=this._selector.selectIdx+1;this.fightNum.value=AR.ins.getSuitFight(e)},i.updateEquip=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e),i=t.flyupLevel+1;i>AR.ins.MAX_LEVEL&&(i=AR.ins.MAX_LEVEL),this.clearItemEffect();for(var n=0;n<this.MAX_NUM;n++){var s=la.SOARING_EQUIPS[n],o=this["equip"+s];o.txt_level.text="";var a=t.equips.getPart(s);if(null!=a){if(0<a.positionLevel){o.g_bg.visible=!0,o.txt_level.text=a.positionLevel+"阶",o.g_icon.filters=null;var r=AR.ins.getSuitGrowConfigIndex(a),l=kB.createEffect(Rs.MODEL.effectId(r),o.width/2,o.height/2,o);this._itemEffs.push(l)}else o.g_bg.visible=!1,o.g_icon.filters=A_.getGrayFilter4();o.g_red.visible=AR.ins.isAbleGrowEquip(a),o.addChild(o.g_red),o.g_icon.skin=_r.getAtlasSubPath("soaring/"+this.getEquiptIcon(a)+".png"),o.addChild(o.g_bg),o.addChild(o.txt_level),o.dataSource={data:a,showGrow:!0,actorId:e}}else{o.g_red.visible=!1,o.g_bg.visible=!1,o.g_icon.filters=A_.getGrayFilter4();var c=AR.ins.getSoaringGradeEquipByPos(i,s);o.dataSource={data:c,showGrow:!0,actorId:e},o.g_icon.skin=_r.getAtlasSubPath("soaring/"+this.getEquiptIcon(c)+".png")}}},i.clearItemEffect=function(){if(null!=this._itemEffs)for(var e in this._itemEffs)this._itemEffs[e].dispose(),null;this._itemEffs=[]},i.getEquiptIcon=function(e){var t=AR.ins.toSuitShowDto(e),i=Bi.getIndex(t.goodsId);return Bi.MODEL.icon(i)},i.needRedpt=function(e){return AR.ins.showSuitGrowDot(e.id)},i.onClickWF=function(e){QR.goToOpenHelpDes(5)},t}(),uQ=function(e){function t(){var e=this;e._iconId="",e.skillGrid=null,e._job=0,e.attackEff=null,e.hitEffectOne=null,e.hitEffectTwo=null,e.effect1=null,e.effect2=null,e._higEffectTwo=null,e._currentLevel=0,e._btnEff=null,e.needEffece=[1,4],e._actorId=0,e._alertTip=null,t.__super.call(e),e.skillGrid=new GF,e.icon.addChild(e.skillGrid),e.skillGrid.width=100,e.skillGrid.height=100,e.centerX=e.centerY=0}b(t,"modules.actor.views.soaring.subview.ZhuijiSkillTips",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.initView()},i.initView=function(){this.img_boss.skin=_r.getFullUrl("ui/images/soaring/hj_img_boss.png"),this.img_preview_bg.skin=_r.getFullUrl("ui/images/zhuiji/zj_tips_bg.jpg");var e=gR.ins.actorList[gR.ins.showId-1];this.img_player.skin=_r.getFullUrl("ui/images/soaring/sex_"+e.sex+".png")},i.showById=function(e,t,i,n){var s=this;void 0===t&&(t=""),void 0===i&&(i=-1),void 0===n&&(n=0),s.initView();G.loader.getRes(s.img_boss.skin);var o=Vn.getIndex(e);s._iconId=Vn.MODEL.icon(o),s._actorId=i,s.skillGrid.bindData=e,s.skillname.changeText(Vn.MODEL.name(o)),s.skilljob.changeText("职业："+ra.getCareerName(Vn.MODEL.role(o))),s._job=Vn.MODEL.role(o),s.skilldes.innerHTML=Vn.MODEL.desc(o),s.attackEff=Vn.MODEL.effect_play(o),s.hitEffectOne=Vn.MODEL.effect_hit(o),s.hitEffectTwo=Vn.MODEL.effect_hit2(o),""==t||null==t?(s.skilllimit.changeText("已激活"),s.skilllimit.color="#90877b"):(s.skilllimit.changeText(t),s.skilllimit.color="#ff2e24"),s.parent||(eq.panelLayer.on("MASK_CLOSE",s,s.onClick),eq.panelLayer.open(s,!1,!0));var a=parseInt(e.toString().substr(2,1));switch((s._currentLevel=0)<=s.needEffece.indexOf(a)?(s._currentLevel=a,s.img_boss.visible=!0,s.img_preview_bg.visible=s.g_preBg.visible=!0,s.img_player.visible=!0,s.playAttackEffect(),s.skilldesbar.y=583,s.skilldes.y=625):(s.img_boss.visible=!1,s.img_preview_bg.visible=s.g_preBg.visible=!1,s.img_player.visible=!1,s.effect1&&(s.effect1.dispose(),s.effect1=null),s.effect2&&(s.effect2.dispose(),s.effect2=null),s.skilldesbar.y=238,s.skilldes.y=279),s.height=s.skilldes.y+s.skilldes.contextHeight+10,s._btnEff&&s._btnEff.dispose(),s._btnEff=null,s._alertTip=null,n){case 0:s.btn_active.visible=!1,s.skilllimit.visible=!0;break;case 1:s.btn_active.visible=!0,s.btn_active.gray=!1,s._btnEff||(s._btnEff=kB.createEffect("jm1130",s.btn_active.width/2,s.btn_active.height/2,s.btn_active),s._btnEff.scale_X=1.25,s._btnEff.scale_Y=1.25),s.skilllimit.visible=!1;break;case 2:s.btn_active.visible=!0,s.btn_active.gray=!0,s.skilllimit.visible=!1,s._alertTip=RP.n[647];break;case 3:s.btn_active.visible=!0,s.skilllimit.visible=!0,s.btn_active.gray=!0,s._alertTip=t}s.btn_active.visible&&(s.height+=147)},i.playAttackEffect=function(){var e=this;if(e.parent){var t=0;e.effect1&&(e.effect1.dispose(),e.effect1=null),e._higEffectTwo&&(e._higEffectTwo.removeSelf(),e._higEffectTwo.dispose(),e._higEffectTwo=null);switch(t=500,e._job){case ha.ZHAN.type:e.attackEff&&(t=900,e.effect1=kB.createEffect(e.attackEff,e.img_player.x+40,e.img_player.y+130,e),e.effect1.scale_X=.4,e.effect1.scale_Y=.4,e.effect1.setDir(3));break;case ha.FA.type:case ha.DAO.type:e.attackEff&&(e.effect1=kB.createEffect(e.attackEff,e.img_player.x+40,e.img_player.y+130,e),e.effect1.scale_X=.4,e.effect1.scale_Y=.4,e.effect1.setDir(3),t=900)}G.timer.once(t,e,e.playerHitEffect)}},i.onTweenComplete=function(){this.effect1&&(this.effect1.removeSelf(),this.effect1.dispose(),this.effect1=null)},i.playerHitEffect=function(){var e=this,t=200;if(e.parent){var i=0,n=0;switch(e._job){case ha.FA.type:n=(e._currentLevel,i=90,50),t=400;break;case ha.ZHAN.type:n=(i=4==e._currentLevel?90:70,45),t=400;break;case ha.DAO.type:i=105,n=55,t=800,e._higEffectTwo=kB.createEffect(e.hitEffectTwo,e.img_boss.x+50,e.img_boss.y+110,e),e._higEffectTwo.scale_X=.5,e._higEffectTwo.scale_Y=.5,e.addChild(e.img_boss)}e.effect2&&(e.effect2.dispose(),e.effect2=null),e.effect2=kB.createEffect(e.hitEffectOne,e.img_boss.x+n,e.img_boss.y+i,e),e.effect2.scale_X=.5,e.effect2.scale_Y=.5,e.hitEffectTwo?G.timer.once(t,e,e.playerHitEffectTwo):G.timer.once(t,e,e.playAttackEffect)}},i.playerHitEffectTwo=function(){this.effect2&&(this.effect2.dispose(),this.effect2=null),G.timer.once(600,this,this.playAttackEffect)},i.close=function(e){void 0===e&&(e=!1),eq.panelLayer.close(this)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_active.on("click",this,this.onActive)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.disposeEffect(),G.timer.clearAll(this),this.btn_active.off("click",this,this.onActive),this._btnEff&&this._btnEff.dispose(),this._btnEff=null},i.onActive=function(e){this.btn_active.gray?null!=this._alertTip&&zB.ins.showMsg(this._alertTip,1):-1!=this._actorId&&(bR.reqSkillActive(this._actorId),this.close())},i.disposeEffect=function(){var e=this;e.effect2&&(e.effect2.dispose(),e.effect2=null),e.effect1&&(e.effect1.removeSelf(),e.effect1.dispose(),e.effect1=null),e._higEffectTwo&&(e._higEffectTwo.removeSelf(),e._higEffectTwo.dispose(),e._higEffectTwo=null)},i.onClick=function(e){e instanceof modules.actor.views.soaring.subview.ZhuijiSkillTips&&(eq.panelLayer.off("MASK_CLOSE",this,this.onClick),this.close())},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.soaring.other.ZhuijiSkillTipsUI._$SET_instance),t._instance=null,t}(Fv),dQ=function(e){function n(){var e=this;e.WING_POSITION_Y=[600,600,600,600,600,620,600,600,520,550],e.mcAttr=null,e._selector=null,e._wingD=null,e._curIdx=-1,e._curId=0,e._effect=null,e._effId="",e._upStep=!1,e._upStar=!1,e._tween=null,e._curShowStep=0,e.g_cost=null,e.skillitemArr=null,e.skillidArr=null,e.skillNameArr=null,e.img_skill=null,e.sp_reddot=null,e.isGold=!1,e.isActiveStatus=1,e.bg1=null,e.bg2=null,e._BAR_W=618,e._mX=0,e._times=0,e.titleId=11,e.delayGuideId=0,e._sbox=null,e._circle=null,e.effStar=null,n.__super.call(e),e.mcAttr=new dt,e.mcAttr.x=e.mcABg.x+100,e.mcAttr.y=e.mcABg.y+12,e.addChild(e.mcAttr),e._selector=new Nj,e.addChild(e._selector),e.g_cost=new MF(45),e.g_cost.needGridBg=!1,e.g_cost.pos(70,-13),e.mcBtns.addChild(e.g_cost);var t=yB.create(2535);e.g_cost.bindData=t,e.sp_reddot=new pp,e.addChild(e.sp_reddot);var i=_r.getAtlasSubPath("basic_ui/ty_ts_hd.png");e.btnOn.tipSkin=i,e.bg1=_r.getFullUrl("ui/images/yuyi/yy_jsjm_db.jpg"),e.bg2=_r.getFullUrl("ui/images/yuyi/yy_active_db.jpg")}b(n,"modules.actor.views.wing.ActorWingV",e);var t=n.prototype;return t.initialize=function(){this._BAR_W=this.imgBar.width,this.imgBar.mask=this.bar_mask},t.createChildren=function(){e.prototype.createChildren.call(this)},t.destroy=function(e){var t=this;void 0===e&&(e=!0),t._effect&&t._effect.dispose(),t._effect=null;var i=G.loader.getRes(t.bg1);if(i&&G.loader.clearRes(t.bg1,!0),(i=G.loader.getRes(t.bg2))&&G.loader.clearRes(t.bg2,!0),t.mcEffect.dispose(),t.activeBb.dispose(),t.actorR.dispose(),t.actorL.dispose(),t.skillitemArr&&0<t.skillitemArr.length)for(var n=0;n<t.skillitemArr.length;n++)(i=G.loader.getRes(t.skillitemArr[n].skin))&&G.loader.clearRes(t.skillitemArr[n].skin,!0);laya.ui.View.prototype.destroy.call(t,e)},t.updateByVSC=function(e){var t=this;if(t.showMasterTip(),e){if("21110"==e.actionOrder){if(Tu.sendToModule("WING_STONE_UPDATE",["modules.actor.ActorModule"]),t._wingD.activeHandler&&0<t._wingD.wingStep)return t._wingD.activeHandler=!1,t.showActiveEffect(),void t.showTips();t._curShowStep=t._wingD.wingStep,t._upStep=t._wingD.starUp,t._upStar=t._wingD.levelUp,t._upStep&&(UB.ins.playSound("12",3,!0),t.openActive()),t._upStep?(t.showContent(),t.showBar()):(t.showBar(),t.updateExp(),!t._upStep&&t.showWingEff(),t.updateItem()),t.showTips(),t.btn_up.label=t._wingD.isMaxLevel?"进 阶":"提 升"}else if("number"==typeof e&&Math.floor(e)==e){var i=e-1;t._selector.selectIdx=i}}else t.updateItem()},t.showMasterTip=function(){for(var e=!1,t=0;t<gR.ins.actorList.length;t++)e||(e=this.getShowTip(t));this.btnOn.showTip=e},t.getShowTip=function(e){if(dr.getOpenServiceDay()<parseInt($e.MODEL.value(161)))return!1;for(var t,i=0;i<la.SWING.length;i++)if(t=wR.ins.getBetter(e+1,la.SWING[i]))return!0;wR.ins.itemIsTop(22,0);var n=[],s=gR.ins.actorList[e];for(i=0;i<la.SWING.length;i++)if(t=MR.ins.getEquip(s.id,la.SWING[i])){var o=wR.ins.posH.take(la.SWING[i]).indexOf(t.goodsId);n.push(wR.ins.posH.take(la.SWING[i])[o+1])}else{var a=wR.ins.posH.take(la.SWING[i]);n=n.concat(a)}var r=0;for(i=0;i<n.length;i++)for(var l=vo.count,c=0;c<l;c++)if(vo.MODEL.itemId(c)==n[i]){r=c;var u=vo.MODEL.exchangeID(r),d=xa.MODEL.consumption(xa.getIndex(u)),h=JSON.parse(d)[0].value.split(":"),_=parseInt(h[1]),f=parseInt(h[0]),p=_<=(10<_?TR.ins.getGoodsNum(f):TR.ins.getGoodsNum(f)+1),g=yo.MODEL.levelLimit(r)<=gR.ins.actorById(e+1).wingData.wingStep;if(p&&g)return!0}return wR.ins.getCombime()},t.openActive=function(){var e=mo.MODEL.jmId(mo.getIndex(this._wingD.wingStep));Tu.sendToModule("OPEN_WING_ACTIVE",["modules.actor.ActorModule"],{name:"羽翼"+this._wingD.wingStep+"阶",effect:e,wingStep:this._wingD.wingStep})},t.onMouseDown=function(){this._mX=G.stage.mouseX,this.on("mouseup",this,this.onMouseUp)},t.onMouseUp=function(){var e=this;if(G.stage.mouseX>e._mX){if(!e.btnL.visible)return;e._curShowStep-=1}else{if(!e.btnR.visible)return;e._curShowStep+=1}e.showWingEff(!0),e.mcSlice.on("mousedown",e,e.onMouseDown),e.off("mouseup",e,e.onMouseUp)},t.onAdd=function(e){var t=this;t.txt_get.on("click",t,t.onClick),t.btnActive.on("click",t,t.onClick),t.mc_skill1.on("click",t,t.onClick),t.mc_skill2.on("click",t,t.onClick),t.mc_skill3.on("click",t,t.onClick),t.mc_skill4.on("click",t,t.onClick),t.mc_skill5.on("click",t,t.onClick),t.btnOn.on("click",t,t.onClick),t.btnL.on("click",t,t.onClick),t.btnR.on("click",t,t.onClick),t.btn_flyup.on("click",t,t.onClick),t.btn_zizhi.on("click",t,t.onClick),t.btn_up.on("click",t,t.onClick),t.zhisheng_link.on("click",t,t.onClick),t.txt_blessTps.visible=!1;var i=t.getRedPtRole();t._selector.selectIdx=-1==i?Nj.globalIdx:i,t._selector.on("select",t,t.onSelect),t.txt_get.visible=!1,t.mc_shenyubg.visible=t.btnOn.visible=dr.getOpenServiceDay()>=parseInt($e.MODEL.value(161)),t.onSelect(),t.bar_mask.x=-508;var n=new fA;Tu.sendToService(n),gR.ins.isshowYuyiZhisheng&&(gR.ins.isshowYuyiZhisheng=0,hN.ins.open("SWING_ZHISHENG",null,0))},t.onRemove=function(e){var t=this;wR.ins.isActivitingWing=!1,t.txt_get.off("click",t,t.onClick),t.btnActive.off("click",t,t.onClick),t.mc_skill1.off("click",t,t.onClick),t.mc_skill2.off("click",t,t.onClick),t.mc_skill3.off("click",t,t.onClick),t.mc_skill4.off("click",t,t.onClick),t.mc_skill5.off("click",t,t.onClick),t.btnOn.off("click",t,t.onClick),t.btnL.off("click",t,t.onClick),t.btnR.off("click",t,t.onClick),t.btn_flyup.off("click",t,t.onClick),t.btn_zizhi.off("click",t,t.onClick),t.btn_up.off("click",t,t.onClick),t.zhisheng_link.off("click",t,t.onClick),t._selector.off("select",t,t.onSelect),t.mcSlice.off("mousedown",t,t.onMouseDown),t._curIdx=-1,t._upStep=!1,t.delayGuideId=0,G.timer.clear(t,t.showGuide),gR.ins.showYuyiBless=0},t.onF=function(e){e.destroy(!0)},t.onClick=function(e){var t=this;if(e.target==t.txt_get)Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._wingD.costItemId});else if(e.target!=t.btnActive||t._wingD.isTop){if(e.target==t.mc_skill1||e.target==t.mc_skill2||e.target==t.mc_skill3||e.target==t.mc_skill4||e.target==t.mc_skill5){var i=parseInt(e.target.name);if(t.skillidArr[i-1]){var n=t._wingD.skillArr,s="",o=$e.MODEL.value(96).split(",");if(-1==n.indexOf(parseInt(o[i-1])))for(var a=0;a<$s.count;a++)if(0<=$s.MODEL.pasSkillId(a).indexOf(parseInt(o[i-1]))){s=$s.MODEL.tier(a)+"阶开启";break}mQ.instance.showById(t.skillidArr[i-1],s)}}else if(e.target==t.btnOn){var r=hN.ins._getOpenData("ACTOR_M");r&&(r.subIndex=parseInt("2")),hN.ins.open("SWING",null,0)}else if(e.target==t.btnL)t._curShowStep-=1,t.showWingEff(!0);else if(e.target==t.btnR)t._curShowStep+=1,t.showWingEff(!0);else if(e.target==t.btn_flyup)hN.ins.open("SWING_UPDATE",{actor:t._selector.selectIdx+1,type:2,actorD:gR.ins.actorList[t._selector.selectIdx]}),UB.ins.playSound("11");else if(e.target==t.btn_zizhi)hN.ins.open("SWING_UPDATE",{actor:t._selector.selectIdx+1,type:1,actorD:gR.ins.actorList[t._selector.selectIdx]}),UB.ins.playSound("11");else if(e.target==t.btn_up){if(t._wingD.wingStep<4&&-1==gR.ins.isShowBuyGifttip.indexOf(t._selector.selectIdx)&&dr.getOpenServiceDay()<=7&&0==gR.ins.isBuyGift)return gR.ins.isShowBuyGifttip.push(t._selector.selectIdx),void hN.ins.open("SWING_ZHISHENGBUY",null,0);t._times=BB.getTimer(),t.toUpStar(2,!0)}else if(e.target==t.zhisheng_link){if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);eU.targetId=10013,eU.toSelectIndex=0,CN.dealActIcon(CN.getIconBtn(46))}}else if(LY.showing&&11==LY.Ins().currGuideId&&(t.showGuide(11,!1),Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])),gR.ins.canActive(t._selector.selectIdx+1))if(gR.ins.canLevelActive()){wR.ins.isActivitingWing=!0;var l=new oA;l.roleIndex=t._selector.selectIdx+1,Tu.sendToService(l)}else zB.ins.playErrorMsg(gR.ins.activeLv+RP.n[648])},t.showWingEff=function(e){var t=this;void 0===e&&(e=!1);var i="";0==t._curShowStep?(t._effId="",t._effect&&(t._effect.visible=!1)):i=mo.MODEL.jmId(mo.getIndex(t._curShowStep)),t._effId!=i&&0<t._curShowStep&&(t._effect&&(t._effect.visible=!1),t._effId=i,G.timer.once(200,t,t.showEff,[e])),t.mc_level.value=t._curShowStep+"",t.mcP.visible=0==t._wingD.isTop&&1<=t._curShowStep,t.showLR(),t.showStep()},t.showEff=function(e){var t=this;t._effect=mj.GetNew(),t._effect.renderInSelf=!0,t._effect.setXY(365,t.WING_POSITION_Y[t._curShowStep-1]),t.addChildAt(t._effect,t.getChildIndex(t.mcABg)-1),t._effect.loadEffect(t._effId),t._effect.visible=!0,e?(t._effect.scaleX=t._effect.scaleY=0,Og.to(t._effect,{scaleX:1,scaleY:1},350,pa.bounceOut,null,100)):t._effect.scaleX=t._effect.scaleY=1},t.showSkill=function(){var e=this,t=0;if(e.skillitemArr){for(t=0;t<e.skillitemArr.length;t++)e.removeChild(e.skillitemArr[t]),e.removeChild(e.skillNameArr[t]);e.skillitemArr.length=0,e.skillNameArr.length=0}else e.skillitemArr=[];e.skillidArr=[],e.skillNameArr=[];var i=e._wingD.skillArr,n=$e.MODEL.value(96).split(",");for(t=0;t<n.length;t++)if(n[t]){e.img_skill=new Kl,e.addChild(e.img_skill),e.img_skill.pos(e["mc_skill"+(t+1)].x+5,e["mc_skill"+(t+1)].y+5);var s=Ls.getIndex(n[t]);e.img_skill.skin=_r.getIconPath(Ls.MODEL.icon(s)),e.skillidArr.push(n[t]),e.skillitemArr.push(e.img_skill);var o=kB.createText(e["mc_skill"+(t+1)].x-18,e["mc_skill"+(t+1)].y+75,116,50,"",20,"#5f5850",!1,"center",!1,!1,e);if(e.addChild(o),e.skillNameArr.push(o),-1==i.indexOf(parseInt(n[t]))){for(var a=0;a<$s.count;a++)if(0<=$s.MODEL.pasSkillId(a).indexOf(parseInt(n[t]))){o.changeText($s.MODEL.tier(a)+"阶开启");break}Pg.gray(e.img_skill,!0)}else Pg.gray(e.img_skill,!1)}},t.showContent=function(){var e=this;if(null!=e.parent){if(1==e.isActiveStatus&&(e.isActiveStatus=0,e.yuyi_bg.skin=e.bg1,e.yuyi_bg.repaint()),gR.ins.canActive(e._selector.selectIdx+1)){if(e.sp_reddot.graphics.clear(),e.tui_mc.visible=e.zhisheng_link.visible=!1,e.txt_get.visible=e.mcP.visible=e.mc_shenyubg.visible=e.imgTop.visible=e.mcBtns.visible=e.mcJie.visible=!1,e.btnL.visible=e.btnR.visible=e.mcP.visible=e.mcF.visible=e.mcABg.visible=e.mcArrow.visible=e.txt_blessTps.visible=!1,e.btn_flyup.visible=e.btn_zizhi.visible=e.mc_skill5.visible=e.mc_skill1.visible=e.mc_skill2.visible=e.mc_skill3.visible=e.mc_skill4.visible=!1,0==e.isActiveStatus&&(e.isActiveStatus=1,e.yuyi_bg.skin=e.bg2,e.yuyi_bg.repaint()),e.mcAttr.visible=e.btnOn.visible=!1,e.skillitemArr&&0<e.skillitemArr.length)for(var t=0;t<e.skillitemArr.length;t++)e.skillitemArr[t].visible=!1,e.skillNameArr[t].visible=!1;return e.mcA.visible=!0,e.btnActive.visible=gR.ins.canActive(e._selector.selectIdx+1),e.btnActive.visible&&(gR.ins.canLevelActive()?(e.btnActive.showTip=!0,Pg.gray(e.btnActive,!1)):(e.btnActive.showTip=!1,Pg.gray(e.btnActive,!0))),void(e.btnActive.visible?e.doShowGuide(11):e.showGuide(11,!1))}if(e._wingD.isTop&&(e.imgTop.visible=!0,e.imgTop.skin=_r.getAtlasSubPath("actor/wing_text_max.png")),dr.getOpenServiceDay()<=7&&0==gR.ins.isBuyGift?e.tui_mc.visible=e.zhisheng_link.visible=!0:e.tui_mc.visible=e.zhisheng_link.visible=!1,e.showWingEff(),e._curId=e._wingD.id,e.imgTop.visible=e.mcA.visible=!1,e.btnL.visible=e.btnR.visible=e.mcJie.visible=e.mcP.visible=e.mcF.visible=e.mcABg.visible=e.mcArrow.visible=!0,e.btn_flyup.visible=e.btn_zizhi.visible=e.mc_skill5.visible=e.mc_skill1.visible=e.mc_skill2.visible=e.mc_skill3.visible=e.mc_skill4.visible=!0,e.mcAttr.visible=!0,e.mc_shenyubg.visible=e.btnOn.visible=dr.getOpenServiceDay()>=parseInt($e.MODEL.value(161)),e.skillitemArr&&0<e.skillitemArr.length)for(var i=0;i<e.skillitemArr.length;i++)e.skillitemArr[i].visible=!0,e.skillNameArr[i].visible=!0;e.txt_get.visible=e.mcBtns.visible=!0,e.g_cost.visible=e.lab_cost.visible=e.txFeather.visible=e.img_txFeather.visible=e.box_bar.visible=!e._wingD.isMaxLevel;var n=[];e.updateExp(),e.updateItem(),e.clearAttrs(),e.showLevel(),0<e._wingD.curWingExp?(n=e.getTotalAtt(e._wingD.curAttr),e.drawLeftText(n),e.boxleft.x=40,e.drawRightText(e.getTotalAtt(e._wingD.nextAttr),!0,"#23b11f")):e._wingD.isTop?(e.imgTop.visible=!0,e.imgTop.centerX=0,n=e.getTotalAtt(e._wingD.curAttr),e.drawLeftText(n),e.boxleft.x=225,e.txt_get.visible=e.mcP.visible=e.mcBtns.visible=e.mcArrow.visible=!1):(n=e.getTotalAtt(e._wingD.curAttr),e.drawLeftText(n),e.boxleft.x=40,e.drawRightText(e.getTotalAtt(e._wingD.nextAttr),!0,"#23b11f"));var s=RR.getFight(n),o=e.checkTitle(e.titleId),a=rB.ins.getPlusByModule("WING_BASE",e._selector.selectIdx+1);e.mcF.value=s+Math.floor(o*s)+Math.floor((a+1)*s),e.mc_level.value=e._wingD.wingStep+"",e.showSkill(),e.graphics.drawLine(510,1136,600,1136,"#23b11f")}},t.checkTitle=function(e){var t=0,i=tg.ins.toc_title;if(!i)return 0;var n,s=i.titles[0];for(var o in s)if((n=s[o]).id==e&&0<=n.state){var a=co.getIndex(e);t=JSON.parse(co.MODEL.attr(a))[4].value/1e4}else;return t},t.getTimeAtt=function(e){for(var t=this._wingD.curWingExp/this._wingD.totalWingExp,i=0;i<e.length;i++){var n=e[i];n.val=Math.ceil(n.val*t*.5*(.01*this._wingD.feishengdan+1))}return e},t.drawLeftTempText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=this._wingD.curWingExp/this._wingD.totalWingExp,a=0;a<e.length;a++){var r=e[a],l=this["txt_attr_l"+a],c=this["txt_attrname_l"+a];l.visible=!0,c.visible=!0,c.innerHTML=r.sname+":";var u=Math.ceil(r.val*o*.5*(.01*this._wingD.feishengdan+1));t?l.innerHTML="<font style='color:"+i+";'>"+n+u+s+"</font>":l.innerHTML+="&nbsp;",l.innerHTML+="<font style='color:"+i+";'>"+n+u+s+"</font>"}},t.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name.replace(" ","&nbsp;")+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},t.drawRightText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_r"+o],l=this["txt_attrname_r"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name.replace(" ","&nbsp;")+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+"</font>"}},t.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attr_r"+e],n=this["txt_attrname_l"+e],s=this["txt_attrname_r"+e];t.visible=!1,i.visible=!1,t.style.wordWrap=!1,i.style.wordWrap=!1,n.visible=!1,s.visible=!1}},t.getTotalAtt=function(e){var t,i,n=0,s=this._wingD.feishengdan,o=this._wingD.zhizidan,a=[];for(a=aa.mergeFormatAttrs(e,a),t=$e.MODEL.value($e.getIndex(94)),n=0;n<o;n++)a=aa.mergeFormatAttrs(t,a);for(n=0;n<a.length;n++)(i=a[n]).value=Math.ceil(i.value*(.01*this._wingD.feishengdan+1));for(t=$e.MODEL.value($e.getIndex(93)),n=0;n<s;n++)a=aa.mergeFormatAttrs(t,a);return aa.formatAttrToChineseByList(a)},t.doShowGuide=function(e){if(pn.hasIndex(e)&&e!=this.delayGuideId){var t=pn.getIndex(e),i=pn.MODEL.delaytime(t);0<i?(this.delayGuideId=e,G.timer.once(i,this,this.showGuide,[e,!0])):this.showGuide(e,!0)}},t.showGuide=function(e,t){if(t){if(this.delayGuideId=0,PH.Ins().hasNewGuide(e)&&this.parent)switch(e){case 11:LY.Ins().show(e,this.btnActive)}}else LY.showing&&LY.Ins().close(11)},t.showLR=function(){var e=this;return 0==e._wingD.wingStep?(e.btnL.disabled=!0,void(e.btnR.disabled=!0)):e._wingD.isTop&&e._curShowStep==e._wingD.wingStep||e._curShowStep==e._wingD.wingStep&&10==e._curShowStep?(e.btnL.disabled=!1,void(e.btnR.disabled=!0)):void(1==e._curShowStep?(e.btnL.disabled=!0,e.btnR.disabled=!1):e._curShowStep==e._wingD.wingStep+1?(e.btnL.disabled=!1,e.btnR.disabled=!0):(e.btnL.disabled=!1,e.btnR.disabled=!1))},t.showBar=function(e){var t=this;void 0===e&&(e=!0);var i=0==t._wingD.totalWingExp?0:t._wingD.curWingExp/t._wingD.totalWingExp;e?(t._tween&&t._tween.clear(),t._tween=null,t._upStar?t._tween=Og.to(t.bar_mask,{x:0},100,null,ql.create(t,t.onT),0,!1,!1):(t._upStep&&(t.bar_mask.x=-t._BAR_W),t._tween=Og.to(t.bar_mask,{x:-t._BAR_W+i*t._BAR_W},100,null,ql.create(t,t.onEnd),0,!1,!1)),t.showContent()):(t.bar_mask.repaint(),t.bar_mask.x=-t._BAR_W+i*t._BAR_W)},t.onT=function(){var e=this;e._upStar=!1,e.bar_mask.repaint(),e.setStar(),e._wingD.isMaxLevel?(e._tween&&e._tween.clear(),e._tween=null):(e.bar_mask.x=-e._BAR_W,e.showBar())},t.onEnd=function(){this._upStep=!1,this._upStar=!1,this.showBar(!0),this._tween&&this._tween.clear(),this._tween=null},t.updateExp=function(){this.txt_progress.changeText(this._wingD.curWingExp+"/"+this._wingD.totalWingExp)},t.showStep=function(){10==this._curShowStep||(this._curShowStep<20&&10<this._curShowStep?this._curShowStep:this._curShowStep)},t.updateItem=function(){var e=this;e.sp_reddot.graphics.clear();var t,i,n=TR.ins.getGoodsNum(e._wingD.costItemId);t=n>=e._wingD.costItemNum,i=(e.btn_up.showTip=t)?"#23b11f":"#ff2e24",e.txFeather.innerHTML=Ql.createColor(n+"",i)+"/"+e._wingD.costItemNum,0<e._wingD.wingStep&&(0<TR.ins.getGoodsNum(2536)&&$s.MODEL.flyLimit($s.getIndex(e._wingD.id))>e._wingD.feishengdan&&e.drawReddot(e.btn_flyup),0<TR.ins.getGoodsNum(2537)&&$s.MODEL.apLimit($s.getIndex(e._wingD.id))>e._wingD.zhizidan&&e.drawReddot(e.btn_zizhi))},t.showLevel=function(){var e=this;if(e.box_star.visible=!e._wingD.isTop,e._sbox&&e._sbox.graphics.clear(),!e._wingD.isTop){e._sbox||(e._sbox=new dt,e._sbox.pos(e.box_star.x,e.box_star.y),e.mcP.addChild(e._sbox)),e._sbox.graphics.clear();var t,i;i=_r.getAtlasSubPath("yuyi/xz_img_star1.png"),t=G.loader.getRes(i);for(var n=0;n<e._wingD.wingStar;n++)e._sbox.graphics.drawTextures(t,[53*n,0])}},t.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+e.width-30,e.y-1,t.width,t.height)},t.onSelect=function(){var e=this;if(wR.ins.isActivitingWing)e._selector.selectIdx=e._curIdx;else if(e._curIdx!=e._selector.selectIdx){e._curIdx=e._selector.selectIdx;var t=gR.ins.actorList[e._curIdx];e._wingD=t.wingData,e._curShowStep=e._wingD.wingStep,e.showContent(),e.showBar(!1),e.showWingEff(),e.showTips()}},t.toUpStar=function(e,t){void 0===t&&(t=!1);var i=0,n=(dr.getOpenServiceDay(),TR.ins.getGoodsNum(this._wingD.costItemId)<this._wingD.costItemNum);if(n&&!this.isGold&&(t&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:this._wingD.costItemId}),i=1),0==i){var s=new sA;s.actor=this._curIdx+1,s.type=n&&this.isGold?1:0,Tu.sendToService(s)}},t.showTips=function(){for(var e,t=0;t<gR.ins.actorList.length;t++)e=gR.ins.actorList[t].wingData,this._selector.setRedPtByIdx(t,e.showTip||gR.ins.canActive(t+1))},t.getRedPtRole=function(){for(var e=0;e<gR.ins.actorList.length;e++)if(gR.ins.actorList[e].wingData.showTip)return e;return-1},t.showActiveEffect=function(){this.btnActive.visible=!1,this.mcEffect.visible=!0,this.circleEnd()},t.circleEnd=function(){this.mcEffect.mask=null;var e=mj.GetNew();e.renderInSelf=!0,e.pos(this.mcEffect.x+151,this.mcEffect.y+150),e.loadEffect("jm1156"),this.mcA.addChild(e),e.scale_X=1,e.scale_Y=1;var t=mj.GetNew();t.renderInSelf=!0,t.pos(this.mcEffect.x+150,this.mcEffect.y+150),t.loadEffect("jm1156"),t.scale_X=-1,t.scale_Y=1,this.mcA.addChild(t),G.timer.once(1e3,this,this.aftereffect),UB.ins.playSound("11")},t.aftereffect=function(){this.openActive(),this.showContent(),this._curShowStep=1,this.showWingEff()},t.setStar=function(){this.clearStarEff(),this._wingD.isMaxLevel?this.showContent():this.showLevel(),this.effStar||(this.effStar=kB.createEffect("jm1217",38+53*this._wingD.wingStar,-16,this.mcP))},t.clearStarEff=function(){this.effStar&&(this.effStar.parent&&this.effStar.parent.removeChild(this.effStar),this.effStar.dispose(),this.effStar=null)},n}(se),hQ=function(e){function t(){var e=this;e.box=null,e._effect=null,e._icon=null,e._orgX=0,e._orgY=0,e._effId=null,e._recordTime=NaN,e._effectS=["jm0112","jm0117","jm0122","jm0127"],t.__super.call(e),e._orgX=e.mcE.x,e._orgY=e.mcE.y}b(t,"modules.actor.views.wing.FunctionActiveV",Ja);var i=t.prototype;return i.showData=function(e){var t=this;UB.ins.playSound("23"),this.box||(this.box=new pp,this.addChildAt(this.box,0)),this.box.graphics.clear(),this.box.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000"),this.box.x=.5*(720-G.stage.width),this.box.y=.5*(1280-G.stage.height),this.mcE.pos(360,530),this.box_bottom.alpha=1,this.box_bottom.y=605,this.txName.changeText(e.name),e.effect?(this._effect||(this._effect=mj.GetNew(),this._effect.renderInSelf=!0),this._effect.loadEffect(e.effect),this._effId=e.effect,this._effect.pos(0,0),this.mcE.addChild(this._effect)):e.icon&&(this._icon=e.icon,this.mcE.addChild(this._icon));var i=e.offsetX?e.offsetX:0,n=e.offsetY?e.offsetY:0;this.mcE.pos(this._orgX+i,this._orgY+n),this.mcE.scaleX=this.mcE.scaleY=0,this.addChild(this.mcE);var s=e.scaleX?e.scaleX:1.4,o=e.scaleY?e.scaleY:1.4;Og.to(this.mcE,{scaleX:s,scaleY:o},300,pa.sineIn,null,300),G.timer.once(1300,this,function(){this.mouseEnabled=!0,t._recordTime=pt.now(),this.once("click",this,t.onClick)}),G.timer.once(4e3,this,this.onClick)},i.onClick=function(){Og.to(this.box_bottom,{alpha:0,y:886},400,pa.linearInOut,ql.create(this,this.close))},i.clearEff=function(){},i.close=function(){var e=this;e._effect&&(-1<e._effectS.indexOf(e._effId)?(Og.to(e.mcE,{x:360,y:410,scaleX:.83,scaleY:.83},300,pa.linearIn,ql.create(e,e.close2)),Og.to(e.mcTitle,{alpha:0},300,pa.linearIn)):e.mcTitle&&Og.to(e.mcTitle,{alpha:0},300,pa.linearIn,ql.create(e,e.close2)))},i.close2=function(){this._icon&&this._icon.removeSelf(),this._effect&&this._effect.dispose(),this._effect=null,hN.ins._closePanel(this),G.timer.clearAll(this),Og.clearAll(this)},t.HANDEFFID="jm1101",t.STAGEEFFID="jm1100",t}(),_Q=function(e){function t(){var e=this;e.box=null,e._effect=null,e._icon=null,e._orgX=0,e._orgY=0,e.showDataVo=null,e._effId=null,e.tween1=null,e.tween2=null,e.tween3=null,e.titleTween=null,e.ballTween=null,e._handEff=null,e._recordTime=NaN,t.__super.call(e),e._orgX=e.mcE.x,e._orgY=e.mcE.y}b(t,"modules.actor.views.wing.SwingActiveView",xp);var i=t.prototype;return i.showData=function(e){var t=this;t.showDataVo=e,UB.ins.playSound("23"),t.mcE.pos(360,530),t.box_lv.scale(0,0),t.boxName.scale(0,0),t.box_bottom.alpha=0,t.bg.centerX=0,t.tween1&&t.tween1.clear(),t.tween1=Og.to(t.box_bottom,{alpha:1},500,pa.linearIn,ql.create(t,t.createEff)),G.timer.once(1100,t,t.addClickFun)},i.addClickFun=function(){this.once("click",this,this.close2)},i.onEffectComplete=function(){var e=this;e.showDataVo.effect?(e._effect||(e._effect=mj.GetNew(),e._effect.renderInSelf=!0),e._effect.loadEffect(e.showDataVo.effect),e._effId=e.showDataVo.effect,e._effect.pos(0,0),e._effect.scaleX=e._effect.scaleY=1,e.mcE.addChild(e._effect)):e.showDataVo.icon&&(e._icon=e.showDataVo.icon,e.mcE.addChild(e._icon));var t=e.showDataVo.offsetX?e.showDataVo.offsetX:0,i=e.showDataVo.offsetY?e.showDataVo.offsetY:0;e.mcE.pos(e._orgX+t,e._orgY+i),e.addChild(e.mcE);e.showDataVo.scaleX&&e.showDataVo.scaleX,e.showDataVo.scaleY&&e.showDataVo.scaleY;e.mcE.scale(0,0),e.ballTween=Og.to(e.mcE,{scaleX:1,scaleY:1},200,pa.linearIn),e.tween2=Og.to(e.box_lv,{scaleX:1,scaleY:1},200,pa.linearIn),e.tween3=Og.to(e.boxName,{scaleX:1,scaleY:1},200,pa.linearIn)},i.createEff=function(){var e=this;e._handEff=kB.createEffect("jm1034",360,389,e),e._handEff.scaleX=e._handEff.scaleY=1.2,e._handEff.alpha=0,null!=e.tween2?e.tween2.clear():e.tween2=new Og,e.tween2=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onEffectComplete)),e.txName.changeText(e.showDataVo.name),e.mc_level.value=e.showDataVo.wingStep+""},i.clearEff=function(){},i.close=function(){wR.ins.isActivitingWing=!1},i.close2=function(){var e=this;wR.ins.isActivitingWing=!1,e._icon&&e._icon.removeSelf(),e._effect&&e._effect.dispose(),e._effect=null,e._handEff&&(e._handEff.parent&&e._handEff.parent.removeChild(e._handEff),e._handEff=null),hN.ins._closePanel(e),G.timer.clearAll(e),Og.clearAll(e),e.tween1&&e.tween1.clear()},i.destroy=function(e){void 0===e&&(e=!0),this._effect&&this._effect.dispose(),this._effect=null,laya.ui.View.prototype.destroy.call(this,e)},t.HANDEFFID="jm1034",t.STAGEEFFID="jm1100",t}(),fQ=function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.wing.SWingBlessTips",D_);var i=t.prototype;return i.initialize=function(){this.chk.selected=0==gR.ins.isshowYuyiBless},i.onClick=function(e){e.target==this.btn_cancel?(gR.ins.showYuyiBless=0,eq.panelLayer.close(this),hN.ins.close("ACTOR_M")):e.target==this.btn_ok?hN.ins.close("SWING_BLESSTIP"):e.target!=this.chk&&e.target!=this.txt_chk||(gR.ins.isshowYuyiBless=1==gR.ins.isshowYuyiBless?0:1,this.chk.selected=0==gR.ins.isshowYuyiBless)},i.update=function(e){if(e){var t=RP.n[649]+"#23b11f;'>"+e.bless+RP.n[650]+"#ff2e24"+RP.n[651]+e.time+RP.n[652]+RP.n[653];this.txt_notice.innerHTML=t}},i.onAdd=function(e){this.on("click",this,this.onClick),ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){this.off("click",this,this.onClick),ui.ViewBase.prototype.onRemove.call(this,e),this.txt_notice.innerHTML=""},t}(),pQ=function(e){function t(){var e=this;e.swingH=null,e.totalStep=5,e._goodsIdx=null,e._wingComposeIdx=null,e._curSType=0,e._curIdx=-1,e._isEnough=!1,e.roleWingNameTxtArr=null,e.xzArr=null,e._gridRes=null,e._gridTarget=null,e.resId=0,e.resNum=0,e.exChangeId=0,e.sp_reddot=null,t.__super.call(e),e.init()}b(t,"modules.actor.views.wing.SWingComposeV",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.yuyi_bg.skin=_r.getFullUrl("ui/images/yuyi/yy_syjm_db.jpg")},i.updateByVSC=function(e){"21115"==e.actionOrder&&zB.ins.playErrorMsg(1==e.step?RP.n[654]:RP.n[655]),"BP_UPDATE"==e.actionOrder&&this.updateNum()},i.onAdd=function(e){this.on("click",this,this.onClick),this.showList(1)},i.onRemove=function(e){this.off("click",this,this.onClick),-1!=this._curIdx&&(this["btnS_"+(this._curIdx+1)].selected=!1,this["btnS_"+(this._curIdx+1)].mouseEnabled=!0,this._curIdx=-1)},i.onClick=function(e){var t=this;if(e.target==t.btnT_1||e.target==t.btnT_2||e.target==t.btnT_3||e.target==t.btnT_4){var i=parseInt(e.target.name);t.showList(i)}else e.target==t.btnS_1||e.target==t.btnS_2||e.target==t.btnS_3||e.target==t.btnS_4||e.target==t.btnS_5?t.showDetail(parseInt(e.target.name)-1):e.target==t.btnOk&&(t._isEnough?t.compose():zB.ins.playErrorMsg(RP.n[656]))},i.showList=function(e){var t=this;t._curSType=la.SWING[e-1],t.mcSelect.pos(t["btnT_"+e].x,t["btnT_"+e].y);var i=0,n=0;t._goodsIdx=[],t._wingComposeIdx=[];for(var s=1;s<=t.totalStep;s++)n=t.swingH.take(t._curSType+"_"+s),t._wingComposeIdx[s-1]=n,i=vo.MODEL.itemId(n-1),t.addChild(t.mcSelect),t["btnS_"+s].label=Bi.MODEL.name(Bi.getIndex(i)),t._goodsIdx[s-1]=i;t.showDetail(0,!0)},i.showDetail=function(e,t){var i=this;if(void 0===t&&(t=!1),i._curIdx!=e||t){-1!=i._curIdx&&(i["btnS_"+(i._curIdx+1)].selected=!1,i["btnS_"+(i._curIdx+1)].mouseEnabled=!0);for(var n=0;n<i.xzArr.length;n++)i.xzArr[n].visible=!1;i.xzArr[e].visible=!0,i._curIdx=e,i["btnS_"+(i._curIdx+1)].selected=!0,i["btnS_"+(i._curIdx+1)].mouseEnabled=!1;var s=i._goodsIdx[i._curIdx],o=i._wingComposeIdx[i._curIdx];i.exChangeId=vo.MODEL.exchangeID(vo.getIndex(o));var a=JSON.parse(xa.MODEL.consumption(xa.getIndex(i.exChangeId)))[0].value.split(":");i.resId=parseInt(a[0]),i.resNum=parseInt(a[1]),i._gridRes.bindData=yB.create(i.resId),i._gridTarget.bindData=yB.create(s),i.txRes.changeText(Bi.MODEL.name(Bi.getIndex(i.resId))),i.txTarget.changeText(Bi.MODEL.name(Bi.getIndex(s))),i.updateNum();var r;i.clearAttrs(),i.mcWord.graphics.clear(),0==e?(i.btnOk.label="合 成",.5*i.mcWord.width,i.txt_title_l.text=RP.n[657],50,i.fight_l.value=RR.getFight(Bi.MODEL.attributes(Bi.getIndex(s))).toString(),42,r=aa.formatAttrToChineseByList(Bi.MODEL.attributes(Bi.getIndex(s))),i.drawLeftText(r,!0,"#23b11f"),i.mc_arrow.visible=i.boxright.visible=!1,i.boxleft.pos(230,i.boxleft.y)):(i.mc_arrow.visible=i.boxright.visible=!0,i.boxleft.pos(41,i.boxleft.y),i.btnOk.label="升 阶",.2*i.mcWord.width,.78*i.mcWord.width,i.txt_title_l.text="升阶前",i.txt_title_r.text="升阶后",50,i.fight_l.value=RR.getFight(Bi.MODEL.attributes(Bi.getIndex(i.resId))).toString(),i.fight_r.value=RR.getFight(Bi.MODEL.attributes(Bi.getIndex(s))).toString(),42,r=aa.formatAttrToChineseByList(Bi.MODEL.attributes(Bi.getIndex(i.resId))),i.drawLeftText(r),r=aa.formatAttrToChineseByList(Bi.MODEL.attributes(Bi.getIndex(s))),i.drawRightText(r,!0,"#23b11f"))}},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.sname+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.drawRightText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_r"+o],l=this["txt_attrname_r"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.sname+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+"</font>"}},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attr_r"+e],n=this["txt_attrname_l"+e],s=this["txt_attrname_r"+e];t.visible=!1,i.visible=!1,n.visible=!1,s.visible=!1}},i.updateNum=function(){var e=this,t=TR.ins.getGoodsNum(e.resId);e._isEnough=t>=e.resNum,e.btnOk.showTip=e._isEnough,e.txNow.changeText(t+""),e.txNow.color=e._isEnough?"#e3dcc2":"#ff2e24",e.txNeed.changeText("/"+e.resNum),e.updateRedPoint()},i.updateRedPoint=function(){this.sp_reddot.graphics.clear();for(var e=vo.count,t=0,i=0,n=0,s=0;s<e;s++){t=vo.MODEL.exchangeID(s);var o=JSON.parse(xa.MODEL.consumption(xa.getIndex(t)))[0].value.split(":");i=parseInt(o[0]),n=parseInt(o[1]);var a=TR.ins.getGoodsNum(i);if(0<n&&n<=a){var r=vo.MODEL.type(s);if(0<=la.SWING.indexOf(r)){var l=la.SWING.indexOf(r)+1;this.drawReddot(this["btnT_"+l]),this._curSType==r&&this.drawReddot(this["btnS_"+vo.MODEL.level(s)])}}}},i.drawText=function(e,t,i,n,s,o,a,r){var l;void 0===s&&(s="left"),void 0===o&&(o="#ffffff"),void 0===a&&(a=45),void 0===r&&(r=!1),r&&e.clear();for(var c=0;c<n.length;c++)l=n[c],e.fillText(l.name+"："+l.val,t,i,"22px SimHei",o,s),i+=a},i.compose=function(){OR.requestExchange(this.exChangeId,1,0,0)},i.init=function(){var e=this;e.mouseEnabled=!0,e.roleWingNameTxtArr=[],e.swingH=new jl;for(var t=vo.count,i=0,n=0,s=0,o=0;o<t;o++)i=vo.MODEL.type(o),n=vo.MODEL.level(o),s=o+1,e.swingH.put(i+"_"+n,s,!0);for(var a=0;a<la.SWING.length;a++){var r=kB.createText(e["btnT_"+(a+1)].x,e["btnT_"+(a+1)].y+116,116,50,la.getName(la.SWING[a]),20,"#6c6250",!1,"center",!1,!1,e);e.addChild(r),e.roleWingNameTxtArr.push(r)}for(e.xzArr=[e.select1,e.select2,e.select3,e.select4,e.select5],o=0;o<e.xzArr.length;o++)e.xzArr[o].visible=!1;e._gridRes=new MF,e._gridRes.x=e.gridbg_1.x,e._gridRes.y=e.gridbg_1.y,e.addChild(e._gridRes),e._gridTarget=new MF,e._gridTarget.x=e.gridbg_2.x,e._gridTarget.y=e.gridbg_2.y,e.addChild(e._gridTarget),e.sp_reddot=new pp,e.addChild(e.sp_reddot)},i.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+e.width-30,e.y-1,t.width,t.height),this.addChildAt(this.sp_reddot,this.numChildren-1)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(O_),gQ=function(e){function t(){var e=this;e._selector=null,e._grids=null,e._equipWing=null,e._curItemIdx=0,e._curActorIdx=0,e._curAd=null,e._itemIsTop=!1,e._targetId=0,e._exchangeId=0,e._isEnough=!1,e._isCompose=!1,e._stepEnough=!1,e.roleWingNameTxtArr=null,e._stepLimit=0,e._suitNum=0,e._nextsuitNum=0,e._suitId=-1,e._suitLevel=0,e.img_skill=null,e._skillId=0,e.connuseId=0,e.targetArr=null,e.roleHash=null,e.sp_reddot=null,t.__super.call(e),e.init()}b(t,"modules.actor.views.wing.SWingEquipV",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.yuyi_bg.skin=_r.getFullUrl("ui/images/yuyi/yy_syjm_db.jpg")},i.updateByVSC=function(e){"BP_UPDATE"==e.actionOrder?this.updateResNum():"EQUIP_UPDATE"==e.actionOrder&&this.showRole()},i.onAdd=function(e){this.on("click",this,this.onClick),this._selector.on("select",this,this.onSelect),this.onSelect()},i.onRemove=function(e){this.off("click",this,this.onClick),this._selector.off("select",this,this.onSelect),this._selector.selectIdx=0},i.onClick=function(e){var t=this;if(-1!=t._grids.indexOf(e.target))t.onSelectItem(t._grids.indexOf(e.target));else if(e.target==t.btnQuick){if(!t._isEnough)return void zB.ins.playErrorMsg(RP.n[658]);if(!t._stepEnough)return void zB.ins.playErrorMsg(RP.n[659]+t._stepLimit+RP.n[660]);OR.requestExchange(t._exchangeId,1,t._selector.selectIdx+1,1)}else if(e.target==t.mcShow_1||e.target==t.mcShow_2||e.target==t.mcShow_3||e.target==t.mcShow_4)t.onSelectItem(parseInt(e.target.name)-1);else if(e.target==t.label_get)Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.connuseId});else if(e.target==t.btnB){var i=wR.ins.getBetter(t._selector.selectIdx+1,la.SWING[t._curItemIdx]);i?nR.equipSWing(t._selector.selectIdx+1,i.uuId,la.SWING[t._curItemIdx]):zB.ins.playErrorMsg(RP.n[661])}else if(e.target==t.btnMaster){var n={suitid:t._suitId,suitnum:t._suitNum,nextsuitnum:t._nextsuitNum};sW.instance().show(n)}else if(e.target==t.mcSkill){var s={skillId:t._skillId};oW.instance.show(s)}},i.onSelect=function(){this._curItemIdx=0,this.showRole()},i.getRoleData=function(){var e,t=[];this.roleHash=new jl,wR.ins.itemIsTop(22,0);for(var i=0;i<gR.ins.actorList.length;i++){this._curAd=gR.ins.actorList[i],t=[];for(var n=0;n<la.SWING.length;n++)if(e=MR.ins.getEquip(this._curAd.id,la.SWING[n])){var s=wR.ins.posH.take(la.SWING[n]).indexOf(e.goodsId);t.push(wR.ins.posH.take(la.SWING[n])[s+1])}else{var o=wR.ins.posH.take(la.SWING[n]);t=t.concat(o)}this.roleHash.put(i,t)}},i.showRole=function(){var e,t=this;t.targetArr=[];var i=5,n=0,s=gR.ins.actorList[t._selector.selectIdx];if(s.wingData.wingStep<=0)return zB.ins.playErrorMsg(RP.n[662]),void(t._selector.selectIdx=t._curActorIdx);t._curActorIdx=t._selector.selectIdx,t._suitNum=0,t._suitLevel=0,t._nextsuitNum=0,t._suitId=-1,t._curAd=s,t.sp_reddot.graphics.clear(),wR.ins.itemIsTop(22,0);for(var o=0;o<la.SWING.length;o++){if(e=MR.ins.getEquip(t._curAd.id,la.SWING[o]),t._grids[o].bindData=e){t._grids[o].visible=!0,t.roleWingNameTxtArr[o].changeText(e.name),i>e.useLevel&&(i=e.useLevel),t._suitNum++;var a=wR.ins.posH.take(la.SWING[o]).indexOf(e.goodsId);t.targetArr.push(wR.ins.posH.take(la.SWING[o])[a+1])}else t.roleWingNameTxtArr[o].changeText(la.getName(la.SWING[o])),t._grids[o].visible=!1,t.targetArr.push(wR.ins.posH.take(la.SWING[o])[0]);(e=wR.ins.getBetter(t._curAd.id,la.SWING[o]))&&t.drawReddot(t._grids[o])}for(o=0;o<ji.count;o++)if("godWing"==ji.MODEL.suitType(o)&&ji.MODEL.suitNeedNum(o)==t._suitNum&&ji.MODEL.level(o)==i){t._suitId=ji.MODEL.key(o);for(var r=0;r<la.SWING.length;r++)(e=MR.ins.getEquip(t._curAd.id,la.SWING[r]))&&i<e.useLevel&&t._nextsuitNum++}if(-1==t._suitId)for(i=1,o=0;o<ji.count;o++)"godWing"==ji.MODEL.suitType(o)&&ji.MODEL.level(o)==i&&(t._suitId=ji.MODEL.key(o));for(t._skillId=ji.MODEL.skiiId(ji.getIndex(t._suitId)),ji.MODEL.suitNeedNum(ji.getIndex(t._suitId))<=t._suitNum&&(t._suitLevel=ji.MODEL.level(ji.getIndex(t._suitId))),0<t._skillId?Pg.gray(t.img_skill,!1):null!=t.img_skill.filters&&0!=t.img_skill.filters.length||Pg.gray(t.img_skill,!0),o=0;o<la.SWING.length;o++)if(e=MR.ins.getEquip(t._curAd.id,la.SWING[o])){var l=t.precentAddAtt(aa.formatAttrToChineseByList(Bi.MODEL.attributes(e.cfgIdx),!1,!1,!1));n+=Math.ceil(RR.getFight(l,-1,0,!1,!1))}t.fcForce.value=n,t.onSelectItem(t._curItemIdx)},i.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+e.width-30,e.y-1,t.width,t.height),this.addChildAt(this.sp_reddot,this.numChildren-1)},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attr_r"+e],n=this["txt_attrname_l"+e],s=this["txt_attrname_r"+e];t.visible=!1,i.visible=!1,n.visible=!1,s.visible=!1}},i.onSelectItem=function(e){var t=this;t._curItemIdx=e;var i=t._grids[e],n=i.bindData,s=la.SWING[e];wR.ins.getMinStep(s);t.addChild(t.mcSelect),t.mcSelect.pos(i.x,i.y),t.mcWord.graphics.clear(),t._curAd.wingData.wingStep,t.clearAttrs(),t._itemIsTop=n&&wR.ins.itemIsTop(s,n.goodsId),t.label_get.visible=t.txCost.visible=t.txRes.visible=t.btnB.visible=!t._itemIsTop,t.btnQuick.visible=!t._itemIsTop;var o,a,r,l=0;if(t._itemIsTop){t.boxleft.pos(230,t.boxleft.y),t.txt_title_l.text="最高阶",t.mc_arrow.visible=t.boxright.visible=!1,o=aa.formatAttrToChineseByList(Bi.MODEL.attributes(n.cfgIdx)),t.drawLeftText(o,!0,"#23b11f"),t.fight_l.value=Math.ceil(RR.getFight(aa.formatAttrToChineseByList(Bi.MODEL.attributes(n.cfgIdx),!1,!1,!1),-1,0,!1,!1)).toString(),t.getRoleData();for(var c=0;c<gR.ins.actorList.length;c++)t._selector.setRedPtByIdx(c,t.getShowTip(c))}else{if(t.btnB.showTip=null!=wR.ins.getBetter(t._selector.selectIdx+1,la.SWING[t._curItemIdx]),t.clearAttrs(),null==n)return t.boxleft.pos(230,t.boxleft.y),t.mc_arrow.visible=t.boxright.visible=!1,t._isCompose=!0,t.btnQuick.label=RP.n[663],.5*t.mcWord.width,t.txt_title_l.text=RP.n[657],50,t._targetId=wR.ins.posH.take(s)[0],l=Bi.getIndex(t._targetId),o=aa.formatAttrToChineseByList(Bi.MODEL.attributes(l)),t.drawLeftText(o,!0,"#23b11f"),t.fight_l.value=Math.ceil(RR.getFight(aa.formatAttrToChineseByList(Bi.MODEL.attributes(l),!1,!1,!1),-1,0,!1,!1)).toString(),50,void t.updateResNum();t.boxleft.pos(40,t.boxleft.y),t.mc_arrow.visible=t.boxright.visible=!0,t._isCompose=!1,.25*t.mcWord.width;t.mcWord.width;t.txt_title_l.text="升阶前",t.txt_title_r.text="升阶后",50,o=aa.formatAttrToChineseByList(Bi.MODEL.attributes(n.cfgIdx)),t.fight_l.value=Math.ceil(RR.getFight(aa.formatAttrToChineseByList(Bi.MODEL.attributes(n.cfgIdx),!1,!1,!1),-1,0,!1,!1)).toString(),t.drawLeftText(o),l=wR.ins.posH.take(s).indexOf(n.goodsId),t._targetId=wR.ins.posH.take(s)[l+1],r=Bi.getIndex(t._targetId),a=aa.formatAttrToChineseByList(Bi.MODEL.attributes(r)),t.fight_r.value=Math.ceil(RR.getFight(aa.formatAttrToChineseByList(Bi.MODEL.attributes(r),!1,!1,!1),-1,0,!1,!1)).toString(),50,t.drawRightText(a,!0,"#23b11f"),t.btnQuick.label=n?RP.n[665]:RP.n[666],t.updateResNum()}},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.sname+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.drawRightText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_r"+o],l=this["txt_attrname_r"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.sname+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+"</font>"}},i.drawText=function(e,t,i,n,s,o,a,r){void 0===s&&(s="left"),void 0===o&&(o="#ffffff"),void 0===a&&(a=45),void 0===r&&(r=!1),r&&e.clear();var l;ji.MODEL.level(ji.getIndex(this._suitId));if(!(null==n||n.length<=0))for(var c=0;c<n.length;c++)l=n[c],e.fillText(l.name+"："+l.val,t,i,"22px SimHei",o,s),i+=a},i.precentAddAtt=function(e){for(var t,i=0;i<e.length;i++)(t=e[i]).val=Math.ceil(t.val*(1+.05*this._suitLevel));return e},i.updateResNum=function(){var e=this;if(0!=e._targetId){for(var t=vo.count,i=0,n=0;n<t;n++)vo.MODEL.itemId(n)==e._targetId&&(i=n);e._exchangeId=vo.MODEL.exchangeID(i);var s=xa.MODEL.consumption(xa.getIndex(e._exchangeId)),o=JSON.parse(s)[0].value.split(":"),a=parseInt(o[0]),r=TR.ins.getGoodsNum(a),l=parseInt(o[1]);!e._isCompose&&r++,e._isEnough=l<=r;var c=e._isEnough?"#e3dcc2":"#ff2e24";e.txRes.innerHTML="消耗"+Bi.MODEL.name(Bi.getIndex(a))+"：",e.txCost.innerHTML=Ql.createColor(r+"",c)+"/"+l,e.connuseId=a,e._stepEnough=yo.MODEL.levelLimit(i)<=gR.ins.actorById(e._selector.selectIdx+1).wingData.wingStep,e._stepLimit=yo.MODEL.levelLimit(i),e.btnQuick.showTip=e._isEnough&&e._stepEnough,e.getRoleData();for(var u=0;u<gR.ins.actorList.length;u++)e._selector.setRedPtByIdx(u,e.getShowTip(u))}},i.getShowTip=function(e){for(var t=!1,i=0;i<la.SWING.length&&1!=(t=null!=wR.ins.getBetter(e+1,la.SWING[i]));i++);var n=0,s=this.roleHash.take(e);for(i=0;i<s.length;i++)for(var o=vo.count,a=0;a<o;a++)if(vo.MODEL.itemId(a)==s[i]){n=a;var r=vo.MODEL.exchangeID(n),l=xa.MODEL.consumption(xa.getIndex(r)),c=JSON.parse(l)[0].value.split(":"),u=parseInt(c[0]),d=TR.ins.getGoodsNum(u),h=parseInt(c[1]);if(10<h?h<=d:h-1<=d)if(yo.MODEL.levelLimit(n)<=gR.ins.actorById(e+1).wingData.wingStep&&(t=!0,e==this._selector.selectIdx)){var _=0;_=10<h?la.SWING.indexOf(yo.MODEL.position(yo.getIndex(s[i]))):la.SWING.indexOf(yo.MODEL.position(yo.getIndex(u))),this.drawReddot(this._grids[_])}}return t},i.init=function(){var e,t=this;t._selector=new Nj,t.addChild(t._selector),t.removeChild(t.mcSelect),t.roleWingNameTxtArr=[],t._grids=[];for(var i=0;i<la.SWING.length;i++){(e=new MF).toolTipEnabled=!1,(t._grids[i]=e).x=t["mcShow_"+(i+1)].x,e.y=t["mcShow_"+(i+1)].y,t.addChild(e);var n=kB.createText(t["mcShow_"+(i+1)].x,t["mcShow_"+(i+1)].y+116,116,50,la.getName(la.SWING[i]),20,"#6c6250",!1,"center",!1,!1,t);t.addChild(n),t.roleWingNameTxtArr.push(n)}t.img_skill=new Kl,t.img_skill.width=t.img_skill.height=64,t.addChild(t.img_skill),t.img_skill.pos(t.mcSkill.x+5,t.mcSkill.y+5);var s=Ls.getIndex(22);t.img_skill.skin=_r.getIconPath(Ls.MODEL.icon(s)),t.txSName.changeText(Ls.MODEL.skillName(s));var o=_r.getAtlasSubPath("basic_ui/ty_ts_hd.png");t.btnQuick.tipSkin=t.btnB.tipSkin=o,t.sp_reddot=new pp,t.addChild(t.sp_reddot)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(P_),vQ=function(e){function t(){var e=this;e._showGL=null,e._showNum=3,e._resG=null,e._swingH=null,e._selectId=0,e._targetId=0,e._exchangeId=0,e.roleWingNameTxtArr=null,e.linesArr=null,e.isGoldEngth=!1,t.__super.call(e),e.init()}b(t,"modules.actor.views.wing.SWingExchange",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.yuyi_bg.skin=_r.getFullUrl("ui/images/yuyi/yy_syjm_db.jpg")},i.updateByVSC=function(e){"21117"==e.actionOrder?(zB.ins.playErrorMsg(RP.n[667]),this.finish()):"BP_UPDATE"==e.actionOrder&&this.showList()},i.onAdd=function(e){this.on("click",this,this.onClick),this.showList()},i.onRemove=function(e){this.off("click",this,this.onClick),this.mcItems.off("select",this,this.selectItem),this.finish()},i.onClick=function(e){var t=this;if(-1!=t._showGL.indexOf(e.target)){var i=e.target;if(null==i.bindData)return;t._targetId=i.bindData.goodsId,t._exchangeId=parseInt(i.name),t.addChild(t.mcSelect);var n=0;for(n=0;n<3;n++)t.linesArr[n].visible=!1;t.linesArr[i.prop].visible=!0,t.mcSelect.x=i.x,t.mcSelect.y=i.y}else e.target==t.btnOk&&t.exchange()},i.showList=function(){var e=this;e.finish();for(var t=[],i=0;i<TR.bagModel.goodsList.length;i++){var n=TR.bagModel.goodsList[i];-1!=la.SWING.indexOf(Bi.MODEL.decoratePosition(n.cfgIdx))&&(t[t.length]=n)}if(0==t.length)return e.txt_nostuff.visible=!0,void(e.mcItems.visible=!1);e.txt_nostuff.visible=!1,e.mcItems.visible=!0,t=ol.srotOn(t,"goodsId",Array.NUMERIC),e.mcItems.selectedIndex=-1,e.mcItems.dataSource=t,e.mcItems.selectHandler=ql.create(e,e.selectItem,null,!1)},i.finish=function(){for(var e=this,t=0;t<e._showGL.length;t++)e._showGL[t].bindData=null;for(t=0;t<e.roleWingNameTxtArr.length;t++)e.roleWingNameTxtArr[t].changeText("");e.txt_name.changeText(""),e._resG.bindData=null,e.txGold.innerHTML="",e._selectId=0,e._targetId=0,e.removeChild(e.mcSelect)},i.selectItem=function(e){var t=this;if(-1!=e){var i=t.mcItems.dataSource[e];t.mcItems.getItem(e);t._selectId=i.goodsId,t._resG.bindData=i,t.txt_name.changeText(i.name);var n,s=0,o=0,a=t._swingH.take(t._selectId),r=0;for(s=0;s<a.length;s++)if(a[s]!=t._selectId){null!=(n=t._showGL[r]).bindData&&n.bindData.recover(),o=xa.getIndex(a[s]),n.name=a[s],n.prop=s;var l=JSON.parse(xa.MODEL.reward(o))[0].value.split(":"),c=parseInt(l[0]);n.bindData=yB.create(c),t.roleWingNameTxtArr[s].changeText(n.bindData.name),r++}var u=JSON.parse(xa.MODEL.consumption(o))[1].value.split(":"),d=parseInt(u[1]);gR.ins.YB>=d?t.isGoldEngth=!0:t.isGoldEngth=!1;var h=t.isGoldEngth?"#e3dcc2":"#ff2e24";t.txGold.innerHTML=Ql.createColor(d+"",h)}},i.exchange=function(){0!=this._selectId?0!=this._targetId?this.isGoldEngth?(OR.requestExchange(this._exchangeId,1),this.isGoldEngth&&(this._resG.bindData=null)):KQ.ins.showNoGold():zB.ins.playErrorMsg(RP.n[669]):zB.ins.playErrorMsg(RP.n[668])},i.init=function(){var e,t,i=this;i.mouseEnabled=!0,i.mcItems.hScrollBarSkin="",i.mcItems.itemRender=TF,i.mcItems.selectEnable=!0,i.mcItems.scrollBar.elasticBackTime=300,i.mcItems.scrollBar.elasticDistance=100,i.removeChild(i.mcSelect),i.txt_name.text="",i._showGL=[],i.roleWingNameTxtArr=[];for(var n=0;n<i._showNum;n++){(e=new MF).toolTipEnabled=!1,e.x=i["mcShow_"+(n+1)].x,e.y=i["mcShow_"+(n+1)].y,i._showGL[n]=e,i.addChild(e);var s=kB.createText(i["mcShow_"+(n+1)].x,i["mcShow_"+(n+1)].y+116,116,50,"",20,"#e3dcc2",!1,"center",!1,!1,i);i.addChild(s),i.roleWingNameTxtArr.push(s)}i._resG=new MF,i._resG.x=i.mcRes.x,i._resG.y=i.mcRes.y,i.addChild(i._resG),i._swingH=new jl;var o=Io.count,a=0;for(n=0;n<o;n++)a=Io.MODEL.godWingid(n),i._swingH.has(a)?t=i._swingH.take(a):(t=[],i._swingH.put(a,t,!0)),t[t.length]=Io.MODEL.exchangeID(n);for(i.linesArr=[i.leftline,i.mideline,i.rightline],n=0;n<3;n++)i.linesArr[n].visible=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(R_),mQ=(function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.wing.SWingMasterV1",B_),t.prototype.showContent=function(e){}}(),function(e){function t(){var e=this;e._iconId="",e.img_icon=null,e._lastIconSkin=null,t.__super.call(e),e.centerX=e.centerY=0,e.img_icon=new Kl,e.addChild(e.img_icon),e.img_icon.x=e.icon.x+8,e.img_icon.y=e.icon.y+8,e.img_icon.width=100,e.img_icon.height=100}b(t,"modules.actor.views.wing.SWingSkillNewTip",H_);var i=t.prototype;return i.showById=function(e,t){var i=this;void 0===t&&(t="");var n=Ls.getIndex(e);i._iconId=Ls.MODEL.icon(n),i.img_icon.skin=_r.getIconPath(i._iconId),null!=i._lastIconSkin&&-1!=NP.noClearTexture.indexOf(i._lastIconSkin)&&NP.noClearTexture.splice(NP.noClearTexture.indexOf(i._lastIconSkin,1)),i._lastIconSkin=i.img_icon.skin,NP.noClearTexture.push(i._lastIconSkin),i.txt_skill_name.changeText(Ls.MODEL.skillName(n)),i.div_skill_des.innerHTML=Ls.MODEL.skillDesc(n),""==t||null==t?(i.txt_skill_state.changeText("已激活"),i.txt_skill_state.color="#90877b"):(i.txt_skill_state.changeText(t),i.txt_skill_state.color="#ff2e24"),i.parent||(eq.panelLayer.once("MASK_CLOSE",i,i.onClick),eq.panelLayer.open(i,!1,!0))},i.close=function(e){void 0===e&&(e=!1),eq.panelLayer.close(this),null!=this._lastIconSkin&&-1!=NP.noClearTexture.indexOf(this._lastIconSkin)&&NP.noClearTexture.splice(NP.noClearTexture.indexOf(this._lastIconSkin,1))},i.onClick=function(e){e instanceof modules.actor.views.wing.SWingSkillNewTip&&this.close()},p(1,t,"isInited",function(){return null!=t._instance},layouts.actor.wing.SWingSkillNewTipUI._$SET_isInited),p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.actor.wing.SWingSkillNewTipUI._$SET_instance),t._instance=null,t}()),yQ=(function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.wing.SWingSkillV",G_);var i=t.prototype;i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showContent=function(e){}}(),function(e){function t(){var e=this;e.g_id=0,e.g_item=null,e.b_box=null,e.s_box=null,e._data=null,e.GAP=40,e.START_X=10,e.START_Y=70,e.img_item=null,t.__super.call(e)}b(t,"modules.actor.views.wing.SWingUpdateView",U_);var i=t.prototype;return i.initialize=function(){var e=this;e.g_item=new MF,e.g_item.pos(e.icon.x,e.icon.y),e.addChild(e.g_item),e.b_box=new dt,e.b_box.pos(25,232),e.addChild(e.b_box),e.s_box=new dt,e.s_box.pos(25,365),e.addChild(e.s_box)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_levelUp.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.btn_levelUp.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.update=function(e){var t=this;if(e){t._data=e,2==t._data.type?t.g_id=2536:t.g_id=2537;var i=yB.create(t.g_id);t.g_item.bindData=i,t.img_icon.skin=_r.getIconPath(Bi.MODEL.icon(i.cfgIdx));var n=Bi.MODEL.colourId(i.cfgIdx);1<n?(t.img_grade.visible=!0,t.img_grade.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+n+".png")):t.img_grade.visible=!1;var s=Bi.MODEL.colourId(i.cfgIdx);t.txt_name.color=ms.getByQuality(s),t.txt_name.text=i.name,t.initInfo()}},i.getFight=function(e,t){if(0==t)return 0;for(var i in e)-1<e[i].type.indexOf("_C")?e[i].type=e[i].type.split("_")[0]:e[i].value=parseInt(e[i].value)*t;return Math.ceil(RR.getFight(e,this._data.actor,0,!1,!1))},i.getfeishengjiachengAtt=function(){var e,t,i=0,n=this._data.actorD,s=(n.wingData.feishengdan,n.wingData.zhizidan),o=[];for(o=aa.mergeFormatAttrs(n.wingData.curAttr,o),e=$e.MODEL.value($e.getIndex(94)),i=0;i<s;i++)o=aa.mergeFormatAttrs(e,o);for(i=0;i<o.length;i++)(t=o[i]).value=Math.ceil(t.value*(.01*n.wingData.feishengdan));return aa.formatAttrToChineseByList(o)},i.initInfo=function(){var e=this;if(e._data){var t,i,n=e._data.actorD,s=279,o=0,a=0;switch(e._data.type){case 1:o=n.wingData.zhizidan,t=aa.formatAttrToChineseByList($e.MODEL.value($e.getIndex(94))),i=null,a+=e.getFight(JSON.parse($e.MODEL.value($e.getIndex(94))),o),e.tips_type.changeText(RP.n[670]);break;case 2:o=n.wingData.feishengdan,t=aa.formatAttrToChineseByList($e.MODEL.value($e.getIndex(92))),i=aa.formatAttrToChineseByList($e.MODEL.value($e.getIndex(93))),a+=e.getFight(JSON.parse($e.MODEL.value($e.getIndex(93))),o),a+=RR.getFight(e.getfeishengjiachengAtt()),e.tips_type.changeText(RP.n[671])}e.mcf.value=a,e.txt_level.text=o+"级",e.txt_part.text=n.wingData.wingStep+"阶羽翼";var r=0;for(e.b_box.y=s,e.b_box.graphics.clear(),r=0;r<t.length;r++)2==e._data.type?e.b_box.graphics.fillText(t[r].addName+"：+"+parseInt(t[r].val)*o+"%",e.START_X,e.START_Y+e.GAP*r,"24px SimHei","#90877b","left"):e.b_box.graphics.fillText(t[r].addName+"：+"+parseInt(t[r].val)*o,e.START_X,e.START_Y+e.GAP*r,"24px SimHei","#90877b","left");if(s+=t.length*e.GAP,e.s_box.y=s,e.s_box.graphics.clear(),e.s_box.visible=i&&0<i.length,e.next.visible=e.s_box.visible,e.s_box.visible){for(s+=e.GAP+24,e.next.y=s,e.s_box.y=s-40,r=0;r<i.length;r++)e.s_box.graphics.fillText(i[r].addName+"：+"+parseInt(i[r].val)*o,e.START_X,e.START_Y+e.GAP*r,"24px SimHei","#90877b","left");s+=t.length*e.GAP-40}s+=250,0<TR.ins.getGoodsNum(e.g_id)?(e.bog_cost.visible=!1,e.btn_levelUp.visible=!0,e.btn_levelUp.showTip=!0):(e.bog_cost.visible=!0,e.btn_levelUp.visible=!1,e.btn_levelUp.showTip=!1),e.height=s}},i.onClickHandler=function(e){if(this._data){var t=new aA;t.actor=this._data.actor,t.type=this._data.type,Tu.sendToService(t)}},t}()),IQ=function(e){function t(){this._selector=null,t.__super.call(this),this._selector=new Nj(null,42,80),this.addChild(this._selector),this.update(),this.title.innerHTML=RP.n[672]+Ql.createColor(RP.n[673],"#23b11f")+"的角色"}b(t,"modules.actor.views.wing.SwingZhishengView",F_);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.update(),t.use_1.on("click",t,t.onClick),t.use_2.on("click",t,t.onClick),t.use_3.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.use_1.off("click",t,t.onClick),t.use_2.off("click",t,t.onClick),t.use_3.off("click",t,t.onClick)},i.onClick=function(e){var t=e.target;this.sendUse(t)},i.sendUse=function(e){var t=parseInt(e.name),i=gR.ins.actorList[t-1];if(i)if(i.wingData.wingStep<=0)hN.ins.close("SWING_ZHISHENG"),Tu.sendToModule("WING_ZHISHENG",["modules.actor.ActorModule"],t);else{hN.ins.close("SWING_ZHISHENG"),Tu.sendToModule("WING_ZHISHENG",["modules.actor.ActorModule"],t);var n=new sA;n.actor=t,n.isZhisheng=1,Tu.sendToService(n)}else Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"])},i.update=function(){for(var e,t=this,i=!1,n=0,s=0;s<3;s++)e=gR.ins.actorList[s],t["use_"+(s+1)].showTip=!1,e?(i=0<e.wingData.wingStep,n=TR.ins.getGoodsNum(2061),i?(t["grade_"+(s+1)].innerHTML=RP.n[676]+Ql.createColor(e.wingData.wingStep+"阶","#23b11f"),t["use_"+(s+1)].label=RP.n[677],t["advice_"+(s+1)].visible=!0,0<n&&4==e.wingData.wingStep&&(t["use_"+(s+1)].showTip=!0)):(t["grade_"+(s+1)].innerHTML=RP.n[674],t["use_"+(s+1)].label=RP.n[675],t["advice_"+(s+1)].visible=!1),t["use_"+(s+1)].disabled=!1,10<=e.wingData.wingStep?(t["advice_"+(s+1)].innerHTML=Ql.createColor(RP.n[678],"#e6d80d"),t["use_"+(s+1)].disabled=!0):4<e.wingData.wingStep?t["advice_"+(s+1)].innerHTML=Ql.createColor(RP.n[679],"#e6d80d"):e.wingData.wingStep<4?t["advice_"+(s+1)].innerHTML=Ql.createColor(RP.n[680],"#23b11f"):t["advice_"+(s+1)].innerHTML=Ql.createColor(RP.n[681],"#ff2e24")):(t["grade_"+(s+1)].innerHTML=RP.n[682],t["use_"+(s+1)].label=RP.n[683],t["advice_"+(s+1)].visible=!1)},t}(),bQ=function(e){function n(){this._item=null,n.__super.call(this),this.showView()}b(n,"modules.actor.views.wing.SwingZSQuickbuyView",Sp);var t=n.prototype;return t.onAdd=function(e){this.btn_buy.on("click",this,this.openGift),this.btn_close.on("click",this,this.clolsePanel),ui.ViewBase.prototype.onAdd.call(this,e)},t.onRemove=function(e){this.btn_buy.off("click",this,this.openGift),this.btn_close.off("click",this,this.clolsePanel),ui.ViewBase.prototype.onRemove.call(this,e)},t.showView=function(){this._item=new MF;var e=yB.create(2061);this._item.bindData=e,this.tiem.addChild(this._item)},t.clolsePanel=function(){hN.ins.close("SWING_ZHISHENGBUY")},t.openGift=function(){if(CN.dealActIcon(CN.getIconBtn(46)),MN.isNormalShow)eU.targetId=10013,eU.toSelectIndex=0,CN.dealActIcon(CN.getIconBtn(46));else if(0<Et.count)this.onJxrComplete(46);else{var e=[{url:_r.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:Et}];uc.ins().onLoadJxrs(e,ql.create(CN,this.onJxrComplete,[46]))}},t.onJxrComplete=function(e){if(Et.hasIndex(e)){var t=Et.getIndex(e),i=Et.MODEL.mainType(t);WB.getActivity(i,ql.create(CN,n.onGetActivityList,[i,t]))}},n.onGetActivityList=function(e,t){var i=Et.MODEL.UIId(t);i&&hN.ins.toggle(i,e)},n}(),wQ=function(e){function t(){this.attrItem=null,this._canUp=!1,this.eff=null,this._cost=0,t.__super.call(this)}b(t,"modules.actor.views.zs.ActorZhuanshengV",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.img_bg.skin=_r.getFullUrl("ui/images/zhuansheng/zs_jm_bg.jpg")},i.addGuide=function(){var e,t=this;0==gR.ins.zsLv?PH.Ins().hasNewGuide(44)&&(gR.ins.zsExp<t._cost?((e=new u_).x=t.lk_getXw.x,e.y=t.lk_getXw.y-8,e.width=t.lk_getXw.width,e.height=t.lk_getXw.height,LY.Ins().show(45,e,!1,t)):((e=new u_).x=t.btn_up.x,e.y=t.height-149-t.btn_up.height-8,e.width=t.btn_up.width,e.height=t.btn_up.height,LY.Ins().show(44,e,!1,t))):LY.showing&&LY.Ins().close(44)},i.onAdd=function(e){var t=this;t.btn_up.on("click",t,t.onClick),t.lk_getXw.on("click",t,t.onClickLk),t.btn_preview.on("click",t,t.onClickPreview),t.attrItem||(t.attrItem=new rW,t.attrItem.y=603,t.addChild(t.attrItem)),t.img_success.visible=!1,t.img_red.visible=!1,t.showDetail(),nR.reqOpenZsExchange();var i=gR.ins.zsLv,n=es.getIndex(i+1);t.btn_preview.visible=0<=n},i.onRemove=function(e){var t=this;xQ.ins.close(),t.btn_up.off("click",t,t.onClick),t.lk_getXw.off("click",t,t.onClickLk),t.btn_preview.off("click",t,t.onClickPreview),t.attrItem&&t.attrItem.parent&&t.attrItem.parent.removeChild(t.attrItem),t.attrItem=null,t.clearEff()},i.updateByVSC=function(e){if(this.showDetail(),e instanceof protos.actor.toc_21109)0<e.lv_change&&this.showEffect();else if(e instanceof protos.actor.toc_21120){for(var t=!1,i=gR.ins.zsLv,n=es.getIndex(i+1),s=[0,1,2],o=0;o<s.length;o++){if(gR.ins.checkCanZsExchange(s[o])&&0<=n){t=!0;break}}this.img_red.visible=t,AN.ins.updatePt(6,t)}},i.showDetail=function(){var e=this,t=gR.ins.zsLv,i=t+1;e.txt_zsLv.text=RP.n[684]+t,e.txt_ownXw.text=gR.ins.zsExp+"",e.attrItem.update(t),0<=es.getIndex(t+1)?(e.showCost(i),e.img_max.visible=!1):(e.clearEff(),e.img_max.visible=!0,e.txt_title1.visible=!1,e.txt_title2.visible=!1,e.img_numBg1.visible=!1,e.img_numBg2.visible=!1,e.txt_costXw.visible=!1,e.txt_ownXw.visible=!1,e.btn_up.visible=!1,e.lk_getXw.visible=!1,e.img_red.visible=!1,AN.ins.updatePt(6,!1),AN.ins.updatePt(3,!1),e.btn_preview.visible=!1),e.num_fight.value=e.attrItem.fightValue+Math.floor(e.attrItem.fightValue*e.checkTitle(12)),e.addGuide()},i.checkTitle=function(e){var t=0,i=tg.ins.toc_title;if(!i)return 0;var n,s=i.titles[0];for(var o in s)if((n=s[o]).id==e&&0<=n.state){var a=co.getIndex(e);t=JSON.parse(co.MODEL.attr(a))[4].value/1e4}else;return t},i.showCost=function(e){var t=this,i=es.getIndex(e);t._cost=parseInt(es.MODEL.cost(i)),gR.ins.zsExp<t._cost?(t._canUp=!1,t.txt_ownXw.color="#e70909",t.clearEff()):(t._canUp=!0,t.txt_ownXw.color="#01fb01",t.eff||(t.eff=kB.createEffect("jm1130",t.btn_up.width>>1,t.btn_up.height>>1,t.btn_up),t.eff.scale_X=1.25,t.eff.scale_Y=1.25)),AN.ins.updatePt(3,t._canUp),t.txt_costXw.text=t._cost+""},i.showEffect=function(){var e=mj.GetNew();e.renderInSelf=!0,e.loadEffect("jm0003"),e.pos(this.width/2,this.height/2-150),this.addChild(e),UB.ins.playSound("9",3,!0)},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.getPath=function(e){return _r.getAtlasSubPath("mainframe")+"/num_"+e+".png"},i.onClick=function(e){this._canUp?nR.reqZsUpgrade():zB.ins.playErrorMsg(RP.n[685])},i.onClickPreview=function(e){xQ.ins.showTips()},i.onClickLk=function(e){Tu.sendToModule("OPEN_ZSEXP",["modules.actor.ActorModule"]),LY.showing&&LY.Ins().closeArrow(),UB.ins.playSound(90006)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(oe),xQ=function(e){function t(){this._box=null,t.__super.call(this),this._box=new dt,this.addChild(this._box)}b(t,"modules.actor.views.zs.ZsPreviewTip",jv);var i=t.prototype;return i.showTips=function(){var e=this;e._box.graphics.clear(),e.parent||(eq.panelLayer.openTip(e),eq.panelLayer.on("MASK_CLOSE",e,e.onClick));var t=gR.ins.zsLv,i=t+1;if(0<=es.getIndex(t+1)){e.txt_suitName.innerHTML=i+RP.n[686];for(var n=[],s=es.MODEL.desc(i-1).split('"'),o=1;o<s.length-3;o+=4){var a=[];a.push(s[o]),a.push(s[o+2]),n.push(a)}e.list_preview.array=n,e.list_preview.renderHandler=new ql(e,e.onRender,null,!1)}},i.onRender=function(e,t){if(!(t>this.list_preview.array.length)){var i=this.list_preview.array[t][0],n=this.list_preview.array[t][1],s=e.getChildByName("txt_title"),o=e.getChildByName("txt_content");s.innerHTML=i,o.innerHTML=n}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._box.graphics.clear()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},p(1,t,"ins",function(){return t._instance=t._instance||new t},layouts.actor.zs.ZsPreviewTipUI._$SET_ins),t._instance=null,t}(),SQ=function(t){function e(){this.vsc=null,this._openSelectIndex=0,e.__super.call(this),this.top=this.bottom=this.left=this.right=0,this.init()}b(e,"modules.dailygift.views.DailyGiftSubV",t);var i=e.prototype;return i.init=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0;e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:T0,id:"1",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigActivityMainType","ConfigActivityGift","ConfigRecharge"],["CActivityMainType","CActivityGift","CRecharge"]))}]),e.vsc.filterHandler=ql.create(e,e.checkRedPoint,null,!1)},i.onAdd=function(e){t.prototype.onAdd.call(this,e),this.vsc.invalid(),this.vsc&&(this.vsc.selectedIndex=this.openSelectIndex,this.vsc.updateSelectedView()),XR.hasOpenV=!0,Tu.sendToModule("UPDATE_ACTLEFT_ICON",["modules.nav.NavModule"])},i.onRemove=function(e){t.prototype.onRemove.call(this,e),this.openSelectIndex=0,this.vsc&&(this.vsc.selectedIndex=-1)},i.checkRedPoint=function(e){return 0},i.onSubChanged=function(e,t){var i;switch(e){case"1":i=_r.getAtlasSubPath("dailygift/mrlb_text_mrlb.png")}this.setTitle(i)},i.update=function(e){this.callLater(this.updateDo,e)},i.updateDo=function(e){this.vsc.invalid(),this.vsc.updateSelectedView(e)},i.updateView=function(){this.vsc.selectedView.updateView&&this.vsc.selectedView.updateView()},p(0,i,"openSelectIndex",function(){return this._openSelectIndex},function(e){this._openSelectIndex=e,this.vsc.selectedIndex=e}),e.SUB_DAILYGIFT="1",e}(Ip),kQ=function(e){function t(){this.POSITION=[[{x:39,y:145},{x:91,y:164},{x:144,y:145}],[{x:19,y:133},{x:63,y:156},{x:118,y:156},{x:164,y:133}],[{x:13,y:113},{x:44,y:150},{x:91,y:164},{x:138,y:150},{x:170,y:113}]],this._callback=null,this._grids=null,this._time=0,t.__super.call(this)}b(t,"modules.arena.views.ArenaFailView",fe);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this._grids=[];for(var e=0;e<4;e++){var t=this["grid"+e],i=new MF;t.addChild(i),this._grids[e]=i}for(e=0;e<5;e++){this["img_star"+e].visible=!1}var n=new ys([.3086,.1094,.082,0,0,.3086,.1094,.082,0,0,.3086,.1094,.082,0,0,0,0,0,1,0]);Pg.addFilter(this.bg,n)},i.update=function(e){var t=this,i=kR.ins.toc_arena,n=Lt.getIndex(i.lvlCfgId);t.txt_jieNum.value=Lt.MODEL.cStep(n)+"",t.txt_jieNum.visible=0!=Lt.MODEL.cStep(n),t.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(n)+".png"),t.setStar(Lt.MODEL.currentStarNum(n),Lt.MODEL.maxStarNum(n));for(var s,o=e.award,a=e.callback,r={},l=0,c=0,u=0;u<4;u++){var d=t["grid"+u];d.removeSelf()}for(var h in n=0,o){var _;s=o[h],d=t["grid"+n];var f=t["txt_name"+n];if(null!=d){var p=t._grids[n];s instanceof protos.backpack.DtoGoods?_=s:(l=s.modelId,c=s.count,null!=(_=r[l])?_.goodsNum+=c:_=yB.create(l,c)),p.bindData=_,f.changeText(_.name),t.grids.addChild(d),d.x=(21+d.width)*n,n++}}t._callback=a,t._time=6,G.timer.loop(1e3,t,t.onTime),t.onTime()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),bj.ins.show(this)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clearAll(this),this._callback&&(this._callback.run(),this._callback=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),G.timer.clearAll(this)},i.onClick=function(e){switch(e.target){case this.btn_get:hN.ins._closePanel(this)}},i.onTime=function(){this._time-=1,this.txt_time.changeText("("+this._time+"s)"),this._time<=0&&(G.timer.clearAll(this),hN.ins._closePanel(this))},i.setStar=function(e,t){this.imgBg.skin=0==t?_r.getAtlasSubPath("arena/jj_dw_dtwz.png"):_r.getAtlasSubPath("arena/jj_dw_dtx"+t+".png");for(var i=0;i<5;i++){var n=this["img_star"+i];n.visible=!1,i<t&&(n.x=this.POSITION[t-3][i].x,n.y=this.POSITION[t-3][i].y)}for(i=0;i<t;i++)(n=this["img_star"+i]).visible=i<e},t}(),EQ=function(e){function t(){this.POSITION=[[{x:39,y:145},{x:91,y:164},{x:144,y:145}],[{x:19,y:133},{x:63,y:156},{x:118,y:156},{x:164,y:133}],[{x:13,y:113},{x:44,y:150},{x:91,y:164},{x:138,y:150},{x:170,y:113}]],this._iconGrid=null,t.__super.call(this),this.initUI()}b(t,"modules.arena.views.ArenaInfoNewV",pe);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),G.timer.clear(this,this.onTimer)},i.initUI=function(){this._iconGrid=new MF,this._iconGrid.pos(this.icon.x,this.icon.y),this.addChild(this._iconGrid);for(var e=0;e<5;e++){this["star"+e].visible=!1}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_add.on("click",t,t.onClick),t.btn_fight.on("click",t,t.onClick),t.btn_now_rank.on("click",t,t.onOpenRank),t.btn_award_rank.on("click",t,t.onOpenAwardRank),t.btn_last_rank.on("click",t,t.onOpenLastRank),t.btn_share.on("click",t,t.onShare);var i=new DA;Tu.sendToService(i);var n=new NA;Tu.sendToService(n);var s=new HA;Tu.sendToService(s)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_add.off("click",t,t.onClick),t.btn_fight.off("click",t,t.onClick),t.btn_now_rank.off("click",t,t.onOpenRank),t.btn_award_rank.off("click",t,t.onOpenAwardRank),t.btn_last_rank.off("click",t,t.onOpenLastRank),t.btn_share.off("click",t,t.onShare),G.timer.clear(t,t.onTimer)},i.onClick=function(e){if(UR.instance.isAuto&&UR.instance.fullPower)zB.ins.showById(2126,1);else if(ZN.isEnabledChangeScene()){var t=kR.ins.toc_arena;if(null!=t)if(e.currentTarget==this.btn_add){var i=Ct.MODEL.dailyPurchaseLimit(0);if(t.buyNum<i){var n=kR.ins.getPurchaseCost(t.buyNum+1);KQ.ins.show(RP.n[687]+Ql.createColor(n+"元宝","#23b11f")+RP.n[688]+Ql.newline()+RP.n[689]+t.buyNum+"/"+i,ql.create(this,this.onBuyAlert),!1)}else zB.ins.playErrorMsg(RP.n[690])}else if(e.currentTarget==this.btn_fight){if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);if(0<t.canPkNum){var s=dr.serverDate,o=s.getHours(),a=s.getDay();0==a&&22<=o||1==a&&o<10?zB.ins.playErrorMsg(RP.n[691]):(UR.instance.isAuto=!1,hN.ins.isOpen("ARENA_MATCH")||hN.ins.open("ARENA_MATCH"))}else i=Ct.MODEL.dailyPurchaseLimit(0),t.buyNum<i?(n=kR.ins.getPurchaseCost(t.buyNum+1),KQ.ins.show(RP.n[687]+Ql.createColor(n+"元宝","#23b11f")+RP.n[688]+Ql.newline()+RP.n[689]+t.buyNum+"/"+i,ql.create(this,this.onBuyAlert),!1)):zB.ins.playErrorMsg(RP.n[695])}}else zB.ins.showById(2126,1)},i.updateByVSC=function(e){if(e instanceof protos.arena.toc_21302)this.update();else if(e instanceof protos.arena.toc_21311){var t=e;0<t.rank?this.txt_rank.changeText(t.rank+""):this.txt_rank.changeText("未上榜"),this.txt_winCnt.changeText(t.winCount.toString())}else if(e instanceof protos.arena.toc_21315){var i=e;this.img_streak.visible=1<i.continueWin}},i.onBuyAlert=function(e){if(1==e){var t=new OA;Tu.sendToService(t)}},i.update=function(){var e=this,t=kR.ins.toc_arena;if(null!=t){gR.ins.actorList[gR.ins.showId-1];var i=Lt.getIndex(t.lvlCfgId),n=kR.ins.getWeeklyGoods(Lt.MODEL.classType(i)).split(";")[0].split(","),s=parseInt(n[0]),o=parseInt(n[1]),a=yB.create(s,o);e._iconGrid.bindData=a,e.txt_subRank.changeText(Lt.MODEL.name(i)),e.txt_jieNum.value=Lt.MODEL.cStep(i)+"",e.txt_jieNum.visible=0!=Lt.MODEL.cStep(i),e.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(i)+".png"),e.setStar(Lt.MODEL.currentStarNum(i),Lt.MODEL.maxStarNum(i));var r=Ct.MODEL.key(0);if(e.txt_leftCnt.changeText(t.canPkNum+"/"+r),e.txt_item_name.color=ms.getByQuality(Bi.MODEL.colourId(a.cfgIdx)),e.txt_item_name.changeText(a.name),t.canPkNum>=r)e.div_desc.visible=!1,G.timer.clear(e,e.onTimer);else{e.div_desc.visible=!0;var l=dr.serverTimeSec,c=t.endT;c<l&&(l=c),e.div_desc.innerHTML=Ql.createColor(Jp.getHMSTimeString(c-l),"#01b527")+RP.n[696],G.timer.loop(300,e,e.onTimer)}0<t.canPkNum?e.txt_leftCnt.color="#01b527":e.txt_leftCnt.color="#e41b00";var u=dr.serverDate,d=u.getHours(),h=u.getDay();(0==h&&21<d||1==h&&d<9)&&(e.div_desc.innerHTML=Ql.createColor(RP.n[697],"#ff2e24"),G.timer.clear(e,e.onTimer)),e.btn_share.visible=jP.getCpShareSwitch(),e.img_red.visible=eR.ins.getRWT(3)<=0}},i.onTimer=function(){var e=kR.ins.toc_arena;if(null!=e){var t=dr.serverTimeSec,i=e.endT;i<t&&(G.timer.clear(this,this.onTimer),t=i),this.div_desc.innerHTML=Ql.createColor(Jp.getHMSTimeString(i-t),"#01b527")+RP.n[698];var n=dr.serverDate,s=n.getHours(),o=n.getDay();(0==o&&21<s||1==o&&s<9)&&(this.div_desc.innerHTML=Ql.createColor(RP.n[697],"#ff2e24"),G.timer.clear(this,this.onTimer))}},i.onOpenRank=function(e){hN.ins.open("ARENA_RANK",!1)},i.onOpenAwardRank=function(e){hN.ins.open("ARENA_SEASON")},i.onOpenLastRank=function(){hN.ins.open("ARENA_RANK",!0)},i.onShare=function(e){Tu.sendToModule("COPY_SHARE",["modules.activityDaily.DailyModule"],{id:3})},i.setStar=function(e,t){this.imgBg.skin=0==t?_r.getAtlasSubPath("arena/jj_dw_dtwz.png"):_r.getAtlasSubPath("arena/jj_dw_dtx"+t+".png");for(var i=0;i<5;i++){var n=this["star"+i];n.visible=!1,i<t&&(n.x=this.POSITION[t-3][i].x,n.y=this.POSITION[t-3][i].y)}for(i=0;i<t;i++)(n=this["star"+i]).visible=i<e},t}(),TQ=function(e){function t(){this._player=null,this._playerIdx=0,this._countDown=0,this._tweener=null,t.__super.call(this),this.init()}b(t,"modules.arena.views.ArenaMatchView",ve);var i=t.prototype;return i.init=function(){this.spr_content.scrollRect=new u_(0,0,this.spr_content.width,this.spr_content.height)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),kR.ins.isMatching=!0;var t=new PA;Tu.sendToService(t),this.centerX=0,this.other_box.visible=!1,this.update()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),null!=this._tweener&&this._tweener.clear(),this._tweener=null,G.timer.clear(this,this.updateCountDown),kR.ins.isMatching=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._player=null,G.timer.clear(this,this.updateCountDown)},i.updatePlayer=function(e){if(0==e.state)return zB.ins.playErrorMsg(RP.n[700]),void hN.ins.close("ARENA_MATCH");eq.topLayer.mouseThrough=!1,this._player=e;var t=Math.floor(3*Math.random());this._player.shows.length=t+2,this._playerIdx=0,this.other_box.visible=!0,this.txt_count_down.visible=!1,this.txt_rank2.visible=!1,this.txt_name2.visible=!1,this.playEffect()},i.playEffect=function(){var e=this;e.spr_content.addChild(e.img_player),e.img_player.y=18,e.img_player.x=26,e.img_player.addChild(e.img_player2),e.img_player2.x=0,e.img_player2.visible=!0,e.img_player2.y=e.spr_content.height+18;var t=e._player.player;e._playerIdx<e._player.shows.length&&(t=e._player.shows[e._playerIdx]),e.img_player2.skin=_r.getActorHeadPath(t.job,t.sex),null==e._tweener&&(e._tweener=new Og),e._tweener.to(e.img_player,{y:-e.spr_content.height},270,pa.linearIn,ql.create(e,e.onPlayEnd))},i.onPlayEnd=function(){var e=!1,t=this._player.player;this._playerIdx<this._player.shows.length&&(t=this._player.shows[this._playerIdx++],e=!0),this.txt_name2.changeText(t.name);var i=Lt.getIndex(t.curLvlId);this.txt_rank2.changeText(Lt.MODEL.name(i)),this.txt_rank2.visible=!0,this.txt_name2.visible=!0,e?(this.img_player.skin=this.img_player2.skin,G.timer.once(500,this,this.playEffect)):G.timer.once(800,this,end=function(){eq.topLayer.mouseThrough=!0,Tu.sendToModule("EFFECT_END",["modules.digger.DiggerModule"])})},i.update=function(){var e=kR.ins.toc_arena;if(null==e)return zB.ins.playErrorMsg(RP.n[701]),void hN.ins.close("ARENA_MATCH");gR.ins.actorList[gR.ins.showId-1];var t=Lt.getIndex(e.lvlCfgId);this.txt_subRank.changeText(Lt.MODEL.name(t));var i=gR.ins.actorList[gR.ins.showId-1];this.img_head.skin=_r.getActorHeadPath(i.job,i.sex),this.txt_name.changeText(gR.ins.charName)},i.startCountDown=function(){this.txt_count_down.visible=!0,this._countDown=1,this.updateCountDown(),G.timer.loop(1e3,this,this.updateCountDown)},i.updateCountDown=function(){this.txt_count_down.x=310,this.txt_count_down.text=RP.n[702],this._countDown=this._countDown-1,this._countDown<0&&(G.timer.clear(this,this.updateCountDown),Tu.sendToModule("COUNTDONW_END",["modules.digger.DiggerModule"]))},t}(),CQ=function(e){function t(){this._isShowLastWeek=!1,t.__super.call(this),this.initUI()}b(t,"modules.arena.views.ArenaRankV",me);var i=t.prototype;return i.initUI=function(){this.centerX=0,this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticBackTime=300,this.list_rank.scrollBar.elasticDistance=100,this.list_rank.renderHandler=ql.create(this,this.onListRender,null,!1),this.list_rank.selectEnable=!0,this.list_rank.array=null},i.onListRender=function(e,t){var i=this.list_rank.array[t];i.rank<=3?(e.txt_rank.visible=!1,e.clip_rank.visible=!0,e.clip_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+i.rank+".png")):(e.txt_rank.visible=!0,e.clip_rank.visible=!1,e.txt_rank.changeText("第"+i.rank+"名")),e.txt_name.changeText(i.name);var n=Lt.getIndex(i.lvlCfgId);e.txt_jieNum.value=Lt.MODEL.cStep(n)+"",e.txt_jieNum.visible=0!=Lt.MODEL.cStep(n),e.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(n)+".png"),e.txt_winCnt.changeText(i.winCount+""),e.on("click",this,this.onClickCellEvent,[i])},i.onClick=function(e){e.target==this.btn_close&&hN.ins.close("ARENA_RANK")},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_no.visible=!1,this.on("click",this,this.onClick),this.list_rank.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.list_rank.scrollBar.off("change",this,this.onScrollChanged)},i.update=function(){var e=this,t=kR.ins.toc_rank;if(null!=t&&!e._isShowLastWeek){var i=Lt.getIndex(t.lvlCfgId);e.txt_jieNum.value=Lt.MODEL.cStep(i)+"",e.txt_jieNum.visible=0!=Lt.MODEL.cStep(i),e.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(i)+".png"),e.txt_winCnt.changeText(t.winCount+""),0<t.rank?e.txt_rank.changeText(t.rank+""):e.txt_rank.changeText("未上榜");var n=t.arrRank.concat();e.list_rank.array=n}var s=kR.ins.toc_preRank;null!=s&&e._isShowLastWeek&&(i=Lt.getIndex(s.lvlCfgId),e.txt_jieNum.value=Lt.MODEL.cStep(i)+"",e.txt_jieNum.visible=0!=Lt.MODEL.cStep(i),e.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(i)+".png"),e.txt_winCnt.changeText(s.winCount+""),0<s.rank?e.txt_rank.changeText(s.rank+""):e.txt_rank.changeText("未上榜"),n=s.arrRank.concat(),e.list_rank.array=n),e.txt_no.visible=!(e.list_rank.array&&0<e.list_rank.array.length),e.lan_mc.visible=e.list_rank.array&&6<=e.list_rank.array.length},i.reqData=function(e){if(void 0===e&&(e=!1),this.list_rank.array=null,this._isShowLastWeek=e,this._isShowLastWeek){this.img_title.skin=_r.getAtlasSubPath("arena/jj_text_szpm.png");var t=new HA;Tu.sendToService(t)}else{var i=new NA;Tu.sendToService(i),this.img_title.skin=_r.getAtlasSubPath("arena/jj_text_bzpm.png")}},i.onClickCellEvent=function(e,t){if(e.playerId.toString()==gR.ins.charId)zB.ins.showMsg(RP.n[703],1);else{QB.ins.playID=e.playerId,hN.ins.open("FRIENDNEWADDFRIENDVIEW");var i=new lM;i.targetId=e.playerId,Tu.sendToService(i)}},i.onScrollChanged=function(){0==this.list_rank.scrollBar.max||this.list_rank.scrollBar.value>=this.list_rank.scrollBar.max?this.lan_mc.visible=!1:this.lan_mc.visible=!0},t}(),LQ=function(n){function e(){this.vsc=null,this.resList=[102,64,65,101],this.soundID=null,this.soundIns=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(e,"modules.digger.views.SportsMainView",n);var t=e.prototype;return t.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/digger/yq_btn_yz.png","ui/layouts/digger/yq_btn_wzzb.png"],this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1);this.vsc.registAll([{cls:yJ,id:"0",grayTip:function(){zB.ins.showMsg(RP.n[704],1),UB.ins._playLevelNot()},wait:hN.wait(hN.waitConfig(["YezhanFightRewardResource","YezhanRankRewardResource"],["CFieldFightAward","CFieldRankAward"]),hN.waitAtlas("field"),_r.getAtlasSubPath("field/bg_recycle.jpg"))},{cls:EQ,id:"1",isHideBg:!0,grayTip:function(){zB.ins.showById(4343,1),UB.ins._playLevelNot()},wait:hN.wait(hN.waitConfig(["ConfigArenaCommon","ConfigArenaPurchase","ConfigArenaPlayerLevel","ConfigArenaReward"],["CArenaCommon","CArenaPurchase","CArenaPlayerLevel","CArenaReward"]),hN.waitAtlas("arena"),_r.getAtlasSubPath("arena/dan_img_shadow50.jpg"))}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},t.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},t.onAdd=function(e){n.prototype.onAdd.call(this,e);var t=__.equipCareList.concat(this.resList);AN.reqRedPt(t);var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_FIELD",[102],i),AN.ins.addListener("BTN_ARENA",[101],i),AN.ins.addListener("BTN_ACTIVE_E",[65],i),this.updateItemEnabled()},t.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},t.redPtUpdate=function(e,t){this.updateItemEnabled()},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.onSubChanged=function(e,t){var i="";switch(e){case"1":i="digger/jj_title_jj.png";break;case"0":i="digger/jj_title_yz.png"}this.setTitle(_r.getAtlasSubPath(i))},t.checkTips=function(e){if("0"==e){if(AN.ins.getStateByCareList([102]))return 3}else if("1"==e){if(!GR.getInstance().checkModuleOpen(18))return 1;if(AN.ins.getStateByCareList([101]))return 3}return 0},t.getJJCopenlevel=function(){var e=$e.getIndex(15);return parseInt($e.MODEL.value(e))},t.getJJCopenDay=function(){var e=$e.getIndex(231);return parseInt($e.MODEL.value(e))},e.TAB_INDEX_YZ="0",e.TAB_INDEX_JJC="1",e}(Ip),MQ=function(e){function t(){this._grids=null,t.__super.call(this),this.initUI()}b(t,"modules.arena.views.ArenaSeasonV",ye);var i=t.prototype;return i.initUI=function(){var e=this;e.list_rank.vScrollBarSkin="",e.list_rank.scrollBar.elasticBackTime=300,e.list_rank.scrollBar.elasticDistance=100,e.list_rank.renderHandler=ql.create(e,e.onListRender,null,!1);var t=[];t.length=kR.ins.getDiamondExtras().length,e.list_rank.array=t,e.g_mask.visible=3<e.list_rank.array.length;for(var i=0;i<4;i++){var n=new MF;n.pos(e["img_award"+i].x,e["img_award"+i].y),e.addChild(n);var s=kR.ins.getWeeklyGoods(4-i).split(";")[0].split(","),o=parseInt(s[0]),a=parseInt(s[1]),r=yB.create(o,a);n.bindData=r}},i.onListRender=function(e,t){t<3?(e.txt_rank.visible=!1,e.clip_rank.visible=!0,e.clip_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+(t+1)+".png")):(e.txt_rank.visible=!0,e.clip_rank.visible=!1,e.txt_rank.changeText("第"+(t+1)+"名"));var i=kR.ins.getDiamondExtraGoods(t+1),n=e.grid;if(i&&0<i.length){null==n&&((n=new MF).pos(e.img_award.x,e.img_award.y),n.size(64,64),e.addChild(n),e.grid=n),n.visible=!0;var s=i.split(";")[0].split(","),o=parseInt(s[0]),a=parseInt(s[1]),r=yB.create(o,a);n.bindData=r,e.txt_goods.changeText(Bi.MODEL.name(r.cfgIdx))}else n&&(n.visible=!1),e.txt_goods.changeText("");e.txt_name.changeText("暂无"),e.txt_winCnt.changeText("暂无");var l=kR.ins.toc_extra;if(!(null==l||t>=l.arrRank.length)){var c=l.arrRank[t];e.txt_name.changeText(c.name),e.txt_winCnt.changeText(c.winCount+"")}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=new BA;Tu.sendToService(t),this.on("click",this,this.onClick),this.list_rank.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.list_rank.scrollBar.off("change",this,this.onScrollChanged)},i.onClick=function(e){e.target==this.btn_close&&hN.ins.close("ARENA_SEASON")},i.update=function(){var e=kR.ins.toc_rank;if(null!=e){var t=Lt.getIndex(e.lvlCfgId);this.txt_jieNum.value=Lt.MODEL.cStep(t)+"",this.txt_jieNum.visible=0!=Lt.MODEL.cStep(t),this.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(t)+".png"),this.txt_winCnt.changeText(e.winCount+"");var i=kR.ins.toc_extra;null!=i&&(0<i.rank&&i.rank<=5?this.txt_rank.changeText(i.rank+""):this.txt_rank.changeText("未上榜"),this.list_rank.refresh())}},i.onScrollChanged=function(){0==this.list_rank.scrollBar.max||this.list_rank.scrollBar.value>=this.list_rank.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),AQ=function(e){function t(){this.POSITION=[[{x:39,y:145},{x:91,y:164},{x:144,y:145}],[{x:19,y:133},{x:63,y:156},{x:118,y:156},{x:164,y:133}],[{x:13,y:113},{x:44,y:150},{x:91,y:164},{x:138,y:150},{x:170,y:113}]],this._callback=null,this._grids=null,this._time=0,t.__super.call(this)}b(t,"modules.arena.views.ArenaSucceedView",Ie);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this._grids=[];for(var e=0;e<4;e++){var t=this["grid"+e],i=new MF;t.addChild(i),this._grids[e]=i}for(e=0;e<5;e++){this["img_star"+e].visible=!1}},i.update=function(e){var t=this,i=kR.ins.toc_arena,n=kR.ins.toc_arena_pre,s=Lt.getIndex(i.lvlCfgId),o=Lt.getIndex(n.lvlCfgId);if(null!=n?t.upgradeIndexTo(s,o):t.upgradeIndexTo(s,s),null!=n)for(var a=s-o,r=0;r<3;r++){var l=t["award_star"+r];l.visible=!1,r<a&&(l.visible=!0)}var c,u=e.award,d=e.callback,h={},_=0,f=0;for(r=0;r<4;r++){var p=t["grid"+r];p.removeSelf()}for(var g in s=0,u){var v;c=u[g],p=t["grid"+s];var m=t["txt_name"+s];if(null!=p){var y=t._grids[s];c instanceof protos.backpack.DtoGoods?v=c:(_=c.modelId,f=c.count,null!=(v=h[_])?v.goodsNum+=f:v=yB.create(_,f)),y.bindData=v,m.changeText(v.name),t.grids.addChild(p),p.x=(21+p.width)*s,s++}}t._callback=d,t._time=6,G.timer.loop(1e3,t,t.onTime),t.onTime()},i.upgradeIndexTo=function(e,t){this.txt_jieNum.value=Lt.MODEL.cStep(t)+"",this.txt_jieNum.visible=0!=Lt.MODEL.cStep(t),this.img_rank.skin=_r.getAtlasSubPath("arena/dan_icon_golddan"+Lt.MODEL.classType(t)+".png");var i=Lt.MODEL.currentStarNum(t);if(this.setStar(i,0,Lt.MODEL.maxStarNum(t)),!(e<=t)){var n=Lt.MODEL.currentStarNum(t+1),s=0;s=0==n?1:0<n?n<i?0:1:0,this.setStar(i,s,Lt.MODEL.maxStarNum(t)),G.timer.once(600,this,this.upgradeIndexTo,[e,t+1])}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),bj.ins.show(this)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clearAll(this),this._callback&&(this._callback.run(),this._callback=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_get:hN.ins._closePanel(this)}},i.setStar=function(e,t,i){this.imgBg.skin=0==i?_r.getAtlasSubPath("arena/jj_dw_dtwz.png"):_r.getAtlasSubPath("arena/jj_dw_dtx"+i+".png");for(var n=0,s=0;s<5;s++){var o=this["img_star"+s];o.visible=!1,s<i&&(o.x=this.POSITION[i-3][s].x,o.y=this.POSITION[i-3][s].y)}for(s=0;s<i;s++)(o=this["img_star"+s]).visible=!1,s<e?o.visible=!0:s<e+t&&(G.timer.once(500*n,this,function(e){var t=kB.createEffect("jm1158",e.x+e.width/2,e.y+e.height/2+1,e.parent);t.scaleX=t.scaleY=1.3},[o]),G.timer.once(500*(n+1),this,function(e){e.visible=!0},[o]),n++)},i.onTime=function(){this._time-=1,this.txt_time.changeText("("+this._time+"s)"),this._time<=0&&(G.timer.clearAll(this),hN.ins._closePanel(this))},t}(),DQ=function(e){function t(){var e=this;e._bgm=null,e._sm=null,e._hejiEffect=null,e._zhuijiEffect=null,t.__super.call(e),e._bgm=new Tj,e._bgm.showLabel=!1,e._bgm.width=250,e._bgm.pos(237,207),e._bgm.max=10,e._bgm.min=0,e._bgm.allowClickBack=!0,e.addChild(e._bgm),e._sm=new Tj,e._sm.showLabel=!1,e._sm.pos(237,257),e._sm.width=250,e._sm.max=10,e._sm.min=0,e._sm.allowClickBack=!0,e.addChild(e._sm),e.btnSwitch.visible=!1,e.img_autoZhuiJiRed.visible=!1}b(t,"modules.assit.view.AssitMainV",ke);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btnClose.on("click",t,t.onClick),t.imgClose.on("click",t,t.onClick),t.imgOpen.on("click",t,t.onClick),t.chkMy.on("click",t,t.onClick),t.chkOther.on("click",t,t.onClick),t.chkZhen.on("click",t,t.onClick),t.chkHeji.on("click",t,t.onClick),t.btnCopy.on("click",t,t.onClick),t.txt_autoZhuiJi.on("click",t,t.onAutoZhuiJiClicked),t.btnCopy.centerX=0,t._bgm.on("change",t,t.onBgmChange),t._sm.on("change",t,t.onSmChange),t.canSet(ER.ins.cansetM),t.chkMy.selected=ER.ins.hideMe,t.chkOther.selected=ER.ins.hideOther,t._bgm.value=10*UB.ins.musicVolume,t._sm.value=10*UB.ins.soundVolume,t.chkZhen.selected=ER.ins.hideZhen,t.chkHeji.selected=ER.ins.hideHeji;var i=ql.create(t,t.redPtUpdate,null,!1);AN.ins.addListener("BTN_SETTING_HEJI",[220],i),AN.ins.addListener("LINK_SETTING_ZHUIJI",[253],i),jP.checkFunctionOpen(26)&&(t.btnSwitch.visible=!0,t.btnSwitch.on("click",t,t.onClick),t.btnSwitch.centerX=0),t.btnCopy.visible=!1,t.updateView(),t.lbl_player_name.changeText(gR.ins.charName),t.lbl_uid.changeText(hr.uid),t.lbl_server_id.changeText(hr.serverID),t.lbl_server_name.changeText(hr.serverName)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btnClose.off("click",t,t.onClick),t.imgClose.off("click",t,t.onClick),t.imgOpen.off("click",t,t.onClick),t.chkMy.off("click",t,t.onClick),t.chkOther.off("click",t,t.onClick),t.chkZhen.off("click",t,t.onClick),t.chkHeji.off("click",t,t.onClick),t.btnSwitch.off("click",t,t.onClick),t.btnCopy.off("click",t,t.onClick),t.txt_autoZhuiJi.off("click",t,t.onAutoZhuiJiClicked),t._bgm.off("change",t,t.onBgmChange),t._sm.off("change",t,t.onSmChange),AN.ins.removeListener("BTN_SETTING_HEJI"),AN.ins.removeListener("LINK_SETTING_ZHUIJI"),t.disposeEffect()},i.onClick=function(e){var t=this;e.target==t.btnClose?hN.ins.toggle("ASSIT"):e.target==t.imgClose?(t.canSet(!0),ER.reqSave()):e.target==t.imgOpen?(t.canSet(!1),ER.reqSave()):e.target==t.chkMy?(ER.ins.hideMe=!ER.ins.hideMe,t.chkMy.selected=ER.ins.hideMe,Tu.sendToModule("HIDE_MYSELF",["modules.scene.SceneModule"],ER.ins.hideMe),ER.reqSave()):e.target==t.chkOther?(ER.ins.hideOther=!ER.ins.hideOther,t.chkOther.selected=ER.ins.hideOther,Tu.sendToModule("HIDE_OTHER",["modules.scene.SceneModule"],ER.ins.hideOther),ER.reqSave()):e.target==t.chkZhen?(ER.ins.hideZhen=!ER.ins.hideZhen,t.chkZhen.selected=ER.ins.hideZhen,Tu.sendToModule("HIDE_ZHEN",["modules.scene.SceneModule"],ER.ins.hideZhen),ER.reqSave()):e.target==t.chkHeji?(ER.ins.hideHeji=!ER.ins.hideHeji,t.chkHeji.selected=ER.ins.hideHeji,ER.reqSave()):e.target==t.btnSwitch?hN.ins.open("YUNYING_ACCOUNT_VIEW"):(e.target,t.btnCopy)},i.onBgmChange=function(e){UB.ins.musicVolume=this._bgm.value/10,ER.reqSave()},i.onSmChange=function(e){UB.ins.soundVolume=this._sm.value/10,ER.reqSave()},i.canSet=function(e){this.imgClose.visible=!e,this.imgOpen.visible=e,ER.ins.cansetM=e,this._bgm.disabled=!e,this._sm.disabled=!e},i.updateView=function(){0<gR.ins.getZhuiJiNum()&&(!ER.ins.isAutoZhuiJi||gR.ins.getZhuiJiNum()>ER.ins.autoZhuiJiStr.length)?this.img_autoZhuiJiRed.visible=!0:this.img_autoZhuiJiRed.visible=!1},i.redPtUpdate=function(e,t){var i=this;switch(e){case"BTN_SETTING_HEJI":AN.ins.getStateByCareList([220])?null==i._hejiEffect&&(i._hejiEffect=kB.createEffect("jm1081",i.chkHeji.x+23,i.chkHeji.y+i.chkHeji.height/2+5,i)):i.disposeHeJiEff();break;case"LINK_SETTING_ZHUIJI":AN.ins.getStateByCareList([253])?null==i._zhuijiEffect&&(i._zhuijiEffect=kB.createEffect("jm1382",i.txt_autoZhuiJi.x+95,i.txt_autoZhuiJi.y+i.txt_autoZhuiJi.height/2,i),i._zhuijiEffect.scale_X=.45,i._zhuijiEffect.scale_Y=.5):i.disposeZhuiJiEff()}},i.disposeEffect=function(){this.disposeHeJiEff(),this.disposeZhuiJiEff()},i.disposeHeJiEff=function(){null!=this._hejiEffect&&(this._hejiEffect.parent&&this._hejiEffect.parent.removeChild(this._hejiEffect),this._hejiEffect.dispose(),this._hejiEffect=null)},i.disposeZhuiJiEff=function(){this._zhuijiEffect&&(this._zhuijiEffect.parent&&this._zhuijiEffect.parent.removeChild(this._zhuijiEffect),this._zhuijiEffect.dispose(),this._zhuijiEffect=null)},i.onAutoZhuiJiClicked=function(e){hN.ins.open("SOARING_VIEW",{__subIndex_:3}),G.timer.once(200,hN.ins,hN.ins.open,["ZhuiJiAutoSettingView"])},t}(),OQ=function(e){var m;function t(e){this._achieves=[],this._callback=null,this._goodsId=0,t.__super.call(this),this._callback=e,this.lst_bg.itemRender=m,this.lst_bg.vScrollBarSkin="",this.lst_bg.spaceY=5}b(t,"modules.backpack.views.achieve.GoodsAchieveNewView",al);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.lst_bg.on("click",this,this.onListMouse),this.lst_bg.scrollBar.on("change",this,this.onScrollEnd)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.lst_bg.off("click",this,this.onListMouse),this.lst_bg.scrollBar.off("change",this,this.onScrollEnd)},i.onScrollEnd=function(e){this.lst_bg.scrollBar.value>=this.lst_bg.scrollBar.max?this.img_black.visible=!1:this.img_black.visible=!0},i.update=function(e){this._goodsId=e,this.lst_bg.scrollBar.value=0;var t=Bi.getIndex(e),i=Bi.MODEL.achieving(t);if(i){for(var n=i.split(";"),s=[],o=0;o<n.length;o++){var a=n[o].split("|"),r=parseInt(a[3]),l=parseInt(a[0]);if(6==l||!(gR.ins.lv<r)){if(5==l){var c=a[4].split(","),u=parseInt(c[0]),d=parseInt(c[1]),h=dr.getOpenServiceDay(),_=parseInt(a[5]);if(h<u||d<h)continue;if("FIRST_RECHARGE"==a[1]){if(HN.ins.toc_recharge)if(2==HN.ins.toc_recharge.canGet)continue}else if(-1<JP.A_GIFT_ID_ARR.indexOf(_)&&null!=JP.A_GIFT_ID_HASH.take(_)&&2==JP.A_GIFT_ID_HASH.take(_).status)continue}7==l&&modules.pet.others.PetDataModel.ins().isBuyTrain||(s[s.length]=n[o])}}this.lst_bg.dataSource=s,this.height=this.img_bg.y+20+66*s.length+3,354<=this.height&&(this.height=354)}this.onScrollEnd()},i.onListMouse=function(e){var t=this;if(G.__typeof(e.target,m)){var i=e.target.dataSource;if(null==i)return;var n=i.split("|"),s=6==parseInt(n[0]);if(s){var o=parseInt(n[3]);if(!GR.getInstance().checkModuleOpen(o))return void zB.ins.showMsg(GR.getInstance().getErrorTips(o),1)}else 4==parseInt(n[0])&&null!=t._callback&&t._callback.run();if(2==parseInt(n[0])||ZN.isEnabledChangeScene()){if(1==parseInt(n[0])&&hN.ins._closeLayout(),modules.strength.views.fazhen.FazhenSkillAlert.ins.parent&&modules.strength.views.fazhen.FazhenSkillAlert.ins.close(),"BOSS_MAINVIEW"==n[1]){var a=n[2],r=0;if("2"==a){if(vi.count<=0){var l=[{url:_r.getJxrDBPath("FlyUPBoss"),type:"arraybuffer",cls:vi}];return void uc.ins().onLoadJxrs(l,ql.create(t,t.onListMouse,[e]))}if(!HR.ins.showRedPot1(1))return void zB.ins.showMsg(RP.n[705],1)}else if("3"==a&&(r=parseInt($e.MODEL.value($e.getIndex(162))),!(80<=gR.ins.lv&&dr.getOpenServiceDay()>=r)))return void zB.ins.showMsg(RP.n[706]+mp.WORDS[r]+RP.n[707],1);s&&(i=i.replace(/[0-9]?|/,"2")),Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],i)}else if("SOARING_VIEW"==n[1]){var c=$e.MODEL.value($e.getIndex(207)),u=JSON.parse(c);if(u.level>gR.ins.lv)return void zB.ins.playErrorMsg(RP.n[81]+u.level+"级开启");if(u.flyLevel>gR.ins.zsLv)return void zB.ins.playErrorMsg(RP.n[82]+u.flyLevel+"级开启");hN.ins.open(n[1],{_subIndex_:parseInt(n[2]),_isEtip:!0,_actorId:aQ._curSelector,_pos:n[3]},null,!0)}else if("PETMAIN_VIEW"==n[1]){if(!CN.getIconBtn(107))return void zB.ins.showMsg(RP.n[20],1);Tu.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:parseInt(n[2]),isT:!0})}if(5==parseInt(n[0])){var d=n[4].split(","),h=parseInt(d[0]),_=parseInt(d[1]),f=dr.getOpenServiceDay();if(f<h||_<f)return void zB.ins.showMsg(RP.n[84]+h+"且<="+_+"开启",1);n[0]="2"}var p=n.join("|");if("OS_TEHUI"==n[1])return ZN.isEnabledChangeScene()?(6<n.length&&(eU.targetId=parseInt(n[5])),eU.toSelectIndex=parseInt(n[2]),CN.dealActIcon(CN.getIconBtn(46)),void(null!=t._callback&&t._callback.run())):void zB.ins.showById(2126,1);if("OPENSERVER"==n[1])return ZN.isEnabledChangeScene()?(eU.toSelectIndex=parseInt(n[2]),CN.dealActIcon(CN.getIconBtn(12)),void(null!=t._callback&&t._callback.run())):void zB.ins.showById(2126,1);if("MO_EQUIP_MAIN_COMPOSE"==n[1]){var g=Bi.getIndex(t._goodsId);if(0==g)return;var v=Bi.MODEL.decoratePosition(g);Bi.MODEL.magicSpecialPosition(g)?hN.ins.open("MO_EQUIP_OPERATE",{_subIndex_:parseInt("1"),part:v},"MO_MAIN_VIEW"):Tu.sendToModule("OPEN_MO_Main_COMPOSE",["modules.actor.ActorModule"],{part:v})}else{if("BAGPACK"==n[1]){if(0==(g=Bi.getIndex(t._goodsId)))return;return 3==parseInt(n[2])&&hN.ins.open("BAGPACK",{_subIndex_:3,id:t._goodsId},0,!0),void(null!=t._callback&&t._callback.run())}"OPEN_HUNDUN_VIEW1"==n[1]?(modules.copy.others.HundunData.ins.linkTo=!0,hN.ins.open("COPYMAINVIEW",{selectedIndex:n[2]})):(s&&(p=p.replace(/[0-9]?|/,"2")),Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],p))}}else zB.ins.showById(2126,1);null!=t._callback&&t._callback.run()}},t.__init$=function(){m=function(e){function t(){this._data=null,this._effect=null,t.__super.call(this)}return b(t,"",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(s,t,"dataSource",e),null!=t._effect&&(t._effect.dispose(),t._effect=null),t._data=e,null!=t._data){t.img_tuijian2.visible=!1;var i=e.split("|");t.txt_name.changeText(i[i.length-1]),4==parseInt(i[0])?(t.mc_go.visible=!1,t.txt_go.visible=!1):(5==parseInt(i[0])&&(null==t._effect&&(t._effect=kB.createEffect("jm1382",t.width/2+1,t.height/2+1,t),t._effect.scale_X=1.09,t._effect.scale_Y=.88),t.img_tuijian2.visible=!0,t.addChild(t.img_tuijian2)),t.mc_go.visible=!0,t.txt_go.visible=!0)}}),t}(s)},t}(),PQ=function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.tips.FlyUpNPCBBTip",Ua);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.updatePanel(),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.updatePanel=function(){this.txtBB.innerHTML=bR.npcBB;var e=gR.ins.actorFlyUpLevel;this.imgLeft.skin=_r.getAtlasSubPath("flyzone/fs_msz_hs_"+e+".png"),this.imgRight.skin=_r.getAtlasSubPath("flyzone/fs_msz_ls_"+(e+1)+".png"),this.imgMap.skin=_r.getAtlasSubPath("limitchallenge/fs_bossdt_"+(e+1)+".png")},i.onClick=function(e){switch(e.target){case this.btn_Go:bR.reqFlyByZones(),hN.ins.close("FLYUPNPCCBBTIP")}},t.NAME="FLYUPNPCCBBTIP",t}(),RQ=function(n){function t(){var e=this;e.vsc=null,e._composeOpenLv=0,e._composeOpenSer=0,e._sy_Lv=0,e._sy_fly_Lv=0,e._sy_open_day=0,e._fairylandOpenZuanShengLevel=0,e._farrylandOpenServerDay=0,t.__super.call(e),e.centerX=e.centerY=0,e.top=e.bottom=e.left=e.right=0}b(t,"modules.godweapon.views.GodWeaponMainPanel",n);var e=t.prototype;return e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},e.initialize=function(){var i=this;this.size(720,1280),this.navList=["ui/layouts/godweapon/btn_tab_sy.png","ui/layouts/godweapon/btn_tab_fl.png","ui/layouts/godweapon/btn_tab_hc.png","ui/layouts/godweapon/yq_btn_sbsy.png"],this._composeOpenLv=parseInt($e.MODEL.value($e.getIndex(114))),this._composeOpenSer=parseInt($e.MODEL.value($e.getIndex(118))),this._sy_Lv=parseInt($e.MODEL.value($e.getIndex(116))),this._sy_fly_Lv=parseInt($e.MODEL.value($e.getIndex(117))),this._sy_open_day=parseInt($e.MODEL.value($e.getIndex(115))),this._fairylandOpenZuanShengLevel=parseInt($e.MODEL.value($e.getIndex(123))),this._farrylandOpenServerDay=parseInt($e.MODEL.value($e.getIndex(122))),this.vsc=new SB(this),this.vsc.registAll([{cls:V0,id:"0",showDragon:!0,isHideBg:!0},{cls:OJ,id:"1",isHideBg:!0,grayTip:function(){zB.ins.showMsg("开服≥"+i._farrylandOpenServerDay+RP.n[712]+i._fairylandOpenZuanShengLevel+"转开启",1)}},{cls:DJ,id:"2",showDragon:!0,isHideBg:!0,grayTip:function(){zB.ins.showMsg("开服≥"+i._composeOpenSer+RP.n[713]+i._composeOpenLv+"转开启",1),UB.ins._playLevelNot()}},{cls:N0,id:"3",showDragon:!0,isHideBg:!0,grayTip:function(){var e=gR.ins.zsLv,t=gR.ins.lv;dr.getOpenServiceDay()<i._sy_open_day?(zB.ins.showMsg("开服第"+i._sy_open_day+RP.n[714],1),UB.ins._playLevelNot()):t<i._sy_Lv?(zB.ins.showMsg(RP.n[715]+i._sy_Lv+RP.n[716],1),UB.ins._playLevelNot()):e<i._sy_fly_Lv&&(zB.ins.showMsg(RP.n[717]+i._sy_fly_Lv+RP.n[718],1),UB.ins._playLevelNot())}}]),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.vsc.filterHandler=ql.create(this,this.checkRedPoint,null,!1)},e.onAdd=function(e){var t=this;n.prototype.onAdd.call(this,e);var i=ql.create(this,function(){t.vsc.updateItemEnabled()},null,!1);AN.ins.addListener("BTN_FAIRYLAND",[68],i),AN.ins.addListener("BTN_GODWEAPON_ARMS",[67],i),AN.ins.addListener("BTN_GODWEAPON_SY",[227],i),AN.reqRedPt([68])},e.onRemove=function(e){n.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_FAIRYLAND")},e.onSubChanged=function(e,t){var i="";switch(e){case"0":case"1":case"2":case"3":i="godweapon/sb_text_sb.png"}this.setTitle(_r.getAtlasSubPath(i))},e.checkRedPoint=function(e){if("2"==e&&!this.isOpenCompose())return 1;if("3"==e&&!this.isOpenShengYu())return 1;if("1"==e){if(!this.isFairyLandOpne())return 1;if(AN.ins.getStateByBtnName("BTN_FAIRYLAND"))return 3}return"0"==e&&AN.ins.getStateByBtnName("BTN_GODWEAPON_ARMS")?3:"3"==e&&AN.ins.getStateByBtnName("BTN_GODWEAPON_SY")?3:0},e.isFairyLandOpne=function(){return gR.ins.zsLv>=this._fairylandOpenZuanShengLevel&&dr.getOpenServiceDay()>=this._farrylandOpenServerDay},e.updateView=function(e){this.vsc.updateSelectedView(e)},e.isOpenCompose=function(){var e=gR.ins.zsLv,t=dr.getOpenServiceDay();return e>=this._composeOpenLv&&t>=this._composeOpenSer},e.isOpenShengYu=function(){var e=gR.ins.zsLv,t=(gR.ins.lv,dr.getOpenServiceDay());return e>=this._sy_fly_Lv&&t>=this._sy_open_day},t.VIEW_GODWEAPON="0",t.VIEW_FAIRYLAND="1",t.VIEW_COMPOSE="2",t.VIEW_HOLYLAND="3",t.NAME="GodWeaponMainPanel",t}(Ip),NQ=function(e){function t(){this._dto=null,this.goodsId=0,t.__super.call(this)}b(t,"modules.backpack.views.tip.FlyupStoneUseTip",hl);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),4==gR.ins.actorFlyUpBosstask?(t.goodsId=660108,t._dto=KH.create(t.goodsId),t.notice.changeText(RP.n[719])):5==gR.ins.actorFlyUpBosstask&&(t.goodsId=799912,t._dto=yB.create(t.goodsId),t.notice.changeText(RP.n[720]));var i=new MF;t.addChild(i),i.x=200,i.y=146,i.bindData=t.goodsId;var n=new fc(t._dto.name);n.centerX=0,n.y=270,t.addChild(n),n.color="#90877b",n.fontSize=20,n.font="SimHei",t.txt_Title.changeText(RP.n[721]),t.on("click",t,t.onClick),t.btn_Close.visible=!1,LY.Ins().lockSceneShowByDisPlay(t.btn_Go)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_Go:4==gR.ins.actorFlyUpBosstask?hN.ins.open("SOARING_VIEW",{_subIndex_:0}):5==gR.ins.actorFlyUpBosstask&&hN.ins.open("SOARING_VIEW",{_subIndex_:2}),hN.ins.close("FlyupStoneUseTip")}},t.NAME="FlyupStoneUseTip",t}(),BQ=function(e){function t(){this._dto=null,t.__super.call(this)}b(t,"modules.backpack.views.tip.QuickUseTip",hl);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._dto=TR.ins.getGoodsDto(89);var t=new MF;this.addChild(t),t.x=200,t.y=146,t.bindData=89;var i=new fc(this._dto.name);i.centerX=0,i.y=270,this.addChild(i),i.color="#90877b",i.fontSize=20,i.font="SimHei",this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_Go:Tu.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:this._dto,num:1});case this.btn_Close:hN.ins.close("QuickUseTip")}},t.NAME="QuickUseTip",t}(),HQ=(function(e){function t(){this._dto=null,this._goodsId=0,this._grid=null,t.__super.call(this)}b(t,"modules.backpack.views.tip.SamsaraEquipGetTip",hl);var i=t.prototype;i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.notice.text=RP.n[722],t._dto=KH.create(t._goodsId),t._grid=new MF,t.addChild(t._grid),t._grid.x=200,t._grid.y=146,t._grid.bindData=t._goodsId;var i=new fc(t._dto.name);i.centerX=0,i.y=270,t.addChild(i),i.color="#90877b",i.fontSize=20,i.font="SimHei",t.on("click",t,t.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_Go:hN.ins.open("SamsaraEquipMainView")}},i.show=function(e,t){void 0===t&&(t="")}}(),function(e){function t(){this._dto=null,this._achieves=null,this._btnEffect=null,t.__super.call(this),this.btn_grow.on("click",this,this.onGrow)}b(t,"modules.backpack.views.tip.RingEquipToolTip",E_);var i=t.prototype;return i.show=function(e,t,i){var n=this;if(void 0===t&&(t=-1),void 0===i&&(i=!0),n._dto=e)if(0<e.level&&i)hN.ins.open("RINGUPMAINVIEW",n._dto,"ACTOR_M");else{var s=0,o="",a="";1==n._dto.type?(s=309,o="js_tc_text_mbjz",a="tips_mb"):2==n._dto.type?(s=310,o="js_tc_text_fsjz",a="tips_hs"):3==n._dto.type?(s=311,o="js_tc_text_sljz",a="tips_sl"):4==n._dto.type&&(s=312,o="js_tc_text_fhjz",a="tips_fh");var r=Bi.getIndex(s);n.parent||(eq.panelLayer.on("MASK_CLOSE",n,n.onClick),eq.panelLayer.openTip(n)),n.txt_ring_name.skin=_r.getAtlasSubPath("basic_ui/"+o+".png"),n.ring.skin=_r.getAtlasSubPath("actor/"+a+".png"),n.ring.centerX=0,n.ring.centerY=-200,n.material.visible=!1,n.btn_grow.visible=!1,n.is_active.skin=0<e.level?_r.getAtlasSubPath("base_ui2/tj_img_yjh.png"):_r.getAtlasSubPath("base_ui2/tj_img_wjh.png"),n.imgBg.skin=_r.getAtlasSubPath("actor/tj_img_ydbg.jpg"),n.height=1083,-1!=e.nextConfigIndex&&i?(e.isAbleGrow?(n.btn_grow.visible=!0,n._btnEffect=kB.createEffect("jm1130",n.btn_grow.width/2,n.btn_grow.height/2,n.btn_grow),n._btnEffect.scale_X=1.25,n._btnEffect.scale_Y=1.2):Bi.MODEL.achieving(r)?(n._achieves||(n._achieves=new zW(500),n._achieves.centerX=-2,n._achieves.y=800),n.addChild(n._achieves),n._achieves.update(s),n.height=836+n._achieves.height+54):(n._achieves&&n._achieves.removeSelf(),n.height=1083),0==e.level?n.showInfo(e.type,1,e.jobId,t):n.showInfo(e.type,e.level,e.jobId,t)):(n.showInfo(e.type,e.level,e.jobId,t),n.height=893)}},i.showInfo=function(e,t,i,n){void 0===n&&(n=-1);var s=wB.getConfigIndex(e,t,i);if(-1!=s){var o=ps.MODEL.attrs(s),a=ps.MODEL.extraFight(s),r=ps.MODEL.buffIds(s),l=JSON.parse(o),c=aa.formatAttrToChineseByList(l);this.clearAttrs(),this.drawAttrText(c,!0,"#23b11f");var u="",d=[];for(var h=0 in""!=r&&null!=r&&(d=JSON.parse(r)),d){var _=parseInt(d[h]);s=Ls.getIndex(_),u+=Ls.MODEL.skillDesc(s)+"<br>"}this.div_des.innerHTML=u,this.fight.value=RR.getFight(o,n)+a}},i.drawAttrText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.clearAttrs=function(){for(var e=0;e<5;e++){var t=this["txt_attr_l"+e],i=this["txt_attrname_l"+e];t.visible=!1,t.style.wordWrap=!1,i.visible=!1}},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._btnEffect&&(this._btnEffect.removeSelf(),this._btnEffect.dispose(),this._btnEffect=null),this._achieves&&this._achieves.removeSelf()},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){this.close(!0)},i.onGrow=function(){null!=this._dto&&(vR.reqGrowRing(this._dto.jobId,this._dto.type),G.timer.once(100,this,this.delayOpen),this.close())},i.delayOpen=function(){hN.ins.open("RINGUPMAINVIEW",this._dto,"ACTOR_M")},i.close=function(e){var t=this;(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(t)&&eq.panelLayer.close(t):eq.panelLayer.close(t);eq.panelLayer.off("MASK_CLOSE",t,t.onClick),t.ring&&t.ring.skin&&(G.loader.clearRes(t.ring.skin),t.ring.skin=""),t.imgBg&&t.imgBg.skin&&(G.loader.clearRes(t.imgBg.skin),t.imgBg.skin="")},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag.RingEquipTipUI._$SET_instance),t._instance=null,t}()),VQ=function(e){function t(){var e=this;e._content=null,e._dto=null,e.noShowBtnList=[60035,60062,60132,60600,60601,60602,2134,2135,2136,2190,2291],e.noShowBtnSubType=[29],e.giftList=[60600,60601,60602,2134,2135,2136],e._achieves=null,e._clickParam=null,e._clickHandler=null,e.max=0,t.__super.call(e),e._content=new I0,e._content.pos(0,88),e.addChild(e._content),e.btn_use.on("click",e,e.onGoodsToolTipsUse),e.btn_min.on("click",e,e.onClickHandler),e.btn_max.on("click",e,e.onClickHandler),e.btn_sub.on("click",e,e.onClickHandler),e.btn_add.on("click",e,e.onClickHandler)}b(t,"modules.backpack.views.tip.GoodsToolTip",wm);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.show=function(s){var o=this;this._dto=s;var a=this._dto.cfgIdx,e=Bi.MODEL.colourId(a);this.txt_name.changeText(Bi.MODEL.name(a)),this.txt_name.color=ms.getByQuality(e),this._content.update(this._dto,ql.create(this,function(e){if(0<e.uuId){var t=Bi.MODEL.event2(a);o.btn_use.visible=""!=t}else o.btn_use.visible=!1;if(o.max=s.goodsNum,o.btn_use.visible){var i=s.goodsNum;0<o._dto.defaultUseMax&&(i=o._dto.defaultUseMax),o.txt_num.changeText(i+""),o.box.visible=o._content.img_line.visible=!0,o.img_bg_kuang.height=o._content.y+o._content.img_line.y+o.box.height+65}else o.box.visible=o._content.img_line.visible=!1,o.img_bg_kuang.height=o._content.y+o._content.img_line.y+25;-1!=ca.PASSSUIT_IDS.indexOf(e.goodsId)?NN.reqPassSuitInfo(ql.create(this,o.setClickHandler),e.goodsId):PR.isComposeGoods(e)?o.btn_use.label="合 成":o.btn_use.label="使 用",-1!=o.noShowBtnList.indexOf(e.goodsId)||-1!=o.noShowBtnSubType.indexOf(e.subType)?(o.btn_min.visible=o.btn_max.visible=o.btn_sub.visible=o.btn_add.visible=o.img_bg.visible=o.txt_num.visible=!1,o.btn_use.visible&&(o.img_bg_kuang.height-=75)):o.btn_min.visible=o.btn_max.visible=o.btn_sub.visible=o.btn_add.visible=o.img_bg.visible=o.txt_num.visible=!0;var n=0;o.setAchieving(e),o._achieves&&o._achieves.parent&&(n=o._achieves.height,o._achieves.y=o.img_bg_kuang.y+o.img_bg_kuang.height),this.height=o.img_bg_kuang.height+n,this.box.bottom=40+n},[this._dto])),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this))},i.updateTimeTxt=function(){this._content.updateTimeTxt()},i.setClickHandler=function(e,t,i){this.btn_use&&this.btn_use.visible&&(this.btn_use.label=e),this._clickHandler=t,this._clickParam=i},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick),this._clickHandler=null,this._clickParam=null},i.onClick=function(e){this.close(!0)},i.onGoodsToolTipsUse=function(e){var t=this;if(UB.ins.playSound(90101),t._dto)if(t._clickHandler)t._clickHandler.runWith(t._clickParam);else{var i=t._dto.cfgIdx,n=Bi.MODEL.event2(i);if(2061==t._dto.goodsId&&(gR.ins.isshowYuyiZhisheng=1),-1!=ca.SEAAIR_TOOLS.indexOf(t._dto.goodsId)){nB.ins.showAddSouleExp=!0,nB.ins.useGoodsDto=t._dto,nB.ins.tooldsId=t._dto.goodsId;var s=parseInt(t.txt_num.text);return Tu.sendToModule("OPEN_SOUL_ADD_PANEL",["modules.skill.SkillModule"],{num:s}),void t.close()}if(n&&"GUILD_BOSS_MAINVIEW"==n.split("|")[1]){if(60<=gR.ins.lv&&!vN.ins.joinGuild)return hN.ins.open("GUILD_LIST_VIEW"),void t.close();if(gR.ins.lv<60)return void zB.ins.playErrorMsg(RP.n[723])}if(n&&"PETMAIN_VIEW"==n.split("|")[1]){var o=modules.pet.others.PetDataModel.ins().btnPetShow;if(1==o)Tu.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:parseInt(n.split("|")[2])});else{if(0==o)return void zB.ins.showById(5003,1);if(2==o)return void zB.ins.showById(5004,1)}}if(2078==t._dto.goodsId&&60<=gR.ins.lv&&!vN.ins.joinGuild)hN.ins.open("GUILD_LIST_VIEW",modules.guild.others.RaiseKunMasterData.ins.getSkillByGoods(t._dto));else if(n&&"modules.guild.views.raisekun.RaiseKunMasterSkillView"==n.split("|")[1]){if(!vN.ins.joinGuild)return void zB.ins.playErrorMsg(RP.n[723]);hN.ins.open("modules.guild.views.raisekun.RaiseKunMasterMainView",{dto:t._dto,openSkill:!0})}else if(23==t._dto.goodsId)Tu.sendToModule("OPEN_ZZT_PAGE",["modules.zzt.ZztModule"],0);else if(24==t._dto.goodsId)Tu.sendToModule("OPEN_ZZT_PAGE",["modules.zzt.ZztModule"],1);else if(467==t._dto.goodsId||468==t._dto.goodsId)KR.ins.checkIsInActiveTime(t._dto.goodsId)?KR.ins.openEvaluateView(t._dto.goodsId):Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],t._dto);else if(n&&"SGRING_ACTIVE_VIEW"==n.split("|")[1]){parseInt(n.split("|")[2])>aB.instance.activingRingId?zB.ins.playErrorMsg(RP.n[725]):Tu.sendToModule("OPEN_ACHIEVE_NEW_MAIN_VIEW",["modules.achievenew.AchieveNewModule"],{_subIndex_:"0"})}else if(n&&"TREASURE_VIEW"==n.split("|")[1]){var a=parseInt($e.MODEL.value($e.getIndex(175)));if(gR.ins.lv<a)return void zB.ins.playErrorMsg(RP.n[726]);if(2==parseInt(n.split("|")[2])){var r=$e.MODEL.value($e.getIndex(155)).split(",");if(dr.getOpenServiceDay()<r[0]||gR.ins.zsLv<r[1])return void zB.ins.showMsg(RP.n[727]+r[0]+RP.n[728]+r[1]+"级开启",1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(n.split("|")[2])})}else hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(n.split("|")[2])})}else if(-1!=t.giftList.indexOf(t._dto.goodsId)){var l=t._dto;0<TR.ins.goodtimesHash.take(t._dto.goodsId)?Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],l):OR.reqDiscardGoods(t._dto.goodsId)}else{l=t._dto;var c=Bi.MODEL.fight(l.cfgIdx);if("GetBigGiftBag"==Bi.MODEL.event(l.cfgIdx)&&gR.ins.VIPLevel<c){var u=ei.getIndex(4342),d=ei.MODEL.content(u);return KQ.ins.show(mp.getFormat(d,[c]),ql.create(t,t.showNOGlod),!1,3,RP.n[729]),KQ.ins.cancelClose=!1,void t.close()}if(ca.isBlackMacketGoods(l.goodsId)&&Tu.sendToModule("USE_GOODS",["modules.auctionhouse.AuctionHouseModule"],{dtoGoods:l}),n&&"TR_HEFU_VIEW"==n.split("|")[1]){if(0<BR.ins.curCopyId)return void zB.ins.showMsg(RP.n[730],1);if(!CN.getIconBtn(63))return void zB.ins.showMsg(RP.n[636],1)}if(n&&"TR_MYSTICAL_VIEW"==n.split("|")[1]){if(0<BR.ins.curCopyId)return void zB.ins.showMsg(RP.n[732],1);var h=t.getIsOpenTrMystical();if(!h)return;return void(h.isOpen?(CN.dealActIcon(CN.getIconBtn(h.icon)),t.close()):zB.ins.showMsg(RP.n[636],1))}1<l.goodsNum?Tu.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:l,num:parseInt(t.txt_num.text)}):(Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],l),2291==l.goodsId&&Tu.sendToModule("OPEN_PANEL",["modules.vip.VipModule"]))}}t.close()},i.getIsOpenTrMystical=function(){for(var e=0;e<kt.count;e++)if("TR_MYSTICAL"==kt.MODEL.iconName(e)&&CN.getIconBtn(kt.MODEL.key(e)))return{icon:kt.MODEL.key(e),isOpen:!0};return{icon:0,isOpen:!1}},i.showNOGlod=function(e){1==e&&Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_min:t.txt_num.changeText("1");break;case t.btn_max:t.txt_num.changeText(t.max+"");break;case t.btn_sub:1<parseInt(t.txt_num.text)&&t.txt_num.changeText(parseInt(t.txt_num.text)-1+"");break;case t.btn_add:parseInt(t.txt_num.text)<t.max&&t.txt_num.changeText(parseInt(t.txt_num.text)+1+"")}},i.setAchieving=function(e){var t=this;Bi.MODEL.achieving(e.cfgIdx)&&e.needGetWay?(t._achieves||(t._achieves=new OQ(ql.create(modules.backpack.views.tip.GoodsToolTip.instance,modules.backpack.views.tip.GoodsToolTip.instance.close,null,!1))),t._achieves.pos(0,t.y+t.height+50),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.bag._GoodsTipUI._$SET_instance),t._instance=null,t}(),GQ=function(e){function t(){this._showRank=!1,this._rankArray=null,this._myDamage=null,this._firstInfo=null,t.__super.call(this)}b(t,"modules.bossancient.view.BossAncientRankScene",sm);var i=t.prototype;return i.clearAll=function(){this._rankArray=[],this._myDamage=null,this._firstInfo=null},i.updateRankInfo=function(e){e instanceof protos.bossancient.toc_24044&&(this._rankArray=e.infos,this.updateListShow(this._rankArray))},i.updateListShow=function(e){var t=this;t._rankArray=e,t._myDamage=t._rankArray.pop(),t._rankArray=t._rankArray.sort(t.sortByDam),t._firstInfo=t._rankArray[0];for(var i=0;i<t._rankArray.length;i++)t._rankArray[i].rank=i+1;t.list.array=t._rankArray,t.updateMyInfo()},i.sortByDam=function(e,t){return t.damage-e.damage},i.updateMyInfo=function(){this._myDamage&&this._firstInfo&&(this.txt_myguilddamage.changeText(mp.getBigIntStr(this._myDamage.damage)),this.txtFirstName.changeText(this._firstInfo.name),this.txtFirstDam.changeText(mp.getBigIntStr(this._firstInfo.damage)))},i.initialize=function(){this.list.itemRender=it},i.onAdd=function(e){var t=this;t.btnShowOrClose.on("click",t,t.onClick),t.boxShow.visible=t._showRank,t.boxFirst.visible=!t._showRank,t.btnShowOrClose.scaleX=t._showRank?-1:1,t.btnShowOrClose.scaleY=t._showRank?1:-1,t.txtMyName.changeText(gR.ins.charName),t.txt_myguilddamage.changeText("0"),t.txtFirstName.changeText("无"),t.txtFirstDam.changeText("0"),t.updateListShow(VR.ins.rankListInfo),ui.ViewBase.prototype.onAdd.call(t,e)},i.onRemove=function(e){this.btnShowOrClose.off("click",this,this.onClick),this.clearAll(),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClick=function(e){var t=this;t._showRank=!t._showRank,t.boxShow.visible=t._showRank,t.boxFirst.visible=!t._showRank,t.btnShowOrClose.scaleX=t._showRank?-1:1,t.btnShowOrClose.scaleY=t._showRank?1:-1},t}(),UQ=function(e){function t(){this._container=null,t.__super.call(this)}b(t,"modules.bossancient.view.Boss_AncientItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){var t=e.name;e.levLim,e.zsLim;this.txt_boss_name.changeText(t),1==e.status&&e.id==VR.ins.canClgId?(this.img_state.visible=!0,this.img_state.skin=_r.getAtlasSubPath("boss/boss_bq_kjs.png")):this.img_state.visible=!1}}),p(0,i,"select",null,function(e){this.btn_challenge.selected=e,this.txt_boss_name.color=e?"#fff9b4":"#91856d"}),t}(im),FQ=function(e){function t(){t.__super.call(this)}return b(t,"modules.bossancient.view.BossAncientRefreshView",om),t.prototype.update=function(e){if(hN.ins.isOpen("FIRST_PAY")){var t=hN.ins._getPanel("FIRST_PAY");t&&t.parent&&this.parent.setChildIndex(this,t.parent.getChildIndex(t)-1)}e&&(this.txt_bname.innerHTML=Ql.htmlText(vp.trim(e.name),dr.font,24,"#e41b00")+"已刷新")},t}(),qQ=function(e){function t(){this._array=null,this._gridsList=null,this._avatar=null,this._canClgId=0,this._listIndex=-2,this.curObj=null,this.days=["周日","周一","周二","周三","周四","周五","周六"],t.__super.call(this),this._array=VR.ins.configArr}b(t,"modules.bossancient.view.Boss_AncientView",am);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e._gridsList=new vj(6),e._gridsList.pos(-4,793),e._gridsList.scaleX=e._gridsList.scaleY=.64,e._gridsList._gnameVisible=!1,e._gridsList._gsimpleName=!1,e._gridsList._spaceX=5,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.addChildAt(e._gridsList,3),e.list.itemRender=UQ,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.selectEnable=!0,e.list.renderHandler=ql.create(e,e.onListRender,null,!1),e.list.selectHandler=ql.create(e,e.onChange,null,!1)},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.updateByVSC=function(e){var t=this;if(t._array||(t._array=VR.ins.configArr),e instanceof protos.bossancient.toc_21232){var i=e.infos;t._canClgId=e.curBossId;for(var n=0;n<t._array.length;n++)t._array[n].leftTime=i[t._array[n].id].leftTime,t._array[n].curAnger=i[t._array[n].id].curAnger,t._array[n].maxAnger=i[t._array[n].id].maxAnger,t._array[n].status=t._array[n].curAnger>=t._array[n].maxAnger?1:0;t.list.dataSource=t._array,t.setStartIndex(t._array)}},i.updateListShow=function(){this._array=VR.ins.arrayList,this.list.dataSource=this._array,this.setStartIndex(this._array)},i.setStartIndex=function(e){for(var t=0,i=0;i<e.length;i++)if(1==e[i].status){t=i;break}this.list.selectedIndex=t,this.list.tweenTo(t),this.onChange(t)},i.onListRender=function(e,t){t==this.list.selectedIndex&&this._array[t]&&2!=this._array[t].status?e.select=!0:e.select=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),VR._canClear=!0;var t=NP.noClearTexture.indexOf("/layouts/boss");-1<t&&NP.noClearTexture.splice(t,1),this._canClgId=VR.ins.canClgId,this.btn_challenge.on("click",this,this.onClickHandler),this.labName.on("click",this,this.onNameClick),this.updateListShow()},i.onNameClick=function(e){VR._canClear=!1,NP.noClearTexture.push("/layouts/boss"),VR.ins.showWildId=this.curObj.corBossId,hN.ins.close("BOSS_ANCIENT_MAINVIEW"),Tu.sendToModule("OPEN_WILD_BY_ANCIENT",["modules.boss.BossModule"])},i.onRemove=function(e){this.clearAll(),this.btn_challenge.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.clearAll=function(){this._avatar&&(this._avatar.dispose(),this._avatar=null),this.curObj=null},i.onChange=function(e){var t=this;if(t._listIndex!=e&&(t._listIndex=e,t.curObj=t.list.getItem(e),t.curObj&&2!=t.curObj.status)){var i=t.curObj.leftTime?t.curObj.maxAnger-t.curObj.curAnger-1:t.curObj.maxAnger-t.curObj.curAnger;t.labTime.changeText(t.getRefreshTime(t.curObj.refreshTime,i,t.curObj.leftTime));var n=rn.getIndex(t.curObj.id),s=rn.MODEL.bossId(n);n=hn.getIndex(s);var o=t.curObj.reward;t._gridsList.setGoodsItems(o,3);for(var a=t._gridsList.items,r=0;r<a.length;r++)a[r]&&(t["txtEname"+r].changeText(a[r].simpleName),t["txtEname"+r].color=ms.getByQuality(a[r].colourId));t.img_kill.visible=0!=t.curObj.status&&t.curObj.id==t._canClgId,t.img_kill.visible&&(2==t.curObj.status?t.img_kill.skin=_r.getAtlasSubPath("boss/boss_yzbq_yjs.png"):1==t.curObj.status&&(t.img_kill.skin=_r.getAtlasSubPath("boss/boss_yzbq_kjs.png"))),t.curObj.id==t._canClgId?(t.btn_challenge.visible=1==t.curObj.status,t.txt_ch.visible=0==t.curObj.status):(t.btn_challenge.visible=!1,t.txt_ch.visible=!0),t.txt_ch.changeText("未刷新"),t.btn_challenge.visible?(t.labTime.changeText(RP.n[734]),t.labTime.x=63,t.htmlLT.visible=t.htmlRT.visible=!1):(t.htmlLT.visible=t.htmlRT.visible=!0,t.labTime.x=63),t.txtProgress.changeText(t.curObj.curAnger+"/"+t.curObj.maxAnger),t.updateBarRate(t.curObj.curAnger/t.curObj.maxAnger),t.setAvatar(),t.setBossLevel()}},i.updateBarRate=function(e){e<0?e=0:1<e&&(e=1);var t=this.imgBar.scrollRect||new u_(0,0,this.imgBar.width,this.imgBar.height);t.width=this.imgBar.width*e,this.imgBar.scrollRect=t},i.setAvatar=function(){var e=this;if(e.curObj){var t=rn.getIndex(e.curObj.id);t=hn.getIndex(rn.MODEL.bossId(t));var i=hn.MODEL.muId(t);t=_n.getIndex(i);var n=_n.MODEL.avatarId(t);if(!e._avatar){e._avatar=new uq,e._avatar.renderInSelf=!0,e._avatar.pos(235,650);var s=e.getChildIndex(e.img_kill);e.addChildAt(e._avatar,s)}e._avatar.mid=n,e._avatar.type=Za.MONSTER,e._avatar.loadAvatarParts("mid",n,!0),e._avatar.setDir(4),e._avatar.play("stand"),e._avatar.mat.identity(),e._avatar.mat.scale(1.2,1.2)}},i.setBossLevel=function(){var e=this;if(e.curObj){var t=e.curObj.name,i=e.curObj.level;e.txt_bname.text=t+"︵",e.txt_blvl.text=i+"",e.txt_te.text="级︶",e.txt_blvl.y=e.txt_bname.y+e.txt_bname.textHeight,e.txt_te.y=e.txt_blvl.y+e.txt_blvl.height+5,e.labName.text=e.curObj.corWildName+"",e.labName.underline=!0}},i.onClickHandler=function(e){TR.ins.hasEmptyNum(50)?jR.reqEntry(this.curObj.id):KQ.ins.showBagRecycle()},i.updateInfoByVSC=function(e){this.updateListShow()},i.getRefreshTime=function(e,t,i){var n=dr.curServerTime,s=new Date(1e3*e*t+n+1e3*i),o=10<=s.getHours()?s.getHours()+"":"0"+s.getHours(),a=10<=s.getMinutes()?s.getMinutes()+"":"0"+s.getMinutes();return"将于"+s.getFullYear()+"年"+(s.getMonth()+1)+"月"+s.getDate()+"日("+this.getWeekDayStr(s.getDay())+")"+o+":"+a},i.getWeekDayStr=function(e){return this.days[e]+""},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(),jQ=function(e){function s(){this._imgIcon=null,this._curIconId=-1,s.__super.call(this),this.centerX=0,this.top=545}b(s,"modules.broadcast.views.ActivityOpenView",D);var t=s.prototype;return t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.update()},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),-1!=this._curIconId&&s.overdueTips.push(this._curIconId),this._curIconId=-1},t.clearOverdueTextures=function(){var e;for(var t in s.overdueTips){e=s.overdueTips[t];var i=kt.getIndex(e),n=_r.getAtlasSubPath("mainicons_mix/"+kt.MODEL.icon(i)+".png");yc.clearRes(n),yc.clearTextureRes(n),tt.ins.clearTexture(n)}},t.update=function(){var e=this,t=s.ableShowTips;if(0!=t.length)if(-1==e._curIconId){e._curIconId=t[0];var i=kt.getIndex(e._curIconId);null==e._imgIcon&&(e._imgIcon=new Kl,e.addChild(e._imgIcon),e._imgIcon.centerX=0,e._imgIcon.centerY=-145,e._imgIcon.scrollRect=new u_(0,0,132,132),e._imgIcon.scale(1.2,1.2)),e._imgIcon.skin=_r.getAtlasSubPath("mainicons_mix/"+kt.MODEL.icon(i)+".png");var n=kt.MODEL.name(i);e.txt_name.changeText(n+RP.n[735])}else-1==t.indexOf(e._curIconId)&&(e._curIconId=-1,e.update());else hN.ins.close("ACTIVITY_OPEN_VIEW")},t.onClick=function(e){switch(e.target){case this.btnGo:if(-1==this._curIconId)return;var t=CN.getActIcon(this._curIconId);t&&t.btn&&CN.dealActIcon(t.btn);case this.btnClose:-1!=this._curIconId&&s.overdueTips.push(this._curIconId),this._curIconId=-1,this.update()}},p(1,s,"ableShowTips",function(){var e=[];if(null==s.lastShowTips)e=s.needShowTips.concat();else for(var t=0;t<s.needShowTips.length;t++){var i=s.needShowTips[t];-1==s.overdueTips.indexOf(i)&&e.push(i)}return e},layouts.broad.ActivityOpenViewUI._$SET_ableShowTips),s.clearOverdueTips=function(){for(var e=0;e<s.overdueTips.length;e++){var t=s.overdueTips[e];-1==s.needShowTips.indexOf(t)&&-1!=s.lastShowTips.indexOf(t)&&(s.overdueTips.splice(e,1),e--)}},s.needShowTips=[],s.lastShowTips=[],s.overdueTips=[],s}(),WQ=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0,this.init()}b(e,"modules.limitChallenge.views.LimitChallengeMainView",t);var i=e.prototype;return i.init=function(){this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/limitYQBtn/yq_btn_fs1.png","ui/layouts/limitYQBtn/yq_btn_fs2.png","ui/layouts/limitYQBtn/yq_btn_fs3.png","ui/layouts/limitYQBtn/yq_btn_fs4.png","ui/layouts/limitYQBtn/yq_btn_fs5.png","ui/layouts/limitYQBtn/yq_btn_fs6.png","ui/layouts/limitYQBtn/yq_btn_fs7.png","ui/layouts/limitYQBtn/yq_btn_fs8.png","ui/layouts/limitYQBtn/yq_btn_fs9.png","ui/layouts/limitYQBtn/yq_btn_scfs.png"],this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1);for(var e,t=[],i=0;i<mN.ins.taskHash.length;i++)(e=new Object).cls=F0,e.id=i,e.data={group:i+1},e.grayTip=function(){zB.ins.playErrorMsg(RP.n[736])},t.push(e);this.vsc.registAll(t),this.vsc.filterHandler=ql.create(this,this.checkRedPoint,null,!1)},i.onAdd=function(e){t.prototype.onAdd.call(this,e),this.panelName="LimitChallengeMainView",AN.ins.addListener("BTN_FLYUP_2ROAD",[251],ql.create(this,this.redPtUpdate,null,!1))},i.onRemove=function(e){t.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_FLYUP_2ROAD")},i.redPtUpdate=function(e,t){this.updateItemEnabled()},i.updateItemEnabled=function(){this.vsc.updateItemEnabled()},i.checkRedPoint=function(e){return parseInt(e)>mN.ins.groupId-1?1:parseInt(e)<mN.ins.groupId-1?0:AN.ins.getStateByCareList([251])?3:0},i.onSubChanged=function(e,t){var i,n=parseInt(e)+1;i=_r.getAtlasSubPath("limitYQBtn/fs_text_fs"+n.toString()+".png"),this.setTitle(i)},i.update=function(e){this.callLater(this.updateDo,e)},i.updateDo=function(e){this.vsc.invalid(),this.vsc.updateSelectedView(e)},i.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},e.SUB_GE="0",e}(Ip),YQ=function(e){function n(){var e=this;e.maxLen=0,e.itemH=0,e.spaceY=0,e.totH=0,e._items=null,e._curItems=null,e._hideItems=null,e._msgs=null,e._isPlay=!1,e._isScroll=!1,e.txtkey=null,n.__super.call(e),null==zB.ins.attrView&&(zB.ins.attrView=e),e._curItems=[],e._hideItems=[],e._items=[];for(var t=0;t<7;t++){var i=e["item"+t];i.visible=!1,e._items.push(i)}e._msgs=[],e._isPlay=!1,e._isScroll=!1,e.maxLen=e._items.length-1,e.itemH=40,e.spaceY=0,e.totH=300,e.content.y=e.itemH+e.spaceY,e.centerX=-200,e.y=800,e.mouseThrough=!0,e.visible=!1,e.txtkey={ATK:1,BOSS_DAM_INC:1,CRI:1,CRI_RATE:1,DEF:1,EVASION:1,MAXHP:1,MAXMP:1,MDEF:1,PARALYSIS_RATE:1,PARALYSIS_RES_RATE:1,PRECISION:1,REGEN_HP_PS:1,TRUE_DEF:1},G.timer.once(1e3,e,e.initEnd)}b(n,"modules.broadcast.views.AttrEffectView",Ae);var t=n.prototype;return t.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},t.pushAttr=function(e,t){null!=this.txtkey[e]&&(this.parent||eq.topLayer.addChild(this),this._msgs.push({key:e,val:t}),this.visible=!0,this.loopNext(),G.timer.once(3e3,this,this.onClearItems))},t.onClearItems=function(){var e=this,t=0;if(e.onHideThis(),e._curItems&&0<e._curItems.length)for(t=0;t<e._curItems.length;t++)e._curItems[t].parent&&e._curItems[t].parent.removeChild(e._curItems[t]);if(e._hideItems&&0<e._hideItems.length)for(t=0;t<e._hideItems.length;t++)e._hideItems[t].parent&&e._hideItems[t].parent.removeChild(e._hideItems[t]);e._hideItems=[],e._curItems=[],e._msgs=[]},t.loopNext=function(){var e=this;if(!e._isPlay&&!e._isScroll&&0!=e._msgs.length){if(7<e._msgs.length)return e._msgs.splice(0,e._msgs.length-7),void G.timer.once(150,e,e.onScrollEnd);e._isPlay=!0;var t=e._msgs.shift(),i=e.itemH+e.spaceY,n=e.getItem();n.x=0,n.img_desc.on("loaded",e,e.adjustPos,[n]),n.img_desc.skin=_r.getAttrTxtPath(t.key),n.clip_value.value=t.val,e.adjustPos(n),n.visible=!0,e._curItems.push(n),n.y=e.totH+120,Og.to(n,{y:e.totH},150,pa.linearIn,ql.create(e,e.onShowStart,[n])),G.timer.once(300,e,e.onDelayTime,[n]),e.totH>=i*e.maxLen?(e._isScroll=!0,Og.to(e.content,{y:0},150,pa.linearIn,ql.create(e,e.onScrollEnd))):e.totH-=i}},t.onDelayTime=function(e){G.timer.clear(this,this.onDelayTime),1==this._isPlay&&(this._isPlay=!1)},t.onScrollEnd=function(){G.timer.frameOnce(1,this,this._onScrollEnd)},t._onScrollEnd=function(){for(var e=this,t=e.itemH+e.spaceY,i=e._curItems.length,n=(e.maxLen-i)*t,s=0;s<i;s++){e._curItems[s].y=n+t*s}e.content.y=e.itemH+e.spaceY,e._isScroll=!1,e.loopNext()},t.adjustPos=function(e){0==e.img_desc.width?e.clip_value.x=120:e.clip_value.x=e.img_desc.x+e.img_desc.width+10},t.onShowStart=function(e){Og.to(e,{alpha:1},1e3,pa.linearIn,ql.create(this,this.onShowEnd,[e])),this._isPlay=!1,this.loopNext()},t.onShowEnd=function(e){Og.to(e,{x:-200,alpha:0},200,pa.linearIn,ql.create(this,this.onComplete,[e])),this._hideItems.push(e);var t=this._curItems.indexOf(e);this._curItems.splice(t,1),0==this._curItems.length&&(this.totH=270),this.onHideThis()},t.onComplete=function(e){this._items.push(e),e.alpha=1,e.visible=!1,e.img_desc.off("loaded",this,this.adjustPos);var t=this._hideItems.indexOf(e);this._hideItems.splice(t,1),0==this._curItems.length&&0==this._hideItems.length&&(this.visible=!1,this.removeSelf())},t.getItem=function(){var e;return 0<this._items.length?e=this._items.pop():(null==(e=this._hideItems.shift())&&(e=this._curItems.shift()),null==e&&(e=Fh.getItemByClass("AttrEffect",Me))),Og.clearAll(e),e&&(e.alpha=1,e.img_desc.off("loaded",this,this.adjustPos),e.visible=!1),e},t.onHideThis=function(){this._isScroll=!1,this._isPlay=!1},n}(),zQ=function(e){function i(){var e=this;e.offset=-28,e.msgArr=null,e.isPlay=!1,i.__super.call(e),null==zB.ins.broadView&&(zB.ins.broadView=e),e.msgArr=zB.ins.getBroadMsg(),e.visible=!1;var t=new u_;t.width=e.width-56,t.height=e.height,e.spr_content.scrollRect=t,e.div_broad.style.wordWrap=!1,e.div_broad.innerHTML="",e.div_broad.on("link",e,e.onLink),e.on("display",e,e.onDisplay),e.mouseThrough=!0,G.timer.once(1e3,e,e.initEnd),e.mouseEnabled=!1}b(i,"modules.broadcast.views.BroadcastView",ft);var t=i.prototype;return t.initEnd=function(){this.isPlay||(G.timer.clear(this,this.initEnd),this.removeSelf())},t.sortByPri=function(e,t){return e.pri-t.pri},t.onLink=function(e){QB.ins.linkHandler(e)},t.pushText=function(e){this.parent||eq.topLayer.addChild(this),zB.ins.pushBroadMsg(e),this.msgArr=zB.ins.getBroadMsg(),this.isPlay||G.timer.frameOnce(1,this,this.startPlay)},t.startPlay=function(){var e=this;e.isPlay||(e.visible=!0,e.isPlay=!0,e.div_broad.x=e.width+e.offset,e.div_broad.innerHTML=e.msgArr.shift().html,e.div_broad.width=e.div_broad.contextWidth,G.scaleTimer.frameLoop(1,e,e.onLoop))},t.onLoop=function(){this.div_broad.x-=2,this.div_broad.x+this.div_broad.width+this.offset<=0&&this.loopNext()},t.loopNext=function(){var e=this;0<e.msgArr.length?(e.div_broad.x=e.width+e.offset,e.div_broad.innerHTML=e.msgArr.shift().html,e.div_broad.width=e.div_broad.contextWidth):(e.isPlay=!1,G.scaleTimer.clear(e,e.onLoop),e.div_broad.innerHTML="",e.visible=!1,e.removeSelf())},t.onDisplay=function(e){this.div_broad.x=this.width+this.offset,!this.isPlay&&0<this.msgArr.length&&this.pushText(this.msgArr.pop())},t.onResize=function(){ui.ViewBase.prototype.onResize.call(this),this.x=(G.stage.width-this.width)/2},i}(),XQ=function(e){function a(){this._grid=null,this._wearHandler=null,a.__super.call(this),this._grid=new MF,this.grid.addChild(this._grid),this.centerX=0,this.top=436,this.txt_content.mouseEnabled=!1}b(a,"modules.broadcast.views.EquipWearTip",ma);var t=a.prototype;return t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.updateView()},t.onRemove=function(e){var t;for(var i in ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),a._showItems=[],a._textureUrls)t=a._textureUrls[i],NP.noClearTexture.splice(NP.noClearTexture.indexOf(t),1);a._textureUrls=[]},t.show=function(e,t,i,n,s,o){void 0===t&&(t=""),void 0===n&&(n=RP.n[737]),void 0===s&&(s=RP.n[738]),void 0===o&&(o=!1),a._showItems.push({dtoGoods:e,content:t,wearHandler:i,title:n,btnlabel:s,showSimName:o}),hN.ins.open("EQUIP_WEAR_TIP")},t.updateView=function(){var e=this;if(0!=a._showItems.length){var t=a._showItems.shift(),i=t.dtoGoods;null!=t.title&&e.txt_title.changeText(t.title),null!=t.content&&(e.txt_content.innerHTML=t.content),e._wearHandler=t.wearHandler,e._grid.bindData=i,e.txt_name.color=ms.getByQuality(i.colourId),t.showSimName?e.txt_name.changeText(i.simpleName):e.txt_name.changeText(i.name),e.btn_wear.label=t.btnlabel,e.parent||eq.navLayer.addChild(e),a._textureUrls.push(e._grid.getIconUrl()),NP.noClearTexture.push(e._grid.getIconUrl())}else e.close()},t.onClick=function(e){switch(e.target){case this.btn_wear:null!=this._wearHandler&&(this._wearHandler.run(),this._wearHandler.clear()),this._wearHandler=null;case this.btn_close:this.close()}},t.close=function(){hN.ins.close("EQUIP_WEAR_TIP")},p(1,a,"ins",function(){return a._instance=a._instance||new a},layouts.broad.EquipWearTipUI._$SET_ins),a._instance=null,a._showItems=[],a._textureUrls=[],a}(),QQ=function(e){function i(){var e=this;e._fight=0,e._sfight=0,e._time=NaN,e._tfight=NaN,e._stopTime=NaN,e._tweenerBody=null,e._tweenerAdd=null,e.step=0,i.__super.call(e),e.visible=!1,e.clip_add.visible=!1,e.mouseThrough=!0,e.step=0,G.timer.once(1e3,e,e.initEnd)}b(i,"modules.broadcast.views.FightEffectView",Da);var t=i.prototype;return t.initEnd=function(){G.timer.clear(this,this.initEnd),this.removeSelf()},t.playFight=function(e,t){0!=this.step&&4!=this.step||(this._sfight=e-t),this._fight=e,this._stopTime=BB.getTimer()+1e3,i.delayShow||this.play()},t.starPlayFight=function(){this.play()},t.play=function(){var e=this;e.parent||eq.topLayer.addChild(e),0==e.step?e.playStart():2==e.step?e._time=BB.getTimer():3==e.step?(e.clip_add.visible=!1,null!=e._tweenerAdd&&e._tweenerAdd.clear(),e.onShowEnd()):4==e.step&&(G.timer.clearAll(e),null!=e._tweenerBody&&e._tweenerBody.clear(),e.playEnd(),e.playStart()),e.timer.once(4e3,e,e.onclearThis)},t.playStart=function(){var e=this;e.step=1,e.x=(G.stage.width-e.width)/2+6,e.visible=!0,e._tfight=e.getTFight(e._fight),e.clip_tot.value=e._tfight+"",e.img_fight.x=e.clip_tot.x+e.clip_tot.width/2-e.img_fight.width-19*e._fight.toString().length/2-10,e.y=850,e.onShowEnd()},t.onShowEnd=function(){this.step=2,this._time=BB.getTimer(),G.timer.loop(40,this,this.rollNum),this.showExtraFight()},t.rollNum=function(){var e=this,t=BB.getTimer();t>e._stopTime&&(G.timer.clear(e,e.rollNum),e.rollEnd());var i=Math.floor((t-e._time)/1e3*(e._fight-e._tfight)+e._tfight);i>e._fight&&(i=e._fight),e.clip_tot.value=i+""},t.rollEnd=function(){this.step=4,this.clip_tot.value=this._fight+"",this.onAddEnd()},t.showExtraFight=function(){var e=this;e.step=3,e.clip_add.value="+"+(e._fight-e._sfight),e.clip_add.visible=!0,e.clip_add.y=106,null==e._tweenerAdd?e._tweenerAdd=new Og:e._tweenerAdd.clear(),e._tweenerAdd.to(e.clip_add,{y:e.clip_tot.y},200,pa.linearIn,null)},t.onAddEnd=function(){null==this._tweenerBody?this._tweenerBody=new Og:this._tweenerBody.clear(),this._tweenerBody.to(this,{alpha:0},500,pa.sineIn,ql.create(this,this.playEnd),200)},t.playEndS=function(){},t.playEnd=function(){this.step=0,this.alpha=1,this.visible=!1,this.clip_add.visible=!1,i.delayShow=!1,this.removeSelf()},t.getTFight=function(e){for(var t=1,i=0;0<e;)i=e%10*t,e=Math.floor(e/10),t*=10;return i},t.onclearThis=function(){this.timer.clear(this,this.onclearThis),this.playEnd()},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),i.delayShow=!1},i.delayShow=!1,i}(),JQ=function(e){function l(){var e=this;e.noShowBtnList=[60035,60062,60132,60600,60601,60602],e.giftList=[60600,60601,60602],e._content=null,e._wearHandler=null,e._clickParam=null,e._clickHandler=null,e.max=0,l.__super.call(e),e._content=new b0,e._content.pos(0,88),e.addChild(e._content),e.centerX=0,e.centerY=0}b(l,"modules.broadcast.views.GoodsQuickUseTip",dl);var t=l.prototype;return t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_use.on("click",t,t.onGoodsToolTipsUse),t.btn_min.on("click",t,t.onClickHandler),t.btn_max.on("click",t,t.onClickHandler),t.btn_sub.on("click",t,t.onClickHandler),t.btn_add.on("click",t,t.onClickHandler),t.btn_close.on("click",t,t.onClickHandler),t.updateView()},t.onRemove=function(e){var t,i=this;for(var n in ui.ViewBase.prototype.onRemove.call(i,e),i.btn_use.off("click",i,i.onGoodsToolTipsUse),i.btn_min.off("click",i,i.onClickHandler),i.btn_max.off("click",i,i.onClickHandler),i.btn_sub.off("click",i,i.onClickHandler),i.btn_add.off("click",i,i.onClickHandler),i.btn_close.off("click",i,i.onClickHandler),l._showItems=[],l._needShowItems=[],l._curDto=null,l._textureUrls)t=l._textureUrls[n],NP.noClearTexture.splice(NP.noClearTexture.indexOf(t),1);l._textureUrls=[]},t.setClickHandler=function(e,t,i){this.btn_use&&this.btn_use.visible&&(this.btn_use.label=e),this._clickHandler=t,this._clickParam=i},t.show=function(e){-1==l._showItems.indexOf(e)&&l._curDto!=e&&(l._showItems.push(e),hN.ins.open("GOODS_QUICK_USE_TIP"))},t.showNeedShow=function(){if(0!=l._needShowItems.length){var e;for(var t in l._needShowItems)e=l._needShowItems[t],this.show(e);l._needShowItems=[]}},t.onGoodsToolTipsUse=function(e){if(UB.ins.playSound(90101),l._curDto)if(this._clickHandler)this._clickHandler.runWith(this._clickParam);else{var t,i=l._curDto.cfgIdx,n=Bi.MODEL.event2(i);if(2061==l._curDto.goodsId&&(gR.ins.isshowYuyiZhisheng=1),""!=n&&(t=n.split("|"))&&"GUILD_BOSS_MAINVIEW"==t[1]){if(60<=gR.ins.lv&&!vN.ins.joinGuild)return hN.ins.open("GUILD_LIST_VIEW"),void this.close();if(gR.ins.lv<60)return void zB.ins.playErrorMsg(RP.n[723])}if(2078==l._curDto.goodsId&&60<=gR.ins.lv&&!vN.ins.joinGuild)hN.ins.open("GUILD_LIST_VIEW");else if(23==l._curDto.goodsId)Tu.sendToModule("OPEN_ZZT_PAGE",["modules.zzt.ZztModule"],0);else if(24==l._curDto.goodsId)Tu.sendToModule("OPEN_ZZT_PAGE",["modules.zzt.ZztModule"],1);else if(467==l._curDto.goodsId||468==l._curDto.goodsId)KR.ins.checkIsInActiveTime(l._curDto.goodsId)?KR.ins.openEvaluateView(l._curDto.goodsId):Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],l._curDto);else if(n&&"SGRING_ACTIVE_VIEW"==n.split("|")[1]){var s=parseInt(n.split("|")[2]);s>aB.instance.activingRingId?zB.ins.playErrorMsg(RP.n[725]):Tu.sendToModule("OPEN_SGR_ACTIVE_VIEW",["modules.specialgodring.SpecialGodRingModule"],s)}else if(n&&"TREASURE_VIEW"==n.split("|")[1]){var o=parseInt($e.MODEL.value($e.getIndex(175)));if(gR.ins.lv<o)return void zB.ins.playErrorMsg(RP.n[726]);if(2==parseInt(n.split("|")[2])){var a=$e.MODEL.value($e.getIndex(155)).split(",");if(dr.getOpenServiceDay()<a[0]||gR.ins.zsLv<a[1])return void zB.ins.showMsg(RP.n[727]+a[0]+RP.n[728]+a[1]+"级开启",1);hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(n.split("|")[2])})}else hN.ins.open("TREASURE_VIEW",{_subIndex_:parseInt(n.split("|")[2])})}else if(-1!=this.giftList.indexOf(l._curDto.goodsId)){var r=l._curDto;0<TR.ins.goodtimesHash.take(l._curDto.goodsId)?Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],r):OR.reqDiscardGoods(l._curDto.goodsId)}else 1<(r=l._curDto).goodsNum?Tu.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:r,num:parseInt(this.txt_num.text)}):Tu.sendToModule("BP_SHOWUSE",["modules.backpack.BackpackModule"],r)}this.updateView()},t.close=function(){l._curDto=null,l._showItems=[],l._needShowItems=[],hN.ins.close("GOODS_QUICK_USE_TIP")},t.updateView=function(){var i=this;if(0!=l._showItems.length){var n=(l._curDto=l._showItems.shift()).cfgIdx,e=Bi.MODEL.colourId(n);this.txt_name.changeText(Bi.MODEL.name(n)),this.txt_name.color=ms.getByQuality(e),l._textureUrls.push(this.getIconUrl(l._curDto.goodsId)),this._content.update(l._curDto,ql.create(this,function(e){if(0<e.uuId){var t=Bi.MODEL.event2(n);i.btn_use.visible=""!=t}else i.btn_use.visible=!1;i.max=l._curDto.goodsNum,i.btn_use.visible?(i.txt_num.changeText(l._curDto.goodsNum+""),i.box.visible=i._content.img_line.visible=!0,this.height=i._content.y+i._content.img_line.y+i.box.height+65):(i.box.visible=i._content.img_line.visible=!1,this.height=i._content.y+i._content.img_line.y+25),-1!=ca.PASSSUIT_IDS.indexOf(e.goodsId)?NN.reqPassSuitInfo(ql.create(this,i.setClickHandler),e.goodsId):PR.isComposeGoods(e)?i.btn_use.label="合 成":i.btn_use.label="使 用",-1!=i.noShowBtnList.indexOf(e.goodsId)?i.btn_min.visible=i.btn_max.visible=i.btn_sub.visible=i.btn_add.visible=i.img_bg.visible=i.txt_num.visible=!1:i.btn_min.visible=i.btn_max.visible=i.btn_sub.visible=i.btn_add.visible=i.img_bg.visible=i.txt_num.visible=!0},[l._curDto]))}else this.close()},t.getIconUrl=function(e){var t=Bi.getIndex(e),i=Bi.MODEL.icon(t);return _r.getIconPath(i)},t.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_min:t.txt_num.changeText("1");break;case t.btn_max:t.txt_num.changeText(t.max+"");break;case t.btn_sub:1<parseInt(t.txt_num.text)&&t.txt_num.changeText(parseInt(t.txt_num.text)-1+"");break;case t.btn_add:parseInt(t.txt_num.text)<t.max&&t.txt_num.changeText(parseInt(t.txt_num.text)+1+"");break;case t.btn_close:t.updateView()}},t.addNeedShow=function(e){l._needShowItems.push(e)},p(0,t,"curShow",function(){return l._curDto}),p(1,l,"ins",function(){return l._instance=l._instance||new l},layouts.broad.GoodsQuickUseTipUI._$SET_ins),l._instance=null,l._showItems=[],l._needShowItems=[],l._textureUrls=[],l._curDto=null,l}(),ZQ=function(s){function t(){var e=this;e.vsc=null,e.resList=[235,236,237,,240],t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.size(720,1280),e.centerX=e.centerY=0}b(t,"modules.magic.views.MagicMainView",s);var e=t.prototype;return e.initialize=function(){this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onVSCSelected,null,!1),this.navList=["ui/layouts/magic/tab_magicTower.png","ui/layouts/magic/yq_btn_mwjd.png","ui/layouts/magic/yq_btn_mwmj.png","ui/layouts/magic/yq_btn_mwbk.png"];var e=zB.ins.getDesc(4295),t=zB.ins.getDesc(4296),i=zB.ins.getDesc(4297),n=zB.ins.getDesc(4298);this.vsc.registAll([{cls:iZ,id:"0",isHideBg:!0,wait:hN.wait(hN.waitConfig(["FengMoTaConfig"],["CMagicTower"])),grayTip:function(){zB.ins.showMsg(e,1)}},{cls:z0,id:"1",isHideBg:!0,grayTip:function(){zB.ins.showMsg(t,1)}},{cls:Q0,id:"2",isHideBg:!0,grayTip:function(){zB.ins.showMsg(i,1)}},{cls:tZ,id:"3",isHideBg:!0,grayTip:function(){zB.ins.showMsg(n,1)}}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},e.onAdd=function(e){s.prototype.onAdd.call(this,e);ql.create(this,this.redPtUpdate,null,!1);var t=__.equipCareList.concat(this.resList);AN.reqRedPt(t)},e.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},e.destroy=function(e){void 0===e&&(e=!0),s.prototype.destroy.call(this,e),hN.ins.isOpen("MAGIC_TOWER_RANK")&&hN.ins.close("MAGIC_TOWER_RANK");for(var t=[_r.getAtlasSubPath("magic/num_fm_cs.png"),_r.getAtlasSubPath("magic/num_fm_zdl.png")],i=0;i<t.length;i++){var n=G.loader.getRes(t[i]);n&&n.destroy(),n=null}},e.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.checkTips=function(e){if("0"==e){if(!IN.isOpenMagicTower)return 1;if(AN.ins.getStateByCareList([235]))return 3}else if("1"==e){if(0==IN.isOpenMagicJindi)return 1;if(AN.ins.getStateByCareList([236]))return 3}else if("2"==e){if(0==IN.isOpenMagicMinjing)return 1;if(AN.ins.getStateByCareList([237]))return 3}else if("3"==e){if(!IN.isOpenMagicBaoku)return 1;if(AN.ins.getStateByCareList([240]))return 3}return 0},e.onVSCSelected=function(e,t){var i="";switch(e){case"0":i="magic/fmt_title_fmt.png";break;case"1":i="magic/mwmj_title_mwjd.png";break;case"2":i="magic/mwmj_title_mwmj.png";break;case"3":i="magic/mwbk_text_mwbk.png"}this.setTitle(_r.getAtlasSubPath(i))},t}(Ip),KQ=function(e){function t(){this._maskCancel=!0,this.cancelClose=!1,this._descDiv=null,this._handler=null,this._cbRecords={},this._recordType=null,this._recordCookie=!1,t.__super.call(this),this.btn_cancel.on("click",this,this.onBtnClick,[this.btn_cancel]),this.btn_ok.on("click",this,this.onBtnClick,[this.btn_ok]),this.btn_close.on("click",this,this.onBtnClick,[this.btn_close]),this._descDiv=kB.createHtmlDiv(0,0,26,"#90877b",460,0,this),this._descDiv.style.leading=8,this._descDiv.style.align="center",this.hdv_des.style.font="SimHei",this.hdv_des.style.fontFamily="SimHei",this.hdv_des.style.fontSize=26,this.hdv_des.style.color="#90877b",this.hdv_des.style.leading=8,this.hdv_des.style.align="center",this.box_selected&&(this.box_selected.visible=!1)}b(t,"modules.broadcast.views.Alert",$v);var i=t.prototype;return i.show=function(e,t,i,n,s,o,a,r,l){var c=this;if(void 0===i&&(i=!1),void 0===n&&(n=3),void 0===a&&(a=!0),void 0===r&&(r=0),void 0===l&&(l=!1),c.cancelClose=!1,null==o?(c.txt_title.visible=!1,c.img_title.visible=!0):(c.txt_title.visible=!0,c.img_title.visible=!1),c.box1.visible=!1,c._descDiv.visible=!0,c.btn_close.visible=a,null==s)c.btn_ok.label="确 认",c.btn_cancel.label="取 消";else if(2==n){var u=s.split(",");c.btn_ok.label=u[0],c.btn_cancel.label=u[1]}else 3==n?(u=s.split(","),c.btn_cancel.label=u[0],c.btn_ok.label=u[1]):1==n?c.btn_ok.label=s:0==n&&(c.btn_cancel.label=s);if(c.icon.visible=!1,0<r&&(c.icon.visible=!0,c.txt_cost.changeText(r.toString())),c._descDiv.innerHTML=e,c._descDiv.height=c._descDiv.contextHeight,c._descDiv.y=102+(175-c._descDiv.height)/2,c._handler=t,i?(c.img_caution.visible=!0,c.img_caution.x=(c.width-c._descDiv.contextWidth-c.img_caution.width-8)/2,c.img_caution.y=c._descDiv.y+1,c._descDiv.x=c.img_caution.x+c.img_caution.width+8-(c._descDiv.width-c._descDiv.contextWidth)/2):(c._descDiv.x=(c.width-c._descDiv.width)/2,c.img_caution.visible=!1),c.box_selected&&(c.box_selected.visible=l),c.txt_title.text=o,0==n)c.btn_cancel.x=(c.width-c.btn_cancel.width)/2,c.btn_cancel.visible=!0,c.btn_ok.visible=!1;else if(1==n)c.btn_ok.x=(c.width-c.btn_ok.width)/2,c.btn_ok.visible=!0,c.btn_cancel.visible=!1;else if(2==n){var d=96;c.btn_ok.x=(c.width-c.btn_ok.width-c.btn_cancel.width-d)/2,c.btn_cancel.x=c.btn_ok.x+c.btn_ok.width+d,c.btn_ok.visible=c.btn_cancel.visible=!0}else 3==n&&(d=96,c.btn_cancel.x=(c.width-c.btn_ok.width-c.btn_cancel.width-d)/2,c.btn_ok.x=c.btn_cancel.x+c.btn_cancel.width+d,c.btn_ok.visible=c.btn_cancel.visible=!0);c.parent||(eq.panelLayer?(eq.panelLayer.once("MASK_CLOSE",c,c.onClick),eq.panelLayer.open(c,!1,!0)):G.stage.addChild(c),c.stage&&c.stage.on("resize",c,c._$8_onResize),c._$8_onResize())},i.showNoGold=function(){var e=zB.ins.getDesc(1029);this.show(e,ql.create(this,recharge=function(e){switch(e){case 1:Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])}}),!1,3,RP.n[744])},i.showBagRecycle=function(){var e=zB.ins.getDesc(1030);this.show(e,ql.create(this,recycle=function(e){Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"])}),!1,1,RP.n[745]),UB.ins._playBackpackNot(),mQ.isInited&&mQ.instance.close()},i.showmoyuRecycle=function(){var e=zB.ins.getDesc(3913);this.show(e,ql.create(this,recycle=function(e){Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"])}),!1,1,RP.n[745]),UB.ins._playBackpackNot()},i._$8_onResize=function(){this.x=(G.stage.width-this.width)/2,this.y=(G.stage.height-this.height)/2},i.onClick=function(e){this._maskCancel&&this.onBtnClick(this.btn_close)},i.close=function(){var e=this;e.parent&&(e.stage&&e.stage.off("resize",e,e._$8_onResize),eq.panelLayer?eq.panelLayer.close(e):e.parent.removeChild(e)),e._maskCancel=!0,e._handler=null,e._recordType=null},i.setMaskCancel=function(e){this._maskCancel=e},i.onBtnClick=function(e){var t=this,i=t._handler,n=t._recordType;if(t.cancelClose||t.close(),e==t.btn_ok||e==t.btn_cancel){var s=e==t.btn_ok?1:0;t.close(),t.box1.visible?(n&&1==s&&t.checkbox.selected&&(t._cbRecords[n]=!0),i&&i.runWith([s,t.checkbox.selected])):i&&i.runWith(s)}},i.showBox=function(e,t,i,n,s,o,a,r,l,c){var u=this;if(void 0===n&&(n=!1),void 0===s&&(s=3),void 0===l&&(l=!1),void 0===c&&(c=!1),r){if(!0===u._cbRecords[r]&&!0,!0===u._cbRecords[r])return u._handler=i,void u.onBtnClick(u.btn_ok)}if(u._recordType=r,u._recordCookie=l,u.cancelClose=!1,null==a&&(a=RP.n[747]),u.box1.visible=!0,u._descDiv.visible=!1,u.box_selected&&(u.box_selected.visible=c),null==o)u.btn_ok.label="确 认",u.btn_cancel.label="取 消";else if(2==s){var d=o.split(",");u.btn_ok.label=d[0],u.btn_cancel.label=d[1]}else 3==s?(d=o.split(","),u.btn_cancel.label=d[0],u.btn_ok.label=d[1]):1==s?u.btn_ok.label=o:0==s&&(u.btn_cancel.label=o);if(u.hdv_des.innerHTML=e,u.txt_checkbox.changeText(t),u.checkbox.x=508-(52+u.txt_checkbox.textWidth)>>1,u.checkbox.toggle=!0,u.checkbox.selected=!1,u._handler=i,u.img_caution.visible=!!n,u.txt_title.text=a,0==s)u.btn_cancel.x=(u.width-u.btn_cancel.width)/2,u.btn_cancel.visible=!0,u.btn_ok.visible=!1;else if(1==s)u.btn_ok.x=(u.width-u.btn_ok.width)/2,u.btn_ok.visible=!0,u.btn_cancel.visible=!1;else if(2==s){var h=96;u.btn_ok.x=(u.width-u.btn_ok.width-u.btn_cancel.width-h)/2,u.btn_cancel.x=u.btn_ok.x+u.btn_ok.width+h,u.btn_ok.visible=u.btn_cancel.visible=!0}else 3==s&&(h=96,u.btn_cancel.x=(u.width-u.btn_ok.width-u.btn_cancel.width-h)/2,u.btn_ok.x=u.btn_cancel.x+u.btn_cancel.width+h,u.btn_ok.visible=u.btn_cancel.visible=!0);u.parent||(eq.panelLayer.once("MASK_CLOSE",u,u.onClick),eq.panelLayer.open(u,!1,!0),u.stage&&u.stage.on("resize",u,u._$8_onResize),u._$8_onResize())},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.common._AlertUI._$SET_ins),t._inst=null,t.BTN_CANCEL=0,t.BTN_OK=1,t.BTN_OKCANCEL=2,t.BTN_CANCELOK=3,t}(),$Q=function(e){function r(){this.paoContent=null,r.__super.call(this)}b(r,"modules.broadcast.views.DialogueBubbleView",e);var t=r.prototype;return t.updatePosition=function(e,t){var i=this;if(null!=e){var n=e.x+e.width/2-i.width/2,s=e.x+e.width/2+i.width;try{i.corner.bottom=NaN,i.corner.right=NaN,i.corner.left=NaN,i.corner.top=NaN,i.corner.centerX=NaN}catch(e){return}switch(r._direction=t){case 1:i.corner.top=-16,n<0?(i.corner.left=40,i.x=e.x):600<s?(i.corner.right=40,i.x=e.x-i.width+100):(i.corner.centerX=0,i.x=e.x-i.width/2+40),i.y=e.y+e.height;break;case 5:i.x=e.x+e.width+5,i.y=e.y}}},t.setContents=function(){this.content.innerHTML=this.paoContent},t.onRemove=function(e){var t=r.paoContentViewArr.indexOf(this);-1<t&&r.paoContentViewArr.splice(t),this.content.innerHTML="",ui.ViewBase.prototype.onRemove.call(this,e)},p(0,t,"width",e.prototype._$get_width,function(e){G.superSet(Fo,this,"width",e),this.content.width=e-2*this.content.x}),p(0,t,"height",e.prototype._$get_height,function(e){G.superSet(Fo,this,"height",e),this.content.height=e-2*this.content.y}),r.addShow=function(e,t,i,n,s,o){var a;switch(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===o&&(o=1),(a=new r).content.innerHTML=e,null!=t?t.addChild(a):G.stage.addChild(a),a.pos(i,n),s&&(a.width=2*a.content.x+a.content.contextWidth,a.height=2*a.content.y+a.content.contextHeight-a.content.leading),r._direction=o,a.corner.bottom=NaN,a.corner.right=NaN,a.corner.left=NaN,o){case 1:a.corner.y=7,a.corner.right=20,a.corner.rotation=0,a.corner.scaleY=1;break;case 2:a.corner.y=7,a.corner.centerX=0,a.corner.rotation=-90,a.corner.scaleY=1;break;case 3:a.corner.bottom=26,a.corner.right=20,a.corner.rotation=90,a.corner.scaleY=-1;break;case 4:a.corner.right=-10,a.corner.centerY=0,a.corner.rotation=0,a.corner.scaleY=1;break;case 5:a.corner.rotation=270,a.corner.centerY=18,a.corner.scaleY=1,a.corner.left=-18;break;case 6:a.corner.bottom=26,a.corner.centerX=0,a.corner.rotation=90,a.corner.scaleY=-1}return a.paoContent=e,-1==r.paoContentViewArr.indexOf(a)&&r.paoContentViewArr.push(a),a},r.reSetContents=function(){for(var e=0;e<r.paoContentViewArr.length;e++)r.paoContentViewArr[e].setContents()},r.UP=1,r.LEFT=5,r._direction=0,r.paoContentViewArr=[],r}(Fo),eJ=(function(e){function t(){var e=this;e._maskCancel=!0,e.cancelClose=!1,e._descDiv=null,e._handler=null,e._cbRecords={},e._recordType=null,e._recordCookie=!1,t.__super.call(e),e.btn_cancel.on("click",e,e.onBtnClick,[e.btn_cancel]),e.btn_ok.on("click",e,e.onBtnClick,[e.btn_ok]),e.btn_close.on("click",e,e.onBtnClick,[e.btn_close]),e._descDiv=kB.createHtmlDiv(0,0,26,"#90877b",460,0,e),e._descDiv.style.leading=8,e._descDiv.style.align="center",e.hdv_des.style.font="SimHei",e.hdv_des.style.fontFamily="SimHei",e.hdv_des.style.fontSize=26,e.hdv_des.style.color="#90877b",e.hdv_des.style.leading=8,e.hdv_des.style.align="center",e.box_selected.visible=!1}b(t,"modules.broadcast.views.Alert2",$v);var i=t.prototype;i.show=function(e,t,i,n,s,o,a,r,l){var c=this;if(void 0===i&&(i=!1),void 0===n&&(n=3),void 0===a&&(a=!0),void 0===r&&(r=0),void 0===l&&(l=!1),c.cancelClose=!1,null==o?(c.txt_title.visible=!1,c.img_title.visible=!0):(c.txt_title.visible=!0,c.img_title.visible=!1),c.box1.visible=!1,c._descDiv.visible=!0,c.box_selected.visible=l,c.btn_close.visible=a,null==s)c.btn_ok.label="确 认",c.btn_cancel.label="取 消";else if(2==n){var u=s.split(",");c.btn_ok.label=u[0],c.btn_cancel.label=u[1]}else 3==n?(u=s.split(","),c.btn_cancel.label=u[0],c.btn_ok.label=u[1]):1==n?c.btn_ok.label=s:0==n&&(c.btn_cancel.label=s);if(c.icon.visible=!1,0<r&&(c.icon.visible=!0,c.txt_cost.changeText(r.toString())),c._descDiv.innerHTML=e,c._descDiv.height=c._descDiv.contextHeight,c._descDiv.y=102+(175-c._descDiv.height)/2,c._handler=t,i?(c.img_caution.visible=!0,c.img_caution.x=(c.width-c._descDiv.contextWidth-c.img_caution.width-8)/2,c.img_caution.y=c._descDiv.y+1,c._descDiv.x=c.img_caution.x+c.img_caution.width+8-(c._descDiv.width-c._descDiv.contextWidth)/2):(c._descDiv.x=(c.width-c._descDiv.width)/2,c.img_caution.visible=!1),c.txt_title.text=o,0==n)c.btn_cancel.x=(c.width-c.btn_cancel.width)/2,c.btn_cancel.visible=!0,c.btn_ok.visible=!1;else if(1==n)c.btn_ok.x=(c.width-c.btn_ok.width)/2,c.btn_ok.visible=!0,c.btn_cancel.visible=!1;else if(2==n){var d=96;c.btn_ok.x=(c.width-c.btn_ok.width-c.btn_cancel.width-d)/2,c.btn_cancel.x=c.btn_ok.x+c.btn_ok.width+d,c.btn_ok.visible=c.btn_cancel.visible=!0}else 3==n&&(d=96,c.btn_cancel.x=(c.width-c.btn_ok.width-c.btn_cancel.width-d)/2,c.btn_ok.x=c.btn_cancel.x+c.btn_cancel.width+d,c.btn_ok.visible=c.btn_cancel.visible=!0);c.parent||(eq.panelLayer?(eq.panelLayer.once("MASK_CLOSE",c,c.onClick),eq.panelLayer.open(c,!1,!0)):G.stage.addChild(c),c.stage&&c.stage.on("resize",c,c._$8_onResize),c._$8_onResize())},i.showNoGold=function(){var e=zB.ins.getDesc(1029);this.show(e,ql.create(this,recharge=function(e){switch(e){case 1:Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])}}),!1,3,RP.n[744])},i.showBagRecycle=function(){var e=zB.ins.getDesc(1030);this.show(e,ql.create(this,recycle=function(e){Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"])}),!1,1,RP.n[745]),UB.ins._playBackpackNot(),mQ.isInited&&mQ.instance.close()},i.showmoyuRecycle=function(){var e=zB.ins.getDesc(3913);this.show(e,ql.create(this,recycle=function(e){Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"])}),!1,1,RP.n[745]),UB.ins._playBackpackNot()},i._$8_onResize=function(){this.x=(G.stage.width-this.width)/2,this.y=(G.stage.height-this.height)/2},i.onClick=function(e){this._maskCancel&&this.onBtnClick(this.btn_close)},i.close=function(){var e=this;e.parent&&(e.stage&&e.stage.off("resize",e,e._$8_onResize),eq.panelLayer?eq.panelLayer.close(e):e.parent.removeChild(e)),e._maskCancel=!0,e._handler=null,e._recordType=null},i.setMaskCancel=function(e){this._maskCancel=e},i.onBtnClick=function(e){var t=this,i=t._handler,n=t._recordType;if(t.cancelClose||t.close(),e==t.btn_ok||e==t.btn_cancel){var s=e==t.btn_ok?1:0;t.close(),t.box1.visible?(n&&1==s&&t.checkbox.selected&&(t._cbRecords[n]=!0),i&&i.runWith([s,t.checkbox.selected])):t.box_selected.visible?i&&i.runWith([s,t.ck_box.selected]):i&&1==s&&i.runWith(s)}},i.showBox=function(e,t,i,n,s,o,a,r,l,c){var u=this;if(void 0===n&&(n=!1),void 0===s&&(s=3),void 0===l&&(l=!1),void 0===c&&(c=!1),r){if(!0===u._cbRecords[r]&&!0,!0===u._cbRecords[r])return u._handler=i,void u.onBtnClick(u.btn_ok)}if(u._recordType=r,u._recordCookie=l,u.cancelClose=!1,null==a&&(a=RP.n[747]),u.box1.visible=!0,u._descDiv.visible=!1,u.box_selected.visible=c,null==o)u.btn_ok.label="确 认",u.btn_cancel.label="取 消";else if(2==s){var d=o.split(",");u.btn_ok.label=d[0],u.btn_cancel.label=d[1]}else 3==s?(d=o.split(","),u.btn_cancel.label=d[0],u.btn_ok.label=d[1]):1==s?u.btn_ok.label=o:0==s&&(u.btn_cancel.label=o);if(u.hdv_des.innerHTML=e,u.txt_checkbox.changeText(t),u.checkbox.x=508-(52+u.txt_checkbox.textWidth)>>1,u.checkbox.toggle=!0,u.checkbox.selected=!1,u._handler=i,u.img_caution.visible=!!n,u.txt_title.text=a,0==s)u.btn_cancel.x=(u.width-u.btn_cancel.width)/2,u.btn_cancel.visible=!0,u.btn_ok.visible=!1;else if(1==s)u.btn_ok.x=(u.width-u.btn_ok.width)/2,u.btn_ok.visible=!0,u.btn_cancel.visible=!1;else if(2==s){var h=96;u.btn_ok.x=(u.width-u.btn_ok.width-u.btn_cancel.width-h)/2,u.btn_cancel.x=u.btn_ok.x+u.btn_ok.width+h,u.btn_ok.visible=u.btn_cancel.visible=!0}else 3==s&&(h=96,u.btn_cancel.x=(u.width-u.btn_ok.width-u.btn_cancel.width-h)/2,u.btn_ok.x=u.btn_cancel.x+u.btn_cancel.width+h,u.btn_ok.visible=u.btn_cancel.visible=!0);u.parent||(eq.panelLayer.once("MASK_CLOSE",u,u.onClick),eq.panelLayer.open(u,!1,!0),u.stage&&u.stage.on("resize",u,u._$8_onResize),u._$8_onResize())},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.common._AlertUI._$SET_ins),t._inst=null,t.BTN_CANCEL=0,t.BTN_OK=1,t.BTN_OKCANCEL=2,t.BTN_CANCELOK=3}(),function(e){function r(){this.paoContent=null,r.__super.call(this)}b(r,"modules.broadcast.views.DialogueView",e);var t=r.prototype;return t.setContents=function(){this.content.innerHTML=this.paoContent},t.onRemove=function(e){var t=r.paoContentViewArr.indexOf(this);-1<t&&r.paoContentViewArr.splice(t),ui.ViewBase.prototype.onRemove.call(this,e)},p(0,t,"width",e.prototype._$get_width,function(e){G.superSet(qo,this,"width",e),this.content.width=e-2*this.content.x}),p(0,t,"height",e.prototype._$get_height,function(e){G.superSet(qo,this,"height",e),this.content.height=e-2*this.content.y}),r.addShow=function(e,t,i,n,s,o){var a;switch(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===o&&(o=1),(a=new r).content.innerHTML=e,null!=t?t.addChild(a):G.stage.addChild(a),a.pos(i,n),s&&(a.width=2*a.content.x+a.content.contextWidth,a.height=2*a.content.y+a.content.contextHeight-a.content.leading),a.corner.bottom=NaN,a.corner.right=NaN,a.corner.left=NaN,o){case 1:a.corner.y=7,a.corner.right=20,a.corner.rotation=-90,a.corner.scaleY=1;break;case 2:a.corner.y=7,a.corner.centerX=0,a.corner.rotation=-90,a.corner.scaleY=1;break;case 3:a.corner.bottom=26,a.corner.right=20,a.corner.rotation=90,a.corner.scaleY=-1;break;case 4:a.corner.right=-10,a.corner.centerY=0,a.corner.rotation=0,a.corner.scaleY=1;break;case 5:a.corner.rotation=180,a.corner.centerY=8,a.corner.scaleY=1,a.corner.left=7;break;case 6:a.corner.bottom=26,a.corner.centerX=0,a.corner.rotation=90,a.corner.scaleY=-1}return a.paoContent=e,-1==r.paoContentViewArr.indexOf(a)&&r.paoContentViewArr.push(a),a},r.reSetContents=function(){for(var e=0;e<r.paoContentViewArr.length;e++)r.paoContentViewArr[e].setContents()},r.paoContentViewArr=[],r}(qo)),tJ=function(e){function n(){var e=this;e._faceUI=null,e._infoUI=null,e.selectBtn=null,e.sendHelper=null,e._lastT=NaN,e._lastgT=NaN,e.btnArr=null,e.kk=0,e.ttt=[],n.__super.call(e),e.initUI(),(n._ins=e).sendHelper=QB.ins.sendHelper}b(n,"modules.chat.views.ChatUI",e);var t=n.prototype;return t.createChildren=function(){e.prototype.createChildren.call(this)},t.setChannel=function(){var e=this;e.btnArr=[e.btn_c_all,e.btn_c_world,e.btn_c_cross,e.btn_c_guild,e.btn_c_sys,e.btn_c_own],QB.noralArr=[e.btn_c_all,e.btn_c_world,e.btn_c_guild,e.btn_c_sys],QB.kuafuArr=[e.btn_c_all,e.btn_c_world,e.btn_c_cross,e.btn_c_guild,e.btn_c_sys],GR.getInstance().checkModuleOpen(68)?QB.defaultArr=QB.kuafuArr:QB.defaultArr=QB.noralArr},t.changeChatUI=function(){for(var e=0,t=0;t<this.btnArr.length;t++){var i=this.btnArr[t];if(i)0<=QB.defaultArr.indexOf(i)?(i.x=n.posxArr[e],e++,i.visible=!0):i.visible=!1}},t.destroy=function(e){void 0===e&&(e=!0),this._infoUI&&this._infoUI.parent==this&&this.removeChild(this._infoUI),this._faceUI.removeSelf(),laya.ui.View.prototype.destroy.call(this,e),this._faceUI=null,this._infoUI=null},t.initUI=function(){var e=this;e._infoUI=Ej.ins,e.btn_face.clickHandler=ql.create(e,e.onFace,null,!1),e.btn_send.clickHandler=ql.create(e,e.onSend,null,!1),e.btn_close.clickHandler=ql.create(e,e.onExit,null,!1),e.input_text.maxChars=40,e.input_text.on("enter",e,e.onSend),e.input_text.on("input",e,e.onInput),e.input_text.on("focus",e,e.onFocusChange),e.input_text.on("blur",e,e.onFocusChange),e.bottom=0,e.setChannel(),e.changeChatUI(),e.btn_c_all.clickHandler=ql.create(e,e.onChannel,[e.btn_c_all],!1),e.btn_c_world.clickHandler=ql.create(e,e.onChannel,[e.btn_c_world],!1),e.btn_c_guild.clickHandler=ql.create(e,e.onChannel,[e.btn_c_guild],!1),e.btn_c_sys.clickHandler=ql.create(e,e.onChannel,[e.btn_c_sys],!1),e.btn_c_own.clickHandler=ql.create(e,e.onChannel,[e.btn_c_own],!1),e.btn_c_cross.clickHandler=ql.create(e,e.onChannel,[e.btn_c_cross],!1),e.btn_c_own.showTip=!1,e.selectBtn=e.btn_c_all,e.selectBtn.mouseEnabled=!1,e.link_guild.visible=!1,e.link_guild.on("click",e,e.onAddGuild),e.on("click",e,e.onClick)},t.onAddGuild=function(){var e=$e.getIndex(14),t=parseInt($e.MODEL.value(e));gR.ins.lv<t?zB.ins.showById2(2117,[t],1):hN.ins.open("GUILD_LIST_VIEW")},t.onFocusChange=function(){0!=this.input_text.editable&&(this.promtUpdate(),v_.isConchApp||pt.onMobile)},t.updatePos=function(){this.input_text.focus?this.bottom=80:this.bottom=0},t.promtUpdate=function(){this.input_text.text&&0<this.input_text.text.length&&"own"!=this.selectBtn.name?this.txt_desc.visible=!1:this.input_text.focus&&"own"!=this.selectBtn.name?this.txt_desc.visible=!1:this.txt_desc.visible=!0},t.onChannel=function(e){var t=this;if(t.selectBtn.mouseEnabled=!0,t.selectBtn.selected=!1,t.selectBtn=e,t.selectBtn.mouseEnabled=!1,t.input_text.editable=!0,t.btn_send.disabled=!1,t.btn_face.disabled=!1,t.link_guild.visible=!1,t.btn_send.visible=!0,t.btn_face.visible=!0,"all"==e.name)t.txt_desc.changeText(RP.n[752]),QB.ins.changeChannel(0),t.input_text.width=528,t.input_text.x=6;else if("world"==e.name)t.txt_desc.changeText(RP.n[752]),QB.ins.changeChannel(1),t.input_text.width=528,t.input_text.x=6;else if("guild"==e.name)QB.ins.changeChannel(2),t.guildUpdate(),t.input_text.width=528,t.input_text.x=6;else if("cross"==e.name)QB.ins.changeChannel(5),t.guildUpdate(),t.input_text.width=528,t.input_text.x=6,t.txt_desc.changeText(RP.n[752]);else if("sys"==e.name)t.input_text.text="",t.txt_desc.changeText(RP.n[755]),t.input_text.editable=!1,t.btn_send.visible=!1,t.btn_face.visible=!1,QB.ins.changeChannel(3),t.input_text.width=528,t.input_text.x=6;else if("own"==e.name){var i=QB.ins.playName;""==i?(t.txt_desc.changeText(RP.n[756]),t.input_text.editable=!1):(t.txt_desc.changeText("对"+i+"说："),t.input_text.editable=!0,t.input_text.width=528-(40+20*i.length),t.input_text.x=75+20*i.length),t.btn_c_own.showTip=!1,QB.ins.changeChannel(4)}t.promtUpdate(),t._infoUI.lock=!1},t.guildUpdate=function(){var e=this;2==QB.ins.curChannel&&(gR.ins.guildId?(e.txt_desc.changeText(RP.n[752]),e.input_text.editable=!0,e.btn_send.disabled=!1,e.btn_face.disabled=!1,e.link_guild.visible=!1):(e.txt_desc.changeText(RP.n[758]),e.link_guild.visible=!0,e.addChild(e.link_guild),e.input_text.text="",e.input_text.editable=!1,e.btn_send.disabled=!0,e.btn_face.disabled=!0))},t.onSelect=function(e){var t=this,i="[#"+(t.facePanel.list_face.selectedIndex+1)+"]";if(40<t.input_text.text.length+i.length)zB.ins.showById(2095,1);else{var n=ac.getCursorPos(t.input_text);if(-1!=n){var s=t.input_text.text;t.input_text.changeText(s.substring(0,n)+i+s.substring(n)),QB.ins.sendHelper.content=t.input_text.text,n+=i.length}else t.input_text.text+=i,QB.ins.sendHelper.content=t.input_text.text,n=t.input_text.text.length;ac.setCursorPos(t.input_text,n)}},t.onExit=function(){this._faceUI&&this._faceUI.list_face.off("click",this,this.onSelect),this._faceUI&&this.removeChild(this._faceUI),this._faceUI=null,hN.ins.close("CHAT")},t.onClick=function(e){this._faceUI&&this._faceUI.visible&&e.target!=this.btn_face&&(this._faceUI.visible=!1)},t.toPriChat=function(){this.btn_c_own.selected=!0,this.onChannel(this.btn_c_own)},t.onSend=function(){var e=this;if(""!=e.input_text.text){if(hr.isDebug){if("?pixel"==e.input_text.text)return void xs.fullPixel();if("?jgsldshnb"==e.input_text.text)return iJ.ins.show(),e.sendHelper.clear(),e.input_text.text="",e.input_text.maxChars=500,e.promtUpdate(),QB.ins.sendChat("debug",1),void(QB.ins.isDebug=!0);if("?fit_t"==e.input_text.text)return $a.ins.show(),void(e.input_text.text="");if(".w"==e.input_text.text&&G.timer.frameLoop(100,qH.Ins(),qH.Ins().clearDirTextureHash),".l"==e.input_text.text){var t=jt.MODEL.attrs(1150);aa.formatAttrToChineseByList(t)}if(".1"==e.input_text.text&&sH.skillState(NF.mainChar,7,4),".2"==e.input_text.text&&sH.skillState(NF.mainChar,7,0),".3"==e.input_text.text){var i=mj.GetNew();return i.reset(),i.renderInSelf=!0,i.id="taskTrackjm1080",i.setXY(200,0),i.loadEffect("jn10595"),void e.addChild(i)}if(".vv"==e.input_text.text)return QB.ins.pushMsg("0237"+v_.isConchApp,1),void gp.show(130,0);if(".d"==e.input_text.text)return void(Es.WebGLTextCacheCount=200);if("..version"==e.input_text.text)return void QB.ins.pushMsg("version:"+hr.version+",appversion:"+hr.appVersion+",mainFile:"+hr.mainFile,1);if("..device"==e.input_text.text){var n="";return n+="imei:"+hr.IMEI,n+=" appid:"+hr.appid,void QB.ins.pushMsg(n,1)}if(".hmjj"==e.input_text.text)return vt.isShowLog=!vt.isShowLog,void QB.ins.pushMsg(RP.n[759]+vt.isShowLog,1);if(".hm"==e.input_text.text)return void Ka.ins.show();if(".hh."==e.input_text.text){hr.clickbosaidong="1";var s="["+hr.serverID+","+hr.serverName+","+hr.uid+","+gR.ins.charName+"]";return void nr.log("LogError:"+s+" dd",0,!0)}if(".dd"==e.input_text.text){var o="cW="+pt.clientWidth+" cH="+pt.clientHeight;return o+=" w="+pt.width+" h="+pt.height,o+=" sw="+G.stage.width+" sh="+G.stage.height,o+=" onA="+pt.onAndroid+" cApp="+v_.isConchApp,o+=" p="+pt.pixelRatio,o+=" isX="+EB.isAndroidX,void QB.ins.pushMsg(o,1)}}var a=BB.getTimer(),r=5e3,l=e._lastT;if(2==QB.ins.curChannel&&(r=3e3,l=e._lastgT),QB.ins.isDebug&&(l=0),l&&a-l<r){var c=Math.ceil((r-a+l)/1e3);zB.ins.showById2(2093,[c],1)}else{2==QB.ins.curChannel?e._lastgT=a:e._lastT=a;var u=e.sendHelper.getEncodeStr();if(2==QB.ins.curChannel)QB.ins.sendChat(u,2);else if(5==QB.ins.curChannel)QB.ins.sendChat(u,7);else if(1==QB.ins.curChannel||0==QB.ins.curChannel)QB.ins.sendChat(u,1),Tu.sendToModule("do_chat",["modules.scene.SceneModule"],{chanType:1,data:u});else if(4==QB.ins.curChannel){var d=QB.ins.playID;QB.ins.sendChatforPritave(d,u,5)}e.sendHelper.clear(),e.input_text.text="",e.promtUpdate()}}},t.textttttt=function(){var e=zB.ins.getDesc(3997)+2e3*Math.random();zB.ins.playNoticeMsg(e,!0,!0)},t.tttt=function(){this.ttt.length;for(var e=Math.floor(20*Math.random()),t="",i=0;i<e;i++){var n=Math.floor(Math.random()*this.ttt.length);t+=this.ttt[n]}QB.ins.sendChat(t,1)},t.onInput=function(){this.sendHelper.content=this.input_text.text},t.updateInput=function(){this.input_text.changeText(this.sendHelper.content),ac.setCursorPos(this.input_text,this.input_text.text.length),this.promtUpdate()},t.onFace=function(){var e=this.facePanel;e.visible=!e.visible},t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t),sJ.ins.hideCompoment("ChatSimpleUI"),t._infoUI.lock=!1,t.selectBtn.mouseEnabled=!0,t.selectBtn.selected=!1,t.selectBtn=t.btn_c_all,t.selectBtn.mouseEnabled=!1,t.selectBtn.selected=!0,t.input_text.editable=!0,t.btn_send.disabled=!1,t.btn_face.disabled=!1,t.link_guild.visible=!1,QB.ins.changeChannel(0),t._infoUI.x=30,t._infoUI.y=20,t._infoUI.width=t.width-100,t._infoUI.height=t.height-148,t._infoUI.refresh(),t._infoUI.vScrollBar.value=t._infoUI.vScrollBar.max,t.addChild(t._infoUI),t.addChild(t.btn_close),t.input_text.changeText(t.sendHelper.content),t.onFocusChange(),t.promtUpdate()},t.onResize=function(){ui.ViewBase.prototype.onResize.call(this),this.width=G.stage.width,800<this.width&&(this.width=800),this._infoUI.parent==this&&(this._infoUI.width=this.width-160)},p(0,t,"facePanel",function(){var e=this;return e._faceUI||(e._faceUI=new bW,e._faceUI.bottom=70,e._faceUI.right=10,e.addChild(e._faceUI),e._faceUI.visible=!1,e._faceUI.list_face.on("click",e,e.onSelect)),e._faceUI}),p(1,n,"ins",function(){return n._ins=n._ins||new n},layouts.chat.ChatBaseUI._$SET_ins),n.maxChar=40,n.posy=465,n._ins=null,f(n,["posxArr",function(){return this.posxArr=[7,151,293,435,577]}]),n}(as),iJ=function(e){function t(){var e=this;e._totH=0,e._isLog=!1,e._tf=null,e._tf2=null,e.isAtlasToolsShow=!1,e.logTF,t.__super.call(e),e.panel_div.vScrollBarSkin="",e.panel_div.vScrollBar.isVertical=!0,e.panel_div.vScrollBar.elasticDistance=200,e.btn_close.on("click",e,e.close),e.btn_send.on("click",e,e.onSend),e.input_text.on("enter",e,e.onSend),e._tf=new zp,e._tf.pos(0,e._totH),e._tf.fontSize=24,e._tf.color="#fff9e0",e._tf.on("link",e,e.onLink),e._tf.leading=8,e._tf.width=e.panel_div.width,e._tf.height=e.panel_div.height,e.panel_div.addChild(e._tf),e._tf2=new zp,e._tf2.fontSize=20,e._tf2.color="#00ff00",e._tf2.width=300,e._tf2.height=60,e._tf2.x=10,e._tf2.y=4,e.addChild(e._tf2),e._tf2.mouseEnabled=!1,e.initCmd()}b(t,"modules.chat.views.gm.GMHelp",er);var i=t.prototype;return i.loop=function(){0!=this.displayedInStage&&(this._tf2.text=RP.n[760]+Jp.getCNDHMS(parseInt((BB.getTimer()/1e3).toString())))},i.initCmd=function(){var e=this;e.createCmdTip(Ql.createColor(RP.n[761],"#01b527"),"",!1),e.createCmdTip(Ql.createColor(RP.n[762],"#01b527"),"?help"),e.createCmdTip(Ql.createColor(RP.n[763],"#01b527"),"debug"),e.createCmdTip(Ql.createColor(RP.n[764],"#01b527"),"debugtool"),e.createCmdTip(Ql.createColor(RP.n[765],"#01b527"),RP.n[766]),e.createCmdTip(Ql.createColor(RP.n[767],"#01b527"),RP.n[768]),e.createCmdTip(Ql.createColor(RP.n[769],"#01b527"),"log"),e.createCmdTip(Ql.createColor(RP.n[770],"#01b527"),"logNarmal"),e.createCmdTip(Ql.createColor(RP.n[771],"#01b527"),RP.n[772]),e.createCmdTip(Ql.createColor(RP.n[773],"#01b527"),RP.n[774]),e.createCmdTip(Ql.createColor(RP.n[775],"#01b527"),RP.n[776]),e.createCmdTip(Ql.createColor(RP.n[777],"#01b527"),RP.n[778]),e.createCmdTip(Ql.createColor(RP.n[779],"#01b527"),RP.n[780]),e.createCmdTip(Ql.createColor(RP.n[781],"#01b527"),"screen"),e.createCmdTip(Ql.createColor("-----------------------------------------------------","#01b527"),"",!1),("666666"==hr.gid||"17"==hr.gid||"9"==hr.gid)&&(e.createCmdTip(RP.n[782],RP.n[783]),e.createCmdTip(RP.n[784],RP.n[785]),e.createCmdTip(RP.n[786],RP.n[787]),e.createCmdTip(RP.n[788],RP.n[789]),e.createCmdTip(RP.n[790],RP.n[791]),e.createCmdTip(RP.n[792],RP.n[793]),e.createCmdTip(RP.n[794],RP.n[795]),e.createCmdTip(RP.n[796],RP.n[797]),e.createCmdTip(RP.n[798],RP.n[799]),e.createCmdTip(RP.n[800],RP.n[801]),e.createCmdTip("加属性","attr set {MAXHP:1000000,DEF:1000000,ATK:100000000,UNION_DAM_INC_RATE_PVE:10000000}"),e.createCmdTip("加血量","attr set {MAXHP:9000000000,DEF:1000000,ATK:10,UNION_DAM_INC_RATE_PVE:10000000}"),e.createCmdTip(RP.n[802],RP.n[803]),e.createCmdTip(RP.n[804],RP.n[805]),e.createCmdTip(RP.n[806],RP.n[807]),e.createCmdTip(RP.n[808],"rmb [num]"),e.createCmdTip(RP.n[809],RP.n[810]),e.createCmdTip(RP.n[811],RP.n[812]),e.createCmdTip(RP.n[813],RP.n[814]),e.createCmdTip(RP.n[815],RP.n[816]),e.createCmdTip(RP.n[817],"#mc"),e.createCmdTip(RP.n[818],"#weekcard"),e.createCmdTip(RP.n[819],RP.n[820]),e.createCmdTip(RP.n[821],RP.n[822]),e.createCmdTip(RP.n[823],RP.n[824]),e.createCmdTip(RP.n[825],RP.n[826]),e.createCmdTip(RP.n[827],RP.n[828]),e.createCmdTip(RP.n[829],RP.n[830]),e.createCmdTip(RP.n[831],RP.n[832]),e.createCmdTip(RP.n[833],RP.n[834]),e.createCmdTip(RP.n[835],"baye fund"),e.createCmdTip(RP.n[836],RP.n[837]),e.createCmdTip(RP.n[838],RP.n[839]),e.createCmdTip(RP.n[840],RP.n[841]),e.createCmdTip(RP.n[842],RP.n[843]),e.createCmdTip(RP.n[844],"speedUp4"),e.createCmdTip(RP.n[845],"sound"),e.createCmdTip(RP.n[846],RP.n[847]),e.createCmdTip(RP.n[848],RP.n[849]),e.createCmdTip(RP.n[850],RP.n[851]),e.createCmdTip("无敌攻","attr set {MAXHP:999999999,DEF:999999999,ATK:9999999999,UNION_DAM_INC_RATE_PVE:9999999999}"),e.createCmdTip(RP.n[852],RP.n[853]),e.createCmdTip(RP.n[854],RP.n[855]),e.createCmdTip(RP.n[856],RP.n[857]))},i.createCmdTip=function(e,t,i){void 0===i&&(i=!0),e+=i?Ql.createColorHerf(t,"#02b0e9",t):Ql.createColor(t,"#02b0e9"),this._tf.innerHTML&&0<this._tf.innerHTML.length?this._tf.innerHTML+=Ql.newline()+e:this._tf.innerHTML=e,this._tf.height=this._tf.textHeight},i.onLink=function(e){if(e&&0<e.length&&"0"!=e){if("debugtool"==(e=mp.trim(e)))return void gp.show(130,0);if("debugPlane"==e)return void Uo.init();if("AtlasTools"==e){var t=v_.isWebGL;return v_.isWebGL=!0,this.isAtlasToolsShow?(Ce.getInstance().end(),this.isAtlasToolsShow=!1):(Ce.getInstance().start(),this.isAtlasToolsShow=!0),void(v_.isWebGL=t)}if("log"==e)return void tr.ins.showLoadedMap(NP.log());if("sound"==e)return void console.log(UP.ins.print());if("logNarmal"==e)return void tr.ins.show();if("showSerTime"==e)return void QB.ins.pushMsg(RP.n[858]+Jp.getSTRYMDHM(dr.curServerTime),1);if("openServDay"==e)return void QB.ins.sendChat(e,1,1);if("openComServDay"==e)return void QB.ins.pushMsg(RP.n[859]+dr.getComServiceDay()+"天",1);if("speedUp4"==e)return G.timer.scale=4,BB.accSpeed=4,BB.defaultActSpeed=4,void(BB.actSpeed=4);if("finish flyup new"==e&&(gR.ins.actorFlyUpBosstask=1),"get flyupequip"==e){var i;for(var n in gR.ins.actorList){i=gR.ins.actorList[n];var s=AR.ins.getActorActivingMaxLevel(i);AR.ins.getActorUseLevel(i)==s&&s++,s=Math.max(1,s);var o,a=(i.job,v=s,void 0,AR.ins.lstEquips[v]);for(var r in a)o=a[r],QB.ins.sendChat("goods "+o.goodsId+" 1",1)}return}if("get flyupequipMAX"==e){var l,c,u,d;for(d in QB.ins.sendChat("flyLevel 12",1),QB.ins.sendChat("clean backpack",1),gR.ins.actorList){var h;for(h in l=gR.ins.actorList[d],l.job,p=7,void 0,g=AR.ins.lstEquips[p],c=g)u=c[h],QB.ins.sendChat("goods "+u.goodsId+" 1",1)}return void G.timer.once(2e3,null,function(){var e;for(e in gR.ins.actorList){var t;for(t in l=gR.ins.actorList[e],c=AR.ins.getBagSoaringEquips)(u=c[t])&&null==l.equips.getPart(u.position)&&bR.reqWear(l.id,u.uuId)}})}if("screen"==e&&QB.ins.pushMsg(RP.n[860]+pt.width+"*"+pt.height,1),!dr.isConchApp){if("packSpeedSlow"==e)return SF.GetIntance().setSlowPack(),void QB.ins.pushMsg(RP.n[861],1);if("packSpeedRecove"==e)return QB.ins.pushMsg(RP.n[862],1),void SF.GetIntance().recovePack()}if("#"==e.charAt(0)){var _=e.substring(1);return void QB.ins.sendChat(_,1)}if("@"==e.charAt(0)){var f=(_=e.substring(1)).split("#");return void this[f.shift()](f)}this.input_text.text=e}var p,g,v},i.onSend=function(){if(this.input_text.text&&0<this.input_text.text.length){var e=this.input_text.text;if(0<=e.indexOf("?jssdk")){var t=e.split(" ");return jP.sdk_cmd(t[1],t[2]),void(this.input_text.text="")}0<=this.input_text.text.indexOf("mission enter")&&NF.Ins().recordMainCharPosition(),QB.ins.sendChat(this.input_text.text,6,1),this.input_text.text=""}},i.show=function(){var e=this;e.parent||(QB.ins.sendChat("DEBUG",1),QB.ins.isDebug=!0,G.stage.addChild(e),e.stage&&e.stage.on("resize",e,e._$8_onResize),e._$8_onResize(),e.input_text.focus=!0,e.frame.on("mousedown",e,e.onMouseDown),e.loop())},i.onMouseDown=function(){this.frame.on("mouseup",this,this.onMouseUp),this.startDrag()},i.onMouseUp=function(){this.frame.off("mouseup",this,this.onMouseUp),this.stopDrag()},i._$8_onResize=function(){this.x=(G.stage.width-this.width)/2,this.y=(G.stage.height-this.height)/2-168},i.close=function(){this.parent&&(this.stage&&this.stage.off("resize",this,this._$8_onResize),this.parent.removeChild(this))},i.thunderEquip=function(e){for(var t=0|e[0],i=0;i<Bi.count;i++)if(Bi.MODEL.thunderStar(i)==t){var n="goods "+Bi.MODEL.key(i)+" "+(la.isBoth(Bi.MODEL.decoratePosition(i))?"2":"1");QB.ins.sendChat(n,1)}},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.chat.GMHelpUI._$SET_ins),t._inst=null,t}(),nJ=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(e,"modules.moLimitMission.views.MoLimitMissionMainView",t);var i=e.prototype;return i.onAdd=function(e){t.prototype.onAdd.call(this,e)},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/molimit/btn_tab_0.png","ui/layouts/molimit/btn_tab_1.png","ui/layouts/molimit/btn_tab_2.png"],e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1);for(var t,i=[],n=0;n<kN.getInstance().moLevelArr.length;n++)(t=new Object).cls=cZ,t.id=n,t.data=kN.getInstance().moLevelArr[n],i.push(t);e.vsc.registAll(i),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},i.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("molimit/xsrw_text_xsrw.png")),this.vsc.updateSelectedView(kN.getInstance().moLevelArr[parseInt(e)])},i.viewRefresh=function(e){void 0===e&&(e=-1),0<=this.vsc.selectedIndex?(this.vsc.selectedIndex=e,this.vsc.updateSelectedView(kN.getInstance().moLevelArr[this.vsc.selectedIndex])):this.vsc.updateSelectedView(kN.getInstance().moLevelArr[0]),this.callLater(this.updateItemEnabled)},i.checkTips=function(e){var t=parseInt(e),i=kN.getInstance().moLevelArr[t],n=1==kN.getInstance().checkChapterMissionAllFinished(t+1);return 0==t?n&&0==i.statue?3:kN.getInstance().checkSubLevelUnget(t+1)?3:0:1==kN.getInstance().checkChapterMissionAllFinished(t)?n&&0==i.statue?3:kN.getInstance().checkSubLevelUnget(t+1)?3:0:0},i.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.NAME="MoLimitMissionMainView",f(e,["TIPSARR",function(){return this.TIPSARR=[RP.n[863],RP.n[864],RP.n[865]]}]),e}(Ip),sJ=function(e){var s;function o(){var e=this;e._regHash=null,e._cmptHash=null,e._caseHash=null,e._hideHash=null,e._set=null,e.isExit=!1,e.navNamestoString=null,e._navHash=null,e.hideNamestoString,o._ins&&pt.window.alert(RP.n[867]),o.__super.call(e),e.init()}b(o,"modules.nav.views.NavMainView",Ip);var t=o.prototype;return t.regCompoment=function(e,t,i){void 0===i&&(i="mainframe");var n=this._regHash.take(e);n||(n=new s),n.name=e,n.cls=t,n.resPath=i,this._regHash.put(e,n)},t.setTop=function(e){var t=o.ins.getCompomentsByName(e);t&&t.parent&&0<this.numChildren&&this.setChildIndex(t,this.numChildren-1)},t.showCompoment=function(e){var t=this;if("Navheji"==e){var i=Pn.getIndex(parseInt(gR.ins.cId));Pn.MODEL.type(i);if(aB.instance.activedRingId<1)return}var n=this._regHash.take(e);if(n){var s;if("NavTopBar"==e&&1==this.isExit&&(s=this._cmptHash.take(e),this.removeChild(s),this._cmptHash.remove(e)),this._cmptHash.has(e)){var o=this._cmptHash.take(e);return o.visible=!0,void(o.show&&o.show())}var a=_r.getLayoutsPath(n.resPath);G.loader.getRes(a)?this.onLoaded(n.name):G.loader.load(a,ql.create(null,function(e){t.onLoaded(n.name)}))}else pt.window.alert("NavMainView showCompoment "+e+" not reg")},t.showCompoments=function(e){var t=[];for(var i in 2==e.length?(t=e[0],this.isExit=e[1]):(t=e,this.isExit=!1),this.hideNamestoString="",this._cmptHash.proto)-1==t.indexOf(i)&&(this.hideCompoment(i),this.hideNamestoString+=","+i);this.navNamestoString="";for(var n=0;n<t.length;n++)this.showCompoment(t[n]),this.navNamestoString+=","+t[n]},t.hideCompoment=function(e){var t,i=this._regHash.take(e);if(i&&G.loader.cancelLoadByUrl(_r.getLayoutsPath(i.resPath)),this._cmptHash.has(e)){t=this._cmptHash.remove(e);try{t&&t.hide()}catch(e){}"ChatSimpleUI"!=e?"NavHotupdate"!=e&&(this.removeChild(t),t&&t.removeSelf()):t.visible=!1}},t.hideCompoments=function(e){for(var t=0;t<e.length;t++)this.hideCompoment(e[t])},t.hideAllCompoments=function(){for(var e in this._cmptHash.proto)this._cmptHash.proto[e].visible=!1},t.showAllCompoments=function(){for(var e in this._cmptHash.proto)this._cmptHash.proto[e].visible=!0},t.getCompomentsByName=function(e){return this._navHash.take(e)},t.isOpen=function(e){return this._cmptHash.has(e)},t.notice=function(e,t){var i,n;for(var s in e)n=e[s],(i=this.getCompomentsByName(n))&&i.notice(t)},t.clearList=function(e){var t,i;for(var n in e)i=e[n],(t=this.getCompomentsByName(i))&&t.clearList()},t.removeAll=function(){var e;for(var t in this._cmptHash.proto)e=this._cmptHash.proto[t],this.hideCompoment(e.name)},t.onLoaded=function(e){var t,i=this,n=i._regHash.take(e);i._cmptHash.has(e)?t=i._cmptHash.take(e):(i._caseHash.has(e)?t=i._caseHash.take(e):(t=new n.cls,i._caseHash.put(e,t)),i._cmptHash.put(e,t),i._navHash.put(e,t));try{t.show()}catch(e){}if("NavCounterList"==e)t.parent||i.addChildAt(t,0);else if("ChatSimpleUI"==e)t.visible=!0,t.show(),t.parent||i.addChild(t),i.setTop(e),i.setTop("Navheji");else if("NavCheckPoint"==e||"Navheji"==e||0==i.numChildren)t.parent||i.addChild(t);else if("NavZhuiJi"==e)i.addChild(t),i.setTop("NavZhuiJi");else if("NavLimitZhuiJi"==e)i.addChild(t),i.setTop("NavLimitZhuiJi");else if("NavNewDailyEnter"==e){var s=o.ins.getCompomentsByName("NavNewDailyEnter");s&&0<i.numChildren&&(t.parent||i.addChild(t),i.setChildIndex(s,0))}else t.parent||i.addChildAt(t,1)},t.init=function(){var e=this;e.left=e.right=e.top=e.bottom=0,e.mouseEnabled=!0,e.mouseThrough=!0,e._regHash=new jl,e._cmptHash=new jl,e._caseHash=new jl,e._navHash=new jl,e._hideHash=new jl,G.stage.focus=e,G.stage.on("keydown",e,e.onKeyPress)},t.onKeyPress=function(e){"666666"!=hr.gid&&"17"!=hr.gid&&"9"!=hr.gid||36!=e.keyCode||(GB.has(_r.getLayoutsPath("chat"))?GB.hasLoaded(_r.getLayoutsPath("chat"))&&t():GB.retain(_r.getLayoutsPath("chat")).once("complete",this,t));function t(){iJ.ins.parent?iJ.ins.close():iJ.ins.show()}},p(1,o,"ins",function(){return o._ins||(o._ins=new o),o._ins},ui.SubPanel._$SET_ins),o.getExpPt=function(){var e=o.ins.getCompomentsByName("NavBottom");return e?e.getExpPt():null},o.getPowerEndPt=function(){var e=o.ins.getCompomentsByName("NavCheckPoint");return e?e.getPowerPt():null},o.getRingPt=function(){var e=o.ins.getCompomentsByName("NavBottom");return e?e.getRingPt():null},o._ins=null,o.__init$=function(){s=function(){function e(){this.name=null,this.cls=null,this.resPath=null}return b(e,""),e}()},o}(),oJ=function(i){function e(){this.vsc=null,this.openGovRangID=0,this.resList=[207],e.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(e,"modules.newDailyAct.view.NewDailyActMainView",i);var t=e.prototype;return t.initialize=function(){var i=this;this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/achievenew/yq_btn_gz.png","ui/layouts/achievenew/yq_btn_ww.png","ui/layouts/achievenew/yq_btn_wf.png"];this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.openGovRangID=parseInt($e.MODEL.value($e.getIndex(119))),this.vsc.registAll([{cls:WY,id:"0",grayTip:function(){var e=Qt.getIndex(i.openGovRangID),t=Qt.MODEL.ringName(e);zB.ins.showMsg("激活"+t+RP.n[451],1)},wait:hN.wait(hN.waitConfig(["OfficialResource","OfficialRewardResource","OfficialDailyResource","OfficialTaskResource"],["COfficialResource","COfficialRewardResource","COfficialDailyResource","COfficialTaskResource"]),hN.waitAtlas("achievenew"))},{cls:QY,id:"1",isHideBg:!0,grayTip:function(){var e=YP.instance.cfgLimitLevel,t=YP.instance.cfgOpenServerDay;gR.ins.lv<e?(zB.ins.showMsg(e+RP.n[869],1),UB.ins._playLevelNot()):dr.getOpenServiceDay()<t&&zB.ins.showMsg("开服后"+t+"天开放",1)},wait:hN.wait(hN.waitConfig(["PrestigeResource"],["CPrestigeResource"]),hN.waitAtlas("prestige"))},{cls:hJ,id:"2",isHideBg:!0}]),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1)},t.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},t.onAdd=function(e){i.prototype.onAdd.call(this,e),AN.reqRedPt(this.resList);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_GOV",[207],t),AN.ins.addListener("BTN_ACTIVE_E",[65],t),this.updateItemEnabled()},t.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_GOV"),AN.ins.removeListener("BTN_ACTIVE_E")},t.redPtUpdate=function(e,t){this.updateItemEnabled()},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.onSubChanged=function(e,t){var i="";switch(e){case"0":i="achievenew/cj_text_gz.png";break;case"2":i="digger/title_active.png";break;case"1":i="achievenew/ww_text_ww.png",YP.instance.checkRequestInfo()}this.setTitle(_r.getAtlasSubPath(i))},t.checkTips=function(e){if("0"==e){if(this.openGovRangID>aB.instance.activedRingId)return 1;if(AN.ins.getStateByBtnName("BTN_GOV"))return 3}else if("2"==e){if(AN.ins.getStateByCareList([65]))return 3}else if("1"==e&&0==YP.instance.openBool)return 1;return 0},e.NAME="NewDailyActMainView",e.TAB_INDEX_GOV="0",e.TAB_INDEX_PRESTIGE="1",e.TAB_INDEX_PLAY="2",e}(Ip),aJ=function(i){function e(){this.vsc=null,e.__super.call(this)}b(e,"modules.niepan.views.NiepanMainView",i);var t=e.prototype;return t.initialize=function(){this.size(720,1280),this.top=this.left=this.right=this.bottom=0,this.navList=["ui/layouts/niepan/yq_btn_npsl.png","ui/layouts/niepan/yq_btn_whzl.png"],this.vsc=new SB(this),this.vsc.registAll([{cls:qZ,id:1},{cls:XZ,id:2,isHideBg:!0,grayTip:function(){zB.ins.showMsg(zB.ins.getDesc(4852),1)}}]),this.vsc.invalid(),this.title=_r.getAtlasSubPath("niepan/np_text_np.png"),this.vsc.filterHandler=ql.create(this,this.onVscFilter,null,!1)},t.onSelectedView=function(e,t){},t.onVscFilter=function(e,t){if("1"==e){if(ON.ins.checkTask())return 3}else if("2"==e){var i=ON.ins.data31051;if(!i||i&&i.curRoleIndex<=0||1==ON.ins.getNowStatus())return 1;if(ON.ins.checkWuxingCost()||ON.ins.checkNiepan()||ON.ins.checkDailyAward())return 3}return 0},t.setSelectIndex=function(e){switch(e){case 1:break;case 2:this.vsc.selectedIndex=1}},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=new _P;Tu.sendToService(t),this.setTitle(this.title)},t.onRemove=function(e){i.prototype.onRemove.call(this,e)},t.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,i.prototype.destroy.call(this,e)},e}(Ip),rJ=function(e){function t(){this._tween=null,this._BAR_W=0,t.__super.call(this)}b(t,"modules.corssbattle.views.crossboss.CrossBossCaijiBar",Mo);var i=t.prototype;return i.notice=function(e){if(e)if(e.proto instanceof protos.crossBoss.toc_24034){var t=e.proto.caijiTime;tr.push(RP.n[870]+t/1e3+"s"),0<t&&(this._tween=Og.to(this.mc_bar,{scaleX:1},t,pa.linearIn,ql.create(this,this.caijiEnd))),this.html_proces.innerHTML=Ql.createColor("["+gR.ins.charName+"]","#02b0e9")+RP.n[871]}else e.proto instanceof protos.crossBoss.toc_25009&&(this._tween&&this._tween.clear(),sJ.ins.hideCompoment("CROSSBOSSCAIJIBAR"))},i.caijiEnd=function(){DN.instance.reqCaiJiEndInfo(),sJ.ins.hideCompoment("CROSSBOSSCAIJIBAR")},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._BAR_W=this.mc_bar.width,this.mc_bar.scaleX=0},i.destroy=function(e){void 0===e&&(e=!0),t.alertMsg=null,t.callback=null,laya.ui.View.prototype.destroy.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._tween&&this._tween.clear(),t.alertMsg=null,t.callback=null},t.NAME="CROSSBOSSCAIJIBAR",t.alertMsg=null,t.callback=null,t}(),lJ=function(e){function t(){t.__super.call(this)}b(t,"modules.corssbattle.views.crossboss.CrossBossResultView",Do);var i=t.prototype;return i.notice=function(e){e&&"string"==typeof e.proto&&this.playername.changeText(e.proto)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),G.timer.once(1e4,this,this.closethis)},i.closethis=function(){sJ.ins.hideCompoment("CROSSBOSSRESULTVIEW")},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clear(this,this.closethis)},t.NAME="CROSSBOSSRESULTVIEW",t}(),cJ=function(e){function t(){this.curBoss=null,this.countTime=0,t.__super.call(this)}b(t,"modules.corssbattle.views.crossboss.CrossBossTitle",Oo);var i=t.prototype;return i.notice=function(e){if("CROSSBOSSDEAD"==e.actionOrder){var t=new MO;Tu.sendToService(t)}else"30742"!=e.actionOrder&&"25011"!=e.actionOrder||this.showBossTime()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=new MO;Tu.sendToService(t),this.onBossTime()},i.onBossTime=function(){var e=this,t=BR.ins.curCopyId,i=YR.ins.crossBossData.copyList;if(!YR.ins.isBorn)for(var n=0;n<i.length;n++)if(t==i[n].copyId){e.curBoss=i[n];var s=rn.MODEL.name(rn.getIndex(t));0<i[n].serverId?e.battlename.changeText("S."+i[n].serverId+s):e.battlename.changeText(s),e.countTime=i[n].bossleftTime-dr.serverTimeSec,0<e.countTime?(e.titlebg.height=62,e.onResetTime(),0<e.countTime&&G.timer.loop(1e3,e,e.onResetTime)):(e.titlebg.height=33,e.battletime.changeText(""))}},i.showBossTime=function(){if(!this.curBoss||YR.ins.isBorn)return G.timer.clear(this,this.onResetTime),this.titlebg.height=33,void this.battletime.changeText("");this.onBossTime()},i.onResetTime=function(){this.battletime.changeText(RP.n[872]+Jp.getENTickMS(this.countTime)),this.countTime--,this.countTime<=0&&(G.timer.clear(this,this.onResetTime),this.titlebg.height=33,this.battletime.changeText(""))},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.curBoss=null},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clear(this,this.onResetTime)},t.NAME="CROSSBOSSTITLE",t}(),uJ=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=0,this.left=this.right=0}b(e,"modules.rank.views.RankMainView",t);var i=e.prototype;return i.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.vsc=new SB(this),this.vsc.registAll([{cls:l1,id:0,isHideBg:!0}]),this.title=_r.getTitlePath("phb_text__phb")},i.onSelectedView=function(e,t){},i.onVscFilter=function(e,t){return 0},i.onAdd=function(e){t.prototype.onAdd.call(this,e),this.layout.dragon_border.visible=!1},i.onRemove=function(e){t.prototype.onRemove.call(this,e),YP.instance.rankBack=!1},e}(Ip),dJ=function(e){function t(){this.date=null,t.__super.call(this)}b(t,"modules.digger.views.active.ActivityEntranceItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.date=wH.Ins().serverDate,this.btn_enter.on("click",this,this.onClickHandler),this.link_desc.on("click",this,this.onLinkHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_enter.off("click",this,this.onClickHandler),this.link_desc.off("click",this,this.onLinkHandler)},i.onLinkHandler=function(e){this.tag&&hN.ins.open("AE_EXPLAIN_VIEW",{desc:this.tag.rule})},i.onClickHandler=function(e){var t=this;if(ZN.isEnabledChangeScene()){if(t.tag){if(5==t.tag.type)return Tu.sendToModule("OPEN_WB_ENTER_PANEL",["modules.boss.BossModule"]),void hN.ins.close("NewDailyActMainView");if(6==t.tag.type){for(var i=un.getIndex(57),n=un.MODEL.openConditions(i),s=JSON.parse(n),o=!0,a=0;a<s.length;a++){var r,l=s[a];l.type&&(r=l.type.toLowerCase());var c=parseInt(l.value);if("serveropenday"==r)var u=parseInt(l.value);if("playerzhuanshenglevel"==r)var d=parseInt(l.value);switch(r){case"serveropenday":dr.getOpenServiceDay()<c&&(o=!1);break;case"playerzhuanshenglevel":gR.ins.zsLv<c&&(o=!1)}}return 0==o?void zB.ins.showMsg("开服第"+u+RP.n[873]+d+RP.n[874],1):(Tu.sendToModule("OPEN_FD_ENTER_PANEL",["modules.firedragon.FireDragonModule"]),void hN.ins.close("NewDailyActMainView"))}if(4!=t.tag.type){if(0<t.tag.flyLevel){if(t.tag.flyLevel>gR.ins.zsLv)return void zB.ins.showMsg("转生"+t.tag.level+RP.n[877]+t.tag.activeName,1)}else if(t.tag.level>gR.ins.lv)return void zB.ins.showMsg(t.tag.level+RP.n[878]+t.tag.activeName,1);0<t.tag.openServiceDay&&t.tag.openServiceDay>dr.getOpenServiceDay()?zB.ins.showById2(3536,[t.tag.openServiceDay],1):t.isInOpenWeek()&&t.isInOpenTime()?(hN.ins.close("NewDailyActMainView"),2==t.tag.type?CN.gotoYzbqcNpc():t.tag.missionId?jR.reqEntry(t.tag.missionId):t.tag.goEvent&&0<t.tag.goEvent.length&&Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],t.tag.goEvent)):4==t.tag.type?zB.ins.showMsg(RP.n[879],1):zB.ins.showMsg(t.tag.openDescribe+"活动",1)}else AN.ins.getStateByCareList([223])?hN.ins.open("GUILD_MNG_MAINVIEW",{_subIndex_:3}):gR.ins.lv<60?zB.ins.showMsg(RP.n[875],1):vN.ins.joinGuild?zB.ins.showMsg(RP.n[80],1):hN.ins.open("GUILD_LIST_VIEW")}}else zB.ins.showById(2126,1)},i.isInOpenWeek=function(){return!(1<=this.tag.openWeek.length&&-1==this.tag.openWeek.indexOf(this.date.getDay()))},i.isInOpenTime=function(){var e=this;if(""!=e.tag.openTime){var t=new Date(e.date.getFullYear(),e.date.getMonth(),e.date.getDate(),parseInt(e.tag.openTime.substr(0,2)),parseInt(e.tag.openTime.substr(3,2)),0).getTime(),i=new Date(e.date.getFullYear(),e.date.getMonth(),e.date.getDate(),parseInt(e.tag.openTime.substr(6,2)),parseInt(e.tag.openTime.substr(9,2)),0).getTime();if(!(dr.curServerTime>=t&&dr.curServerTime<=i))return!1}return!0},i.isHasRedPot=function(){var e=this;if(4==e.tag.type)return AN.ins.getStateByCareList([223]);if(5==e.tag.type)return AN.ins.getStateByCareList([243]);if(1==e.tag.type)return AN.ins.getStateByCareList([250]);if(2==e.tag.type)return AN.ins.getStateByCareList([249]);if(6==e.tag.type)return AN.ins.getStateByCareList([258]);if(0<e.tag.openServiceDay&&dr.getOpenServiceDay()<e.tag.openServiceDay)return!1;if(0<e.tag.flyLevel){if(e.tag.flyLevel>gR.ins.zsLv)return!1}else if(e.tag.level>gR.ins.lv)return!1;return!(!e.isInOpenWeek()||!e.isInOpenTime())},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t.tag=e,t.txt_time.changeText(t.tag.openDescribe),t.g_bg.right=0,t.g_bg.width=xs.getTextWidth(t.tag.openDescribe)+50,t.img_bg_0.skin=_r.getAEPath("ae_bg_"+t.tag.type+"_0"),t.img_bg_1.skin=_r.getAEPath("ae_bg_"+t.tag.type+"_1"),t.btn_enter.showTip=t.isHasRedPot())}),t}(Zv),hJ=function(e){function t(){this._array=null,t.__super.call(this)}b(t,"modules.digger.views.active.ActivityEntranceView",Kv);var i=t.prototype;return i.initialize=function(){this.list.itemRender=dJ,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this._array=[];for(var e=0,t=bt.count;e<t;e++)this._array.push({key:bt.MODEL.key(e),type:bt.MODEL.type(e),missionId:bt.MODEL.missionId(e),activeName:bt.MODEL.activeName(e),level:bt.MODEL.level(e),flyLevel:bt.MODEL.flyLevel(e),openServiceDay:bt.MODEL.openServiceDay(e),openWeek:bt.MODEL.openWeek(e),openTime:bt.MODEL.openTime(e),goEvent:bt.MODEL.goEvent(e),openDescribe:bt.MODEL.openDescribe(e),instruction:bt.MODEL.instruction(e),rule:bt.MODEL.rule(e)})},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.list.array=this._array,AN.reqRedPt([223,243,250,249,258]),AN.ins.addListener("AE_UI_UPDATE",[65,223,243,258],ql.create(this,this.updateItemsUI))},i.updateItemsUI=function(){this.list.array=this._array},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),AN.ins.removeListener("AE_UI_UPDATE")},i.destroy=function(e){void 0===e&&(e=!0),this.wanfabg&&this.wanfabg.skin&&G.loader.clearRes(this.wanfabg.skin),laya.ui.View.prototype.destroy.call(this,e)},t}(),_J=function(e){function t(){t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_ProfitView",Wv);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),G.stage.on("click",this,this.onClickHanlder),QR.reqBubbleProfit()},i.onRemove=function(e){G.stage.off("click",this,this.onClickHanlder),ui.ViewBase.prototype.onRemove.call(this,e)},i.update=function(e){if(e){this.txt_area.innerHTML=Ql.createColor(QR.curRate+"","#23b11f")+"倍区",this.txt_total.innerHTML="经验"+Ql.createColor(e.exp+"","#23b11f")+RP.n[880]+Ql.createColor(e.prestige+"","#23b11f");for(var t=ri.getIndex(QR.curRate),i=JSON.parse(ri.MODEL.rewardArray(t)),n="",s=0;s<i.length;s++){var o=aR.getMoneyItems(i[s].value);35==o[0].itemId?n+=aR.PRESTIGE.name+Ql.createColor(o[0].itemNum+"","#23b11f"):4==o[0].itemId&&(n+=aR.EXP.name+Ql.createColor(o[0].itemNum+"","#23b11f")),n+=RP.n[881]}this.txt_current.innerHTML=n}},i.onClickHanlder=function(e){hN.ins.close("AE_BUBBLE_PROFIT_VIEW")},t}(),fJ=function(e){function t(){this.itemList=null,this._alpha=[1,.6,.3,.3,1],t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_RankItem",e);var i=t.prototype;return i.initialize=function(){var e;this.itemList=this.itemList||[];for(var t=0;t<2;t++)(e=new MF).pos(350+79*t,7),e.size(74,74),e.toolTipEnabled=!1,this.addChild(e),this.itemList.push(e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.g_rank.visible=this.txt_rank.visible=!1},i.getColors=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386"}return"#90877b"},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.img_bg.visible=!1,t.g_rank.visible=e.rank<=3,t.txt_rank.visible=3<e.rank,t.txt_name.changeText(e.playerName),t.g_rank.visible?t.g_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+e.rank+".png"):t.txt_rank.changeText(e.rank),""!=e.guildName?t.txt_guild.changeText(e.guildName):t.txt_guild.changeText("无");var i,n=0;0<e.prestige&&((i=yB.create(35,e.prestige)).disAchi=!1,t.itemList[n].bindData=i,n++),0<e.exp&&((i=yB.create(4,e.exp)).disAchi=!1,t.itemList[n].bindData=i,n++);for(var s=0;s<2;s++)t.itemList[s].visible=s<n;t.txt_name.color=t.getColors(e.rank),t.txt_guild.color=t.getColors(e.rank)}}),t}(Yv),pJ=function(e){function t(){this.cd=NaN,this.itemList=null,t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_RankView",zv);var i=t.prototype;return i.initialize=function(){var e;this.list.itemRender=fJ,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.itemList=this.itemList||[];for(var t=0;t<2;t++)(e=new MF).pos(453+79*t,216),e.size(74,74),e.toolTipEnabled=!1,this.addChild(e),this.itemList.push(e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exit.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.btn_exit.off("click",this,this.onClickHandler),this.clearTimer(this,this.onTimer),ui.ViewBase.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.update=function(e){var t=this;if(e instanceof protos.digger.toc_30331){t.list.array=e.rankList,t.txt_prestige.innerHTML=RP.n[882],0<e.rank&&e.rank<=10?t.txt_rank.innerHTML=RP.n[883]+Ql.createColor(e.rank+"","#e6d80d"):t.txt_rank.innerHTML=RP.n[884]+Ql.createColor("未上榜","#e6d80d");var i,n=0;0<e.prestige&&((i=yB.create(35,e.prestige)).disAchi=!1,t.itemList[n].bindData=i,n++),0<e.exp&&((i=yB.create(4,e.exp)).disAchi=!1,t.itemList[n].bindData=i,n++);for(var s=0;s<2;s++)t.itemList[s].visible=s<n;t.cd=parseInt($e.MODEL.value($e.getIndex(95))),t.btn_exit.label="退出("+t.cd+"s)",t.timerLoop(1e3,t,t.onTimer)}},i.onTimer=function(){this.cd--,this.cd<=0?this.setExitCopy():this.btn_exit.label="退出("+this.cd+"s)"},i.onClickHandler=function(e){this.setExitCopy()},i.setExitCopy=function(){this.clearTimer(this,this.onTimer),BB.isShaozhu()||BR.ins.exitCopy(300),hN.ins.close("AE_BUBBLE_RANK_VIEW")},t}(),gJ=function(t){function e(){this.vsc=null,this._openSelectIndex=0,e.__super.call(this),this.top=this.bottom=this.left=this.right=0,this.init()}b(e,"modules.recharge.views.FirstRechargeMainV",t);var i=e.prototype;return i.init=function(){var e=this;e.centerX=e.centerY=0,e.size(720,1280),e.navList=["ui/layouts/recharge_s/yq_btn_scfl.png","ui/layouts/recharge_s/yq_btn_byhl.png"],e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:u1,id:"1",isHideBg:!0},{cls:c1,id:"2",isHideBg:!0}]),e.vsc.filterHandler=ql.create(e,e.checkRedPoint,null,!1)},i.onAdd=function(e){t.prototype.onAdd.call(this,e),this.vsc.invalid(),this.vsc&&(this.vsc.selectedIndex=this.openSelectIndex,this.vsc.updateSelectedView()),this.addListener()},i.onRemove=function(e){t.prototype.onRemove.call(this,e),this.openSelectIndex=0,this.vsc&&(this.vsc.selectedIndex=-1),AN.ins.removeListener("BTN_RECHARGE_0"),AN.ins.removeListener("BTN_RECHARGE_1")},i.showByVSC=function(e,t){this.addListener()},i.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},i.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},i.checkRedPoint=function(e){return"1"==e&&AN.ins.getStateByCareList([1003])?3:"2"==e&&AN.ins.getStateByCareList([1004])?3:0},i.onSubChanged=function(e,t){var i;switch(e){case"1":i=_r.getAtlasSubPath("recharge_s/cz_sc_title_sc.png");break;case"2":i=_r.getAtlasSubPath("recharge_s/byhl_title_byhl.png")}this.setTitle(i)},i.update=function(e){this.callLater(this.updateDo,e)},i.updateDo=function(e){this.vsc.invalid(),this.vsc.updateSelectedView(e)},i.addListener=function(){var e=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_RECHARGE_0",[1003],e),AN.ins.addListener("BTN_RECHARGE_1",[1004],e)},p(0,i,"openSelectIndex",function(){return this._openSelectIndex},function(e){this._openSelectIndex=e,this.vsc.selectedIndex=e}),e.SUB_RECHARGE="1",e.SUB_BAIYUAN="2",e}(Ip),vJ=function(e){function t(){this._id=0,this.curObj=null,this.cfun=null,t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_SceneItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_area.on("click",this,this.onClickHandler),this.img_select.visible=!1},i.onRemove=function(e){this.img_area.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.setHide=function(){this.txt_name.visible=this.txt_guild.visible=this.txt_no.visible=!1},i.update=function(){var e=this;if(e.setHide(),!QR.b_infoHash.take(e._id))return e.txt_no.visible=!0,void(e.curObj=null);e.curObj=QR.b_infoHash.take(e._id),e.txt_name.changeText(e.curObj.playerName),e.txt_name.visible=!0,""!=e.curObj.guildName?(e.txt_guild.changeText(e.curObj.guildName),e.txt_guild.visible=!0):e.txt_guild.visible=!1},i.selected=function(e){this.img_select.visible=e==this._id},i.onClickHandler=function(e){if(!this.curObj||""==this.curObj.playerName||this.curObj.playerName!=gR.ins.charName){Tu.sendToModule("UPDATE_BUBBLE_SELECT",["modules.digger.DiggerModule"],this._id);var t=ai.getIndex(this._id),i=ai.MODEL.gridScope(t).split(";"),n=i[Math.round(Math.random()*(i.length-1))].split(","),s=new Uh(80*parseInt(n[0]),40*parseInt(n[1]));QR.b_infoHash.take(this._id)?yH.Ins().mainCharMove(s,!0,ql.create(this,this.fightTarget)):yH.Ins().mainCharMove(s)}},i.fightTarget=function(){this.curObj&&sH.fights(this.curObj.objectId)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){this._id=parseInt(e),this.setHide();var t=ai.getIndex(this._id),i=ai.MODEL.rate(t);this.img_area.skin=_r.getAtlasSubPath("bubbleScene/ae_pd_"+i+".png")}}),t}(Qv),mJ=function(e){function t(){this.itemList=null,this.locX=[13,150,424,561,287],this._et=NaN,this._ret=NaN,t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_SceneView",Jv);var i=t.prototype;return i.initialize=function(){this.itemList=this.itemList||[];var e=0,t=[];for(e=0;e<ai.count;e++)1==ai.MODEL.onlyOwn(e)&&t.push(ai.MODEL.key(e));for(e=0;e<t.length;e++){var i=new vJ;i.pos(this.locX[e],3),i.dataSource=t[e],this.area_box.addChild(i),this.itemList.push(i)}},i.updateSelect=function(e){for(var t=0;t<this.itemList.length;t++)this.itemList[t]&&this.itemList[t].selected(e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_desc.on("click",t,t.onClickHandler),t.btn_exit.on("click",t,t.onClickHandler),t.img_curArea.on("click",t,t.onClickHandler);var i=wH.Ins().serverDate,n=$e.MODEL.value($e.getIndex(110)).split(","),s=new Date(i.getFullYear(),i.getMonth(),i.getDate(),parseInt(n[0]),parseInt(n[1]),0,0);t._et=s.getTime(),t.timerLoop(1e3,t,t.onTimer),t.onTimer()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_desc.off("click",t,t.onClickHandler),t.btn_exit.off("click",t,t.onClickHandler),t.img_curArea.off("click",t,t.onClickHandler),t.clearTimer(t,t.onTimer),t.clearTimer(t,t.onExitTimer)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.update=function(){for(var e=0;e<this.itemList.length;e++)this.itemList[e]&&this.itemList[e].update();this.img_curArea.skin=_r.getAtlasSubPath("bubbleScene/ae_pd_"+QR.curRate+".png")},i.onTimer=function(){var e=this._et-dr.curServerTime;if(e<=0)return this.event("end"),this.clearTimer(this,this.onTimer),this.txt_time.innerHTML=RP.n[499]+Ql.createColor("已结束","#ff2e24"),void this.resetExitTime();this.txt_time.innerHTML=RP.n[886]+Ql.createColor(Go.deltaFormat(e,"hh:mm:ss"),"#ff2e24")},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_desc:for(var t=0,i=0;i<bt.count;i++)if(bt.MODEL.type(i)==QR.AE_TYPE){t=i;break}hN.ins.open("AE_EXPLAIN_VIEW",{desc:bt.MODEL.rule(t)});break;case this.img_curArea:hN.ins.open("AE_BUBBLE_PROFIT_VIEW");break;case this.btn_exit:KQ.ins.show(RP.n[887]+parseInt($e.MODEL.value($e.getIndex(96)))+RP.n[888],ql.create(this,this.onAlertHandler),!1)}},i.onAlertHandler=function(e){1==e&&BR.ins.exitCopy(300)},i.resetExitTime=function(){hN.ins.isOpen("AE_BUBBLE_RANK_VIEW")||(this._ret=10,this.timerLoop(1e3,this,this.onExitTimer),this.onExitTimer())},i.onExitTimer=function(){if(!hN.ins.isOpen("AE_BUBBLE_RANK_VIEW"))return this._ret-dr.curServerTime<=0?(this.clearTimer(this,this.onExitTimer),void BR.ins.exitCopy(300)):void 0;this.clearTimer(this,this.onExitTimer)},t}(),yJ=function(e){function t(){this._playerArr=null,this.grid=null,t.__super.call(this),this.initUI()}b(t,"modules.field.views.FieldFightV",La);var i=t.prototype;return i.initUI=function(){var e=this;e.list_role.itemRender=SW,e.list_role.dataSource=[],e.list_role.vScrollBarSkin="",e.list_role.scrollBar.elasticBackTime=300,e.list_role.scrollBar.elasticDistance=100,e.btn_rank.on("click",e,e.onClick),e.txt_rank.on("click",e,e.onClick)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_rank.underline=!0;var i=new RL;Tu.sendToService(i),t.grid||(t.grid=new MF(46),t.grid.needEffect=!1,t.grid.needGridBg=!1,t.grid.pos(284,245),t.grid.bindData=yB.create(3),t.addChild(t.grid)),t.btn_share.on("click",t,t.onShare)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),G.timer.clear(t,t.onTimer),t.grid&&(t.grid.parent&&t.grid.parent.removeChild(t.grid),t.grid.destroy(),t.grid=null),t.btn_share.off("click",t,t.onShare)},i.onXundi=function(e,t){if(1==t){if(gR.ins.YB<e)return void KQ.ins.showNoGold();var i=new BL;Tu.sendToService(i)}},i.onClick=function(e){e.currentTarget==this.btn_rank?hN.ins.open("FIELD_RANK"):e.currentTarget==this.txt_rank&&(60<=gR.ins.lv?Tu.sendToModule("SWITCH_TAB_TYPE",["modules.rank.RankModule"],{value:7,backId:"SPORTS_MAIN_VIEW"}):zB.ins.playErrorMsg(RP.n[889]))},i.updateByVSC=function(e){var t=this;if(t.list_role.dataSource=[],ZB.ins.toc_field){var i=ZB.ins.toc_field;t.txt_pk.text=i.pkValue+"",0<i.rank?t.txt_paiming.text="("+i.rank+"名)":t.txt_paiming.text=RP.n[890],t.txt_paiming.x=t.txt_pk.x+t.txt_pk.textWidth+3;100<=i.yeZhanPk?(t.txt_pkvalue.text=i.yeZhanPk.toString()+"("+(i.yeZhanPk-99)+RP.n[891],t.txt_pkvalue.color="#ff0000"):(t.txt_pkvalue.text=i.yeZhanPk.toString(),t.txt_pkvalue.color="#23b11f");var n=ZB.ins.getRankResult(i.rank);t._playerArr=ZB.ins.playerArr,t._playerArr.length<4&&(1==t._playerArr.length&&11001==t._playerArr[0].playerId||(0<t._playerArr.length&&t._playerArr[t._playerArr.length-1].hasOwnProperty("refreshT")&&t._playerArr.splice(-1,1),t._playerArr.push({refreshT:i.refreshTime}))),t.list_role.dataSource=t._playerArr,t._playerArr.length<=0?t.txt_noPlayer_0.visible=t.txt_noPlayer_1.visible=!0:t.txt_noPlayer_0.visible=t.txt_noPlayer_1.visible=!1;var s=gR.ins.actorList[gR.ins.showId-1];t.img_head.skin=_r.getActorHeadPath(s.job,s.sex),t.img_head.scaleX=t.img_head.scaleY=1,t.img_head.x=10,n=ZB.ins.getRankResult(i.rank),t.txt_mc.text=n.soul,1e4<n.coin?t.txt_jb.text=(n.coin/1e4).toFixed(1)+"万":t.txt_jb.text=n.coin,t.btn_share.visible=jP.getCpShareSwitch(),t.img_red.visible=eR.ins.getRWT(2)<=0}},i.onListRender=function(e,t){},i.onWatch=function(e){},i.onTimer=function(e){dr.serverTimeSec},i.onShare=function(e){Tu.sendToModule("COPY_SHARE",["modules.activityDaily.DailyModule"],{id:2})},t.CHECK_POINT_STATUS=!0,t}(),IJ=function(e){function t(){t.__super.call(this),this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticBackTime=300,this.list_rank.scrollBar.elasticDistance=100,this.list_rank.spaceY=6;var e=[];e.length=_i.count,this.list_rank.array=e,this.list_rank.renderHandler=ql.create(this,this.onListRender,null,!1)}b(t,"modules.field.views._FieldRankV",gm);var i=t.prototype;return i.onListRender=function(e,t){var i=_i.MODEL.rankRange(t).split(","),n=parseInt(i[0]),s=parseInt(i[1]);e.img_r_1.visible=1==n,e.img_r_2.visible=2==n,e.img_r_3.visible=3==n,3<n?(e.txt_rank.visible=!0,e.txt_rank.text=n==s?""+n:n+"-"+s):e.txt_rank.visible=!1;for(var o=_i.MODEL.currencyValue(t),a=(_i.MODEL.goodsAward(t)+";15,"+o.split(":")[1]).split(";"),r=0;r<2;r++){var l=e["grid"+r];if(null==l&&((l=new MF(74)).font="20px SimHei",l.x=e["img_award"+r].x,l.y=e["img_award"+r].y,e.addChild(l),e["grid"+r]=l),r<a.length){l.visible=!0;var c=a[r].split(","),u=parseInt(c[0]),d=parseInt(c[1]),h=yB.create(u,d);l.bindData=h,e["txt_award"+r].changeText(Bi.MODEL.name(h.cfgIdx))}else l.visible=!1,e["txt_award"+r].changeText("")}},i.close=function(){hN.ins.close("FIELD_RANK")},i.onClick=function(e){e.target==this.btn_close&&this.close()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick);var t=new RL;Tu.sendToService(t)},i.update=function(){if(ZB.ins.toc_field){var e=ZB.ins.toc_field;0<e.rank?this.txt_rank.changeText(e.rank+""):this.txt_rank.changeText("未上榜")}},t}(),bJ=function(e){function t(){var e=this;e._msk=null,e._cb=null,t.__super.call(e),e.centerX=0,e.y=140,e._msk=new Ss,e._msk.width=G.stage.width,e._msk.height=G.stage.height,e._msk.graphics.drawRect(0,0,G.stage.width,G.stage.height,"#000000"),e._msk.centerX=0,e._msk.y=-e.y,e._msk.alpha=0,e.addChildAt(e._msk,0)}b(t,"modules.fight.views.FightStartV",Oa);var i=t.prototype;return i.start=function(e,t){var i=this;void 0===e&&(e=0),i.stop(),0<e?(i.img_font0.skin=_r.getAtlasSubPath("fightstart/bag_text_tiao.png"),i.img_font1.skin=_r.getAtlasSubPath("fightstart/bag_text_zhan.png"),i.img_font1.x=90):(i.img_font0.skin=_r.getAtlasSubPath("fightstart/bag_text_zhan.png"),i.img_font1.skin=_r.getAtlasSubPath("fightstart/bag_text_dou.png"),i.img_font1.x=82),i._cb=t,i.spr_start.scaleX=i.spr_start.scaleY=1,i.spr_start.alpha=1,i.spr_start.visible=!1,i.spr_time.visible=!0,i.clip_num.index=2,i.spr_timeBg.alpha=1,Og.to(i._msk,{alpha:.6},250),i.playNum()},i.stop=function(){this._cb=null,Og.clearAll(this._msk),Og.clearAll(this.clip_num),Og.clearAll(this.spr_timeBg),Og.clearAll(this.spr_text),Og.clearAll(this.spr_startBg),Og.clearAll(this.spr_light),Og.clearAll(this.spr_start),this._msk.alpha=0},i.playNum=function(){this.clip_num.scaleX=this.clip_num.scaleY=1,this.clip_num.alpha=0,this.spr_timeBg.alpha=0,this.spr_timeBg.scaleX=this.spr_timeBg.scaleY=1,Og.to(this.clip_num,{scaleX:2,scaleY:2,alpha:1},100,null,ql.create(this,this.playNum1))},i.playNum1=function(){Og.to(this.clip_num,{scaleX:.5,scaleY:.5},150,null,ql.create(this,this.playNum2))},i.playNum2=function(){Og.to(this.clip_num,{scaleX:1,scaleY:1},250),Og.to(this.spr_timeBg,{alpha:1,scaleX:1.2,scaleY:1.2},250,null,ql.create(this,this.playNum3))},i.playNum3=function(){Og.to(this.spr_timeBg,{alpha:0},250,null,ql.create(this,this.playNumEnd))},i.playNumEnd=function(){0<this.clip_num.index?(this.clip_num.index--,this.playNum()):this.playText()},i.playText=function(){var e=this;e.spr_start.visible=!0,e.spr_time.visible=!1,e.spr_text.scaleX=e.spr_text.scaleY=1,e.spr_text.alpha=0,Og.to(e.spr_text,{scaleX:2,scaleY:2,alpha:1},100,null,ql.create(e,e.playText1)),e.spr_startBg.scaleX=e.spr_startBg.scaleY=.5,Og.to(e.spr_startBg,{scaleX:1,scaleY:1},250),e.spr_light.visible=!1,e.spr_light.scaleX=e.spr_light.scaleY=.5},i.playText1=function(){Og.to(this.spr_text,{scaleX:.5,scaleY:.5},150,null,ql.create(this,this.playText2))},i.playText2=function(){this.spr_light.visible=!0,Og.to(this.spr_light,{scaleX:1,scaleY:1},250),Og.to(this.spr_text,{scaleX:1,scaleY:1},250,null,ql.create(this,this.playText3))},i.playText3=function(){G.timer.once(250,this,this.playTextEnd)},i.playTextEnd=function(){Og.to(this.spr_start,{scaleX:1.4,alpha:0},100,null,ql.create(this,this.playTextEnd2))},i.playTextEnd2=function(){Og.to(this._msk,{alpha:0},250,null,ql.create(this,this.playEnd))},i.playEnd=function(){hN.ins._closePanelForce(this),this._cb&&this._cb.run(),this._cb=null},t}(),wJ=function(e){function t(){var e=this;e._callback=null,e._grids=null,e._time=0,e._materialShow=null,e._ganTanImg=null,e.cateCount=0,t.__super.call(e),e._grids=new wj(3,4,116,10,30,!0,null,10),e._grids.isCenter=!0,e._grids.pos(114,370),e.addChild(e._grids)}b(t,"modules.fight.views.result.FightSuccessView",Ra);var i=t.prototype;return i.update=function(e,t,i){var n=this;n.cateCount=i;var s,o,a=[],r=[],l=[],c=[],u=[],d=[],h=[],_=[],f=[],p=[],g={},v=0,m=0;for(var y in e)if((o=e[y])instanceof protos.backpack.DtoGoods)_.push(o);else if(v=o.modelId,m=o.count,s=g[v])s.goodsNum+=m;else switch((s=yB.create(v,m)).subType){case 16:a.push(s);break;case 3:r.push(s);break;case 15:l.push(s);break;case 9:c.push(s);break;case 12:u.push(s);break;case 17:d.push(s);break;case 11:h.push(s);break;case 10:f.push(s);break;case 33:p.push(s);break;default:_.push(s)}var I=a.concat(r).concat(l).concat(c).concat(u).concat(d).concat(h).concat(p).concat(_).concat(f);switch(n._grids.gridDatas=I,n._grids.vScrollBar.value=1,tr.push("run FightSuccessView update,cate:"+i),n._callback=t,n._time=6,G.timer.loop(1e3,n,n.onTime),n.onTime(),n.addChildAt(n.xiala,n.numChildren-1),n.xiala.visible=12<I.length,n._grids.x=n.width-n._grids.contentW>>1,i){case 1:if(null==n._materialShow){n._materialShow=new Xl,n._materialShow.fontSize=22,n._materialShow.font=dr.font,n._materialShow.align="center",n._materialShow.color="#90877b",n.addChild(n._materialShow),n._materialShow.pos(0,810),n._materialShow.contextWidth,n._materialShow.width=n.width,n._materialShow.height=30;var b="",w=ei.getIndex(4220);b+=Ql.createColor(ei.MODEL.content(w),"#e6d80d");var x=hg.ins.datas22352;x&&0==x.leftTime&&(b+="&nbsp;&nbsp;"+RP.n[892],n._materialShow.on("link",n,n.onMaterialLink)),n._materialShow.innerHTML=b,n._ganTanImg=new Kl,n._ganTanImg.pos((n.width-n._materialShow.contextWidth)/2-15,810),n.addChild(n._ganTanImg),n._ganTanImg.skin=_r.getAtlasSubPath("base_ui2/ty_bz_sm.png")}}},i.onMaterialLink=function(e){hN.ins.isOpen("MONTHCARD")||hN.ins.open("MONTHCARD",{selectedIndex:3})},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onClick),bj.ins.show(this)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_get.off("click",t,t.onClick),null!=t._materialShow&&(t._materialShow.off("link",t,t.onMaterialLink),t._materialShow.removeSelf(),t._materialShow.destroy(),t._materialShow=null,t._ganTanImg.removeSelf(),t._ganTanImg.destroy(),t._ganTanImg=null),tr.push("run FightSuccessView,onRemove"),G.timer.clearAll(t),t._callback&&(tr.push("run FightSuccessView,onRemove,_callback"),t._callback.run(),t._callback=null)},i.destroy=function(e){void 0===e&&(e=!0),this._grids.destroy(e),this._grids=null,laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){hN.ins._closePanel(this),58==this.cateCount&&(modules.copy.others.HundunData.ins.again=!0,Tu.sendToModule("OPEN_HUNDUN_VIEW",["modules.copy.CopyModule"]))},i.onTime=function(){this._time-=1,this.txt_time.changeText("("+this._time+"s)"),this._time<=0&&(G.timer.clearAll(this),hN.ins._closePanel(this),58==this.cateCount&&(modules.copy.others.HundunData.ins.again=!0,Tu.sendToModule("OPEN_HUNDUN_VIEW",["modules.copy.CopyModule"])))},t}(),xJ=function(e){function t(e){this.WAIT_SEC=20,void(this._remainSec=0)===e&&(e=20),t.__super.call(this),this.WAIT_SEC=e,this.btn_relive.on("click",this,this.onRelive,[2])}b(t,"modules.fight.views.Fight_Relive",e);var i=t.prototype;return i.clearTimerListener=function(){this.clearTimer(this,this.onTimer),this.fadeHide()},i.fadeShow=function(e,t){void 0===t&&(t=!0),this.parent!=e&&e.addChild(this),this.visible=!0,t&&(this.alpha=0,this.scaleX=this.scaleY=.7),Og.clearAll(this),Og.to(this,{scaleX:1,scaleY:1,alpha:1},100)},i.fadeHide=function(){Og.clearAll(this),Og.to(this,{scaleX:.7,scaleY:.7,alpha:0},150,null,ql.create(this,this.onHideComplete))},i.onHideComplete=function(){this.removeSelf(),this.visible=!1},i.onTimer=function(){this.txt_time.changeText(this._remainSec+"s"),this._remainSec--,this._remainSec<0&&(this.onRelive(1),this.clearTimer(this,this.onTimer),this.fadeHide())},i.onRelive=function(e){if(2==e&&gR.ins.YB<100)KQ.ins.showNoGold();else{var t=new FA;t.type=e,Tu.sendToService(t),this.clearTimer(this,this.onTimer),this.fadeHide()}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(ym,t,"dataSource",e);var i=e.name||e.rivalName||"";t.txt_name.innerHTML=i+"&nbsp;"+Ql.createColor(RP.n[893],"#e3dcc2");var n=e.time||dr.curServerTime;t._remainSec=(n+1e3*t.WAIT_SEC-dr.curServerTime)/1e3>>0,t._remainSec<5&&(t._remainSec=5),t.timerLoop(1e3,t,t.onTimer),t.onTimer()}),t}(ym),SJ=function(e){function t(){this._callback=null,this._arr=[{type:1,lvl:28,icon:"js_icon_sc",tips:RP.n[894],uid:1},{type:1,lvl:28,icon:"js_icon_mrcz",tips:RP.n[895],uid:1},{type:1,lvl:40,icon:"js_icon_tb",tips:RP.n[896],uid:2},{type:1,lvl:1,icon:"js_icon_bs",tips:RP.n[897],uid:3},{type:1,lvl:1,icon:"js_icon_bw",tips:RP.n[898],uid:4},{type:2,lvl:1,icon:"",tips:"",uid:5}],this.colorMatrix=[.2586,.1094,.082,0,0,.2586,.1094,.082,0,0,.2586,.1094,.082,0,0,0,0,0,1,0],this.GrayFilter=null,this._time=0,t.__super.call(this)}b(t,"modules.fight.views.result.Fight_FailView",mm);var i=t.prototype;return i.initialize=function(){this.list.itemRender=kJ,this.list.vScrollBarSkin="",this.GrayFilter=new ys(this.colorMatrix),this.img_bg.filters=[this.GrayFilter]},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exit.on("click",this,this.onClickHandler),VQ.instance.close(!0)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clearAll(this),this.btn_exit.off("click",this,this.onClickHandler),tr.push("run Fight_FailView,onRemove"),this._callback&&(tr.push("run Fight_FailView,onRemove,_callback"),this._callback.run(),this._callback=null),$R.isViewLink=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.update=function(e,t,i){var n,s=this;void 0===i&&(i=""),s._callback=t,$R.isFaildLink=!1,3<=gR.ins.actorList.length?(n=s._arr.slice(0,s._arr.length-1),s.list.spaceY=6,s.btn_exit.y=930):(n=s._arr.concat(),s.list.spaceY=3,s.btn_exit.y=920),HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet?n.splice(1,1):n=n.slice(1,n.length),s.txt_cd.y=s.btn_exit.y+68,s.list.dataSource=n,s._time=15,s.txt_cd.changeText("（"+s._time+"s）"),G.timer.loop(1e3,s,s.onTime)},i.onTime=function(){this._time--,this._time<0?$R.isViewLink||(G.timer.clearAll(this),hN.ins._closePanel(this)):this.txt_cd.changeText("（"+this._time+"s）")},i.onClickHandler=function(e){hN.ins._closePanel(this),10<=gR.ins.lv&&(HN.ins._isTipOpen=!0,HN.ins._isTip=!1,MN.isNormalShow=!0,Tu.sendToModule("_UI_SET_CHANGED",["modules.recharge.RechargeModule"]))},t}(),kJ=function(e){function t(){this._data=null,this.eff=null,this.bSkin=null,t.__super.call(this)}b(t,"modules.fight.views.result.Fight_FialItem",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.sp_a.visible=t.sp_n.visible=!1,t.btn_link.on("click",t,t.onClickHandler),t.img_actor.mouseEnabled=!0,t.img_actor.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;t.btn_link.off("click",t,t.onClickHandler),t.img_actor.off("click",t,t.onClickHandler),t.eff&&(t.eff.parent&&t.eff.parent.removeChild(t.eff),t.eff.dispose(),t.eff=null);var i=yc.getRes(t.btn_type.skin);i&&(i.destroy(),yc.clearRes(t.btn_type.skin),tt.ins.clearTexture(t.btn_type.skin)),ui.ViewBase.prototype.onRemove.call(t,e)},i.onLoad=function(){var e=this;if(yc.getRes(e.btn_type.skin)&&yc.clearRes(e.btn_type.skin),e.btn_type.skin=_r.getAtlasSubPath("mainicons_mix/"+e._data.icon+".png"),e.txt_type){var t=e._data&&2!=e._data.type;(e.txt_type.visible=t)&&e.txt_type&&(e.txt_type.text=e._data.tips)}},i.setRoleEff=function(){this.eff||(this.eff=kB.createEffect("jm1307",this.width>>1,this.height>>1,this))},i.onClickHandler=function(e){if(this._data)if(this._data.lvl>gR.ins.lv)zB.ins.showById(101,1);else switch($R.isFaildLink=!0,$R.isViewLink=!0,this._data.uid){case 1:Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],1);break;case 2:Tu.sendToModule("TR_OPEN",["modules.treasure.TreasureModule"]);break;case 3:Tu.sendToModule("ST_OPEN_RED",["modules.strength.StrengthModule"],{_subIndex_:2});break;case 4:hN.ins.open("ACHIEVE_NEW_MAIN_VIEW",{_subIndex_:"2"},0);break;case 5:Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"])}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){if(t._data=e,t.sp_a.visible=2==t._data.type,t.sp_n.visible=!t.sp_a.visible,t.sp_a.visible&&(t.img_actor.skin=_r.getAtlasSubPath("fightresult/boss_img_"+gR.ins.actorList.length+".jpg")),t.sp_n.visible)if(t.bSkin=_r.getAtlasSubPath("mainicons_mix/"+t._data.icon+".png"),G.loader.getRes(t.bSkin))t.onLoad();else{var i=[{url:t.bSkin,type:"image"}];G.loader.load(i,ql.create(t,t.onLoad),null,"image")}2==t._data.type&&t.setRoleEff()}}),t}(vm),EJ=function(e){function t(){var e=this;e.BOTTOM_Y=0,e.LEFT_X=0,e.RIGHT_X=0,t.__super.call(e),e.y=175,e.BOTTOM_Y=e.img_bottom.y,e.LEFT_X=e.img_left.x,e.RIGHT_X=e.img_right.x}b(t,"modules.gui.views.commonui.GK_Title",bm);var i=t.prototype;return i.update=function(e){var t=this;t.showGK(e.num);for(var i=[t.img_guang,t.img_left,t.img_right,t.img_bottom,t.img_circle,t.sp_gk],n=0;n<i.length;n++){var s=i[n];s.visible=!0,s.alpha=0}t.img_circle.rotation=0,Og.to(t.img_circle,{alpha:1},500),Og.to(t.img_circle,{rotation:-90},2500),Og.to(t.img_circle,{alpha:0},500,null,null,2e3),t.img_bottom.y=t.BOTTOM_Y+50,Og.to(t.img_bottom,{alpha:1},500),Og.to(t.img_bottom,{y:t.BOTTOM_Y},250),Og.to(t.img_bottom,{alpha:0},500,null,null,2e3);t.img_left.x=t.LEFT_X+42,Og.to(t.img_left,{alpha:1},500,null,null,250),Og.to(t.img_left,{x:t.LEFT_X-20},250,null,null,250),Og.to(t.img_left,{x:t.LEFT_X},250,null,null,500),Og.to(t.img_left,{alpha:0},500,null,null,2e3),Og.to(t.img_left,{x:t.LEFT_X-20},250,null,null,2250),t.img_right.x=t.RIGHT_X-42,Og.to(t.img_right,{alpha:1},500,null,null,250),Og.to(t.img_right,{x:t.RIGHT_X+20},250,null,null,250),Og.to(t.img_right,{x:t.RIGHT_X},250,null,null,500),Og.to(t.img_right,{alpha:0},500,null,null,2e3),Og.to(t.img_right,{x:t.RIGHT_X+20},250,null,null,2250),Og.to(t.img_guang,{alpha:1},500,null,null,500),Og.to(t.img_guang,{alpha:0},500,null,null,2e3),t.sp_gk.scaleX=t.sp_gk.scaleY=1,Og.to(t.sp_gk,{alpha:1},250,null,null,500),Og.to(t.sp_gk,{scaleX:.75,scaleY:.75},250,null,null,2250)},i.showGK=function(e){var t=this;t.font_num.value=""+e;var i=32*t.font_num.value.length;t.img_guan.x=t.font_num.x+i-4,t.sp_gk.width=t.img_guan.x+56,t.sp_gk.pivotX=t.sp_gk.width/2,t.sp_gk.x=t.width/2},t}(),TJ=function(n){function t(){this.vsc=null,t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.soul.views.SouloutMainView",n);var e=t.prototype;return e.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/soulout/soulout_up.png","ui/layouts/soulout/soulout_copy.png"],e.vsc=new SB(e),e.vsc.registAll([{cls:IK,id:0,isHideBg:!0},{cls:yK,id:2,isHideBg:!0}]),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},e.onAdd=function(e){n.prototype.onAdd.call(this,e);var t=new ip;Tu.sendToService(t),AN.reqRedPt([216,217,218,269]);var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_SOULOUT_COPY",[216,217,218,269],i)},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("soulout/ys_title_ys.png"))},e.onRemove=function(e){n.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_SOULOUT_COPY")},e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},e.checkTips=function(e){if(e==t.SUB_GOD.toString()){if(AN.ins.getStateByCareList([216,269])||oB.ins.isFirstLogin&&GR.getInstance().checkModuleOpen(66))return 3}else if(e==t.SUB_SKILL.toString()&&AN.ins.getStateByCareList([217]))return 3;return e==t.SUB_COPY.toString()&&AN.ins.getStateByCareList([218])?3:0},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.SUB_GOD=0,t.SUB_SKILL=1,t.SUB_COPY=2,t}(Ip),CJ=(function(e){function t(){this._imgIcon=null,this.kunId=0,this._font1=null,this.canOpen=!0,t.__super.call(this),this.centerY=this.centerX=0}b(t,"modules.guild.views.domain.scene.GuildKun_NoticeView",D);var i=t.prototype;i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.clearOverdueTextures()},i.initialize=function(){var e=this;null==e._imgIcon&&(e._imgIcon=new Kl,e.addChild(e._imgIcon),e._imgIcon.centerX=0,e._imgIcon.centerY=-145,e._imgIcon.scrollRect=new u_(0,0,132,132),e._imgIcon.scale(1.2,1.2)),e._font1=new Is(e.txt_name.fontSize),kB.replace(e.txt_name,e._font1),e.btnGo.label=e.canOpen?"开启":RP.n[899]},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btnGo.on("click",this,this.onClick),this.btnClose.on("click",this,this.onClose)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btnGo.off("click",this,this.onClick),this.btnClose.off("click",this,this.onClose)},i.clearOverdueTextures=function(){var e=this._imgIcon.skin;yc.clearRes(e),yc.clearTextureRes(e),tt.ins.clearTexture(e)},i.update=function(e){this.kunId=e;var t=_r.getBossPath(gN.ins.getMonsterHeadId(this.kunId));this._imgIcon.skin=t;var i=gN.ins.getMonsterId(this.kunId),n=hn.getIndex(i),s=hn.MODEL.name(n);this._font1.append(s,"#e6d80d"),this._font1.append(RP.n[900]),this._font1.x=(this.width-this._font1.contentW)/2},i.onClick=function(e){hN.ins.open("GUILD_BOSS_MAINVIEW"),hN.ins.close("GUILD_KUN_NOTICE_VIEW")},i.onClose=function(e){hN.ins.close("GUILD_KUN_NOTICE_VIEW")}}(),function(n){function t(){this.vsc=null,t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.soul.views.soulskin.SoulSkinMainView",n);var e=t.prototype;return e.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/soulskin/yq_btn_yshh.png"],e.vsc=new SB(e),e.vsc.registAll([{cls:SK,id:0,isHideBg:!0}]),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},e.onAdd=function(e){n.prototype.onAdd.call(this,e);var t=new ip;Tu.sendToService(t),AN.reqRedPt([269]);var i=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_SOUL_SKIN",[269],i)},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("soulskin/yshh_text_yshh.png"))},e.onRemove=function(e){n.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_SOUL_SKIN")},e.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e)},e.checkTips=function(e){return e==t.SUB_SKIN.toString()&&AN.ins.getStateByCareList([269])?3:0},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.NAME="SoulSkinMainView",t.SUB_SKIN=0,t}(Ip)),LJ=function(e){function t(){var e=this;e._skillLevel=0,e._actorId=0,e._errorCode=0,e._isNeedActive=!1,e._weaponLevel=0,e._clothLevel=0,e._canUpgrade=!1,e._eff=null,e._effSuccess=null,t.__super.call(e),e.centerX=e.centerY=0}b(t,"modules.god.views.DuanHunSkillTip",oa);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_active.on("click",this,this.onClick)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_active.off("click",t,t.onClick),null!=t._eff&&(t._eff.removeSelf(),t._eff.dispose(),t._eff=null),null!=t._effSuccess&&(t._effSuccess.removeSelf(),t._effSuccess.dispose(),t._effSuccess=null),t._errorCode=0},i.updateView=function(e){var t=this,i=eN.ins.getLevel(t._actorId,0),n=eN.ins.getLevel(t._actorId,1),s=0<i&&0<n,o=e<i&&e<n,a=1==t._weaponLevel&&1==t._clothLevel&&0==e&&s,r=!a&&t._weaponLevel>e&&t._clothLevel>e&&o,l=t._skillLevel;t.show(t._actorId,e,t._weaponLevel,t._clothLevel,a,r),l<e&&(t._effSuccess=0==l?kB.createEffect("jm1426",t.width/2,280,t):kB.createEffect("jm1078",t.width/2,280,t))},i.show=function(e,t,i,n,s,o){var a=this;void 0===s&&(s=!1),void 0===o&&(o=!1),a._errorCode=0,null!=a._eff&&(a._eff.removeSelf(),a._eff.dispose(),a._eff=null),a._actorId=e,a._skillLevel=t,a._isNeedActive=s,a._weaponLevel=i,a._clothLevel=n,a._canUpgrade=o;var r=t>=Xt.count;a.btn_active.visible=!r,a.btn_active.disabled=!s&&!o,a.btn_active.label=0==t?"激 活":s?"激 活":"升 级",a.btn_active.showTip=s||o,a.txt_disableTip.visible=!r,a.txt_disableTip.innerHTML=RP.n[901]+(t+1)+RP.n[902],a.img_max.visible=r;var l=eN.ins.getBuffIndexByLevel(t||1),c=Xt.MODEL.effects(l);a._eff=kB.createEffect(c,a.width/2-2,348,a),a.div_cur_title.innerHTML=RP.n[903];var u=Xt.MODEL.buffs(l);if(u&&0<u.length){var d=parseInt(u[0]);d&&!isNaN(d)&&(l=Ls.getIndex(d),a.lbl_name.changeText(Ls.MODEL.skillName(l)),a.div_cur.innerHTML=Ls.MODEL.skillDesc(l))}if(a.div_next_title.innerHTML=RP.n[904],l=eN.ins.getBuffIndexByLevel(t+1),(u=Xt.MODEL.buffs(l))&&0<u.length){var h=parseInt(u[0]);h&&!isNaN(h)&&(l=Ls.getIndex(h),0==t&&a.lbl_name.changeText(Ls.MODEL.skillName(l)),a.div_next.innerHTML=Ls.MODEL.skillDesc(l))}var _="",f=t+1<=i?"#23b11f":"#90877b";_+=Ql.createColor(RP.n[905]+(t+1)+"阶",f),_+="&nbsp;",f=t+1<=n?"#23b11f":"#90877b",_+=Ql.createColor(RP.n[906]+(t+1)+"阶",f),a.div_suit.innerHTML="[&nbsp;"+_+"&nbsp;]",a.cur.visible=0<t,a.next.visible=0==t||!r,a.div_suit.visible=!r,a.img_line0.visible=a.cur.visible,a.img_line1.visible=!r,a.div_next.y=a.div_suit.visible?a.div_suit.y+a.div_suit.contextHeight+10:a.div_suit.y,a.img_line1.y=a.div_next.y+a.div_next.contextHeight+15,a.txt_disableTip.y=a.img_line1.y+13,a.cur.visible?a.next.y=a.cur.y+a.cur.height+20:a.next.y=485,a.next.visible?a.height=a.next.y+a.next.height+90:a.height=a.cur.y+a.cur.height+90},i.onClick=function(e){tN.reqDuanHunSkillUpgrade(this._actorId)},t.NAME="DuanHunSkillTip",t}(),MJ=function(e){function t(){var e=this;e._selector=null,e.attr_sin=null,e.attr_dou1=null,e.attr_dou2=null,e.g_cost=null,e._font=null,e._isUp=!1,e._type=-1,e._destID=0,e._isFull=!1,e.avatar=null,e.weaponLevel=0,e.clothLevel=0,e.hasWeapon=!1,e.hasCloth=!1,e.effLevel=null,e.effWeapon=null,e.effCloth=null,e._eff1476=null,e.canCon=!1,e.tipSprite=null,t.__super.call(e)}b(t,"modules.god.views.GodDuanhunView",pr);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;if(e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.box_c.addChild(e._selector),e.g_cost=new MF(45),e.g_cost.needGridBg=!1,e.g_cost.needEffect=!1,e.g_cost.pos(e.lab_cost.x+e.lab_cost.width-5,e.lab_cost.y-10),e.box_c.addChild(e.g_cost),e._font=new Is(e.txt_cost.fontSize),kB.replace(e.txt_cost,e._font),e.bg.skin=_r.getFullUrl("ui/layouts/godequip/rxdh_zjm_bg.jpg"),null==e._eff1476){e._eff1476=kB.createEffect("jm1476",e.btn_skill.width/2,e.btn_skill.height/2,e.btn_skill),e.tipSprite=new pp;var t=yc.getRes("ui/layouts/basic_ui/ty_ts_hd.png");e.tipSprite.texture=t,e.tipSprite.visible=!1,e._eff1476.addChild(e.tipSprite),e.tipSprite.pos(15,-50)}},i.setup=function(e){this.onSelect(null);var t=this._selector.selectIdx+1;this.hasWeapon=null!=eN.ins.getCurrGodEqu(t,0),this.hasCloth=null!=eN.ins.getCurrGodEqu(t,1),this.updateLevel(),tN.reqDuanHunInfo(),tN.reqDuanHunSkillInfo()},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.setup(t)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(t,e),t.effLevel&&t.effLevel.dispose(),t.effLevel=null,t.effWeapon&&t.effWeapon.dispose(),t.effWeapon=null,t.effCloth&&t.effCloth.dispose(),t.effCloth=null,t._eff1476&&t._eff1476.dispose(),t._eff1476=null,t.tipSprite&&t.tipSprite.removeSelf(),t.tipSprite=null},i.updateByVSC=function(e){this.updateCost()},i.update=function(e){void 0===e&&(e=!1),this._isUp=e,this.doUpdate()},i.doUpdate=function(){var e=this;e.canCon=!0,e._isUp&&(e.effLevel&&e.effLevel.dispose(),e.effLevel=kB.createEffect("jm1078",e.width/2,e.btn_go.y,e.box_c),e._isUp=!1),e.updateLevel(),e._selector.invalid(),e.updateDisplay(),e.updateAttr(),e.updateCost(),e.updateNotify(),e.updateEff()},i.updateLevel=function(){var e=this._selector.selectIdx+1;this.weaponLevel=eN.ins.getDuanHunLevel(e,0),this.clothLevel=eN.ins.getDuanHunLevel(e,1)},i.updateDisplay=function(){var e=this._selector.selectIdx+1,t=eN.ins.getCurrGodEqu(e,this._type),i=eN.ins.getNextGodEqu(e,this._type),n=t?t.goodsId:i,s=Ci.getIndex(n);this.img_name.skin=_r.getAtlasSubPath("godequip/"+Ci.MODEL.nameRes(s)+".png"),this.img_bg.skin=_r.getAtlasSubPath("godequip/equip_textbg.png"),this.btn_go.visible=null!=t,this.txt_noequip.visible=null==t},i.updateAttr=function(){var e,t,i=this,n=i._selector.selectIdx+1,s=eN.ins.getLevel(n,i._type);0<s&&s<i.currentLevel?(i.canCon=!1,e=eN.ins.getDuanHunAttrs(i._type,s),i.updateSingle(e,!1)):(e=eN.ins.getDuanHunAttrs(i._type,i.currentLevel),t=eN.ins.getDuanHunAttrs(i._type,i.currentLevel+1),e&&0<e.length?t&&0<t.length?i.updateDouble(e,t):i.updateSingle(e,!1):t&&0<t.length&&i.updateSingle(t,!1)),i.fight_item.value=eN.ins.getDuanHunFight(n,i._type)},i.updateCost=function(){var e=this;e._font.clear();e._selector.selectIdx;var t=eN.ins.getDuanHunMatIdAndNum(e._type,e.currentLevel+1);if(t){var i=t.id,n=t.num,s=TR.ins.getGoodsNum(i);n<=s?e._font.append(s+"","#23b11f").append("/"+n,"#90877b"):e._font.append(s+"","#ff2e24").append("/"+n,"#90877b"),e.lab_cost.visible=e.g_cost.visible=e.canCon;var o=yB.create(i);e.g_cost.bindData=o,e.btn_go.visible=!e.txt_noequip.visible&&e.canCon,e.img_fin.visible=!1,e._isFull=!1}else e.lab_cost.visible=e.g_cost.visible=!1,e.btn_go.visible=!1,e._isFull=!0,e.img_fin.visible=e._isFull&&!e.txt_noequip.visible;e.txt_tips0.visible=!e._isFull&&!e.canCon&&!e.txt_noequip.visible,e.txt_tips1.visible=!e._isFull&&!e.canCon||e.txt_noequip.visible;var a=RP.n[907]+(0==e._type?"剑":"甲")+RP.n[908];e.txt_tips1.innerHTML=a+Ql.createColor(e.currentLevel+"","#23b11f")+"阶",e._font.x=e.txt_cost.x+(e.txt_cost.width-e._font.contentW>>1),e._font.visible=e.canCon&&!e.txt_tips1.visible,e.lab_cost.visible=e.lab_cost.visible&&!e.txt_tips1.visible,e.g_cost.visible=e.g_cost.visible&&!e.txt_tips1.visible},i.updateNotify=function(){var e=this._selector.selectIdx+1;this.btn_w.showTip=eN.ins.isDuanHunUp(e,0),this.btn_c.showTip=eN.ins.isDuanHunUp(e,1),this.btn_go.showTip=0==this._type?this.btn_w.showTip:this.btn_c.showTip,this.tipSprite.visible=eN.ins.isShowSkillRp(e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onClick),t.btn_w.on("click",t,t.onSelWeapon),t.btn_c.on("click",t,t.onSelCloth),t.btn_help.on("click",t,t.onClickWF),t.txt_help.on("click",t,t.onClickWF),t.btn_skill.on("click",t,t.showSkillTip),t._selector.selectIdx=Nj.globalIdx,t._selector.on("select",t,t.onSelect)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onClick),t.btn_w.off("click",t,t.onSelWeapon),t.btn_c.off("click",t,t.onSelCloth),t.btn_help.off("click",t,t.onClickWF),t.txt_help.off("click",t,t.onClickWF),t.btn_skill.off("click",t,t.showSkillTip),t._selector.off("select",t,t.onSelect),t._isUp=!1},i.onSelect=function(e){var t=this._selector.selectIdx+1;!eN.ins.isDuanHunUp(t,0)&&eN.ins.isDuanHunUp(t,1)?this.onSelCloth(e):this.onSelWeapon(e)},i.onSelWeapon=function(e){this.doSelect(0)},i.onSelCloth=function(e){this.doSelect(1)},i.doSelect=function(e){0==e?this.mc_sel.pos(this.btn_w.x-4,this.btn_w.y-4):this.mc_sel.pos(this.btn_c.x-4,this.btn_c.y-4),this._type=e,this._isUp=!1,this.doUpdate()},i.onClick=function(e){tN.reqDuanHunUpgrade(this._selector.selectIdx+1,this._type)},i.updateSingle=function(e,t){var i=this;i.attr_dou1&&(i.attr_dou1.visible=!1,i.attr_dou2.visible=!1),i.attr_sin||(i.attr_sin=new kW,i.attr_sin.pos(214,655),i.box_c.addChild(i.attr_sin)),i.attr_sin.visible=!0;var n=null==eN.ins.getDuanHunMatIdAndNum(i._type,i.currentLevel+1)?i.currentLevel:Math.min(i.currentLevel,eN.ins.getLevel(i._selector.selectIdx+1,i._type));i.attr_sin.setTitle(n),i.attr_sin.update(e,t,i._type),i.mc_next.visible=!1,i.img_attrBg.width=319},i.updateDouble=function(e,t){var i=this;i.attr_sin&&(i.attr_sin.visible=!1),i.attr_dou1||(i.attr_dou1=new kW,i.attr_dou1.pos(30,655),i.box_c.addChild(i.attr_dou1),i.attr_dou2=new kW,i.attr_dou2.pos(394,655),i.box_c.addChild(i.attr_dou2)),i.attr_dou1.visible=i.attr_dou2.visible=!0;var n=Math.min(i.currentLevel,eN.ins.getLevel(i._selector.selectIdx+1,i._type));i.attr_dou1.setTitle(n),i.attr_dou1.update(e,!1,i._type),i.attr_dou2.update(t,!0,i._type),i.attr_dou2.setTitle(n+1),i.mc_next.visible=!0,i.img_attrBg.width=660},i.needRedpt=function(e){return!!eN.ins.isDuanHunActorUp(e.id)},i.onClickWF=function(e){var t=Vi.getIndex(12),i=Vi.MODEL.description(t);hN.ins.open("AE_EXPLAIN_VIEW",{desc:i})},i.updateAvatar=function(){var e,t=this._selector.selectIdx+1,i=gR.ins.actorById(t),n=_R.ins.getPanelEffectIdByMagicId(i.magicId),s=eN.ins.getCurrGodEqu(t,0),o=i.wid,a=i.sex;s&&(e=Bi.MODEL.roleId(s.cfgIdx))&&0<e.length&&(o=e.split(",")[a-1]);var r=eN.ins.getCurrGodEqu(t,1),l=i.mid;r&&(e=Bi.MODEL.roleId(r.cfgIdx))&&0<e.length&&(l=e.split(",")[a-1]),this.avatar.changeAvatar(i.sex,o,l,i.wgid,i.weaponSoulId,i.chuanshiId,n)},i.updateEff=function(){var e,t=this,i=t._selector.selectIdx+1,n=gR.ins.actorById(i).sex;0==t._type?(t.effCloth&&(t.effCloth.visible=!1),t.effWeapon&&t.effWeapon.dispose(),e=eN.ins.getDuanHunEffect(t._type,t.currentLevel||1,n),t.effWeapon=kB.createEffect(e,450,500,t.box_c),t.effWeapon.scale_X=t.effWeapon.scale_Y=.6):(t.effCloth&&t.effCloth.dispose(),e=eN.ins.getDuanHunEffect(t._type,t.currentLevel||1,n),t.effCloth=kB.createEffect(e,362,500,t.box_c),t.effCloth.scale_X=t.effCloth.scale_Y=.8,t.effWeapon&&(t.effWeapon.visible=!1))},i.showSkillTip=function(e){var t=this._selector.selectIdx+1,i=eN.ins.getSkillLevel(t),n=eN.ins.getLevel(t,0),s=eN.ins.getLevel(t,1),o=0<n&&0<s,a=eN.ins.getDuanHunLevel(t,0),r=eN.ins.getDuanHunLevel(t,1),l=1==a&&1==r&&0==i&&o,c=!l&&i<a&&i<r&&(i<n&&i<s);hN.ins.open("DuanHunSkillTip",{actorId:t,skillLevel:i,weaponLevel:a,clothLevel:r,isNeedActive:l,canUpgrade:c})},p(0,i,"currentLevel",function(){return 0==this._type?this.weaponLevel:this.clothLevel}),t}(),AJ=function(e){function t(){var e=this;e._selector=null,e.attr_sin=null,e.attr_dou1=null,e.attr_dou2=null,e.g_dis=null,e.g_cost=null,e._disDto=null,e._costDto=null,e._font=null,e._isUp=!1,e._currId=0,e._type=-1,e._level=0,e._destID=0,e._isFull=!1,t.__super.call(e),e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.needRedpt,null,!1),e.box_c.addChild(e._selector),e.g_dis=new MF,e.g_dis.pos(e.mc_g.x+33,e.mc_g.y+31),e.box_c.addChild(e.g_dis),e.g_cost=new MF(46),e.g_cost.needGridBg=!1,e.g_cost.needEffect=!1,e.g_cost.isShowSmallIcon=!0,e.g_cost.pos(290,865),e.box_c.addChild(e.g_cost),e._font=new Is(e.txt_cost.fontSize),kB.replace(e.txt_cost,e._font),e.bg.skin=_r.getFullUrl("ui/images/godequip/sz_rxzb_img_bg.jpg")}b(t,"modules.god.views.GodEquipView",vr);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.setup=function(e){if(null==e)this.onSelect(null);else{var t,i=parseInt(e),n=1==i||78==i?1:0;for(var s in gR.ins.actorList)if(t=gR.ins.actorList[s],eN.ins.isUpable(t.id,n)){var o=t.id-1;return void(o!=this._selector.selectIdx?this._selector.selectIdx=o:this.onSelect(null))}1==n?this.onSelCloth(null):this.onSelWeapon(null)}},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.setup(t)},i.updateByVSC=function(e){this.updateCost()},i.update=function(){this.doUpdate()},i.doUpdate=function(){var e=this;if(e._isUp){e._isUp=!1;var t=e._selector.selectIdx+1,i=eN.ins.getCurrGodEqu(t,e._type);if(i&&i.goodsId!=e._currId){e._currId<=0?console.log("激活"):console.log("升阶");var n=kB.createEffect("jm1244",e.g_dis.x+58,e.g_dis.y+58);e.addChildAt(n,e.getChildIndex(e.g_dis)+1)}}e._selector.invalid(),e.updateDisplay(),e.updateAttr(),e.updateCost(),e.updateNotify()},i.updateDisplay=function(){var e=this,t=e._selector.selectIdx+1,i=eN.ins.getCurrGodEqu(t,e._type),n=eN.ins.getNextGodEqu(t,e._type),s=i?i.goodsId:n;e._destID=n||i.goodsId,e._disDto?e._disDto.setGoodsId(s):e._disDto=KH.create(s),i?(e._disDto.uuId=i.uuId,e._disDto.position=i.position,e._disDto.roleId=i.roleId,e._currId=i.goodsId):(e._disDto.uuId=e._disDto.position=e._disDto.roleId=0,e._currId=0),e.g_dis.needEffect=0<e._currId,e.g_dis.bindData=e._disDto;var o=Ci.getIndex(s),a=Ci.MODEL.cost(o)[0];e._costDto?e._costDto.setGoodsId(a):e._costDto=yB.create(a),e.g_cost.bindData=e._costDto,e._level=Ci.MODEL.level(o),e.img_name.skin=_r.getAtlasSubPath("godequip/"+Ci.MODEL.nameRes(o)+".png"),e.img_bg.skin=_r.getAtlasSubPath("godequip/equip_textbg.png"),e.mc_level.value=e._level.toString(),1<e._level?e.btn_preview.gray=!1:e.btn_preview.gray=!0,e.btn_go.label=i?"进 阶":"激 活",i?(e.btn_break.visible=!0,e.btn_go.x=380,e.btn_break.x=0!=n?140:262,e.btn_preview.visible=!0,e.lk_get.x=600):(e.btn_break.visible=!1,e.btn_preview.visible=!1,e.btn_go.x=262,e.lk_get.x=500)},i.updateAttr=function(){var e=this._selector.selectIdx+1,t=eN.ins.getCurrGodEqu(e,this._type),i=eN.ins.getNextGodEqu(e,this._type);t?0<i?this.updateDouble(t.goodsId,i,t.randomRate):this.updateSingle(t.goodsId,t.randomRate,!1):this.updateSingle(i,0,!0),this.fight_item.value=t?this._disDto.fight:0},i.updateCost=function(){var e=this;e._font.clear();var t=e._selector.selectIdx+1,i=eN.ins.getNextGodEqu(t,e._type);if(0<i){var n=Ci.getIndex(i),s=Ci.MODEL.cost(n)[0],o=Ci.MODEL.cost(n)[1],a=TR.ins.getGoodsNum(s);o<=a?e._font.append(a+"/"+o,"#e3dcc2"):e._font.append(a+"","#e70909").append("/"+o,"#e3dcc2"),e.lab_cost.visible=e.bg_txt.visible=e.g_cost.visible=!0,e.btn_go.visible=e.lk_get.visible=!0,e.img_fin.visible=!1,e._isFull=!1}else e.lab_cost.visible=e.bg_txt.visible=e.g_cost.visible=!1,e.btn_go.visible=e.lk_get.visible=!1,e.img_fin.visible=!0,e._isFull=!0;e._font.x=e.txt_cost.x+(e.txt_cost.width-e._font.contentW>>1)},i.updateNotify=function(){var e=this._selector.selectIdx+1;this.btn_w.showTip=eN.ins.isUpable(e,0),this.btn_c.showTip=eN.ins.isUpable(e,1)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onClick),t.btn_w.on("click",t,t.onSelWeapon),t.btn_c.on("click",t,t.onSelCloth),t.lk_get.on("click",t,t.onLink),t.btn_break.on("click",t,t.onBreakClicked),t.btn_preview.on("click",t,t.onPreviewClicked),t._selector.selectIdx=Nj.globalIdx,t._selector.on("select",t,t.onSelect)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onClick),t.btn_w.off("click",t,t.onSelWeapon),t.btn_c.off("click",t,t.onSelCloth),t.lk_get.off("click",t,t.onLink),t._selector.off("select",t,t.onSelect),t.btn_break.off("click",t,t.onBreakClicked),t.btn_preview.on("click",t,t.onPreviewClicked),t._isUp=!1},i.onSelect=function(e){var t=this._selector.selectIdx+1;!eN.ins.isUpable(t,0)&&eN.ins.isUpable(t,1)?this.onSelCloth(e):this.onSelWeapon(e)},i.onSelWeapon=function(e){this.doSelect(0)},i.onSelCloth=function(e){this.doSelect(1)},i.doSelect=function(e){var t=this;0==e?t.mc_sel.pos(t.btn_w.x-4,t.btn_w.y-4):t.mc_sel.pos(t.btn_c.x-4,t.btn_c.y-4),t.btn_preview.skin=0==e?_r.getAtlasSubPath("godequip/sz_icon_syht.png"):_r.getAtlasSubPath("godequip/sz_icon_sjht.png"),t._type=e,t._isUp=!1,t.doUpdate()},i.onClick=function(e){if(UB.ins.playSound("3"),!this._isUp){var t=this._selector.selectIdx+1,i=eN.ins.getNextGodEqu(t,this._type),n=Ci.getIndex(i),s=Ci.MODEL.cost(n)[0],o=Ci.MODEL.cost(n)[1];if(TR.ins.getGoodsNum(s)<o)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:s});if(i){var a=KH.create(i);if(gR.ins.zsLv<a.flyLevel)return void zB.ins.showMsg(RP.n[562],1)}this._isUp=!0,tN.reqUpgrade(this._selector.selectIdx+1,this._type)}},i.onLink=function(e){Tu.sendToModule("TR_OPEN",["modules.treasure.TreasureModule"]),UB.ins.playSound(90006)},i.updateSingle=function(e,t,i){var n=this;n.attr_dou1&&(n.attr_dou1.visible=!1,n.attr_dou2.visible=!1),n.attr_sin||(n.attr_sin=new EW(RP.n[910]),n.attr_sin.pos(215,590),n.box_c.addChild(n.attr_sin)),n.attr_sin.setTitle(i?RP.n[911]:RP.n[912]),n.attr_sin.visible=!0,n.attr_sin.update(e,t,i),n.mc_next.visible=!1},i.updateDouble=function(e,t,i){var n=this;n.attr_sin&&(n.attr_sin.visible=!1),n.attr_dou1||(n.attr_dou1=new EW(RP.n[913]),n.attr_dou1.pos(30,590),n.box_c.addChild(n.attr_dou1),n.attr_dou2=new EW(RP.n[914]),n.attr_dou2.pos(394,590),n.box_c.addChild(n.attr_dou2)),n.attr_dou1.visible=n.attr_dou2.visible=!0,n.attr_dou1.update(e,i,!1),n.attr_dou2.update(t,i,!0),n.mc_next.visible=!0},i.needRedpt=function(e){return!!eN.ins.isActorUpEnable(e)},i.onBreakClicked=function(e){tN.reqBreak(this._selector.selectIdx+1,this._type)},i.onPreviewClicked=function(e){var t=gR.ins.actorList[this._selector.selectIdx];Tu.sendToModule("GE_OPEN_PREVIEW",["modules.actor.ActorModule"],{id:this._destID,type:this._type,sex:t.sex,job:t.job,isFull:this._isFull})},t}(),DJ=function(e){function t(){var e=this;e.PAGE_ITEM_LENGTH=5,e._bagDatas=null,e._gridDatas=null,e._gridItems=null,e._materialItems=null,e._materialDatas=null,e._materialGrids=null,e._hasAddItems=null,e._page=0,e._pageMax=0,e._resultGrid=null,e._loopTime=0,e._shineTweener=null,e._effect=null,e._newItem=null,e._newTween=null,e._currentMouseDownGrid=null,e._currentMouseDownItem=null,e._isAbleShowTip=!1,e._hasShowGridTip=!1,e._hasShowItemTip=!1,t.__super.call(e)}b(t,"modules.godweapon.views.compound.GodWeaponCompoundView",mr);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e._hasAddItems=[],e._gridItems=[],e._gridDatas=[],e._materialItems=[],e._materialDatas=[],e._materialGrids=[];for(var t=0;t<3;t++){var i=e["material"+t];e._materialItems[t]=i,e._materialDatas[t]=null;var n=new MF;n.needGridBg=!1,n.needEffect=!1,n.toolTipEnabled=!1,n.mouseEnabled=!1,n.isShowJob=!1,i.addChildAt(n,1),i.txt_name.text="",e._materialGrids[t]=n,e["img_line"+t].visible=!1}for(t=0;t<e.PAGE_ITEM_LENGTH;t++)(n=new MF(80)).toolTipEnabled=!1,n.isShowJob=!0,n.x=e["grid"+t].x,n.y=e["grid"+t].y,e.b_bag.addChild(n),e._gridItems[t]=n,e._gridDatas[t]=null;var s=e.result;s.txt_name.text="",s.icon.skin=_r.getAtlasSubPath("godweapon/sb_jm_tsyk.png"),e._resultGrid=new MF,e._resultGrid.needGridBg=!1,e._resultGrid.needEffect=!1,e._resultGrid.isShowJob=!1,e._resultGrid.y=2,s.addChildAt(e._resultGrid,1),s.plus.visible=!1,e.img_alert.visible=!0,e.img_alert.alpha=0,e.img_ableCompound.visible=!1,e._loopTime=0},i.showByVSC=function(e,t){var i=this;i._page=0,i.resetBagData(),i.on("click",i,i.onClick);for(var n=0;n<i._materialItems.length;n++)i._materialItems[n].on("click",i,i.onClickMaterials);for(n=0;n<i._gridItems.length;n++)i._gridItems[n].on("click",i,i.onClickBagItems);for(n=0;n<i._materialItems.length;n++)i._materialItems[n].on("mousedown",i,i.onMouseDownItem);for(n=0;n<i._gridItems.length;n++)i._gridItems[n].on("mousedown",i,i.onMouseDownGrid);i._resultGrid.on("click",i,i.onClearResult)},i.hideByVSC=function(e,t){var i=this;null!=i._newItem&&i._newItem.removeSelf(),i.off("click",i,i.onClick);for(var n=0;n<i._materialItems.length;n++)i._materialItems[n].off("click",i,i.onClickMaterials);for(n=0;n<i._gridItems.length;n++)i._gridItems[n].off("click",i,i.onClickBagItems);for(n=0;n<i._materialItems.length;n++)i._materialItems[n].off("mousedown",i,i.onMouseDownItem);for(n=0;n<i._gridItems.length;n++)i._gridItems[n].off("mousedown",i,i.onMouseDownGrid);for(i._resultGrid.off("click",i,i.onClearResult),n=0;n<i._materialDatas.length;n++)i._materialDatas[n]=null;for(n=0;n<i._bagDatas.length;n++)i._bagDatas[n]=null;null!=i._shineTweener&&i._shineTweener.clear(),null!=i._newTween&&i._newTween.clear(),null!=i._newItem&&i._newItem.removeSelf(),i._resultGrid.bindData=null,i.img_ableCompound.visible=!1,i.result.txt_name.text="",i.img_alert.visible=!0,i.img_alert.alpha=0},i.updateByVSC=function(e){var t=e;if(null!=t)switch(t.actionOrder){case"23703":var i=t.proto;this.testCompound(i.configId)}},i.resetBagData=function(){this._bagDatas=[];for(var e=TR.ins.getBackPackItems(),t=0;t<e.length;t++){var i=e[t];aN.isHalldom(i)&&this._bagDatas.push(this.clone(i))}this.updateBagData()},i.onClearResult=function(e){this._resultGrid.bindData=null;var t=this.result;0==this.img_ableCompound.visible&&(t.txt_name.text="")},i.updateBagData=function(){var e=this;e._bagDatas.sort(e.sortFunction);var t=Math.ceil(e._bagDatas.length/5);e._pageMax=Math.max(t,1),0==e._bagDatas.length?(e.txt_noTip.visible=!0,e.b_bag.visible=!1):(e.txt_noTip.visible=!1,e.b_bag.visible=!0),e.updatePageItem()},i.sortFunction=function(e,t){var i=Bi.getIndex(e.goodsId),n=Bi.getIndex(t.goodsId),s=Bi.MODEL.colourId(i),o=Bi.MODEL.colourId(n);if(o<s)return 1;if(s<o)return-1;var a=Bi.MODEL.roleTypeId(i),r=Bi.MODEL.roleTypeId(n);return r<a?1:a<r?-1:n<i?1:i<n?-1:0},i.testCompound=function(e){this._materialDatas[0];this.flyItem(e);for(var t=0;t<this._materialDatas.length;t++)this._materialDatas[t]=null;this._resultGrid.bindData=e;var i=Bi.getIndex(e),n=this.result;n.txt_name.text=Bi.MODEL.name(i),n.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(i)),this.showSuccessEffect(),this.resetBagData()},i.updatePageItem=function(){for(var e=this,t=0;t<e._gridItems.length;t++){var i=e._gridItems[t];if(i._iconUrl=null,e._bagDatas.length>e.PAGE_ITEM_LENGTH*e._page+t){var n=e._bagDatas[e.PAGE_ITEM_LENGTH*e._page+t];i.bindData=n,e["name"+t].color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(n.goodsId))),e["name"+t].text=n.name}else i.bindData=null,e["name"+t].text="";e._gridDatas[t]=i.bindData}e.btnPrev.disabled=0==e._page,e.btnNext.disabled=e._page==e._pageMax-1,e.updateMaterialView()},i.ShowErrorBorder=function(e){var t=this;void 0===e&&(e=1),this._loopTime=e,null!=this._shineTweener&&this._shineTweener.clear(),this._shineTweener=Og.to(this.img_alert,{alpha:1},100,null,ql.create(this,function(){t._shineTweener=Og.to(t.img_alert,{alpha:0},100,null,ql.create(t,function(){t._loopTime=t._loopTime-1,0<t._loopTime&&t.ShowErrorBorder(t._loopTime)}))}))},i.showSuccessEffect=function(){this._effect=kB.createEffect("jm0005",380,740,this),this._effect.playEndHandler=ql.create(this,this.clear,null,!0)},i.clear=function(){this._effect&&(this._effect.dispose(),this._effect=null)},i.flyItem=function(e){var t=this;null!=this._newTween&&this._newTween.clear(),null==this._newItem&&(this._newItem=new MF),this._newItem._iconUrl=null,this._newItem.bindData=e;var i=this.result;this._newItem.x=i.x,this._newItem.y=i.y,this._newTween=Og.to(this._newItem,{y:this.bagInfo.y+100},1e3,null,ql.create(this,function(){t._newItem.removeSelf()})),this.addChild(this._newItem)},i.updateMaterialView=function(){for(var e=this,t=0,i=0;i<e._materialDatas.length;i++){var n=e._materialDatas[i],s=e._materialGrids[i],o=e._materialItems[i];null!=(s.bindData=n)?(o.plus.visible=!1,o.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(n.goodsId))),o.txt_name.text=n.name,t++):(o.plus.visible=!0,o.txt_name.text="")}var a=e.result;if(t<3)for(e.btnCompound.disabled=!0,e.img_ableCompound.visible=!1,null==e._resultGrid.bindData&&(a.txt_name.text=""),i=0;i<3;i++){var r=e["img_line"+i];r.visible=!1}else for(e.btnCompound.disabled=!1,e.img_ableCompound.visible=!0,a.txt_name.text=RP.n[915],a.txt_name.color="#e6d80d",i=0;i<3;i++)(r=e["img_line"+i]).visible=!0},i.onClick=function(e){var t=this;switch(e.target){case t.btnNext:t.page=t.page+1;break;case t.btnPrev:t.page=t.page-1;break;case t.btnCompound:var i=t._materialDatas[0];if(null==i)break;var n=t._materialDatas[1];if(null==n)break;var s=t._materialDatas[2];if(null==s)break;oN.ReqCompoundItem(i,n,s)}},i.onClickMaterials=function(e){var t=this;if(!t._hasShowItemTip)for(var i=0;i<t._materialItems.length;i++){var n=t._materialItems[i];if(e.target==n)if(null==t._materialDatas[i])t.ShowErrorBorder(3);else{var s=t._materialDatas[i];t._materialDatas[i]=null;for(var o=0;o<t._bagDatas.length;o++){var a=t._bagDatas[o];a.uuId==s.uuId&&(a.goodsNum+=s.goodsNum,s.goodsNum=0)}0<s.goodsNum&&t._bagDatas.push(s),t.updateBagData(),t.updateMaterialView(),s=null}}},i.onClickBagItems=function(e){if(!this._hasShowGridTip)for(var t=0;t<this._gridItems.length;t++){var i=this._gridItems[t],n=this._gridDatas[t];if(e.target==i&&null!=n){this.addItemToMaterial(n);break}}},i.addItemToMaterial=function(e){for(var t=this,i=0;i<t._materialDatas.length;i++){var n=t._materialDatas[i];if(null!=n){var s=Bi.getIndex(e.goodsId),o=Bi.getIndex(n.goodsId);if(Bi.MODEL.colourId(s)!=Bi.MODEL.colourId(o))return void zB.ins.showMsg(RP.n[916],1)}}for(i=0;i<t._materialDatas.length;i++)if(null==(n=t._materialDatas[i])){if(e.goodsNum-=1,0==e.goodsNum){var a=t._bagDatas.indexOf(e);t._bagDatas.splice(a,1)}return t.updatePageItem(),(e=t.clone(e)).goodsNum=1,t._materialDatas[i]=e,t._resultGrid.bindData=null,void t.updateMaterialView()}zB.ins.showMsg(RP.n[917],1)},i.clone=function(e){var t=new yB;return t.uuId=e.uuId,t.position=e.position,t.goodsId=e.goodsId,t.goodsNum=e.goodsNum,t.expTime=e.expTime,t.roleId=e.roleId,t.changeNum=e.changeNum,t.cfgIdx=e.cfgIdx,t.canUse=e.canUse,t.isOther=e.isOther,t.disAchi=e.disAchi,t},i.onMouseDownGrid=function(e){var t=this;t._currentMouseDownGrid=e.target,null!=t._currentMouseDownGrid&&(t._isAbleShowTip=!0,t._currentMouseDownGrid.on("mouseout",t,t.onMouseOutGrid),G.stage.once("mouseup",t,t.onMouseUpGrid),G.timer.once(yp.scrollBarDelayTime,t,t.toggleShowGridTip))},i.toggleShowGridTip=function(){var e=this;G.timer.clear(e,e.toggleShowGridTip),e._isAbleShowTip&&null!=e._currentMouseDownGrid&&(e._currentMouseDownGrid.off("mouseout",e,e.onMouseOutGrid),e._hasShowGridTip=!0,null!=e._currentMouseDownGrid.bindData&&e._currentMouseDownGrid._doShowToolTip())},i.onMouseUpGrid=function(e){var t=this;G.timer.clear(this,this.toggleShowGridTip),this._isAbleShowTip=!1,G.timer.once(200,this,function(){t._hasShowGridTip=!1})},i.onMouseOutGrid=function(e){null!=this._currentMouseDownGrid&&this._currentMouseDownGrid.off("mouseout",this,this.onMouseOutGrid),this._isAbleShowTip=!1,this._currentMouseDownGrid=null},i.onMouseDownItem=function(e){var t=this;t._currentMouseDownItem=e.target,null!=t._currentMouseDownItem&&(t._isAbleShowTip=!0,t._currentMouseDownItem.on("mouseout",t,t.onMouseOutItem),G.stage.once("mouseup",t,t.onMouseUpItem),G.timer.once(yp.scrollBarDelayTime,t,t.toggleShowItemTip))},i.toggleShowItemTip=function(){var e=this;if(G.timer.clear(e,e.toggleShowItemTip),e._isAbleShowTip&&null!=e._currentMouseDownItem){e._currentMouseDownItem.off("mouseout",e,e.onMouseOutItem),e._hasShowItemTip=!0;var t=e._materialItems.indexOf(e._currentMouseDownItem),i=e._materialGrids[t];null!=i.bindData&&i._doShowToolTip()}},i.onMouseUpItem=function(e){var t=this;G.timer.clear(this,this.toggleShowItemTip),this._isAbleShowTip=!1,G.timer.once(200,this,function(){t._hasShowItemTip=!1})},i.onMouseOutItem=function(e){null!=this._currentMouseDownItem&&this._currentMouseDownItem.off("mouseout",this,this.onMouseOutItem),this._isAbleShowTip=!1,this._currentMouseDownItem=null},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_help.on("click",this,this.onClickHelp)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_help.off("click",this,this.onClickHelp)},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(34));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e})},p(0,i,"page",function(){return this._page},function(e){this._page!=e&&(e>this._pageMax-1?e=this._pageMax-1:e<0&&(e=0),this._page=e,this.updatePageItem())}),t}(),OJ=function(t){function e(){this._currentLevelSelected=-1,e.__super.call(this)}b(e,"modules.godweapon.views.fairyland.GodWeaponFairylandMainView",t);var i=e.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.list_rank.itemRender=NJ,e.list_rank.repeatY=3,e.list_level.itemRender=RJ,e.list_level.selectHandler=ql.create(e,e.onLevelSelected,null,!1),e.list_level.selectEnable=!0,e.list_level.repeatY=3,e.list_level.vScrollBarSkin="",e.list_level.spaceY=10,e.list_level.scrollBar.elasticBackTime=100,e.list_level.scrollBar.elasticDistance=0},i.onLevelSelected=function(e){var t;if(!((t=this.list_level.array[e]).id-1>nN.instance.currentLevel)){if(1!=t.id&&1==nN.instance.currentLevel)if(0!=this.list_level.array[this.list_level.array.length-1].quality)return;t.selected=!0;for(var i=0;i<this.list_level.array.length;i++){var n=this.list_level.array[i];if(i!=e&&n.selected&&n.id!=t.id){n.selected=!1,this.list_level.changeItem(i,n);break}}}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_rankDetail.on("click",t,t.onRankClicked),t.btn_challenge.on("click",t,t.onChallengeClicked),t.btn_help.on("click",t,t.onClickHelp)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.txt_rankDetail.off("click",t,t.onRankClicked),t.btn_challenge.on("click",t,t.onChallengeClicked),t.btn_help.off("click",t,t.onClickHelp)},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.list_rank.dataSource=[],BN.reqRank(15),this.updateByVSC(t)},i.updateByVSC=function(e){var t=this;nN.instance.currentLevel<=3?3==nN.instance.currentLevel?nN.instance.currentLevel!=nN.instance.currentThroughLevel?t.list_level.dataSource=nN.instance.getConfig().slice(0,nN.instance.currentThroughLevel).reverse():t.list_level.dataSource=nN.instance.getConfig().slice(0,nN.instance.currentLevel+1).reverse():t.list_level.dataSource=nN.instance.getConfig().slice(0,3).reverse():1==nN.instance.lastQuality?t.list_level.dataSource=nN.instance.getConfig().slice(0,nN.instance.currentLevel+1).reverse():t.list_level.dataSource=nN.instance.getConfig().slice(0,nN.instance.currentThroughLevel).reverse();var i=-1;if(0==nN.instance.currentLevel)i=t.findIDbyIndex(1);else for(var n=0;n<t.list_level.array.length;n++)if(0==t.list_level.array[n].quality){i=i<1&&t.list_level.array.length==nN.instance.getConfig().length?n:n-1;break}i<0&&(i=t.list_level.array.length-1),t.list_level.selectedIndex=i,t.onLevelSelected(i),nN.instance.currentLevel,t.list_level.scrollTo(0);var s=nN.instance.leftChallengeTime;t.txt_leftTime.text=""+(s<0?0:s),t.btn_challenge.showTip=0<s},i.findIDbyIndex=function(e){for(var t=this.list_level.array.length-1;0<t;t--)if(this.list_level.array[t].id==e)return t;return 0},i.updateRank=function(){this.list_rank.dataSource=o_.ins.getRank(15).datas},i.onRankClicked=function(e){hN.ins.isOpen("GodWeaponFairylandRankPanel")||Tu.sendToModule("OPEN_FAIRYLAND_RANK",["modules.godweapon.GodWeaponModule"])},i.onChallengeClicked=function(e){if(ZN.isEnabledChangeScene()){var t=parseInt($e.MODEL.value(98));if(nN.instance.leftChallengeTime<=0)if(0<TR.ins.getGoodsNum(t)){var i=yB.create(t,1),n=RP.n[918]+i.name+RP.n[919];KQ.ins.show(n,ql.create(this,this.alertConfirm))}else zB.ins.showMsg(RP.n[920],1);else if(TR.ins.hasEmptyNum(20)){var s=this.list_level.array[this.list_level.selectedIndex].id,o=ir.MODEL.missionId(s-1),a=new YV;a.copyId=o,Tu.sendToService(a),this.timer.once(300,this,function(){hN.ins.close("GodWeaponMainPanel")})}else KQ.ins.showBagRecycle()}else zB.ins.showById(2126,1)},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(33));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e})},i.alertConfirm=function(e){if(1==e){var t=new Wr;Tu.sendToService(t)}},e}(kr),PJ=function(e){function i(){i.__super.call(this)}return b(i,"modules.godweapon.views.fairyland.item.GodWeaponFairylandDetialItem",e),p(0,i.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;G.superSet(wr,t,"dataSource",e),e&&(t.txt_rank.text=e.r,t.txt_name.text=e.n,t.txt_level.text="第"+e.v+"层",t.txt_time.text=Jp.getTickMS(e.sv),t.img_rank.visible=!1,e.r<4?(t.img_rank.visible=!0,t.img_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+e.r+".png"),t.txt_name.color=i._rankNameColorArr[e.r-1],t.img_bg.skin=_r.getAtlasSubPath("base_ui2/phb_db_no"+e.r+".png"),t.img_bg.sizeGrid="0,60,0,60"):(t.txt_name.color=i._rankNameColorArr[i._rankNameColorArr.length-1],t.img_bg.skin=_r.getAtlasSubPath("basic_ui_3/ty_btn_lb_2.png")))}),f(i,["_rankNameColorArr",function(){return this._rankNameColorArr=["#f7efcf","#f0d1a4","#c5a386","#90877b"]}]),i}(wr),RJ=function(t){function e(){this.vo=null,this._grid_0=null,this._grid_1=null,e.__super.call(this)}b(e,"modules.godweapon.views.fairyland.item.GodWeaponFairylandLevelItem",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid_0=new MF,e._grid_0.size(e.img_reward_0.width,e.img_reward_0.height),e._grid_0.pos(e.img_reward_0.x,e.img_reward_0.y),e.addChild(e._grid_0),e._grid_0.mouseEnabled=!1,e._grid_1=new MF,e._grid_1.size(e.img_reward_1.width,e.img_reward_1.height),e._grid_1.pos(e.img_reward_1.x,e.img_reward_1.y),e.addChild(e._grid_1),e.addChildAt(e._grid_1,e.getChildIndex(e.img_get)+1),e.addChild(e.img_get),e.box_selected.visible=!1,e.box_normal.visible=!e.box_selected.visible},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.changeSelected=function(){this.vo.selected?(this.box_selected.visible=!0,this.img_point.visible=!1):(this.box_selected.visible=!1,this.img_point.visible=!0),this.box_normal.visible=!this.box_selected.visible},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(xr,t,"dataSource",e),e){t.vo=e,t.changeSelected(),t.txt_level.text="第"+t.vo.id+"层",0<=t.vo.quality?(t._grid_1.mouseEnabled=t.img_point.visible=!0,0==t.vo.quality?t.img_get.visible=!0:t.img_get.visible=!1,t.img_point.skin=_r.getAtlasSubPath("godweapon/quality_"+t.vo.quality+".png")):t._grid_1.mouseEnabled=t.img_get.visible=t.img_point.visible=!1;var i=yB.createStr(ir.MODEL.sReward(t.vo.id-1));t._grid_0.bindData=i,i=yB.createStr(ir.MODEL.firstReward(t.vo.id-1)),t._grid_1.bindData=i}}),e}(xr),NJ=function(e){function t(){this.gAlpha=[1,.6,.3],t.__super.call(this)}return b(t,"modules.godweapon.views.fairyland.item.GodWeaponFairylandSimpleItem",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){G.superSet(Tr,this,"dataSource",e),e&&(this.img_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+e.r+".png"),this.txt_name.text=e.n,this.txt_level.text=e.v+"层",this.txt_time.text=Jp.getTickMS(e.sv),this.img_bg.alpha=this.gAlpha[e.r-1],this.img_rank.sizeGrid="0,20,0,20")}),t}(Tr),BJ=function(i){function t(){var e=this;e.vsc=null,e._effT=0,e.lwOpenLv=0,e.csOpenLv=null,t.__super.call(e),e.mouseEnabled=!0,e.top=e.bottom=e.left=e.right=0,e.lwOpenLv=parseInt($e.MODEL.value($e.getIndex(154))),e.csOpenLv=$e.MODEL.value($e.getIndex(155)).split(",")}b(t,"modules.treasure.views.TreasureView",i);var e=t.prototype;return e.initialize=function(){var e=this;this.size(720,1280),this.centerX=this.centerY=0,this.navList=["ui/layouts/treasure/btn_tab_tanbao1.png","ui/layouts/treasure/btn_tab_tanbao2.png","ui/layouts/treasure/btn_tab_tanbao3.png"],this.vsc=new SB(this),this.title=_r.getAtlasSubPath("treasure/tb_text_tb.png"),this.vsc.registAll([{cls:DK,id:"0"},{cls:PK,id:"1",wait:hN.wait(hN.waitConfig(["DragonDesignUpgrade"],["CConfigDragonInfo"])),grayTip:function(){zB.ins.showMsg(RP.n[921]+e.lwOpenLv+"级开启",1)}},{cls:MK,id:"2",grayTip:function(){zB.ins.showMsg(RP.n[922]+e.csOpenLv[0]+RP.n[923]+e.csOpenLv[1]+"级开启",1)}}]),this.vsc.invalid(),this.title=_r.getAtlasSubPath("treasure/tb_text_tb.png"),this.vsc.filterHandler=ql.create(this,this.onVscFilter,null,!1),this.isTop=!0,this.mouseThrough=!0},e.onSelectedView=function(e,t){},e.onVscFilter=function(e,t){if("0"==e){if(AN.ins.getStateByCareList([104]))return 3}else if("1"==e){if(gR.ins.lv<this.lwOpenLv)return 1;if(AN.ins.getStateByCareList([106]))return 3}else if("2"==e){if(dr.getOpenServiceDay()<this.csOpenLv[0]||gR.ins.zsLv<this.csOpenLv[1])return 1;if(AN.ins.getStateByCareList([107]))return 3}return 0},e.setSelectIndex=function(e){switch(e.toString()){case"0":break;case"1":this.vsc.selectedIndex=1}},e.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},e.onAdd=function(e){i.prototype.onAdd.call(this,e),Eg.reqGroup(),AN.reqRedPt([104,106,107]);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_TREASURE",[104,106,107],t),this.setTitle(this.title)},e.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_TREASURE")},e.destroy=function(e){void 0===e&&(e=!0),hN.ins.isOpen("TREASURE_EXCHANGE")||NR.destoryGridImage(),this.vsc=null,i.prototype.destroy.call(this,e)},t}(Ip),HJ=function(i){function t(){var e=this;e.vsc=null,e.ptList=[264],t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.size(720,1280),e.centerX=e.centerY=0}b(t,"modules.treasure.views.TrHeFuMainView",i);var e=t.prototype;return e.initialize=function(){this.navList=["ui/layouts/treasure/yq_btn_hftb.png"];this.vsc=new SB(this),this.title=_r.getAtlasSubPath("treasure/hfhd_title_hftb.png"),this.vsc.registAll([{cls:fz,id:"0",wait:hN.wait(hN.waitConfig(["HeFuDiggerExhibition","ConfigActivityMainType"],["HeFuDiggerExhibition","CActivityMainType"])),grayTip:function(){zB.ins.showMsg(RP.n[924],1)}}]),this.vsc.invalid(),this.title=_r.getAtlasSubPath("treasure/hfhd_title_hftb.png"),this.vsc.filterHandler=ql.create(this,this.checkTips,null,!1),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.isTop=!0,this.mouseThrough=!0},e.onAdd=function(e){i.prototype.onAdd.call(this,e),Eg.reqGroup(),AN.reqRedPt(this.ptList);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_TR_HEFU",[264],t)},e.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_TR_HEFU")},e.destroy=function(e){void 0===e&&(e=!0),hN.ins.isOpen("TREASURE_EXCHANGE")||NR.destoryGridImage(),this.vsc=null,i.prototype.destroy.call(this,e)},e.checkTips=function(e,t){return"0"==e&&AN.ins.getStateByCareList([264])?3:0},e.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("treasure/hfhd_title_hftb.png"))},e.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t}(Ip),VJ=function(i){function n(e){var t=this;t.vsc=null,t.ptList=[260],t.jxA=["TrMysticalExhibition"],t.clsA=["TrMysticalExhibition"],t.mainType=0,t.data_12202=null,t.activityIds=null,n.__super.call(t),t.bottom=t.top=t.left=t.right=0,t.size(720,1280),t.centerX=t.centerY=0}b(n,"modules.treasure.views.TrMysticalMainView",i);var e=n.prototype;return e.initialize=function(){var e=this;e.navList=["ui/layouts/treasure/btn_tab_mysticcal.png"],e.vsc=new SB(e),e.title=_r.getAtlasSubPath("treasure/tb_text_tb.png"),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.isTop=!0,e.mouseThrough=!0},e.onAdd=function(e){i.prototype.onAdd.call(this,e),this.mainType=JP.c_mainType,this.checkInte(),Eg.reqGroup(),AN.reqRedPt(this.ptList);var t=ql.create(this,this.redPtUpdate,null,!1);AN.ins.addListener("BTN_TR_MYSTICAL",[260],t)},e.onRemove=function(e){i.prototype.onRemove.call(this,e),AN.ins.removeListener("BTN_TR_MYSTICAL")},e.destroy=function(e){void 0===e&&(e=!0),hN.ins.isOpen("TREASURE_EXCHANGE")||NR.destoryGridImage(),this.vsc=null,i.prototype.destroy.call(this,e)},e.checkTips=function(e,t){return"0"==e&&AN.ins.getStateByCareList([260])?3:0},e.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("treasure/tb_text_tb.png"))},e.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},e.inteUI=function(e){var t=this;void 0===e&&(e=!1),t.data_12202=mB.getInStance().getMainType(t.mainType);var i=0;if(t.data_12202){t.isTop=!0,t.mouseThrough=!0,t.navList=[],t.activityIds=t.data_12202.activityIds,e&&t.vsc.selectedView&&(t.vsc.selectedView.parent&&t.vsc.selectedView.parent.removeChild(t.vsc.selectedView),t.vsc.selectedView.destroy());var n=[];for(i=0;i<t.activityIds.length;++i){var s=t.activityIds[i],o=It.getIndex(s);if(It.MODEL.mainType(o)==t.mainType){var a=It.MODEL.uiType(o);n.push({cls:JP.getClass(a),id:s,data:s,wait:hN.wait(hN.waitConfig(t.jxA,t.clsA))})}}t.vsc.registAll(n),e?(t.layout.setNavList(t.navList,!0),t.vsc.invalidTab()):t.vsc.invalid()}},e.checkInte=function(){this.inteUI(!0)},n}(Ip),GJ=function(e){function t(){var e=this;e.icons=[],e._data=null,e.expPoolMask=null,e.holyList=[],e._upgradeEff=null,e._isRequestUpgrade=!1,e.roleVo=null,e._weaponName="",t.__super.call(e),e.initUI()}b(t,"modules.godweapon.views.weapon.GodWeaponSkillSubPanel",Vr);var i=t.prototype;return i.initUI=function(){var e=this;e._data=iN.instance,e.expPoolMask=new pp,e.expPoolMask.graphics.drawRect(0,0,e.fullball.width,e.fullball.height,"#FF0000"),e.img_gwSkillbg.skin=_r.getFullUrl("ui/layouts/godweapon/sb_jm_db.jpg"),e.fullball.mask=e.expPoolMask;for(var t=e._data.holyList,i=t.length,n=0;n<i;n++){var s=new MW(t[n]);e.holyBox.addChild(s),s.x=n*(s.width+5),e.holyList.push(s),s.on("click",e,e.onHolyHandler)}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btnAddExp.on("click",t,t.onClickHandler),t.lk_reset.on("click",t,t.onResetHandler),t.btn_attrs.on("click",t,t.onClickHandler),t.btn_help.on("click",t,t.onClickHelp)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.fullball.off("click",t,t.onClickHandler),t.lk_reset.off("click",t,t.onResetHandler),t.btn_attrs.off("click",t,t.onClickHandler),t.btn_help.off("click",t,t.onClickHelp),t.disposeUpgradeEffect()},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(32));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e})},i.clearAll=function(e){void 0===e&&(e=!0)},i.onResetHandler=function(e){var t=this._data.getRoleOwnPts(this.roleVo.roleId)-this._data.getRoleExtPts(this.roleVo.roleId),i=RP.n[925]+Ql.createColor(this._weaponName,"#e0d6c1")+RP.n[926];i+=Ql.createColor(RP.n[927]+t+"技能点","#01b527"),NW.ins.show(i,this._data.costReset,ql.create(this,this.onAlertHandler,[t<=0]),RP.n[928],40,t<=0)},i.onAlertHandler=function(e){e?zB.ins.playErrorMsg(RP.n[929]):sN.reqResetPoints(this.roleVo.roleId)},i.onHolyHandler=function(e){var t=e.currentTarget,i=t.equipPos;if(0==t.locked){var n={roleId:this.roleVo.roleId,position:i};Tu.sendToModule("OPEN_HOLY_SELECTED_PANEL",["modules.godweapon.GodWeaponModule"],n)}else{var s=Si.MODEL.conditionDef(Si.getIndex(i));if(s&&0<s.length){var o=JSON.parse(s)[0].value;zB.ins.playErrorMsg(RP.n[930]+o+"级开启")}else zB.ins.playErrorMsg(RP.n[931])}},i.onClickHandler=function(e){var t=this;if(e.currentTarget==t.btnAddExp){if(!t.roleVo)return;if(t.roleVo.weaponLv+1==Ei.count)return void zB.ins.playErrorMsg("已满级");var i=Ei.MODEL.consumeExp(t.roleVo.weaponLv);if(!t._data)return;0<t._data.leftExp&&0<i&&i<=t._data.leftExp?(t._isRequestUpgrade=!0,sN.reqWeaponUpgrade(t._data.crtRoleId)):zB.ins.playErrorMsg(RP.n[932])}else{if(!t._data)return;LW.instance.show(t._data.crtRoleId)}},i.updateUI=function(e){var t=this;t.roleVo=t._data.rolesDict[t._data.crtRoleId];var i=0,n=0;t.roleVo&&(i=t.roleVo.leftPoint,n=t.roleVo.weaponLv);var s=0;t.lab_level&&(s=parseInt(t.lab_level.text)),s<n&&t._isRequestUpgrade&&t.showUpgradeEffect(),t.lab_level&&(t.lab_level.text=n.toString()),t.lab_crtPoint&&(t.lab_crtPoint.text=i.toString()),t._weaponName=Li.MODEL.name(e-1),t.img_weaponTitle.skin=_r.getGodWeaponPath("v_"+Li.MODEL.icon(e-1)),t.updatePosUI(e,t.roleVo),t.updateAttrsUI(),t.updateExpUI(),t.updateHolyUI()},i.showUpgradeEffect=function(){this._isRequestUpgrade=!1,this._upgradeEff&&this.disposeUpgradeEffect(),null==this._upgradeEff&&(this._upgradeEff=kB.createEffect("jm1078",360,500,this),this._upgradeEff.playEndHandler=ql.create(this,this.disposeUpgradeEffect))},i.disposeUpgradeEffect=function(){this._upgradeEff&&(this._upgradeEff.removeSelf(),this._upgradeEff.destroy(),this._upgradeEff=null)},i.updateHolyUI=function(){for(var e=0;e<this.holyList.length;e++){var t=this.holyList[e],i=t.equipPos,n=!0,s=Si.MODEL.conditionDef(Si.getIndex(i));s&&0<s.length&&(n=!ks.enoughCondition(s,this.roleVo.weaponLv)),t.setData(iN.instance.getGodHoly(this.roleVo.roleId,i),n)}},i.updateAttrsUI=function(){var e=this._data.getWeaponTotalByRoleId(this.roleVo.roleId);this.mc_power.value=RR.getFight(e)},i.updateExpUI=function(){var e=this;null!=e.lab_exp&&(e.lab_exp.text=mp.getBigIntStr(e._data.leftExp,1,!0));var t,i=1,n=0,s=0;e.roleVo&&(n=e.roleVo.useExp,s=e.roleVo.weaponLv);var o=Ei.count,a=!1;o<=s&&(a=!0,s=o),(i=n/(t=Ei.MODEL.exp(s)))<0&&(i=0),1<i&&(i=1),e.img_progress.scaleX=i,a?null!=e.lab_progress&&(e.lab_progress.text=RP.n[933]):null!=e.lab_progress&&(e.lab_progress.text=n+"/"+t);var r=e._data.leftExp/(t/2);1<r&&(r=1);var l=e.fullball.height;e.expPoolMask.y=l-l*r;var c=!1,u=Ei.MODEL.consumeExp(e.roleVo.weaponLv);0<e._data.leftExp&&0<u&&u<=e._data.leftExp&&(c=!0),e.exp_redpt.visible=c},i.updatePosUI=function(e,t){for(var i,n=this,s=n._data.getPositonsByWeaponId(e),o=n.icons.length,a=0;a<3;a++)n["w_"+(a+1)].visible=e==a+1;var r=0;for(r=0;r<s.length;r++)r<o?(i=n.icons[r]).visible=!0:(i=new PW,n.icons.push(i),n.addChild(i)),i.setData(s[r],e,t),i.name=i.positionId+"";for(;r<o;r++)(i=n.icons[r]).visible=!1,i.name="";o=n.icons.length;var l=n.positionBox.graphics;l.clear();for(var c=o;0<c;c--)if((i=n.icons[c-1]).visible)for(var u=i.actived?"#FF0000":"#706a6a",d=null,h=0;h<i.preLinks.length;h++)(d=n.getChildByName(i.preLinks[h]+""))&&l.drawLine(i.posX,i.posY,d.posX,d.posY,u,5)},t}(),UJ=function(i){function t(){var e=this;e.vsc=null,t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.size(720,1280),e.centerX=0,e.mouseThrough=!0,e.vsc=new SB(e),e.vsc.registAll([{cls:GK,id:"1",isHideBg:!0}]),e.vsc.invalid()}b(t,"modules.vip.views.VipPriMV",i);var e=t.prototype;return e.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=new $M;Tu.sendToService(t),this.setTitle(_r.getAtlasSubPath("vip3privilege/mb_text_lqmb.png"))},e.updateVIP3=function(){this.vsc.selectedView instanceof modules.vip.views.Vip3PrivilegeV&&this.vsc.selectedView.update()},t}(Ip),FJ=function(e){function t(){this._eff=null,t.__super.call(this),this.btn_ok.clickHandler=ql.create(this,this.onOK,null,!1)}b(t,"modules.goldrotary.views.GoldRotaryGet",il);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this._eff&&(this._eff.dispose(),this._eff=null),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;if(ui.ViewBase.prototype.onAdd.call(t,e),null==t._eff&&(t._eff=kB.createEffect("jm00711",312,-16,t),t.addChild(t.img_title)),0<sl.ins.result){var i=Ni.getIndex(sl.ins.result);t.img_icon.skin=_r.getAtlasSubPath("goldrotary/gold_icon"+Ni.MODEL.icon(i)+".png"),t.img_icon.pivotX=t.img_icon.width/2,t.img_icon.pivotY=t.img_icon.height/2;var n=Ni.MODEL.order(i),s=Ri.getIndex(n);t.div_name.innerHTML=Ql.createColor(Ri.MODEL.costGold(s)*(Ni.MODEL.rateGroup(i)/100)+"元宝","#fffe41")+""+Ql.createColor("("+Ni.MODEL.rateGroup(i)/100+"倍)","#01b527")}t.alpha=0,Og.to(t,{alpha:1},300)},i.onOK=function(){hN.ins._closePanelForce(this)},t}(),qJ=function(e){function t(){this.BAR_W=301,this.toc24011=null,t.__super.call(this),this.top=220,this.centerX=0}b(t,"modules.nav.views.sub.NavATKTargetHead",em);var i=t.prototype;return i.onEnter=function(){this.visible=pt.now()-uF.attackTimeForYzbqc<3e3,uF.attackTarget&&this.visible?uF.attackTarget.isBoss||uF.attackTarget.isElites?this.visible=!1:this.showRoleInfo():this.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,this.img_bar&&this.img_bar.source&&(this.BAR_W=this.img_bar.source.width),G.timer.loop(1e3,this,this.onEnter)},i.notice=function(e){switch(e.actionOrder){case"HURT_MESSAGE_UPDATE":this.toc24011=e.proto,this.showRoleInfo()}},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clear(this,this.onEnter)},i.onComplete=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.img_head.skin=e,this.img_head.pos(t,i)},i.showRoleInfo=function(){var e=this;if(null!=e.toc24011){dr.dtoEnterScene&&13==dr.dtoEnterScene.type?(e.top=322,e.g_icon.visible=!0):(e.top=220,e.g_icon.visible=!1);var t,i="";if(e.img_head.skin=null,uF.attackTarget){var n=uF.charQueue.take(e.toc24011.targetObjId),s=uF.attackTarget,o=hn.MODEL.muId(hn.getIndex(s.modelId));if(3446==_n.MODEL.key(_n.getIndex(o)))return void(e.visible=!1);if(n&&n.charProfessionName&&(e.txt_guild.text="公会："+n.charProfessionName),s.isElites||s.isBoss||0==s.roleType&&0==s.sex){e.txt_guild.text="";var a=hn.getIndex(s.modelId);e.txt_name.changeText(hn.MODEL.name(a));var r=hn.MODEL.muId(a);a=_n.getIndex(r),i=_n.MODEL.headId(a),t=_r.getBossPath(i),e.img_head.loadImage(t,0,0,0,0,ql.create(e,e.onComplete,[t,-21,-37])),n&&0<n.currHp?e.img_bar.width=e.BAR_W*(n.currHp/n.maxHP):e.visible=!1}else if(e.txt_name.text!=uF.attackTarget.charName&&(n&&e.txt_name.changeText("姓名："+n.char_name),""==s.guideName&&(e.txt_guild.text=RP.n[934]),t=_r.getActorHeadPath(s.roleType,s.sex),e.img_head.loadImage(t,0,0,0,0,ql.create(e,e.onComplete,[t,2,-13]))),n){var l=uF.charIdQueue.take(n.char_id),c=0,u=0;if(l&&0<l.length){for(var d=0;d<l.length;d++)c+=l[d].currHp,u+=l[d].proto.maxHP;n&&0<c?e.img_bar.width=1<c/u?1*e.BAR_W:e.BAR_W*(c/u):e.visible=!1}else n&&0<n.currHp?1<n.currHp/n.maxHP?e.img_bar.width=1*e.BAR_W:e.img_bar.width=e.BAR_W*(n.currHp/n.maxHP):e.visible=!1}}e.txt_name.y=""!=e.txt_guild.text?6:21}},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),G.timer.clearAll(this),this.graphics.clear(),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="NavATKTargetHead",t}(),jJ=function(e){function s(){var e=this;e.ITEM_W=150,e.Page_Num=4,e.openedUI={},e.curOpenUI="",e._panel=null,e._scrollToIndex=-1,e._inTween=!1,e._nums=0,e.lastOpenUI="",e.lastValue=-1,e.tabIsImg=!1,s.__super.call(e),e.bottom_nav.nav.hScrollBarSkin="";for(var t=G.loader.getRes(e.bottom_nav.bottom_bg.skin),i=new pp,n=4;n--;)i.graphics.drawTexture(t,(4-n)*t.width,0,t.width,t.height);e.bottom_nav.bottom_bg.addChild(i),e.bottom_nav.btn_pre.on("click",e,e.onBtnClick,[0]),e.bottom_nav.btn_next.on("click",e,e.onBtnClick,[1]),e.bottom_nav.sp_btn.visible=!1,e.bottom_nav.g_red.visible=!1,0<dr.xgame&&(e.head_bar.btn_close.visible=!1),xs.injectFunction2(xs.bind(e,e.onTabChildChanged),e.bottom_nav.tab,e.bottom_nav.tab._childChanged,"_childChanged",!1,!1)}b(s,"modules.gui.views.layout.LayoutPanel",pc);var t=s.prototype;return t.onBtnClick=function(e){0==e?(this._nums-=3*this.ITEM_W,this._nums<0&&(this._nums=0)):this._nums+=3*this.ITEM_W,this.onNavScroll(this._nums)},t.onNavScroll=function(e){Og.clearAll(this.bottom_nav.nav.hScrollBar),Og.to(this.bottom_nav.nav.hScrollBar,{value:e},200)},t.onPanelChange=function(){var e=this.bottom_nav.nav.hScrollBar.value>=(this.bottom_nav.tab.items.length-this.Page_Num)*this.ITEM_W;this.bottom_nav.btn_pre.visible=e,this.bottom_nav.btn_next.visible=!e,this.bottom_nav.g_red.visible=this.getRPtStatus()},t.getRPtStatus=function(){var e=this;if(e.bottom_nav.tab.items.length-e.Page_Num<=0||e.bottom_nav.btn_pre.visible)return!1;if(e.lastValue==e.bottom_nav.nav.hScrollBar.value)return e.bottom_nav.g_red.visible;if(e.lastValue=e.bottom_nav.nav.hScrollBar.value,1<e.curOpenUI.length&&e.lastOpenUI!==e.curOpenUI&&!e.openedUI[e.curOpenUI])return e.lastOpenUI=e.curOpenUI,e.openedUI[e.curOpenUI]=1,!0;var t=0;for(t=Math.ceil(e.bottom_nav.nav.hScrollBar.value/e.ITEM_W)+3;t<e.bottom_nav.tab.items.length;t++){if(e.bottom_nav.tab.items[t].showTip)return!0}return!1},t.onTabChildChanged=function(e){this.callLater(this.delayTabWidthed)},t.delayTabWidthed=function(){var e=this,t=e.bottom_nav.tab.items.length,i=t*e.ITEM_W+(t>e.Page_Num?e.ITEM_W/2:0);e.bottom_nav.tab.width=t<=4?i:30+i,e.bottom_nav.sp_btn.visible=t>e.Page_Num,e.bottom_nav.sp_btn.visible?(e.bottom_nav.nav.hScrollBar.on("change",e,e.onPanelChange),e.onPanelChange(),e._nums=e.bottom_nav.nav.hScrollBar.value):e.bottom_nav.nav.hScrollBar.off("change",e,e.onPanelChange)},t.setNavList=function(e,t){var i=this;void 0===t&&(t=!1),i.tabIsImg=t;for(var n=i._nums=0;n<e.length;n++){var s;n<i.bottom_nav.tab.items.length?(s=i.bottom_nav.tab.items[n],i.tabIsImg&&!yc.getRes(e[n])?G.loader.load(_r.getFullUrl(e[n]),ql.create(i,i.resetSkin,[e[n],s]),null,"image",1,!0):s.skin=e[n]):(s=i.getTabRes(e[n]),i.bottom_nav.tab.addItem(s))}for(;i.bottom_nav.tab.items.length>e.length;)i.bottom_nav.tab.delItem(i.bottom_nav.tab.items[i.bottom_nav.tab.items.length-1])},t.addPanel=function(e){var t=this;e.centerX=0,e.centerY=NaN;var i=e.navList,n=i?i.length:0;if(0<n)for(var s=0;s<n;s++){var o=t.getTabRes(i[s]);t.bottom_nav.tab.addItem(o)}t.bottom_nav.nav.hScrollBar.off("change",t,t.onPanelChange),t.callLater(t.delayTabWidthed),t.head_bar.title.visible=!0,t.head_bar.title.skin=e.title,e.isTop?t.addChild(e):t.addChildAt(e,1),t._panel=e,t.callLater(t.onScrollTo),t.updateCircle()},t.onStartTween=function(){var e=this.bottom_nav.tab.width-this.bottom_nav.nav.width;e<=0?this.callLater(this.onScrollTo):(this.bottom_nav.nav.scrollTo(),Og.to(this.bottom_nav.nav.hScrollBar,{value:e},200,null,ql.create(this,this.onStartComplete)))},t.onStartComplete=function(){this.timerOnce(100,this,this.onScrollTo)},t.onScrollTo=function(){var e=this,t=e._scrollToIndex,i=0;t+1>=e.bottom_nav.tab.items.length&&(i+=110),(e._scrollToIndex=-1)==t&&(t=e.bottom_nav.tab.selectedIndex)<0&&(t=0),t+e.Page_Num>e.bottom_nav.tab.items.length&&(t=Math.max(e.bottom_nav.tab.items.length-e.Page_Num,0)),(i+=t*e.ITEM_W)==e.bottom_nav.nav.hScrollBar.value?e.onScrollToComplete():Og.to(e.bottom_nav.nav.hScrollBar,{value:i},300,null,ql.create(e,e.onScrollToComplete))},t.onScrollToComplete=function(){this.bottom_nav.nav.mouseEnabled=!0,this._inTween=!1},t.clearScrollTween=function(){var e=this;e._inTween=!1,Og.clearAll(e.bottom_nav.nav.hScrollBar),e.clearTimer(e,e.onStartTween),e.clearTimer(e,e.onScrollTo),e.clearTimer(e,e.delayTabWidthed),e.bottom_nav.nav.mouseEnabled=!0},t.removePanel=function(e){this.removeChild(e);var t=this.bottom_nav.tab.items;if(t)for(var i=t.length-1;0<=i;i--){var n=t[i];this.bottom_nav.tab.delItem(n,!1)}this._panel=null,this.head_bar.title.visible=!1,this.bottom_nav.sp_btn.visible=!1,Og.clearAll(this.bottom_nav.nav.hScrollBar),this.clearScrollTween(),this.updateCircle()},t.updateCircle=function(){var e=this;e._panel&&!SB.isWaiting?e.img_circle.visible&&(e._panel.isHideBg&&(e.g_bg.visible=!e._panel.isHideBg),e.clearTimer(e,e.onTimer),e.img_circle.visible=!1,e.img_circle.rotation=0,e.img_circle.alpha=0,e.img_lt.visible=!1):e.img_circle.visible||(e.img_circle.visible=!0,e.frameLoop(1,e,e.onTimer),e.img_lt.visible=!0,e.g_bg.visible=!0)},t.onTimer=function(){this.img_circle.alpha<1&&(this.img_circle.alpha=Math.min(this.img_circle.alpha+.02,1)),this.img_circle.rotation+=12},t.tabScrollTo=function(e){this._scrollToIndex=e,this._inTween||this.callLater(this.onScrollTo)},t.updateMoney=function(){this.head_bar.txt_coin.changeText(gR.ins.coinStr+""),this.head_bar.txt_gold.changeText(gR.ins.YB+"")},t.setTitle=function(e){this.head_bar.title.skin=e},t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.head_bar.on("click",t,t.onClick),t.updateMoney(),t.img_circle.visible=!1,t.img_circle.rotation=0,t.img_circle.alpha=0,t.updateCircle(),t.dragon_border.centerX=0,t.doResize()},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.head_bar.off("click",t,t.onClick),Nj.globalIdx=0,t.clearTimer(t,t.onTimer),t._scrollToIndex=-1,t.lastValue=-1,t.head_bar.title.skin=null},t.onResize=function(){ui.ViewBase.prototype.onResize.call(this),this.doResize()},t.doResize=function(){var e=G.stage.width;this.bottom_nav.x=e-720>>1},t.onClick=function(e){e.target==this.head_bar.mc_gold||e.target==this.head_bar.txt_gold?this._panel&&Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],this._panel.id):e.target!=this.head_bar.mc_coin&&e.target!=this.head_bar.txt_coin||(HN.ins.reqBuyCoin(),UB.ins.playSound(90006))},t.getTabRes=function(e){var t=kB.createTipButton(e,NI.POINT,0,0,this.ITEM_W,127,2);return t.tipOffX=3,this.tabIsImg&&(yc.getRes(e)||G.loader.load(_r.getFullUrl(e),ql.create(this,this.resetSkin,[e,t]),null,"image",1,!0)),t},t.resetSkin=function(e,t){t.skin=_r.getFullUrl(e)},s._showTweenPanels={},s}(),WJ=function(e){function t(){this._eff=null,this._grids=null,this._arr=null,t.__super.call(this),this.initUI()}b(t,"modules.guide.views.GuideAwardV",Ol);var i=t.prototype;return i.initUI=function(){this.btn_get.clickHandler=ql.create(this,this.onGet,null,!1),this.list_get.renderHandler=ql.create(this,this.onListRender,null,!1),this.clip_lvl2.align="right",this._grids=[]},i.onGet=function(){var e=Rl.ins.toc_info;null!=e&&(1==e.state&&4==e.type?Tu.sendToModule("BP_RECYCLE",["modules.backpack.BackpackModule"]):1==e.state&&5==e.type&&Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]),hN.ins._closePanelForce(this))},i.destroy=function(e){void 0===e&&(e=!0),this._eff&&(this._eff.dispose(),this._eff=null),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.update(),null==this._eff&&(this._eff=kB.createEffect("jm00711",252,58,this),this.addChild(this.img_title))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e);var t=Rl.ins.toc_info;if(null!=t&&2==t.state){Rl.ins.awardId=t.taskId;var i=new oM;Tu.sendToService(i)}},i.setSkin=function(e){this.img_desc.skin=e},i.update=function(){var e=this,t=Rl.ins.toc_info;if(null!=t){var i=t.state,n=t.type;e.btn_get.label=RP.n[935],e.btn_get.disabled=!1,1==i?(e.img_title.skin=_r.getAtlasSubPath("guide/systemboot_title_jlyl.png"),e.btn_get.disabled=!0):e.img_title.skin=_r.getAtlasSubPath("guide/newbie_text_gxn.png");var s=Wn.getIndex(t.taskId);e.clip_lvl.visible=!1,e.clip_lvl2.visible=!1;var o="";if(1==i)if(1==n){var a=parseInt(Wn.MODEL.guideTaskParam(s));o=_r.getGuidePath("txt_sj2"),e.clip_lvl.visible=!0,e.clip_lvl.value=a+"",e.clip_lvl.x=166}else if(2==n)o=_r.getGuidePath("txt_gh2");else if(3==n)o=_r.getGuidePath("txt_dl2");else if(4==n){e.btn_get.disabled=!1,e.btn_get.label=RP.n[936];var r=Wn.MODEL.guideTaskParam(s).split(","),l=(parseInt(r[1]),parseInt(r[2]),parseInt(r[3]));2,e.clip_lvl.visible=!0,e.clip_lvl.value=l+"",o=_r.getGuidePath("txt_hs4"),e.clip_lvl.x=74,e.clip_lvl2.visible=!0,e.clip_lvl2.value="2",e.clip_lvl2.x=160}else 5==n?(oR.checkOpen(gR.ins.actorList.length)&&(e.btn_get.disabled=!1,e.btn_get.label=RP.n[937]),o=_r.getGuidePath("txt_jsjs")):6==n&&(o=_r.getGuidePath("txt_thunder"));else 1==n?(a=parseInt(Wn.MODEL.guideTaskParam(s)),o=_r.getGuidePath("txt_sj"),e.clip_lvl.visible=!0,e.clip_lvl.value=a+"",e.clip_lvl.x=256):2==n?o=_r.getGuidePath("txt_gh"):3==n?o=_r.getGuidePath("txt_dl"):4==n?o=_r.getGuidePath("txt_hs"):5==n?o=_r.getGuidePath("txt_jsjs"):6==n&&(o=_r.getGuidePath("txt_thunder"));if(GB.hasLoaded(o))e.setSkin(o);else GB.retain(o).once("complete",e,e.setSkin,[o]);var c=Wn.MODEL.zhanshiGoodsAward(s);gR.ins.actorById(1).job==ha.FA.type?c=Wn.MODEL.fashiGoodsAward(s):gR.ins.actorById(1).job==ha.DAO.type&&(c=Wn.MODEL.daoshiGoodsAward(s)),null==c&&(c="");var u=c.split(";"),d=Wn.MODEL.resAward(s);if(u.length<6&&d&&0<d.length){for(var h=aR.getMoneysByStr(d).GOLD,_=6-u.length,f="",p=0;p<_;p++)0<p&&(f+=";"),f+="14,"+Math.floor(h/_);0<c.length&&(c=f+";"+c),u=c.split(";")}for(var g=0;g<6;g++){var v=e._grids[g];if(null==v&&((v=new MF).x=e["img_grid"+g].x,v.y=e["img_grid"+g].y,v.size(106,106),e.addChild(v),e._grids[g]=v),g<u.length){v.visible=!0;var m=u[g].split(","),y=parseInt(m[0]),I=parseInt(m[1]),b=yB.create(y,I);b.disAchi=!1,v.bindData=b,e["txt_name"+g].changeText(Bi.MODEL.name(b.cfgIdx))}else v.visible=!1,e["txt_name"+g].changeText("")}if(e._arr=null,e.height=580,e.img_bg.height=500,e.txt_desc.visible=e.img_line.visible=e.list_get.visible=!1,1==i){var w=Wn.MODEL.guideTaskType(s);if(Yn.hasIndex(w)){var x=Yn.getIndex(w);e.txt_desc.changeText(Yn.MODEL.getDesc(x));var S=Yn.MODEL.getEquip(x).split(";");e.list_get.repeatY=S.length,e.list_get.array=S,e._arr=S,e.txt_desc.visible=e.img_line.visible=e.list_get.visible=!0,e.height=e.list_get.y+60*S.length+(S.length-1)*e.list_get.spaceY+30,e.img_bg.height=e.height-80}}}},i.onListRender=function(e,t){if(null!=this._arr&&0!=this._arr.length){var i=this._arr[t],n=i.split("|");e.txt_name.changeText(n[n.length-1]),4==parseInt(n[0])?(e.mc_go.visible=!1,e.txt_go.visible=!1,e.off("click",this,this.onClick)):(e.mc_go.visible=!0,e.txt_go.visible=!0,e.on("click",this,this.onClick,[i]))}},i.onClick=function(e){Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],e),hN.ins._closePanelForce(this)},t}(),YJ=(function(e){function t(){var e=this;e._eff=null,e._effId=null,e._ext=0,t.__super.call(e),e.y=196,e.visible=!1,e._ext=-1,e.initUI(),e.txt_des1.visible=e.txt_des2.visible=!1}b(t,"modules.guide.views.GuideIcon",Pl);var i=t.prototype;G.imps(i,{"modules.nav.others.INav":!0}),i.initUI=function(){this.btn_award.clickHandler=ql.create(this,this.onClick,null,!1),this.on("click",this,this.onClick)},i.clearList=function(){},i.onClick=function(){var e=Rl.ins.toc_info;null!=e&&3!=e.state&&hN.ins.open("GUIDE_AWARD")},i.onHideEnd=function(){this.visible=!1;var e=5!=KW.MAXICONNUM;KW.MAXICONNUM=5,e&&Tu.sendToModule("UPDATE_ACTLEFT_ICON",["modules.nav.NavModule"])},i.notice=function(e){var t=this,i=Rl.ins.toc_info;if(null!=i){if(0==i.taskId||3==i.state)return t.visible&&Og.to(t,{x:-200,alpha:0},500,null,ql.create(t,t.onHideEnd),0,!0),void(t._ext=-1);Og.clearAll(t),t._ext=1,t.visible=!0,t.alpha=1,t.x=15;var n=Wn.getIndex(i.taskId),s=_r.getGuidePath(Wn.MODEL.icon(n));if(GB.hasLoaded(s))t.setSkin(s);else GB.retain(s).once("complete",t,t.setSkin,[s]);var o=4!=KW.MAXICONNUM;KW.MAXICONNUM=4,o&&Tu.sendToModule("UPDATE_ACTLEFT_ICON",["modules.nav.NavModule"])}},i.setSkin=function(e){this.btn_award.skin=e},i.show=function(){null!=Rl.ins.toc_info&&this.notice(null)},i.hide=function(){this._eff&&(this._eff.dispose(),this._eff=null,this._effId=null)},i.close=function(){1==this._ext&&(this._ext=0,this.visible=!1);var e=5!=KW.MAXICONNUM;KW.MAXICONNUM=5,e&&Tu.sendToModule("UPDATE_ACTLEFT_ICON",["modules.nav.NavModule"])},i.open=function(){0==this._ext&&(this.x=-200,this.alpha=0,this.visible=!0,Og.to(this,{x:15,alpha:1},300,pa.sineIn),this._ext=1);var e=4!=KW.MAXICONNUM;KW.MAXICONNUM=4,e&&Tu.sendToModule("UPDATE_ACTLEFT_ICON",["modules.nav.NavModule"])},i.isClear=function(){return!1},p(0,i,"name",function(){return"GuideIcon"}),t.NAME="GuideIcon"}(),function(e){function t(){this.BAR_W=301,this._$8_mask=null,t.__super.call(this),this.visible=!1}b(t,"modules.nav.views.sub.NavTargetHead",cm);var i=t.prototype;return i.notice=function(e){if(this.checkNewSC())this.visible=!1;else switch(e.actionOrder){case"24004":this.showInfo();break;case"24026":this.updateAscriptorHp();break;default:this.resetName()}},i.onAdd=function(e){var t=this;if(ui.ViewBase.prototype.onAdd.call(t,e),t.visible=!1,!t.checkNewSC()){t.img_bar&&t.img_bar.source&&(t.BAR_W=t.img_bar.source.width),ZN.isSynch()?(t.btn.visible=!0,t.btn.on("click",t,t.onBtnClick)):t.btn.visible=!1;var i=BR.ins.curCopyId,n=rn.getIndex(i);15==rn.MODEL.cate(n)&&(t.btn.visible=!1),t.showInfo(),t.bgbox.cacheAs="normal",t.updateAscriptorHp()}},i.checkNewSC=function(){var e=BR.ins.curCopyId,t=rn.getIndex(e);return 14==rn.MODEL.cate(t)&&7777==e},i.showInfo=function(){var e=this,t=BR.ins.toc24004;if(t)if(t.playerId){tr.push(RP.n[938]+t.playerId),tr.push(RP.n[939]+gR.ins.charId);var i=String(t.playerId)==gR.ins.charId;e.txt_name.changeText(t.playerName),e.txt_guild.changeText(""!=t.guildName?t.guildName:RP.n[940]),e.img_head.skin=null,e.img_head.skin=_r.getActorSmallHeadPath(t.roleType,t.sex),e.visible=!0,e.btn.label=i?"放弃归属":RP.n[941],e.setBloodRate(t.hpPrec/100),e.cp_score.value=t.fighting.toString()}else e.visible=!1;var n=dr.dtoEnterScene;if(n&&6==n.type){var s=rn.getIndex(BR.ins.curCopyId),o=rn.MODEL.key(s);0<=BR.ins.checkPersonHasFirstKillReward(o)&&BR.ins.bossPersonHash&&0==BR.ins.bossPersonHash.take(BR.ins.curCopyId).passTimes?e.top=262:e.top=192}else if(!n||7!=n.type&&49!=n.type)e.top=192;else{var a=BR.ins.bossWildHash.take(BR.ins.curCopyId),r=a&&a.isFirstKill;e.top=r?262:192}},i.resetName=function(){tr.push("resetName"),this.btn.label="",this.btn.label=RP.n[942]},i.onBtnClick=function(e){var t=BR.ins.toc24004;t&&(t.objectId==gR.ins.objectId?Tu.sendToService(new xA):sH.fights(t.objectId))},i.onAward=function(){hN.ins.open("BOSS_WILD_SCENE_AWARD",{id:BR.ins.curCopyId})},i.updateAscriptorHp=function(){BR.ins.toc24026&&this.setBloodRate(BR.ins.toc24026.hpPrec/100),BR.ins.toc24004&&BR.ins.toc24004.playerId&&0==this.visible&&(this.visible=!0)},i.setCharhead=function(e,t){},i.setBloodRate=function(e){this.img_bar&&(e<0?e=0:1<e&&(e=1),this._$8_mask||(this._$8_mask=new pp),this.img_bar.mask=this._$8_mask,this._$8_mask.graphics.clear(),this._$8_mask.graphics.drawRect(0,0,this.BAR_W*e,this.img_bar.height,"#000000"))},i.onRemove=function(e){modules.boss.views.scene.Boss_WildKillView.hideAll(!1),ui.ViewBase.prototype.onRemove.call(this,e),this.btn.off("click",this,this.onBtnClick)},i.destroy=function(e){void 0===e&&(e=!0),modules.boss.views.scene.Boss_WildKillView.destroyAll(),G.timer.clearAll(this),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="NavTargetHead",t}()),zJ=function(e){function t(){this.curTaskVo,t.__super.call(this)}b(t,"modules.niepan.views.NiepanNpcTalk",uh);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.updatePanel(),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_Go.tag=0,this.off("click",this,this.onClick)},i.updatePanel=function(){var e=this,t=lB.instance().getProGressDicTaskByType(4);if(t){var i=n_.getIndex(t.questId),n=n_.MODEL.npcTalk(i),s=n_.MODEL.npcName(i),o=n_.MODEL.commitNpc(i);e.txtBB.innerHTML=zB.ins.getDesc(n),e.npcicon.skin=_r.getFullUrl("ui/layouts/niepan/"+o+".png",!1),e.npcname.changeText(zB.ins.getDesc(s)),e.boxa.visible=!1,e.height=480,e.btn_Go.label=RP.n[943],e.btn_Go.tag=1}else if(ON.ins.checkNiepan()){e.boxa.visible=!0,e.height=580;gR.ins.actorFlyUpLevel;if(ON.ins.data31051){var a=ON.ins.getIconName(ON.ins.data31051.curRoleIndex,gR.ins.getJobByIdx(ON.ins.data31051.curRoleIndex)),r=ON.ins.getPreNiepanLevel(ON.ins.data31051.curRoleIndex,gR.ins.getJobByIdx(ON.ins.data31051.curRoleIndex));e.imgLeft.skin=_r.getFullUrl("ui/layouts/niepan/"+r+".png",!1),e.imgRight.skin=_r.getFullUrl("ui/layouts/niepan/"+a+"l.png",!1),e.npcname.changeText(ON.ins.getNpcname(ON.ins.data31051.curRoleIndex,gR.ins.getJobByIdx(ON.ins.data31051.curRoleIndex))),e.txtBB.innerHTML=ON.ins.getdes(ON.ins.data31051.curRoleIndex,gR.ins.getJobByIdx(ON.ins.data31051.curRoleIndex))}e.btn_Go.label=RP.n[944],e.btn_Go.tag=2}else e.btn_Go.tag=0,hN.ins.close("NiepanNpcTalk")},i.onClick=function(e){switch(e.target){case this.btn_Go:if(1==this.btn_Go.tag){var t=lB.instance().getProGressDicTaskByType(4);t&&(sN.reqFinishedTask(t.questId),hN.ins.close("NiepanNpcTalk"),Tu.sendToModule("OPEN_NIEPAN",["modules.niepan.NiepanModule"]))}else if(2==this.btn_Go.tag){var i=new pP;Tu.sendToService(i),hN.ins.close("NiepanNpcTalk")}}},t.NAME="NiepanNpcTalk",t}(),XJ=function(e){var r;function t(){var e=this;e._selector=null,e._curSkill=null,e._targetSkill=null,e._toc12949=null,e._skills=null,e._skillsItem=null,e._skillMap=null,e.tipsSprit=null,e._costGoodsNum1=0,e._costGoodsNum2=0,e._hasSelectReddot=!1,e._reddotData={},e.eff=null,e.sp_reddot=null,e.zpt=new Uh,t.__super.call(e)}b(t,"modules.guild.views.skill.GuildSkill_BaseView",xm);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;iu._initContainer(e),e._selector=new Nj,e.box_c.addChild(e._selector),e._targetSkill=new jF,e.box_c.addChild(e._targetSkill),e._targetSkill.pos(e.target_skill.x,e.target_skill.y),e._skills=[],e._skillsItem=[],e._skillMap={};var t,i,n=0,s=Us.count;for(n=0;n<s;n++){var o=Us.MODEL.skillId(n);t&&t.skillId==o||((t=new r).skillId=o,t.sIndex=n,t.skillIcon="icskill00"+Us.MODEL.skillIcon(n),t.maxLevel=0,t.costDonatePoint=Us.MODEL.costDonatePoint(n),e._skills.push(t),e._skillMap[o]=t,null==e._targetSkill.bindData&&(e._targetSkill.bindData=t,e._targetSkill.x=e.target_skill.x+(e.target_skill.width-e._targetSkill.width>>1),e._targetSkill.y=e.target_skill.y+(e.target_skill.height-e._targetSkill.height>>1)));var a=Us.MODEL.level(n);a>t.maxLevel&&(t.maxLevel=a)}for(n=0;n<e._skills.length;n++)(i=new jF).bindData=e._skills[n],i.x=e["mc_skillbg"+n].x+(e["mc_skillbg"+n].width-i.width>>1),i.y=e["mc_skillbg"+n].y+(e["mc_skillbg"+n].height-i.height>>1),i.on("click",e,e.onSkillClick,[i]),e._skillsItem.push(i),e.box_c.addChild(i);e.changeStartIndex(0),e.btn_study.on("click",e,e.onBtnClick,[e.btn_study]),e.sp_reddot=new pp,e.box_c.addChild(e.sp_reddot)},i.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+e.width-30+9,e.y-1-10,t.width,t.height)},i.refreshNewActor=function(){this._selector&&this._selector.refresh()},i.onGridSelected=function(e,t){this._curSkill=e.bindData,this._targetSkill.bindData=e.bindData,this.updateSkill()},i.onSkillClick=function(e){this.onGridSelected(e,e.bindData.sIndex)},i.onBtnClick=function(e){if(e==this.btn_study){if(UB.ins.playSound(90006),!this._toc12949)return;var t=this._selector.selectIdx+1;if(!this._toc12949.skillDataMap[t])return;var i=this._curSkill;if(vN.ins.myGuildBaseToc.mineContrib<this._costGoodsNum1)return void zB.ins.showMsg(RP.n[945],1);if(gR.ins.coin<this._costGoodsNum2)return void HN.ins.reqBuyCoin();var n=new UM;n.actorId=t,n.skillId=i.skillId,Tu.sendToService(n)}},i.changeStartIndex=function(e){},i.onSelect=function(e){var t=this._selector.selectIdx+1;if(this._toc12949&&!this._toc12949.skillDataMap[t])this.reqSkillInfo();else{var i=this.findNextStudySkill();this._curSkill=this._skills[i],this.updateSkill()}},i.updateByVSC=function(e){var t=this;if(e instanceof protos.guild.toc_12949){if(t._toc12949=e,t.updateReddotData(),!t._hasSelectReddot){var i=t.findNextStudySkill();t._curSkill=t._skills[i],t._hasSelectReddot=!0}t.updateSkill()}else"BP_UPDATE"!=e.actionOrder&&"10205"!=e.actionOrder||(t.updateReddotData(),t.updateNum(),t.updateSkill())},i.updateNum=function(){this.sp_reddot.graphics.clear();for(var e=this._selector.selectIdx+1,t=this._reddotData[e],i=0;i<this._skills.length;i++)0<=t.indexOf(this._skills[i].skillId)&&this.drawReddot(this._skillsItem[i])},i.updateReddotData=function(){var e=this,t=e._hasSelectReddot;for(var i in e._toc12949.skillDataMap){for(var n=e._toc12949.skillDataMap[i],s=[],o=0;o<e._skills.length;o++){var a=e._skills[o],r=a.skillId,l=null==n[r]?0:n[r],c=a.sIndex+l;0<=c&&Us.MODEL.skillId(c)==r&&(e._costGoodsNum1=Us.MODEL.costDonatePoint(c),e._costGoodsNum1&&0<e._costGoodsNum1&&vN.ins.myGuildBaseToc.mineContrib>=e._costGoodsNum1&&gR.ins.coin>=e._costGoodsNum2&&s.push(r))}e._reddotData[i]=s,e._selector.setRedPtByIdx(i-1,0<s.length),!t&&0<s.length&&(e._selector.off("select",e,e.onSelect),e._selector.selectIdx=i-1,e._selector.on("select",e,e.onSelect),t=!0)}},i.findNextStudySkill=function(e){if(void 0===e&&(e=0),!this._toc12949)return e;var t=this._selector.selectIdx+1;if(!this._toc12949.skillDataMap[t])return e;for(var i=this._reddotData[t],n=this._skills.length,s=0;s<n;s++){var o=e+s;n<=o&&(o-=n);var a=this._skills[o].skillId;if(-1!=i.indexOf(a))return o}return e},i.onGridRender=function(e,t){var i=this._selector.selectIdx+1,n=this._reddotData[i];if(n&&0!=n.length){var s=G.loader.getRes(NI.POINT),o=e.bindData.skillId;if(-1!=n.indexOf(o))iu.layerGraphics(e,15,this.zpt.setTo(0,0)).drawTexture(s,this.zpt.x+e.width-s.width,this.zpt.y,s.width,s.height)}},i.updateSkill=function(){var e=this;if(e._toc12949){var t=e._selector.selectIdx+1,i=e._toc12949.skillDataMap[t];if(i){e.skillSelect.x=e["mc_skillbg"+(e._curSkill.skillId-1)].x,e.skillSelect.y=e["mc_skillbg"+(e._curSkill.skillId-1)].y,e.box_c.setChildIndex(e.skillSelect,e.box_c.numChildren-1),e.box_c.setChildIndex(e.sp_reddot,e.box_c.numChildren-1);var n=e._curSkill,s=n.skillId,o=0;null!=i[s]&&(o=i[s]),e.clearAttrs();var a,r=o>=n.maxLevel;if(r)e.btn_study.disabled=!0,e.sp_study.visible=!1,e.img_ymj.visible=!0,e.img_arrow.visible=!1,e.txt_nolearn.visible=!1;else{e.btn_study.disabled=!1,e.sp_study.visible=!0,e.img_ymj.visible=!1,e.img_arrow.visible=!0;var l=n.sIndex+(0==o?1:o),c=Us.MODEL.attrs(l);0==o?e.txt_nolearn.visible=!0:(e.drawLeftText(aa.formatAttrToChineseByList(c)),e.txt_nolearn.visible=!1),o++}l=n.sIndex+o-1,e.txt_name.changeText(e.getName(Us.MODEL.name(l))),e._costGoodsNum1=Us.MODEL.costDonatePoint(l),e.txt_cost0.innerHTML=Ql.createColor(""+e._costGoodsNum1,e._costGoodsNum1>vN.ins.myGuildBaseToc.mineContrib?"#e70909":"#e3dcc2"),e.txt_costres.innerHTML=Ql.createColor(""+vN.ins.myGuildBaseToc.mineContrib,"#e3dcc2"),r?(c=Us.MODEL.attrs(l+1),e.drawLeftText(aa.formatAttrToChineseByList(c),!0,"#23b11f"),e.next_att.visible=!1):(c=Us.MODEL.attrs(l+1),e.drawRightText(aa.formatAttrToChineseByList(c)),e.next_att.visible=!0),!r&&vN.ins.myGuildBaseToc.mineContrib>=e._costGoodsNum1&&gR.ins.coin>=e._costGoodsNum2?e.eff||(e.eff=kB.createEffect("jm1130",e.btn_study.width>>1,e.btn_study.height>>1,e.btn_study),e.eff.scale_X=1.25,e.eff.scale_Y=1.25):(e.eff&&e.eff.dispose(),e.eff=null);for(var u=e._toc12949.skillDataMap[t],d=0;d<e._skills.length;d++){a=e._skillsItem[d];var h=null==u[e._skills[d].skillId]?0:u[e._skills[d].skillId];e["skillname"+d].innerHTML=e.getName(Us.MODEL.name(a.bindData.sIndex))+"<font style='color:#e6d80d;'>(Lv."+h+")</font>"}e.updateNum()}}},i.getName=function(e){return 1==e?"刃意":2==e?"固本":3==e?"铁壁":""},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML="<font style='color:"+i+";'>"+a.sname+":</font>",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.drawRightText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#23b11f"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_r"+o],l=this["txt_attrname_r"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.sname+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+"</font>"}},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attr_r"+e],n=this["txt_attrname_l"+e],s=this["txt_attrname_r"+e];t.visible=!1,i.visible=!1,t.style.wordWrap=!1,i.style.wordWrap=!1,n.visible=!1,s.visible=!1}},i.updateAttri=function(e,t,i,n){void 0===n&&(n=!1);var s,o,a=aa.formatAttrToChineseByList(t);if(1==a.length?s=[-1,0,-1]:2==a.length?s=[0,-1,1]:3==a.length&&(s=[0,1,2]),e.graphics.clear(),n)return!o&&(o=G.loader.getRes(_r.getAtlasSubPath("basic_ui/comp_textbg.png"))),Cl.draw9Grid(e.graphics,o,0,35,222,31,[3,0,3,0]),void e.graphics.fillText("未学习",96,37,"24px SimHei","#01fb01","center");for(var r=0;s&&r<s.length;r++){var l=-1!=s[r]?a[s[r]]:null;if(l){!o&&(o=G.loader.getRes(_r.getAtlasSubPath("basic_ui/comp_textbg.png"))),Cl.draw9Grid(e.graphics,o,0,40*r,222,31,[3,0,3,0]);var c=l.name+"：";e.graphics.fillText(c,16,2+40*r,"24px SimHei","#a19980","left");var u=16+xs.getTextWidth(c),d=""+l.val;e.graphics.fillText(d,u,2+40*r,"24px SimHei",i,"left")}}},i.formatAttr=function(e,t,i){void 0===i&&(i=!1);for(var n=aa.formatAttrToChineseByList(e),s="",o=0;o<n.length;o++){var a=n[o];s=s+a.name+"："+Ql.createColor(i?"0":a.val,t),o<n.length-1&&(s+="<br/>")}return s},i.showByVSC=function(e,t){this._selector.on("select",this,this.onSelect),this._hasSelectReddot=!1,this.refreshNewActor(),this.reqSkillInfo()},i.reqSkillInfo=function(){var e=new GM;Tu.sendToService(e)},i.hideByVSC=function(e,t){this._selector.off("select",this,this.onSelect),this._toc12949=null,this.eff&&this.eff.dispose(),this.eff=null},i.destroy=function(e){void 0===e&&(e=!0),this.sp_reddot&&(this.sp_reddot.parent.removeChild(this.sp_reddot),this.sp_reddot=null),G.loader.getRes(this.guildskillbg.skin)&&G.loader.clearRes(this.guildskillbg.skin,!0),laya.ui.View.prototype.destroy.call(this,e)},t.__init$=function(){r=function(){function e(){this.skillId=0,this.skillIcon=null,this.sIndex=0,this.maxLevel=0,this.costDonatePoint=0}return b(e,""),e}()},t}(),QJ=function(e){function t(){var e=this;e.showDataVo=null,e.tween1=null,e.tween2=null,e.tween3=null,e.ballTween=null,e._handEff=null,e._imgSoul=null,t.__super.call(e),e._imgSoul=new Kl,e._imgSoul.pos(202,334),e.addChild(e._imgSoul)}b(t,"modules.soul.views.soulskin.SoulSkinActiveView",xp);var i=t.prototype;return i.showData=function(e){var t=this;t.showDataVo=e,UB.ins.playSound("23"),t._imgSoul.skin=_r.getFullUrl("ui/images/soul/yshh_zs_"+t.showDataVo.type+".png"),t.box_lv.scale(0,0),t.boxName.scale(0,0),t._imgSoul.scale(0,0),t.box_bottom.alpha=0,t.bg.centerX=0,t.tween1&&t.tween1.clear(),t.tween1=Og.to(t.box_bottom,{alpha:1},500,pa.linearIn,ql.create(t,t.createEff)),G.timer.once(1100,t,t.addClickFun)},i.addClickFun=function(){this.once("click",this,this.close2)},i.onEffectComplete=function(){this.ballTween=Og.to(this._imgSoul,{scaleX:1,scaleY:1},200,pa.linearIn),this.tween2=Og.to(this.box_lv,{scaleX:1,scaleY:1},200,pa.linearIn),this.tween3=Og.to(this.boxName,{scaleX:1,scaleY:1},200,pa.linearIn)},i.createEff=function(){var e=this;e._handEff=kB.createEffect("jm1034",360,389,e),e._handEff.scaleX=e._handEff.scaleY=1.2,e._handEff.alpha=0,null!=e.tween2?e.tween2.clear():e.tween2=new Og,e.tween2=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onEffectComplete)),e.txName.changeText(e.showDataVo.name),e.mc_level.value="1"},i.close2=function(){var e=this;e._handEff&&(e._handEff.parent&&e._handEff.parent.removeChild(e._handEff),e._handEff=null),hN.ins._closePanel(e),G.timer.clearAll(e),Og.clearAll(e),e.tween1&&e.tween1.clear()},t.NAME="SoulSkinActiveView",t.HANDEFFID="jm1034",t}(),JJ=function(e){function t(){this._list=[aa.MAXHP,aa.MAXMP,aa.ATK,aa.DEF,aa.MDEF,aa.CRI_RATE,aa.CRI_QD_RATE,aa.PARALYSIS_RATE,aa.PARALYSIS_RES_RATE],this._total=0,this._curIdx=0,this._lbox=null,t.__super.call(this)}b(t,"modules.xinfa.view.XinfaAttrShowPanel",U);var i=t.prototype;return i.show=function(e){this._total=gR.ins.actorList.length,this._curIdx=e.actor,this.showValue(this._curIdx)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._curIdx=1,this.clearAll()},i.showValue=function(e){var t,i=this,n=e-1,s=gR.ins.actorList[n],o=pB._xinfaDataHash.take(e).infos,a=0;for(o.sort(i.sortOn),a=0;a<o.length;a++)0==o[a].steps&&0==o[a].level||(0<o[a].steps||0<o[a].level)&&(t=o[a]);if(t){var r=pB.ins.getCurIndex(t.steps,t.level,t.xinfa),l=pv.MODEL.attrsForClient(r),c=t.books,u=[];for(u.push(l),a=0;a<c.length;a++){var d=pB.ins.getCIndexByInfo(c[a]);-1<d&&u.push(hv.MODEL.attrsForClient(d))}var h=[];for(a=0;a<u.length;a++)"string"==typeof u[a]&&0<u[a].length&&h.push(aa.formatAttrToChineseByList(u[a]));var _,f={};for(a=0;a<h.length;a++)for(var p=h[a],g=0;g<p.length;g++)if(f[p[g].addName]){var v=parseInt(f[p[g].addName].val)+parseInt(p[g].val);f[p[g].addName].val=v}else f[p[g].addName]={addName:p[g].addName,val:p[g].val};for(var m in h=[],f)_=f[m],h.push(_);i._lbox||(i._lbox=new dt,i._lbox.pos(128,120),i.addChild(i._lbox)),i._lbox.graphics.clear();var y,I=0;for(a=0;a<i._list.length;a++){y=i._list[a],i._list[a].id;for(var b=0;b<h.length;b++)h[b].addName==y.name&&(i._lbox.graphics.fillText(y.attrName+" ： ",100,4+42*I,"24px SimHei","#90877b","right"),i._lbox.graphics.fillText(h[b].val+"",103,4+42*I,"24px SimHei","#e0d6ca","left"),I++,h.splice(b,1))}if(h.length)for(a=0;a<h.length;a++)h[a].addName==RP.n[946]&&(i._lbox.graphics.fillText(RP.n[947],100,4+42*I,RP.n[948],"#90877b","right"),i._lbox.graphics.fillText(h[a].val+"",103,4+42*I,"24px SimHei","#e0d6ca","left"),I++,h.splice(a,1));for(a=1;a<=3;a++)i["mcJob_"+a].visible=s.job==a;i.showLR()}},i.sortOn=function(e,t){return t.xinfa-e.xinfa},i.onClick=function(e){e.target==this.btnL?(this._curIdx-=1,this.showValue(this._curIdx)):e.target==this.btnR&&(this._curIdx+=1,this.showValue(this._curIdx))},i.showLR=function(){var e=this;1==e._total?(e.btnL.visible=!1,e.btnR.visible=!1):1==e._curIdx?(e.btnL.visible=!1,e.btnR.visible=!0):e._curIdx==e._total?(e.btnL.visible=!0,e.btnR.visible=!1):(e.btnL.visible=!0,e.btnR.visible=!0)},i.clearAll=function(){this._lbox&&(this._lbox.destroy(!0),this._lbox=null)},t.GAP=42,t.START_PY=2,t.START_TY=4,t}(),ZJ=function(e){function t(){var e=this;e._BAR_W=0,e.mainType=0,e.actId=1069,e.bigwardgrid=null,e.wardArr=null,e._tween=null,e.actInfo=null,e.cost=0,e.isAuto=0,e.addluck=0,e.isFist=0,e.eTime=NaN,e.countfire=0,e.intervalTime=20,t.__super.call(e),e.mcItems.hScrollBarSkin="",e.mcItems.scrollBar.elasticBackTime=300,e.mcItems.scrollBar.elasticDistance=100,e.mcItems.scrollBar.on("end",e,e.onScrollEnd),e.mcItems.selectEnable=!0,e.bigwardgrid=new MF,e.bigward.addChild(e.bigwardgrid),e.list.itemRender=oq,e.list.vScrollBarSkin="",e.list.spaceY=10,e.list.scrollBar.elasticDistance=200,e.wardArr=[],e.mc_bar.mask=e.bar_mask}b(t,"modules.jianbao.view.JianbaoView",cc);var i=t.prototype;return i.onAdd=function(e){var t=this;t._BAR_W=t.mc_bar.width,t.btn_left.on("click",t,t.onClick),t.btn_right.on("click",t,t.onClick),t.btn_one.on("click",t,t.onClick),t.btn_auto.on("click",t,t.onClick);var i=mB.getInStance().getMainType(14);t.actId=i?i.activityIds[0]:0,WB.getActivityData(t.actId,ql.create(t,t.onActivity)),t.isAuto=0,t.btn_left.visible=!1,t.bar_mask.x=-t._BAR_W},i.onActivity=function(){this.actInfo=mB.getInStance().getActivityData(this.actId)},i.onRemove=function(e){var t=this;t.btn_left.off("click",t,t.onClick),t.btn_right.off("click",t,t.onClick),t.btn_one.off("click",t,t.onClick),t.btn_auto.off("click",t,t.onClick),t.stopHander(),ui.ViewBase.prototype.onRemove.call(t,e)},i.onClick=function(e){var t=this;switch(e.target){case t.btn_right:var i=t.mcItems.startIndex+4;i>=t.mcItems.length&&(i=t.mcItems.length-1),t.mcItems.startIndex!=i&&t.mcItems.tweenTo(i,150*(i-t.mcItems.startIndex),ql.create(t,t.onScrollEnd));break;case t.btn_left:(i=t.mcItems.startIndex-4)<0&&(i=0),t.mcItems.startIndex!=i&&t.mcItems.tweenTo(i,150*(t.mcItems.startIndex-i),ql.create(t,t.onScrollEnd));break;case t.btn_one:t.jianbaoHander();break;case t.btn_auto:t.autoHander()}},i.jianbaoHander=function(){if(gR.ins.YB<this.cost)return KQ.ins.showNoGold(),void this.stopHander();if(!TR.ins.hasEmptyNum(20))return KQ.ins.showBagRecycle(),void this.stopHander();if(hN.ins.isOpen("OfflinePanelView"))this.stopHander();else{var e=new qc;e.lotteryID=this.actId,e.lotteryNum=1,Tu.sendToService(e)}},i.autoHander=function(){this.isAuto?this.stopHander():gR.ins.YB<this.cost?KQ.ins.showNoGold():TR.ins.hasEmptyNum(20)?(this.btn_one.disabled=!0,this.btn_auto.label="停 止",this.isAuto=1,this.jianbaoHander(),G.timer.loop(500,this,this.jianbaoHander)):KQ.ins.showBagRecycle()},i.stopHander=function(){this.isAuto=0,G.timer.clear(this,this.jianbaoHander),this.btn_one.disabled=!1,this.btn_auto.label=RP.n[949]},i.onScrollEnd=function(){this.mcItems.array.length<=4||(0==this.mcItems.scrollBar.value?this.btn_left.visible=!1:this.btn_left.visible=!0,this.mcItems.scrollBar.value==this.mcItems.scrollBar.max?this.btn_right.visible=!1:this.btn_right.visible=!0)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.activity.Lottery_back_MyAllRecord_toc_31032)0==t.isFist?(t.isFist=1,t.wardArr=e.recordArr):t.wardArr=t.wardArr.concat(e.recordArr),t.updateRecord(t.wardArr);else if(e instanceof protos.activity.Lottery_back_MyRecord_toc_31031){t.updateStatu();var i=e.recordArr[0],n=js.MODEL.bigRewardId(js.getIndex(t.actId)),s=Ws.MODEL.needShow(Ws.getIndex(i.configID));n==i.configID?(t.stopHander(),t.playFireworkEffect()):s||(t.wardArr=t.wardArr.concat(e.recordArr)),t.updateRecord(t.wardArr);var o=yB.createStr(Ws.MODEL.rewardDef(Ws.getIndex(i.configID))).goodsId;zB.ins.playGetItemsByPos([o],new Uh(t.stage.width/2,t.stage.height/2-100))}else e instanceof protos.activity.Lottery_back_LotteryTime_toc31033&&(t.showBar(e),t.updateWard(),t.updateStatu())},i.updateWard=function(){var e=this;if(!(e.mcItems.array&&0<e.mcItems.array.length)){e.mainType=14;var t=mB.getInStance().getMainType(e.mainType);e.actId=t?t.activityIds[0]:0;for(var i,n=[],s=[],o=js.MODEL.showaward(js.getIndex(e.actId)).split(";"),a=0;a<o.length;a++)o[a]&&(s=o[a].split(","),i=yB.create(s[0],s[1]),0==a?e.bigwardgrid.bindData=i:n[n.length]=i);0!=n.length?(e.mcItems.visible=!0,e.mcItems.selectedIndex=-1,e.mcItems.itemRender=dq,e.mcItems.dataSource=n,e.mcItems.scrollTo(0),e.mcItems.array.length<=4&&(e.btn_right.visible=e.btn_left.visible=!1)):e.mcItems.visible=!1}},i.updateStatu=function(){var e=this,t=js.MODEL.consumptionDef(js.getIndex(e.actId));if(t){var i=JSON.parse(t);if(i){var n=i[0].value.split(":")[1];e.txt_cost.innerHTML=n+"",e.cost=n}}e.lefttime.innerHTML="",e.des.innerHTML=It.MODEL.desc(It.getIndex(e.actId)),e.actInfo&&(e.onResetTime(!0),e.eTime=e.actInfo.endTime-dr.serverTimeSec,0<e.eTime&&G.timer.frameLoop(10,e,e.onResetTime))},i.showBar=function(e){var t=this,i=js.MODEL.thresholdLimit(js.getIndex(t.actId)),n=0==e.lotteryTime?0:e.lotteryTime/i;t._tween=Og.to(t.bar_mask,{x:-t._BAR_W+n*t._BAR_W},100,null),t.addluck=js.MODEL.addLuck(js.getIndex(t.actId)),t.html_proces.innerHTML=e.lotteryTime*t.addluck+"/"+i*t.addluck},i.onResetTime=function(e){var t=this;void 0===e&&(e=!1),t.eTime=t.actInfo.endTime-dr.serverTimeSec,0<t.eTime?1<=Math.floor(t.eTime/86400)?t.lefttime.innerHTML=Ql.createColor(Jp.getSTRDHMS(t.eTime),"#23b11f"):t.lefttime.innerHTML=Ql.createColor(Jp.getSTRDHMS(t.eTime),"#ff2e24"):(t.lefttime.innerHTML=Ql.createColor("已结束","#ff2e24"),e||(G.timer.clear(t,t.onResetTime),t.parent&&hN.ins._closePanel(t.parent)))},i.updateRecord=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){var n={};n.playerName=e[i].playerName,"1"==Ws.MODEL.needShow(Ws.getIndex(e[i].configID))&&(n.configID=yB.createStr(Ws.MODEL.rewardDef(Ws.getIndex(e[i].configID))).goodsId,t.push(n))}t.reverse(),this.list.array=t,this.img_jb.visible=5<=t.length},i.playFireworkEffect=function(){for(var e=80,t=this.countfire=0;t<6;t++)G.timer.once(e,this,this.playFirework,null,!1),e=20+Math.ceil(180*Math.random())},i.playFirework=function(){var e;(e=mj.GetNew()).renderInSelf=!0,e.loadEffect("jm1314"),e.playEndHandler=ql.create(this,this.effEnd,[e]),e.setXY(150+Math.ceil(400*Math.random()),300+Math.ceil(200*Math.random())),this.addChild(e)},i.effEnd=function(e){e.parent.removeChild(e),e.dispose(),e=null},t}(),KJ=function(e){function t(){this._eff=null,this._tweener=null,t.__super.call(this),this.btnEntrance.on("click",this,this.onBtnEntrance)}b(t,"modules.limitChallenge.views.LimitChallengeOpenView",vc);var i=t.prototype;return i.onBtnEntrance=function(e){mN.shouldOpen=!0,this.close()},i.close=function(){var e=this;if(e.x=G.stage.width-e.width>>1,e.y=G.stage.height-e.height>>1,e.centerX=NaN,e.centerY=NaN,e.parent){var t=sJ.ins.getCompomentsByName("NavBottom");if(null==t||null==t.boxR)return void e.onComplete();var i=t.boxR.localToGlobal(new Uh(t.boxR.width/2,t.boxR.height/2));null!=e._tweener&&e._tweener.clear(),e._tweener=Og.to(e,{x:i.x,y:i.y,scaleX:0,scaleY:0,alpha:0},800,pa.sineOut,ql.create(e,e.onComplete))}null!=e._eff&&(e._eff.removeSelf(),e._eff.dispose(),e._eff=null)},i.onComplete=function(){this.parent&&(eq.panelLayer?eq.panelLayer.close(this):this.parent.removeChild(this)),hN.ins.isOpen("LIMIT_CHALLENGE_MAIN_VIEW")||Tu.sendToModule("OPEN_LIMIT_CHALLENGE_MAIN",["modules.limitChallenge.LimitChallengeModule"])},i.show=function(){var e=this;e.parent||(eq.panelLayer?eq.panelLayer.open(e,!1,!0,!1):G.stage.addChild(e),null==e._eff?(e._eff=kB.createEffect("jm1130",e.btnEntrance.width>>1,e.btnEntrance.height>>1,e.btnEntrance),e._eff.scale_X=1.25,e._eff.scale_Y=1.25):e.btnEntrance.addChild(e._eff),e.onResize()),e.x=NaN,e.y=NaN,e.alpha=1,e.scale(1,1),e.centerX=0,e.centerY=0},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.limitchallenge.LimitChallengeOpenViewUI._$SET_ins),t.iconTip=null,t._inst=null,t}(),$J=function(e){function t(){this._gridsList=null,t.__super.call(this)}b(t,"modules.magic.views.item.MagicTowerAwardItem",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.x=190,e._gridsList.y=-22,e._gridsList._spaceX=68,e._gridsList.size(360,130),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=e._gridsList._gridH+3,e.addChild(e._gridsList))},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(e){var t=IN.getMagicTowerAward(e.index,e.level+1);t&&""!=t&&this._gridsList.setGoodsItems(t,6);var i=!1;i=IN.isPassAll?0<=e.level&&e.level+1==e.pass:1<=e.level&&e.level+1==e.pass,this.g_bg.skin=i?_r.getAtlasSubPath("basic_ui_g/ty_jm_hsjbd.png"):_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzjbd.png"),this.g_quality.skin=_r.getAtlasSubPath("magic/quality_"+e.level+".png")}}),t}(Pm),eZ=function(e){function t(){this._data=null,t.__super.call(this)}b(t,"modules.magic.views.item.MagicTowerRankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_name.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._data=null,this.txt_name.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){if(this._data)if(this._data.id.toString()!=gR.ins.charId){QB.ins.playID=this._data.id,hN.ins.open("FRIENDNEWADDFRIENDVIEW");var t=new lM;t.targetId=this._data.id,Tu.sendToService(t)}else zB.ins.showMsg(RP.n[703],1)},i.getTcolor=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386"}return"#90877b"},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t._data=e,t.txt_name.text=e.n,t.txt_name.color=t.getTcolor(e.r),t.txt_time.text=Jp.getTickMS(e.sv),t.txt_step.text=e.v+"层",t.g_rank.visible=e.r<4,t.g_rank.visible?(t.g_rank.skin=_r.getAtlasSubPath("base_ui2/phb_dj_"+e.r+".png"),t.g_bg.skin=_r.getAtlasSubPath("base_ui2/phb_db_no"+e.r+".png")):t.g_bg.skin=_r.getAtlasSubPath("basic_ui_3/ty_btn_lb_2.png"),t.txt_rank.visible=!t.g_rank.visible,t.txt_rank.visible&&t.txt_rank.changeText(e.r))}),t}(Nm),tZ=function(e){function t(){this._array=null,this._gridsList=null,this.baokuData,t.__super.call(this)}b(t,"modules.magic.views.MagicBaokuView",qm);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new vj(4),e._gridsList.pos(75,743),e._gridsList.size(480,180),e._gridsList._gsimpleName=!0,e._gridsList._spaceX=35,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.addChild(e._gridsList),e._array=[];for(var t=BR.ins.getBossIds(42),i=0;i<t.length;i++){var n=t[i],s=rn.getIndex(n),o=rn.MODEL.isCard(s);e._array.push({id:n,isCard:o,cate:42})}e.txt_des.style.font="SimHei",e.txt_des.style.fontFamily="SimHei",e.txt_des.style.fontSize=22,e.txt_des.style.color="#90877b",e.txt_des.innerHTML=RP.n[951]},i.updateByVSC=function(e){e instanceof protos.magic.toc_21247&&(this.baokuData=e,this.updateReward(this.baokuData.missonId),this.updateStatus())},i.updateReward=function(e){var t=rn.getIndex(e),i=t,n=(rn.MODEL.bossId(t),rn.MODEL.bossShowAward(i));this._gridsList.setGoodsItems(n,3),this._gridsList.x=(this.width-this._gridsList.contentWidth)/2},i.updateStatus=function(){var e=this;e.txNum.innerHTML=e.baokuData.leftChanllengeTime+"";var t=e.baokuData.shopModelId,i=Nn.getIndex(t),n=Nn.MODEL.VipLimit(i).split(",")[0];0==e.baokuData.leftChanllengeTime&&0<e.baokuData.vipCanByTimes&&gR.ins.VIPLevel>=n?e.btn_buy_time.visible=!0:e.btn_buy_time.visible=!1,1==e.baokuData.missonStatus?e.btn_challenge.label="扫 荡":e.btn_challenge.label="挑 战",0<e.baokuData.leftChanllengeTime?e.btn_challenge.showTip=!0:e.btn_challenge.showTip=!1},i.onAdd=function(e){this.btn_buy_time.on("click",this,this.onClickLink),this.btn_challenge.on("click",this,this.onClickLink),jR.reqCopy(44),ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){this.btn_buy_time.off("click",this,this.onClickLink),this.btn_challenge.off("click",this,this.onClickLink),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClickLink=function(e){switch(e.target){case this.btn_buy_time:this.buyTimeTip();break;case this.btn_challenge:if(!this.baokuData)return;if(this.baokuData.leftChanllengeTime<1)return void zB.ins.showMsg(RP.n[952],1);if(!TR.ins.hasEmptyNum(20))return void KQ.ins.showBagRecycle();if(UR.instance.fullPower&&UR.instance.isAuto&&!BR.ins.isCheckPointBoss)return void zB.ins.showById(2126,1);this.enterCopyZone()}},i.enterCopyZone=function(){1==this.baokuData.missonStatus?jR.reqMagicBaoku(this.baokuData.missonId):(bN.reqChallengeCopy(this.baokuData.missonId),G.timer.once(300,this,function(){hN.ins.close("MAGIC_VIEW")}))},i.buyTimeTip=function(){if(null!=this.baokuData)if(0!=this.baokuData.vipCanByTimes&&0!=this.baokuData.shopModelId){var e=this.baokuData.shopModelId,t=Nn.getIndex(e),i=Nn.MODEL.price(t),n=Nn.MODEL.goodsId(t),s=Bi.getIndex(n),o=(Bi.MODEL.name(s),RP.n[954]+Ql.createColor(i+"元宝","#fcd132")+RP.n[955]+Ql.createColor("1次","#23b11f")+RP.n[956]+RP.n[957]+Ql.createColor(this.baokuData.vipCanByTimes+"次","#23b11f"));KQ.ins.show(o,ql.create(this,this.onBuyAlert),!1,3,null,null,!0,i)}else zB.ins.showMsg(RP.n[953],1)},i.onBuyAlert=function(e){if(null!=this.baokuData&&1==e){var t=this.baokuData.shopModelId,i=Nn.getIndex(t),n=Nn.MODEL.price(i);if(gR.ins.YB<n)return void zB.ins.playErrorMsg(RP.n[468]);wN.reqBuyMallGood(this.baokuData.shopModelId,1)}},t}(),iZ=function(e){function t(){this.index=0,this.extraVo=null,this.item=null,this.equitImg=null,this.g_got=null,t.__super.call(this)}b(t,"modules.magic.views.MagicTowerView",Rm);var i=t.prototype;return i.initialize=function(){this.list_award.itemRender=$J,this.list_award.vScrollBarSkin="",this.list_rank.itemRender=NJ,this.list_rank.vScrollBarSkin="",this.list_rank.repeatY=3,this.txt_tips.innerHTML=RP.n[959]},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_rank.on("click",t,t.onClickHandler),t.btn_challenge.on("click",t,t.onClickHandler),t.txt_lock.on("link",t,t.onLinkHandler),t.updateByVSC(),BN.reqRank(16)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.txt_rank.off("click",t,t.onClickHandler),t.btn_challenge.off("click",t,t.onClickHandler),t.txt_lock.off("link",t,t.onLinkHandler),t.item&&(t.item.parent&&t.item.parent.removeChild(t.item),t.item.destroy(),t.item=null),G.timer.clearAll(t)},i.updateByVSC=function(e){var t=this;if(IN.mTowerData){(IN.isPassAll||1!=IN.mTowerData.pLevel)&&0<IN.mTowerData.pLevel?t.index=sn.getIndex(IN.mTowerData.pId):t.index=sn.getIndex(IN.mTowerData.pId+1),t.txt_tips.visible=IN.isPassAll,t.btn_challenge.showTip=0<IN.mTowerData.leftTimes,t.txt_times.innerHTML=RP.n[960]+Ql.createColor(IN.mTowerData.leftTimes.toString(),"#23b11f"),t.cp_score.value=Math.floor(sn.MODEL.recommended(t.index)/1e4).toString(),t.cp_step.value="第"+mp.getChineseNum(sn.MODEL.key(t.index))+"层";for(var i=[],n=0;n<3;n++)i.push({index:t.index,level:n,pass:IN.mTowerData.pLevel});t.list_award.dataSource=i,t.setExtraAward()}},i.setExtraAward=function(){var e=this;if(_R.mTowerExtra=null,e.extraVo=IN.getExtraAward(e.index),e.sp_extra.visible=e.txt_lock.visible=null!=e.extraVo,e.sp_extra.visible){e.txt_extra.innerHTML=Ql.createColor(e.extraVo.id+"","#23b11f")+RP.n[961];var t=e.extraVo.extra.split("|");switch(e.equitImg&&(e.equitImg.visible=!1),e.item&&(e.item.visible=!1),e.g_got&&(e.g_got.visible=!1),parseInt(t[0])){case 1:e.equitImg||(e.equitImg=new Kl,e.equitImg.pos(e.g_grid.x+5,e.g_grid.y+5),e.sp_extra.addChild(e.equitImg)),e.equitImg.visible=e.txt_lock.visible=!0,e.equitImg.skin=_r.getMoEquipPath(t[2]),e.txt_lock.innerHTML=RP.n[962]+la.getName(parseInt(t[1]))+RP.n[963],_R.mTowerExtra={isUnlock:sn.MODEL.key(e.index)==e.extraVo.id,part:parseInt(t[1]),icon:t[2]};break;case 2:e.item||(e.item=new MF,e.item.size(110,110),e.item.pos(e.g_grid.x,e.g_grid.y),e.sp_extra.addChild(e.item)),e.item.visible=!0,e.txt_lock.visible=!1;var i=new yB;i.setGoodsId(parseInt(t[1])),i.goodsNum=1,e.item.bindData=i}IN.isPassAll&&(e.item&&(e.item.filters=1!=IN.mTowerData.pLevel?null:A_.getGrayFilter()),1==IN.mTowerData.pLevel&&(e.g_got||(e.g_got=new Kl,e.g_got.pos(e.g_grid.x+2,e.g_grid.y+20),e.g_got.skin=_r.getAtlasSubPath("base_ui2/ty_gat_ylq.png"),e.sp_extra.addChild(e.g_got)),e.g_got.visible=!0))}},i.setMagicTowerRank=function(){var e=o_.ins.getRank(16).datas.concat();3<e.length?this.list_rank.dataSource=e.splice(0,3):this.list_rank.dataSource=e},i.onClickHandler=function(e){switch(e.currentTarget){case this.txt_rank:hN.ins.open("MAGIC_TOWER_RANK");break;case this.btn_challenge:if(!IN.mTowerData)return;if(UR.instance.fullPower&&UR.instance.isAuto&&!BR.ins.isCheckPointBoss)return void zB.ins.showById(2126,1);if(!ZN.isEnabledChangeScene())return void zB.ins.showById(2126,1);if(IN.mTowerData.leftTimes<1)return void zB.ins.showMsg(RP.n[952],1);if(!TR.ins.hasEmptyNum(20))return void KQ.ins.showBagRecycle();this.enterCopyZone()}},i.enterCopyZone=function(){bN.reqChallengeCopy(sn.MODEL.missionId(this.index)),G.timer.once(300,this,function(){hN.ins.close("MAGIC_VIEW")})},i.onLinkHandler=function(e){null==this.extraVo&&2<this.extraVo.target.length||hN.ins.open(this.extraVo.target[1],{_subIndex_:this.extraVo.target[2]})},t}(),nZ=function(t){function i(){this.index=0,this._gridsList=null,this._currentTime=0,this._targetTime=0,this._passTime=0,this._circle=null,this._currentQaulity=0,this._timeArr=null,i.__super.call(this)}b(i,"modules.magic.views.MagicTowerSceneView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),null==e._circle&&(e._circle=new pp,e._circle.graphics.drawCircle(0,0,e.g_circle.width/2,"#123456"),e._circle.pos(0,0),e.g_circle.mask=e._circle),e._gridsList||(e._gridsList=new vj,e._gridsList.y=-16,e._gridsList.x=54,e._gridsList._spaceX=24,e._gridsList.size(130,130),e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=110,e._gridsList._gridW=109,e._gridsList._gnameVisible=!1,e.b_extra.addChild(e._gridsList))},e.destroy=function(e){void 0===e&&(e=!0),this.hide(),this._circle&&this._circle.removeSelf(),this._circle=null,this._timeArr=null,laya.ui.View.prototype.destroy.call(this,e)},e.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.show(),G.timer.loop(1e3,this,this.loop)},e.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clear(this,this.loop)},e.show=function(){var e=this;(IN.isPassAll||1!=IN.mTowerData.pLevel)&&0<IN.mTowerData.pLevel?e.index=sn.getIndex(IN.mTowerData.pId):e.index=sn.getIndex(IN.mTowerData.pId+1),e._timeArr=sn.MODEL.passTime(e.index),e._currentTime=0,e._currentQaulity=0,e._passTime=0,e._targetTime=e._timeArr[e._currentQaulity]-e._passTime,e.updateView(),e.updateTime()},e.hide=function(){},e.updateView=function(){var e=this;if(e.g_quality.skin=_r.getFullUrl("ui/images/godweapon/quality_"+e._currentQaulity+".png"),e.txt_quality.innerHTML=Ql.createColor(e._targetTime+"秒","#23b11f")+RP.n[965]+Ir.QUALITY_NAME_ARR[e._currentQaulity]+"评价",""==sn.MODEL.firstReward(e.index)?e.b_extra.visible=!1:IN.mTowerData.pId==sn.MODEL.key(e.index)&&1==IN.mTowerData.pLevel?e.b_extra.visible=!1:e.b_extra.visible=!0,e.b_extra.visible){var t=IN.getMagicTowerAward(e.index,0);e.txt_award.innerHTML=RP.n[966],t&&""!=t&&(e._gridsList._nameVisible=!1,e._gridsList.setGoodsItems(t,6))}else e._gridsList._nameVisible=!0,e.txt_award.innerHTML="";if((t=IN.getMagicTowerAward(e.index,e._currentQaulity+1))&&""!=t){for(var i=yB.createStrArr(t),n="奖励：",s=0,o=0;o<i.length;o++)s=Bi.getIndex(i[o].goodsId),n+=0<o?"、":"",n+=Ql.createColor(Bi.MODEL.name(s)+"x"+i[o].goodsNum,ms.getByQuality(Bi.MODEL.colourId(s)));e.txt_exp.innerHTML=n}},e.updateQuality=function(){var e=this;e._currentQaulity<2?(e._currentQaulity++,e._currentTime=0,e._targetTime=e._timeArr[e._currentQaulity]-e._passTime):G.timer.clear(e,e.loop),e.updateView()},e.updateTime=function(){var e=this,t=i.MIN_ANGLE+(270-i.MIN_ANGLE)*(e._currentTime/e._targetTime);e._circle.graphics.clear(),e._circle.graphics.drawPie(e.g_circle.width>>1,e.g_circle.height>>1,e.g_circle.width>>1,t,270,"#000000"),e._circle.repaint(),e.txt_time.innerHTML=Jp.simpleFormat(e._targetTime-e._currentTime)},e.loop=function(){this._currentTime++,this._passTime++,this.updateTime(),this._currentTime>=this._targetTime&&this.updateQuality()},i.MIN_ANGLE=-90,i.MAX_ANGLE=270,i}(Hm),sZ=function(e){function t(){t.__super.call(this),this.imgImp.visible=!1}return b(t,"modules.mail.views.MailRender",e),p(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(cu,this,"dataSource",e),null!=e){var t=e;this.txTitle.changeText(t.mail_title),this.txTime.changeText(Jp.getSTRYMDHM(1e3*t.mail_getTime)),this.mcNoread.visible=0==t.mail_state,this.mcRead.visible=1==t.mail_state,this.mcGift.visible=1==t.mail_attach,this.imgImp.visible=1==t.isImportant}}),t}(cu),oZ=function(e){function i(){this._keyGrid=null,this.toc=null,this.times=0,this.moneyIcon=null,i.__super.call(this),this.list.itemRender=XW,this.list.vScrollBarSkin="",this.list.scrollBar.elasticDistance=100,this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.touchScrollEnable=!1,this.list.scrollBar.mouseWheelEnable=!1,this._keyGrid=new MF,this._keyGrid.needGridBg=!1,this.key_icon.addChild(this._keyGrid),this._keyGrid.size(this.key_icon.width+5,this.key_icon.height+5),this._keyGrid.bindData=yB.create(60050,1),this.key_num.style.wordWrap=!1}b(i,"modules.mall.views.MallMysteryView",Ym);var t=i.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.hde_times.style.font="SimHei",t.hde_times.style.fontFamily="SimHei",t.hde_times.style.fontSize=24,t.hde_times.style.wordWrap=!1,t.hde_times.style.color="#a19980",t.hde_times.style.align="center",t.hde_times.width=220,t.hdv_timer.innerHTML="",t.btn_refresh.on("click",t,t.reqRefresh),wN.reqMySteryList()},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_refresh.off("click",this,this.reqRefresh),this.list.array=null},t.reqRefresh=function(e){var t=tH.instance.mysterystore_data;this.times=t.refreshTime;var i=TR.ins.getGoodsNum(60050),n=0,s=0;if(0==this.times)n=s=0;else if(0<i)n=60050,s=1;else if(gR.ins.YB<200)return void KQ.ins.showNoGold();wN.reqMySteryRefresh(n,s)},t.updateBagItem=function(){var e=TR.ins.getGoodsNum(60050),t="#23b11f";0==e&&(t="#ff2e24"),this.key_num.innerHTML=Ql.createColor(e+"/1",t)+"）"},t.hideByVSC=function(e,t){G.timer.clearAll(this)},t.showByVSC=function(e,t){},t.updateByVSC=function(e){var t=this;t.toc=tH.instance.mysterystore_data,null!=t.toc&&(t.list.array=t.toc.list,t.showLeftRefreshTime(),t.btn_refresh.showTip=tH.instance.hasLeftFreeTime(),t.showLeftTime(),G.timer.loop(1e3,t,t.showLeftTime),t.updateBagItem())},t.showLeftRefreshTime=function(){var e=tH.instance.mysterystore_data;if(null!=e){0==e.refreshTime?(this.btn_refresh.label=RP.n[967],this.cost.visible=!1,this.hde_times.visible=!1,1):(this.btn_refresh.label="刷 新",this.hde_times.visible=!1,this.cost.visible=!0,this.txt_refreshCost.text="200")}},t.showLeftTime=function(){var e=this,t=tH.instance.getLeftTime();t<=1e3?(e.hdv_timer.visible=!1,e.btn_refresh.label=RP.n[967],e.cost.visible=!1,e.hde_times.visible=!1,e.times=0,e.toc.refreshTime=0,e.btn_refresh.showTip=!0):(e.hdv_timer.visible=!0,t-=1e3,e.parent&&(e.hdv_timer.innerHTML=RP.n[969]+Ql.createColor(i.getHMSTimeString(t),"#23b11f")))},i.getHMSTimeString=function(e){var t=e/1e3,i=Math.floor(t/3600),n=10<=i?i.toString():"0"+i.toString(),s=Math.floor((t-3600*i)/60),o=10<=s?s.toString():"0"+s.toString(),a=Math.floor(t-3600*i-60*s);return n+":"+o+":"+(10<=a?a.toString():"0"+a.toString())},i}(),aZ=function(e){function t(){t.__super.call(this),this.list.itemRender=XW,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.scrollBar.on("change",this,this.onScrollChanged),iu.optimizeList(this.list,XW)}b(t,"modules.mall.views.MallNormalView",zm);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_list_mask.visible=!1:this.img_list_mask.visible=!0},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.list.array=null},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){wN.reqMallList(2)},i.updateByVSC=function(e){this.list.array=tH.instance.getTabGoodsList(2),this.onScrollChanged()},t}(),rZ=function(e){function t(){this._dto=null,t.__super.call(this)}b(t,"modules.vip.views.VipCardUseTip",hl);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._dto=TR.ins.getGoodsDto(2291);var t=new MF;this.addChild(t),t.x=200,t.y=146,t.bindData=2291;var i=new fc(this._dto.name);i.centerX=0,i.y=270,this.addChild(i),i.color="#90877b",i.fontSize=20,i.font="SimHei",this.notice.text=RP.n[970],this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_Go:Tu.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:this._dto,num:1}),Tu.sendToModule("OPEN_PANEL",["modules.vip.VipModule"]);case this.btn_Close:hN.ins.close("VipCardUseTip")}},t.NAME="VipCardUseTip",t}(),lZ=function(e){function t(){t.__super.call(this)}return b(t,"modules.map.views.MapPoint",yu),t.prototype.updateDate=function(e){if(0<e.bossHp){var t=rn.getIndex(e.missionId),i=rn.MODEL.bossId(t),n=hn.MODEL.name(hn.getIndex(i));this.txt_name.color="#e6d80d",this.txt_name.changeText(n)}else{this.txt_name.color="#23b11f";var s=Math.floor(e.rebrithTime/1e3);this.txt_name.changeText(Jp.getTickMS(s))}},t}(),cZ=function(t){function e(){this._gridsList=null,this._mask=null,this._data=null,this.startLayer=null,this.SIZE=116,e.__super.call(this),this.startLayer=new pp,this.addChild(this.startLayer)}b(e,"modules.moLimitMission.views.MoLimitMissionSubView",t);var i=e.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.setChildIndex(t.box_mask,t.numChildren-1),t.btn_get.on("click",t,t.onGetClicked),t.list_subTask.scrollBar.on("change",t,t.onScrollChanged),t.loop(),G.timer.loop(1e3,t,t.loop),t.parent.parent.addChild(t.box_kuang)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_get.off("click",t,t.onGetClicked),t.list_subTask.scrollBar.off("change",t,t.onScrollChanged),G.timer.clear(t,t.loop),t.startLayer.graphics.clear(),t.parent.parent.removeChild(t.box_kuang)},i.loop=function(){var e=kN.getInstance().endTime-dr.serverTimeSec;0<e?this.txt_countDown.innerHTML=RP.n[971]+Ql.createColor(Jp.getDHM(e),"#23b11f"):(this.txt_countDown.innerHTML="",G.timer.clear(this,this.loop))},i.onGetClicked=function(e){if(TR.ins.hasEmptyNum(20)){var t=new $u;t.groupID=this._data.chapter,Tu.sendToService(t)}else zB.ins.showById(3542,1)},i.onScrollChanged=function(){0==this.list_subTask.scrollBar.max||this.list_subTask.scrollBar.value>=this.list_subTask.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._gridsList=new vj,e._gridsList.x=280,e._gridsList.y=160,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e._gridsList.width=460,e._gridsList._spaceX=30,e._gridsList._gridH=e._gridsList._gridW=100,e._gridsList._gnameY=103,e._gridsList._gnameFont="20px SimHei",e.addChild(e._gridsList),e.list_subTask.itemRender=dZ,e.list_subTask.repeatX=1,e.list_subTask.repeatY=4,e.list_subTask.spaceY=5,e.list_subTask.vScrollBarSkin=""},i.updateByVSC=function(e){var t=this;if(e){t._data=e,t.img_firstGoods.skin=_r.getFullUrl("ui/images/zhuiji/"+su.MODEL.titleResource(e.chapter-1)+".png"),t._gridsList.setGoodsItems(e.reward,1);var i=e.reward[0];t.txt_firstName.text=i.simpleName,t.txt_firstName.color=ms.getByQuality(i.colourId);for(var n=0;n<e.reward.length;n++)_R.getIsMoEquit(e.reward[n].goodsId);if(1==e.statue)t.img_isGet.visible=!0,t.btn_get.visible=!1,t.txt_progress.visible=!1;else{for(var s=0,o=0;o<e.subMissionArr.length;o++)2==e.subMissionArr[o].statue&&s++;t.txt_progress.visible=!0,t.txt_progress.text=RP.n[972]+s+"/"+e.subMissionArr.length+")",t.txt_progress.color=s==e.subMissionArr.length?"#23b11f":"#FF2e24",t.img_isGet.visible=!1,t.btn_get.visible=!0,1==kN.getInstance().checkChapterMissionAllFinished(e.chapter)?t.btn_get.gray=!1:t.btn_get.gray=!0,t.btn_get.mouseEnabled=!t.btn_get.gray}if(t.list_subTask.dataSource=e.subMissionArr,1!=e.chapter){t.box_mask.visible=!0;var a=kN.getInstance().moLevelArr[t._data.chapter-2];if(null==t._mask){t._mask=new Ss,t.box_mask.addChildAt(t._mask,0),t._mask.alpha=.8;var r=t.stage.height-t.box_mask.top-t.box_mask.bottom;t._mask.graphics.drawRect(0,0,t.box_mask.width,r,"#000000",null),t.box_mask.mouseEnabled=!0,t.box_mask.mouseThrough=!1}0==kN.getInstance().checkChapterMissionAllFinished(a.chapter)?(t.box_mask.visible=!0,t.txt_tips.leading=10,t.txt_tips.innerHTML=RP.n[973]+Ql.newline()+RP.n[974]+Ql.createColor(nJ.TIPSARR[t._data.chapter-1],"#e6d80d")):t.box_mask.visible=!1}else t.box_mask.visible=!1}},i.setMoEquitStar=function(e,t,i){if(_R.getIsMoEquit(e)){var n=Bi.MODEL.magicStarLevel(Bi.getIndex(e));if(a||(a=new dt,this.addChild(a)),a.graphics.clear(),!_R.getIsMoEquitSpecial(e))return a.pos(t+3,i-this.SIZE+3),a.graphics.drawTextures(_R.starBgTexture,[0,0]),void a.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"no-repeat",new Uh(26*(10-n),0));var s=Math.floor(n/6),o=Math.floor(n%6),a=new dt;a.pos(t+5,i-28),this.startLayer.addChild(a);for(var r=0;r<o;r++)a.graphics.drawTextures(_R.getStarTexture(s),[_R.getStartX(o)+44*r,0]);a.scaleX=a.scaleY=.45}},e}(Xu),uZ=function(e){function t(){this._eff=null,this._tweener=null,t.__super.call(this),this.btnEntrance.on("click",this,this.onBtnEntrance)}b(t,"modules.moLimitMission.views.MoLimitMissionOpenPanel",Qu);var i=t.prototype;return i.onBtnEntrance=function(e){this.close()},i.close=function(){var e=this;if(null!=e._eff&&(e._eff.removeSelf(),e._eff.dispose(),e._eff=null),e.x=G.stage.width-e.width>>1,e.y=G.stage.height-e.height>>1,e.centerX=NaN,e.centerY=NaN,e.parent){var t=CN.getIconBtn(14);if(null==t)return void e.onComplete();var i=t.localToGlobal(new Uh(t.width/2,t.height/2));null!=e._tweener&&e._tweener.clear(),e._tweener=Og.to(e,{x:i.x,y:i.y,scaleX:0,scaleY:0,alpha:0},800,pa.sineOut,ql.create(e,e.onComplete))}},i.onComplete=function(){Tu.sendToModule("SHOW_MO_LIMIT_MISSION_MAIN_VIEW",["modules.moLimitMission.MoLimitMissionModule"]),this.parent&&(eq.panelLayer?eq.panelLayer.close(this):this.parent.removeChild(this))},i.show=function(){var e=this;if(!e.parent){eq.panelLayer.open(e,!1,!0,!1);var t=new td;Tu.sendToService(t),null==e._eff&&(e._eff=kB.createEffect("jm1130",e.btnEntrance.width>>1,e.btnEntrance.height>>1,e.btnEntrance),e._eff.scale_X=1.25,e._eff.scale_Y=1.25),e.onResize()}e.x=NaN,e.y=NaN,e.alpha=1,e.scale(1,1),e.centerX=0,e.centerY=0},p(1,t,"ins",function(){return t._inst=t._inst||new t},layouts.molimit.MoLimitMissionOpenLayoutUI._$SET_ins),t.iconTip=null,t._inst=null,t}(),dZ=function(e){function t(){this.vo=null,this._grid=null,t.__super.call(this)}b(t,"modules.moLimitMission.views.MoLimitSubLevelRenderer",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new MF(116),this._grid.pos(18,18),this.addChild(this._grid)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onBtnClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_get.off("click",this,this.onBtnClicked)},i.onBtnClicked=function(e){if(this.vo)switch(this.vo.statue){case 0:if(BB.isShaozhu()&&modules.copy.others.PigData.ins.PigCopyID<=0)return;var t=this.vo.goCammand.split("|");if(!ZN.isEnabledChangeScene()&&2!=parseInt(t[0]))return void zB.ins.showById(2126,1);var i=Np.create(0|t[0],t[1]);2<t.length&&(i.data=t[2]),hN.ins.close("ACHIEVE_NEW_MAIN_VIEW"),Tu.sendToModule("GOTARGET",["modules.task.TaskModule"],i);break;case 1:var n=new Ku;n.subMissionID=this.vo.missionID,Tu.sendToService(n)}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Ju,t,"dataSource",e),t.vo=e,t.btn_get.visible=!1,t.img_isFinished.visible=!1,t.vo){var i=gR.ins.actorList[0].job,n=yB.createStrArr(t.vo.showGoods)[i-1];if(t._grid.dataSource=n,2==t.vo.statue)t.img_isFinished.visible=!0,t.txt_dect.innerHTML=t.vo.taskDesc+Ql.createColor(t.vo.taskNum+"/"+t.vo.taskNum,"#23B11F");else{t.btn_get.visible=!0;var s=lB.instance().getTaskAsstInfo(t.vo.missionID),o=0;if(s)o=s.targetList[0].currentValue;var a="#FF2E24";o==t.vo.taskNum&&(a="#23B11F"),t.txt_dect.innerHTML=t.vo.taskDesc+Ql.createColor(o+"/"+t.vo.taskNum,a)}switch(t.btn_get.showTip=!1,t.vo.statue){case 0:t.btn_get.label=RP.n[975];break;case 1:t.btn_get.label="完成",t.btn_get.showTip=!0}}}),t}(Ju),hZ=function(e){function t(){var e=this;e.LEADING=50,e.CELL_ALIGN=22,e.CELL_WIDTH=90,e.CELL_HEIGHT=90,e.SHOW_ROW=3,e.BASE_HEIGHT=142,e._showBtns=[],e._btnLayer=null,e._btnHash=new jo,t.__super.call(e),e.init()}b(t,"modules.nav.views.sub.ActIconCollection",a);var i=t.prototype;return i.init=function(){this.BASE_HEIGHT=this.height-this.CELL_HEIGHT,this._btnLayer=new pp,this.addChild(this._btnLayer)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_close:this.close()}e.target instanceof ui.controls.TipButton&&CN.dealActIcon(e.target)},i.close=function(){this.removeSelf()},i.destroy=function(e){void 0===e&&(e=!0),this._showBtns=[],this._btnLayer=null,this.off("click",this,this.onClick),laya.ui.View.prototype.destroy.call(this,e)},i.showActIcons=function(e,t){var i,n,s=this;for(n in s._showBtns)(i=s._showBtns[n]).btn.removeSelf();var o=CN.getIconBtn(e),a=kt.getIndex(e),r=kt.MODEL.name(a);if(s.lbl_title.changeText(r),null==t){t=[];var l=kt.count;for(a=0;a<l;a++){var c,u=kt.MODEL.parent(a),d=kt.MODEL.key(a);if(0!=jP.checkFunctionOpen(d))for(var h in CN.iconData.icons2)if(c=CN.iconData.icons2[h],e==u&&c.iconId==d){t.push(d);break}}}var _=Math.max(Math.ceil(t.length/s.SHOW_ROW),1);s.height=s.CELL_HEIGHT*_+s.LEADING*(_-1)+s.BASE_HEIGHT;var f=CN.iconData,p=0;s._showBtns=[];var g,v=s.width-(s.SHOW_ROW*s.CELL_WIDTH+(s.SHOW_ROW-1)*s.CELL_ALIGN)>>1;for(g in s._btnLayer.x=v,s._btnLayer.y=s.icon.y,t){d=t[g];var m=p%s.SHOW_ROW*(s.CELL_WIDTH+s.CELL_ALIGN),y=Math.floor(p/s.SHOW_ROW)*(s.CELL_HEIGHT+s.LEADING);(i=s.getBtn(d)).pos(m,y);for(var I=0;I<f.icons2.length;I++){var b=f.icons2[I];if(b.iconId==d){i.updateStatus(b.status),i.setCountTime(b.time);break}}s._showBtns.push(i),p++}var w=sJ.ins.getCompomentsByName("NavActRView");w.addChild(s);var x=o.x+o.width/2-s.width/2,S=o.y+o.height+10;x+s.width>w.width&&(x=w.width-s.width),s.pos(x,S)},i.getBtn=function(e,t,i){void 0===t&&(t=this.CELL_WIDTH),void 0===i&&(i=this.CELL_HEIGHT);var n=this._btnHash.get(e);return n?this._btnLayer.addChild(n.btn):(n=new $H(e,this._btnLayer,this,t,i),this._btnHash.set(e,n)),n},p(1,t,"instance",function(){return t._instance=t._instance||new t},layouts.nav.ActIconCollectionUI._$SET_instance),t._instance=null,t}(),_Z=function(e){function t(){var e=this;t.__super.call(e),e.top=300,e.counterIcon.visible=!1,e.title.text=RP.n[976],e.list.itemRender=fZ,e.left=0,e.list.dataSource=[],e.list.height=445,e.list.vScrollBarSkin="",e.height=545}b(t,"modules.nav.views.sub.NavAttackList",pd);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.clearList(),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,this.showInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.clearList=function(){this.list.dataSource=[],this.list.refresh(),this.visible=!1},i.notice=function(e){switch(e.actionOrder){case"24027":this.showInfo();break;case"NAV_ATTACK_LIST_SELECT":LN.attackSelect&&1==LN.attackSelect.type?this.clickFun(LN.attackSelect.objectId):this.clearSelected()}},i.showInfo=function(){var e=this,t=BR.ins.toc24027;t&&(!dr.dtoEnterScene||12!=dr.dtoEnterScene.type&&13!=dr.dtoEnterScene.type?dr.dtoEnterScene&&53==dr.dtoEnterScene.type?(e.top=505,e.height=328,e.list.height=305):(e.top=300,e.height=610,e.list.height=484):(e.top=555,e.height=398,e.list.height=305),e.list.dataSource=t.list,e.visible=e.isShowList(t.list.length),e.list.refresh())},i.isShowList=function(e){return 0<e&&7777!==BR.ins.curCopyId&&33001!==BR.ins.curCopyId},i.clickFun=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i&&i.vo&&i.vo.objectId==e?i.onSelectItem(!0):i.onSelectItem(!1)}},i.clearSelected=function(){for(var e=0;e<this.list.content.numChildren;e++){this.list.content.getChildAt(e).onSelectItem(!1)}},t.NAME="NavAttackList",t}(),fZ=function(e){function t(){this.vo=null,t.__super.call(this),this.btn.selected=!1}b(t,"modules.nav.views.sub.NavAttackListItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onGoClicked)},i.destroy=function(e){void 0===e&&(e=!0),this.vo=null,this.off("click",this,this.onGoClicked),laya.ui.View.prototype.destroy.call(this,e)},i.onGoClicked=function(e){sH.fights(this.vo.objectId),LN.attackSelect=this.vo,LN.attackMonsterSelect=null,LN.attackCollcetionSelect=null,Tu.sendToModule("NAV_ATTACK_LIST_SELECT",["modules.nav.NavModule"],this.vo),Tu.sendToModule("NAV_ATTACK_MONSTER_LIST_SELECT",["modules.nav.NavModule"]),Tu.sendToModule("NAV_ATTACK_COLLECTION_LIST_SELECT",["modules.nav.NavModule"]),LY.Ins().isShow()&&LY.Ins().close(31)},i.onSelectItem=function(e){this.btn.selected=e},i.doShowGuide=function(){var e=PH.Ins().info;e&&0<e.getCurrentGuide(31)&&2==e.status&&(LY.Ins().isShow()||LY.Ins().show(31,this.btn,!1,this))},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){this.vo=e,this.vo&&(this.head.skin=null,this.head.skin=_r.getActorSmallHeadPath(e.roleType,e.sex),this.head.scale(.72,.72),e.guildName?this.tx_guild.text=e.guildName:this.tx_guild.text=RP.n[977],this.tx_name.text=e.name)}),t}(fd),pZ=function(e){function t(){this._clickBool=!1,t.__super.call(this)}b(t,"modules.nav.views.sub.NavAttackOther",gd);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_boss.on("click",t,t.onClickHeJi),t.btn_person.on("click",t,t.onClickHeJi),t.showGuiShuInfo();var i=BR.ins.curCopyId,n=rn.getIndex(i);41!=rn.MODEL.cate(n)&&42!=rn.MODEL.cate(n)&&53!=rn.MODEL.cate(n)&&57!=rn.MODEL.cate(n)?G.timer.loop(1e3,t,t.onEnter):G.timer.loop(1e3,t,t.onEnter1),G.timer.once(4e3,t,t.doShowGuide),t.visible=!0,t.checkCrossBoss(),t._clickBool=!1},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_person.off("click",t,t.onClickHeJi),t.btn_boss.off("click",t,t.onClickHeJi),G.timer.clear(t,t.onEnter),G.timer.clear(t,t.onEnter1),LY.Ins().isShow()&&LY.Ins().close(30),G.timer.clear(t,t.doShowGuide)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.btn_person.off("click",t,t.onClickHeJi),t.btn_boss.off("click",t,t.onClickHeJi),G.timer.clear(t,t.onEnter),G.timer.clear(t,t.onEnter1),G.timer.clear(t,t.doShowGuide),laya.ui.View.prototype.destroy.call(t,e)},i.checkCrossBoss=function(){YR.ins.isCrossBossCopy()&&(YR.ins.isBorn?this.visible=!0:this.visible=!1)},i.onEnter=function(){var e=this;uF.attackTime&&uF.attackTarget&&pt.now()-uF.attackTime<3e3?BR.ins.toc24004&&BR.ins.toc24004.playerId.toString()==gR.ins.charId?uF.attackTarget.isBoss?(e.btn_owner.visible=e.btn_bossIng.visible=!0,e.btn_person.visible=e.btn_boss.visible=e.btn_personIng.visible=!1,LY.Ins().isShow()&&e._clickBool&&LY.Ins().close(30)):(e.btn_boss.visible=e.btn_owner.visible=!0,e.btn_bossIng.visible=e.btn_personIng.visible=e.btn_person.visible=!1):BR.ins.toc24004&&uF.attackTarget&&uF.attackTarget.objectId==BR.ins.toc24004.objectId?(e.btn_boss.visible=e.btn_personIng.visible=!0,e.btn_bossIng.visible=e.btn_owner.visible=e.btn_person.visible=!1):uF.attackTarget&&uF.attackTarget.isBoss?(e.btn_bossIng.visible=e.btn_person.visible=!0,e.btn_boss.visible=e.btn_owner.visible=e.btn_personIng.visible=!1):(e.btn_boss.visible=e.btn_person.visible=!0,e.btn_bossIng.visible=e.btn_owner.visible=e.btn_personIng.visible=!1):0==NF.mainChar.isDeath&&(e._clickBool&&null!=BR.ins.enterScenceBossInfo?BR.ins.toc24004&&0!=BR.ins.toc24004.objectId&&BR.ins.toc24004.playerId.toString()!=gR.ins.charId?sH.fights(BR.ins.toc24004.objectId):null!=BR.ins.enterScenceBossInfo&&BR.ins.toc24004.playerId.toString()!=gR.ins.charId&&sH.fights(BR.ins.enterScenceBossInfo.objectId):BR.ins.toc24004&&BR.ins.toc24004.playerId.toString()==gR.ins.charId?uF.attackTarget&&uF.attackTarget.isBoss?(e.btn_owner.visible=e.btn_bossIng.visible=!0,e.btn_person.visible=e.btn_boss.visible=e.btn_personIng.visible=!1):(e.btn_owner.visible=e.btn_boss.visible=!0,e.btn_person.visible=e.btn_bossIng.visible=e.btn_personIng.visible=!1):(e.btn_boss.visible=!0,e.btn_person.visible=!0,e.btn_owner.visible=!1,e.btn_bossIng.visible=!1,e.btn_personIng.visible=!1))},i.onEnter1=function(){var e=this;if(uF.attackTime&&uF.attackTarget&&pt.now()-uF.attackTime<3e3)BR.ins.toc24004&&BR.ins.toc24004.playerId.toString()==gR.ins.charId?uF.attackTarget.isBoss?(1==LN.isTarMove?(e.btn_bossIng.visible=!1,e.btn_boss.visible=!0):(e.btn_bossIng.visible=!0,e.btn_boss.visible=!1),e.btn_owner.visible=!0,e.btn_person.visible=e.btn_personIng.visible=!1,LY.Ins().isShow()&&e._clickBool&&LY.Ins().close(30)):(e.btn_boss.visible=e.btn_owner.visible=!0,e.btn_bossIng.visible=e.btn_personIng.visible=e.btn_person.visible=!1):BR.ins.toc24004&&uF.attackTarget.objectId==BR.ins.toc24004.objectId?(e.btn_boss.visible=e.btn_personIng.visible=!0,e.btn_bossIng.visible=e.btn_owner.visible=e.btn_person.visible=!1):uF.attackTarget&&uF.attackTarget.isBoss?(e.btn_bossIng.visible=e.btn_person.visible=!0,e.btn_boss.visible=e.btn_owner.visible=e.btn_personIng.visible=!1):(e.btn_boss.visible=e.btn_person.visible=!0,e.btn_bossIng.visible=e.btn_owner.visible=e.btn_personIng.visible=!1);else if(0==NF.mainChar.isDeath){var t=BR.ins.toc24004&&BR.ins.toc24004.playerId.toString()==gR.ins.charId;dr.dtoEnterScene?41==dr.dtoEnterScene.type||42==dr.dtoEnterScene.type?(e.btn_boss.visible=!0,e.btn_person.visible=!0,e.btn_owner.visible=!1,e.btn_bossIng.visible=!1,e.btn_personIng.visible=!1):53==dr.dtoEnterScene.type?(t?(e.btn_boss.visible=!0,e.btn_person.visible=!1,e.btn_owner.visible=!0):(e.btn_boss.visible=!0,e.btn_person.visible=!0,e.btn_owner.visible=!1),e.btn_bossIng.visible=!1,e.btn_personIng.visible=!1):57==dr.dtoEnterScene.type&&(t?(e.btn_boss.visible=!0,e.btn_person.visible=!1,e.btn_owner.visible=!0):(e.btn_boss.visible=!0,e.btn_person.visible=!0,e.btn_owner.visible=!1),e.btn_bossIng.visible=!1,e.btn_personIng.visible=!1):t?uF.attackTarget&&uF.attackTarget.isBoss?(e.btn_owner.visible=e.btn_bossIng.visible=!0,e.btn_person.visible=e.btn_boss.visible=e.btn_personIng.visible=!1):(e.btn_owner.visible=e.btn_boss.visible=!0,e.btn_person.visible=e.btn_bossIng.visible=e.btn_personIng.visible=!1):(e.btn_boss.visible=!0,e.btn_person.visible=!0,e.btn_owner.visible=!1,e.btn_bossIng.visible=!1,e.btn_personIng.visible=!1)}},i.showGuiShu=function(){this.btn_bossIng.visible=this.btn_owner.visible=!0,this.btn_boss.visible=this.btn_person.visible=!1},i.showNoGuiShu=function(){this.btn_person.visible=this.btn_bossIng.visible=!0,this.btn_boss.visible=this.btn_owner.visible=!1},i.onClickHeJi=function(e){e.target==this.btn_boss?(null!=BR.ins.enterScenceBossInfo&&sH.fights(BR.ins.enterScenceBossInfo.objectId),LN.isTarMove=!1):e.target==this.btn_person&&(BR.ins.toc24004&&0!=BR.ins.toc24004.objectId?sH.fights(BR.ins.toc24004.objectId):zB.ins.playErrorMsg(RP.n[978]),this._clickBool=!0,LY.Ins().isShow()&&LY.Ins().close(30))},i.showGuiShuInfo=function(){BR.ins.toc24004&&BR.ins.toc24004.playerId.toString()==gR.ins.charId?(this.btn_person.visible=!1,this.btn_owner.visible=!0):(this.btn_boss.visible=!0,this.btn_person.visible=!0,this.btn_owner.visible=!1,this.btn_bossIng.visible=!1),this.btn_personIng.visible=!1},i.notice=function(e){switch(e.actionOrder){case"24004":this.showGuiShuInfo();break;case"25011":this.checkCrossBoss()}},i.doShowGuide=function(){var e=PH.Ins().info;if(e&&0<e.getCurrentGuide(30)&&this.btn_person.visible&&0==this._clickBool&&2==e.status&&!LY.Ins().isShow()){var t=new u_;t.x=this.width-this.btn_person.width,t.y=this.btn_person.y,t.width=this.btn_person.width,t.height=this.btn_person.height,LY.Ins().show(30,t,!1,this)}},p(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins},layouts.nav.NavAttackOtherUI._$SET_ins),t.NAME="NavAttackOther",t._ins=null,t}(),gZ=function(e){function t(){t.__super.call(this)}b(t,"modules.nav.NavMaterialView",Bd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_link.on("link",this,this.onLinkClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.txt_link.off("link",this,this.onLinkClicked)},i.clearList=function(){},i.hide=function(){},i.notice=function(e){},i.onLinkClicked=function(e){0!=EB.showCharge&&(hN.ins.isOpen("MONTHCARD")||hN.ins.open("MONTHCARD",{selectedIndex:3},0))},i.show=function(){var e=rn.getIndex(BR.ins.curCopyId),t=rn.MODEL.goodsAward(e).split(","),i=yB.create(t[0],t[1]);this.txt_reward.innerHTML="奖励:"+Ql.createColor(i.name+"*"+i.goodsNum,ms.getByQuality(i.colourId)),uo.count<=0?HP.loadConfig(["ConfigBigMonthCard"],["ConfigTqyueka"],ql.create(this,this.onJxrComplete)):this.onJxrComplete()},i.onJxrComplete=function(){var e=uo.MODEL.materialFuebnExtraRate(0);this.txt_link.innerHTML=RP.n[979]+RP.n[980]+e/100+RP.n[981]},p(0,i,"name",function(){return"NavMaterialView"}),t.NAME="NavMaterialView",t}(),vZ=function(e){function t(){t.__super.call(this),this.txt_info.innerHTML="是否"+Ql.createColor(RP.n[982],"#23b11f")+RP.n[983]}b(t,"modules.nav.views.sub.NavAutoWay",vd);var i=t.prototype;return i.notice=function(e){e.actionOrder},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onBtnGoClicked),this.btn_close.on("click",this,this.onBtnClicked),this.img_bg.skin=_r.getFullUrl("ui/images/relive/boss_fh_db.png")},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_go.off("click",this,this.onBtnGoClicked),this.btn_close.off("click",this,this.onBtnClicked),Po.ins().backMissionID=0},i.onBtnGoClicked=function(e){var t=rn.getIndex(BR.ins.curCopyId);switch(rn.MODEL.cate(t)){case 56:this.toBoss(Po.ins().backMissionID)}},i.toBoss=function(e){if(0==Hu.count){var t=[{url:_r.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Hu}];uc.ins().onLoadJxrs(t,ql.create(this,this.loadComplete,[e]))}else this.loadComplete(e)},i.loadComplete=function(e){for(var t=0;t<Hu.count;t++)if(Hu.MODEL.nextMissionId(t)==e){var i=Hu.MODEL.location(t),n=i[0],s=i[1],o=new Uh(n,s),a=zN.findCharsBySize(o,5);if(0<a.length){var r=NF.mainChar,l=a[0];if(NF.Ins().selectChar=l,ZN.getTileDisByPos(l.tileX,l.tileY,r.tileX,r.tileY)<=0)NF.Ins().onMoveEndHander();else{YN.getCharNearPt(l);yH.Ins().mainCharMove(l.point,!1,ql.create(NF.Ins(),NF.Ins().onMoveEndHander),!1)}}break}sJ.ins.hideCompoment("NavAutoWay")},i.onBtnClicked=function(){Po.ins().backMissionID=0,sJ.ins.hideCompoment("NavAutoWay")},t.NAME="NavAutoWay",t}(),mZ=function(e){function t(){this.preBlock=!1,t.__super.call(this),this.left=17,this.bottom=330}b(t,"modules.nav.views.sub.NavBlock",md);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exit.on("click",this,this.toggle),this.preBlock=ER.ins.hideOther,this.setDefault();var t=parseInt($e.MODEL.value($e.getIndex(219)));this.timerLoop(1e3*t,this,this.update)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_exit.off("click",t,t.toggle),ER.ins.hideOther!=t.preBlock&&t.setHide(t.preBlock),t.clearTimer(t,t.update)},i.toggle=function(e){var t=!ER.ins.hideOther;this.setHide(t);var i=ei.getIndex(t?4313:4314),n=ei.MODEL.content(i);zB.ins.playErrorMsg(n)},i.setHide=function(e){ER.ins.hideOther=e,Tu.sendToModule("HIDE_OTHER",["modules.scene.SceneModule"],ER.ins.hideOther),ER.reqSave()},i.update=function(){var e=ER.ins.hideOther;if(!e)for(var t=zN.charQueue.length,i=0,n=0;n<t;n++){var s=zN.charQueue[n];if(s.type!=Za.MAIN_CHAR&&s.type!=Za.HERO&&s.type!=Za.CHAR||i++,5<=i){e=!0;var o=ei.getIndex(4315),a=ei.MODEL.content(o);zB.ins.playErrorMsg(a);break}}e!=ER.ins.hideOther&&this.setHide(e),this.btn_exit.selected=!e},i.notice=function(e){switch(e.actionOrder){case"HIDE_OTHER_PLAYERS":this.update()}},i.setDefault=function(){dr.dtoEnterScene&&46==dr.dtoEnterScene.type&&this.setHide(!0)},p(0,i,"name",function(){return"NavBlock"}),t.NAME="NavBlock",t}(),yZ=function(e){function t(){this.vo=null,t.__super.call(this),this.btn.selected=!1}b(t,"modules.nav.views.sub.NavCollectionListItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.vo=null,laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onGoClicked)},i.onGoClicked=function(e){if(this.vo){var t=uH.Ins().isGetHero(this.vo.objectId);if(t){NF.Ins().selectChar=t;var i=ZN.getTileDis(NF.mainChar.tilePoint,t.tilePoint);if(i<=4&&2<i)return void yH.Ins().mainCharMove(t.point,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndHander));if(1<i){var n=YN.getCharNearPt(t);yH.Ins().mainCharMove(n,!0,ql.create(NF.Ins(),NF.Ins().onMoveEndHander))}else NF.Ins().onMoveEndHander()}}LN.attackSelect=null,LN.attackCollcetionSelect=this.vo,Tu.sendToModule("NAV_ATTACK_COLLECTION_LIST_SELECT",["modules.nav.NavModule"],this.vo),Tu.sendToModule("NAV_ATTACK_LIST_SELECT",["modules.nav.NavModule"],this.vo)},i.onSelectItem=function(e){this.btn.selected=e},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.vo=e,t.vo){var i=hn.getIndex(t.vo.collectionid);t.tx_name.changeText(hn.MODEL.name(i));var n=hn.MODEL.muId(i);i=_n.getIndex(n);var s=_n.MODEL.headId(i);s&&"0.0"!=s&&(t.head.skin=_r.getBossPath(s),t.head.scaleX=t.head.scaleY=.6,t.head.centerX=0,t.head.centerY=-20),t.tx_guild.text=""}}),t}(fd),IZ=function(e){function t(){var e=this;t.__super.call(e),e.top=300,e.counterIcon.visible=!1,e.title.text=RP.n[984],e.list.itemRender=yZ,e.left=0,e.list.dataSource=[],e.list.height=120,e.list.vScrollBarSkin="",e.height=220}b(t,"modules.nav.views.sub.NavCollectionList",pd);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,this.showInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.clearList=function(){this.list.dataSource=[],this.list.refresh(),this.visible=!1},i.notice=function(e){switch(e.actionOrder){case"25012":this.showInfo();break;case"NAV_ATTACK_COLLECTION_LIST_SELECT":LN.attackCollcetionSelect?this.clickFun(LN.attackCollcetionSelect.objectId):this.clearSelected()}},i.showInfo=function(){var e=BR.ins.toc25012;e&&(this.list.dataSource=e.list,this.visible=0<e.list.length,e.list.length<=0&&this.clearList(),this.list.refresh())},i.clickFun=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i&&i.vo&&i.vo.objectId==e?i.onSelectItem(!0):i.onSelectItem(!1)}},i.clearSelected=function(){for(var e=0;e<this.list.content.numChildren;e++){this.list.content.getChildAt(e).onSelectItem(!1)}},t.NAME="NavCollectionList",t}(),bZ=function(e){function t(){this.lastObjectId=0,t.__super.call(this),this.top=300}b(t,"modules.nav.views.sub.NavAttackTarget",Td);var i=t.prototype;return i.initialize=function(){this.tx_guild.text=""},i.onEnter=function(){!dr.dtoEnterScene||13!=dr.dtoEnterScene.type&&12!=dr.dtoEnterScene.type?this.top=300:this.top=322,this.visible=pt.now()-uF.attackTime<3e3,uF.attackTarget&&(uF.attackTarget.isBoss?this.showBossInfo():1==this.checkIsCommonMonster()?this.visible=!1:this.showRoleInfo())},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,G.timer.loop(1e3,this,this.onEnter)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),G.timer.clear(this,this.onEnter)},i.checkIsCommonMonster=function(){return!uF.attackTarget.isBoss&&!uF.attackTarget.isElites&&0==uF.attackTarget.roleType&&0==uF.attackTarget.sex},i.showRoleInfo=function(){var e=this;if(null==uF.attackTarget.roleType||null==uF.attackTarget.sex)return e.tx_guild.text="",void(e.visible=!1);uF.attackTarget&&(e.tx_name.text=uF.attackTarget.charName,e.head.skin=_r.getActorSmallHeadPath(uF.attackTarget.roleType,uF.attackTarget.sex),uF.attackTarget.guideName?e.tx_guild.text=uF.attackTarget.guideName:e.tx_guild.text=RP.n[977],e.head.scaleX=.8,e.head.scaleY=.8,e.head.x=30,e.head.y=58)},i.showBossInfo=function(){if(uF.attackTarget){var e,t=hn.getIndex(uF.attackTarget.modelId);this.tx_name.changeText(hn.MODEL.name(t));var i=hn.MODEL.muId(t);t=_n.getIndex(i),e=_n.MODEL.headId(t),this.head.skin=_r.getBossPath(e),G.timer.once(100,this,this.loadHeadImg,[_r.getBossPath(e)]),this.head.scaleX=.6,this.head.scaleY=.6,this.head.x=25,this.head.y=58,this.tx_guild.text=""}},i.loadHeadImg=function(e){if(null==this.head.texture){var t=yc.getRes(e);t?this.head.source=t:G.loader.load(e,ql.create(this,this.setSource,[e]))}},i.setSource=function(e){var t=yc.getRes(e);this.head.source=t},t.NAME="NavAttackTarget",t}(),wZ=function(e){function t(){var e=this;e.guide_init=!0,t.__super.call(e),e.attIcon.visible=!1,e.title.text=RP.n[986],e.title.color="#f52d23",e.list.itemRender=fZ,e.right=0,e.top=495,e.list.dataSource=[],e.list.height=385,e.list.vScrollBarSkin="",e.height=485}b(t,"modules.nav.views.sub.NavCounterList",pd);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,this.guide_init=!0,this.showInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.visible=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.clearList=function(){this.list.dataSource=[],this.list.refresh(),this.visible=!1},i.notice=function(e){switch(e.actionOrder){case"24028":this.showInfo();break;case"NAV_ATTACK_LIST_SELECT":LN.attackSelect&&2==LN.attackSelect.type&&this.clickFun(LN.attackSelect.objectId)}},i.showInfo=function(){var e=this,t=BR.ins.toc24028;t&&(dr.dtoEnterScene&&13==dr.dtoEnterScene.type?(e.top=322,e.height=398,e.list.height=305):(e.top=495,e.height=413,e.list.height=320),e.visible=0<t.list.length&&7777!==BR.ins.curCopyId,e.list.dataSource=t.list,0<t.list.length&&G.timer.once(2e3,e,e.doShowGuide))},i.clickFun=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i&&i.vo&&i.vo.objectId==e?i.onSelectItem(!0):i.onSelectItem(!1)}},i.doShowGuide=function(){var e=this.list.content.getChildAt(0);if(e&&e.vo&&5003==e.vo.modeId){var t=PH.Ins().info;if(t&&0<t.getCurrentGuide(31)&&this.guide_init&&2==t.status&&!LY.Ins().isShow()){this.guide_init=!1;var i=new u_;i.x=e.x+5,i.y=e.y+40,i.width=e.width,i.height=e.height,LY.Ins().show(31,i,!1,this)}}},t.NAME="NavCounterList",t}(),xZ=function(e){function t(){var e=this;e._maxW=720,e._minW=720,e.debug=!1,e._hpMask=null,e._mpMask=null,e._hpLineE=null,e._mpLineE=null,e._hpEffect=null,e._mpEffect=null,e._hpLineM=null,e._mpLineM=null,e._curLv=-1,e._curExp=-1,e._specialRing=null,e._specialRingBreat=null,e._isShowSp=!1,e._isOpen=!1,e._inFlyUpZone=!1,t.__super.call(e),e.initUI()}b(t,"modules.nav.views.sub.NavBottom",bd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.initUI=function(){var e=this;e.imgFlyRed.visible=!1,e._specialRing=kB.createEffect("jm1425",73,75,e.boxR,"jm1425"),e._specialRing.autoClear=!1,e._specialRing.pos(73,75),e.initEffect(),qH.Ins().addNoClears("jm1424"),qH.Ins().addNoClears("jm1425"),e.on("click",e,e.onClick),e.boxM.cacheAs="normal",G.timer.once(2e3,e,e.onTimeOutChangeHP),e.imgExpBar.scaleX=0,AN.ins.addListener("BTN_ROLE",[1],ql.create(e,e.redPtHandler,null,!1)),AN.ins.addListener("BTN_SKILL",[99],ql.create(e,e.redPtHandler,null,!1)),AN.ins.addListener("BTN_ACHIEVE",[,55,56,57,91,225],ql.create(e,e.redPtHandler,null,!1)),AN.ins.addListener("BTN_DZ",[40,52,279,278],ql.create(e,e.redPtHandler,null,!1)),AN.ins.addListener("BTN_BACKPACK",[50,54,275],ql.create(e,e.redPtHandler,null,!1)),AN.ins.addListener("BTN_FLYUP_ROAD",[251],ql.create(e,e.redPtHandler,null,!1))},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onTimeOutChangeHP=function(){this.updateCurrHP(),this.updateCurrMP()},i.clearList=function(){},i.notice=function(e){var t=this;"10206"==e.actionOrder||"10207"==e.actionOrder?0==zB.ins.expRunning&&t.showExp():"HP_CHANGE"==e.actionOrder?t.updateCurrHP():"MP_CHANGE"==e.actionOrder?t.updateCurrMP():"UpdateCurrMP"==e.actionOrder?t.updateCurrMP():"UpdateCurrHP"==e.actionOrder?t.updateCurrHP():"UPDATE_GOV_REDPOINT"==e.actionOrder||"UPDATE_TUJIAN_REDPOINT"==e.actionOrder||"UPDATE_HEJI_RED_POINT"==e.actionOrder||"10206"==e.actionOrder||"21109"==e.actionOrder||"10205"==e.actionOrder||("RESFRESH_BACKPACK_INFO"==e.actionOrder?t.updateRecycleTip():"__SCENE_CHANGED__"==e.actionOrder?t.reSetHp():"checkZone"==e.actionOrder?t.checkZone():"UPDATE_RED_POINT"==e.actionOrder&&t.redPtHandler("BTN_ROLE",!1)),t.updateStatus()},i.updateCurrHP=function(){var e=uH.Ins().getAllHeroHp();e&&this.showHp(e.currHP/e.maxHP)},i.updateCurrMP=function(){var e=uH.Ins().getAllHeroMp();e&&this.showMp(e.currMP/e.maxMP)},i.updateAchieveNewRedPoint=function(){AN.ins.getStateByCareList([57])?this.redPtHandler("BTN_ACHIEVE",!0):this.redPtHandler("BTN_ACHIEVE",!1)},i.updateHeJiRedPoint=function(){iR.instance.checkPointRedPoint()},i.showGuide=function(e,t){if(t)switch(e){case 41:if(2==PH.Ins().info.status){var i=new Uh(Math.floor(this.boxR.x+this.boxR.width/2)-79,Math.floor(this.boxR.y+this.boxR.height/2)-75),n=new u_,s=this.localToGlobal(i,!0);n.x=s.x,n.y=s.y,n.width=this.boxR.width-14,n.height=this.boxR.height,LY.Ins().show(41,n,!1,this)}}else LY.showing&&LY.Ins().close(41)},i.show=function(){this.updateStatus(),this.checkDisppear(),G.stage.on("visibilitychange",this,this.onVisibiltityEvent)},i.checkDisppear=function(){var e=this;e._specialRing&&null==e._specialRing.aunit?e.showSpeRingActEff(e._isShowSp):e._specialRing&&null==e._specialRing.parent?e.showSpeRingActEff(e._isShowSp):null!=e._specialRing||e.showSpeRingActEff(e._isShowSp)},i.onVisibiltityEvent=function(e){this.checkDisppear(),this._specialRing.mouseEnabled=this._specialRing.mouseThrough=!1},i.redPtHandler=function(e,t){var i=this;"BTN_ROLE"==e?(i.btnRole.showTip=AN.ins.getStateByCareList([1]),0==i.btnRole.showTip&&-1<gR.ins.isniePan()&&(i.btnRole.showTip=nB.FIRST_LONGIN)):"BTN_SKILL"==e?i.btnSkill.showTip=t:"BTN_DZ"==e?i.btnDz.showTip=t||rB.checkFazhenOpen()&&rB.firstLogin:"BTN_BACKPACK"==e?(0==(i.btnBag.showTip=t)&&(i.btnBag.showTip=CR.ins.hasRedPoint),i.updateRecycleTip()):"BTN_ACHIEVE"==e?i.btn_achieve.showTip=t:"BTN_FLYUP_ROAD"==e&&i.showSpeRingActEff(t)},i.updateRecycleTip=function(){null!=t.dialogueRecycle&&t.dialogueRecycle.removeSelf(),this.btnBag.showTip&&TR.ins.isShowRecycleTip()&&(null==t.dialogueRecycle?t.dialogueRecycle=eJ.addShow(RP.n[987],eq.navLayer,0,0,!0,3):eq.navLayer.addChild(t.dialogueRecycle),t.dialogueRecycle.centerX=120,t.dialogueRecycle.bottom=120)},i.showSpeRingActEff=function(e){var t=this;this._isShowSp=e,this._inFlyUpZone||(this._specialRing&&this._specialRing.dispose(),this._specialRing=null,e?(null==this._specialRingBreat&&(this._specialRingBreat=kB.createEffect("jm1032",this.imgR.x+this.imgR.width/2-5,this.imgR.y+this.imgR.height/2+6,null),this._specialRingBreat&&(this._specialRingBreat.autoClear=!1),G.timer.once(1e3,this,function(){null!=t._specialRingBreat&&(t.boxR.addChild(t._specialRingBreat),t._specialRingBreat.mouseEnabled=t._specialRing.mouseThrough=!1)})),this._specialRing=kB.createEffect("jm1424",73,75,this.boxR)):(this._specialRingBreat&&(this._specialRingBreat.parent&&this._specialRingBreat.parent.removeChild(this._specialRingBreat),this._specialRingBreat.dispose(),this._specialRingBreat=null),this._specialRing=kB.createEffect("jm1425",73,75,this.boxR)),this._specialRing&&(this._specialRing.autoClear=!1),this.imgFlyRed.visible=e)},i.hide=function(){},i.getExpPt=function(){var e=new Uh(Math.floor(this.imgExpBar.x+this.imgExpBar.width*this.imgExpBar.scaleX),this.imgExpBar.y);return this.localToGlobal(e,!0)},i.getRingPt=function(){var e=new Uh(Math.floor(this.boxR.x+this.boxR.width/2),this.boxR.y+this.boxR.height/2);return this.localToGlobal(e,!0)},i.reSetHp=function(){this.showHp(1)},i.onCompResize=function(){this.resetW(),laya.ui.Component.prototype.onCompResize.call(this)},i.initEffect=function(){var e=this;null==e._hpEffect&&(e._hpEffect=mj.GetNew(),e._hpEffect.renderInSelf=!0,e._hpEffect.loadEffect("jm0018"),e._hpEffect.pos(0,0),e._hpEffect.autoClear=!1,e._hpEffect.mat.identity(),e.spHp.addChild(e._hpEffect)),null==e._mpEffect&&(e._mpEffect=mj.GetNew(),e._mpEffect.renderInSelf=!0,e._mpEffect.loadEffect("jm0019"),e._mpEffect.pos(0,0),e._mpEffect.autoClear=!1,e._mpEffect.mat.identity(),e.spMp.addChild(e._mpEffect)),null==e._hpMask&&(e._hpMask=new pp,e._hpMask.graphics.drawRect(0,-e.spHp.height,e.spHp.width,e.spHp.height,"#123456"),e._hpMask.pos(0,e.spHp.height)),null==e._mpMask&&(e._mpMask=new pp,e._mpMask.graphics.drawRect(0,-e.spMp.height,e.spMp.width,e.spMp.height,"#123456"),e._mpMask.pos(0,e.spMp.height))},i.resetW=function(){if(null!=this.parent){this.parent;this.imgExpBar.width=this.width-289}},i.showExp=function(){-1==this._curLv?(this._curLv=gR.ins.lv,this._curExp=gR.ins.exp,this.imgExpBar.scaleX=gR.ins.exp/gR.ins.maxExp):this.showBarEffect(),this.txExp.changeText(gR.ins.exp+"/"+gR.ins.maxExp)},i.showBarEffect=function(){var e=gR.ins.lv-this._curLv;if(0!=e||this._curExp!=gR.ins.exp){Og.clearAll(this.imgExpBar);var t=0<e?1:gR.ins.exp/gR.ins.maxExp,i=0<e?500:300;Og.to(this.imgExpBar,{scaleX:t},i,null,ql.create(this,this.onEnd),0,!1,!1)}},i.onEnd=function(){1==this.imgExpBar.scaleX?(this._curLv+=1,this.imgExpBar.scaleX=0):this._curExp=gR.ins.exp,this.showBarEffect()},i.showHp=function(e){var t=this;t._hpMask&&t.spHp&&(1<=(t._hpMask.scaleY=e)?t.spHp.mask&&t.spHp.mask.repaint():t.spHp.mask?t._hpMask.repaint():t.spHp.mask=t._hpMask)},i.showMp=function(e){var t=this;t.spMp&&t.boxL&&t.imgL&&t.imgMp&&(1<=(t._mpMask.scaleY=e)?t.spMp.mask&&t.spMp.mask.repaint():t.spMp.mask?t._mpMask.repaint():t.spMp.mask=t._mpMask)},i.onClick=function(e){var t={_subIndex_:0};switch(e.target){case this.btnBag:Tu.sendToModule("BP_OPEN_RED",["modules.backpack.BackpackModule"],t);break;case this.btnSkill:Tu.sendToModule("SKILLVIEW_OPEN_RED",["modules.skill.SkillModule"],t);break;case this.btn_achieve:Tu.sendToModule("OPEN_ACHIEVE_NEW_MAIN_VIEW",["modules.achievenew.AchieveNewModule"]);break;case this.btnDz:Tu.sendToModule("ST_OPEN_RED",["modules.strength.StrengthModule"],t);break;case this.btnRole:Tu.sendToModule("OPEN_RED",["modules.actor.ActorModule"],t);break;case this.boxR:if(!this._isOpen)return void zB.ins.playErrorMsg(RP.n[988]);if(this._inFlyUpZone)return void zB.ins.playErrorMsg(RP.n[989]);Tu.sendToModule("OPEN_LIMIT_CHALLENGE_MAIN",["modules.limitChallenge.LimitChallengeModule"],{subIndex:mN.ins.groupId-1})}},i.updateStatus=function(){if(rB.checkFazhenOpen()&&rB.firstLogin&&(this.btnDz.showTip=!0),!this._isOpen){var e=PH.Ins().info;v_.isWebGL&&(this.boxR.filters=null),this._isOpen=!!e&&10010<=e.taskId,this._isOpen||v_.isWebGL&&Pg.gray(this.boxR,!0)}},i.checkZone=function(){var e=this;v_.isWebGL&&(e.boxR.filters=null),dr.dtoEnterScene&&43==dr.dtoEnterScene.type?(e._inFlyUpZone=!0,e._specialRing.dispose(),e._specialRing=null,e._specialRing=kB.createEffect("jm1425",71,70,e.boxR,"jm1425"),e._specialRingBreat&&e._specialRingBreat.dispose(),e._specialRingBreat=null,e.imgFlyRed.visible=!1,Pg.gray(e.boxR,!0)):(e._inFlyUpZone=!1,e.showSpeRingActEff(e._isShowSp))},p(0,i,"name",function(){return"NavBottom"}),t.NAME="NavBottom",t.dialogueRecycle=null,t.SpecialRingEffId="jm1425",t.SpecialRingBreathId="jm1424",t}(),SZ=function(t){function a(){var e=this;e._life=-1,e._tarHp=NaN,e._nodeHp=NaN,e._maxHp=NaN,e._partHp=0,e._hp_trans=0,e._hp_life=0,e._lastFrameTime=0,e._add_trans=0,e._add_life=0,e._bossId=0,e._visibleStatus=!0,e.isShow=!0,e._extraGrid=null,e._rewardGrid=null,e._showText=null,e._countTime=180,e.firstAdd=!0,e._invalid=!1,a.__super.call(e),e.mc_trans.scrollRect=new u_(0,0,e.mc_trans.width,e.mc_trans.height),e.mc_life.scrollRect=new u_(0,0,e.mc_life.width,e.mc_life.height),e.top=50,e.centerX=0}b(a,"modules.nav.views.navboss.BossHeadTowerView",t);var e=a.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._rewardGrid=new vj,e._rewardGrid._gridW=74,e._rewardGrid._gridH=74,e._rewardGrid._gnameY=77,e._rewardGrid._gnameFont="18px SimHei",e._rewardGrid._gtextH=18,e._rewardGrid._repeatX=3,e._rewardGrid._spaceX=5,e._rewardGrid.pos(e.img_normal.x,e.img_normal.y),e._rewardGrid._hScrollBarSkin=null,e._rewardGrid.size(260,100),e.addChild(e._rewardGrid),e._extraGrid=new MF,e._extraGrid.needGridBg=!0,e._extraGrid.size(74,74),e._extraGrid.x=e.img_extra.x,e._extraGrid.y=e.img_extra.y,e.addChild(e._extraGrid),e._showText=kB.createText(e.img_extra.x-30,e.img_extra.y+e.img_extra.height/2-12,180,24,"",24,"#23b11f"),e.addChild(e._showText)},e.readyShow=function(){this.parent&&(this.isShow=!0,this._doShow())},e.readyHide=function(){this.parent&&(this.isShow=!1,this._doHide())},e._doShow=function(){var e=this;e.parent&&e._visibleStatus&&(G.superSet(st,e,"visible",!0),e.clearTimer(e,e.onHideComplete),Og.clearAll(e),Og.to(e,{alpha:1},100),e.timer.loop(1e3,e,e.loop))},e._doHide=function(){var e=this;!e.parent&&e._visibleStatus||(Og.clearAll(e),Og.to(e,{alpha:0},100,null,ql.create(e,e.onHideComplete)),e.timerOnce(250,e,e.onHideComplete),e.timer.clear(e,e.loop))},e.onHideComplete=function(){this.clearTimer(this,this.onHideComplete),Og.clearAll(this),G.superSet(st,this,"visible",!1),this.isShow||(this._visibleStatus=!0,this.removeSelf())},e.loop=function(){if(this._countTime--,0==this._countTime)return Tu.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ql.create(this,function(){jR.reqAward(BR.ins.curCopyId),Tu.sendToModule("OPEN_MAIN_VIEW",["modules.copy.CopyModule"],{selectedIndex:2})},[])}),void this.timer.clear(this,this.loop);this.txt_countDown.text=RP.n[990]+Jp.getENTickMS(this._countTime)},e.update=function(e,t,i){var n=this;if(t=Math.max(t,0),n._bossId!=e||n._tarHp!=t){if(n._tarHp=t,n._bossId!=e){n._bossId=e;var s=hn.getIndex(n._bossId),o=JSON.parse(hn.MODEL.attributes(s)),a=aa.formatNewAttrToObject(o);n._maxHp=parseInt(a.MAXHP),n.txt_name.changeText(hn.MODEL.name(s));var r,l=hn.MODEL.hpSlot(s);l<=0&&(l=1);var c=hn.MODEL.muId(s);if(s=_n.getIndex(c),r=_n.MODEL.headId(s),n.mc_head.skin=_r.getBossPath(r),n._partHp=Math.ceil(n._maxHp/l),n._nodeHp=n._hp_life=n._hp_trans=n._maxHp,n.clearTimer(n,n.readyHide),0<BR.ins.curCopyId)var u=rn.getIndex(BR.ins.curCopyId),d=rn.MODEL.duration(u);n._countTime=d,n.updateReward(),n.updateExtra(),n.updateShowText(),n.onNode(!0,!0)}else n.onNode();n._tarHp>n._maxHp&&xs.printStack("=================> bossId = "+n._bossId+"  maxHp = "+n._maxHp+"  partHp = "+n._partHp+"  tarHp = "+n._tarHp)}},e.repainMc=function(e,t){var i=t%this._partHp;0==i&&0!=t?i=1:i/=this._partHp;var n=e.scrollRect;n.width=e.width*i,e.scrollRect=n},e.onNode=function(e,t){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!1);var n=Math.max(Math.ceil(i._tarHp/i._partHp),1),s=0;if(i._hp_life==i._tarHp&&i._hp_trans==i._tarHp)i._invalid=!1,s=n,0==i._tarHp&&i.timerOnce(500,i,i.readyHide);else{i._invalid=!0,t&&i._nodeHp%i._partHp==0?(i._tarHp<i._nodeHp?i._hp_life=i._hp_trans=n*i._partHp:i._hp_life=i._hp_trans=(n-1)*i._partHp+1,s=n,i._nodeHp=i._tarHp):(s=Math.max(Math.ceil(i._hp_trans/i._partHp),1),i._nodeHp=s==n?i._tarHp:n<s?(s-1)*i._partHp:s*i._partHp);var o=Math.abs(i._tarHp-i._hp_trans),a=Math.abs(i._nodeHp-i._hp_trans),r=Math.min(Math.ceil(o/i._partHp*1500),1500);r=Math.max(Math.ceil(a/o*r),300),n!=s&&1e3<r&&(r=1e3),i._add_trans=Math.ceil(a/r);250<(r=Math.ceil(o/i._partHp*250))?r=250:r<120&&(r=120),i._add_life=Math.ceil(a/r)}e&&(i.setBloodLift(s),i.repainMc(i.mc_trans,i._hp_trans),i.repainMc(i.mc_life,i._hp_life))},e.onUpdate=function(){var e=this,t=pt.now(),i=t-e._lastFrameTime;e._lastFrameTime=t,e._invalid&&(e._nodeHp<e._hp_trans?e._hp_trans=Math.max(e._hp_trans-e._add_trans*i,e._nodeHp):e._nodeHp>e._hp_trans&&(e._hp_trans=Math.min(e._hp_trans+e._add_trans*i,e._nodeHp)),e._nodeHp==e._hp_life||(e._nodeHp<e._hp_life?e._hp_life=Math.max(e._hp_life-e._add_life*i,e._nodeHp):e._nodeHp>e._hp_life&&(e._hp_life=Math.min(e._hp_life+e._add_life*i,e._nodeHp))),e._hp_trans==e._nodeHp&&e._hp_life==e._nodeHp?e.onNode(!0,!0):(e.repainMc(e.mc_trans,e._hp_trans),0!=e._hp_life&&e._hp_life%e._partHp==0&&e._nodeHp<e._hp_trans?e.repainMc(e.mc_life,e._hp_life+1):e.repainMc(e.mc_life,e._hp_life)))},e.setBloodLift=function(e){var t=this;if(e==t._life)return!1;t._life=e,t.mc_bg.graphics.clear(),t.mc_trans.graphics.clear(),t.mc_life.graphics.clear(),t.num_lf.value="x"+e;var i=e%5;0==i&&(i=5);var n=0;return 0<(n=1==i?e<=1?0:5:i-1)&&t.drawBlood(t.mc_bg.graphics,"boss_gw_xt"+n),t.drawBlood(t.mc_trans.graphics,"boss_gw_xt"+i+"b"),t.drawBlood(t.mc_life.graphics,"boss_gw_xt"+i),!0},e.drawBlood=function(e,t){var i=G.loader.getRes(_r.getAtlasSubPath("mission/"+t+".png"));i&&e.drawTexture(i,0,0,i.width,i.height)},e.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._lastFrameTime=pt.now(),t.frameLoop(1,t,t.onUpdate),t.updateExtra(),t.updateReward(),t.updateShowText(),t.alpha=0,t.readyShow(),Tu.sendToModule("HIDE_GUIDE",["modules.guide.GuideModule"])},e.updateReward=function(){var e=xo.MODEL.firstReward(Lo.instance.currentLevel);this._rewardGrid.setGoodsItems(e,6)},e.updateShowText=function(){var e=this,t=xo.getIndex(Lo.instance.currentLevel+1);if(0!=xo.MODEL.extraAward(t).length){e.img_dext.visible=e.level.visible=!0;var i=xo.MODEL.extraType(t),n=xo.MODEL.extraLevel(t);e.level.value=n.toString();var s="";switch(i){case 1:s="lwt_gat_js.png";break;case 2:s="lwt_gat_hd.png";break;case 3:s="lwt_gat_zchd.png";break;case 4:s="lwt_gat_zcjs.png"}e.img_dext.skin=_r.getAtlasSubPath("mission/"+s);var o=a.dectPosAr[i-1];e.img_dext.pos(o.x,o.y),o=a.levelPosArr[i-1],(4==i||3==i)&&n<10?e.level.pos(o.x+8,o.y+2):e.level.pos(o.x,o.y),e.addChild(e.img_dext),e.addChild(e.level)}else e.img_dext.visible=e.level.visible=!1},e.updateExtra=function(){var e=xo.getIndex(Lo.instance.currentLevel+1),t=xo.MODEL.extraAward(e);if(0!=t.length){var i=yB.createStr(t);i=LR.getIsDragon(i.goodsId)?KH.createStr(t):yB.createStr(t),this._extraGrid.bindData=i;Bi.MODEL.colourId(i.cfgIdx);this._extraGrid.visible=!0,this.img_extra.size(74,74),this._extraGrid.bindData=i,this.txt_extra.text=Bi.MODEL.simpleName(i.cfgIdx),this.txt_extra.color=ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx))}else this._extraGrid.visible=!1,this.txt_extra.text=""},e.hasAward=function(){return!(!this._rewardGrid||!this.firstAdd)&&(this.firstAdd=!1,0<this._rewardGrid.list.length)},e.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.onUpdate),this.timer.clear(this,this.loop),this._bossId=0,Tu.sendToModule("SHOW_GUIDE",["modules.guide.GuideModule"])},p(0,e,"visible",function(){return this._visibleStatus},function(e){this._visibleStatus!=e&&((this._visibleStatus=e)?this._doShow():this._doHide())}),f(a,["levelPosArr",function(){return this.levelPosArr=[new Uh(469,129),new Uh(469,129),new Uh(491,139),new Uh(491,139)]},"dectPosAr",function(){return this.dectPosAr=[new Uh(454,123),new Uh(454,123),new Uh(431,114),new Uh(431,114)]}]),a}(st),kZ=function(e){function i(){var e=this;e._life=-1,e._tarHp=0,e._nodeHp=0,e._maxHp=0,e._partHp=0,e._hp_trans=0,e._hp_life=0,e._lastFrameTime=0,e._add_trans=0,e._add_life=0,e._bossId=0,e._visibleStatus=!0,e.isShow=!0,e.firstAdd=!0,e.isAward=!1,e._durationTime=NaN,e._invalid=!1,e.isCDIng=!1,e._personBossReward,i.__super.call(e),e.mc_trans.scrollRect=new u_(0,0,e.mc_trans.width,e.mc_trans.height),e.mc_life.scrollRect=new u_(0,0,e.mc_life.width,e.mc_life.height),e.hunBox.visible=!1}b(i,"modules.nav.views.navboss.BossHeadView",ot);var t=i.prototype;return t.onOpenReward=function(e){qU.ins._onDropBtnClick(e)},t.readyShow=function(){this.parent&&(this.isShow=!0,this._doShow())},t.readyHide=function(){this.parent&&(this.isShow=!1,this._doHide())},t._doShow=function(){var e=this;e.parent&&e._visibleStatus&&(G.superSet(ot,e,"visible",!0),e.clearTimer(e,e.onHideComplete),e.clearTimer(e,e.onTimer),Og.clearAll(e),Og.to(e,{alpha:1},100),e.hunBox.visible=!1,e.img_hdbar.scaleX=1)},t._doHide=function(){var e=this;!e.parent&&e._visibleStatus||(Og.clearAll(e),Og.to(e,{alpha:0},100,null,ql.create(e,e.onHideComplete)),e.timerOnce(250,e,e.onHideComplete),e.hideHD())},t.onHideComplete=function(){var e=this;e.clearTimer(e,e.onHideComplete),e.clearTimer(e,e.onTimer),Og.clearAll(e),G.superSet(ot,e,"visible",!1),e.isShow||(e._visibleStatus=!0,e.removeSelf(),e.hideHD())},t.showHunDunInfoEx=function(e){null==i.toc24103&&(i.toc24103=e),i._leftTime=i.toc24103.buffVO.leftTime,i.HuDunEndTime=dr.curServerTime+i.toc24103.buffVO.leftTime,this.showHD()},t.showHunDunInfo=function(e){switch(e.actionOrder){case"NAV_UPDATE_BOSS_BUFF_START":null==i.toc24103&&(i.toc24103=e.proto.proto),i._leftTime=i.toc24103.buffVO.leftTime,i.HuDunEndTime=dr.curServerTime+i.toc24103.buffVO.leftTime,this.showHD();break;case"NAV_UPDATE_BOSS_BUFF_END":Tu.sendToModule("NAV_BOSS_HUDUN_OVER",["modules.boss.BossModule"]),i._leftTime=0,i.HuDunEndTime=0,this.clearTimer(this,this.onTimer),this.hunBox.visible=!1,this.img_hdbar.scaleX=1}},t.reSetName=function(){if(0!=this._bossId){var e=hn.getIndex(this._bossId);this.txt_name.changeText(""),this.txt_name.changeText(hn.MODEL.name(e)+"(lv."+hn.MODEL.level(e)+")"),this.btn_award.label="",this.btn_award.label="奖 励"}},t.update=function(e,t,i){var n=this;if(t=Math.max(t,0),n.showHD(),n._bossId!=e||n._tarHp!=t){if(n._tarHp=t,n._bossId!=e){n._bossId=e;var s=hn.getIndex(n._bossId),o=JSON.parse(hn.MODEL.attributes(s)),a=aa.formatNewAttrToObject(o);n._maxHp=parseInt(a.MAXHP),n.txt_name.changeText(hn.MODEL.name(s)+"(lv."+hn.MODEL.level(s)+")");var r,l=hn.MODEL.hpSlot(s);l<=0&&(l=1);var c=hn.MODEL.muId(s);s=_n.getIndex(c),(r=_n.MODEL.headId(s))&&"0.0"!=r&&(n.mc_head.skin=_r.getBossPath(r),G.timer.once(100,n,n.loadHeadImg,[_r.getBossPath(r)])),n._partHp=Math.ceil(n._maxHp/l),n._nodeHp=n._hp_life=n._hp_trans=n._maxHp,n.clearTimer(n,n.readyHide),n.onNode(!0,!0)}else n.onNode();n._tarHp>n._maxHp&&xs.printStack("=================> bossId = "+n._bossId+"  maxHp = "+n._maxHp+"  partHp = "+n._partHp+"  tarHp = "+n._tarHp)}},t.loadHeadImg=function(e){if(null==this.mc_head.texture){var t=yc.getRes(e);t?this.mc_head.source=t:G.loader.load(e,ql.create(this,this.setSource,[e]))}},t.setSource=function(e){var t=yc.getRes(e);this.mc_head.source=t},t.repainMc=function(e,t){var i=t%this._partHp;0==i&&0!=t?i=1:i/=this._partHp;var n=e.scrollRect;n.width=e.width*i,e.scrollRect=n},t.onNode=function(e,t){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!1);var n=Math.max(Math.ceil(i._tarHp/i._partHp),1),s=0;if(i._hp_life==i._tarHp&&i._hp_trans==i._tarHp)i._invalid=!1,s=n,0==i._tarHp&&i.timerOnce(500,i,i.readyHide);else{i._invalid=!0,t&&i._nodeHp%i._partHp==0?(i._tarHp<i._nodeHp?i._hp_life=i._hp_trans=n*i._partHp:i._hp_life=i._hp_trans=(n-1)*i._partHp+1,s=n,i._nodeHp=i._tarHp):(s=Math.max(Math.ceil(i._hp_trans/i._partHp),1),i._nodeHp=s==n?i._tarHp:n<s?(s-1)*i._partHp:s*i._partHp);var o=Math.abs(i._tarHp-i._hp_trans),a=Math.abs(i._nodeHp-i._hp_trans),r=Math.min(Math.ceil(o/i._partHp*2200),2200);r=Math.max(Math.ceil(a/o*r),300),n!=s&&1e3<r&&(r=1e3),i._add_trans=Math.ceil(a/r);250<(r=Math.ceil(o/i._partHp*250))?r=250:r<120&&(r=120),i._add_life=Math.ceil(a/r)}e&&(i.setBloodLift(s),i.repainMc(i.mc_trans,i._hp_trans),i.repainMc(i.mc_life,i._hp_life))},t.onUpdate=function(){var e=this,t=pt.now(),i=t-e._lastFrameTime;e._lastFrameTime=t,e._invalid&&(e._nodeHp<e._hp_trans?e._hp_trans=Math.max(e._hp_trans-e._add_trans*i,e._nodeHp):e._nodeHp>e._hp_trans&&(e._hp_trans=Math.min(e._hp_trans+e._add_trans*i,e._nodeHp)),e._nodeHp==e._hp_life||(e._nodeHp<e._hp_life?e._hp_life=Math.max(e._hp_life-e._add_life*i,e._nodeHp):e._nodeHp>e._hp_life&&(e._hp_life=Math.min(e._hp_life+e._add_life*i,e._nodeHp))),e._hp_trans==e._nodeHp&&e._hp_life==e._nodeHp?e.onNode(!0,!0):(e.repainMc(e.mc_trans,e._hp_trans),0!=e._hp_life&&e._hp_life%e._partHp==0&&e._nodeHp<e._hp_trans?e.repainMc(e.mc_life,e._hp_life+1):e.repainMc(e.mc_life,e._hp_life)))},t.setBloodLift=function(e){var t=this;if(e==t._life)return!1;t._life=e,t.mc_bg.graphics.clear(),t.mc_trans.graphics.clear(),t.mc_life.graphics.clear(),t.num_lf.value="x"+e;var i=e%5;0==i&&(i=5);var n=0;return 0<(n=1==i?e<=1?0:5:i-1)&&t.drawBlood(t.mc_bg.graphics,"boss_gw_xt"+n),t.drawBlood(t.mc_trans.graphics,"boss_gw_xt"+i+"b"),t.drawBlood(t.mc_life.graphics,"boss_gw_xt"+i),!0},t.drawBlood=function(e,t){var i=G.loader.getRes(_r.getAtlasSubPath("mission/"+t+".png"));i&&e.drawTexture(i,0,0,i.width,i.height)},t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._lastFrameTime=pt.now(),t.frameLoop(1,t,t.onUpdate),t.alpha=0,t.firstAdd=!0,t.readyShow(),Tu.sendToModule("HIDE_GUIDE",["modules.guide.GuideModule"]),t.isAward=!1,t.resetHeadLoc(),t.btn_award.on("click",t,t.onOpenReward);var i=dr.dtoEnterScene;if(i&&6==i.type){var n=rn.getIndex(BR.ins.curCopyId),s=rn.MODEL.key(n),o=BR.ins.checkPersonHasFirstKillReward(s);if(0<=o&&BR.ins.bossPersonHash&&0==BR.ins.bossPersonHash.take(BR.ins.curCopyId).passTimes){null==t._personBossReward&&(t._personBossReward=new MF(74),t.box_firstKill.addChild(t._personBossReward)),t.box_firstKill.visible=!0,t.firstkilltip.visible=!0,t.box_firstKill.pos(128,134),t.firstkilltip.pos(120,125),t.addChild(t.firstkilltip),t.isAward=!0;var a=gR.ins.actorById(1).job-1,r=yB.createStrArr(Bu.MODEL.reward(o))[a];t._personBossReward.dataSource=r,t.txt_firstKillName.text=r.simpleName,t.txt_firstKillName.color=ms.getByQuality(Bi.MODEL.colourId(r.cfgIdx))}else t.box_firstKill.visible=!1,t.firstkilltip.visible=!1}else if(!i||7!=i.type&&49!=i.type)t.box_firstKill.visible=!1,t.firstkilltip.visible=!1;else{var l=BR.ins.bossWildHash.take(BR.ins.curCopyId);if(l&&l.isFirstKill){null==t._personBossReward&&(t._personBossReward=new MF(74),t.box_firstKill.addChild(t._personBossReward)),t.box_firstKill.visible=!0,t.firstkilltip.visible=!0,t.isAward=!0;var c=BR.ins.getFirstKillReward(BR.ins.curCopyId),u=yB.create(c.id,c.count);t._personBossReward.dataSource=u,t.txt_firstKillName.text=u.simpleName,t.txt_firstKillName.color=ms.getByQuality(Bi.MODEL.colourId(u.cfgIdx))}else t.box_firstKill.visible=!1,t.firstkilltip.visible=!1}},t.onRemove=function(e){var t=this;t.clearTimer(t,t.onUpdate),t._bossId=0,i.toc24103=null,BR.ins.bossHuDunData=null,t.hunBox.visible=!1,Tu.sendToModule("SHOW_GUIDE",["modules.guide.GuideModule"]),t.btn_award.off("click",t,t.onOpenReward),t.clearTimer(t,t.onHideComplete),t.clearTimer(t,t.onTimer),Og.clearAll(t),ui.ViewBase.prototype.onRemove.call(t,e)},t.onTimer=function(){var e=this,t=i.HuDunEndTime-dr.curServerTime;if(t<0)return e.isCDIng=!1,e.event("end"),e.clearTimer(e,e.onTimer),void(e.hunBox.visible=!1);e.hunBox.visible=!0,e.img_hdbar.scaleX=t/e._durationTime,1<e.img_hdbar.scaleX&&(e.img_hdbar.scaleX=1)},t.resetHeadLoc=function(){dr.dtoEnterScene&&13==dr.dtoEnterScene.type?(this.left=NaN,this.centerX=0,this.top=160):(this.left=30,this.centerX=NaN,this.top=24)},t.showHD=function(){var e=this;if(i.toc24103&&i.toc24103.buffVO&&0<i._leftTime){var t=Ls.getIndex(i.toc24103.buffVO.buffid);e._durationTime=Ls.MODEL.duration(t),e.hunBox.visible=!0,0<i._leftTime?(e.isCDIng=!0,G.timer.loop(950,e,e.onTimer),e.onTimer()):(e.hunBox.visible=!1,e.clearTimer(e,e.onTimer),e.isCDIng=!1)}else e.hunBox.visible=!1,G.timer.clear(e,e.onTimer)},t.hideHD=function(){this.hunBox.visible=!1,this.img_hdbar&&this.img_hdbar._style&&(this.img_hdbar.scaleX=1),i.toc24103=null,G.timer.clear(this,this.onTimer)},t.hasAward=function(){return!(!this.firstAdd||!this.isShow)&&(this.firstAdd=!1,this.isAward)},p(0,t,"visible",function(){return this._visibleStatus},function(e){this._visibleStatus!=e&&((this._visibleStatus=e)?this._doShow():this._doHide())}),i.toc24103=null,i._leftTime=NaN,i.HuDunEndTime=NaN,i}(),EZ=function(e){function a(){a.__super.call(this),this.left=6,this.bottom=200}b(a,"modules.nav.views.sub.NavExit",kd);var t=a.prototype;return t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exit.on("click",this,this.onClick),sJ.ins.setTop("NavExit")},t.destroy=function(e){void 0===e&&(e=!0),a.alertMsg=null,a.callback=null,laya.ui.View.prototype.destroy.call(this,e)},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_exit.off("click",this,this.onClick),a.alertMsg=null,a.callback=null},t.onClick=function(e){if(a.callback)a.callback.run();else{var t=BR.ins.curCopyId,i=rn.getIndex(t),n=rn.MODEL.cate(i);if(1==BR.ins.wildIsAuto||1==BR.ins.godIsAuto){var s=new kA;switch(n){case 3:BR.ins.wildIsAuto=!1;break;case 13:BR.ins.godIsAuto=!1;break;case 49:BR.ins.wildIsAuto=!1}s.isOpen=0,s.type=n,Tu.sendToService(s)}switch(uF.firstAtt=!0,uF.firstDef=!0,n){case 57:if((Po.ins().currentSelectMissionID=0)<Hu.count)this.onJxrComplete();else{var o=[{url:_r.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Hu}];uc.ins().onLoadJxrs(o,ql.create(this,this.onJxrComplete))}BR.ins.crossAwardArr=[];break;default:BR.ins.exitCopy(300),BR.ins.isCrossFirst=!1,BR.ins.crossAwardArr=[]}}hN.ins.isOpen("RESULT_FAIL")&&hN.ins.close("RESULT_FAIL"),hN.ins.isOpen("FLYUPNPCCBBTIP")&&hN.ins.close("FLYUPNPCCBBTIP")},t.onJxrComplete=function(){for(var e=BR.ins.curCopyId,t=0;t<Hu.count;t++)if(e==Hu.MODEL.nextMissionId(t)){var i=Hu.MODEL.location(t);i[0],i[1];break}jR.reqEntry(3096,0,0,0,0,BR.ins.curCopyId)},t.onConfirm=function(e){1==e&&(a.callback?a.callback.run():BR.ins.exitCopy(300))},p(0,t,"name",function(){return"NavExit"}),a.NAME="NavExit",a.alertMsg=null,a.callback=null,a}(),TZ=function(e){function i(){this._currentTime=0,this._targetTime=0,this._passTime=0,this._circle=null,this._currentQaulity=0,this._timeArr=null,i.__super.call(this)}b(i,"modules.nav.views.sub.NavFairylandView",e);var t=i.prototype;return G.imps(t,{"modules.nav.others.INav":!0}),t.destroy=function(e){void 0===e&&(e=!0),this.hide(),this._circle&&this._circle.removeSelf(),this._circle=null,this._timeArr=null,laya.ui.View.prototype.destroy.call(this,e)},t.createChildren=function(){e.prototype.createChildren.call(this),null==this._circle&&(this._circle=new pp,this._circle.graphics.drawCircle(0,0,this.img_circle.width/2,"#123456"),this._circle.pos(0,0),this.img_circle.mask=this._circle)},t.clearList=function(){},t.notice=function(e){switch(e.actionOrder){case"CHALLENGE_FINISH":G.timer.clear(this,this.loop)}},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),G.timer.loop(1e3,this,this.loop)},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),G.timer.clear(t,t.loop),t.img_circle&&t.img_circle.skin&&(t.img_circle.skin=null),t.img_circle_bg&&t.img_circle_bg.skin&&(t.img_circle_bg.skin=null),t.img_quality&&t.img_quality.skin&&(t.img_quality.skin=null)},t.show=function(){var e=this,t=nN.instance.currentLevel;t>=ir.count&&(t=ir.count-1),e._timeArr=ir.MODEL.passTime(t),e._currentTime=0,e._currentQaulity=0,e._passTime=0,e._targetTime=e._timeArr[e._currentQaulity]-e._passTime,e.img_circle.skin=_r.getFullUrl("ui/images/godweapon/sb_sbhj_fbpj_jdt.png"),e.img_circle_bg.skin=_r.getFullUrl("ui/images/godweapon/sb_sbhj_fbpj_dk.png"),e.updateView(),e.updateTime()},t.hide=function(){},t.updateView=function(){this.img_quality.skin=_r.getFullUrl("ui/images/godweapon/quality_"+this._currentQaulity+".png");var e=nN.instance.currentLevel;e>=ir.count&&(e=ir.count-1);var t=nN.instance.getRewardByLevelAndQuality(0==e?1:e+1,this._currentQaulity),i=yB.createStr(t).goodsNum;this.txt_exp.innerHTML=Ql.createColor(RP.n[991],"#e0d6c1")+Ql.createColor(mp.getBigIntStr(i),"#ff831e"),this.txt_quality.innerHTML=Ql.createColor(this._targetTime+"秒","#ff831e")+Ql.createColor(RP.n[992],"#e0d6c1")+Ql.createColor(Ir.QUALITY_NAME_ARR[this._currentQaulity],"#ff831e")+Ql.createColor("评价","#e0d6c1")},t.updateQuality=function(){var e=this;e._currentQaulity<3?(e._currentQaulity++,e._currentTime=0,e._targetTime=e._timeArr[e._currentQaulity]-e._passTime):G.timer.clear(e,e.loop),e.updateView()},t.updateTime=function(){var e=this,t=i.MIN_ANGLE+(270-i.MIN_ANGLE)*(e._currentTime/e._targetTime);e._circle.graphics.clear(),e._circle.graphics.drawPie(e.img_circle.width>>1,e.img_circle.height>>1,e.img_circle.width>>1,t,270,"#000000"),e._circle.repaint(),e.txt_time.text=Jp.simpleFormat(e._targetTime-e._currentTime),e.txt_time.color="#FF0000"},t.loop=function(){this._currentTime++,this._passTime++,this.updateTime(),this._currentTime>=this._targetTime&&this.updateQuality()},p(0,t,"name",function(){return"NavFairylandView"}),i.NAME="NavFairylandView",i.MIN_ANGLE=-90,i.MAX_ANGLE=270,i}(Ed),CZ=function(e){function t(){var e=this;t.__super.call(e),e.top=310,e.counterIcon.visible=!1,e.title.text=RP.n[993],e.list.itemRender=LZ,e.left=0,e.list.dataSource=[],e.list.height=120,e.list.vScrollBarSkin="",e.height=220}b(t,"modules.nav.views.sub.NavMonsterAttackList",pd);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.visible=!1,this.showInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.clearList=function(){this.list.dataSource=[],this.list.refresh(),this.visible=!1},i.notice=function(e){switch(e.actionOrder){case"24033":this.showInfo();break;case"NAV_ATTACK_MONSTER_LIST_SELECT":LN.attackMonsterSelect?this.clickFun(LN.attackMonsterSelect.objectId):this.clearSelected()}},i.showInfo=function(){var e=BR.ins.toc24033;e&&(dr.dtoEnterScene&&12==dr.dtoEnterScene.type?this.top=310:dr.dtoEnterScene&&13==dr.dtoEnterScene.type?this.top=322:this.top=210,this.list.dataSource=e.list,this.visible=0<e.list.length,this.list.refresh())},i.clickFun=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i&&i.vo&&i.vo.objectId==e?i.onSelectItem(!0):i.onSelectItem(!1)}},i.clearSelected=function(){for(var e=0;e<this.list.content.numChildren;e++){this.list.content.getChildAt(e).onSelectItem(!1)}},t.NAME="NavMonsterAttackList",t}(),LZ=function(e){function t(){this.vo=null,t.__super.call(this),this.btn.selected=!1}b(t,"modules.nav.views.sub.NavMonsterAttackListItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.vo=null,laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onGoClicked)},i.onGoClicked=function(e){sH.fights(this.vo.objectId),LN.attackSelect=null,LN.attackMonsterSelect=this.vo,LN.attackCollcetionSelect=null,Tu.sendToModule("NAV_ATTACK_MONSTER_LIST_SELECT",["modules.nav.NavModule"],this.vo),Tu.sendToModule("NAV_ATTACK_LIST_SELECT",["modules.nav.NavModule"],this.vo),Tu.sendToModule("NAV_ATTACK_COLLECTION_LIST_SELECT",["modules.nav.NavModule"])},i.onSelectItem=function(e){this.btn.selected=e},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.vo=e,t.vo){var i=hn.getIndex(t.vo.bossid);t.tx_name.changeText(hn.MODEL.name(i));var n=hn.MODEL.muId(i);i=_n.getIndex(n),t.head.skin=_r.getBossPath(_n.MODEL.headId(i)),t.head.scaleX=t.head.scaleY=.6,t.head.centerX=0,t.head.centerY=-20,t.tx_guild.text=""}}),t}(fd),MZ=function(e){function t(){this._equipEff=null,t.__super.call(this),this.top+=98,this.on("click",this,this.onClick),this._equipEff=mj.GetNew(),this._equipEff.loadEffect("jm1375")}b(t,"modules.nav.views.sub.NavFirstPayTime",Cd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.notice=function(e){"10206"==e.actionOrder||e.actionOrder},i.show=function(){},i.hide=function(){},i.clearList=function(){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),G.timer.loop(10,this,this.loop),G.timer.loop(2e3,this,this.createEff),qH.Ins().addNoClears("jm1375"),this.updateLuckNav(!0)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t._equipEff&&(t._equipEff.parent&&t._equipEff.parent.removeChild(t._equipEff),t._equipEff&&t._equipEff.dispose(),t._equipEff=null,qH.Ins().removeNoClears("jm1375")),t.updateLuckNav(!1)},i.updateLuckNav=function(e){var t=new Tu;t.setup("updateNavUI",[],{isShow:e}),sJ.ins.notice(["NavLuckDrop","NavPetBirth"],t),t.recover()},i.onClick=function(e){Tu.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"])},i.createEff=function(){this._equipEff=kB.createEffect("jm1375",5,this.height/2,this),this._equipEff.scale_X=2.16,this._equipEff.scale_Y=1.15},i.loop=function(){if(HN.ins.to_31011)return HN.ins.to_31011&&HN.ins.to_31011.times<=0?(G.timer.clear(this,this.loop),void Tu.sendToModule("CHANGE_FIRSTPAY_TIME",["modules.nav.NavModule"])):void(HN.ins.to_31011&&(HN.ins.to_31011.times-=16.1,this.dtime.text=t.simpleFormat(HN.ins.to_31011.times/10)));G.timer.clear(this,this.loop)},p(0,i,"name",function(){return"NavFirstPayTime"}),t.simpleFormat=function(e){var t="",i=Math.floor(e/6e3);t+=0<i?10<=i?i.toFixed(0)+":":"0"+i+":":"00:";var n=Math.floor((e-6e3*i)/100);t+=0<n?10<=n?n+":":"0"+n+":":"00:";var s=Math.floor(e-6e3*i-100*n);return t+=10<=s?s+"":"0"+s},t.NAME="NavFirstPayTime",t}(),AZ=function(e){function t(){t.__super.call(this),0<dr.xgame&&(this.top=60)}b(t,"modules.nav.views.sub.NavHejiMission",Ld);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showHejiState()},i.onRemove=function(e){this.off("click",this,this.onChangeAutoHeji),ui.ViewBase.prototype.onRemove.call(this,e)},i.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":gR&&this.showHejiState()}},i.showHejiState=function(){var e=this;if(0!=e.checkIsSHowHejiBtn())if(0!=BR.ins.curCopyId)if(aB.instance.activedRingId<1)e.visible=!1;else{e.visible=!0;var t=rn.getIndex(BR.ins.curCopyId),i=rn.MODEL.cate(t),n=ER.ins.getHeJiSettiongByCate(i);0<n?(e.visible=!0,e.img_heji.skin=2==n?_r.getAtlasSubPath("basic_ui_3/jm_hjl.png"):_r.getAtlasSubPath("basic_ui_3/jm_hjh.png"),e.on("click",e,e.onChangeAutoHeji)):(e.visible=!1,e.off("click",e,e.onChangeAutoHeji))}else e.visible=!1;else e.visible=!1},i.onChangeAutoHeji=function(e){ER.ins.updateHeJiChange(),this.showHejiState()},i.checkIsSHowHejiBtn=function(){var e=!0;return dr.dtoEnterScene&&(12!=dr.dtoEnterScene.type&&13!=dr.dtoEnterScene.type||(e=!1)),e},t.NAME="NavHejiMission",t}(),DZ=function(e){function t(){this._notice="",t.__super.call(this)}b(t,"modules.nav.views.sub.NavHotupdate",Dd);var i=t.prototype;return i.notice=function(e){e&&(this._notice=e.proto.notice)},i.onclickHandler=function(e){1==e&&pt.window.location.reload()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_update.on("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),t.alertMsg=null,t.callback=null,laya.ui.View.prototype.destroy.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_update.off("click",this,this.onClick),t.alertMsg=null,t.callback=null},i.onClick=function(e){KQ.ins.show(this._notice,ql.create(this,this.onclickHandler),!1,3,RP.n[994])},t.NAME="NavHotupdate",t.alertMsg=null,t.callback=null,t}(),OZ=function(e){function t(){this._cd=0,t.__super.call(this),this.left=6,this.bottom=200,this.mouseThrough=!0}b(t,"modules.nav.views.sub.NavInCallBoss",Od);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.checkCD(),this.on("click",this,this.onClick)},i.onRemove=function(e){this.off("click",this,this.onClick),G.timer.clear(this,this.loopCD)},i.onClick=function(e){switch(e.target){case this.btnExit:KQ.ins.show(Ql.createColor(RP.n[995],"#ff2e24")+RP.n[996]+Ql.createColor(RP.n[997],"#ff2e24")+RP.n[998],ql.create(this,this.onExit,null,!1),!1,3,null,null,!0,0);break;case this.btnCallF:this.checkCD(!0)}},i.checkCD=function(e){var t=this;if(void 0===e&&(e=!1),t._cd=modules.guild.others.GuildCallBossUtils.ins.cdTime,t._cd<0){if(t.btnCallF.disabled=!1,t.imgCD.visible=!1,e){modules.guild.others.GuildCallBossUtils.ins.startCallCD(),t._cd=30;var i=new WM;i.missionId=modules.guild.others.GuildCallBossUtils.ins._missionId,Tu.sendToService(i),zB.ins.playRainbowByWords(RP.n[999],5e3),t.imgCD.visible=!0,t.btnCallF.disabled=!0,t.labTime.text="冷却:"+t._cd+"秒",G.timer.loop(1e3,t,t.loopCD)}}else t.imgCD.visible=!0,t.btnCallF.disabled=!0,t.labTime.text="冷却:"+t._cd+"秒",G.timer.loop(1e3,t,t.loopCD)},i.loopCD=function(){if(this._cd--,this._cd<0)return this.btnCallF.disabled=!1,G.timer.clear(this,this.loopCD),void(this.imgCD.visible=!1);this.labTime.text="冷却:"+this._cd+"秒"},i.onExit=function(e){0!=e&&(BR.ins.exitCopy(300),hN.ins.isOpen("RESULT_FAIL")&&hN.ins.close("RESULT_FAIL"))},t.NAME="NavInCallBoss",t}(),PZ=function(e){function t(){this._activityEff=null,t.__super.call(this)}b(t,"modules.nav.views.sub.NavLimitZhuiJi",Pd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.notice=function(e){e.actionOrder},i.onClicked=function(e){},i.initView=function(){var e=this,t=gR.ins.actorList[0];e._activityEff&&e._activityEff.dispose(),e._activityEff=null,e._activityEff=kB.createEffect(xW.ACTIVITY_EFFECT_ID_ARR[t.job-1],e.img_skill.x+35,e.img_skill.y+35,e),e._activityEff.alpha=.01,e._activityEff.scale_X=.6,e._activityEff.scale_Y=.6,Og.to(e._activityEff,{alpha:1},1e3,pa.circIn,ql.create(e,e.onActivityEffFakeEnd));var i=ei.getIndex(4294);e.txt_countDown.innerHTML=ei.MODEL.content(i),e.txt_countDown.leading=5},i.show=function(){this.initView()},i.onActivityEffFakeEnd=function(){},i.loop=function(){},i.showBubble=function(){},i.fakeBubble=function(){},i.hide=function(){this.clearList()},i.clearList=function(){G.timer.clearAll(this),Og.clearAll(this._activityEff),this._activityEff&&(this._activityEff.destroy(),this._activityEff=null)},p(0,i,"name",function(){return"NavLimitZhuiJi"}),t.NAME="NavLimitZhuiJi",t.BUBBLE_TIME=3e3,t.MAX_BUBBLT_TIME=4,t}(),RZ=function(e){function t(){this._eff=null,t.__super.call(this),this.dtime.text="0"}b(t,"modules.nav.views.sub.NavLuckDrop",Rd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.notice=function(e){e&&("updateNavUI"==e.actionOrder?this.updatePos(e.proto.isShow):"30721"==e.actionOrder&&this.updateTimes(e.proto.times))},i.updateTimes=function(e){this.dtime.text=e+"",e<=0&&G.timer.clear(this,this.createEff)},i.show=function(){this.on("click",this,this.onClick),sJ.ins.isOpen("NavFirstPayTime")?this.top=341:this.top=428,this.updatePetNav()},i.hide=function(){this.off("click",this,this.onClick),this.updatePetNav()},i.updatePos=function(e){this.top=e?341:428,qH.Ins().addNoClears("jm1375"),this.updatePetNav()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),G.timer.loop(2e3,this,this.createEff),qH.Ins().addNoClears("jm1375")},i.updatePetNav=function(){var e=new Tu;e.setup("updateNavUI2",[],{topValue:this.top}),sJ.ins.notice(["NavPetBirth"],e),e.recover()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),G.timer.clear(t,t.createEff),t._eff&&(t._eff.parent&&t._eff.parent.removeChild(t._eff),t._eff&&t._eff.dispose(),t._eff=null,qH.Ins().removeNoClears("jm1375"))},i.createEff=function(){this._eff&&this._eff.dispose(),this._eff=null,this._eff=kB.createEffect("jm1375",5,this.height/2,this),this._eff.scale_X=2.16,this._eff.scale_Y=1.15},i.onClick=function(e){eU.toSelectIndex=0,CN.dealActIcon(CN.getIconBtn(11))},i.clearList=function(){},p(0,i,"name",function(){return"NavLuckDrop"}),t.NAME="NavLuckDrop",t}(),NZ=function(e){function t(){t.__super.call(this),this.btn_mine.tipOffX=7,this.btn_mine.tipOffY=-9,this.on("click",this,this.onClicked)}b(t,"modules.nav.views.sub.NavMineView",Hd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.clearList=function(){},i.notice=function(e){this.updateStatus(),AN.ins.addListener("BTN_SPORTS",[64,102,215,101],ql.create(this,this.redPtHandler,null,!1))},i.show=function(){this.updateStatus()},i.redPtHandler=function(e,t){AN.ins.getStateByCareList([64]),AN.ins.getStateByCareList([102]),AN.ins.getStateByCareList([215]),AN.ins.getStateByCareList([101]),this.btn_mine.showTip=t},i.hide=function(){},i.updateStatus=function(){var e=parseInt($e.MODEL.value($e.getIndex(121))),t=PH.Ins().info;this.visible=!!t&&e<=t.taskId},i.onClicked=function(e){Tu.sendToModule("OPEN_SPORTS_VIEW",["modules.digger.DiggerModule"])},i.destroy=function(e){void 0===e&&(e=!0),this.off("click",this,this.onClicked),AN.ins.removeListener("BTN_SPORTS"),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"name",function(){return"NavMineView"}),t.NAME="NavMineView",t}(),BZ=function(e){function t(){this._currentMissionID=0,this._pointDataArr=null,this._imgPointArr=null,this._sceneID=0,this.gkDto=null,this.widthPrecent=.035,this.heightPrcent=.035,t.__super.call(this)}b(t,"modules.nav.views.sub.NavMiniMap",Vd);var i=t.prototype;return G.imps(i,{"modules.nav.others.INav":!0}),i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onMapClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.on("click",this,this.onMapClicked),G.timer.clearAll(this);var t=yc.getRes(this.img_map.skin);t&&t.destroy(),this.img_map.skin=""},i.onMapClicked=function(e){hN.ins.isOpen("MapPanel")||hN.ins.open("MapPanel")},i.hide=function(){},i.show=function(){this._currentMissionID=BR.ins.curCopyId,this.initView(),G.timer.loop(200,this,this.updateMainChar),this.updateSceneMonsterTransPoint(),G.timer.loop(1e3,this,this.updateSceneMonsterTransPoint)},i.clearList=function(){},i.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":break;case"25018":this.refreshPoint()}},i.initView=function(){var e=this;e.img_map.skin=_r.getFullUrl("ui/images/map/mini/"+e._currentMissionID+".jpg");var t=rn.getIndex(e._currentMissionID);Pn.getIndex(rn.MODEL.cId(t));if(e._sceneID=Pn.MODEL.sid(rn.MODEL.cId(t)),e.gkDto=IB.hash.take(rn.MODEL.cId(t)),e._pointDataArr=[],e._imgPointArr=[],0<Hu.count)e.onJxrComplete();else{var i=[{url:_r.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Hu}];uc.ins().onLoadJxrs(i,ql.create(e,e.onJxrComplete))}},i.onJxrComplete=function(){this.updatePoint(),this.refreshPoint()},i.updateMainChar=function(){var e=NF.mainChar,t=e.dir;this.img_arrow.rotation=45*t-60,this.img_arrow.x=e.x*this.widthPrecent+5,this.img_arrow.y=e.y*this.heightPrcent+5},i.refreshPoint=function(){var e;for(var t in this._imgPointArr){e=this._imgPointArr[t];var i=xN.Ins().mapBossDate[e.name];e&&i&&(i.bossHp<=0?e.visible=!1:e.visible=!0)}},i.updatePoint=function(){for(var e,t,i=0;i<Hu.count;i++)Hu.MODEL.missionId(i)==this._currentMissionID&&((e=new Object).missionID=Hu.MODEL.missionId(i),e.pointArr=Hu.MODEL.location(i),e.nextID=Hu.MODEL.nextMissionId(i),this._pointDataArr.push(e));for(var n=NaN,s=NaN,o=0;o<this._pointDataArr.length;o++)t=new Kl,this.addChild(t),n=(e=this._pointDataArr[o]).pointArr[0],s=e.pointArr[1],t.x=80*n*this.widthPrecent,t.y=40*s*this.heightPrcent,t.name=e.nextID,t.skin="ui/layouts/mainframe/mjrq_dt_hd.png",this._imgPointArr.push(t)},i.updateSceneMonsterTransPoint=function(){var e,t=xN.Ins().mapBossDate;for(var i in zN.charQueue)if((e=zN.charQueue[i]).type==Za.MONSTER_TRANSPORT){var n=e.data;if(!n)continue;var s=hn.getIndex(parseInt(n.modelId)),o=hn.MODEL.muId(s),a=_n.getIndex(o),r=_n.MODEL.avatarId(a),l=_n.MODEL.awayEffect(a);e.setCharNameVisible(!0);var c=t[xN.Ins().getMissionIdByBossId(parseInt(n.modelId))];if(e.setCharBoolVisible(!0),e.charNameColor="#e6d80d",0<c.rebrithTime){e.isDeath=!0,e.setOnlyHpBarVisible(!1),ZN.updateCharDisplay(e,"ms228"),e.setDir(5),c.rebrithTime-=1e3;var u=1+c.rebrithTime/1e3;u=0<=u?u:0,e.setCharRelieveDesc(RP.n[1e3]+Jp.getTickMS(u)),e.removeEffect("eid_"+l)}else{e.setDir(4),e.isDeath=!1,ZN.updateCharDisplay(e,r);var d=xN.Ins().getMaxHpByModelId(parseInt(n.modelId));e.setCharBoolValue(c.bossHp,d),e.setCharRelieveDesc(""),e.hasEffect("eid_"+l)||e.loadEffect(l,Za.LAYER_BODY_BOTTOM)}}},p(0,i,"name",function(){return null}),t.NAME="NavMiniMap",t}(),HZ=function(e){function r(){var e=this;e._time=NaN,e._pointArr=[[new Uh(170,110)],[new Uh(95,110),new Uh(250,110)],[new Uh(60,110),new Uh(170,110),new Uh(280,110)]],e._showArr=null,e._flyArr=null,e._show=!1,e._iconArr=null,e._unAutoArr=null,e._currentArrowIcon=null,e._clickeImgTime=0,r.__super.call(e),e.txt_countDown.text="",e.img_bg.visible=!1,e.img_title.visible=!1,r.intervalTime=parseInt($e.MODEL.value($e.getIndex(202))),e._iconArr=[],e.initIcon()}b(r,"modules.nav.views.sub.NavZhuiJi",zd);var t=r.prototype;return G.imps(t,{"modules.nav.others.INav":!0}),t.initIcon=function(){for(var e,t=0;t<3;t++)(e=new xW(t+1)).size(60,60),this._iconArr.push(e)},t.notice=function(e){switch(e.actionOrder){case"CHANGE_MAP":this.hide();break;case"USE_HEJI_BACK":this.showView();case"CHAR_DEAD":if(this.parent&&e&&e.proto){var t,i=e.proto.job;(t=this.getIocnByProfression(i))&&t.playClickEff(!1)}}},t.getIndexByJob=function(e){for(var t=0;t<gR.ins.actorList.length;t++){if(gR.ins.actorList[t].job==e)return t}return-1},t.show=function(){this.showView()},t.showView=function(){gR.ins.getZhuiJiNum(),ER.ins.autoZhuiJiStr;this._unAutoArr=[],this._unAutoArr=gR.ins.zhuijiSkill.slice(),this.img_bg.visible=!1,this.img_title.visible=!1,sJ.ins.hideCompoment("NavLimitZhuiJi");var e=_r.getFullUrl("ui/images/zhuiji/fs_text_djs.png");G.loader.getRes(e)?this.initView():G.loader.load(e,ql.create(this,this.initView))},t.initView=function(){LY.Ins().isShow()&&LY.Ins().closeLockArrow(29),this._showArr=[],this.playFlyEffect(),this.img_title.skin=_r.getFullUrl("ui/images/zhuiji/fs_text_djs.png"),this.initPoint(),this._time=5040,this._show=!1},t.initPoint=function(){var e=this;0==e._showArr.length&&G.timer.once(100,sJ.ins,sJ.ins.hideCompoment,[e.name]);for(var t,i,n,s=e._pointArr[e._showArr.length-1],o=0;o<e._showArr.length;o++){t=e.getIocnByProfression(e._showArr[o]),i=s[o],t.pos(i.x,i.y),e.addChild(t),t.visible=!1;var a=e._flyArr[o];(n=kB.createEffect(r._flyEffArr[e._showArr[o]-1],a.x,a.y,e)).isAutoDispose=!0,Og.to(n,{x:t.x+30,y:t.y+30},300,pa.circInOut,ql.create(e,e.onFlyEffEnd,[n,t]))}},t.onFlyEffEnd=function(e,t){t&&t.parent&&(t.visible=!0),0==this._show&&(this._show=!0,G.timer.loop(10,this,this.updateTime),this.img_bg.visible=!0,this.img_title.visible=!0,this.showArrow()),this.doShowGuide();var i=gR.ins.getIndexByJob(t.profession),n=ER.ins.autoZhuiJiStr.indexOf((i+1).toString());if(ER.ins.isAutoZhuiJi&&-1<n){var s=(n+1)*r.intervalTime;G.timer.once(s,t,t.playClickEff,[!1],!1)}e&&(e.destroy(),e=null)},t.playFlyEffect=function(){this._flyArr=[];for(var e=0;e<gR.ins.zhuijiSkill.length;e++)if(0!=this._unAutoArr[e]&&0<gR.ins.actorByJob(e+1).currHP){var t=sJ.ins.getCompomentsByName("Navheji"),i=t["img_zhuiji_"+(e+1)],n=t.localToGlobal(new Uh(i.x,i.y));this._showArr.push(e+1);this.globalToLocal(new Uh(n.x,n.y));this._flyArr.push(n)}},t.updateTime=function(){var e,t=this;if(t._time-=10,t.txt_countDown.changeText((t._time/1e3).toFixed(2)),t._time<=0){for(i in G.timer.clearAll(t),t._iconArr)(e=t._iconArr[i])&&e.parent&&e.playClickEff(!1);G.timer.once(1200,sJ.ins,sJ.ins.hideCompoment,[t.name])}else{var i;for(i in t._clickeImgTime=0,t._iconArr)(e=t._iconArr[i])&&null==e.parent&&t._clickeImgTime++;3==t._clickeImgTime&&(G.timer.clearAll(t),G.timer.once(600,sJ.ins,sJ.ins.hideCompoment,[t.name]))}},t.hide=function(){this.clearList(),this.txt_countDown.changeText(""),0<gR.ins.limitZhuiJiSkillID&&sJ.ins.showCompoment("NavLimitZhuiJi")},t.clearIcon=function(){var e;for(var t in this._iconArr)(e=this._iconArr[t])&&e.parent&&e.removeSelf()},t.clearList=function(){G.timer.clearAll(this),this.clearIcon()},t.getIocnByProfression=function(e){var t;for(var i in this._iconArr)if((t=this._iconArr[i]).name==e.toString())return t;return null},t.doShowGuide=function(){var e=PH.Ins().info;if(e&&0<e.getCurrentGuide(35)&&!LY.Ins().isShow()){var t=new u_,i=gR.ins.actorList[0].job,n=this.getIocnByProfression(i);t.x=n.x+3,t.y=n.y-7,t.width=n.width,t.height=n.height,LY.Ins().show(35,t,!1,this)}},t.showArrow=function(){var e=ER.ins.autoZhuiJiStr.length;if(!ER.ins.isAutoZhuiJi||e<gR.ins.getZhuiJiNum())for(var t,i=0;i<this._iconArr.length;i++)if((t=this._iconArr[i]).visible){this._currentArrowIcon=t,LY.Ins().showforDir(0,RP.n[1001],t,!1,!1);break}},p(0,t,"name",function(){return"NavZhuiJi"}),r.NAME="NavZhuiJi",r.intervalTime=0,f(r,["_flyEffArr",function(){return this._flyEffArr=["jm1362","jm1363","jm1364"]}]),r}(),VZ=function(e){function t(){t.__super.call(this),this.list.itemRender=hY,this.list.dataSource=[],this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100}b(t,"modules.newsiege.views.NewSiegeGuildInfoView",ih);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),DN.instance.reqGuildInfo(),this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showGuildInfo=function(){this.list.dataSource=DN.instance.playerList,this.list.refresh(),this.g_mask.visible=5<DN.instance.playerList.length},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),GZ=function(e){function t(){var e=this;e.sp_reddot=null,e._cdT=0,e.siegeData=null,t.__super.call(e),e.siegeData=DN.instance,e.sp_reddot=new pp,e.addChild(e.sp_reddot),e.on("click",e,e.onAward)}b(t,"modules.newsiege.views.NewSiegeAwardsView",Xd);var i=t.prototype;return i.updateScore=function(e){var t=this;if(void 0===e&&(e=!1),0!=t.siegeData.addScore&&e){var i=[{text:"获得：",color:""},{text:"积分"},{text:"x"+t.siegeData.addScore,color:"#23b11f"}];zB.ins.showMsg(i,2,!1)}var n=t.getCurrAward(),s=wi.MODEL.param(n)[0],o="";o=t.siegeData.myScore>=s?"#23b11f":"#ff2e24",t.txt_score.innerHTML=Ql.createColor(t.siegeData.myScore+"",o)+"/"+s;var a=0|wi.MODEL.goodsRewardStr(n).split(",")[0];Bi.getIndex(a);if(t.siegeData.myScore>=s&&-1==t.siegeData.awardList.indexOf(wi.MODEL.key(n))){t.sp_reddot.graphics.clear();var r=G.loader.getRes(NI.POINT);t.sp_reddot.graphics.drawTexture(r,t.width-(r.width+13),-4,r.width,r.height)}else t.sp_reddot.graphics.clear();t.visible=t.siegeData.awardList.length<t.siegeData.getAwards("Score").length},i.getCurrAward=function(){var e,t=this.siegeData.getAwards("Score");for(var i in t)if(e=t[i],-1==this.siegeData.awardList.indexOf(wi.MODEL.key(e)))return e;return t[t.length-1]},i.onAward=function(e){if(!(BB.getTimer()-this._cdT<500)){this._cdT=BB.getTimer();var t=this.getCurrAward(),i=wi.MODEL.key(t),n=wi.MODEL.param(t)[0];-1==this.siegeData.awardList.indexOf(i)&&this.siegeData.myScore>=n?(this.siegeData.reqGetAwardsInfo(i),this.siegeData.isclickGet=!0):zB.ins.showMsg(RP.n[1002],1)}},t}(),UZ=function(e){function t(){this.cdTime=5,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.newsiege.views.NewSiegeMoveView",eh);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=xi.getIndex(DN.instance.enterSceneId);this.cdTime=xi.MODEL.castTime(t),this.txt_cd.changeText(this.cdTime+RP.n[1003]+DN.instance.sceneName),this.starChangeScene()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.onMove)},i.starChangeScene=function(){this.timerLoop(1e3,this,this.onMove)},i.onMove=function(){if(this.cdTime--,this.txt_cd.changeText(this.cdTime+RP.n[1003]+DN.instance.sceneName),this.cdTime<0){this.clearTimer(this,this.onMove),null!=BR.ins.toc24033&&(BR.ins.toc24033.list=[]),hN.ins._closePanel(this);var e=rn.MODEL.cId(rn.getIndex(DN.instance.enterSceneId));DN.instance.reqEntry(e)}},t}(),FZ=function(e){function t(){this._time=15,this.eff=null,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.newsiege.views.NewSiegeGuildResultView",nh);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_time.changeText(""),this.txt_guildName.align="center",this.btn_get.on("click",this,this.onClose)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_get.off("click",t,t.onClose),t._time=0,G.timer.clear(t,t.onTime),t.eff&&(t.eff.parent&&t.eff.parent.removeChild(t.eff),t.eff.dispose(),t.eff=null),t.onClose(null)},i.update=function(e){var t=this;t.box_person.visible=10<e.playerRank,t.box_guild.visible=5<e.guildRank,t.eff||(t.eff=kB.createEffect("jm1106",360,365,t)),t._time=15,G.timer.loop(1e3,t,t.onTime);var i,n="",s="",o=[],a=0,r=0;if(t.txt_pJifen.text=e.playerScore+"",t.txt_pRank.text="第"+e.playerRank+"名",t.txt_guildName.innerHTML=RP.n[1005]+e.guildName,""!=(n=DN.instance.getAwardsByRank(e.playerRank,1)))for(o=n.split(";"),a=0;a<o.length;a++)s=o[a],r=parseInt(s.split(",")[0]),(i=new pq)._nameVisible=!0,i._simpleName=!0,i._textLayer=5,i.size(93,93),i._nameY=96,i.pos(126*a,15),i.bindData=yB.create(r,parseInt(s.split(",")[1])),t.panel_awards_self.addChild(i);if(t.txt_gJifen.text=e.guildScore.toString(),t.txt_gRank.text="第"+e.guildRank.toString()+"名",""!=(n=DN.instance.getAwardsByRank(e.guildRank,2)))for(o=n.split(";"),a=0;a<o.length;a++)s=o[a],r=parseInt(s.split(",")[0]),(i=new pq)._nameVisible=!0,i._simpleName=!0,i._textLayer=5,i.size(93,93),i._nameY=96,i.pos(126*a,15),i.bindData=yB.create(r,parseInt(s.split(",")[1])),t.panel_awards_guild.addChild(i)},i.onTime=function(){this._time--,0<this._time?this.btn_time.changeText(this._time+"s"):(G.timer.clear(this,this.onTime),this.onClose(null))},i.onClose=function(e){G.timer.clear(this,this.onTime),hN.ins._closePanel(this),this.panel_awards_self.removeChildren(0),this.panel_awards_guild.removeChildren(0),DN.instance.clear(),BR.ins.exitCopy(500)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.imgHeadbg&&t.imgLeftbg&&t.imgRightbg&&t.imgHeadbg.skin&&t.imgLeftbg.skin&&t.imgRightbg.skin&&(G.loader.clearRes(t.imgRightbg.skin),G.loader.clearRes(t.imgLeftbg.skin),G.loader.clearRes(t.imgHeadbg.skin)),laya.ui.View.prototype.destroy.call(t,e)},t}(),qZ=function(t){function e(){this.select_role_index=-1,this.select_job=0,this.curTaskVo=null,this.taskStatus=-1,this.roleArr=null,this.roleimageArr=null,this._linkStr=null,this.taskEff=null,e.__super.call(this)}b(e,"modules.niepan.views.NiepanChallengeView",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.img_zhan.visible=!1,e.img_fa.visible=!1,e.img_dao.visible=!1,e.roleArr=[e.btn_zhan,e.btn_fa,e.btn_dao],e.roleimageArr=[e.img_zhan,e.img_fa,e.img_dao]},i.init=function(){this.updateTask()},i.updateByVSC=function(e){"UDPDATE_TASK"==e.actionOrder?this.updateTask():"31051"==e.actionOrder&&this.updateView()},i.updateView=function(){var e=ON.ins.data31051;e?(this.setRoleStatus(e.curRoleIndex),this.updateTask()):this.img_zhan.visible=!0},i.updateTask=function(){var e=this;e.removeEff();var t=ON.ins.getNowStatus();if(e.btn_task.visible=!1,e.btn_accept.showTip=!1,e.text_task.innerHTML="",e.img_tan.visible=!1,1==t){if(e.curTaskVo=lB.instance().getProGressDicTaskByType(4),e.curTaskVo){var i=n_.getIndex(e.curTaskVo.questId),n=n_.MODEL.descr(i),s=n_.MODEL.value(i);e._linkStr=n_.MODEL.link(i);var o=[];n&&(o=n.split(",")),1<o.length?(e.img_tan.visible=!0,e.text_task.innerHTML=zB.ins.getDesc(o[e.select_role_index])+"("+e.curTaskVo.targetList[0].currentValue+"/"+s+")"):(e.img_tan.visible=!0,e.text_task.innerHTML=zB.ins.getDesc(parseInt(o[0]))+"("+e.curTaskVo.targetList[0].currentValue+"/"+s+")"),e.curTaskVo.phase==Bp.ON_PROCESS?(e.btn_accept.label=RP.n[1006],e.setEff()):e.curTaskVo.phase==Bp.CAN_COMMIT?e.btn_accept.label=RP.n[1007]:e.curTaskVo.phase==Bp.FINISHED&&(e.btn_accept.label=RP.n[1008],e.btn_accept.showTip=!0),e.taskStatus=e.curTaskVo.phase,e.btn_task.visible=!0}}else 3==t?e.btn_accept.label=RP.n[1009]:2==t?e.btn_accept.label=RP.n[1010]:ON.ins.checkMaxByIndex(e.select_role_index+1)?(e.text_task.innerHTML="",e.img_tan.visible=!1,e.btn_accept.label=RP.n[1011],e.btn_accept.disabled=!0):(e.btn_accept.label=RP.n[1012],e.text_task.innerHTML=RP.n[1013],e.img_tan.visible=!0,gR.ins.actorById(e.select_role_index+1)?e.btn_accept.showTip=!0:e.btn_accept.showTip=!1)},i.setRoleStatus=function(e){var t=this;0<e?(t.btn_zhan.gray=!0,t.btn_fa.gray=!0,t.btn_dao.gray=!0,t.img_zhan.visible=!1,t.img_fa.visible=!1,t.img_dao.visible=!1,t.roleArr[gR.ins.getJobByIdx(e)-1]&&(t.roleArr[gR.ins.getJobByIdx(e)-1].gray=!1,t.roleimageArr[gR.ins.getJobByIdx(e)-1].visible=!0),t.select_role_index=gR.ins.getIndexByJob(gR.ins.getJobByIdx(e)),t.updateNameIcon(gR.ins.getJobByIdx(e))):(t.select_role_index=gR.ins.getIndexByJob(1),t.img_zhan.visible=!0,t.updateNameIcon(1))},i.updateNameIcon=function(e){var t=ON.ins.getIconName(this.select_role_index,e);this.niepantitle.skin=_r.getFullUrl("ui/layouts/niepan/"+t+".png",!1);var i=to.MODEL.des(to.getIndex(ON.ins.getLevelByIndex(this.select_role_index)));if(i){var n=i.split(",");this.niepan_des.innerHTML=zB.ins.getDesc(n[e-1])}},i.destoryImage=function(e){ui.ViewBase.prototype.destoryImage.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_accept.on("click",t,t.onClick),t.btn_zhan.on("click",t,t.onClick),t.btn_fa.on("click",t,t.onClick),t.btn_dao.on("click",t,t.onClick),t.btn_task.on("click",t,t.onClick),t.init()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.curTaskVo=null,t.taskStatus=-1,t.removeEff(),t.btn_accept.off("click",t,t.onClick),t.btn_zhan.off("click",t,t.onClick),t.btn_fa.off("click",t,t.onClick),t.btn_dao.off("click",t,t.onClick),t.btn_task.off("click",t,t.onClick)},i.onClick=function(e){var t=this,i=ON.ins.getNowStatus();if(e.target==t.btn_zhan){if(1==t.btn_zhan.gray)return void(1==i?zB.ins.showById(4955,1):zB.ins.showById(4804,1));t.img_dao.visible=!1,t.img_fa.visible=!1,t.img_zhan.visible=!0,t.select_role_index=gR.ins.getIndexByJob(1),t.select_job=0,t.updateNameIcon(1),t.statusHandler()}else if(e.target==t.btn_fa){if(1==t.btn_fa.gray)return void(1==i?zB.ins.showById(4955,1):zB.ins.showById(4804,1));t.img_dao.visible=!1,t.img_zhan.visible=!1,t.img_fa.visible=!0,t.select_role_index=gR.ins.getIndexByJob(2),t.select_job=1,t.updateNameIcon(2),t.statusHandler()}else if(e.target==t.btn_dao){if(1==t.btn_dao.gray)return void(1==i?zB.ins.showById(4955,1):zB.ins.showById(4804,1));t.img_zhan.visible=!1,t.img_fa.visible=!1,t.img_dao.visible=!0,t.select_role_index=gR.ins.getIndexByJob(3),t.select_job=2,t.updateNameIcon(3),t.statusHandler()}else e.target==t.btn_accept?1==i?0<=t.select_role_index&&t.curTaskVo&&(t.taskStatus==Bp.FINISHED?Tu.sendToModule("NIEPANTASK",["modules.scene.SceneModule"]):t.taskStatus==Bp.ON_PROCESS&&t._linkStr&&(cB.taskLinkHandler(t._linkStr),hN.ins.close("NIEPAN_MAIN_VIEW"))):2==i||3==i?Tu.sendToModule("OPEN_NIEPAN_WUXING",["modules.niepan.NiepanModule"]):0==i&&(t.curTaskVo||(ON.ins.checkMaxByIndex(t.select_role_index+1)?zB.ins.showMsg(RP.n[1014],1):gR.ins.actorById(t.select_role_index+1)?KQ.ins.show(zB.ins.getDesc(4803),ql.create(t,t.alertConfirm,[t.select_job,t.select_role_index+1])):Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]))):e.target==t.btn_task&&hN.ins.open("NIEPAN_TASK_VIEW")},i.statusHandler=function(){var e=this;ON.ins.checkMaxByIndex(e.select_role_index+1)?(e.text_task.innerHTML="",e.img_tan.visible=!1,e.btn_accept.label=RP.n[1011],e.btn_accept.disabled=!0,e.btn_accept.showTip=!1):0==ON.ins.getNowStatus()&&(e.btn_accept.label=RP.n[1012],gR.ins.actorById(e.select_role_index+1)?e.btn_accept.showTip=!0:e.btn_accept.showTip=!1,e.text_task.innerHTML=RP.n[1013],e.img_tan.visible=!0,e.btn_accept.disabled=!1)},i.alertConfirm=function(e,t,i){1==i&&sN.requestGetTask(this.getTask(e),t)},i.getTask=function(e){var t=ON.ins.data31051;if(t){var i=t.curRoleIndex,n=1;0<i&&(n=t.roleData[i]+1);var s=to.MODEL.startQuest(to.getIndex(n)).split(",");return parseInt(s[e])}return 0},i.setEff=function(){this.taskEff=mj.GetNew(),this.taskEff.renderInSelf=!0,this.taskEff.pos(this.btn_task.x+50,this.btn_task.y+50),this.taskEff.loadEffect("jm1160"),this.boxb.addChild(this.taskEff)},i.removeEff=function(){this.taskEff&&(this.taskEff.removeSelf(),this.taskEff.dispose(),this.taskEff=null)},e}(fh),jZ=function(e){function t(){var e=this;e.textArr=null,e.index=0,e.rewardGrid=null,e.award=0,e.awardNum=0,e.taskEff=null,e.txtArr=null,e.labArr=null,e.biaoarr=null,e.gettingWard=0,t.__super.call(e)}b(t,"modules.niepan.views.NiepanDailyView",lh);var i=t.prototype;return i.initView=function(){this.txtArr=[],this.labArr=[],this.biaoarr=[],this.updateView()},i.updateView=function(){var e=this,t=ON.ins.data31051;if(t){if((e.index=0)<t.curRoleIndex){var i=t.roleData[t.curRoleIndex]+1,n=to.MODEL.rewardDef(to.getIndex(i)),s=JSON.parse(n);e.award=parseInt(s[0].value.split(":")[0]),e.awardNum=parseInt(s[0].value.split(":")[1]);var o=to.MODEL.dailyQuest(to.getIndex(i)).split(",");e.textArr=[];var a,r,l=lB.instance().getProGressGroupTaskByType(5),c=lB.instance().gettodayCompListGroupTaskByType(5),u=0,d=[],h=0;if(l&&0<l.length)for(u=0;u<l.length;u++){var _=l[u];o.indexOf(_.questId+"")<0||(r=n_.MODEL.descr(n_.getIndex(_.questId)),h=n_.MODEL.value(n_.getIndex(_.questId)),d=[],r&&(d=r.split(",")),e.getText().innerHTML=zB.ins.getDesc(parseInt(d[0]))+"&nbsp;"+Ql.createColor(_.targetList[0].currentValue+"","#ff2e24")+"/"+h+"次",(a=e.getLineText()).name=_.questId+"",a.on("click",e,e.onClick),e.getBiao())}var f=0;if(c&&0<c.length)for(u=0;u<c.length;u++){var p=c[u];0<p.count&&0<=o.indexOf(p.questId+"")&&(f++,r=n_.MODEL.descr(n_.getIndex(p.questId)),h=n_.MODEL.value(n_.getIndex(p.questId)),d=[],r&&(d=r.split(",")),e.getText().innerHTML=zB.ins.getDesc(parseInt(d[0]))+"&nbsp;"+Ql.createColor(h+"","#23b11f")+"/"+h+"次",(a=e.getLineText(!1)).name=p.questId+"",a.off("click",e,e.onClick),a.changeText("已完成"),a.color="#5f5952",a.repaint(),e.getBiao())}e.bless_bar.scaleX=f/o.length}if(0<e.award){e.rewardGrid=new MF(116),e.rewardGrid.scaleX=e.rewardGrid.scaleY=.64,e.rewardGrid.toolTipEnabled=!1,e.rewardGrid.pos(e.btn_buy.x,e.btn_buy.y);var g=yB.create(e.award,e.awardNum);e.rewardGrid.bindData=g,e.addChild(e.rewardGrid),e.rewardGrid.on("click",e,e.onCloseddd2)}if(t.dailyAward||f<o.length){if(e.gettingWard&&t.dailyAward){var v=e.localToGlobal(new Uh(e.btn_buy.x+e.btn_buy.width/2,e.btn_buy.y+e.btn_buy.width/2));zB.ins.playGetItemsByPos([e.award],v)}e.removeEff()}else e.taskEff=mj.GetNew(),e.taskEff.renderInSelf=!0,e.taskEff.pos(e.btn_buy.x+38,e.btn_buy.y+38),e.taskEff.loadEffect("jm1145"),e.taskEff.scale_X=e.taskEff.scale_Y=.64,e.addChild(e.taskEff)}e.gettingWard=0},i.onCloseddd=function(e){if(e.target==this.btn_close)hN.ins.close("NIEPAN_DAILY_VIEW");else if(e.target==this.rewardGrid){var t=new gP;Tu.sendToService(t)}},i.onCloseddd2=function(e){if(1==this.bless_bar.scaleX){this.gettingWard=1;var t=new gP;Tu.sendToService(t)}else zB.ins.showById(4889,1)},i.onClick=function(e){var t=e.target;if(t){var i=n_.getIndex(parseInt(t.name)),n=n_.MODEL.link(i);n&&(cB.taskLinkHandler(n),hN.ins.close("NIEPAN_DAILY_VIEW"),hN.ins.close("NIEPAN_MAIN_VIEW"))}},i.getText=function(){if(this.txtArr[this.index])return this.txtArr[this.index];var e=kB.createHtmlDiv(90,120+45*this.index,24,"#90877b",465,28,this);return this.txtArr.push(e),e},i.getLineText=function(e){var t=this;void 0===e&&(e=!0),t.labArr[t.index]&&(t.removeChild(t.labArr[t.index]),t.labArr[t.index]=null);var i=kB.createLabel(440,45*t.index+120,116,28,t,RP.n[1018]);return i.font="SimHei",i.fontSize=24,i.align="center",i.color="#23b22f",i.underline=e,t.labArr[t.index]=i},i.getBiao=function(){if(this.biaoarr[this.index])return this.biaoarr[this.index];var e=new Kl;return e.pos(50,120+45*this.index),e.skin=_r.getFullUrl("ui/layouts/base_ui2/tips_zs.png",!1),this.addChild(e),this.index++,e},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onCloseddd),this.initView()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onCloseddd),this.rewardGrid.off("click",this,this.onCloseddd2)},i.removeEff=function(){this.taskEff&&(this.taskEff&&this.taskEff.dispose(),this.taskEff=null)},t}(),WZ=function(e){function t(){var e=this;e.seff1521="jm1521",e.seff1522="jm1522",e.seff1523="jm1523",e.seff1532="jm1532",e.eff1521=null,e.eff1522=null,e.eff1523=null,e.effectArr=null,e._mask=null,e.sp=null,e.countfire=0,e.intervalTime=20,t.__super.call(e),e.top=e.right=e.left=e.bottom=0}b(t,"modules.niepan.views.NiepanEffect",ch);var i=t.prototype;return i.notice=function(e){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),G.timer.once(200,this,this.startEffect)},i.startEffect=function(){var e=this;e._mask||(e._mask=new Ss,e._mask.graphics.drawRect(-1e3,0,3e3,e.stage.height,"#000000",null),e._mask.mouseEnabled=!0,e._mask.mouseThrough=!0),e._mask.alpha=.5,e.addChild(e._mask),e.effectArr=[];for(var t=0;t<6;t++){var i=mj.GetNew();i.renderInSelf=!0,i.x=150*t,i.y=e.stage.height-50,i.loadEffect(e.seff1522),e.addChild(i),e.effectArr.push(i)}G.timer.once(500,e,e.effHandler),e.sp=new pp,e.sp.pos(360,e.stage.height),e.addChild(e.sp),e.eff1523=mj.GetNew(),e.eff1523.renderInSelf=!0,e.eff1523.loadEffect(e.seff1523),e.sp.addChild(e.eff1523),Og.to(e.sp,{y:e.stage.height-640},300,pa.linearIn)},i.effHandler=function(){var e=this;e.eff1521=mj.GetNew(),e.eff1521.renderInSelf=!0,e.eff1521.pos(360,560),e.eff1521.loadEffect(e.seff1521),e.eff1521.playEndHandler=ql.create(e,e.effHandler2),e.addChild(e.eff1521)},i.effHandler2=function(){var e=this;e.eff1521&&(e.eff1521.parent.removeChild(e.eff1521),e.eff1521.dispose(),e.eff1521=null),e.eff1521=mj.GetNew(),e.eff1521.renderInSelf=!0,e.eff1521.pos(360,560),e.eff1521.loadEffect(e.seff1532),G.timer.once(700,e,e.hideMask),e.addChild(e.eff1521)},i.hideMask=function(){for(var e=this,t=0;t<6;t++)e.effectArr[t]&&(e.effectArr[t].parent.removeChild(e.effectArr[t]),e.effectArr[t].dispose(),e.effectArr[t]=null);e.effectArr.length=0,e.eff1521&&(e.eff1521.parent.removeChild(e.eff1521),e.eff1521.dispose(),e.eff1521=null),e._mask&&Og.to(e._mask,{alpha:0},100,pa.linearIn,ql.create(e,e.playFireworkEffect))},i.playFireworkEffect=function(){for(var e=80,t=this.countfire=0;t<6;t++)G.timer.once(e,this,this.playFirework,null,!1),e=20+Math.ceil(180*Math.random())},i.playFirework=function(){var e;(e=mj.GetNew()).renderInSelf=!0,e.loadEffect("jm1314"),e.playEndHandler=ql.create(this,this.effEnd,[e]),e.setXY(150+Math.ceil(400*Math.random()),300+Math.ceil(400*Math.random())),this.addChild(e)},i.effEnd=function(e){e.parent.removeChild(e),e.dispose(),e=null},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.eff1521&&(t.eff1521.removeSelf(),t.eff1521.dispose(),t.eff1521=null),t.eff1522&&(t.eff1522.removeSelf(),t.eff1522.dispose(),t.eff1522=null),t.eff1523&&(t.eff1523.removeSelf(),t.eff1523.dispose(),t.eff1523=null),G.timer.clearAll(t)},t.NAME="NiepanEffect",t}(),YZ=function(e){function t(){this.taskId=0,t.__super.call(this),this.butt.scaleX=this.butt.scaleY=.8}return b(t,"modules.niepan.views.NiepanPointItem",dh),t.prototype.updateStatus=function(e,t){e&&(this.butt.selected=!0),this.txt.innerHTML="试炼"+mp.WORDS[t+1]},t}(),zZ=function(e){function t(){this.itemArr=null,t.__super.call(this)}b(t,"modules.niepan.views.NiepanTaskView",hh);var i=t.prototype;return i.updateView=function(){var e=ON.ins.data31051;if(e&&0<e.curRoleIndex){var t=e.roleData[e.curRoleIndex]+1,i=to.MODEL.startQuest(to.getIndex(t)).split(","),n=to.MODEL.endQuest(to.getIndex(t)).split(","),s=parseInt(i[gR.ins.getJobByIdx(e.curRoleIndex)-1]),o=to.MODEL.name(to.getIndex(t)).split(","),a=parseInt(n[gR.ins.getJobByIdx(e.curRoleIndex)-1]),r=lB.instance().getProGressDicTaskByType(4),l=0,c=0,u=0;if(r){var d=(l=r.questId-s)/((c=a-s+1)-1);d<=0&&(d=0),this.bless_bar.scaleX=d,u=this.bless_bar.width/(c-1);for(var h=0;h<c;h++){var _=new YZ;_.taskId=s+h,_.on("click",this,this.taskOnClick,[_.taskId]),_.pos(42+h*u,313),h<l?_.updateStatus(0,h):_.updateStatus(1,h),this.addChild(_),this.itemArr.push(_)}}var f=n_.MODEL.desTwo(n_.getIndex(r.questId));this.txt_task_des.innerHTML=zB.ins.getDesc(f),this.text_title.innerHTML=o[gR.ins.getJobByIdx(e.curRoleIndex)-1]}},i.taskOnClick=function(e){var t=n_.MODEL.desTwo(n_.getIndex(e));this.txt_task_des.innerHTML=zB.ins.getDesc(t)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClose),this.btn_buy.on("click",this,this.onClose),this.itemArr=[],this.updateView()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClose),t.btn_buy.off("click",t,t.onClose);for(var i=0;i<t.itemArr.length;i++)t.itemArr[i]&&(t.itemArr[i].off("click",t,t.taskOnClick),t.itemArr[i]=null);t.itemArr.length=0,t.itemArr=null},i.onClose=function(e){e.target!=this.btn_close&&e.target!=this.btn_buy||hN.ins.close("NIEPAN_TASK_VIEW")},t}(),XZ=function(i){function t(){var e=this;e.select_role_index=-1,e.curLevel=0,e.g_cost=null,e.costId=0,e.costNum=0,e.wuxingMax=0,e.copyid=0,e.isEnought=0,e.isFull=0,e.isAuto=0,e.roleArr=null,e.roleimageArr=null,e.viewData=null,e.refreshviewData=null,e.mask_mc0=null,e.mask_mc1=null,e.mask_mc2=null,e.mask_mc3=null,e.mask_mc4=null,e.maskMid_mc=null,e.taskEff=null,e.qiuEff0=null,e.qiuEff1=null,e.qiuEff2=null,e.qiuEff3=null,e.qiuEff4=null,e.qiuwenEff0=null,e.qiuwenEff1=null,e.qiuwenEff2=null,e.qiuwenEff3=null,e.qiuwenEff4=null,e.qiuMidEff=null,e.qiuMidEFF=null,e.qiuMidFireEFF=null,e.qiuMidWenEFF=null,e.qiuBaoEFF=null,e.qiuflyEFF=null,e.attName=null,e.effArr=null,e.effwenArr=null,e.moveDis=0,e.flySp=null,e.flyNum=0,t.__super.call(e)}b(t,"modules.niepan.views.NiepanWuxingView",i);var e=t.prototype;return e.createChildren=function(){var e=this;i.prototype.createChildren.call(e),e.img_zhan.visible=!1,e.img_fa.visible=!1,e.img_dao.visible=!1,e.roleArr=[e.btn_zhan,e.btn_fa,e.btn_dao],e.roleimageArr=[e.img_zhan,e.img_fa,e.img_dao],e.attName=["攻击力","生命值","生命值","攻击力","双防"],e.effArr=["jm1520","jm1533","jm1534","jm1535","jm1536"],e.effwenArr=["jm1527","jm1528","jm1529","jm1530","jm1531"],e.btn_chong.label=RP.n[1019];for(var t=0;t<5;t++)e["qiuEff"+t]=mj.GetNew(),e["qiuEff"+t].pos(e["blessball"+t].width/2,e["blessball"+t].width/2),e["qiuEff"+t].renderInSelf=!0,e["qiuEff"+t].loadEffect(e.effArr[t]),e["blessball"+t].addChild(e["qiuEff"+t]),e["qiuwenEff"+t]=mj.GetNew(),e["qiuwenEff"+t].pos(e["blessball"+t].width/2,e["blessball"+t].width),e["qiuwenEff"+t].renderInSelf=!0,e["qiuwenEff"+t].loadEffect(e.effwenArr[t]),e["blessball"+t].addChild(e["qiuwenEff"+t]),e["mask_mc"+t]=new pp,e["mask_mc"+t].graphics.drawRect(0,0,e["blessball"+t].width,e["blessball"+t].height,"#000000"),e["mask_mc"+t].pos(0,e["blessball"+t].height),e["blessball"+t].mask=e["mask_mc"+t];for(e.qiuMidEFF=mj.GetNew(),e.qiuMidEFF.pos(e.blessballmid.width/2,e.blessballmid.width/2),e.qiuMidEFF.renderInSelf=!0,e.qiuMidEFF.loadEffect("jm1526"),e.blessballmid.addChild(e.qiuMidEFF),e.qiuMidWenEFF=mj.GetNew(),e.qiuMidWenEFF.pos(e.blessballmid.width/2,0),e.qiuMidWenEFF.renderInSelf=!0,e.qiuMidWenEFF.loadEffect("jm1524"),e.blessballmid.addChild(e.qiuMidWenEFF),e.qiuMidWenEFF.scale_X=0,e.maskMid_mc=new pp,e.maskMid_mc.graphics.drawRect(0,0,e.blessballmid.width,e.blessballmid.height,"#000000"),e.maskMid_mc.pos(0,0),e.blessballmid.mask=e.maskMid_mc,e.qiuMidFireEFF=mj.GetNew(),e.qiuMidFireEFF.pos(e.blessballmid.x+e.blessballmid.width/2,e.blessballmid.y),e.qiuMidFireEFF.renderInSelf=!0,e.qiuMidFireEFF.loadEffect("jm1519"),e.boxt.addChild(e.qiuMidFireEFF),e.flySp=new pp,e.flySp.pos(e.blessballmid.x+e.blessballmid.width/2,e.blessballmid.y+e.blessballmid.width/2),e.boxt.addChild(e.flySp),t=0;t<5;t++)e["att_"+t].innerHTML=Ql.createColor(e.attName[t]+"+0","#23b11f")},e.init=function(){var e=this;if(e.isEnought=0,e.viewData=ON.ins.data31051,e.viewData){e.select_role_index=e.viewData.curRoleIndex,e.setRoleStatus(e.viewData.curRoleIndex),e.curLevel=e.viewData.roleData[e.select_role_index]+1,e.wuxingMax=to.MODEL.eleNum(to.getIndex(e.curLevel));var t=to.MODEL.consumptionDef(to.getIndex(e.curLevel)),i=JSON.parse(t);e.costId=parseInt(i[0].value.split(":")[0]),e.costNum=parseInt(i[0].value.split(":")[1]),e.g_cost=new MF(45),e.g_cost.needGridBg=!1,e.g_cost.pos(e.text_cost.x-50,e.text_cost.y-10),e.boxb.addChild(e.g_cost);var n=yB.create(e.costId);e.g_cost.bindData=n,e.updateCost(),e.updateView()}e.setEff()},e.setRoleStatus=function(e){0<e&&(this.btn_zhan.gray=!0,this.btn_fa.gray=!0,this.btn_dao.gray=!0,this.img_zhan.visible=!1,this.img_fa.visible=!1,this.img_dao.visible=!1,this.roleArr[gR.ins.getJobByIdx(e)-1]&&(this.roleArr[gR.ins.getJobByIdx(e)-1].gray=!1,this.roleimageArr[gR.ins.getJobByIdx(e)-1].visible=!0))},e.updateCost=function(){var e=this;if(0<e.costId){var t=TR.ins.getGoodsNum(e.costId);t>=e.costNum?(e.isEnought=1,e.btn_chong.showTip=!0,e.text_cost.innerHTML=Ql.createColor(t+"","#23b11f")+"/"+e.costNum):(e.isEnought=0,e.btn_chong.showTip=!1,e.text_cost.innerHTML=Ql.createColor(t+"","#ff2e24")+"/"+e.costNum)}},e.updateByVSC=function(e){"31054"==e.actionOrder?this.updateView2():"31051"==e.actionOrder?this.setEff():"BP_UPDATE"==e.actionOrder&&this.updateCost()},e.updateView=function(){var e=this;if(e.viewData=ON.ins.data31051,e.isFull=1,e.viewData){var t=e.viewData.wuxingData;for(var i in t){var n=parseInt(i);if(n){e["qiu_"+(n-1)].changeText(t[i]+"/"+e.wuxingMax),e["mask_mc"+(n-1)].pos(0,e["blessball"+(n-1)].height-e["blessball"+(n-1)].height*(t[i]/e.wuxingMax)),e["qiuwenEff"+(n-1)].pos(e["blessball"+(n-1)].width/2,e["blessball"+(n-1)].height-e["blessball"+(n-1)].height*(t[i]/e.wuxingMax));var s=1-Math.abs(t[i]/e.wuxingMax-.5);.5==s&&(s=0),e["qiuwenEff"+(n-1)].scale_X=s,t[i]<e.wuxingMax&&(e.isFull=0);for(var o=eo.MODEL.attrs(eo.getIndex(n)),a=[],r=0;r<t[i];r++)a=aa.mergeFormatAttrs(o,a);var l=aa.formatAttrToChineseByList(a);e.setAtt(n-1,l)}}}e.isFull&&(e.isAuto=0,G.timer.clear(e,e.autoUpgrade),e.btn_chong.label=RP.n[1020],e.btn_chong.showTip=!0,e.boxb.visible=!1)},e.updateView2=function(){var e=this;if(e.viewData=ON.ins.data31051,e.refreshviewData=ON.ins.data31054,e.boxb.visible=!0,e.refreshviewData&&e.viewData){var t=e.viewData.wuxingData,i=e.refreshviewData.wuxingCurData;for(var n in t){if(parseInt(n))for(var s in i)if(s==n){var o=parseInt(s);o&&(e.flyNum=o,t[n]+=i[s])}}}e.qiuMidFireEFF.visible=!1,e.maskMid_mc&&(e.qiuMidWenEFF.y=e.maskMid_mc.y=e.blessballmid.height,e.moveDis=12,G.timer.loop(10,e,e.effHandler))},e.effHandler=function(){var e=this;e.maskMid_mc.y-=e.moveDis,e.qiuMidWenEFF.y-=e.moveDis;var t=1-Math.abs(e.maskMid_mc.y-e.blessballmid.height/2)/e.blessballmid.height;.5==t&&(t=0),e.qiuMidWenEFF.scale_X=t,e.maskMid_mc.y<=0&&(G.timer.clear(e,e.effHandler),e.qiuMidFireEFF.visible=!0,e.maskMid_mc.y=0,e.qiuMidWenEFF.scale_X=0,e.qiuBaoEFF&&(e.qiuBaoEFF.removeSelf(),e.qiuBaoEFF.dispose(),e.qiuBaoEFF=null),e.qiuBaoEFF=mj.GetNew(),e.qiuBaoEFF.pos(e.blessballmid.x+e.blessballmid.width/2,e.blessballmid.y+e.blessballmid.height/2),e.qiuBaoEFF.renderInSelf=!0,e.qiuBaoEFF.loadEffect("jm1517"),G.timer.once(130,e,e.ebaoEnd),e.boxt.addChild(e.qiuBaoEFF))},e.ebaoEnd=function(){var e=this;e.qiuflyEFF&&(e.qiuflyEFF.removeSelf(),e.qiuflyEFF.dispose(),e.qiuflyEFF=null),e.qiuflyEFF=mj.GetNew(),e.qiuflyEFF.pos(0,0),e.qiuflyEFF.renderInSelf=!0,e.qiuflyEFF.loadEffect("jm1518"),G.timer.once(130,e,e.eflyEnd),e.flySp.addChild(e.qiuflyEFF),e.flySp.rotation=72*(e.flyNum-1)},e.eflyEnd=function(){this.updateView()},e.setAtt=function(e,t){0<t.length&&(this["att_"+e].innerHTML=Ql.createColor(this.attName[e]+"+"+t[0].val,"#23b11f"))},e.openQuickBuyPanel=function(e){Tu.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1050,max:-1}),UB.ins.playSound(90006)},e.destoryImage=function(e){ui.ViewBase.prototype.destoryImage.call(this,e)},e.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_chong.on("click",t,t.onClick),t.btn_task.on("click",t,t.onClick),t.btn_zhan.on("click",t,t.onClick),t.btn_fa.on("click",t,t.onClick),t.btn_dao.on("click",t,t.onClick),t.btn_chong.showTip=!1,t.init()},e.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_chong.off("click",t,t.onClick),t.btn_task.off("click",t,t.onClick),t.btn_zhan.off("click",t,t.onClick),t.btn_fa.off("click",t,t.onClick),t.btn_dao.off("click",t,t.onClick),t.isAuto=0,t.btn_chong.label=RP.n[1019],G.timer.clearAll(t)},e.autoUpgrade=function(){if(this.isEnought){var e=new fP;Tu.sendToService(e)}else this.isAuto=0,this.btn_chong.label=RP.n[1019],this.openQuickBuyPanel(null),G.timer.clear(this,this.autoUpgrade)},e.onClick=function(e){var t=this;if(e.target==t.btn_zhan){if(1==t.btn_zhan.gray)return void zB.ins.showById(4804,1);t.img_dao.visible=!1,t.img_fa.visible=!1,t.img_zhan.visible=!0}else if(e.target==t.btn_fa){if(1==t.btn_fa.gray)return void zB.ins.showById(4804,1);t.img_dao.visible=!1,t.img_zhan.visible=!1,t.img_fa.visible=!0}else if(e.target==t.btn_dao){if(1==t.btn_dao.gray)return void zB.ins.showById(4804,1);t.img_zhan.visible=!1,t.img_fa.visible=!1,t.img_dao.visible=!0}else e.target==t.btn_task?(hN.ins.open("NIEPAN_DAILY_VIEW"),t.removeEff()):e.target==t.btn_chong&&(t.isFull?Tu.sendToModule("NIEPANTASK",["modules.scene.SceneModule"]):t.isAuto?(t.isAuto=0,t.btn_chong.label=RP.n[1019],G.timer.clear(t,t.autoUpgrade)):t.isEnought?(t.autoUpgrade(),t.isAuto=1,t.btn_chong.label=RP.n[1024],G.timer.loop(300,t,t.autoUpgrade)):t.openQuickBuyPanel(null))},e.setEff=function(){var e=this;ON.ins.firstIn||1==ON.ins.checkDailyAward()?(ON.ins.firstIn=0,e.taskEff&&(e.taskEff&&e.taskEff.dispose(),e.taskEff=null),e.taskEff=mj.GetNew(),e.taskEff.renderInSelf=!0,e.taskEff.pos(e.btn_task.x+50,e.btn_task.y+50),e.taskEff.loadEffect("jm1160"),e.boxb.addChild(e.taskEff)):e.removeEff()},e.removeEff=function(){0==ON.ins.checkDailyAward()&&this.taskEff&&(this.taskEff&&this.taskEff.dispose(),this.taskEff=null)},e.destroy=function(e){var t=this;void 0===e&&(e=!0),t.taskEff&&(t.taskEff.dispose(),t.taskEff=null),t.qiuwenEff0&&(t.qiuwenEff0.dispose(),t.qiuwenEff0=null),t.qiuwenEff1&&(t.qiuwenEff1.dispose(),t.qiuwenEff1=null),t.qiuwenEff2&&(t.qiuwenEff2.dispose(),t.qiuwenEff2=null),t.qiuwenEff3&&(t.qiuwenEff3.dispose(),t.qiuwenEff3=null),t.qiuwenEff4&&(t.qiuwenEff4.dispose(),t.qiuwenEff4=null),t.qiuMidEff&&(t.qiuMidEff.dispose(),t.qiuMidEff=null),t.qiuMidEFF&&(t.qiuMidEFF.dispose(),t.qiuMidEFF=null),t.qiuMidFireEFF&&(t.boxt.removeChild(t.qiuMidFireEFF),t.qiuMidFireEFF.dispose(),t.qiuMidFireEFF=null),t.qiuMidWenEFF&&(t.qiuMidWenEFF.removeSelf(),t.qiuMidWenEFF.dispose(),t.qiuMidWenEFF=null);for(var i=0;i<5;i++)t["qiuEff"+i].removeSelf(),t["qiuEff"+i].dispose(),t["qiuEff"+i]=null;t.qiuflyEFF&&(t.qiuflyEFF.removeSelf(),t.qiuflyEFF.dispose(),t.qiuflyEFF=null),t.qiuBaoEFF&&(t.qiuBaoEFF.removeSelf(),t.qiuBaoEFF.dispose(),t.qiuBaoEFF=null),laya.ui.View.prototype.destroy.call(t,e)},t}(_h),QZ=function(e){function t(){this._grids=null,t.__super.call(this)}b(t,"modules.offline.views.OfflineExpV",Ih);var i=t.prototype;return i.initialize=function(){this._grids=new wj(3,4,116,12,12,!1),this._grids.pos(17,420),this._grids.height-=24,this.addChild(this._grids),this.txt_1.innerHTML=RP.n[1025]+Ql.createColor("24","#23b11f")+RP.n[1026]},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.update()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.update=function(){var e=this;if(PN.ins.toc_exp){var t=PN.ins.toc_exp;e.txt_time.innerHTML=RP.n[1027]+Ql.createColor(Jp.getHMSOrDHm(t.time),"#23b11f"),e.txt_coin.changeText("+"+t.coin),e.txt_exp.changeText("+"+t.exp),e.txt_soul.changeText("+"+t.moChenNum),e.txt_equip_0.changeText("+"+t.eqNum_0),e.txt_equip_1.changeText("+"+t.eqNum_1),e.txt_equip_2.changeText("+"+t.eqNum_2),e.txt_YKcoin.changeText("+"+t.yKcoin),e.txt_YKexp.changeText("+"+t.yKexp),e._grids.vScrollBar.value=0}},i.destroy=function(e){void 0===e&&(e=!0),this._grids.destroy(e),this._grids=null,laya.ui.View.prototype.destroy.call(this,e)},t}(),JZ=function(e){function t(){var e=this;e._actorSelector=null,e._roleIndex=0,e._equipIndex=-1,e._equipHash=null,e.g_cost=null,e.attr_sin=null,e.attr_dou1=null,e.attr_dou2=null,e._isActiveTroopTao=!1,e._isActiveDecorationTao=!1,e._materialIds_YES=[2013,2013,2013,2013,2013,2013,2013,2013],e._materialIds_NO=[2001,2002,2003,2004,2005,2006,2007,2008],e._activeEff=null,e._upLvlEff=null,e.isSame=!1,e._taoEff=null,e._equipAvatar=null,e.curLvl=0,e.nextLvl=0,e.standLvl=0,e.curPro=null,e.nextPro=null,e.effect_fenjie=null,e.currentEquLv=0,e.skillLv=0,e._costDto=null,e._materialEnought=!1,e._isActive=!1,e.currentPro={},e.prePro=null,e.standPro=null,t.__super.call(e),e.initUI()}b(t,"modules.passsuit.views.PassSuitMainView",DI);var i=t.prototype;return i.initUI=function(){var e=this;e.centerX=e.centerY=0,e._actorSelector=new Nj,e.addChild(e._actorSelector),e.hdv_cost.y+=3,e.hdv_cost.style.font="SimHei",e.hdv_cost.style.fontSize=20,e.hdv_cost.style.align="center",e.hdv_cost.style.color="#e3dcc2",e.hdv_cost.style.valign="middle",e.hdv_name.style.font="SimHei",e.hdv_name.style.fontSize=28,e.hdv_name.style.align="center",e.hdv_name.style.color="#e6d80d",e.g_cost=new MF(45),e.g_cost.needGridBg=!1,e.g_cost.needEffect=!1,e.g_cost.pos(282,1020),e.addChild(e.g_cost),e._actorSelector.on("select",e,e.roleChangeHandler),e.txt_active.underline=!0,e.img_skill.width=e.img_skill.height=64,e.btn_left.visible=e.btn_right.visible=!1,e.img_Skill.visible=!1,e.img_max.cacheAs="bitmap",e.mc_next.cacheAs="bitmap",e.bg.cacheAs="bitmap",e.img_redCom.visible=!1},i.onClickTxtActive=function(e){this._isActive?Tu.sendToModule("OPEN_PASSSUIT_FENJIE",["modules.passsuit.PassSuitModule"]):Tu.sendToModule("OPEN_PASSSUIT_COMPOSE",["modules.passsuit.PassSuitModule"])},i.onClickEffectActive=function(e){Tu.sendToModule("OPEN_PASSSUIT_FENJIE",["modules.passsuit.PassSuitModule"])},i.onMouseTap=function(e){if(null!=RN.ins.equipHash){var t=new Object,i=RN.ins.equipHash.take(this._roleIndex),n=RN._ins.getSuitIdByRoleIndex(this._roleIndex);t.level=n,t.list=i,gY.instance.show(t)}},i.clearTaoEffect=function(){this._taoEff&&(this._taoEff.parent&&this._taoEff.parent.removeChild(this._taoEff),this._taoEff.dispose(),this._isActiveTroopTao&&(this._isActiveTroopTao=!1),this._isActiveDecorationTao&&(this._isActiveDecorationTao=!1))},i.upLvHandler=function(e){var t=this;t._materialEnought?(t._isActiveTroopTao=!1,t._isActiveDecorationTao=!1,t.getTroopEnough()?t._isActiveTroopTao=!0:t._isActiveTroopTao=!1,t.getDecorationEnough()?t._isActiveDecorationTao=!0:t._isActiveDecorationTao=!1,"激 活"==t.btn_up.label?(t.showActiveEffect(),UB.ins.playSound("1")):"升 级"==t.btn_up.label&&(t.showUpLvlEffect(),UB.ins.playSound("2",3,!0)),NN.reqPassSuitUpLvl(t._roleIndex,t._equipIndex)):t._isActive?Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._materialIds_YES[t._equipIndex]}):Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._materialIds_NO[t._equipIndex]})},i.showActiveEffect=function(){var e=this;e._activeEff&&(e._activeEff.parent&&e._activeEff.parent.removeChild(e._activeEff),e._activeEff.dispose()),e._activeEff=mj.GetNew(),e._activeEff.renderInSelf=!0,e._activeEff.loadEffect("jm0149"),e._activeEff.pos(360,460),e.addChild(e._activeEff)},i.showUpLvlEffect=function(){var e=this;e._upLvlEff&&(e._upLvlEff.parent&&e._upLvlEff.parent.removeChild(e._upLvlEff),e._upLvlEff.dispose()),e._upLvlEff=mj.GetNew(),e._upLvlEff.renderInSelf=!0,e._upLvlEff.loadEffect("jm0011"),e._upLvlEff.pos(360,460),e.addChild(e._upLvlEff)},i.onClickHandler=function(e,t){var i=this;i.btn_left.visible=!1;for(var n=0;n<8;n++)i._equipHash.take(n).select=n==e;if(i._equipIndex==e?i.isSame=!0:i.isSame=!1,i._equipIndex=e,i.updateName(),i.updateEquipPro(),i.updateBtn(),i.updateSkillInfo(),0<RN.ins.equipHash.take(i._roleIndex)[i._equipIndex]&&null!=t&&i.isSame){var s={lv:i.currentEquLv,ps:i._equipIndex};pY.instance.show(s)}var o=RN.ins.getFenJieEqui();if(0<o[i._equipIndex]&&i._isActive)i.getfenjieRedPointAndEffect(0<o[i._equipIndex]&&i._isActive);else{var a=RN.ins.isEnoughtComposeByPos(i._roleIndex,i._equipIndex);i.getfenjieRedPointAndEffect(a)}},i.showTaoEff=function(){this.clearTaoEffect(),this._taoEff=mj.GetNew(),this._taoEff.renderInSelf=!0,this._taoEff.loadEffect("jm0148"),this._taoEff.mouseEnabled=!1,this._taoEff.pos(265,1085),this.addChild(this._taoEff)},i.updateName=function(){this.hdv_name.innerHTML=this["label"+this._equipIndex].text},i.updateAvatar=function(e){var t=this;e&&(t._equipAvatar&&(t._equipAvatar.parent&&t._equipAvatar.parent.removeChild(t._equipAvatar),t._equipAvatar.dispose()),t._equipAvatar=mj.GetNew(),t._equipAvatar.renderInSelf=!0,t._equipAvatar.pos(365,460),t.addChildAt(t._equipAvatar,t.getChildIndex(t.bg)+1),t._equipAvatar.loadEffect(e),t._equipAvatar.scaleX=t._equipAvatar.scaleY=.85)},i.roleChangeHandler=function(){this._roleIndex!=this._actorSelector.selectIdx+1&&(this._equipIndex=-1,this.update())},i.forceRefresh=function(e,t){this._actorSelector&&(this._actorSelector.selectIdx=e-1),this._roleIndex=e,this._equipIndex=t,this.update()},i.getTroopEnough=function(){var e=this,t=RN.ins.equipHash.take(e._roleIndex),i=t[0],n=t[1],s=n<i?n:i,o=RN.ins.getCurSuitPro(1,s),a=0,r=0;e.nextPro=o.next,e.curLvl=o.curLvl,e.nextLvl=o.nextLvl,e.standLvl=""==e.nextPro?e.curLvl:e.nextLvl;var l=!1;for(a=0;a<2;a++)a!=e._equipIndex?t[a]>=e.standLvl&&++r:a==e._equipIndex&&t[a]+1==e.standLvl&&(++r,l=!0);return!(2!=r||!l)},i.getDecorationEnough=function(){var e=this,t=RN.ins.equipHash.take(e._roleIndex),i=100,n=0,s=0,o=!1;for(n=2;n<8;n++)t[n]<i&&(i=t[n]);var a=RN.ins.getCurSuitPro(2,i);for(e.nextPro=a.next,e.curLvl=a.curLvl,e.nextLvl=a.nextLvl,e.standLvl=""==e.nextPro?e.curLvl:e.nextLvl,n=2;n<8;n++)n!=e._equipIndex?t[n]>=e.standLvl&&++s:n==e._equipIndex&&t[n]+1==e.standLvl&&(++s,o=!0);return!(6!=s||!o)},i.refreshRedPoint=function(){var e=0,t=!1,i=0,n=RN.ins.getFenJieEqui();for(e=0;e<gR.ins.actorList.length;e++)if(t=RN.ins.isTotalEnought(e+1),this._actorSelector.setRedPtByIdx(e,t),0==t)for(i=0;i<this._equipHash.length;i++)if(0<n[i]){this._actorSelector.setRedPtByIdx(e,!0);break}for(e=0;e<gR.ins.actorList.length;e++)for(i=0;i<this._equipHash.length;i++)if(RN.ins.isEnoughtComposeByPos(e+1,i)){this._actorSelector.setRedPtByIdx(e,!0);break}for(i=0;i<this._equipHash.length;i++)0==(t=RN.ins.isEnoughtByPos(this._roleIndex,i))&&(t=!!(0<n[i]||RN.ins.isEnoughtComposeByPos(this._roleIndex,i))),this._equipHash.take(i).isRedPointVisible=t},i.getfenjieRedPointAndEffect=function(e){var t=this;e?(null==t.effect_fenjie&&(t.effect_fenjie=kB.createEffect("jm1130",t.txtEffectPoint.x+48,t.txtEffectPoint.y+13)),null==t.effect_fenjie.parent&&t.addChild(t.effect_fenjie),t.effect_fenjie.scale_X=.7,t.effect_fenjie.scale_Y=.7,t.effect_fenjie.mouseEnabled=t.effect_fenjie.mouseThrough=!1):t.effect_fenjie&&(t.effect_fenjie.parent&&t.effect_fenjie.parent.removeChild(t.effect_fenjie),t.effect_fenjie.dispose(),t.effect_fenjie=null)},i.onClickSkillListener=function(e){var t=this,i="";if(e.target==t.img_skill){var n={lv:t.skillLv};fY.instance.show(n)}else e.target==t.btn_left?(t.btn_right.visible=!0,t.btn_left.visible=!1,t.currentPro&&0!=t.currentPro.cindex&&(t.showPreAttr("left"),i=Ms.MODEL.effectid(t.currentPro.cindex),t.hdv_name.innerHTML=Ms.MODEL.name(t.currentPro.cindex))):e.target==t.btn_right&&(t.btn_right.visible=!1,t.btn_left.visible=!0,t.currentPro&&0!=t.currentPro.nindex&&(t.showPreAttr("right"),i=Ms.MODEL.effectid(t.currentPro.cindex),t.hdv_name.innerHTML=Ms.MODEL.name(t.currentPro.cindex)));t.updateAvatar(i)},i.update=function(){var e=this;e._roleIndex=e._actorSelector.selectIdx+1,null!=RN.ins.equipHash.take(e._roleIndex)?(e.updateEquip(),e.updateTaoBtn(),e.updateSkillInfo(),e._isActiveTroopTao?e.getTroopEnough()||e.showTaoEff():e._isActiveDecorationTao&&(e.getDecorationEnough()||e.showTaoEff()),e.refreshRedPoint(),e.updateBtn()):zB.ins.playErrorMsg(RP.n[1028])},i.showPreAttr=function(e){var t=this._equipHash.take(this._equipIndex),i=0;i="left"==e?t.level:t.level+1,this.currentPro=RN.ins.getProHash(this._equipIndex,i),this.updateDouble(this.currentPro.cur,this.currentPro.next)},i.updateTaoBtn=function(){RN.ins.equipHash.take(this._roleIndex);var e=RN._ins.getSuitIdByRoleIndex(this._roleIndex);0==e&&(e=1),this.btn_tip.skin=_r.getAtlasSubPath("passsuit/cs_btn_"+e+".png"),e=RN._ins.getSuitIdByRoleIndex(this._roleIndex),this.btn_tip.filters=e<=0?A_.getGrayFilter():[]},i.updateEquip=function(){var e,t,i=RN.ins.equipHash.take(this._roleIndex),n=0,s=0,o=-1;for(n=0;n<8;n++)s=i[n],(e=this._equipHash.take(n)).level=s,""!=(t=RN.ins.getEquipNameByPosAndLvl(n,s))&&this["label"+n].changeText(t),-1==this._equipIndex&&e.isRedPointVisible&&(this._equipIndex=n);o=-1!=this._equipIndex?this._equipIndex:0,this.onClickHandler(o)},i.updateBtn=function(){var e=this;e.currentEquLv=0;var t=e._equipHash.take(e._equipIndex);e.currentEquLv=t.level,0==e.currentEquLv?(e.btn_up.label="激 活",e.btn_right.visible=e.btn_left.visible=!1):(e.btn_up.label="升 级",1<e.currentEquLv&&(e.btn_right.visible=e.currentEquLv<4));var i=RN.ins.isEnoughtByPos(e._roleIndex,e._equipIndex);e.btn_up.showTip=i},i.updateSkillInfo=function(){var e=this;e.img_Skill.visible=!1,e.img_skill.visible=!1;var t=e.skillLv=0,i=RN.ins.equipHash.take(e._roleIndex);0==i[e._equipIndex]||i[e._equipIndex],0==e._equipIndex?(e.img_Skill.visible=!0,e.img_skill.visible=!0,t=0==i[e._equipIndex]?RN.ins.getIndexBySuitTypeAndLv(1,1):RN.ins.getIndexBySuitTypeAndLv(1,i[e._equipIndex])):1==e._equipIndex&&(e.img_Skill.visible=!0,e.img_skill.visible=!0,t=0==i[e._equipIndex]?RN.ins.getIndexBySuitTypeAndLv(2,1):RN.ins.getIndexBySuitTypeAndLv(2,i[e._equipIndex]));var n=As.MODEL.skillEffectId(t),s=Ls.getIndex(parseInt(n));Ls.MODEL.icon(s)&&e.showSkillIcon(Ls.MODEL.icon(s)),0==i[e._equipIndex]?e.img_skill.filters=A_.getGrayFilter():e.img_skill.filters=null,e.skillLv=parseInt(n)},i.updateEquipPro=function(){var e=this;e.currentPro={},e.txtEffectPoint.visible=!1,e._materialEnought=!1,e.sp.visible=!0,e.img_max.visible=!1;var t=e._equipHash.take(e._equipIndex).level;e.currentPro=RN.ins.getProHash(e._equipIndex,t);var i=RN.ins.getCostHash(e._equipIndex,t),n=parseInt(i.costId),s=parseInt(i.costNum);e._costDto?e._costDto.setGoodsId(n):e._costDto=yB.create(n),e.g_cost._iconUrl=null,e.g_cost.bindData=e._costDto;var o=TR.ins.getGoodsNum(n);s<=o?(e._materialEnought=!0,e.hdv_cost.innerHTML=Ql.createColor(o+"","#23b11f")+"/"+s):(e._materialEnought=!1,e.hdv_cost.innerHTML=Ql.createColor(o+"","#ff2e24")+"/"+s),e._isActive=!1,e.txt_active.text=RP.n[1029];var a=e.currentPro.cur,r=e.currentPro.next;""==a||null==a?(e.updateAvatar(Ms.MODEL.effectid(e.currentPro.nindex)),e.updateSingle(r,!0),e.sp.visible=!0,e.img_max.visible=!1,e.btn_left.visible=e.btn_right.visible=!1):(e._isActive=!0,e.txt_active.text=RP.n[1030],e.updateAvatar(Ms.MODEL.effectid(e.currentPro.cindex)),""==r||null==r?(e.txtEffectPoint.visible=!0,e.updateSingle(a),e.sp.visible=!1,e.img_max.visible=!0,e.txtEffectPoint.text=RP.n[1031]):(e.updateDouble(a,r),e.sp.visible=!0,e.img_max.visible=!1),e.btn_right.visible=!0),e.txt_active.underline=!0,e.caculateFightValue()},i.caculateFightValue=function(){var e,t=0,i=0,n=0,s=[],o=[];for(n=i=0;n<8;n++){var a=0;s=[],t=this._equipHash.take(n).level,""!=(e=RN.ins.getProHash(n,t).cur)&&(s=aa.mergeFormatAttrs(e,s),a=RR.getFight(s,this._roleIndex,0,!0,!1),o.push(a))}i=this.getFightNum(o),i+=this.calTalValue(),this.clip_fight.value=i},i.getFightNum=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i];return t},i.calTalValue=function(){var e=0,t=RN._ins.getSuitIdByRoleIndex(this._roleIndex);if(0<t){var i=RN.ins.getCurSuitPro(3,t),n=aa.formatNewAttrToChinese(i.cur,!1,!1);e=RR.getFight(n)}return e},i.updateSingle=function(e,t){var i=this;void 0===t&&(t=!1),i.attr_dou1&&(i.attr_dou1.visible=!1,i.attr_dou2.visible=!1),i.attr_sin||(i.attr_sin=new dt,i.attr_sin.pos(265,763),i.addChild(i.attr_sin)),i.attr_sin.visible=!0,i.showAttr(i.attr_sin,e,"#23b11f",t),i.mc_next.visible=!1},i.updateDouble=function(e,t,i){var n=this;void 0===i&&(i=!1),n.attr_sin&&(n.attr_sin.visible=!1),n.attr_dou1||(n.attr_dou1=new dt,n.attr_dou1.pos(150,763),n.addChild(n.attr_dou1),n.attr_dou2=new dt,n.attr_dou2.pos(470,763),n.addChild(n.attr_dou2)),n.attr_dou1.visible=n.attr_dou2.visible=!0,n.showAttr(n.attr_dou1,e,"#90877b",i,!0),""!=t?n.showAttr(n.attr_dou2,t,"#23b11f",!1,!1):n.attr_dou2.graphics.clear(),n.mc_next.visible=!0},i.showAttr=function(e,t,i,n,s){var o;void 0===s&&(s=!0),e.graphics.clear();var a=5,r=5,l=5,c=aa.formatAttrToChineseByList(t),u=yc.getRes(_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzd.png")),d=yc.getRes(_r.getAtlasSubPath("ase_ui2/ty_bq_ss.png"));if(0<c.length){var h=c.length;3<=h?(l=-30,4==h&&(l=5),r=39):2==h&&(l=20,r=50),n&&(i="#23b11f");for(var _=0;_<c.length;_++)s?e.graphics.drawTexture(u,a,l-2,270,34):(e.graphics.drawTexture(u,a,l-2,110,34),e.graphics.drawTexture(d,a+85,l+1,23,28)),o=c[_],s&&(e.graphics.fillText(o.addName+": ",a,l+2,"24px SimHei","#90877b","left"),a+=22*mp.getStringLength(o.addName+": ")>>1),e.graphics.fillText(o.val+"",a+5,l+2,"24px SimHei",i,"left"),a+=22*mp.getStringLength(o.val)>>1,l+=r,a=5}},i.showSkillIcon=function(e){this.img_skill.skin=_r.getIconPath(e)},i.initPart=function(){var e;this._equipHash=new jl;for(var t=0;t<8;t++)(e=new rq).select=!1,e.position=t,e.level=0,e.x=this["grid"+t].x,e.y=this["grid"+t].y,e.on("click",this,this.onClickHandler,[t]),this.addChild(e),this._equipHash.put(t,e)},i.onAdd=function(e){var t=this;t.initPart(),t._actorSelector.selectIdx=Nj.globalIdx,t._roleIndex=1,t.img_skill.on("click",t,t.onClickSkillListener),t.btn_left.on("click",t,t.onClickSkillListener),t.btn_right.on("click",t,t.onClickSkillListener),t.btn_up.on("click",t,t.upLvHandler),t.btn_tip.on("click",t,t.onMouseTap),t.txt_active.on("click",t,t.onClickTxtActive),t.txtEffectPoint.on("click",t,t.onClickEffectActive),t.update()},i.onRemove=function(e){var t=this;t._equipIndex=-1,t.skillLv=0,t.img_skill.off("click",t,t.onClickSkillListener),t.btn_left.off("click",t,t.onClickSkillListener),t.btn_right.off("click",t,t.onClickSkillListener),t.txtEffectPoint.off("click",t,t.onClickSkillListener),t.btn_up.off("click",t,t.upLvHandler),t.btn_tip.off("click",t,t.onMouseTap),t.txt_active.off("click",t,t.onClickTxtActive),t.txtEffectPoint.off("click",t,t.onClickEffectActive),t.btn_left.visible=t.btn_right.visible=!1,t.isSame=!1,t.effect_fenjie&&(t.effect_fenjie.parent&&t.effect_fenjie.parent.removeChild(t.effect_fenjie),t.effect_fenjie.dispose(),t.effect_fenjie=null),t._activeEff&&(t._activeEff.parent&&t._activeEff.parent.removeChild(t._activeEff),t._activeEff.dispose()),t._activeEff=null,t._upLvlEff&&(t._upLvlEff.parent&&t._upLvlEff.parent.removeChild(t._upLvlEff),t._upLvlEff.dispose()),t._upLvlEff=null,t._equipAvatar&&(t._equipAvatar.parent&&t._equipAvatar.parent.removeChild(t._equipAvatar),t._equipAvatar.dispose()),t._equipAvatar=null,t.txtEffectPoint.changeText("");for(var i=0;i<t._equipHash.length;i++){var n=t._equipHash.take(i);n.destroy(),n=null}t._equipHash=null},i.refreshRoleInfo=function(){this._actorSelector&&this._actorSelector.refresh()},i.destroy=function(e){void 0===e&&(e=!0),this._equipAvatar&&this._equipAvatar.dispose(),laya.ui.View.prototype.destroy.call(this,e)},f(t,["_noActiveEff",function(){return this._noActiveEff=["jm1185","jm1186","jm1189","jm1190","jm1187","jm1188","jm1191","jm1192"]},"_activeEffs",function(){return this._activeEffs=["jm1185","jm1186","jm1189","jm1190","jm1187","jm1188","jm1191","jm1192"]}]),t}(),ZZ=function(e){function t(){var e=this;e._grid=null,e._dto=null,e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,t.__super.call(e),e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e._grid.toolTipEnabled=!1,e.addChildAt(e._grid,e.getChildIndex(e.img_icon)+1)}b(t,"modules.pet.views.EggTips",ga);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var i=this;e&&(this.tipsbg.skin=_r.getFullUrl("ui/images/pet/cw_tips_bg.jpg"),this._dto=e,this._dto.goodsNum=1,this._grid.bindData=e,this.txt_name.changeText(e.name),this.txt_name.color=ms.getDragonColorByQuality(this._dto.colourId),this.btn_go.visible=0<this._dto.uuId,this.setAvatar(),TR.ins.getGoodsDes(e.goodsId,ql.create(this,function(e,t){i.txt_des.innerHTML=t,this.height=i.txt_des.y+i.txt_des.contextHeight+(i.btn_go.visible?133:30)})),this.parent||(eq.panelLayer.on("MASK_CLOSE",this,this.onClick),eq.panelLayer.openTip(this)),this.btn_go.on("click",this,this.onClickHandler))},i.onClickHandler=function(e){Tu.sendToModule("PETOPENVIEW",["modules.pet.PetModule"]),this.close(!0)},i.onClick=function(e){this.close(!0)},i.close=function(e){var t=this;(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(t)&&eq.panelLayer.close(t):eq.panelLayer.close(t);t.btn_go.off("click",t,t.onClickHandler),t.clearAvator(),t.clearAvator2(),G.timer.clearAll(t),t.tipsbg&&t.tipsbg.skin&&(G.loader.clearRes(t.tipsbg.skin),t.tipsbg.skin="")},i.setAvatar=function(){if(0<Dh.count)this.showAvator();else{var e=[{url:_r.getDBPath("PetEggResource"),type:"arraybuffer"}];G.loader.load(e,ql.create(this,this.onLoad,e),null,"arraybuffer")}},i.effEnd=function(){this.clearAvator2(),this._avatar2=new mj,this._avatar2.renderInSelf=!0,this.addChild(this._avatar2),this._avatar2.loadEffect(this.modeleff2),this._avatar2.pos(280,300)},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.showAvator=function(){var e=this;if(e.clearAvator(),null!=e._dto){for(var t,i=0;i<Dh.count;i++)Dh.MODEL.goodsId(i)==e._dto.goodsId&&(t=Dh.MODEL.interfaceModel(i));if(t){var n=t.split(",");e.modeleff1=n[0],e.modeleff2=n[1]}e._avatar=new mj,e._avatar.renderInSelf=!0,G.timer.once(800,e,e.effEnd),e.addChild(e._avatar),e._avatar.loadEffect(e.modeleff1),e._avatar.pos(280,300)}},i.onLoad=function(e){if(G.loader.getRes(e.url)&&Dh.count<=0){Dh.setup(e.url);for(var t=Dh.count,i=0;i<t;i++)Dh.config(i)}G.loader.clearRes(e.url),this.showAvator()},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.pet.EggTipUI._$SET_instance),t._instance=null,t}(),KZ=function(e){function t(){this.REMAIN_TIME=30,this._totalTime=0,this.reliveType=0,t.__super.call(this)}b(t,"modules.relive.views.NavWorldBoss",Yd);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_relive.on("click",this,this.onReliveClicked),this.btn_save.on("click",this,this.onSaveClicked),this.img_bg.skin=_r.getFullUrl("ui/images/relive/boss_fh_db.png"),this.update()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_relive.off("click",this,this.onReliveClicked),this.btn_save.off("click",this,this.onSaveClicked)},i.update=function(){var e=this;p_.toc24006&&(e.txt_dect.innerHTML="您被"+Ql.createColor(p_.toc24006.killerName,"#e6d80d")+"击败");var t=rn.getIndex(BR.ins.curCopyId);e.reliveType=rn.MODEL.reliveType(t),e.REMAIN_TIME=rn.MODEL.reliveCD(t);var i=rn.MODEL.reliveConsumptionDefs(t);if(0!=e.REMAIN_TIME&&""!=i&&null!=i){for(var n=JSON.parse(i),s=0;s<n.length;s++){var o=n[s];if("res"==o.type){var a=String(o.value).split(":");e.img_cost.visible="GOLD"==a[0],e.txt_cost.text=a[1]}}e.txt_cost.visible=e.img_cost.visible=!0}e._totalTime=e.REMAIN_TIME,e.showTimeTxt(e.txt_time,e._totalTime),G.timer.loop(1e3,e,e.onTimer,[e.txt_time])},i.onReliveClicked=function(e){this.sendRelive(1)},i.onSaveClicked=function(e){var t=rn.getIndex(BR.ins.curCopyId);switch(rn.MODEL.cate(t)){case 57:this.closePanel(),Po.ins().backMissionID=BR.ins.curCopyId,jR.reqEntry(3096,0,0,0,0,BR.ins.curCopyId)}},i.closePanel=function(){G.timer.clear(this,this.onTimer),this._totalTime=0,hN.ins.close("NavWorldBoss")},i.onTimer=function(e){if(!(BR.ins.curCopyId<=0||3096==BR.ins.curCopyId))return this._totalTime--,this.showTimeTxt(this.txt_time,this._totalTime),this._totalTime<=0?(this.onSaveClicked(null),void this.closePanel()):void 0;Tu.sendToModule("RELIVEVIEW_CLOSE",["modules.relive.ReliveModule"])},i.showTimeTxt=function(e,t){t<0&&(t=0),e.changeText("("+t+")")},i.sendRelive=function(e){var t=new wA;t.type=e,Tu.sendToService(t)},t.NAME="NavWorldBoss",t}(),$Z=function(e){function t(){var e=this;e._grid=null,e._skillId=0,e._skillNextId=0,t.__super.call(e),e._grid=new GF,e._grid.pos(e.img_icon.x,e.img_icon.y),e.addChild(e._grid)}b(t,"modules.pet.views.PetSkillTip1",Rh);var i=t.prototype;return i.show=function(e){var t=this;if(e){var i,n=0;if("number"==typeof e&&Math.floor(e)==e){n=e,i=new Hh;var s=Bh.getIndex(n);i.petId=Bh.MODEL.petStar(s),i.petStar=Bh.MODEL.petStar(s),i.petModel=Ph.MODEL.model(Ph.getIndex(i.petId)),n=s}else i=e,n=modules.pet.others.PetDataModel.ins().getStarIndexByPro(i.petId,i.petStar);t.txt_name.changeText(i.name);var o=Bh.MODEL.skillsNow(n),a="",r=[],l=0,c=1,u=0;if(o){if(t.lb_title1.text=RP.n[1033],a=Bh.MODEL.skillsNext(n)){r=a.split(","),l=parseInt(r[0]);var d=Bh.MODEL.skillsNow(modules.pet.others.PetDataModel.ins().getStarIndexByPro(i.petId,l));if(d){var h=Vn.getIndex(d);t.div_des2.innerHTML=Vn.MODEL.desc(h)}}t.lb_title2.visible=t.div_des2.visible=a,t.g_line.visible=t.txt_limit.visible=a,u=a?1:2}else c=0,(a=Bh.MODEL.skillsNext(n))&&(r=a.split(","),l=parseInt(r[0]),o=Bh.MODEL.skillsNow(modules.pet.others.PetDataModel.ins().getStarIndexByPro(i.petId,l))),t.lb_title1.text=RP.n[1032],t.lb_title2.visible=t.div_des2.visible=!1,t.g_line.visible=t.txt_limit.visible=!0,u=0;t._grid.bindData=o;s=Vn.getIndex(o);t.txt_name.changeText(Vn.MODEL.name(s)),t.div_des.innerHTML=Vn.MODEL.desc(s),t.txt_limit.changeText(RP.n[1034]+l+"星"),t.txt_learn.text=c?"":"未习得",t.txt_learn.color=c?"#00ff00":"#ff0000",t.resetHeight(u)}t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.resetHeight=function(e){var t=this;switch(e){case 0:t.height=t.div_des.y+t.div_des.contextHeight+100;break;case 1:t.lb_title2.y=t.div_des.y+t.div_des.contextHeight+15,t.div_des2.y=t.lb_title2.y+40,t.height=t.div_des2.y+t.div_des2.contextHeight+100;break;case 2:t.height=t.div_des.y+t.div_des.contextHeight+28}},i.onClickHandler=function(e){this.close(!0)},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.pet.PetSkillTips1UI._$SET_instance),t._instance=null,t}(),eK=function(e){function t(){var e=this;e._buffId=0,e._buffIcon=null,t.__super.call(e),e._buffIcon=new Kl,e._buffIcon.width=e._buffIcon.height=105,e._buffIcon.pos(e.img_icon.x+5,e.img_icon.y+5),e.addChild(e._buffIcon)}b(t,"modules.pet.views.PetSkillTip2",Nh);var i=t.prototype;return i.show=function(e){var t=this;if(e){if("string"==typeof e)t._buffId=parseInt(e);else{var i=parseInt(Ah.MODEL.roleBuffs(modules.pet.others.PetDataModel.ins().getColorIndexByPro(e.petId,e.petColor)));i&&(t._buffId=i)}var n=Ls.getIndex(t._buffId);t.txt_name.changeText(Ls.MODEL.skillName(n)),t.div_des.innerHTML=Ls.MODEL.skillDesc(n),t._buffIcon.skin=_r.getIconPath(Ls.MODEL.icon(n)),t.height=t.div_des.y+t.div_des.contextHeight+28}t.parent||(eq.panelLayer.on("MASK_CLOSE",t,t.onClick),eq.panelLayer.openTip(t))},i.onClickHandler=function(e){this.close(!0)},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this)},p(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.pet.PetSkillTips2UI._$SET_instance),t._instance=null,t}(),tK=function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.preview.views.PreviewView",Kh);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.update()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clear(this,this.onUpdateTime)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){e.target},i.close=function(){hN.ins._closePanelForce(this)},i.update=function(){Jh.getInStance().toc12003;var e,t=CN.iconData;for(var i in t.icons2)if(37==(e=t.icons2[i]).iconId){var n=e.time;G.timer.clear(this,this.onUpdateTime),G.timer.loop(1e3,this,this.onUpdateTime,[n]),this.onUpdateTime(n)}var s=io.getIndex(Jh.getInStance().toc12003.showId),o=io.MODEL.interfaceResource(s);this.img_bg1.skin=_r.getAtlasSubPath("preview/bg/"+o+"_1.jpg"),this.img_bg2.skin=_r.getAtlasSubPath("preview/bg/"+o+"_2.jpg"),this.img_title.skin=_r.getAtlasSubPath("preview/title/"+o+".png")},i.onUpdateTime=function(e){var t=e-dr.serverTimeSec;t<0?this.close():this.div_leave.innerHTML=RP.n[1035]+Ql.createColor(Jp.getHMSTimeString(t),"#23b11f")},t}(),iK=function(e){function t(){this._eff=null,this._grids=null,t.__super.call(this),this.centerX=0,this.centerY=-100,this.initUI()}b(t,"modules.recharge.views.EveryRechargeV",wa);var i=t.prototype;return i.initUI=function(){var e=this;e._grids=[],e.btn_close.clickHandler=ql.create(e,e.onClose,null,!1),e.btn_recharge.clickHandler=ql.create(e,e.onRecharge,null,!1),e.btn_get.clickHandler=ql.create(e,e.onRecharge,null,!1)},i.onClose=function(){hN.ins._closePanelForce(this)},i.onRecharge=function(){var e=HN.ins.toc_every;if(null!=e){var t=0;for(var i=0 in e.showArray)if(1==e.showArray[i]){t=i;break}if(0<t){var n=new WA;n.cfgId=t,Tu.sendToService(n)}else Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),$U.reqRecharge()},i.destroy=function(e){void 0===e&&(e=!0),this._eff&&(this._eff.dispose(),this._eff=null),laya.ui.View.prototype.destroy.call(this,e)},i.update=function(){var e=this,t=HN.ins.toc_every;if(null!=t){var i=-1,n=0,s=0,o=0;for(var a=0 in t.showArray)1==t.showArray[a]&&0==n?n=a:0==t.showArray[a]&&0==s&&(s=a),o=a;0<n?(i=Kt.getIndex(n),e.clip_gold.value="0",e.btn_recharge.visible=!1,e.btn_get.label=RP.n[1036],e.btn_get.visible=!0,e.btn_get.disabled=!1,null==e._eff&&(e._eff=mj.GetNew(),e._eff.loadEffect("jm1242"),e._eff.renderInSelf=!0,e.addChild(e._eff)),e._eff.setXY(366,525)):(e._eff&&(e._eff.dispose(),e._eff=null),0==s?(e.clip_gold.value="0",e.btn_get.visible=!0,e.btn_get.label="已领取",e.btn_get.disabled=!0,e.btn_recharge.visible=!1,i=Kt.getIndex(o)):(i=Kt.getIndex(s),e.clip_gold.value=Kt.MODEL.totalGold(i)-t.gold+"",e.btn_recharge.visible=!0,e.btn_get.visible=!1));for(var r=Kt.MODEL.rechargeReward(i).split(";"),l=0;l<4;l++){var c=e._grids[l];if(l<r.length){null==c&&((c=new MF).pos(e["img_grid"+l].x,e["img_grid"+l].y),e.addChild(c),e._grids[l]=c);var u=r[l].split(","),d=parseInt(u[0]),h=parseInt(u[1]),_=yB.create(d,h);_.disAchi=!1,c.bindData=_,c.visible=!0,e["txt_name"+l].changeText(Bi.MODEL.simpleName(_.cfgIdx)),e["txt_name"+l].color=ms.getByQuality(Bi.MODEL.colourId(_.cfgIdx))}else c&&(c.visible=!1),e["img_grid"+l].visible=!1,e["txt_name"+l].changeText("")}}},t}(),nK=function(e){function i(){var e=this;e._eff=null,e._effId="",i.__super.call(e),e.pos(106,616);var t=gR.ins.actorList[0];t.job==ha.ZHAN.type?e._effId="jm1428":t.job==ha.FA.type?e._effId="jm1428":t.job==ha.DAO.type&&(e._effId="jm1428"),e.img_bg.skin=_r.getNoClearImage("cz_sctc"),e.on("click",e,e.onClick)}b(i,"modules.recharge.views.FirstPayPop",Va);var t=i.prototype;return t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._eff=kB.createEffect(this._effId,189,170,this),this._eff.autoClear=!1;var t=CN.getIconBtn(28);if(null!=t){var i=t.localToGlobal(new Uh(0,0));this.pos(i.x+80,i.y-10)}},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this._eff&&this._eff.dispose(),this._eff=null},t.updatePos=function(){var e=CN.getIconBtn(28);if(null!=e){var t=e.localToGlobal(new Uh(0,0));this.pos(t.x+80,t.y-10)}else hN.ins._closePanelForce(this)},t.onClick=function(){hN.ins.close("FIRST_PAY"),Tu.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"])},i}(),sK=function(e){function t(){this.BAR_W,t.__super.call(this),this.mouseThrough=!0,this.initUI()}b(t,"modules.recharge.views.RechargeSubV",c_);var i=t.prototype;return i.initUI=function(){this.list_recharge.array=[],this.list_recharge.renderHandler=ql.create(this,this.onItemRender,null,!1),this.list_recharge.selectEnable=!0,this.list_recharge.vScrollBarSkin=""},i.onSelectRender=function(e){var t=this.list_recharge.array[e];t<0||t>=Ln.count||EB.pay(1,Ln.MODEL.key(t))},i.onRecharge=function(){var e=this.list_recharge.selectedIndex;e<0||e>=Ln.count||EB.pay(1,Ln.MODEL.key(e))},i.onItemRender=function(e,t){var i=this.list_recharge.array[t];e.img_icon.skin=_r.getAtlasSubPath("recharge/cz_czyb_icon_"+(t+1)+".png");var n=HN.ins.getShowMoney(i),s=Ln.MODEL.key(i);if(-1!=n){e.visible=!0,e.txt_money.changeText("￥"+n),this.list_recharge.selectedIndex==t?(0==e.img_select.visible&&this.onSelectRender(t),this.list_recharge.selectedIndex=-1,e.img_select.visible=!0):e.img_select.visible=!1;var o=HN.ins.getShowGold(i),a=0;null!=HN.ins.toc_recharge&&(a=HN.ins.toc_recharge.hasGets[s]),1==a?e.img_double.visible=!1:0<dr.iosCheck?e.img_double.visible=!1:(e.img_double.visible=!0,o*=2),e.clip_cost.total,e.clip_cost.value=o+"",e.clip_cost.runCallLater(e.clip_cost.changeValue),e.clip_yb.x=21*e.clip_cost.value.length-1,e.clip_cost.width=21*e.clip_cost.value.length+54}else e.visible=!1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_vip.on("click",t,t.onClick),t.update(),t.list_recharge.selectedIndex=-1;var i=new $M;Tu.sendToService(i),t.parent.parent.addChild(t.box_top),t.BAR_W=t.img_progBar.width,t.setRateBar(),t.clip_vip.value="0"},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_vip.off("click",this,this.onClick),this.parent.parent.removeChild(this.box_top)},i.onClick=function(e){switch(e.target){case this.btn_vip:Tu.sendToModule("OPEN_PANEL",["modules.vip.VipModule"])}},i.update=function(){for(var e=!1,t=0;t<Ln.count;t++)if(3e5==Ln.MODEL.gold(t)){var i=Ln.MODEL.key(t),n=0;null!=HN.ins.toc_recharge&&(n=HN.ins.toc_recharge.hasGets[i]),e=1==n;break}var s=[];for(t=0;t<Ln.count;t++)if(1==Ln.MODEL.type(t)){if(dr.nativeIOS&&-1==Ln.MODEL.money_ios(t))continue;if(!e&&3e5<Ln.MODEL.gold(t))continue;s.push(t)}this.list_recharge.array=s,this.list_recharge.scrollTo(s.length-1),this.refreshVip()},i.refreshVip=function(){var e=Wg.ins.toc_info;if(null!=e){if(10<=e.vipLvl)this.div_desc.innerHTML=RP.n[1037],this.setRateBar(1),this.txt_progress.text=e.cost+"/MAX";else{var t=_o.getIndex(e.vipLvl+1),i=_o.MODEL.needGold(t);this.div_desc.innerHTML="再充值"+Ql.createColor(i-e.cost+"","#e0d6c1")+RP.n[1038]+Ql.createColor("VIP"+(e.vipLvl+1),"#e6d80d"),this.setRateBar(e.cost/i),this.txt_progress.text=e.cost+"/"+i}this.clip_vip.value=e.vipLvl+""}},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.img_progBar.scrollRect||new u_(0,0,this.img_progBar.width,this.img_progBar.height);t.width=this.BAR_W*e,this.img_progBar.scrollRect=t},t}(),oK=function(e){function t(){this._list=[aa.ATK,aa.MAXHP,aa.DEF,aa.MDEF,aa.GDR_ONE_HIT_RATE,aa.GDR_ONE_HIT_RATE_REDUCE],this._total=0,this._actorId=0,this._wBox=null,t.__super.call(this),this.init()}b(t,"modules.resonate.tips.ResonateAttrDetailTip",y_);var i=t.prototype;return i.show=function(e){this._total=gR.ins.actorList.length,this.showValue(e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._wBox.graphics.clear(),this._actorId=-1},i.init=function(){this.btnL.mouseEnabled=!0,this.btnR.mouseEnabled=!0,this._wBox=new dt,this._wBox.x=30,this._wBox.y=112,this.addChild(this._wBox)},i.onClick=function(e){var t=gR.ins.actorById(this._actorId),i=gR.ins.actorList.indexOf(t);e.target==this.btnL?(i-=1,this.showIndex(i)):e.target==this.btnR&&(i+=1,this.showIndex(i))},i.showIndex=function(e){var t=gR.ins.actorList[e];this.showValue(t.id)},i.showValue=function(e){var t=this,i=t._list.length;t._actorId=e;var n=gR.ins.actorById(t._actorId);t._wBox.graphics.clear();var s,o,a=[];o=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",s=G.loader.getRes(o);for(var r=0;r<i;r++)a[2*r]=-20,a[2*r+1]=2+42*r;t._wBox.graphics.drawTextures(s,a);var l,c=VN.ins.getActorResonateData(t._actorId),u=[];if(null!=c){var d;for(r=0;r<8;r++){var h,_=c[r];if(null!=(d=UN.getChineseAttrByLevel(_,r))&&0!=d.length)for(var f in d)h=d[f],u.hasOwnProperty(h.id)?u[h.id]+=parseFloat(h.val):u[h.id]=parseFloat(h.val)}}var p=0;for(r=0;r<i;r++){var g=(l=t._list[r]).attrName,v="0";if(u.hasOwnProperty(l.id)){if(null==aa.getAttributById(l.id))continue;v=u[l.id].toString()}t._wBox.graphics.fillText(g+"：",190,4+42*p,"24px SimHei","#90877b","right"),l.isPer&&(v+="%"),t._wBox.graphics.fillText(v,193,4+42*p,"24px SimHei","#e0d6ca","left"),p++}for(r=1;r<=3;r++)t["mcJob_"+r].visible=n.job==r;t.showLR()},i.showLR=function(){var e=this,t=gR.ins.actorById(e._actorId),i=gR.ins.actorList.indexOf(t);1==e._total?(e.btnL.visible=!1,e.btnR.visible=!1):0==i?(e.btnL.visible=!1,e.btnR.visible=!0):i+1==e._total?(e.btnL.visible=!0,e.btnR.visible=!1):(e.btnL.visible=!0,e.btnR.visible=!0)},t.GAP=42,t.START_PY=2,t.START_TY=4,t}(),aK=function(e){function t(){this._level=0,this._actorId=0,this._errorCode=0,this._isNeedActive=!1,this._btnEff=null,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.resonate.tips.ResonateSkillTip",I_);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),null!=this._btnEff&&(this._btnEff.removeSelf(),this._btnEff.dispose(),this._btnEff=null),this._errorCode=0},i.updateView=function(){this.show(this._actorId,this._level,this._isNeedActive)},i.show=function(e,t,i){var n=this;void 0===i&&(i=!1),n._errorCode=0,null!=n._btnEff&&(n._btnEff.removeSelf(),n._btnEff.dispose(),n._btnEff=null),n._actorId=e,n._level=t,n._isNeedActive=i;var s=507;if(n.cur.visible=!1,0<n._level&&(s+=44,n.cur.visible=!0,n.div_cur.innerHTML=UN.getLevelEffect(n._level),s+=n.div_cur.contextHeight),s+=20,n.lbl_name.changeText(UN.getLevelName(Math.max(1,n._level))),n.next.visible=!1,n.txt_disableTip.visible=!1,n._level<UN.MAX_LEVEL){n.next.visible=!0,n.img_max.visible=!1,n.div_next.innerHTML=RP.n[1039]+UN.getLevelEffect(n._level+1);for(var o="",a=VN.ins.getActorResonateData(n._actorId),r=0;r<8;r++){0<r&&(o+="&nbsp;");var l=la.getResonateName(r),c=0;null!=a&&(c=a[r]);var u=c>=n._level+1?"#23b11f":"#90877b";o+=Ql.createColor(l,u)}n.div_suit.innerHTML="[&nbsp;"+o+"&nbsp;]",n.txt_disableTip.visible=!0,n.txt_disableTip.y=s-10,n.txt_disableTip.innerHTML=RP.n[1040]+(n._level+1)+RP.n[1041],s+=n.txt_disableTip.height,s+=20,n.next.y=s-75,s+=50+n.div_next.contextHeight}else n.img_max.visible=!0;s+=20,n.btn_active.visible=n._isNeedActive,n.btn_active.gray=!UN.isAbleGrowSkill(n._actorId),n.btn_active.label=0==t?"激 活":"升 级",n.btn_active.gray&&(n._errorCode=1),n._isNeedActive&&(s+=109,n.btn_active.gray||null==n._btnEff&&(n._btnEff=kB.createEffect("jm1130",n.btn_active.width>>1,n.btn_active.height>>1,n.btn_active),n._btnEff.scale_X=1.25,n._btnEff.scale_Y=1.25),n.img_max.visible=!1),n.img_max.visible&&!n.btn_active.visible&&(s+=109),n.height=s},i.onClick=function(e){switch(e.target){case this.btn_active:if(this.btn_active.gray){switch(this._errorCode){case 1:zB.ins.showMsg(RP.n[1042],1)}return}GN.reqGrowSkill(this._actorId),hN.ins.close("RESONATE_SKILL_TIP")}},t}(),rK=function(e){function t(){var e=this;e._selector=null,e._moEquip=null,e._soaringEquip=null,e._cost=null,e._dots=null,e._selectImage=null,e._curSelectPart=-1,e._curActorId=-1,e._curPosLevel=-1,e._lastActiveNum=-1,e._lastSkillLevel=-1,e._attrInfo=null,e._isPlaySucceed=!1,e._btnEff=null,e._gongmingEff=null,e._circleEff=null,e._soaringEquipEff=null,e._moEquipEff=null,e._eff1447=null,e.MAX_SUIT=8,t.__super.call(e),e.init()}b(t,"modules.resonate.views.ResonateView",w_);var i=t.prototype;return G.imps(i,{"modules.resonate.views.IResonateView":!0}),i.init=function(){var e,t=this;t._selector=new Nj,t._selector.redptHandler=ql.create(t,t.needRedpt,null,!1),t.addChild(t._selector),t._selectImage=new Kl(_r.getAtlasSubPath("basic_ui/ty_gz_xzzt.png")),t._selectImage.size(116,116),t._attrInfo=new dt,t.info.addChild(t._attrInfo),t._moEquip=new MF,t._moEquip.toolTipEnabled=!1,t.equipMo.addChildAt(t._moEquip,1),t._soaringEquip=new MF,t._soaringEquip.toolTipEnabled=!1,t.equipSoaring.addChildAt(t._soaringEquip,1),t._cost=new MF(45),t._cost.needGridBg=!1,t._cost.needEffect=!1,t._cost.pos(61,-10),t.cost.addChild(t._cost),t._gongmingEff=[];for(var i=0;i<8;i++){(e=t["equip"+i]).g_icon.skin=_r.getResonateEquipIconPath(i);var n=kB.createText(e.x,e.y+116+2,116,0,la.getResonateName(i),20,"#90877b",!1,"center",!1,!1,t);t.addChild(n)}t._eff1447=kB.createEffect("jm1447",t.skill.width/2,t.skill.height/2,t.skill),t._dots=[]},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.txt_help.on("click",t,t.onClick),t.skill.on("click",t,t.onClick),t._selector.invalid(),t._selector.on("select",t,t.onSelectActor);var i=t._selector.selectIdx+1;t.updateEquip(),t.showPartEquip(i,0)},i.onRemove=function(e){var t,i=this;for(var n in ui.ViewBase.prototype.onRemove.call(i,e),i.off("click",i,i.onClick),i.txt_help.off("click",i,i.onClick),i.skill.off("click",i,i.onClick),i._selector.off("select",i,i.onSelectActor),i._attrInfo.graphics.clear(),i._lastActiveNum=-1,i._lastSkillLevel=-1,i._curSelectPart=-1,i._curActorId=-1,i._curPosLevel=-1,i._isPlaySucceed=!1,null!=i._btnEff&&(i._btnEff.removeSelf(),i._btnEff.dispose(),i._btnEff=null),null!=i._circleEff&&(i._circleEff.removeSelf(),i._circleEff.dispose(),i._circleEff=null),null!=i._soaringEquipEff&&(i._soaringEquipEff.removeSelf(),i._soaringEquipEff.dispose(),i._soaringEquipEff=null),null!=i._moEquipEff&&(i._moEquipEff.removeSelf(),i._moEquipEff.dispose(),i._moEquipEff=null),i._gongmingEff)(t=i._gongmingEff[n]).removeSelf(),t.dispose(),t=null;i._gongmingEff=[],G.timer.clear(i,i.onResetPartEquip)},i.onClick=function(e){var t=this,i=t._selector.selectIdx+1;switch(e.target){case t.txt_help:case t.btn_help:var n=Vi.getIndex(11),s=Vi.MODEL.description(n);hN.ins.open("AE_EXPLAIN_VIEW",{desc:s});break;case t.btn_upgrade:if(t.btn_upgrade.gray){switch(UN.disableGrowLevelCode(i,t._curSelectPart)){case 1:zB.ins.showMsg(RP.n[1043],1);break;case 2:zB.ins.showMsg(RP.n[1044],1);break;case 3:zB.ins.showMsg(RP.n[1045],1);break;case 4:zB.ins.showMsg(RP.n[566],1)}return}GN.reqGrowActor(i,t._curSelectPart);break;case t.skill:var o={actorId:i,level:t._lastSkillLevel,isNeedActive:t._lastSkillLevel<UN.MAX_LEVEL};hN.ins.open("RESONATE_SKILL_TIP",o);break;case t.btn_detail:hN.ins.open("RESONATE_ATTR_DETAIL_TIP",i);break;case t._soaringEquip:case t._moEquip:}for(var a=0;a<t.MAX_SUIT;a++)if(t["equip"+a]==e.target){t.showPartEquip(t._curActorId,a);break}},i.onSelectActor=function(e){this._lastActiveNum=-1,this._lastSkillLevel=-1,this.updateEquip();var t=this._selector.selectIdx+1;this.showPartEquip(t,0)},i.refresh=function(){this.updateEquip();var e=this._selector.selectIdx+1;this.showPartEquip(e,this._curSelectPart),this._selector.invalid()},i.updateGoods=function(){this.refresh()},i.showPartEquip=function(e,t){var i=this;G.timer.clear(i,i.onResetPartEquip),null!=i._btnEff&&(i._btnEff.removeSelf(),i._btnEff.dispose(),i._btnEff=null),null!=i._circleEff&&(i._circleEff.removeSelf(),i._circleEff.dispose(),i._circleEff=null),null!=i._soaringEquipEff&&(i._soaringEquipEff.removeSelf(),i._soaringEquipEff.dispose(),i._soaringEquipEff=null),null!=i._moEquipEff&&(i._moEquipEff.removeSelf(),i._moEquipEff.dispose(),i._moEquipEff=null),i["equip"+t].addChildAt(i._selectImage,2);var n=0,s=VN.ins.getActorResonateData(e);if(null!=s&&(n=s[t]),i._isPlaySucceed=!1,i._curSelectPart==t&&i._curActorId==e&&i._curPosLevel<n)return i._isPlaySucceed=!0,i.btn_upgrade.disabled=!0,kB.createEffect("jm1440",363,499,i),G.timer.once(800,i,i.onResetPartEquip),void(i._curPosLevel=n);i.btn_upgrade.disabled=!1,i._curSelectPart=t,i._curActorId=e,i._curPosLevel=n;var o=UN.MAX_LEVEL,a=Math.min(UN.MAX_LEVEL,n+1),r=a,l=UN.getSoaringSuitShowEquip(e,t,r),c=UN.getMoSuitShowEquip(e,t,r);if(i._soaringEquip.bindData=l,i._moEquip.bindData=c,i.equipSoaring.txt_level.text=mp.getChineseNum(r)+"阶",i.equipMo.txt_level.text=mp.getChineseNum(r)+"阶",i.shen.visible=!1,i.mo.visible=!1,null!=s){var u=UN.getSoaringSuitShowEquip(e,t).positionLevel,d=UN.getMoSuitLevel(e,t);(n<u||u>=UN.MAX_LEVEL)&&(i.shen.visible=!0),(n<d||d>=UN.MAX_LEVEL)&&(i.mo.visible=!0),i.shen.visible&&i.mo.visible&&null==i._circleEff&&(i._circleEff=kB.createEffect("jm1439",363,499,i)),i.shen.visible&&null==i._soaringEquipEff&&(i._soaringEquipEff=kB.createEffect("jm1409",i._soaringEquip.width/2,i._soaringEquip.height/2,i._soaringEquip)),i.mo.visible&&null==i._moEquipEff&&(i._moEquipEff=kB.createEffect("jm1391",i._moEquip.width/2,i._moEquip.height/2,i._moEquip))}i._attrInfo.graphics.clear();var h=yc.getRes(_r.getAtlasSubPath("basic_ui_g/ty_sxjm_wzd.png")),_=UN.getChineseAttrByLevel(n,t),f=UN.getChineseAttrByLevel(a,t),p=0,g="#90877b",v=0,m=0;if(i.cur.changeText(RP.n[1047]),0==n){var y;for(var I in p=0,i.arrow.visible=!1,f)y=f[I],v=40,m=58+p,g="#23b11f",i._attrInfo.graphics.drawTexture(h,v,m,236,34),i._attrInfo.graphics.fillText(y.name+":"+y.val,v,m+5,"24px SimHei",g,"left"),p+=44;i.cur.x=99,i.cur.changeText(RP.n[1048]),i.cur_line.x=40,i.info.width=312}else if(o<=n){for(I in p=0,i.arrow.visible=!1,i.img_max.visible=!0,_)y=_[I],v=40,m=58+p,i._attrInfo.graphics.drawTexture(h,v,m,236,34),i._attrInfo.graphics.fillText(y.name+":"+y.val,v,m+5,"24px SimHei",g,"left"),p+=44;i.cur.x=99,i.cur_line.x=40,i.info.width=312}else{for(I in p=0,i.arrow.visible=!0,_)y=_[I],v=15,m=58+p,i._attrInfo.graphics.drawTexture(h,v,m,236,34),i._attrInfo.graphics.fillText(y.name+":"+y.val,v,m+5,"24px SimHei",g,"left"),p+=44;for(I in p=0,f)y=f[I],v=306,m=58+p,g="#23b11f",i._attrInfo.graphics.drawTexture(h,v,m,140,34),i._attrInfo.graphics.fillText(y.val,v+120,m+5,"24px SimHei",g,"right"),p+=44;i.cur.x=63,i.cur_line.x=7,i.info.width=452}if(n<o){i.cost.visible=!0,i.img_max.visible=!1;var b=UN.getMaterials(e,t,r);if(null!=b&&0<b.length){var w=b[0].value,x=parseInt(w.split(":")[0]),S=parseInt(w.split(":")[1]),k=TR.ins.getGoodsNum(x);i._cost.bindData=yB.create(x,1);var E=S<=k;i.div_cost.innerHTML=Ql.createColor(k.toString(),E?"#23b11f":"#ff2e24")+"/"+S}}else i.cost.visible=!1,i.img_max.visible=!0;var T=UN.isAbleGrowPosition(e,t);i.btn_upgrade.gray=!T,i.btn_upgrade.label=0<n?"升 级":"激 活",!i.btn_upgrade.gray&&i.cost.visible&&null==i._btnEff&&(i._btnEff=kB.createEffect("jm1130",i.btn_upgrade.width>>1,i.btn_upgrade.height>>1,i.btn_upgrade),i._btnEff.scale_X=1.25,i._btnEff.scale_Y=1.25)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),null!=this._eff1447&&(this._eff1447.removeSelf(),this._eff1447.dispose()),this._eff1447=null},i.onResetPartEquip=function(){kB.createEffect("jm1426",G.stage.width/2,G.stage.height/2,eq.panelLayer);var e=this._selector.selectIdx+1;this.showPartEquip(e,this._curSelectPart)},i.updateEquip=function(){var e,t=this,i=t._selector.selectIdx+1,n=(gR.ins.actorById(i),VN.ins.getActorResonateData(i));if(null==n)return t.defaultEquipShow(),void t.defaultSkillShow();for(var s=n.level,o=(UN.BUFF_IDS[Math.max(s,1)-1],0),a=UN.ableGrowPositions(i),r=0;r<t.MAX_SUIT;r++){e=t["equip"+r],t._dots[r]||(t._dots[r]=kB.createSprite(NI.POINT,e.x+85,e.y-13,0,0,t));var l=n[r];e.txt_level.text=mp.getChineseNum(Math.max(l,1))+"阶",e.g_icon.filters=null,0==l&&(e.g_icon.filters=A_.getGrayFilter4()),e.g_bg.visible=0<l;var c=t._gongmingEff[r];0<l&&o++,t._dots[r].visible=!1,-1!=a.indexOf(r)&&(t._dots[r].visible=!0),UN.isAbleGrowPosition2(i,r)?(null==c&&(c=kB.createEffect("jm1438",e.width/2,e.height/2,e),t._gongmingEff[r]=c),c.visible=!0):null!=c&&(c.visible=!1)}var u=0;t._lastActiveNum<o&&t._lastActiveNum,t._lastSkillLevel<s&&-1!=t._lastSkillLevel&&kB.createEffect("jm1426",G.stage.width/2,G.stage.height/2,eq.panelLayer),t._lastActiveNum=o,t._lastSkillLevel=s,UN.isAbleGrowSkill(i)&&(u=1),t.skill.showTip=1==u,t.fightNum.value=UN.getFightNum(i)},i.defaultSkillShow=function(){var e=this._selector.selectIdx+1;gR.ins.actorById(e),UN.BUFF_IDS[0];this._lastSkillLevel=0},i.defaultEquipShow=function(){for(var e,t=0;t<this.MAX_SUIT;t++)e=this["equip"+t],this._dots[t]||(this._dots[t]=kB.createSprite(NI.POINT,e.x+85-e.width/2,e.y-13-e.height/2,0,0,this)),this._dots[t].visible=!1,e.txt_level.text="一阶",e.g_bg.visible=!1,e.g_icon.gray=!0;this.fightNum.value=0},i.needRedpt=function(e){var t=e.id,i=UN.ableGrowPositions(t),n=UN.isAbleGrowSkill(t);return 0<i.length||n},i.setGray=function(e,t){if(t){var i=[];i=(i=(i=(i=i.concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([0,0,0,1,0]);var n=new ys(i);e.filters=[n]}else e.filters=[]},t}(),lK=function(e){function t(){var e=this;e._orgX=0,e._orgY=355,e._handEff=null,e.tween1=null,e.tween2=null,e.tween3=null,e.tween4=null,e.titleTween=null,e.ballTween=null,e.imgScess=null,e._data=0,e.isOver=!1,e._bindData=0,e._recordTime=NaN,t.__super.call(e),e.centerX=e.centerY=0,e.imgScess=new Kl,e.imgScess.skin="",e.addChild(e.imgScess)}b(t,"modules.skill.views.InnerActivedShowView",ec);var i=t.prototype;return i.onAdd=function(e){var t=this;t.isOver=!1,t.txtRingName.scale(0,0),t.txt_name_bg.scale(0,0),t.ball.y=355,t.ball.size(288,354),t.ball.scale(0,0),t.onEffectComplete(),t.on("click",t,t.onClickViewListener)},i.onRemove=function(e){var t=this;t.off("click",t,t.onClickViewListener),t.tween1&&t.tween1.clear(),t.tween2&&t.tween2.clear(),t.tween3&&t.tween3.clear(),t.ballTween&&t.ballTween.clear(),t.titleTween&&t.titleTween.clear(),t._handEff&&(t._handEff.parent&&t._handEff.parent.removeChild(t._handEff),t._handEff.dispose(),t._handEff=null)},i.getRingPoint=function(){return sJ.ins.getCompomentsByName("NavBottom").btnBag.localToGlobal(new Uh(45,45))},i.onClickViewListener=function(e){this.onClick()},i.onClick=function(){0!=this.isOver&&hN.ins.close("NEIGONG_ACTIVED_SHOW_VIEW")},i.onComposeShow=function(){var e=this;e.graphics.clear(),e.graphics.drawRect(0,0,e.width,e.height,"#000000"),UB.ins.playSound("23",3,!0),e._bindData=e._data,null==e.ballTween&&(e.ballTween=new Og),e.ballTween.to(e.ball,{scaleX:1,scaleY:1},200,pa.linearIn,ql.create(e,e.showHandler)),e.onComposeShowRingName()},i.showHandler=function(){var e=this;null==e.titleTween&&(e.titleTween=new Og),e.ball.y=e._orgY,e.ball&&(e.titleTween=Og.to(e.ball,{y:e._orgY-5},500,null,ql.create(e,e.shareHandler)))},i.shareHandler=function(){var e=this;e.ball.y==e._orgY-5?e.titleTween=Og.to(e.ball,{y:e._orgY+10},1e3,null,ql.create(e,e.shareHandler)):e.ball.y==e._orgY+10?e.titleTween=Og.to(e.ball,{y:e._orgY},500,null,ql.create(e,e.shareHandler)):e.ball.y==e._orgY&&(e.titleTween=Og.to(e.ball,{y:e._orgY-5},500,null,ql.create(e,e.shareHandler)))},i.showHandEff=function(){var e=this;null==e._handEff&&(e._handEff=kB.createEffect("jm1034",484,399,e)),e._handEff.scaleX=e._handEff.scaleY=1.2,e._handEff.alpha=0,null!=e.tween4?e.tween4.clear():e.tween4=new Og,e.tween4=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onComposeShow))},i.onComposeShowRingName=function(){null==this.tween2&&(this.tween2=new Og),this.tween2.to(this.txtRingName,{x:176,scaleX:1,scaleY:1},500,pa.linearIn),null==this.tween3&&(this.tween3=new Og),this.tween3.to(this.txt_name_bg,{x:168,scaleX:1,scaleY:1},500,pa.linearIn),this.isOver=!0},i.onEffectComplete=function(){this.box_active.alpha=0,null==this.tween1&&(this.tween1=new Og),this.tween1.to(this.box_active,{alpha:1},500,pa.linearIn,ql.create(this,this.showHandEff))},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t.HANDEFFID="jm1034",t}(),cK=function(e){function t(){var e=this;e.START_ANGLE=153,e._selector=null,e._curRoleIndex=0,e._curIcons=null,e._curEffs=null,e.EFFECT_ORIGIN_Y=28,e._ballValue=1,e._tweenerBall=null,e._ballTop=null,e._ballMask=null,e._loopTime=0,e._lastExp=-1,e._lastLevel=-1,e._lastJie=-1,e._lastChong=-1,e._maskLevel=null,e._delayIcons=[],e._needActive=!1,e._lastPlayerId=-1,e._bigFireEffect=null,e._activeBtnEffect=null,t.__super.call(e)}b(t,"modules.skill.views.InnerView",oc);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e._curIcons=[];for(var t=0;t<10;t++){var i=e["pear"+t];i.index=0,e._curIcons[t]=i}e.img_max.visible=!1,e.txt_chong.value="0",e.cost_hdv.style.align="center",e.cost_hdv.style.valign="middle",e.cost_hdv.style.font="SimHei",e.cost_hdv.style.fontFamily="SimHei",e.cost_hdv.style.fontSize=24,e.cost_hdv.style.color="#e41b00";var n=parseInt($e.MODEL.value($e.getIndex(91)));e.txt_openTip.text=RP.n[1049]+(n+1)+RP.n[1050],e.img_redPoint.visible=!1,e.txt_exp.visible=!1,null==e._maskLevel&&(e._maskLevel=new BF,e._maskLevel.size(e.imgProgress.width,e.imgProgress.height),e.imgProgress.mask=e._maskLevel,e._maskLevel.alpha=.5),e._ballMask=new pp,e._ballMask.graphics.drawCircle(0,62,62,"#f00"),e._ballMask.y=-33,e._ballMask.x=-2},i.onAdd=function(e){nc.reqInnerAttrPillList()},i.updateByVSC=function(e){this.updateView()},i.updateView=function(){var e=this;if(e.showRedPoint(),null!=e._activeBtnEffect&&(e._activeBtnEffect.removeSelf(),e._activeBtnEffect.dispose(),e._activeBtnEffect=null),!tB.ins.isActived(e._curRoleIndex))return e.spr_attr.visible=!1,e.noActive.visible=!0,e.chong.visible=!1,e.icons.visible=!1,e.upgrade.visible=!1,e.fight_value.visible=!1,e._ballTop.visible=!1,e.img_effect.visible=!1,e.img_fire.visible=!0,e.btn_attrd.visible=e.img_attrdRed.visible=!1,null!=e._bigFireEffect&&(e._bigFireEffect.visible=!1),null==e._activeBtnEffect&&(e._activeBtnEffect=kB.createEffect("jm1130",e.btn_active.width>>1,e.btn_active.height>>1,e.btn_active),e._activeBtnEffect.scale_X=1.25,e._activeBtnEffect.scale_Y=1.25),e._needActive=!0,void(e._lastPlayerId=e._curRoleIndex);e._needActive&&e._lastPlayerId==e._curRoleIndex&&hN.ins.open("NEIGONG_ACTIVED_SHOW_VIEW"),e._needActive=!1,e.fight_value.visible=!0,e.spr_attr.visible=!0,e._ballTop.visible=!0,e.noActive.visible=!1,e.chong.visible=!0,e.icons.visible=!0,e.upgrade.visible=!0,e.img_fire.visible=!1,e.img_effect.visible=!0,e.btn_attrd.visible=!0,e.img_attrdRed.visible=tB.ins.innerAttrPillCanUpgrade(e._selector.selectIdx+1),null!=e._bigFireEffect&&(e._bigFireEffect.visible=!0),0==e._curRoleIndex&&(e._selector.selectIdx=IH.ins.currentSelectedRole,e._curRoleIndex=e._selector.selectIdx+1);var t,i=-1,n=0,s=0,o=sc.count-1,a=tB.ins.getInnerData(e._curRoleIndex);null!=a&&(i=tB.ins.getInnerUpdateIndex(a.level)),-1!=i&&(n=i),n<o&&(s=n+1);var r,l,c,u=sc.MODEL.level(n),d=sc.MODEL.chong(n),h=u-11*d;e.txt_chong.value=d.toString(),c=JSON.parse(sc.MODEL.attr(n)),t="间隔"+(r=aa.formatNewAttrToObject(c)).DAM_PS_time/1e3+RP.n[1051],e.txt_curReply.text=r.DAM_PS_HP.toString(),e.txt_curReplyDes.text=t,e.txt_curNei.text=r.MAXHD.toString(),e.nei_next.x=e.txt_curNei.x+e.txt_curNei.textWidth+2,e.txt_curDamage.text=(r.HD_DAM_DEC_RATE2/100).toFixed(2)+"%",e.damage_next.x=e.txt_curDamage.x+e.txt_curDamage.textWidth+2,e.txt_curReply.x=e.txt_curReplyDes.x+e.txt_curReplyDes.textWidth+1,e.reply_next.x=e.txt_curReply.x+e.txt_curReply.textWidth+2;var _=!1;for(i in 0==e._maskLevel.levelEndAngle?e.showLevelWithoutTween(h):(e.showTweenLevel(h),h!=e._lastJie&&-1!=e._lastJie&&(_=!0)),0==h?(e._delayIcons=[],e.clearBallEffects()):10==h&&(e._ballTop.visible=!1),e._curIcons){var f=e._curIcons[i];0!=i&&h==parseInt(i.toString())+1&&_?-1==e._delayIcons.indexOf(f)&&(e._delayIcons.push(f),G.timer.once(500,e,e.delayShowEffect,[f,i])):(i<h?-1==e._delayIcons.indexOf(f)&&(f.index=1):f.index=0,-1==e._delayIcons.indexOf(f)&&i<h&&e.showEffect(i))}if(e.showFight(n),0==s){for(i in e.img_max.visible=!0,e.upgrade.visible=!1,e._ballTop.visible=!1,e.nei_next.visible=!1,e.damage_next.visible=!1,e.reply_next.visible=!1,e._curIcons)(f=e._curIcons[i]).index=1,e.showEffect(i);Og.clearAll(e._maskLevel),e.showLevelWithoutTween(10),-1==e._lastExp?e.ballValue=1:e.tweenBallValueTo(1,0),e._lastExp=g,G.timer.clear(e,e.delayShowEffect)}else{var p=sc.MODEL.attr(s);c=JSON.parse(p),(l=aa.formatNewAttrToObject(c)).DAM_PS_time/1e3,e.txt_nextReply.text=l.DAM_PS_HP.toString(),e.txt_nextNei.text=l.MAXHD.toString(),e.txt_nextDamage.text=(l.HD_DAM_DEC_RATE2/100).toFixed(2)+"%",e.nei_next.visible=l.MAXHD>r.MAXHD,e.damage_next.visible=l.HD_DAM_DEC_RATE2>r.HD_DAM_DEC_RATE2,e.reply_next.visible=l.DAM_PS_HP>r.DAM_PS_HP,e.img_max.visible=!1,e.upgrade.visible=!0;var g=0,v=sc.MODEL.copper(n),m=sc.MODEL.exp(n);if(null!=a){var y=(g=a.exp)/m;if(10!=h&&0!=s||(y=1),-1==e._lastExp)e.ballValue=y;else if(-1!=e._lastLevel)if(e._lastLevel<n){e._lastChong<d?(G.timer.clear(e,e.delayShowEffect),e.tweenBallValueTo(y,0)):10!=h?e.tweenBallValueTo(y,0):e.tweenBallValueTo(1,0);e.playOnceEffect("jm1116",360,533,e)}else e.tweenBallValueTo(y,0);e._lastExp=g,e._lastChong=d}else e.ballValue=0;e.txt_exp.text=g+"/"+m;var I=gR.ins.coin;e.cost_hdv.style.color=v<=I?"#e3dcc2":"#e41b00",e.cost_hdv.innerHTML=v.toString();var b=10==h;e.btn_tupo.visible=b,e.btn_up.visible=!e.btn_tupo.visible,e.txt_loopTip.visible=e.btn_up.visible,e.cost_box.visible=!e.btn_tupo.visible}e._lastLevel=n,e._lastJie=h,e.doShowGuide()},i.showByVSC=function(e,t){var i=this;i._selector.refresh(),i._selector.on("select",i,i.onSelectRole),i._selector.selectIdx=IH.ins.currentSelectedRole,i.on("click",i,i.onClick),i._curRoleIndex=i._selector.selectIdx+1,null==i._bigFireEffect&&(i._bigFireEffect=mj.GetNew(),i._bigFireEffect.renderInSelf=!0,i._bigFireEffect.loadEffect("jm1120"),i._bigFireEffect.setXY(i.img_effect.width/2,i.img_effect.height/2),i._bigFireEffect.mouseEnabled=!1,i.img_effect.addChild(i._bigFireEffect)),null==i._ballTop&&(i._ballTop=kB.createEffect("jm1313",137,60,i.effect_ball),i._ballTop.mask=i._ballMask),i.btn_up.on("mousedown",i,i.onMouseDownHandler),i.btn_up.on("mouseup",i,i.onMouseUpHandler),i.btn_up.on("mouseout",i,i.onMouseUpHandler),i.updateView()},i.hideByVSC=function(e,t){var i=this;i._selector.off("select",i,i.onSelectRole),i.off("click",i,i.onClick),null!=i._tweenerBall&&i._tweenerBall.clear(),Og.clearAll(i._maskLevel),G.timer.clear(i,i.delayShowEffect),i._delayIcons=[],i._lastExp=-1,i._lastLevel=-1,i._lastChong=-1,i._lastJie=-1,i._ballValue=-1,i._maskLevel.levelEndAngle=0,i.resetBtnState(),null!=i._bigFireEffect&&(i._bigFireEffect.removeSelf(),i._bigFireEffect.dispose(),i._bigFireEffect=null),null!=i._ballTop&&(i._ballTop.mask=null,i._ballTop.dispose()),(i._ballTop=null)!=i._activeBtnEffect&&(i._activeBtnEffect.removeSelf(),i._activeBtnEffect.dispose(),i._activeBtnEffect=null),i.clearBallEffects(),i.btn_up.off("mousedown",i,i.onMouseDownHandler),i.btn_up.off("mouseup",i,i.onMouseUpHandler),i.btn_up.off("mouseout",i,i.onMouseUpHandler),G.timer.clear(i,i.autoUpgrade)},i.onMouseDownHandler=function(e){this.autoUpgrade(),G.timer.loop(300,this,this.autoUpgrade)},i.onMouseUpHandler=function(){G.timer.clear(this,this.autoUpgrade)},i.autoUpgrade=function(){var e=-1,t=sc.count-1,i=0,n=tB.ins.getInnerData(this._curRoleIndex);null!=n&&(e=tB.ins.getInnerUpdateIndex(n.level)),-1!=e&&(i=e);var s=sc.MODEL.level(i),o=sc.MODEL.chong(i);if(t<=i||1==(10==s-11*o))G.timer.clear(this,this.autoUpgrade);else{var a=sc.MODEL.copper(e);if(gR.ins.coin<a)return this.quickBuyMoney(),void G.timer.clear(this,this.autoUpgrade);nc.reqInnerUpgrade(this._curRoleIndex),UB.ins.playSound("11")}},i.clearBallEffects=function(){if(null!=this._curEffs)for(var e=0 in this._curEffs){var t=this._curEffs[e];t.removeSelf(),t.dispose()}this._curEffs&&(this._curEffs.length=0)},i.showRedPoint=function(){for(var e=-1,t=tB.ins.checkRedPoint(),i=0;i<t.length;i++){var n=1==t[i]||tB.ins.innerAttrPillCanUpgrade(i+1);this._selector.setRedPtByIdx(i,n),n&&-1==e&&(e=i)}return e},i.tweenBallValueTo=function(e,t){var i=this;void 0===t&&(t=0),null!=this._tweenerBall&&this._tweenerBall.clear(),this.ballValue==e&&0==t||(this._loopTime=t,0==this._loopTime?this._tweenerBall=Og.to(this,{ballValue:e},200,null,ql.create(this,this.resetBtnState)):this._tweenerBall=Og.to(this,{ballValue:1},100,null,ql.create(this,function(){i.ballValue=0,i._loopTime=i._loopTime-1,i.tweenBallValueTo(e,i._loopTime)})))},i.resetBtnState=function(){this.btn_tupo.gray=!1,this.btn_up.gray=!1},i.playOnceEffect=function(e,t,i,n){var s=kB.createEffect(e,t,i,n);return s.playEndHandler=ql.create(this,function(e){e.dispose(),e=null},[s],!0),s},i.showBallValue=function(e,t){var i=this;1<t?t=1:t<0&&(t=0),i.img_effect.scrollRect=new u_(-3,i.img_effect.height*(1-t),i.img_effect.width+5,i.img_effect.height*t),i.img_effect.y=e+i.img_effect.height*(1-t);var n=i.img_effect.height*(1-t)+2;i._ballTop.y=27+n,i._ballMask.y=-n,i._ballTop.visible=1!=t},i.showTweenLevel=function(e){var t=this.START_ANGLE+(Math.max(1,e)-1)*(230/9);Og.clearAll(this._maskLevel);var i=new Og;i.to(this._maskLevel,{levelEndAngle:t},500,null,ql.create(this,function(e){e.clear()},[i]))},i.showLevelWithoutTween=function(e){this._maskLevel.showLevelWithoutTween(e)},i.delayShowEffect=function(e,t){e.index=1,this.showEffect(t);for(var i=0;i<t;i++)this.showEffect(i);var n=this._delayIcons.indexOf(e);-1!=n&&this._delayIcons.splice(n,1),this.playOnceEffect("jm1118",e.width/2,e.height/2,e)},i.showFight=function(e){var t=sc.MODEL.attr(e),i=RR.getFight(t,this._curRoleIndex);this.fight_value.value=i},i.showEffect=function(e){var t=this;if(null==t._curEffs&&(t._curEffs=[]),null==t._curEffs[e]){var i=kB.createEffect("jm1119",t._curIcons[e].x+t._curIcons[e].width/2,t._curIcons[e].y+t._curIcons[e].height/2,t.icons);t.icons.addChild(i),t._curEffs[e]=i}},i.onSelectRole=function(){var e=this;IH.ins.currentSelectedRole=e._selector.selectIdx,e._curRoleIndex=e._selector.selectIdx+1,null!=e._tweenerBall&&e._tweenerBall.clear(),Og.clearAll(e._maskLevel),G.timer.clear(e,e.delayShowEffect),e._delayIcons=[],e._lastExp=-1,e._lastLevel=-1,e._lastJie=-1,e._lastChong=-1,e._maskLevel.levelEndAngle=0,e.resetBtnState(),e.clearBallEffects(),null==e._ballTop&&(e._ballTop=kB.createEffect("jm1313",137,60,e.effect_ball),e._ballTop.mask=e._ballMask),e.updateView()},i.onClick=function(e){switch(e.target){case this.btn_tupo:var t=this.currentConfigIndex;-1==t&&(t=0);var i=sc.MODEL.copper(t);gR.ins.coin<i?this.quickBuyMoney():nc.reqInnerUpgrade(this._curRoleIndex),UB.ins.playSound("11");break;case this.btn_active:nc.reqInnerUpgrade(this._curRoleIndex);break;case this.btn_attrd:Tu.sendToModule("INNER_ATTR_PILL_VIEW",["modules.skill.SkillModule"],{roleIndex:this._curRoleIndex})}},i.quickCharge=function(){KQ.ins.showNoGold()},i.quickBuyMoney=function(){HN.ins.reqBuyCoin()},i.doShowGuide=function(){var e=PH.Ins().info;if(e&&2==e.status){if(0<e.getCurrentGuide(24)){var t=new u_;t.x=this.btn_up.x,t.y=this.btn_up.y-6,t.width=this.btn_up.width,t.height=this.btn_up.height,LY.Ins().show(24,t,!1,this.upgrade)}}else e&&0<=e.taskEvent.indexOf("24")&&3==e.status&&0<=e.getCurrentGuide(12)?Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"]):LY.Ins().isShow()&&LY.Ins().close(24)},i.destroy=function(e){void 0===e&&(e=!0),this.bg&&this.bg.skin&&G.loader.clearRes(this.bg.skin),laya.ui.View.prototype.destroy.call(this,e)},p(0,i,"attributeDes",function(){return RP.n[1052]}),p(0,i,"ballValue",function(){return this._ballValue},function(e){this._ballValue!=e&&(this._ballValue=e,this.showBallValue(this.EFFECT_ORIGIN_Y,e))}),p(0,i,"currentConfigIndex",function(){var e=tB.ins.getInnerData(this._curRoleIndex);return null!=e?tB.ins.getInnerUpdateIndex(e.level):-1}),t}(),uK=function(e){function t(){this._data={},this.offY=0,t.__super.call(this)}b(t,"modules.skill.views.item.MijiGetwayItem",Lu);var i=t.prototype;return i.onClick=function(e,t){var i={dtoequ:t[0],getinfo:t[1]};Wj.instance.show(i)},p(0,i,"data",null,function(e){if(null!=e){var t,i=0,n=e;for(1==n[0].level?this.txt_getway.text=RP.n[1053]:2==n[0].level&&(this.txt_getway.text=RP.n[1054]),i=0;i<n.length;i++)(t=new xY).x=9+i%4*140,t.y=76+154*Math.floor(i/4),t.dataSource=n[i],this.addChild(t),this.offY=t.y+150;this.height=this.offY}}),t}(),dK=function(e){function t(){var e=this;e.curRoleIndex=1,e._selector=null,e._mijiHole=-1,e.curSelectRender=null,e.isEnoughUp=!1,e.itemSp=null,e.dataHash=null,e.itemArr=null,e.shineItem=null,e.showIndex=0,e.showCount=0,e.showClip=null,e.nameStr="",e.isEffectTime=0,e.toc_21413=null,e.intervalTime=0,e.stopPosArr=null,e.slowPos=0,e.centerItem=null,e.eff_ok=null,e.isOnceRedpt=[!1,!1,!1],t.__super.call(e)}b(t,"modules.skill.views.MijiMainView",e);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.createChildren=function(){e.prototype.createChildren.call(this),this.mijibg.skin=_r.getFullUrl("ui/images/skill/mj_img_bg.jpg")},i.initialize=function(){var e,t=this;t.stopPosArr=[3,4,5],t._selector=new Nj,t._selector.centerX=0,t._selector.y=60,t.box_c.addChild(t._selector),t._selector.redptHandler=ql.create(t,t.updateSelectorRedpt,null,!1),t.itemSp=new pp,t.box_c.addChildAt(t.itemSp,t.box_c.getChildIndex(t.slock0)-1),t.itemArr=[];for(var i=0;i<8;i++)(e=new MF).needGridBg=!1,e.needEffect=!1,e.name=i+"",e.pos(t["g"+i].x+3,t["g"+i].y+3),t.itemSp.addChild(e),t.itemArr.push(e);t.btn_upgrade.label="放 入",iB.ins.curUpgradeId=0,t.btn_upgrade.clickHandler=ql.create(t,t.onUpgradeBtn,null,!1),t.btn_upgrade0.clickHandler=ql.create(t,t.onGetLearn,null,!1),t.btn_compose.on("click",t,t.onComposeBtn),t.btn_preview.clickHandler=ql.create(t,t.onPreviewBtn,null,!1),t.btn_lock.clickHandler=ql.create(t,t.onLockBtn,null,!1),t.shineItem=[t.smclip0,t.smclip1,t.smclip2,t.smclip3,t.smclip4,t.smclip5,t.smclip6,t.smclip7],t.centerItem=new MF,t.box_c.addChild(t.centerItem),t.centerItem.needGridBg=!1,t.centerItem.needEffect=!1,t.centerItem.toolTipEnabled=!1,t.centerItem.mouseEnabled=!1,t.centerItem.pos(t.btn_upgrade0.x-20,t.btn_upgrade0.y-22),t.centerItem.visible=!1},i.updateByVSC=function(e){var t=this;if(e){if("add"==e)return void(0<iB.ins.curUpgradeId?(t.btn_upgrade.label="镶 嵌",t.btn_upgrade0.showTip=!1,t.centerItem.bindData=yB.create(iB.ins.curUpgradeId),t.centerItem.visible=!0,t.eff_ok||(t.eff_ok=kB.createEffect("jm1130",t.btn_upgrade.width>>1,t.btn_upgrade.height>>1,t.btn_upgrade),t.eff_ok.scale_X=1.25,t.eff_ok.scale_Y=1.25)):(t.eff_ok&&(t.eff_ok.removeSelf(),t.eff_ok.dispose()),t.eff_ok=null));e instanceof protos.skill.Miji_returnUpgrade_21413_toc?(t.isEffectTime=1,t.toc_21413=e,t.showMijiEffect(e)):e instanceof protos.skill.toc_21409&&0==t.isEffectTime&&t.showMijiListByIndex()}else t.showMijiListByIndex(!0);t._selector.invalid(),t.updateAddBtnRP()},i.showMijiEffect=function(e){var t=this;t.showIndex=-1,t.showCount=16+e.postion,t.slowPos=t.showCount-t.stopPosArr[Math.floor(3*Math.random())],t.intervalTime=80,G.timer.once(t.intervalTime,t,t.showEffect),t.eff_ok&&(t.eff_ok.removeSelf(),t.eff_ok.dispose()),t.eff_ok=null},i.showEffect=function(){var e=this;if(e.showIndex>=e.showCount-1)G.timer.once(300,e,e.ClearEffect);else{e.showClip&&(e.showClip.index=1),e.showIndex++,e.showIndex>=e.slowPos&&(e.intervalTime+=200,600<=e.intervalTime&&(e.intervalTime=600));var t=e.showIndex;8<=t&&(t%=8),e.showClip=e.shineItem[t],e.showClip.index=0,G.timer.once(e.intervalTime,e,e.showEffect)}},i.ClearEffect=function(){this.showUpgradeEff(this.toc_21413.postion)},i.showByVSC=function(e,t){var i=this;i._selector.refresh(),i._selector.on("select",i,i.onSelectRole),i.btn_compose.on("click",i,i.onComposeBtn),i._selector.selectIdx=IH.ins.currentSelectedRole,i.curRoleIndex=i._selector.selectIdx,i.showMijiListByIndex(!0),i.updateAddBtnRP()},i.hideByVSC=function(e,t){var i=this;i._selector.off("select",i,i.onSelectRole),i.btn_compose.off("click",i,i.onComposeBtn),i._mijiHole=-1,iB.ins.curUpgradeId=0,i.eff_ok&&(i.eff_ok.removeSelf(),i.eff_ok.dispose()),i.eff_ok=null},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.curRoleIndex=IH.ins.currentSelectedRole;for(var t=gR.ins.actorList,i=0;i<t.length;i++)t[i]&&uf.reqMijiInfo(i+1);this.centerItem.visible=!1},i.onRemove=function(e){hN.ins.isOpen("MIJI_LAOYIN")&&hN.ins.close("MIJI_LAOYIN"),ui.ViewBase.prototype.onRemove.call(this,e)},i.showMijiListByIndex=function(e){var t=this;void 0===e&&(e=!1);var i=0;t.dataHash=iB.ins.mijiHash;var n=t.dataHash.take(t.curRoleIndex+1),s=1;if(n)for(var o=0;o<n.length;o++){var a,r=n[o],l=t.itemArr[o];l.bindData=null,t["slock"+o].visible=1==r.isLock,0!=r.miji_id?(a=yB.create(r.miji_id),l.bindData=a,t["clip"+o].index=0,r.attPower&&(i+=r.attPower)):t["clip"+o].index=1;var c=Qs.MODEL.flyLevel(Qs.getIndex(r.miji_index));t["lock"+o].visible=gR.ins.zsLv<c,t["lock"+o].visible&&1==s?(s=0,t["txt_limit"+o].changeText(c+"转开启")):t["txt_limit"+o].changeText("")}t.fight_item.value=i},i.selectDefault=function(e){G.timer.once(200,this,this.showRedPoint)},i.onScrollComplete=function(){},i.showDetail=function(){var e=this,t=iB.ins.getMijiDto(e.curRoleIndex+1,e._mijiHole);if(null==t)e.btn_upgrade.label="学 习",e.setCostVisible(!1),e.curSelectRender&&!e.curSelectRender.isLock&&(e.btn_upgrade.visible=!0);else{Bi.getIndex(t.miji_id);e.btn_upgrade.label="升 级",t.cur_lvl>=t.maxLv?e.setCostVisible(!1):e.setCostVisible(!0)}},i.setCostVisible=function(e){this.btn_upgrade.visible=e},i.showRedPoint=function(){return-1},i.updateAddBtnRP=function(e){this.btn_upgrade0.showTip=this.isShowAddBtnRP(e)},i.isShowAddBtnRP=function(e){var t=!1;null==e&&(e=this.curRoleIndex+1);var i,n=0,s=0,o=0,a=iB.ins,r=a.getFuwenIndexs();for(n=0;n<r.length&&(a.canEquipAll(e)?t=!0:(o=r[n],s=Xs.MODEL.type(o),i=a.getLearnSlot(e,s),a.hasEmptySlot(e)?i?i.cur_lvl<a.getMaxLevelInBag(e,r,s)&&(t=!0):this.isOnceRedpt[e-1]=!0:i?i.cur_lvl<a.getMaxLevelInBag(e,r,s)&&(t=!0):a.getMaxLevel(e)<a.getMaxLevelInBag(e,r,s)&&(t=!0)),!t);n++);return!t&&0<r.length&&this.isOnceRedpt[e-1]&&a.isNewFuwen[e-1]&&(t=this.isOnceRedpt[e-1]),t},i.updateSelectorRedpt=function(e){return this.isShowAddBtnRP(e.id)},i.showUpgradeEff=function(e){for(var t=0,i=0,n=0;n<8;n++){var s=this.itemArr[n];s&&parseInt(s.name)+1==e&&(t=s.x+40,i=s.y+40)}var o=mj.GetNew();o.pos(t,i),o.renderInSelf=!0,o.loadEffect("jm1163"),this.box_c.addChild(o),G.timer.once(1e3,this,this.showResultEff,[t,i])},i.showResultEff=function(e,t){var i=mj.GetNew();i.pos(e+20,t+20),i.renderInSelf=!0,0==this.toc_21413.isSucces?(i.loadEffect("jm1164"),Tu.sendToModule("START_FIGHT_EFFECT",["modules.broadcast.BroadcastModule"])):(QQ.delayShow=!1,i.loadEffect("jm1180"),1==this.toc_21413.isSucces?zB.ins.showById(3672,1):2==this.toc_21413.isSucces&&zB.ins.showById(3908,1)),this.box_c.addChild(i),G.timer.once(1e3,this,this.showResult)},i.showResult=function(){this.isEffectTime=0,this.showMijiListByIndex(),this.showClip&&(this.showClip.index=1)},i.onSelectRole=function(){iB.ins.curUpgradeId=0,this.centerItem.visible=!1,this.curRoleIndex=this._selector.selectIdx,IH.ins.currentSelectedRole=this._selector.selectIdx,this.showMijiListByIndex(!0),uf.reqMijiInfo(this.curRoleIndex+1),this.updateAddBtnRP()},i.onGetLearn=function(){Tu.sendToModule("MIJILEARN_OPEN",["modules.skill.SkillModule"],this.curRoleIndex),this.isOnceRedpt[this.curRoleIndex]&&iB.ins.isNewFuwen[this.curRoleIndex]&&this.btn_upgrade0.showTip&&(this.btn_upgrade0.showTip=!1,iB.ins.isNewFuwen[this.curRoleIndex]=!1,this._selector.invalid())},i.onUpgradeBtn=function(){0==iB.ins.curUpgradeId?Tu.sendToModule("MIJILEARN_OPEN",["modules.skill.SkillModule"],this.curRoleIndex):0<iB.ins.curUpgradeId&&KQ.ins.show(RP.n[1055]+Bi.MODEL.name(Bi.getIndex(iB.ins.curUpgradeId))+RP.n[1056]+Ql.createColor(RP.n[1057],"#01b527"),ql.create(this,this.alertConfirmUP,null))},i.alertConfirmUP=function(e){1==e&&this.reqUp()},i.reqUp=function(){uf.reqUpgradeMiji(this.curRoleIndex+1,iB.ins.curUpgradeId),QQ.delayShow=!0,iB.ins.curUpgradeId=0,this.centerItem.visible=!1,this.btn_upgrade.label="放入"},i.onTakeoffBtn=function(){var e=an.MODEL.cost(an.getIndex(1)).split(":")[1],t=iB.ins.getRewardNumByTakeoff(this.curRoleIndex+1,this.curSelectRender.dtoMiji.miji_index),i=t.name,n=t.num,s=Ql.createColor(RP.n[1058],"#e3dcc2")+Ql.createColor(e+"元宝","#FF9900")+Ql.createColor(RP.n[1059],"#e3dcc2")+Ql.createColor(i+"*"+n,"#912CEE");KQ.ins.show(s,ql.create(this,this.alertConfirm))},i.alertConfirm=function(e){if(1==e){var t=an.MODEL.cost(an.getIndex(1)).split(":")[1];gR.ins.YB<t?zB.ins.playErrorMsg(RP.n[1060]):uf.reqTakeoffMiji(this.curRoleIndex+1,this.curSelectRender.dtoMiji.miji_index)}},i.onComposeBtn=function(){Tu.sendToModule("MIJICOMPOSE_OPEN",["modules.skill.SkillModule"])},i.onPreviewBtn=function(){Tu.sendToModule("MIJISHOW_OPEN",["modules.skill.SkillModule"])},i.onLockBtn=function(){Tu.sendToModule("MIJI_LAOYIN",["modules.skill.SkillModule"])},i.onClickLink=function(e){Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:45})},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(Ou),hK=function(e){function t(){var e=this;e.isLevelUp=!1,e._selector=null,e._role=-1,e._canUp=0,e._cost=null,e.modelData=null,e.upSuccessEfc=null,e.roleEffect=null,e.seaAirList=[],e.filter=new ys([.5,0,0,0,16.75,0,.5,0,0,16.75,0,0,.5,0,16.75,0,0,0,1,0]),t.__super.call(e),e.modelData=nB.ins,e.initUI()}b(t,"modules.skill.views.SeaAirMainView",J_);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.qihaiBg1.skin=_r.getFullUrl("ui/images/jingmai/jm_bg.jpg"),t.btn_update.on("click",t,t.onClickUpgrade),t.txt_get.on("click",t,t.onClickGet),t.txt_talent.on("click",t,t.onClickTalent),t._selector.selectIdx=gR.ins.currentSelectRoleIndex;var i=gR.ins.isniePan();-1==i&&(i=0),t._selector.selectIdx=i,gR.ins.currentSelectRoleIndex=i,t._role=t._selector.selectIdx,t._canUp=0,t._cost=null,t.modelData.updateSeaAir(),t.showUpdateEffect(),t.update(),t.checkOpenNP()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_update.off("click",t,t.onClickUpgrade),t.txt_get.off("click",t,t.onClickGet),t.txt_talent.off("click",t,t.onClickTalent)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(t,e),t.upSuccessEfc&&(t.upSuccessEfc.parent&&t.upSuccessEfc.parent.removeChild(t.upSuccessEfc),t.upSuccessEfc=null);for(var i=0;i<t.seaAirList.length;i++)t.seaAirList[i]&&t.seaAirList[i].parent&&(t.seaAirList[i].parent.removeChild(t.seaAirList[i]),t.seaAirList[i].disponse());t.seaAirList=[]},i.initUI=function(){var e=this;e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e.html_cost.innerHTML="",e.html_cost.style.align="center",e.txt_cur.leading=19,e.txt_curW.leading=19,e.txt_next.leading=19,e.txt_nextW.leading=19,e.qihaiBg2.visible=!1;var t,i=e.getChildIndex(e.qihaiBg2);e._selector.on("select",e,e.onSelectRole),null==e.roleEffect&&(e.roleEffect=mj.GetNew(),e.roleEffect.renderInSelf=!0,e.roleEffect.loadEffect("jm1515"),e.addChildAt(e.roleEffect,i),e.roleEffect.pos(e.qihaiBg2.x+251,e.qihaiBg2.y+308)),i=e.getChildIndex(e.qihaiBg1);for(var n=0;n<nB.POINT.length;n++)(t=new VF).setXY(nB.POINT[n].x,nB.POINT[n].y),e.addChild(t),e.seaAirList.push(t)},i.updateSeaAirInfo=function(e){var t=this;e?null==t.upSuccessEfc&&(t.upSuccessEfc=mj.GetNew(),t.upSuccessEfc.renderInSelf=!0,t.upSuccessEfc.loadEffect("jm1496"),t.upSuccessEfc.pos(358,644),t.addChild(t.upSuccessEfc),t.upSuccessEfc.playEndHandler=ql.create(t,t.onPlayerEnd)):t.showUpdateEffect(),t.update(),t.checkOpenNP()},i.onPlayerEnd=function(){this.upSuccessEfc&&(this.upSuccessEfc.parent&&this.upSuccessEfc.parent.removeChild(this.upSuccessEfc),this.upSuccessEfc=null),this.showUpdateEffect()},i.onClickUpgrade=function(e){1!=this._canUp?zB.ins.showById(4605,1):this.modelData.upSeaAirByIndex(this._role+1)},i.onClickGet=function(e){Tu.sendToModule("OPEN_SOUL_POWER_GET_PANEL",["modules.skill.SkillModule"])},i.onClickTalent=function(e){Tu.sendToModule("SKILLVIEW_OPEN",["modules.skill.SkillModule"],{selectedInex:4,backID:0})},i.onSelectRole=function(){this._selector.selectIdx!=this._role&&(this._role=this._selector.selectIdx,gR.ins.currentSelectRoleIndex=this._selector.selectIdx,this.showUpdateEffect(),this.update())},i.update=function(){var e=this;e._canUp=0,e._cost=null;var t=0,i=gR.ins.actorList[e._role].qhCfgId,n=-1;0<i&&(n=oo.getIndex(i));var s=0;-1!=n&&(s=oo.MODEL.level(n));var o=-1,a=oo.count;for(t=0;t<a;t++)if(oo.MODEL.level(t)==s+1){o=t;break}e.btn_update.label="修 炼",e.btn_update.disabled=!1;var r=Math.floor(s/10);if(e.clip_lvl.value=0!=s&&s%10==0?(10,mp.getChineseNum(r)+"阶"):(s%10,mp.getChineseNum(r+1)+"阶"),1==mp.getChineseNum(r+1).length?(e.clip_lvl.spaceY=10,e.img_lvlbg.height=106):(e.clip_lvl.spaceY=0,e.img_lvlbg.height=30*e.clip_lvl.value.length+38),-1==o)e.txt_cost.visible=!1,e.img_costBg.visible=!1,e.html_cost.innerHTML="",e.btn_update.disabled=!0,e.spr_update.visible=!1,e.spr_next.visible=!1,e.spr_cur.x=(e.width-e.spr_cur.width)/2,e.img_max.visible=!0;else{e.txt_cost.visible=!0,e.img_costBg.visible=!0,e.spr_update.visible=!0,e.spr_next.visible=!0,e.img_max.visible=!1,e.spr_cur.x=40;var l=oo.MODEL.cost(o),c=0;if(e.modelData.seaAirInfo.has(e._role+1))c=e.modelData.seaAirInfo.take(e._role+1).soulScore;l<=c?(e._canUp=1,e.html_cost.innerHTML=Ql.createColor(c.toString(),"#23b11f")+"/"+l):e.html_cost.innerHTML=Ql.createColor(c.toString(),"#ff2e24")+"/"+l}if(-1==n)-1!=o?(e.txt_cur.text=aa.formatAttrOnlyKey(oo.MODEL.attrs(o),"：\n",!1,!0)+"：\n",e.txt_curW.text="0\n0\n0\n0\n"):(e.txt_cur.text="",e.txt_curW.text=""),e.fight_item.value=0;else{var u=oo.MODEL.attrs(n);e.txt_cur.text=aa.formatAttrOnlyKey(u,"：\n",!1,!0)+"：\n",e.txt_curW.text=aa.formatAttrOnlyValue(u),e.fight_item.value=RR.getFight(u,e._role)}if(-1==o)e.txt_next.text="",e.txt_nextW.text="";else{var d=oo.MODEL.attrs(o);e.txt_next.text=aa.formatAttrOnlyKey(d,"：\n",!1,!0)+"：\n",e.txt_nextW.text=aa.formatAttrOnlyValue(d)}e.imgTipCanUp.visible=0<e._canUp,e.img_get.visible=e.modelData.showGetRedPoint(e._role),e.updateTip()},i.updateTip=function(){for(var e=gR.ins.actorList,t=0;t<this.modelData.seaAirUps.length;t++){if(e.length>t)if(e[t].niepanlevel<=0)this._selector.setRedPtByIdx(t,!1);else{var i=this.modelData.seaAirUps[t];this._selector.setRedPtByIdx(t,i),0==i&&(i=this.modelData.showGetRedPoint(t),this._selector.setRedPtByIdx(t,i))}}},i.showAvtiveBall=function(e){var t=0,i=0,n=nB.POINT;for(t=0;t<n.length;t++)if(t<e)for(i=0;i<this.seaAirList.length;i++)this.seaAirList[i].x==n[t].x&&this.seaAirList[i].y==n[t].y&&(this.seaAirList[t].actived=!0);else this.seaAirList[t].actived=!1},i.showUpdateEffect=function(){this.getChildIndex(this.qihaiBg1);for(var e,t=this.getLv(),i=0;i<this.seaAirList.length;i++){(e=this.seaAirList[i]).actived=i<t;var n=nB.POINT[(10-t+i)%10];Og.to(e,{x:n.x,y:n.y,ease:pa.cubicInOut},200,null,ql.create(this,this.onCompose,[e],!0))}},i.onCompose=function(e){Og.clearAll(e)},i.getLv=function(){var e=-1,t=0,i=gR.ins.actorList[this._role].qhCfgId;return 0<i&&(e=oo.getIndex(i)),-1!=e&&(t=oo.MODEL.level(e)),0!=t&&t%10==0?10:t%10},i.checkOpenNP=function(){var e=0,t=gR.ins.actorList;for(e=0;e<t.length;e++){var i=0<t[e].niepanlevel,n=this._selector.getItem(e);n&&(n.mcHead.filters=null,i||(n.mcHead.filters=[this.filter]),n.isGray=!i,n.mouseEnabled=i)}},t}(),_K=function(e){function t(){this._selector=null,this._data=null,this._dto=null,this._useNum=1,t.__super.call(this),this._selector=new Nj(null,42,80),this._data=nB.ins,this.addChild(this._selector)}b(t,"modules.skill.views.SeaAirZhiShengView",Z_);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.use_1.on("click",t,t.onClick),t.use_2.on("click",t,t.onClick),t.use_3.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.use_1.off("click",t,t.onClick),t.use_2.off("click",t,t.onClick),t.use_3.off("click",t,t.onClick)},i.onClick=function(e){var t=e.target;this.sendUse(t)},i.sendUse=function(e){var t=parseInt(e.name);gR.ins.actorList[t-1]?(hN.ins.close("SEA_AIR_ZS_GETVIEW"),this._dto&&this._data.useSoulTools(t,this._dto.uuId,this._useNum)):Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"])},i.update=function(e){var t=this;if(null!=nB.ins.useGoodsDto){t._useNum=e;var i,n=!1;t._dto=nB.ins.useGoodsDto;var s=Bi.MODEL.name(Bi.getIndex(t._dto.goodsId));t.title.innerHTML=RP.n[1061]+Ql.createColor(s,"#23b11f")+"的角色";for(var o=0;o<3;o++)if(i=gR.ins.actorList[o],t["use_"+(o+1)].showTip=!1,i){n=!0,TR.ins.getGoodsNum(t._dto.goodsId),n?(t["grade_"+(o+1)].innerHTML=RP.n[1064]+Ql.createColor(Math.floor(i.qhCfgId/10)+1+"阶","#23b11f"),t["use_"+(o+1)].label=RP.n[677],t["advice_"+(o+1)].visible=!0):(t["grade_"+(o+1)].innerHTML=RP.n[1062],t["use_"+(o+1)].label=RP.n[675],t["advice_"+(o+1)].visible=!1),t["use_"+(o+1)].disabled=!1,11<=Math.floor(i.qhCfgId/10)&&(t["advice_"+(o+1)].innerHTML=Ql.createColor(RP.n[1066],"#e6d80d"),t["use_"+(o+1)].disabled=!0);var a=Bi.MODEL.eventArgs(Bi.getIndex(t._dto.goodsId));a&&-1!=a.indexOf(".")&&(a=a.slice(0,-2)),t["advice_"+(o+1)].innerHTML=Ql.createColor("魂力："+a,"#e6d80d")}else t["grade_"+(o+1)].innerHTML=RP.n[682],t["use_"+(o+1)].label=RP.n[675],t["advice_"+(o+1)].visible=!1}},t}(),fK=function(e){function t(){var e=this;e.curRoleIndex=0,e.allSkillArr=null,e._selector=null,e.curSelectRender=null,e._grid=null,e._skillId=0,e._enoughCoin1=!1,e._isMaxLv=!1,e._allUpMoney=0,e.eff=null,t.__super.call(e)}b(t,"modules.skill.views.SkillSubView_1",_f);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.list_skill.y-=4,e.list_skill.itemRender=SY,e.list_skill.repeatX=1,e.list_skill.vScrollBarSkin="",e.list_skill.selectHandler=ql.create(e,e.onListMouse,null,!1),e.btn_upgrade.clickHandler=ql.create(e,e.onUpgradeBtn,null,!1),e.btn_allUp.clickHandler=ql.create(e,e.onAllUpgradeBtn,null,!1),e.lk_get.on("click",e,e.onClickLink),e.coin_icon1.on("click",e,e.onClickLink),e.coin_icon2.on("click",e,e.onClickLink),e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e._grid=new GF,e.addChild(e._grid),e.txt_money.text="",e.txt_totalMoney.text="",e.img_maxLv1.visible=!1,e.img_maxLv2.visible=!1,e.lk_get.visible=!1,e.redPoint.visible=!1,e.mc_cost1.visible=!1,e.mc_cost2.visible=!1,e.txt_curDes.width=e.txt_nextDes.width=280,e.txt_curDes.autoSize=!0,e.txt_nextDes.autoSize=!0},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearEff()},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.updateByVSC=function(e){e&&this.showUpgradeEff(e),this.showSkillListByIndex(),4<=this._skillId&&this.showdetail(this._skillId),this.updateRedPoint()},i.showByVSC=function(e,t){this._selector.refresh(),this._selector.on("select",this,this.onSelectRole),this._selector.selectIdx=IH.ins.currentSelectedRole,this.curRoleIndex=this._selector.selectIdx+1,this.showSkillListByIndex(!0),this.updateRedPoint()},i.hideByVSC=function(e,t){this.list_skill.selectedIndex=-1,this._selector.off("select",this,this.onSelectRole),this.clearEff()},i.showSkillListByIndex=function(e){var t=this;void 0===e&&(e=!1),t.allSkillArr=[];var i=0;gR.ins.actorList&&gR.ins.actorList.length>t._selector.selectIdx&&(i=gR.ins.actorList[t._selector.selectIdx].job);for(var n=[],s=0;s<Vn.count;s++)i==Vn.MODEL.role(s)&&1==Vn.MODEL.available(s)&&n.push(Vn.MODEL.key(s));for(s=0;s<n.length;s++){var o=IH.ins.getDtoSkill(t.curRoleIndex,n[s]);t.allSkillArr.push(o)}t.allSkillArr&&(t.list_skill.array=t.allSkillArr),e&&(t.list_skill.selectedIndex=0),t.checkIsAllMax(t.allSkillArr)},i.updateRedPoint=function(){for(var e=gR.ins.lv,t=gR.ins.zsLv,i=0;i<gR.ins.actorList.length;i++){this._selector.setRedPtByIdx(i,!1);var n=IH.ins.skillHash.take(i+1);if(n)for(var s=0;s<n.length;s++){var o=n[s],a=o.skill_id,r=Vn.getIndex(a),l=Vn.MODEL.upgradeCost(r),c=Vn.MODEL.maxLevel(r),u=o.cur_lvl,d=o.zsLimit,h=o.levelLimit;if(u<c&&gR.ins.coin>l[u-1]&&d<=t&&h<=e){this._selector.setRedPtByIdx(i,!0);break}}}},i.onListMouse=function(e){var t=this,i=t.allSkillArr[e];if(i){if(0==i.cur_lvl)return;t._skillId=i.skill_id,t.showdetail(t._skillId)}t.curSelectRender&&t.curSelectRender.setSelectBg(!1),t.curSelectRender=t.list_skill.selection,t.curSelectRender&&t.curSelectRender.setSelectBg(!0)},i.showdetail=function(e){var t=this,i=IH.ins.getCurrSkillDto(t.curRoleIndex,e);if(i){var n=i.cur_lvl,s=Vn.getIndex(t._skillId),o=Vn.MODEL.desc(s),a=Vn.MODEL.maxLevel(s),r=Vn.MODEL.damageFactor(s),l=Vn.MODEL.fixedDamage(s),c=Vn.MODEL.para1(s),u=Vn.MODEL.para2(s),d=n-1,h=n,_=r.length>d?(r[d]/100).toString():"0",f=l.length>d?l[d].toString():"0",p=c.length>d?(c[d]/100).toString():"0",g=u.length>d?u[d].toString():"0";203==t._skillId&&(f=l[d]/100+"%");var v=mp.getFormat(o,[_,f,p,g]);if(t.txt_curDes.innerHTML=v,a<n+1)t._isMaxLv=!0,t.txt_nextDes.innerHTML=RP.n[1069],t.mc_cost1.visible=!1,t.img_maxLv1.visible=!0;else{t._isMaxLv=!1,t.mc_cost1.visible=!0,t.img_maxLv1.visible=!1;var m=r.length>h?(r[h]/100).toString():"0",y=l.length>h?l[h].toString():"0",I=c.length>h?(c[h]/100).toString():"0",b=u.length>h?u[h].toString():"0";203==t._skillId&&(y=l[h]/100+"%");var w=mp.getFormat(o,[m,y,I,b]);t.txt_nextDes.innerHTML=w,t._enoughCoin1=!0;var x=Vn.MODEL.upgradeCost(s);gR.ins.coin<x[h-1]?(t._enoughCoin1=!1,t.txt_money.text=x[h-1]+"",t.txt_money.color="#ff2e24"):(t.txt_money.text=x[h-1]+"",t.txt_money.color="#e3dcc2"),t.setBtnStatus(t._enoughCoin1);var S=i.levelLimit,k=i.zsLimit,E=gR.ins.lv,T=gR.ins.zsLv;if(E<S||T<k){t.setBtnStatus(!1),t.costVisible(!1);var C="";E<=S&&(C=S+"级"),T<k&&(C=k+"转"),t.txt_limit.text="达到"+C+"可升级"}else t.setBtnStatus(!0),t.costVisible(!0)}t.txt_skillName.text=Vn.MODEL.name(s),t._grid.bindData=e,t._grid.x=t.img_grid.x+(t.img_grid.width-t._grid.width>>1),t._grid.y=t.img_grid.y+(t.img_grid.height-t._grid.height>>1),t._allUpMoney=IH.ins.getAllUpCost(t.curRoleIndex),t.txt_totalMoney.text=t._allUpMoney+"",t.txt_totalMoney.color=t._allUpMoney>gR.ins.coin?"#ff2e24":"#e3dcc2",t._allUpMoney<=gR.ins.coin&&0<t._allUpMoney?(t.eff||(t.eff=kB.createEffect("jm1130",t.btn_allUp.width>>1,t.btn_allUp.height>>1,t.btn_allUp),t.eff.scale_X=1.25,t.eff.scale_Y=1.25),t.showGuide(8,!0)):(t.clearEff(),t.showGuide(8,!1)),8<TR.ins.getRecycleEquips(la.NORMAL).length&&t.canUpLvl(),t.redPoint.visible=!1,t.txt_curDes.x=320-t.txt_curDes.contextWidth>>1,t.txt_nextDes.x=320-t.txt_nextDes.contextWidth>>1}},i.canUpLvl=function(){var e=!1,t=IH.ins.cloneSkillArr(this.curRoleIndex);if(0<t.length){t.sort(IH.ins.sortFunc);var i=t[0].skill_id,n=t[0].cur_lvl,s=Vn.getIndex(i),o=Vn.MODEL.upgradeCost(s);n<Vn.MODEL.maxLevel(s)&&gR.ins.coin>o[n]&&(e=!0)}return e},i.showGuide=function(e,t){if(t){if(PH.Ins().hasNewGuide(e))switch(e){case 8:var i=new u_;i.x=this.btn_allUp.x,i.y=this.btn_allUp.y-10,i.width=this.btn_allUp.width,i.height=this.btn_allUp.height+10,LY.Ins().show(e,i,!1,this.mc_cost2)}}else LY.showing&&LY.Ins().close(8)},i.checkIsAllMax=function(e){for(var t,i=IH.ins.takeCharSkillList(this.curRoleIndex),n=0,s=0,o=0;o<i.length;o++)t=i[o],s=Vn.getIndex(t.skill_id),1==Vn.MODEL.available(s)&&n++;if(0!=n){var a=!0;for(o=0;o<e.length;o++)if(t=e[o]){var r=t.cur_lvl;if(s=Vn.getIndex(t.skill_id),r+1<=Vn.MODEL.maxLevel(s)){a=!1;break}}this.img_maxLv2.visible=a,this.lk_get.visible=!a,this.mc_cost2.visible=!a,a&&(this.redPoint.visible=!1,this.clearEff())}},i.setBtnStatus=function(e){this.btn_upgrade.mouseEnabled=e,this.btn_upgrade.gray=!e},i.costVisible=function(e){this.txt_costStr.visible=e,this.img_coin.visible=e,this.txt_money.visible=e,this.img_txtBg.visible=e,this.txt_limit.visible=!e},i.showUpgradeEff=function(e){var t=e.newList,i=e.oldList;null!=t&&t.sort(this.sortSkill),null!=i&&i.sort(this.sortSkill);for(var n=0;n<5;n++){var s=this.list_skill.getCell(n);if(s){var o=s.skillId;if(null==t)break;for(var a=0;a<t.length;a++){var r=t[a],l=i[a];l&&r&&r.skill_id==o&&s.showUpgradeEff(l.cur_lvl,r.cur_lvl)}}}},i.sortSkill=function(e,t){return e.skill_id>t.skill_id?1:-1},i.onUpgradeBtn=function(){this._isMaxLv?zB.ins.playErrorMsg(RP.n[1070]):this._enoughCoin1?uf.reqSkillUpgrade(this.curRoleIndex,this._skillId):zB.ins.showById(1003,1)},i.onAllUpgradeBtn=function(){if(LY.showing&&8==LY.Ins().currGuideId&&(this.showGuide(8,!1),Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])),0!=this._allUpMoney)uf.reqAllSkillUp(this.curRoleIndex),UB.ins.playSound("13",3,!0);else{var e=IH.ins.cloneSkillArr(this.curRoleIndex);if(0<e.length){e.sort(IH.ins.sortFunc);var t=e[0].skill_id,i=e[0].cur_lvl;if(IH.ins.checkLvLimit(t,i)){var n=Vn.getIndex(t),s=Vn.MODEL.upgradeCost(n);if(i<Vn.MODEL.maxLevel(n)&&gR.ins.coin<s[i])return void zB.ins.showById(1003,1)}}zB.ins.playErrorMsg(RP.n[1071])}},i.onSelectRole=function(){this.list_skill.selectedIndex=-1,this.curRoleIndex=this._selector.selectIdx+1,IH.ins.currentSelectedRole=this._selector.selectIdx,this.showSkillListByIndex(!0)},i.onClickLink=function(e){HN.ins.reqBuyCoin(),UB.ins.playSound(90006)},t}(),pK=function(e){function n(){this._vo=null,this._ballEffect=null,this._canActivityEff=null,n.__super.call(this)}b(n,"modules.soul.views.SoulElementItem",e);var t=n.prototype;return t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.disopseEff()},t.disopseEff=function(){var e=this;e._ballEffect&&(e._ballEffect.parent&&e._ballEffect.parent.removeChild(e._ballEffect),e._ballEffect.dispose(),e._ballEffect=null),e._canActivityEff&&(e._canActivityEff.parent&&e._canActivityEff.parent.removeChild(e._canActivityEff),e._canActivityEff.dispose(),e._canActivityEff=null)},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t.setSelected=function(e){this.img_selected.visible=e},p(0,t,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Bf,t,"dataSource",e),t._vo=e,t.disopseEff(),t._vo){t.txt_dect.text="";var i=_r.getAtlasSubPath("soul/ys_off_"+(t._vo.id-1)+".png");switch(t.img_bg.skin=i,t._vo.statue){case 1:if(null==t._ballEffect){n.BALL_EFFECT_ARR[Vf.instance.currentActivityPart-1];t._ballEffect=kB.createEffect(n.BALL_EFFECT_ARR[t._vo.id-1],t.width/2,t.height/2,t)}break;case 0:null==t._canActivityEff&&(t._canActivityEff=kB.createEffect("jm1247",t.width/2,t.height/2,t));break;case 2:t.txt_dect.text=t._vo.activityDect}}else t.img_selected.visible=!1,t.txt_dect.text=""}),f(n,["BALL_EFFECT_ARR",function(){return this.BALL_EFFECT_ARR=["jm1173","jm1169","jm1170","jm1171","jm1172"]}]),n}(Bf),gK=function(e){function t(){var e=this;e.panelId=null,e.souloutGuanzhulv=0,e.consumeobj=null,e.itemTargetStr=null,e.itemTarget=[],e.costId=0,e.costNum=0,e.soulImage=null,e.eff=null,e.titleTween=null,t.__super.call(e),e.panelId="SOULOUT_ADVANCE",e.txt_des1.style.align="left",e.txt_des1.style.font="SimHei",e.txt_des1.style.fontFamily="SimHei",e.txt_des1.style.fontSize=24,e.txt_des1.style.color="#90877b",e.txt_des2.style.align="left",e.txt_des2.style.font="SimHei",e.txt_des2.style.fontFamily="SimHei",e.txt_des2.style.fontSize=24,e.txt_des2.style.color="#90877b"}b(t,"modules.soul.views.SouloutAdvanceView",Qf);var i=t.prototype;return i.shareHandler=function(){var e=this;95==e.soulImage.y?e.titleTween=Og.to(e.soulImage,{y:105},1e3,null,ql.create(e,e.shareHandler)):105==e.soulImage.y?e.titleTween=Og.to(e.soulImage,{y:100},500,null,ql.create(e,e.shareHandler)):100==e.soulImage.y&&(e.titleTween=Og.to(e.soulImage,{y:95},500,null,ql.create(e,e.shareHandler)))},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.update(),t.soulImage.y=100,t.soulImage&&(t.titleTween=Og.to(t.soulImage,{y:95},500,null,ql.create(t,t.shareHandler)))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.titleTween&&this.titleTween.clear()},i.update=function(){var e=this;(e.souloutGuanzhulv=$f.instance.souloutGuanzhulv,e.souloutGuanzhulv==_p.count-1?e.souloutAdvanicon.skin=_r.getFullUrl("ui/images/soul/"+_p.MODEL.nameIconId(_p.getIndex(e.souloutGuanzhulv))+".png"):e.souloutAdvanicon.skin=_r.getFullUrl("ui/images/soul/"+_p.MODEL.nameIconId(_p.getIndex(e.souloutGuanzhulv+1))+".png"),null==e.soulImage&&(e.soulImage=new Kl,e.soulImage.centerX=0,e.soulImage.y=100,e.addChild(e.soulImage)),e.soulImage.skin=_r.getFullUrl("ui/images/soul/"+_p.MODEL.mosterId(e.souloutGuanzhulv)+".png"),e.souloutGuanzhulv<_p.count-1)?(e.consumeobj=JSON.parse(_p.MODEL.consumeDef(e.souloutGuanzhulv)),e.itemTargetStr=e.consumeobj[0].value,e.itemTarget=e.itemTargetStr.split(":"),e.costId=parseInt(e.itemTarget[0]),e.costNum=parseInt(e.itemTarget[1]),TR.ins.getGoodsNum(e.costId)<e.costNum?(e.btn_advance.visible=!1,e.eff&&e.eff.dispose(),e.eff=null):(e.btn_advance.visible=!0,e.eff||(e.eff=kB.createEffect("jm1130",e.btn_advance.x+e.btn_advance.width/2,e.btn_advance.y+e.btn_advance.height/2,e),e.eff.scale_X=1.2,e.eff.scale_Y=1.3)),e.maxLevel.visible=!1):(e.btn_advance.visible=!1,e.maxLevel.visible=!0,e.eff&&e.eff.dispose(),e.eff=null);_p.MODEL.levelUpDesc(e.souloutGuanzhulv);e.txt_des1.innerHTML=_p.MODEL.levelUpDesc(e.souloutGuanzhulv),e.txt_des2.innerHTML=_p.MODEL.attDesc(e.souloutGuanzhulv),e.btn_advance.visible||e.maxLevel.visible?e.height=844:e.height=730},i.onClick=function(e){if(e.target==this.btn_close)this.close();else if(e.target==this.btn_advance){var t=new np;Tu.sendToService(t)}},i.close=function(){hN.ins.close(this.panelId)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(),vK=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.soul.views.SouloutAttDetailView",Jf);var i=t.prototype;return i.init=function(){},i.showValue=function(e){this.clearAttrs(),this.drawLeftText(e),this.updateSkill()},i.updateSkill=function(){for(var e=0;e<xv.count-1;e++)this["skillname"+e].innerHTML=xv.MODEL.skillName(e)+":",this["skilldes"+e].innerHTML=xv.MODEL.skillDect(e)},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#23b11f"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attrname_l"+e];t.visible=!1,t.style.wordWrap=!1,i.visible=!1}},t}(),mK=function(t){function e(){this._grid=null,this._cost=null,this._vo=null,this._costYuanBaoNum=0,e.__super.call(this)}b(e,"modules.soul.views.SouloutCopyRewardView",t);var i=e.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onGoBtnClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_get.off("click",this,this.onGoBtnClicked)},i.onGoBtnClicked=function(e){""!=this._vo.costStr&&gR.ins.YB<this._costYuanBaoNum?KQ.ins.showNoGold():jR.reqAward(48,this._vo.num)},i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y),e.addChild(e._grid),e.img_icon.visible=!1,e._grid.mouseEnabled=!1,e._cost=new MF,e._cost.pos(e.img_money.x+10,e.img_money.y+10),e.addChild(e._cost),e.img_money.visible=!1,e._cost.mouseEnabled=!1,e._cost.scale(.3,.3),e._cost.needEffect=!1,e._cost.needGridBg=!1},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.setImage=function(e){var t=G.loader.getRes(e.skin);null!=t?t&&t.bitmap&&(t.bitmap.enableMerageInAtlas=!1):e.on("loaded",this,this.onLoadedImage,[,[e]])},i.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1)},p(0,i,"dataSource",t.prototype._$get_dataSource,function(e){var t=this;if(G.superSet(Zf,t,"dataSource",e),e){t._vo=e;var i=t._vo.reward.split(","),n=yB.create(i[0],1);if(t.txt_num.text=i[1],t._grid.bindData=n,""!=t._vo.costStr){var s=yB.createStr(t._vo.costStr);t.txt_money.text=s.goodsNum.toString(),t._costYuanBaoNum=s.goodsNum,s.goodsNum=1,t._cost.bindData=s,t._cost.visible=!0}else t._costYuanBaoNum=0,t._cost.visible=!1;t.txt_free.visible=!t._cost.visible,t.txt_money.visible=t._cost.visible,t.img_time.skin=_r.getAtlasSubPath("soulout/fb_jy_jlbs_"+t._vo.num+".png")}}),e}(Zf),yK=function(i){function e(){this._grid=null,this._leftTime=0,this._mask=null,this._effect=null,e.__super.call(this)}b(e,"modules.soul.views.SouloutCopyView",i);var t=e.prototype;return G.imps(t,{"ui.IVSCView":!0}),t.createChildren=function(){var e=this;i.prototype.createChildren.call(e),e._grid=new MF,e._grid.pos(e.txt_rewardName.x+30,e.txt_rewardName.y-e._grid.height-10);var t=e.box_content.getChildIndex(e.txt_rewardName);e.box_content.addChildAt(e._grid,t),e.list_reward.itemRender=mK,e.list_reward.repeatX=3,e.list_reward.spaceX=20,e._mask=new Ss,e.box_reward.addChild(e._mask),e._mask.alpha=.8,e._mask.graphics.drawRect(0,0,720,1160,"#000000",null),e._mask.mouseEnabled=!0,e._mask.mouseThrough=!1},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t,i=cd.MODEL.reward(0).split(","),n=yB.create(i[0],i[1]);this.txt_rewardName.text=n.simpleName,n.goodsNum=1,this._grid.bindData=n,this.btn_challenge.on("click",this,this.onChallengeBtnClicked);for(var s=[],o=0;o<cd.count;o++)(t=new Object).id=cd.MODEL.key(o),t.num=cd.MODEL.num(o),t.costStr=cd.MODEL.consumeDef(o),t.reward=cd.MODEL.reward(o),s.push(t);this.list_reward.dataSource=s,this.box_reward.addChild(this.list_reward)},t.hideByVSC=function(e,t){},t.showByVSC=function(e,t){this.updateByVSC(t)},t.updateByVSC=function(e){var t=this,i=0<$f.instance.hasReward;t.box_reward.visible=i;var n=0;0<hg.ins.getLeftTime()?(n=uo.MODEL.yuanGodRewardTimes(0),t.btn_challenge.label="扫 荡"):t.btn_challenge.label="挑 战",t._leftTime=1+n-$f.instance.copyTime,t.txt_time.text=RP.n[1072]+t._leftTime.toString(),t.box_content.visible=!i,0<t._leftTime?t.btn_challenge.showTip=!0:t.btn_challenge.showTip=!1},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_challenge.on("click",this,this.onChallengeBtnClicked),this.disposeEffect()},t.disposeEffect=function(){this._effect&&(this._effect.parent&&this._effect.parent.removeChild(this._effect),this._effect.dispose(),this._effect=null)},t.onChallengeBtnClicked=function(e){ZN.isEnabledChangeScene()?this._leftTime<=0?zB.ins.showMsg(RP.n[1073],1):hg.ins.getLeftTime()<=0?jR.reqEntry(48):(_g.reqGetCanSweep(27),_g.reqSaoDangCopy(48)):zB.ins.showById(2126,1)},e}(Kf),IK=function(e){function t(){var e=this;e._gridRes=null,e.skillidArr=null,e.skillNameArr=null,e.skilllimitArr=null,e.img_skill=null,e.skillitemArr=null,e.skillOpenArr=null,e.eff=null,e.colorMatrix=null,e.titleTween=null,t.__super.call(e),e.init()}b(t,"modules.soul.views.SouloutUpgradeView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.updateByVSC=function(e){"31010"==e.actionOrder?this.update():"BP_UPDATE"==e.actionOrder&&this.updateNum()},i.updateNum=function(){var e=this,t=$f.instance.souloutVo;if(e.maxLevel.visible=!1,0<t.costNum){e.btn_upgrade.visible=!0,e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!0,e._gridRes.bindData=yB.create(t.costId);var i=TR.ins.getGoodsNum(t.costId);i>=t.costNum?(e.txt_cost.innerHTML=Ql.createColor(i+"","#23b11f")+"/"+t.costNum,e.btn_upgrade.showTip=!0):(e.txt_cost.innerHTML=Ql.createColor(i+"","#ff2e24")+"/"+t.costNum,e.btn_upgrade.showTip=!1)}else 0<t.costId?(e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btn_upgrade.visible=!0):(e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btn_upgrade.visible=!1,e.maxLevel.visible=!0);e.btn_power.showTip=!1,0<=$f.instance.souloutGuanzhulv&&$f.instance.souloutGuanzhulv<_p.count-1&&e.updateReddot()},i.updateReddot=function(){var e=JSON.parse(_p.MODEL.consumeDef($f.instance.souloutGuanzhulv))[0].value.split(":"),t=parseInt(e[0]),i=parseInt(e[1]),n=TR.ins.getGoodsNum(t),s=$f.instance.souloutGuanzhulv<_p.count-1;this.btn_power.showTip=i<=n&&s},i.update=function(){var e=this,t=$f.instance.souloutVo;e.updateNum(),e.updateStar();var i=mp.getChineseNum(t.souloutGrade);0<=i.indexOf("零")&&(i=i.slice(0,i.indexOf("零")));var n=(e.gra0.value=i).length;1<n?(e.imgJie.y=e.gra0.y+27*n+5,e.img_lvlbg.height=72+27*n):(e.imgJie.y=e.gra0.y+27*n+20,e.img_lvlbg.height=87+27*n),e.clearAttrs();var s=$f.instance.souloutGuanzhulv;0<=s&&(e.soulAvtar.skin=_r.getFullUrl("ui/images/soul/"+_p.MODEL.image(_p.getIndex(s))+".png"),e.soulname.skin=_r.getFullUrl("ui/images/soul/"+_p.MODEL.nameIconId(_p.getIndex(s))+".png"));var o,a;t.isTop?(e.boxleft.pos(270,e.boxleft.y),e.mc_arrow.visible=e.boxright.visible=!1,o=aa.formatAttrToChineseByList(t.curAttr),e.drawLeftText(o,!0,"#23b11f")):(o=aa.formatAttrToChineseByList(t.curAttr),a=aa.formatAttrToChineseByList(t.nextAttr),e.drawLeftText(o,!0,"#90877b"),e.drawRightText(a,!0,"#23b11f"));var r=RR.getFight(o,-1,0,!0,!1),l=[],c=fp.MODEL.buffId(fp.getIndex($f.instance.souloutVo.id));if(c){0<=c.indexOf(",")?l=c.split(","):l.push(parseInt(c));for(var u=0;u<l.length;u++)r+=Ls.MODEL.fighting(Ls.getIndex(l[u]))}e.fcForce.value=r+Math.floor(r*e.checkTitle(21))},i.checkTitle=function(e){var t=0,i=tg.ins.toc_title;if(!i)return 0;var n,s=i.titles[0];for(var o in s)if((n=s[o]).id==e&&0<=n.state){var a=co.getIndex(e);t=JSON.parse(co.MODEL.attr(a))[4].value/1e4}else;return t},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attr_r"+e],n=this["txt_attrname_l"+e],s=this["txt_attrname_r"+e];t.visible=!1,i.visible=!1,n.visible=!1,s.visible=!1}},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_l"+o],l=this["txt_attrname_l"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+s+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+s+"</font>"}},i.drawRightText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");for(var o=0;o<e.length;o++){var a=e[o],r=this["txt_attr_r"+o],l=this["txt_attrname_r"+o];r.visible=!0,l.visible=!0,l.innerHTML=a.name+":",t?r.innerHTML="<font style='color:"+i+";'>"+n+a.val+"</font>":r.innerHTML+="<font style='color:"+i+";'>"+n+a.val+"</font>"}},i.updateStar=function(){for(var e=this,t=0;t<10;t++)t<$f.instance.souloutVo.souloutStar?e["img_star_"+t].visible=!0:e["img_star_"+t].visible=!1;10==$f.instance.souloutVo.souloutStar?e.btn_upgrade.label="升 阶":e.btn_upgrade.label="升 星";for(var i=0;i<e.skilllimitArr.length;i++){var n;if($f.instance.souloutVo.souloutGrade<parseInt(e.skillOpenArr[i]))n=10<=parseInt(e.skillOpenArr[i])?e.skillOpenArr[i]+"阶开启":e.skillOpenArr[i]+RP.n[1074],e.skilllimitArr[i].text=n,e.skillitemArr[i].filters=[e.colorMatrix];else e.skilllimitArr[i].changeText(""),e.skilllimitArr[i].visible=!1,e.skillitemArr[i].filters=[]}},i.drawText=function(e,t,i,n,s,o,a,r){var l;void 0===s&&(s="left"),void 0===o&&(o="#ffffff"),void 0===a&&(a=45),void 0===r&&(r=!1),r&&e.clear();for(var c=0;c<n.length;c++)l=n[c],e.fillText(l.name+"："+l.val,t,i,"22px SimHei",o,s),i+=a},i.shareHandler=function(){var e=this;232==e.soulAvtar.y?e.titleTween=Og.to(e.soulAvtar,{y:242},1e3,null,ql.create(e,e.shareHandler)):242==e.soulAvtar.y?e.titleTween=Og.to(e.soulAvtar,{y:237},500,null,ql.create(e,e.shareHandler)):237==e.soulAvtar.y&&(e.titleTween=Og.to(e.soulAvtar,{y:232},500,null,ql.create(e,e.shareHandler)))},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.update(),t.soulAvtar.y=237,t.soulAvtar&&(t.titleTween=Og.to(t.soulAvtar,{y:232},500,null,ql.create(t,t.shareHandler)));var i=ql.create(t,t.redPtUpdate,null,!1);AN.ins.addListener("BTN_SOUL_SKIN2",[269],i),AN.reqRedPt([269]),oB.ins.isFirstLogin&&(t.btnSkin.showTip=!0)},i.redPtUpdate=function(e,t){"BTN_SOUL_SKIN2"==e&&(this.btnSkin.showTip=t||oB.ins.isFirstLogin)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.titleTween&&this.titleTween.clear(),AN.ins.removeListener("BTN_SOUL_SKIN")},i.onClick=function(e){var t=this;if(e.target==t.btn_upgrade){var i=new sp;i.type=1,Tu.sendToService(i)}else if(e.target==t.mc_skill1||e.target==t.mc_skill2||e.target==t.mc_skill3||e.target==t.mc_skill4||e.target==t.mc_skill5||e.target==t.mc_skill6||e.target==t.mc_skill7){var n=parseInt(e.target.name);if(t.skillidArr[n-1]){var s="";$f.instance.souloutVo.souloutGrade<parseInt(t.skillOpenArr[n-1])&&(s=t.skillOpenArr[n-1]+"阶开启"),mQ.instance.showById(t.skillidArr[n-1],s)}}else e.target==t.btn_power?hN.ins.open("SOULOUT_ADVANCE",null,0):e.target==t.btn_info?hN.ins.open("SOULOUT_DETAIL",t.getTotalAtt()):e.target==t.btnSkin&&hN.ins.open("SoulSkinMainView",null,0)},i.getTotalAtt=function(){var e=[];e=aa.mergeFormatAttrs(fp.MODEL.attrs(fp.getIndex($f.instance.souloutVo.id)),e);for(var t=0;t<xv.count;t++)xv.MODEL.activeAttribute(t)&&(e=aa.mergeFormatAttrs(xv.MODEL.activeAttribute(t),e));return aa.formatAttrToChineseByList(e)},i.init=function(){var e=this;e._gridRes=new MF(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x-47,e._gridRes.y=e.txt_cost.y-10,e.addChild(e._gridRes),e.skillOpenArr=$e.MODEL.value($e.getIndex(150)).split(","),e.skillidArr=[],e.skillNameArr=[],e.skillitemArr=[],e.skilllimitArr=[];var t=0,i=$e.MODEL.value($e.getIndex(147)).split(",");for(t=0;t<i.length;t++)if(i[t]){e.img_skill=new Kl,e.addChild(e.img_skill),e.img_skill.pos(e["mc_skill"+(t+1)].x+7,e["mc_skill"+(t+1)].y+7);var n=Ls.getIndex(i[t]);e.img_skill.skin=_r.getIconPath(Ls.MODEL.icon(n)),e.img_skill.scaleX=1.3,e.img_skill.scaleY=1.3,e.skillidArr.push(i[t]),e.skillitemArr.push(e.img_skill);var s=kB.createText(e["mc_skill"+(t+1)].x-9,e["mc_skill"+(t+1)].y+108,116,50,Ls.MODEL.skillName(n),24,"#90877b",!1,"center",!1,!1,e);e.addChild(s),e.skillNameArr.push(s);var o=kB.createText(e["mc_skill"+(t+1)].x+10,e["mc_skill"+(t+1)].y+20,75,50,Ls.MODEL.skillName(n),30,"#ff0000",!1,"center",!0,!1,e);e.addChild(o),e.skilllimitArr.push(o)}var a=[];a=(a=(a=(a=a.concat([.35,0,0,0,0])).concat([.35,0,0,0,0])).concat([.35,0,0,0,0])).concat([0,0,0,1,0]),e.colorMatrix=new ys(a),e.imgJie.x+=2},i.destroy=function(e){void 0===e&&(e=!0);for(var t=0;t<this.skillitemArr.length;t++){G.loader.getRes(this.skillitemArr[t].skin)&&G.loader.clearRes(this.skillitemArr[t].skin,!0)}laya.ui.View.prototype.destroy.call(this,e)},t}(tp),bK=function(e){function t(){this._imgSkill=null,t.__super.call(this),this._imgSkill=new Kl,this._imgSkill.pos(7,7),this.boxSkill.addChild(this._imgSkill)}b(t,"modules.soul.views.soulskin.SoulSkillGrid",Gf);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.update=function(e,t,i,n){var s=this;void 0===i&&(i=!1),void 0===n&&(n=!0),s.imgRed.visible=!1;var o=Ls.getIndex(e.skillId);s._imgSkill.skin=_r.getIconPath(Ls.MODEL.icon(o)),s._imgSkill.width=s._imgSkill.height=100,n?(s.labName.visible=!0,s.labName.text=Ls.MODEL.skillName(o)):s.labName.visible=!1,i?(s.labLock.y=12,0==t?(s.imgMask.visible=!0,s.labLock.text=RP.n[1076]):(s.imgMask.visible=!1,s.labLock.visible=!1),99999!=t&&(s.imgRed.visible=oB.ins.getCanUpSkillByType(e.type))):(s.labLock.y=22,e.lockLevel>t?(s.imgMask.visible=!0,s.labLock.text=oB.ins.getStepByLevel(e.lockLevel,e.type)+RP.n[1075]):(s.imgMask.visible=!1,s.labLock.visible=!1))},t}(),wK=function(e){function t(){t.__super.call(this)}b(t,"modules.soul.views.soulskin.SoulSkinAttrTip",Uf);var i=t.prototype;return i.show=function(e){var t,i,n,s,o,a,r=this,l=oB.ins.info[e],c=e+"_"+l.level,u=Un.getIndex(c),d=0,h=-2;if(r.boxAttr.graphics.clear(),0<=u)for(i=(t=Un.MODEL.attrs(u))?JSON.parse(t):null,n=aa.formatNewAttrToChinese(i,!1,!0,!0),d=0;d<n.length;d++)o=(s=n[d]).name+":",a=s.val+"",r.drawAttr(r.boxAttr,o,"#23b11f",a,"#23b11f",0,h,28),h+=42;else for(c=e+"_"+(l.level+1),u=Un.getIndex(c),i=(t=Un.MODEL.attrs(u))?JSON.parse(t):null,n=aa.formatNewAttrToChinese(i,!1,!0,!0),d=0;d<n.length;d++)o=(s=n[d]).name+":",a="0",r.drawAttr(r.boxAttr,o,"#90877b",a,"#90877b",0,h,28),h+=38;r.skillDesc.innerHTML="",r.skillDesc.leading=6;var _=l.skills;oB.ins.getTalentSkillInfo();for(var f in _){var p=_[f],g=oB.ins.getTalentByPosLvl(e,p.pos,p.level);if(0!=g){var v=Ls.getIndex(g),m=Ls.MODEL.skillName(v),y=Ls.MODEL.skillDesc(v);r.skillDesc.innerHTML+=m+":"+y+Ql.newline()}}var I=oB.ins.skillInfo[e];for(d=0;d<I.length;d++){I[d];if(I[d].lockLevel<=l.level){var b=I[d].skillId,w=Ls.getIndex(b),x=Ls.MODEL.skillName(w);r.skillDesc.innerHTML+="&nbsp;"+Ql.newline()+x+":"+I[d].desc+Ql.newline()}}r.height=r.skillDesc.y+r.skillDesc.contextHeight+40,r.parent||(eq.panelLayer.on("MASK_CLOSE",r,r.onClick),eq.panelLayer.openTip(r))},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px 黑体",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!eq.panelLayer.closeTip(this)&&eq.panelLayer.close(this):eq.panelLayer.close(this);eq.panelLayer.off("MASK_CLOSE",this,this.onClick)},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.soulout.soulskin.SoulSkinAttDetailUI._$SET_ins),t._ins=null,t}(),xK=function(e){function t(){t.__super.call(this)}b(t,"modules.soul.views.soulskin.SoulSkinItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&(this.img_icon.skin=_r.getAtlasSubPath("soulskin/ys"+e.type+".png"),this.imgNoActive.visible=0==e.level,this.img_red.visible=oB.ins.getRedPointByType(e.type),this.labLevel.visible=0!=e.level,this.labLevel.text=oB.ins.getLevelByLevel(e.level,e.type))}),t}(Ff),SK=function(e){function t(){var e=this;e._infoAll=null,e._curWearSkin=0,e._info=null,e._type=-1,e._showStarEff=!1,e.titleTween=null,e._listArr=null,e._oldSelectIdx=-1,e._showEff=!1,e._gridRes=null,e._isEnouph=!0,e._csuId=0,e._canUpEff=null,e._sbox=null,e.effStar=null,e._skillGrids=new Array,t.__super.call(e)}b(t,"modules.soul.views.soulskin.SoulSkinView",Wf);var i=t.prototype;return i.initialize=function(){var e=this;e.listType.itemRender=xK,e.listType.repeatY=5,e.listType.repeatX=1,e.listType.selectEnable=!0,e.listType.mouseEnabled=!0,e.listType.selectHandler=ql.create(e,e.onSelectedHandler,null,!1),e._gridRes=new MF(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x-47,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e.box_c.addChild(e._gridRes)},i.onAdd=function(e){var t=this;oB.ins.isFirstLogin=!1,ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.soulAvtar.y=237,t.soulAvtar&&(t.titleTween=Og.to(t.soulAvtar,{y:232},500,null,ql.create(t,t.shareHandler)))},i.shareHandler=function(){var e=this;232==e.soulAvtar.y?e.titleTween=Og.to(e.soulAvtar,{y:242},1e3,null,ql.create(e,e.shareHandler)):242==e.soulAvtar.y?e.titleTween=Og.to(e.soulAvtar,{y:237},500,null,ql.create(e,e.shareHandler)):237==e.soulAvtar.y&&(e.titleTween=Og.to(e.soulAvtar,{y:232},500,null,ql.create(e,e.shareHandler)))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.titleTween&&this.titleTween.clear(),this.clearCanUpEff(),G.timer.clearAll(this)},i.updateByVSC=function(e){var t=this;if(e)if("BP_UPDATE"!=e.actionOrder){var i=e;if(t._infoAll=oB.ins.info,t._curWearSkin=i.curWearSkin,-1<t._type)t._infoAll[t._type].level>t._info.level&&0!=t._info.level?t._showStarEff=!0:t._showStarEff=!1,t._infoAll[t._type].level>t._info.level&&0==t._info.level&&hN.ins.open("SoulSkinActiveView",{type:t._type,name:oB.ins.getNameByType(t._type)}),t._info=t._infoAll[t._type],t.listType.changeItem(t._type-1,t._info),t.updatePanel(),t.listType.refresh();else{for(var n in t._listArr=[],t._infoAll)t._listArr.push(t._infoAll[n]);t.listType.array=t._listArr,G.timer.once(50,t,t.typeSelect)}}else t.updateConsume()},i.typeSelect=function(){var e=-1;if(0<oB.openType)e=oB.openType-1,oB.openType=-1;else if(0<this._curWearSkin)e=this._curWearSkin-1;else for(var t=this._listArr.length;0<=t;t--){var i=this._listArr[t];if(i&&0<i.level){e=t;break}}-1==e&&(e=0),this.listType.selectedIndex=e},i.onSelectedHandler=function(e){if(this._oldSelectIdx!=e){this._oldSelectIdx=e,this._showEff=!0;var t=this.listType.getItem(e);t&&(this._info=t,this._type=this._info.type,this.updatePanel())}},i.updatePanel=function(){var e=this;e.soulAvtar.skin=_r.getFullUrl("ui/images/soul/yshh_zs_"+Math.max(e._type,1)+".png"),e.soulname.skin=_r.getFullUrl("ui/images/soul/yshh_bqwz_"+Math.max(e._type,1)+".png"),e.updateConsume(),e.updateStar(),e.updateAttrs(),e.updateSkills(),e.btnWear.visible=e._type!=e._curWearSkin,e.btnCancelWear.visible=e._type==e._curWearSkin},i.updateConsume=function(){var e=this;0==e._info.level?e.btnUpgrade.label="激 活":e.btnUpgrade.label="升 星";var t=e._type+"_"+(e._info.level+1),i=Un.getIndex(t);if(i||0==i){e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!0,e.btnUpgrade.visible=!0,e.maxLevel.visible=!1;var n=Un.MODEL.consumeDef(i);if(n){var s=JSON.parse(n)[0].value.split(":"),o=parseInt(s[0]),a=parseInt(s[1]),r=TR.ins.getGoodsNum(o);e._gridRes.bindData=yB.create(o),e._csuId=o,a<=r?(e._isEnouph=!0,e.txt_cost.innerHTML=Ql.createColor(r+"","#23b11f")+"/"+a,e.btnUpgrade.showTip=!0):(e._isEnouph=!1,e.txt_cost.innerHTML=Ql.createColor(r+"","#ff2e24")+"/"+a,e.btnUpgrade.showTip=!1)}}else e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btnUpgrade.visible=!1,e.maxLevel.visible=!0},i.updateSkills=function(){for(var e=this;e._skillGrids.length;)e._skillGrids.pop().removeSelf();var t=0,i=oB.ins.skillInfo[e._type];if(i)for(t=0;t<i.length;t++){var n=e.getSkillGrid();e._skillGrids.push(n),n.pos(265+101*t,864),e.box_c.addChild(n),n.on("click",e,e.onClickNormal),n.update(i[t],e._info.level),n.tag={info:i[t],isTalent:!1,curLevel:e._info.level,type:e._type}}var s=oB.ins.getTalentSkillInfo()[e._type];if(e.clearCanUpEff(),G.timer.clear(e,e.clearCanUpEff),s){for(t=0;t<s.length;t++){var o=e.getSkillGrid();e._skillGrids.push(o),o.pos(106+101*t,864),e.box_c.addChild(o),o.on("click",e,e.onClickNormal),o.update(s[t],e._info.level,!0),o.tag={info:s[t],isTalent:!0,skillInfo:e._info.skills,curLevel:e._info.level,type:e._type},EY.ins.parent&&EY.ins._isTalent&&EY.ins.show(o.tag)}if(e._showEff){if(e._showEff=!1,!e._info.skills[1])return;0<oB.ins.getTalentByPosLvl(e._info.type,e._info.skills[1].pos,e._info.skills[1].level+1)&&0<e._info.level&&(e._canUpEff=kB.createEffect("jm1498",152,936,e.box_c),G.timer.once(3e3,e,e.clearCanUpEff))}}},i.clearCanUpEff=function(){this._canUpEff&&this._canUpEff.dispose(),this._canUpEff=null},i.onClickNormal=function(e){var t=e.currentTarget;t&&EY.ins.show(t.tag)},i.getSkillGrid=function(){return new bK},i.updateAttrs=function(){var e=this;e.boxleft.graphics.clear(),e.boxright.graphics.clear();var t,i,n,s,o,a,r=e._type+"_"+(e._info.level+1),l=Un.getIndex(r),c=0,u=15;if(0<=l){for(e.mc_arrow.visible=!0,e.boxleft.x=119,e.boxright.visible=!0,e.imgAttrRight.visible=!0,e.imgAttrLeft.x=119,i=(t=Un.MODEL.attrs(l))?JSON.parse(t):null,n=aa.formatNewAttrToChinese(i,!1,!0,!1),c=0;c<n.length;c++)o=(s=n[c]).name+":",a=s.val+"",e.drawAttr(e.boxright,o,"#23b11f",a,"#23b11f",20,u,24),u+=26;if(u=15,r=e._type+"_"+e._info.level,0==(l=Un.getIndex(r))||l){for(i=(t=Un.MODEL.attrs(l))?JSON.parse(t):null,n=aa.formatNewAttrToChinese(i,!1,!0,!1),c=0;c<n.length;c++)o=(s=n[c]).name+":",a=s.val+"",e.drawAttr(e.boxleft,o,"#90877b",a,"#90877b",20,u,24),u+=26;e.fcForce.value=RR.getFight(i)+oB.ins.getSkillFight(e._type)}else{for(c=0;c<n.length;c++)o=(s=n[c]).name+":",a="0",e.drawAttr(e.boxleft,o,"#90877b",a,"#90877b",20,u,24),u+=26;e.fcForce.value=0}}else{for(e.boxleft.x=263,e.imgAttrLeft.x=263,e.boxright.visible=!1,e.mc_arrow.visible=!1,e.imgAttrRight.visible=!1,r=e._type+"_"+e._info.level,l=Un.getIndex(r),i=(t=Un.MODEL.attrs(l))?JSON.parse(t):null,n=aa.formatNewAttrToChinese(i,!1,!0,!1),c=0;c<n.length;c++)o=(s=n[c]).name+":",a=s.val+"",e.drawAttr(e.boxleft,o,"#90877b",a,"#90877b",20,u,24),u+=26;e.fcForce.value=RR.getFight(i)+oB.ins.getSkillFight(e._type)}},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px 黑体",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.updateStar=function(){var e=this;e.clearStarEff(),e._sbox&&e._sbox.graphics.clear(),e._sbox||(e._sbox=new dt,e._sbox.pos(98,640),e.box_c.addChild(e._sbox));var t,i=e._type+"_"+e._info.level,n=Un.getIndex(i);if(n||0==n){var s=Un.MODEL.step(n),o=Un.MODEL.star(n);t=mp.getChineseNum(s)}else t="一";0<=t.indexOf("零")&&(t=t.slice(0,t.indexOf("零")));var a=(e.gra0.value=t).length;1<a?(e.imgJie.y=e.gra0.y+27*a+5,e.img_lvlbg.height=72+27*a):(e.imgJie.y=86,e.img_lvlbg.height=130);var r,l;l=_r.getAtlasSubPath("soulskin/xz_img_star1.png"),r=G.loader.getRes(l);for(var c=0;c<o;c++)e._sbox.graphics.drawTextures(r,[52*c-1,-4]);e.setStar(o)},i.setStar=function(e){this._showStarEff&&(this._showStarEff=!1,0!=this._info.level&&0!=e&&(this.clearStarEff(),this.effStar||(this.effStar=kB.createEffect("jm1217",52*(e-1)+21,20,this.boxStar))))},i.clearStarEff=function(){this.effStar&&this.effStar.dispose(),this.effStar=null},i.onClick=function(e){var t=this;switch(e.target){case t.btnRule:case t.btnRule1:QR.goToOpenHelpDes(14);break;case t.btnUpgrade:if(!t._isEnouph&&0==t._info.level)return void hN.ins.open("SoulSkinGoodsTip",t._csuId);var i=new iP;i.type=t._type,Tu.sendToService(i);break;case t.btnWear:if(!t._info||0==t._info.level)return void zB.ins.playErrorMsg(RP.n[1077]);if($f.instance.souloutVo.souloutGrade<5)return void zB.ins.playErrorMsg(RP.n[1078]);var n=oB.ins.getWearCanClick();if(0<n)return void zB.ins.playErrorMsg(RP.n[1079]+n+"秒");var s=new nP;s.type=t._type,s.oper=1,Tu.sendToService(s);break;case t.btnCancelWear:var o=oB.ins.getWearCanClick();if(0<o)return void zB.ins.playErrorMsg(RP.n[1080]+o+"秒");var a=new nP;a.type=t._type,a.oper=2,Tu.sendToService(a);break;case t.btnXiang:if(!t._info||0==t._info.level)return void zB.ins.playErrorMsg(RP.n[1081]);wK.ins.show(t._type)}},t}(),kK=function(e){function t(){var e=this;e._orgX=0,e._orgY=0,e._handEff=null,e.imgActiveRing=null,e.tween1=null,e.tween2=null,e.tween3=null,e.tween4=null,e.titleTween=null,e.ballTween=null,e._data=0,e.isOver=!1,e._bindData=0,e._recordTime=NaN,t.__super.call(e),e.centerX=e.centerY=0}b(t,"modules.specialgodring.view.SGRActivedShowView",lp);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this._handEff&&(this._handEff.parent&&this._handEff.parent.removeChild(this._handEff),this._handEff.dispose(),this._handEff=null),laya.ui.View.prototype.destroy.call(this,e)},i.showData=function(e){var t=this;t.isOver=!1,t._data=e,t.clearTweens(),t.txtRingName.skin=_r.getSpecialGodRingVTitlePath(t._data),t.box_active.alpha=0,t.txtRingName.scale(0,0),t.txt_name_bg.scale(0,0),t.box_active.centerX=0,null==t.tween1&&(t.tween1=new Og),t.tween1.to(t.box_active,{alpha:1},500,pa.linearIn,ql.create(t,t.showHandEff)),G.timer.once(1100,t,t.addClickFun),t.on("click",t,t.onClickViewListener)},i.addClickFun=function(){this.isOver=!0},i.getRingPoint=function(){return sJ.ins.getCompomentsByName("NavBottom").btnBag.localToGlobal(new Uh(45,45))},i.onClickViewListener=function(e){this.onClick()},i.clearTweens=function(){var e=this;e.tween1&&e.tween1.clear(),e.tween2&&e.tween2.clear(),e.tween3&&e.tween3.clear(),e.tween4&&e.tween4.clear(),e.titleTween&&e.titleTween.clear(),e.ballTween&&e.ballTween.clear(),e._handEff&&(e._handEff.parent&&e._handEff.parent.removeChild(e._handEff),e._handEff.dispose(),e._handEff=null),e.imgActiveRing&&(e.imgActiveRing.alpha=0,e.imgActiveRing.parent&&e.imgActiveRing.parent.removeChild(e.imgActiveRing),e.imgActiveRing.skin=null,e.imgActiveRing=null),e.off("click",e,e.onClickViewListener)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTweens()},i.onClick=function(){if(0!=this.isOver){switch(""!=Qt.MODEL.reward(this._bindData)&&this.flyTobag(),this._bindData){case 0:hN.ins.open("SOARING_VIEW",{__subIndex_:parseInt("4")},null,!0);break;case 1:break;case 2:Tu.sendToModule("OPEN_DAILY_VIEW",["modules.newDailyAct.NewDailyActModule"]);break;case 3:Tu.sendToModule("OPEN_ACHIEVE_NEW_MAIN_VIEW",["modules.achievenew.AchieveNewModule"],{_subIndex_:"3"})}2==this._bindData||3==this._bindData||(this._bindData,parseInt($e.MODEL.value($e.getIndex(158)))),hN.ins.close("SGRING_ACTIVED_SHOW_VIEW")}},i.onComposeShow=function(){var e=this;e.graphics.clear(),e.graphics.drawRect(0,0,e.width,e.height,"#000000"),UB.ins.playSound("23",3,!0),e._bindData=e._data;var t=_r.getSpecialGodRingIconPath(e._bindData);null==e.imgActiveRing?e.imgActiveRing=new Kl(t):e.imgActiveRing.dataSource=t,null==e.imgActiveRing.parent&&e.addChild(e.imgActiveRing),e.imgActiveRing.anchorX=.5,e.imgActiveRing.anchorY=.5,4==e._data?(e.imgActiveRing.x=60+(e.width-e.imgActiveRing.width/2>>1),e._orgY=e.imgActiveRing.y=(e.height-e.imgActiveRing.height/2>>1)-50):6==e._data?(e.imgActiveRing.x=90+(e.width-e.imgActiveRing.width/2>>1),e._orgY=e.imgActiveRing.y=(e.height-e.imgActiveRing.height/2>>1)-40):11==e._data?(e.imgActiveRing.x=60+(e.width-e.imgActiveRing.width/2>>1),e._orgY=e.imgActiveRing.y=(e.height-e.imgActiveRing.height/2>>1)-40):(e.imgActiveRing.x=50+(e.width-e.imgActiveRing.width/2>>1),e._orgY=e.imgActiveRing.y=(e.height-e.imgActiveRing.height/2>>1)-50),e.imgActiveRing.scale(0,0),e.onComposeShowRingName(),null==e.ballTween&&(e.ballTween=new Og),e.ballTween.to(e.imgActiveRing,{scaleX:1,scaleY:1},200,pa.linearIn)},i.showHandEff=function(){var e=this;null==e._handEff&&(e._handEff=kB.createEffect("jm1034",480,399,e.img_bg)),e._handEff.alpha=0,null!=e.tween4?e.tween4.clear():e.tween4=new Og,e.tween4=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onEffectComplete))},i.onComposeShowRingName=function(){null==this.tween2&&(this.tween2=new Og),this.tween2.to(this.txtRingName,{x:175,scaleX:1,scaleY:1},200,pa.linearIn),null==this.tween3&&(this.tween3=new Og),this.tween3.to(this.txt_name_bg,{x:168,scaleX:1,scaleY:1},200,pa.linearIn),this.isOver=!0},i.onEffectComplete=function(){var e=this;e.onComposeShow(),e.onComposeShowRingName(),null==e.titleTween&&(e.titleTween=new Og),e.imgActiveRing.y=e._orgY,e.imgActiveRing&&(e.titleTween=Og.to(e.imgActiveRing,{y:e._orgY-5},500,pa.linearIn,ql.create(e,e.shareHandler)))},i.shareHandler=function(){var e=this;e.imgActiveRing.y==e._orgY-5?e.titleTween=Og.to(e.imgActiveRing,{y:e._orgY+10},1e3,pa.linearIn,ql.create(e,e.shareHandler)):e.imgActiveRing.y==e._orgY+10?e.titleTween=Og.to(e.imgActiveRing,{y:e._orgY},500,pa.linearIn,ql.create(e,e.shareHandler)):e.imgActiveRing.y==e._orgY&&(e.titleTween=Og.to(e.imgActiveRing,{y:e._orgY-5},500,pa.linearIn,ql.create(e,e.shareHandler)))},i.flyTobag=function(){var e=Qt.MODEL.reward(this._bindData),t=JSON.parse(e),i=[];if(t&&0<t.length){for(var n=0;n<t.length;n++){var s=t[n].value,o=parseInt(s.split(":")[0]);i.push(o)}zB.ins.playGetItems(i)}},t.HANDEFFID="jm1034",t}(),EK=function(e){function t(){this.RING_POSITIONS=[{x:-252,y:-132},{x:-253,y:-142},{x:-252,y:-105},{x:-257,y:-142},{x:-252,y:-142},{x:-257,y:-142},{x:-355,y:-138},{x:-253,y:-120},{x:-252,y:-132},{x:-256,y:-132},{x:-252,y:-135},{x:-355,y:-138},{x:-248,y:-135},{x:-248,y:-135},{x:-248,y:-122},{x:-251,y:-135},{x:-250,y:-132},{x:-250,y:-132},{x:-252,y:-142},{x:-252,y:-105},{x:-254,y:-140},{x:-253,y:-85},{x:-252,y:-135},{x:-253,y:-135},{x:-241,y:-135},{x:-249,y:-132},{x:-255,y:-135},{x:-252,y:-140}],this._data=-1,this.ringModel=null,this.addActive=null,this.sp=null,this.status="",t.__super.call(this),this.ringModel=aB.instance}b(t,"modules.specialgodring.view.item.SGRRightItem",up);var i=t.prototype;return i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.addActive&&(t.addActive.parent&&t.addActive.parent.removeChild(t.addActive),t.addActive&&t.addActive.dispose(),t.addActive=null),t.btn&&t.btn.skin&&G.loader.clearRes(t.btn.skin),laya.ui.View.prototype.destroy.call(t,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.addActiveEff(!1)},i.addActiveEff=function(e){var t=this;void 0===e&&(e=!1),1==e?(null==t.addActive&&(t.addActive=kB.createEffect("jm1353",0,0,t),t.addActive.mouseEnabled=!1),t.addActive.pos(125,112)):t.addActive&&(t.addActive.parent&&t.addActive.parent.removeChild(t.addActive),t.addActive&&t.addActive.dispose(),t.addActive=null)},i.setFilter=function(e){this.filters=e},i.onClick=function(e){"active_no"==this.status?zB.ins.playErrorMsg(RP.n[1082]):Tu.sendToModule("OPEN_SGR_ACTIVE_VIEW",["modules.specialgodring.SpecialGodRingModule"],this._data)},i.clickItem=function(){"active_no"==this.status?zB.ins.playErrorMsg(RP.n[1082]):Tu.sendToModule("OPEN_SGR_ACTIVE_VIEW",["modules.specialgodring.SpecialGodRingModule"],this._data)},i.doShowGuide=function(){var e=PH.Ins().info;if(!LY.showing&&e&&2==e.status){var t=new u_;0<e.getCurrentGuide(25)?(t.x=300,t.y=25,t.width=100,t.height=this.height/2,LY.Ins().show(25,t,!1,this)):0<e.getCurrentGuide(26)&&(t.x=200,t.y=25,t.width=this.width/2,t.height=this.height/2,LY.Ins().show(26,t,!1,this))}},p(0,i,"data",function(){return this._data},function(e){var t=!0;if(this._data==e&&(t=!1),this._data=e,this.selected=!1,this.ringModel.activedRingId>this._data?(this.status="active_ok",this.addActiveEff(!1),this.setFilter(null)):this.ringModel.activedRingId==this._data?(this.status="active_ing",this.addActiveEff(!0),this.setFilter(null),this.selected=!0,this.doShowGuide()):(this.status="active_no",this.addActiveEff(!1),this.setFilter(A_.getGrayFilter())),t){this.img_ring.skin=_r.getSpecialGodRingIconPath(this._data);var i=A_.getRingPos(this._data);null!=this.RING_POSITIONS[this._data]&&(this.img_ring.x=this.RING_POSITIONS[this._data].x+i.x,this.img_ring.y=this.RING_POSITIONS[this._data].y+i.y),this.img_ring.scaleX=this.img_ring.scaleY=.8,this.img_title.skin=_r.getSpecialGodRingTitlePath(this._data),this.txtRingDesc.text=Qt.MODEL.ringDesc(this._data)}}),p(0,i,"selected",null,function(e){var t=this;e?(t.img_border.skin=_r.getFullUrl("ui/layouts/specialgodring/tj_xz_jzk_xz.png"),t.img_border.scaleX=t.img_border.scaleY=1.1,t.img_select.visible=!0,t.img_border.x=-13):(t.img_border.skin=_r.getFullUrl("ui/layouts/specialgodring/tj_xz_jzk.png"),t.img_border.scaleX=t.img_border.scaleY=1,t.img_select.visible=!1,t.img_border.x=-1)}),t}(),TK=function(e){function t(){var e=this;e.taskEffect=null,e.showAreaRect=new u_,t._instance=e,t.__super.call(e),e.mask_top.on("click",e,e.emptyHandler),e.mask_bottom.on("click",e,e.emptyHandler),e.mask_left.on("click",e,e.emptyHandler),e.mask_right.on("click",e,e.emptyHandler),e.mouseThrough=!0,e.mask_box.mouseThrough=!0,e.img_selected.visible=!1,e.mask_box.alpha=0}b(t,"modules.task.views.LockMaskView",wc);var i=t.prototype;return i.onStageClick=function(e){this.showAreaRect&&this.showAreaRect.contains(e.stageX,e.stageY)&&hN.ins.close("LOCK_SCENE_HOLLOW")},i.showEffect=function(){var e=this;e.taskEffect||(e.taskEffect=mj.GetNew(),e.taskEffect.reset(),e.taskEffect.renderInSelf=!0,e.taskEffect.id="lockScene_jm1269",e.taskEffect.loadEffect("jm1269"),e.addChild(e.taskEffect),e.taskEffect.scale_X=2,e.taskEffect.scale_Y=2),e.taskEffect.setXY(e.img_selected.x+e.img_selected.width/2,e.img_selected.y+e.img_selected.height/2),e.taskEffect.visible=!0},i.hideEffect=function(){this.taskEffect&&(this.taskEffect.visible=!1)},i.emptyHandler=function(e){this.showEffect(),G.timer.once(1e3,this,this.hideEffect)},i.showPanel=function(e,t){this.img_selected.x=t.vx-10,this.img_selected.y=t.vy-10,this.img_selected.width=t.vw+20,this.img_selected.height=t.vh+20,this.show(t.vx,t.vy,t.vw,t.vh),this.stage&&this.stage.on("click",this,this.onStageClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.hideEffect(),this.stage&&this.stage.off("click",this,this.onStageClick)},i.show=function(e,t,i,n){var s=this;s.mask_top.height=t,s.mask_bottom.height=s.height-(t+n),s.mask_left.width=e,s.mask_right.width=s.width-(e+i),s.showAreaRect.x=e,s.showAreaRect.y=t,s.showAreaRect.width=i,s.showAreaRect.height=n},t.ins=function(){return t._instance||(t._instance=new t),t._instance},t._instance=null,t.EFFECT="jm1269",t}(),CK=function(e){function t(){this.directId=156,this.showList=[],this._achieves=null,t.__super.call(this),this.init()}b(t,"modules.task.views.PlayerUpgradeDirectionView",Gh);var i=t.prototype;return i.init=function(){this.closeBtn.on("click",this,this.onClick)},i.update=function(){var e=this,t=$e.getIndex(e.directId),i=$e.MODEL.value(t);if(e.showList.length=0,i&&0<i.length){for(var n=i.split(";"),s=[],o=/starlevel_\d+/g,a=0;a<n.length;a++){var r=n[a],l=0,c=!0,u=r.match(o);if(u){var d=u[0];d&&(l=parseInt(d.split("_")[1]))}var h=r.split("|");1==parseInt(h[0])?h[2]>gR.ins.lv&&(c=!1):2==parseInt(h[0])&&h[3]>gR.ins.lv&&(c=!1),s.push({open:c,star:l,link:r})}s.sort(e.sortFunc),e.showList=s}0<e.showList.length&&(e._achieves||(e._achieves=new FF,e._achieves.x=35,e._achieves.y=410,e.addChild(e._achieves)),e._achieves.update(e.showList)),e._achieves&&(e._achieves.visible=0<e.showList.length),e.height=810},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.update()},i.sortFunc=function(e,t){return e.open==t.open?e.star==t.star?0:e.star>t.star?-1:1:e.open>t.open?-1:1},i.onClick=function(){hN.ins.close("PLAY_UPGRADE_DIRECTION")},t}(),LK=(function(e){function t(){this._selector=null,this._role=-1,this._panel=null,t.__super.call(this),this.initUI()}b(t,"modules.title.views.TitleShowV",ig);var i=t.prototype;i.initUI=function(){var e=this;e._panel=new Cj,Cj.defH=130,e._panel.width=608,e._panel.top=245,e._panel.bottom=149,e._panel.centerX=0,e._panel.vScrollBarSkin="",e._panel.vScrollBar.elasticBackTime=300,e._panel.vScrollBar.elasticDistance=100,e.addChild(e._panel),e.addChild(e.img_shadow),e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e._selector.on("select",e,e.onSelectRole)},i.onSelectRole=function(){this._selector.selectIdx!=this._role&&(this._role=this._selector.selectIdx,this._panel.toggleClose(),this.update())},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._panel.toggleClose(),this._selector.selectIdx=Nj.globalIdx,this._role=this._selector.selectIdx;var t=new XM;Tu.sendToService(t),this.btn_total.on("click",this,this.openTotal)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Tu.sendToService(new KM),this.btn_total.off("click",this,this.openTotal)},i.openTotal=function(){Tu.sendToModule("OPEN_TOTALV",["modules.fashion.FashionModule"])},i.update=function(){var e=tg.ins.toc_title;if(null!=e){for(var t,i=0;i<3;i++){t=gR.ins.actorList[i],this._selector.setRedPtByIdx(i,!1);for(var n=e.titles[i],s=0;s<n.length;s++)if(0==n[s].tipState&&t){this._selector.setRedPtByIdx(i,!0);break}}tg.ins.role=this._role;var o=[],a=e.titles[this._role].length;for(i=0;i<a;i++)o.push(i);this._panel.datas=o}}}(),function(e){function t(){this.data=null,this.item=null,t.__super.call(this)}b(t,"modules.treasure.views.item.TrExchangeItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_exchange.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_exchange.off("click",this,this.onClick)},i.onClick=function(){if(this.data){if(gR.ins.dragonsuipian<this.data.costCount)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:2524});OR.requestExchange(this.data.exChangeId,1)}},i.update=function(){var e=this;if(e.data){gR.ins.dragonsuipian>=e.data.costCount?(e.btn_exchange.showTip=!0,e.txt_cost.innerHTML=Ql.createColor(gR.ins.dragonsuipian+"","#23b11f")+"/"+e.data.costCount):(e.btn_exchange.showTip=!1,e.txt_cost.innerHTML=Ql.createColor(gR.ins.dragonsuipian+"","#ff2e24")+"/"+e.data.costCount),e.item||(e.item=new MF,e.item.isClearUrl=!1,e.item.pos(e.itembg.x,e.itembg.y),e.item.toolTipEnabled=!1,e.addChild(e.item));var t=KH.create(e.data.targetId);(e.item.bindData=t).dragonIndex=1,e.txt_name.changeText(t.name+"Lv."+jt.MODEL.level(t.dragonIndex-1)),e.txt_name.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(Bi.getIndex(e.data.targetId)));for(var i,n=0,s=0;s<Yt.count;s++)Yt.MODEL.toolsId(s)==e.data.targetId&&(n=Yt.MODEL.unlock(s),i=Yt.MODEL.chineseNum(s));0==n?e.txt_geway.changeText(RP.n[1084]):e.txt_geway.changeText(i),e.txt_geway.color="#23b11f",e.clearAttrs();var o=aa.formatAttrToChineseByList(Bi.MODEL.attributes(Bi.getIndex(e.data.targetId)));e.drawLeftText(o)}},i.clearAttrs=function(){for(var e=0;e<4;e++){var t=this["txt_attr_l"+e],i=this["txt_attrname_l"+e];t.visible=!1,t.style.wordWrap=!1,i.visible=!1}},i.drawLeftText=function(e,t,i,n,s){void 0===t&&(t=!0),void 0===i&&(i="#90877b"),void 0===n&&(n=""),void 0===s&&(s="");var o=0;o=1==e.length?40:2==e.length?26:7;for(var a=0;a<e.length;a++){var r=e[a],l=aa.getAttributById(r.id).getModuleName(r.module)+":",c=this["txt_attr_l"+a],u=this["txt_attrname_l"+a];c.visible=!0,u.visible=!0,c.y=o,u.y=o,u.innerHTML=l,c.x=u.x+u.contextWidth,t?c.innerHTML="<font style='color:"+i+";'>"+n+r.val+s+"</font>":c.innerHTML+="<font style='color:"+i+";'>"+n+r.val+s+"</font>",o+=u.contextHeight+10}},i.drawText=function(e,t,i,n,s,o,a,r){var l;if(void 0===s&&(s="left"),void 0===o&&(o="#ffffff"),void 0===a&&(a=25),void 0===r&&(r=!0),r&&e.clear(),!(null==n||n.length<=0))for(var c=0;c<n.length;c++)l=n[c],e.fillText(l.name+"："+l.val,t,i,"22px SimHei",o,s),i+=a},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){this.data=e,this.update()}),t}(kg)),MK=function(e){function s(){var e,t,i=this;i._item=0,i._cdTime=0,i.result_list=null,i.record_list=null,i.grid_list=[],i.award_list=[],i.showTextArr=[],i.showArrIndex=[],i.weekCount=0,i._effect=null,i.mask_mc=null,i.resGird1=null,i.resGird2=null,i.sp_reddot=null,s.__super.call(i),i._item=2020,i.list.itemRender=lq,i.list.vScrollBarSkin="",i.list.spaceY=10,i.list.scrollBar.elasticDistance=200;for(var n=0;n<12;n++)e=i["g"+n],(t=new MF).pos(e.x,e.y),i.box.addChild(t),i.grid_list.push(t);for(n=0;n<5;n++)(e=i["award"+n]).on("click",i,i.onitemClick),i.award_list.push(e);i.resGird1=new MF,i.resGird1.needGridBg=!1,i.resGird1.pos(i.itempic1.x-3,i.itempic1.y-2),i.box_d.addChild(i.resGird1),i.resGird2=new MF,i.resGird2.needGridBg=!1,i.resGird2.pos(i.itempic2.x-3,i.itempic2.y-2),i.box_d.addChild(i.resGird2),i.sp_reddot=new pp,i.sp_reddot.pos(0,71),i.addChild(i.sp_reddot),i.mask_mc=new pp,i.mask_mc.graphics.drawRect(0,0,i.blessball.width,i.blessball.height,"#000000"),i.mask_mc.pos(0,i.blessball.height),i.blessball.mask=i.mask_mc,i.txt_blessDes.changeText(ei.MODEL.content(ei.getIndex(3545))),"37h5"==hr.platform?(i.title37.visible=!0,i.titleother.visible=!1):(i.title37.visible=!1,i.titleother.visible=!0)}b(s,"modules.treasure.views.sub.TrChuanshiView",pg);var t=s.prototype;return t.showView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!0;for(var t=0;t<this.award_list.length;t++)this.award_list[t].visible=!0;this.resGird1.visible=!0,this.resGird2.visible=!0,this.updateStore(),this.updateFreeTimeStatus()},t.hideView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!1;for(var t=0;t<this.award_list.length;t++)this.award_list[t].visible=!1;this.resGird1.visible=!1,this.resGird2.visible=!1},t.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+42,e.y-6,t.width,t.height)},t.onitemClick=function(e){var t=e.target,i=this.showArrIndex[parseInt(t.name)],n=Kp.MODEL.times(Kp.getIndex(i));if(this.weekCount<n||0<=uB.ins.TrasureAwardArr.indexOf(i)){var s=Kp.MODEL.rewardDefs(Kp.getIndex(i)),o=JSON.parse(s)[0].value.split(":");Tu.sendToModule("TR_AWARDTIP",["modules.treasure.TreasureModule"],[this.weekCount,n-this.weekCount,o[0],o[1]])}else Eg.reqWeekAward(i)},t.updateByVSC=function(e){if("show"==e)this.showView(),this.updateKey(),this.updateInfo(),Eg.reqrecord(105);else if("hide"==e)this.hideView();else{if(hN.ins.isOpen("TREASURE_RESULT"))return;"30322"==e.actionOrder?(this.forHunt(e.proto.list),Eg.reqrecord(105)):"30324"==e.actionOrder||("30326"==e.actionOrder?this.updateRecord(e.proto.list):"30328"==e.actionOrder?this.updateInfo():"CHUANSHI_GUPDATE"==e.actionOrder&&(this.updateStore(),this.updateKey()))}},t.onAdd=function(e){var t=this;t.on("click",t,t.onClick),t.btn_help.on("click",t,t.onClickHelp),ui.ViewBase.prototype.onAdd.call(t,e),t.updateStore(),t.updateKey(),t.updateInfo(),t.updateDisplay(),Eg.reqrecord(105)},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),G.timer.clear(t,t.showTime),t.btn_help.off("click",t,t.onClickHelp),t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null)},t.onClickHelp=function(){QR.goToOpenHelpDes(17)},t.updateInfo=function(){var e,t=this;t.sp_reddot.graphics.clear(),t.txt_blessVaule.value=uB.ins.chuanshiBless+"",t.weekCount=uB.ins.getCountByType(105),t.txt_count.innerHTML=RP.n[1085]+Ql.createColor(t.weekCount+"","#23b11f"),t.bless_num.changeText(t.weekCount+""),t.showArrIndex=uB.ins.getShowArrByType(105);for(var i=0;i<t.showArrIndex.length;i++){e=t.award_list[i];var n=Kp.MODEL.rewardDefs(Kp.getIndex(t.showArrIndex[i])),s=(JSON.parse(n)[0].value.split(":"),Kp.MODEL.times(Kp.getIndex(t.showArrIndex[i])));Pg.gray(e,!1),t.weekCount>=s?(t["txt_ward"+i].innerHTML=Ql.createColor(s+"次","#23b11f"),0<uB.ins.TrasureAwardArr.length&&0<=uB.ins.TrasureAwardArr.indexOf(t.showArrIndex[i])?(Pg.gray(e,!0),t["txt_ward"+i].innerHTML=Ql.createColor("已领取","#23b11f")):t.drawReddot(e)):(Pg.gray(e,!0),t["txt_ward"+i].innerHTML=Ql.createColor(s+"次","#666666"))}t.updateTimeBar(),t.updateFreeTimeStatus()},t.updateRecord=function(e){this.record_list=e,20<this.record_list.length&&this.record_list.splice(0,this.record_list.length-20),this.list.array=this.record_list},t.loop=function(){if(this.record_list.length){var e=this.record_list.shift(),t=uB.ins.msgList;t.push(e),20<t.length&&t.splice(0,1),this.list.array=t,this.list.scrollBar.value=this.list.scrollBar.max}0==this.record_list.length&&G.timer.clear(this,this.loop)},t.forHunt=function(e){this._cdTime=BB.getTimer()+1200,this.result_list=e,this.openResult()},t.openResult=function(){hN.ins.open("TREASURE_RESULT",this.result_list),this.result_list=null},t.updateStore=function(){this.btn_store.showTip=0<uB.chuanshiModel.goodsList.length},t.updateKey=function(){var e=this,t=TR.ins.getGoodsNum(2020);e.btn_one.showTip=0<t,e.btn_ten.showTip=10<=t;var i=yB.create(2020);e.resGird1.bindData=i,e.resGird2.bindData=i,e.resGird1.scaleX=e.resGird2.scaleX=.5,e.resGird1.scaleY=e.resGird2.scaleY=.5,e.txt_num.innerHTML=1<=t?Ql.createColor(t+"/1","#23b11f")+")":Ql.createColor(t+"/1","#ff2e24")+")",e.txt_num2.innerHTML=10<=t?Ql.createColor(t+"/10","#23b11f")+")":Ql.createColor(t+"/10","#ff2e24")+")";var n=yB.createStr(Sa.MODEL.consumptions(24)),s=yB.createStr(Sa.MODEL.consumptions(25));e.txt_yb1.changeText(n.goodsNum+"("),e.txt_yb2.changeText(s.goodsNum+"("),e.updateFreeTimeStatus()},t.updateDisplay=function(){var e=this,t=0,i=0,n=uB.ins.getGroup(105);if(0<e.showTextArr.length)for(t=0;t<e.showTextArr.length;t++)e.showTextArr[t]&&(e.showTextArr[t].parent&&e.showTextArr[t].parent.removeChild(e.showTextArr[t]),e.showTextArr[t].destroy(),e.showTextArr[t]=null);for(e.showTextArr=[],t=0;t<gc.count;t++)gc.MODEL.groupId(t)==Yo.MODEL.diggerGroupId(n)&&(e.updateGrid(gc.MODEL.goodsId(t),i,gc.MODEL.goodsNum(t)),i+=1);G.timer.loop(1e3,e,e.showTime,null,!1)},t.showTime=function(){this.txt_lefttime.changeText(RP.n[1086]+this.getLeftTime())},t.getLeftTime=function(){var e=dr.getZeroTime(dr.serverTimeSec),t=(7-dr.serverDate.getDay())*Jp.DATE_SECOND,i=(new Date(1e3*(e+=t)).getTime()/1e3>>0)-dr.serverTimeSec;return Jp.getSTRDHMS(i)},t.updateFreeTimeStatus=function(){var e=uB.ins.freeTimeHash;if(e){var t=e.take(105);this.btn_one.label=0<t?RP.n[1087]:RP.n[1088];var i=TR.ins.getGoodsNum(2020);this.btn_one.showTip=0<i||0<t}},t.updateTimeBar=function(){var e=0,t=Sa.MODEL.fullLuck(30),i=uB.ins.getChuanshiTime(),n=0,s=uB.ins.getCountByType(105);for(e=0;e<i.length;e++)s>=i[e]&&(n=e+1);this.bless_bar.scaleX=n/i.length,this.mask_mc.pos(0,this.blessball.height*(1-uB.ins.chuanshiBless/t))},t.updateGrid=function(e,t,i){if(t<this.grid_list.length){var n,s=this.grid_list[t];if((n=1<e.length?yB.create(e[gR.ins.actorById(1).job-1],i):yB.create(e[0],i)).disAchi=!1,s.bindData=n,t<this.grid_list.length-1){var o=kB.createText(s.x,s.y+s.height,116,50,Bi.MODEL.simpleName(n.cfgIdx),20,ms.getByQuality(Bi.MODEL.colourId(n.cfgIdx)),!1,"center",!1,!1,this);this.box.addChild(o),this.showTextArr.push(o)}this["g"+t].skin=NI.gridBg(Bi.MODEL.colourId(n.cfgIdx))}},t.onClick=function(e){if(!(BB.getTimer()-this._cdTime<500)){this._cdTime=BB.getTimer();var t=TR.ins.getGoodsNum(this._item);t=10<=t?10:t,e.target==this.btn_one?(this.btn_one.label==RP.n[1089]?uB.ins.reqOne(uB.ins.getReqType(105,1,0)):1<=t?uB.ins.reqOne(uB.ins.getReqType(105,1,0)):this.buyHandler(1),UB.ins.playSound("11")):e.target==this.btn_ten?(1<=t?uB.ins.reqOne(uB.ins.getReqType(105,t,0)):this.buyHandler(10),UB.ins.playSound("11")):e.target==this.btn_store&&Tu.sendToModule("TR_STORE",["modules.treasure.TreasureModule"],"CHUANSHI_GUPDATE")}},t.buyHandler=function(e){if(uB.ins.getShowTip(105,e))1==e?hN.ins.open("TREASURE_BUY",[105,1]):hN.ins.open("TREASURE_BUY",[105,10]);else{var t,i=uB.ins.getReqType(105,e,1);t=yB.createStr(Sa.MODEL.consumptions(Sa.getIndex(i))),gR.ins.YB<t.goodsNum?KQ.ins.showNoGold():uB.ins.reqOne(i)}},t.destroy=function(e){var t=this;void 0===e&&(e=!0);for(var i=0;i<t.grid_list.length;i++)t.grid_list[i]&&t.grid_list[i].skin&&G.loader.clearRes(t.grid_list[i].skin);t.sp_reddot&&(t.sp_reddot.parent.removeChild(t.sp_reddot),t.sp_reddot=null),t.resGird1&&(t.resGird1.parent&&t.resGird1.parent.removeChild(t.resGird1),t.resGird1.destroy(),t.resGird1=null),t.resGird2&&(t.resGird2.parent&&t.resGird2.parent.removeChild(t.resGird2),t.resGird2.destroy(),t.resGird2=null),laya.ui.View.prototype.destroy.call(t,e)},s}(),AK=function(e){function t(){this._data=null,this.index=0,this._BAR_W=0,this.iconPath=["icgoods104","icgoods105","icgoods106","icgoods107","icgoods112","icgoods112"],t.__super.call(this)}b(t,"modules.treasure.views.item.TrMysticalItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._BAR_W=this.bar.width,this.g_redPt.visible=this.g_got.visible=!1,this.g_item.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.g_item.off("click",this,this.onClickHandler)},i.resetShow=function(){var e=this;e._data&&(e.g_redPt.visible=!e._data.got&&e._data.allTimes>=Kp.MODEL.times(e.index),e.g_got.visible=e._data.got,!e._data.got&&e._data.allTimes<Kp.MODEL.times(e.index)?(e.g_icon.filters=A_.getGrayFilter(),e.g_item.filters=A_.getGrayFilter()):(e.g_icon.filters=null,e.g_item.filters=null))},i.onClickHandler=function(e){if(this._data){var t=Kp.MODEL.times(this.index);if(!this._data.got&&this._data.allTimes>=t)Eg.reqWeekAward(this._data.id);else{var i=Kp.MODEL.rewardDefs(this.index),n=JSON.parse(i)[0].value.split(":");Tu.sendToModule("TR_AWARDTIP",["modules.treasure.TreasureModule"],[this._data.allTimes,t-this._data.allTimes,n[0],n[1]])}}},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t._data=e,t.index=Kp.getIndex(t._data.id),-1==t._data.preId?(t.bar.sizeGrid="0,3,0,10",t.bar.skin=_r.getAtlasSubPath("basic_ui_g/ty_jdt_jd2.png")):(t.bar.sizeGrid="0,5,0,3",t.bar.skin=_r.getAtlasSubPath("basic_ui_g/ty_jdt_jd1.png")),t.iconPath[e.index]&&(t.g_icon.skin=_r.getAtlasSubPath("treasure/"+t.iconPath[e.index]+".png"));var i=-1==t._data.preId?0:Kp.MODEL.times(Kp.getIndex(t._data.preId)),n=Kp.MODEL.times(t.index),s=(t._data.allTimes-i)/(n-i);1<s&&(s=1),s<0&&(s=0);var o=t.bar.scrollRect||new u_(0,0,t.bar.width,t.bar.height);o.width=t._BAR_W*s,t.bar.scrollRect=o,t.txt_num.changeText((t._data.allTimes>n?n:t._data.allTimes)+"/"+n),t.txt_num.color=t._data.allTimes>=n?"#23b11f":"#ff2e24",t.resetShow()}}),t}(yg),DK=function(e){function t(){var e=this;e.grid_list=[],e.record_list=null,e.result_list=null,e._groupId=0,e.showTextArr=[],e._cdTime=0,e._item=0,e._effect=null,e.resGird1=null,e.resGird2=null,t.__super.call(e),e._item=2018,e.initView(),e.list.itemRender=lq,e.list.vScrollBarSkin="",e.list.spaceY=10,e.list.scrollBar.elasticDistance=200}b(t,"modules.treasure.views.sub.TrHuntView",gg);var i=t.prototype;return i.initView=function(){for(var e,t,i=this,n=0;n<16;n++)e=i["g"+n],(t=new MF).scaleX=.8,t.scaleY=.8,t.needGridBg=!1,t.pos(e.x,e.y),t.size(e.width,e.height),i.box.addChild(t),i.grid_list.push(t);e=i.g16,(t=new MF).needGridBg=!1,t.pos(e.x,e.y),i.box.addChild(t),i.grid_list.push(t),e=i.g17,(t=new MF).needGridBg=!1,t.pos(e.x,e.y),i.box.addChild(t),i.grid_list.push(t),i.resGird1=new MF,i.resGird1.needGridBg=!1,i.resGird1.pos(i.itempic1.x-3,i.itempic1.y-2),i.box_d.addChild(i.resGird1),i.resGird2=new MF,i.resGird2.needGridBg=!1,i.resGird2.pos(i.itempic2.x-3,i.itempic2.y-2),i.box_d.addChild(i.resGird2),"37h5"==hr.platform?(i.title37.visible=!0,i.titleother.visible=!1):(i.title37.visible=!1,i.titleother.visible=!0)},i.showView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!0;for(e=0;e<this.showTextArr.length;e++)17==e||16==e||(this.showTextArr[e].visible=!0);this.resGird1.visible=!0,this.resGird2.visible=!0,this.list.visible=!0,this.updateStore()},i.hideView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!1;for(e=0;e<this.showTextArr.length;e++)this.showTextArr[e].visible=!1;this.resGird1.visible=!1,this.resGird2.visible=!1,this.list.visible=!1},i.updateByVSC=function(e){if("show"==e)this.showView(),this.updateKey(),Eg.reqrecord(103);else if("hide"==e)this.hideView();else{if(hN.ins.isOpen("TREASURE_RESULT"))return;"30322"==e.actionOrder?(this.forHunt(e.proto.list),Eg.reqrecord(103)):"30324"==e.actionOrder||("30326"==e.actionOrder?this.updateRecord(e.proto.list):"EQUIP_GUPDATE"==e.actionOrder&&(this.updateStore(),this.updateKey()))}},i.onAdd=function(e){var t=this;t.on("click",t,t.onClick),t.txt_link.on("click",t,t.onLinkPath),t.btn_help.on("click",t,t.onClickHelp),ui.ViewBase.prototype.onAdd.call(t,e),t.updateStore(),t.updateKey(),t.updateDisplay(),Eg.reqrecord(103),t.txt_tip1.innerHTML=RP.n[1090]+Ql.createColor(RP.n[1091],"#e6d80d")+RP.n[1092]},i.onRemove=function(e){var t=this;if(ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.txt_link.off("click",t,t.onLinkPath),t.btn_help.off("click",t,t.onClickHelp),G.timer.clearAll(t),t.result_list){var i;for(var n in t.result_list){i=t.result_list[n];var s=Bi.getIndex(i.id),o=ms.getByQuality(Bi.MODEL.colourId(s)),a=Bi.MODEL.name(s)+"x"+i.num;zB.ins.showById2(2139,[o,a],2)}t.result_list=null}t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null)},i.onClickHelp=function(){QR.goToOpenHelpDes(15)},i.update=function(){this._groupId!=uB.ins.groupId&&(this._groupId=uB.ins.groupId,this.updateDisplay()),this.list.array=uB.ins.msgList},i.updateStore=function(){this.btn_store.showTip=0<uB.equipModel.goodsList.length},i.updateRecord=function(e){this.record_list=e,20<this.record_list.length&&this.record_list.splice(0,this.record_list.length-20),this.list.array=this.record_list},i.loop=function(){if(this.record_list.length){var e=this.record_list.shift(),t=uB.ins.msgList;t.push(e),20<t.length&&t.splice(0,1),this.list.array=t,this.list.scrollBar.value=this.list.scrollBar.max}0==this.record_list.length&&G.timer.clear(this,this.loop)},i.updateKey=function(){var e=this,t=TR.ins.getGoodsNum(2018);e.btn_one.showTip=0<t,e.btn_ten.showTip=10<=t;var i=yB.create(2018);e.resGird1.bindData=i,e.resGird2.bindData=i,e.resGird1.scaleX=e.resGird2.scaleX=.5,e.resGird1.scaleY=e.resGird2.scaleY=.5,e.txt_num.innerHTML=1<=t?Ql.createColor(t+"/1","#23b11f")+")":Ql.createColor(t+"/1","#ff2e24")+")",e.txt_num2.innerHTML=10<=t?Ql.createColor(t+"/10","#23b11f")+")":Ql.createColor(t+"/10","#ff2e24")+")";var n=yB.createStr(Sa.MODEL.consumptions(0)),s=yB.createStr(Sa.MODEL.consumptions(1));e.txt_yb1.changeText(n.goodsNum+"("),e.txt_yb2.changeText(s.goodsNum+"(")},i.forHunt=function(e){this._cdTime=BB.getTimer()+1200,this.result_list=e,this.openResult()},i.openResult=function(){hN.ins.open("TREASURE_RESULT",this.result_list),this.result_list=null},i.updateDisplay=function(){var e=this,t=0,i=0,n=uB.ins.getGroup(103);if(0<e.showTextArr.length)for(t=0;t<e.showTextArr.length;t++)e.removeChild(e.showTextArr[t]),e.showTextArr[t]=null;for(e.showTextArr=[],t=0;t<ya.count;t++)ya.MODEL.groupId(t)==Yo.MODEL.diggerGroupId(n)&&(e.updateGrid(ya.MODEL.goodsId(t),i),i+=1);null==e._effect&&(e._effect=kB.createEffect("jm1148",360,104,e))},i.updateGrid=function(e,t){if(t<this.grid_list.length){var i,n=this.grid_list[t];(i=1<e.length?yB.create(e[gR.ins.actorById(1).job-1]):yB.create(e[0])).disAchi=!1,n.bindData=i;var s=kB.createText(n.x-13,n.y+n.height-15,116,50,Bi.MODEL.simpleName(i.cfgIdx),20,ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx)),!1,"center",!1,!1,this);this.box.addChild(s),this.showTextArr.push(s),17!=t&&16!=t||(s.pos(n.x,s.y),s.visible=!1);var o=this["g"+t];o.skin=NI.gridBg(Bi.MODEL.colourId(i.cfgIdx)),this.setImage(o)}},i.onClick=function(e){if(!(BB.getTimer()-this._cdTime<500)){this._cdTime=BB.getTimer();var t=TR.ins.getGoodsNum(this._item);t=10<=t?10:t,e.target==this.btn_one?(1<=t?uB.ins.reqOne(uB.ins.getReqType(103,1,0)):this.buyHandler(1),UB.ins.playSound("11")):e.target==this.btn_ten?(1<=t?uB.ins.reqOne(uB.ins.getReqType(103,t,0)):this.buyHandler(10),UB.ins.playSound("11")):e.target==this.btn_store&&Tu.sendToModule("TR_STORE",["modules.treasure.TreasureModule"],"EQUIP_GUPDATE")}},i.buyHandler=function(e){if(uB.ins.getShowTip(103,e))1==e?hN.ins.open("TREASURE_BUY",[103,1]):hN.ins.open("TREASURE_BUY",[103,10]);else{var t,i=uB.ins.getReqType(103,e,1);t=yB.createStr(Sa.MODEL.consumptions(Sa.getIndex(i))),gR.ins.YB<t.goodsNum?KQ.ins.showNoGold():uB.ins.reqOne(i)}},i.destroy=function(e){var t=this;void 0===e&&(e=!0);for(var i=0;i<t.grid_list.length;i++)t.grid_list[i]&&t.grid_list[i].skin&&G.loader.clearRes(t.grid_list[i].skin);t.resGird1&&(t.resGird1.parent&&t.resGird1.parent.removeChild(t.resGird1),t.resGird1.destroy(),t.resGird1=null),t.resGird2&&(t.resGird2.parent&&t.resGird2.parent.removeChild(t.resGird2),t.resGird2.destroy(),t.resGird2=null),laya.ui.View.prototype.destroy.call(t,e)},i.setImage=function(e){var t=G.loader.getRes(e.skin);null!=t?t&&t.bitmap&&(t.bitmap.enableMerageInAtlas=!1):e.on("loaded",this,this.onLoadedImage,[,[e]])},i.onLoadedImage=function(e,t){t[0].off("loaded",this,this.onLoadedImage);var i=G.loader.getRes(t[0].skin);i&&i.bitmap&&(i.bitmap.enableMerageInAtlas=!1)},i.onLinkPath=function(){var e=YP.instance.cfgLimitLevel,t=YP.instance.cfgOpenServerDay;gR.ins.lv<e||dr.getOpenServiceDay()<t?zB.ins.showById(4371,1):hN.ins.open("NewDailyActMainView",{_subIndex_:"1"})},t}(),OK=function(e){function t(){this.wardArr=null,this.itemId=0,this.goodItem=null,t.__super.call(this),this.wardArr=[]}b(t,"modules.treasure.views.TrBigwardView",fg);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_ok.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.itemId=0,this.btn_ok.off("click",this,this.onClick)},i.onClick=function(e){this.itemId=0,this.showAward()},i.update=function(e){e&&0<e.length&&(this.wardArr=this.wardArr.concat(e)),this.showAward()},i.showAward=function(){var e,t=this;0<t.wardArr.length?0==t.itemId&&(t.itemId=t.wardArr.shift(),t.itemId&&(e=yB.create(t.itemId),t.goodItem||(t.goodItem=new MF,t.box.addChild(t.goodItem)),e&&(t.goodItem.bindData=e,t.txt_name.innerHTML=Ql.createColor(e.name,ms.getByQuality(Bi.MODEL.colourId(e.cfgIdx)))))):hN.ins.close("TREASURE_BIGWARD")},t}(),PK=function(e){function n(){var e,t=this;t._item=0,t._cdTime=0,t.result_list=null,t.showItemArr=null,t.award_list=null,t.showArrIndex=null,t.gridPanel=null,t.weekCount=0,t.mask_mc=null,t.resGird1=null,t.resGird2=null,t.sp_reddot=null,n.__super.call(t),t._item=2019,t.showItemArr=[],t.award_list=[];for(var i=0;i<5;i++)(e=t["ward"+i]).mouseEnabled=!0,e.on("click",t,t.onitemClick),t.award_list.push(e);t.gridPanel=new wj(4,4,116,10,29,!0,null,20),t.gridPanel.pos(21,158),t.gridPanel.height=555,t.addChild(t.gridPanel),t.addChildAt(t.g_mask,t.numChildren-1),t.gridPanel.vScrollBar.on("change",t,t.onScrollChanged),t.txt_blessDes.changeText(ei.MODEL.content(ei.getIndex(3544))),t.resGird1=new MF,t.resGird1.needGridBg=!1,t.resGird1.pos(t.itempic1.x-3,t.itempic1.y-2),t.box_d.addChild(t.resGird1),t.resGird2=new MF,t.resGird2.needGridBg=!1,t.resGird2.pos(t.itempic2.x-3,t.itempic2.y-2),t.box_d.addChild(t.resGird2),t.mask_mc=new pp,t.mask_mc.graphics.drawRect(0,0,t.blessball.width,t.blessball.height,"#000000"),t.mask_mc.pos(0,t.blessball.height),t.blessball.mask=t.mask_mc,t.sp_reddot=new pp,t.addChild(t.sp_reddot),"37h5"==hr.platform?(t.title37.visible=!0,t.titleother.visible=!1):(t.title37.visible=!1,t.titleother.visible=!0)}b(n,"modules.treasure.views.sub.TrLongwenView",vg);var t=n.prototype;return t.drawReddot=function(e){var t=G.loader.getRes(NI.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+e.width-30,e.y-1,t.width,t.height)},t.onitemClick=function(e){var t=e.target,i=this.showArrIndex[parseInt(t.name)],n=Kp.MODEL.times(Kp.getIndex(i));if(this.weekCount<n||0<=uB.ins.TrasureAwardArr.indexOf(i)){var s=Kp.MODEL.rewardDefs(Kp.getIndex(i)),o=JSON.parse(s)[0].value.split(":");Tu.sendToModule("TR_AWARDTIP",["modules.treasure.TreasureModule"],[this.weekCount,n-this.weekCount,o[0],o[1]])}else Eg.reqWeekAward(i)},t.showView=function(){this.gridPanel.visible=!0,this.resGird1.visible=!0,this.resGird2.visible=!0;for(var e=0;e<this.award_list.length;e++)this.award_list[e].visible=!0;this.updateStore()},t.hideView=function(){this.gridPanel.visible=!1,this.resGird1.visible=!1,this.resGird2.visible=!1;for(var e=0;e<this.award_list.length;e++)this.award_list[e].visible=!1},t.updateByVSC=function(e){if("show"==e)this.showView(),this.updateKey(),this.updateInfo();else if("hide"==e)this.hideView();else{if(hN.ins.isOpen("TREASURE_RESULT"))return;"30322"==e.actionOrder?this.forHunt(e.proto.list):"30324"==e.actionOrder||("30326"==e.actionOrder?this.updateInfo():"30328"==e.actionOrder?this.updateInfo():"LONGWEN_GUPDATE"==e.actionOrder&&(this.updateStore(),this.updateKey()))}},t.onAdd=function(e){var t=this;t.on("click",t,t.onClick),t.btn_help.on("click",t,t.onClickHelp),ui.ViewBase.prototype.onAdd.call(t,e),t.updateStore(),t.updateKey(),t.updateInfo(),t.updateDisplay()},t.updateDisplay=function(){var e,t=0,i=uB.ins.getDragonGroup();for(t=this.showItemArr.length=0;t<Qo.count;t++)Qo.MODEL.groupId(t)==Yo.MODEL.diggerGroupId(i)&&(e=yB.create(Qo.MODEL.goodsId(t)),this.showItemArr.push(e));this.gridPanel.gridDatas=this.showItemArr},t.updateInfo=function(){var e=this;e.sp_reddot.graphics.clear(),e.txt_blessVaule.value=uB.ins.longwenBless+"";var t,i=Sa.MODEL.fullLuck(20);e.mask_mc.pos(0,e.blessball.height*(1-uB.ins.longwenBless/i)),e.weekCount=uB.ins.getCountByType(104),e.rewarCount.innerHTML=RP.n[1093]+Ql.createColor(e.weekCount+"次","#23b11f"),e.showArrIndex=uB.ins.getShowArrByType(104);for(var n=0;n<e.showArrIndex.length;n++){t=e.award_list[n];var s=Kp.MODEL.rewardDefs(Kp.getIndex(e.showArrIndex[n])),o=(JSON.parse(s)[0].value.split(":"),Kp.MODEL.times(Kp.getIndex(e.showArrIndex[n])));Pg.gray(t,!1),e.weekCount>=o?(e["txt_ward"+n].innerHTML=Ql.createColor(o+"次","#23b11f"),0<uB.ins.TrasureAwardArr.length&&0<=uB.ins.TrasureAwardArr.indexOf(e.showArrIndex[n])?(Pg.gray(t,!0),e["txt_ward"+n].innerHTML=Ql.createColor("已领取","#23b11f")):e.drawReddot(t)):(Pg.gray(t,!0),e["txt_ward"+n].innerHTML=Ql.createColor(o+"次","#666666"))}},t.forHunt=function(e){this._cdTime=BB.getTimer()+1200,this.result_list=e,this.openResult()},t.openResult=function(){hN.ins.open("TREASURE_RESULT",this.result_list),this.result_list=null},t.onRemove=function(e){this.off("click",this,this.onClick),this.btn_help.off("click",this,this.onClickHelp),ui.ViewBase.prototype.onRemove.call(this,e)},t.onClickHelp=function(){QR.goToOpenHelpDes(16)},t.updateStore=function(){this.btn_store.showTip=0<uB.longwenModel.goodsList.length},t.updateKey=function(){var e=this,t=TR.ins.getGoodsNum(2019);e.btn_one.showTip=0<t,e.btn_ten.showTip=10<=t;var i=yB.create(2019);e.resGird1.bindData=i,e.resGird2.bindData=i,e.resGird1.scaleX=e.resGird2.scaleX=.5,e.resGird1.scaleY=e.resGird2.scaleY=.5,e.txt_num.innerHTML=1<=t?Ql.createColor(t+"/1","#23b11f")+")":Ql.createColor(t+"/1","#ff2e24")+")",e.txt_num2.innerHTML=10<=t?Ql.createColor(t+"/10","#23b11f")+")":Ql.createColor(t+"/10","#ff2e24")+")";var n=yB.createStr(Sa.MODEL.consumptions(12)),s=yB.createStr(Sa.MODEL.consumptions(13));e.txt_yb1.changeText(n.goodsNum+"("),e.txt_yb2.changeText(s.goodsNum+"("),e.btn_shop.showTip=!1;for(var o=uB.ins.getExchangeData(),a=0;a<o.length;a++)if(gR.ins.dragonsuipian>=o[a].costCount){e.btn_shop.showTip=!0;break}},t.onClick=function(e){var t=this;if(!(BB.getTimer()-t._cdTime<500)){t._cdTime=BB.getTimer();var i=TR.ins.getGoodsNum(t._item);if(i=10<=i?10:i,e.target==t.btn_one)1<=i?uB.ins.reqOne(uB.ins.getReqType(104,1,0)):t.buyHandler(1),UB.ins.playSound("11");else if(e.target==t.btn_ten)1<=i?uB.ins.reqOne(uB.ins.getReqType(104,i,0)):t.buyHandler(10),UB.ins.playSound("11");else if(e.target==t.btn_store)Tu.sendToModule("TR_STORE",["modules.treasure.TreasureModule"],"LONGWEN_GUPDATE");else if(e.target==t.btn_shop){hN.ins._getOpenData("TREASURE_VIEW")._subIndex_=1,t.gridPanel.isClearUrl=!1,hN.ins.open("TREASURE_EXCHANGE",null,0)}}},t.buyHandler=function(e){if(uB.ins.getShowTip(104,e))1==e?hN.ins.open("TREASURE_BUY",[104,1]):hN.ins.open("TREASURE_BUY",[104,10]);else{var t,i=uB.ins.getReqType(104,e,1);t=yB.createStr(Sa.MODEL.consumptions(Sa.getIndex(i))),gR.ins.YB<t.goodsNum?KQ.ins.showNoGold():uB.ins.reqOne(i)}},t.destroy=function(e){var t=this;void 0===e&&(e=!0),t.sp_reddot&&(t.sp_reddot.parent.removeChild(t.sp_reddot),t.sp_reddot=null),t.resGird1&&(t.resGird1.parent&&t.resGird1.parent.removeChild(t.resGird1),t.resGird1.destroy(),t.resGird1=null),t.resGird2&&(t.resGird2.parent&&t.resGird2.parent.removeChild(t.resGird2),t.resGird2.destroy(),t.resGird2=null),t.gridPanel&&t.gridPanel.vScrollBar&&t.gridPanel.vScrollBar.off("change",t,t.onScrollChanged),t.gridPanel.destroy(e),t.gridPanel=null,laya.ui.View.prototype.destroy.call(t,e)},t.onScrollChanged=function(){0==this.gridPanel.vScrollBar.max||this.gridPanel.vScrollBar.value>=this.gridPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},n}(),RK=function(e){function t(){var e=this;e.grid_list=[],e.record_list=null,e.result_list=null,e._groupId=0,e.showTextArr=[],e._cdTime=0,e._gid=0,e._effect=null,e.resGird1=null,e.resGird2=null,e.acitivityId=0,e.actInfo=null,e.gList=null,e.tList=null,e.toc30328=null,e.cdTime=NaN,e.eTime=NaN,e.allTimes=0,t.__super.call(e),e.initView(),e.list.itemRender=lq,e.list.vScrollBarSkin="",e.list.spaceY=10,e.list.scrollBar.elasticDistance=200}b(t,"modules.treasure.views.sub.TrMysticalView",Ig);var i=t.prototype;return i.initView=function(){var e,t,i=this,n=0;for(n=0;n<18;n++)e=i["g"+n],(t=new MF).pos(e.x,e.y),n<16&&(t.scaleX=t.scaleY=.8,t.size(e.width,e.height)),i.box.addChild(t),i.grid_list.push(t);for(n=1;n<3;n++)i["resGird"+n]=new MF,i["resGird"+n].needGridBg=!1,i["resGird"+n].pos(i["itempic"+n].x-3,i["itempic"+n].y-2),i.box_d.addChild(i["resGird"+n])},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.btn_help.on("click",this,this.onClickHelp),this.updateStore()},i.onRemove=function(e){var t=this;if(ui.ViewBase.prototype.onRemove.call(t,e),G.timer.clear(t,t.onResetTime),G.timer.clearAll(t),t.off("click",t,t.onClick),t.btn_help.off("click",t,t.onClickHelp),t.result_list){var i;for(var n in t.result_list){i=t.result_list[n];var s=Bi.getIndex(i.id),o=ms.getByQuality(Bi.MODEL.colourId(s)),a=Bi.MODEL.name(s)+"x"+i.num;zB.ins.showById2(2139,[o,a],2)}t.result_list=null}t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null),t.clearShowItem()},i.destroy=function(e){var t=this;void 0===e&&(e=!0);var i=0;if(t.grid_list){for(i=0;i<t.grid_list.length;i++)t.grid_list[i]&&(t.grid_list[i].parent&&t.grid_list[i].parent.removeChild(t.grid_list[i]),t.grid_list[i].destroy(),t.grid_list[i]=null);t.grid_list=null}if(t.gList){for(i=0;i<t.gList.length;i++)t.gList[i]&&(t.gList[i].parent&&t.gList[i].parent.removeChild(t.gList[i]),t.gList[i].destroy(),t.gList[i]=null);t.gList=null}for(i=1;i<3;i++)t["resGird"+i]&&(t["resGird"+i].parent&&t["resGird"+i].parent.removeChild(t["resGird"+i]),t["resGird"+i].destroy(),t["resGird"+i]=null);laya.ui.View.prototype.destroy.call(t,e)},i.showByVSC=function(e,t){this.acitivityId=t,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack)),this.updateKey()},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.setCdTime(this.actInfo.endTime),this.updateDisplay(),Eg.reqrecord(108))},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(19));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e,type:1})},i.showView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!0;for(e=0;e<this.showTextArr.length;e++)this.showTextArr[e]&&(this.showTextArr[e].visible=!0);this.resGird1.visible=!0,this.resGird2.visible=!0,this.list.visible=!0,this.updateStore()},i.hideView=function(){for(var e=0;e<this.grid_list.length;e++)this.grid_list[e].visible=!1;for(e=0;e<this.showTextArr.length;e++)this.showTextArr[e].visible=!1;this.resGird1.visible=!1,this.resGird2.visible=!1,this.list.visible=!1},i.updateByVSC=function(e){e.proto instanceof protos.treasure.Treasure_returnInfo_30328_toc&&(this.toc30328=e.proto,this.setTrAwards()),"show"==e?(this.showView(),this.updateKey(),Eg.reqrecord(108)):"hide"==e?this.hideView():"30322"==e.actionOrder?(this.forHunt(e.proto.list),Eg.reqrecord(108)):"30326"==e.actionOrder?this.updateRecord(e.proto.list):"MYSTICAL_GUPDATE"==e.actionOrder&&(this.updateStore(),this.updateKey())},i.update=function(){this._groupId!=uB.ins.groupId&&(this._groupId=uB.ins.groupId,this.updateDisplay()),this.list.array=uB.ins.msgList},i.updateStore=function(){this.btn_store.showTip=0<uB.mysticalModel.goodsList.length},i.updateRecord=function(e){this.record_list=e,20<this.record_list.length&&this.record_list.splice(0,this.record_list.length-20),this.list.array=this.record_list},i.loop=function(){if(this.record_list.length){var e=this.record_list.shift(),t=uB.ins.msgList;t.push(e),20<t.length&&t.splice(0,1),this.list.array=t,this.list.scrollBar.value=this.list.scrollBar.max}0==this.record_list.length&&G.timer.clear(this,this.loop)},i.updateKey=function(){var e=this,t=uB.getExploreIndex(0,e.acitivityId),i=yB.createStr(Sa.MODEL.consumptions(t));e.resGird1.bindData=i,e.resGird2.bindData=i,e.resGird1.scaleX=e.resGird2.scaleX=.5,e.resGird1.scaleY=e.resGird2.scaleY=.5,e._gid=i.goodsId;var n=TR.ins.getGoodsNum(e._gid);e.btn_one.showTip=0<n,e.btn_ten.showTip=10<=n;var s=1<=n?"#23b11f":"#ff2e24";e.txt_num.innerHTML=Ql.createColor(n+"/1",s)+")",s=10<=n?"#23b11f":"#ff2e24",e.txt_num2.innerHTML=Ql.createColor(n+"/10",s)+")",t=uB.getExploreIndex(1,e.acitivityId);var o=yB.createStr(Sa.MODEL.consumptions(t));e.txt_yb1.changeText(o.goodsNum+"("),t=uB.getExploreIndex(1,e.acitivityId,10);var a=yB.createStr(Sa.MODEL.consumptions(t));e.txt_yb2.changeText(a.goodsNum+"(")},i.forHunt=function(e){this._cdTime=BB.getTimer()+1200,this.result_list=e,this.openResult()},i.openResult=function(){hN.ins.open("TREASURE_RESULT",this.result_list),this.result_list=null},i.onClick=function(e){if(!(BB.getTimer()-this._cdTime<500))switch(this._cdTime=BB.getTimer(),e.target){case this.btn_one:this.onReqHandler(1);break;case this.btn_ten:this.onReqHandler(10);break;case this.btn_store:Tu.sendToModule("TR_STORE",["modules.treasure.TreasureModule"],"MYSTICAL_GUPDATE")}},i.onReqHandler=function(e){var t=0,i=TR.ins.getGoodsNum(this._gid);1<=(i=10<=i?10:i)?(t=1==e?uB.getExploreIndex(0,this.acitivityId):uB.getExploreIndex(0,this.acitivityId,i),uB.ins.reqOne(Sa.MODEL.key(t),this.acitivityId)):this.buyHandler(e),UB.ins.playSound("11")},i.buyHandler=function(e){if(uB.ins.getShowTip(108,e))hN.ins.open("TREASURE_BUY",[108,e,this.acitivityId]);else{var t,i=uB.getExploreIndex(1,this.acitivityId,e);t=yB.createStr(Sa.MODEL.consumptions(i)),gR.ins.YB<t.goodsNum?KQ.ins.showNoGold():uB.ins.reqOne(Sa.MODEL.key(i),this.acitivityId)}},i.updateDisplay=function(){var e=this;e._effect||(e._effect=kB.createEffect("jm1436",360,104,e)),e.clearShowItem(),e.showTextArr=[];var t=mg.getIndex(e.acitivityId),i=mg.MODEL.goodsReward(t),n=JP.praseGoodsStr(i);if(n&&!(n.length<1))for(var s,o=0;o<e.grid_list.length;o++)if(s=n[o],e.grid_list[o]&&s){if(e.grid_list[o].bindData=n[o],16<=o)continue;if(!e.showTextArr[o]){var a=kB.createText(e.grid_list[o].x-13,e.grid_list[o].y+e.grid_list[o].height-20,116,50,Bi.MODEL.simpleName(s.cfgIdx),20,ms.getByQuality(Bi.MODEL.colourId(s.cfgIdx)),!1,"center",!1,!1,e);e.box.addChild(a),e.showTextArr.push(a)}}},i.clearShowItem=function(){var e=this,t=0;if(e.showTextArr&&0<e.showTextArr.length){for(t=0;t<e.showTextArr.length;t++)e.showTextArr[t]&&(e.showTextArr[t].parent&&e.showTextArr[t].parent.removeChild(e.showTextArr[t]),e.showTextArr[t].destroy(),e.showTextArr[t]=null);e.showTextArr.splice(0,e.showTextArr.length)}},i.setCdTime=function(e){if((this.cdTime=e)<=0)return hN.ins.close("TR_MYSTICAL_VIEW"),this.txt_time.innerHTML=RP.n[481]+Ql.createColor("已结束","#ff2e24"),void G.timer.clear(this,this.onResetTime);this.onResetTime(),G.timer.frameLoop(10,this,this.onResetTime)},i.onResetTime=function(){this.eTime=this.cdTime-dr.serverTimeSec,0<this.eTime?this.txt_time.innerHTML=RP.n[482]+Ql.createColor(Jp.getSTRDHMS(this.eTime),"#23b11f"):(hN.ins.close("TR_MYSTICAL_VIEW"),this.txt_time.innerHTML=RP.n[481]+Ql.createColor("已结束","#ff2e24"),G.timer.clear(this,this.onResetTime))},i.getTimesList=function(){for(var e=[],t=0;t<Kp.count;t++)Kp.MODEL.activityId(t)==this.acitivityId&&108==Kp.MODEL.type(t)&&e.push(Kp.MODEL.key(t));return e},i.setTrAwards=function(){var e=this;if(e.toc30328){e.tList||(e.tList=e.getTimesList());var t=e.allTimes=0;for(t=0;t<e.toc30328.treasureTime.length;t++)if(108==e.toc30328.treasureTime[t].type){e.allTimes=e.toc30328.treasureTime[t].value;break}for(e.gList=e.gList||[],t=0;t<e.tList.length;t++){if(!e.gList[t]){var i=new AK;i.pos(55+105*t,9),e.box_c.addChildAt(i,2),e.gList.push(i)}var n=e.tList[t-1]?e.tList[t-1]:-1,s=-1<e.toc30328.gotList.indexOf(e.tList[t]);e.gList[t].dataSource={index:t,id:e.tList[t],preId:n,got:s,allTimes:e.allTimes}}}},t}(),NK=function(e){function t(){this.gooditem=null,t.__super.call(this)}return b(t,"modules.treasure.views.TrAwardTip",Dg),t.prototype.setup=function(e){var t=this;t.txt_tip1.innerHTML=RP.n[1097]+Ql.createColor(e[0]+"","#23b11f")+"次",0<e[1]?(t.txt_tip2.innerHTML="再购买"+Ql.createColor(e[1]+"","#23b11f")+RP.n[1098],t.txt_tip2.visible=!0,t.txt_get.visible=!1):(t.txt_tip2.visible=!1,t.txt_get.visible=!0),t.item.y=(t.txt_tip2.visible?t.txt_tip2.y:t.txt_tip1.y)+45,t.txt_name.y=t.item.y+114,t.gooditem||(t.gooditem=new MF,t.addChild(t.gooditem));var i=yB.create(e[2],e[3]);2524==e[2]?t.gooditem.toolTipEnabled=!1:t.gooditem.toolTipEnabled=!0,t.gooditem.bindData=i,t.gooditem.pos(t.item.x,t.item.y),t.txt_name.changeText(i.name),t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(i.cfgIdx))},t}(),BK=function(e){function t(){var e=this;e._max=0,e._num=0,e._buyNum=0,e._isDown=!1,e.curType=0,e.reqType=0,e.conmose=0,e.isSelect=!1,e.awardArr=[],e.acitivityId=0,t.__super.call(e)}b(t,"modules.treasure.views.TrQuickbuyView",Ag);var i=t.prototype;return i.setup=function(e){var t,i=this;i._num=e[1],i.curType=e[0],i.acitivityId=2<e.length?e[2]:0;for(var n=0;n<Sa.count;n++)if(Sa.MODEL.position(n)==i.curType){if(0!=i.acitivityId&&Sa.MODEL.activityId(n)!=i.acitivityId)continue;14==(t=yB.createStr(Sa.MODEL.consumptions(n))).goodsId&&i._num==Sa.MODEL.exploreNum(n)&&(i.reqType=Sa.MODEL.key(n))}var s=$e.MODEL.value($e.getIndex(279)).split(","),o=new MF(116);o.x=156,o.y=215;var a=yB.create(s[0],i._num);o.bindData=a,i.addChild(o);var r=new Yp;r.x=o.x-10,r.y=o.y+126,r.font="SimHei",r.width=135,r.color=ms.getByQuality(a.colourId),r.align="center",r.fontSize=20,r.text=a.simpleName,i.addChild(r);var l=new MF(116);l.x=332,l.y=215,t.goodsNum=i._num,l.bindData=t,i.addChild(l);var c=new Yp;c.x=l.x-10,c.y=l.y+126,c.font="SimHei",c.width=135,c.color=ms.getByQuality(t.colourId),c.align="center",c.fontSize=20,c.text=t.simpleName,i.addChild(c),i.conmose=yB.createStr(Sa.MODEL.consumptions(Sa.getIndex(i.reqType))).goodsNum;var u=RP.n[1099]+Ql.createColor(i.conmose+"元宝","#e6d80d")+RP.n[1100]+i._num,d="(获得"+a.name+"*"+i._num+"和"+t.name+"*"+i._num+")";i.txt_notice.innerHTML=u,i.txt_notice2.innerHTML=d,i.chk.selected=0==uB.ins.getShowTip(i.curType,i._num)},i.getConsume=function(e){var t=0;return 103==e?t=parseInt($e.MODEL.value(106)):104==e?t=parseInt($e.MODEL.value(107)):105==e&&(t=parseInt($e.MODEL.value(108))),t},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this.txt_notice.innerHTML=""},i.onClick=function(e){var t=this;switch(e.target){case t.btn_cancel:case t.btn_close:hN.ins._closePanel(t);break;case t.btn_ok:gR.ins.YB<t.conmose?KQ.ins.showNoGold():uB.ins.reqOne(t.reqType,t.acitivityId),hN.ins._closePanel(t),uB.ins.SetShowTip(t.curType,t._num,1==t.isSelect?0:1);break;case t.chk:t.isSelect=!t.isSelect,t.chk.selected=t.isSelect}},t}(),HK=function(t){function i(){var e=this;e._grids=[],e._datas=[],e._pool=[],e._txtArr=[],e._isFirst=!0,e.isEnoughGold=1,e.isEnoughGoood=1,e.isGoldType=1,e.nextId=0,e.goodId=0,e.hasnum=0,e.curPos=0,e.curNum=0,e.firstNum=0,e.resGird1=null,e.bigAward=null,e.curAwardArr=null,e._tw=null,e._twT=0,i.__super.call(e),e.cont.x=38}b(i,"modules.treasure.views.TrResultView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.resGird1=new MF,e.resGird1.needGridBg=!1,e.resGird1.needNum=!1,e.resGird1.isClearUrl=!1,e.resGird1.pos(e.itempic1.x-3,e.itempic1.y-2),e.addChild(e.resGird1),e.curAwardArr=[],e.bigAward=[],e.bigAward=$e.MODEL.value(178).split(",")},e.update=function(e){var t=this;t.clear();var i,n=[],s=[];for(var o in t.curAwardArr=[],e){i=e[o];var a=Bi.getIndex(i.id);2==Bi.MODEL.type(a)?s.push(i):n.push(i),0<=t.bigAward.indexOf(i.id+"")&&t.curAwardArr.push(i.id)}var r,l=Math.ceil(f/4),c=4<f?4:f,u=150*c-34,d=132*l-16;t._isFirst||(t._tw=ql.create(t,t.onOther,null,!1)),t._twT=e.length;for(var h,_,f=n.length+s.length,p=0;p<f;p++){i=e[p];var g=yB.create(i.id,i.num);g.disAchi=!1,t._datas.push(g),l=p/5>>0,c=p%5,(r=t.getOne()).reset(),r.pos(c*(r.width+5),l*(r.height+24));var v=kB.createText(r.x,r.y+116,116,50,g.simpleName,20,"#6c6250",!1,"center",!1,!1,t);t.cont.addChild(v),t._txtArr.push(v),t.cont.addChild(r),t._grids.push(r),t._isFirst?r.playFirst(p,g,f):r.playOther(p,g,t._tw)}var m=uB.ins.currentType,y=0,I=0;for(p=0;p<Sa.count;p++)Sa.MODEL.activityId(p)==uB.ins.curActivityId&&Sa.MODEL.key(p)==m&&(t.curPos=Sa.MODEL.position(p),h=yB.createStr(Sa.MODEL.consumptions(p)),y=Sa.MODEL.exploreNum(p),0==t.firstNum&&(t.firstNum=y),14==h.goodsId?(t.isGoldType=1,_=yB.createStr(Sa.MODEL.consumptions2(p)),I=h.goodsNum,t.hasnum=TR.ins.getGoodsNum(_.goodsId),t.resGird1.bindData=_):(t.isGoldType=0,I=(_=yB.createStr(Sa.MODEL.consumptions2(p))).goodsNum,t.goodId=_.goodsId,t.nextId=Sa.MODEL.nextid(p),t.firstNum=Sa.MODEL.exploreNum(Sa.getIndex(t.nextId)),t.hasnum=TR.ins.getGoodsNum(h.goodsId),t.resGird1.bindData=h),t.resGird1.scaleX=.5,t.resGird1.scaleY=.5);t.isEnoughGold=gR.ins.YB>=I?1:0,t.itempic1.scaleX=.5,t.itempic1.scaleY=.5,y=10<=t.firstNum?10:1,t.curNum=1==y?1:10<=t.hasnum?10:t.hasnum,t.hasnum>=y?t.txt_num.innerHTML=Ql.createColor(t.hasnum+"/"+y,"#23b11f")+")":t.txt_num.innerHTML=Ql.createColor(t.hasnum+"/"+y,"#ff2e24")+")",0<t.hasnum?t.isEnoughGoood=1:t.isEnoughGoood=0,t.txt_yb.changeText(I+"("),t.btn_buy.label="购买"+y+"次",t.cont.size(u,d),t._isFirst=!1,0<t.curAwardArr.length&&Tu.sendToModule("TR_BIGWARD",["modules.treasure.TreasureModule"],t.curAwardArr)},e.onFirst=function(){},e.onOther=function(){this._twT--,0==this._twT&&Og.from(this.cont,{scaleX:.3,scaleY:.3},100)},e.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onBuy),this.firstNum=0},e.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onBuy),this._isFirst=!0,Tu.sendToModule("RESHOWMAINVIEW",["modules.treasure.TreasureModule"],null),Tu.sendToModule("RESHOWMAINVIEW",["modules.activity.ActivityModule"],null),this._datas.length=0,this._grids.length=0},e.clear=function(){var e=this;Og.clearAll(e.cont),e.cont.scaleX=e.cont.scaleY=1,e._tw&&e._tw.recover();for(var t=[],i=0;i<e._datas.length;i++){var n=e._datas[i],s=e._grids[i];uB.ins.needFly(n.goodsId)&&t.push({id:n.goodsId,p:s.localToGlobal(new Uh)}),n.recover()}for(i=0;i<e._txtArr.length;i++)e.cont.removeChild(e._txtArr[i]),e._txtArr[i]=null;for(e._txtArr=[],e._datas.length=0,e._grids.length=0,t.length&&Tu.sendToModule("TR_FLY",["modules.treasure.TreasureModule"],t);0<e.cont.numChildren;)(s=e.cont.removeChildAt(e.cont.numChildren-1))&&(s.reset(),e._pool.push(s))},e.getOne=function(){return this._pool.length?this._pool.pop():new qF},e.onBuy=function(e){var t=this;if(e.target==t.btn_close)t.clear(),hN.ins._closePanel(t);else if(e.target==t.btn_buy)if(t.isGoldType)t.isEnoughGold?uB.ins.reqOne(uB.ins.currentType,uB.ins.curActivityId):KQ.ins.showNoGold();else if(t.isEnoughGoood)if(t.curNum=10<=t.curNum?10:t.curNum,0!=uB.ins.curActivityId){var i=uB.getExploreIndex(0,uB.ins.curActivityId,t.curNum,t.curPos);uB.ins.reqOne(Sa.MODEL.key(i),uB.ins.curActivityId)}else uB.ins.reqOne(uB.ins.getReqType(t.curPos,t.curNum,0));else t.isEnoughGold?uB.ins.reqOne(t.nextId,uB.ins.curActivityId):KQ.ins.showNoGold()},i}(bg),VK=function(e){function t(){var e=this;e.grid_list=null,e.currentType=0,t.__super.call(e),e.grid_list=new wj(4,5,116,5,24,!0,ql.create(e,e.onClick,null,!1),36),e.grid_list.isClearUrl=!1,e.grid_list.owerModule=" modules.treasure.TreasureModule",e.grid_list.pos(35,90),e.addChild(e.grid_list),e.setChildIndex(e.g_mask,e.numChildren-1)}b(t,"modules.treasure.views.TrStoreView",wg);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onTake)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onTake),this.txt_no.visible=!1,this.grid_list.vScrollBar.on("change",this,this.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),this.grid_list&&this.grid_list.vScrollBar&&this.grid_list.vScrollBar.off("change",this,this.onScrollChanged),this.grid_list.destroy(e),this.grid_list=null,laya.ui.View.prototype.destroy.call(this,e)},i.update=function(e){var t,i=this;"EQUIP_GUPDATE"==e||"EQUIP_GUPDATE"==e._actionOrder_?(t=uB.equipModel.goodsList,i.grid_list.gridDatas=t,i.currentType=103):"LONGWEN_GUPDATE"==e||"LONGWEN_GUPDATE"==e._actionOrder_?(t=uB.longwenModel.goodsList,i.grid_list.gridDatas=t,i.currentType=104):"CHUANSHI_GUPDATE"==e||"CHUANSHI_GUPDATE"==e._actionOrder_?(t=uB.chuanshiModel.goodsList,i.grid_list.gridDatas=t,i.currentType=105):"MYSTICAL_GUPDATE"==e||"MYSTICAL_GUPDATE"==e._actionOrder_?(t=uB.mysticalModel.goodsList,i.grid_list.gridDatas=t,i.currentType=108):"HEFU_GUPDATE"!=e&&"HEFU_GUPDATE"!=e._actionOrder_||(t=uB.hefuTrModel.goodsList,i.grid_list.gridDatas=t,i.currentType=109),i.txt_no.visible=!(i.grid_list.gridDatas&&0<i.grid_list.gridDatas.length),i.g_mask.visible=i.grid_list.gridDatas&&20<i.grid_list.gridDatas.length},i.onTake=function(e){e.target==this.btn_take?Eg.reqTakeAll(this.currentType):e.target==this.btn_close&&hN.ins._closePanel(this)},i.onClick=function(e){},i.onScrollChanged=function(){0==this.grid_list.vScrollBar.max||this.grid_list.vScrollBar.value>=this.grid_list.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),GK=function(e){function t(){this._effect=null,this._equipEff=null,this._effArr=null,t.__super.call(this),this.mouseThrough=!0,this.initUI()}b(t,"modules.vip.views.Vip3PrivilegeV",Ug);var i=t.prototype;return i.initUI=function(){var e=this;e.div_desc.innerHTML=RP.n[1101]+Ql.createColor("100","#e6d80d")+"元成为"+Ql.createColor("VIP3","#e6d80d")+RP.n[1102],e._effArr=[];for(var t=_o.getIndex(3),i=_o.MODEL.rewards(t).split(";"),n=0,s="",o=0;o<3;o++){var a=new MF;a.x=e["img_grid"+o].x,a.y=e["img_grid"+o].y,a.size(106,106),e.box_c.addChildAt(a,9);var r=i[o+1].split(","),l=parseInt(r[0]),c=parseInt(r[1]),u=KH.create(l,c);switch(a.bindData=u,a.isClearUrl=!0,e["txt_name"+o].changeText(Bi.MODEL.minUseLevel(u.cfgIdx)+"级"),e["clip_fight"+o].value=u.baseFight,n=Bi.getIndex(l),Bi.MODEL.roleTypeId(n)){case 1:s="bb_jb_zs";break;case 2:s="bb_jb_fs";break;case 3:s="bb_jb_ds"}e["img_role"+o].skin=_r.getAtlasSubPath("basic_ui/"+s+".png")}e.num_fight.value=3e4,e._equipEff=mj.GetNew(),e._equipEff.loadEffect("jm1355"),e._equipEff.renderInSelf=!0,e._equipEff.setXY(e.width/2,420),e.box_c.addChild(e._equipEff),e.btn_recharge.clickHandler=ql.create(e,e.onClick,null,!1)},i.destroy=function(e){var t=this;if(void 0===e&&(e=!0),t._effect&&(t._effect.dispose(),t._effect=null),t._equipEff&&(t._equipEff.dispose(),t._equipEff=null),t._effArr){for(var i=t._effArr.length,n=0;n<i;n++){t._effArr[n].dispose()}t._effArr=null}NP.clearTextureByModule("layouts/vip3privilege/"),t.box_top.removeSelf(),laya.ui.View.prototype.destroy.call(t,e)},i.onClick=function(){3<=gR.ins.VIPLevel?hN.ins.open("VIP_PANEL",3):Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.update(),this.parent.parent.addChild(this.box_top)},i.update=function(){var e=this;3<=gR.ins.VIPLevel?(e.btn_recharge.label=RP.n[1103],null==e._effect&&(e._effect=mj.GetNew(),e._effect.loadEffect("jm1242"),e._effect.renderInSelf=!0,e._effect.setXY(e.btn_recharge.width>>1,e.btn_recharge.height>>1),e.btn_recharge.addChild(e._effect))):e.btn_recharge.label="充 值"},t}(),UK=function(e){function t(){var e=this;e._srcX=NaN,e._lastX=NaN,e._offsetX=NaN,e._initX=NaN,e._posArr=null,e._target=0,e._moveOffset=0,e._curIdx=0,e._tarIdx=0,e._effect=null,e.openLvl=-1,e._effInfo=null,e.BAR_W=0,e.G_SIZE=74,e.G_GRID=30,e._vipDataModel=Wg.ins,e._gridsVec=new Array,e.f=new ys([.791231,.051799,.00697,0,-7.475,.026231,.816799,.00697,0,-7.475,.026231,.051799,.77197,0,-7.475,0,0,0,1,0]),t.__super.call(e),e.initUI(),e._effInfo={},e._effInfo[3]=["jm0109","jm1147","jm1147","jm1147"],e._effInfo[4]=["jm1226"],e._effInfo[5]=["jm1226","jm0109","jm1226"],e._effInfo[6]=["jm1147","jm1226","jm1226"],e._effInfo[7]=["jm1226","jm1226"],e._effInfo[8]=["jm1226","jm1226"],e._effInfo[9]=["jm1226","jm1226"],e._effInfo[10]=["jm1226","jm1226"],e.div_count.visible=e.btn_recharge.visible=e.div_desc.visible=EB.showCharge}b(t,"modules.vip.views.VipInfoV",qg);var i=t.prototype;return i.initUI=function(){var e=this;e._posArr=[],e._posArr.push({x:0,scale:1,z:3,alpha:0}),e._posArr.push({x:180,scale:.95,z:2,alpha:.2}),e._posArr.push({x:100,scale:.9,z:1,alpha:.4}),e._posArr.push({x:0,scale:.8,z:0,alpha:.5}),e._posArr.push({x:-100,scale:.9,z:1,alpha:.4}),e._posArr.push({x:-180,scale:.95,z:2,alpha:.2}),e._moveOffset=70,e._initX=e.vipCur.x,e.vipNext.y=e.vipPrev.y=e.vipCur.y;for(var t=0;t<6;t++)e._posArr[t].x+=e._initX;for(e.vipNext.filters=[e.f],e.vipPrev.filters=[e.f],e.vipNext.x=e._posArr[2].x,e.vipPrev.x=e._posArr[4].x,e.vipNext.scaleX=e.vipNext.scaleY=e._posArr[2].scale,e.vipPrev.scaleX=e.vipPrev.scaleY=e._posArr[4].scale,e.vipCur.zOrder=e._posArr[0].z,e.vipNext.zOrder=e._posArr[2].z,e.vipPrev.zOrder=e._posArr[4].z,t=0;t<10;t++)e["clip_v"+t].index=1;e.clip_v0.index=0,e._curIdx=0,e._tarIdx=-1,e.addDownListener()},i.onRecharge=function(){if(null!=this._vipDataModel.toc_info)if(1==this._vipDataModel.toc_info.awards[this._curIdx+1]){var e=new eA;e.lvl=this._curIdx+1,Tu.sendToService(e)}else Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._effect&&(t._effect.visible=!0,t._effect.dispose(),t._effect=null);for(var i=0;i<t._gridsVec.length;i++)t._gridsVec[i].clearIconTexture(),t._gridsVec[i].destroy(!0);t._gridsVec.length=0,t._effInfo=[],t._posArr=[],t._vipDataModel=null,t.vipPrev.img_ad.dispose(),t.vipCur.img_ad.dispose(),t.vipNext.img_ad.dispose(),laya.ui.View.prototype.destroy.call(t,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.BAR_W=this.img_progBar.width,this._tarIdx=-1,this.parent.parent.addChild(this.box_top);var t=new $M;Tu.sendToService(t),this.setRateBar()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.parent.parent.removeChild(this.box_top),this.removeTouch()},i.update=function(){var e=this,t=e._vipDataModel.toc_info;if(null!=t){if(e.div_count.innerHTML="已有"+Ql.createColor(t.count+"","#01b527")+"人成为"+Ql.createColor("VIP","#ffff41"),10<=t.vipLvl)e.div_desc.innerHTML=RP.n[1037],e.setRateBar(1),e.txt_progress.changeText(t.cost+"/MAX");else{var i=_o.getIndex(t.vipLvl+1),n=_o.MODEL.needGold(i);e.div_desc.innerHTML="再充值"+Ql.createColor(n-t.cost+"","#ffff41")+RP.n[1105]+Ql.createColor("VIP"+(t.vipLvl+1),"#ffff41"),e.setRateBar(t.cost/n),e.txt_progress.changeText(t.cost+"/"+n)}e.clip_vip.value=t.vipLvl+"";var s=t.vipLvl+1;10<s&&(s=10);for(var o=1;o<=10;o++){if(1==t.awards[o]){s=o;break}}-1!=e.openLvl?e.setCurVip(e.openLvl):e.setCurVip(s),e.openLvl=-1,t=null}},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.img_progBar.scrollRect||new u_(0,0,this.img_progBar.width,this.img_progBar.height);t.width=this.BAR_W*e,this.img_progBar.scrollRect=t},i.updateState=function(){var e=this,t=e._vipDataModel.toc_info;if(null!=t){var i=e._vipDataModel.toc_info.awards[e._curIdx+1];e.setBtnState(i);var n=t.vipLvl+1;10<n&&(n=10);for(var s=1;s<=10;s++){if(1==t.awards[s]){n=s;break}}e._curIdx+1<n?(e._tarIdx=n,e.setNextInfo(n),e.onNextDown()):e._curIdx+1>n&&(e._tarIdx=n,e.setPrevInfo(n),e.onPrevDown()),t=null}},i.setBtnState=function(e){var t=this;t._effect&&(t._effect.visible=!1),2==e?(t.btn_recharge.label="已领取",t.btn_recharge.disabled=!0):1==e?(t.btn_recharge.label=RP.n[1106],t.btn_recharge.disabled=!1,EB.showCharge&&(null==t._effect&&(t._effect=mj.GetNew(),t._effect.loadEffect("jm1242"),t._effect.renderInSelf=!0,t._effect.setXY(t.btn_recharge.x+t.btn_recharge.width/2,t.btn_recharge.y+t.btn_recharge.height/2),t.box_c.addChild(t._effect)),t._effect.visible=!0)):(t.btn_recharge.label="充 值",t.btn_recharge.disabled=!1)},i.setPrevInfo=function(e){var t=this;t.vipPrev.clip_lvl.value=e+"";var i=_o.getIndex(e);t.vipPrev.div_desc.innerHTML=_o.MODEL.privilegeDetail(i);for(var n=_o.MODEL.rewards(i).split(";"),s=(550-n.length*t.G_SIZE-(n.length-1)*t.G_GRID)/2,o=0;o<4;o++){var a=t.vipPrev["grid"+o];if(t.vipPrev["img_grid"+o].x=s+104*o,t.vipPrev["txt_name"+o].x=t.vipPrev["img_grid"+o].x-20,null==a&&((a=new MF).y=t.vipPrev["img_grid"+o].y,a.size(t.G_SIZE,t.G_SIZE),t.vipPrev.addChild(a),t.vipPrev["grid"+o]=a),a.x=t.vipPrev["img_grid"+o].x,o<n.length){a.visible=!0;var r=n[o].split(","),l=parseInt(r[0]),c=parseInt(r[1]),u=yB.create(l,c);a.bindData=u;var d=Bi.MODEL.simpleName(u.cfgIdx),h=d||Bi.MODEL.name(u.cfgIdx);t.vipPrev["txt_name"+o].changeText(h),t.vipPrev["txt_name"+o].color=ms.getByQuality(Bi.MODEL.colourId(u.cfgIdx))}else a.visible=!1,t.vipPrev["txt_name"+o].changeText("");if(a.needEffect=!1,a.destroyChildren(),t._effInfo[e]instanceof Array){var _=t._effInfo[e];if(o<_.length){var f=mj.GetNew();f.loadEffect(_[o]),f.renderInSelf=!0,f.setXY(37,37),f.scale_X=t.G_SIZE/116,f.scale_Y=t.G_SIZE/116,a.addChild(f)}}a.isClearUrl=!0,-1==t._gridsVec.indexOf(a)&&t._gridsVec.push(a)}3==n.length?t.vipPrev.img_grid3.visible=!1:t.vipPrev.img_grid3.visible=!0;var p=_r.getVipPath("vip_text_vip"+e);t.setPrevAd(t.vipPrev,p)},i.setPrevAd=function(e,t){e.img_ad.skin=t},i.setNextAd=function(e,t){e.img_ad.skin=t},i.setCurAd=function(e,t){e.img_ad.skin=t},i.setNextInfo=function(e){var t=this;t.vipNext.clip_lvl.value=e+"";var i=_o.getIndex(e);t.vipNext.div_desc.innerHTML=_o.MODEL.privilegeDetail(i);for(var n=_o.MODEL.rewards(i).split(";"),s=(550-n.length*t.G_SIZE-(n.length-1)*t.G_GRID)/2,o=0;o<4;o++){var a=t.vipNext["grid"+o];if(t.vipNext["img_grid"+o].x=s+104*o,t.vipNext["txt_name"+o].x=t.vipNext["img_grid"+o].x-20,null==a&&((a=new MF).y=t.vipNext["img_grid"+o].y,a.size(t.G_SIZE,t.G_SIZE),t.vipNext.addChild(a),t.vipNext["grid"+o]=a),a.x=t.vipNext["img_grid"+o].x,o<n.length){a.visible=!0;var r=n[o].split(","),l=parseInt(r[0]),c=parseInt(r[1]),u=yB.create(l,c);a.bindData=u;var d=Bi.MODEL.simpleName(u.cfgIdx),h=d||Bi.MODEL.name(u.cfgIdx);t.vipNext["txt_name"+o].changeText(h),t.vipNext["txt_name"+o].color=ms.getByQuality(Bi.MODEL.colourId(u.cfgIdx))}else a.visible=!1,t.vipNext["txt_name"+o].changeText("");if(a.needEffect=!1,a.destroyChildren(),t._effInfo[e]instanceof Array){var _=t._effInfo[e];if(o<_.length){var f=mj.GetNew();f.loadEffect(_[o]),f.renderInSelf=!0,f.setXY(37,37),f.scale_X=t.G_SIZE/116,f.scale_Y=t.G_SIZE/116,a.addChild(f)}}a.isClearUrl=!0,-1==t._gridsVec.indexOf(a)&&t._gridsVec.push(a)}3==n.length?t.vipNext.img_grid3.visible=!1:t.vipNext.img_grid3.visible=!0;var p=_r.getVipPath("vip_text_vip"+e);t.setNextAd(t.vipNext,p)},i.setCurVip=function(e){var t=this;if(null!=t._vipDataModel.toc_info){10<e&&(e=10),t["clip_v"+t._curIdx].index=1,t._curIdx=e-1,t["clip_v"+t._curIdx].index=0,t.vipCur.clip_lvl.value=e+"";var i=_o.getIndex(e);t.vipCur.div_desc.innerHTML=_o.MODEL.privilegeDetail(i);for(var n=_o.MODEL.rewards(i).split(";"),s=(550-n.length*t.G_SIZE-(n.length-1)*t.G_GRID)/2,o=0;o<4;o++){var a=t.vipCur["grid"+o];if(t.vipCur["img_grid"+o].x=s+104*o,t.vipCur["txt_name"+o].x=t.vipCur["img_grid"+o].x-20,null==a&&((a=new MF).y=t.vipCur["img_grid"+o].y,a.size(t.G_SIZE,t.G_SIZE),t.vipCur.addChild(a),t.vipCur["grid"+o]=a),a.x=t.vipCur["img_grid"+o].x,o<n.length){a.visible=!0;var r=n[o].split(","),l=parseInt(r[0]),c=parseInt(r[1]),u=yB.create(l,c);u.disAchi=!1,a.bindData=u;var d=Bi.MODEL.simpleName(u.cfgIdx),h=d||Bi.MODEL.name(u.cfgIdx);t.vipCur["txt_name"+o].changeText(h),t.vipCur["txt_name"+o].color=ms.getByQuality(Bi.MODEL.colourId(u.cfgIdx))}else a.visible=!1,t.vipCur["txt_name"+o].changeText("");if(a.needEffect=!1,a.destroyChildren(),t._effInfo[e]instanceof Array){var _=t._effInfo[e];if(o<_.length){var f=mj.GetNew();f.loadEffect(_[o]),f.renderInSelf=!0,f.setXY(37,37),f.scale_X=t.G_SIZE/116,f.scale_Y=t.G_SIZE/116,a.addChild(f)}}a.isClearUrl=!0,-1==t._gridsVec.indexOf(a)&&t._gridsVec.push(a)}3==n.length?t.vipCur.img_grid3.visible=!1:t.vipCur.img_grid3.visible=!0;var p=_r.getVipPath("vip_text_vip"+e);t.setCurAd(t.vipCur,p);var g=e%10+1;t.setNextInfo(g);var v=(e+8)%10+1;t.setPrevInfo(v);var m=t._vipDataModel.toc_info.awards[e];t.setBtnState(m)}},i.addDownListener=function(){var e=this;e.btn_recharge.clickHandler=ql.create(e,e.onRecharge,null,!1),e.vipCur.once("mousedown",e,e.onMouseDown),e.vipNext.once("mousedown",e,e.onNextDown),e.vipPrev.once("mousedown",e,e.onPrevDown)},i.removeDownListener=function(){this.btn_recharge.clickHandler=null,this.vipCur.offAll("mousedown"),this.vipNext.offAll("mousedown"),this.vipPrev.offAll("mousedown")},i.onNextDown=function(){this.removeDownListener(),this._target=5,this.tweenMove()},i.onPrevDown=function(){this.removeDownListener(),this._target=1,this.tweenMove()},i.onMouseDown=function(e){var t=this;t.removeDownListener(),t._srcX=t.vipCur.x,t._lastX=G.stage.mouseX,G.stage.once("mouseup",t,t.onStageMouseUp),G.stage.once("mouseout",t,t.onStageMouseUp),G.timer.frameLoop(1,t,t.loop)},i.removeTouch=function(){G.stage.off("mouseup",this,this.onStageMouseUp),G.stage.off("mouseout",this,this.onStageMouseUp),G.timer.clear(this,this.loop)},i.onStageMouseUp=function(e){this.removeTouch(),this._target=0,this.tweenMove()},i.loop=function(){var e=this,t=G.stage.mouseX;e._offsetX=t-e._lastX,e._offsetX<0&&e._offsetX<-100&&(e._offsetX=-100),0<e._offsetX&&100<e._offsetX&&(e._offsetX=100),e.vipCur.x=e._srcX+e._offsetX,e.vipCur.x>e._initX?e._target=1:e._target=5,e.adjust(),e.vipCur.x>e._initX+e._moveOffset?(e.removeTouch(),e.tweenMove()):e.vipCur.x<e._initX-e._moveOffset&&(e.removeTouch(),e.tweenMove())},i.tweenMove=function(){var e=this;Og.to(e.vipCur,{x:e._posArr[e._target].x,scaleX:e._posArr[e._target].scale,scaleY:e._posArr[e._target].scale,update:ql.create(e,e.adjust,null,!1)},300,pa.sineIn,ql.create(e,e.tweenEnd))},i.tweenEnd=function(){var e=this;if(1==e._target)e._target=2,e.tweenMove();else if(5==e._target)e._target=4,e.tweenMove();else{var t={};t[e._target]=e.vipCur,t[(e._target+2)%6]=e.vipNext,t[(e._target+4)%6]=e.vipPrev,e.vipCur=t[0],e.vipNext=t[2],e.vipPrev=t[4],e.addDownListener(),-1!=e._tarIdx?(e.setCurVip(e._tarIdx),e._tarIdx=-1):2==e._target?e.setCurVip((e._curIdx+9)%10+1):4==e._target&&e.setCurVip((e._curIdx+1)%10+1)}},i.adjust=function(){var e,t,i,n,s,o=this,a=0;0==(i=o._target)?a=o.vipCur.x>o._posArr[0].x?1:5:1==i||2==i?a=i-1:5==i?a=0:4==i&&(a=5),e=(a+2)%6,t=(a+4)%6,n=(i+2)%6,s=(i+4)%6;var r=(o.vipCur.x-o._posArr[a].x)/(o._posArr[i].x-o._posArr[a].x);o.vipNext.x=r*(o._posArr[n].x-o._posArr[e].x)+o._posArr[e].x,o.vipPrev.x=r*(o._posArr[s].x-o._posArr[t].x)+o._posArr[t].x,o.vipCur.scaleX=o.vipCur.scaleY=r*(o._posArr[i].scale-o._posArr[a].scale)+o._posArr[a].scale,o.vipNext.scaleX=o.vipNext.scaleY=r*(o._posArr[n].scale-o._posArr[e].scale)+o._posArr[e].scale,o.vipPrev.scaleX=o.vipPrev.scaleY=r*(o._posArr[s].scale-o._posArr[t].scale)+o._posArr[t].scale,o.vipCur.zOrder=r*(o._posArr[i].z-o._posArr[a].z)+o._posArr[a].z,o.vipNext.zOrder=r*(o._posArr[n].z-o._posArr[e].z)+o._posArr[e].z,o.vipPrev.zOrder=r*(o._posArr[s].z-o._posArr[t].z)+o._posArr[t].z,o.vipCur.filters=[],o.vipPrev.filters=[],o.vipNext.filters=[],o.vipCur.zOrder<2?o.vipCur.filters=[o.f]:o.vipCur.filters=[],o.vipPrev.zOrder<2?o.vipPrev.filters=[o.f]:o.vipPrev.filters=[],o.vipNext.zOrder<2?o.vipNext.filters=[o.f]:o.vipNext.filters=[]},t}(),FK=function(e){function i(){var e=this;e._grids=null,e._total=0,e._actorVo=null,e._wsVo=null,e._effectid=null,e._effect=null,e._wearEff=null,i.__super.call(e),e._grids=[];for(var t=0;t<8;t++)e._grids[t]=new _q,e._grids[t].toolTipEnabled=!1,e._grids[t].isClearUrl=!1,e._grids[t].name=t+1}b(i,"modules.weaponsoul.views.WeaponSoulDetailPanel",Zg);var t=i.prototype;return t.updateByVSC=function(e){"22504"==e.actionOrder||"22507"==e.actionOrder?(this.showDetail(),this.callLater(this.updateRedPt)):"BP_UPDATE"==e.actionOrder?this.callLater(this.updateRedPt):"UPDATE_DETAIL"==e.actionOrder&&(this.showDetail(),this.callLater(this.updateRedPt))},t.updateRedPt=function(){hB.ins.goodsUpdate(),this.showRoleRedPt(),this.showPartRedPt()},t.onAdd=function(e){this.showDetail(),this.showRoleRedPt(),ui.ViewBase.prototype.onAdd.call(this,e),this.wsDescr.on("link",this,this.onLink),this.on("click",this,this.onClick)},t.onLink=function(){0<this._actorVo.useSoul&&(hN.ins.close("WEAPONSOUL_DETAIL"),Tu.sendToModule("OPEN_WSCORE",["modules.strength.StrengthModule"]))},t.onRemove=function(e){var t=this;t.off("click",t,t.onClick),t.wsDescr.off("link",t,t.onLink),hN.ins.close("WEAPONSOULLVUPV"),Tu.sendToModule("UPDATE_MAIN",["modules.strength.StrengthModule"]);for(var i=0;i<8;i++)t._grids[i].clearIconTexture();t._effect&&(t._effect.dispose(),t._effect=null),ui.ViewBase.prototype.onRemove.call(t,e)},t.onClick=function(e){var t=this;if(e.target instanceof modules.weaponsoul.views.WeaponSoulGrid){var i=parseInt(e.target.name),n=t._wsVo.partLvs[i-1];if(hB.ins.partIsTop(t._wsVo.wsid,i,n+1))return void zB.ins.showMsg(RP.n[1107],1);hB.ins.curPart=i,Tu.sendToModule("OPEN_LVUP",["modules.strength.StrengthModule"])}else if(e.target==t.imgSkillIcon||e.target==t.txDes)0!=t._wsVo.skilllv&&0==t._wsVo.isTop?Tu.sendToModule("OPEN_TIPS_1",["modules.strength.StrengthModule"]):Tu.sendToModule("OPEN_TIPS",["modules.strength.StrengthModule"]);else if(e.target==t.btn_exit)hN.ins.close("WEAPONSOUL_DETAIL");else if(e.target==t.btn_use){if(0==t._wsVo.actived){if(t._wsVo.fitParts>=t._wsVo.totalPart)return void ev.reqActivedWs(t._actorVo.idx,t._wsVo.wsid);zB.ins.showMsg(RP.n[1108],1)}t._actorVo&&t._wsVo&&t._wsVo.wsid==t._actorVo.wearId?ev.ReqOff(t._actorVo.idx,t._wsVo.wsid):ev.ReqEquip(t._actorVo.idx,t._wsVo.wsid),UB.ins.playSound("4")}},t.showWearEff=function(e){var t=this;t._wearEff&&(t._wearEff.dispose(),t._wearEff=null)},t.showDetail=function(){var e=this,t=hB.ins.curWSId;e._actorVo=hB.ins.getVoByRole(modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex+1),e._wsVo=e._actorVo.getWsVo(t);var i=po.getIndex(t);e._total=po.MODEL.posNum(i),e.showWearEff(!1),e.showEffect(!0);var n=4==e._total?4:6,s=4==n?e.mcB4:e.mcB6;e.mcB4.visible=4==n,e.mcB6.visible=!e.mcB4.visible;for(var o,a,r=hB.ins.getIconDto(t),l=!1,c=0,u=0;u<e._grids.length;u++)o=e._grids[u],c=e._wsVo.getPartLv(u+1),u<e._total?((a=r[u]).goodsNum=c,Math.floor(c/10)+1,o.bindData=a,s.addChild(o),o.pos(e["mcP"+n+"_"+(u+1)].x,e["mcP"+n+"_"+(u+1)].y),e["txName"+n+"_"+(u+1)].changeText(Bi.MODEL.name(a.cfgIdx)),l=c<po.MODEL.effectCondition(i),e["mcL"+n+"g_"+(u+1)].visible=l,e["mcL"+n+"b_"+(u+1)].visible=!l,s.addChild(e["mcR"+n+"_"+(u+1)])):(4!=n&&(e["txName"+n+"_"+(u+1)].text="",e["mcL"+n+"g_"+(u+1)].visible=!1,e["mcL"+n+"b_"+(u+1)].visible=!1),o.bindData=null,o.parent&&o.parent.removeChild(o)),o.gray=0==c;e._wsVo.actived?(e.btn_use.gray=!1,e.btn_use.mouseEnabled=!0,0<e._actorVo.wearId?(e.btn_use.showTip=!1,e.btn_use.label=e._wsVo.wsid==e._actorVo.wearId?"取 消":"替 换"):e.btn_use.label="使 用",0<e._actorVo.useSoul?e.wsDescr.innerHTML=Ql.createColor(RP.n[1109],"#d98f0b")+Ql.createColorHerf(RP.n[1110],"#0cca32","#"):e.wsDescr.innerHTML=Ql.createColor(RP.n[1111],"#d98f0b")):(e._wsVo.fitParts>=e._wsVo.totalPart?(e.btn_use.showTip=!0,e.btn_use.gray=!1,e.btn_use.mouseEnabled=!0):(e.btn_use.mouseEnabled=!1,e.btn_use.showTip=!1,e.btn_use.gray=!0),e.btn_use.label="解 锁",e.wsDescr.innerHTML=Ql.createColor(RP.n[1112],"#d98f0b")),e.showPartRedPt(),e.updateSkillContent()},t.showEffect=function(e){var t=this,i=po.getIndex(hB.ins.curWSId),n=e?po.MODEL.panelEffect(i):po.MODEL.unactivatedPanelEffect(i);t._effectid!=n&&(t._effectid=n,t._effect&&t._effect.dispose(),t._effect=mj.GetNew(),t._effect.renderInSelf=!0,t._effect.pos(370,420),t._effect.loadEffect(n),t.addChild(t._effect))},t.updateSkillContent=function(){var e,t=this,i=po.getIndex(t._wsVo.wsid);0==t._wsVo.skilllv||t._wsVo.skilllv,t.imgSkillIcon.skin=_r.getIconPath(po.MODEL.skillIcon(i));for(var n=t._wsVo.totalPart,s=[],o=0;o<n;o++){var a=hB.getWspId(t._wsVo.wsid,o+1,t._wsVo.partLvs[o]),r=go.MODEL.attrs(go.getIndex(a));r&&0<r.length&&(s=aa.mergeFormatAttrs(r,s))}for(var l="",c=aa.formatAttrToChineseByList(s,!0),u=0;u<c.length;u++){var d=c[u];l+=d.name+" +"+d.val,l+=u%2==0?"    ":"<br>"}var h=t._wsVo.skilllv;h<=0&&(h=1);var _=fo.getIndex(100*t._wsVo.skillId+h);e=fo.MODEL.desc(_),t.txDes.innerHTML=l+Ql.createColor(e,"#5f5952")+"<br>",t.txSkillName_1.innerHTML=po.MODEL.name(i)+t._wsVo.step+"阶",t.txSkillName_2.changeText(po.MODEL.skillName(i)),t.mcF.value=RR.getFight(c,modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex)},t.showPartRedPt=function(){for(var e=0,t=4==this._total?4:8,i=4==this._total?4:6,n=0;n<t;n++)e=this._actorVo.wsPartShowTips(hB.ins.curWSId,n+1),t&&(this["mcR"+i+"_"+(n+1)].visible=1==e)},t.showRoleRedPt=function(){for(var e,t=gR.ins.actorList.length,i=0;i<t;i++)e=gR.ins.actorList[i],hB.ins.getVoByRole(e.id)},i.MINNUM=4,i.MAXNUM=8,i}(),qK=function(e){function t(){this._selector=null,this._actorVo=null,t.__super.call(this),this.init()}b(t,"modules.weaponsoul.views.WeaponSoulMainView",Qg);var i=t.prototype;return i.init=function(){this._selector=new Nj,this.addChild(this._selector),this.wsList.itemRender=PY,this.wsList.hScrollBarSkin="",this.wsList.scrollBar.elasticBackTime=20,this.wsList.scrollBar.elasticDistance=50,iu.optimizeList(this.wsList,PY),hB.ins.parseData()},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.updateByVSC=function(e,t){this.updateRedTip(),this.updateUI()},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t),t.btn_pre.on("click",t,t.onBtnHandler),t.btn_next.on("click",t,t.onBtnHandler),t.btn_wsl.on("click",t,t.onBtnHandler),t._selector.selectIdx=modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex,hB.ins.actorSelectIndex=t._selector.selectIdx,t._selector.on("select",t,t.onSelect),t.onSelect(modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex),t.updateRedTip()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_pre.off("click",t,t.onBtnHandler),t.btn_next.off("click",t,t.onBtnHandler),t.btn_wsl.off("click",t,t.onBtnHandler),t._selector.off("select",t,t.onSelect),hB.ins.curRole=-1,t.wsList.selectedIndex=0,t.btn_pre.visible=!1,t.btn_next.visible=!0,t.wsList.startIndex=0,t.wsList.tweenTo(0),hN.ins.close("WEAPONSOUL_DETAIL")},i.onSelect=function(e){void 0===e&&(e=-1),modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex=this._selector.selectIdx,hB.ins.actorSelectIndex=this._selector.selectIdx,hB.ins.curRole=this._selector.selectIdx+1,this.updateUI(),this.updateWsRedTip()},i.updateRedTip=function(){hB.ins.goodsUpdate(),this.updateActorRedTip(),this.callLater(this.updateWsRedTip)},i.updateActorRedTip=function(){for(var e,t,i=gR.ins.actorList.length,n=0;n<i;n++)e=gR.ins.actorList[n],t=hB.ins.getVoByRole(e.id),this._selector.setRedPtByIdx(e.id-1,t.showTips()||hB.ins.coreTotalRedPoint(e.id))},i.updateWsRedTip=function(){var e=po.count,t=modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex+1,i=hB.ins.getVoByRole(t);if(i)for(var n=0;n<e;n++){var s=this.wsList.getCell(n);s&&s.showRedTip(i.wsShowTips(s.wsId))}},i.updateUI=function(){var e=modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex+1,t=hB.ins.getVoByRole(e),i=[];if(this.btn_wsl.showTip=hB.ins.coreTotalRedPoint(e),t){for(var n=po.count,s=[],o=0;o<n;o++){var a=po.MODEL.key(o),r=t.getWsVo(a);if(r&&(r.showUsed=t.wearId==a),s.push(r),r)for(var l=r.totalPart,c=0;c<l;c++){var u=hB.getWspId(r.wsid,c+1,r.partLvs[c]),d=go.MODEL.attrs(go.getIndex(u));d&&0<d.length&&(i=aa.mergeFormatAttrs(d,i))}}this.wsList.array=s}for(var h=aa.formatAttrToChineseByList(i),_=0;_<4;_++)if(_<h.length){var f=h[_];this["txt_attr"+_].text=f.name+" +"+f.val}else this["txt_attr"+_].text="";this.updateBtnShow(),this.mc_power.value=RR.getFight(h,modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex)},i.onBtnHandler=function(e){var t=this;e.currentTarget==t.btn_pre?(t.btn_pre.mouseEnabled=!1,t.wsList.tweenTo(t.wsList.startIndex-2,200,ql.create(t,t.updateBtnShow))):e.currentTarget==t.btn_next?(t.btn_next.mouseEnabled=!1,t.wsList.tweenTo(t.wsList.startIndex+2,200,ql.create(t,t.updateBtnShow))):e.currentTarget==t.btn_wsl&&Tu.sendToModule("OPEN_WSCORE",["modules.strength.StrengthModule"])},i.updateBtnShow=function(){this.updateWsRedTip(),this.btn_pre.mouseEnabled=!0,this.btn_next.mouseEnabled=!0;var e=po.count;this.btn_next.visible=2<e-this.wsList.startIndex,this.btn_pre.visible=0!=this.wsList.startIndex},t.NAME="WeaponSoulMainView",t}(),jK=function(e){function t(){var e=this;e._wsVo=null,e._level=0,e._posId=0,e._costId=0,e._costNum=0,e._grid=null,e._isEnough=!1,e._partGrid=null,e._stepEff=null,e._cEff=[],e.breakGrid=null,e.break_costId=0,e.break_costNum=0,e.m_noLvGrid=null,e.no_costId=0,e.no_costNum=0,t.__super.call(e),e.mouseEnabled=!0,e._partGrid=new MF,e._partGrid.isClearUrl=!1,e._partGrid.pos(e.mcPart.x,e.mcPart.y),e.addChildAt(e._partGrid,7),e.txt_level.color="#d6d6d6"}b(t,"modules.weaponsoul.views.WeaponSoulLvUpV",$g);var i=t.prototype;return i.notice=function(e){var t=this;if("22504"==e.actionOrder){var i=e.proto,n=1==i.state?"jm0010":"jm0011";if(0==i.state){var s=mj.GetNew();s.renderInSelf=!0;var o=i.lv%10;if(0<o){var a=t["mcP_"+o];s.pos(a.x+t.mcBall.x+a.width/2,t["mcP_"+o].y+t.mcBall.y+a.height/2),s.loadEffect("jm0104"),s.playEndHandler=ql.create(t,t.effectEnd2,[s]),t.addChild(s)}UB.ins.playSound("4",3,!0)}else UB.ins.playSound("3",3,!0);t._stepEff&&t._stepEff.dispose(),t._stepEff=mj.GetNew(),t._stepEff.renderInSelf=!0,t._stepEff.pos(t.mcPart.x+.5*t.mcPart.width,t.mcPart.y+t.mcPart.height-45),t._stepEff.loadEffect(n),t._stepEff.playEndHandler=ql.create(t,t.effectEnd),t.addChild(t._stepEff),G.timer.once(200,t,t.showDetail)}else"BP_UPDATE"==e.actionOrder&&t.updateItem();t.addChildAt(t.txt_level,8)},i.effectEnd2=function(e){e.dispose()},i.effectEnd=function(){this._stepEff&&(this._stepEff.dispose(),this._stepEff=null)},i.onAdd=function(e){this.on("click",this,this.onClick),this.showDetail()},i.onRemove=function(e){var t=this;if(t.off("click",t,t.onClick),t._cEff)for(var i=t._cEff.length;0<i;i--)t._cEff.pop().dispose();t._partGrid&&t._partGrid.clearIconTexture(),t._grid&&t._grid.clearIconTexture(),Tu.sendToModule("UPDATE_DETAIL",["modules.strength.StrengthModule"])},i.onClick=function(e){var t=this;e.target==t.btnB?t._isEnough?(hB.ins.needUpdate=0,ev.ReqlvUp(modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex+1,t._posId),t.btnB.mouseEnabled=!1):t.noLvBox.visible?t.no_costId&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.no_costId}):t.breakBox.visible?t.break_costId&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.break_costId}):t._costId&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t._costId}):e.target==t.btn_close&&hN.ins.close("WEAPONSOULLVUPV")},i.showDetail=function(){var e=this,t=hB.ins;e._wsVo=t.getWsVoByRole(modules.strength.others.Strength_Data_Model.ins.currentSelectedRoleIndex+1,t.curWSId),e._level=e._wsVo.getPartLv(t.curPart),e._posId=hB.getWspId(t.curWSId,t.curPart,e._level);var i=e._level%10;e.upgradeBox.visible=!1,e.noLvBox.visible=!1,e.breakBox.visible=!1;var n=t.partIsTop(t.curWSId,t.curPart,e._level+1);if(e.imgTop.visible=n,e.btnB.visible=!n,n)return e.updateCircleUI(9,!0),e.img_title1.visible=!0,e.img_title2.visible=!1,void(e.img_title3.visible=!1);0==i&&0<e._level?(e.breakBox.visible=!0,e.breakUpgradeUI()):0<i?(e.upgradeBox.visible=!0,e.upgradeUI()):(e.noLvBox.visible=!0,e.noLvUpdateUI())},i.breakUpgradeUI=function(){var e=this,t=hB.ins;e.updateCircleUI(9,!0);var i=go.getIndex(e._posId),n=go.MODEL.cost(i).split(",");e.break_costId=n[0],e.break_costNum=n[1];var s=yB.create(e.break_costId);e.breakGrid||(e.breakGrid=new MF,e.breakGrid.isClearUrl=!1,e.breakGrid.pos(e.breakIcon.x,e.breakIcon.y),e.breakBox.addChild(e.breakGrid),e.breakBox.addChild(e.break_num)),e.breakGrid.bindData=s,e.btnB.label="突 破",e.img_title1.visible=!1,e.img_title2.visible=!1,e.img_title3.visible=!0,e.btnB.mouseEnabled=!0,e.break_name.changeText(s.name),s=t.getIconDto(t.curWSId)[t.curPart-1],e.txM.changeText(Bi.MODEL.name(s.cfgIdx)),e.txt_level.text=e._level+"",e._partGrid.bindData=s;var o=[],a=10*go.MODEL.grade(i)+10;(o=aa.formatAttrToChineseByList(go.MODEL.attrs(i))).unshift({name:RP.n[1113],val:a,module:RP.n[1114]});var r=[],l=go.getIndex(e._posId+1);l<0&&(l=i),(r=aa.formatAttrToChineseByList(go.MODEL.attrs(l))).unshift({name:RP.n[1115],val:10+a,module:RP.n[1116]}),e.showAttrBox(e.breakAttrs,"break_",o,r),e.updateItem()},i.updateCircleUI=function(e,t){var i,n=this;void 0===t&&(t=!1);for(var s=1;s<=9;s++){var o=n["mcP_"+s];o.index=s<=e?0:1,1<s&&(n["mcL_"+(s-1)].visible=1<s&&s<=e),s<=e?(n._cEff[s-1]?i=n._cEff[s-1]:((i=mj.GetNew()).renderInSelf=!0,i.loadEffect("jm0105"),n._cEff[s-1]=i),i.pos(o.x+o.height/2,o.y+o.width/2),n.mcBall.addChild(i)):n._cEff[s-1]&&(i=n._cEff[s-1]).parent&&n.mcBall.removeChild(i)}n.mcL_9.visible=t},i.noLvUpdateUI=function(){var e=this;e._partGrid&&(e._partGrid.bindData=null);var t=hB.ins;s=t.getIconDto(t.curWSId)[t.curPart-1],e.txM.changeText(Bi.MODEL.name(s.cfgIdx)),e.updateCircleUI(0,!1);var i=go.getIndex(e._posId),n=go.MODEL.cost(i).split(",");e.no_costId=n[0],e.no_costNum=n[1];var s=yB.create(e.no_costId);e.m_noLvGrid||(e.m_noLvGrid=new MF,e.m_noLvGrid.isClearUrl=!1,e.m_noLvGrid.pos(e.activeIcon.x,e.activeIcon.y),e.noLvBox.addChild(e.m_noLvGrid),e.noLvBox.addChild(e.active_num)),e.m_noLvGrid.bindData=s,e.btnB.label="激 活",e.img_title1.visible=!1,e.img_title2.visible=!0,e.img_title3.visible=!1,e.btnB.mouseEnabled=!0,e.active_name.changeText(s.name);var o=go.getIndex(e._posId+1);o<0&&(o=i);var a=aa.formatAttrToChineseByList(go.MODEL.attrs(o));e.showAttrBox(e.activeAttrs,"active_",a,null),e.updateItem()},i.upgradeUI=function(){var e=this,t=hB.ins,i=e._level%10;e.updateCircleUI(i);var n,s=Math.floor(e._level/10)+1;if(r=t.getIconDto(t.curWSId)[t.curPart-1],e.txM.changeText(Bi.MODEL.name(r.cfgIdx)),e.txt_level.text=e._level+"",e._partGrid.bindData=r,t.partIsTop(t.curWSId,t.curPart,e._level+1))return e.upgradeBox.visible=e.btnB.visible=!1,void(e.imgTop.visible=!0);if(e.upgradeBox.visible=e.btnB.visible=!0,e.imgTop.visible=!1,e.txDesc.visible=!1,9==i)if(n="炼 化",e.img_title1.visible=!0,e.img_title2.visible=!1,e.img_title3.visible=!1,0==e._wsVo.actived)e.txDesc.visible&&(e.txDesc.innerHTML=RP.n[1117]+Ql.createColor(e._wsVo.skillStep+"阶","#23b11f")+RP.n[1118]+po.MODEL.name(po.getIndex(t.curWSId))+RP.n[1119]);else{var o=fo.getIndex(100*t.curWSId+e._wsVo.skilllv+1),a=fo.MODEL.conditions(o)/10+1;e.txDesc.visible&&(e.txDesc.innerHTML=RP.n[1120]+Ql.createColor(a+"阶","#23b11f")+RP.n[1121]+Ql.createColor(e._wsVo.skilllv+1+"级技能","#23b11f"))}else n="炼 化",e.img_title1.visible=!0,e.img_title2.visible=!1,e.img_title3.visible=!1,e.txDesc.visible&&(e.txDesc.innerHTML="升级至"+Ql.createColor(10*(s-1)+10+"","#23b11f")+RP.n[1122]+Ql.createColor(mp.WORDS[s+1]+"阶","#23b11f"));e.btnB.label=n;var r,l=go.getIndex(e._posId),c=go.getIndex(e._posId+1),u=go.MODEL.cost(l).split(",");e._costId=u[0],e._costNum=u[1],e._grid||(e._grid=new MF,e._grid.isClearUrl=!1,e._grid.pos(e.mcIcon.x,e.mcIcon.y),e.upgradeBox.addChild(e._grid),e.upgradeBox.addChild(e.txNum)),e._grid.bindData&&e._grid.bindData.goodsId!=e._costId?(e._grid.bindData.recover(),e._grid.bindData=yB.create(e._costId)):null==e._grid.bindData&&(e._grid.bindData=yB.create(e._costId)),e.txcostName.changeText(Bi.MODEL.name(e._grid.bindData.cfgIdx)),e.updateItem();var d=aa.formatAttrToChineseByList(go.MODEL.attrs(l)),h=aa.formatAttrToChineseByList(go.MODEL.attrs(c));e.showAttrBox(e.upgradeAttrs,"upgrade_",d,h),e.btnB.mouseEnabled=!0},i.updateItem=function(){var e=this,t=0;e.upgradeBox.visible&&0<e._costId?(t=TR.ins.getGoodsNum(e._costId),e._isEnough=t>=e._costNum,e.txNum.innerHTML=Ql.createColor(t+"/"+e._costNum,e._isEnough?"#d6d6d6":"#ff2e24")):e.noLvBox.visible&&0<e.no_costId?(t=TR.ins.getGoodsNum(e.no_costId),e._isEnough=t>=e.no_costNum,e.active_num.innerHTML=Ql.createColor(t+"/"+e.no_costNum,e._isEnough?"#d6d6d6":"#ff2e24")):e.breakBox.visible&&0<e.break_costId&&(t=TR.ins.getGoodsNum(e.break_costId),e._isEnough=t>=e.break_costNum,e.break_num.innerHTML=Ql.createColor(t+"/"+e.break_costNum,e._isEnough?"#d6d6d6":"#ff2e24")),e.btnB.showTip=e._isEnough},i.showAttrBox=function(e,t,i,n){for(var s=e.numChildren,o=0;o<s;o++){var a=this[t+"attr"+o],r=this[t+"next"+o],l=this[t+"attr_next"+o];if(r.visible=!1,i.length>o){var c=i[o].name,u=i[o].val;if(a.text=c+"："+u,a.y=45*o,null!=n)for(var d=0;d<n.length;d++){n[o].name==c&&(l.text=n[o].val,r.x=a.textWidth+10,r.visible=!0)}switch(a.visible=!0,0,i.length){case 1:a.y=40;break;case 2:a.y=25*(o+1)+5*o}}else a.visible=!1}},i.showAttr=function(e,t,i,n){var s;void 0===n&&(n=!1),e.clear();var o=0,a=0,r=3,l=t.length;a=(o=1==l?32:2==l?19:4,27);for(var c=yc.getRes(_r.getAtlasSubPath("basic_ui/comp_textbg.png")),u=0;u<t.length;u++){if(s=t[u],n)e.drawTexture(c,r,o,50,25);else{e.drawTexture(c,r,o,155,25);var d=s.name;d||(d=aa.getAttributById(parseInt(s.id)).name),e.fillText(d+": ",r,o,"24px SimHei",i,"left"),r+=22*mp.getStringLength(d+": ")>>1}e.fillText(s.val+"",r,o,"24px SimHei",i,"left"),o+=a,r=3}},i.clearAttr=function(e){e.clear()},t}(),WK=function(e){function t(){t.__super.call(this)}b(t,"modules.weaponsoul.views.WeaponSoulTips1",tv);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showDetail()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showDetail=function(){var e=hB.ins,t=po.getIndex(e.curWSId),i=e.getWsVoByRole(e.curRole,e.curWSId);this.txSkillN_1.changeText(po.MODEL.skillName(t)),this.imgSkill.skin=_r.getIconPath(po.MODEL.skillIcon(t));var n=fo.getIndex(100*e.curWSId+i.skilllv);this.txSkillN_2.innerHTML=po.MODEL.skillName(t)+i.skilllv+"阶["+po.MODEL.posNum(t)+"/"+po.MODEL.posNum(t)+"]",this.txDesc_1.innerHTML=fo.MODEL.desc(n),n=fo.getIndex(100*e.curWSId+i.skilllv+1),this.txSkillN_3.innerHTML=po.MODEL.skillName(t)+i.skilllv+"阶["+Ql.createColor(i.nextfitParts+"","#ff2e24")+"/"+po.MODEL.posNum(t)+"]",this.txDesc_2.innerHTML=i.getTips(fo.MODEL.conditions(n))+"<br>"+Ql.createColor(fo.MODEL.desc(n),"#65533e")},t}(),YK=function(e){function t(){t.__super.call(this)}b(t,"modules.weaponsoul.views.WeaponSoulTips",iv);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showDetail()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showDetail=function(){var e=hB.ins,t=po.getIndex(e.curWSId),i=e.getWsVoByRole(e.curRole,e.curWSId);if(this.txSkillN_1.changeText(po.MODEL.skillName(t)),0==i.actived)return this.imgSkill.skin=_r.getIconPath(po.MODEL.effectIcon(t)),this.txSkillN_2.innerHTML=po.MODEL.name(t)+RP.n[1123]+Ql.createColor(i.fitParts+"","#ff2e24")+"/"+po.MODEL.posNum(t)+"]",void(this.txDesc.innerHTML=i.getTips(po.MODEL.effectCondition(t)));var n=fo.getIndex(100*e.curWSId+1);if(this.imgSkill.skin=_r.getIconPath(po.MODEL.skillIcon(t)),0==i.isTop)return this.txSkillN_2.innerHTML=po.MODEL.skillName(t)+"1阶["+Ql.createColor(i.fitParts+"","#ff2e24")+"/"+po.MODEL.posNum(t)+"]",void(this.txDesc.innerHTML=i.getTips(fo.MODEL.conditions(n))+"<br>"+Ql.createColor(fo.MODEL.desc(n),"#65533e"));this.txSkillN_2.innerHTML=po.MODEL.skillName(t)+i.skilllv.toString()+"阶["+po.MODEL.posNum(t)+"/"+po.MODEL.posNum(t)+"]",this.txDesc.innerHTML=fo.MODEL.desc(n)+"<br>"+Ql.createColor(RP.n[1124],"#65533e")},t}(),zK=function(e){function t(){this._actorId=0,this._xinfa=0,this._skillInfos=null,t.__super.call(this)}b(t,"modules.xinfa.view.XinfaSkillShowView",Iv);var i=t.prototype;return i.updateInfo=function(e){this._actorId=e.actor,this._xinfa=e.xinfa,this._skillInfos=pB.ins.getSkillIdByXinfaActor(this._actorId,this._xinfa),this.updatePanel()},i.updatePanel=function(){var e,t,i=this;0==i._skillInfos[0].skillId||0==i._skillInfos[1].skillId?i.boxNext.visible=!1:i.boxNext.visible=!0;var n=(e=0<i._skillInfos[0].skillId?i._skillInfos[0]:i._skillInfos[1]).skillId,s=Ls.getIndex(n);i.htmlNeed1.innerHTML=e.need,5<=e.bookNum?(i.labNum1.changeText(RP.n[1125]),i.labNum1.color="#23b11f"):(i.labNum1.changeText("("+e.bookNum+"/5)"),i.labNum1.color="#666666"),i.labName.changeText("斩魂刀");var o=i._skillInfos[0].quality;if(o<2&&(o=2),i.labName.color=ms.getByQuality(o),i.img_bg.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_4.png"),i.labNum1.x=i.htmlNeed1.x+i.htmlNeed1.contextWidth+5,i.labName1.changeText(Ls.MODEL.skillName(s)),i.labName1.color=ms.getByQuality(e.quality),i.htmlDesc1.innerHTML=Ls.MODEL.skillDesc(s),0<i._skillInfos[1].skillId&&(t=i._skillInfos[1]),t){var a=t.skillId,r=Ls.getIndex(a);i.htmlNeed2.innerHTML=t.need,5<=t.bookNum?(i.labNum2.changeText(RP.n[1126]),i.labNum2.color="#23b11f"):(i.labNum2.changeText("("+t.bookNum+"/5)"),i.labNum2.color="#666666"),i.labNum2.x=i.htmlNeed2.x+i.htmlNeed2.contextWidth+5,i.labName2.changeText(Ls.MODEL.skillName(r)),i.labName2.color=ms.getByQuality(t.quality),i.htmlDesc2.innerHTML=Ls.MODEL.skillDesc(r)}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){this._skillInfos=[],ui.ViewBase.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),this.imgSkillShow&&this.imgSkillShow.skin&&G.loader.clearRes(this.imgSkillShow.skin),laya.ui.View.prototype.destroy.call(this,e)},t}(),XK=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.yunying.views.YunyingAccountView",Sv);var i=t.prototype;return i.init=function(){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_ok:jP.sdk_cmd("switchaccount");break;case this.btn_close:case this.btn_cancel:this.close()}},i.close=function(){hN.ins.close("YUNYING_ACCOUNT_VIEW")},t}(),QK=function(e){function i(){this._eff=null,this._hasInitAward=!1,i.__super.call(this),this.centerY=-50}b(i,"modules.yunying.views.YunyingCareView",kv);var t=i.prototype;return t.initAward=function(){for(var e=Rn.MODEL.rewards(2),t=JSON.parse(e),i=0;i<t.length;i++){var n=this["txt_name"+i],s=this["img_grid"+i];if(null!=this.name&&null!=s){var o=new MF;s.addChild(o);var a=t[i],r=a.value.toString();switch(a.type){case"goods":var l=r.split(":");o.bindData=yB.create(l[0],l[1]);var c=Bi.getIndex(l[0]);n.changeText(Bi.MODEL.name(c)),n.color=ms.getByQuality(Bi.MODEL.colourId(c))}}}},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this._hasInitAward||this.initAward(),this._hasInitAward=!0,this.update(hr.wx_is_subscribe)},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&(this._eff.dispose(),this._eff=null)},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t.update=function(e){var t=this;if(void 0===e&&(e=0),t._eff&&(t._eff.dispose(),t._eff=null),0==e)t.btn_get.label=RP.n[1127],t.btn_get.disabled=!1,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btn_get.width/2,t.btn_get.height/2,t.btn_get),t._eff.scale_X=1,t._eff.scale_Y=1,t.btn_get.addChild(t._eff));else{parseInt(hr.webGetParams.wx_is_subscribe);t.btn_get.label=RP.n[935],t.btn_get.disabled=!1,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btn_get.width/2,t.btn_get.height/2,t.btn_get),t._eff.scale_X=1,t._eff.scale_Y=1,t.btn_get.addChild(t._eff))}i._status=e},t.onClick=function(e){switch(e.target){case this.btn_get:jP.sdk_cmd("subscribe");case this.btn_close:this.close()}},t.close=function(){hN.ins.close("YUNYING_CARE_VIEW")},i._status=1,i}(),JK=function(e){function t(){this._eff=null,this._hasInitAward=!1,t.__super.call(this),this.centerY=-50}b(t,"modules.yunying.views.YunyingMicroView",Ev);var i=t.prototype;return i.initAward=function(){for(var e=Rn.MODEL.rewards(1),t=JSON.parse(e),i=0;i<t.length;i++){var n=this["txt_name"+i],s=this["img_grid"+i];if(null!=this.name&&null!=s){var o=new MF;s.addChild(o);var a=t[i],r=a.value.toString();switch(a.type){case"goods":var l=r.split(":");o.bindData=yB.create(l[0],l[1]);var c=Bi.getIndex(l[0]);n.changeText(Bi.MODEL.name(c)),n.color=ms.getByQuality(Bi.MODEL.colourId(c))}}}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._hasInitAward||t.initAward(),t._hasInitAward=!0,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btn_download.width/2,t.btn_download.height/2,t.btn_download),t._eff.scale_X=1,t._eff.scale_Y=1,t.btn_download.addChild(t._eff))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&(this._eff.dispose(),this._eff=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_download:jP.sdk_cmd("download_wd");case this.btn_close:this.close()}},i.close=function(){hN.ins.close("YUNYING_MICRO_VIEW")},t}(),ZK=function(e){function t(){t.__super.call(this),this.init()}b(t,"modules.yunying.views.YunyingSaveView",Tv);var i=t.prototype;return i.init=function(){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_ok:jP.sdk_cmd("savetodesktop");case this.btn_cancel:case this.btn_close:this.close()}},i.close=function(){hN.ins.close("YUNYING_SAVE_VIEW")},t}(),KK=function(e){function t(){var e=this;e._eff=null,e._gridsList=null,e._hasInitAward=!1,t.__super.call(e),e.centerY=-50,e._gridsList=new vj,e._gridsList._spaceX=23,e._gridsList.centerX=-30,e._gridsList.y=308,e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=e._gridsList._gridH+4,e.addChild(e._gridsList),e.img_grid0.visible=e.txt_name0.visible=!1}b(t,"modules.yunying.views.YunyingShareView",Cv);var i=t.prototype;return i.initAward=function(){var e=Rn.MODEL.rewards(3),t=JSON.parse(e);this._gridsList.setGoodsItems(e,6),this._gridsList.size(t.length*(this._gridsList._spaceX+this._gridsList._gridW)-this._gridsList._spaceX,130),this.btn_share.label=RP.n[1129]},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._hasInitAward||t.initAward(),t._hasInitAward=!0,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btn_share.width/2,t.btn_share.height/2,t.btn_share),t._eff.scale_X=1,t._eff.scale_Y=1,t.btn_share.addChild(t._eff))},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&(this._eff.dispose(),this._eff=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_share:jP.sdk_cmd("share");case this.btn_close:this.close()}},i.close=function(){hN.ins.close("YUNYING_SHARE_VIEW")},t}(),$K=function(e){function t(){this._eff=null,this._hasInitAward=!1,t.__super.call(this),this.centerY=-50}b(t,"modules.yunying.views.YunyingVerifyView",Lv);var i=t.prototype;return i.initAward=function(){for(var e=Rn.MODEL.rewards(0),t=JSON.parse(e),i=0;i<t.length;i++){var n=this["txt_name"+i],s=this["img_grid"+i];if(null!=this.name&&null!=s){var o=new MF;s.addChild(o);var a=t[i],r=a.value.toString();switch(a.type){case"goods":var l=r.split(":");o.bindData=yB.create(l[0],l[1]);var c=Bi.getIndex(l[0]);n.changeText(Bi.MODEL.name(c)),n.color=ms.getByQuality(Bi.MODEL.colourId(c))}}}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._hasInitAward||t.initAward(),t._hasInitAward=!0,null==t._eff&&(t._eff=kB.createEffect("jm1242",t.btn_get.width/2,t.btn_get.height/2,t.btn_get),t._eff.scale_X=1,t._eff.scale_Y=1,t.btn_get.addChild(t._eff)),t.update(hr.id_verify)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&(this._eff.dispose(),this._eff=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_get:if(1==hr.id_verify||2==hr.id_verify){if(1==t._status)return void qP.verify(this,this.updateButtonStatus);nR.reqVerifyReward()}else zB.ins.playErrorMsg(RP.n[1130]+hr.id_verify);case this.btn_close:this.close()}},i.updateButtonStatus=function(){this.update(2)},i.close=function(){hN.ins.close("YUNYING_VERIFY_VIEW")},i.update=function(e){void 0===e&&(e=1),this.btn_get.label=1==e?RP.n[1131]:RP.n[1132],t._status=e},t._status=1,t}(),e$=function(e){function t(){this._grids=null,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.yzbqc.view.YzbqcEnterV",Dv);var i=t.prototype;return i.updateByVSC=function(e){"23120"==e.actionOrder&&this.setOpen()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.show()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.show=function(){var e=ko.MODEL.desc(0);this.txt_desc.innerHTML=e.split("$$")[0],this.txt_rule.innerHTML=e.split("$$")[1],this.setOpen()},i.setOpen=function(){this.imgClose.visible=!gB.ins.isOpen,this.btnGo.visible=gB.ins.isOpen},i.onClick=function(e){e.target==this.btnGo&&(gR.ins.lv>=ko.MODEL.openLevel(0)?(jR.reqEntry(ko.MODEL.sceneID(0)),hN.ins.close("YZBQC_ENTER")):zB.ins.playErrorMsg(ko.MODEL.openLevel(0)+RP.n[1133]))},t}(),t$=function(e){function t(){var e=this;e._chagneSizeT=0,e._killNotice=[],e._rewardId=0,e._canGet=!1,e._kplay=!1,e._reliveV=null,e._attackMask=null,e.changeCampTime=0,e.taskEffect=null,t.__super.call(e)}b(t,"modules.yzbqc.view.YzbqcMainV",Av);var i=t.prototype;return i.updateTimer=function(){this.changeCampTime=Math.ceil((gB.ins.changeCampTime-dr.curServerTime)/1e3),this.timeCd()},i.update=function(e){if("23103"==e.actionOrder)this._chagneSizeT=5;else if("23110"==e.actionOrder)this.updateRank(),this.updateReward();else if("23118"==e.actionOrder)this._killNotice.push(e.proto),this.showKillNotice();else if("23117"==e.actionOrder)this.updateReward();else if("23112"==e.actionOrder);else if("__ZHANBAO_YZBQ_PLAY_END__"==e.actionOrder){var t=e.proto,i={};if(i.victory=t.isMeWin,i.attacker=t.isMeAttack,i.rivalName=t.isMeAttack?t.defenderName:t.attackerName,t.isMeWin&&""!=i.rivalName)return void modules.boss.views.scene.Boss_WildKillView.pushNote(i,this.killBox);!t.isMeWin&&this.showRelive(i)}else if("23106"==e.actionOrder){!e.proto.dtoZhanBao.isMeAttack&&this.showAttackMask()}else e.actionOrder},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.timeCd()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._killNotice=[],this._chagneSizeT=0,this.changeCampTime=0,G.timer.clearAll(this)},i.onSelectedHeadHandler=function(e){},i.showAttackMask=function(){null==this._attackMask&&(this._attackMask=new Ij,this.addChild(this._attackMask)),this._attackMask.fadeShow()},i.onClick=function(e){e.target==this.btnExit?gB.ins.reqExit(ql.create(this,this.alertBack)):e.target==this.mcGift||e.target==this.img_gift?this._canGet?(Hv.ReqGetReward(this._rewardId),zB.ins.playGetGoods("85,1")):-1==this._rewardId?zB.ins.playErrorMsg(RP.n[1134]):zB.ins.playErrorMsg(RP.n[1135]):e.target==this.btn_look&&Tu.sendToModule("OPEN_RANK_AWARD",["modules.yzbqc.YzbqcModule"])},i.alertBack=function(e){1==e&&gB.ins.changeUI(!1)},i.showKillNotice=function(){var e=this;if(!e._kplay)if(0!=e._killNotice.length){e._kplay=!0,e.mcKill.visible=!0,e.mcKill.scaleX=e.mcKill.scaleY=1;var t=e._killNotice.shift();e.fcKill.value=t.num+"",e.txKillC.innerHTML=t.name+To.MODEL.desc(To.getIndex(t.num)),Og.from(e.mcKill,{scaleX:.1,scaleY:.1},100,pa.sineOut,ql.create(e,e.killEnd))}else e.mcKill.visible=!1},i.killEnd=function(){G.timer.once(1e3,this,this.showKillNotice),this._kplay=!1},i.updateRank=function(){var e=gB.ins.curRank;this.txMS.changeText(e.myRank.toString()),this.txMN.changeText(e.mySorce.toString());for(var t=0;t<4;t++)if(e.list.length>t){var i=e.list[t];this["txN_"+(t+1)].changeText(i.name),this["txS_"+(t+1)].changeText(i.sorce+"分")}else this["txN_"+(t+1)].changeText(""),this["txS_"+(t+1)].changeText("")},i.timeCd=function(){var e=this;e.txtTime.changeText(RP.n[1136]+Jp.getTickMS(gB.ins.endTime)),gB.ins.endTime-=1,300<=gB.ins.endTime?(0==e.txt_zhenying.visible&&(e.txt_zhenying.visible=!0),e.changeCampTime-=1,0<e.changeCampTime?e.txt_zhenying.changeText(RP.n[1137]+Jp.getTickMS(e.changeCampTime)):e.changeCampTime=300,e.txtTime.bottom=7):(e.txt_zhenying.visible=!1,e.txtTime.bottom=-10),0!=e._chagneSizeT?(e.mcChange.visible=!0,e.fcChange.value=e._chagneSizeT+"",Og.from(e.mcChange,{scaleX:.1,scaleY:.1},500,pa.sineOut),e._chagneSizeT-=1):e.mcChange.visible=!1,gB.ins.endTime<=30&&0<gB.ins.endTime?(e.mcEnd.visible=!0,e.fcEnd.value=gB.ins.endTime+"",Og.from(e.mcEnd,{scaleX:.1,scaleY:.1},500,pa.sineOut)):e.mcEnd.visible=!1,gB.ins.endTime<0?gB.ins.endTime=0:G.timer.once(995,e,e.timeCd)},i.onChangeEnd=function(){this.mcChange.visible=!1},i.updateReward=function(){var e=this,t=So.count;e._rewardId=-1;for(var i=0,n=0;n<t;n++)if(-1==gB.ins.getRewards.indexOf(So.MODEL.key(n))){e._rewardId=So.MODEL.key(n),i=n;break}if(-1==e._rewardId)return e._canGet=e.img_red.visible=e.mcGift.visible=!1,void e.removeEffect();e.mcGift.visible=!0,0<gB.ins.curRank.upSorce&&zB.ins.playNoticeMsg(RP.n[1138]+gB.ins.curRank.upSorce),e._canGet=gB.ins.curRank.mySorce>=So.MODEL.targetPoints(i);var s=e._canGet?"#23b11f":"#ff2e24";e.img_red.visible=e._canGet,e.txt_score.innerHTML="积分："+Ql.createColor(gB.ins.curRank.mySorce+"",s)+"/"+So.MODEL.targetPoints(i)},i.showEffect=function(){},i.removeEffect=function(){this.taskEffect&&(this.taskEffect.dispose(),this.taskEffect=null)},i.showRelive=function(e){null==this._reliveV&&(this._reliveV=new xJ,this._reliveV.centerX=0,this._reliveV.bottom=250),this._reliveV.fadeShow(this),this._reliveV.dataSource=e},t}(),i$=function(e){function t(){this.time=30,this.yzbqcData=null,t.__super.call(this),this.centerX=this.centerY=0,this.yzbqcData=gB.ins}b(t,"modules.yzbqc.view.YzbqcResultV",Ov);var i=t.prototype;return i.show=function(e){var t=this;if(null!=e){t.time=30,t.txTime.changeText(t.time+"s"),G.timer.loop(1e3,t,t.cd);var i=0;if(t.txtRank.changeText(e.rank+""),t.txt_jf.text=t.yzbqcData.curRank.mySorce.toString(),e&&-1!=e.rewardid){var n;if(null!=(n=Eo.getIndex(e.rewardid))||-1!=n){var s,o,a=Eo.MODEL.award(n).split(";");for(i=0;i<a.length;i++)""!=a[i]&&(s=a[i].split(","),(o=new MF(90)).dataSource=yB.create(s[0],s[1]),o.pos(t["r_"+(i+1)].x,t["r_"+(i+1)].y),t.box_awards.addChild(o),t["txG_"+(i+1)].changeText(Bi.MODEL.name(o.bindData.cfgIdx)))}}for(5<t.yzbqcData.curRank.list.length&&(t.yzbqcData.curRank.list.length=5),i=0;i<5;i++)t.yzbqcData.curRank.list.length>i?(t["txtPname_"+i].text=t.yzbqcData.curRank.list[i].name+"",t["txtScore_"+i].text=t.yzbqcData.curRank.list[i].sorce+"",""!=t.yzbqcData.curRank.list[i].guidName?t["txt_Gname_"+i].text=t.yzbqcData.curRank.list[i].guidName+"":t["txt_Gname_"+i].text=RP.n[1139]):(t["txtPname_"+i].text="--",t["txt_Gname_"+i].text="--",t["txtScore_"+i].text="--")}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clear(this,this.cd)},i.onClick=function(e){e.target==this.btnGet&&this.end()},i.cd=function(){this.time--,0<this.time?this.txTime.changeText(this.time+"s"):(G.timer.clear(this,this.cd),this.end())},i.end=function(){G.timer.clear(this,this.cd),hN.ins.close("YZBQC_RESULT"),this.yzbqcData.changeUI(!1)},t}(),n$=function(e){function t(){t.__super.call(this)}b(t,"modules.yzbqc.view.YzbqcPlayerRankV",Nv);var i=t.prototype;return i.updateByVSC=function(e){"23110"==e.actionOrder&&this.show()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.show()},i.show=function(){this.mcL.itemRender=Rv,this.mcL.dataSource=gB.ins.curRank.list,this.mcL.vScrollBarSkin="";var e=0==gB.ins.curRank.myRank?"未上榜":gB.ins.curRank.myRank+"";this.txt_rank.changeText(RP.n[1140]+e),this.txt_score.changeText(RP.n[1141]+gB.ins.curRank.mySorce)},t}(),s$=function(e){function t(){this._grids=null,t.__super.call(this)}b(t,"modules.yzbqc.view.itemrender.YzbqcRRItem",e);var i=t.prototype;return i.getGrid=function(e){return this._grids||(this._grids=[]),null==this._grids[e]&&(this._grids[e]=new MF(80)),this._grids[e]},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(null!=e){var t=e,i=Eo.MODEL.range(t).split(",");i[0]==i[1]?this.txNum.changeText("第"+i[0]+"名"):this.txNum.changeText("第"+i[0]+"-"+i[1]+"名");for(var n,s,o=Eo.MODEL.award(t).split(";"),a=0;a<o.length;a++)""!=o[a]&&(n=o[a].split(","),(s=this.getGrid(a)).dataSource=yB.create(n[0],n[1]),s.pos(this["b_"+(a+1)].x,this["b_"+(a+1)].y),this.addChild(s),this["txtName_"+a].text=Bi.MODEL.name(Bi.getIndex(n[0])))}}),t}(Bv),o$=function(e){function t(){this._list=[],this.awarditem=null,this.awardsArr=[],this.currentPage=0,this.totalPage=0,t.__super.call(this),this.panel_award.hScrollBarSkin="",this.panel_award.hScrollBar.elasticDistance=300}b(t,"modules.yzbqc.view.YzbqcRewardRankV",Pv);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showInfo(),this.btnLeft.on("click",this,this.onclick),this.btnRight.on("click",this,this.onclick)},i.onclick=function(e){var t=this;e.target==t.btnLeft?(0<t.currentPage?t.currentPage--:t.currentPage=0,t.panel_award.hScrollBar.setScroll(0,480,480*t.currentPage)):e.target==t.btnRight&&(t.currentPage>t.totalPage?t.currentPage=t.totalPage:t.currentPage++,t.panel_award.hScrollBar.setScroll(0,480*t.totalPage,480*t.currentPage))},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e);for(var i=0;i<t.awardsArr.length;i++)null!=t.awardsArr[i].parent&&(t.awardsArr[i].parent.removeChild(t.awardsArr[i]),t.awardsArr[i]=null);t.btnLeft.off("click",t,t.onclick),t.btnRight.off("click",t,t.onclick),t.awardsArr.length=0},i.showInfo=function(){if(this.mcL.itemRender=s$,this.mcL.vScrollBarSkin="",0==this._list.length)for(var e=0;e<Eo.count;e++)this._list[e]=e;this.mcL.dataSource=this._list,this.showAwardsInfo()},i.showAwardsInfo=function(){this.totalPage=Math.floor(So.count/4);for(var e=0;e<So.count;e++)this.awarditem=new UY,this.panel_award.addChild(this.awarditem),this.awardsArr.push(this.awarditem),this.awarditem.x=120*e,this.awarditem.y=10,this.awarditem.showInfo(So.MODEL.key(e))},t}(),a$=function(e){function t(){var e=this;e.siegedata=null,e.caijiTime=0,e.isCaiJiIng=!1,e.caijiName="",e.btnSceneIsEnabled=!1,e.endSceneID=0,e.tips=null,e.tipsCM=null,e.effect=null,t.__super.call(e),e.centerX=e.centerY=0,e.siegedata=DN.instance,e.initUI()}b(t,"modules.newsiege.views.NewSiegeSceneMainView",Oj);var i=t.prototype;return i.onAdd=function(e){var t=this;if(ui.ViewBase.prototype.onAdd.call(t,e),0!=BR.ins.curCopyId){var i=rn.getIndex(BR.ins.curCopyId),n=rn.MODEL.bossId(i);qU.ins.setDropBtnStatus(n,!0,ql.create(t,t.onAward,null,!1))}t.box_dn.visible=t.box_dq.visible=!1,null!=BR.ins.toc24033&&(BR.ins.toc24033.list=[]),t.nav_guiShu.txt_guishu.text=RP.n[1142],t.updateInfo(),t.btn_cq.on("click",t,t.onClickCaiJi),t.btn_cn.on("click",t,t.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[1],"城内"]]),t.btn_dq.on("click",t,t.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[2],"殿前"]]),t.btn_dn.on("click",t,t.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[3],"皇宫"]]),t.btn_cn1.on("click",t,t.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[1],"城内"]]),t.btn_dq1.on("click",t,t.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[2],"殿前"]]),t.nav_hurtRank.visible=t.nav_caiji.visible=!1},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.siegedata.enterSceneId=0,t.nav_hurtRank.btn_one.off("click",t,t.onClickHurtRankListener),t.nav_hurtRank.btn_all.off("click",t,t.onClickHurtRankListener),t.nav_otherGuild.btn_other_look.off("click",t,t.onClickGuideInfo),t.nav_selfGuild.btn_self_look.off("click",t,t.onClickSelfGuild),t.btn_cq.off("click",t,t.onClickCaiJi),t.btn_cn.off("click",t,t.onClickBtnSceneListener),t.btn_dq.off("click",t,t.onClickBtnSceneListener),t.btn_dn.off("click",t,t.onClickBtnSceneListener),t.btn_cn1.off("click",t,t.onClickBtnSceneListener),t.btn_dq1.off("click",t,t.onClickBtnSceneListener),t.btnSceneIsEnabled=!1,G.timer.clear(t,t.showEndCDTime),G.timer.clearAll(t),t.clearTips(),t.tipsCM=null;var i=parseInt(uH.Ins().currCid);i==DN.NEW_SIEGE_SCENEID[0]?.5==t.btn_cn.alpha?t.siegedata.isShowCN_effect_h=!1:1==t.btn_cn.alpha&&(t.siegedata.isShowCN_effect_a=!1):i==DN.NEW_SIEGE_SCENEID[1]?t.siegedata.isShowDQ_effect=!1:i==DN.NEW_SIEGE_SCENEID[2]?t.siegedata.isShowHG_effect=!1:i==DN.NEW_SIEGE_SCENEID[3]&&(t.siegedata.isShowCQ_effect=!1),t.clearEffect(),t.siegedata._toc23335=null},i.showCaiJiInfo=function(e,t,i,n){void 0===t&&(t=""),void 0===i&&(i=""),void 0===n&&(n=0),this.nav_caiji.visible=e,this.isCaiJiIng=e,this.caijiName=t,e?(this.nav_caiji.txt_guildName.text=i,this.caijiTime=(n-dr.curServerTime)/1e3,this.nav_caiji.txt_name.innerHTML=t+RP.n[1143]+Ql.createColor("("+Jp.getCNTickMS(this.caijiTime)+")","#23b11f")):this.caijiTime=0},i.showEndCDTime=function(){var e=this;if(e.isCaiJiIng&&(0<e.caijiTime?(e.nav_caiji.txt_name.innerHTML=e.caijiName+RP.n[1144]+Ql.createColor("("+Jp.getCNTickMS(e.caijiTime)+")","#23b11f"),e.caijiTime--):e.caijiTime<=0&&e.nav_caiji.visible&&(e.siegedata.reqCaiJiEndInfo(),e.nav_caiji.visible=!1)),0<e.siegedata.endTime){var t=e.siegedata.endTime-dr.serverTimeSec;60<=t?e.nav_guiShu.txt_time.innerHTML=RP.n[1145]+Ql.createColor(Jp.getCNTickMS(t),"#23b11f"):0<t?e.nav_guiShu.txt_time.innerHTML=RP.n[1146]+Ql.createColor(t+"秒","#23b11f"):G.timer.loop(1e3,e,e.showEndCDTime)}},i.showMoveBtn=function(){this.showSelfSceneInfo()},i.updateInfo=function(){this.showHurtRankInfo(),this.showGuildRankInfo(),this.showSelfGuildRankInfo(),this.showLongChengInfo(),this.showSelfSceneInfo(),this.showMoveScene(),G.timer.loop(1e3,this,this.showEndCDTime)},i.playGetItemsByPos=function(e){var t=wi.getIndex(e),i=wi.MODEL.goodsRewardStr(t).split(",")[0];zB.ins.playGetItemsByPos([i],new Uh(this.nav_gift.x+this.nav_gift.width/2,this.nav_gift.y+this.nav_gift.height/2))},i.updateScore=function(e){var t=this;if(void 0===e&&(e=!1),t.nav_gift.visible||(t.nav_gift.visible=!0),0!=t.siegedata.addZhanGong&&1==e){var i=[{text:t.siegedata.addZhanGong<0?"扣除：":"获得：",color:""},{text:"战功"},{text:"x"+Math.abs(t.siegedata.addZhanGong),color:"#00ff00"}];zB.ins.showMsg(i,2,!1)}t.txt_value.innerHTML=RP.n[1147]+Ql.createColor(t.siegedata.myGongXun.toString(),"#23b11f"),t.nav_gift.updateScore(e),t.showGuildRankInfo(),t.showSelfGuildRankInfo(),hN.ins.isOpen("GUILD_RANK_MAINVIEW")&&Tu.sendToModule("GUILD_RANK_AWARDS_UPDATE",["modules.guild.GuildModule"],{thisFight:!0}),t.showBtnSceneStatus()},i.updateWinGuild=function(){""!=this.siegedata.winGuild?this.nav_guiShu.txt_guishu.text=RP.n[1148]+this.siegedata.winGuild:this.nav_guiShu.txt_guishu.text=RP.n[1142]},i.showHurtRankInfo=function(){var e=this;0<e.siegedata.hurtRank.length&&uH.Ins().currCid==_a.S_SBK_OUT.toString()&&(e.box_scene.visible=!1,e.nav_hurtRank.visible=!0,e.nav_hurtRank.box_all.visible=!1,e.nav_hurtRank.box_one.visible=!0,e.nav_hurtRank.txt_name.text=e.siegedata.hurtRank[0].Name,e.nav_hurtRank.txt_hurt.text=(e.siegedata.hurtRank[0].Hurt/1e4).toFixed(1)+"万",e.nav_hurtRank.btn_one.visible=!1,e.nav_hurtRank.btn_one.on("click",e,e.onClickHurtRankListener),e.nav_hurtRank.btn_all.on("click",e,e.onClickHurtRankListener),e.showHurtRank())},i.closeHurtRank=function(){this.siegedata.hurtRank=[],this.nav_hurtRank.visible=!1,this.btnSceneIsEnabled=!0,this.btn_cn.alpha=1},i.updateScenePlayerNum=function(e){this.nav_selfGuild&&this.nav_selfGuild.parent&&(this.nav_selfGuild.txt_sceneName.innerHTML=RP.n[1150]+Ql.createColor(e.toString(),"#e0d6c1"))},i.showGuildRankInfo=function(){for(var e=this,t=0;t<3;t++)e.siegedata.guideRank.length>t?(e.nav_otherGuild["txt_guild_"+t].text=e.siegedata.guideRank[t].gname,e.nav_otherGuild["txt_score_"+t].text=e.siegedata.guideRank[t].score):(e.nav_otherGuild["txt_guild_"+t].text=RP.n[1151],e.nav_otherGuild["txt_score_"+t].text="0");e.showLongChengInfo(0<e.siegedata.guideRank.length?e.siegedata.guideRank[0].gname:""),e.nav_otherGuild.btn_other_look.on("click",e,e.onClickGuideInfo)},i.showSelfGuildRankInfo=function(){this.nav_selfGuild.txt_gScore.innerHTML=RP.n[1152]+Ql.createColor(this.siegedata.myGuildScore.toString(),"#e0d6c1"),this.nav_selfGuild.txt_pScore.innerHTML=RP.n[1153]+Ql.createColor(this.siegedata.myScore.toString(),"#e0d6c1"),this.nav_selfGuild.btn_self_look.on("click",this,this.onClickSelfGuild)},i.showLongChengInfo=function(e){void 0===e&&(e=""),this.nav_guiShu.txt_guishu.text=""!=e?RP.n[1154]+e:RP.n[1155]},i.showMoveScene=function(){this.box_scene.visible=!1,this.btn_cn.on("click",this,this.onClickBtnSceneListener,[[DN.NEW_SIEGE_COPYID[1],"城内"]])},i.onClickHurtRankListener=function(e){e.target==this.nav_hurtRank.btn_one?(this.nav_hurtRank.box_all.visible=!1,this.nav_hurtRank.box_one.visible=!0):e.target==this.nav_hurtRank.btn_all&&(this.nav_hurtRank.box_all.visible=!0,this.nav_hurtRank.box_one.visible=!1)},i.showSelfSceneInfo=function(){var e=this,t=0;if(this.box_btn_scene.visible=!1,this.box_dq.visible=this.box_dn.visible=this.btn_cn.visible=this.btn_dq.visible=!1,this.cp_caiji.index=1,dr.dtoEnterScene&&0!=dr.dtoEnterScene.cid){var i=rn.getIndex(dr.dtoEnterScene.copyId),n=rn.MODEL.cId(i);20130==n?(this.box_btn_scene.visible=!0,t=0,this.box_scene.visible=!1,G.timer.once(200,this,function(){e.btnSceneIsEnabled=0==e.showShaChengDoor(),e.btn_cn.alpha=e.btnSceneIsEnabled?1:.5,e.img_sceneBg.visible=e.btn_cn.visible=!0,e.showOrHideEffect(e.btn_cn,e.siegedata.isShowCN_effect_h,e.box_btn_scene)})):20140==n?(this.box_btn_scene.visible=!0,this.nav_hurtRank.visible=!1,t=1,this.btnSceneIsEnabled=this.checkGongXun(DN.NEW_SIEGE_COPYID[2]),this.img_sceneBg.visible=this.btn_dq.visible=this.btnSceneIsEnabled,this.box_scene.visible=!this.btnSceneIsEnabled,this.endSceneID!=n&&zB.ins.playRainbowByWords(RP.n[1156],5e3)):20150==n?(this.box_btn_scene.visible=!0,this.nav_hurtRank.visible=!1,t=2,this.btnSceneIsEnabled=this.checkGongXun(DN.NEW_SIEGE_COPYID[3]),this.box_scene.visible=!0,this.img_sceneBg.visible=this.box_dq.visible=this.btnSceneIsEnabled,this.box_scene.visible=!this.btnSceneIsEnabled,zB.ins.playRainbowByWords(RP.n[1157],5e3)):20160==n&&(this.cp_caiji.index=0,t=3,this.box_btn_scene.visible=!0,this.btnSceneIsEnabled=!0,this.nav_hurtRank.visible=this.box_scene.visible=!1,this.img_sceneBg.visible=this.box_dn.visible=this.btnSceneIsEnabled,zB.ins.playRainbowByWords(RP.n[1158],5e3));for(var s=0;s<_a.S_SBK_SCENES.length;s++)this["cp_"+s].index=s<=t?0:1,null!=this["line_"+s]&&(this["line_"+s].visible=!1);for(s=0;s<t;s++)this["line_"+s].visible=s<t;this.endSceneID=n}this.btn_cn.visible&&this.siegedata.isShowCN_effect_h&&(this.siegedata.isShowCN_effect_h=!1)},i.showBtnSceneStatus=function(){var e=this;e.box_btn_scene.visible=!1,e.box_dq.visible=e.box_dn.visible=e.btn_cn.visible=e.btn_dq.visible=!1;var t=rn.getIndex(dr.dtoEnterScene.copyId),i=rn.MODEL.cId(t);20130==i?(e.box_btn_scene.visible=!0,e.btnSceneIsEnabled=0==e.showShaChengDoor(),e.btn_cn.alpha=e.btnSceneIsEnabled?1:.5,e.img_sceneBg.visible=e.btn_cn.visible=!0,1!=e.btn_cn.alpha&&null==e.tipsCM&&(e.tipsCM=eJ.addShow(RP.n[1159],e,e.box_btn_scene.x+38,e.box_btn_scene.y-70,!0,6)),.5==e.btn_cn.alpha?e.showOrHideEffect(e.btn_cn,e.siegedata.isShowCN_effect_h,e.box_btn_scene):1==e.btn_cn.alpha&&e.showOrHideEffect(e.btn_cn,e.siegedata.isShowCN_effect_a,e.box_btn_scene)):20140==i?(e.box_btn_scene.visible=!0,e.btnSceneIsEnabled=e.checkGongXun(DN.NEW_SIEGE_COPYID[2]),e.img_sceneBg.visible=e.btn_dq.visible=e.btnSceneIsEnabled,e.box_scene.visible=!e.btnSceneIsEnabled,0==e.box_scene.visible&&1==e.btn_dq.visible&&e.showPopo("殿前",e.btn_dq),e.btn_dq.visible&&e.showOrHideEffect(e.btn_dq,e.siegedata.isShowDQ_effect,e.box_btn_scene)):20150==i?(e.clearTips(),e.box_btn_scene.visible=!0,e.btnSceneIsEnabled=e.checkGongXun(DN.NEW_SIEGE_COPYID[3]),e.img_sceneBg.visible=e.box_dq.visible=e.btnSceneIsEnabled,e.box_scene.visible=!e.btnSceneIsEnabled,e.box_dq.visible&&e.showOrHideEffect(e.btn_dn,e.siegedata.isShowHG_effect,e.box_dq)):20160==i&&(e.box_btn_scene.visible=!0,e.img_sceneBg.visible=e.box_dn.visible=!0,e.box_scene.visible=!1,e.box_dn.visible&&e.showOrHideEffect(e.btn_cq,e.siegedata.isShowCQ_effect,e.box_dn))},i.onClickSelfGuild=function(e){Tu.sendToModule("OPEN_GUILD_PERSON_VIEW",["modules.newsiege.NewSiegeModule"])},i.onClickCaiJi=function(e){e&&e.target==this.btn_cq&&(this.siegedata.isShowCQ_effect=!1);for(var t,i=zN.getCollectionInStage(),n=0,s=0;s<i.length;s++)if(i[s]&&i[s].data){var o=i[s].data;if(o&&6==o.charType){n=o.objectId,t=i[s];break}}if(null!=this.siegedata._toc23335)this.siegedata._toc23335.guildName!=gR.ins.guildName?(zB.ins.showMsg(RP.n[1160],1),sH.fights(this.siegedata._toc23335.uuid)):zB.ins.showMsg(RP.n[1161]+this.siegedata._toc23335.charName+RP.n[1162],1);else{if(t)var a=ZN.getTileDis(NF.mainChar.tilePoint,t.tilePoint);0!=n&&a<=1?this.siegedata.reqCaiJiStartInfo(n):Tu.sendToService(new lD)}this.clearEffect()},i.onClickGuideInfo=function(e){Tu.sendToModule("GUILD_RANK_AWARDS",["modules.guild.GuildModule"],{selectedIndex:0})},i.onClickBtnSceneListener=function(e,t){var i=this;if(!NF.mainChar.isDeath){if(i.siegedata.enterSceneId=e[0],i.siegedata.sceneName=e[1],0==i.btnSceneIsEnabled)e[0]==DN.NEW_SIEGE_COPYID[1]&&zB.ins.showMsg(RP.n[1163],1),sH.startInstantFight();else if(sH.stop(),e[0]==DN.NEW_SIEGE_COPYID[1]){var n=rn.MODEL.cId(rn.getIndex(e[0]));i.siegedata.reqEntry(n)}else 0!=e[0]&&i.siegedata.reqBeforeMoveScene(e[0]);t.target==i.btn_cn?.5==i.btn_cn.alpha?i.siegedata.isShowCN_effect_h=!1:1==i.btn_cn.alpha&&(i.siegedata.isShowCN_effect_a=!1):t.target==i.btn_dq?i.siegedata.isShowDQ_effect=!1:t.target==i.btn_dn?i.siegedata.isShowHG_effect=!1:t.target==i.btn_cq&&(i.siegedata.isShowCQ_effect=!1),i.clearEffect(),i.clearTips()}},i.showHurtRank=function(){for(var e=0;e<DN.HURT_NUM;e++)this.siegedata.hurtRank.length>e?(this.nav_hurtRank["txt_name_"+e].text=this.siegedata.hurtRank[e].Name,this.nav_hurtRank["txt_score_"+e].text=(this.siegedata.hurtRank[e].Hurt/1e4).toFixed(1)+"万"):(this.nav_hurtRank["txt_name_"+e].text=RP.n[1164],this.nav_hurtRank["txt_score_"+e].text="0")},i.initUI=function(){this.nav_gift.visible=!0;var e=0;for(e=0;e<4;e++)this["cp_"+e].index=1;this.nav_caiji.mc_head.skin=_r.getBossPath("ichead0050"),this.nav_caiji.mc_head.x=-9,this.nav_caiji.mc_head.y=-9,this.nav_hurtRank.centerX=60,this.nav_hurtRank.centerY=-80},i.showShaChengDoor=function(){var e=!1;if(BR.ins.toc24033&&0<BR.ins.toc24033.list.length)for(var t=0;t<BR.ins.toc24033.list.length;t++){if(parseInt($e.MODEL.value($e.getIndex(148)))==BR.ins.toc24033.list[t].bossid){e=!0;break}e=!1}else e=!1;return e},i.checkGongXun=function(e){var t=xi.getIndex(e),i=xi.MODEL.needExploit(t);return this.siegedata.myGongXun>=i},i.clearTips=function(){this.tips&&(this.tips.removeSelf(),this.tips.destroy(),this.tips=null),this.tipsCM&&(this.tipsCM.removeSelf(),this.tipsCM.destroy())},i.showPopo=function(e,t){null==this.tips&&(this.tips=eJ.addShow(RP.n[1165]+e+RP.n[1166],this,this.box_btn_scene.x+38,this.box_btn_scene.y-70,!0,6))},i.onAward=function(){hN.ins.open("BOSS_SCZB_SCENE_AWARD",{id:BR.ins.curCopyId})},i.showOrHideEffect=function(e,t,i){var n=new Uh(e.x+50,e.y+42);t&&(null==this.effect&&(this.effect=kB.createEffect("jm1081",0,0)),this.effect.pos(n.x,n.y),this.effect.parent||i.addChild(this.effect),this.effect.mouseEnabled=!1,this.effect.mouseThrough=!1)},i.clearEffect=function(){this.effect&&(this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect.dispose(),this.effect=null)},t}(),r$=function(e){function t(){var e=this;e._handEff=null,e._orgX=0,e._orgY=0,e.tween1=null,e.tween2=null,e.tween3=null,e.titleTween=null,e.ballTween=null,e.isOver=!1,t.__super.call(e),e.img_bg.skin=_r.getActImg()}b(t,"modules.achievenew.views.tujian.Tujian_ActivedView",dI);var i=t.prototype;return i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),0!=t.isOver&&(t.tween1&&t.tween1.clear(),t.tween2&&t.tween2.clear(),t.tween3&&t.tween3.clear(),t.titleTween&&t.titleTween.clear(),t.ballTween&&t.ballTween.clear(),t._handEff&&(t._handEff.parent&&t._handEff.parent.removeChild(t._handEff),t._handEff.dispose(),t._handEff=null))},i.destroy=function(e){void 0===e&&(e=!0),this.img_bg&&this.img_bg.skin&&""!=this.img_bg.skin&&G.loader.clearRes(this.img_bg.skin),ui.SubPanel.prototype.destroy.call(this,e)},i.setHide=function(){this.item.scale(0,0),this.item.txt_name.text="",this.item.sp_star.visible=!1,this.item.img_full.visible=!1,this.item.img_bold.visible=!1},i.update=function(e){var t=this,i=Bt.getIndex(e),n=JSON.parse(Bt.MODEL.goodsComsumption(i)),s=yB.create(parseInt(n[0].value.toString().split(":")[0])),o=Bi.MODEL.colourId(s.cfgIdx);t.txt_name.innerHTML=Bt.MODEL.name(i);var a=t.item;a.img_bg.skin=_r.getAtlasSubPath("tujian/tj_fk_b_"+o+".png");var r="bg_"+Bt.MODEL.type(i)+"_"+Bt.MODEL.index(i);a.img_pic.skin=_r.getTuJianPathJpg(r),a.font_power.value=zP.getBossCardLevelFight(i)+"",a.fight.width=a.font_power.x+22*a.font_power.value.length+a.font_power.spaceX,t.setHide(),t.box_active.visible=!1,t.txt_name.x=t.txt_name_bg.x=-60,t.txt_name.alpha=t.txt_name_bg.alpha=0,t.img_bg.y=-280,t.img_bg.centerX=0,t.tween1=Og.to(t.img_bg,{y:0},1e3,pa.bounceOut,ql.create(t,t.onEffectComplete))},i.onEffectComplete=function(){var e=this;e.box_active.visible=!0,e.timerOnce(800,e,e.onComposeShow),e.onComposeShowRingName(),e.box_active.scale(0,0),e.titleTween=Og.to(e.box_active,{scaleX:1,scaleY:1},1e3,pa.bounceOut),e.item.scale(0,0),e.ballTween=Og.to(e.item,{scaleX:1,scaleY:1},500,pa.bounceOut)},i.onComposeShow=function(){var e=this;e.graphics.clear(),e.graphics.drawRect(0,0,e.width,e.height,"#000000"),UB.ins.playSound("23",3,!0),e._handEff||(e._handEff=kB.createEffect("jm1034",360,388,e),e.setChildIndex(e._handEff,e.getChildIndex(e._handEff)-1)),e._handEff.scaleX=e._handEff.scaleY=1.2},i.onComposeShowRingName=function(){this.tween2=Og.to(this.txt_name,{x:96,alpha:1},500,pa.backInOut),this.tween3=Og.to(this.txt_name_bg,{x:77,alpha:1},500,pa.backInOut),this.isOver=!0},t.HANDEFFID="jm1034",t}(),l$=function(e){function t(){var e=this;e.index=0,e.activeKey=0,e.activeIndex=0,e.c_gid=0,e.c_gnum=0,e.c_exp=0,e.g_colorId=0,e.dto=null,e.state=0,e._BAR_W=0,e.headList=null,e.GRID_Y=38,e.star_y=[60,40,21,4,0,-8],e.eff=null,e._lbox=null,e._rbox=null,t.__super.call(e)}b(t,"modules.achievenew.views.tujian.Tujian_DetailView",fI);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.setHide(),t._BAR_W=t.bar.width,t.txt_cost.visible=t.sp_bar.visible=t.img_full.visible=!1,t.txt_cost.width=350,t.txt_special.visible=!1,t.btn_active.on("click",t,t.onClickHandler),t.btn_close.on("click",t,t.onClickHandler),t.link_path.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_active.off("click",t,t.onClickHandler),t.btn_close.off("click",t,t.onClickHandler),t.link_path.off("click",t,t.onClickHandler),t.setHide(),t.clearActiveEff()},i.setHide=function(e){void 0===e&&(e=!1),this.img_red.visible=e,this.item.img_full.visible=e},i.setLevel=function(e){var t=this;t.item.sp_star.visible=!0,t.headList=t.headList||[];for(var i=Bt.MODEL.level(e),n=0;n<10;n++)if(n<i){if(!t.headList[n]){var s=new Kl;s.pos(23*n,0),t.headList.push(s),t.headList[n].skin=_r.getAtlasSubPath("tujian/tj_xx_1.png")}t.headList[n].visible=!0,t.headList[n].parent||t.item.sp_star.addChild(t.headList[n])}else t.headList[n]&&(t.headList[n].visible=!1)},i.initInfo=function(e){if(e){this.index=e.index,this.activeKey=e.activeKey,this.activeIndex=Bt.getIndex(this.activeKey);var t=JSON.parse(Bt.MODEL.goodsComsumption(this.index));this.c_gid=parseInt(t[0].value.toString().split(":")[0]),this.c_gnum=parseInt(t[0].value.toString().split(":")[1]),this.setCardsInfo(),this.setCardsState()}},i.setCardsInfo=function(){var e=this;e.dto=yB.create(e.c_gid),e.g_colorId=Bi.MODEL.colourId(e.dto.cfgIdx),e.item.txt_name.color=ms.getByQuality(e.g_colorId),e.item.txt_name.text=Bt.MODEL.name(e.index),e.item.img_bg.skin=_r.getAtlasSubPath("tujian/tj_fk_b_"+e.g_colorId+".png");var t="bg_"+Bt.MODEL.type(e.index)+"_"+Bt.MODEL.index(e.index);e.item.img_pic.skin=_r.getTuJianPathJpg(t)},i.setCardsState=function(){var e=this;-1==e.activeKey?(e.state=0,e.item.sp_star.visible=!1):(0==Bt.MODEL.nextLevelId(Bt.getIndex(e.activeKey))?e.state=2:e.state=1,e.setLevel(e.activeIndex)),e.link_path.visible=2!=e.state;var t=e.item;t.font_power.value=zP.getBossCardLevelFight(0<e.state?e.activeIndex:e.index)+"",t.fight.width=t.font_power.x+22*t.font_power.value.length+t.font_power.spaceX,t.img_pic.filters=0==e.state?A_.getGrayFilter():null,e.setAttrs(),e.setActiveComsump()},i.setActiveComsump=function(){var e=this;switch(e.setHide(),e.clearActiveEff(),e.txt_cost.visible=0==e.state,e.sp_bar.visible=1==e.state,e.img_full.visible=2==e.state,e.btn_active.visible=2!=e.state,e.item.img_full.visible=e.img_full.visible,e.item.img_full&&(e.item.img_full.skin=_r.getAtlasSubPath("tujian/tj_bq_ymj.png")),e.state){case 0:e.item.visible=!0,e.img_red.visible=TR.ins.getGoodsNum(e.c_gid)>=e.c_gnum&&zP.getRedByRole(e.index),e.img_red.visible&&e.setActiveEff("jm1247"),e.item.img_full.visible=!e.img_red.visible,e.item.img_full.visible&&(e.item.img_full.skin=_r.getAtlasSubPath("tujian/tj_bq_wjh.png")),e.btn_active.label="激  活",e.txt_cost.innerHTML="消耗："+Ql.createColor(e.dto.name+" x "+e.c_gnum,ms.getByQuality(e.g_colorId));break;case 1:e.btn_active.label="升  级",e.img_red.visible=zP.curExp>=Bt.MODEL.levelUpCardExp(e.activeIndex),e.img_red.visible&&e.setActiveEff("jm1245");var t=zP.curExp/Bt.MODEL.levelUpCardExp(e.activeIndex);1<t&&(t=1);var i=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);i.width=e._BAR_W*t,e.bar.scrollRect=i,e.txt_bar.text=zP.curExp+"/"+Bt.MODEL.levelUpCardExp(e.activeIndex)}},i.updateToc=function(e){this.activeKey=zP.getCardsLevel(Bt.MODEL.type(this.index),Bt.MODEL.index(this.index)),this.activeIndex=Bt.getIndex(this.activeKey),this.setCardsState()},i.setActiveEff=function(e){this.clearActiveEff(),this.eff||(this.eff=kB.createEffect(e,this.item.img_full.x+205,this.item.img_full.y+166,this))},i.clearActiveEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_active:if(2==t.state)return;var i=0;if(0==t.state){if(!zP.getRedByRole(t.index))return void zB.ins.showById2(4213,[zP.getRedByRoleName(t.index)],1);if(TR.ins.getGoodsNum(t.c_gid)<t.c_gnum)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.c_gid});i=t.index}if(1==t.state){if(zP.curExp<Bt.MODEL.levelUpCardExp(t.activeIndex))return void zB.ins.showById(3269,1);i=t.activeIndex}var n={};n.cid=Bt.MODEL.key(i),n.nid=0==t.state?Bt.MODEL.key(i):Bt.MODEL.nextLevelId(i),n.exp=Bt.MODEL.levelUpCardExp(i),zP.reqTujianActive(n);break;case t.link_path:if(0==t.state)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.c_gid});hN.ins.open("TUJIAN_DECOMPOSE_VIEW");break;case t.btn_close:hN.ins._closePanel(t)}},i.setAttrs=function(){var e=this;e.img_arrow.visible=2!=e.state;var t=zP.getAttrsByIndex(0==e.state?e.index:e.activeIndex),i=t.attrS;if(e.showAttrs(t.attrN),e.txt_special.visible=0<i.length,0<i.length&&(e.txt_special.innerHTML=RP.n[1167]+i[0].addName+"+"+i[0].val),2==e.state)return e._rbox&&e._rbox.graphics.clear(),void(e._lbox.x=222);var n=zP.getAttrsByIndex(0==e.state?e.index:e.activeIndex+1);e.showAttrs(n.attrN,1)},i.showAttrs=function(e,t){var i=this;void 0===t&&(t=0);var n=0;switch(t){case 0:for(i._lbox||(i._lbox=new dt,i._lbox.pos(85,645),i.addChild(i._lbox)),i._lbox.x=85,i._lbox.graphics.clear(),n=0;n<e.length;n++)i._lbox.graphics.fillText(e[n].addName+"：",0,i.star_y[e.length-1]+i.GRID_Y*n,"24px SimHei","#90877b","left"),i._lbox.graphics.fillText(0==i.state?"0":e[n].val+"",120,i.star_y[e.length-1]+i.GRID_Y*n,"24px SimHei","#90877b","left");break;case 1:for(i._rbox||(i._rbox=new dt,i._rbox.pos(386,645),i.addChild(i._rbox)),i._rbox.graphics.clear(),n=0;n<e.length;n++)i._rbox.graphics.fillText(e[n].addName+"：",0,i.star_y[e.length-1]+i.GRID_Y*n,"24px SimHei","#90877b","left"),i._rbox.graphics.fillText(e[n].val+"",120,i.star_y[e.length-1]+i.GRID_Y*n,"24px SimHei","#23b11f","left")}},t}(),c$=function(e){function t(){this.ITEM_HEIGTH=130,this.ITEM_SPACE_Y=18,t.__super.call(this)}b(t,"modules.achievenew.views.tujian.Tujian_SuitView",mI);var i=t.prototype;return i.initialize=function(){this.list.spaceY=this.ITEM_SPACE_Y,this.list.itemRender=nz},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.initInfo()},i.initInfo=function(){this.txt_name_all.text=zP.getSuitNameByType(zP.selectType)+RP.n[1168];var e=zP.getSuitListByType(zP.selectType),t=e.length*this.ITEM_HEIGTH+(e.length-1)*this.ITEM_SPACE_Y;this.list.height=t,this.height=118+t,this.list.array=e},t}(),u$=function(e){function i(e){var t=this;t.mainType=0,t.data_12202=null,t.activityIds=null,t.canGets=null,t.vsc=null,t._CheckId=0,t._firstIndex=-1,t.needCheck=!0,t.firstArr=[],t.MACTIVITY="MACTIVITY",i.__super.call(t),t.bottom=t.top=0,t.left=t.right=0}b(i,"modules.activity.views.ActivityMainView",B);var t=i.prototype;return t.initialize=function(){var e=this;e.vsc=new SB(e),eU.targetId<=0&&(e.vsc.openSelectReddot=!0),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onCheckTable,null,!1),e.isTop=!0},t.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.panelName="ActivityMainView",this.mainType=JP.c_mainType,this.checkInte(),this.checkTable(),this.needCheck=!0,JP.ins.isActToView=!0,ZP.isFrtRedPt=!0},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),eU.toSelectIndex=-1,JP.ins.isActToView=!1},t.destroy=function(e){void 0===e&&(e=!0);for(var t=0;this&&this.navList&&t<this.navList.length;t++){var i=_r.getFullUrl(this.navList[t]),n=yc.getRes(i);n&&(n.destroy(),yc.clearRes(i),tt.ins.clearTexture(i))}ui.SubPanel.prototype.destroy.call(this,e)},t.onSubChanged=function(e,t){var i=parseInt(e);if(It.hasIndex(i)){var n=It.getIndex(i),s="activity/"+It.MODEL.titleUI(n)+".png";this.setTitle(_r.getAtlasSubPath(s))}this.vsc.updateItemEnabled()},t.checkInte=function(){this.inteUI(!0)},t.update=function(e){var t=this;0==e&&t.checkInte(),t.vsc.selectedView instanceof modules.activity.views.hefu.ActivityHeFuChargeProfitView&&t.vsc.selectedView.updateSelect&&t.vsc.selectedView.updateSelect(),(t.vsc.selectedView instanceof modules.activityDaily.view.OS_DayReturnView||t.vsc.selectedView instanceof modules.activity.views.os.OS_GoalView||t.vsc.selectedView instanceof modules.activity.views.os.OS_DailyPayView||t.vsc.selectedView instanceof modules.activity.views.os.OS_LimitBuyView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_WelfareView)&&t.vsc.selectedView.updateList&&t.vsc.selectedView.updateList(),(t.vsc.selectedView instanceof modules.activity.views.sp.FestivalPayView||t.vsc.selectedView instanceof modules.activity.views.sp.FestivalUseYBView)&&t.vsc.selectedView.updateView(),t.vsc.selectedView instanceof modules.activity.views.invest.InvestMainView&&t.vsc.selectedView.onReqBack(),t.vsc.selectedView instanceof modules.activity.views.os.OS_GiftsView&&t.vsc.selectedView.refresh&&t.vsc.selectedView.refresh(),t.vsc.selectedView instanceof modules.activity.views.os.item.OS_Purchase&&t.vsc.selectedView.onReqBack&&t.vsc.selectedView.onReqBack(),(t.vsc.selectedView instanceof modules.activity.views.tehui.ActivityMysteryView||t.vsc.selectedView instanceof modules.activity.views.tehui.ActivityTehuiView||t.vsc.selectedView instanceof modules.activity.views.gongce.ActivityGongceLoginView||t.vsc.selectedView instanceof modules.activity.views.sp.ActivityPointsShopView)&&t.vsc.selectedView.onReqBack&&t.vsc.selectedView.onReqBack(),t.vsc.selectedView instanceof modules.activity.views.qq.QqDaTingView&&t.vsc.selectedView.onReqBack(),20==e&&t.vsc.selectedView.updateView(),t._CheckId=e,t.vsc.updateItemEnabled(),t.activityIds&&0<t.activityIds.length&&(t.data_12202=mB.getInStance().getMainType(t.mainType),t.data_12202&&!JP.isEqual(t.activityIds,t.data_12202.activityIds)&&t.inteUI(!0))},t.tabCheckInte=function(e){if(this._CheckId=e,this.needCheck)return this.checkTable(),void(this.needCheck=!1)},t.checkTable=function(){this._CheckId=0,this.vsc.updateItemEnabled()},t.updateByVSC=function(e){var t=this;t.vsc&&t.vsc.selectedView&&((t.vsc.selectedView instanceof modules.activity.views.sp.Sp_CoupletView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_CrackerView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_FireworksView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_BargainView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_TreePlantView||t.vsc.selectedView instanceof modules.activity.views.sp.Sp_TreePickView||t.vsc.selectedView instanceof modules.activity.views.invite.In_SaleView||t.vsc.selectedView instanceof modules.activity.views.invite.In_LoginView||t.vsc.selectedView instanceof modules.activity.views.invite.In_LotteryView||t.vsc.selectedView instanceof modules.activity.views.os.OS_SevenKHView||t.vsc.selectedView instanceof modules.activity.views.os.OS_BossScoreView||t.vsc.selectedView instanceof modules.activity.views.os.OS_GiftsView)&&t.vsc.selectedView.refresh&&t.vsc.selectedView.refresh(e),t.vsc.selectedView instanceof modules.activity.views.os.OS_DailyPayView2&&t.vsc.selectedView.updateByVSC&&t.vsc.selectedView.updateByVSC(e),(t.vsc.selectedView instanceof modules.activity.views.os.Celebration_View||t.vsc.selectedView instanceof modules.activity.views.returns.Re_TaskView)&&t.vsc.selectedView.updateTaskList(e),t.vsc.updateItemEnabled())},t.updateView=function(e){this.vsc.updateItemEnabled()},t.onCheckTable=function(e,t){var i=parseInt(e);if(21==It.MODEL.uiType(It.getIndex(i))){JP.ins.isLinkToView=2;var n=new AA;n.actId=i,Tu.sendToService(n)}if(It.MODEL.vipLimit(It.getIndex(i))>gR.ins.VIPLevel)return 2;if(36==It.MODEL.uiType(It.getIndex(i))&&null==this.firstArr[i]&&(this.firstArr[i]=1),1026==i){if(HN.ins.isShowEveryRed())return 3}else{var s=mB.getInStance().getMainType(this.mainType);if(s&&s.fActivityIds){var o=mB.getInStance().getActivityData(i);return-1!=s.fActivityIds.indexOf(i)?o&&this._CheckId==o.activityId&&o.gifts&&!o.hasComGift()?(s.fActivityIds.splice(s.fActivityIds.indexOf(i),1),0):3:o&&this._CheckId==o.activityId&&o.gifts&&o.hasComGift()?(s.fActivityIds.push(o.activityId),3):0}}return 0},t.inteUI=function(e){var t=this;if(void 0===e&&(e=!1),t.data_12202=mB.getInStance().getMainType(t.mainType),t.data_12202){t.isTop=!0,t.mouseThrough=!0,t.navList=[],t.activityIds=t.data_12202.activityIds,e&&t.vsc.selectedView&&(t.vsc.selectedView.parent&&t.vsc.selectedView.parent.removeChild(t.vsc.selectedView),t.vsc.selectedView.destroy());for(var i,n=[],s=0;s<t.activityIds.length;++s){var o,a=t.activityIds[s],r=0,l=0,c=0;if(o=0==t.data_12202.isPlayerActivity?(r=It.getIndex(a),l=It.MODEL.mainType(r),c=It.MODEL.uiType(r),i="ui/layouts/activityTab/"+It.MODEL.tableUI(r)+".png",a):(r=wn.getIndex(a),l=wn.MODEL.mainType(r),c=wn.MODEL.uiType(r),i="ui/layouts/activityTab/"+wn.MODEL.tableUI(r)+".png",{pType:t.data_12202.isPlayerActivity,aId:a}),l==t.mainType){t.navList.push(i);var u=-1<JP.IS_HIDE_BG.indexOf(c);n.push({cls:JP.getClass(c),id:a,data:o,isHideBg:u})}}t.vsc.registAll(n),e?(t.layout.setNavList(t.navList,!0),t.vsc.invalidTab()):t.vsc.invalid(),-1!=eU.toSelectIndex&&(t.vsc.selectedIndex=eU.toSelectIndex),t.firstArr=JP.ins.firstArr}},p(0,t,"tab",function(){return this.layout?this.layout.bottom_nav.tab:null}),i}(),d$=function(e){function t(){this._avatar=null,this.awardsList=[],this.bossData=null,this.currentBoss=null,this.BAR_W,t.__super.call(this),this.centerX=this.centerY=0,this.bossData=$P.ins}b(t,"modules.activity.views.festivalboss.FestivalBossView",fm);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){$P.ins.actId=t},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.BAR_W=t.img_bar.width,t.layout.dragon_border.visible=!1,t.img_yjs.visible=!1,t.txt_rank.on("click",t,t.onClickRankEvent),t.btn_enter.on("click",t,t.onClickEnterEvent),t.link_showGift.on("click",t,t.openGiftView)},i.onRemove=function(e){var t=this;for(ui.SubPanel.prototype.onRemove.call(t,e),t.txt_rank.off("click",t,t.onClickRankEvent),t.btn_enter.off("click",t,t.onClickEnterEvent),t.link_showGift.off("click",t,t.openGiftView);t.awardsList&&0<t.awardsList.length;){t.awardsList.shift().removeSelf()}t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null)},i.updateView=function(){var e=this,t=0;if(0==e.bossData.toc21272.hurtList.length){for(t=0;t<3;t++)e["txt_rank_"+t].text=RP.n[1169],e["txt_score_"+t].text="0";e.txt_befName.innerHTML=RP.n[1170]}else{for(t=0;t<e.bossData.toc21272.hurtList.length;t++)if(t<3){e["txt_rank_"+t].text=e.bossData.toc21272.hurtList[t].name;var i="";i=1e8<=e.bossData.toc21272.hurtList[t].hurt?(e.bossData.toc21272.hurtList[t].hurt/1e8).toFixed(2)+"亿":1e4<=e.bossData.toc21272.hurtList[t].hurt?Math.floor(e.bossData.toc21272.hurtList[t].hurt/1e4)+"万":e.bossData.toc21272.hurtList[t].hurt+"",e["txt_score_"+t].text=i}e.txt_befName.innerHTML=RP.n[1171]+Ql.createColor(e.bossData.toc21272.hurtList[0].name,"#e0d6c1")}if(e.currentBoss=e.bossData.toc21272.bossInfo,null!=e.currentBoss){e.currentBoss.state<0?e.img_yjs.visible=!0:e.img_yjs.visible=!1,e.setBlood(e.currentBoss);var n=e.currentBoss.mainType,s=ci.getIndex(n),o=ci.MODEL.copyid(s);e.setPanel(s),e.setDefaultItem(o)}},i.setBlood=function(e){var t=rn.getIndex(e.bossId),i=rn.MODEL.bossId(t);t=hn.getIndex(i);var n=aa.formatNewAttrToObject(JSON.parse(hn.MODEL.attributes(t))).MAXHP,s=e.blood;this.txt_blood.text=(100*s/n).toFixed(2)+"%",this.setRateBar(s/n)},i.setPanel=function(e){var t=e,i="activity/"+ci.MODEL.titleUI(t)+".png";this.setTitle(_r.getAtlasSubPath(i));var n=ci.MODEL.desStr(t);this.txt_des.text=n},i.setRateBar=function(e){void 0===e&&(e=0),1<e&&(e=1);var t=this.img_bar.scrollRect||new u_(0,0,this.img_bar.width,this.img_bar.height);t.width=this.BAR_W*e,this.img_bar.scrollRect=t},i.setDefaultItem=function(e){for(var t,i=this,n=rn.getIndex(e),s=rn.MODEL.bossShowAward(n).split(";"),o=0;o<s.length;o++){var a=s[o],r=parseInt(a.split(",")[0]),l=parseInt(a.split(",")[1]);i.awardsList.length>o?t=i.awardsList[o]:(t=new MF,i.awardsList.push(t)),null==t.parent&&i.box_award.addChild(t),t.pos(i["img_"+o].x,i["txt_tool_"+o].y-58),t.bindData=yB.create(r,l),i["txt_tool_"+o].text=Bi.MODEL.name(Bi.getIndex(r)),i["txt_tool_"+o].color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(r)))}if(i.awardsList.length>o)for(;o<i.awardsList.length;o++)(t=i.awardsList[o])&&t.parent&&t.removeSelf();var c=rn.MODEL.bossId(n);n=hn.getIndex(c),i.txt_name.text=hn.MODEL.name(n)+"︵",i.txt_lv.innerHTML=hn.MODEL.level(n)+"",i.txt_lv.y=i.box_name.y+12*i.txt_name.text.length,i.txt_ji.text="级︶",i.txt_ji.y=i.txt_lv.y+16*i.txt_lv.innerHTML.length,i.setAvatar(n)},i.setAvatar=function(e){var t=this,i=hn.MODEL.muId(e);e=_n.getIndex(i);var n=_n.MODEL.avatarId(e);t._avatar||(t._avatar=new uq,t._avatar.renderInSelf=!0,t._avatar.pos(350,(t.stage.height-t._avatar.height)/2),t.addChildAt(t._avatar,3)),t._avatar.mid=n,t._avatar.type=Za.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(5),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1,1)},i.onClickEnterEvent=function(e){if(1!=this.currentBoss.state){if(this.currentBoss.state<0)return void zB.ins.showMsg(RP.n[1172],1);if(0==this.currentBoss.state)return void zB.ins.showMsg(RP.n[879],1)}TR.ins.hasEmptyNum(20)?ZN.isEnabledChangeScene()?(jR.reqEntry(this.currentBoss.bossId),hN.ins._closePanelForce(this)):zB.ins.showById(2126,1):KQ.ins.showBagRecycle()},i.onClickRankEvent=function(e){hN.ins.open("FESTBOSS_RANK_VIEW")},i.openGiftView=function(){hN.ins.open("FESTBOSS_SHOWAWARD_VIEW")},i.redPtHandler=function(e,t){1==(this.btn_enter.showTip=t)&&jR.reqCopy(52)},i.checkMainType=function(){for(var e=kt.count,t=0;t<e;t++){if("FESTIVAL"==kt.MODEL.iconName(t))kt.MODEL.key(t)}},t}(),h$=function(e){function i(e){var t=this;t.vsc=null,t.data_12202=null,t.activityIds=null,t._CheckId=0,t.needCheck=!0,i.__super.call(t),t.bottom=t.top=t.left=t.right=0}b(i,"modules.activity.views.LimitBuyView",B);var t=i.prototype;return t.initialize=function(){this.vsc=new SB(this),this.vsc.openSelectReddot=!0,this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.isTop=!0},t.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.panelName="OpenLimitBuyV",this.inteUI(!0),this.checkTable(),this.needCheck=!0,G.timer.loop(1e3,this,this.checkTable)},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),G.timer.clear(this,this.checkTable),eU.toSelectIndex=-1},t.destroy=function(e){void 0===e&&(e=!0);for(var t=0;this&&this.navList&&t<this.navList.length;t++){var i=_r.getFullUrl(this.navList[t]),n=yc.getRes(i);n&&(n.destroy(),yc.clearRes(i),tt.ins.clearTexture(i))}ui.SubPanel.prototype.destroy.call(this,e)},t.onSubChanged=function(e,t){this.setTitle(_r.getAtlasSubPath("activity/title_limitBuy.png"))},t.checkInte=function(){},t.update=function(e){var t=this;0==e&&t.checkInte(),t._CheckId=e,t.vsc.updateItemEnabled(),t.activityIds&&0<t.activityIds.length&&(t.data_12202=mB.getInStance().getMainType(13),t.data_12202&&!JP.isEqual(t.activityIds,t.data_12202.activityIds)&&t.inteUI(!0)),t.vsc.selectedView instanceof modules.activity.views.os.item.OS_Purchase&&t.vsc.selectedView.onReqBack&&t.vsc.selectedView.onReqBack()},t.tabCheckInte=function(e){if(this._CheckId=e,this.needCheck)return this.checkTable(),void(this.needCheck=!1)},t.inteUI=function(e){var t=this;void 0===e&&(e=!1),t.data_12202=mB.getInStance().getMainType(13);var i=0;if(t.data_12202){t.isTop=!0,t.mouseThrough=!0,t.navList=[],t.activityIds=t.data_12202.activityIds,e&&t.vsc.selectedView&&(t.vsc.selectedView.parent&&t.vsc.selectedView.parent.removeChild(t.vsc.selectedView),t.vsc.selectedView.destroy());var n=[];for(i=0;i<t.activityIds.length;++i){var s=t.activityIds[i],o=It.getIndex(s);if(13==It.MODEL.mainType(o)){var a=It.MODEL.uiType(o),r=-1<JP.IS_HIDE_BG.indexOf(a);n.push({cls:JP.getClass(a),id:s,data:s,isHideBg:r})}}t.vsc.registAll(n),e?(t.layout.setNavList(t.navList,!0),t.vsc.invalidTab()):t.vsc.invalid(),-1!=eU.toSelectIndex&&(t.vsc.selectedIndex=eU.toSelectIndex)}},t.checkTable=function(){this._CheckId=0,this.vsc.updateItemEnabled()},t.updateByVSC=function(e){},p(0,t,"tab",function(){return this.layout?this.layout.bottom_nav.tab:null}),i}(),_$=function(e){function t(){this.g=null,this.v=null,t.__super.call(this)}b(t,"modules.activity.views.invite.In_LoginTipView",Em);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.b_c.on("click",t,t.onClick),t.b_g.on("click",t,t.onClick),t.b_s.on("click",t,t.onClick)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.g&&(t.g.destroy(e),t.g=null),t.b_c.off("click",t,t.onClick),t.b_g.off("click",t,t.onClick),t.b_s.off("click",t,t.onClick),ui.SubPanel.prototype.destroy.call(t,e)},i.updateView=function(e){var t=this;!e||e.length<2||(t.v=e[0],t.g||(t.g=new vj,t.g.y=270,t.g._spaceX=30,t.g.size(660,180),t.g._gsimpleName=!0,t.g._hScrollBarSkin=t.g._vScrollBarSkin=null,t.addChild(t.g)),t.g.setGoodsItems(e[1].goodsReward,3),t.g.x=(t.width-t.g.contentWidth)/2)},i.onClick=function(e){switch(e.currentTarget){case this.b_c:hN.ins._closePanel(this);break;case this.b_g:if(!this.v)return;WB.getGift(this.v.giftId,ql.create(this,this.onRefresh));break;case this.b_s:YB.reqWxCanShare("LOGIN_GIFT_ACTIVITY")}},i.onRefresh=function(){Tu.sendToModule("UPDATE_BARGAIN_SELECTED",["modules.activity.ActivityModule"]),hN.ins._closePanel(this)},t}(),f$=function(e){function t(){this.g=null,t.__super.call(this)}b(t,"modules.activity.views.invite.In_SaleAwardView",Lm);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.g&&(this.g.destroy(e),this.g=null),ui.SubPanel.prototype.destroy.call(this,e)},i.updateView=function(e){var t=this;e&&(t.g||(t.g=new vj,t.g.y=95,t.g._spaceX=21,t.g.size(600,180),t.g._hScrollBarSkin=t.g._vScrollBarSkin=null,t.g._gridH=t.g._gridW=116,t.g._gnameY=t.g._gridH+5,t.addChild(t.g)),t.g.setGoodsItems(e,3),t.g.x=(t.width-t.g.contentWidth)/2)},t}(),p$=function(e){function t(){this._array=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_BossScoreExchangeView",$m);var i=t.prototype;return i.initialize=function(){this.list.itemRender=wz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this._array=JP.getExchangeData("BOSS_EXCHANGE")},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler)},i.update=function(e){if(e){this.txt_score.changeText(String(e.scoreObj.score));for(var t=[],i=0;i<this._array.length;i++)t.push({vo:this._array[i],score:e.scoreObj.score,activityId:e.owerActivity,exTimes:e.scoreObj.exchange.take(this._array[i].exChangeId)?e.scoreObj.exchange.take(this._array[i].exChangeId):0,limitTimes:e.scoreObj.limit.take(this._array[i].exChangeId)?e.scoreObj.limit.take(this._array[i].exChangeId):0});this.list.dataSource=t}},i.onClickHandler=function(e){hN.ins._closePanel(this)},t}(),g$=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.OS_RankView",gy);var i=t.prototype;return i.initialize=function(){this.list.spaceY=5,this.list.repeatX=1,this.list.itemRender=Mz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged),this.txt_no.visible=!1},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.update=function(e){var t=this;if(e){26==e.myRankType||29==e.myRankType?(t.boxMoney.visible=!0,t.boxNormal.visible=!1,t.list.itemRender=Dz):(t.list.itemRender=Mz,t.boxMoney.visible=!1,t.boxNormal.visible=!0),t.list.dataSource=e.rank,t.txt_no.visible=e.rank.length<1,t.g_mask.visible=9<e.rank.length;var i=It.MODEL.secondtitleui(e.index).split(",");i[0]&&(t.img_title.skin=_r.getOsNewPath("rank/"+i[0])),0<e.myRank?t.txt_myRank.innerHTML=RP.n[1174]+Ql.createColor(e.myRank+"名","#23b11f"):t.txt_myRank.innerHTML=RP.n[1175]+Ql.createColor("未上榜","#ff2e24"),t.txt_gtype.changeText(e.rankLevelStr),1==e.myRankType?0==e.rankValue?t.txt_over.changeText(e.rankLevel+"级"):t.txt_over.changeText(e.rankValue+"转"+e.rankLevel+"级"):e.activityId==JP.A_ID_1053?aB.isActiveSoul?t.txt_over.changeText(JP.getSoluLevel(e.rankValue)):t.txt_over.changeText("未激活"):t.txt_over.changeText(e.rankValue+JP.getWordsByRtype(e.type))}},t}(),v$=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.OS_SevenKHPreviewView",by);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Pz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHanlder),this.list.scrollTo(0),this.list.scrollBar.on("change",this,this.onScrollChanged),this.list.dataSource=JP.getMissionScoreData()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHanlder),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onClickHanlder=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),m$=function(e){function t(){this.gvo=null,this.copyId=0,this.g_cost=0,t.__super.call(this)}b(t,"modules.activity.views.os.OS_SoulEnterView",ky);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_cancel.on("click",t,t.onClickHandler),t.btn_sure.on("click",t,t.onClickHandler),t.btn_close.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.gvo=null,t.btn_cancel.off("click",t,t.onClickHandler),t.btn_sure.off("click",t,t.onClickHandler),t.btn_close.off("click",t,t.onClickHandler)},i.update=function(e){var t=this;if(e){t.gvo=e;var i=St.getIndex(t.gvo.giftId);t.copyId=parseInt(St.MODEL.targetParam1(i)),t.g_cost=St.MODEL.costGold(i),t.txt_cose.innerHTML=t.g_cost.toString(),t.g_icon.x=(t.width-t.g_icon.width-t.txt_cose.contextWidth-10)/2,t.txt_cose.x=t.g_icon.x+67}},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:case this.btn_cancel:hN.ins._closePanel(this);break;case this.btn_sure:if(gR.ins.YB<this.g_cost)return void KQ.ins.showNoGold();jR.reqEntry(this.copyId),hN.ins._closePanel(this),hN.ins.close("OPENSERVER")}},t}(),y$=function(e){function t(){this.gridPanel=null,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_FireworksPreviewView",Jy);var i=t.prototype;return i.initialize=function(){var e=this;e.gridPanel||(e.gridPanel=new wj(4,4,116,20,35,!0,null,43,!0,!1),e.gridPanel.pos(35,11),e.gridPanel.isShowJob=!0,e.panel.addChild(e.gridPanel),e.setChildIndex(e.g_mask,e.numChildren-1),e.gridPanel.vScrollBar.on("change",e,e.onScrollChanged))},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),this.gridPanel&&this.gridPanel.vScrollBar&&this.gridPanel.vScrollBar.off("change",this,this.onScrollChanged),this.gridPanel.destroy(e),this.gridPanel=null,ui.SubPanel.prototype.destroy.call(this,e)},i.update=function(e){!e||e.length<1||(this.gridPanel.gridDatas=e)},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.onScrollChanged=function(){0==this.gridPanel.vScrollBar.max||this.gridPanel.vScrollBar.value>=this.gridPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),I$=function(e){function t(){this.gvo=null,this.acitivityId=0,this.gridPanel=null,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_TreeBoxsView",eI);var i=t.prototype;return i.initialize=function(){this.gridPanel=new wj(4,4,116,16,20,!0,null,0,!0,!1),this.gridPanel.pos(38,130),this.gridPanel.size(600,180),this.gridPanel.isShowJob=!0,this.addChild(this.gridPanel)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.g_got.visible=this.btn_award.visible=!1,this.btn_close.on("click",this,this.onClickHandler),this.btn_award.on("click",this,this.onClickHandler)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.gridPanel.destroy(e),t.gridPanel=null,t.gvo=null,t.btn_close.off("click",t,t.onClickHandler),t.btn_award.off("click",t,t.onClickHandler),ui.SubPanel.prototype.destroy.call(t,e)},i.updateView=function(e){e&&(this.gvo=e.gvo,this.acitivityId=e.acitivityId,this.gridPanel.gridDatas=this.gvo.rewardGoods,this.gridPanel.x=(this.width-this.gridPanel.contentWidth)/2,this.resetShow())},i.resetShow=function(){this.g_got.visible=2==this.gvo.status,this.btn_award.visible=!this.g_got.visible,this.btn_award.visible&&(this.btn_award.disabled=0==this.gvo.status,this.btn_award.label=0==this.gvo.status?"未达成":"领 取")},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:hN.ins._closePanel(this);break;case this.btn_award:if(!this.gvo||1!=this.gvo.status)return;WB.getGift(this.gvo.giftId,ql.create(this,this.onRefresh,[this.gvo.giftId]))}},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.acitivityId);t&&(this.gvo=t.getGift(e),this.gvo&&(this.resetShow(),this.goToPos()),Tu.sendToModule("UPDATE_BARGAIN_SELECTED",["modules.activity.ActivityModule"],{isGrowth:!0}))},i.goToPos=function(){if(this.gvo){for(var e=[],t=0;t<this.gvo.rewardGoods.length;t++)this.gvo.rewardGoods[t]&&e.push(this.gvo.rewardGoods[t].goodsId);var i=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(e,new Uh(i.x,i.y))}},t}(),b$=function(e){function t(){this.eff=null,this.gItem=null,this.cItem=null,this.dto=null,this.acitivityId=0,this._data=null,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_TreePickAwardView",iI);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.g_title.skin=_r.getOsNewPath("sp/other/cqqd_text_gxhd"),this.btn_on.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.cItem&&(t.cItem.parent&&t.cItem.parent.removeChild(t.cItem),t.cItem.destroy(),t.cItem=null),t.dto=null,t.clearEff(),t.btn_on.off("click",t,t.onClickHandler)},i.updateView=function(e){var t=this;if(e){t._data=e.gList[0],t.gItem||(t.gItem=new MF,t.g_item.addChild(t.gItem));var i=yB.create(t._data.gId,t._data.gNum);t.gItem.bindData=i;var n=Bi.getIndex(i.goodsId);t.txt_name.changeText(Bi.MODEL.simpleName(n)),t.txt_name.color=ms.getByQuality(Bi.MODEL.colourId(n)),t.g_icon.visible=1==t._data.isTop;var s=Jn.getIndex(JP.pickLevel);t.acitivityId=Jn.MODEL.pickActivityId(s);var o=mB.getInStance().getActivityData(t.acitivityId);if(o){var a=o.position.split(",");a[0]&&(t.btn_on.label="继续"+a[0])}t.setPickCost(s),t.setAward(t._data.isTop);for(var r=[],l=0;l<e.gList.length;l++)r.push(e.gList[l].gId);t.goToPos(r)}},i.setPickCost=function(e){var t=this;t.cItem||(t.cItem=new MF(45),t.cItem.pos(247,267),t.cItem.needGridBg=!1,t.cItem.needEffect=!1,t.addChild(t.cItem));for(var i=yB.createStrArr(Jn.MODEL.consumptionDef(e)),n=0;n<i.length;n++)15!=i[n].goodsId&&14!=i[n].goodsId&&(t.dto=i[n]);if(t.dto){t.cItem.dataSource=t.dto;var s=TR.ins.getGoodsNum(t.dto.goodsId),o=s>=t.dto.goodsNum?"#23b11f":"#ff2e24";t.txt_cost.innerHTML=Ql.createColor(s.toString(),o)+"/"+t.dto.goodsNum,t.cItem.x=(t.width-(45+t.txt_cost.contextWidth))/2,t.txt_cost.x=t.cItem.x+45;var a=It.MODEL.mainType(It.getIndex(t.acitivityId)),r=s>=t.dto.goodsNum;Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:t.acitivityId,redPt:r,mType:a})}},i.onClickHandler=function(e){this.dto&&(this.dto.goodsNum>TR.ins.getGoodsNum(this.dto.goodsId)?zB.ins.showMsg(RP.n[1176],1):WB.reqPickAward(this.acitivityId))},i.setAward=function(e){void 0===e&&(e=!1),this.clearEff(),!this.eff&&e&&(this.eff=kB.createEffect("jm1244",this.g_item.width>>1,this.g_item.height>>1,this.g_item))},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.goToPos=function(e){if(e&&!(e.length<1)){var t=this.localToGlobal(new Uh(this.width>>1,this.g_item.x+this.g_item.height>>1));zB.ins.playGetItemsByPos(e,new Uh(t.x,t.y))}},t}(),w$=function(e){function t(){var e=this;e.gp=null,t.__super.call(e),e.gp||(e.gp=new wj(1,4,116,24),e.gp.pos(95,865),e.gp.height=180,e.addChild(e.gp)),e.gp.vScrollBarSkin="",e.gp.vScrollBar.elasticDistance=0}b(t,"modules.activityDaily.view.FavourGameView",Ta);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn.on("click",this,this.onClick),this.setTitle(_r.getAtlasSubPath("activityDaily/sclb_text_sclb.png")),this.gp.gridDatas=yB.createStrArr(gs.MODEL.rewardDef(gs.getIndex(1))),this.update()},i.update=function(){0<eR.ins.getRWT(1)?(this.btn.visible=!1,this.img_get.visible=!0):(this.btn.visible=!0,this.img_get.visible=!1)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn.off("click",this,this.onClick)},i.onClick=function(e){if(jP.getHasFavour()){var t=new vP;t.rid=1,Tu.sendToService(t)}else zB.ins.playErrorMsg(ei.MODEL.content(ei.getIndex(5344)))},t}(),x$=function(e){function t(){t.__super.call(this)}b(t,"modules.activityDaily.view.focusReward.FocusQRCodeView",Im);var i=t.prototype;return i.initialize=function(){},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this),this.btn_close.on("click",this,this.onBtnClose),this.img_QRCode.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_img_ewm.jpg"),this.txt_tip.innerHTML=RP.n[1177]},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this),this.btn_close.off("click",this,this.onBtnClose),ja.ins.hasFocus="HAS_FOCUS",Tu.sendToModule("FOCUS_REWARD",["modules.activityDaily.DailyModule"])},i.onBtnClose=function(e){this.close()},t}(),S$=function(e){function t(){this._gridsList=null,this.btnEffect=null,t.__super.call(this)}b(t,"modules.activityDaily.view.BindingPhoneView",Hy);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=176,e._gridsList.x=20,e._gridsList._spaceX=24,e._gridsList.size(662,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=e._gridsList._gridH+5,e.addChild(e._gridsList))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.btn.on("click",t,t.onClick),t.img_bg0.skin=_r.getFullUrl("ui/layouts/basic_ui/lxsy_db_gx.png"),t.img_bg1.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_img_bg1.jpg"),t.img_bg2.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_img_bg2.jpg"),t.img_title.skin=_r.getFullUrl("ui/layouts/activityDaily/bdsj_tc_bdsj.png"),t.img_text.skin=_r.getFullUrl("ui/layouts/activityDaily/bdsj_text_bdsj.png"),t.showDetail()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this),this.btn.off("click",this,this.onClick),this.clearButtonEffect()},i.showDetail=function(){var e=this,t=Rn.MODEL.rewards(Rn.getIndex(5));e._gridsList.setGoodsItems(t,6),e._gridsList.x=(e.width-e._gridsList.contentWidth)/2,jP.hasBindPhone()?(e.img_red.visible=!1,e.btn.label=RP.n[1179],e.showButtonEffect()):(e.img_red.visible=!0,e.btn.label=RP.n[1180],e.clearButtonEffect())},i.onClick=function(e){hN.ins.close("BINDING_PHONE"),jP.sdk_cmd("bind_phone")},i.showButtonEffect=function(){this.btnEffect||(this.btnEffect=kB.createEffect("jm1130",this.btn.width>>1,this.btn.height>>1,this.btn),this.btnEffect.scale_X=1.25,this.btnEffect.scale_Y=1.25)},i.clearButtonEffect=function(){this.btnEffect&&(this.btnEffect.parent&&this.btnEffect.parent.removeChild(this.btnEffect),this.btnEffect.dispose(),this.btnEffect=null)},t}(),k$=function(e){function t(){this.t=null,this.tg=null,this.et=NaN,t.__super.call(this),this.centerX=0,this.mouseThrough=this.isHideBg=!0,this.isTop=!0,this.title=_r.getAtlasSubPath("activityDaily/zjd_title.png")}b(t,"modules.activityDaily.view.In_EggView",km);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.t_l.on("click",t,t.onClick),t.t_v.on("click",t,t.onClick),t.b_h.on("click",t,t.onClick),t.layout.dragon_border.visible=!1,YB.reqEggInfo();for(var i=0;i<4;i++)t["g_"+i].skin=_r.getOsNewPath("egg/zjd_bg"+(i+1),".jpg")},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.tg&&t.tg.dispose(),G.timer.clear(t,t.onResetTime),t.t_l.off("click",t,t.onClick),t.t_v.off("click",t,t.onClick),t.b_h.off("click",t,t.onClick)},i.refesh=function(e){var t=this;if(e){if(e instanceof protos.activityDaily.toc_39015)return t.tg=e,t.init(),t.et=t.tg.et,void(0<t.et?(t.onResetTime(),G.timer.frameLoop(10,t,t.onResetTime)):t.clearTime());if(e instanceof protos.activityDaily.toc_39017){var i=e;t.tg.ts++,t.tg.free=i.free,t.tg.list.put(i.awd.id,i.awd),t.init(i.awd.id)}}},i.init=function(e){var t=this;void 0===e&&(e=-1),t.t_n.innerHTML=RP.n[1181]+Ql.createColor(t.tg.free+"/8",0<t.tg.free?"#23b11f":"#ff2e24"),t.t=t.t||[];for(var i=0;i<9;i++){var n=t.t[i];n||((n=new hX).pos(120+i%3*193,432+200*Math.floor(i/3)),t.t.push(n),t.addChild(n)),-1<e?n.refresh(e,{vo:t.tg.list.take(i),t:t.tg.ts}):n.dataSource={id:i,vo:t.tg.list.take(i),free:t.tg.free,t:t.tg.ts}}},i.onClick=function(e){switch(e.currentTarget){case this.t_l:hN.ins.open("SP_FIREWORKS_PREVIEW",this.award);break;case this.t_v:jP.sdk_cmd("wx_share_2","GOLD_EGG");break;case this.b_h:QR.goToOpenHelpDes(54)}},i.onResetTime=function(){this.et=Math.floor(this.tg.et/1e3)-dr.serverTimeSec,0<this.et?this.t_t.innerHTML=RP.n[1182]+Jp.getSTRDHMS(this.et):(this.t_t.innerHTML=RP.n[1183]+Ql.createColor("已结束","#ff2e24"),this.clearTime())},i.clearTime=function(){G.timer.clear(this,this.onResetTime),hN.ins._closePanel(this)},p(0,i,"award",function(){for(var e=dr.getOpenServiceDay(),t="",i=0;i<Pi.count;i++){var n=Pi.MODEL.day(i).split(",");if(!(e<parseInt(n[0]))&&!(1<n.length&&e>parseInt(n[1]))){t=Pi.MODEL.reward(i);break}}return JP.praseGoodsStr(t)}),t}(),E$=function(e){function t(){this.rechargeId=0,this.hasCharged=!1,this.gL=null,this.gR=null,this.tL=null,this.tR=null,t.__super.call(this)}b(t,"modules.activityDaily.view.pay0.Pay0Popup",Lh);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this);var e=this;e.gL=new MF,kB.replace(e.img_gL,e.gL),e.tL=kB.createLabel(126,410,200,20,e),e.tL.fontSize=20,e.tL.font="SimHei",e.tL.align="center",e.gR=new MF,kB.replace(e.img_gR,e.gR),e.tR=kB.createLabel(408,410,200,20,e),e.tR.fontSize=20,e.tR.font="SimHei",e.tR.align="center"},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);var i=hN.ins._getOpenData("PAY0_SHARE");t.hasCharged=i.hasCharged;var n=i.cfgIndex;t.rechargeId=An.MODEL.rechargeId(n);var s=cq.getGoodsByType6(An.MODEL.reward(n))[0];t.gL.bindData=s,t.tL.text=s.goodsNum+s.name,t.tL.color=ms.getByQuality(s.colourId),s=cq.getGoodsByType6(An.MODEL.shareReward(n))[0],t.gR.bindData=s,t.tR.text=s.goodsNum+s.name,t.tR.color=ms.getByQuality(s.colourId);var o=t.getPerStr(An.MODEL.percent(n)/100);t.num_per.value=o+"倍",t.btn_close.on("click",t,t.onClickHandler),t.btn_get.on("click",t,t.onClickHandler),t.btn_share.on("click",t,t.onClickHandler)},i.getPerStr=function(e){var t=e.toString(),i=e.toFixed(2);return t.length<i.length?t:i},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClickHandler),t.btn_get.off("click",t,t.onClickHandler),t.btn_share.off("click",t,t.onClickHandler)},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:hN.ins._closePanel(this);break;case this.btn_get:this.hasCharged&&(YB.req0YuanGold(this.rechargeId),hN.ins._closePanel(this),YB.req0YuanInfo());break;case this.btn_share:jP.sdk_cmd("wx_share_2","ZERO_RMB_"+this.rechargeId),hN.ins._closePanel(this),hN.ins.close("PAY0_VIEW")}},t}(),T$=function(e){function t(){this._gridsList=null,this.btnEffect=null,t.__super.call(this),ja.ins.hasFocus&&"HAS_FOCUS"==ja.ins.hasFocus||(ja.ins.hasFocus="HAS_NOT_FOCUS")}b(t,"modules.activityDaily.view.focusReward.FocusRewardView",Hy);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=176,e._gridsList.x=20,e._gridsList._spaceX=24,e._gridsList.size(662,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=e._gridsList._gridH+5,e.addChild(e._gridsList))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.btn.on("click",t,t.onClick),t.img_bg0.skin=_r.getFullUrl("ui/layouts/basic_ui/lxsy_db_gx.png"),t.img_bg1.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_img_bg1.jpg"),t.img_bg2.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_img_bg2.jpg"),t.img_title.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_tc_gzyx.png"),t.img_text.skin=_r.getFullUrl("ui/layouts/activityDaily/gzyx_text_djgz.png"),t.img_red.visible=!1,t.showDetail()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this),this.btn.off("click",this,this.onClick),this.clearButtonEffect()},i.showDetail=function(){var e=$e.MODEL.value($e.getIndex(256));this._gridsList.setGoodsItems(e,6),this._gridsList.x=(this.width-this._gridsList.contentWidth)/2,"HAS_FOCUS"==ja.ins.hasFocus?(this.btn.label="领奖",this.showButtonEffect()):(this.btn.label=RP.n[1184],this.clearButtonEffect())},i.onClick=function(e){"HAS_FOCUS"==ja.ins.hasFocus?YB.reqFocusReward():(hN.ins.close("FOCUS_REWARD"),Tu.sendToModule("FOCUS_QRCODE",["modules.activityDaily.DailyModule"]))},i.showButtonEffect=function(){this.btnEffect||(this.btnEffect=kB.createEffect("jm1130",this.btn.width>>1,this.btn.height>>1,this.btn),this.btnEffect.scale_X=1.25,this.btnEffect.scale_Y=1.25)},i.clearButtonEffect=function(){this.btnEffect&&(this.btnEffect.parent&&this.btnEffect.parent.removeChild(this.btnEffect),this.btnEffect.dispose(),this.btnEffect=null)},t}(),C$=function(e){function t(){this._gridsList=null,this.g_pay=0,this.c_pay=0,t.__super.call(this)}b(t,"modules.activityDaily.view.LimitSurprise",Om);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=221,e._gridsList.x=9,e._gridsList._spaceX=24,e._gridsList.size(662,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList._gridH=e._gridsList._gridW=116,e._gridsList._gnameY=e._gridsList._gridH+5,e.addChild(e._gridsList))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClickHandler),t.btn_award.on("click",t,t.onClickHandler),t.g_fullFont.visible=!1,t.cp_pay.visible=t.g_payFont.visible=!1,YB.reqLimitSpInfo()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.btn_award.off("click",this,this.onClickHandler)},i.updateToc=function(e){var t=this;if(e)if(e instanceof protos.activityDaily.toc_30133)1==e.result&&(t.btn_award.disabled=!0,t.btn_award.label="已领取",hN.ins._closePanel(t));else if(e instanceof protos.activityDaily.toc_30131){var i=Yi.getIndex(e.cid),n=Yi.MODEL.reward(i);t._gridsList.setGoodsItems(n,6),t._gridsList.x=(t.width-t._gridsList.contentWidth)/2,t.g_pay=Yi.MODEL.gold(i),t.c_pay=e.curPay,t.cp_pay.value=t.g_pay.toString(),t.cp_rebate.value=Yi.MODEL.rebate(i)+"%",t.txt_pay.visible=0<t.c_pay,t.txt_pay.visible&&(t.txt_pay.innerHTML=RP.n[1185]+Ql.createColor(t.c_pay.toString(),"#e6d80d")+"元宝"),t.btn_award.disabled=!1,t.btn_award.label=t.c_pay<t.g_pay?"去充值":RP.n[1186],t.cp_pay.visible=t.g_payFont.visible=t.c_pay<t.g_pay,t.g_fullFont.visible=!t.cp_pay.visible}},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:hN.ins._closePanel(this);break;case this.btn_award:if(this.c_pay<this.g_pay){if(EB.showCharge)if(HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet)hN.ins.open("FIRST_RECHARGE",null);else if(0<Ln.count)this.onPay();else{var t=[{url:_r.getJxrDBPath("ConfigRecharge"),type:"arraybuffer",cls:Ln}];uc.ins().onLoadJxrs(t,ql.create(this,this.onPay))}return}if(!TR.ins.hasEmptyNum(4))return void KQ.ins.showBagRecycle();YB.reqLimitSpAward()}},i.onPay=function(){for(var e=0;e<Ln.count;e++)if(1==Ln.MODEL.type(e)&&Ln.MODEL.gold(e)==this.g_pay){EB.pay(1,Ln.MODEL.key(e));break}},t}(),L$=function(e){function t(){this._gp=null,this._ldArr=null,this._dict=null,t.__super.call(this),this._dict=new jo}b(t,"modules.activityDaily.view.pay0.Pay0View",Mh);var i=t.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.title=_r.getAtlasSubPath("pay0/lylb_title_lylb.png"),e.img_hasGot.visible=!1,e._ldArr=eR.ins.getRecGiftIdx(12),e.list_gift.hScrollBarSkin="",e.list_gift.scrollBar.elasticBackTime=300,e.list_gift.scrollBar.elasticDistance=100,e.list_gift.array=e._ldArr,e.list_gift.renderHandler=new ql(e,e.onListRender),e.list_gift.selectHandler=new ql(e,e.onSelect),e.list_gift.selectEnable=!0,e.list_gift.repeatX=Math.min(e._ldArr.length,4),e.list_gift.width=112*e.list_gift.repeatX+e.list_gift.spaceX*(e.list_gift.repeatX-1),e.list_gift.centerX=0,e.btn_prev.x=e.list_gift.x-166,e.btn_next.x=e.list_gift.x+e.list_gift.width+102,e._gp=new wj(1,4,116,30,15,!0,null,0,!0),e._gp.vScrollBarSkin="",e._gp.vScrollBar.elasticDistance=0,e._gp.pos(80,e.img_bg1.y+20),e._gp.isCenter=!0,e._gp.height=140,e.box_c.addChild(e._gp)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.parent.parent.addChild(t.box_top),t.btn_buy.on("click",t,t.onClick),t.btn_get.on("click",t,t.onClick),t.btn_next.on("click",t,t.onClick),t.btn_prev.on("click",t,t.onClick),t.list_gift.scrollBar&&t.list_gift.scrollBar.on("end",t,t.onScrollEnd),YB.req0YuanInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.parent.parent.removeChild(t.box_top),t.btn_buy.off("click",t,t.onClick),t.btn_get.off("click",t,t.onClick),t.btn_next.off("click",t,t.onClick),t.btn_prev.off("click",t,t.onClick),t.list_gift.scrollBar&&t.list_gift.scrollBar.off("end",t,t.onScrollEnd)},i.onClick=function(e){var t=this;if("buy"==e.target.name){if(0<=t.list_gift.selectedIndex){var i=t._ldArr[t.list_gift.selectedIndex],n=An.MODEL.rechargeId(i),s=Ln.getIndex(n),o=Ln.MODEL.type(s);EB.pay(o,n),hN.ins._closePanelForce(t)}}else if("get"==e.target.name){var a=t._ldArr[t.list_gift.selectedIndex],r=An.MODEL.rechargeId(a),l=t._dict.get(r);if(l)if(l.canGet){var c=l.isPay;hN.ins.open("PAY0_SHARE",{cfgIndex:a,hasCharged:c})}else zB.ins.showById(5404,1)}else if("next"==e.target.name){var u=t.list_gift.startIndex+t.list_gift.repeatX;u>=t.list_gift.length&&(u=t.list_gift.length-1),t.list_gift.startIndex!=u&&t.list_gift.tweenTo(u,150*(u-t.list_gift.startIndex),ql.create(t,t.onScrollEnd))}else"prev"==e.target.name&&((u=t.list_gift.startIndex-t.list_gift.repeatX)<0&&(u=0),t.list_gift.startIndex!=u&&t.list_gift.tweenTo(u,150*(t.list_gift.startIndex-u),ql.create(t,t.onScrollEnd)))},i.onListRender=function(e,t){t==this.list_gift.selectedIndex?e.img_select.visible=!0:e.img_select.visible=!1;var i=this._ldArr[t],n=An.MODEL.showGoods(i),s=Bi.getIndex(n);e.img_grid.skin=_r.getIconPath(Bi.MODEL.icon(s)),e.img_point.visible=!1;var o=An.MODEL.rechargeId(i),a=this._dict.get(o);e.img_point.visible=a&&a.isPay&&!a.isGet&&a.canGet;var r=Ln.getIndex(o);e.txt_name.text=a?"¥"+Ln.MODEL.money_wx(r):""},i.onSelect=function(e){this.setCurInfo(e)},i.onScrollEnd=function(){0==this.list_gift.scrollBar.value?this.btn_prev.visible=!1:this.btn_prev.visible=!0,this.list_gift.scrollBar.value==this.list_gift.scrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.update=function(e){this._dict=e.dict,this.setCurInfo(0),this.updateListRedPt()},i.updateListRedPt=function(){this.list_gift.array=this._ldArr},i.setCurInfo=function(e){var t=this;t.list_gift.selectedIndex=e,t.list_gift.scrollTo(e),t.btn_prev.visible=4<t._ldArr.length&&0!=e,t.btn_next.visible=4<t._ldArr.length&&e!=t._ldArr.length-1;var i=t._ldArr[e],n=An.MODEL.showGoods(i),s=An.MODEL.giftId(i);t._gp.gridDatas=cq.getGoodsByType6(Mn.MODEL.reward(Mn.getIndex(s)));Bi.getIndex(n);t.txt_desc.text=An.MODEL.desc(i),t.clip_gold.value=An.MODEL.allGolds(i)+"";var o=JSON.parse(An.MODEL.shareReward(i))[0];t.txt_gold.text=o.value.split(":")[1];var a=An.MODEL.topResBg(i).split(",");t.img_titlebg0.skin=_r.getLayoutsImagePath("pay0/"+a[0]),t.img_titlebg1.skin=_r.getLayoutsImagePath("pay0/"+a[1]),t.img_gift.skin=_r.getLayoutsImagePath("pay0/"+An.MODEL.bigPic(i));var r=An.MODEL.rechargeId(i),l=t._dict.get(r);l&&(t.txt_count.text=RP.n[1187]+(l.aCount-l.pCount)+"/"+l.aCount),t.btn_get.showTip=l&&l.isPay&&!l.isGet&&l.canGet,t.img_hasGot.visible=l&&l.aCount==l.pCount,t.btn_buy.visible=!(t.img_hasGot.visible||l&&l.isPay),t.btn_get.visible=!t.btn_buy.visible&&!t.img_hasGot.visible},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),this._ldArr=null,this._dict=null,ui.SubPanel.prototype.destroy.call(this,e)},t}(),M$=function(e){function t(){this.g=null,this.f=0,this.h=!1,this.c=4,t.__super.call(this)}b(t,"modules.activityDaily.view.OneYuanGiftV",Ly);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e);var t=Mn.getIndex(1);if(e.f=Mn.MODEL.productId(t),!e.g){e.g=new vj,e.g.y=270,e.g._spaceX=22,e.g.size(662,180),e.g._gnameFont=JP.gnameFont,e.g._hScrollBarSkin=null,e.g._vScrollBarSkin=null,e.g._gridH=e.g._gridW=116,e.g._gnameY=e.g._gridH+5,e.addChild(e.g);var i=Mn.MODEL.reward(t);e.g.setGoodsItems(i,6),e.g.x=(e.width-e.g.contentWidth)/2,e.c=yh.getObj(i).length}},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler),this.btn_award.on("click",this,this.onClickHandler),YB.reqOneYuanInfo()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.btn_award.off("click",this,this.onClickHandler)},i.updateToc=function(e){if(e&&e instanceof protos.activityDaily.toc_36012){this.btn_award.disabled=2==e.status,this.h=0!=e.status;var t=1==e.status;this.btn_award.label=this.h?t?RP.n[1189]:"已领取":RP.n[1188],this.btn_award.showTip=t}},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_close:hN.ins._closePanel(this);break;case this.btn_award:if(!this.h&&EB.showCharge)return this.onPay(),void hN.ins._closePanel(this);if(!TR.ins.hasEmptyNum(this.c))return void KQ.ins.showBagRecycle();this.h&&(YB.reqGetOneYuanGift(),hN.ins._closePanel(this))}},i.onPay=function(){EB.pay(Ln.MODEL.type(Ln.getIndex(this.f)),this.f)},t}(),A$=function(e){function t(){this.toc30726=null,t.__super.call(this)}b(t,"modules.activityDaily.view.SuperVipView",uI);var i=t.prototype;return i.initialize=function(){},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),YB.reqSuperVip(),t.btn_close.on("click",t,t.onBtnClose),t.btn_recharge.on("click",t,t.onBtnRecharge),t.img_bg1.skin=_r.getFullUrl("ui/layouts/activityDaily/cjhyzs_jm_bg_01.jpg"),t.img_bg2.skin=_r.getFullUrl("ui/layouts/activityDaily/cjhyzs_jm_bg_02.jpg"),t.img_bg3.skin=_r.getFullUrl("ui/layouts/activityDaily/cjhyzs_jm_bg_03.jpg"),t.img_bg4.skin=_r.getFullUrl("ui/layouts/activityDaily/cjhyzs_jm_bg_04.jpg"),t.box_qr.visible=!1},i.updateByVSC=function(e){e&&e instanceof protos.activityDaily.toc_30726&&(this.toc30726=e,this.updateDetail())},i.updateDetail=function(){var e=this;null!=e.toc30726&&(e.img_photo.skin=e.toc30726.photoUrl,e.txt_desc.innerHTML=RP.n[1190]+e.toc30726.serverName+RP.n[1191],0==e.toc30726.isVip?(e.server_num.innerHTML=(1==e.toc30726.type?"QQ:":"微信:")+"?????????",e.txt_tip1.visible=!0,e.txt_tip2.visible=!0,e.txt_num1.visible=!0,e.txt_num2.visible=!0,e.txt_tip1.innerHTML=RP.n[1192]+e.toc30726.maxDayRecharge+"元",e.txt_tip2.innerHTML=RP.n[1193]+e.toc30726.maxMonthRecharge+"元",e.txt_num1.innerHTML="(<font style='color:#e70909;'>"+e.toc30726.curDayRecharge+"</font>/"+e.toc30726.maxDayRecharge+")",e.txt_num2.innerHTML="(<font style='color:#e70909;'>"+e.toc30726.curMonthRecharge+"</font>/"+e.toc30726.maxMonthRecharge+")",e.txt_tip3.visible=!1,e.txt_tip4.visible=!1,e.btn_recharge.visible=!0,e.box_qr.visible=!1):(e.server_num.innerHTML=(1==e.toc30726.type?"QQ:":"微信:")+e.toc30726.number,e.txt_tip1.visible=!1,e.txt_tip2.visible=!1,e.txt_num1.visible=!1,e.txt_num2.visible=!1,e.txt_tip3.visible=!0,e.txt_tip4.visible=!0,e.btn_recharge.visible=!1,e.toc30726.qrUrl&&""!=e.toc30726.qrUrl?(e.box_qr.visible=!0,e.img_qr.skin=e.toc30726.qrUrl):e.box_qr.visible=!1))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this),this.btn_close.off("click",this,this.onBtnClose),this.btn_recharge.off("click",this,this.onBtnRecharge)},i.onBtnClose=function(e){hN.ins._closePanel(this)},i.onBtnRecharge=function(e){this.toc30726&&0==this.toc30726.isVip&&(Tu.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"]),hN.ins._closePanel(this))},t}(),D$=function(e){function t(){var e=this;e.gridPanel=null,t.__super.call(e),e.gridPanel||(e.gridPanel=new wj(1,4,116,24),e.gridPanel.pos(100,290),e.gridPanel.height=180,e.addChild(e.gridPanel)),e.gridPanel.vScrollBarSkin="",e.gridPanel.vScrollBar.elasticDistance=0}b(t,"modules.activityDaily.view.wechatShare.WechatFirstShareView",bI);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn.on("click",this,this.onClick),this.btn_close.on("click",this,this.onClose),this.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn.off("click",this,this.onClick),this.btn_close.off("click",this,this.onClose)},i.update=function(){var e=wo.MODEL.rewardDefs(wo.getIndex(1)),t=yB.createStrArr(e);this.gridPanel.gridDatas=t},i.onClick=function(e){YB.reqWxCanShare("WX_SHARE")},i.onClose=function(e){hN.ins.close("WECHAT_FIRST_SHARE")},t}(),O$=function(e){function t(){t.__super.call(this)}b(t,"modules.activityDaily.view.wechatShare.WechatShareLvView",wI);var i=t.prototype;return i.initialize=function(){this.list.itemRender=_X,this.list.vScrollBarSkin="",this.list.scrollBar.elasticDistance=300,this.list.repeatY=5,this.txt_desc.text=ei.MODEL.content(ei.getIndex(11112))},i.updateByVSC=function(e){if(e){var t=eR.ins.wxShareInfos,i=[];for(var n=0 in t)"WX_SHARE_LEVEL"==t[n].type&&i.push(t[n]);this.list.array=i}},i.onAdd=function(e){var t=new wP;t.type="WX_SHARE_LEVEL",Tu.sendToService(t),ui.SubPanel.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged),this.btn_share.on("click",this,this.onClickShare),this.imgBg1.skin=_r.getAtlasSubPath("wxshare/hysj_hb_01.jpg"),this.imgBg2.skin=_r.getAtlasSubPath("wxshare/hysj_hb_02.jpg")},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),this.btn_share.off("click",this,this.onClickShare)},i.onClickShare=function(e){YB.reqWxCanShare("WX_SHARE")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),P$=function(e){function t(){t.__super.call(this)}b(t,"modules.activityDaily.view.wechatShare.WechatShareVipView",wI);var i=t.prototype;return i.initialize=function(){this.list.itemRender=_X,this.list.vScrollBarSkin="",this.list.scrollBar.elasticDistance=300,this.list.repeatY=5,this.txt_desc.text=ei.MODEL.content(ei.getIndex(11113))},i.updateByVSC=function(e){if(e){var t=eR.ins.wxShareInfos,i=[];for(var n=0 in t)"WX_SHARE_VIP"==t[n].type&&i.push(t[n]);this.list.array=i}},i.onAdd=function(e){var t=new wP;t.type="WX_SHARE_VIP",Tu.sendToService(t),ui.SubPanel.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged),this.btn_share.on("click",this,this.onClickShare),this.imgBg1.skin=_r.getAtlasSubPath("wxshare/wxyq_img_hyVIP1.jpg"),this.imgBg2.skin=_r.getAtlasSubPath("wxshare/wxyq_img_hyVIP2.jpg")},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),this.btn_share.off("click",this,this.onClickShare)},i.onClickShare=function(e){YB.reqWxCanShare("WX_SHARE")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),R$=function(e){function t(){t.__super.call(this),this.list.itemRender=fX,this.list.vScrollBarSkin="",this.list.scrollBar.elasticDistance=300,this.list.repeatY=5}b(t,"modules.activityDaily.view.wechatShare.WechatShareView",kI);var i=t.prototype;return i.updateByVSC=function(e){this.update()},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged),this.btn_share.on("click",this,this.onClickShare),this.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),this.btn_share.off("click",this,this.onClickShare)},i.update=function(){this.txt_desc.text=ei.MODEL.content(ei.getIndex(5302));for(var e=[],t=2;t<=wo.count;t++){var i=0;i=eR.ins.toc39013.curShareCount<wo.MODEL.needShareCount(wo.getIndex(t))?0:eR.ins.toc39013.rewardArr&&0<=eR.ins.toc39013.rewardArr.indexOf(t)?2:1,e.push({rewardId:t,needShareCount:wo.MODEL.needShareCount(wo.getIndex(t)),reward:wo.MODEL.rewardDefs(wo.getIndex(t)),state:i})}this.list.dataSource=e},i.onClickShare=function(e){YB.reqWxCanShare("WX_SHARE")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),N$=function(e){function n(){var e=this;e._openIdx=0,e._selectSex=1,e._order=null,e._scale=.9,e._posX=null,e._posY=null,e._okImg=null,e._okUrl="ui/layouts/actorselectA/roleexchange_text_gxn.png",e._model=["js_kq_zs","js_kq_nzs","js_kq_fs","js_kq_nfs","js_kq_ds","js_kq_nds"],e._wmodel=["zswb1016","fswb1014","dswb1012"],e._avator=null,e._isPlaying=!1,e._isDown=!1,e._mx=0,e._effect=null,n.__super.call(e),e.isHideBg=!0,e.top=e.bottom=e.left=e.right=0,e.size(980,1280),e._posX=[491,751,230],e._posY=[e.mcR_1.y,e.mcR_2.y,e.mcR_3.y],e._avator=[];for(var t=0;t<3;t++)e._avator[t]=new CF,e._avator[t].pos(-368,57),e["mcR_"+(t+1)].addChildAt(e._avator[t],e["mcR_"+(t+1)].getChildIndex(e["mcO_"+(t+1)]));var i=new fr("#6f2400",20,0,0);e.txt_new.strokeColor="#7c3303",e.txt_new.stroke=0,e.txt_new.color="#fffd63",e.txt_new.filters=[i]}b(n,"modules.actor.views.active.ActorActiveM",V);var t=n.prototype;return t.notice=function(e){"10206"!=e.actionOrder&&"21109"!=e.actionOrder&&"14001"!=e.actionOrder||(this.btnEffect(),this.updateWord())},t.activeNew=function(e){var t=this["mcO_"+e.newActor.job];t.visible=!0,t.scaleX=t.scaleY=.76,Og.to(this["mcO_"+e.newActor.job],{scaleX:1,scaleY:1},250,null,ql.create(this,this.onEffectComplete)),this.btnA.visible=!1,this.btnEffect()},t.onEffectComplete=function(){var e=this;if(3<=gR.ins.actorList.length)return e.txD.visible=!1,e.txt_vip.visible=!1,e._okImg=new Kl,e._okImg.skin=_r.getFullUrl(e._okUrl),e._okImg.x=140,e._okImg.y=990,e.box_c.addChild(e._okImg),void G.timer.once(500,e,e.showEquip);oR.checkOpen(gR.ins.actorList.length)?e["mcO_"+e._order[1].name].visible?e.animation(1):e.animation(2):(e.showContent(),G.timer.once(500,e,e.showEquip))},t.showEquip=function(){Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{actorId:gR.ins.actorList.length}),G.timer.clear(this,this.showEquip)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.mcR_1.on("mousedown",t,t.onMouseDown),t.mcR_2.on("mousedown",t,t.onMouseDown),t.mcR_3.on("mousedown",t,t.onMouseDown),t.on("mouseup",t,t.onMouseUp),t.layout.dragon_border.visible=!1,t.whichJob(),t.showContent(),t.addMask(),t.setTitle(_r.getAtlasSubPath("actorselectA/js_bt_jskq.png")),t.txt_vip.on("click",t,t.gotoVipPanel),t.onCheckPlayerNum()},t.onCheckPlayerNum=function(){if(3<=gR.ins.actorList.length)return this.txD.visible=!1,this.txt_vip.visible=!1,void(this.btnA.visible=!1)},t.gotoVipPanel=function(){var e=0;switch(this._openIdx){case 1:e=2;break;case 2:e=4}hN.ins.open("VIP_PANEL",e)},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.mcR_1.off("mousedown",t,t.onMouseDown),t.mcR_2.off("mousedown",t,t.onMouseDown),t.mcR_3.off("mousedown",t,t.onMouseDown),t.off("mouseup",t,t.onMouseUp),t.onFinish(),t._isPlaying=!1,t._effect&&t._effect.dispose(),t._effect=null},t.onMouseDown=function(){this._isDown=!0,this._mx=G.stage.mouseX},t.onMouseUp=function(){this._isDown&&(this._isPlaying||(this._isDown=!1,0<G.stage.mouseX-this._mx?this.animation(1):this.animation(2)))},t.showContent=function(){this._openIdx=gR.ins.actorList.length,this.showSex(this._selectSex),this.updateWord()},t.updateWord=function(){var e=this;if(oR.checkOpen(e._openIdx))return e.txD.innerHTML=Ql.createColor(RP.n[1194],"#23b11f"),e.txD.x=366,void(e.txt_vip.visible=!1);e.txD.innerHTML=RP.n[1195]+Ql.createColor(oR.getDesc(e._openIdx),"#ff2e24")+" 或",e.txD.x=310,"1转"==oR.getDesc(e._openIdx)?e.txt_vip.x=551:"4转"==oR.getDesc(e._openIdx)&&(e.txt_vip.x=536),e.txt_vip.visible=!0,e.txt_vip.text="成为"+oR.getVipDesc(e._openIdx)},t.onClick=function(e){var t=this;e.target!=t.btnL&&e.target!=t._order[2]||t._isPlaying?e.target!=t.btnR&&e.target!=t._order[1]||t._isPlaying?e.target==t.btnA?t.active():e.target==t.btnS_1?t.showSex(1):e.target==t.btnS_2&&t.showSex(2):t.animation(2):t.animation(1)},t.animation=function(e){var t=this;1==e?(Og.to(t._order[0],{x:t._order[1].x,y:t._order[1].y,scaleX:t._scale,scaleY:t._scale,ease:pa.backOut},500,null,ql.create(t,t.onFinish)),Og.to(t._order[1],{x:t._order[2].x,y:t._order[2].y,ease:pa.backOut},500),Og.to(t._order[2],{x:t._order[0].x,y:t._order[0].y,scaleX:1.35,scaleY:1.35,ease:pa.backOut},500),Og.to(t._order[2].getChildByName("title"),{y:150,ease:pa.backOut},500),Og.to(t._order[0].getChildByName("title"),{y:120,ease:pa.backOut},500),t._order.splice(0,0,t._order.pop())):(Og.to(t._order[0],{x:t._order[2].x,y:t._order[2].y,scaleX:t._scale,scaleY:t._scale,ease:pa.backOut},500,null,ql.create(t,t.onFinish)),Og.to(t._order[1],{x:t._order[0].x,y:t._order[0].y,scaleX:1.35,scaleY:1.35,ease:pa.backOut},500),Og.to(t._order[2],{x:t._order[1].x,y:t._order[1].y,ease:pa.backOut},500),Og.to(t._order[0].getChildByName("title"),{y:120,ease:pa.backOut},500),Og.to(t._order[1].getChildByName("title"),{y:150,ease:pa.backOut},500),t._order.push(t._order.shift())),t.onStart(),t._isPlaying=!0,oR.checkOpen(t._openIdx)&&(t.txt_vip.visible=!1)},t.onStart=function(){var e=this._order[0].name;this.btnA.visible=this.txD.visible=this.txt_vip.visible=!this["mcO_"+e].visible,this.btnEffect()},t.onFinish=function(){this._isPlaying=!1,this.box_c.addChildAt(this.box_c.getChildByName("mask"),this.box_c.getChildIndex(this.mcSex)-1),this.box_c.addChildAt(this._order[0],this.box_c.getChildIndex(this.mcSex)-1)},t.active=function(){if(0==oR.checkOpen(this._openIdx)){UB.ins._playLevelNot();var e=RP.n[1196];return e+=Ql.createColor(oR.getVipDesc(this._openIdx),"#23b11f"),e+=RP.n[1197],e+=Ql.createColor((this._openIdx+1).toString(),"#23b11f"),e+=RP.n[1198],void KQ.ins.show(e,ql.create(this,this.onConfirm),!1,3,RP.n[1199])}var t=new gL;t.sex=this._selectSex,t.job=this._order[0].name,Tu.sendToService(t)},t.onConfirm=function(e){1==e&&this.gotoVipPanel()},t.showSex=function(e){this._selectSex=e,this.btnS_1.selected=Boolean(1==e),this.btnS_2.selected=Boolean(2==e),this["btnS_"+e].mouseEnabled=!1,this["btnS_"+(1==e?"2":"1")].mouseEnabled=!0,this.setAvatar(e)},t.setAvatar=function(e){if(mR.ins.isComplete)for(var t=0;t<3;t++){var i=gR.ins.actorByJob(t+1);null==i?this._avator[t].changeAvatar(e,null,this._model[2*t+e-1],null):this._avator[t].changeAvatar(i.sex,null,this._model[2*t+i.sex-1],null)}else mR.ins.onToLoad(ql.create(this,this.setAvatar,[e]))},t.whichJob=function(){var e=this,t=[0,0,0];for(var i in e._order=[],gR.ins.actorList)t[gR.ins.actorList[i].job-1]=1;for(var n=0;n<=2;n++)1==t[n]?(e["mcO_"+(n+1)].visible=!0,e._order[e._order.length]=e["mcR_"+(n+1)]):(e["mcO_"+(n+1)].visible=!1,e._order.splice(0,0,e["mcR_"+(n+1)]));e._order[0].x=e._posX[0],e._order[0].y=e._posY[0],e._order[1].x=e._posX[1],e._order[1].y=e._posY[1],e._order[2].x=e._posX[2],e._order[2].y=e._posY[2],e._order[1].scaleX=e._order[1].scaleY=e._scale,e._order[2].scaleX=e._order[2].scaleY=.9,e._order[0].scaleX=e._order[0].scaleY=1.35,e._order[0].getChildByName("title").y=150,e._order[1].getChildByName("title").y=120,e._order[2].getChildByName("title").y=120,e.btnA.visible=!e["mcO_"+e._order[0].name].visible,e.btnEffect()},t.btnEffect=function(){var e=this;e.btnA.visible&&oR.checkOpen(gR.ins.actorList.length)?e._effect||(e._effect=new mj,e._effect.pos(e.btnA.x+.5*e.btnA.width,e.btnA.y+.5*e.btnA.height),e._effect.renderInSelf=!0,e._effect.loadEffect("jm1242"),e.box_c.addChild(e._effect)):(e._effect&&e._effect.dispose(),e._effect=null)},t.destroy=function(e){var t=this;void 0===e&&(e=!0),t._order=null,t._okImg&&(t._okImg.parent&&t.removeChild(t._okImg),t._okImg.destroy(!0),G.loader.clearRes(t._okUrl)),t.bg&&t.bg.skin&&G.loader.clearRes(t.bg.skin),t._okUrl&&G.loader.clearRes(t._okUrl),ui.SubPanel.prototype.destroy.call(t,e)},t.addMask=function(){var e=new Ss;e.graphics.drawRect(0,0,this.width,this.height,"#000000",null),e.alpha=.3,e.mouseThrough=!0,e.name="mask",this.box_c.addChildAt(this._order[0],this.box_c.getChildIndex(this.mcSex)-1),this.box_c.addChildAt(e,this.box_c.getChildIndex(this._order[0]))},n}(),B$=function(e){function t(){var e=this;e._selector=null,e._avator=null,e._tPos=null,e._effList=[],t.__super.call(e),e.title=_r.getAtlasSubPath("actor/Role_show_title.png"),e._selector=new Nj,e.addChild(e._selector),e._avator=new CF,e._avator.pos(-340,344),e.addChild(e._avator),e._tPos=[e.title1,e.title2]}b(t,"modules.actor.views.active.ActorShowV",ie);var i=t.prototype;return i.refresh=function(){this.onSelect()},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._selector.refresh(),t._selector.selectIdx!=gR.ins.showId-1&&(t._selector.selectIdx=gR.ins.showId-1),t.onSelect(),t._selector.on("select",t,t.onSelect),JB.ins.openIdx=0},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._selector.off("select",this,this.onSelect),this._selector.selectIdx=0},i.onSelect=function(){var e=this,t=gR.ins.showId==e._selector.selectIdx+1;e.mcShow.visible=t,e.mcW.visible=!t,e.btnShow.visible=!t;var i=gR.ins.actorById(e._selector.selectIdx+1);e._avator.changeAvatar(i.sex,i.wid,i.mid,i.wgid,i.weaponSoulId,i.chuanshiId,i.magicId);for(var n=e._effList.length-1;0<=n;n--)e._effList[n].dispose(),e._effList.pop();var s,o,a=0,r=0;for(n=i.titles.length-1;0<=n;n--)a=co.getIndex(i.titles[n]),(s=co.MODEL.effect(a))&&0<s.length&&((o=mj.GetNew()).renderInSelf=!0,e.addChild(o),o.loadEffect(s),o.pos(e._tPos[e._tPos.length-r-1].x,e._tPos[e._tPos.length-r-1].y),e._effList[e._effList.length]=o,r++)},i.onClick=function(e){if(this.btnSZ==e.target)Tu.sendToModule("FASHION_OPEN",["modules.fashion.FashionModule"],1);else if(this.btnTitle==e.target)Tu.sendToModule("FASHION_OPEN",["modules.fashion.FashionModule"],3);else if(this.btnShow==e.target){var t=new vL;t.role=this._selector.selectIdx+1,Tu.sendToService(t)}},t}(),H$=function(e){function t(){var e=this;e._selector=null,e._sbox=null,e._lbox=null,e._rbox=null,e.openLevel=0,e.cindex=0,e.isMaxLevel=!1,e.isFull=!1,e.c_gid=0,e.c_gnum=0,e._BAR_W=0,e.GAP_Y=37,e.curObj=null,e.eff=null,e.isClick=!0,e.titleTween=null,e._times=0,e._tween=null,e.effStar=null,t.__super.call(e),e.bg.skin=_r.getActImg()}b(t,"modules.actor.views.cimelia.DragonSoulView",Zo);var i=t.prototype;return i.initialize=function(){this._selector=new Nj,this.addChild(this._selector),this._BAR_W=this.bar.width,this.openLevel=parseInt($e.MODEL.value($e.getIndex(141))),this.bar.mask=this.bar_mask},i.shareHandler=function(){var e=this;338==e.img_icon.y?e.titleTween=Og.to(e.img_icon,{y:348},1e3,null,ql.create(e,e.shareHandler)):348==e.img_icon.y?e.titleTween=Og.to(e.img_icon,{y:343},500,null,ql.create(e,e.shareHandler)):343==e.img_icon.y&&(e.titleTween=Og.to(e.img_icon,{y:338},500,null,ql.create(e,e.shareHandler)))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._selector.on("select",t,t.onRoleHandler),t.btn_active.on("click",t,t.onClickHanlder),t.isClick=!0,t.sp.visible=t.sp_ac.visible=!1,t.img_full.visible=!1,t.img_red.visible=!1,gR.ins.lv<t.openLevel?t.sp_ac.visible=!0:(sR.roleIndex=t._selector.selectIdx+1,sR.reqInfo()),t.img_icon.y=343,t.img_icon&&(t.titleTween=Og.to(t.img_icon,{y:338},500,null,ql.create(t,t.shareHandler)))},i.onRemove=function(e){var t=this;t.hide(),t.clearEff(),t.clearStarEff(),t._tween&&t._tween.clear(),t._tween=null,t._selector.off("select",t,t.onRoleHandler),t.btn_active.off("click",t,t.onClickHanlder),t.titleTween&&t.titleTween.clear(),ui.SubPanel.prototype.onRemove.call(t,e)},i.destroy=function(e){void 0===e&&(e=!0),this.bg&&this.bg.skin&&G.loader.clearRes(this.bg.skin),ui.SubPanel.prototype.destroy.call(this,e)},i.hide=function(){this.sp.visible=this.sp_ac.visible=!1,this._sbox&&this._sbox.graphics.clear(),this._lbox&&this._lbox.graphics.clear(),this._rbox&&this._rbox.graphics.clear()},i.updateByVSC=function(e){var t=this;if((!e||e instanceof protos.actor.toc_30121||e instanceof protos.actor.toc_30123)&&null!=sR.draSoulHash){for(var i=0;i<3;i++)sR.draSoulHash&&sR.draSoulHash.take(i+1)&&t._selector.setRedPtByIdx(i,sR.getRedByActorId(i+1));if(sR.draSoulHash&&(t.curObj=sR.draSoulHash.take(sR.roleIndex)),t.curObj)if(t.cindex=sR.getCurIndex(t.curObj.steps,t.curObj.level),t.isFull=sR.getIsFull(t.cindex),t.isMaxLevel=0==ti.MODEL.experience(t.cindex),e instanceof protos.actor.toc_30123)t.showBar();else{if(t.hide(),t.btn_active.visible=!t.isFull,t.img_red.visible=!1,!t.isActived)return t.sp_ac.visible=!0,t.btn_active.visible=!t.isFull,t.txt_open.innerHTML=t.openLevel+RP.n[1201],t.btn_active.label="激 活",t.btn_active.disabled=gR.ins.lv<t.openLevel,void(gR.ins.lv>t.openLevel?t.eff||(t.eff=kB.createEffect("jm1130",t.btn_active.width>>1,t.btn_active.height>>1,t.btn_active),t.eff.scale_X=1.25,t.eff.scale_Y=1.25):t.clearEff());e instanceof protos.actor.toc_30123?t.showBar():t.setProgress()}}},i.setProgress=function(){var e=this;e.clearEff(),e.btn_active.visible=!e.isFull,e.img_red.visible=sR.getRedByActorId(sR.roleIndex),e.sp_ac.visible=!1,e.sp.visible=!0;var t=mp.getChineseNum(e.curObj.steps);e.cp_level.value=t,e.img_bold.height=75+33*t.length,e.img_font.y=e.cp_level.y+30*t.length+15;var i=rB.ins.getPlusByModule("DRAGONSOUL",e._selector.selectIdx+1),n=Math.floor(RR.getFight(JSON.parse(ti.MODEL.attrs(e.cindex)))*(1+i));e.fightNum.value=n+Math.floor(n*e.checkTitle(15)),e.img_full.visible=e.isFull,e.isFull?(e.box_bar.visible=!1,e.txt_cost.visible=e.box_bar.visible):e.setBtnState(),e.showLevel(),e.showAttrs()},i.checkTitle=function(e){var t=0,i=tg.ins.toc_title;if(!i)return 0;var n,s=i.titles[0];for(var o in s)if((n=s[o]).id==e&&0<=n.state){var a=co.getIndex(e);t=JSON.parse(co.MODEL.attr(a))[4].value/1e4}else;return t},i.setBtnState=function(){var e=this;if(e.btn_active.disabled=!1,e.box_bar.visible=!e.isMaxLevel,e.txt_cost.visible=e.box_bar.visible,e.isMaxLevel)return e.btn_active.label="升 阶",void(e.bar_mask.x=-e._BAR_W);var t=JSON.parse(ti.MODEL.consumeDef(e.cindex));e.c_gid=parseInt(t[0].value.toString().split(":")[0]),e.c_gnum=parseInt(t[0].value.toString().split(":")[1]);var i=TR.ins.getGoodsNum(e.c_gid)<e.c_gnum?"#ff2e24":"#23b11f";e.txt_cost.innerHTML=RP.n[1202]+Ql.createColor(TR.ins.getGoodsNum(e.c_gid)+"",i)+"/"+e.c_gnum,TR.ins.getGoodsNum(e.c_gid)<1?e.btn_active.label=RP.n[1203]:e.btn_active.label="提 升",e.box_bar.visible&&!sR.isStep&&(e.txt_bar.changeText(e.curObj.exp+"/"+ti.MODEL.experience(e.cindex)),e.bar_mask.x=-e._BAR_W+e.rateWidth)},i.showLevel=function(){var e=this;if(e.box_star.visible=!e.isFull,e._sbox&&e._sbox.graphics.clear(),!e.isFull){e._sbox||(e._sbox=new dt,e._sbox.pos(104,534),e.sp.addChild(e._sbox)),e._sbox.graphics.clear();var t,i;i=_r.getAtlasSubPath("base_ui2/g_level_0_0.png"),t=G.loader.getRes(i);for(var n=0;n<e.curObj.level;n++)e._sbox.graphics.drawTextures(t,[52*n,0])}},i.showAttrs=function(){var e=this,t=0,i=aa.formatAttrToChineseByList(ti.MODEL.attrs(e.cindex));for(e._lbox||(e._lbox=new dt,e._lbox.pos(128,654),e.sp.addChild(e._lbox)),e._lbox.graphics.clear(),t=0;t<i.length;t++)e._lbox.graphics.fillText(i[t].addName+" ： "+i[t].val,0,e.GAP_Y*t,"24px SimHei","#e0d6c1","left");if(e._lbox.x=e.isFull?282:128,e.img_arrow.visible=!e.isFull,e.isFull)e._rbox&&e._rbox.graphics.clear();else{var n=aa.formatAttrToChineseByList(ti.MODEL.attrs(e.cindex+1));for(e._rbox||(e._rbox=new dt,e._rbox.pos(428,654),e.sp.addChild(e._rbox)),e._rbox.graphics.clear(),t=0;t<i.length;t++)e._rbox.graphics.fillText(n[t].addName+" ： "+n[t].val,0,e.GAP_Y*t,"24px SimHei","#23b11f","left")}},i.onRoleHandler=function(){this._selector.selectIdx+1!=sR.roleIndex&&(sR.roleIndex=this._selector.selectIdx+1,this.updateByVSC(null))},i.onClickHanlder=function(e){var t=this;500<BB.getTimer()-t._times&&!t.isClick&&(t.isClick=!0),!t.isFull&&t.isClick&&(t.openLevel>gR.ins.lv?zB.ins.showById(101,1):t.isActived&&!t.isMaxLevel&&TR.ins.getGoodsNum(t.c_gid)<1?Tu.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1042,max:-1}):(t._times=BB.getTimer(),t.isClick=!1,sR.reqUpdate(sR.roleIndex),t.isActived&&UB.ins.playSound("11")))},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.showBar=function(){var e=this;e._tween&&e._tween.clear(),e._tween=null,sR.isUp?e._tween=Og.to(e.bar_mask,{x:0},100,null,ql.create(e,e.onT)):(sR.isStep&&(e.bar_mask.x=-e._BAR_W,e.setProgress()),e._tween=Og.to(e.bar_mask,{x:-e._BAR_W+e.rateWidth},100,null,ql.create(e,e.onEnd)))},i.onT=function(){var e=this;sR.isUp=!1,e.bar_mask.repaint(),e.setStar(),e.isMaxLevel?(e.isClick=!0,e._tween&&e._tween.clear(),e._tween=null):(e.bar_mask.x=-e._BAR_W,e.showBar())},i.onEnd=function(){this.isClick=!0,sR.isUp=!1,sR.isStep=!1,this.setProgress(),this._tween&&this._tween.clear(),this._tween=null},i.setStar=function(){this.clearStarEff(),this.isMaxLevel?this.setProgress():this.showLevel(),this.effStar||(this.effStar=kB.createEffect("jm1217",52*this.curObj.level+74,557,this.sp))},i.clearStarEff=function(){this.effStar&&(this.effStar.parent&&this.effStar.parent.removeChild(this.effStar),this.effStar.dispose(),this.effStar=null)},p(0,i,"rateWidth",function(){var e=this.curObj.exp/ti.MODEL.experience(this.cindex);return 1<e&&(e=1),this._BAR_W*e}),p(0,i,"isActived",function(){return!this.curObj||0!=this.curObj.steps||0!=this.curObj.level}),t}(),V$=function(e){function t(){var e=this;e._selector=null,e._sbox=null,e._lbox=null,e._rbox=null,e.openLevel=0,e.curID=0,e.isMaxLevel=!1,e.isFull=!1,e.c_gid=0,e.c_gnum=0,e._BAR_W=0,e.GAP_Y=37,e.curObj=null,e.eff=null,e.successEff=null,e.mainEff=null,e.m_cost0=null,e.m_cost1=null,e.m_cost2=null,e.isOneKeyClicked=!1,e._tween=null,e.doingProgress=!1,t.__super.call(e),e.img_bg.skin=_r.getActImg()}b(t,"modules.actor.views.cimelia.YuPeiView",wv);var i=t.prototype;return i.initialize=function(){var e=this;e._selector=new Nj,e.addChild(e._selector);for(var t=0;t<5;t++){var i=SR.skillIDs[t],n=Ls.getIndex(i);e["img_skill"+t].skin=_r.getIconPath(Ls.MODEL.icon(n))}if(!e.m_cost0){var s=SR.materialIDs;e.m_cost0=new MF(45),e.m_cost0.needGridBg=!1,e.m_cost0.needEffect=!1,e.m_cost0.pos(125,1012),e.addChild(e.m_cost0);var o=yB.create(s[0]);e.m_cost0.bindData=o}e.m_cost1||(e.m_cost1=new MF(45),e.m_cost1.needGridBg=!1,e.m_cost1.needEffect=!1,e.m_cost1.pos(350,1012),e.addChild(e.m_cost1),o=yB.create(s[1]),e.m_cost1.bindData=o),e.m_cost2||(e.m_cost2=new MF(45),e.m_cost2.needGridBg=!1,e.m_cost2.needEffect=!1,e.m_cost2.pos(575,1012),e.addChild(e.m_cost2),o=yB.create(s[2]),e.m_cost2.bindData=o)},i.perInit=function(){var e=this;e._BAR_W=e.bar.width,e.bar.mask=e.bar_mask,e.img_max.visible=!1,e.isOneKeyClicked=!1,SR.roleID=e._selector.selectIdx+1,SR.materialIndex=e.rg_materials.selectedIndex,e.btn_upgrade_onekey.label=RP.n[1204],e.showMainEff()},i.setMaterialInfo=function(){var e=SR.materialIDs,t=TR.ins.getGoodsNum(e[0]),i=TR.ins.getGoodsNum(e[1]),n=TR.ins.getGoodsNum(e[2]);this.txt_material0.text=t+"",this.txt_material1.text=i+"",this.txt_material2.text=n+"";var s="#e41b00",o="#01b527";this.txt_material0.color=0<t?o:s,this.txt_material1.color=0<i?o:s,this.txt_material2.color=0<n?o:s},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.rg_materials.on("change",t,t.onMaterialChanged),t._selector.on("select",t,t.onRoleHandler),t.btn_help.on("click",t,t.showHelp),t.btn_upgrade.on("click",t,t.upgradeClicked),t.btn_upgrade_onekey.on("click",t,t.oneKeyUpgradeClicked),t.yupei_skill1.on("click",t,t.onSkillClicked),t.yupei_skill2.on("click",t,t.onSkillClicked),t.yupei_skill3.on("click",t,t.onSkillClicked),t.yupei_skill4.on("click",t,t.onSkillClicked),t.yupei_skill5.on("click",t,t.onSkillClicked),t.perInit(),SR.reqInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.clearEff(),t._tween&&t._tween.clear(),SR.clearFakeDatas(),t.rg_materials.off("change",t,t.onMaterialChanged),t._selector.off("select",t,t.onRoleHandler),t.btn_help.off("click",t,t.showHelp),t.btn_upgrade.off("click",t,t.upgradeClicked),t.btn_upgrade_onekey.off("click",t,t.oneKeyUpgradeClicked),t.yupei_skill1.off("click",t,t.onSkillClicked),t.yupei_skill2.off("click",t,t.onSkillClicked),t.yupei_skill3.off("click",t,t.onSkillClicked),t.yupei_skill4.off("click",t,t.onSkillClicked),t.yupei_skill5.off("click",t,t.onSkillClicked),t.isOneKeyClicked=!1,t.bar.mask=null,t.curObj=null},i.onMaterialChanged=function(e){SR.materialIndex=this.rg_materials.selectedIndex},i.showHelp=function(e){QR.goToOpenHelpDes(2)},i.upgradeClicked=function(){this.doingProgress&&!this.isOneKeyClicked||(this.isOneKeyClicked&&(this.btn_upgrade_onekey.label=RP.n[1204],this.isOneKeyClicked=!1),this.upgrade())},i.upgrade=function(){if(SR.isUpgradeSuccess=!1,!this.isStepChanged()&&SR.getMaterialNum()<=0){var e=SR.materialIDs[this.rg_materials.selectedIndex];return Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:e}),this.btn_upgrade_onekey.label=RP.n[1204],void(this.isOneKeyClicked=!1)}var t=this.rg_materials.selectedIndex,i=SR.materialIDs[t];this.isStepChanged()?SR.reqUpdateTier(SR.roleID):SR.reqUpdateLevel(SR.roleID,i)},i.oneKeyUpgradeClicked=function(e){this.isOneKeyClicked?(this.btn_upgrade_onekey.label=RP.n[1204],this.isOneKeyClicked=!1):this.doingProgress||(this.btn_upgrade_onekey.label=RP.n[1207],this.isOneKeyClicked=!0,this.upgrade())},i.onSkillClicked=function(e){var t=0;switch(e.target){case this.yupei_skill1:t=0;break;case this.yupei_skill2:t=1;break;case this.yupei_skill3:t=2;break;case this.yupei_skill4:t=3;break;case this.yupei_skill5:t=4}var i="",n=SR.skillIDs[t];SR.isSkillActived(SR.roleID,t)||(i=SR.getUnlockSkillStr(t)),Hj.instance.showBySkillID(n,i)},i.updateByVSC=function(e){var t=this;if(e){if("UPDATE_YUPEI_MATERIAL"==e)t.setMaterialInfo();else{if(e instanceof protos.actor.toc_30481){var i=e,n=t._selector.selectIdx+1;t.curObj=i.yupeiHash.take(n),t.curID=SR.getCurrentID(t.curObj.steps,t.curObj.level)}else if(e instanceof protos.actor.toc_30483){var s=!1,o=SR.yupeiHash.take(SR.roleID);SR.isUpgradeSuccess=e.level!=o.level||e.exp!=o.exp||e.steps!=o.steps,SR.isUpgradeSuccess&&(e.level>o.level&&t.showSuccess(),s=t.showProgressEffect(e.steps,e.exp,o.level,e.level)),o.steps=t.curObj.steps=e.steps,o.level=t.curObj.level=e.level,o.exp=t.curObj.exp=e.exp,t.curID=SR.getCurrentID(t.curObj.steps,t.curObj.level),t.isOneKeyClicked=t.isOneKeyClicked&&SR.isUpgradeSuccess&&!t.isStepChanged()}t.updateView(),t.setMaterialInfo(),s||t.setProgress()}if(SR.yupeiHash)for(var a=0;a<3;a++)SR.yupeiHash.take(a+1)&&t._selector.setRedPtByIdx(a,SR.getRedByActorId(a+1))}},i.isStepChanged=function(){var e=Kn.getIndex(this.curID),t=Kn.MODEL.level(e),i=Kn.MODEL.experience(e);return 10==t&&0==i},i.updateView=function(){var e=this,t=Kn.getIndex(e.curID),i=JSON.parse(Kn.MODEL.attrs(t));e.fightNum.value=RR.getFight(i);var n=mp.getChineseNum(e.curObj.steps)+"阶"+mp.getChineseNum(e.curObj.level)+"级";e.txt_level.value=n,e.img_levelBg.height=155+32*(n.length-4);for(var s=0;s<5;s++)e["img_skill"+s].gray=!SR.isSkillActived(SR.roleID,s);e.txt_left0.text=RP.n[1209]+SR.getAttrValue(i,"ATK"),e.txt_left1.text=RP.n[1210]+SR.getAttrValue(i,"CRI");var o=SR.getAttrValue(i,"CRI_QD_RATE")/100;e.txt_left2.text=RP.n[1211]+o.toFixed(2)+"%";var a=Kn.getIndex(e.curID+1);isNaN(a)||null==a||null==a||(i=JSON.parse(Kn.MODEL.attrs(a)),e.txt_right0.text=RP.n[1212]+SR.getAttrValue(i,"ATK"),e.txt_right1.text=RP.n[1213]+SR.getAttrValue(i,"CRI"),o=SR.getAttrValue(i,"CRI_QD_RATE")/100,e.txt_right2.text=RP.n[1214]+o.toFixed(2)+"%");var r=SR.isMaxByIndex(e.curID-1);e.toggleMaxLevelAndStep(r);var l=e.isStepChanged();e.btn_upgrade.label=l?"升 阶":"升 级",l&&(e.btn_upgrade_onekey.label=RP.n[1204]),e.btn_upgrade_onekey.visible=!l,e.btn_upgrade.x=l?217:68},i.getRateWidth=function(e,t,i){e=e||this.curObj.exp,t=t||this.curObj.level,i=i||this.curObj.steps;var n=SR.getCurrentID(i,t),s=Kn.getIndex(n),o=e/(Kn.MODEL.experience(s)||1);return 1<o&&(o=1),Math.floor(this._BAR_W*o)},i.toggleMaxLevelAndStep=function(e){var t=this;t.img_max.visible=e,t.box_bottom.visible=!e,t.box_progress.visible=!e&&!t.isStepChanged(),e?t.box_attr_left.pos(205,21):t.box_attr_left.pos(42,21),t.box_attr_right.visible=!e,t.img_arrow.visible=!e,t.m_cost0&&(t.m_cost0.visible=!e),t.m_cost1&&(t.m_cost1.visible=!e),t.m_cost2&&(t.m_cost2.visible=!e)},i.setProgress=function(){var e=this,t=SR.isMaxByIndex(e.curID-1),i=e.box_progress.visible;if(!t&&i){var n=Kn.getIndex(e.curID),s=e.curObj.exp,o=Kn.MODEL.experience(n);s==o?(e.bar_mask.x=-e._BAR_W,e.txt_bar.text="0/"+Kn.MODEL.experience(n+1)):(e.txt_bar.text=s+"/"+o,e.bar_mask.x=-e._BAR_W+e.getRateWidth())}i||"0/0"!=e.txt_bar.text||(e.bar_mask.x=-e._BAR_W,e.txt_bar.text="0/"+Kn.MODEL.experience(e.curID)),e.doingProgress=!1;var a=SR.getFakeData();a?e.updateByVSC(a):e.isOneKeyClicked&&e.upgrade()},i.showProgressEffect=function(e,t,i,n){if(this.doingProgress=!0,this._tween&&this._tween.clear(),0==t)return!1;var s=this.getRateWidth(t,n,e),o=-this._BAR_W+s;return this._tween=Og.to(this.bar_mask,{x:o},400,null,ql.create(this,this.setProgress)),!0},i.startNextProEffect=function(e){this.bar_mask.x=-this._BAR_W,this._tween=Og.to(this.bar_mask,{x:-this._BAR_W+e},250,null,ql.create(this,this.setProgress))},i.onRoleHandler=function(){var e=this;if(e._selector.selectIdx+1!=SR.roleID){e.curObj=SR.yupeiHash.take(SR.roleID);var t=SR.getRealData()||e.curObj;e.curObj.steps=t.steps,e.curObj.level=t.level,e.curObj.exp=t.exp,SR.roleID=e._selector.selectIdx+1,e.curObj=SR.yupeiHash.take(SR.roleID),e.curID=SR.getCurrentID(e.curObj.steps,e.curObj.level),e.btn_upgrade_onekey.label=RP.n[1204],e.isOneKeyClicked=!1,e._tween&&e._tween.clear(),SR.clearFakeDatas(),e.updateView(),e.setProgress()}},i.showSuccess=function(){this.successEff&&(this.successEff.dispose(),this.successEff=null),this.successEff=kB.createEffect("jm1072",375,557,this)},i.showMainEff=function(){this.mainEff&&(this.mainEff.dispose(),this.mainEff=null),this.mainEff=kB.createEffect("jm1273",362,510,this)},i.clearEff=function(){var e=this;e.eff&&(e.eff.parent&&e.eff.parent.removeChild(e.eff),e.eff.dispose(),e.eff=null),e.successEff&&(e.successEff.parent&&e.successEff.parent.removeChild(e.successEff),e.successEff.dispose(),e.successEff=null),e.mainEff&&(e.mainEff.parent&&e.mainEff.parent.removeChild(e.mainEff),e.mainEff.dispose(),e.mainEff=null)},t}(),G$=function(n){function e(){this._highGrid=null,this._lowGrid=null,this._max=1,this._num=1,this._buyNum=0,this._isDown=!1,this._highNum=null,this._lowNum=null,e.__super.call(this)}b(e,"modules.actor.views.heji.ActorHeJiCanJuanView",n);var t=e.prototype;return t.createChildren=function(){var e=this;n.prototype.createChildren.call(e),e._highGrid=new MF,e._highGrid.pos(e.img_high.x,e.img_high.y);var t=yB.create(aR.HIGH_RUNE_PIECE.itemId);e._highGrid.bindData=t,e.txt_high.text=t.name,e.addChild(e._highGrid),e._highNum=new Yp,e.addChild(e._highNum),e._highNum.color="#e0d6c1",e._highNum.fontSize=24,e._highNum.font=dr.font,e._highNum.align="right",e._highNum.width=e._highGrid.width-10,e._highNum.y=e._highGrid.y+e._highGrid.height-32,e._highNum.x=e._highGrid.x,e._lowGrid=new MF,e._lowGrid.pos(e.img_low.x,e.img_low.y);var i=yB.create(aR.RUNE_PIECE.itemId);e._lowGrid.bindData=i,e.txt_low.text=i.name,e.addChild(e._lowGrid),e._lowNum=new Yp,e.addChild(e._lowNum),e._lowNum.color="#e0d6c1",e._lowNum.fontSize=24,e._lowNum.font=dr.font,e._lowNum.align="right",e._lowNum.width=e._lowGrid.width-10,e._lowNum.y=e._lowGrid.y+e._lowGrid.height-32,e._lowNum.x=e._lowGrid.x,e.updateView()},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.on("mousedown",t,t.onDown),t.on("mouseup",t,t.onOver),t.on("mouseout",t,t.onOver),t.updateView()},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.off("mousedown",t,t.onDown),t.off("mouseup",t,t.onOver),t.off("mouseout",t,t.onOver),t.onOver(null)},t.updateView=function(){var e=this;e._max=gR.ins.fuwengaoji,0==e._max&&(e.txt_imput.text="0"),e._max>=e._num?e.txt_imput.text=e._num.toString():e.txt_imput.text=e._max.toString(),e._lowNum.text=gR.ins.fuwen.toString(),e._highNum.text=gR.ins.fuwengaoji.toString()},t.onClick=function(e){var t=this;switch(e.target){case t.btn_close:hN.ins.isOpen("ACTORHEJICANJUANVIEW")&&hN.ins.close("ACTORHEJICANJUANVIEW");break;case t.btn_exchange:t.exchange();break;case t.btn_oneKey:t.txt_imput.text=gR.ins.fuwengaoji.toString(),t.exchange();break;case t.btn_add:t._buyNum>=t._max?zB.ins.showMsg(RP.n[1217],1):t.loop(t.btn_add);break;case t.btn_reduce:0<parseInt(t.txt_imput.text)&&(1==parseInt(t.txt_imput.text)?zB.ins.showMsg(RP.n[1218],1):t.loop(t.btn_reduce))}},t.exchange=function(){if(0!=gR.ins.fuwengaoji&&gR.ins.fuwengaoji>=parseInt(this.txt_imput.text)){this._num=parseInt(this.txt_imput.text),OR.requestExchange(57,this._num),zB.ins.showMsg(RP.n[1219],2)}else zB.ins.showMsg(RP.n[1220],1)},t.onDown=function(e){this._isDown=!0,this._max=gR.ins.fuwengaoji,G.timer.loop(120,this,this.loop,[e.target])},t.onOneKeyClicked=function(e){},t.onOver=function(e){this._isDown=!1,G.timer.clear(this,this.loop)},t.loop=function(e){switch(e){case this.btn_reduce:1<this._buyNum&&this.changeNum(this._buyNum-1);break;case this.btn_add:this._buyNum<this._max&&this.changeNum(this._buyNum+1)}},t.changeNum=function(e){this._buyNum=e,this._num=e,this.txt_imput.changeText(e+"")},e.NAME="ACTORHEJICANJUANVIEW",e}(j),U$=function(e){var l,c;function t(){this.data=null,this._tabBarData=null,this._currentSelectMainLevelTab=0,t.__super.call(this),this.data=[],this._tabBarData=[]}b(t,"modules.actor.views.heji.ActorHeJiExchangeView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.list_main.itemRender=kX,this.list_main.selectEnable=!0,this.list_detail.itemRender=SX,this.list_detail.spaceY=5,this.list_detail.vScrollBarSkin="",this.list_detail.repeatY=5},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_exchange.on("click",t,t.onExchangeTxtClicked),t.list_main.selectHandler=ql.create(t,t.onMainTypeTabSelect,null,!1),t.list_main.selectEnable=!0,t.btn_close.on("click",t,t.onCloseBtnClicked),t.updateView()},i.updateView=function(){var e,t,i,n=this;iR.instance.checkHasHeJiExchange(),n.data=[],n._tabBarData=[];for(var s=0;s<bs.count;s++){(e=new c).id=bs.MODEL.key(s),e.fuwenID=bs.MODEL.fuwenID(s),e.exchangeID=bs.MODEL.exchangeID(s),e.level=bs.MODEL.level(s);var o=n.data[e.level-1];if(1!=e.level){var a=iR.instance.getRuneResouseByGoodID(e.fuwenID);0==a.needFlyLevel&&gR.ins.lv>=a.needLevel?(null==o&&(o=[],n.data[e.level-1]=o),n.data[e.level-1].push(e)):0<a.needFlyLevel&&gR.ins.zsLv>=a.needFlyLevel&&(null==o&&(o=[],n.data[e.level-1]=o),n.data[e.level-1].push(e))}else null==o&&(o=[],n.data[e.level-1]=o),n.data[e.level-1].push(e)}for(var r=0;r<n.data.length;r++)t=new l,n._tabBarData.push(t),i=n.data[r][0],t.level=i.level,t.fuwenID=i.fuwenID,t.itemIndex=r,t.isSelected=r==n._currentSelectMainLevelTab,0==ua.getFuWenZhuan(i.fuwenID)?t.text=ua.getFuWenLevel(i.fuwenID)+"级":t.text=ua.getFuWenLevel(i.fuwenID)+"转";n.list_main.dataSource=n._tabBarData,n.list_main.selectedIndex=n._currentSelectMainLevelTab,n.list_detail.dataSource=n.data[n._currentSelectMainLevelTab],n.txt_low.text=gR.ins.fuwen.toString(),n.txt_high.text=gR.ins.fuwengaoji.toString()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.txt_exchange.on("click",this,this.onExchangeTxtClicked),this.btn_close.off("click",this,this.onCloseBtnClicked)},i.onExchangeTxtClicked=function(){hN.ins.isOpen("ACTORHEJICANJUANVIEW")||hN.ins.toggle("ACTORHEJICANJUANVIEW")},i.onCloseBtnClicked=function(e){hN.ins.isOpen("ActorHeJiExchangeView")&&hN.ins.close("ActorHeJiExchangeView")},i.onMainTypeTabSelect=function(e){this.updateSelect(),this.list_detail.dataSource=this.data[this._currentSelectMainLevelTab]},i.updateSelect=function(){var e=this,t=e._tabBarData[e._currentSelectMainLevelTab];t.isSelected=!1,e.list_main.setItem(e._currentSelectMainLevelTab,t),e._currentSelectMainLevelTab=e.list_main.selectedIndex,(t=e._tabBarData[e._currentSelectMainLevelTab]).isSelected=!0,e.list_main.setItem(e._currentSelectMainLevelTab,t)},t.NAME="ActorHeJiExchangeView",t.__init$=function(){l=function(){function e(){this.level=0,this.fuwenID=0,this.text=null,this.itemIndex=0,this.isSelected=!1}return b(e,""),e}(),c=function(){function e(){this.id=0,this.fuwenID=0,this.exchangeID=0,this.level=0}return b(e,""),e}()},t}(z),F$=function(e){function t(){this._activityColor="#e6d80d",this._normalColor="#90877b",this._$9__gray="#5f5952",this._fontSize=24,this._contentArr=[RP.n[1221],RP.n[1222],RP.n[1223]],this.arr=null,this._green="#23b11f",t.__super.call(this)}b(t,"modules.actor.views.heji.ActorHejiAllSuitTips",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.initUI()},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.updateView()},i.initUI=function(){this.lists.vScrollBarSkin="",this.lists.scrollBar.elasticBackTime=300,this.lists.scrollBar.elasticDistance=100,this.lists.itemRender=Xl,this.lists.renderHandler=ql.create(this,this.onListRender,null,!1)},i.initConfig=function(){},i.onListRender=function(e,t){var i=e;i.width=600,i.height=176,i.innerHTML=this.arr[t],i.leading=20},i.updateView=function(){var e,t=this;t.arr=[];for(var i=0;i<iR.instance.configVo.length;i++){e="";var n=iR.instance.configVo[i][0],s=n.level;0==ua.getFuWenZhuan(n.levelUpGoodsId)?e+=Ql.htmlText(ua.getFuWenLevel(n.levelUpGoodsId)+RP.n[1224],dr.font,t._fontSize,t._activityColor):e+=Ql.htmlText(ua.getFuWenLevel(n.levelUpGoodsId)+RP.n[1225],dr.font,t._fontSize,t._activityColor),e+=Ql.newline();for(var o=0;o<ua.HEJI_TAO_ZHUANG.length;o++){var a=iR.instance.checkLevelTao(s,ua.HEJI_TAO_ZHUANG[o]),r=0;switch(o){case 0:r=(iR.instance.getAttrFromCommonSuitByLevelAndNum(s,ua.HEJI_TAO_ZHUANG[o])+iR.instance.heJiSkillToPlayer)/100;break;case 1:r=(iR.instance.getAttrFromCommonSuitByLevelAndNum(s,ua.HEJI_TAO_ZHUANG[o])+iR.instance.heJiSkillToMonster)/100;break;case 2:r=iR.instance.getAttrFromCommonSuitByLevelAndNum(s,ua.HEJI_TAO_ZHUANG[o])/100}e+=a?Ql.htmlText(ua.HEJI_TAO_ZHUANG[o]+t._contentArr[o],dr.font,t._fontSize,t._normalColor)+Ql.htmlText(r+"%",dr.font,t._fontSize,t._green):Ql.htmlText(ua.HEJI_TAO_ZHUANG[o]+t._contentArr[o]+r+"%",dr.font,t._fontSize,t._$9__gray),e+=Ql.newline()}t.arr.push(e)}t.lists.array=t.arr},t.NAME="ActorHejiAllSuitTips",t}(Z),q$=function(e){function t(){this.NUM=9,this.EFF_ID="jm0001",this.gridList=[],this.txtList=[],this.selList=[],this._isReq=!1,this._time=0,t.__super.call(this)}b(t,"modules.actor.views.heji.ActorHeJiFenJieView",X);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onCloseBtnClicked),t.btn_fenJie.on("click",t,t.onFenJieBtnClicked),t.on("click",t,t.onGridClicked),t.update()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onCloseBtnClicked),t.btn_fenJie.off("click",t,t.onFenJieBtnClicked),t.on("click",t,t.onGridClicked)},i.onCloseBtnClicked=function(e){hN.ins.isOpen("ActorHeJiFenJie")&&hN.ins.close("ActorHeJiFenJie")},i.onGridClicked=function(e){if(e.target instanceof modules.backpack.views.grid.GoodsGrid){var t=e.target;_W.instance.showByType(t.bindData)}},i.update=function(){var e=this;if(e._isReq){e._isReq=!1;for(var t=0;t<e.selList.length;t++)kB.createEffect(e.EFF_ID,e["img_bg_"+t].x+53,e["img_bg_"+t].y+53,e)}e.selList=TR.ins.getFuWenFenJie(e.NUM);for(var i=0;i<9;i++){var n,s;if(i<e.selList.length){i<e.gridList.length?(n=e.gridList[i],s=e.txtList[i]):((n=new MF).x=e["img_bg_"+i].x,n.y=e["img_bg_"+i].y,e.addChild(n),e.gridList.push(n),s=kB.createText(n.x,n.y+116+6,116,0,"",20,"",!1,"center",!1,!1,e),e.addChild(s),e.txtList.push(s));var o=e.selList[i];n.visible=!0,n.bindData=o;var a=Bi.getIndex(o.goodsId);s.visible=!0,s.changeText(0<Bi.MODEL.flyLevel(a)?Bi.MODEL.flyLevel(a)+"转":"lv."+Bi.MODEL.minUseLevel(a)),s.color=ms.getByQuality(Bi.MODEL.colourId(a))}else i<e.gridList.length&&((n=e.gridList[i]).visible=!1,(s=e.txtList[i]).visible=!1)}},i.onFenJieBtnClicked=function(e){if(300<BB.getTimer()-this._time)if(this._time=BB.getTimer(),this.selList&&this.selList.length){var t,i=[];for(var n in this.selList)t=this.selList[n],i.push(t.uuId);OR.reqRecycle(i),this._isReq=!0,UB.ins.playSound("5",3,!0)}else zB.ins.showById(3539,1)},t.NAME="ActorHeJiFenJie",t}(),j$=function(e){function t(){this.defaultAttrAtr='[{"type":"MAXHP","value":0,"module":"COMBINE_ATTACK"},{"type":"ATK","value":0,"module":"COMBINE_ATTACK"},{"type":"DEF","value":0,"module":"COMBINE_ATTACK"},{"type":"MDEF","value":0,"module":"COMBINE_ATTACK"},{"type":"PVP_DAM_INC_RATE","value":0,"module":"COMBINE_ATTACK"},{"type":"ZHAN_SHI_DAM_INC","value":0,"module":"COMBINE_ATTACK"},{"type":"FA_SHI_DAM_INC","value":0,"module":"COMBINE_ATTACK"},{"type":"DAO_SHI_DAM_INC","value":0,"module":"COMBINE_ATTACK"},{"type":"PVP_DAM_DEC_RATE","value":0,"module":"COMBINE_ATTACK"},{"type":"ZHAN_SHI_DAM_DEC","value":0,"module":"COMBINE_ATTACK"},{"type":"FA_SHI_DAM_DEC","value":0,"module":"COMBINE_ATTACK"},{"type":"DAO_SHI_DAM_DEC","value":0,"module":"COMBINE_ATTACK"}]',this.allAttr=[],t.__super.call(this)}b(t,"modules.actor.views.heji.ActorHejiFuWeiTips",Q);var i=t.prototype;return i.onAdd=function(e){var t,i,n,s=this;ui.SubPanel.prototype.onAdd.call(s,e),s.txt_0.text=s.txt_1.text=s.txt_2.text=s.txt_3.text="",s.allAttr=[],i=aa.formatNewAttrToChinese(s.defaultAttrAtr,!1,!1);for(var o=0;o<i.length;o++)s.getZero(i[o]);for(var a in iR.instance.part)if(0<(n=iR.instance.part[a]).level){t=iR.instance.configVo[n.level-1][n.part-1],i=aa.formatNewAttrToChinese(t.attrs);for(var r=0;r<i.length;r++)s.setAttr(i[r])}for(var l=0;l<s.allAttr.length;l++){var c=aa.getAttributById(s.allAttr[l].id);if(l<4)s["txt_"+l].text=c.getModuleName("MODULE_COMBINE_ATTACK")+":"+s.allAttr[l].val;else{var u="";c.isPer&&(u="%"),s["txt_attr_"+(l-4)].innerHTML=Ql.createColor("["+c.getModuleName("MODULE_COMBINE_ATTACK")+"]"+c.desc+":","#90877b")+Ql.createColor(s.allAttr[l].val+u,"#23b11f")}}},i.getZero=function(e){this.allAttr.push(e)},i.setAttr=function(e){var t;for(var i in this.allAttr)if((t=this.allAttr[i]).id==e.id){var n=parseInt(t.val)+parseInt(e.val);t.val=n.toString()}},t.NAME="ActorHejiFuWeiTips",t}(),W$=function(e){function n(){this.skillIDArr=[501,502,503],this.normalColor="#90877b",this.greedColor="#23b11f",this._grid=null,n.__super.call(this)}b(n,"modules.actor.views.heji.ActorHejiSkillTips",K);var t=n.prototype;return t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);var i=sH.getUnionSkill(1),n=Vn.getIndex(i);t.skillName.text=Vn.MODEL.name(n),t._grid||(t._grid=new GF,t._grid.x=t.img.x,t._grid.y=t.img.y,t._grid.size(100,100),t.addChild(t._grid)),t._grid.bindData=i;var s=gR.ins.actorList[gR.ins.showId-1].job,o=(Vn.count,Vn.getIndex(t.skillIDArr[s-1]));t.skillName.text=Vn.MODEL.name(o);t.skillIDArr[s-1];t.desc.text=Vn.MODEL.desc(o),t.desc.leading=20,t.skill1.innerHTML=Ql.createColor(RP.n[1226],t.normalColor)+Ql.createColor(iR.instance.heJiSkillToPlayer/100+"%",t.greedColor),t.skill2.innerHTML=Ql.createColor(RP.n[1227],t.normalColor)+Ql.createColor(iR.instance.heJiSkillToMonster/100+"%",t.greedColor),t.updateSuitAttr()},t.updateSuitAttr=function(){for(var e=0;e<ua.HEJI_TAO_ZHUANG.length;e++){var t=iR.instance.getTaoZhuangLevel(ua.HEJI_TAO_ZHUANG[e]),i=0;i=0==t?0:iR.instance.getAttrFromCommonSuitByLevelAndNum(0==t?1:t,ua.HEJI_TAO_ZHUANG[e])/100,this["suitAttr"+(e+1)].innerHTML=Ql.createColor(n._contentArr[e],this.normalColor)+Ql.createColor("+"+i+"%",this.greedColor)}},n.NAME="ActorHejiSkillTips",f(n,["_contentArr",function(){return this._contentArr=[RP.n[1228],RP.n[1229],RP.n[1230]]}]),n}(),Y$=function(e){function t(){var e=this;e.longwenModel=null,e.longwenItemArr=[],e.g_suip=null,e.g_longyan=null,e.g_longyyi=null,e.g_jinghua=null,e.fenjieList=[],t.__super.call(e),e.longwenModel=lR.instance(),e.initUI()}b(t,"modules.actor.views.longwen.LongWenFenJieView",Dc);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_addChip.color="#23b11f",t.txt_addHunShi.color="#23b11f",t.txt_addSuiPian.color="#23b11f",t.txt_no.visible=!1,t.btnFenJie.on("click",t,t.onClickLongwenFenJieEvent),t.ckb_0.on("click",t,t.onClickCkbListener),t.ckb_1.on("click",t,t.onClickCkbListener),t.ckb_2.on("click",t,t.onClickCkbListener),t.ckb_3.on("click",t,t.onClickCkbListener),t.ckb_4.on("click",t,t.onClickCkbListener),t.updateByVSC(null)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnFenJie.off("click",t,t.onClickLongwenFenJieEvent),t.ckb_0.off("click",t,t.onClickCkbListener),t.ckb_1.off("click",t,t.onClickCkbListener),t.ckb_2.off("click",t,t.onClickCkbListener),t.ckb_3.off("click",t,t.onClickCkbListener),t.ckb_4.off("click",t,t.onClickCkbListener),t.ckb_0.selected=t.ckb_1.selected=t.ckb_2.selected=t.ckb_3.selected=t.ckb_4.selected=!1,t.txt_addChip.changeText(""),t.txt_addHunShi.changeText(""),t.txt_addSuiPian.changeText(""),t.clearSelected(),t.longwenModel.longwenChipNum=0,t.longwenModel.longwenSuiPianNum=0,t.longwenModel.longwenLyanNum=0,t.longwenModel.longwenLyiNum=0,t.clearItems()},i.showChipNum=function(){var e=this;0<e.longwenModel.longwenChipNum?e.txt_addChip.text="+"+e.longwenModel.longwenChipNum.toString():e.txt_addChip.text="",0<e.longwenModel.longwenSuiPianNum?e.txt_addSuiPian.text="+"+e.longwenModel.longwenSuiPianNum.toString():e.txt_addSuiPian.text="",0<e.longwenModel.longwenLyanNum?e.txt_addHunShi.text="+"+e.longwenModel.longwenLyanNum.toString():e.txt_addHunShi.text="",0<e.longwenModel.longwenLyiNum?e.txt_addly.text="+"+e.longwenModel.longwenLyiNum.toString():e.txt_addly.text=""},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.updateByVSC=function(e){var t=this,i=TR.ins.getBackPackLongWens();t.txt_no.visible=!(i&&0<i.length),t.doSortLongWen(i);var n=0;if(i&&0<i.length){var s;for(n=0;n<i.length;n++){t.longwenItemArr.length>n?s=t.longwenItemArr[n]:(s=new Uj,t.longwenItemArr.push(s)),null==s.parent&&t.longwenPanel.addChild(s),s.x=20+n%2*328,s.y=28+156*Math.floor(n/2),s.data=i[n];var o=Bi.getIndex(i[n].goodsId);1==Bi.MODEL.colourId(o)&&(s.selected=!0)}t.longwenItemArr.length,i.length}for(;n<t.longwenItemArr.length;n++)null!=t.longwenItemArr[n]&&null!=t.longwenItemArr[n].parent&&t.longwenItemArr[n].parent.removeChild(t.longwenItemArr[n]);t.longwenItemArr.length=i.length,t.txt_suipian.text=gR.ins.dragonsuipian.toString(),t.txt_jinghua.text=gR.ins.dragonJingHua.toString(),t.txt_hunshi.text=TR.ins.getGoodsNum(2636).toString(),t.txt_ly.text=TR.ins.getGoodsNum(2637).toString(),t.showSelectedItem(2,!0),t.ckb_4.selected=!0;var a=t.longwenModel.checkHasFenJie();t.btnFenJie.showTip=Object(a).isRedPoint,t.ckb_3.selected=a.isRedPoint&&a.isSelectedPurole,t.showSelectedItem(3,a.isRedPoint&&a.isSelectedPurole)},i.clearSelected=function(){var e=0;for(e=0;e<this.longwenItemArr.length;e++)1==this.longwenItemArr[e].selected&&(this.longwenItemArr[e].selected=!1)},i.doSortLongWen=function(e){e.sort(function(e,t){var i=e.cfgIdx,n=t.cfgIdx;if(Bi.MODEL.colourId(i)<Bi.MODEL.colourId(n))return 1;if(Bi.MODEL.colourId(i)!=Bi.MODEL.colourId(n))return-1;if(Bi.MODEL.key(i)<Bi.MODEL.key(n))return-1;if(Bi.MODEL.key(i)!=Bi.MODEL.key(n))return 1;var s=jt.MODEL.level(e.dragonIndex-1),o=jt.MODEL.level(t.dragonIndex-1);return s<o?1:s==o?0:-1})},i.onClickCkbListener=function(e){var t=this,i=0,n=!1;e.target==t.ckb_0?(i=6,n=t.ckb_0.selected):e.target==t.ckb_1?(i=5,n=t.ckb_1.selected):e.target==t.ckb_2?(i=4,n=t.ckb_2.selected):e.target==t.ckb_3?(i=3,n=t.ckb_3.selected):e.target==t.ckb_4&&(i=2,n=t.ckb_4.selected),t.showSelectedItem(i,n)},i.showSelectedItem=function(e,t){for(var i=0;i<this.longwenItemArr.length;i++){var n=this.longwenItemArr[i];if(n&&n._data){var s=Bi.getIndex(n._data.goodsId);Bi.MODEL.colourId(s)==e&&t!=n.selected&&(n.selected=t)}}},i.onClickLongwenFenJieEvent=function(e){for(var t=[],i=!1,n=0;n<this.longwenItemArr.length;n++){var s=this.longwenItemArr[n],o=0;if(s.selected)t.push(s._data.uuId),o=Bi.getIndex(s._data.goodsId),4<=Bi.MODEL.colourId(o)&&(i=!0)}if(this.fenjieList=t,1==i){var a=RP.n[1231];KQ.ins.show(a,ql.create(this,this.onAlertHandler),!1)}else t.length<=0?zB.ins.playErrorMsg(RP.n[1232]):this.longwenModel.sendToFenJie(t);UB.ins.playSound("5")},i.onAlertHandler=function(e){1==e&&this.longwenModel.sendToFenJie(this.fenjieList)},i.clearItems=function(){for(var e=0;e<this.longwenItemArr.length;e++)null!=this.longwenItemArr[e].parent&&this.longwenItemArr[e].parent.removeChild(this.longwenItemArr[e]);this.longwenItemArr.length=0},i.initUI=function(){var e=this;e.longwenPanel.vScrollBarSkin="",e.longwenPanel.vScrollBar.elasticDistance=300,e.g_suip=new AF(45),e.g_suip.needGridBg=!1,e.g_suip.pos(34,47),e.box.addChild(e.g_suip),e.g_suip.bindData=2524,e.g_suip.cacheAs="bitmap",e.g_jinghua=new AF(45),e.g_jinghua.needGridBg=!1,e.g_jinghua.pos(155,47),e.box.addChild(e.g_jinghua),e.g_jinghua.bindData=2526,e.g_jinghua.cacheAs="bitmap",e.g_longyan=new AF(45),e.g_longyan.needGridBg=!1,e.g_longyan.pos(271,47),e.box.addChild(e.g_longyan),e.g_longyan.bindData=2636,e.g_longyan.cacheAs="bitmap",e.g_longyyi=new AF(45),e.g_longyyi.needGridBg=!1,e.g_longyyi.pos(377,47),e.box.addChild(e.g_longyyi),e.g_longyyi.bindData=2637,e.g_longyyi.cacheAs="bitmap"},t}(),z$=function(e){function t(){var e=this;e._selector=null,e.longwenArr=null,e.longwenModel=null,e.selectedLongwenIndex=-1,e.longwenToInnerArr=[],e.roleIndex=0,e._icon=null,e.hasTools=!1,e.imgJingHua=null,e.selectedLongwenGrid=null,t.__super.call(e),e.longwenModel=lR.instance(),e.centerY=e.centerX=0,e.txt_com.fontSize=24,e.initUI()}b(t,"modules.actor.views.longwen.LongWenMainView",Rc);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.imgAttr.on("click",t,t.onClickEvent),t.btnXiangXi.on("click",t,t.onClickEvent),t.btnChange.on("click",t,t.onClickEvent),t.btnTongTianTa.on("click",t,t.onClickEvent),t.btnUp.on("click",t,t.onClickEvent),t.btnXunBao.on("click",t,t.onClickEvent),t.txt_com.on("click",t,t.onClickCom),t.longwenModel.roleIndex=t._selector.selectIdx+1,t.updateByVSC(null);var i=new VA;Tu.sendToService(i),t.imgAttrD.on("click",t,t.onClickEvent)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.imgAttr.off("click",t,t.onClickEvent),t.btnXiangXi.off("click",t,t.onClickEvent),t.btnChange.off("click",t,t.onClickEvent),t.btnTongTianTa.off("click",t,t.onClickEvent),t.btnUp.off("click",t,t.onClickEvent),t.btnXunBao.off("click",t,t.onClickEvent),t.imgAttrD.off("click",t,t.onClickEvent),t.txt_com.off("click",t,t.onClickCom),t.selectedLongwenIndex=-1,t.longwenModel.roleIndex=0,null!=t.selectedLongwenGrid&&(t.selectedLongwenGrid.clearFilter(),t.selectedLongwenGrid=null)},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.showFight=function(){var e=this.longwenModel.getAllFightNumForJob(this._selector.selectIdx),t=RR.getFight(e,this._selector.selectIdx+1);this.fightNum.value=t+this.longwenModel.longwenConfigFight+AR.ins.getSoaringLongWen(this._selector.selectIdx+1)+this.longwenModel.longwenConfigJFight},i.updateByVSC=function(e){var t=this;if(t.longwenModel.getRedPoint(),t.longwenModel.roleIndex=t._selector.selectIdx+1,t.imgRed_change.visible=!1,t.imgRed_up.visible=!1,t.setOpenLongwen(),t.updateEquips(),t.updateLongWenInfo(),t.updateLongWenAttr(),t.longwenModel.longwenOpenList.length<8){var i=t.longwenModel.getkeyByLongwenPart(52+t.longwenModel.longwenOpenList.length),n=Wt.MODEL.conditionDef(i);JSON.parse(n);t.txtTongGuanGet.text=Wt.MODEL.conditionDeftip(i).replace("通关",""),t.txtTongGuanGet.x=t.longwenArr[t.longwenModel.longwenOpenList.length].x-125,t.txtTongGuanGet.y=t.longwenArr[t.longwenModel.longwenOpenList.length].y+108,t.txtTongGuanGet.on("click",t,t.onClickOpenLongWenListener)}else t.txtTongGuanGet.off("click",t,t.onClickOpenLongWenListener),t.txtTongGuanGet.text="";t.showLongWenMainViewRedPoint(),t.showFight(),t.setChildIndex(t.txtTongGuanGet,t.numChildren-1)},i.showLongWenMainViewRedPoint=function(){for(var e=this,t=0;t<3;t++)if(null!=e._selector._items[t]&&gR.ins.actorList.length>t&&null!=gR.ins.actorById(t+1)&&(0!=e.longwenModel.hasLongwenInnerArr[t]?e._selector.setRedPtByIdx(t,e.longwenModel.hasLongwenInnerArr[t]):0!=e.longwenModel.hasLongwenUpArr[t]?e._selector.setRedPtByIdx(t,e.longwenModel.hasLongwenUpArr[t]):e._selector.setRedPtByIdx(t,e.longwenModel.hasLongwenChangeArr[t])),e.roleIndex-1==t&&null!=gR.ins.actorById(t+1)&&e.selectedLongwenGrid&&e.selectedLongwenGrid._data){var i=e.selectedLongwenGrid._data;0==jt.MODEL.nextId(i.dragonIndex-1)&&(e.imgRed_up.visible=!1)}},i.onClickOpenLongWenListener=function(e){qR.ins.isOpenCopy?hN.ins.open("COPYMAINVIEW",{selectedIndex:2},0):zB.ins.showMsg(RP.n[549],1)},i.updateLongWenInfo=function(){var e=this;if(null!=gR.ins.actorById(e._selector.selectIdx+1))if(0<e.longwenToInnerArr.length){if(e.setAttrIsShow(!0),-1==e.selectedLongwenIndex){e.doSortLongWen(e.longwenToInnerArr);var t=e.gethasUpLongWen();null!=t&&t||(t=e.longwenToInnerArr[0]),e.selectedLongwenGrid=t,null!=e.selectedLongwenGrid&&e.selectedLongwenGrid.setFilter(),e.selectedLongwenIndex=parseInt(e.selectedLongwenGrid.name.split("_")[1])+52}}else e.setAttrIsShow(!1);else e.setAttrIsShow(!1);if(e.selectedLongwenGrid&&e.selectedLongwenGrid._data){var i,n=e.selectedLongwenGrid._data;e.txtName.text="",e.txtName.x=295;var s=Bi.getIndex(n.goodsId),o=Bi.MODEL.name(s);o+=" Lv."+jt.MODEL.level(n.dragonIndex-1),e.txtName.text=o,e.txtName.color=ms.getDragonColorByQuality(Bi.MODEL.colourId(s)),e._icon.bindData=n.goodsId;var a=jt.MODEL.attrs(n.dragonIndex-1);i=aa.formatAttrToChineseByList(a),e.drawText(295,60,i,"#90877b","#90877b",!0);var r,l=[];r=jt.MODEL.attrs(n.dragonIndex);var c=jt.MODEL.nextId(n.dragonIndex-1),u=c.toString();0!=(c="0"!=u?parseInt(u.substr(6,u.length-6)):0)&&(l=aa.formatAttrToChineseByList(r),e.drawText(670,60,l,"#23b11f","#23b11f",!1,!1));jt.MODEL.level(n.dragonIndex-1);if(0==c?(e.btnUp.label="已满级",e.imgFull.visible=e.imgArrow.visible=!1,e.drawText(295,50,i,"#90877b","#23b11f",!0),e.imgRed_up.visible=!1,e.txtHas.visible=!1,e.imgJingHua.visible=!1):(e.btnUp.label="升 级",e.imgFull.visible=e.imgArrow.visible=!0,e.imgArrow.x=593,e.txtHas.visible=!0,e.imgJingHua.visible=!0,e.imgRed_up.visible=e.longwenModel.checkHasUpDragon2(n)),0<n.dragonIndex){var d="",h=jt.MODEL.consumeDef(n.dragonIndex-1),_=JSON.parse(h);if(null!=_)var f=parseInt(_[0].value.split(":")[1]);f<=gR.ins.dragonJingHua?(d="#23b11f",e.hasTools=!0):(d="#ff2e24",e.hasTools=!1),e.txtHas.innerHTML=Ql.createColor(gR.ins.dragonJingHua.toString(),d)+"/"+f,e.imgRed_up.visible=0!=c&&e.hasTools}e.imgRed_change.visible=e.longwenModel.checkHasChange(n,e._selector.selectIdx+1)}else e.imgRed_change.visible=!1,e.txtHas.innerHTML=Ql.createColor("0","#ff2e24")+"/0",e.imgRed_up.visible=!1},i.doSortLongWen=function(e){e.sort(function(e,t){var i=e._data.cfgIdx,n=t._data.cfgIdx,s=jt.MODEL.level(e._data.dragonIndex-1),o=jt.MODEL.level(t._data.dragonIndex-1);return s<o?-1:s!=o?1:Bi.MODEL.colourId(i)<Bi.MODEL.colourId(n)?1:Bi.MODEL.colourId(i)==Bi.MODEL.colourId(n)?e._data.goodsId<t._data.goodsId?-1:e._data.goodsId==t._data.goodsId?0:1:void 0})},i.gethasUpLongWen=function(){var e=0,t=null;for(e=0;e<this.longwenToInnerArr.length;e++){var i=this.longwenToInnerArr[e]._data;if(1==this.longwenModel.checkHasUpDragon2(i)){t=this.longwenToInnerArr[e];break}}return t},i.drawText=function(e,t,i,n,s,o,a){var r;void 0===o&&(o=!1),void 0===a&&(a=!0),o&&this.boxAttr.graphics.clear();for(var l=0;l<i.length;l++){r=i[l];var c="";a?(c=aa.getAttributById(r.id).getModuleNameWithNoSpace(r.module)+"+",this.boxAttr.graphics.fillText(c,e,t,"24px SimHei",n,"left")):(c=" +",this.boxAttr.graphics.fillText(" +",e,t,"24px SimHei",n,"left"));var u=e+(24*mp.getStringLength(c)>>1)+4;this.boxAttr.graphics.fillText(r.val+"",u,t,"24px SimHei",s,"left"),t+=30}},i.setOpenLongwen=function(){for(var e=this.longwenModel.longwenOpenList.length,t=0;t<this.longwenArr.length;t++)this.longwenArr[t].lock=!(t<e)},i.updateEquips=function(){var e=this;e.btnXiangXi.visible=!1,e.longwenToInnerArr=[];for(var t=e._selector.selectIdx+1,i=0;i<8;i++){var n=MR.ins.getEquip(t,52+i);n?(e.longwenArr[i].isChangeDragon=e.longwenModel.checkHasChange(n,t),e.longwenArr[i].data={index:n.position,vo:n},e.longwenToInnerArr.push(e.longwenArr[i]),e.btnXiangXi.visible=!0):(e.longwenArr[i].data={index:52+i,vo:null},e.longwenArr[i].isChangeDragon=!1)}},i.updateLongWenAttr=function(){},i.onClickCom=function(e){var t=parseInt($e.MODEL.value($e.getIndex(312)));t<=gR.ins.lv?Tu.sendToModule("OPTION_RUN",["modules.task.TaskModule"],"2|BAGPACK|3|83|合成"):zB.ins.showMsg(RP.n[1234]+t+"级开启",1)},i.onClickEvent=function(e){var t=this;if(e.target==t.imgAttr)Tu.sendToModule("LONGWEN_YULAN_PANEL",["modules.actor.ActorModule"],{type:1});else if(e.target==t.btnXiangXi){var i=new Object;i.career=t._selector.selectIdx,Vj.instance.show(i)}else if(e.target==t.btnChange)Tu.sendToModule("LONGWEN_CHANGE_PANEL",["modules.actor.ActorModule"],t.selectedLongwenIndex),UB.ins.playSound("4");else if(e.target==t.btnTongTianTa)qR.ins.isOpenCopy?hN.ins.open("COPYMAINVIEW",{selectedIndex:2},0):zB.ins.showMsg(RP.n[549],1);else if(e.target==t.btnUp){if(t.hasTools){if("已满级"==t.btnUp.label)return void zB.ins.playErrorMsg(RP.n[1236]);t.selectedLongwenGrid&&t.selectedLongwenGrid._data&&t.longwenModel.sendToUp(t.selectedLongwenGrid._data.uuId)}else zB.ins.playErrorMsg(RP.n[1237]);UB.ins.playSound("4")}else e.target==t.btnXunBao?Tu.sendToModule("TR_OPEN",["modules.treasure.TreasureModule"],{_subIndex_:1}):e.target==t.imgAttrD&&Tu.sendToModule("LONGWEN_YULAN_PANEL",["modules.actor.ActorModule"],{type:2})},i.onClickLongwenGridEvent=function(e){var t=this,i=parseInt(e.target.name.split("_")[1]);e.target.lock||(t.selectedLongwenIndex=i+52,null!=t.selectedLongwenGrid&&t.selectedLongwenGrid.clearFilter(),t.selectedLongwenGrid=e.target,t.selectedLongwenGrid.setFilter(),null!=e.target._data?t.updateLongWenInfo():0<t.longwenToInnerArr.length&&(t.img_BG.visible=t.boxHave.visible=t.boxUp.visible=t.boxAttr.visible=!1))},i.getSelectedLongWenIndex=function(){var e=0;for(e=this.selectedLongwenIndex=0;e<this.longwenArr.length;e++);},i.onSelectRole=function(){this._selector.selectIdx+1!=this.roleIndex&&(null!=this.selectedLongwenGrid&&(this.selectedLongwenGrid.clearFilter(),this.selectedLongwenGrid=null),this.selectedLongwenIndex=-1,this.roleIndex=this._selector.selectIdx+1,this.updateByVSC(null))},i.initUI=function(){var e,t=this;t.img_bg.skin=_r.getFullUrl("ui/images/longwen/lw_jm_bg.jpg"),t._selector=new Nj,t.addChild(t._selector),t._selector.on("select",t,t.onSelectRole),t.img_BG.visible=!1,t.boxAttr.visible=!1,t.boxUp.visible=!1,t.boxHave.visible=!1,t.txtHas.align="center",t.longwenArr=[];for(var i=0;i<8;i++)(e=new qj).name="longwenGrid_"+i,t.longwenArr.push(e),t.addChild(e),e.x=Mc.LOGNWEN_POINT[i].x,e.y=Mc.LOGNWEN_POINT[i].y,e.on("click",t,t.onClickLongwenGridEvent);t._icon=new AF,t._icon.pos(180,25),t._icon.needGridBg=!1,t.boxAttr.addChild(t._icon),t.imgJingHua=new AF(50),t.imgJingHua.needGridBg=!1,t.imgJingHua.pos(265,-10),t.boxUp.addChild(t.imgJingHua),t.imgJingHua.bindData=2526,t.img_bg.cacheAs="bitmap",t.imgAttr.cacheAs="bitmap",t.imgArrow.cacheAs="bitmap"},i.setLine=function(e){var t=0;for(t=0;t<7;t++)this["clip_"+t].index=t<e?1:0},i.setAttrIsShow=function(e){var t=this;t.img_BG.visible=t.boxAttr.visible=e,t.boxUp.visible=e,t.boxHave.visible=!e,1==t.boxHave.visible&&(t.txt_com.x=415,t.txt_com.y=1090),1==t.boxUp.visible&&(t.txt_com.x=427,t.txt_com.y=1121)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t}(),X$=function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.lunhui.LunhuiExchangeView",ar);var i=t.prototype;return i.initialize=function(){this.list_zs.itemRender=zj,this.list_zs.spaceY=20,this.list_zs.vScrollBarSkin=""},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.close),this.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.close),LY.showing&&LY.Ins().closeArrow()},i.update=function(){this.list_zs.array=[0,1,2]},t}(),Q$=function(e){function t(){this._eff=null,t.__super.call(this)}b(t,"modules.actor.views.lunhui.LunhuiRemindTip",zc);var i=t.prototype;return i.initialize=function(){this.centerX=this.centerY=0,this.btnClick.mouseEnabled=!1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._eff=kB.createEffect("jm1130",t.btn_use.width>>1,t.btn_use.height>>1,t.btn_use),t._eff.scale_X=1.2,t._eff.scale_Y=1.2,t.img_icon.skin=_r.getFullUrl("ui/images/noclear/xt_lhkq_lh.png")},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&this._eff.dispose(),this._eff=null},i.onClick=function(e){switch(e.target){case this.btn_use:Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:3});case this.btn_close:hN.ins.close("LunhuiRemindTip")}},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),this.img_icon&&this.img_icon.skin&&G.loader.clearRes(this.img_icon.skin)},t.NAME="LunhuiRemindTip",t}(),J$=function(e){function t(){this.g_cost=null,this.selectedUIDs=null,this.selectedDtos=null,this.selectedIdxs=null,this.count=NaN,t.__super.call(this)}b(t,"modules.actor.views.mo.MoBreakView",Vu);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.list_main.itemRender=Lj,e.list_main.spaceX=12,e.list_main.spaceY=8,e.list_main.repeatX=5,e.list_main.vScrollBarSkin="",e.list_main.mouseHandler=ql.create(e,e.onSelect,null,!1),e.g_cost=new MF(45),e.g_cost.needGridBg=!1,e.g_cost.needEffect=!1,e.g_cost.pos(60,-9),e.box_reward.addChild(e.g_cost);var t=yB.create(400001);e.g_cost.bindData=t,e.reset()},i.reset=function(){this.selectedDtos=[],this.selectedUIDs=[],this.selectedIdxs=[],this.count=0,this.txt_num.text="x0",this.btn_break.disabled=!0},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.g_mask.visible=!1,this.btn_break.on("click",this,this.breakEquips)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_break.off("click",this,this.breakEquips)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){e instanceof protos.actor.toc_30627&&this.reset();var t=_R.ins.getBreakEquips();(t=this.generateDatas(t)).sort(this.sortFunc),this.list_main.array=t,this.txt_no.visible=t.length<=0},i.generateDatas=function(e){for(var t=[],i=0;i<e.length;i++)t.push({dto:e[i],selected:!1});return t},i.setSelected=function(){for(var e=0;e<this.selectedIdxs.length;e++){var t=this.list_main.getCell(e);t&&(t.selected=!1)}},i.showByVSC=function(e,t){this.reset(),this.updateByVSC(t)},i.hideByVSC=function(e,t){},i.onScrollChanged=function(){},i.onScrollEnd=function(){this.list_main.scrollBar.value==this.list_main.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onSelect=function(e,t,i){var n=this;if(void 0===i&&(i=!0),"click"!=e.type)return!1;var s=n.list_main.getCell(t);if(!s)return!1;s&&(s.selected=!s.selected);var o=n.list_main.getItem(t),a=n.selectedUIDs.indexOf(s.uuid),r=_R.ins.getBreakRewardCount([s.dto]);return s&&s.selected&&-1==a&&(n.selectedUIDs.push(s.uuid),n.selectedDtos.push(s.dto),n.selectedIdxs.push(t),o.selected=!0,n.count+=r),s&&!s.selected&&-1!=a&&(n.selectedUIDs.splice(a,1),n.selectedDtos.splice(a,1),n.selectedIdxs.splice(a,1),o.selected=!1,n.count-=r),n.btn_break.disabled=n.selectedUIDs.length<=0,n.txt_num.text="x"+n.count,!(n.box_reward.centerX=0)},i.breakEquips=function(e){_R.ins.reqBreak(this.selectedUIDs)},i.clearList=function(){var e=this.list_main.array;if(e)for(var t=0;t<e.length;t++){var i=this.list_main.getCell(t);i&&(i.selected=!1)}},i.sortFunc=function(e,t){return t.dto.moEquipScore-e.dto.moEquipScore},t}(),Z$=function(e){function t(){this._eff=null,t.__super.call(this)}b(t,"modules.actor.views.tips.ActorActRemindTip",H);var i=t.prototype;return i.initialize=function(){this.txtDesc.text=RP.n[1238],this.txtDesc.color="#ffb11a",this.centerX=this.centerY=0,this.img_icon.top=85,this.btn_use.bottom=26,this.btnClick.mouseEnabled=!1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._eff=kB.createEffect("jm1130",t.btn_use.width>>1,t.btn_use.height>>1,t.btn_use),t._eff.scale_X=1.2,t._eff.scale_Y=1.2,t.img_icon.skin=_r.getFullUrl("ui/images/noclear/xt_jskq_tx.png")},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&this._eff.dispose(),this._eff=null},i.onClick=function(e){switch(e.target){case this.btn_use:Tu.sendToModule("OPEN_ACTIVE",["modules.actor.ActorModule"]);case this.btn_close:hN.ins.close("ActorActRemindTip")}},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),this.img_icon&&this.img_icon.skin&&G.loader.clearRes(this.img_icon.skin)},t.NAME="ActorActRemindTip",t}(),K$=function(e){function u(){var e=this;e._selector=null,e.hash=null,e.avatar=null,e.avatarW=null,e._effMabi=null,e._effHushen=null,e._effShenli=null,e._effFuhuo=null,e.gridexIndex=[1,2,5,3,8,7,6,4],e._grid51=null,u.__super.call(e),e.title=_r.getAtlasSubPath("other/js_bt_js.png"),e._selector=new Nj(pR.ins.actorList),e.box_p.addChild(e._selector),e.hash=new jl;for(var t=0;t<F.ACTOR_PARTS.length;t++){var i,n=F.ACTOR_PARTS[t],s=e["p"+n];-1!=la.MEDAL_TJ.indexOf(n)?((i=new RF(!1)).showDefault=!1,i.showTxt=!0):i=new MF,i.pos(s.x,s.y),e.box_p.addChild(i);var o=kB.createText(s.x,s.y+116+2,116,0,la.getName(n),20,"#6c6250",!1,"center",!1,!1,e);e.box_p.addChild(o),e.hash.put(n,{g:i,t:o,b:s}),la.isNormal(n)||s.on("click",e,e.onTip,[n])}for(var a=G.loader.getRes(_r.getAtlasSubPath("base_ui2/ty_bjzs_zz2.png")),r=new pp,l=new pp,c=0;c<944;)944-c>=a.height?(r.graphics.drawTexture(a,0,c,a.width,c),l.graphics.drawTexture(a,0,c,a.width,c),c+=a.height):(r.graphics.drawTexture(a,0,c,a.width,944-c),l.graphics.drawTexture(a,0,c,a.width,944-c),c+=944-c);l.pos(0,e.img_right.height),r.pos(0,e.img_left.height),e.img_left.addChild(r),e.img_right.addChild(l),e.p14.visible=!0,e.p15.visible=!0,e.p17.visible=!1,e.p18.visible=!1,e.avatar=new CF,e.avatar.pos(-340,344),e.box_p.addChild(e.avatar),e.avatarW=new CF,e.avatarW.pos(e.avatar.x,e.avatar.y),e.box_p.addChildAt(e.avatarW,2),e.btn_info.visible=!1}b(u,"modules.actor.views.other.OtherEquipView",xh);var t=u.prototype;return t.onTip=function(e){this.hash.take(e).g.isActive},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t._selector.off("select",t,t.onSelect),t._effMabi&&(t._effMabi.removeSelf(),t._effMabi.dispose(),t._effMabi=null),t._effHushen&&(t._effHushen.removeSelf(),t._effHushen.dispose(),t._effHushen=null),t._effFuhuo&&(t._effFuhuo.removeSelf(),t._effFuhuo.dispose(),t._effFuhuo=null),t._effShenli&&(t._effShenli.removeSelf(),t._effShenli.dispose(),t._effShenli=null),t.p13.off("click",t,t.onClickMabiHushen),t.p16.off("click",t,t.onClickMabiHushen)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._selector.refresh(),t._selector.selectIdx=pR.ins.index,t._selector.on("select",t,t.onSelect),t.txt_name.changeText(pR.ins.charName);var i="";0<pR.ins.zsLv&&(i+=pR.ins.zsLv+"转"),i+=pR.ins.lv+"级",t.txt_level.changeText(i),pR.ins.guildName?t.txt_guild_name.changeText(pR.ins.guildName):t.txt_guild_name.changeText("无"),null==t._effMabi&&(t._effMabi=kB.createEffect("jm1154",t.p13.width/2,t.p13.height/2+10,t.p13)),null==t._effHushen&&(t._effHushen=kB.createEffect("jm1155",t.p16.width/2,t.p16.height/2+10,t.p16)),t._effFuhuo||(t._effFuhuo=kB.createEffect("jm1322",t.p15.width/2,t.p15.height/2+10,t.p15)),t._effShenli||(t._effShenli=kB.createEffect("jm1321",t.p14.width/2,t.p14.height/2+10,t.p14)),t.update(),t.p13.on("click",t,t.onClickMabiHushen),t.p16.on("click",t,t.onClickMabiHushen)},t.destroy=function(e){void 0===e&&(e=!0),this.p_in_1.dispose(),this.p_in_2.dispose(),this.p_in_3.dispose(),this.p_in_4.dispose(),this.p_in_5.dispose(),this.p_in_6.dispose(),this.p_in_7.dispose(),this.p_in_8.dispose(),ui.SubPanel.prototype.destroy.call(this,e)},t.onClickMabiHushen=function(e){},t.onSelect=function(e){pR.ins.index=this._selector.selectIdx,this.update()},t.onClick=function(e){e.target,this.btn_info},t.update=function(){this.callLater(this.doUpdate)},t.doUpdate=function(){var e=this,t=e._selector.selectIdx,i=pR.ins.actorById(t);e.fight_item.value=i.force,e.mcHead.skin=_r.getActorHeadPath(i.job,i.sex),e.updateRings(),e.txt_jie.visible=e.img_p51BG.visible=!1,e.txt_DJ.x=497,e.txt_level.x=568,e.p51_2.visible=!1;for(var n=0;n<F.ACTOR_PARTS.length;n++){var s=F.ACTOR_PARTS[n],o=e.hash.take(s),a=o.g,r=o.t,l=e["p_in_"+e.gridexIndex[n]];if(-1!=la.MEDAL_TJ.indexOf(s));else{var c=F.getLinkToRexue(s),u=i.equips.getPart(c);if(u||(u=i.equips.getPart(s)),u){if(a.visible=!0,a.bindData=u,l&&(l.visible=!1),51==s){null==e._grid51&&(e._grid51=new MF,e._grid51.needGridBg=!1,e._grid51.needEffect=!1,e.p51_2.addChild(e._grid51)),e._grid51.bindData=u;var d=Bi.getIndex(u.goodsId),h=Bi.MODEL.simpleName(d);e.txt_jie.changeText(h),e.txt_jie.visible=e.img_p51BG.visible=!0,e.txt_DJ.x=384,e.txt_level.x=451,e.p51_2.visible=!0}}else a.visible=!1,l&&(l.visible=!0);e.setPartName(r,u,s)}}e.avatar.changeAvatar(i.sex,i.wid,i.mid,null,i.weaponSoulId),e.avatarW.changeAvatar(-1,null,null,i.wgid,null)},t.updateRings=function(){var e=this;e._effMabi&&(e._effMabi.filters=null),e._effHushen&&(e._effHushen.filters=null),e._effFuhuo&&(e._effFuhuo.filters=null),e._effShenli&&(e._effShenli.filters=null);var t=e._selector.selectIdx,i=pR.ins.actorById(t);i.job;0==i.mbAdvCfgId&&e._effMabi&&Pg.gray(e._effMabi,!0),0==i.hsAdvCfgId&&e._effHushen&&Pg.gray(e._effHushen,!0),0==i.fuhuoRingLv&&e._effFuhuo&&Pg.gray(e._effFuhuo,!0),0==i.shenliRingLv&&e._effShenli&&Pg.gray(e._effShenli,!0)},t.setPartName=function(e,t,i){t?(e.changeText(F.getLevel(t.goodsId)),e.color=ms.getByQuality(Bi.MODEL.colourId(t.cfgIdx))):(e.changeText(la.getName(i)),e.color="#6c6250")},u}(),$$=function(e){function n(){var e,t=this;t.EMPTY=[0,0,0,0,0,0,0,0],t._selector=null,t.attr_sin=null,t.attr_dou1=null,t.attr_dou2=null,t._equipHash=null,t._equipIndex=0,t._isActive=!1,t.prePro=null,t.standPro=null,t.curLvl=0,t.nextLvl=0,t.standLvl=0,t.curPro=null,t.nextPro=null,t._equipAvatar=null,n.__super.call(t),t.title=_r.getAtlasSubPath("actor_other/inheritance_word_title.png"),t._selector=new Nj(pR.ins.actorList),t.addChild(t._selector),t.hdv_name.style.font="SimHei",t.hdv_name.style.fontFamily="SimHei",t.hdv_name.style.fontSize=26,t.hdv_name.style.align="center",t.hdv_name.style.color="#ffff41",t._equipHash=new jl;for(var i=0;i<8;i++)(e=new rq).select=!1,e.position=i,e.level=0,e.x=t["grid"+i].x,e.y=t["grid"+i].y,e.on("click",t,t.onClickHandler,[i]),t.addChild(e),t._equipHash.put(i,e)}b(n,"modules.actor.views.other.OtherPsView",kh);var t=n.prototype;return t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this._selector.off("select",this,this.roleChangeHandler),this.btn_tip.off("click",this,this.onMouseTap)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._selector.refresh(),t._selector.selectIdx=pR.ins.index,t._selector.on("select",t,t.roleChangeHandler),t.btn_tip.on("click",t,t.onMouseTap),t.update()},t.update=function(){var e=this._selector.selectIdx+1,t=pR.ins.passHash.take(e);t||(t=this.EMPTY);var i,n=0,s=0;for(n=0;n<8;n++)s=t[n],this._equipHash.take(n).level=s,""!=(i=RN.ins.getEquipNameByPosAndLvl(n,s))&&(this["label"+n].text=i);this.onClickHandler(0)},t.onClickHandler=function(e,t){for(var i=0;i<8;i++)this._equipHash.take(i).select=i==e;this._equipIndex=e,this.hdv_name.innerHTML=this["label"+this._equipIndex].text,this.updateEquipPro(),this.updateAvatar()},t.roleChangeHandler=function(){pR.ins.index=this._selector.selectIdx,this.update()},t.onMouseTap=function(e){var t=this._selector.selectIdx+1;pR.ins.passHash.take(t)},t.updateEquipPro=function(){var e=this._equipHash.take(this._equipIndex).level,t=RN.ins.getProHash(this._equipIndex,e),i=t.cur,n=t.next;""==i||null==i?(this.updateSingle(n),this._isActive=!1):(""==n||null==n?this.updateSingle(i):this.updateDouble(i,n),this._isActive=!0),this.caculateFightValue()},t.caculateFightValue=function(){var e,t=0,i=0,n=0;for(n=i=0;n<8;n++)t=this._equipHash.take(n).level,""!=(e=RN.ins.getProHash(n,t).cur)&&(i+=RR.calFightingValue(e));i+=this.calTalValue(),this.fight_item.value=i},t.calTalValue=function(){var e=this,t=0,i=0,n=0,s=0,o=!1,a=0,r=e._selector.selectIdx+1,l=pR.ins.passHash.take(r);if(!l)return 0;if(0<l.length){var c=l[n=0],u=l[1];a=u<c?u:c;var d=RN.ins.getCurSuitPro(1,a);for(e.prePro=d.cur,e.nextPro=d.next,e.curLvl=d.curLvl,e.nextLvl=d.nextLvl,e.standLvl=""==e.prePro?e.nextLvl:e.curLvl,e.standPro=""==e.prePro?e.nextPro:e.prePro,i=0;i<2;i++)l[i]>=e.standLvl&&++n;for(o=2<=n,e.prePro=d.cur,e.nextPro=d.next,e.curLvl=d.curLvl,e.nextLvl=d.nextLvl,e.standLvl=""==e.prePro?e.nextLvl:e.curLvl,e.standPro=""==e.prePro?e.nextPro:e.prePro,o&&""!=e.standPro&&(t+=RR.calFightingValue(e.standPro)),a=100,i=2;i<8;i++)l[i]<a&&(a=l[i]);for(d=RN.ins.getCurSuitPro(2,a),e.prePro=d.cur,e.nextPro=d.next,e.curLvl=d.curLvl,e.nextLvl=d.nextLvl,e.standLvl=""==e.prePro?e.nextLvl:e.curLvl,e.standPro=""==e.prePro?e.nextPro:e.prePro,i=2;i<8;i++)l[i]>=e.standLvl&&++n;for((o=6<=n)&&""!=e.standPro&&(t+=RR.calFightingValue(e.standPro)),a=100,i=0;i<8;i++)l[i]<a&&(a=l[i]);d=RN.ins.getCurSuitPro(3,a),e.prePro=d.cur,e.nextPro=d.next,e.curLvl=d.curLvl,e.nextLvl=d.nextLvl;RN.ins.getCurSuitPro(1,a),RN.ins.getCurSuitPro(2,a);for(e.standLvl=""==e.prePro?e.nextLvl:e.curLvl,e.standPro=""==e.prePro?e.nextPro:e.prePro,i=0;i<2;i++)l[i]>=e.standLvl&&++n;for(i=2;i<8;i++)l[i]>=e.standLvl&&++s;var h=0;2<=n&&h++,6<=s&&h++,(o=2<=h)&&""!=e.standPro&&(t+=RR.calFightingValue(e.standPro))}return t},t.updateSingle=function(e,t){var i=this;void 0===t&&(t=!1),i.attr_dou1&&(i.attr_dou1.visible=!1,i.attr_dou2.visible=!1),i.attr_sin||(i.attr_sin=new dt,i.attr_sin.pos(400,853),i.addChild(i.attr_sin)),i.attr_sin.visible=!0,i.showAttr(i.attr_sin,e,"#e3dcc2",t),i.mc_next.visible=!1},t.updateDouble=function(e,t,i){var n=this;void 0===i&&(i=!1),n.attr_sin&&(n.attr_sin.visible=!1),n.attr_dou1||(n.attr_dou1=new dt,n.attr_dou1.pos(259,853),n.addChild(n.attr_dou1),n.attr_dou2=new dt,n.attr_dou2.pos(555,853),n.addChild(n.attr_dou2)),n.attr_dou1.visible=n.attr_dou2.visible=!0,n.showAttr(n.attr_dou1,e,"#e3dcc2",i),n.showAttr(n.attr_dou2,t,"#e3dcc2",!1),n.mc_next.visible=!0},t.showAttr=function(e,t,i,n){var s;e.graphics.clear();var o=5,a=5,r=5,l=aa.formatAttrToChineseByList(t),c=yc.getRes(_r.getAtlasSubPath("basic_ui/comp_textbg.png"));if(0<l.length){var u=l.length;3<=u?(r=10,4==u&&(r=5),a=28):2==u&&(r=20,a=50),n&&(i="#01fb01");for(var d=0;d<l.length;d++)e.graphics.drawTexture(c,o,r,201,28),s=l[d],e.graphics.fillText(s.name+": ",o,r,"22px SimHei","#a19980","left"),o+=22*mp.getStringLength(s.name+": ")>>1,e.graphics.fillText(s.val+"",o,r,"22px SimHei",i,"left"),o+=22*mp.getStringLength(s.val)>>1,r+=a,o=5}},t.updateAvatar=function(){var e=this;e._equipAvatar&&(e._equipAvatar.parent&&e._equipAvatar.parent.removeChild(e._equipAvatar),e._equipAvatar.dispose()),e._equipAvatar=mj.GetNew(),e._equipAvatar.renderInSelf=!0,e._equipAvatar.pos(475,500),e.addChildAt(e._equipAvatar,2),e._isActive?e._equipAvatar.loadEffect(JZ._activeEffs[e._equipIndex]):e._equipAvatar.loadEffect(JZ._noActiveEff[e._equipIndex])},n}(),e0=function(e){function t(){var e=this;e._selecteds=[],e._open=!0,e._info=null,e._refineInfo=null,e._curValue=0,e._maxValue=0,e.actor=null,e.BAR_W=370,e.isTweening=!1,e.tweenTimes=0,t.__super.call(e)}b(t,"modules.actor.views.samsaraequip.SamEquipRefineTip",Y_);var i=t.prototype;return G.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.initialize=function(){var e=this;e.listGrid.itemRender=pj,e.listGrid.spaceX=12,e.listGrid.spaceY=8,e.listGrid.repeatX=4,e.listGrid.repeatY=100,e.listGrid.vScrollBarSkin="",e.listGrid.mouseHandler=ql.create(e,e.onSelect,null,!1),e.imgBar.mask=e.imgMask,e.imgMask.x=-e.BAR_W,e.ImgAddBar.mask=e.imgAddMask,e.imgAddMask.x=-e.BAR_W},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this._open=!0,this.clearList(),this._selecteds=[],this.off("click",this,this.onClick),this.tweenDown(0),Tu.sendToModule("REFRESH_SAMEQUIPFIGHT",["modules.actor.ActorModule"])},i.autoSelect=function(){var e=this.listGrid.array;if(e){var t=new Ia;t.type="click";for(var i=0;i<e.length&&this.onSelect(t,i,!1);i++)this.btnRefine.mouseEnabled=!1}},i.clearList=function(){var e=this.listGrid.array;if(e)for(var t=0;t<e.length;t++){var i=this.listGrid.getCell(t);i&&(i.selected=!1)}},i.update=function(){this._info&&this.updatePanel(this._info)},i.updatePanel=function(e){var t=this;t._selecteds=[],t.listGrid.array=[],t.boxCurAttr.graphics.clear(),t.boxNextAttr.graphics.clear(),t._info=e,t.actor=gR.ins.actorById(e.actorId);var i=yR.ins.getRefineAttrPos(t._info.actorId,t._info.pos);t._refineInfo=yR.ins.getRefineInfoPos(t._info.actorId,t._info.pos),t._curValue=t._refineInfo.value;t.actor.equips.getPart(t._info.pos);t._maxValue=yR.ins.getMaxValueByLvl(t._refineInfo.level,t._info.pos);var n,s,o,a=yR.ins.getRefineNextAttr(t._info.actorId,t._info.pos),r=aa.formatNewAttrToChinese(i,!1,!0,!0),l=0,c=0;for(t.fight.value=RR.getFight(i),c=0;c<r.length;c++)s=(n=r[c]).name+":",o=n.val+"",t.drawAttr(t.boxCurAttr,s,"#90877b",o,"#90877b",30,l,24),l+=32;if(a)for(t.updateShowOrNot(!0),l=0,t.boxCurAttr.x=18,t.imgArrow.visible=!0,t.boxNextAttr.visible=!0,r=aa.formatNewAttrToChinese(a,!1,!0,!0),c=0;c<r.length;c++)s=(n=r[c]).name+":",o=n.val+"",t.drawAttr(t.boxNextAttr,s,"#23b11f",o,"#23b11f",30,l,24),l+=32;else t.updateShowOrNot(!1),t.boxCurAttr.x=200,t.imgArrow.visible=!1,t.boxNextAttr.visible=!1;t.txtLv.text="Lv."+t._refineInfo.level;var u=yR.ins.getRefineMatis(t.actor,t._info.pos);0==u.length?t.txt_no.visible=!0:t.txt_no.visible=!1,t.listGrid.array=u,t.updateBar(),t._open?(G.timer.once(300,t,t.autoSelect),t._open=!1):G.timer.once(200,t,t.clearList)},i.show=function(e){this.updatePanel(e)},i.onSelect=function(e,t,i){var n=this;if(void 0===i&&(i=!0),"click"!=e.type)return!1;if(!n._info)return!1;var s=n.listGrid.getCell(t);if(!s)return!1;if(s&&!s.selected&&!yR.ins.checkAddedIsMax(yR.ins.getRefineValue(s.dto),n._curValue,n._info.actorId,n._info.pos,n._refineInfo.level))return i&&zB.ins.playErrorMsg(RP.n[1239]),!1;if(!s||s.selected||yR.ins.checkCanAdd(yR.ins.getRefineValue(s.dto),n._curValue,n._info.actorId,n._info.pos,n._refineInfo.level,n.actor))return s&&(s.selected=!s.selected),s&&s.selected&&-1==n._selecteds.indexOf(s.uuid)&&n._selecteds.push(s.uuid),s&&!s.selected&&-1!=n._selecteds.indexOf(s.uuid)&&n._selecteds.splice(n._selecteds.indexOf(s.uuid),1),s&&n.setAddBar(yR.ins.getRefineValue(s.dto),s.selected),!0;if(i)var o=n.actor.equips.getPart(n._info.pos);return i&&zB.ins.playErrorMsg(RP.n[1240]+(yR.ins.getSamLevelByDto(o)+1)+RP.n[1241]),!1},i.updateBar=function(){var e=this;if(!e.isTweening){var t=e._curValue/e._maxValue*e.BAR_W;if(0<e.tweenTimes)return e.imgAddMask.x=-e.BAR_W,e.isTweening=!0,void Og.to(e.imgMask,{x:0},200,null,ql.create(e,e.updateBarTwo));t>e.BAR_W&&(t=e.BAR_W),Og.to(e.imgMask,{x:-e.BAR_W+t},100,null,ql.create(e,e.tweenDown,[t]))}},i.updateBarTwo=function(){this.imgMask.x=-this.BAR_W,0<this.tweenTimes?(this.tweenTimes--,Og.to(this.imgMask,{x:0},200,null,ql.create(this,this.updateBarTwo))):(this.isTweening=!1,this.updateBar())},i.setAddBar=function(e,t){var i=this;t?i._curValue+=e:i._curValue-=e,i._curValue<0&&(i._curValue=0);var n=i._curValue/i._maxValue*i.BAR_W;n>i.BAR_W&&(n=i.BAR_W),Og.clearAll(i.imgAddMask),Og.to(i.imgAddMask,{x:-i.BAR_W+n},100,null,ql.create(i,i.tweenDown,[n]))},i.tweenDown=function(e){var t=this;t.btnRefine.mouseEnabled=!0,t.txtBarValue.text=t._curValue+"/"+t._maxValue;var i=yR.ins.getCanUpLvlNum(t._curValue,t._info.actorId,t._info.pos,t._refineInfo.level,t.actor);t.txtLv.text="Lv."+(t._refineInfo.level+i),0<i&&t.updateNextAttr(t._refineInfo.level+i),t.tweenTimes=5<i?5:i,t.txtLv.color=0<i?"#23b11f":"#e0d6c1",Og.clearAll(t.imgMask),Og.clearAll(t.imgAddMask),t.imgAddMask.x=-t.BAR_W+e},i.updateNextAttr=function(e){this.boxNextAttr.graphics.clear();var t,i,n,s=0,o=0,a=yR.ins.getRefineAttrByLvl(this._info.pos,e),r=aa.formatNewAttrToChinese(a,!1,!0,!0);for(o=0;o<r.length;o++)i=(t=r[o]).name+":",n=t.val+"",this.drawAttr(this.boxNextAttr,i,"#23b11f",n,"#23b11f",30,s,24),s+=32},i.close=function(e){void 0===e&&(e=!1)},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.updateShowOrNot=function(e){var t=this;t.imgMati.visible=e,t.btnRefine.visible=e,t.boxBar.visible=e,t.txtLv.visible=e,t.imgBar.visible=e,t.boxMiaoshu.visible=e,t.txtBarValue.visible=e,t.imgMaxLevel.visible=!e,t.listGrid.visible=e,t.imgXLZZ.visible=e},i.onClick=function(e){switch(e.target){case this.btnClose:hN.ins.close("SamEquipRefineTip");break;case this.btnRefine:if(!this._info)return;if(this.clearList(),0==this._selecteds.length)return void zB.ins.playErrorMsg(RP.n[1242]);var t=new pO;t.job=this._info.actorId,t.pos=this._info.pos,t.uuids=this._selecteds,Tu.sendToService(t),this._selecteds=[]}},p(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.actor.samsaraequip.SamEquipRefineTipUI._$SET_ins),t.NAME="SamEquipRefineTip",t._ins=null,t}(),t0=function(e){function t(){this.GRAY="#90877b",this.GAP_Y=42,this._selector=null,this.avatar=null,this.avatarW=null,this._equipNames=null,this._grids=null,this._redPts=null,t.__super.call(this)}b(t,"modules.actor.views.samsaraequip.SamsaraEquipView",X_);var i=t.prototype;return i.updateView=function(){this.updateEquips(),this._selector.invalid()},i.initialize=function(){var e=this;e._selector=new Nj,e._selector.redptHandler=ql.create(e,e.checkRoleRedPt,null,!1),e.addChild(e._selector),e.avatarW=new CF,e.avatarW.pos(-334,335),e.addChildAt(e.avatarW,1),e.avatar=new CF,e.avatar.pos(-334,335),e.addChildAt(e.avatar,2),e._equipNames={},e._grids={},e._redPts={};for(var t=0;t<8;t++){var i=la.SAMSARA_EQUIPS[t],n=e["equip"+i];e._redPts[i]||(e._redPts[i]=kB.createSprite(NI.POINT,n.x+85-n.width/2,n.y-13-n.height/2,0,0,e));var s=kB.createText(n.x-n.width/2,n.y+116+2-n.height/2,116,0,la.getName(i),20,"#90877b",!1,"center",!1,!1,e);e.addChild(s),e._equipNames[i]=s;var o=new MF;o.mouseEnabled=!1,n.addChild(o),e._grids[i]=o}e.imgBg.skin=_r.getAtlasSubPath("samsaraequip/js_bg.jpg"),e.boxAttr.x=140},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t._selector.on("select",t,t.onSelectActor),t.updateAvatar();for(var i=0;i<8;i++){t["equip"+la.SAMSARA_EQUIPS[i]].on("click",t,t.onClickGrid)}t.updateEquips(),t._selector.invalid()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t._selector.off("select",t,t.onSelectActor);for(var i=0;i<8;i++){t["equip"+la.SAMSARA_EQUIPS[i]].off("click",t,t.onClickGrid)}},i.updateEquips=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e);if(t){for(var i=0;i<8;i++){var n=la.SAMSARA_EQUIPS[i],s=this["equip"+n],o=this._grids[n],a=t.equips.getPart(n);if(a){o.visible=!0,o.bindData=a;var r=yR.ins.getBetterDto(n,t,a);s.tag={pos:n,dto:r||a}}else o.visible=!1,s.tag={pos:n,dto:yR.ins.getMaxLvlWhileNull(n,this._selector.selectIdx+1)}}var l=yR.ins.getRedPtStatusByActor(t),c=yR.ins.getRefineRPtStatusByActor(t,this._selector.selectIdx+1);for(var u=0 in l)this._redPts[u].visible=l[u]||c[u];this.showAttrs(t)}},i.showAttrs=function(e){var t=this;t.boxAttr.graphics.clear();var i=0,n=0,s=t._selector.selectIdx+1,o=yR.ins.getSuitInfoByActor(e),a={};for(var r=0 in o)for(i=0;i<ji.count;i++){var l=ji.MODEL.suitType(i),c=ji.MODEL.level(i),u=ji.MODEL.suitNeedNum(i),d=ji.MODEL.roleType(i);if("lunhuiEquip"==l&&o[r]==c&&r==u&&e.job==d){var h=ji.MODEL.suitNeedNum(i);a[h]=i}}var _=[];for(h in a){var f=!1,p=a[h];c=ji.MODEL.level(p),u=ji.MODEL.suitNeedNum(p);var g=yR.ins.getSuitLevelName(c,e.job);u<=yR.ins.getWearedNumByLvlActor(c,s)&&(f=!0);var v=ji.MODEL.attributes(p);if(""!=v){var m=f?"#e0d6c1":t.GRAY,y=f?"#23b11f":t.GRAY;f&&_.push(v);var I=aa.formatNewAttrToChinese(v,!1,!0,!1);t.boxAttr.graphics.fillText(g+""+u+RP.n[1243],0,n,RP.n[1244],m,"left");var b,w=24*(g+""+u+RP.n[1245]).length-24,x=0;for(var S in I)-1!=(b=I[S]).name.indexOf("加成")?t.boxAttr.graphics.fillText(b.name+""+b.val,w+x%2*180,n,"24px SimHei",y,"left"):t.boxAttr.graphics.fillText(b.name+"+"+b.val,w+x%2*180,n,"24px SimHei",y,"left"),x++,n+=t.GAP_Y}}var k=0;for(i=0;i<_.length;i++)"string"==typeof _[i]&&5<_[i].length&&(k+=RR.getFight(JSON.parse(_[i])));var E=yR.ins.getEquipFightByActor(e)+yR.ins.getRefineFightByActor(t._selector.selectIdx+1);t.fightNum.value=k+E},i.chooseRole=function(e){if(this._selector)for(var t=gR.ins.actorList,i=0;i<t.length;i++)if(t[i].job==e){this._selector.selectIdx=i;break}},i.onSelectActor=function(e){this.updateAvatar(),this.updateView()},i.onClick=function(e){e.target},i.onClickGrid=function(e){var t=e.target.tag,i=this._selector.selectIdx+1;xs.assign(t,{actorId:i}),WX.ins.show(t)},i.updateAvatar=function(){var e=this._selector.selectIdx+1,t=gR.ins.actorById(e);this.avatar.changeAvatar(t.sex,t.wid,t.mid,null,t.weaponSoulId),this.avatarW.changeAvatar(-1,null,null,t.wgid,null)},i.drawAttr=function(e,t,i,n,s,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px SimHei",i,"left");var c=o+(mp.getStringLength(t)*r>>1)+l;return""!=n&&e.graphics.fillText(n,c,a,r+"px SimHei",s,"left"),c+(mp.getStringLength(n)*r>>1)+l},i.checkRoleRedPt=function(e){var t=!1,i=yR.ins.getRedPtStatusByActor(e),n=gR.ins.actorList;if(!n)return t;var s=yR.ins.getRefineRPtStatusByActor(e,n.indexOf(e)+1);for(var o=0 in i)if(i[o]){t=!0;break}for(o in s)if(s[o]){t=!0;break}return t},t}(),i0=function(e){function o(){this.vsc=null,o.__super.call(this),this.top=this.bottom=this.left=this.bottom=0}b(o,"modules.actor.views.soaring.ActorSoaringMainV",Cf);var t=o.prototype;return t.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/soaring/yq_btn_rxsz.png","ui/layouts/soaring/btn_tab_qh.png","ui/layouts/soaring/yq_btn_sztz.png","ui/layouts/soaring/imgSkill.png","ui/layouts/soaring/yq_btn_hjzj.png"],e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1);var t=["ConfigFlyUpResource","ConfigFlyUpSuitResource","ConfigFlyUpSuitLimit"],i=["CFlyUpModel","ConfigFlyUpSuitResource","ConfigFlyUpSuitLimit"];e.vsc.registAll([{cls:aQ,id:"0",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["DragonDesignUpgrade","DragonView"],["CConfigDragonInfo","CConfigDragonView"]))},{cls:eQ,id:"1",wait:hN.wait(hN.waitConfig(t,i))},{cls:cQ,id:"2",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(t,i))},{cls:oQ,id:"3"},{cls:nQ,id:"4",isHideBg:!0}]),e.vsc.filterHandler=ql.create(e,e.checkTips,null,!1)},t.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),bR.reqSoaringData(),AR.ins.init();AN.reqRedPt([239]);var t=ql.create(this,this.redPtUpdate,null,!1);if(AN.ins.addListener("BTN_FLYUP",[239],t),!o._hasOpenSoaring){var i,n=AR.ins.getOverGradeEquips();if(0<n.length)for(var s in n)if(i=n[s],!AR.ins.isNeedCurFlyupEquip(i)){AR.ins.needShowResolveExtraRedDot=!0,this.updateData();break}o._hasOpenSoaring=!0}},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.vsc.selectedView&&this.vsc.selectedView.hideByVSC&&this.vsc.selectedView.hideByVSC(),hN.ins.close("EQUIP_WEAR_TIP")},t.onSubChanged=function(e,t){var i="";switch(e){case"0":case"1":case"2":case"3":case"4":i="soaring/sz_text_sz.png"}this.setTitle(_r.getAtlasSubPath(i))},t.checkTips=function(e){return"0"==e&&AR.ins.isShowEquipPt?3:"1"==e&&AR.ins.isShowCompoundPt?3:"2"==e&&AR.ins.isAbleGrowSuit?3:0},t.updateData=function(){var e=this.vsc.selectedView;e&&e.updateView&&e.updateView(),this.vsc.updateItemEnabled()},t.addSuitArrow=function(){var e=this.vsc.selectedView;e&&e instanceof modules.actor.views.soaring.subview.SoaringSuitV&&e.addArrow&&e.addArrow()},t.selectActor=function(e){var t=this.vsc.selectedView;t&&t.selectActor&&t.selectActor(e),this.vsc.updateItemEnabled()},t.setSelectIndex=function(e){this.vsc.selectedIndex=e},t.refreshToSEquip=function(e){e&&this.vsc.selectedView instanceof modules.actor.views.soaring.subview.SoaringEquipV&&this.vsc.selectedView.refreshToSEquip&&this.vsc.selectedView.refreshToSEquip(e)},o._hasOpenSoaring=!1,o.V_SOARING="0",o.V_EQUIP="1",o.V_SUIT="2",o.V_SKILL="3",o.V_PREVIEW="4",o}(),n0=function(e){function l(){this.sourceImgArr=[],this.desImgArr=[],this._imgArr=[],this._desArr=[],this._pointXArr=[138,272,407],this._zhuijiEffect=null,this._autoEffArr=null,l.__super.call(this),l._grayFilter=(l._grayFilter=(l._grayFilter=(l._grayFilter=l._grayFilter.concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([.3086,.6094,.082,0,0])).concat([0,0,0,1,0])}b(l,"modules.actor.views.soaring.ZhuiJiAutoSettingView",Uv);var t=l.prototype;return t.initialize=function(){},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._autoEffArr=[],t.checkBox_autoZhuiJi.selected=ER.ins.isAutoZhuiJi,t.checkBox_autoZhuiJi.on("change",t,t.onCBZhuiJiClicked),t.btnClose.on("click",t,t.close);var i=ql.create(t,t.redPtUpdate,null,!1);AN.ins.addListener("LINK_SETTING_ZHUIJIZhuiJiAutoSettingView",[253],i),t.initView();var n=new Se;Tu.sendToService(n)},t.onRemove=function(e){var t=this;for(var i in ui.SubPanel.prototype.onRemove.call(t,e),t.checkBox_autoZhuiJi.off("change",t,t.onCBZhuiJiClicked),t.btnClose.off("click",t,t.close),t._imgArr)t._imgArr[i].off("click",t,t.onImageClicked);t.requestSave(),AN.ins.removeListener("LINK_SETTING_ZHUIJIZhuiJiAutoSettingView"),t.disposeEffect()},t.requestSave=function(){var e="";if(0<this._desArr.length)for(var t=0;t<this._desArr.length;t++)for(var i=0;i<gR.ins.actorList.length;i++)gR.ins.actorList[i].job.toString()==this._desArr[t]&&(e+=i+1+"");0<e.length&&(ER.ins.isAutoZhuiJi=this.checkBox_autoZhuiJi.selected,ER.ins.autoZhuiJiStr=e,ER.ins.requestSaveSetting())},t.close=function(){ui.SubPanel.prototype.close.call(this),hN.ins.close("ZhuiJiAutoSettingView")},t.initView=function(){var e,t=this;if(0==t._imgArr.length){for(var i,n,s=0;s<gR.ins.zhuijiSkill.length;s++)(i=t["img_from_"+s]).on("click",t,t.onImageClicked),AN.ins.getStateByCareList([253])&&(n=kB.createEffect("jm1081",i.x+34,i.y+i.height/2-1,t),t._autoEffArr.push(n)),i.name="from"+s,t._imgArr.push(i),t.sourceImgArr.push(i);for(var o=0;o<gR.ins.zhuijiSkill.length;o++)(i=t["img_to_"+o]).name="to"+o,i.on("click",t,t.onImageClicked),t._imgArr.push(i),t.desImgArr.push(i)}for(var a=0,r=0;r<ER.ins.autoZhuiJiStr.length;r++)e=ER.ins.autoZhuiJiStr[r],a=gR.ins.actorList[parseInt(e)-1].job,t._desArr.push(a);t.updateView()},t.onCBZhuiJiClicked=function(e){0<this._desArr.length?(this.checkBox_autoZhuiJi.selected,this.checkBox_autoZhuiJi.selected,this.requestSave(),this._zhuijiEffect&&this.disposeEffect()):this.checkBox_autoZhuiJi.selected&&(zB.ins.showMsg(RP.n[1246],1),this.checkBox_autoZhuiJi.selected=!1)},t.updateView=function(){for(var e,t,i=this,n=0,s=0;s<gR.ins.zhuijiSkill.length;s++){if((e=i._autoEffArr[s])&&(e.alpha=1),0<gR.ins.zhuijiSkill[s])for(var o in i["img_from_"+s].filters=[],i["img_from_"+s].mouseEnabled=!0,i["img_selected_"+s].visible=!1,i._desArr)i["img_selected_"+((n=i._desArr[o])-1)].visible=!0,n-1==s&&(e&&(e.alpha=.01),i["img_from_"+s].mouseEnabled=!1);else i["img_from_"+s].mouseEnabled=!1,i["img_selected_"+s].visible=!1,e&&(e.alpha=.01),i["img_from_"+s].filters=[new ys(l._grayFilter)]}for(var a=0;a<gR.ins.zhuijiSkill.length;a++)if((t=i.desImgArr[a]).visible=!1,0==i._desArr.length)i["img_selected_"+a].visible=!1,i["img_to_"+a].visible=!1;else for(var r=0;r<i._desArr.length;r++)(n=i._desArr[r])==parseInt(t.name.charAt(t.name.length-1))+1&&(t.visible=!0,t.pos(i._pointXArr[r],422));0==i._desArr.length&&i.checkBox_autoZhuiJi.selected&&(i.checkBox_autoZhuiJi.selected=!1),i.updateAutoCheckEffect()},t.onImageClicked=function(e){var t=e.currentTarget,i=parseInt(t.name.charAt(t.name.length-1));if(0==gR.ins.zhuijiSkill[i])zB.ins.showMsg(RP.n[1247],1);else{for(var n=i+1,s=0,o=0;o<gR.ins.actorList.length;o++)if(gR.ins.actorList[o].job==n){s=n;break}0<=this._desArr.indexOf(s)?this._desArr.splice(this._desArr.indexOf(s),1):this._desArr.push(s)}this.updateView()},t.redPtUpdate=function(e,t){switch(e){case"LINK_SETTING_ZHUIJIZhuiJiAutoSettingView":this.updateAutoCheckEffect()}},t.updateAutoCheckEffect=function(){var e=this;AN.ins.getStateByCareList([253])?(null==e._zhuijiEffect&&(e._zhuijiEffect=kB.createEffect("jm1081",e.checkBox_autoZhuiJi.x+31,e.checkBox_autoZhuiJi.y+e.checkBox_autoZhuiJi.height/2-4,e)),e.checkBox_autoZhuiJi.selected||e._desArr.length!=gR.ins.getZhuiJiNum()?e._zhuijiEffect.alpha=.01:e._zhuijiEffect.alpha=1):e.disposeEffect()},t.disposeEffect=function(){for(var e in this._zhuijiEffect&&(this._zhuijiEffect.parent&&this._zhuijiEffect.parent.removeChild(this._zhuijiEffect),this._zhuijiEffect.dispose(),this._zhuijiEffect=null),this._autoEffArr)this._autoEffArr[e].dispose(),null},l.NAME="ZhuiJiAutoSettingView",l._grayFilter=[],l}(),s0=function(e){function t(){this._iconOne=null,this._needToCharge=!1,this.hasBuy=0,this.requestYB=0,this.index=0,this.buyCost=0,this.idArr=null,this.isBuy=!1,t.__super.call(this)}b(t,"modules.activity.views.goldlottery.GoldLotteryBuyView",Zr);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onGoBtnClicked),t.btn_close.on("click",t,t.onCloseBtnClicked),t._iconOne=new MF,t._iconOne.pos(t.img_grid_0.x,t.img_grid_0.y),t.addChild(t._iconOne),t._needToCharge=!0,t.hasBuy=0,t.updateView()},i.onRemove=function(e){if(ui.SubPanel.prototype.onRemove.call(this,e),this.btn_go.on("click",this,this.onGoBtnClicked),this.btn_close.on("click",this,this.onCloseBtnClicked),G.timer.clearAll(this),this.hasBuy){var t=new qc;t.lotteryID=Kr.ins.currentLotteryID,t.lotteryNum=1,Tu.sendToService(t)}},i.updateView=function(){var e=this;e.img_key.skin=_r.getFullUrl("ui/images/icons/icgoods10106.png");var t=1;e.idArr=[];for(var i=0;i<ho.count;i++)ho.MODEL.luckDrawId(i)==Kr.ins.currentLotteryID&&e.idArr.push(ho.MODEL.key(i));Kr.ins.currentChargeLevel>=e.idArr.length?(Kr.ins.currentChargeLevel,e.idArr.length):t=Kr.ins.currentChargeLevel+1,e.index=Kr.ins.getTurnTableIndex(Kr.ins.currentLotteryID,t),e.txt_grid_1.text=ho.MODEL.keyname(e.index);var n=yB.createStr(ho.MODEL.rewardDef(e.index));e._iconOne.dataSource=n,e.txt_grid_0.text=n.simpleName,e.txt_info.innerHTML="";var s=ei.MODEL.content(ei.getIndex(4370)),o=Kr.ins.currentChargeYB;e.buyCost=yB.createStr(ho.MODEL.consumptionDef(e.index)).goodsNum,e.requestYB=ho.MODEL.recharge(e.index);var a="";e.btn_go.showTip=!1,e.txt_num.text=e.buyCost.toString(),e.isBuy=e.idArr.length>Kr.ins.boughTime;var r=Math.max(e.idArr.length-Kr.ins.boughTime,0);e.txt_times.innerHTML=RP.n[1248]+Ql.createColor(r.toString(),0<r?"#23b11f":"#ff2e24")+Ql.createColor("/"+e.idArr.length,"#23b11f"),o>=e.requestYB?(e.btn_go.label=RP.n[1249],e.btn_go.disabled=!e.isBuy,a="#23b11f",e.txt_info.innerHTML=mp.getFormat(s,[a,o,e.requestYB]),e._needToCharge=!1,e.img_yuanbao.visible=!0,gR.ins.YB>=e.buyCost&&e.isBuy&&(e.btn_go.showTip=!0)):(e.btn_go.label=RP.n[1250],a="#ff2e24",e.txt_info.innerHTML=mp.getFormat(s,[a,o,e.requestYB]),e.img_yuanbao.visible=!1,e.txt_num.text="")},i.onGoBtnClicked=function(e){if(this._needToCharge)Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]);else{if(!this.isBuy)return;if(gR.ins.YB>=this.buyCost)if(TR.ins.hasEmptyNum(20)){var t=new jc;t.lotteryID=Kr.ins.currentLotteryID,Tu.sendToService(t),this.hasBuy=1,this.btn_go.mouseEnabled=!1,this.btn_go.gray=!0,G.timer.once(500,this,this.close)}else KQ.ins.showBagRecycle();else KQ.ins.showNoGold()}},i.onCloseBtnClicked=function(e){this.close()},t.NAME="GOLDLOTTERYBUYVIEW",t}(),o0=function(e){function t(){this._effect=null,this._newW=null,this._oldW=null,t.__super.call(this)}b(t,"modules.activity.views.goldlottery.GoldLotteryGetView",$r);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this._effect&&(this._effect.removeSelf(),this._effect.dispose()),G.timer.clearAll(this),Og.clearAll(this.mc_num)},i.showExp=function(e){var t=this;this.mc_num.scaleX=this.mc_num.scaleY=4,Og.to(this.mc_num,{scaleX:1,scaleY:1},500,pa.backIn),this.mc_num.visible=!0,G.timer.once(500,this,function(){t.showExpNum(e.toString())}),G.timer.once(1500,this,this.closeThis)},i.closeThis=function(){hN.ins._closePanelForce(this),this._effect&&(this._effect.removeSelf(),this._effect.dispose())},i.showExpNum=function(e){if(dr.isSleep)this.mc_num.value=e;else{this._effect=kB.createEffect("jm1319",270,150,this);var t=this.mc_num.value;if(e.length!=t.length)for(var i=0;i<e.length-t.length;i++)t="0"+t;this._newW=e.split(""),this._oldW=t.split(""),this.showPos(0,0),this.showPos(1,0),this.showPos(2,0)}},i.showPos=function(e,t){var i=this,n=i._newW.length-e-1;if(i._newW[n]!=i._oldW[n])i._oldW[n]=t+"",i.mc_num.value=i._oldW.join(""),G.timer.once(30,i,i.showPos,[e,t+1],!1);else{if(i.mc_num.value=i._oldW.join(""),(e+=3)>=i._newW.length)return;G.timer.once(30,i,i.showPos,[e,0],!1)}},t.NAME="GOLDlOTTERYGETVIEW",t}(),a0=function(e){function t(){this._box=null,this.S_ICON_PX=57,this.S_TEXT_PX=92,this.path=_r.getAtlasSubPath("base_ui2")+"/tips_zs.png",t.__super.call(this)}b(t,"modules.activity.views.goldlottery.GoldLotteryInfoView",el);var i=t.prototype;return i.initialize=function(){this._box||(this._box=new dt,this._box.pos(0,118),this.addChild(this._box))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);var i=ei.getIndex(4360),n=ei.MODEL.content(i).split("$");t._box&&t._box.graphics.clear();for(var s=G.loader.getRes(t.path),o=0,a=0;a<n.length;a++)if(n[a]&&""!=n[a]){-1==n[a].indexOf("PS：")&&t._box.graphics.drawTextures(s,[t.S_ICON_PX,o]);var r=t.getTF();r.pos(t.S_TEXT_PX,o+3),r.innerHTML=n[a],t._box.addChild(r),o+=r.contextHeight+2}t.height=o+25+t._box.y},i.getTF=function(){var e=new Xl;return e.fontSize=24,e.color="#90877b",e.font="SimHei",e.leading=12,e.width=475,e},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this._box&&this._box.graphics.clear()},t.NAME="GOLDLOTTERYINFOVIEW",t}(),r0=function(e){function t(){var e=this;e.RUN_ROUND=4,e.RUN_ANGLE=5,e.Rotation_Config=[[0,15],[1,20],[3,10],[e.RUN_ROUND,e.RUN_ANGLE]],e._numRound=0,e._numAngle=0,e._drawAngle=0,e._drawing=!1,e._lastFrameTime=NaN,e._currentIndex=-1,e._targetIndex=0,e.needToUpdateReward=!1,e._currentRecord=null,e._idsArr=null,e.vsc=null,e.tipLayer=3,e.textLayer=5,e.effectLayer=7,e.shankCnt=0,e.requestYB=0,e.buyCost=0,e.actVo=null,e.leftStr=RP.n[1251],t.__super.call(e)}b(t,"modules.activity.views.goldlottery.GoldLotteryMainView",tl);var i=t.prototype;return i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.isHideBg=!0,e.vsc=new SB(e),e.title=_r.getAtlasSubPath("goldlottery/ybzp_text_ybzp.png"),e.img_bg.skin=_r.getFullUrl("ui/images/goldlottery/ybzp_jm_bg.jpg"),e.img_bg_left.skin=_r.getFullUrl("ui/images/goldlottery/ybzp_zp_bgz.png"),e.img_bg_right.skin=_r.getFullUrl("ui/images/goldlottery/ybzp_zp_bgy.png"),e.panel_record.vScrollBarSkin="",e.panel_record.vScrollBar.elasticBackTime=200,e.panel_record.vScrollBar.elasticDistance=60,e.txt_record.leading=5},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_start.on("click",t,t.onStartClicked),t.box_info.on("click",t,t.onInfoBoxClicked),t._currentIndex=-1,t.layout.dragon_border.visible=!1,t.img_key.skin=_r.getFullUrl("ui/images/icons/icgoods10106.png"),t.img_key.size(36,36),t.btn_start.label=RP.n[1252],t.btn_start.showTip=!1,t.txt_max.visible=!1,t.txt_num.visible=!0,t.img_key.visible=!0,t.updateView(),t.updateTime()},i.onRemove=function(e){var t=this;if(ui.SubPanel.prototype.onRemove.call(t,e),Kr.ins.hasRecord=!1,t.needToUpdateReward=!1,t.actVo=null,t.btn_start.off("click",t,t.onStartClicked),t.box_info.off("click",t,t.onInfoBoxClicked),Kr.ins.isPlaying){var i=new qc;i.lotteryID=Kr.ins.actId,i.lotteryNum=1,Tu.sendToService(i)}t.lockMask(!1),Kr.ins.isPlaying=!1,G.timer.clearAll(t)},i.onStartClicked=function(e){if(!Kr.ins.isPlaying)if(!Kr.ins.needToBought&&0<Kr.ins.leftLotteryTime){var t=new qc;t.lotteryID=Kr.ins.actId,t.lotteryNum=1,Tu.sendToService(t)}else hN.ins.isOpen("GOLDLOTTERYBUYVIEW")||hN.ins.open("GOLDLOTTERYBUYVIEW")},i.play=function(e){var t=this;t._currentRecord=e,t._numRound=0,t._drawAngle=-1,t._drawing=!0,t.lockMask(!0),G.timer.frameLoop(1,t,t.onPlayLoop),Kr.ins.isPlaying=!0,t.updateTxt(),t.btn_start.mouseEnabled=!1,t.btn_start.gray=!0},i.onPlayLoop=function(){for(var e=this,t=0,i=e.Rotation_Config.length-1;0<=i;){var n=e.Rotation_Config[i];if(e._numRound>=n[0]){t=n[1];break}i--}if(360<=e._numAngle&&(e._numAngle-=360,e._numRound++),e._numRound>=e.RUN_ROUND){if(e._drawAngle<0)for(var s=0;s<e._idsArr.length;s++)if(e._currentRecord.configID==e._idsArr[s]){e._drawAngle=45*s,0==s&&(e._drawAngle=1);break}if(0<e._drawAngle){var o=e._drawAngle-e._numAngle;if(0<=o&&o<=t)return e._numAngle=e._drawAngle,e._drawing=!1,e.img_arrow.rotation=e._numAngle,G.timer.clear(e,e.onPlayLoop),void e.onPlayEnd()}}e._numAngle+=t,e.img_arrow.rotation=e._numAngle},i.onPlayEnd=function(){this.shankCnt=0,G.timer.loop(120,this,this.onShank)},i.onShank=function(){8<this.shankCnt&&this.onShankEnd(),this.shankCnt++},i.onShankEnd=function(){var e=this;e.lockMask(!1),G.timer.clear(e,e.onShank),Kr.ins.isPlaying=!1,e.needToUpdateReward=!0;for(var t=[],i=0;i<ho.count;i++)ho.MODEL.luckDrawId(i)==Kr.ins.currentLotteryID&&t.push(ho.MODEL.key(i));var n=Ws.getIndex(e._currentRecord.configID),s=yB.createStr(Ws.MODEL.rewardDef(n)).goodsNum;Kr.ins.hasLotteryTime<t.length?(e.btn_start.gray=!1,e.btn_start.mouseEnabled=!0):(e.btn_start.gray=!0,e.btn_start.mouseEnabled=!1,e.btn_start.showTip=!1,e.txt_max.visible=!0,e.txt_num.visible=!1,e.img_key.visible=!1),e.updateRecord(),hN.ins.open("GOLDlOTTERYGETVIEW",s)},i.lockMask=function(e){hN.ins.lockMask("GOLDLOTTERYMAINVIEW",e)},i.updateRecord=function(){if(0!=Kr.ins.currentRecord.length){for(var e,t,i="",n=Kr.ins.currentRecord.slice(),s=ei.MODEL.content(ei.getIndex(4369)),o=0,a=n.reverse(),r=0;r<n.length;r++)t=a[r],o=Ws.getIndex(t.configID),e=Ws.MODEL.chatParam(o).split(","),i+=mp.getFormat(s,[t.playerName,e[0],e[1]]),r<n.length-1&&(i+=Ql.newline());this.txt_record.innerHTML=i,this.txt_record.pos(0,0),this.panel_record.addChild(this.txt_record),this.panel_record.refresh(),this.panel_record.vScrollBar.value=0}else this.txt_record.innerHTML=""},i.updateView=function(){var e=this;e.updateReward(),e.updateTxt(),e.updateRecord();for(var t=[],i=0;i<ho.count;i++)ho.MODEL.luckDrawId(i)==Kr.ins.currentLotteryID&&t.push(ho.MODEL.key(i));0<t.length&&(Kr.ins.hasLotteryTime<t.length?(e.btn_start.gray=!1,e.btn_start.mouseEnabled=!0):(e.btn_start.gray=!0,e.btn_start.mouseEnabled=!1,e.btn_start.showTip=!1,e.txt_max.visible=!0,e.txt_num.visible=!1,e.img_key.visible=!1))},i.updateTxt=function(){var e=this;0<Kr.ins.leftLotteryTime?(e.txt_num.text="1/1",e.txt_num.color="#23b11f"):(e.txt_num.text="0/1",e.txt_num.color="#ff2e24");for(var t,i=1,n=[],s=0;s<ho.count;s++)ho.MODEL.luckDrawId(s)==Kr.ins.currentLotteryID&&n.push(ho.MODEL.key(s));i=Kr.ins.currentChargeLevel>=n.l?(Kr.ins.currentChargeLevel=n.length-1,Kr.ins.currentChargeLevel):Kr.ins.currentChargeLevel+1;var o=Kr.ins.currentChargeYB;t=Kr.ins.getTurnTableIndex(Kr.ins.actId,i),e.requestYB=ho.MODEL.recharge(t);var a=ho.MODEL.consumptionDef(t);a&&(e.buyCost=yB.createStr(a).goodsNum),o>=e.requestYB&&gR.ins.YB>=e.buyCost?e.btn_start.showTip=!0:e.btn_start.showTip=!1,0<Kr.ins.leftLotteryTime&&(e.btn_start.showTip=!0)},i.updateReward=function(){for(var e=1,t=[],i=0;i<ho.count;i++)ho.MODEL.luckDrawId(i)==Kr.ins.currentLotteryID&&t.push(ho.MODEL.key(i));e=Kr.ins.hasLotteryTime>=t.length?(Kr.ins.hasLotteryTime,t.length,Kr.ins.hasLotteryTime):Kr.ins.hasLotteryTime+1;var n=Kr.ins.getRewardByIDAndLevel(Kr.ins.actId,e);if(null!=n){var s=n.split(";");this._idsArr=[];for(var o=0;o<s.length;o++){var a=s[o],r=this.box_grid.getChildByName("img_icon_"+o),l=a.split(",");this._idsArr.push(parseInt(l[0])),r.skin=_r.getFullUrl("ui/images/goldlottery/"+l[1]+".png"),this.box_grid.getChildByName("txt_name_"+o).changeText(l[2])}}},i.onInfoBoxClicked=function(e){hN.ins.isOpen("GOLDLOTTERYINFOVIEW")||hN.ins.open("GOLDLOTTERYINFOVIEW")},i.updateTime=function(){var e=this;if(e.actVo=mB.getInStance().getActivityData(Kr.ins.actId),null!=e.actVo){G.timer.clear(e,e.onTimer);var t=e.actVo.endTime-dr.serverTimeSec;0<t?(t>Jp.DATE_SECOND?e.txt_countDown.changeText(e.leftStr+Jp.getDHM(t)):e.txt_countDown.changeText(e.leftStr+Jp.getHMS(t)),G.timer.loop(300,e,e.onTimer)):e.txt_countDown.changeText("已结束")}},i.onTimer=function(){var e=this.actVo.endTime-dr.serverTimeSec;0<e?e>Jp.DATE_SECOND?this.txt_countDown.changeText(this.leftStr+Jp.getDHM(e)):this.txt_countDown.changeText(this.leftStr+Jp.getHMS(e)):(this.txt_countDown.changeText("已结束"),G.timer.clear(this,this.onTimer))},t.NAME="GOLDLOTTERYMAINVIEW",t}(),l0=function(e){function t(){t.__super.call(this)}b(t,"modules.actor.views.zs.ZsExchangeView",ur);var i=t.prototype;return i.initialize=function(){this.list_zs.itemRender=aW,this.list_zs.spaceY=20,this.list_zs.vScrollBarSkin=""},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.close),this.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.close),LY.showing&&LY.Ins().closeArrow()},i.update=function(){if(this.list_zs.array=[0,1,2],PH.Ins().hasNewGuide(47)){var e,t=gR.ins.zsLv+1,i=es.getIndex(t),n=parseInt(es.MODEL.cost(i));if(gR.ins.zsExp>=n)(e=new u_).x=this.width-this.btn_close.width,e.y=this.btn_close.y-15,e.width=this.btn_close.width,e.height=this.btn_close.height+10,LY.Ins().show(47,e,!1,this)}},t}(),c0=function(e){function t(){var e=this;e.vsc=null,e._curIdx=-1,t.__super.call(e),e.centerX=0,e.navList=[_r.getAtlasSubPath("arena/btn_tab_jjc.png"),_r.getAtlasSubPath("arena/btn_tab_mrjl.png"),_r.getAtlasSubPath("arena/btn_tab_sjph.png")],e.title=_r.getAtlasSubPath("arena/title.png"),e.vsc=new SB(e),e.vsc.filterHandler=ql.create(e,e.onVscFilter,null,!1),e.vsc.registAll([{cls:CQ,id:"3"}]),e.vsc.invalid()}b(t,"modules.arena.views.ArenaMV",ge);var i=t.prototype;return i.onVscFilter=function(e,t){var i=kR.ins.toc_red;return i&&"1"==e&&1==i.arenaRed?3:i&&"2"==e&&1==i.awardRed?3:0},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.vsc.selectedIndex=0},i.updateInfo=function(){},i.updateArenaPlayer=function(e){},i.updateAward=function(e){},i.updateRank=function(){this.vsc.selectedView instanceof modules.arena.views.ArenaRankV&&this.vsc.selectedView.update()},i.updateRed=function(){this.vsc.invalid()},t}(),u0=function(e){function t(){t.__super.call(this),this.initUI()}b(t,"modules.backpack.views.item.BagComSBtnContainer",Ge);var i=t.prototype;return i.setSelectedItem=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i.composeData&&i.composeData.sType==e?i.selected(!0):i.selected(!1)}},i.showSType=function(e,t){var i=Cs.MODEL.sTitle(e-1),n=Cs.MODEL.composeKeys(e-1),s=Cs.MODEL.backType(e-1),o=[];if(i){o=i.split(",");for(var a=[],r=0;r<o.length;r++){var l=n.split("|")[r],c=new Object;c.tName=o[r],c.tKey=l,c.bType=e,c.sType=r+1,c.sitemType=s.split(",")[r],c.selected=t==r+1,a.push(c)}this.list.dataSource=a}this.height=this.list.height=62*a.length},i.initUI=function(){this.list.itemRender=_0,this.list.vScrollBarSkin="",this.list.spaceY=6,this.list.dataSource=[],this.list.x=4,this.list.width=175},t}(),d0=function(e){function t(){this.vsc=null,this.openComLv=0;var e=this;t.__super.call(this),this.openComLv=parseInt($e.MODEL.value($e.getIndex(312))),this.navList=[_r.getAtlasSubPath("bag/btn_tab_zb.png"),_r.getAtlasSubPath("bag/btn_tab_dj2.png"),_r.getAtlasSubPath("bag/btn_tab_longwen.png"),_r.getAtlasSubPath("bag/btn_tab_compose.png")],this.vsc=new SB(this),this.vsc.registAll([{cls:uW,id:"1",wait:hN.wait(hN.waitConfig(["ConfigEnhance","ConfigEnchant"],["CEnhanceModel","CEnchantModel"]))},{cls:m0,id:"2",wait:hN.wait(hN.waitConfig(["ConfigFashion"],["CFashionModel"]))},{cls:dW,id:"3",wait:hN.wait(hN.waitConfig(["DragonDesignUpgrade","DragonView"],["CConfigDragonInfo","CConfigDragonView"]))},{cls:g0,id:"4",wait:hN.wait(hN.waitConfig(["ComMapRes"],["ConfigBPMap"])),grayTip:function(){zB.ins.showMsg(RP.n[1253]+e.openComLv+"级开启",1),UB.ins._playLevelNot()}}]),this.vsc.filterHandler=ql.create(this,this.checkNotice,null,!1),this.vsc.selectHandler=ql.create(this,this.onViewChanged,null,!1)}b(t,"modules.backpack.views.BackPackMainView",Je);var i=t.prototype;return i.onViewChanged=function(e,t){},i.update=function(){this.callLater(this.updateDo)},i.updateDo=function(){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView()},i.updateExtend=function(){this.vsc.selectedView instanceof modules.backpack.views.sub.BackPackEquipView&&this.vsc.selectedView.updateExtend()},i.destroy=function(e){void 0===e&&(e=!0),NR.destoryGridImage(),this.vsc=null,d_.clearRecycleUrl(),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){if(this.setTitle(_r.getAtlasSubPath("bag/bag_text_tittle.png")),ui.SubPanel.prototype.onAdd.call(this,e),this.vsc.updateItemEnabled(),hr.isDebug)for(var t in TR.bagModel.goodsList)TR.bagModel.goodsList[t]},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),TR.ins.selectGoodsId=-1},i.checkNotice=function(e){var t=0;if("1"==e&&TR.ins.isShowRecycleTip()&&(t=3),"2"==e&&TR.ins.hasUsableItem()&&(t=3),"3"==e&&AN.ins.getStateByCareList([54])&&(t=3),"4"==e){if(gR.ins.lv<this.openComLv)return 1;CR.ins.hasRedPoint&&(t=3)}return t},i.setFirstTab=function(e){var t=this;TR.ins.forRed&&(TR.ins.forRed=!1,this.callLater(function(){t.vsc.selectedIndex=e}))},i.updateView=function(e){if(e&&e.hasOwnProperty("_subIndex_"))switch(e._subIndex_){case 3:e.hasOwnProperty("id")&&(TR.ins.selectGoodsId=e.id),this.vsc.selectedView instanceof modules.backpack.views.sub.BackPackComView&&this.vsc.selectedView.checkSelectGoods()}},t}(),h0=function(t){function e(){this._max=0,this.showDto=null,e.__super.call(this)}b(e,"modules.backpack.views.BagPackageOpenPanel",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.list_reward.itemRender=Bj,e.list_reward.selectHandler=ql.create(e,e.onGoodSelected,null,!1),e.list_reward.selectEnable=!0,e.list_reward.repeatX=4,e.list_reward.spaceX=15,e.list_reward.vScrollBarSkin="",e.list_reward.spaceY=5,e.list_reward.scrollBar.elasticBackTime=100,e.list_reward.scrollBar.elasticDistance=30},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_min.on("click",t,t.onBtnClicked),t.btn_sub.on("click",t,t.onBtnClicked),t.btn_add.on("click",t,t.onBtnClicked),t.btn_max.on("click",t,t.onBtnClicked),t.btn_use.on("click",t,t.onBtnClicked),t.btn_close.on("click",t,t.onCloseClicked),t.list_reward.scrollBar.on("change",t,t.onScrollChanged),t.txt_num.changeText("1")},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_min.off("click",t,t.onBtnClicked),t.btn_sub.off("click",t,t.onBtnClicked),t.btn_add.off("click",t,t.onBtnClicked),t.btn_max.off("click",t,t.onBtnClicked),t.btn_use.off("click",t,t.onBtnClicked),t.btn_close.off("click",t,t.onCloseClicked),t.list_reward.scrollBar.off("change",t,t.onScrollChanged)},i.onGoodSelected=function(e){var t=this.list_reward.array[e];if(!(t.id-1>nN.instance.currentLevel)){t.selected=!0;for(var i=0;i<this.list_reward.array.length;i++){var n=this.list_reward.array[i];if(i!=e&&n.selected){n.selected=!1,this.list_reward.changeItem(i,n);break}}}},i.updateShow=function(e){this.showDto=e;for(var t=Bi.MODEL.selectGoods(e.cfgIdx).split(";"),i=gR.ins.actorList[0].job,n=[],s=0;s<t.length;s++){var o=t[s].split(",");if(0==o[2]||o[2]==i){var a=yB.create(parseInt(o[0]),parseInt(o[1])),r=new Object;r.dto=a,r.selected=0==s,n.push(r)}}this.list_reward.dataSource=n,this.list_reward.selectedIndex=0,this.g_mask.visible=this.list_reward.length>2*this.list_reward.repeatX},i.onBtnClicked=function(e){var t=this,i=0;switch(e.currentTarget){case t.btn_min:t.txt_num.changeText("1");break;case t.btn_sub:1<(i=parseInt(t.txt_num.text))&&i--,t.txt_num.changeText(i.toString());break;case t.btn_add:(i=parseInt(t.txt_num.text))<t.showDto.goodsNum&&i++,t.txt_num.changeText(i.toString());break;case t.btn_max:t.txt_num.changeText(t.showDto.goodsNum.toString());break;case t.btn_use:var n=t.showDto.uuId,s=t.list_reward.selectedItem.dto,o=parseInt(t.txt_num.text);OR.reqOpenPackage(n,s.goodsId,o)}},i.onCloseClicked=function(e){this.close()},i.onScrollChanged=function(){0==this.list_reward.scrollBar.max||this.list_reward.scrollBar.value>=this.list_reward.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},e.NAME="BagPackageOpenPanel",e}(Qe),_0=function(e){function t(){this.composeData=null,this.model=null,t.__super.call(this),this.model=CR.ins,this.img_tips.x=138,this.img_tips.y=-5,this.img_xz.visible=!1}b(t,"modules.backpack.views.item.BagComposeBtn",e);var i=t.prototype;return i.onAdd=function(e){this.btn_title.on("click",this,this.onClickSType)},i.onRemove=function(e){this.btn_title.off("click",this,this.onClickSType)},i.selected=function(e){this.img_xz.visible=e},i.onClickSType=function(e){Tu.sendToModule("UPDATE_ERJI_TITLE",["modules.backpack.BackpackModule"],{keys:this.composeData.tKey,sType:this.composeData.sType,sItemType:this.composeData.sitemType})},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){null!=e&&(this.composeData=e,this.btn_title.label=e.tName,this.img_tips.visible=!1,this.model.smallTypeHash.has(e.bType+"_"+e.sType)&&(this.img_tips.visible=this.model.smallTypeHash.take(e.bType+"_"+e.sType)),this.img_xz.visible=e.selected)}),t}(We),f0=function(e){function t(){var e=this;e.goodsCost_0=null,e.goodsCost_1=null,e.goodsCost_2=null,e.goodsTarget=null,e.changeKey=0,e.targetGoodsId="",t.__super.call(e),e.btnAdd_0.x=70,e.btnAdd_1.x=166,e.btn_dy.x=263}b(t,"modules.backpack.views.item.BagComposeItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_com.on("click",this,this.onClickCom)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_com.off("click",this,this.onClickCom)},i.onClickCom=function(e){if(0<TR.ins.getLeftGridNum())OR.requestExchange(this.changeKey);else if(!TR.ins.hasEmptyNum(20))return void KQ.ins.showmoyuRecycle()},i.setFilter=function(e){this.btnAdd_0.disabled=this.btnAdd_1.disabled=!e,this.btn_dy.disabled=this.btn_com.disabled=!e},i.hideImage=function(){var e=this;e.img_0.visible=e.img_1.visible=e.img_2.visible=e.img_3.visible=!1,e.btnAdd_0.visible=e.btnAdd_1.visible=!1,e.goodsCost_1&&e.goodsCost_1.parent&&e.goodsCost_1.parent.removeChild(e.goodsCost_1),e.goodsCost_2&&e.goodsCost_2.parent&&e.goodsCost_2.parent.removeChild(e.goodsCost_2)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.hideImage();var i=[],n=0,s=0,o=0,a=Ts.getIndex(parseInt(e)),r=Ts.MODEL.conditions(a);t.changeKey=Ts.MODEL.changeKey(a),i=JSON.parse(r);for(var l,c=!0,u=1,d=0,h=0;h<i.length;h++)n=i[h].value.split(":")[0],s=i[h].value.split(":")[1],d=Bi.getIndex(n),o=1==Bi.MODEL.subType(d)?TR.ins.getLongWenNum(n):TR.ins.getGoodsNum(n),l=new Object,null==t["goodsCost_"+h]&&(t["goodsCost_"+h]=new LF),t["goodsCost_"+h].setGridSize(55),t["goodsCost_"+h].size(96,96),null==t["goodsCost_"+h].parent&&t.addChild(t["goodsCost_"+h]),t["goodsCost_"+h].x=t["img_"+h].x-20,t["goodsCost_"+h].y=t["img_"+h].y,l.bindData=yB.create(n,s),l.isGray=o<s,l.needGoodsNum=!0,l.isLongWen=!1,t["goodsCost_"+h].bindData(l),o<s&&1==u&&(c=!1,u=0);l=new Object,r=Ts.MODEL.target(a);var _=JSON.parse(r);n=_.value.split(":")[0],s=_.value.split(":")[1],null==t.goodsTarget&&(t.goodsTarget=new LF),t.goodsTarget.setGridSize(55),t.goodsTarget.size(82,82),null==t.goodsTarget.parent&&t.addChild(t.goodsTarget),l.bindData=yB.create(n,s),l.isGray=!c,t.goodsTarget.bindData(l),t.goodsTarget.x=t.img_3.x-20,t.goodsTarget.y=t.img_3.y,t.targetGoodsId=n.toString(),t.setFilter(c),1==i.length||(2==i.length?t.btnAdd_0.visible=!0:3==i.length&&(t.btnAdd_0.visible=t.btnAdd_1.visible=!0))}}),t}(qe),p0=function(e){function t(){this.goodsCost_0=null,this.goodsTarget=null,this.changeKey=0,this.targetGoodsId="",t.__super.call(this)}b(t,"modules.backpack.views.item.BagComposeItem2",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_com.on("click",this,this.onClickCom)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_com.off("click",this,this.onClickCom)},i.onClickCom=function(e){if(0<TR.ins.getLeftGridNum())OR.requestExchange(this.changeKey);else if(!TR.ins.hasEmptyNum(20))return void KQ.ins.showmoyuRecycle()},i.setFilter=function(e){this.btn_xh.disabled=this.btn_dy.disabled=this.btn_com.disabled=!e,this.fc_num.disabled=!e},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){var i=[],n=0,s=0,o=0,a=Ts.getIndex(parseInt(e)),r=Ts.MODEL.conditions(a);t.changeKey=Ts.MODEL.changeKey(a),i=JSON.parse(r);for(var l,c=!0,u=1,d=0,h=0;h<i.length&&!(1<=h);h++)n=i[h].value.split(":")[0],s=i[h].value.split(":")[1],d=Bi.getIndex(n),o=1==Bi.MODEL.subType(d)?TR.ins.getLongWenNum(n):TR.ins.getGoodsNum(n),l=new Object,null==t["goodsCost_"+h]&&(t["goodsCost_"+h]=new LF),t["goodsCost_"+h].setGridSize(64),t["goodsCost_"+h].size(96,96),t.addChild(t["goodsCost_"+h]),t["goodsCost_"+h].x=t["img_"+h].x-16,t["goodsCost_"+h].y=t["img_"+h].y,l.bindData=yB.create(n,s),l.isGray=o<s,l.needGoodsNum=!1,t["goodsCost_"+h].bindData(l),o<s&&1==u&&(c=!1,u=0),t.fc_num.value=s.toString();l=new Object,r=Ts.MODEL.target(a);var _=JSON.parse(r);n=_.value.split(":")[0],s=_.value.split(":")[1],null==t.goodsTarget&&(t.goodsTarget=new LF),t.goodsTarget.setGridSize(64),t.goodsTarget.size(82,82),null==t.goodsTarget.parent&&t.addChild(t.goodsTarget),l.bindData=yB.create(n,s),l.isGray=!c,t.goodsTarget.bindData(l),t.goodsTarget.x=t.img_1.x-16,t.goodsTarget.y=t.img_1.y,t.targetGoodsId=n.toString(),t.setFilter(c)}}),t}(Fe),g0=function(e){function t(){var e=this;e.tipBtnList=null,e.smallBtnPanel=null,e.cBigType=1,e.cSmallType=1,e.cSmallItemType=1,e.composeIds="",e.effect=null,e.model=null,t.__super.call(e),e.model=CR.ins,e.panel_btn.width=187,e.initUI()}b(t,"modules.backpack.views.sub.BackPackComView",je);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.updateByVSC(null)},i.updateByVSC=function(e){},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);for(var i=0;i<t.tipBtnList.length;i++)t.tipBtnList[i].on("click",t,t.onClickBigType);t.list.scrollBar.on("change",t,t.onScrollChanged),t.initInfo(!0),t.checkSelectGoods()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e);for(var i=0;i<t.tipBtnList.length;i++)t.tipBtnList[i].off("click",t,t.onClickBigType);t.list.scrollBar.off("change",t,t.onScrollChanged),t.effect&&(t.effect.parent&&t.effect.parent.removeChild(t.effect),t.effect.dispose(),t.effect=null)},i.checkSelectGoods=function(){var e=this;if(-1!=TR.ins.selectGoodsId){var t=CR.ins.findComIndex(TR.ins.selectGoodsId);if(null!=t&&e.tipBtnList.length>t.index1){e.list.array=[],e.cBigType=e.tipBtnList[t.index1].bigType,e.cSmallType=t.sType;var i=Cs.MODEL.composeKeys(e.cBigType-1).split("|")[t.index2],n=Cs.MODEL.backType(e.cBigType-1),s=parseInt(n.split(",")[t.index2]);e.refreshView(),e.showSTypeList({keys:i,sType:e.cSmallType,sItemType:s})}TR.ins.selectGoodsId=-1}},i.showEffect=function(){var e=this;e.effect&&(e.effect.parent&&e.effect.parent.removeChild(e.effect),e.effect.dispose(),e.effect=null),e.effect=mj.GetNew(),e.effect.renderInSelf=!0,e.effect.loadEffect("jm1333"),e.effect.pos(e.width/2,e.height/2),e.addChild(e.effect)},i.refreshView=function(){for(var e=0;e<this.tipBtnList.length;e++)this.tipBtnList[e].rfpt();this.showCSType(!1)},i.showSTypeList=function(e){var t=this;e&&(t.composeIds=e.keys,t.cSmallType=e.sType,t.cSmallItemType=e.sItemType,t.list.dataSource=[],1==t.cSmallItemType?t.list.itemRender=f0:2==t.cSmallItemType&&(t.list.itemRender=p0),t.list.dataSource=t.composeIds.split(","),t.smallBtnPanel.setSelectedItem(t.cSmallType),t.autoSelected())},i.initInfo=function(e){var t=this.model.getComKeys(this.cBigType,e);this.cBigType=t.bType,this.cSmallType=t.sType,this.composeIds=t.comIds,this.cSmallItemType=t.randerType,this.showCSType(),this.refreshView()},i.showCSType=function(e){var t=this;void 0===e&&(e=!0),t.smallBtnPanel.showSType(t.cBigType,t.cSmallType),t.refreshBtnPos(),t.composeIds&&(t.list.dataSource=[],1==t.cSmallItemType?t.list.itemRender=f0:2==t.cSmallItemType&&(t.list.itemRender=p0),t.list.dataSource=t.composeIds.split(",")),e&&t.autoSelected()},i.autoSelected=function(){for(var e=0,t=0,i=this.composeIds.split(","),n=0;n<i.length;n++){t=Ts.getIndex(i[n]);var s=Ts.MODEL.conditions(t);if(s)if(1==this.model.checkHasEnoughToolds(s)){e=n;break}}1==this.cSmallItemType?this.list.scrollBar.value=126*e:2==this.cSmallItemType&&(this.list.scrollBar.value=145*e)},i.refreshBtnPos=function(){var e=this,t=0,i=!1;for(t=0;t<e.tipBtnList.length;t++)t<=e.cBigType-1?(e.tipBtnList[t].y=10+68*t,i=!1,t==e.cBigType-1&&(e.smallBtnPanel.y=e.tipBtnList[t].y+68+4,i=!0)):(e.tipBtnList[t].y=68*(t-e.cBigType)+e.smallBtnPanel.y+e.smallBtnPanel.height+6,i=!1),e.tipBtnList[t].isSselected(i)},i.onClickBigType=function(e){e.currentTarget.bigType!=this.cBigType&&(this.cBigType=e.currentTarget.bigType,this.initInfo(!1))},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.initUI=function(){var e,t=this;t.list.vScrollBarSkin="",t.list.scrollBar.elasticDistance=300,t.list.spaceY=10,t.list.dataSource=[],t.tipBtnList=[];var i=0;for(i=0;i<Cs.count;i++)(e=new lW).setDataInfo(i),e.isSselected(!1),t.panel_btn.addChild(e),e.x=0,e.y=10+68*i,t.tipBtnList.push(e);t.smallBtnPanel=new u0,t.smallBtnPanel.x=0,t.panel_btn.addChild(t.smallBtnPanel)},t.BTN_HEIGHT=68,t}(),v0=function(e){function t(){this.selNum=0,t.__super.call(this)}b(t,"modules.backpack.views.GridOpenView",Ll);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onOK),ad.reqMonthCardInfo(),_g.reqTqMonthCard(),this.updateNum(Rt.MODEL.baseGridNum(0))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onOK)},i.updateNum=function(e){this.selNum=e;var t=0<gR.ins.VIPLevel?Rt.MODEL.vipGridNum(0)[gR.ins.VIPLevel-1]:0,i=ld.ins.data22303,n=hg.ins.datas22352,s=0;i&&0<i.dayLeft&&(s+=parseInt($e.MODEL.value($e.getIndex(60)))),n&&0<n.leftTime&&(s+=parseInt($e.MODEL.value($e.getIndex(136))));for(var o=TR.ins.gridNum-Rt.MODEL.initGridNum(0)-t-s,a=Rt.MODEL.costGolds(0),r=0,l=0;l<this.selNum;l++)r+=a[o+l];this.txt_num.changeText(this.selNum+""),this.txt_cost.innerHTML=r.toString(),this.g_icon.x=318+(129-this.txt_cost.contextWidth)/2,this.txt_cost.x=this.g_icon.x+67},i.onOK=function(e){var t=this,i=0<gR.ins.VIPLevel?Rt.MODEL.vipGridNum(0)[gR.ins.VIPLevel-1]:0,n=TR.ins.gridNum-Rt.MODEL.initGridNum(0)-i,s=Rt.MODEL.baseGridNum(0),o=Rt.MODEL.maxBuyGridNum(0);switch(e.target){case t.btn_less:t.selNum>s&&t.updateNum(t.selNum-s);break;case t.btn_plus:n+t.selNum<o&&t.updateNum(t.selNum+s);break;case t.btn_ok:OR.reqOpenGrid(t.selNum);break;case t.btn_close:case t.btn_cancel:t.close()}},t}(),m0=function(e){function t(){var e=this;e.gridPanel=null,t.__super.call(e),e.gridPanel=new wj(7,5,116,16,32,!0,null,0,!0),e.gridPanel.pos(34,111),e.gridPanel.resetPosY=5,e.gridPanel.top=116,e.gridPanel.bottom=151,e.addChild(e.gridPanel),e.setChildIndex(e.g_mask,e.numChildren-1),e.txt_no.visible=!1,e.gridPanel.vScrollBar.on("change",e,e.onScrollChanged)}b(t,"modules.backpack.views.sub.BackPackItemView",ze);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){void 0===e&&(e=!0),this.gridPanel&&this.gridPanel.vScrollBar&&this.gridPanel.vScrollBar.off("change",this,this.onScrollChanged),this.gridPanel.destroy(e),this.gridPanel=null,ui.SubPanel.prototype.destroy.call(this,e)},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){this.updateByVSC(null);var i,n=TR.ins.getBackPackItems();for(var s in n)i=n[s],-1!=VQ.instance.giftList.indexOf(i.goodsId)&&OR.reqGiftInfo()},i.updateByVSC=function(e){var t=TR.ins.getBackPackItems();t.sort(function(e,t){var i=e.cfgIdx,n=t.cfgIdx;return Bi.MODEL.colourId(i)<Bi.MODEL.colourId(n)?1:Bi.MODEL.colourId(i)==Bi.MODEL.colourId(n)&&e.goodsId>t.goodsId?1:-1}),this.gridPanel.gridDatas=t,this.txt_no.visible=t.length<1,this.g_mask.visible=42<t.length},i.onScrollChanged=function(){0==this.gridPanel.vScrollBar.max||this.gridPanel.vScrollBar.value>=this.gridPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),y0=function(e){function t(){var e=this;e.NUM=9,e.EFF_ID="jm0001",e.gridList=[],e.txtList=[],e.selList=[],e.allList=[],e._isReq=!1,e._time=0,e.toc=null,e.btn_stage=1,e.isOpenBackpack=!1,e.delayGuideId=0,e.isUpdate=!0,e._$9_timer=new Zp,t.__super.call(e),e.txt_link.underline=!0}b(t,"modules.backpack.views.RecycleView",h_);var i=t.prototype;return i.update=function(){var e=this;if(e._isReq){e._isReq=!1;for(var t=0;t<e.selList.length&&!(8<t);t++)kB.createEffect(e.EFF_ID,e["bg"+t].x+53,e["bg"+t].y+53,e)}var i=TR.bagModel.goodsList.length;e.toc=hg.ins.datas22352,0<e.toc.leftTime&&(e.allList=TR.ins.getRecycleEquips(la.NORMAL,i)),e.selList=TR.ins.getRecycleEquips(la.NORMAL,e.NUM);for(var n=0;n<9;n++){var s,o;if(n<e.selList.length){n<e.gridList.length?(s=e.gridList[n],o=e.txtList[n]):((s=new MF).isShowJob=!0,s.x=e["bg"+n].x,s.y=e["bg"+n].y,e.addChild(s),e.gridList.push(s),o=kB.createText(s.x,s.y+116+2,116,0,"",20,"",!1,"center",!1,!1,e),e.addChild(o),e.txtList.push(o));var a=e.selList[n];s.visible=!0,s.bindData=a,e.isOpenBackpack||d_.addRecycleUrl(s.getIconUrl());var r=Bi.getIndex(a.goodsId);o.visible=!0,o.changeText(0<Bi.MODEL.flyLevel(r)?Bi.MODEL.flyLevel(r)+"转":"lv."+Bi.MODEL.minUseLevel(r)),o.color="#90877b"}else n<e.gridList.length&&((s=e.gridList[n]).visible=!1,(o=e.txtList[n]).visible=!1)}e.changeLabel()},i.changeLabel=function(){this.toc&&0<this.toc.leftTime?1==this.btn_stage?this.btn_go.label=RP.n[1254]:0==this.btn_stage&&(this.btn_go.label=RP.n[1255]):this.btn_go.label="熔 炼"},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),d_.recycleUrl.length=0,t.isOpenBackpack=hN.ins.isOpen("BAGPACK"),t.btn_go.on("click",t,t.onRecycle),t.btn_main.on("click",t,t.onRecycle),t.btn_close.on("click",t,t.close),t.txt_link.on("click",t,t.gotoTqMonth),t.box_link.visible=EB.showCharge,t.update(),t.doShowGuide(13);for(var i=0;i<9&&!(8<i);i++){mj.GetNew().loadEffect(t.EFF_ID)}},i.gotoTqMonth=function(){gR.ins.lv<30?zB.ins.showMsg(RP.n[1256],1):0!=EB.showCharge&&hN.ins.open("MONTHCARD",{selectedIndex:1})},i.doShowGuide=function(e){if(pn.hasIndex(e)&&e!=this.delayGuideId){var t=pn.getIndex(e),i=pn.MODEL.delaytime(t);0<i?(this.delayGuideId=e,G.timer.once(i,this,this.showGuide,[e,!0])):this.showGuide(e,!0)}},i.showGuide=function(e,t){var i=this;if(void 0===t&&(t=!1),t){if(i.delayGuideId=0,21==e){var n=new u_;n.x=i.btn_main.x,n.y=i.btn_main.y-10,n.width=i.btn_main.width,n.height=i.btn_main.height,LY.Ins().show(e,n,!1,i);var s=i.btn_main.localToGlobal(new Uh);hN.ins.open("LOCK_SCENE_HOLLOW",{vx:s.x,vy:s.y,vw:i.btn_main.width,vh:i.btn_main.height},null,!0)}else if(PH.Ins().hasNewGuide(e))switch(e){case 13:var o=new u_;o.x=i.btn_go.x,o.y=i.btn_go.y-30,o.width=i.btn_go.width,o.height=i.btn_go.height+40,LY.Ins().show(e,o,!1,i);var a=i.btn_go.localToGlobal(new Uh);hN.ins.open("LOCK_SCENE_HOLLOW",{vx:a.x,vy:a.y,vw:i.btn_go.width,vh:i.btn_go.height},null,!0)}}else ui.SubPanel.prototype.showGuide.call(i,e,t)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onRecycle),t.btn_main.off("click",t,t.onRecycle),t.btn_close.off("click",t,t.close),t.txt_link.off("click",t,t.gotoTqMonth),t.selList.length=0,t.allList=[],t._isReq=!1,G.timer.clear(t,t.showGuide),hN.ins.close("LOCK_SCENE_HOLLOW"),G.timer.clearAll(t),t.btn_stage=1,t.changeLabel(),t.isOpenBackpack||d_.clearRecycleUrl()},i.onResize=function(){ui.ViewBase.prototype.onResize.call(this),LY.showing&&0<LY.Ins().currGuideId&&this.showGuide(LY.Ins().currGuideId,!0)},i.close=function(){ui.SubPanel.prototype.close.call(this),LY.showing&&LY.Ins().close(0,!0)},i.onRecycle=function(e){var t=this;if(e.currentTarget==t.btn_main)return t.close(),void hN.ins.close("BAGPACK");if(LY.showing&&13==LY.Ins().currGuideId&&(hN.ins.close("LOCK_SCENE_HOLLOW"),t.showGuide(13,!1),t.doShowGuide(21)),300<BB.getTimer()-t._time)if(t._time=BB.getTimer(),t.selList&&t.selList.length){var i,n=[];for(var s in t.selList)i=t.selList[s],n.push(i.uuId);if(t.toc&&0<t.toc.leftTime){var o,a=[];for(var r in t.allList)o=t.allList[r],a.push(o.uuId);OR.reqRecycle(a)}else OR.reqRecycle(n);t._isReq=!0,UB.ins.playSound("5",3,!0)}else zB.ins.showById(1304,1)},t}(),I0=function(e){function t(){var e=this;e._desc=null,e._icon=null,e._randomText=null,e._randomPanel=null,e.goodsId=0,e.giftTime=0,e.timeHash=null,e.serviceTime=0,e.auctionGoodsTime=0,t.__super.call(e),(t._ins=e)._icon=new AF,e._icon.pos(30,0),e.addChild(e._icon),e._desc=kB.createHtmlDiv(e.txt_desc.x,e.txt_desc.y,e.txt_desc.fontSize,e.txt_desc.color,e.txt_desc.width,e.txt_desc.height),e._desc.style.leading=17,kB.replace(e.txt_desc,e._desc),e._randomText=kB.createHtmlDiv(e.txt_desc.x,0+Math.max(e._desc.contextHeight,100),24,"#FFFFFF",e.txt_desc.width)}b(t,"modules.backpack.views.tip.GoodsContent",cl);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e);var t,i=TR.ins.getBackPackItems();for(var n in i)t=i[n],-1!=VQ.instance.giftList.indexOf(t.goodsId)?OR.reqGiftInfo():ca.isBlackMacketGoods(t.goodsId)&&OR.reqAucGoodsTime(t.uuId)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),TR.ins.isChange=!1,G.timer.clear(this,this.showTime)},i.update=function(a,e){var r=this;this.lab_time.visible=!1,this.txt_time.visible=!1,this.goodsId=a.goodsId;var t=a.cfgIdx;this.txt_num.changeText(a.goodsNum+"");var i=Bi.MODEL.minUseLevel(t),n=Bi.MODEL.flyLevel(t);0<n?(this.lab_lv.changeText("转生："),this.txt_lv.changeText(n+"转"),this.txt_lv.color=gR.ins.zsLv>=n?"#90877b":"#e70909"):(this.lab_lv.changeText("等级："),this.txt_lv.changeText(1<i?i+"级":"无限制"),this.txt_lv.color=gR.ins.lv>=i?"#90877b":"#e70909"),this.timeHash=TR.ins.goodtimesHash,this.serviceTime=0,this.serviceTime=this.timeHash.take(a.goodsId),this.giftTime=this.serviceTime,this.serviceTime?(this.lab_time.visible=!0,this.txt_time.visible=!0,this.lab_time.text="时限：",this.showTime(),G.timer.loop(1e3,this,this.showTime,null)):(this.lab_time.visible=!1,this.txt_time.visible=!1),TR.ins.getGoodsDes(a.goodsId,ql.create(this,function(e,t,i){i=mp.replace(i,"\\\\n","\n");var n=Bi.MODEL.useLimitOfDay(Bi.getIndex(t));if(0<n){var s=TR.ins.getGoodsUseNum(r.goodsId);i=n<=s?vp.getReplace(i,"\\{0\\}",Ql.createColor(n-s+"","#ff2e24")):vp.getReplace(i,"\\{0\\}",Ql.createColor(n-s+"","#23b11f"))}r._desc.innerHTML=i;var o=r._desc.y+Math.max(r._desc.contextHeight,100)+14;2523==a.goodsId?(r.setRandomDragon(),o=r._randomPanel?r._randomPanel.y+r._randomPanel.height+30:r._randomText.y+r._randomText.contextHeight-20):r._randomText&&r._randomText.parent&&(r._randomText.innerHTML="",r._randomPanel&&(r._randomPanel.removeSelf(),r._randomPanel.destroy(),r._randomPanel=null)),r.img_line.y=o,e&&e.run()},[e])),this._icon.bindData=a.goodsId},i.updateTimeTxt=function(){this.timeHash=TR.ins.goodtimesHash,this.serviceTime=0,this.serviceTime=this.timeHash.take(this.goodsId),this.giftTime=this.serviceTime,this.showTime()},i.updateTime=function(){var e=this;G.timer.clear(e,e.showTime),e.timeHash=TR.ins.goodtimesHash,e.serviceTime=0,e.serviceTime=e.timeHash.take(e.goodsId),e.giftTime=e.serviceTime,e.serviceTime?(e.lab_time.visible=!0,e.txt_time.visible=!0,e.lab_time.text="时限：",e.showTime(),G.timer.loop(1e3,e,e.showTime,null)):(e.lab_time.visible=!1,e.txt_time.visible=!1)},i.showTime=function(){this.giftTime<=0?G.timer.clear(this,this.showTime):(this.giftTime--,this.txt_time.text=this.getDHM(this.giftTime))},i.updateAuctionGoodsTime=function(e,t){void 0===t&&(t=!0),t?(this.auctionGoodsTime=e,this.lab_time.visible=!0,this.txt_time.visible=!0,this.lab_time.text="时限：",this.showAuctionGoodsTime(),G.timer.loop(1e3,this,this.showAuctionGoodsTime,null)):(this.lab_time.visible=!1,this.txt_time.visible=!1)},i.showAuctionGoodsTime=function(){this.auctionGoodsTime<=0?G.timer.clear(this,this.showAuctionGoodsTime):(this.auctionGoodsTime--,this.txt_time.text=this.getDHM(this.auctionGoodsTime))},i.getDHM=function(e){var t=e;t<=0&&VQ.instance.close(!0);var i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),s=t-3600*i-60*n;return i<=0?10<=n?"00:"+n+(10<=s?":":":0")+s:"00:0"+n+(10<=s?":":":0")+s:i<=0&&n<=0?10<=s?"00:00:"+s:"00:00:0"+s:(10<=i?"":"0")+i+(10<=n?":":":0")+n+(10<=s?":":":0")+s},i.setRandomDragon=function(){var e=this,t="";t+=Ql.createColor(RP.n[1257],"#90877b"),t+=Ql.newline();for(var i,n=!1,s=[],o=0;o<Os.count;o++){if(1==Os.MODEL.show(o))for(var a in i=lR.instance().longwenOpenTypeList)i[a],-1!=i.indexOf(Os.MODEL.key(o))&&-1==s.indexOf(Os.MODEL.key(o))&&(s.push(Os.MODEL.key(o)),n=!0,t+=Ql.createColor(Os.MODEL.name(o)+":","#23b11f")+Ql.createColor(Os.MODEL.dest(o),"#90877b"),t+=Ql.newline())}e._randomText.style.lineHeight=24,e._randomText.style.leading=20,e._randomText.innerHTML=n?t:t+Ql.createColor("无","#ff2e24"),15<i.length?(null==e._randomPanel&&(e._randomPanel=new Eh,e._randomPanel.size(e.width,500),e._randomPanel.vScrollBarSkin=null,e.addChild(e._randomPanel),e._randomPanel.addChild(e._randomText)),e._randomText.y=0,e._randomPanel.scrollTo(0,0),e._randomPanel.y=e._desc.y+e._desc.contextHeight-30):(e._randomText.y=e._desc.y+e._desc.contextHeight-30,e.addChild(e._randomText)),e._randomPanel?e.height=e._randomPanel.y+e._randomPanel.height+30:e.height=e._randomText.y+e._randomText.contextHeight-30},p(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins},layouts.bag.GoodsContentUI._$SET_ins),t._ins=null,t}(),b0=function(e){function t(){var e=this;e._desc=null,e._icon=null,e._randomText=null,e.goodsId=0,e.giftTime=0,t.__super.call(e),(t._ins=e)._icon=new AF,e._icon.pos(90,0),e.addChild(e._icon),e._desc=kB.createHtmlDiv(e.txt_desc.x,e.txt_desc.y,e.txt_desc.fontSize,e.txt_desc.color,e.txt_desc.width,e.txt_desc.height),e._desc.style.leading=17,kB.replace(e.txt_desc,e._desc),e._randomText=kB.createHtmlDiv(e.txt_desc.x,e._desc.y+Math.max(e._desc.contextHeight,100),24,"#FFFFFF",e.txt_desc.width),e.addChild(e._randomText)}b(t,"modules.backpack.views.tip.GoodsContent2",ll);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e);var t,i=TR.ins.getBackPackItems();for(var n in i)t=i[n],-1!=VQ.instance.giftList.indexOf(t.goodsId)&&OR.reqGiftInfo()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),TR.ins.isChange=!1,G.timer.clear(this,this.showTime)},i.update=function(s,e){var o=this;this.lab_time.visible=!1,this.txt_time.visible=!1,this.goodsId=s.goodsId;var t=s.cfgIdx;this.txt_num.changeText(s.goodsNum+"");var i=Bi.MODEL.minUseLevel(t),n=Bi.MODEL.flyLevel(t);0<n?(this.lab_lv.changeText("转生："),this.txt_lv.changeText(n+"转"),this.txt_lv.color=gR.ins.zsLv>=n?"#90877b":"#e70909"):(this.lab_lv.changeText("等级："),this.txt_lv.changeText(1<i?i+"级":"无限制"),this.txt_lv.color=gR.ins.lv>=i?"#90877b":"#e70909");var a;a=TR.ins.goodtimesHash.take(s.goodsId),(this.giftTime=a)?(this.lab_time.visible=!0,this.txt_time.visible=!0,this.lab_time.text="时限：",G.timer.loop(1e3,this,this.showTime,null,!1)):(this.lab_time.visible=!1,this.txt_time.visible=!1),TR.ins.getGoodsDes(s.goodsId,ql.create(this,function(e,t,i){i=mp.replace(i,"\\\\n","\n"),o._desc.innerHTML=i;var n=o._desc.y+Math.max(o._desc.contextHeight,100)+14;2523==s.goodsId?(o.setRandomDragon(),n=o._randomText.y+o._randomText.contextHeight+30):o._randomText&&o._randomText.parent&&(o._randomText.innerHTML=""),o.img_line.y=n,e&&e.run()},[e])),this._icon.bindData=s.goodsId},i.updateTimeTxt=function(){this.showTime()},i.showTime=function(){this.giftTime<=0?G.timer.clear(this,this.showTime):(this.giftTime--,this.txt_time.text=this.getDHM(this.giftTime))},i.getDHM=function(e){var t=e;t<=0&&VQ.instance.close(!0);var i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),s=t-3600*i-60*n;return i<=0?10<=n?"00:"+n+(10<=s?":":":0")+s:"00:0"+n+(10<=s?":":":0")+s:i<=0&&n<=0?10<=s?"00:00:"+s:"00:00:0"+s:(10<=i?"":"0")+i+(10<=n?":":":0")+n+(10<=s?":":":0")+s},i.setRandomDragon=function(){var e="";e+=Ql.createColor(RP.n[1257],"#90877b"),e+=Ql.newline();for(var t=!1,i=[],n=0;n<Os.count;n++)if(1==Os.MODEL.show(n)){var s=lR.instance().longwenOpenTypeList;for(var o in s)s[o],-1!=s.indexOf(Os.MODEL.key(n))&&-1==i.indexOf(Os.MODEL.key(n))&&(i.push(Os.MODEL.key(n)),t=!0,e+=Ql.createColor(Os.MODEL.name(n)+":","#23b11f")+Ql.createColor(Os.MODEL.dest(n),"#FFFFFF"),e+=Ql.newline())}t?this._randomText.innerHTML=e:(this._randomText.innerHTML=e+Ql.createColor("无","#ff2e24"),this._randomText.style.lineHeight=30),this.height=this._randomText.y+this._randomText.contextHeight+20},p(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins},layouts.bag.GoodsContent2UI._$SET_ins),t._ins=null,t}(),w0=function(e){function t(){var e=this;e._grid=null,e.goodsID=0,e.uuid=0,e.dto=null,e.gold=0,t.__super.call(e),e.centerX=0,e.centerY=0,e._grid=new MF,e.img_icon.addChild(e._grid)}b(t,"modules.backpack.views.tip.RemindUseGood",RI);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_use.on("click",this,this.onClick),this.btn_close.on("click",this,this.onClose)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_use.off("click",this,this.onClick),this.btn_close.off("click",this,this.onClose)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onClose=function(e){hN.ins.close("REMINDUSE")},i.onClick=function(e){var t=!1,i=TR.ins.getBackPackItems();if(0<i.length)for(var n=0;n<i.length;n++)i[n].uuId!=this.uuid||(t=!0);if(1==t){var s=Bi.getIndex(this.goodsID),o=Bi.MODEL.event2(s).split("|");this.gold=0|o[2];var a=yB.create(this.goodsID);this.showConfirmGold(a,this.gold)}else zB.ins.showMsg(RP.n[1259],1),hN.ins.close("REMINDUSE")},i.showConfirmGold=function(e,t){if(t<=0)OR.reqUseGoods(this.uuid,1),hN.ins.close("REMINDUSE");else{var i=RP.n[170]+Ql.createColor(t+"元宝","#fcd132")+"打开"+Ql.createColor(Bi.MODEL.name(e.cfgIdx),ms.getByQuality(Bi.MODEL.colourId(e.cfgIdx)));KQ.ins.show(i,ql.create(this,this.onConfirm),!0)}},i.onConfirm=function(e){1==e&&(gR.ins.YB>=this.gold?(OR.reqUseGoods(this.uuid,1),hN.ins.close("REMINDUSE")):KQ.ins.showNoGold())},i.update=function(e){this.goodsID=e[0],this.uuid=e[1],this.dto=yB.create(this.goodsID),this._grid.bindData=this.dto},t}(),x0=function(e){function t(){this.vsc=null,t.__super.call(this)}b(t,"modules.bossancient.view.BossAncientMainView",nm);var i=t.prototype;return i.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.vsc=new SB(this),this.vsc.registAll([{cls:qQ,id:0,wait:hN.wait(hN.waitAtlas(["boss"]))}]),this.vsc.selectHandler=ql.create(this,this.onViewChanged,null,!1)},i.onViewChanged=function(e,t){"0"==e&&this.setTitle(_r.getAtlasSubPath("boss/boss_text_ygboss.png"))},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),VR._canClear&&this.bg&&this.bg.skin&&G.loader.clearRes(this.bg.skin),ui.SubPanel.prototype.destroy.call(this,e)},t}(),S0=function(e){function t(){this.len=0,this.currIndex=0,t.__super.call(this),this.centerX=this.centerY=0,this.initUI()}b(t,"modules.broadcast.views.HeraldView",EI);var i=t.prototype;return i.initUI=function(){this.len=Gi.count,this.currIndex=1,this.btn_left.visible=!1,this.updateView(),this.updateBtn()},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_left.on("click",t,t.onClick),t.btn_right.on("click",t,t.onClick),t.btn_close.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_left.off("click",t,t.onClick),t.btn_right.off("click",t,t.onClick),t.btn_close.off("click",t,t.onClick)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateView=function(e){void 0===e&&(e=1);for(var t=Gi.getIndex(e),i=Gi.MODEL.img(t),n=1;n<5;n++){var s=i+n;this["img_"+n].skin=_r.getHeraldBG(s)}},i.onClick=function(e){var t=this;switch(e.currentTarget){case t.btn_left:0<t.currIndex&&t.currIndex<=t.len&&(t.currIndex-=1,t.updateView(t.currIndex)),t.updateBtn();break;case t.btn_right:0<t.currIndex&&t.currIndex<t.len&&(t.currIndex+=1,t.updateView(t.currIndex)),t.updateBtn();break;case t.btn_close:hN.ins.close("HERALD_VIEW")}},i.updateBtn=function(){var e=this;1==e.len?(e.btn_left.visible=!1,e.btn_right.visible=!1):1==e.currIndex?(e.btn_left.visible=!1,e.btn_right.visible=!0):e.currIndex==e.len?(e.btn_left.visible=!0,e.btn_right.visible=!1):(e.btn_left.visible=!0,e.btn_right.visible=!0)},t}(),k0=function(e){function t(){t.__super.call(this),this.centerX=0,this.centerY=0}b(t,"modules.changename.views.ChangeGuildNameView",os);var i=t.prototype;return i.initialize=function(){this.txt_input.maxChars=6},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.txt_tip.text=RP.n[1261],t.txt_input.text="",t.txt_dest.text=RP.n[1262],t.btn_sure.on("click",t,t.onClick),t.txt_input.on("focus",t,t.promtUpdate),t.txt_input.on("blur",t,t.promtUpdate)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t),t.btn_sure.off("click",t,t.onClick),t.txt_input.off("focus",t,t.promtUpdate),t.txt_input.off("blur",t,t.promtUpdate)},i.onClick=function(e){if(this.txt_input.text){var t=new QD;t.name=this.txt_input.text,ss.ins.guildName=this.txt_input.text,Tu.sendToService(t),this.btn_sure.disabled=!0,G.timer.once(1e3,this,this.btnDisabled)}else zB.ins.showMsg(RP.n[1263],1)},i.btnDisabled=function(){this.btn_sure.disabled=!1},i.promtUpdate=function(){this.txt_input.text&&0<this.txt_input.text.length?this.txt_dest.visible=!1:this.txt_input.focus?this.txt_dest.visible=!1:this.txt_dest.visible=!0},i.changeName=function(){},t}(),E0=function(e){function t(){t.__super.call(this),this.centerX=0,this.centerY=0}b(t,"modules.changename.views.ChangeNameViews",os);var i=t.prototype;return i.initialize=function(){this.txt_input.maxChars=6},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.txt_input.text="",t.promtUpdate(),t.btn_sure.on("click",t,t.onClick),t.txt_input.on("focus",t,t.promtUpdate),t.txt_input.on("blur",t,t.promtUpdate)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t),t.btn_sure.off("click",t,t.onClick),t.txt_input.off("focus",t,t.promtUpdate),t.txt_input.off("blur",t,t.promtUpdate)},i.onClick=function(e){if(this.txt_input.text){var t=new XD;t._name=this.txt_input.text,Tu.sendToService(t),ss.ins.name=this.txt_input.text,this.btn_sure.disabled=!0,G.timer.once(1e3,this,this.btnDisabled)}else zB.ins.showMsg(RP.n[1263],1)},i.btnDisabled=function(){this.btn_sure.disabled=!1},i.promtUpdate=function(){this.txt_input.text&&0<this.txt_input.text.length?this.txt_dest.visible=!1:this.txt_input.focus?this.txt_dest.visible=!1:this.txt_dest.visible=!0},i.changeName=function(){for(var e=gR.ins.actorList,t=0;t<e.length;t++){var i=e[t];if(i)uH.getHero(i.id).char_name=ss.ins.name}gR.ins.charName=ss.ins.name,uY.ins.changeName(ss.ins.name),NF.mainChar.char_name=ss.ins.name},t}(),T0=(function(e){function t(){this.strLevel=null,this.playerId=NaN,t.__super.call(this)}b(t,"modules.chat.views.otherInfo",e);var i=t.prototype;i.checkOther=function(e){hN.ins.close("OTHER"),this.playerId=QB.ins.playID,nR.reqViewOther(this.playerId)},i.priChat=function(e){hN.ins.close("OTHER"),tJ.ins.toPriChat()},i.onAdd=function(e){this.centerX=0,this.centerY=0,this.btn_other.on("click",this,this.checkOther),this.btn_own.on("click",this,this.priChat)},i.onRemove=function(e){this.btn_other.off("click",this,this.checkOther),this.btn_own.off("click",this,this.priChat)},i.update=function(e){this.strLevel="";pR.ins.actorById(0);this.mcHead.skin=_r.getActorHeadPath(e.roleType,e.sex),this.txt_name.changeText(e.name),0<e.flyLevel&&(this.strLevel+=e.flyLevel+"转"),this.strLevel+=e.level+"级",this.txt_level.changeText(this.strLevel),e.guildName?this.txt_guildName.changeText(e.guildName):this.txt_guildName.changeText("无")},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){G.superSet(BI,this,"dataSource",e)})}(BI),function(e){function t(){this._eff=null,this._si=-1,this._gs=null,t.__super.call(this),this.centerX=0,this.y=0,this.initUI()}b(t,"modules.dailygift.views.DailyGiftV",Ho);var i=t.prototype;return i.initUI=function(){this.div_tip.innerHTML="",this._gs=[];for(var e=1;this["btn_"+e];){var t=this["btn_"+e];t.img_select.visible=!1,t.img_grid.size(80,80),t.img_point.visible=!1,t.img_vg.skin=_r.getAtlasSubPath("dailygift/mrlb_btn_"+e+".png"),e++}},i.updateView=function(){G.timer.clear(this,this.onCheckEndTime),G.timer.loop(1e3,this,this.onCheckEndTime),this.onCheckEndTime();var e=XR.ableAwardIndex;-1!=e?this.selectedIndex=e:-1==this._si?this.selectedIndex=0:this.updateByVSC()},i.updateByVSC=function(){var e=this;if(XR.actInfo){e.reset();var t=e["btn_"+(e._si+1)],i=e.box_award,n=e.div_tip,s=e.btn_get;if(t){t.img_select.visible=!0,e.img_title.skin=_r.getAtlasSubPath("dailygift/mrlb_msz_bt_"+(e._si+1)+".png");for(var o=XR.getAward(e._si),a=o.length,r=156*a-40,l=i.width-r>>1,c=0;c<=a-1;){var u=o[c];e._gs[c]=e._gs[c]||new MF;var d=e._gs[c];d.bindData=u,d.visible=!0,d.parent||i.addChild(d),d.pos(l+156*c,0);var h=ms.getByQuality(u.colourId);i.graphics.fillText(u.name,d.x+d.width/2,d.y+d.height+5,"20px SimHei",h,"center"),c++}var _=XR.getState(e._si);s.visible=!0;var f=s.disabled=!1;if(2==e._si)switch(n.innerHTML=XR.getDes(e._si),_){case 0:case 1:s.label=RP.n[1265];break;case 2:s.label="已领取",s.disabled=!0}else switch(n.innerHTML=XR.getDes(e._si),_){case 0:s.label=XR.getCost(e._si)+"元购买";break;case 1:s.label=RP.n[1266];break;case 2:var p=e._si+6;XR.isAbleShare(p)?(s.label=RP.n[1267],f=!0):(s.label="已领取",s.disabled=!0)}(1==_||f)&&null==e._eff&&(e._eff=kB.createEffect("jm1242",e.btn_get.width>>1,e.btn_get.height>>1,e.btn_get))}}},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e);for(var t=1;this["btn_"+t];){this["btn_"+t].on("click",this,this.onSelectBtn),t++}this.on("click",this,this.onClick),this.updateView()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e);for(var i=1;t["btn_"+i];){t["btn_"+i].off("click",t,t.onSelectBtn),i++}t.off("click",t,t.onClick),G.timer.clear(t,t.onCheckEndTime)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e);var t=0;for(t=this._gs.length;this._gs[t-1];){this._gs[t-1].destroy(),t--}this._gs=null,this._eff&&this._eff.dispose(),this._eff=null},i.onSelectBtn=function(e){for(var t=1;this["btn_"+t];){if(this["btn_"+t]==e.target){this.selectedIndex=t-1;break}t++}},i.onCheckEndTime=function(){var e=1e3*XR.refreshTime-dr.curServerTime;e<=0?(this.div_desc.innerHTML=RP.n[1268],G.timer.clear(this,this.onCheckEndTime)):this.div_desc.innerHTML=RP.n[1269]+Ql.createColor(Jp.getHMS(e/1e3),"#23b11f")},i.onClick=function(e){switch(e.target){case this.btn_get:switch(XR.getState(this._si)){case 0:var t=0;switch(this._si){case 0:t=710;break;case 1:t=720;break;case 2:zB.ins.showById(11102,1)}t&&EB.pay(13,t);break;case 1:var i=XR.getGiftId(this._si);if(i)switch(this._si){case 0:case 1:Bo.reqDrawAward(i);break;case 2:Bo.reqDrawAwardNormal(i)}break;case 2:switch(this._si){case 0:case 1:var n=this._si+6;XR.isAbleShare(n)&&Tu.sendToModule("COPY_SHARE",["modules.activityDaily.DailyModule"],{id:n,content:"分享后可获得以下奖励"})}}}},i.reset=function(){for(var e=this,t=1;e["btn_"+t];){var i=e["btn_"+t];i.img_select.visible=!1,i.img_point.visible=XR.isShowDot(t-1);var n=XR.getAward(t-1)[0];if(n){var s=Bi.getIndex(n.goodsId),o=Bi.MODEL.icon(s);NR.loadIcon(o,ql.create(e,e.doDrawIcon,[i.img_grid.graphics]))}t++}for(t=e._gs.length;e._gs[t-1];){e._gs[t-1].visible=!1,t--}e.box_award.graphics.clear(),e._eff&&e._eff.dispose(),e._eff=null},i.doDrawIcon=function(e,t){t.bitmap.enableMerageInAtlas=!1,e.drawTexture(t,0,0,80,80)},p(0,i,"selectedIndex",null,function(e){this._si=e,this.updateByVSC()}),t}()),C0=function(e){function t(){t.__super.call(this)}b(t,"modules.digger.views.active.AE_Bubble_RuleView",Xv);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.txt_enter.on("click",this,this.onClickHandler),this.btn_close.on("click",this,this.onClickHandler);for(var t,i=0,n=0;n<bt.count;n++)if(bt.MODEL.type(n)==QR.AE_TYPE){i=n;break}t=bt.MODEL.instruction(i),this.txt_desc.innerHTML=t,t=bt.MODEL.rule(i),this.txt_rule.innerHTML=t},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.txt_enter.off("click",this,this.onClickHandler),this.btn_close.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){hN.ins.close("AE_BUBBLE_RULE_VIEW")},t}(),L0=function(e){function t(){this.vsc=null,this._curIdx=-1,t.__super.call(this),this.centerX=0,this.title=_r.getAtlasSubPath("field/title.png"),this.vsc=new SB(this),this.vsc.registAll([{cls:yJ,id:"1"}]),this.vsc.invalid()}return b(t,"modules.field.views.FieldMV",Ma),t.prototype.updateFieldInfo=function(){},t}(),M0=function(e){function t(){var e=this;e._callback=null,e._grids=null,e._time=0,e._firstKillReward=null,t.__super.call(e),e._grids=new wj(2,4,116,10,30,!0,null,10),e._grids.isCenter=!0,e._grids.pos(114,e.txt_firstRewardName.y+70),e.addChild(e._grids)}b(t,"modules.fight.views.result.FightSuccessPersonBossFirstKillPanel",Pa);var i=t.prototype;return i.update=function(e,t,i){var n,s,o=this,a=[],r=[],l=[],c=[],u=[],d=[],h=[],_=[],f=[],p={},g=0,v=0;for(var m in e)if((s=e[m])instanceof protos.backpack.DtoGoods)_.push(s);else if(g=s.modelId,v=s.count,n=p[g])n.goodsNum+=v;else switch((n=yB.create(g,v)).subType){case 16:a.push(n);break;case 3:r.push(n);break;case 15:l.push(n);break;case 9:c.push(n);break;case 12:u.push(n);break;case 17:d.push(n);break;case 11:h.push(n);break;case 10:f.push(n);break;default:_.push(n)}var y=a.concat(r).concat(l).concat(c).concat(u).concat(d).concat(h).concat(_).concat(f);o._grids.gridDatas=y,o._grids.vScrollBar.value=1,o._callback=t,o._time=6,G.timer.loop(1e3,o,o.onTime),o.onTime(),o._grids.x=o.width-o._grids.contentW>>1;BR.ins.curCopyId;null==o._firstKillReward&&(o._firstKillReward=new MF,o.img_grid.addChild(o._firstKillReward));var I=rn.MODEL.key(rn.getIndex(BR.ins.curCopyId)),b=BR.ins.checkPersonHasFirstKillReward(I),w=gR.ins.actorById(1).job-1,x=yB.createStrArr(Bu.MODEL.reward(b))[w];o._firstKillReward.dataSource=x,o.txt_firstRewardName.text=x.simpleName,o.txt_firstRewardName.color=ms.getByQuality(Bi.MODEL.colourId(x.cfgIdx)),o.addChildAt(o.xiala,o.numChildren-1),o.xiala.visible=8<y.length},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onClick),bj.ins.show(this)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_get.off("click",this,this.onClick),G.timer.clearAll(this),this._callback&&(this._callback.run(),this._callback=null)},i.destroy=function(e){void 0===e&&(e=!0),this._grids.destroy(e),this._grids=null,ui.SubPanel.prototype.destroy.call(this,e)},i.onClick=function(e){hN.ins._closePanel(this)},i.onTime=function(){this._time-=1,this.txt_time.changeText("("+this._time+"s)"),this._time<=0&&(G.timer.clearAll(this),hN.ins._closePanel(this))},t.NAME="FightSuccessPersonBossFirstKillPanel",t}(),A0=function(e){function t(){this.effect=null,this.NAMEArr=[RP.n[1270],RP.n[1271]],t.__super.call(this)}b(t,"modules.god.views.GodEquipPreviewView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.updateViewData=function(e){var t=this,i=KH.create(e.id),n=PR.getGoodsNewAttr(i.goodsId);t.fight_num.value=RR.getFight(n);for(var s,o,a="",r=Ci.count/2,l=0;l<Ci.count;l++)if(Ci.MODEL.key(l)==i.goodsId){if(a=Ci.MODEL.equip_desc(l),0==e.type)s=Ci.MODEL.effectid(l);else switch(o=Ci.MODEL.effectid(l).split(","),e.sex){case 1:s=o[0];break;case 2:s=o[1]}t.txt_partName.text=t.NAMEArr[Ci.MODEL.type(l)],t.txt_partName.color=ms.getByQuality(i.colourId),Ci.MODEL.level(l)==r?t.txt_name.text=t.NAMEArr[Ci.MODEL.type(l)]+"Lv."+Ci.MODEL.level(l):t.txt_name.text=t.NAMEArr[Ci.MODEL.type(l)]+"Lv."+(Ci.MODEL.level(l)-1),t.txt_name.color=ms.getByQuality(i.colourId);break}var c=e.isFull?"#23b11f":"#ff2e24";t.txt_dect.innerHTML=mp.getFormat(a,[c]),t.txt_dect.style.leading=10,0==e.type?t.effect=kB.createEffect(s,450,420,t):t.effect=kB.createEffect(s,280,450,t)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.effect&&(this.effect.parent&&this.effect.removeSelf(),this.effect.dispose(),this.effect=null)},t.NAME="GodEquipPreviewView",t}(gr),D0=function(e){function t(){this._currentTime=0,this._targetTime=0,this._circle=null,t.__super.call(this)}b(t,"modules.godweapon.views.fairyland.GodWeaponFairylandCountDownPanel",br);var i=t.prototype;return i.updateData=function(){this.setUp()},i.setUp=function(){null==this._circle&&(this._circle=new pp,this.img_circle.mask=this._circle)},i.clearGraphic=function(){},i.loop=function(){this._currentTime--,this.updateTime()},i.updateTime=function(){var e=this,t=e._currentTime/e._targetTime*360-90;e._circle.graphics.clear(),e._circle.graphics.drawPie(e.img_circle.width>>1,e.img_circle.height>>1,e.img_circle.width>>1,-90,t,"#000000"),e._circle.repaint(),e.txt_time.text=Jp.simpleFormat(e._currentTime),e.txt_time.color="#FF0000"},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.updateData(),this._currentTime=this._targetTime=20,this.updateTime(),G.timer.loop(1e3,this,this.loop)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),G.timer.clear(this,this.loop)},t.NAME="GodWeaponFairylandCountDownPanel",t}(),O0=function(e){function t(){t.__super.call(this)}b(t,"modules.godweapon.views.fairyland.GodWeaponFairylandRankPanel",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.list_rank.itemRender=PJ,this.txt_no.visible=!1},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.list_rank.dataSource=o_.ins.getRank(15).datas,this.btn_close.on("click",this,this.onCloseClicked),this.txt_no.visible=this.list_rank.length<1},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onCloseClicked)},i.onCloseClicked=function(e){this.close()},t.NAME="GodWeaponFairylandRankPanel",t}(Er),P0=function(t){function e(){this._gridReward=null,this._callBack=null,this._isS=!1,this._countDown=0,e.__super.call(this)}b(e,"modules.godweapon.views.fairyland.GodWeaponFairylandSuccessPanel",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.img_left.skin=_r.getFullUrl("ui/images/godweapon/ty_js_db.png"),e.img_right.skin=_r.getFullUrl("ui/images/godweapon/ty_js_db.png"),e.img_title.skin=_r.getFullUrl("ui/images/godweapon/ty_js_tt.png"),e.img_finish.skin=_r.getFullUrl("ui/images/godweapon/sb_sbhj_text_wc.png"),e._gridReward=new vj,e._gridReward.x=e.txt_get.x,e._gridReward.y=e.txt_get.y+20,e._gridReward._repeatX=4,e._gridReward._hScrollBarSkin="",e._gridReward._vScrollBarSkin="",e._gridReward.height=300,e._gridReward.width=450,e._gridReward._spaceX=25,e._gridReward._gsimpleName=!0,e.addChild(e._gridReward)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_getReward.on("click",t,t.onGetRewardClicked),t.btn_quit.on("click",t,t.onQuitClicked),t.txt_time.text=Jp.getTickMS(nN.instance.lastTime);var i=nN.instance.showQuality;if(0<i&&i<=4){if(1<i){var n;n=nN.instance.currentThroughLevel>=ir.count?ir.MODEL.passTime(nN.instance.currentThroughLevel-1):ir.MODEL.passTime(nN.instance.currentThroughLevel);nN.instance.lastTime;var s=nN.instance.lastTime-n[i-2];t.txt_close.text="距离"+Ir.QUALITY_NAME_ARR[i-2]+"只差"+s+"秒"}else t.txt_close.text="";t.img_quality.skin=_r.getFullUrl("ui/images/godweapon/quality_"+(i-1)+".png")}else t.img_quality.skin="",t.txt_close.text="";var o=nN.instance.getRewardByLevelAndQuality(nN.instance.currentThroughLevel,i-1);if(nN.instance.isFirstThrough){var a=ir.MODEL.firstReward(nN.instance.currentThroughLevel-1);t._gridReward.combineData(a,o)}else t._gridReward.setGoodsItems(o,6);i-1==0?(t.btn_getReward.centerX=0,t.btn_quit.visible=!1,t.txt_dect.visible=!1,t._countDown=3,t._isS=!0,t.btn_getReward.text.changeText(RP.n[1272]+t._countDown+")")):(t._isS=!1,t._countDown=300),t.timer.loop(1e3,t,t.loop)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_getReward.off("click",t,t.onGetRewardClicked),t.btn_quit.off("click",t,t.onQuitClicked),t.timer.clear(t,t.loop)},i.loop=function(){var e=this;e._countDown--,e._isS?(e.btn_getReward.text.changeText(RP.n[1272]+e._countDown+")"),0==e._countDown&&(e.getReward(!0),e.close(),e.timer.clear(e,e.loop))):0==e._countDown&&(e.timer.clear(e,e.loop),e.runCallback())},i.updateView=function(e){e&&(this._callBack=e.callback)},i.onGetRewardClicked=function(e){this.getReward(!0),this.close()},i.getReward=function(e){var t=new Yr;t.isGetReward=!0,Tu.sendToService(t),this.runCallback()},i.runCallback=function(){this._callBack&&(this._callBack.run(),this._callBack=null),Tu.sendToModule("OPEN_MAIN_PANEL",["modules.godweapon.GodWeaponModule"],{selectedIndex:"1"})},i.onQuitClicked=function(e){this.runCallback(),this.close()},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},e.NAME="GodWeaponFairylandSuccessPanel",e}(Cr),R0=function(e){function t(){var e=this;e.item=[],e.currentSelectedItem=null,e.syData=null,t.__super.call(e),e.centerX=e.centerY=0,e.syData=cN.instance,e.panel_boss.vScrollBarSkin="",e.panel_boss.vScrollBar.elasticBackTime=300,e.panel_boss.vScrollBar.elasticDistance=100}b(t,"modules.godweapon.views.shengyu.GodWeaponBossTiXingView",Pr);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e);for(var t=0;t<this.item.length;t++)null!=this.item[t].parent&&this.item[t].parent.removeChild(this.item[t]),this.item[t]=null;this.item=[],Tu.sendToModule("CLOSE_SY_SELCTED_VIEW",["modules.godweapon.GodWeaponModule"])},i.showInfo=function(){var e=null,t=0;for(t=0;t<this.syData.ShenBin_TowerInfo.list.length;t++){var i=rn.getIndex(this.syData.ShenBin_TowerInfo.list[t].missionId),n=rn.MODEL.zsLevelLimit(i),s=rn.MODEL.zsLevelUpLimit(i);if(gR.ins.zsLv>=n&&gR.ins.zsLv<=s){e=this.syData.ShenBin_TowerInfo.list[t];break}}var o,a=this.syData.ShenBin_ShenYuInfo.list.concat();for(null!=e&&a.push(e),t=0;t<a.length;t++)this.item.length>t?o=this.item[t]:(o=new CW,this.item.push(o)),o.x=0,o.y=63*t,o.data=a[t],null==o.parent&&this.panel_boss.addChild(o)},t}(),N0=function(e){function t(){this.syModel=null,this.towerList=[],this.syList=[],t.__super.call(this),this.centerX=this.centerY=0,this.syModel=cN.instance}b(t,"modules.godweapon.views.shengyu.GodWeaponSYMainView",Nr);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this)},i.destroy=function(e){var t;void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e);for(var i=0;i<5;i++)(t=this["g_tower_"+i])&&t.skin&&G.loader.clearRes(t.skin)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_setting.on("click",t,t.onClickTxtListener),t.syModel.reqShenBinTower(20);for(var i=0;i<5;i++)t["g_tower_"+i].on("click",t,t.onClickTower);t.btn_help.on("click",t,t.onClickHelp)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.txt_setting.off("click",t,t.onClickTxtListener);for(var i=0;i<5;i++)t["g_tower_"+i].off("click",t,t.onClickTower);t.btn_help.off("click",t,t.onClickHelp)},i.updateRedPoint=function(){this.showUpdateTowerRedInfo(),this.showUpdateSYRedInfo()},i.onClickTower=function(e){var t=parseInt(e.currentTarget.name),i=this.towerList[t];i&&i.onTowers()},i.updateByVSC=function(e){null!=e&&(e instanceof protos.godweapon.toc_30340?(this.showTowerInfo(),this.syModel.reqShenBinTower(21)):e instanceof protos.godweapon.toc_30350&&this.showSYInfo())},i.showTowerInfo=function(){for(var e,t=gR.ins.zsLv,i=this.syModel.ShenBin_TowerInfo.list,n=0;n<i.length;n++){this.towerList.length>n?e=this.towerList[n]:(e=new H0,this.towerList.push(e)),null==e.parent&&this.addChild(e),e.x=lN.TOWER_POINT[n].x,e.y=lN.TOWER_POINT[n].y;var s=rn.getIndex(i[n].missionId),o=rn.MODEL.zsLevelLimit(s),a=rn.MODEL.zsLevelUpLimit(s);o<=t&&t<=a||(i[n].challengeCDTime=0),e.data=i[n];var r=!1;r=0==i[n].select,this.syModel.txHash.put(i[n].missionId,r,!0),this.setOpenTower(n,o<=t&&t<=a)}},i.setOpenTower=function(e,t){var i=t?"2":"",n="lwt_lwt_dc";1<=e&&e<4?n="lwt_lwt_lc":4==e&&(n="lwt_lwt_td"),this["g_tower_"+e].skin=_r.getAtlasSubPath("godweapon/"+n+i+".png")},i.showSYInfo=function(){var e=this;e.txt_hasNum.innerHTML=RP.n[1274]+Ql.createColor(e.syModel.ShenBin_ShenYuInfo.guishuNum+"","#23b11f");var t,i=0;gR.ins.zsLv;for(i=0;i<e.syModel.ShenBin_ShenYuInfo.list.length;i++){e.syList.length>i?t=e.syList[i]:(t=new TW,e.syList.push(t)),t.Skin=i,t.data=e.syModel.ShenBin_ShenYuInfo.list[i],null==t.parent&&e.addChild(t),t.x=lN.SY_POINT[i].x,t.y=lN.SY_POINT[i].y;var n=!1;n=0==e.syModel.ShenBin_ShenYuInfo.list[i].select,e.syModel.txHash.put(e.syModel.ShenBin_ShenYuInfo.list[i].missionId,n,!0)}e.addChild(e.btn_help)},i.onClickTxtListener=function(e){Tu.sendToModule("OPEN_SHNEGYU_SETTING",["modules.godweapon.GodWeaponModule"])},i.showUpdateTowerRedInfo=function(){var e=0;for(e=0;e<this.towerList.length;e++){var t=this.towerList[e];t.data&&0<this.syModel.syBossNums&&t.updateRedPoint(this.syModel.txHash.take(t.data.missionId))}},i.showUpdateSYRedInfo=function(){var e=0;for(e=0;e<this.syList.length;e++){var t=this.syList[e];t.data&&0<this.syModel.syBossNums&&t.updateRedPoint(this.syModel.txHash.take(t.data.missionId))}},i.onClickHelp=function(){var e=Vi.MODEL.description(Vi.getIndex(35));hN.ins.open("AE_EXPLAIN_VIEW",{desc:e})},t}(),B0=function(e){function t(){var e=this;e.cdTime=0,e.bossHP=0,e.costYB=0,e.costType="",e._data={},e.goodsList=[],e.syData=null,e.HasEno=!1,t.__super.call(e),e.centerX=e.centerY=0,e.syData=cN.instance,e.initUI()}b(t,"modules.godweapon.views.shengyu.GodWeaponEnterSYView",Ur);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_cancel.on("click",t,t.onClickBtnListener),t.btn_enter.on("click",t,t.onClickBtnListener),t.btn_close.on("click",t,t.onClickBtnListener),t.txt_cd.x=320,t.g_icon.skin=_r.getIconPath("icgoods10177")},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_cancel.off("click",t,t.onClickBtnListener),t.btn_enter.off("click",t,t.onClickBtnListener),t.btn_close.off("click",t,t.onClickBtnListener),t.clearTimer(t,t.onTimer)},i.refreshPanel=function(e){var t=this;t._data=e,t.cdTime=t._data.challengeCDTime,t.bossHP=t._data.bossHp,t.g_level.skin=_r.getAtlasSubPath("godweapon/sbsy_title_"+(t._data.missionId-2968)+".png");var i=rn.getIndex(t._data.missionId),n=rn.MODEL.bossShowAward(i);if(n)for(var s=n.split(";"),o=0;o<s.length;o++){var a=s[o].split(",")[0];t.goodsList[o].bindData=parseInt(a),t.goodsList[o].goodsNum=parseInt(s[o].split(",")[1]);var r=Bi.getIndex(parseInt(a));t["txt_name_"+o].text=Bi.MODEL.name(r),t["txt_name_"+o].color=ms.getByQuality(Bi.MODEL.colourId(r))}var l=JSON.parse(rn.MODEL.consumption(i));for(o=0;o<l.length;o++){var c=l[o].value.toString();if("res"==l[o].type)t.costType=c.split(":")[0],t.txt_yuanbao.text=c.split(":")[1],t.costYB=parseInt(c.split(":")[1]);else{var u=TR.ins.getGoodsNum(parseInt(c.split(":")[0])).toString(),d=parseInt(c.split(":")[1]);t.HasEno=parseInt(u)>=d;var h=t.HasEno?"#23b11f":"#ff2e24";t.txt_has.innerHTML=Ql.createColor(u,h)+Ql.createColor("/"+d,"#23b11f")}}null!=t._data&&(t.cdTime=t._data.challengeCDTime,0<t.cdTime?(t.timerLoop(1e3,t,t.onTimer),t.onTimer()):(t.clearTimer(t,t.onTimer),t.txt_cd.text="")),"GOLD"==t.costType?t.img_huobi.skin=_r.getAtlasSubPath("base_ui2/ty_hb_yb.png"):"COPPER"==t.costType&&(t.img_huobi.skin=_r.getAtlasSubPath("base_ui2/ty_hb_tb.png")),t.txt_or.x=t.txt_yuanbao.x+t.txt_yuanbao.width+11,t.g_icon.x=t.txt_or.x+32,t.txt_has.x=t.g_icon.x+59},i.onTimer=function(){var e=this.cdTime--;if(e<0)return this.event("end"),void(this.txt_cd.text="");this.txt_cd.text=RP.n[1275]+Go.deltaFormat(1e3*e,"hh:mm:ss")},i.onClickBtnListener=function(e){var t=this;switch(e.currentTarget){case t.btn_close:hN.ins._closePanel(t);break;case t.btn_cancel:hN.ins.close("GODWEAPON_SY_ENTER");break;case t.btn_enter:if(0<t.cdTime)return void zB.ins.playErrorMsg(RP.n[1276]+t.cdTime+"秒");if(t.bossHP<=0||0<t._data.time)return void zB.ins.playErrorMsg(RP.n[1277]);if(TR.ins.getLeftGridNum()<20)return void zB.ins.playErrorMsg(RP.n[342]);var i=0;return"GOLD"==t.costType?i=gR.ins.YB:"COPPER"==t.costType&&(i=gR.ins.coin),i>=t.costYB||t.HasEno?void jR.reqEntry(t._data.missionId):void(i<t.costYB&&"GOLD"==t.costType?zB.ins.playErrorMsg(RP.n[1279]):i<t.costYB&&"COPPER"==t.costType?zB.ins.playErrorMsg(RP.n[1280]):zB.ins.playErrorMsg(RP.n[1281]))}},i.initUI=function(){for(var e=0;e<3;e++){var t=new MF;t.x=this["grid_"+e].x,t.y=this["grid_"+e].y+100,t.needGridBg=!1,this.addChild(t),this.goodsList.push(t)}},t}(),H0=function(e){function t(){this.selectedBox=!1,this._data=0,this._selected=!1,this.selfFlyLv=0,this._setTime=0,this._challengeCDTime=0,this._time=0,t.__super.call(this)}b(t,"modules.godweapon.views.shengyu.GodWeaponTowerItem",Fr);var i=t.prototype;return i.updateRedPoint=function(e){this.txt_time.visible&&"已刷新"==this.txt_time.text&&(this.img_red.visible=e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClickItemListener)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClickItemListener),this.clearTimer(this,this.onTimer)},i.onClickItemListener=function(e){this.onTowers()},i.onTowers=function(){this.selected?(this._data.challengeCDTime=this.challengeCDTime,Tu.sendToModule("OPEN_SHNEGYU_ENTER",["modules.godweapon.GodWeaponModule"],this._data)):zB.ins.playErrorMsg(RP.n[1282])},i.onTimer1=function(){this._challengeCDTime--,this._challengeCDTime<0&&(this._challengeCDTime=0)},i.onTimer=function(){var e=this._setTime-=1e3;if(e<=0)return this.event("end"),this.txt_time.text="已刷新",this.img_red.visible=this.selectedBox,void this.setRedLoc();this.txt_time.text=Go.deltaFormat(e,"hh:mm:ss")},i.setRedLoc=function(){this.img_red.visible},p(0,i,"setTime",function(){return this._setTime},function(e){0<(this._setTime=e)?(this.img_red.visible=!1,this.timerLoop(1e3,this,this.onTimer),this.onTimer()):(this.txt_time.text="已刷新",this.clearTimer(this,this.onTimer),this.img_red.visible=this.selectedBox),this.setRedLoc()}),p(0,i,"challengeCDTime",function(){return this._challengeCDTime},function(e){0<(this._challengeCDTime=e)?this.timerLoop(1e3,this,this.onTimer1):this.clearTimer(this,this.onTimer1)}),p(0,i,"data",function(){return this._data},function(e){this._data=e,this.selfFlyLv=gR.ins.zsLv;var t=rn.getIndex(e.missionId),i=rn.MODEL.zsLevelLimit(t),n=rn.MODEL.zsLevelUpLimit(t);0==e.select?this.selectedBox=!0:1==e.select&&(this.selectedBox=!1),this.selfFlyLv>=i&&this.selfFlyLv<=n?(this.txt_time.visible=!0,this.selected=!0,this.txt_fly.color="#e6d80d",this.setTime=e.time,this.challengeCDTime=e.challengeCDTime):(this.img_red.visible=!1,this.challengeCDTime=0,this.txt_time.visible=!1,this.selected=!1,this.txt_fly.color="#90877b"),this.txt_fly.text=rn.MODEL.name(t).substr(3,2)+" "+i+"转-"+n+"转",this.txt_time.x=(this.txt_fly.width-this.txt_fly.textWidth)/2+this.txt_fly.textWidth+11,this.setRedLoc()}),p(0,i,"selected",function(){return this._selected},function(e){this._selected=e}),t.REFRESH="已刷新",t}(),V0=function(e){function t(){this._taskPanel=null,this._pointsPanel=null,this._data=null,this.btnList=[],this.selectBtnIndex=-1,t.__super.call(this),this.init()}b(t,"modules.godweapon.views.weapon.GodWeaponPanel",Mr);var i=t.prototype;return i.init=function(){var e=this;e._data=iN.instance,e._pointsPanel=new GJ,e._pointsPanel.y=71,e.box_c.addChild(e._pointsPanel),e._taskPanel=new RW,e._taskPanel.y=71,e.box_c.addChild(e._taskPanel),e._taskPanel.visible=!0,e._pointsPanel.visible=!1;for(var t=[1,2,3],i=0;i<3;i++){var n=e["btn_"+(i+1)];n.name=t[i],n.on("click",e,e.onClickHandler),e.btnList.push(n)}e.img_1.visible=!0,e.img_2.visible=!1,e.img_3.visible=!1},i.updateDefaultBtn=function(){var e=0,t=gR.ins.actorList.length,i=0;if(0<this._data.taskRoleId?e=this._data.taskRoleId:0<this._data.activedRoleId&&(e=this._data.activedRoleId,!0),0<e){var n=this._data.rolesDict[e];n&&(i=3<t?e-1:n.weaponId-1)}else{i=gR.ins.actorList[0].job-1}this.updateSelectedBtn(i)},i.updateSelectedBtn=function(e){for(var t=this,i=null,n=1,s=0;s<t.btnList.length;s++)i=t.btnList[s],s==e?(n=parseInt(i.name),i.selected=!0):i.selected=!1;t.updateEff(n);var o=!1,a=0;if(3<t.btnList.length){a=e+1;var r=t._data.rolesDict[a];r&&r.actived&&(o=!0)}else{var l;for(var c in t._data.rolesDict)if((l=t._data.rolesDict[c])&&l.weaponId==n){a=l.roleId,l&&l.actived&&(o=!0);break}}if(a<=0)for(var u=gR.ins.actorList,d=0;d<u.length;d++){var h=u[d];if(h&&h.job==n){a=h.id;break}}if(t._data.crtRoleId=a,o)t._taskPanel.visible=!1,t._pointsPanel.visible=!0,0<ki.count?t._pointsPanel.updateUI(n):HP.loadConfig(["GodArmsSkillResource"],["CGodArmsSkill"],ql.create(t,t.updateSkillPanel,[n]));else{t._taskPanel.visible=!0,t._pointsPanel.visible=!1;var _=0<a&&a==t._data.taskRoleId;t._taskPanel.updateTypeUI(n,_?t._data.currentTaskId:-1)}},i.clearAll=function(e){void 0===e&&(e=!0),this._pointsPanel.clearAll(e),this._taskPanel.clearAll(e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),sN.requestGodWeapon(),this._data&&this._data.initedData&&this._data.updateTaskStatus(),this.selectBtnIndex=-1,this.updateDefaultBtn(),this.updateRedhot()},i.onClickHandler=function(e){var t=this.btnList.indexOf(e.currentTarget);this.selectBtnIndex=t,this.updateSelectedBtn(t)},i.updateEff=function(e){switch(e){case 1:this.img_1.visible=!0,this.img_2.visible=this.img_3.visible=!1;break;case 2:this.img_2.visible=!0,this.img_1.visible=this.img_3.visible=!1;break;case 3:this.img_3.visible=!0,this.img_2.visible=this.img_1.visible=!1}},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),this.clearAll(!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateRedhot=function(){for(var e=null,t=0;t<this.btnList.length;t++)(e=this.btnList[t]).showTip=this._data.showTipByWeaponId(t,parseInt(e.name))},i.updateByVSC=function(e){var t=this,i=t._data.rolesDict[t._data.crtRoleId];i&&(i.actived?(t._taskPanel.visible=!1,t._pointsPanel.visible=!0,0<ki.count?t.updateSkillPanel(i.weaponId):HP.loadConfig(["GodArmsSkillResource"],["CGodArmsSkill"],ql.create(t,t.updateSkillPanel,[i.weaponId]))):(t._taskPanel.visible=!0,t._pointsPanel.visible=!1,t._taskPanel.updateTypeUI(i.weaponId,t._data.crtRoleId==t._data.taskRoleId?t._data.currentTaskId:-1))),-1==t.selectBtnIndex&&t.updateDefaultBtn(),t.updateRedhot()},i.updateSkillPanel=function(e){this._pointsPanel&&this._pointsPanel.updateUI(e)},t}(),G0=function(e){function t(){var e=this;e.RUN_ROUND=4,e.RUN_ANGLE=10,e.Rotation_Config=[[0,15],[1,20],[3,15],[e.RUN_ROUND,e.RUN_ANGLE]],e._drawing=!1,e._requested=!1,e._numRound=0,e._numAngle=0,e._drawAngle=0,e.actId=0,e.actVo=null,e._arr=null,e._splitArr=[],e._txtArr=[],e.aRecord=[],e.bRecord=[],e.shankCnt=0,e.divArr=[],t.__super.call(e),e.initUI(),e.isTop=!0,e.mouseThrough=!0,e.title=_r.getAtlasSubPath("goldrotary/acer_text_title2.png")}b(t,"modules.goldrotary.views.GoldRotaryV",nl);var i=t.prototype;return i.initUI=function(){var e=this;e.panel_record.vScrollBarSkin="",e.panel_record.vScrollBar.elasticBackTime=200,e.panel_record.vScrollBar.elasticDistance=60,e.btn_turn.clickHandler=ql.create(e,e.onClick,null,!1),e.btn_rule.clickHandler=ql.create(e,e.onRule,null,!1),e.txt_rule.on("click",e,e.onRule)},i.onRule=function(){},i.onClick=function(){var e=sl.ins.toc_info;null!=e&&(0<e.count?this.startPlay():Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],0))},i.startPlay=function(){this.img_turnBg.visible=!0,this._numRound=0,this._drawAngle=-1,this._drawing=!0,this.btn_turn.disabled=!0,this.lockMask(!0),G.timer.frameLoop(1,this,this.onPlayLoop)},i.onPlayLoop=function(){for(var e=this,t=0,i=e.Rotation_Config.length-1;0<=i;){var n=e.Rotation_Config[i];if(e._numRound>=n[0]){t=n[1];break}i--}if(360<=e._numAngle&&(e._numAngle-=360,e._numRound++),e._numRound>=e.RUN_ROUND&&(e._numRound==e.RUN_ROUND&&0==e._requested&&(e._requested=!0,Tu.sendToService(new bM)),0<e._drawAngle)){var s=e._drawAngle-e._numAngle;if(0<=s&&s<=t)return e._numAngle=e._drawAngle,e._requested=e._drawing=!1,e.img_point.rotation=e._numAngle,e.img_turnBg.rotation=45*Math.floor((e._numAngle+45)%360/45),G.timer.clear(e,e.onPlayLoop),void e.onPlayEnd()}e._numAngle+=t,e.img_point.rotation=e._numAngle,e.img_turnBg.rotation=45*Math.floor((e._numAngle+45)%360/45)},i.onPlayEnd=function(){this.shankCnt=0,G.timer.loop(120,this,this.onShank)},i.onShank=function(){8<this.shankCnt&&this.onShankEnd(),this.shankCnt++,1==(1&this.shankCnt)?this.img_turnBg.visible=!1:this.img_turnBg.visible=!0},i.onShankEnd=function(){this.lockMask(!1),G.timer.clear(this,this.onShank),hN.ins.open("GOLDROTARYGET")},i.lockMask=function(e){hN.ins.lockMask("GOLDROTARY",e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this._numAngle=0,this.img_turnBg.visible=!1,this.img_point.rotation=this._numAngle,Tu.sendToService(new IM)},i.onRemove=function(e){G.timer.clearAll(this),this.actId=0,this.actVo=null,this._drawAngle=-1,this._drawing=this._requested=!1,ui.SubPanel.prototype.onRemove.call(this,e)},i.updateInfo=function(){var e=this,t=sl.ins.toc_info;if(null!=t){e.spr_progress.visible=!0,e.txt_num.visible=!0,e.txt_num2.visible=!1;for(var i=0;i<e._splitArr.length;i++)e._splitArr[i].removeSelf();for(i=0;i<e._txtArr.length;i++)e._txtArr[i].removeSelf();var n=0;0!=t.turnId&&(n=Ri.getIndex(t.turnId));var s=Ri.MODEL.loop(n),o=Ri.MODEL.value(n)*s,a=576/s;for(e.txt_signe.changeText(o+""),i=1;i<s;i++){var r=e._splitArr[i-1];null==r&&(r=new Kl(_r.getAtlasSubPath("goldrotary/acer_img_interval.png")),e._splitArr[i-1]=r),r.pos(21+a*i-2,4),e.spr_progress.addChild(r);var l=e._txtArr[i-1];null==l&&(l=kB.createText(0,0,76,24,"",24,"#b7a06f"),e._txtArr[i-1]=l),l.changeText(Ri.MODEL.value(n)*i+""),l.pos(21+a*i-38,30),e.spr_progress.addChild(l)}if(0==t.cost?e.img_progBar.width=.01:t.cost>=o?e.img_progBar.width=576:e.img_progBar.width=t.cost/o*576,0==n&&0==t.cost)e.img_desc.skin=_r.getAtlasSubPath("goldrotary/acer_text_recharge1.png"),e.txt_num.pos(59,0),e.txt_num.changeText(Ri.MODEL.value(n)+""),e.spr_progress.visible=!1;else if(t.cost>=o)n+1<Ri.count?(e.img_desc.skin=_r.getAtlasSubPath("goldrotary/acer_text_recharge3.png"),e.txt_num2.visible=!0,e.txt_num.changeText(Ri.MODEL.costGold(n)+""),e.txt_num2.changeText(Ri.MODEL.costGold(n+1)+""),e.txt_num.pos(183,-2)):(e.img_desc.skin=_r.getAtlasSubPath("goldrotary/acer_text_recharge2.png"),e.txt_num.visible=!1);else{e.img_desc.skin=_r.getAtlasSubPath("goldrotary/acer_text_recharge4.png");for(var c=0;c<=t.cost;)c+=Ri.MODEL.value(n);e.txt_num.changeText(c-t.cost+""),e.txt_num.pos(116,-2)}e.btn_turn.disabled=!1,0<t.count?e.btn_turn.label=RP.n[1283]:t.cost>=Ri.MODEL.value(n)*Ri.MODEL.loop(n)?(e.btn_turn.label=RP.n[1283],e.btn_turn.disabled=!0):e.btn_turn.label=RP.n[1285],e.txt_gold.changeText(Ri.MODEL.costGold(n)+""),0<t.count?e.div_count.innerHTML=Ql.createColor(t.count+"","#01b527")+"次":e.div_count.innerHTML=Ql.createColor(t.count+"","#e41b00")+"次";var u=Ri.MODEL.key(n),d=sl.ins.getTurnInfo(u);for(e._arr=d,i=0;i<d.length;i++){var h=d[i],_=e["img_icon"+i];_.skin=_r.getAtlasSubPath("goldrotary/gold_icon"+Ni.MODEL.icon(h)+".png"),_.pivotX=_.width/2-6,_.pivotY=_.height/2,e["txt_rate"+i].changeText(Ni.MODEL.rateGroup(h)/100+"倍")}}},i.updateRecord=function(){var e=this,t=sl.ins.toc_record;if(null!=t){for(;0<e.aRecord.length;)e.pushDiv(e.aRecord.pop());for(;0<e.bRecord.length;)e.pushDiv(e.bRecord.pop());for(var i=0,n=t.aRecords,s=0;s<n.length;s++){var o=n[s],a=e.getDiv();a.innerHTML=Ql.createColor(o.playerName,"#e3dcc2")+"&nbsp;投入"+Ql.createColor(o.gold+"元宝","#fffe41")+"&nbsp;获得"+Ql.createColor(Math.floor(o.gold*o.rate/100)+"元宝","#fffe41")+"("+Ql.createColor(o.rate/100+"倍","#01b527")+")",a.height=a.contextHeight,a.x=0,a.y=i,e.aRecord.push(a),e.panel_record.addChild(a),i+=a.contextHeight+10}for(n=t.bRecords,s=0;s<n.length;s++)o=n[s],(a=e.getDiv()).innerHTML=Ql.createColor(o.playerName,"#e3dcc2")+"&nbsp;投入"+Ql.createColor(o.gold+"元宝","#fffe41")+"&nbsp;获得"+Ql.createColor(Math.floor(o.gold*o.rate/100)+"元宝","#fffe41")+"("+Ql.createColor(o.rate/100+"倍","#01b527")+")",a.height=a.contextHeight,e.bRecord.push(a),a.x=0,a.y=i,e.panel_record.addChild(a),i+=a.contextHeight+10;e.panel_record.refresh(),e.panel_record.vScrollBar.value=0}},i.retResult=function(e){var t=Ni.getIndex(e);sl.ins.result=e;for(var i=0;i<this._arr.length;i++)if(t==this._arr[i]){this._drawAngle=45*i+23;break}},i.updateTime=function(){if(this.actId){this.actVo=mB.getInStance().getActivityData(this.actId);var e=this.actVo.endTime-dr.serverTimeSec;0<e?(this.txt_time.changeText(Jp.getCNDHMS(e)),G.timer.loop(300,this,this.onTimer)):this.txt_time.changeText("已结束")}},i.onTimer=function(){var e=this.actVo.endTime-dr.serverTimeSec;if(0<e){var t=Jp.getCNDHMS(e);this.txt_time.changeText(t)}else this.txt_time.changeText("已结束"),G.timer.clear(this,this.onTimer)},i.getDiv=function(){if(0<this.divArr.length)return this.divArr.pop();var e=kB.createHtmlDiv(0,0,20,"#a19980",660);return e.style.align="center",e},i.pushDiv=function(e){null!=e&&(e.removeSelf(),this.divArr.push(e))},t}(),U0=function(e){function t(){var e=this;e.actId=0,e.vsc=null,t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.centerX=0,e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onVscFilter,null,!1),e.vsc.registAll([{cls:ZJ,id:"1"}]),e.vsc.invalid()}b(t,"modules.jianbao.view.JianbaoPanel",lc);var i=t.prototype;return i.onVscFilter=function(e,t){return 0},i.updateByVSC=function(e){this.vsc.selectedView.updateByVSC(e)},i.onSubChanged=function(e,t){var i="";switch(e){case"1":i="jianbao/jb_title_jb.png"}this.setTitle(_r.getAtlasSubPath(i))},t.JIANBAO="1",t}(),F0=function(e){function t(){var e=this;e._taskInfo=null,e._group=0,e._eff=null,e.BAR_W=0,e._gridsList=null,e.skillGrid=null,e._poit=null,e.eff=null,e._isFlying=!1,e.hasArrow=0,e._flys=new Array,t.__super.call(e)}b(t,"modules.limitChallenge.views.godEquip.LCGodEquipView",e);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.createChildren=function(){e.prototype.createChildren.call(this),this.imgBg1.skin=_r.getFullUrl("ui/images/feishengroad/fs_jm_bg.jpg")},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e._gridsList=new vj,e._gridsList.pos(40,351),e._gridsList.scaleX=e._gridsList.scaleY=.8,e._gridsList._gnameVisible=!0,e._gridsList._gsimpleName=!1,e._gridsList._spaceX=38,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.addChildAt(e._gridsList,14),e.listTask.selectEnable=!0,e.listTask.itemRender=BW,e.listTask.spaceX=0,e.listTask.spaceY=8,e.listTask.repeatX=1,e.listTask.vScrollBarSkin="",e.listTask.mouseThrough=!0,e._poit=new Uh(e.listTask.x+570,e.listTask.top+59),e.BAR_W=e.imgBar.width,e.imgBar.mask=e.rectBar,e.rectBar.x=-e.BAR_W,e.textBar.text="0/8",e.textBar.visible=!1,e.btnGo.visible=!1},i.updateByVSC=function(e){e&&(this._isFlying?G.timer.once(500,this,this.updateByVSC,[1]):(G.timer.clear(this,this.updateByVSC),this.updatePanel(),this.updateBar()))},i.showAimGuide=function(){},i.showByVSC=function(e,t){t&&(t&&0==this._group&&t.hasOwnProperty("group")&&(this._group=t.group,this.imgMap.skin=_r.getAtlasSubPath("limitchallenge/fs_bossdt_"+this._group+".png")),this.updatePanel(),this.updateBar())},i.hideByVSC=function(e,t){},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.listTask.scrollBar.on("change",this,this.onScrollChanged),gR.ins.lv<20?this.btnLink.gray=!0:this.btnLink.gray=!1},i.onRemove=function(e){var t=this;for(ui.SubPanel.prototype.onRemove.call(t,e),G.timer.clear(t,t.updateByVSC),t.off("click",t,t.onClick),t.listTask.scrollBar.off("change",t,t.onScrollChanged);t._flys.length;){var i=t._flys.pop();Og.clearAll(i),i&&i.dispose(),i=null}mN.showArrow=!1,t.hasArrow=0},i.onClick=function(e){switch(e.target){case this.btnGo:this.doEnterCopy();break;case this.btnLink:if(gR.ins.lv<20)return void zB.ins.showMsg(RP.n[1286],1);HR.openLevel=this._group,hN.ins.open("BOSS_MAINVIEW",{_subIndex_:2},0)}},i.doEnterCopy=function(){if(!this.btnGo.gray)return dr.dtoEnterScene&&15==dr.dtoEnterScene.type?(BR.ins.exitCopy(1),void G.timer.once(500,this,this.enterFlyCopy)):void(!ZN.isEnabledChangeScene()||dr.dtoEnterScene&&13==dr.dtoEnterScene.type?zB.ins.showById(2126,1):this.enterFlyCopy());this.getFinished()>=this._taskInfo.length?zB.ins.showMsg(RP.n[1287],1):zB.ins.showMsg(RP.n[1288],1)},i.enterFlyCopy=function(){for(var e=this._group,t=0;t<pi.count;t++)if(e==pi.MODEL.flyUpLevel(t)){BR.ins.isCheckPointBoss=!1;var i=pi.MODEL.missionId(t);bR.reqEnter(i),bR.copyId=i,bR.npcBB=pi.MODEL.npcBBdesc(t);break}},i.updatePanel=function(){var e=this;e.updateTaskList();var t=Hs.getIndex(e._group);e._gridsList.setGoodsItems(Hs.MODEL.rewards(t),3);var i=e._gridsList.items;if(i)for(var n=0;n<i.length;n++)i[n]&&(i[n].needGetWay=!1);e.txtSkill.text="("+e.getFinished()+"/"+e._taskInfo.length+")",e.imgTitle.skin=_r.getAtlasSubPath("limitchallenge/fs_rw_pz"+e._group+".png");var s=e.imgTitle.width+e.txtSkill.textWidth;e.imgTitle.x=(720-s)/2,e.txtSkill.x=e.imgTitle.x+e.imgTitle.width},i.updateTaskList=function(){this._taskInfo=mN.ins.getInfoByGroup(this._group),this.listTask.array=this._taskInfo},i.handlerArrow=function(){if(!this.hasArrow){var e=PH.Ins().info;e&&e.taskEvent&&0<=e.taskEvent.indexOf("42")&&0<=e.taskEvent.indexOf("12")&&3==e.status&&0==mN.showArrow&&Tu.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"])}},i.getFinished=function(){for(var e=0,t=0;t<this._taskInfo.length;t++)3==this._taskInfo[t].status&&e++;return e},i.showEffect=function(e){this._isFlying=!0,this.updatePanel();var t=kB.createEffect("jm1364",this._poit.x,this._poit.y,this);this._flys.push(t),Og.to(t,{x:150,y:this.boxBar.y+26},800,null,ql.create(this,this.playEffEnd))},i.playEffEnd=function(){var e=this._flys.shift();e&&(Og.clearAll(e),e.dispose(),e=null),this._isFlying=!1,this.updateBar()},i.updateRedPoit=function(){var e=this,t=e.getFinished(),i=t<e._taskInfo.length,n=t>=e._taskInfo.length&&e._group==gR.ins.actorFlyUpLevel+1;e.btnGo.visible=!i,e.boxBar.visible=i,e._gridsList.visible=i,e.imgGridBg.visible=i,e.btnLink.visible=i,e.imgRed.visible=n,e.btnGo.gray=!n,n?(e.eff||(e.eff=kB.createEffect("jm1130",e.btnGo.width>>1,e.btnGo.height>>1,e.btnGo),e.eff.scale_X=1.25,e.eff.scale_Y=1.2),G.timer.once(1e3,e,e.showArrow),e.hasArrow=1):(e.hasArrow&&(LY.Ins().closeThisPanel(),e.hasArrow=0),e.eff&&(e.eff.dispose(),e.eff=null)),e.handlerArrow()},i.showArrow=function(){LY.Ins().showforDir(0,RP.n[1289],this.btnGo,!1,!1)},i.updateBar=function(){var e=this.getFinished()/this._taskInfo.length*this.BAR_W;Og.to(this.rectBar,{x:-this.BAR_W+e},100,null,ql.create(this,this.tweenDown))},i.tweenDown=function(){Og.clearAll(this.rectBar),this.textBar.text=this.getFinished()+"/"+this._taskInfo.length,this.updateRedPoit()},i.onScrollChanged=function(){0==this.listTask.scrollBar.max||this.listTask.scrollBar.value>=this.listTask.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.destroy=function(e){void 0===e&&(e=!0),this.imgBg1&&this.imgBg1.skin&&G.loader.clearRes(this.imgBg1.skin),ui.SubPanel.prototype.destroy.call(this,e)},t}(_c),q0=function(e){function t(){t.__super.call(this)}b(t,"modules.magic.views.MagicTowerRankView",Bm);var i=t.prototype;return i.initialize=function(){this.list.itemRender=eZ,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.txt_no.visible=!1},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler),this.updateRank()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){hN.ins._closePanel(this)},i.updateRank=function(){this.list.dataSource=o_.ins.getRank(16).datas},t}(),j0=function(e){function t(){this.playId=0,this.bType=0,this._copyId=0,this.score=0,t.__super.call(this),this.centerX=0,this.centerY=0}b(t,"modules.magic.views.others.HelpFriendView",Ad);var i=t.prototype;return i.initialize=function(){this.cb_noremind.selected=!1,this.txt_des.style.font="SimHei",this.txt_des.style.fontFamily="SimHei",this.txt_des.style.fontSize=24,this.txt_des.style.color="#90877b"},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onRefuse),t.btn_go.on("click",t,t.onChallenge),t.cb_noremind.on("click",t,t.setRemind)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onRefuse),t.btn_go.off("click",t,t.onChallenge),t.cb_noremind.off("click",t,t.setRemind)},i.updateLabel=function(e){var t=e.copyId;this._copyId=t;var i=e.name,n=rn.getIndex(t),s=n,o=rn.MODEL.bossId(n);if(YR.ins.isCrossBoss(t)){o=Ao.MODEL.bossId(Ao.getIndex(t));var a=new MO;Tu.sendToService(a)}n=hn.getIndex(o);var r=hn.MODEL.name(n);0<e.serverid&&(r="S."+e.serverid+r);hn.MODEL.level(n),rn.MODEL.levelLimit(s),rn.MODEL.zsLevelLimit(s);var l=rn.MODEL.cate(s),c=rn.MODEL.extraCondition(s),u=0;if(c)for(var d=0;d<JSON.parse(c).length;d++){var h=JSON.parse(c)[d];"MoEquipScore"==h.type&&(u=parseInt(h.value))}this.score=u,this.bType=l;var _=hn.MODEL.muId(n),f=_n.getIndex(_),p=_n.MODEL.headId(f);switch(this.img_bosshead.skin=_r.getBossPath(p),l){case 41:RP.n[1290];break;case 42:RP.n[1291]}this.playId=e.playId,this.txt_des.innerHTML=RP.n[1292]+Ql.createColor(i,"#23b11f")+RP.n[1293]+Ql.createColor(r,"#23b11f")},i.setRemind=function(){BR.ins.noShow=this.cb_noremind.selected},i.onChallenge=function(e){var t=0;switch(this.bType){case 41:if(!IN.isOpenMagicJindi)return;var i=rn.getIndex(this._copyId);t=rn.MODEL.zsLevelLimit(i),gR.ins.zsLv,t+RP.n[1294];break;case 42:if(!IN.isOpenMagicMinjing)return;t=this.score,0,RP.n[1295]+t+RP.n[1296]}TR.ins.hasEmptyNum(20)?ZN.isEnabledChangeScene()?(hN.ins.close("HELPFRIEND_VIEW"),bN.reqInitiatorId(this.playId),57==this.bType?(Po.ins().currentSelectMissionID=this._copyId,jR.reqEntry(this._copyId,0,0,0,0,1)):jR.reqEntry(this._copyId)):zB.ins.showById(2126,1):KQ.ins.showBagRecycle()},i.onRefuse=function(e){hN.ins.close("HELPFRIEND_VIEW")},t}(),W0=function(e){function t(){this._container=null,this.lastTime=0,this.monsterId=0,t.__super.call(this),this.txt_state.style.font="SimHei",this.txt_state.style.fontFamily="SimHei",this.txt_state.style.fontSize=20,this.txt_state.style.align="center"}b(t,"modules.magic.views.item.Magic_JindiItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),G.timer.clear(this,this.showTime)},i.showTime=function(){this.lastTime<=0?G.timer.clear(this,this.showTime):(this.lastTime--,this.txt_state.innerHTML=Ql.createColor(this.getDHM(this.lastTime),"#e41b00"))},i.getDHM=function(e){var t=e,i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),s=t-3600*i-60*n;return i<=0?10<=n?"00:"+n+(10<=s?":":":0")+s:"00:0"+n+(10<=s?":":":0")+s:i<=0&&n<=0?10<=s?"00:00:"+s:"00:00:0"+s:(10<=i?"":"0")+i+(10<=n?":":":0")+n+(10<=s?":":":0")+s},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){var i=t.tag.id,n=rn.getIndex(i),s=n;t.monsterId=rn.MODEL.bossId(n),n=hn.getIndex(t.monsterId);var o=hn.MODEL.level(n),a=(hn.MODEL.muId(n),hn.MODEL.name(n)),r=t.tag.lastTime-dr.curServerTime;t.lastTime=Math.floor(r/1e3),t.txt_boss_name.changeText(a);rn.MODEL.levelLimit(s);var l,c=rn.MODEL.zsLevelLimit(s),u=rn.MODEL.extraCondition(s),d=0;if(u)for(var h=0;h<JSON.parse(u).length;h++){var _=JSON.parse(u)[h];"MoEquipScore"==_.type&&(d=parseInt(_.value))}switch(l=9999<d?Math.floor(d/1e4)+"万":d+"",t.txt_boss_lv.changeText(o+"级"),t.tag.status){case 0:t.txt_state.innerHTML=0<d?Ql.createColor(RP.n[1297]+l+"开启","#e41b00"):Ql.createColor(c+"转开启","#e41b00");break;case 1:t.txt_state.innerHTML=Ql.createColor("可击杀","#23b11f");break;case 2:t.showTime(),G.timer.loop(1e3,t,t.showTime,null,!0)}}}),p(0,i,"select",null,function(e){this.box_select.visible=e,this.txt_boss_name.color=e?"#fff9b4":"#91856d"}),t}(jm),Y0=function(t){function e(){this._gridsList=null,this.index=0,this.pLevel=0,e.__super.call(this)}b(e,"modules.magic.views.MagicTowerSettleView",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._gridsList||(e._gridsList=new vj,e._gridsList.x=e.txt_get.x,e._gridsList.y=e.txt_get.y+20,e._gridsList._repeatX=4,e._gridsList._hScrollBarSkin="",e._gridsList._vScrollBarSkin="",e._gridsList.height=300,e._gridsList.width=450,e._gridsList._spaceX=25,e._gridsList._gsimpleName=!0,e.addChild(e._gridsList))},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_award.on("click",this,this.onClickHandler),this.btn_exit.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_award.off("click",this,this.onClickHandler),this.btn_exit.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateView=function(e){var t=this;if(e){t.index=sn.getIndex(e.pid),t.pLevel=e.pLevel;var i=IN.getMagicTowerAward(t.index,e.pLevel,e.pFirst);if(i&&""!=i&&t._gridsList.setGoodsItems(i,6),t.g_quality.skin=_r.getFullUrl("ui/images/godweapon/quality_"+(e.pLevel-1)+".png"),t.txt_time.text=Jp.getTickMS(e.pTime),1==e.pLevel)t.btn_award.centerX=0,t.btn_exit.visible=t.txt_dect.visible=t.txt_close.visible=!1;else{t.btn_exit.visible=t.txt_dect.visible=t.txt_close.visible=!0;var n=e.pTime-sn.MODEL.passTime(t.index)[e.pLevel-2];t.txt_close.innerHTML="（距离"+Ir.QUALITY_NAME_ARR[e.pLevel-2]+"只差"+Ql.createColor(n.toString(),"#ff2e24")+"秒）"}}},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_award:bN.reqMTowerReceive(1),this.onExitCopy();break;case this.btn_exit:this.onExitCopy()}},i.onExitCopy=function(){this.close(),hN.ins.open("MAGIC_VIEW",{_subIndex_:0,isUnLock:1==this.pLevel}),BR.ins.exitCopy(300)},e}(Vm),z0=function(e){function t(){var e=this;e._array=null,e._gridsList=null,e._avatar=null,e._fistReward=null,e.maxTime=0,e.startLayer=null,e.SIZE=116,e.curObj=null,e.needNum=0,t.__super.call(e),e.startLayer=new pp,e.box_c.addChild(e.startLayer),e.link_help.underline=!0}b(t,"modules.magic.views.MagicJinDiView",Wm);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new vj(3),e._gridsList.pos(127,793),e._gridsList.size(480,180),e._gridsList._gsimpleName=!0,e._gridsList._spaceX=26,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.box_c.addChild(e._gridsList),e.list.itemRender=W0,e.list.vScrollBarSkin="",e.list.visible=!1,e.list.selectEnable=!0,e.list.renderHandler=ql.create(e,e.onListRender,null,!1),e.list.selectHandler=ql.create(e,e.onChange,null,!1),e._array=[];for(var t=BR.ins.getBossIds(41),i=0;i<t.length;i++){var n=t[i],s=rn.getIndex(n),o=rn.MODEL.isCard(s);e._array.push({id:n,isCard:o,cate:41})}e.maxTime=parseInt($e.MODEL.value($e.getIndex(199))),e.box_socre.visible=!1},i.onListRender=function(e,t){t==this.list.selectedIndex&&this._array[t]?e.select=!0:e.select=!1},i.onChange=function(e,t){var i=this;if(void 0===t&&(t=!1),i.curObj=i._array[e],i.curObj){var n=rn.getIndex(i.curObj.id),s=n,o=rn.MODEL.bossId(n);n=hn.getIndex(o);rn.MODEL.key(s);var a=rn.MODEL.bossShowAward(s);switch(i._gridsList.setGoodsItems(a,3),i.img_kill.visible=1==i.curObj.status||2,i.img_kill.visible&&(2==i.curObj.status?i.img_kill.skin=_r.getAtlasSubPath("magic/boss_yzbq_yjs.png"):1==i.curObj.status&&(i.img_kill.skin=_r.getAtlasSubPath("magic/boss_yzbq_kjs.png"))),i.curObj.status){case 0:i.btn_challenge.gray=!0,i.btn_challenge.disabled=!1;break;case 1:i.btn_challenge.gray=!1,i.btn_challenge.disabled=!1;break;case 2:i.btn_challenge.gray=!1,i.btn_challenge.disabled=!0}i.txt_ch.visible=!1;var r=rn.MODEL.extraCondition(s),l=0;if(r)for(var c=0;c<JSON.parse(r).length;c++){var u=JSON.parse(r)[c];"MoEquipScore"==u.type&&(l=parseInt(u.value))}var d=rn.MODEL.levelLimit(s),h=rn.MODEL.zsLevelLimit(s);0<l?i.needNum=l:gR.ins.zsLv<h?i.needNum=h:gR.ins.lv<d&&(i.needNum=d),1==i.curObj.status&&(i.btn_challenge.label="挑 战"),0==i.curObj.status&&zB.ins.showMsg(i.needNum+RP.n[1298],1),i.setAvatar(n),i.setBossLevel(n)}},i.getGoodsByType2=function(e){return e.split(",")[0]},i.setMoEquitStar=function(e,t,i){if(_R.getIsMoEquit(e)){var n=Bi.MODEL.magicStarLevel(Bi.getIndex(e));if(a||(a=new dt,this.box_c.addChild(a)),a.graphics.clear(),!_R.getIsMoEquitSpecial(e))return a.pos(t+3,i-this.SIZE+3),a.graphics.drawTextures(_R.starBgTexture,[0,0]),void a.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"no-repeat",new Uh(26*(10-n),0));var s=Math.floor(n/6),o=Math.floor(n%6),a=new dt;a.pos(t+5,i-28),this.startLayer.addChild(a);for(var r=0;r<o;r++)a.graphics.drawTextures(_R.getStarTexture(s),[_R.getStartX(o)+44*r,0]);a.scaleX=a.scaleY=.45}},i.setBossLevel=function(e){var t=hn.MODEL.name(e),i=hn.MODEL.level(e);this.txt_bname.text=t+"︵",this.txt_blvl.innerHTML=i.toString(),this.txt_te.text="级︶",this.txt_blvl.y=this.txt_bname.y+this.txt_bname.textHeight,this.txt_te.y=this.txt_blvl.y+this.txt_blvl.contextWidth+5},i.setAvatar=function(e){var t=this,i=hn.MODEL.muId(e);e=_n.getIndex(i);var n=_n.MODEL.avatarId(e);if(!t._avatar){t._avatar=new uq,t._avatar.renderInSelf=!0,t._avatar.pos(480,600);var s=t.box_c.getChildIndex(t.img_kill);t.box_c.addChildAt(t._avatar,s)}t._avatar.mid=n,t._avatar.type=Za.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1.2,1.2)},i.onClickHandler=function(e){0!=this.curObj.status?this.curObj&&(TR.ins.hasEmptyNum(20)?UR.instance.fullPower&&UR.instance.isAuto&&!BR.ins.isCheckPointBoss?zB.ins.showById(2126,1):ZN.isEnabledChangeScene()?jR.reqEntry(this.curObj.id):zB.ins.showById(2126,1):KQ.ins.showBagRecycle()):zB.ins.showMsg(this.needNum+RP.n[1298],1)},i.enterCopyZone=function(){jR.reqEntry(this.curObj.id)},i.onRefesh=function(e){hN.ins.open("MAGICATTENTION_VIEW",{type:41})},i.openHelpView=function(){hN.ins.open("AE_EXPLAIN_VIEW",{desc:RP.n[1300]})},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.img_kill.visible=!1,t.btn_challenge.on("click",t,t.onClickHandler),t.txt_refesh.on("click",t,t.onRefesh),jR.reqCopy(41),t.link_help.on("click",t,t.openHelpView),t.txt_jipin.on("click",t,t.toJiPinView)},i.onRemove=function(e){var t=this;t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.btn_challenge.off("click",t,t.onClickHandler),t.txt_refesh.off("click",t,t.onRefesh),t.link_help.off("click",t,t.openHelpView),t.txt_jipin.off("click",t,t.toJiPinView),ui.SubPanel.prototype.onRemove.call(t,e)},i.destroy=function(e){void 0===e&&(e=!0),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),this.startLayer.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.magic.toc_21241){for(var i=0;i<t._array.length;i++){var n=e.bossInfo,s=t._array[i];s.status=0|n[s.id].status,s.lastTime=n[s.id].lastTime}!t.list.visible&&(t.list.visible=!0),t._array=t._array.sort(t.sortArray),t.list.array=t._array,t.setStartIndex(t._array),t.txt_lastGS.color=e.ownerTimes<=0?"#e41b00":"#23b11f",t.txt_lastCY.color=e.assistTimes<=0?"#e41b00":"#23b11f",t.txt_lastGS.changeText(e.ownerTimes+"/"+t.maxTime),t.txt_lastCY.changeText(e.assistTimes+"/"+t.maxTime)}},i.setStartIndex=function(e){for(var t=-1,i=-1,n=e.length-1;0<=n;n--)1==e[n].status&&-1==i&&(i=n);t<0&&(t=i<0?0:i),(this.list.selectedIndex=t)<4?this.list.scrollTo(0):this.list.scrollTo(t-3),this.onChange(t,!0)},i.sortArray=function(e,t){if(e.isCard&&2!=e.status)return-1;if(t.isCard&&2!=t.status)return 1;var i=0==e.status?1.5:e.status,n=0==t.status?1.5:t.status;return i!=n?i-n:e.isCard!=t.isCard?t.isCard-e.isCard:e.id-t.id},i.toJiPinView=function(){hN.ins.open("BOSS_MAINVIEW",[5],0)},t}(),X0=function(e){function t(){this._eff=null,t.__super.call(this)}b(t,"modules.magic.views.MagicTowerUnlockSucView",Gm);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_link.on("click",this,this.onClickHandler),this.initShow()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t._eff&&(t._eff.parent&&t._eff.parent.removeChild(t._eff),t._eff.dispose(),t._eff=null),t.btn_link.off("click",t,t.onClickHandler)},i.initShow=function(){_R.mTowerExtra&&(this.g_equit.skin=_r.getMoEquipPath(_R.mTowerExtra.icon),this.txt_name.changeText("魔装"+la.getName(_R.mTowerExtra.part)+"部位"),this._eff||(this._eff=kB.createEffect("jm1060",275,160,this)))},i.onClickHandler=function(e){hN.ins.open("MO_MAIN_VIEW",{_subIndex_:0,isUnLock:!0})},t}(),Q0=function(e){function t(){var e=this;e._array=null,e._gridsList=null,e._avatar=null,e._fistReward=null,e.maxTime=0,e.startLayer=null,e.SIZE=116,e.curObj=null,e.needNum=0,e.needNum1=0,t.__super.call(e),e.startLayer=new pp,e.box_c.addChild(e.startLayer),e.link_help.underline=!0}b(t,"modules.magic.views.MagicMiJingView",Wm);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new vj(4),e._gridsList.pos(127,793),e._gridsList.size(480,180),e._gridsList._gsimpleName=!0,e._gridsList._spaceX=26,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.box_c.addChild(e._gridsList),e.list.itemRender=W0,e.list.vScrollBarSkin="",e.list.visible=!1,e.list.selectEnable=!0,e.list.renderHandler=ql.create(e,e.onListRender,null,!1),e.list.selectHandler=ql.create(e,e.onChange,null,!1),e._array=[];for(var t=BR.ins.getBossIds(42),i=0;i<t.length;i++){var n=t[i],s=rn.getIndex(n),o=rn.MODEL.isCard(s);e._array.push({id:n,isCard:o,cate:42})}e.maxTime=parseInt($e.MODEL.value($e.getIndex(200))),e.box_socre.visible=!1},i.onListRender=function(e,t){t==this.list.selectedIndex&&this._array[t]?e.select=!0:e.select=!1},i.onChange=function(e,t){var i=this;if(void 0===t&&(t=!1),i.curObj=i._array[e],i.curObj){var n=rn.getIndex(i.curObj.id),s=n,o=rn.MODEL.bossId(n);n=hn.getIndex(o);var a=rn.MODEL.key(s),r=(BR.ins.checkPersonHasFirstKillReward(a),rn.MODEL.bossShowAward(s));i._gridsList.setGoodsItems(r,3),i.img_kill.visible=1==i.curObj.status,i.img_kill.visible&&(2==i.curObj.status?i.img_kill.skin=_r.getAtlasSubPath("magic/boss_yzbq_yjs.png"):1==i.curObj.status&&(i.img_kill.skin=_r.getAtlasSubPath("magic/boss_yzbq_kjs.png"))),i.btn_challenge.gray=0==i.curObj.status,i.txt_ch.visible=!1;var l=rn.MODEL.extraCondition(s),c=0;if(l)for(var u=0;u<JSON.parse(l).length;u++){var d=JSON.parse(l)[u];"MoEquipScore"==d.type&&(c=parseInt(d.value))}var h=rn.MODEL.levelLimit(s),_=rn.MODEL.zsLevelLimit(s);0<c?(i.needNum=c,i.needNum1=_):gR.ins.zsLv<_?i.needNum=_:gR.ins.lv<h&&(i.needNum=h),1==i.curObj.status&&(i.btn_challenge.label="挑 战"),1==t&&0==i.curObj.status&&zB.ins.showMsg(i.needNum1+RP.n[1301]+i.needNum+RP.n[1302],1),i.setAvatar(n),i.setBossLevel(n)}},i.getGoodsByType2=function(e){return e.split(",")[0]},i.setMoEquitStar=function(e,t,i){if(_R.getIsMoEquit(e)){var n=Bi.MODEL.magicStarLevel(Bi.getIndex(e));if(a||(a=new dt,this.box_c.addChild(a)),a.graphics.clear(),!_R.getIsMoEquitSpecial(e))return a.pos(t+3,i-this.SIZE+3),a.graphics.drawTextures(_R.starBgTexture,[0,0]),void a.graphics.fillTexture(_R.starLevelTexture,2,3,26,22,"no-repeat",new Uh(26*(10-n),0));var s=Math.floor(n/6),o=Math.floor(n%6),a=new dt;a.pos(t+5,i-28),this.startLayer.addChild(a);for(var r=0;r<o;r++)a.graphics.drawTextures(_R.getStarTexture(s),[_R.getStartX(o)+44*r,0]);a.scaleX=a.scaleY=.45}},i.setBossLevel=function(e){var t=hn.MODEL.name(e),i=hn.MODEL.level(e);this.txt_bname.text=t+"︵",this.txt_blvl.innerHTML=i.toString(),this.txt_te.text="级︶",this.txt_blvl.y=this.txt_bname.y+this.txt_bname.textHeight,this.txt_te.y=this.txt_blvl.y+this.txt_blvl.contextWidth+5},i.setAvatar=function(e){var t=this,i=hn.MODEL.muId(e);e=_n.getIndex(i);var n=_n.MODEL.avatarId(e);if(!t._avatar){t._avatar=new uq,t._avatar.renderInSelf=!0,t._avatar.pos(480,600);var s=t.box_c.getChildIndex(t.img_kill);t.box_c.addChildAt(t._avatar,s)}t._avatar.mid=n,t._avatar.type=Za.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1.2,1.2)},i.onClickHandler=function(e){0!=this.curObj.status?this.curObj&&(TR.ins.hasEmptyNum(20)?UR.instance.fullPower&&UR.instance.isAuto&&!BR.ins.isCheckPointBoss?zB.ins.showById(2126,1):ZN.isEnabledChangeScene()?jR.reqEntry(this.curObj.id):zB.ins.showById(2126,1):KQ.ins.showBagRecycle()):zB.ins.showMsg(this.needNum1+RP.n[1303]+this.needNum+RP.n[1304],1)},i.onRefesh=function(e){hN.ins.open("MAGICATTENTION_VIEW",{type:42})},i.openHelpView=function(){hN.ins.open("AE_EXPLAIN_VIEW",{desc:RP.n[1300]})},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.img_kill.visible=!1,t.btn_challenge.on("click",t,t.onClickHandler),t.txt_refesh.on("click",t,t.onRefesh),jR.reqCopy(42),t.link_help.on("click",t,t.openHelpView),t.txt_jipin.on("click",t,t.toJiPinView)},i.onRemove=function(e){var t=this;t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.btn_challenge.off("click",t,t.onClickHandler),t.txt_refesh.off("click",t,t.onRefesh),t.link_help.off("click",t,t.openHelpView),t.txt_jipin.off("click",t,t.toJiPinView),ui.SubPanel.prototype.onRemove.call(t,e)},i.destroy=function(e){void 0===e&&(e=!0),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.magic.toc_21245){for(var i=e.bossInfo,n=0;n<t._array.length;n++){var s=t._array[n];s.status=0|i[s.id].status,s.lastTime=i[s.id].lastTime}!t.list.visible&&(t.list.visible=!0),t._array=t._array.sort(t.sortArray),t.list.array=t._array,t.setStartIndex(t._array),t.box_socre.visible=!0;var o=e.socre;99999<e.socre?(t.img_wan.visible=!0,o=Math.floor(o/1e4)):t.img_wan.visible=!1,t.clip_socre.value=o+"",t.img_wan.x=t.clip_socre.x+25*o.toString().length+10,t.box_socre.centerX=0,t.txt_lastGS.color=e.ownerTimes<=0?"#e41b00":"#23b11f",t.txt_lastCY.color=e.assistTimes<=0?"#e41b00":"#23b11f",t.txt_lastGS.changeText(e.ownerTimes+"/"+t.maxTime),t.txt_lastCY.changeText(e.assistTimes+"/"+t.maxTime)}},i.setStartIndex=function(e){for(var t=-1,i=-1,n=e.length-1;0<=n;n--)1==e[n].status&&-1==i&&(i=n);t<0&&(t=i<0?0:i),(this.list.selectedIndex=t)<4?this.list.scrollTo(0):this.list.scrollTo(t-3),this.onChange(t,!0)},i.sortArray=function(e,t){if(e.isCard&&2!=e.status)return-1;if(t.isCard&&2!=t.status)return 1;var i=0==e.status?1.5:e.status,n=0==t.status?1.5:t.status;return i!=n?i-n:e.isCard!=t.isCard?t.isCard-e.isCard:e.id-t.id},i.toJiPinView=function(){hN.ins.open("BOSS_MAINVIEW",[5],0)},t}(),J0=function(e){function t(){this.target=null,this.type=0,this.flyupBossArr=[47001,47002,47003,47004,47005,47006,47007,47008,47009,47010,47011,47012,47013,47014,47015,47016,47017,47018,47019,47020,47021,47037,47038,47039,47040,47041,47042,47043,47044,47045],this.allScore=0,t.__super.call(this)}b(t,"modules.magic.views.others.Magic_AttentionItem",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.cb_attention.on("click",this,this.onCbHandler),this.cb_attention.visible=this.txt_unLevel.visible=!1},i.onRemove=function(e){this.cb_attention.off("click",this,this.onCbHandler),ui.SubPanel.prototype.onRemove.call(this,e)},i.getIsOpen=function(){var e=rn.getIndex(this.target.id),t=rn.MODEL.zsLevelLimit(e),i=rn.MODEL.levelLimit(e);if(-1==this.flyupBossArr.indexOf(this.target.id)){if(0<this.allScore){if(BR.ins.score<this.allScore)return!1;if(gR.ins.zsLv<t)return!1}else if(gR.ins.zsLv<t)return!1}else if(gR.ins.actorFlyUpLevel<HR.ins.getFlyupLimit(this.target.id)||gR.ins.zsLv<t||gR.ins.lv<i)return!1;return!0},i.setAttention=function(){var e,t=this,i=0;switch(t.type){case 41:BR.ins.jindiBossObj[t.target.id]&&(i=t.target.id,e=BR.ins.jindiBossObj[i],t.cb_attention.selected=0==e.select);break;case 42:BR.ins.mijingBossObj[t.target.id]&&(i=t.target.id,e=BR.ins.mijingBossObj[i],t.cb_attention.selected=0==e.select);break;case 47:HR.ins.map[t.target.id]&&(i=t.target.id,t.cb_attention.selected=HR.ins.map[i.toString()].selected)}},i.onCbHandler=function(e){var t=this;switch(t.type){case 41:BR.ins.jindiBossObj[t.target.id].select=t.cb_attention.selected?0:1;break;case 42:BR.ins.mijingBossObj[t.target.id].select=t.cb_attention.selected?0:1;break;case 47:HR.ins.map[t.target.id].selected=t.cb_attention.selected,Tu.sendToModule("UPDATE_FLYUP_LIST",["modules.boss.BossModule"])}var i=new bA;i.copyId=t.target.id,i.selected=t.cb_attention.selected,Tu.sendToService(i),t.event("end")},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.target=e;var i=rn.getIndex(t.target.id),n=i,s=rn.MODEL.bossId(i);t.type=rn.MODEL.cate(i),i=hn.getIndex(s);var o=hn.MODEL.name(i);t.txt_bname.changeText(o),t.txt_unLevel.visible=!t.getIsOpen(),t.cb_attention.visible=!t.txt_unLevel.visible;var a=hn.MODEL.muId(i);hn.MODEL.level(i);i=_n.getIndex(a);var r=rn.MODEL.levelLimit(n),l=rn.MODEL.zsLevelLimit(n);if(-1==t.flyupBossArr.indexOf(t.target.id)){var c=rn.MODEL.extraCondition(n);if(c)for(var u=0;u<JSON.parse(c).length;u++){var d=JSON.parse(c)[u];"MoEquipScore"==d.type&&(t.allScore=parseInt(d.value))}t.txt_unLevel.visible=!t.getIsOpen(),t.cb_attention.visible=!t.txt_unLevel.visible,0<t.allScore?t.txt_needLevel.changeText(t.allScore+""):t.txt_needLevel.changeText(l+""),1==t.txt_unLevel.visible&&t.txt_unLevel.changeText(l+RP.n[1306])}else t.txt_needLevel.changeText(mp.WORDS[HR.ins.getFlyupLimit(t.target.id)]+"重"),1==t.txt_unLevel.visible&&(gR.ins.actorFlyUpLevel<HR.ins.getFlyupLimit(t.target.id)?t.txt_unLevel.changeText(mp.WORDS[HR.ins.getFlyupLimit(t.target.id)]+RP.n[1307]):0<l?t.txt_unLevel.changeText(l+RP.n[1306]):t.txt_unLevel.changeText(r+RP.n[1309]));0<l?t.txt_blevel.changeText(l+"转"):t.txt_blevel.changeText(r+""),t.setAttention()}}),t}(Um),Z0=function(e){function t(){this._type=0,t.__super.call(this)}b(t,"modules.magic.views.others.Magic_AttentionView",Fm);var i=t.prototype;return i.initialize=function(){this.list.itemRender=J0,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.g_title.skin=_r.getBossPath("boss_text_bosstx")},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.updatePanel=function(e){var t,i=[];if(47==(this._type=e))this.txt_needDes.text=RP.n[1310],t=HR.ins.getBossInfoByIndex();else switch(t=BR.ins.getBossIds(e),e){case 42:this.txt_needDes.text=RP.n[1311];break;case 41:this.txt_needDes.text=RP.n[1312]}if(t)for(var n=0;n<t.length;n++)i.push({id:t[n],cate:e});this.list.array=i},t}(),K0=function(e){function t(){t.__super.call(this)}b(t,"modules.mail.views.MailContentNoGiftV",au);var i=t.prototype;return i.notice=function(e){"11212"==e.actionOrder&&(-1!=e.proto.list.indexOf(lu.ins.curShowVo.mail_id)&&this.onClose())},i.refresh=function(){var e=lu.ins.curShowVo;this.txContent.innerHTML=e.mail_context,this.txSender.changeText(e.mail_sender),e.isImportant?this.btnDel.visible=!1:(this.btnDel.visible=!0,this.btnDel.on("click",this,this.onDel)),this.txt_no.y=this.btnDel.visible?570:600},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btnClose.on("click",this,this.onClose),this.refresh()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btnClose.off("click",this,this.onClose),this.btnDel.off("click",this,this.onClose)},i.onClose=function(){hN.ins.close("MAIL_CONTENT_NOGIFT")},i.onDel=function(){var e=new zL;e.idList=[lu.ins.curShowVo.mail_id],Tu.sendToService(e)},t}(),$0=function(e){function t(){this._isDel=!1,this._grids=null,t.__super.call(this),this.btnDel.visible=!1,this.imgGet.visible=!1}b(t,"modules.mail.views.MailContentWithGiftV",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.notice=function(e){if("11207"==e.actionOrder)this.showDel();else if("11212"==e.actionOrder){-1!=e.proto.list.indexOf(lu.ins.curShowVo.mail_id)&&this.onClose()}},i.refresh=function(){var e=this,t=lu.ins.curShowVo;e.txContent.innerHTML=t.mail_context,e.txSender.changeText(t.mail_title),e._grids=[];var i,n,s,o,a=0,r=0;if(t.attrList)for(a=0;a<t.attrList.length;a++)o=t.attrList[a],n=yB.create(aR.changeToGoodsId(o.itemId),o.value),(i=new MF).size(74,74),i.bindData=n,i.pos(89*r,0),e.mcItem.addChild(i),e._grids.push(i),r++;if(t.propList)for(a=0;a<t.propList.length;a++)s=t.propList[a],n=yB.create(s.id,s.value),(i=new MF).size(74,74),i.bindData=n,i.pos(89*r,0),e.mcItem.addChild(i),e._grids.push(i),r++;var l=89*(r-1)+74;e.mcItem.width=512<l?512:l,e.mcItem.x=(e.width-e.mcItem.width)/2,e.mcItem.hScrollBarSkin="",e.mcItem.refresh(),e.showDel()},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btnClose.on("click",this,this.onClose),this.refresh()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnClose.off("click",t,t.onClose),t.btnGet.off("click",t,t.onGet),t.btnDel.off("click",t,t.onDel);for(var i=0;i<t._grids.length;i++)t._grids[i].destroy(!0);t._grids=null,t.btnDel.visible=!1,t.imgGet.visible=!1},i.showDel=function(){var e=this,t=lu.ins.curShowVo;2==t.mail_attach?(e.btnGet.visible=!1,e.imgGet.visible=!0,t.isImportant||(e.btnDel.visible=!0,e.btnDel.on("click",e,e.onDel))):1==t.mail_attach&&(e.btnGet.visible=!0,e.btnGet.on("click",e,e.onGet))},i.onClose=function(){hN.ins.close("MAIL_CONTENT_WITHGIFT")},i.onGet=function(){var e=new YL;e.idList=[lu.ins.curShowVo.mail_id],Tu.sendToService(e)},i.onDel=function(){var e=new zL;e.idList=[lu.ins.curShowVo.mail_id],Tu.sendToService(e)},t}(ru),e1=function(e){function t(){this._dm=null,t.__super.call(this),this._dm=lu.ins,this.list_mail.itemRender=sZ,this.list_mail.vScrollBarSkin="",this.txt_no.visible=!1}b(t,"modules.mail.views.MailMainView",uu);var i=t.prototype;return i.refreshList=function(){this.list_mail.dataSource=lu.ins.mailList,this.txt_no.visible=lu.ins.mailList.length<1,this.g_mask.visible=5<lu.ins.mailList.length},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_oneKey.on("click",t,t.onGetAll),t.btn_close.on("click",t,t.onClose),t.btn_deleteAll.on("click",t,t.onDeleteAll),t.list_mail.scrollBar.on("change",t,t.onScrollChanged),t.list_mail.on("click",t,t.onListMouse),t.list_mail.dataSource=lu.ins.mailList,0!=lu.ins.mailList.length&&t.list_mail.scrollTo(0),t.txt_no.visible=lu.ins.mailList.length<1,t.g_mask.visible=5<lu.ins.mailList.length},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.list_mail.off("click",t,t.onListMouse),t.btn_close.off("click",t,t.onClose),t.btn_oneKey.off("click",t,t.onGetAll),t.btn_deleteAll.off("click",t,t.onDeleteAll),t.list_mail.scrollBar.off("change",t,t.onScrollChanged)},i.onGetAll=function(e){if(0<this._dm.noGetNum){var t=new YL;t.idList=this._dm.getList,Tu.sendToService(t)}else zB.ins.showMsg(RP.n[1313],1)},i.onClose=function(e){Tu.sendToModule("CLOSE",["modules.mail.MailModule"])},i.onDeleteAll=function(e){if(0<lu.ins.readMailIDS.length){var t=Ql.createColor(RP.n[1314],"#90877b")+Ql.newline()+Ql.createColor(RP.n[1315],"#23b11f");KQ.ins.show(t,ql.create(this,this.deleteAllReadMail))}else zB.ins.showMsg(RP.n[1316],1)},i.deleteAllReadMail=function(){var e=new zL;e.idList=lu.ins.readMailIDS,Tu.sendToService(e)},i.onListMouse=function(e){if(e.target instanceof modules.mail.views.MailRender){var t=new WL;t.mail_id=this._dm.mailList[this.list_mail.selectedIndex].mail_id,Tu.sendToService(t)}},i.onScrollChanged=function(){0==this.list_mail.scrollBar.max||this.list_mail.scrollBar.value>=this.list_mail.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),t1=function(e){function t(){this.vsc=null,t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.mall.views.MallMainView",vu);var i=t.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/mall/btn_tab_smsd.png","ui/layouts/mall/btn_tab_cydj.png"],e.vsc=new SB(e),e.isTop=!0,e.vsc.registAll([{cls:oZ,id:"SUB_MYSTERY"},{cls:aZ,id:"SUB_NORMAL"}]),e.vsc.invalid(),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.checkRedPoint,null,!1)},i.checkRedPoint=function(e){return"SUB_MYSTERY"==e&&tH.instance.hasLeftFreeTime()?3:0},i.update=function(e){this.callLater(this.updateItemEnabled)},i.updateItemEnabled=function(){this.vsc.updateItemEnabled()},i.onSubChanged=function(e,t){switch(this.addChildAt(this.sp_top,this.numChildren),e){case"SUB_MYSTERY":this.setTitle(_r.getAtlasSubPath("mall/sc_text_sc.png")),this.img_ye.skin=_r.getAtlasSubPath("mall/shop_img_ad4.jpg");break;case"SUB_MILITARY":break;case"SUB_NORMAL":this.setTitle(_r.getAtlasSubPath("mall/sc_text_sc.png")),this.img_ye.skin=_r.getAtlasSubPath("mall/shop_img_ad1.jpg")}},i.updateMyStery=function(){0==this.vsc.selectedIndex&&this.vsc.updateSelectedView()},i.updateMilitaryMoney=function(){this.vsc.selectedIndex},i.selectPage=function(e){this.vsc.selectedIndex=e},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t.SUB_MYSTERY="SUB_MYSTERY",t.SUB_NORMAL="SUB_NORMAL",t.SUB_MILITARY="SUB_MILITARY",t}(),i1=function(e){function t(){this._currentMissionID=0,this._pointDataArr=null,this._imgPointArr=null,this._pathPointArr=null,this.widthPrecent=.08,this.heightPrcent=.08,t.__super.call(this)}b(t,"modules.map.views.MapPanel",mu);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._currentMissionID=BR.ins.curCopyId,t.img_map.skin=_r.getFullUrl("ui/images/map/big/"+t._currentMissionID+".jpg"),t.img_title.skin=_r.getFullUrl("ui/images/map/title/"+t._currentMissionID+".png"),t.img_map.on("click",t,t.onMapClicked),t._pathPointArr=[],t._currentMissionID=BR.ins.curCopyId,t.initView(),G.timer.loop(200,t,t.updateMainChar),G.timer.loop(1e3,t,t.updateTime),t.refreshPoint()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),G.timer.clearAll(this),this.img_map.off("click",this,this.onMapClicked)},i.onMapClicked=function(e){var t=Math.round(e.currentTarget.mouseX/this.widthPrecent/80),i=Math.round(e.currentTarget.mouseY/this.heightPrcent/40);NF.Ins().selectChar&&yH.Ins().clear(),yH.Ins().mainCharMove(new Uh(80*t,40*i)),xN.Ins().updateClickPoint(t,i)},i.initView=function(){this.img_map.skin=_r.getFullUrl("ui/images/map/big/"+this._currentMissionID+".jpg");var e=rn.getIndex(this._currentMissionID);Pn.getIndex(rn.MODEL.cId(e));this._pointDataArr=[],this._imgPointArr=[],this.updatePoint(),this.updateMainChar()},i.updatePoint=function(){for(var e,t,i=0;i<Hu.count;i++)Hu.MODEL.missionId(i)==this._currentMissionID&&((e=new Object).missionID=Hu.MODEL.missionId(i),e.pointArr=Hu.MODEL.location(i),e.nextID=Hu.MODEL.nextMissionId(i),this._pointDataArr.push(e));for(var n=0,s=0,o=0;o<this._pointDataArr.length;o++)t=new lZ,this.box_map.addChild(t),n=(e=this._pointDataArr[o]).pointArr[0],s=e.pointArr[1],t.name=e.nextID,t.x=80*n*this.widthPrecent-t.width/2+10,t.y=40*s*this.heightPrcent-t.height+20,this._imgPointArr.push(t)},i.refreshPoint=function(){var e;for(var t in this._imgPointArr){e=this._imgPointArr[t];var i=xN.Ins().mapBossDate[e.name];i&&e.updateDate(i)}},i.updateTime=function(){this.refreshPoint()},i.updateMainChar=function(){var e=this,t=NF.mainChar,i=t.dir;e.img_arrow.rotation=45*i-60,e.img_arrow.x=t.x*e.widthPrecent+5,e.img_arrow.y=t.y*e.heightPrcent+5,e.img_point.visible=!1;var n=xN.Ins().currentClickedPoint;0<n.x&&0<n.y&&t&&t.tileX!=n.x&&t.tileY!=n.y&&(e.img_point.visible=!0,e.img_point.x=80*n.x*e.widthPrecent-e.img_point.width/2,e.img_point.y=40*n.y*e.heightPrcent-e.img_point.height,e.initPathPoint())},i.initPathPoint=function(){var e,t,i=NF.mainChar._movePath_.slice();this.hidePath();for(var n=0;n<i.length;n++)(t=i[n]).x+"_"+t.y,null==(e=this._pathPointArr[n])?((e=new Kl).skin=_r.getFullUrl("ui/images/map/mjrq_dt_hx.png"),this.box_map.addChild(e),this._pathPointArr.push(e)):e.visible=!0,e.pos(t.x*this.widthPrecent,t.y*this.heightPrcent)},i.hidePath=function(){var e;if(0<this._pathPointArr.length)for(var t=0;t<this._pathPointArr.length;t++)(e=this._pathPointArr[t])&&(e.visible=!1)},t.NAME="MapPanel",t}(),n1=function(e){function t(){this.attName=null,t.__super.call(this),this.centerX=0,this.centerY=315,this.visible=!1,t._ins=this}b(t,"modules.nav.views.sub.NavAttRemind",Le);var i=t.prototype;return i.onAdd=function(e){this.img_bg.visible=!1,this.txt_1.visible=!1,ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.changeText=function(e,t,i,n){var s=this,o=_r.getAtlasSubPath("basic_ui/boss_jm_hszz.png");if(this.img.skin=o,this.img.scaleY=10,this.img.alpha=0,this.img1.skin=o,this.img1.scaleY=10,this.img1.alpha=0,this.visible=e,this.txt_1.innerHTML="",1==e)switch(i){case 1:18!=dr.dtoEnterScene.type?(this.img_bg.visible=!0,this.txt_1.visible=!0,this.width=735,this.txt_1.x=72,this.txt_1.width=592,this.txt_1.innerHTML="受到"+Ql.createColor(t,"#23b11f")+RP.n[1317]):(this.img_bg.visible=!1,this.txt_1.visible=!1),this.stage.addChild(this.img),this.stage.addChild(this.img1),Og.to(this.img,{alpha:1},1e3,pa.linearIn,null,0,!1,!1),Og.to(this.img,{alpha:0},1e3,pa.linearIn,null,1e3,!1,!1),Og.to(this.img,{alpha:1},1e3,pa.linearIn,null,2e3,!1,!1),Og.to(this.img,{alpha:0},1e3,pa.linearIn,ql.create(this,this.destoryRedLight,[this.img]),3e3,!1,!1),Og.to(this.img1,{alpha:1},1e3,pa.linearIn,null,0,!1,!1),Og.to(this.img1,{alpha:0},1e3,pa.linearIn,null,1e3,!1,!1),Og.to(this.img1,{alpha:1},1e3,pa.linearIn,null,2e3,!1,!1),Og.to(this.img1,{alpha:0},1e3,pa.linearIn,ql.create(this,this.destoryRedLight,[this.img1]),3e3,!1,!1),G.timer.once(1e4,this,function(){s.changeText(!1)});break;case 2:18!=dr.dtoEnterScene.type?(this.img_bg.visible=!0,this.txt_1.visible=!0,BR.ins.toc24004&&(BR.ins.toc24004.playerId.toString()==n?this.txt_1.innerHTML=RP.n[1318]+Ql.createColor(t,"#23b11f"):this.txt_1.innerHTML=RP.n[1319]+Ql.createColor(t,"#23b11f")),this.width=496,this.txt_1.x=52,this.txt_1.width=363):(this.img_bg.visible=!1,this.txt_1.visible=!1),G.timer.once(1e4,this,function(){s.changeText(!1)});break;case 3:18!=dr.dtoEnterScene.type?(this.img_bg.visible=!0,this.txt_1.visible=!0,this.txt_1.innerHTML=RP.n[1320]+Ql.createColor(t,"#23b11f")+RP.n[1321],this.width=496,this.txt_1.x=52,this.txt_1.width=363):(this.img_bg.visible=!1,this.txt_1.visible=!1),G.timer.once(1500,this,function(){s.changeText(!1)})}},i.destoryRedLight=function(e){G.stage.removeChild(e)},p(1,t,"ins",function(){return t._ins=t._ins||new t},layouts.nav.AttRemindUI._$SET_ins),t.NAME="NavAttRemind",t._ins=null,t}(),s1=function(e){function t(){this.time=30,t.__super.call(this)}b(t,"modules.nav.views.sub.NavCallFriendView",wd);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.img_cd.visible=!1,this.txt_cd.text="",this.btn_call.disabled=!1,LN.isCall=!1,this.time=30},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),G.timer.clear(this,this.textState)},i.notice=function(e){},i.textState=function(){var e=this;e.time<=0?(e.time=30,G.timer.clear(e,e.textState),LN.isCall=!1,e.img_cd.visible=!1,e.txt_cd.text="",e.btn_call.disabled=!1):(e.time--,e.btn_call.selected=!1,e.img_cd.visible=!0,e.txt_cd.text="剩余:"+e.time+"s",e.btn_call.disabled=!0)},i.onClick=function(e){null!=gR.ins.guildName?1!=LN.isCall&&(LN.isCall=!0,dr.dtoEnterScene&&54==dr.dtoEnterScene.type&&gN.ins.reqInvite(BR.ins.curCopyId),this.textState(),G.timer.loop(1e3,this,this.textState,null,!1),zB.ins.playRainbowById(32),bN.reqCallFriend(BR.ins.curCopyId)):zB.ins.showById(2031,1)},t.NAME="NavCallFriend",t}(),o1=function(e){function t(){this.openAlertBool=!1,t.__super.call(this)}b(t,"modules.offline.views.OfflinePanelView",bh);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),SF.GetIntance().offLineTime=pt.now(),this.img_circle.rotation=0,this.frameLoop(1,this,this.onTimer),G.timer.loop(1e3,this,this.onReconected)},i.onTimer=function(){this.img_circle.alpha<1&&(this.img_circle.alpha=Math.min(this.img_circle.alpha+.02,1)),this.img_circle.rotation+=24},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),G.timer.clearAll(this)},i.onReconected=function(){var e=this;if(SF.GetIntance().loginSocket.connected){tr.push(RP.n[1322]),PN.ins.reConnectTime=0,PN.ins.currentOfflineSecond=0;var t=new _L;t.arthor=hr.uid,t.platform=hr.platform,t.serverId=hr.serverID,Tu.sendToService(t),tr.push(RP.n[1323]+hr.key+" arthor="+t.arthor+RP.n[1324]+t.platform+RP.n[1325]+t.serverId),this.close()}else{if(30<=PN.ins.currentOfflineSecond&&0==PN.ins.reConnectTime)return PN.ins.reConnectTime++,G.timer.clearAll(this),tr.push(RP.n[1326]),this.close(),this.openAlertBool=!0,KQ.ins.show(RP.n[1327],ql.create(null,function(){e.openAlertBool=!1,hN.ins.open("OfflinePanelView")}),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),void(KQ.ins.cancelClose=!0);if(40<=PN.ins.currentOfflineSecond&&1==PN.ins.reConnectTime)return G.timer.clearAll(this),PN.ins.reConnectTime++,tr.push(RP.n[1328]),this.close(),this.openAlertBool=!0,KQ.ins.show(RP.n[1329],ql.create(null,function(){e.openAlertBool=!1,pt.window.location.reload()}),!1,1,null,null,!1),KQ.ins.setMaskCancel(!1),void(KQ.ins.cancelClose=!0);console.log("offline connect",SF.GetIntance().loginSocket.connected,hr.socket_host,hr.socket_port),0==this.openAlertBool&&PN.ins.currentOfflineSecond++,SF.GetIntance().reconnectedFun(),tr.push(RP.n[1330]+RP.n[1331]+hr.socket_host+RP.n[1332]+hr.socket_port+"   key"+hr.key)}},t.NAME="OfflinePanelView",t.COUNT_DOWN_SEC=3,t}(),a1=function(e){function t(){this.goodsSP=null,this._equipAvatar=null,this._equipIndex=0,this.isHasTools=!1,this._achieves=null,this.selctedTarget=null,this.suitList=[],t.__super.call(this)}b(t,"modules.passsuit.views.PassSuitComposeView",LI);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.suitList=[],t.initUI(),t.btnClose.on("click",t,t.onCloseViewListener),t.btnCompose.on("click",t,t.onCloseViewListener),t.txtGet.on("click",t,t.onCloseViewListener);for(var i=0;i<t.suitList.length;i++)t.suitList[i].on("click",t,t.onClickEquListener);t._equipIndex=0,t.selctedTarget=t.suitList[0],t.selctedTarget.select=!0,t.showCurrentComposeCost(),0==t._equipIndex?t.txtGet.changeText(RP.n[1333]):1==t._equipIndex?t.txtGet.changeText(RP.n[1334]):t.txtGet.changeText(RP.n[1335])},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnClose.off("click",t,t.onCloseViewListener),t.btnCompose.off("click",t,t.onCloseViewListener),t.txtGet.off("click",t,t.onCloseViewListener);for(var i=0;i<t.suitList.length;i++)t.suitList[i].off("click",t,t.onClickEquListener),t.suitList[i].parent&&t.suitList[i].parent.removeChild(t.suitList[i]),t.suitList[i]=null;t.suitList=null,t._equipAvatar&&(t._equipAvatar.parent&&t._equipAvatar.parent.removeChild(t._equipAvatar),t._equipAvatar.dispose(),t._equipAvatar=null),t._equipIndex=0,t.selctedTarget&&(t.selctedTarget.select=!1,t.selctedTarget=null),t.goodsSP&&(t.goodsSP.parent&&t.goodsSP.parent.removeChild(t.goodsSP),t.goodsSP=null)},i.refreshTools=function(){this.showCurrentComposeCost(),hN.ins.isOpen("PASSSUIT_COMPOSE_VIEW")&&hN.ins.close("PASSSUIT_COMPOSE_VIEW")},i.onCloseViewListener=function(e){var t=this;if(e.target==t.btnClose)hN.ins.isOpen("PASSSUIT_COMPOSE_VIEW")&&hN.ins.close("PASSSUIT_COMPOSE_VIEW");else if(e.target==t.btnCompose)if(0==t.isHasTools)zB.ins.playErrorMsg(RP.n[658]);else{var i=Ms.MODEL.composeID(t._equipIndex);OR.requestExchange(i)}else if(e.target==t.txtGet){var n=0,s=0;s=0==t._equipIndex||1==t._equipIndex?(n=Ms.MODEL.goodsId(t._equipIndex),Bi.getIndex(n)):(n=t.goodsSP.goodsId,Bi.getIndex(t.goodsSP.goodsId)),Bi.MODEL.achieving(s)?Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:n}):t._achieves&&t._achieves.removeSelf()}},i.onClickEquListener=function(e){var t=this,i=parseInt(e.target.name.split("_")[1]);i!=t._equipIndex&&(null!=t.selctedTarget&&(t.selctedTarget.select=!1),t._equipIndex=i,t.selctedTarget=e.target,t.selctedTarget.select=!0,t.showCurrentComposeCost(),0==t._equipIndex?t.txtGet.text=RP.n[1337]:1==t._equipIndex?t.txtGet.text=RP.n[1338]:t.txtGet.text=RP.n[1339])},i.showCurrentComposeCost=function(){var e=this,t=0;e.hde_goods.style.fontSize=20,e.hde_goods.style.font="SimHei",e.hde_goods.style.align="center",e.hde_goods.y=9;var i=Ms.MODEL.composeID(e._equipIndex),n=xa.MODEL.consumption(i-1);if(n){var s=JSON.parse(n);if("goods"==s[0].type)var o=parseInt(s[0].value.split(":")[0]),a=parseInt(s[0].value.split(":")[1]);e.goodsSP.bindData=o,a<=(t=TR.ins.getGoodsNum(o))?(e.hde_goods.innerHTML=Ql.createColor(t+"","#23b11f")+Ql.createColor("/"+a,"#e0d6c1"),e.isHasTools=!0):(e.hde_goods.innerHTML=Ql.createColor(t+"","#ff2e24")+Ql.createColor("/"+a,"#e0d6c1"),e.isHasTools=!1)}e.updateAvatar()},i.updateAvatar=function(){var e=this;e._equipAvatar&&(e._equipAvatar.parent&&e._equipAvatar.parent.removeChild(e._equipAvatar),e._equipAvatar.dispose(),e._equipAvatar=null),e._equipAvatar=mj.GetNew(),e._equipAvatar.renderInSelf=!0,e._equipAvatar.mouseEnabled=e._equipAvatar.mouseThrough=!1,e._equipAvatar.pos(310,355),e.addChild(e._equipAvatar),e._equipAvatar.loadEffect(JZ._activeEffs[e._equipIndex]),e._equipAvatar.scaleX=e._equipAvatar.scaleY=.85},i.initUI=function(){var e=this;e.centerX=e.centerY=0;var t,i=0,n="";for(i=0;i<8;i++)(t=new rq).x=e["grid_"+i].x,t.y=e["grid_"+i].y,t.position=i,t.level=1,n=Ms.MODEL.name(i),e["label_"+i].text=n,t.name="itemGrid_"+i,e.suitList.push(t),e.addChild(t);e.goodsSP=new AF(40),e.spContaner.addChild(e.goodsSP),e.goodsSP.needGridBg=!1,e.goodsSP.x=54,e.goodsSP.y=0},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t.MAX_LENGTH=8,t}(),r1=function(e){function t(){this.list_fenjie=null,this._achieves=null,t.__super.call(this),this.initUI()}b(t,"modules.passsuit.views.PassSuitFenJieView",AI);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseViewListener),this.panel_fenjie.vScrollBar.on("change",this,this.onScrollChanged),this.showInfo(),this.showAchieves()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.clearItem(),this.btn_close.off("click",this,this.onClickCloseViewListener),this.panel_fenjie.vScrollBar.off("change",this,this.onScrollChanged)},i.refreshFenJiePanel=function(){this.showInfo()},i.showAchieves=function(){var e=this,t=Bi.getIndex(2070);Bi.MODEL.achieving(t)?(null==e._achieves&&(e._achieves=new zW(530),e._achieves.centerX=0,e._achieves.bottom=58,e.addChild(e._achieves)),e._achieves.update(2070)):e._achieves&&e._achieves.removeSelf(),e.g_mask.bottom=e._achieves.height+e._achieves.bottom+19,e.panel_fenjie.height=e.height-e.g_mask.bottom-e.panel_fenjie.y},i.showInfo=function(){var e,t,i=TR.ins.getBackPackCS(),n=0;for(n=0;n<i.length;n++)e=i[n],this.list_fenjie.length>n?t=this.list_fenjie[n]:(t=new _Y,this.list_fenjie.push(t)),t.data=e,t.x=10,t.y=10+165*n,null==t.parent&&this.panel_fenjie.addChild(t);for(;n<this.list_fenjie.length;n++)this.list_fenjie[n].parent&&this.list_fenjie[n].parent.removeChild(this.list_fenjie[n]);this.list_fenjie.length=i.length},i.clearItem=function(){for(var e=0;e<this.list_fenjie.length;e++)null!=this.list_fenjie[e].parent&&this.list_fenjie[e].parent.removeChild(this.list_fenjie[e]),this.list_fenjie[e]=null;this.list_fenjie=[]},i.onClickCloseViewListener=function(e){hN.ins._closePanel(this)},i.initUI=function(){this.centerX=this.centerY=0,this.panel_fenjie.vScrollBarSkin="",this.panel_fenjie.vScrollBar.elasticDistance=300,this.list_fenjie=[]},i.onScrollChanged=function(){this.list_fenjie.length<=3||0==this.panel_fenjie.vScrollBar.max||this.panel_fenjie.vScrollBar.value>=this.panel_fenjie.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),l1=function(e){function t(){var e=this;e._effect=null,e.type_prestige=11,e.RANKS=[{name:"战力榜",type:2,tab:"btn_tab_zlb.png"},{name:"神装榜",type:17,tab:"btn_tab_zlb.png"},{name:"等级榜",type:1,tab:"btn_tab_djb.png"},{name:"杀戮榜",type:7,tab:"btn_tab_yzb.png"},{name:"关卡榜",type:10,tab:"btn_tab_swb.png"},{name:"威望榜",type:11,tab:"btn_tab_swb.png"},{name:"官职榜",type:12,tab:"btn_tab_swb.png"},{name:"魅力榜",type:18,tab:"btn_tab_swb.png"},{name:"徽章榜",type:13,tab:"btn_tab_swb.png"}],e.avatar=null,e.first=null,e.arr=[],e.btnType=null,e._avator=null,e._posX=[-50,-135,185],e._posY=[180,125,125],e._scaleArr=[.6,.5,.5],e._diTuX=[188,77,393],e._diTuY=[384,310,310],e._index=0,e.ac=null,e.m_selectedIndex=0,e.rankDataManager=o_.ins,t.__super.call(e),e.isTop=!0,e.list.itemRender=mY,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=200,e.list.scrollBar.on("change",e,e.onScrollEnd),e.list_title.scrollTo(0),e.list_title.selectedIndex=0,e.list_title.selectEnable=!0,e.list_title.dataSource=e.RANKS,e.list_title.vScrollBarSkin="",e.list_title.selectHandler=ql.create(e,e.onChange,null,!1),e.getListData(),e._avator=[],e.first=new mY,e.first.pos(e.list.x,e.list.top-56),e.addChild(e.first),e.ditu_1.visible=!1,e.ditu_2.visible=!1,e.ditu_3.visible=!1,e.txt_no.visible=!1,e.title=_r.getTitlePath("phb_text__phb"),e.setTitle(e.title)}b(t,"modules.rank.views.RankView",r_);var i=t.prototype;return i.getListData=function(){this.arr=[];for(var e=0;e<9;e++)this.arr.push({listName:{text:this.RANKS[e].name}});this.list_title.array=this.arr,this.list_title.renderHandler=ql.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr.length)){var i=this.arr[t];this.btnType=e.getChildByName("btn_type"),this.btnType.label=i.listName.text,this._index==t?this.btnType.selected=!1:this.btnType.selected=!0}},i.onScrollEnd=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.updateByVSC=function(e){"10702"==e.actionOrder?this.update():"number"==typeof e.actionOrder?this.tabIndex=e.actionOrder:"number"==typeof e&&(this.tabIndex=e)},i.update=function(){var e=this,t=e.RANKS[e.list_title.selectedIndex],i=e.rankDataManager.getRank(t.type);if(i){0<i.myRank?(e.txt_me.changeText(i.myRank+""),e.txt_me.color="#23b11f"):(e.txt_me.changeText("未上榜"),e.txt_me.color="#e70909"),0<i.datas.length?e.txt_no.visible=!1:e.txt_no.visible=!0,null!=e._effect&&e._effect.dispose();var n=Cn.getIndex(i.type),s=Cn.MODEL.firstT(n);0<i.datas.length&&(e._effect=mj.GetNew(),e._effect.pos(367,210),e._effect.renderInSelf=!0,e.addChild(e._effect),e._effect.loadEffect(s,"body_top"));var o=i.datas.concat();if(0<o.length?(e.first.dataSource=o.shift(),e.first.visible=!0):e.first.visible=!1,e.list.array=o,e.list.scrollTo(0),0<i.datas.length)for(var a=i.datas[0].roles,r=JSON.parse(a),l=(a.split(","),0);l<3;l++)if(r[l]){e._avator[l]?e.ac=e._avator[l]:(e.ac=new CF,e.ac.pos(e._posX[l],e._posY[l]),e.ac.scale(e._scaleArr[l],e._scaleArr[l]),e["ditu_"+(l+1)].pos(e._diTuX[l],e._diTuY[l]),e["ditu_"+(l+1)].visible=!0,e.addChild(e.ac),e._avator.push(e.ac));var c=0;switch(r[l].gender){case"MALE":c=1;break;case"FEMALE":c=2}e.ac.changeAvatar(c,r[l].weapon,r[l].avatar,r[l].wingAvartar),e._avator[l].visible=!0,e["ditu_"+(l+1)].visible=!0,e.firstBtn.dataSource=i.datas[0],e.firstBtn.on("click",e,e.onClick)}else e._avator[l]&&(e._avator[l].visible=!1,e["ditu_"+(l+1)].visible=!1);else{for(l=0;l<3;l++)e._avator[l]&&(e._avator[l].visible=!1,e["ditu_"+(l+1)].visible=!1);e.firstBtn.off("click",e,e.onClick)}}},i.onAdd=function(e){this.btn_help.on("click",this,this.openHelp),ui.SubPanel.prototype.onAdd.call(this,e),0<=this.list_title.selectedIndex?this.onChange(null):this.list_title.selectedIndex=0,this.m_selectedIndex=0},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_help.off("click",this,this.openHelp),this.rankDataManager.reset(),this._effect&&this._effect.dispose(),this._effect=null},i.openHelp=function(){QR.goToOpenHelpDes(1)},i.onChange=function(e){var t=this.RANKS[this.list_title.selectedIndex];this._index=this.list_title.selectedIndex;var i=t.type;this.rankDataManager.type=i,this.rankDataManager.getRank(i)?this.update():BN.reqRank(i),UB.ins._playPanelSound()},i.onClick=function(e){this.firstBtn.dataSource&&nR.reqViewOther(this.firstBtn.dataSource.id)},i.destroy=function(e){void 0===e&&(e=!0),this.list.scrollBar.off("change",this,this.onScrollEnd),this._effect&&this._effect.dispose(),this._effect=null,ui.SubPanel.prototype.destroy.call(this,e)},p(0,i,"tabIndex",null,function(e){for(var t=0;t<this.RANKS.length;t++){this.RANKS[t].type==e&&(this.m_selectedIndex=t,this.layout&&(this.list_title.selectedIndex=t,this.tabScrollTo(t)))}}),t}(),c1=function(e){function t(){this.mng=null,this.listItem=[],t.__super.call(this),this.mng=HN.ins,this.fcNum.value=parseInt($e.MODEL.value($e.getIndex(398))).toString(),this.txt_ms.style.font="SimHei",this.txt_ms.style.fontSize=24,this.txt_ms.style.color="#90877b",this.txt_ms.style.leading=9}b(t,"modules.recharge.views.BaiYuanHaoLiV",Ze);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.txt_ms.innerHTML=ei.MODEL.content(ei.getIndex(11105)),this.reqViewInfo()},i.onRemove=function(e){for(ui.SubPanel.prototype.onRemove.call(this,e);this.listItem&&0<this.listItem.length;)this.listItem.shift().ondisponse(),null},i.update=function(){var e,t=0;if(this.txt_cz.text=this.mng.toc_baiY.totolMoney+"元/98元",this.listItem.length<Nt.count)for(t=0;t<Nt.count;t++)e=new yY,this.listItem.push(e),e.parent||this.box_c.addChild(e),e.pos(28,220*t+447);for(t=0;t<this.listItem.length;t++)this.listItem[t].update({state:this.mng.toc_baiY.hash_state.take(t+1),award:Nt.MODEL.reward(t),day:t+1,logInDay:this.mng.toc_baiY.logInDay})},i.reqViewInfo=function(){var e=new mP;Tu.sendToService(e)},t}(),u1=function(e){function t(){this._eff=null,this._currentIdex=0,this.goodsStr="",this.RECOMMAND_INDEX=3,this.goodsArr=[],t.__super.call(this),this.centerX=0,this.y=0,this.initUI()}b(t,"modules.recharge.views.FirstRechargeV",Ga);var i=t.prototype;return i.initUI=function(){var e=this;e.div_desc.innerHTML="建议"+Ql.createColor(RP.n[1340],"#01b527")+RP.n[1341],e.btn_get.clickHandler=ql.create(e,e.onGet,null,!1);for(var t=Ln.count,i=[],n=0;n<t;n++)5==Ln.MODEL.firstMultiple(n)&&i.push(n);for(n=0;n<4;n++){var s=i[n],o=HN.ins.getShowMoney(s);e["btn_recharge"+n].label=o+"元";var a=5*HN.ins.getShowGold(s);e["div_desc"+n].innerHTML="获得"+Ql.createColor(a+"","#fcd132")+"元宝",e["btn_recharge"+n].clickHandler=ql.create(e,e.onRecharge,[s],!1)}e.btn_get.visible=!1},i.onRecharge=function(e){if(!(e<0||e>=Ln.count))if(e<this.RECOMMAND_INDEX){var t=HN.ins.getShowMoney(e),i=HN.ins.getShowMoney(this.RECOMMAND_INDEX),n=5*HN.ins.getShowGold(this.RECOMMAND_INDEX),s="充值"+i+RP.n[1342]+t+"元",o=RP.n[1343]+i+RP.n[1344]+n+RP.n[1345];KQ.ins.show(o,ql.create(this,this.pay,[e]),!1,2,s)}else this.pay(this.RECOMMAND_INDEX,1)},i.pay=function(e,t){1==t?EB.pay(1,Ln.MODEL.key(this.RECOMMAND_INDEX)):EB.pay(1,Ln.MODEL.key(e))},i.onClose=function(){hN.ins._closePanelForce(this)},i.onGet=function(){var e=new XA;e.day=this._currentIdex,Tu.sendToService(e)},i.onGetPay=function(e){var t=this;t.pay_0.selected=t.pay_1.selected=t.pay_2.selected=!1;var i=0,n=0,s="";e.target==t.pay_0?(s=t.getOneDay(),i=t.showInfo(1),n=1):e.target==t.pay_1?(s=fi.MODEL.secondDayReward(0),i=t.showInfo(2),n=2):e.target==t.pay_2&&(s=fi.MODEL.thirdDayReward(0),i=t.showInfo(3),n=3),t.box_sel.pos(e.target.x,e.target.y),t.showGoods(s),t.img_ad0.visible=t.img_ad1.visible=t.img_ad2.visible=e.target!=t.pay_1&&e.target!=t.pay_2,t.showBtnGetState(i,n)},i.destroy=function(e){void 0===e&&(e=!0),this.clear(),G.loader.clearRes(this.img_topBG.skin),G.loader.clearRes(this.img_des.skin),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.updateByVSC(),t.pay_0.on("click",t,t.onGetPay),t.pay_1.on("click",t,t.onGetPay),t.pay_2.on("click",t,t.onGetPay),hN.ins.close("FIRST_PAY"),t.parent.parent.addChild(t.box_top)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.parent.parent.removeChild(t.box_top),t.pay_0.off("click",t,t.onGetPay),t.pay_1.off("click",t,t.onGetPay),t.pay_2.off("click",t,t.onGetPay),hN.ins.close("FIRST_PAY"),null!=t._eff&&t._eff.dispose(),t._eff=null},i.updateByVSC=function(){var e=this;if(null!=HN.ins.toc_recharge){e.red_0.visible=e.red_1.visible=e.red_2.visible=!1;var t,i=-1,n=HN.ins.toc_recharge.hash_state,s=0;if(0<n.length){for(var o=0 in n.proto)if(HN.ins.toc_recharge.day>=o&&(i=n.take(o)+1,1==(s=o)&&(t=e.getOneDay()),2==o?t=fi.MODEL.secondDayReward(0):3==o&&(t=fi.MODEL.thirdDayReward(0)),0==n.take(o))){i=n.take(o)+1,s=o;break}0<s&&(s-1==1?e.txt_day.text=RP.n[1346]:s-1==2&&(e.txt_day.text=RP.n[1347]),e.box_sel.pos(e["pay_"+(s-1)].x,e["pay_"+(s-1)].y),e["red_"+(s-1)].visible=1==i,e.img_ad0.visible=e.img_ad1.visible=e.img_ad2.visible=!1)}s<=0&&(s=1,t=e.getOneDay(),i=0,e.txt_day.text=RP.n[1348],e.box_sel.pos(e.pay_0.x,e.pay_0.y)),e.showGoods(t),e.showBtnGetState(i,s)}},i.flyGoods=function(){this.goodsStr&&0<this.goodsStr.length&&zB.ins.playGetGoods(this.goodsStr)},i.showGoods=function(e){var t=this;if(t.clear(),(t.goodsStr=e)&&0<e.length){for(var i=e.split(";"),n=i.length,s=0;s<5;s++){if(s<n){var o=new MF;o.needEffect=!1,o.pos(t["img_grid"+s].x,t["img_grid"+s].y),t.box_c.addChild(o);var a=i[s].split(","),r=parseInt(a[0]),l=parseInt(a[1]),c=yB.create(r,l);c.disAchi=!1,o.needEffect=!0,o.bindData=c,t["txt_name"+s].changeText(Bi.MODEL.name(c.cfgIdx)),t["txt_name"+s].color=ms.getByQuality(Bi.MODEL.colourId(c.cfgIdx))}else t["txt_name"+s].changeText("");t.goodsArr.push(o)}for(s=0;s<3;s++)t.box_c.addChild(t["img_ad"+s])}},i.clear=function(){for(;this.goodsArr&&0<this.goodsArr.length;){var e=this.goodsArr.shift();e.removeSelf(),e=null}},i.showBtnGetState=function(e,t){var i=this;i.img_jy.visible=!0,i._currentIdex=t,0==e?1==t?(i.txt_lq.visible=i.btn_get.visible=!1,i.spr_recharge.visible=!0):(i.txt_lq.visible=i.btn_get.disabled=!0,i.img_jy.visible=i.spr_recharge.visible=!1,i.btn_get.label=RP.n[935],2==t?i.txt_lq.text=RP.n[1350]:3==t&&(i.txt_lq.text=RP.n[1351])):1==e?(i.btn_get.label=RP.n[935],i.btn_get.visible=!0,i.img_jy.visible=i.spr_recharge.visible=i.txt_lq.visible=i.btn_get.disabled=!1):2==e&&(i.btn_get.label="已领取",i.btn_get.disabled=i.btn_get.visible=!0,i.img_jy.visible=i.txt_lq.visible=i.spr_recharge.visible=!1),1==e&&null==i._eff?(i._eff=mj.GetNew(),i._eff.loadEffect("jm1242"),i._eff.renderInSelf=!0,i._eff.setXY(360,992),i._eff.scale(1.35,1.35),i.box_c.addChild(i._eff)):1!=e&&i._eff&&(i._eff.dispose(),i._eff=null)},i.getOneDay=function(){var e="",t=gR.ins.actorList[0];return t.job==ha.ZHAN.type?e=fi.MODEL.zhanshiReward(0):t.job==ha.FA.type?e=fi.MODEL.fashiReward(0):t.job==ha.DAO.type&&(e=fi.MODEL.daoshiReward(0)),e},i.showInfo=function(e){var t=0;return t=HN.ins.toc_recharge.day<e?0:parseInt(HN.ins.toc_recharge.hash_state.take(e).toString())+1,1==e?this.txt_day.text=RP.n[1353]:2==e?this.txt_day.text=RP.n[1354]:3==e&&(this.txt_day.text=RP.n[1355]),t},t}(),d1=function(e){function t(){var e=this;e.vsc=null,e._curIdx=-1,t.__super.call(e),e.top=e.bottom=0,e.centerX=0,e.title=_r.getAtlasSubPath("recharge/cz_czyb_title_cz.png"),e.vsc=new SB(e),e.vsc.registAll([{cls:sK,id:"1"}]),e.vsc.invalid(),e.isTop=!0,e.mouseThrough=!0}b(t,"modules.recharge.views.RechargeMV",l_);var i=t.prototype;return i.updateRecharge=function(){this.vsc.selectedView instanceof modules.recharge.views.RechargeSubV&&this.vsc.selectedView.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t}(),h1=function(e){function t(){this.REMAIN_TIME=30,this._totalTime=0,this.reliveType=0,t.__super.call(this)}b(t,"modules.relive.views.ReliveTipsView",g_);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.box_1.mouseEnabled=this.box_1.mouseThrough=!0,this.btn_point.on("click",this,this.onBtnClick),this.update(),this.txt_time.x=165,eq.panelLayer&&eq.panelLayer.setMaskAlpha(.1)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_point.off("click",this,this.onBtnClick),this.closePanel()},i.update=function(){var e=this;p_.toc24006&&(e.txt_name.innerHTML="您被"+Ql.createColor(p_.toc24006.killerName,"#e6d80d")+"击败"),e.txt_guildName.innerHTML="";var t=rn.getIndex(BR.ins.curCopyId);e.reliveType=rn.MODEL.reliveType(t),e.REMAIN_TIME=rn.MODEL.reliveCD(t);var i=rn.MODEL.reliveConsumptionDefs(t);if(e.icon_money.visible=!1,e.txt_guildName.visible=!1,e.btn_point.visible=e.box_1.visible=!0,e.txt_time.y=75,0!=e.REMAIN_TIME&&""!=i&&null!=i){for(var n=JSON.parse(i),s=0;s<n.length;s++){var o=n[s];if("res"==o.type){var a=String(o.value).split(":");e.icon_money.visible="GOLD"==a[0],e.txt_money.text=a[1]}}e.txt_money.visible=e.icon_money.visible=!0,e.btn_point.visible=1==e.reliveType}else e.txt_guildName.visible=!0,e.btn_point.visible=e.box_1.visible=!1,dr.dtoEnterScene&&13==dr.dtoEnterScene.type&&(e.txt_name.innerHTML="您被 ["+Ql.createColor(p_.toc24006.killerName,"#e6d80d")+"]击杀 ",e.txt_guildName.innerHTML=RP.n[1356]+Ql.createColor(p_.toc24006.guildName,"#ff0000")+"]",e.txt_time.y=135,e.REMAIN_TIME=DN.instance.getReliveTimes(),Tu.sendToModule("NEW_SS_CHAR_DEAD",["modules.newsiege.NewSiegeModule"]));e._totalTime=e.REMAIN_TIME,e.showTimeTxt(e.txt_time,e._totalTime),G.timer.loop(1e3,e,e.onTimer,[e.txt_time])},i.closePanel=function(){G.timer.clear(this,this.onTimer),this._totalTime=0,this.close()},i.onTimer=function(e){if(!(BR.ins.curCopyId<=0))return this._totalTime--,this.showTimeTxt(this.txt_time,this._totalTime),this._totalTime<=0?(this.sendRelive(0),void this.closePanel()):void 0;Tu.sendToModule("RELIVEVIEW_CLOSE",["modules.relive.ReliveModule"])},i.showTimeTxt=function(e,t){t<0&&(t=0),e.innerHTML=Ql.createColor(t+"秒","#23b11f")+RP.n[1357]},i.onBtnCityClick=function(e){0<this._totalTime||this.sendRelive(0)},i.onBtnClick=function(e){this.sendRelive(1)},i.sendRelive=function(e){var t=new wA;t.type=e,Tu.sendToService(t)},t}(),_1=function(e){function t(){this.vsc=null,this.RESONATE_VIEW=1,t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.resonate.views.ResonateSubView",b_);var i=t.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.centerX=0,e.vsc=new SB(e),e.vsc.filterHandler=ql.create(e,e.onVscFilter,null,!1),e.vsc.registAll([{cls:rK,id:e.RESONATE_VIEW,showDragon:!0,isHideBg:!0}]),e.vsc.invalid(),e.navList=["ui/layouts/resonate/yq_btn_smgm.png"],e.title=_r.getAtlasSubPath("resonate/smgm_text_smgm.png")},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.onVscFilter=function(e,t){return 0},i.updateGoods=function(){var e=this.vsc.selectedView;e&&e.updateGoods&&e.updateGoods()},i.refresh=function(){var e=this.vsc.selectedView;e&&e.refresh&&e.refresh()},t}(),f1=function(e){function t(){var e=this;e._font=null,e._grids=null,e._bar=null,e._eff=null,e._viewEff=null,e._isFly=!1,e._effInfo={},e.day=null,e._iconGrids=[],t.__super.call(e),e._bar=new IY,e._bar.pos(45,10),e.box_top.addChild(e._bar),e._grids=new DF(1,5,116,22,45,!0),e._effInfo[1]="jm1226",e._effInfo[2]="jm1146",e._effInfo[3]="jm1146",e._effInfo[4]="jm1147",e._effInfo[5]="jm1146",e._effInfo[6]="jm1146",e._effInfo[7]="jm1146",e._effInfo[8]="jm1146",e._effInfo[9]="jm1226",e._effInfo[10]="jm1147",e._effInfo[11]="jm1146",e._effInfo[12]="jm1226",e._effInfo[13]="jm1147",e._effInfo[14]="jm1147",e._font=new Is(e.txt_day.fontSize),kB.replace(e.txt_day,e._font),e.mc_get.mouseThrough=!0,e.mc_get.mouseEnabled=!0}b(t,"modules.seven.views.SevenMainView",tf);var i=t.prototype;return i.update=function(){var e=$N.ins.signinDays;this._font.clear().append(RP.n[1358],"#90877b").append(e+"","#23b11f").append("天","#90877b"),this._bar.setup()},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_get.centerX=0,t.btn_get.on("click",t,t.onClick),t._bar.on("select",t,t.onSelect),$N.ins.signinData&&t.update(),t.parent.parent.addChild(t.box_top)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_get.off("click",t,t.onClick),t._bar.off("select",t,t.onSelect),t._eff&&(t._eff.parent&&t._eff.parent.removeChild(t._eff),t._eff.dispose(),t._eff=null),t.parent.parent.removeChild(t.box_top)},i.destroy=function(e){void 0===e&&(e=!0),this._effInfo={},this._grids.destroy(e),ui.SubPanel.prototype.destroy.call(this,e)},i.onClick=function(e){var t=$N.ins.signinData.gifts[this._bar.selectIndex];WB.getGift(t.giftId,ql.create(this,this.onActGift,[t.giftId]))},i.onSelect=function(e){var t=this,i=t._bar.selectIndex,n=$N.ins.signinData.gifts[i],s=n.rewardGoods;if(t._iconGrids.length)for(var o=0;o<t._iconGrids.length;o++)t._iconGrids.shift().removeSelf();for(var a=0;a<5;a++){var r=new MF;r.x=t["imgIcon"+a].x,r.y=t["imgIcon"+a].y,r.size(116,116),t.box_c.addChild(r);var l=parseInt(s[a].goodsId),c=parseInt(s[a].goodsNum),u=yB.create(l,c);if(r.bindData=u,r.needEffect=!1,t["txtName"+a].changeText(Bi.MODEL.name(u.cfgIdx)),t["txtName"+a].color=ms.getByQuality(Bi.MODEL.colourId(u.cfgIdx)),t._iconGrids.push(r),0==a&&t._effInfo[i+1]){var d=mj.GetNew();d.loadEffect(t._effInfo[i+1]),d.renderInSelf=!0,d.setXY(58,58),r.addChild(d)}}var h=n.rewardGoods.concat();St.MODEL.exp(n.index)&&h.unshift(aR.getMoneyDto(St.MODEL.exp(n.index))),t._grids.gridDatas=h,t.btn_get.disabled=1!=n.status,t.btn_get.label=2==n.status?"已领取":RP.n[1359],t.btn_get.visible=2!=n.status,t.mc_get.visible=!1,1==n.status?t._eff||(t._eff=kB.createEffect("jm1130",t.btn_get.width>>1,t.btn_get.height>>1,t.btn_get),t._eff.scale_X=1.25,t._eff.scale_Y=1.25):(t._eff&&t._eff.dispose(),t._eff=null),t.txt_details.changeText("登录第"+t.dayText(i)+RP.n[1360])},i.onActGift=function(e){var t,i=[];for(var n in this._grids.gridDatas)t=this._grids.gridDatas[n],i.push(t.goodsId);zB.ins.playGetItems(i),this.update(),Tu.sendToModule("UPDATE_NAV",["modules.welfare.WelfareModule"])},i.onComplete=function(e){e.removeSelf(),this._isFly&&(this._isFly=!1,this.update())},i.dayText=function(e){var t=this;switch(e){case 0:t.day="一";break;case 1:t.day="二";break;case 2:t.day="三";break;case 3:t.day="四";break;case 4:t.day="五";break;case 5:t.day="六";break;case 6:t.day="七";break;case 7:t.day="八";break;case 8:t.day="九";break;case 9:t.day="十";break;case 10:t.day="十一";break;case 11:t.day="十二";break;case 12:t.day="十三";break;case 13:t.day="十四"}return t.day},t}(),p1=function(e){function t(){this.g_cost=null,this.innerAttrPillHash=null,this.upgradeLvLimit=null,this.curRoleIndex=0,this.curSelectedPill=0,t.__super.call(this)}b(t,"modules.skill.views.InnerAttrPillView",tc);var i=t.prototype;return i.initialize=function(){this.g_cost=new MF(45),this.g_cost.needGridBg=!1,this.g_cost.pos(70,0),this.g_cost.needEffect=!1,this.box_cost.addChild(this.g_cost)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.on("click",t,t.onClick),t.curRoleIndex=hN.ins._getOpenData("INNER_ATTR_PILL_VIEW").roleIndex,t.innerAttrPillHash=new jl,t.upgradeLvLimit=tB.ins.getLvLimit(t.curRoleIndex),t.initUI(),nc.reqInnerAttrPillInfo(t.curRoleIndex)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this),this.off("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){if(e instanceof protos.inner.toc_30255)e.roleIndex==this.curRoleIndex&&(this.innerAttrPillHash.put(e.goodsId,e.level,!0),this.updateView());else if(e instanceof protos.inner.toc_30257)e.innerAttrPillInfo.roleIndex==this.curRoleIndex&&(this.updateHash(e.innerAttrPillInfo.hash),this.updateView());else if(e instanceof protos.inner.toc_30259)for(var t=e,i=0;i<t.len;i++)t.innerAttrPillList[i].roleIndex==this.curRoleIndex&&(this.updateHash(t.innerAttrPillList[i].hash),this.updateView())},i.initUI=function(){for(var e=0;e<tB.ATTRPILL_GOODSID.length;e++){var t=this["img_attrd"+e],i=this["lab_name"+e];o=tB.ATTRPILL_GOODSID[e],a=Bi.getIndex(o),i.text=Bi.MODEL.name(a),t.skin=_r.getIconPath(Bi.MODEL.icon(a))}for(var n=0;n<tB.ATTRPILL_GOODSID.length;n++)this.innerAttrPillHash.put(tB.ATTRPILL_GOODSID[n],0);var s=tB.ins.getInnerAttrPillVo(this.curRoleIndex);if(s){this.updateHash(s.hash);for(var o=0,a=0,r=this.curSelectedPill=0;r<tB.ATTRPILL_GOODSID.length;r++)if(this.canUpgrade(tB.ATTRPILL_GOODSID[r])){this.curSelectedPill=r;break}this.updateView()}},i.updateHash=function(e){for(var t=0;t<tB.ATTRPILL_GOODSID.length;t++)e.has(tB.ATTRPILL_GOODSID[t])&&this.innerAttrPillHash.put(tB.ATTRPILL_GOODSID[t],e.take(tB.ATTRPILL_GOODSID[t]),!0)},i.updateView=function(){for(var e=this,t=0,i=0,n=0;n<tB.ATTRPILL_GOODSID.length;n++){var s=e["img_select"+n],o=e["img_arrow"+n],a=e["img_red"+n],r=e["lab_lv"+n];t=tB.ATTRPILL_GOODSID[n],i=Bi.getIndex(t),r.text="Lv."+(e.innerAttrPillHash.has(t)?e.innerAttrPillHash.take(t):0),s.visible=o.visible=n==e.curSelectedPill,a.visible=e.canUpgrade(t)}if(0<=e.curSelectedPill){t=tB.ATTRPILL_GOODSID[e.curSelectedPill],i=Bi.getIndex(t);var l=e.innerAttrPillHash.has(t)?e.innerAttrPillHash.take(t):0,c=Fi.MODEL.levelMax(Fi.getIndex(e.curSelectedPill+1));if(0<i){for(var u=aa.formatAttrToChineseByList(Bi.MODEL.attributes(i)),d=0;d<5;d++){var h=e["txt_attr"+(d+1)];if(h&&u[d]){h.visible=!0;for(var _,f=u[d].name;0<=f.indexOf(" ");)f=f.replace(" ","&nbsp;");_="string"==typeof u[d].val&&0<=u[d].val.indexOf("%")?(parseFloat(u[d].val.split("%")[0])*l).toFixed(2)+"%":""+parseInt(u[d].val)*l,!e.upgradeLvLimit.has(t)||l<e.upgradeLvLimit.take(t)||e.upgradeLvLimit.take(t)<c?h.innerHTML=f+"："+_+"&nbsp;&nbsp;<font style='color:#23b22f;'>+"+u[d].val+"</font>":h.innerHTML=f+"："+_}else h&&(h.visible=!1)}var p=Bi.MODEL.attributes(i);if(p){var g=JSON.parse(p);if(g){for(var v=0;v<g.length;v++)g[v].value*=l;var m=RR.getFight(g);e.num_fight.value=m}}}var y=yB.create(t);e.g_cost.bindData=y,e.txt_cost.text=TR.ins.getGoodsNum(t)+"/1",e.img_upgradeRed.visible=e.canUpgrade(t);var I=tB.ins.getInnerData(e.curRoleIndex);sc.getIndex(I.level+1);e.upgradeLvLimit.has(t)&&0!=e.upgradeLvLimit.take(t)?l<e.upgradeLvLimit.take(t)||e.upgradeLvLimit.take(t)<c?(e.btn_upgrade.disabled=!1,e.btn_upgrade.label="升 级",e.txt_limit.visible=!0,e.txt_limit.text=RP.n[1362]+e.upgradeLvLimit.take(t)+"级）"):(e.btn_upgrade.disabled=!0,e.btn_upgrade.label="已满级",e.txt_limit.visible=!1):(e.btn_upgrade.disabled=!0,e.btn_upgrade.label="升 级",e.txt_limit.visible=!0,e.txt_limit.text=RP.n[1361])}},i.canUpgrade=function(e){return this.innerAttrPillHash.take(e)<this.upgradeLvLimit.take(e)&&0<TR.ins.getGoodsNum(e)},i.onClick=function(e){var t=this;switch(e.target){case t.box_attrd0:t.curSelectedPill=0,t.updateView();break;case t.box_attrd1:t.curSelectedPill=1,t.updateView();break;case t.box_attrd2:t.curSelectedPill=2,t.updateView();break;case t.box_attrd3:t.curSelectedPill=3,t.updateView();break;case t.btn_upgrade:nc.reqInnerAttrPillUpgrade(t.curRoleIndex,tB.ATTRPILL_GOODSID[t.curSelectedPill]);break;case t.btn_close:hN.ins.close("INNER_ATTR_PILL_VIEW")}},t}(),g1=function(e){function t(){var e=this;e._grid1=null,e._grid2=null,e._grid3=null,e._resultGrid=null,e.selectArr=null,e.selectIds=null,e._effect2=null,e._resultId=0,e._itemList=[],t.__super.call(e)}b(t,"modules.skill.views.MijiComposeView",Cu);var i=t.prototype;return i.initialize=function(){var e=this;e.list_miji.itemRender=xY,e.list_miji.repeatX=4,e.list_miji.spaceX=20,e.list_miji.spaceY=10,e.list_miji.vScrollBarSkin="",e.list_miji.selectEnable=!0,e.list_miji.selectHandler=ql.create(e,e.onListMouse,null,!1),e._grid1=new MF,e._grid1.x=e.img_grid1.x,e._grid1.y=e.img_grid1.y,e._grid1.needGridBg=!1,e._grid1.needEffect=!1,e._grid1.mouseEnabled=!1,e.addChild(e._grid1),e._grid2=new MF,e._grid2.x=e.img_grid2.x,e._grid2.y=e.img_grid2.y,e._grid2.needGridBg=!1,e._grid2.needEffect=!1,e._grid2.mouseEnabled=!1,e.addChild(e._grid2),e._grid3=new MF,e._grid3.x=e.img_grid3.x,e._grid3.y=e.img_grid3.y,e._grid3.needGridBg=!1,e._grid3.needEffect=!1,e._grid3.mouseEnabled=!1,e.addChild(e._grid3),e._resultGrid=new MF,e._resultGrid.x=e.img_result.x,e._resultGrid.y=e.img_result.y,e._resultGrid.needGridBg=!1,e._resultGrid.needEffect=!1,e.addChild(e._resultGrid)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.close),t.btn_compose.on("click",t,t.onComposeClick),t.btn_area1.on("click",t,t.onClickCost,[0]),t.btn_area2.on("click",t,t.onClickCost,[1]),t.btn_area3.on("click",t,t.onClickCost,[2]),t.selectArr=[],t.selectIds=[],t.update(),t.refreshCost(),t._resultGrid.bindData=null,t.img_lock.visible=!0},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.close),t.btn_compose.off("click",t,t.onComposeClick),t.btn_area1.off("click",t,t.onClickCost,[0]),t.btn_area2.off("click",t,t.onClickCost,[1]),t.btn_area3.off("click",t,t.onClickCost,[2]),t.list_miji.selectedIndex=-1,t.list_miji.scrollTo(0),t._effect2&&(t._effect2.dispose(),t._effect2=null),t._itemList=[]},i.update=function(){this.list_miji.dataSource=null;for(var e=[],t=TR.ins.getBackPackItems(),i=0;i<t.length;i++)for(var n=t[i],s=0;s<Xs.count;s++)if(Xs.MODEL.goodsId(s)==n.goodsId){var o={};o.mijiDto=DH.create(n.goodsId,Xs.MODEL.mijiLevel(s),0),o.isLearn=!1,o.needTips=!1,e.push(o)}var a=Math.ceil(e.length/4);for(this.list_miji.repeatY=a,this.list_miji.dataSource=e,i=0;i<this.list_miji.length;i++){var r=this.list_miji.getCell(i);r&&this._itemList.push(r)}},i.refreshCost=function(){var e=this;if(e._grid1.bindData=null,0<e.selectIds.length){var t=e.selectIds[0];e._grid1.bindData=yB.create(t)}if(e._grid2.bindData=null,1<e.selectIds.length){var i=e.selectIds[1];e._grid2.bindData=yB.create(i)}if(e._grid3.bindData=null,2<e.selectIds.length){var n=e.selectIds[2];e._grid3.bindData=yB.create(n)}},i.showResult=function(e){this._resultId=e,this.playEffect1()},i.resetSelect=function(){for(var e=0;e<this._itemList.length;e++){var t=this._itemList[e];t&&(-1!=this.selectArr.indexOf(e)?t.isChangeGray=!0:t.isChangeGray=!1)}},i.onListMouse=function(e){this._resultGrid.bindData=null;var t=this.list_miji.selection;if(t){var i=t.mijiId,n=TR.ins.getGoodsNum(i);if(0==i)return;if(3<=this.selectArr.length)return;if(this.getNumInArr(i)>=n)return;this.selectArr.push(e),this.selectIds.push(i),this.refreshCost(),this.list_miji.selectedIndex=-1}},i.getNumInArr=function(e){for(var t=0,i=0;i<this.selectIds.length;i++)this.selectIds[i]==e&&t++;return t},i.setBtnStatus=function(e){this.btn_compose.mouseEnabled=e,this.btn_compose.gray=!e},i.playEffect1=function(){for(var e=1;e<=3;e++){var t=mj.GetNew();t.renderInSelf=!0,t.loadEffect("jm0016");var i=this["img_grid"+e];t.setXY(i.x+i.width/2,i.y+i.height/2),this.addChild(t)}this.timerOnce(500,this,this.playEffect2)},i.playEffect2=function(){var e=this;e._resultGrid.bindData=yB.create(e._resultId),e.img_lock.visible=!1,e.selectArr=[],e.selectIds=[],e.update(),e.refreshCost(),e._effect2=mj.GetNew(),e._effect2.renderInSelf=!0,e._effect2.loadEffect("jm0001"),e._effect2.setXY(e.img_result.x+e.img_result.width/2,e.img_result.y+e.img_result.height/2),e.addChild(e._effect2),e._effect2.playEndHandler=ql.create(e,e.playEffComplete,null,!0)},i.playEffComplete=function(){this.setBtnStatus(!0),this._effect2&&(this._effect2.dispose(),this._effect2=null),this.list_miji.tweenTo(0)},i.onComposeClick=function(){this._resultId=0,this.selectIds.length<3?zB.ins.playErrorMsg(RP.n[1363]):(this.setBtnStatus(!1),uf.reqComposeMiji(this.selectIds))},i.onClickCost=function(e){e<this.selectArr.length&&(this.selectArr.splice(e,1),this.selectIds.splice(e,1),this.refreshCost(),this.list_miji.selectedIndex=-1)},t}(),v1=function(e){function t(){t.__super.call(this)}b(t,"modules.skill.views.SeaAirGetExpView",lr);var i=t.prototype;return i.initialize=function(){this.list_qh.itemRender=wY,this.list_qh.spaceY=20,this.list_qh.vScrollBarSkin=""},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.close)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.close)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.update=function(){this.list_qh.array=[0,1,2]},t}(),m1=function(e){function t(){var e=this;e._selector=null,e.curRoleIndex=1,e.curSelectIndex=1,e.dataHash=null,e.lockId=0,e.handlType=0,e.isFirstOpen=1,e.nameStr="",e.itemArr=null,t.__super.call(e)}b(t,"modules.skill.views.MijiLaoyinView",Au);var i=t.prototype;return i.initialize=function(){var e,t=this;t._selector=new Nj,t._selector.centerX=0,t._selector.top=95,t.addChild(t._selector),t.id="MIJI_LAOYIN",t.lockId=parseInt($e.MODEL.value($e.getIndex(145))),t.btn_lock.gray=!0,t.itemArr=[];for(var i=0;i<8;i++)(e=new AF).needGridBg=!1,e.name=i+"",t["img"+i].addChild(e),t.itemArr.push(e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this._selector.on("select",this,this.onSelectRole),this.curRoleIndex=IH.ins.currentSelectedRole,this.updateStatus()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._selector.off("select",this,this.onSelectRole),G.timer.clearAll(this)},i.onClick=function(e){var t=this,i=e.target;if(i==t.btn_close)t.close();else if(i==t.g0||i==t.g1||i==t.g2||i==t.g3||i==t.g4||i==t.g5||i==t.g6||i==t.g7)t.itemClickHandler(parseInt(i.name));else if(i==t.btn_lock)if(2==t.handlType){if(TR.ins.getGoodsNum(t.lockId)<=0)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.lockId});KQ.ins.show(RP.n[1364]+t.nameStr+RP.n[1365]+Ql.createColor(RP.n[1366],"#01b527"),ql.create(t,t.alertConfirm,null))}else 1==t.handlType&&KQ.ins.show(RP.n[1367]+t.nameStr+RP.n[1368]+Ql.createColor(RP.n[1369],"#01b527"),ql.create(t,t.alertConfirm,null));else i==t.label_getway&&Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.lockId})},i.alertConfirm=function(e){1==e&&this.reqLockHandler()},i.reqLockHandler=function(){2==this.handlType?uf.reqLockMiji([this.curRoleIndex+1,this.curSelectIndex]):1==this.handlType&&uf.requnLockMiji([this.curRoleIndex+1,this.curSelectIndex]),this.handlType=0},i.itemClickHandler=function(e){var t=this;t.select_mc.visible=!1,t.dataHash=iB.ins.mijiHash;var i=t.dataHash.take(t.curRoleIndex+1);if(i){var n=i[e];if(!n.isOpen||0==n.miji_id)return t.btn_lock.label=RP.n[1370],void(t.btn_lock.gray=!0);if(1==n.isLock)t.handlType=1,t.btn_lock.label=RP.n[1371],t.btn_lock.gray=!1;else{t.handlType=2,t.btn_lock.label=RP.n[1370];var s=TR.ins.getGoodsNum(t.lockId);t.btn_lock.gray=!(0<s)}t.nameStr=Bi.MODEL.name(Bi.getIndex(n.miji_id))}t.curSelectIndex=e+1,t.select_mc.pos(t["g"+e].x-8,t["g"+e].y-8),t.select_mc.visible=!0},i.onSelectRole=function(){this.curRoleIndex=this._selector.selectIdx,IH.ins.currentSelectedRole=this._selector.selectIdx,uf.reqMijiInfo(this.curRoleIndex+1),this.updateStatus()},i.updateStatus=function(){var e=this,t=1;e.dataHash=iB.ins.mijiHash;var i=e.dataHash.take(e.curRoleIndex+1);if(i)for(var n=0;n<i.length;n++){var s=i[n];e["lock"+n].visible=1==s.isLock,0!=s.miji_id?(e.itemArr[n].bindData=s.miji_id,e.isFirstOpen&&(e.isFirstOpen=0,e.curSelectIndex=n+1)):e.itemArr[n].bindData=0;var o=Qs.MODEL.flyLevel(Qs.getIndex(s.miji_index));e["zslock"+n].visible=gR.ins.zsLv<o,e["zslock"+n].visible&&1==t?(t=0,e["txt_limit"+n].changeText(o+"转开启")):0!=s.miji_id||e["zslock"+n].visible?e["txt_limit"+n].changeText(""):e["txt_limit"+n].changeText("未学习")}e.itemClickHandler(e.curSelectIndex-1)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t}(),y1=function(e){function t(){this._grid=null,this.roleIndex=0,this.mijiId=0,this.curSelectRender=null,t.__super.call(this)}b(t,"modules.skill.views.MijiLearnView",Du);var i=t.prototype;return i.initialize=function(){var e=this;e.list_miji.itemRender=xY,e.list_miji.repeatX=4,e.list_miji.vScrollBarSkin="",e.list_miji.scrollBar.elasticBackTime=300,e.list_miji.scrollBar.elasticDistance=100,e.list_miji.selectEnable=!0,e.list_miji.selectHandler=ql.create(e,e.onListMouse,null,!1),e._grid=new MF,e._grid.x=e.img_grid.x-3,e._grid.y=e.img_grid.y,e._grid.needGridBg=!1,e._grid.needEffect=!1,e._grid.mouseEnabled=!1,e.addChild(e._grid)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.close),t.btn_get.on("click",t,t.getway),t.btn_learn.on("click",t,t.onLearnClick),t.list_miji.scrollBar.on("change",t,t.onScrollChanged),t.txt_skillName.text="",t.txt_desc.innerHTML="",t._grid.bindData=null},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.close),t.btn_get.off("click",t,t.getway),t.btn_learn.off("click",t,t.onLearnClick),t.list_miji.scrollBar.off("change",t,t.onScrollChanged),G.timer.clearAll(t),t.list_miji.selectedIndex=-1},i.getway=function(){Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:45})},i.update=function(e){var t=this;t.roleIndex=e;for(var i,n=[],s=0,o=TR.ins.getBackPackItems(),a=0;a<o.length;a++){var r=o[a];for(s=0;s<Xs.count;s++)Xs.MODEL.goodsId(s)==r.goodsId&&n.push(s)}var l=[],c=iB.ins.takeCharMijiList(t.roleIndex+1);for(a=0;a<c.length;a++)i=c[a],l.push(i.miji_id);var u=[],d=[];for(s=0;s<n.length;s++){var h=n[s],_=Xs.MODEL.goodsId(h);i=DH.create(Xs.MODEL.goodsId(h),1,0);var f={};-1!=l.indexOf(_)?(f.mijiDto=i,f.isLearn=!0,f.needTips=!1,u.push(f)):(f.mijiDto=i,f.isLearn=!1,f.needTips=!1,d.push(f))}var p=d.concat(u),g=Math.ceil(p.length/4);2<g&&(t.list_miji.repeatY=g),t.list_miji.dataSource=p,t.g_mask.visible=12<t.list_miji.length,0<p.length?(t.no_stuff.visible=!1,t.kuang_bg.visible=t.quan.visible=!0):(t.no_stuff.visible=!0,t.kuang_bg.visible=t.quan.visible=!1),G.timer.callLater(t,t.selectDefault)},i.selectDefault=function(){this.list_miji.selectedIndex=0},i.onListMouse=function(e){var n=this;if(this.curSelectRender&&this.curSelectRender.setSelectBg(!1),this.curSelectRender=this.list_miji.selection,this.curSelectRender){if(this.curSelectRender.setSelectBg(!0),this.mijiId=this.curSelectRender.mijiId,0==this.mijiId)return;this.curSelectRender.isLearn?(this.btn_learn.gray=!0,this.btn_learn.mouseEnabled=!1,this.btn_learn.label="已学习"):(this.btn_learn.gray=!1,this.btn_learn.mouseEnabled=!0,this.btn_learn.label="学 习");var t=yB.create(this.mijiId),i=(this._grid.bindData=t).cfgIdx;this.txt_skillName.text=Bi.MODEL.name(i),TR.ins.getGoodsDes(t.goodsId,ql.create(this,function(e,t){n.txt_desc.innerHTML=t;var i=58<n.txt_desc.contextHeight?33:44;n.txt_skillName.y=n.kuang_bg.y+Math.floor((n.kuang_bg.height-n.txt_desc.contextHeight-i)/2),n.txt_desc.y=n.txt_skillName.y+i}))}},i.onLearnClick=function(){var e=0;if(0!=this.mijiId){for(var t=iB.ins.mijiHash,i=0,n=0;n<Xs.count;n++)Xs.MODEL.goodsId(n)==this.mijiId&&(i=Xs.MODEL.type(n),e=Xs.MODEL.mijiLevel(n));var s=t.take(this.roleIndex+1);if(s)for(var o=0;o<s.length;o++){var a=s[o];if(a.miji_id==this.mijiId)return void zB.ins.playErrorMsg(RP.n[1374]);if(a.type==i&&e<a.cur_lvl)return void zB.ins.playErrorMsg(RP.n[1375])}iB.ins.curUpgradeId=this.mijiId,Tu.sendToModule("MIJI_ADD",["modules.skill.SkillModule"],"add"),this.close()}else zB.ins.playErrorMsg(RP.n[1373])},i.onScrollChanged=function(){0==this.list_miji.scrollBar.max||this.list_miji.scrollBar.value>=this.list_miji.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),I1=function(e){function t(){t.__super.call(this)}b(t,"modules.skill.views.MijiShowView",Pu);var i=t.prototype;return i.initialize=function(){this.mijiPanel.vScrollBarSkin="",this.mijiPanel.vScrollBar.elasticDistance=300},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.close),this.mijiPanel.vScrollBar.on("change",this,this.onScrollChanged),this.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.close),this.mijiPanel.vScrollBar.off("change",this,this.onScrollChanged)},i.update=function(){for(var e,t=[],i=[],n=0;n<Xs.count;n++)(e={}).mijiDto=DH.create(Xs.MODEL.goodsId(n),1,0),e.isLearn=!1,e.needTips=!0,e.isShow=!0,e.miji_id=n,e.level=Xs.MODEL.mijiLevel(n),1==Xs.MODEL.mijiLevel(n)?t.push(e):2==Xs.MODEL.mijiLevel(n)&&i.push(e);var s=new uK;s.data=t,this.mijiPanel.addChild(s);var o=new uK;o.data=i,o.y=s.y+s.height,this.mijiPanel.addChild(o)},i.onScrollChanged=function(){0==this.mijiPanel.vScrollBar.max||this.mijiPanel.vScrollBar.value>=this.mijiPanel.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onListMouse1=function(e){},i.onListMouse2=function(e){},t.NAME="MIJI_SHOW_GOODS",t}(),b1=function(e){function t(){var e=this;e._openSelectIndex=0,e.vsc=null,e.zsOpenLv=0,e.skillCareList=[31],e.veinCareList=[5],e.innerList=[33],e.mijiList=[228],t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.init()}b(t,"modules.skill.views.SkillMainView",df);var i=t.prototype;return i.init=function(){var e=this;this.zsOpenLv=parseInt($e.MODEL.value($e.getIndex(67))),this.navList=["ui/layouts/skill/imgSkill.png","ui/layouts/skill/btn_tab_xf.png","ui/layouts/skill/btn_tab_jm.png","ui/layouts/skill/yq_btn_fw.png","ui/layouts/skill/yq_btn_tf.png"];_r.getLayoutsPath("xinfa");var t=parseInt($e.MODEL.value($e.getIndex(91)));this.vsc=new SB(this),this.vsc.selectHandler=ql.create(this,this.onSubChanged,null,!1),this.vsc.registAll([{cls:fK,id:"0",showDragon:!0,isHideBg:!0},{cls:cK,id:"1",showDragon:!0,isHideBg:!0,grayTip:function(){zB.ins.showMsg("通关第"+t+"关开启",1)},wait:hN.wait(hN.waitConfig(["InnerUpgrade"],["InnerUpgrade"]))},{cls:vX,id:"2",showDragon:!0,isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigRoleSystem"],["CRoleSystemModel"]))},{cls:dK,id:"3",showDragon:!0,grayTip:function(){zB.ins.showMsg(e.zsOpenLv+RP.n[1376],1),UB.ins._playLevelNot()},wait:hN.wait(hN.waitConfig(["ConfigMijiHole","ConfigMiji","ConfigMijiGrid"],["CMijiHoleModel","ConfigMiji","ConfigMijiGrid"]))},{cls:T1,id:"4",showDragon:!0,isHideBg:!1,wait:hN.wait(hN.waitConfig(["SkillInnateResource","TalentMap","TalentMaxLv"],["ConfigTalent","ConfigTalentMap","ConfigTalentLevel"])),grayTip:function(){zB.ins.playErrorMsg(RP.n[505])}}]),this.vsc.filterHandler=ql.create(this,this.checkRedPoint,null,!1)},i.update=function(e){this.callLater(this.updateDo,e)},i.updateImde=function(e){this.updateDo(e)},i.updateDo=function(e){this.vsc.updateSelectedView(e)},i.onSubChanged=function(e,t){var i="";switch(this.skill_common_bg.visible=!1,e){case"0":i="skill/jn_text_jn.png",this.skill_common_bg.visible=!0;break;case"3":i="skill/mj_text_fw.png";break;case"1":i="skill/ng_text_ng.png";break;case"2":i="skill/jm_text_jm.png";break;case"4":i="skill/tf_text_tf.png"}this.setTitle(_r.getAtlasSubPath(i))},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.vsc&&(t.vsc.selectedIndex=t.openSelectIndex),IH.ins.currentSelectedRole=0,AN.reqRedPt([t.veinCareList]),AN.reqRedPt([t.innerList]),AN.reqRedPt([t.mijiList]),AN.reqRedPt([225,272]);var i=ql.create(t,t.redPtUpdate,null,!1);AN.ins.addListener("BTN_VEIN",t.veinCareList,i),AN.ins.addListener("BTN_SKILL_UPGRADE",t.skillCareList,i),AN.ins.addListener("BTN_INNER",t.innerList,i),AN.ins.addListener("BTN_MIJI",t.mijiList,i),AN.ins.addListener("BTN_XINFA",[225],i),AN.ins.addListener("BTN_TALENT",[272],i)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.vsc.selectedView&&this.vsc.selectedView.hideByVSC&&this.vsc.selectedView.hideByVSC(),this.openSelectIndex=0,this.vsc&&(this.vsc.selectedIndex=-1),IH.ins.currentSelectedRole=0,AN.ins.removeListener("BTN_VEIN"),AN.ins.removeListener("BTN_INNER"),AN.ins.removeListener("BTN_SKILL_UPGRADE"),AN.ins.removeListener("BTN_MIJI"),AN.ins.removeListener("BTN_XINFA"),AN.ins.removeListener("BTN_TALENT")},i.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},i.checkRedPoint=function(e){if("3"==e&&!this.isOpenMiji())return 1;if("1"==e&&!this.isOpenInner())return 1;if("0"==e&&AN.ins.getStateByCareList(this.skillCareList))return 3;if("3"==e&&this.checkMijiRedPoint())return 3;if("2"==e&&AN.ins.getStateByCareList(this.veinCareList))return 3;if("1"==e&&AN.ins.getStateByCareList(this.innerList))return 3;if("4"==e){if(-1==gR.ins.isniePan())return 1;if(AN.ins.getStateByCareList([272]))return 3}return 0},i.isOpenXinfa=function(){var e=gR.ins.zsLv,t=dr.getOpenServiceDay();return 4<=e&&11<=t},i.isOpenMiji=function(){return gR.ins.zsLv>=this.zsOpenLv},i.isOpenInner=function(){gR.ins.lv;var e=parseInt($e.MODEL.value($e.getIndex(91)));return!(UR.instance.currentPoint<=e)},i.checkSkillRedPoint=function(){for(var e=0;e<gR.ins.actorList.length;e++){if(IH.ins.checkRedPoint(e+1))return!0}return!1},i.checkMijiRedPoint=function(){return AN.ins.getStateByCareList(this.mijiList)},i.checkInnerRedPoint=function(){return-1!=tB.ins.checkRedPoint().indexOf(1)},i.setFirstTap=function(e){var t=this;IH.ins.forRed&&(IH.ins.forRed=!1,this.callLater(function(){t.vsc.selectedIndex=e}))},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},p(0,i,"openSelectIndex",function(){return this._openSelectIndex},function(e){this._openSelectIndex=e,1<(this.vsc.selectedIndex=e)&&this.tabScrollTo(e)}),t.SUB_SKILL="0",t.SUB_INNER="1",t.SUB_JingMai="2",t.SUB_MIJI="3",t.TAB_TIANFU="4",t}(),w1=function(e){function t(){this._data=null,this.isUp=!1,this.goodsCost_0=null,this.goodsCost_1=null,this.talentVo=null,t.__super.call(this),this._data=sB.ins,this.initUI()}b(t,"modules.skill.views.talent.TalentLearnView",Tp);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.isUp=!1,this.btn_learn.on("click",this,this.onClickLearn)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_learn.off("click",this,this.onClickLearn)},i.refreshTips=function(e){e.skillInnateId==this.talentVo.skillInnateId&&this.showInfo(e)},i.updateGoods=function(){if(null!=this.talentVo){if(this._data.talentRedPointHash.has(this.talentVo.skillInnateId)){var e=this._data.talentRedPointHash.take(this.talentVo.skillInnateId);this.talentVo.isLearn=e.showRed}this.showInfo(this.talentVo)}},i.showInfo=function(e){var t=this;if(e){var i;t.talentVo=e,t.box_bigSkill.visible=t.box_full.visible=t.box_learn.visible=t.box_xiaohao.visible=!1,t._data.actorTalentData.has(IH.ins.currentSelectedRole+1)&&(i=t._data.actorTalentData.take(IH.ins.currentSelectedRole+1));var n=!1;if(null==i)return;i.talent_Hash.has(e.skillInnateId)?e.level>=t._data.getMaxLevelBySkillId(e.skillInnateId)?(t.box_full.visible=t.btn_learn.visible=t.box_tj.visible=t.box_nextDesc.visible=!1,t.img_max.visible=!0,t.img_line.y=385,t.height=550):(n=!0,t.btn_learn.visible=t.box_tj.visible=t.box_nextDesc.visible=!0,t.box_full.visible=t.img_max.visible=!1,t.img_line.y=568,t.height=898):(t.img_max.visible=t.box_nextDesc.visible=!1,t.box_full.visible=t.btn_learn.visible=t.box_tj.visible=!0,t.img_line.y=568,t.height=898),t.txt_skillNameA.text=e.skillName;var s="",o="",a=0,r=t.getTips(e);1<r.length&&(s=r[0],o=r[1]),t.img_skill.skin=_r.getIconPath(o),t.txt_desc.innerHTML=s;var l=t._data.getTypeBySkillIdAndLv(e.skillInnateId,10);1<(r=t.getTips(l)).length&&(t.txt_full.innerHTML=r[0]),t.txt_cost_tool_0.innerHTML=t.txt_cost_tool_1.innerHTML="";var c,u,d,h="",_="",f=0,p=0,g=[],v=0,m=0,y=0;if(n){var I=t._data.getTypeBySkillIdAndLv(e.skillInnateId,e.level+1);I&&(h=I.learnPlayerCostDefs,_=I.skillLevelConditionMap,f=I.costInnate,p=I.totalCostInnateCondition,c=I.skillLevelOrCondition,1<(r=t.getTips(I)).length&&(s=r[0],o=r[1],t.txt_nextDesc.innerHTML=s))}else h=e.learnPlayerCostDefs,_=e.skillLevelConditionMap,f=e.costInnate,p=e.totalCostInnateCondition,c=e.skillLevelOrCondition;if(h){g=JSON.parse(h);for(var b=0;b<g.length;b++)v=g[b].value.split(":")[0],m=g[b].value.split(":")[1],y=TR.ins.getGoodsNum(v),a=Bi.getIndex(v),o=Bi.MODEL.icon(a),_r.getIconPath(o),null==t["goodsCost_"+b]&&(t["goodsCost_"+b]=new MF(45)),null==t["goodsCost_"+b].parent&&t.box_tj.addChild(t["goodsCost_"+b]),t["goodsCost_"+b].x=t["img_cost"+b].x,t["goodsCost_"+b].y=t["img_cost"+b].y,t["goodsCost_"+b].bindData=yB.create(v),t["goodsCost_"+b].needGridBg=!1,t["txt_cost_tool_"+b].innerHTML=m<=y?Ql.createColor(y.toString(),"#23b11f")+"/"+m:Ql.createColor(y.toString(),"#ff2e24")+"/"+m;1<g.length&&(null!=t.goodsCost_1&&(t.goodsCost_1.x=t.txt_cost_tool_0.x+t.txt_cost_tool_0.contextWidth+20),t.txt_cost_tool_1.x=t.goodsCost_1.x+t.goodsCost_1.width+7)}if(i.leftTalentPoint>=f?t.txt_cost_tfd.innerHTML=Ql.createColor(i.leftTalentPoint.toString(),"#23b11f")+"/"+f:t.txt_cost_tfd.innerHTML=Ql.createColor(i.leftTalentPoint.toString(),"#ff2e24")+"/"+f,_)t.box_learn.visible=!0,g=_.split(","),i.talent_Hash.has(g[0])?(d=t._data.getTypeBySkillIdAndLv(g[0],g[1]),u=i.talent_Hash.take(g[0]),t.txt_skillName.color=u.lv>=d.level?"#23b11f":"#ff2e24",t.txt_skillName.text=d.skillName):(d=t._data.getTypeBySkillIdAndLv(g[0],g[1]))&&(t.txt_skillName.color="#ff2e24",t.txt_skillName.text=d.skillName);if(0<p){t.box_xiaohao.visible=!0;var w=IH.ins.currentSelectedRole,x=t._data.actorTalentData.take(w+1),S=0;x.talentCost_hash.has(t._data.talentType)&&(S=parseInt(x.talentCost_hash.take(t._data.talentType)+"")),t.txt_has.innerHTML=p<=S?Ql.createColor(S+"","#23b11f")+"/"+p:Ql.createColor(S+"","#ff2e24")+"/"+p}t.box_tj.visible?""!=c?(t.box_bigSkill.visible=!0,t.txt_bigSkill.innerHTML=t.checkCondition(c),t.height=938):t.height=898:t.height=550,t.btn_learn.showTip=e.isLearn,t.btn_learn.disabled=!e.isLearn}},i.onClickLearn=function(e){this._data.reqTalentUpByRoleIndex(IH.ins.currentSelectedRole+1,this.talentVo.skillInnateId)},i.checkCondition=function(e){var t="",i=IH.ins.currentSelectedRole+1;if(this._data.actorTalentData.has(i))for(var n=this._data.actorTalentData.take(i),s=e.split(";"),o=[],a=0,r=0,l=0;l<s.length;l++){o=s[l].split(","),a=parseInt(o[0]),r=parseInt(o[1]);var c="",u=this._data.getTypeBySkillIdAndLv(a,r);if(n.talent_Hash.has(a))c=n.talent_Hash.take(a).lv>=r?"#23b11f":"#ff2e24";else c="#ff2e24";t+=Ql.createColor(u.skillName,c)+"或"}return t.substr(0,t.length-1)},i.getTips=function(e){var t=0,i=0,n="",s="",o=[];if(0<e.buffs.length)t=e.buffs[0],i=Ls.getIndex(t),n=Ls.MODEL.icon(i),s=Ls.MODEL.skillDesc(i),o.push(s),o.push(n);else{var a=e.skillId_levelMap;if(a){i=Vn.getIndex(a.split(",")[0]),n=Vn.MODEL.icon(i),s=Vn.MODEL.desc(i);var r=Vn.MODEL.damageFactor(i),l=Vn.MODEL.fixedDamage(i),c=r.length>e.level-1?(r[e.level-1]/100).toString():"0",u=l.length>e.level-1?l[e.level-1].toString():"0";203==i&&(u=l[e.level-1]/100+"%"),s=mp.getFormat(s,[c,u]),o.push(s),o.push(n)}}return o},i.initUI=function(){var e=this;e.txt_desc.style.font="黑体",e.txt_desc.style.fontSize=24,e.txt_desc.style.color="#90877b",e.txt_desc.style.leading=17,e.txt_full.style.font="黑体",e.txt_full.style.fontSize=24,e.txt_full.style.color="#90877b",e.txt_full.style.leading=17,e.txt_nextDesc.style.font="黑体",e.txt_nextDesc.style.fontSize=24,e.txt_nextDesc.style.color="#90877b",e.txt_nextDesc.style.leading=17,e.txt_cost_tool_0.style.font="黑体",e.txt_cost_tool_0.style.fontSize=24,e.txt_cost_tool_0.style.color="#90877b",e.txt_cost_tool_1.style.font="黑体",e.txt_cost_tool_1.style.fontSize=24,e.txt_cost_tool_1.style.color="#90877b",e.txt_cost_tfd.style.font="黑体",e.txt_cost_tfd.style.fontSize=24,e.txt_cost_tfd.style.color="#90877b",e.txt_has.style.font="黑体",e.txt_has.style.fontSize=24,e.txt_has.style.color="#90877b",e.txt_bigSkill.style.font="黑体",e.txt_bigSkill.style.fontSize=24,e.txt_bigSkill.style.color="#90877b",e.txt_bigSkill.style.leading=12,e.txt_bigSkill.style.wordWrap=!0,e.img_max.visible=!1},t}(),x1=function(e){function t(){this._data=null,this.imgSkill=null,this.effect_0=null,this.effect_1=null,t.__super.call(this),this.centerX=this.centerY=0,this._data=sB.ins,this.initUI()}b(t,"modules.skill.views.talent.TalentOkView",Ep);var i=t.prototype;return i.destroy=function(e){var t=this;void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(t,e),t.effect_1&&(t.effect_1.parent&&t.effect_1.parent.removeChild(t.effect_1),t.effect_1=null),t.effect_0&&(t.effect_0.parent&&t.effect_0.parent.removeChild(t.effect_0),t.effect_0=null)},i.showInfo=function(e,t){var i=this,n=i._data.getTypeBySkillIdAndLv(e,t);if(n){var s=0,o="",a=0;if(0<n.buffs.length)a=n.buffs[0],s=Ls.getIndex(a),o=Ls.MODEL.icon(s);else{var r=n.skillId_levelMap;r&&(s=Vn.getIndex(r.split(",")[0]),o=Vn.MODEL.icon(s))}i.imgSkill.skin=_r.getIconPath(o),i.txt_name.text=n.skillName}null==i.effect_0&&(i.effect_0=mj.GetNew(),i.effect_0.renderInSelf=!0,i.effect_0.loadEffect("jm1510"),i.effect_0.pos(307,112),i.addChild(i.effect_0)),null==i.effect_1&&(i.effect_1=mj.GetNew(),i.effect_1.renderInSelf=!0,i.effect_1.loadEffect("jm1244"),i.effect_1.pos(310,375),i.addChild(i.effect_1))},i.initUI=function(){this.imgSkill=new Kl,this.imgSkill.width=this.imgSkill.height=95,this.imgSkill.x=this.img_skill.x+16,this.imgSkill.y=this.img_skill.y+8,this.addChild(this.imgSkill)},t}(),S1=function(e){function c(){this._data=null,this.goodTool=null,this.hasGoods=!1,c.__super.call(this),this.centerX=this.centerY=0,this._data=sB.ins,this.initUI()}b(c,"modules.skill.views.talent.TalentResetView",Lp);var t=c.prototype;return t.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_no.on("click",t,t.onClickEvent),t.btn_reset.on("click",t,t.onClickEvent),t.btn_close.on("click",t,t.onClickEvent)},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.hasGoods=!1,t.btn_no.off("click",t,t.onClickEvent),t.btn_reset.off("click",t,t.onClickEvent),t.btn_close.off("click",t,t.onClickEvent)},t.showReset=function(e){var t,i=this,n=$e.getIndex(292),s=parseInt($e.MODEL.value(n));if(t=yB.create(s,1)){i.goodTool.bindData=t,i.txt_name.text=t.name;var o=Bi.MODEL.colourId(t.cfgIdx);i.txt_name.color=ms.getByQuality(o)}var a=TR.ins.getGoodsNum(s);n=$e.getIndex(293);var r=parseInt($e.MODEL.value(n)),l="";l=0<a?(i.txt_has.innerHTML=Ql.createColor(a.toString(),"#23b11f")+"/1",c.RESET[0].replace("$1","<font style='color:#e6d80d'>"+t.name+"</font>").replace("$2","<font style='color:#23b11f'>"+i._data.getTalentNameByType(i._data.talentType)+"</font>")):(i.txt_has.innerHTML=Ql.createColor(a.toString(),"#ff2e24")+"/1",c.RESET[0].replace("$1","<font style='color:#e6d80d'>"+r+RP.n[1378]).replace("$2",RP.n[1379]+i._data.getTalentNameByType(i._data.talentType)+"</font>")),i.txt_desc.innerHTML=l,i.hasGoods=0<a},t.onClickEvent=function(e){e.target==this.btn_close||e.target==this.btn_no?this.close():this._data.reqTalentReSetByRoleIndex(IH.ins.currentSelectedRole+1,this._data.talentType,this.hasGoods?1:2)},t.initUI=function(){var e=this;e.txt_name.align="center",e.txt_has.style.font="黑体",e.txt_has.style.fontSize=22,e.txt_has.style.color="#e0d6c1",e.txt_desc.style.font="黑体",e.txt_desc.style.fontSize=24,e.txt_desc.style.color="#90877b",e.txt_desc.style.leading=20,null==e.goodTool&&(e.goodTool=new MF(110)),e.addChildAt(e.goodTool,e.getChildIndex(e.img_tools)+1),e.goodTool.needGridBg=!0,e.goodTool.x=e.img_tools.x+10,e.goodTool.y=e.img_tools.y+2,e.txt_has.style.color="#e0d6c1",e.txt_has.style.font="黑体",e.txt_has.style.fontSize=22,e.txt_has.style.align="right",e.txt_desc.style.color="#90877b",e.txt_desc.style.font="黑体",e.txt_desc.style.fontSize=24,e.txt_desc.style.align="left"},f(c,["RESET",function(){return this.RESET=[RP.n[1380],RP.n[1381]]}]),c}(),k1=function(e){function t(){this.list_fenjie=null,this._achieves=null,t.__super.call(this),this.initUI()}b(t,"modules.skill.views.talent.TalentFenJieView",Op);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseViewListener),this.panel_fenjie.vScrollBar.on("change",this,this.onScrollChanged),this.showInfo()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.clearItem(),this.btn_close.off("click",this,this.onClickCloseViewListener),this.panel_fenjie.vScrollBar.off("change",this,this.onScrollChanged)},i.refreshFenJiePanel=function(){this.showInfo()},i.showAchieves=function(){var e=this,t=Bi.getIndex(2070);Bi.MODEL.achieving(t)?(null==e._achieves&&(e._achieves=new zW(530),e._achieves.centerX=0,e._achieves.bottom=58,e.addChild(e._achieves)),e._achieves.update(2070)):e._achieves&&e._achieves.removeSelf(),e.g_mask.bottom=e._achieves.height+e._achieves.bottom+19,e.panel_fenjie.height=e.height-e.g_mask.bottom-e.panel_fenjie.y},i.showInfo=function(){var e,t,i=TR.ins.getBackPackTalentBook(),n=0;for(n=0;n<i.length;n++)e=i[n],this.list_fenjie.length>n?t=this.list_fenjie[n]:(t=new kY,this.list_fenjie.push(t)),t.data=e,t.x=10,t.y=10+165*n,null==t.parent&&this.panel_fenjie.addChild(t);for(;n<this.list_fenjie.length;n++)this.list_fenjie[n].parent&&this.list_fenjie[n].parent.removeChild(this.list_fenjie[n]);this.list_fenjie.length=i.length},i.clearItem=function(){for(var e=0;e<this.list_fenjie.length;e++)null!=this.list_fenjie[e].parent&&this.list_fenjie[e].parent.removeChild(this.list_fenjie[e]),this.list_fenjie[e]=null;this.list_fenjie=[]},i.onClickCloseViewListener=function(e){hN.ins._closePanel(this)},i.initUI=function(){this.centerX=this.centerY=0,this.panel_fenjie.vScrollBarSkin="",this.panel_fenjie.vScrollBar.elasticDistance=300,this.list_fenjie=[]},i.onScrollChanged=function(){this.list_fenjie.length<=3||0==this.panel_fenjie.vScrollBar.max||this.panel_fenjie.vScrollBar.value>=this.panel_fenjie.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),E1=function(e){function t(){this.talentType=0,this.effect=null,this.talentVO=null,this.txt_lv=null,this._modelData=null,t.__super.call(this),this._modelData=sB.ins,this.initUI()}b(t,"modules.skill.views.talent.TalentSkillItem",Mp);var i=t.prototype;return i.dispose=function(){this.effect&&this.effect.parent&&this.effect.parent.removeChild(this.effect),this.effect=null,Zl.clearIconTexture(this)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClickIcon)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClickIcon)},i.onClickIcon=function(e){Tu.sendToModule("OPEN_TALENT_LEARN_PANEL",["modules.skill.SkillModule"],{data:this.talentVO})},i.setInfo=function(e){var t=this,i=IH.ins.currentSelectedRole,n=gR.ins.actorList[i].job,s=0,o="",a="";if(s=1==n?e.roleSkill_1[t._modelData.talentType-1]:2==n?e.roleSkill_2[t._modelData.talentType-1]:e.roleSkill_3[t._modelData.talentType-1],0<ao.count){var r=ao.getIndex(s),l=ao.MODEL.buffs(r),c=0;if(0<l.length)c=l[0],r=Ls.getIndex(c),a=Ls.MODEL.icon(r);else{var u=ao.MODEL.skillId_levelMap(r);u&&(r=Vn.getIndex(u.split(",")[0]),a=Vn.MODEL.icon(r))}o=_r.getIconPath(a),t.img_skill.skin=o,Zl.addIconUse(t,o),r=ao.getIndex(s);var d=ao.MODEL.specialGrid(r);0<d?(o=_r.getAtlasSubPath("grids/chuanshi_"+d+".png"),t.setChildIndex(t.img_skill,0),t.setChildIndex(t.img_border,1),t.img_skill.y=17):(o=_r.getAtlasSubPath("base_ui2/ty_jm_gz.png"),t.setChildIndex(t.img_border,0),t.setChildIndex(t.img_skill,1),t.img_skill.y=11),t.img_border.skin=o,t.img_skill.gray=!0;var h=ao.MODEL.skillInnateId(r);t.name="talent_"+h;var _=ao.MODEL.level(r),f=t._modelData.talentRedPointHash.take(h);f?(t.talentVO=f.vo,t.talentVO?t.talentVO.isLearn=f.showRed:(t.talentVO=t._modelData.getTypeBySkillIdAndLv(h,_),t.talentVO.isLearn=!1)):(t.talentVO=t._modelData.getTypeBySkillIdAndLv(h,_),t.talentVO.isLearn=!1),t.showEffect(),t.txt_lv.text="0/10"}},i.showEffect=function(){var e=this;e.talentVO&&1==e.talentVO.isLearn?null==e.effect&&(e.effect=mj.GetNew(),e.effect.renderInSelf=!0,e.effect.loadEffect("jm1498"),e.effect.pos(70,110),e.addChild(e.effect)):(e.effect&&e.effect.parent&&e.effect.parent.removeChild(e.effect),e.effect=null)},i.initUI=function(){var e=this;e.img_red.visible=!1,e.img_border.width=134,e.img_border.height=132,e.txt_lv=new Yp,e.addChild(e.txt_lv),e.txt_lv.align="right",e.txt_lv.fontSize=22,e.txt_lv.font="黑体",e.txt_lv.color="#e0d6c1",e.txt_lv.x=75,e.txt_lv.y=102,e.txt_lv.filters=[new fr("#000000",2,0,0)]},p(0,i,"data",null,function(e){var t=this;if(e){t.talentVO=t._modelData.getTypeBySkillIdAndLv(e.id,e.lv);var i=t._modelData.talentRedPointHash.take(e.id);t.talentVO.isLearn=!!i&&i.showRed,t.img_skill.gray=!1,t.showEffect(),t.talentVO.level>=t._modelData.getMaxLevelBySkillId(t.talentVO.skillInnateId)?(t.txt_lv.text="已满级",t.txt_lv.x=57):(t.txt_lv.text=t.talentVO.level+"/"+t._modelData.getMaxLevelBySkillId(t.talentVO.skillInnateId),t.txt_lv.x=77),t.txt_lv.y=95,Tu.sendToModule("REFRES_TALENT_LEARN_PANEL",["modules.skill.SkillModule"],{data:t.talentVO})}}),t}(),T1=function(e){function t(){var e=this;e._data=null,e._roleIndex=0,e._selector=null,e.tj_point=[149,355],e.skillView=null,e.talentInfoVo=null,e.filter=new ys([.5,0,0,0,16.75,0,.5,0,0,16.75,0,0,.5,0,16.75,0,0,0,1,0]),t.__super.call(e),e._data=sB.ins,e.initUI()}b(t,"modules.skill.views.talent.TalentMainView",Pp);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),this.skillView&&this.skillView.dispose()},i.onAdd=function(e){var t=this;if(ui.SubPanel.prototype.onAdd.call(t,e),1==ON.ins.isOpenTalent&&0<ON.ins.openTalentIndex)t._selector.selectIdx=ON.ins.openTalentIndex-1;else{var i=gR.ins.isniePan();-1==i&&(i=0),t._selector.selectIdx=i,IH.ins.currentSelectedRole=i}ON.ins.isOpenTalent=0,t._roleIndex=t._selector.selectIdx,t.btn_0.on("click",t,t.onClickBtn),t.btn_1.on("click",t,t.onClickBtn),t.btn_no.on("click",t,t.onClickNoBtn),t.btn_wh.on("click",t,t.onClickDesc),t.txt_sm.on("click",t,t.onClickDesc),t.btn_reset.on("click",t,t.onClickReset),t.btn_fenjie.on("click",t,t.onClickFenJie),t.txt_talent.on("click",t,t.onClickTalent),t.btn_0.selected=!0,t._data.talentType=1,t.img_jt.x=t.tj_point[0],t._data.updateTalent(),t.showTalentInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_0.off("click",t,t.onClickBtn),t.btn_1.off("click",t,t.onClickBtn),t.btn_no.off("click",t,t.onClickNoBtn),t.btn_wh.off("click",t,t.onClickDesc),t.txt_sm.off("click",t,t.onClickDesc),t.btn_reset.off("click",t,t.onClickReset),t.btn_fenjie.off("click",t,t.onClickFenJie),t.txt_talent.off("click",t,t.onClickTalent),t._data.talentType=1},i.showTalentInfo=function(e){var t=this;void 0===e&&(e=!0),t.talentInfoVo=t._data.actorTalentData.take(t._roleIndex+1),t.talentInfoVo.talentCost_hash.has(t._data.talentType)?t.txt_cost.text=t.talentInfoVo.talentCost_hash.take(t._data.talentType)+"":t.txt_cost.text="0",t.txt_has.text=t.talentInfoVo.leftTalentPoint.toString(),t.skillView.showSkillInfo(e),t.showRedTips(),t.checkOpenNP()},i.onClickNoBtn=function(e){zB.ins.showMsg(RP.n[1382],1)},i.onClickBtn=function(e){var t=this,i=0;e.target==t.btn_0?(t.btn_no.selected=t.btn_1.selected=!1,t.btn_0.selected=!0,i=1):e.target==t.btn_1&&(t.btn_no.selected=t.btn_0.selected=!1,t.btn_1.selected=!0,i=2),t.img_jt.x=t.tj_point[i-1],t._data.talentType!=i&&(t._data.talentType=i,t.skillView.changeTalentType(),t.skillView.showSkillInfo(),t.showRedTips()),t.talentInfoVo.talentCost_hash.has(t._data.talentType)?t.txt_cost.text=t.talentInfoVo.talentCost_hash.take(t._data.talentType)+"":t.txt_cost.text="0"},i.onClickDesc=function(e){QR.goToOpenHelpDes(22)},i.onClickReset=function(e){parseInt(this.txt_cost.text)<=0?zB.ins.showById(4778,1):Tu.sendToModule("OPEN_TALENT_RESET_PANEL",["modules.skill.SkillModule"],{roleIndex:this._roleIndex})},i.onClickFenJie=function(e){Tu.sendToModule("OPEN_TALENT_FENJIE_PANEL",["modules.skill.SkillModule"])},i.onClickTalent=function(e){Tu.sendToModule("OPEN",["modules.actor.ActorModule"],{subIndex:5})},i.showRedTips=function(){for(var e=[],t=gR.ins.actorList,i=0;i<this._data.actorTalentData.length;i++){if(t.length>i)t[i].niepanlevel<=0?this._selector.setRedPtByIdx(i,!1):(e=this._data.getRedPointByRoleIndex(i+1,this._roleIndex==i),this._selector.setRedPtByIdx(i,e[0]),this._roleIndex==i&&(this.btn_0.showTip=e[1],this.btn_1.showTip=e[2]))}},i.initUI=function(){var e=this;e.panel_skill.vScrollBarSkin="",e.panel_skill.vScrollBar.elasticBackTime=300,e.panel_skill.vScrollBar.elasticDistance=100,e._selector=new Nj,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e._selector.on("select",e,e.onSelectRole),null==e.skillView&&(e.skillView=new C1),e.panel_skill.addChild(e.skillView),e.skillView.pos(33,10),e.txt_cost.text="0"},i.onSelectRole=function(){var e=this;e.btn_0.selected=e.btn_1.selected=!1,e._selector.selectIdx!=e._roleIndex&&(e._roleIndex=e._selector.selectIdx,IH.ins.currentSelectedRole=e._selector.selectIdx,e.talentInfoVo=e._data.actorTalentData.take(e._roleIndex+1),e.btn_0.selected=!0,e._data.talentType=1,e.img_jt.x=e.tj_point[e._data.talentType-1],e.showTalentInfo())},i.checkOpenNP=function(){var e=0,t=gR.ins.actorList;for(e=0;e<t.length;e++){var i=0<t[e].niepanlevel,n=this._selector.getItem(e);n&&(n.mcHead.filters=null,i||(n.mcHead.filters=[this.filter]),n.isGray=!i,n.mouseEnabled=i)}},t}(),C1=function(e){function t(){this._data=null,this.skillArr=[],this.roleIndex=0,t.__super.call(this),this._data=sB.ins,this.initUI()}b(t,"modules.skill.views.talent.TalentSkillView",Ap);var i=t.prototype;return i.dispose=function(){for(var e=0;e<this.skillArr.length;e++)this.skillArr[e].dispose();this.skillArr=[]},i.showSkillInfo=function(e){void 0===e&&(e=!0),this.roleIndex=IH.ins.currentSelectedRole+1;var t,i=this._data.actorTalentData.take(this.roleIndex),n=i.talent_Hash,s=0,o=0;for(e&&this.resetLine(i),s=0;s<this.skillArr.length;s++)(t=this.skillArr[s]).setInfo(this._data.talentMapInit(s)),o=t.name.split("_")[1],n.has(o)&&(t.data=n.take(o))},i.resetLine=function(e){var t,i=0,n=0,s=0,o=[],a=[],r="",l="";for(i=0;i<lo.count;i++)for(n=lo.MODEL.key(i),a=""!=(l=lo.MODEL.nextSkillIds(i))?l.split(","):[],o=""!=(r=lo.MODEL.imgs(i))?r.split(","):[],s=0;s<a.length;s++)this["line_"+n+"_"+a[s]].skin=_r.getAtlasSubPath("skill/tf_line_"+o[s]+".png");if(e){var c=gR.ins.actorList[this.roleIndex-1].job,u=this._data.talentType,d=[],h=0,_=0;for(i=0;i<lo.count;i++)if(h=lo.MODEL.key(i),d=1==c?lo.MODEL.roleSkill_1(i):2==c?lo.MODEL.roleSkill_2(i):lo.MODEL.roleSkill_3(i),o=""!=(r=lo.MODEL.imgs(i))?r.split(","):[],_=this._data.getSkillIdByCid(d[u-1]),e.talent_Hash.has(_))for(a=""!=(l=lo.MODEL.nextSkillIds(i))?l.split(","):[],s=0;s<a.length;s++){var f=lo.getIndex(a[s]);d=1==c?lo.MODEL.roleSkill_1(f):2==c?lo.MODEL.roleSkill_2(f):lo.MODEL.roleSkill_3(f),_=this._data.getSkillIdByCid(d[u-1]),e.talent_Hash.has(_)&&((t=this["line_"+h+"_"+a[s]]).skin=_r.getAtlasSubPath("skill/tf_line_"+o[s].replace("hui","hong")+".png"),this.setChildIndex(t,17))}}},i.changeTalentType=function(){var e=0;for(e=0;e<this.skillArr.length;e++)this.skillArr[e].setInfo(this._data.talentMapInit(e))},i.initUI=function(){var e,t=0;for(t=0;t<sB.POINT.length;t++)(e=new E1).x=sB.POINT[t].x,e.y=sB.POINT[t].y,this.addChild(e),e.setInfo(this._data.talentMapInit(t)),this.skillArr.push(e)},t}(),L1=function(e){function i(){var e=this;e._orgX=0,e._orgY=0,e._handEff=null,e._ballEffect=null,e.effBox=null,e.tween1=null,e.tween2=null,e.tween3=null,e.tween4=null,e.titleTween=null,e.ballTween=null,e.image=null,e._vo=null,e.isOver=!1,e.target=null,i.__super.call(e)}b(i,"modules.soul.views.SoulActivityView",e);var t=i.prototype;return t.createChildren=function(){e.prototype.createChildren.call(this),this.img_bg.skin=_r.getFullUrl("ui/images/soul/tj_bg960.jpg")},t.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClicked)},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Vf.instance.currentActivityPart=0,this.disposeEff()},t.disposeEff=function(){var e=this;e._ballEffect&&(e._ballEffect.parent&&e._ballEffect.parent.removeChild(e._ballEffect),e._ballEffect.dispose(),e._ballEffect=null),e._handEff&&(e._handEff.parent&&e._handEff.parent.removeChild(e._handEff),e._handEff=null)},t.showData=function(){var e=this;e.isOver=!1,e._vo=Vf.instance.configArr[Vf.instance.currentActivityPart-1],e.txt_name_bg.skin=_r.getFullUrl("ui/images/soul/tj_tjmz_bg.png"),6==e._vo.id?e.img_name.skin=_r.getFullUrl("ui/images/soul/ys_text_lyys.png"):e.img_name.skin=_r.getAtlasSubPath("soul/ys_text_"+(e._vo.id-1)+".png"),e.box_active.alpha=0,e.img_name.scale(0,0),e.txt_name_bg.scale(0,0),e.img_bg.y=-280,e.img_bg.centerX=0,null!=e.tween1?e.tween1.clear():e.tween1=new Og,e.tween1.to(e.box_active,{alpha:1},500,pa.linearIn,ql.create(e,e.onComposeShow))},t.onEffectComplete=function(){var e=this;if(e.onComposeShowRingName(),null==e._ballEffect){var t=i.BALL_EFFECT_ARR[Vf.instance.currentActivityPart-1];6==Vf.instance.currentActivityPart?(e.image=new Kl,e.image.centerX=0,e.image.y=300,e.image.skin=_r.getFullUrl("ui/images/soul/ys_img_ys.png"),e.addChild(e.image),e.image.scale(0,0),null!=e.ballTween?e.ballTween.clear():e.ballTween=new Og,e.ballTween.to(e.image,{scaleX:1,scaleY:1},200,pa.linearIn,ql.create(e,e.showHandler)),e.target=e.image,e._orgY=300):(e.effBox=new dt,e.effBox.pos(360,550),e.addChild(e.effBox),e._ballEffect=kB.createEffect(t,0,0,e.effBox),e.effBox.scale(0,0),null!=e.ballTween?e.ballTween.clear():e.ballTween=new Og,e.ballTween.to(e.effBox,{scaleX:1,scaleY:1},200,pa.linearIn,ql.create(e,e.showHandler)),e.target=e.effBox,e._orgY=550)}},t.showHandler=function(){this.target.y=this._orgY,this.target&&(this.titleTween=Og.to(this.target,{y:this._orgY-5},500,null,ql.create(this,this.shareHandler)))},t.shareHandler=function(){var e=this;e.target.y==e._orgY-5?e.titleTween=Og.to(e.target,{y:e._orgY+10},1e3,null,ql.create(e,e.shareHandler)):e.target.y==e._orgY+10?e.titleTween=Og.to(e.target,{y:e._orgY},500,null,ql.create(e,e.shareHandler)):e.target.y==e._orgY&&(e.titleTween=Og.to(e.target,{y:e._orgY-5},500,null,ql.create(e,e.shareHandler)))},t.onComposeShow=function(){var e=this;e.graphics.clear(),e.graphics.drawRect(0,0,e.width,e.height,"#000000"),UB.ins.playSound("23",3,!0),null==e._handEff&&(e._handEff=kB.createEffect("jm1034",360,389,e)),e._handEff.scaleX=e._handEff.scaleY=1.2,e._handEff.alpha=0,null!=e.tween2?e.tween2.clear():e.tween2=new Og,e.tween2=Og.to(e._handEff,{alpha:1},100,pa.linearIn,ql.create(e,e.onEffectComplete))},t.onComposeShowRingName=function(){var e=this;null!=e.tween4?e.tween4.clear():e.tween4=new Og,e.tween4.to(e.img_name,{x:83,scaleX:1,scaleY:1},500,pa.linearIn),null!=e.tween3?e.tween3.clear():e.tween3=new Og,e.tween3.to(e.txt_name_bg,{x:75,scaleX:1,scaleY:1},500,pa.linearIn),e.isOver=!0},t.onClicked=function(e){var t=this;0!=t.isOver&&(t.tween1&&t.tween1.clear(),t.tween2&&t.tween2.clear(),t.tween3&&t.tween3.clear(),t.tween4&&t.tween4.clear(),t.titleTween&&t.titleTween.clear(),t.ballTween&&t.ballTween.clear(),t.disposeEff(),t.off("click",t,t.onClicked),hN.ins.close("SoulActivityView"),6==Vf.instance.currentActivityPart&&hN.ins.open("SOULOUT_V"))},t.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.NAME="SoulActivityView",i.HANDEFFID="jm1034",i.STAGEEFFID="jm1100",i.SOULEFFURL="ui/images/soul/ys_img_ys.png",f(i,["BALL_EFFECT_ARR",function(){return this.BALL_EFFECT_ARR=["jm1178","jm1174","jm1175","jm1176","jm1177","jm1179"]}]),i}(Rf),M1=function(e){function t(){var e=this;e._orgX=0,e._orgY=0,e._handEff=null,e._ballEffect=null,e.tween1=null,e.tween2=null,e.tween3=null,e.titleTween=null,e.ballTween=null,e._vo=null,e.isOver=!1,e.image=null,t.__super.call(e)}b(t,"modules.soul.views.SouloutAdvActiveView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.img_bg.skin=_r.getFullUrl("ui/images/soul/tj_bg960.jpg"),this.box_active.centerX=0},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClicked)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Vf.instance.currentActivityPart=0,this.disposeEff()},i.disposeEff=function(){var e=this;e._ballEffect&&(e._ballEffect.parent&&e._ballEffect.parent.removeChild(e._ballEffect),e._ballEffect.dispose(),e._ballEffect=null),e._handEff&&(e._handEff.parent&&e._handEff.parent.removeChild(e._handEff),e._handEff=null)},i.showSoulAdvance=function(){var e=this;e.isOver=!1,e._vo=Vf.instance.configArr[Vf.instance.currentActivityPart-1],e.img_name.skin=_r.getFullUrl("ui/images/soul/ys_text_slyys.png"),e.txt_name_bg.skin=_r.getFullUrl("ui/images/soul/tj_tjmz_bg.png"),e.img_bg.y=-280,e.img_bg.centerX=0,e.box_active.scale(0,0),e.image=new Kl,e.image.centerX=0,e.image.y=300,e.image.skin=_r.getFullUrl("ui/images/soul/ys_img_sys.png"),e.addChild(e.image),e.tween1=Og.to(e.img_bg,{y:0},1e3,pa.bounceOut,ql.create(e,e.onAdvanceEffectComplete)),e.tween2=Og.to(e.img_name,{x:80,alpha:1},500,pa.backInOut),e.titleTween=Og.to(e.box_active,{scaleX:1,scaleY:1},1e3,pa.bounceOut),e.image.scale(0,0),e.ballTween=Og.to(e.image,{scaleX:1,scaleY:1},500,pa.bounceOut)},i.onAdvanceEffectComplete=function(){this.box_active.visible=!0,this.timerOnce(3e3,this,this.onAdvanceClose)},i.onAdvanceClose=function(){this.tween1&&this.tween1.clear(),this.tween2&&this.tween2.clear(),this.titleTween&&this.titleTween.clear(),this.ballTween&&this.ballTween.clear(),hN.ins.close("SoulOutAdvActiveView")},i.onComposeShow=function(){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,"#000000"),UB.ins.playSound("23",3,!0),null==this._handEff&&(this._handEff=kB.createEffect("jm1034",360,389,this)),this._handEff.scaleX=this._handEff.scaleY=1.2},i.onComposeShowRingName=function(){this.tween2=Og.to(this.img_name,{x:80,alpha:1},500,pa.backInOut),this.tween3=Og.to(this.txt_name_bg,{x:70,alpha:1},500,pa.backInOut),this.isOver=!0},i.onClicked=function(e){var t=this;t.tween1&&t.tween1.clear(),t.tween2&&t.tween2.clear(),t.tween3&&t.tween3.clear(),t.titleTween&&t.titleTween.clear(),t.ballTween&&t.ballTween.clear(),t.disposeEff(),t.off("click",t,t.onClicked),hN.ins.close("SoulOutAdvActiveView")},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},t.NAME="SoulOutAdvActiveView",t.HANDEFFID="jm1034",t.STAGEEFFID="jm1100",t.SOULEFFURL="ui/images/soul/ys_img_sys.png",t}(Rf),A1=function(i){function e(){this._countDownTime=0,this._grid=null,this._callBack=null,e.__super.call(this)}b(e,"modules.soul.views.SoulCopySuccessView",i);var t=e.prototype;return t.createChildren=function(){var e=this;i.prototype.createChildren.call(e),e._grid=new MF,e._grid.pos(e.img_icon.x,e.img_icon.y);var t=e.getChildIndex(e.img_icon);e.addChildAt(e._grid,t),e._grid.mouseEnabled=!1,e.img_icon.visible=!1,e.g_title.skin=_r.getFullUrl("ui/images/soul/ys_text_ljsy.png")},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._countDownTime=10,t.btn_go.on("click",t,t.onGoClicked);var i=cd.MODEL.reward(0).split(","),n=yB.create(i[0],i[1]);t.txt_num.text=i[1],n.goodsNum=1,t._grid.bindData=n;var s=new op;Tu.sendToService(s),t.timer.loop(1e3,t,t.loop)},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_go.off("click",this,this.onGoClicked),this.timer.clear(this,this.loop)},t.updateView=function(e){e&&e.hasOwnProperty("callback")&&(this._callBack=e.callback)},t.onGoClicked=function(e){BR.ins.exitCopy(200),Tu.sendToModule("OPEN_SOUL_COPY_MAIN_PANEL",["modules.soul.SoulOutModule"],{selectedIndex:2}),hN.ins.close("SoulCopySuccessView")},t.loop=function(){this._countDownTime--,this.txt_countDown.text="("+this._countDownTime+")",this._countDownTime<=0&&(this.timer.clear(this,this.loop),this.onGoClicked(null))},e.NAME="SoulCopySuccessView",e.TITLEURL="ui/images/soul/ys_text_ljsy.png",e}(Nf),D1=function(t){var i;function e(){this._itemArr=null,this._selectedIndex=-1,this._attrArr=null,this._upgradeCost=null,this._activityEff=null,this._openIdx=0,e.__super.call(this)}b(e,"modules.soul.views.SoulPreviewPanel",t);var n=e.prototype;return n.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.mouseThrough=!0,e.isHideBg=!0,e.initItem(),e.list_attr.itemRender=i,e.list_attr.repeatX=2,e.list_attr.repeatY=2,e.list_attr.spaceX=50,e.list_attr.spaceY=11,e.img_cost.visible=!1,e.list_attr.centerX=42,e.title=_r.getAtlasSubPath("soul/ys_title_ys.png"),e.img_bg.skin=_r.getFullUrl("ui/images/soul/yssx_img_bg.jpg"),e.img_soul.skin=_r.getAtlasSubPath("soul/ys_img_ys.png"),e.img_chain.skin=_r.getAtlasSubPath("soul/ys_img_sl.png"),e.img_dect.skin=_r.getAtlasSubPath("soul/ys_text_yscq.png")},n.initItem=function(){var e,t;this._itemArr=[];for(var i=0;i<5;i++)(t=this["img_"+i]).visible=!1,(e=new pK).pos(t.x,t.y),e.name="item_"+i,this._itemArr.push(e),this.box_c.addChild(e)},n.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.layout.dragon_border.visible=!1,t.btn_activity.on("click",t,t.onActivityClicked),t.btn_soulUpgrade.on("click",t,t.onSoulUpgradeClicked);for(var i=0;i<t._itemArr.length;i++)t._itemArr[i].on("click",t,t.onItemClicked);var n=new zf;Tu.sendToService(n),null==t._activityEff&&(t._activityEff=kB.createEffect("jm1130",360,t.btn_soulUpgrade.y+34,t.box_c),t._activityEff.scale_X=1.25,t._activityEff.scale_Y=1.25),t.txt_vip.on("click",t,t.gotoVipPanel),t.txt_canActivity3.innerHTML=t.txt_canActivity2.innerHTML=t.txt_canActivity.innerHTML=""},n.updateView=function(){for(var e,t,i=this,n=0;n<5;n++)e=i._itemArr[n],t=Vf.instance.configArr[n],e.dataSource=t;if(Vf.instance.checkAllPartIsActivity())t=Vf.instance.configArr[5],-1==i._selectedIndex&&(i._selectedIndex=0),i.updateSoulUpgrade(),i.updateSkill(),i.updateAttr();else if(i.txt_cost.text="",i.btn_soulUpgrade.visible=!1,-1==i._selectedIndex){i._selectedIndex=0;for(var s=4;0<s;s--)if(0==(t=Vf.instance.configArr[s]).statue){i._selectedIndex=t.id-1;break}i.onItemClicked(null)}else i.updateSkill(),i.updateDisplay(),i.updateAttr()},n.updateSkill=function(){var e=Vf.instance.configArr[this._selectedIndex];this.txt_elementName.text=e.skillName,this.txt_elementDect.innerHTML=e.skillDect},n.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_activity.off("click",t,t.onActivityClicked),t.btn_soulUpgrade.off("click",t,t.onSoulUpgradeClicked);for(var i=0;i<t._itemArr.length;i++)t._itemArr[i].off("click",t,t.onItemClicked);t._activityEff&&(t._activityEff.parent&&t._activityEff.parent.removeChild(t._activityEff),t._activityEff.dispose(),t._activityEff=null),t.txt_vip.off("click",t,t.gotoVipPanel)},n.gotoVipPanel=function(){0<this._openIdx&&hN.ins.open("VIP_PANEL",this._openIdx)},n.onActivityClicked=function(e){var t=new Xf;t.part=this._selectedIndex+1,Vf.instance.currentActivityPart=t.part,Tu.sendToService(t)},n.onSoulUpgradeClicked=function(e){if(yB.createStr(xv.MODEL.consume(5)).goodsNum>gR.ins.YB)KQ.ins.showNoGold();else{var t=new Xf;t.part=6,Vf.instance.currentActivityPart=t.part,Tu.sendToService(t)}},n.onItemClicked=function(e){var t,i;for(var n in t=e?e.currentTarget.dataSource:Vf.instance.configArr[this._selectedIndex],this._itemArr)(i=this._itemArr[n]).dataSource.id!=t.id?(i.setSelected(!1),this._selectedIndex=t.id-1):i.setSelected(!0);Vf.instance.checkAllPartIsActivity()?this.updateSoulUpgrade():this.updateDisplay(),this.updateSkill(),this.updateAttr()},n.updateDisplay=function(){var e,t=this;switch(t.txt_canActivity3.innerHTML="",t.img_isActivity.visible=!1,t.txt_vip.visible=!1,t.txt_canActivity2.innerHTML=t.txt_canActivity.innerHTML="",(e=t._selectedIndex<t._itemArr.length?t._itemArr[t._selectedIndex].dataSource:Vf.instance.configArr[t._selectedIndex]).statue){case 2:var i=e.activityDect,n=i.substr(4,4);t._openIdx=parseInt(n.substr(3,1));var s=i.substr(1,1),o=yh.getObj(xv.MODEL.activeOrCondition(xv.getIndex(e.id)))[0],a=-1;if("serverOpenDay"==o.type){var r;a=parseInt(o.value);r=Vf.instance.loginDay<a?"#e41b00":"#01b527"}var l=Vf.instance.loginDay;t.txt_canActivity.innerHTML="开服第"+s+"天或",t.txt_canActivity2.innerHTML="开启（"+Ql.createColor(l+"",r)+"/"+a+"）",t.txt_vip.changeText(n),t.txt_vip.x=t.txt_canActivity.x+t.txt_canActivity.contextWidth+10,t.txt_canActivity2.x=t.txt_vip.x+t.txt_vip.displayWidth+5,t.txt_vip.visible=!0,t.btn_activity.visible=t._activityEff.visible=!1;break;case 0:t.btn_activity.visible=t._activityEff.visible=!0;break;case 1:t.img_isActivity.visible=!0,t.btn_activity.visible=t._activityEff.visible=!1}},n.updateAttr=function(){var e=Vf.instance.configArr[this._selectedIndex];this._attrArr=aa.formatNewAttrToChinese(e.activeAttribute),this.list_attr.dataSource=this._attrArr},n.updateSoulUpgrade=function(){var e=this;e.txt_vip.visible=!1,e.txt_canActivity2.innerHTML=e.txt_canActivity.innerHTML="";var t=Vf.instance.configArr[5];switch(e.img_isActivity.visible=!1,t.statue){case 0:var i=yB.createStr(xv.MODEL.consume(5)),n=i.goodsNum;i.goodsNum=1,e.img_cost.visible=!0,e.txt_cost.text=n.toString(),gR.ins.YB>=n?e.txt_cost.color="#23b11f":e.txt_cost.color="#e0d6c1",e._activityEff.visible=e.btn_soulUpgrade.visible=!0,e.txt_elementDect.innerHTML="",e.txt_elementName.text="",e.txt_canActivity.innerHTML="",e.img_chain.visible=!1;break;case 2:var s=yh.getObj(xv.MODEL.activeOrCondition(5))[0],o=-1;if("serverOpenDay"==s.type){var a;o=parseInt(s.value);a=Vf.instance.loginDay<o?"#e41b00":"#01b527",e.txt_canActivity3.innerHTML=Ql.createColor(t.activityDect+"(","#e0d6c1")+Ql.createColor(Vf.instance.loginDay.toString(),a)+Ql.createColor("/"+o+")","#e0d6c1")}else e.txt_canActivity3.innerHTML=t.activityDect;e._activityEff.visible=e.btn_soulUpgrade.visible=!1,e.btn_activity.visible=!1,e.txt_elementDect.innerHTML="",e.txt_elementName.text="",e.txt_cost.text="";break;default:e.txt_cost.text="",e._activityEff.visible=e.btn_soulUpgrade.visible=!1,e.btn_activity.visible=!1,e.txt_canActivity3.innerHTML=""}},n.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},e.NAME="SoulPreviewPanel",e.__init$=function(){i=function(e){function t(){this._content=null,this._fontSize=24,t.__super.call(this),this.initUI()}b(t,"",e);var i=t.prototype;return i.initUI=function(){var e=this;e._content=new Xl,e._content.width=200,e._content.font=dr.font,e._content.fontSize=e._fontSize,e._content.color="#FFFFFF",e._content.height=e._fontSize,e._content.align="left",e._content.style.lineHeight=e._fontSize+4,e._content.style.height=e._fontSize+4,e.addChild(e._content)},p(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(G.superSet(Vg,this,"dataSource",e),e&&this._content){var t=e;this._content.innerHTML=Ql.createColor(t.name,"#90877b")+Ql.createColor(" +"+t.val,"#23b11f")}}),t}(Vg)},e}(Hf),O1=function(e){function t(){this.titleTween=null,this._achiveY=0,this._achieves=null,this._skillGrids=new Array,t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.soul.views.soulskin.SoulSkinGoodsTip",qf);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.imgSoul.y=45,this.titleTween=Og.to(this.imgSoul,{y:40},500,null,ql.create(this,this.shareHandler)),eq.panelLayer.on("click",this,this.onClickClose)},i.onClickClose=function(e){hN.ins.close("SoulSkinGoodsTip")},i.shareHandler=function(){var e=this;50==e.imgSoul.y?e.titleTween=Og.to(e.imgSoul,{y:40},1e3,null,ql.create(e,e.shareHandler)):40==e.imgSoul.y?e.titleTween=Og.to(e.imgSoul,{y:50},500,null,ql.create(e,e.shareHandler)):45==e.imgSoul.y&&(e.titleTween=Og.to(e.imgSoul,{y:50},500,null,ql.create(e,e.shareHandler)))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.titleTween&&this.titleTween.clear(),eq.panelLayer.off("click",this,this.onClickClose)},i.update=function(e){var t,i=this,n=e,s=0,o=0,a=0;for(o=0;o<Gn.count;o++)if(Gn.MODEL.goodsId(o)==n){s=Gn.MODEL.type(o),t=Gn.MODEL.name(o),a=Gn.MODEL.fight(o);break}for(i.imgName.skin=_r.getFullUrl("ui/images/soul/yshh_tip_"+s+".png"),i.fight.value=a,i.imgSoul.skin=_r.getFullUrl("ui/images/soul/yshh_zs_"+s+".png"),i.htmlDes.innerHTML=Ql.createColor(RP.n[1383],"#e0d6c1")+Ql.createColor(t,"#e6d80d");i._skillGrids.length;)i._skillGrids.pop().removeSelf();var r,l=0,c=oB.ins.getTalentSkillInfo()[s],u=0;if(c)for(o=0;o<c.length;o++){var d=new bK;i._skillGrids.push(d),d.pos(48,492),i.addChild(d),d.update(c[o],99999,!0,!1),u=Ls.getIndex(c[o].skillId),r=Ls.MODEL.skillDesc(u),i.htmlSkillTalent.innerHTML=r+Ql.newline(),i.htmlSkillTalent.y=496}l=659;var h=oB.ins.skillInfo[s],_="";if(h)for(o=0;o<h.length;o++){var f=new bK;i._skillGrids.push(f),f.pos(48+o%2*308,l),l+=o%2==1&&0<o/2?142:0,i.addChild(f),f.update(h[o],99999,!1,!1),u=Ls.getIndex(h[o].skillId),_=Ls.MODEL.skillName(u),i["htmlSkill"+(o+1)].innerHTML=oB.ins.getStepByLevel(h[o].lockLevel,s)+RP.n[1384]+Ql.createColor("【"+_+"】","#e0d6c1"),i["htmlSkill"+(o+1)].y=f.y-32,i["htmlSkill"+(o+1)].x=f.x,i["htmlSkillDesc"+(o+1)].x=f.x+104,i["htmlSkillDesc"+(o+1)].y=f.y+4,i["htmlSkillDesc"+(o+1)].innerHTML=h[o].desc+Ql.newline()}var p=yB.create(n);i.setAchieving(p),i._achieves?i.height=900+i._achieves.height+20:i.height=900},i.setAchieving=function(e){var t=this;e&&Bi.MODEL.achieving(e.cfgIdx)&&e.needGetWay?(t._achieves||(t._achieves=new OQ(ql.create(t,t._$9_close,null,!1)),t._achieves.centerX=0),t._achieves.pos(0,900),t.addChild(t._achieves),t._achieves.update(e.goodsId)):t._achieves&&t._achieves.removeSelf()},i._$9_close=function(){hN.ins.close("SoulSkinGoodsTip"),EY.ins.close()},t.NAME="SoulSkinGoodsTip",t}(),P1=function(e){function t(){var e=this;e.beforePoint=null,e.afterPoint=null,e.LINK_POSITION=[[{x:315,y:1040}],[{x:234,y:1040},{x:410,y:1040}],[{x:234,y:1010},{x:410,y:1010},{x:315,y:1074}],[{x:234,y:1010},{x:410,y:1010},{x:234,y:1074},{x:410,y:1074}],[{x:139,y:1010},{x:315,y:1010},{x:491,y:1010},{x:234,y:1074},{x:410,y:1074}],[{x:139,y:1010},{x:315,y:1010},{x:491,y:1010},{x:139,y:1074},{x:315,y:1074},{x:491,y:1074}],[{x:58,y:1010},{x:234,y:1010},{x:410,y:1010},{x:586,y:1010},{x:139,y:1074},{x:315,y:1074},{x:491,y:1074}],[{x:58,y:1010},{x:234,y:1010},{x:410,y:1010},{x:586,y:1010},{x:58,y:1074},{x:234,y:1074},{x:410,y:1074},{x:586,y:1074}]],e.currengRingId=0,e.linkTxtArr=[],e._clickBoxes=[],e.linkItemArr=[],e.sgrmodel=null,e.imgRing=null,e.hasActiveEffect=[],e.mainActiveEffect=null,e.tween1=null,e.tween2=null,e.effectPro=null,e.effectGuangMu=null,e._activeBtnEffect=null,e.ringHash=null,e.chipFight=0,e.eff1=null,e._activeEffect=null,e._globalTouch=null,e.activedEffectId="jm1168",e._flyeffect=null,t.__super.call(e),e.initUI()}b(t,"modules.specialgodring.view.SGRActiveView",rp);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btnUp.visible=!1,t.txtisactive_0.visible=t.txtisactive_1.visible=!1,t.btnLook.on("click",t,t.onClickLookRingListener),t.btnLeft.on("click",t,t.onClickRingArrowListener),t.btnRight.on("click",t,t.onClickRingArrowListener),t.btnUp.on("click",t,t.onClickActiveRingListener),t.setData(t.sgrmodel.activingRingId-1)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnLeft.off("click",t,t.onClickRingArrowListener),t.btnRight.off("click",t,t.onClickRingArrowListener),t.btnLook.off("click",t,t.onClickLookRingListener),t.btnUp.off("click",t,t.onClickActiveRingListener),t.clear(),t.chipFight=0,LY.showing&&(LY.Ins().closeLockArrow(27),LY.Ins().closeLockArrow(33))},i.onMouseDown=function(e){var t=e.stageX,i=e.stageY;this._globalTouch=new Uh(t,i)},i.updateByVSC=function(e){null!=e&&(e.hasOwnProperty("updatering")?this.setData():this.showEffect(e.ringid,e.part))},i.showEffect=function(e,t){this.chipFight=0,this.setData(e)},i.setData=function(e){void 0===e&&(e=-1),-1==e||(this.currengRingId=e),this.showCurrentRingInfo()},i.destroy=function(e){var t=this;for(var i in void 0===e&&(e=!0),t.ringHash.proto){var n=t.ringHash.take(i);n&&n.skin&&(n.destroy(),n.dispose(),n=null)}t.ringHash.dispose(),t.ringHash=null,t.mainActiveEffect&&t.mainActiveEffect.parent&&(t.mainActiveEffect.parent.removeChild(t.mainActiveEffect),t.mainActiveEffect.dispose(),t.mainActiveEffect=null),t.effectGuangMu&&t.effectGuangMu.parent&&(t.effectGuangMu.parent.removeChild(t.effectGuangMu),t.effectGuangMu.dispose(),t.effectGuangMu=null),t.effectPro&&t.effectPro.parent&&(t.effectPro.parent.removeChild(t.effectPro),t.effectPro.dispose(),t.effectPro=null),t._activeEffect&&(t._activeEffect.parent&&t._activeEffect.parent.removeChild(t._activeEffect),t._activeEffect.dispose(),t._activeEffect=null);var s=0;for(s=0;s<t.linkTxtArr.length;s++)t.linkTxtArr[s]=null,t._clickBoxes[s].off("click",t,t.onClickChipInfoListener),t._clickBoxes[s]=null,t.linkItemArr[s].destroy(e),t.linkItemArr[s]=null;for(t._clickBoxes=[],t.linkTxtArr=[],t.linkItemArr=[],s=0;s<t.hasActiveEffect.length;s++)t.hasActiveEffect[s].parent&&(t.hasActiveEffect[s].parent.removeChild(t.hasActiveEffect[s]),t.hasActiveEffect[s].dispose(),t.hasActiveEffect[s]=null);t.img_bg=null,t.img_ring_bg=null,t.img_des=null,t.imgRing=null,t.imgtxtBG=null,ui.SubPanel.prototype.destroy.call(t,e)},i.initUI=function(){var e=this;e.sgrmodel=aB.instance,e.img_ring_bg.visible=!1,e.title=_r.getStyleImagePath("tj_text_tj"),null==e.imgRing&&(e.imgRing=new Kl,e.sgrPanel.addChild(e.imgRing),e.imgRing.x=0,e.imgRing.y=0),null==e.ringHash&&(e.ringHash=new jl),e.beforePoint=e.imgRing.localToGlobal(new Uh(0,0)),e.sgrPanel.mouseEnabled=e.sgrPanel.mouseThrough=!1},i.onMouseUp=function(e){if(!hN.ins.isOpen("SGRING_ACTIVED_SHOW_VIEW")&&!this.btnUp.visible&&null!=this._globalTouch)for(var t=e.stageX,i=e.stageY,n=0;n<this.linkTxtArr.length;n++){var s=this.linkTxtArr[n];if(s.visible){var o=s.localToGlobal(new Uh(s.x,s.y));o.x-=s.x,o.y-=s.y;var a=new u_(o.x-40,o.y-20,180,62);if(a.contains(t,i)&&a.contains(this._globalTouch.x,this._globalTouch.y)){var r={info:s.name};CY.instance.show(r);break}}}},i.showCurrentRingInfo=function(){var e=this;e.clear();var t;t=_r.getSpecialGodRingIconPath(e.currengRingId),e.imgRing.skin=t,e.img_des.skin=_r.getSpecialGodRingDesPath(e.currengRingId),e.txtRingName.skin=_r.getSpecialGodRingVTitlePath(e.currengRingId);var i=A_.getRingPos(e.currengRingId);6==e.currengRingId||11==e.currengRingId?(e.imgRing.x=-120+i.x,e.imgRing.y=-80+i.y):(e.imgRing.x=0+i.x,e.imgRing.y=0+i.y);var n=e.getChipInfo(e.currengRingId),s=0;n.length;for(s=0;s<n.length;s++){var o,a,r;e.linkTxtArr.length>s?(o=e.linkTxtArr[s],a=e.linkItemArr[s],r=e._clickBoxes[s]):(o=kB.createText(120+s%4*190,1074+53*Math.floor(s/4),120,0,"",22,"#90877b",!1,"center",!1,!1,e.box_d),e.linkTxtArr.push(o),(r=new dt).size(160,60),e._clickBoxes.push(r)),e.linkItemArr.length>s?a=e.linkItemArr[s]:(a=new MF,e.linkItemArr.push(a));var l=e.LINK_POSITION[n.length-1][s];r.pos(l.x-40,l.y-19-972),o.pos(l.x,l.y-972);var c=Bi.getIndex(parseInt(n[s].id));o.text=Bi.MODEL.name(c),o.name=n[s].id+"_"+n[s].num+"_"+s+"_"+e.currengRingId,r.name=o.name,r.on("click",e,e.onClickChipInfoListener),o.underline=!0,a.mouseEnabled=!1,a.needGridBg=!1,a.bindData=yB.create(parseInt(n[s].id)),a.x=o.x-40,a.y=o.y-16,a.width=a.height=55,null==o.parent&&e.box_d.addChild(o),null==r.parent&&e.box_d.addChild(r),null==a.parent&&e.box_d.addChild(a)}var u=e.sgrmodel.getAtrrForRingId1();e.fight_num.value=u+e.chipFight,e.txtDesc.text=Qt.MODEL.ringPack(e.currengRingId),e.showChipInfo(),e.currengRingId<e.sgrmodel.activedRingId?(null==e.effectGuangMu&&(e.effectGuangMu=kB.createEffect("jm1034",360,219,e)),e.showRingEffect(),e.txtisactive_1.visible=!0,e.txtisactive_0.visible=!1):(6==e.currengRingId||11==e.currengRingId?(e.imgRing.x=-120+i.x,e.imgRing.y=-80+i.y):(e.imgRing.x=0+i.x,e.imgRing.y=0+i.y),e.txtisactive_1.visible=!1,e.txtisactive_0.visible=!0),e.btnLeft.visible=0<e.currengRingId,e.btnRight.visible=e.currengRingId<27,1==e.btnRight.visible&&e.currengRingId==e.sgrmodel.activingRingId&&e.sgrmodel.activedRingId<27&&(e.btnRight.visible=!1),e.doShowGuide(),e.ringHash.put(e.imgRing.skin,e.imgRing),e.ringHash.put(e.img_des.skin,e.img_des),e.ringHash.put(e.txtRingName.skin,e.txtRingName)},i.onActiveRing=function(e){null!=this.mainActiveEffect&&this.mainActiveEffect.parent&&this.sgrmodel.reqActiveRing(),this.doShowGuide()},i.showChipInfo=function(){var e,t,i=this,n=0,s=0,o=[],a=0,r=0;if(o=i.getChipInfo(i.currengRingId),i.mainActiveEffect&&i.mainActiveEffect.parent&&(i.mainActiveEffect.parent.removeChild(i.mainActiveEffect),i.mainActiveEffect.dispose(),i.mainActiveEffect=null),i.img_ring_bg.visible=!1,i.btnUp.visible=!1,null!=i._activeBtnEffect&&(i._activeBtnEffect.removeSelf(),i._activeBtnEffect.dispose(),i._activeBtnEffect=null),i.currengRingId==i.sgrmodel.activingRingId-1){for(n=0;n<i.sgrmodel.activingRingChipArr.length;n++){var l;if(e=i.linkTxtArr[n].name.split("_")[0],t=i.linkTxtArr[n].name.split("_")[1],Bi.getIndex(parseInt(e)),1==i.sgrmodel.activingRingChipArr[n])s++,i.linkTxtArr[n].color="#23b11f";else if(i.linkTxtArr[n].color="#90877b",TR.ins.getGoodsNum(parseInt(e))>=parseInt(t))i.hasActiveEffect.length>r?((l=i.hasActiveEffect[a]).x=i.linkTxtArr[n].x+46,l.y=i.linkTxtArr[n].y+10,a++):((l=kB.createEffect("jm1130",i.linkTxtArr[n].x+46,i.linkTxtArr[n].y+10,i.box_d)).mouseEnabled=l.mouseThrough=!1,l.scale_X=1,l.scale_Y=1,i.hasActiveEffect.push(l)),l.parent||i.addChild(l),i.linkTxtArr[n].color="#e0d6c1",r++;i.linkTxtArr[n].underlineColor=i.linkTxtArr[n].color}s>=i.sgrmodel.activingRingChipArr.length&&i.currengRingId+1==i.sgrmodel.activingRingId&&(i.clear(),i.btnUp.visible=!0,i.btnUp.scale(0,0),i.btnUp.anchorX=.5,i.btnUp.anchorY=.5,Og.clearAll(i.btnUp),Og.to(i.btnUp,{scaleX:1,scaleY:1},400,null),null==i._activeBtnEffect&&(i._activeBtnEffect=kB.createEffect("jm1130",i.btnUp.width/2,i.btnUp.height/2,i.btnUp),i._activeBtnEffect.scale_X=1.25,i._activeBtnEffect.scale_Y=1.25));Math.floor(360/i.sgrmodel.activingRingChipArr.length)}else if(i.currengRingId<i.sgrmodel.activedRingId)for(o=i.getChipInfo(i.currengRingId),n=0;n<o.length;n++)i.linkTxtArr[n].color="#23b11f",i.linkTxtArr[n].underlineColor=i.linkTxtArr[n].color;else for(o=i.getChipInfo(i.currengRingId),n=0;n<o.length;n++)i.linkTxtArr[n].color="#90877b",i.linkTxtArr[n].underlineColor=i.linkTxtArr[n].color},i.showMask=function(e){var t=this;-1==e?(null==t.effectPro&&(t.effectPro=kB.createEffect("jm1138",380,248,t.sgrPanel)),null==t.effectGuangMu&&(t.effectGuangMu=kB.createEffect("jm1034",489,409,t)),t.effectPro.visible=!0,t.effectGuangMu.visible=!0):(t.effectPro&&t.effectPro.parent&&(t.effectPro.visible=!1),t.effectGuangMu&&t.effectGuangMu.parent&&(t.effectGuangMu.visible=!1))},i.showRingEffect=function(){var e=A_.getRingPos(this.currengRingId);this.imgRing.y=40+e.y,this.tween1=Og.to(this.imgRing,{y:-20+e.y},1500,pa.linearInOut,ql.create(this,this.onSucComp))},i.onSucComp=function(){var e=A_.getRingPos(this.currengRingId);this.tween2=Og.to(this.imgRing,{y:40+e.y},1500,pa.linearInOut,ql.create(this,this.showRingEffect))},i.onClickChipInfoListener=function(e){var t={info:e.target.name};CY.instance.show(t)},i.getChipInfo=function(e){var t=0,i=Qt.MODEL.fragments(e).split(","),n=Qt.MODEL.number(e).split(","),s=[];for(t=0;t<i.length;t++){var o=new Object;o.id=i[t],o.num=n[t],s.push(o)}return s},i.onClickLookRingListener=function(e){var t=this.sgrmodel.getAtrrForRingId();TY.instance.show(t)},i.onClickRingArrowListener=function(e){e.target==this.btnLeft?0<this.currengRingId?this.currengRingId--:(this.currengRingId=0,zB.ins.playErrorMsg(RP.n[1385])):this.currengRingId>this.sgrmodel.activedRingId?zB.ins.playErrorMsg(RP.n[1386]):this.currengRingId++,this.showCurrentRingInfo()},i.showSuccessEffect=function(e){this._activeEffect=kB.createEffect("jm1167",e.width/2,e.height/2,e),this._activeEffect.playEndHandler=ql.create(this,this.onClearActiveEff,null,!0)},i.onClearActiveEff=function(){this._activeEffect&&(this._activeEffect.dispose(),this._activeEffect=null)},i.onClickActiveRingListener=function(e){this.sgrmodel.reqActiveRing()},i.clear=function(){var e=this,t=0;for(t=0;t<e.linkTxtArr.length;t++)null!=e.linkTxtArr[t]&&(e.linkTxtArr[t].parent&&e.linkTxtArr[t].parent.removeChild(e.linkTxtArr[t]),e.linkItemArr[t].parent&&e.linkItemArr[t].parent.removeChild(e.linkItemArr[t]),e._clickBoxes[t].parent&&e._clickBoxes[t].parent.removeChild(e._clickBoxes[t]));for(t=0;t<e.hasActiveEffect.length;t++)e.hasActiveEffect[t].parent&&e.hasActiveEffect[t].parent.removeChild(e.hasActiveEffect[t]),e.hasActiveEffect[t].dispose(),e.hasActiveEffect[t]=null;e.hasActiveEffect=[],null!=e.effectGuangMu&&(e.effectGuangMu.removeSelf(),e.effectGuangMu.dispose(),e.effectGuangMu=null),e._activeEffect&&e._activeEffect.parent&&(e._activeEffect.parent.removeChild(e._activeEffect),e._activeEffect.dispose(),e._activeEffect=null),e.eff1&&(e.eff1.parent&&e.eff1.parent.removeChild(e.eff1),e.eff1.dispose(),e.eff1=null),e.tween1&&e.tween1.clear(),e.tween2&&e.tween2.clear()},i.showImageRingInfo=function(){var e=this,t="",i=0,n=0;if(e.currengRingId==e.sgrmodel.activingRingId-1){for(n=0;n<e.sgrmodel.activingRingChipArr.length;n++)1==e.sgrmodel.activingRingChipArr[n]&&i++;t=_r.getSGRPath(e.currengRingId+"_"+i)}else t=e.currengRingId<e.sgrmodel.activedRingId?(i=Qt.MODEL.fragments(e.currengRingId).split(",").length,_r.getSGRPath(e.currengRingId+"_"+i)):_r.getSGRPath(e.currengRingId+"_0");return t},i.clearFlyEffect=function(){this._flyeffect&&(this._flyeffect.dispose(),this._flyeffect=null)},i.doShowGuide=function(){var e=this,t=PH.Ins().info;if(t&&2==t.status){var i,n;if(rp.uiView.hasOwnProperty("props")&&rp.uiView.props.hasOwnProperty("height")&&rp.uiView.props.height,0<t.getCurrentGuide(27)&&e.linkTxtArr&&0<e.linkTxtArr.length&&(0==e.sgrmodel.activingRingChipArr[0]||0==e.sgrmodel.activingRingChipArr[1]))0==e.sgrmodel.activingRingChipArr[0]?n=e.linkTxtArr[0]:0==e.sgrmodel.activingRingChipArr[1]&&(n=e.linkTxtArr[1]),n&&((i=new u_).x=n.x+-45,i.y=n.y+-30,i.width=n.width+80,i.height=n.height+40,LY.Ins().show(27,i,!1,e.box_d));else if(0<t.getCurrentGuide(33)){var s=new u_;s.x=e.btnUp.x+-98,s.y=e.btnUp.y+-50,s.width=e.btnUp.width,s.height=e.btnUp.height+20,LY.Ins().show(33,s,!1,e.box_d)}else LY.showing&&(LY.Ins().close(27),LY.Ins().close(33))}else t&&3==t.status&&0<t.taskEvent.indexOf("27")&&0<t.taskEvent.indexOf("12")&&t.taskEvent.indexOf("33")<0?e.showGuide(12,!0):LY.showing&&(LY.Ins().close(27),LY.Ins().close(33))},t.HANDEFFID="jm1034",t}(),R1=(function(e){function s(){var e=this;e.ringModel=null,e.ringItemArr=[],e._showUIArr=[],e._showRingItemArr=null,e.ITEM_SPACE=0,e.ITEM_HEIGHT=0,e._SHOW_POSITION=[250,320,390,320],e._globalTouch=null,e._lastIndex=-1,s.__super.call(e),e.initUI(),e.ringModel=aB.instance;for(var t=0;t<5;t++){var i=e["item"+t],n=new EK;n.visible=!1,i.addChild(n),e._showUIArr[t]=n}e.items.mouseEnabled=!1,e.sgrPanel.alpha=0}b(s,"modules.specialgodring.view.SGRMainView",dp);var t=s.prototype;t.destroy=function(e){var t=this;void 0===e&&(e=!0),0==hN.ins.isOpen("SGRING_ACTIVE_VIEW")&&(NP.clearTextureByModule("/images/specialgodring/"),NP.clearTextureByModule("/images/specialring_title/"),NP.clearTextureByModule("/layouts/specialgodring/"));var i=0;for(i=0;i<t._showUIArr.length;i++)t._showUIArr[i].parent.removeChild(t._showUIArr[i]),t._showUIArr[i].destroy(e),t._showUIArr[i]=null;for(t._showUIArr=[],i=0;i<t._showRingItemArr.length;i++)null!=t._showRingItemArr[i].parent&&(t._showRingItemArr[i].parent.removeChild(t._showRingItemArr[i]),t._showRingItemArr[i].destroy(e),t._showRingItemArr[i]=null);if(t._showRingItemArr=[],t.ringItemArr&&0<t.ringItemArr.length)for(var n;0<t.ringItemArr.length;)(n=t.ringItemArr.shift()).parent.removeChild(n);ui.SubPanel.prototype.destroy.call(t,e)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.showRingInfo(),G.timer.loop(200,t,t.onChangeScroll),t.on("mousedown",t,t.onMouseDown),t.on("mouseup",t,t.onMouseUp)},t.onRemove=function(e){var t=this;if(ui.SubPanel.prototype.onRemove.call(t,e),t.ringItemArr&&0<t.ringItemArr.length)for(var i;0<t.ringItemArr.length;)(i=t.ringItemArr.shift()).parent.removeChild(i);LY.showing&&(LY.Ins().close(25),LY.Ins().close(26),LY.Ins().close(27),LY.Ins().close(28)),t.off("mousedown",t,t.onMouseDown),t.off("mouseup",t,t.onMouseUp),G.timer.clear(t,t.onChangeScroll),t._lastIndex=-1},t.onMouseUp=function(e){if(null!=this._globalTouch)for(var t=e.stageX,i=e.stageY,n=0;n<this._showUIArr.length;n++){var s=this._showUIArr[n];if(s&&s.visible){var o=s.localToGlobal(new Uh(s.x,s.y)),a=new u_(o.x,o.y,s.width,s.height);a.contains(t,i)&&a.contains(this._globalTouch.x,this._globalTouch.y)&&s.clickItem()}}},t.onMouseDown=function(e){var t=e.stageX,i=e.stageY;this._globalTouch=new Uh(t,i)},t.initUI=function(){this.sgrPanel.vScrollBarSkin="",this.sgrPanel.vScrollBar.rollRatio=0},t.onChangeScroll=function(){this.updateScrollItems()},t.updateScrollItems=function(){if(null!=this._showRingItemArr){var e,t=this._showRingItemArr.concat(),s=this.sgrPanel.vScrollBar.value+this.sgrPanel.height/2;t.sort(function(e,t){var i=Math.abs(e.y+e.height/2-s),n=Math.abs(t.y+t.height/2-s);return n<i?1:i<n?-1:0}),e=t[0];var i=this._showRingItemArr.indexOf(e);if(this._lastIndex!=i){this._lastIndex=i;for(var n=0;n<this._showUIArr.length;n++){var o=this._showUIArr[n];null!=this._showRingItemArr[i-2+n]?(e=this._showRingItemArr[i-2+n],o.visible=!0,o.data=e.dataSource):o.visible=!1}}}},t.showRingInfo=function(){var e=this,t=5;t=e.ringModel.activedRingId<=3?5:0==e.ringModel.activingRingId?e.ringModel.activedRingId:28==e.ringModel.activingRingId?e.ringModel.activingRingId:e.ringModel.activingRingId+1;var i,n=0,s=0;for(e._showRingItemArr=[],n=0;n<t;n++)e.ringItemArr.length>n?i=e.ringItemArr[n]:((i=new dt).size(770,200),e.ringItemArr.push(i)),0==e.ITEM_HEIGHT&&(e.ITEM_HEIGHT=e.sgrPanel.height/5),i.y=(e.ITEM_HEIGHT+e.ITEM_SPACE)*n,i.dataSource=n,e._showRingItemArr.push(i),s+=(e.ITEM_HEIGHT+e.ITEM_SPACE)*n;for(n=0;n<e._showRingItemArr.length;n++){if(i=e._showRingItemArr[n],null==e._showRingItemArr[n].parent){var o=0;i.x=850,o=e._SHOW_POSITION[n%e._SHOW_POSITION.length],i.alpha=0,e.sgrPanel.addChild(i)}Og.to(i,{x:o,alpha:1},268,null,null)}e.items.x=500,e.items.alpha=0,Og.to(e.items,{x:121,alpha:1},268,null,null),e.sgrPanel.vScrollBar.max=s;var a=e.ringModel.activedRingId*(e.ITEM_HEIGHT+e.ITEM_SPACE);s<a&&(a=s),e.sgrPanel.vScrollBar.value=a},s.NAME="SGRA_TITLE"}(),function(e){function t(){var e=this;e._dto=null,e._toggle=!1,e._effect=null,e._effId=null,e.idx=0,t.__super.call(e),e.img_bg.visible=!1,e.height=130,e.left=0,e._toggle=!1,e.img_title.visible=!1}b(t,"modules.title.views.TitleItem",eg);var i=t.prototype;return i.onAdd=function(e){this.img_head.on("click",this,this.onToggle),this.btn_show.on("click",this,this.onToggle),this.btn_wear.on("click",this,this.onWear)},i.onRemove=function(e){var t=this;t.img_head.off("click",t,t.onToggle),t.btn_show.off("click",t,t.onToggle),t.btn_wear.off("click",t,t.onWear),G.timer.clear(t,t.onTimer)},i.destroy=function(e){void 0===e&&(e=!0),this._effect&&this._effect.forceDestory(),this._effect=null,this._effId=null,ui.SubPanel.prototype.destroy.call(this,e)},i.onToggle=function(){this.toggle=!this.toggle,this.event("change",this)},i.onWear=function(){var e=this;if(null!=e._dto)if(0==e._dto.state){if(!tg.ins.canPlatformUseByID(e._dto.platform))return;var t=new QM;t.actor=e._dto.actor+1,t.titleId=e._dto.id,Tu.sendToService(t)}else if(0<e._dto.state){var i=gR.ins.actorById(e._dto.actor+1).job;if(e._dto.state!=i){var n=co.getIndex(e._dto.id),s=co.MODEL.name(n),o=RP.n[1387]+ha.getDesByType(e._dto.state)+"的"+Ql.createColor("["+s+"]","#912CEE")+"称号。";KQ.ins.showBox(o,RP.n[1388],ql.create(e,e.onWearBack,[e._dto]),!1,3,RP.n[1389],RP.n[1390],RP.n[1391],!0)}else{var a=new JM;a.actor=e._dto.actor+1,a.titleId=e._dto.id,Tu.sendToService(a)}}},i.onWearBack=function(e,t){if(1==t){if(!tg.ins.canPlatformUseByID(e.platform))return console.log("本渠道不允许的称号",e.id),void tr.push(RP.n[1392]+e.id);var i=new QM;i.actor=e.actor+1,i.titleId=e.id,Tu.sendToService(i)}},i.update=function(e){var t=this;t.idx=e;var i=tg.ins.role;if(tg.ins.toc_title){var n=tg.ins.toc_title.titles[i][t.idx];if(n!=t._dto){t._dto=n;var s=co.getIndex(n.id);if(t.txt_desc.text=co.MODEL.text(s),-1==n.endT)t.txt_desc.height=18,t.div_leftT.innerHTML="",G.timer.clear(t,t.onTimer);else{t.txt_desc.height=18;var o=dr.serverTimeSec,a=n.endT-o;a<0&&(a=0),t.div_leftT.innerHTML=RP.n[1393]+Ql.createColor(Jp.getHMSOrDHm(a),"#e41b00"),t._toggle&&G.timer.loop(300,t,t.onTimer)}var r=JSON.parse(co.MODEL.attr(s)),l=aa.formatAttrToChineseByList(r);t.txt_hp.changeText(l[0].val),t.txt_att.changeText(l[1].val),t.txt_wuDef.changeText(l[2].val),t.txt_moDef.changeText(l[3].val),4<l.length?(t.txt_sp.visible=t.lab_sp.visible=!0,"TITLE"!=l[4].module?t.lab_sp.changeText(t.getModuleName(l[4].module)+l[4].name+"加成："):t.lab_sp.changeText(l[4].name+"："),t.txt_sp.changeText(l[4].val)):t.txt_sp.visible=t.lab_sp.visible=!1,t.img_wear2.visible=!1;var c=n.state;if(0<c)1==c?t.img_wear2.skin=_r.getAtlasSubPath("title/ch_bq_zs.png"):2==c?t.img_wear2.skin=_r.getAtlasSubPath("title/ch_bq_fs.png"):3==c&&(t.img_wear2.skin=_r.getAtlasSubPath("title/ch_bq_ds.png")),t.img_wear2.visible=!0,c=gR.ins.actorById(i+1).job!=c?0:1;-1==c?(t.txt_noget.visible=!0,t.btn_wear.visible=!1,t.img_head.visible=!1):0==c?(t.txt_noget.visible=!1,t.btn_wear.visible=!0,t.btn_wear.label="佩 戴",t.img_head.visible=!0):1==c&&(t.txt_noget.visible=!1,t.btn_wear.visible=!0,t.btn_wear.label="卸 下",t.img_head.visible=!0),t.btn_show.showTip=0==t._dto.tipState;var u=co.MODEL.effect(s);t._effect&&(t._effect&&t._effect.forceDestory(),t._effect=null,t._effId=null),u&&0<u.length?(null==t._effect&&(t._effect=new mj,t._effect.pos(t.img_title.x,t.img_title.y),t._effect.renderInSelf=!0,t.addChild(t._effect)),t._effId&&u!=t._effId&&t._effect.removeEffect("eid_"+t._effId),t._effect.loadEffect(u)):(t._effect&&t._effect.forceDestory(),t._effect=null,t._effId=null)}}},i.onTimer=function(){var e=dr.serverTimeSec,t=this._dto.endT;t<e&&(G.timer.clear(this,this.onTimer),e=t),this.div_leftT.innerHTML=RP.n[1394]+Ql.createColor(Jp.getHMSOrDHm(t-e),"#e41b00")},i.getModuleName=function(e){var t;switch(e){case"WING_BASE":t="羽翼";break;case"ZHUANSHENG":t="转生";break;case"EQUIP_BASE":t="装备";break;case"GEMSTONE":t="宝石";break;case"DRAGONSOUL":t="龙魄";break;case"BOSS_CARD":t="图鉴";break;case"YUANGOD":t="元神"}return t},p(0,i,"toggle",function(){return this._toggle},function(e){if(e!=this._toggle)if(this._toggle=e,this._toggle){this.img_bg.visible=!0;var t=tg.ins.role;if(!tg.ins.toc_title)return;var i=tg.ins.toc_title.titles[t][this.idx],n=co.getIndex(this._dto.id),s=JSON.parse(co.MODEL.attr(n)),o=aa.formatAttrToChineseByList(s);if(-1==i.endT?this.height=4<o.length?400:366:this.height=4<o.length?444:399,1==this.txt_sp.visible)switch(this._dto.id){case 22:this.txt_sp.x=344;break;case 666:this.txt_sp.x=296;break;default:this.txt_sp.x=318}if(this.btn_show.selected=!0,this.btn_show.scaleY=-1,this.btn_show.y=85,-1!=this._dto.endT){var a=dr.serverTimeSec,r=this._dto.endT-a;r<0&&(r=0),this.div_leftT.innerHTML=RP.n[1395]+Ql.createColor(Jp.getHMSOrDHm(r),"#e41b00"),G.timer.loop(300,this,this.onTimer)}if(0==this._dto.tipState){var l=new ZM;l.titleId=this._dto.id,Tu.sendToService(l)}}else this.img_bg.visible=!1,this.height=130,this.btn_show.selected=!1,this.btn_show.scaleY=1,this.btn_show.y=41,G.timer.clear(this,this.onTimer)}),t}()),N1=(function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0}b(t,"modules.title.views.TitleTotalV",ng);var i=t.prototype;i.showTotal=function(){var e=this,t=tg.ins.toc_title;if(t){var i=tg.ins.toc_title.attrs;if(i[aa.MAXHP.id]?e.txt_hpT.changeText(i[aa.MAXHP.id]+""):e.txt_hpT.changeText("0"),i[aa.ATK.id]?e.txt_attT.changeText(i[aa.ATK.id]+""):e.txt_attT.changeText("0"),i[aa.DEF.id]?e.txt_wuDefT.changeText(i[aa.DEF.id]+""):e.txt_wuDefT.changeText("0"),i[aa.MDEF.id]?e.txt_moDefT.changeText(i[aa.MDEF.id]+""):e.txt_moDefT.changeText("0"),i[aa.BOSS_DAM_INC_RATE.id]?e.txt_boss.changeText(i[aa.BOSS_DAM_INC_RATE.id]/100+"%"):e.txt_boss.changeText("0%"),i[aa.GUANQIA_EXP_PLUS.id]?e.txt_GQExp.changeText(i[aa.GUANQIA_EXP_PLUS.id]/100+"%"):e.txt_GQExp.changeText("0%"),i[aa.CRI_RATE.id]?e.txt_crit.changeText(i[aa.CRI_RATE.id]/100+"%"):e.txt_crit.changeText("0%"),i[aa.ATTR_INC_RATE.id]){var n,s=t.titles[0],o=[];for(var a in s)0<=(n=s[a]).state&&o.push(n.id);-1!=o.indexOf(11)?e.txt_yuyi.changeText(e.getModuleValue(11)+""):e.txt_yuyi.changeText("0%"),-1!=o.indexOf(12)?e.txt_ZS.changeText(e.getModuleValue(12)+""):e.txt_ZS.changeText("0%"),-1!=o.indexOf(13)?e.txt_equip.changeText(e.getModuleValue(13)+""):e.txt_equip.changeText("0%"),-1!=o.indexOf(14)?e.txt_baoshi.changeText(e.getModuleValue(14)+""):e.txt_baoshi.changeText("0%"),-1!=o.indexOf(15)?e.txt_longpo.changeText(e.getModuleValue(15)+""):e.txt_longpo.changeText("0%"),-1!=o.indexOf(16)?e.txt_tujian.changeText(e.getModuleValue(16)+""):e.txt_tujian.changeText("0%"),-1!=o.indexOf(21)?e.txt_yuanshen.changeText(e.getModuleValue(21)+""):e.txt_yuanshen.changeText("0%")}else e.txt_yuyi.changeText("0%"),e.txt_ZS.changeText("0%"),e.txt_equip.changeText("0%"),e.txt_baoshi.changeText("0%"),e.txt_longpo.changeText("0%"),e.txt_tujian.changeText("0%"),e.txt_yuanshen.changeText("0%")}},i.getModuleValue=function(e){var t=co.getIndex(e),i=JSON.parse(co.MODEL.attr(t));return aa.formatAttrToChineseByList(i)[4].val},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)}}(),function(e){function t(){t.__super.call(this),this.top=this.bottom=this.left=this.right=0}b(t,"modules.treasure.views.TrlwExchangeView",Sg);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){this.list.itemRender=LK,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.spaceY=12,this.title=_r.getAtlasSubPath("treasure/tb_text_spsc.png")},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.pudateList(),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onClick=function(){hN.ins.close("TREASURE_EXCHANGE")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.pudateList=function(){var e=uB.ins.getExchangeData();G.timer.once(100,this,this.setExchangeList,[e])},i.setExchangeList=function(e){this.list.dataSource=e},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){},i.updateByVSC=function(e){},t}()),B1=function(e){function t(){var e=this;e.vsc=null,e._grids=null,e._lvl=0,e._eff=null,e._circleMask=null,e.dlbPosArr=null,e._effInfo=null,e._vipDataModel=Wg.ins,e._effs=new Array,t.__super.call(e),e.mouseThrough=!0,e.isHideBg=!0,e._grids=[],e.initUI(),e._effInfo={},e._effInfo[0]=["jm1145"],e._effInfo[1]=["jm1145"],e._effInfo[2]=["jm1145"],e._effInfo[3]=["jm1147"],e._effInfo[4]=["jm1147"],e._effInfo[5]=["jm1146"],e._effInfo[6]=["jm1147","jm1147"],e._effInfo[7]=["jm1226","jm1147"],e._effInfo[8]=["jm1147"],e._effInfo[9]=["jm1261"],e._effInfo[10]=["jm1261"],e.dlbPosArr=[270,225,225,280,217,230,225,330,221,221,221,217]}b(t,"modules.vip.views.VipGiftV",Fg);var i=t.prototype;return i.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.vsc=new SB(this),this.title=_r.getAtlasSubPath("vip2/vip_lb_text_viplb.png")},i.initUI=function(){var e=this,t=[];t.length=11,e.list_gift.hScrollBarSkin="",e.list_gift.scrollBar.elasticBackTime=300,e.list_gift.scrollBar.elasticDistance=100,e.list_gift.scrollBar.on("end",e,e.onScrollEnd),e.list_gift.array=t,e.list_gift.renderHandler=new ql(e,e.onListRender),e.list_gift.selectHandler=new ql(e,e.onSelect),e.list_gift.selectEnable=!0,e.img_hasBuy.visible=!1;e.setTitle(_r.getAtlasSubPath("vip2/VIPpackage_text_title.png"))},i.onClick=function(e){var t=this;if(null!=t._vipDataModel.toc_gift)if("buy"==e.target.name){if(-1!=t._lvl){var i=0|t._vipDataModel.toc_gift.awards[t._lvl];if(1==i){var n=new iA;n.lvl=t._lvl,Tu.sendToService(n)}else 0==i&&(zB.ins.playErrorMsg(RP.n[1396]),Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]))}}else if("next"==e.target.name){var s=t.list_gift.startIndex+4;s>=t.list_gift.length&&(s=t.list_gift.length-1),t.list_gift.startIndex!=s&&t.list_gift.tweenTo(s,150*(s-t.list_gift.startIndex),ql.create(t,t.onScrollEnd))}else"prev"==e.target.name&&((s=t.list_gift.startIndex-4)<0&&(s=0),t.list_gift.startIndex!=s&&t.list_gift.tweenTo(s,150*(t.list_gift.startIndex-s),ql.create(t,t.onScrollEnd)))},i.onListRender=function(e,t){if(t==this.list_gift.selectedIndex?e.img_select.visible=!0:e.img_select.visible=!1,e.img_vg.skin=_r.getVipPath("vip_lb_text_v"+t),e.img_grid.skin=_r.getVipPath("giftIcon_"+t),e.img_grid.scale(.83,.83),e.img_point.visible=!1,null!=this._vipDataModel.toc_gift){if(1==this._vipDataModel.toc_gift.awards[t]){var i=_o.getIndex(t),n=_o.MODEL.giftCost(i);gR.ins.YB>=n&&(e.img_point.visible=!0)}this._circleMask=new pp,this._circleMask.graphics.drawCircle(49,48,43,"#010101"),this._circleMask.pos(0,0),e.img_grid.mask=this._circleMask}},i.onSelect=function(e){this.setCurVip(e)},i.onScrollEnd=function(){0==this.list_gift.scrollBar.value?this.btn_prev.visible=!1:this.btn_prev.visible=!0,this.list_gift.scrollBar.value==this.list_gift.scrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.parent.parent.addChild(t.box_top);var i=new tA;Tu.sendToService(i),t._lvl=-1,t.btn_buy.on("click",t,t.onClick),t.btn_next.on("click",t,t.onClick),t.btn_prev.on("click",t,t.onClick),t.layout.dragon_border.visible=!1},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.parent.parent.removeChild(t.box_top),t.btn_buy.off("click",t,t.onClick),t.btn_next.off("click",t,t.onClick),t.btn_prev.off("click",t,t.onClick),Wg.openIndex=-1},i.update=function(){var e=this._vipDataModel.toc_gift;if(null!=e){var t=gR.ins.VIPLevel+1;10<t&&(t=10);for(var i=0;i<=10;i++)if(1==e.awards[i]){t=i;break}-1!=Wg.openIndex&&(t=Wg.openIndex),this.setCurVip(t),this.list_gift.selectedIndex=t,this.list_gift.scrollTo(t),this.onScrollEnd()}},i.updateState=function(e){var t=this;if(-1!=t._lvl){var i=t._vipDataModel.toc_gift;if(null!=i){var n=i.awards[t._lvl];1==n?(t.btn_buy.label=RP.n[1397],t.btn_buy.visible=!0,t.img_gold.visible=t.txt_gold.visible=!0,t.img_hasBuy.visible=!1):2==n?(10==t._lvl?t.btn_buy.label="已购买":t.btn_buy.visible=!1,t.img_gold.visible=t.txt_gold.visible=!1,t.img_hasBuy.visible=!0):(t.btn_buy.label="VIP"+t._lvl+"可购买",t.btn_buy.visible=!0,t.img_gold.visible=t.txt_gold.visible=!0,t.img_hasBuy.visible=!1),e==t._lvl&&2==n&&t.update()}}},i.setCurVip=function(e){var t=this,i=t._vipDataModel.toc_gift;if(null!=i){t._lvl=e,t.clip_lvl.value=e+"";var n=_o.getIndex(e);t.txt_desc.changeText(_o.MODEL.giftName(n)),t.txt_gold.changeText(_o.MODEL.giftCost(n)+"");var s=t.txt_gold.width+t.img_gold.width+6;t.img_gold.x=(t.width-s)/2-4,t.txt_gold.x=t.img_gold.x+t.img_gold.width+6,t.img_ad.skin=_r.getVipPath("giftAd"+e),t.img_gift.skin=_r.getVipPath("vip_lb_icon_"+e),t.img_dlb.x=t.img_ad.x+t.dlbPosArr[e],t.box_ad.centerX=0;var o=_o.MODEL.costGoodsRewardStr(n).split(";");if(t._effs){for(var a=0;a<t._effs.length;a++)t._effs[a].dispose();t._effs.length=0}for(var r=0;r<4;r++){var l;if(t._grids[r]?l=t._grids[r]:((l=new MF).x=t["img_grid"+r].x,l.y=t["img_grid"+r].y,t.box_c.addChild(l),(t._grids[r]=l).needEffect=!1),t._effInfo[t._lvl]){var c=t._effInfo[t._lvl];if(r<c.length){var u=mj.GetNew();u.loadEffect(c[r]),u.scale_X=1,u.scale_Y=1,u.renderInSelf=!0,u.setXY(58,57),l.addChild(u),t._effs.push(u)}}if(r<o.length){l.visible=!0;var d=o[r].split(","),h=parseInt(d[0]),_=parseInt(d[1]),f=yB.create(h,_);f.disAchi=!0,l.bindData=f,t["txt_name"+r].changeText(Bi.MODEL.name(f.cfgIdx)),t["txt_name"+r].color=ms.getByQuality(Bi.MODEL.colourId(f.cfgIdx))}else l.visible=!1,t["txt_name"+r].changeText("")}var p=i.awards[e];1==p?(t.btn_buy.label=RP.n[1397],t.btn_buy.visible=!0,t.img_gold.visible=t.txt_gold.visible=!0,t.img_hasBuy.visible=!1):2==p?(t.btn_buy.visible=!1,t.img_gold.visible=t.txt_gold.visible=!1,t.img_hasBuy.visible=!0):(t.btn_buy.label="VIP"+e+"可购买",t.btn_buy.visible=!0,t.img_gold.visible=t.txt_gold.visible=!0,t.img_hasBuy.visible=!1),t.list_gift.refresh()}},i.destroy=function(e){var t=this;if(void 0===e&&(e=!0),t._effInfo={},t._effs){for(var i=0;i<t._effs.length;i++)t._effs[i].dispose();t._effs.length=0}t.list_gift.dataSource=[],t.list_gift.array=[];for(var n=0;n<t._grids.length;n++)t._grids[n].clearIconTexture();t.destoryImage(t),ui.SubPanel.prototype.destroy.call(t,e)},t}(),H1=function(e){function t(){var e=this;e.vsc=null,e._curIdx=-1,t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.centerX=0,e.vsc=new SB(e),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onVscFilter,null,!1),e.vsc.registAll([{cls:UK,id:"1",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigVip"],["ConfigVip"]))}]),e.vsc.invalid()}b(t,"modules.vip.views.VipMV",jg);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.setTitle(_r.getAtlasSubPath("vip2/vip_title_vip.png"))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),modules.copy.others.NewPigData.ins.isReturnShaoZhu=!1},i.onVscFilter=function(e,t){if("1"!=e)return 0;var i=Wg.ins.toc_info;if(i)for(var n=0;n<=12;n++)if(i.awards[n]&&1==i.awards[n])return 3;return 0},i.onSubChanged=function(e,t){var i="";switch(e){case"1":i="vip2/vip_title_vip.png"}this.setTitle(_r.getAtlasSubPath(i))},i.updateVip=function(){this.vsc.selectedView instanceof modules.vip.views.VipInfoV&&this.vsc.selectedView.update(),this.vsc.invalid()},i.setOpenLvl=function(e){this.vsc.selectedView instanceof modules.vip.views.VipInfoV&&(this.vsc.selectedView.openLvl=e)},i.updateVipState=function(){this.vsc.selectedView instanceof modules.vip.views.VipInfoV&&this.vsc.selectedView.updateState(),this.vsc.invalid()},i.updateGiftTip=function(){this.vsc.invalid()},t.PRIVILEGE="1",t}(),V1=function(e){function t(){this._costBox=null,this._currentVO=null,this.enough=!1,this.wsIds=[],this._selector=null,this._roleIndex=-1,t.__super.call(this),this.init()}b(t,"modules.weaponsoul.views.WeaponSoulCorePanel",Jg);var i=t.prototype;return i.init=function(){var e=this;e._selector=new Nj,e.addChild(e._selector),e.txt_coreDescr.style.fontSize=24,e.list.itemRender=OY,e.list.hScrollBarSkin="",e.list.scrollBar.elasticBackTime=0,e.list.scrollBar.elasticDistance=50,e.list.mouseEnabled=!0,iu.optimizeList(e.list,OY),e.list.selectEnable=!0,e._costBox=new MF(45),e._costBox.isShowSmallIcon=!0,e._costBox.needGridBg=!1,e._costBox.toolTipEnabled=!0,e._costBox.goodsNum=1,e.itembox.addChild(e._costBox),e._costBox.bindData=yB.create(hB.ins.coreCostId),e.txt_noItem.text=RP.n[1399],e.btn_core.label="使 用"},i.setSelectItem=function(){this.list.selectedIndex=this.wsIds.indexOf(hB.ins.coreSelectId),this.selectHandler()},i.selectHandler=function(){for(var e=this,t=0;t<e.wsIds.length;t++){var i=e.list.getCell(t);i&&(i.selected=e.list.selectedIndex==t)}var n=e.list.selectedItem;if(e._currentVO=null,n){var s=e._currentVO=n,o=po.getIndex(s.skillId);e.txt_skill.changeText(po.MODEL.skillName(o)),e.skill_icon.skin=_r.getIconPath(s.effectIcon);var a=100*s.skillId+s.skilllv,r=fo.MODEL.desc(fo.getIndex(a));e.txt_descr.innerHTML="<br>"+Ql.createColor(r,"#a19980"),s.coreUsed?(e.btn_active.label="取 消",e.btn_active.showTip=!1):(e.btn_active.label="激 活",e.btn_active.showTip=hB.ins.coreUseWsRedPoint(e._roleIndex)),e.btn_active.visible=!0}else e.btn_active.visible=!1,e.txt_skill.text="",e.txt_descr.innerHTML="",e.skill_icon.skin=""},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t),t.setTitle(_r.getAtlasSubPath("weaponsoul/bh_text_qlzh.png")),t.btn_pre.on("click",t,t.onBtnHandler),t.btn_next.on("click",t,t.onBtnHandler),t.btn_core.on("click",t,t.onBtnHandler),t.btn_active.on("click",t,t.onBtnHandler),t._selector.selectIdx=hB.ins.actorSelectIndex,t._selector.on("select",t,t.onSelect),t.updateUI()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_pre.off("click",t,t.onBtnHandler),t.btn_next.off("click",t,t.onBtnHandler),t.btn_core.off("click",t,t.onBtnHandler),t.btn_active.off("click",t,t.onBtnHandler),t.list.array=null},i.onSelect=function(e){this.updateUI()},i.updateUI=function(){var e=this;e._roleIndex=e._selector.selectIdx+1;var t=hB.ins.getVoByRole(e._roleIndex),i=0;if(e.wsIds.length=0,t){i=t.useSoul;for(var n=po.count,s=[],o=0;o<n;o++){var a=po.MODEL.key(o),r=t.getWsVo(a);r&&r.actived&&(r.coreUsed=0<=t.useWeaponSouls.indexOf(a),s.push(r),e.wsIds.push(a))}e.list.array=s}e.img_noitem.visible=e.txt_noItem.visible=0==i,e.showBox.visible=0<e.list.array.length&&0<i,e.txt_coreDescr.innerHTML=RP.n[1400]+Ql.createColor(i+"","#23b11f")+RP.n[1401]+Ql.createColor(i+1+"","#23b11f")+RP.n[1402],e.upateCoreCost(),hB.ins.coreSelectId<0&&(e.list.selectedIndex=0),e.selectHandler(),e.btn_pre.visible=e.btn_next.visible=2<e.wsIds.length},i.upateCoreCost=function(){var e=hB.ins.coreCostId,t=0;e&&(t=TR.ins.getGoodsNum(e)),this.enough=0<t,0<t&&(this._costBox.bindData=yB.create(e,0)),this.txt_ownAmount.innerHTML=Ql.createColor(t+"/1",0<t?"#23b11f":"#ff2e24"),this.btn_core.showTip=hB.ins.coreUseItemRedPoint(this._roleIndex),this.updateActorRedTip()},i.updateActorRedTip=function(){for(var e,t=gR.ins.actorList.length,i=0;i<t;i++)e=gR.ins.actorList[i],hB.ins.getVoByRole(e.id),this._selector.setRedPtByIdx(e.id-1,hB.ins.coreTotalRedPoint(e.id))},i.onBtnHandler=function(e){var t=this;e.currentTarget==t.btn_pre?(t.btn_pre.mouseEnabled=!1,t.list.tweenTo(t.list.startIndex-2,200,ql.create(t,t.updateBtnShow))):e.currentTarget==t.btn_next?(t.btn_next.mouseEnabled=!1,t.list.tweenTo(t.list.startIndex+2,200,ql.create(t,t.updateBtnShow))):e.target==t.btn_core?t.enough&&(hB.ins.needUpdate=0,ev.ReqCore(t._selector.selectIdx+1)):e.target==t.btn_active&&t._currentVO&&ev.ReqCoreUseWs(t._selector.selectIdx+1,t._currentVO.wsid,t._currentVO.coreUsed?2:1)},i.updateBtnShow=function(){this.updateActorRedTip(),this.btn_pre.mouseEnabled=!0,this.btn_next.mouseEnabled=!0;var e=po.count;this.btn_next.visible=2<e-this.list.startIndex,this.btn_pre.visible=0!=this.list.startIndex},t}(),G1=function(e){function t(){var e=this;e.regL=null,e.vsc=null,e.bool=!1,e.ykIndex=0,t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.vsc=new SB(e),e.updateTab(),e.vsc.selectHandler=ql.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ql.create(e,e.onSubFilter,null,!1)}b(t,"modules.welfare.views.WelfareView",sv);var i=t.prototype;return i.updateTab=function(){var e=[_r.getLayoutsPath("welfare")],t=[_r.getLayoutsPath("seven")],i=(_r.getLayoutsPath("welfare_recharge"),[_r.getLayoutsPath("notice")]),n=[_r.getLayoutsPath("redpacket")],s=[_r.getAtlasSubPath("welfare_mix/yq_btn_qd.png"),_r.getAtlasSubPath("welfare_mix/yq_btn_gg.png")];this.regL=[{cls:GY,id:"1",wait:hN.wait(hN.waitConfig(["ConfigSignIn","ConfigSignInTimes"],["CSignIn","CSignInTimes"]),hN.waitRes(e))},{cls:vh,id:"8",wait:hN.wait(hN.waitConfig(["ConfigGongGao"],["ConfigGongGao"]),hN.waitRes(i))}],0<dr.iosCheck||(s.push(_r.getAtlasSubPath("welfare_mix/yq_btn_jhm.png")),this.regL.push({cls:VY,id:"2",isHideBg:!0})),$N.ins.isOpen()&&(s.splice(1,0,_r.getAtlasSubPath("welfare_mix/yq_btn_dljl.png")),this.regL.splice(1,0,{cls:f1,id:"4",isHideBg:!0,wait:hN.wait(hN.waitConfig(["ConfigActivityGift"],["CActivityGift"]),hN.waitRes(t))})),GR.getInstance().checkModuleOpen(34)&&fB.ins.isPacketOpen&&(s.splice(2,0,_r.getAtlasSubPath("welfare_mix/yq_btn_tjhb.png")),this.regL.splice(2,0,{cls:BY,id:"9",wait:hN.waitRes(n)})),this.navList=s,this.vsc.registAll(this.regL)},i.update=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},i.updateNav=function(){this.vsc.updateItemEnabled()},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.panelName="WelfareView"},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.onSubChanged=function(e){switch(e){case"1":this.setTitle(_r.getAtlasSubPath("welfare_mix/fl_text_qd.png"));break;case"2":this.setTitle(_r.getAtlasSubPath("welfare_mix/fl_text_jhm.png"));break;case"4":this.setTitle(_r.getAtlasSubPath("welfare_mix/dljl_text_title_dljl.png"));break;case"5":this.setTitle(_r.getAtlasSubPath("welfare_mix/accumulativerecharge_text_title.png"));break;case"8":this.setTitle(_r.getAtlasSubPath("welfare_mix/fl_text_gg.png"));break;case"9":this.setTitle(_r.getAtlasSubPath("welfare_mix/tjhb_text_tjhb.png"))}},i.onSubFilter=function(e){return"1"==e&&fB.ins.canSignAward()?3:"4"==e&&$N.ins.isAwardable()?3:"5"==e&&fB.ins.isDailyReturnAble?3:0},i.setFirstTap=function(e){var t=this;if(fB.ins.forRed){fB.ins.forRed=!1;for(var i=0,n=0;n<this.regL.length;n++)if(this.regL[n].id==e){i=n;break}this.callLater(function(){t.vsc.selectedIndex=i})}},i.openIndex=function(e){this.vsc.selectedIndex=e?e.id:0},t}(),U1=function(e){function t(){this._xinfa=1,this._list=null,this._array=[],this._canGetNum=0,this._cbPath=_r.getAtlasSubPath("basic_ui_3/ty_xz_dh.png"),this._cbVec=new Array,this._maskVec=new Array,t.__super.call(this)}b(t,"modules.xinfa.view.XinfaCJDisposeView",_v);var i=t.prototype;return i.initialize=function(){},i.onListRender=function(e,t){var i=this;if("click"==e.type){var n=i._list.getCell(t);n.selected=!n.selected;var s,o,a=i._list.getItem(t),r=hv.MODEL.decomposeGoods(a.id-1).split(",");if(n.selected)(o=new Ss).left=o.right=o.top=o.bottom=0,o.alpha=.5,o.graphics.drawRect(0,0,n.width,n.height,"#000000",null),(s=new Kl(i._cbPath)).centerX=0,s.centerY=0,n.contains(o)||(n.addChild(o),i._maskVec.push(o)),n.contains(s)||(n.addChild(s),i._cbVec.push(s)),i._canGetNum+=parseInt(r[1]);else n.destroyChildren(),i._canGetNum-=parseInt(r[1]),2==a.quality?i.check1.selected=!1:3==a.quality?i.check2.selected=!1:4==a.quality?i.check3.selected=!1:5==a.quality&&(i.check4.selected=!1);i.setCanGetNum()}},i.updateInfo=function(e,t){var i=this;void 0===t&&(t=!1),i._list||(i._list=new mc,i._list.itemRender=fq,i._list.height=400,i._list.repeatX=4,i._list.repeatY=4,i._list.spaceX=13,i._list.spaceY=13,i._list.vScrollBarSkin="",i._list.mouseHandler=ql.create(i,i.onListRender),i._list.pos(37,102),i.addChild(i._list)),i._canGetNum=0,e&&(i._xinfa=e.xinfa),0==i._array.length&&(i._array=pB.ins.getCanResoBooksByXAQ(i._xinfa)),i._list.array=i._array,i.txt_no.visible=i._list.array.length<1,i.clearMskSel(),t?i.clearSelected():G.timer.once(100,i,i.updateAddedBooks,[!t,2])},i.clearSelected=function(){for(var e=0;e<this._list.cells.length;e++){var t=this._list.getCell(e);t.selected=!1,t.destroyChildren()}this.getCanGetNum()},i.clearMskSel=function(){for(var e=0;e<this._maskVec.length;e++)this._maskVec[e].removeSelf();for(var t=this._maskVec.length=0;t<this._cbVec.length;t++)this._cbVec[t].removeSelf();this._cbVec.length=0},i.getCanGetNum=function(){for(var e=0;e<this._list.cells.length;e++){var t=this._list.getCell(e);if(t.selected){var i=pB.ins.getCIndexByGoodId(t.goodsId);if(i<0)continue;var n=hv.MODEL.decomposeGoods(i).split(",");this._canGetNum+=parseInt(n[1])}}0==this._array.length&&(this._canGetNum=0),this.setCanGetNum()},i.setCanGetNum=function(){var e=hv.MODEL.decomposeGoods(5).split(","),t=TR.ins.getGoodsNum(e[0]);this.labHave.changeText("x"+t),this.labGot.changeText("+"+this._canGetNum),this.labGot.x=this.labHave.x+12*(t.toString().length+1)+5},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_no.visible=!1,t.on("click",t,t.onClick),t.check1.selected=!0,t.check2.selected=!1,t.check3.selected=!1,t.check4.selected=!1;for(var i=1;i<=4;i++)t["check"+i].on("click",t,t.updateSelectedEquip,[i+1])},i.onRemove=function(e){var t=this;t.off("click",t,t.onClick);var i=0;for(i=1;i<=4;i++)t["check"+i].off("click",t,t.updateSelectedEquip);t._canGetNum=0,t._list.array=[],t._list=null,t.clearMskSel(),t._array=[],ui.SubPanel.prototype.onRemove.call(t,e)},i.onClick=function(e){switch(e.target){case this.btnClose:hN.ins.close("XINFA_BOOK_DISPOSE");break;case this.btnDispose:this.reqDisposeBook()}},i.reqDisposeBook=function(){for(var e=this,t=[],i=0;i<e._list.cells.length;i++){var n=e._list.getCell(i);if(n.selected)for(var s=0;s<e._array.length;s++)if(n.goodsId==e._array[s].goodsId){t.push(e._array[s].id),e._array.splice(s,1);break}}0!=t.length?(e._list.array=[],e.txt_no.visible=e._list.array.length<1,pB.ins.reqDisposeBook(t),e._array.length?G.timer.once(100,e,e.updateInfo,[null,!0]):G.timer.once(100,e,e.getCanGetNum)):zB.ins.showMsg(RP.n[1403],1)},i.updateSelectedEquip=function(e){this.updateAddedBooks(this["check"+(e-1)].selected,e)},i.updateAddedBooks=function(e,t){var i=0;for(i=0;i<this._list.cells.length;i++){var n,s,o=this._list.getCell(i),a=pB.ins.getCIndexByGoodId(o.goodsId);if(!(a<0))if(hv.MODEL.quality(a)==t)if(o.selected=e)(s=new Ss).left=s.right=s.top=s.bottom=0,s.alpha=.5,s.graphics.drawRect(0,0,o.width,o.height,"#000000",null),(n=new Kl(this._cbPath)).centerX=0,n.centerY=0,o.numChildren<2&&(o.addChild(s),this._maskVec.push(s)),o.numChildren<3&&(o.addChild(n),this._cbVec.push(n));else o.destroyChildren()}this._canGetNum=0,this.getCanGetNum()},t}(),F1=function(e){function t(){var e=this;e._curInfo=null,e._curAttrInfo=null,e._actorId=0,e._xinfa=0,e._showStarEff=!1,e._cindex=-1,e._model=null,e._sbox=null,e.effStar=null,e._lbox=null,e._imgs=new Array,t.__super.call(e)}b(t,"modules.xinfa.view.XinfaCJUpView",fv);var i=t.prototype;return i.updateInfo=function(e){var t=this;if(e instanceof protos.xinfa.toc_30165){t._showStarEff=!0;var i=e;t._xinfa=i.xinfa,t._curInfo={pos:i.pos,quality:i.quality,level:i.level,xinfa:i.xinfa}}else{var n=e.pos;t._actorId=e.actor,t._xinfa=e.xinfa,t._curInfo=pB.ins.getBookInfoByPos(n,t._actorId,t._xinfa)}t._curInfo&&t.updatePanel()},i.onAdd=function(e){this.on("click",this,this.onClick),ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){this.off("click",this,this.onClick),this.clearAll(),ui.SubPanel.prototype.onRemove.call(this,e)},i.onClick=function(e){switch(e.target){case this.btnReplace:this.equipOrReplaceIt();break;case this.btnUpStar:this.upLevelIt()}},i.equipOrReplaceIt=function(){for(var e=this,t=pB.ins.getBooksHaveByPos(e._curInfo.pos),i=!1,n=0;n<t.length;n++)if(t[n].quality==e._curInfo.quality){if(t[n].level>e._curInfo.level){i=!0,pB.ins.reqBooksUp(e._actorId,2,t[n].quality,e._curInfo.pos,e._xinfa);break}}else if(t[n].quality>e._curInfo.quality){i=!0,pB.ins.reqBooksUp(e._actorId,2,t[n].quality,e._curInfo.pos,e._xinfa);break}i||zB.ins.showMsg(RP.n[1404],1)},i.upLevelIt=function(){this._curInfo.level>=pB.ins.getXinfaBookStarNum(this._curInfo.quality)?zB.ins.showMsg("已满星",1):pB.ins.getBookCanUpStar(this._curInfo.pos,this._curInfo.quality)?pB.ins.reqBooksUp(this._actorId,1,this._curInfo.quality,this._curInfo.pos,this._xinfa):zB.ins.showMsg(RP.n[1405],1)},i.sortByQuality=function(e,t){return e.quality-t.quality},i.updatePanel=function(){var e=this;e.boxStar3.visible=e._curInfo.quality<=2,e.boxStar5.visible=2<e._curInfo.quality,e.imgBook.skin=_r.getAtlasSubPath("xinfa/xf_tx_wymj"+e._curInfo.pos+".png"),e.img_bg.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_4.png"),e._cindex=pB.ins.getCIndexByInfo(e._curInfo),-1==e._cindex?(e.fightNum.value=0,e.txtName.changeText(""),e.labName.changeText(""),e.imgUp.visible=e.imgRep.visible=!1):(e.setName(),e.setAttr(),e.setStar(),e.setRedPoint())},i.setModel=function(){var e=this,t="jm"+hv.MODEL.jmId(e._cindex);e._model||(e._model=mj.GetNew(),e._model.loadEffect(t),e._model.renderInSelf=!0,e._model.setXY(300,300),e._model.scale_X=1.6,e._model.scale_Y=1.6,e.addChild(e._model)),e._model&&e._model.loadEffect(t)},i.setStar=function(){var e;this._sbox=this._curInfo.quality<=2?this.boxStar3:this.boxStar5,this.clearStar(),e=_r.getAtlasSubPath("base_ui2/g_level_0_0.png");for(var t=0;t<this._curInfo.level;t++){var i=new Kl(e);this._sbox.addChild(i),i.y=0,i.x=52*t,this._imgs.push(i)}this.setEff()},i.clearStar=function(){if(this._imgs.length){for(var e=0;e<this._imgs.length;e++)this._imgs[e].removeSelf();this._imgs.length=0}},i.clearAll=function(){var e=this;e.clearStar(),e.clearStarEff(),e._lbox&&e._lbox.graphics.clear(),e.fightNum.value=0,e._model&&(e._model.dispose(),e._model=null),e._curInfo=null,e._curAttrInfo=null},i.setEff=function(){this._showStarEff&&0!=this._curInfo.level&&(this.clearStarEff(),this.effStar||(this.effStar=kB.createEffect("jm1217",52*(this._curInfo.level-1)+21,24,this._sbox)),this._showStarEff=!1)},i.clearStarEff=function(){this.effStar&&(this.effStar.parent&&this.effStar.parent.removeChild(this.effStar),this.effStar.dispose(),this.effStar=null)},i.setName=function(){var e=this,t=hv.MODEL.goodsId(e._cindex),i=Bi.getIndex(t),n=Bi.MODEL.name(i);e.txtName.changeText(n),e.labName.changeText(n),e.txtName.color=ms.getByQuality(e._curInfo.quality),e.labName.color=ms.getByQuality(e._curInfo.quality),e.boxConsume.visible=e._curInfo.level<pB.ins.getXinfaBookStarNum(e._curInfo.quality)},i.setAttr=function(){var e=this,t=0,i=aa.formatAttrToChineseByList(hv.MODEL.attrsForClient(e._cindex));for(e.fightNum.value=RR.getFight(JSON.parse(hv.MODEL.attrs(e._cindex)))+hv.MODEL.extrafight(e._cindex),e._lbox||(e._lbox=new dt,e._lbox.pos(70,550),e.addChild(e._lbox)),e._lbox.graphics.clear(),t=0;t<i.length;t++)i[t].addName==RP.n[1406]&&(i[t].addName=RP.n[1407]),e._lbox.graphics.fillText(i[t].addName+" ： "+i[t].val,0,37*t,"24px SimHei","#e0d6c1","left")},i.setRedPoint=function(){this.imgUp.visible=pB.ins.getBookCanUpStar(this._curInfo.pos,this._curInfo.quality)&&this._curInfo.level<pB.ins.getXinfaBookStarNum(this._curInfo.quality),this.imgRep.visible=this.getCanReplace()},i.getCanReplace=function(){for(var e=pB.ins.getBooksHaveByPos(this._curInfo.pos),t=0;t<e.length;t++)if(e[t].quality==this._curInfo.quality){if(e[t].level>this._curInfo.level)return!0}else if(e[t].quality>this._curInfo.quality)return!0;return!1},t}(),q1=function(e){function t(){this._sbox=null,this._lbox=null,this._imgs=new Array,t.__super.call(this)}b(t,"modules.xinfa.view.XinfaMijiShowPanel",gv);var i=t.prototype;return i.update=function(e){var i=this;if(e){var t=0,n=e,s=new MF;s.isClearUrl=!1,this.addChild(s),s.pos(50,90),s.bindData=n.goodsId,s.mouseEnabled=!1;var o=Bi.MODEL.name(n.cfgIdx);this.labNum.changeText(n.goodsNum+""),TR.ins.getGoodsDes(n.goodsId,ql.create(this,function(e,t){i.htmlDesc.innerHTML=t}));var a,r=pB.ins.getCIndexByGoodId(n.goodsId),l=hv.MODEL.quality(r),c=hv.MODEL.attrsForClient(r),u=hv.MODEL.level(r);for(this.labName.changeText(o),this.labName.color=ms.getByQuality(l),this.boxStar3.visible=l<=2,this.boxStar5.visible=2<l,l<2&&(l=2),this.img_bg.skin=_r.getAtlasSubPath("basic_ui_g/ty_tips_pz_"+l+".png"),this._sbox=l<=2?this.boxStar3:this.boxStar5,this.clearStar(),a=_r.getAtlasSubPath("base_ui2/g_level_0_0.png"),t=0;t<u;t++){var d=new Kl(a);this._sbox.addChild(d),d.y=0,d.x=52*t,this._imgs.push(d)}this.labQuality.changeText(ms.getByQualityName(l));var h=aa.formatAttrToChineseByList(c);this._lbox||(this._lbox=new dt,this._lbox.pos(50,430),this.addChild(this._lbox)),this._lbox.graphics.clear();var _=100;for(t=0;t<h.length;t++)h[t].addName==RP.n[1408]?(_=150,h[t].addName=RP.n[1409]):_=100,this._lbox.graphics.fillText(h[t].addName+" ： ",0,37*t,"24px SimHei","#90877b","left"),this._lbox.graphics.fillText(h[t].val,_,37*t,"24px SimHei","#01b527","left")}},i.clearStar=function(){if(this._imgs.length){for(var e=0;e<this._imgs.length;e++)this._imgs[e].removeSelf();this._imgs.length=0}},i.onRemove=function(e){this.clearStar(),ui.SubPanel.prototype.onRemove.call(this,e)},t}(),j1=function(e){function t(){var e=this;e._selector=null,e.cindex=0,e.isClick=!0,e._sbox=null,e._lbox=null,e._rbox=null,e.c_gid=0,e.c_gnum=0,e._xinfaList=null,e._curXinfa=0,e._isMaxLev=!1,e._isMaxStep=!1,e.curObj=null,e.GAP_Y=30,e._showStarEff=!1,e._updateByBtn=!1,e.effStar=null,e.effXinfa=null,e._model=null,e._isGray=!1,e._grids=new Array,t.__super.call(e),e.img_bg.skin=_r.getActImg()}b(t,"modules.xinfa.view.XinfaShowView",mv);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.clearAll=function(){this.effXinfa&&(this.effXinfa.dispose(),this.effXinfa=null),this.clearStarEff();for(var e=0;e<this._grids.length;e++)this._grids[e].removeSelf(),this._grids[e].clearIconTexture();this._grids.length=0,this._model=""},i.initialize=function(){this.img_full.centerX=0,this._selector=new Nj,this.addChild(this._selector)},i.updateByVSC=function(e){var t=this;if("boolean"==typeof e&&e&&t.setBtnState(),!e||e instanceof protos.xinfa.toc_30161||e instanceof protos.xinfa.toc_30163){for(var i=gR.ins.actorList.length,n=0;n<i;n++)t._selector.setRedPtByIdx(n,pB.ins.getXinfaRedFP(n+1));if(e instanceof protos.xinfa.toc_30163)t.curObj=e.result,t._showStarEff=!0;else{if(!pB._xinfaDataHash)return;if(!pB._xinfaDataHash.take(t._selector.selectIdx+1))return;t._xinfaList=pB._xinfaDataHash.take(t._selector.selectIdx+1).infos;for(var s=0;s<t._xinfaList.length;s++)-1!=pB.ins.getCurIndex(t._xinfaList[s].steps,t._xinfaList[s].level,t._xinfaList[s].xinfa)&&(t.curObj=t._xinfaList[s]);t._showStarEff=!1}t.curObj&&(t._curXinfa=t.curObj.xinfa,t._updateByBtn||(t.cindex=pB.ins.getCurIndex(t.curObj.steps,t.curObj.level,t.curObj.xinfa)),t._isMaxLev=pB.ins.getIsMaxLev(t.cindex),t._isMaxStep=pB.ins.getIsMaxStep(t.cindex)),t.hide(),t.btn_active.visible=!t._isMaxStep,t.img_red.visible=!1,t.setProgress(),t.setShowPanel(),t.setBookIcon()}},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.onAdd=function(e){var t=this;pB.ins.reqInfo(),ui.SubPanel.prototype.onAdd.call(t,e),t._selector.on("select",t,t.onRoleHandler),t.imgPage.on("click",t,t.onClickHandler),t.on("click",t,t.onClickHandler),t.labGetProp.on("click",t,t.onClickHandler),t.isClick=!0,t.img_full.visible=!1,t.img_red.visible=!1,t.imgCanUp.visible=!1,t.imgCoin.visible=!1},i.onRemove=function(e){var t=this;t._selector.off("select",t,t.onRoleHandler),t.labGetProp.off("click",t,t.onClickHandler),t.imgPage.off("click",t,t.onClickHandler),t.off("click",t,t.onClickHandler),t.clearAll(),ui.SubPanel.prototype.onRemove.call(t,e)},i.showStar=function(){this.setProgress()},i.hide=function(){this._sbox&&this._sbox.graphics.clear(),this._lbox&&this._lbox.graphics.clear(),this._rbox&&this._rbox.graphics.clear()},i.setProgress=function(){var e=this;e.clearStarEff(),e.btn_active.visible=!e._isMaxStep,e.sp.visible=!0;var t=mp.getChineseNum(e.curObj.steps);e.cp_level.value=t,e.img_bold.height=75+33*t.length,e.img_font.y=e.cp_level.y+33*t.length+15,e.fightNum.value=pB.ins.getFightNumByActor(e._selector.selectIdx+1),e.img_full.visible=e._isMaxStep,e.setBtnState(),e.showLevel(),e.showAttrs()},i.setShowPanel=function(){var e=this;e.btnLast.visible=0!=pv.MODEL.exId(e.cindex),e.btnNext.visible=0!=pv.MODEL.nextId(e.cindex);var t=pB.ins.getModelByBooks(e._selector.selectIdx+1,e._curXinfa),i=pB.ins.getXinfaIsGray(e._selector.selectIdx+1,e._curXinfa);if(e._model==t)return e._isGray?i||Pg.gray(e.effXinfa,i):i&&Pg.gray(e.effXinfa,i),void(e._isGray=i);e._model=t,e.effXinfa&&(e.effXinfa.dispose(),e.effXinfa=null),e.effXinfa=kB.createEffect(e._model,360,550,e),e._isGray=i,Pg.gray(e.effXinfa,e._isGray),e._updateByBtn=!1},i.setBookIcon=function(){var e=this,t=0,i=pB._xinfaDataHash.take(e._selector.selectIdx+1),n=i.infos;for(t=0;t<e._grids.length;t++)e._grids[t].removeSelf(),e._grids[t].clearIconTexture();for(t=e._grids.length=0;t<n.length;t++)n[t].xinfa==e._curXinfa&&(i=n[t]);for(n=i.books,t=0;t<n.length;t++){var s=pB.ins.getBookGoodIdByPQL(n[t].pos,n[t].quality,n[t].level);if(s){var o=new MF;o.mouseEnabled=!1,o.bindData=s,e["boxCJ"+n[t].pos].addChild(o),e._grids.push(o)}e["imgRPB"+n[t].pos].visible=pB.ins.getCanOperBookByPos(e._selector.selectIdx+1,n[t].pos,e._curXinfa)}},i.setBtnState=function(){var e=this;e.btn_active.disabled=!1;var t,i=JSON.parse(pv.MODEL.consumeption(e.cindex));e.c_gnum=parseInt(i[0].value.toString().split(":")[1]),e.imgPage.visible=!e._isMaxLev,e._isMaxLev?(e.boxConsume.visible=!1,e.btn_active.label="升  阶",e.imgCanUp.visible=!0):(e.boxConsume.visible=!0,e.c_gid=parseInt(i[0].value.toString().split(":")[0]),t=TR.ins.getGoodsNum(e.c_gid)<e.c_gnum?"#ff2e24":"#23b11f",e.txt_cost.visible=0!=e.c_gnum,e.txt_cost.innerHTML=Ql.createColor(TR.ins.getGoodsNum(e.c_gid)+"",t)+"/"+e.c_gnum,TR.ins.getGoodsNum(e.c_gid)<e.c_gnum?(e.btn_active.label=RP.n[1203],e.imgCanUp.visible=!1):(e.btn_active.label="修  炼",e.imgCanUp.visible=!0)),e._isMaxStep?(e.boxConsume.visible=!1,e.imgCanUp.visible=!1,e.labGetProp.visible=!1):e.labGetProp.visible=!e._isMaxLev},i.showAttrs=function(){var e=this,t=0,i=aa.formatAttrToChineseByList(pv.MODEL.attrsForClient(e.cindex));for(e._lbox||(e._lbox=new dt,e._lbox.pos(128,630),e.sp.addChild(e._lbox)),e._lbox.graphics.clear(),t=0;t<i.length;t++)i[t].addName==RP.n[1406]&&(i[t].addName=RP.n[1407]),e._lbox.graphics.fillText(i[t].addName+" ： "+i[t].val,0,e.GAP_Y*t,"24px SimHei","#e0d6c1","left");if(e._lbox.x=e._isMaxStep?282:128,e.img_arrow.visible=!e._isMaxStep,e._isMaxStep)e._rbox&&e._rbox.graphics.clear();else{var n=aa.formatAttrToChineseByList(pv.MODEL.attrsForClient(e.cindex+1));for(e._rbox||(e._rbox=new dt,e._rbox.pos(428,630),e.sp.addChild(e._rbox)),e._rbox.graphics.clear(),t=0;t<n.length;t++)n[t].addName==RP.n[1413]&&(n[t].addName=RP.n[1414]),e._rbox.graphics.fillText(n[t].addName+" ： "+n[t].val,0,e.GAP_Y*t,"24px SimHei","#23b11f","left")}},i.onRoleHandler=function(){this._selector.selectIdx+1!=pB.roleIndex&&(pB.roleIndex=this._selector.selectIdx+1,this.updateByVSC(null))},i.onClickHandler=function(e){var t=this;if(pB._xinfaDataHash){var i=-1;switch(e.target){case t.btn_active:if(!t._isMaxLev&&TR.ins.getGoodsNum(t.c_gid)<t.c_gnum)return void Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.c_gid});t.isClick=!1,pB.ins.reqUpgrade(t._selector.selectIdx+1,t._curXinfa);break;case t.btnAttrInfo:hN.ins.open("XINFA_ATTR_PANEL",{actor:t._selector.selectIdx+1});break;case t.btnDispose:hN.ins.open("XINFA_BOOK_DISPOSE",{xinfa:t._curXinfa});break;case t.btnLast:t.cindex=pv.MODEL.exId(t.cindex),t._updateByBtn=!0,t.updateByVSC(null);break;case t.btnNext:t.cindex=pv.MODEL.nextId(t.cindex),t._updateByBtn=!0,t.updateByVSC(null);break;case t.btnShowSkill:hN.ins.open("XINFA_SKILL_PANEL",{actor:t._selector.selectIdx+1,xinfa:t._curXinfa});break;case t.btnShowRule:QR.goToOpenHelpDes(3);break;case t.boxCJ1:i=1;break;case t.boxCJ2:i=2;break;case t.boxCJ3:i=3;break;case t.boxCJ4:i=4;break;case t.boxCJ5:i=5;break;case t.imgPage:var n=new yB;n.setGoodsId(311e3),n.goodsNum=TR.ins.getGoodsNum(311e3),VQ.instance.show(n)}if(-1!=i){var s=pB.ins.getBookInfoByPos(i,t._selector.selectIdx+1,t._curXinfa);if(!s)return;if(s.quality)hN.ins.open("XINFA_BOOK_UP",{pos:i,actor:t._selector.selectIdx+1,xinfa:t._curXinfa});else{var o=pB.ins.getBooksHaveByPos(i);if(o.length){o.sort(t.sortByQuality);var a=o[0].quality;pB.ins.reqBooksUp(t._selector.selectIdx+1,2,a,i,t._curXinfa)}else zB.ins.showMsg(RP.n[1415],1)}}e.currentTarget==t.labGetProp&&(t._isMaxLev?HN.ins.reqBuyCoin():Tu.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.c_gid}))}},i.sortByQuality=function(e,t){return t.quality-e.quality},i.showLevel=function(){var e=this;e.box_star.visible=!e._isMaxStep,e._sbox&&e._sbox.graphics.clear(),e._sbox||(e._sbox=new dt,e._sbox.pos(104,490),e.sp.addChild(e._sbox)),e._sbox.graphics.clear();var t,i;i=_r.getAtlasSubPath("base_ui2/g_level_0_0.png"),t=G.loader.getRes(i);for(var n=0;n<e.curObj.level;n++)e._sbox.graphics.drawTextures(t,[52*n-1,-4]);e.setStar()},i.setStar=function(){this._showStarEff&&0!=this.curObj.level&&(this.clearStarEff(),this.effStar||(this.effStar=kB.createEffect("jm1217",52*(this.curObj.level-1)+21,23,this.box_star)))},i.clearStarEff=function(){this.effStar&&(this.effStar.parent&&this.effStar.parent.removeChild(this.effStar),this.effStar.dispose(),this.effStar=null)},i.destroy=function(e){void 0===e&&(e=!0),pB.ins.destroyAll(),ui.SubPanel.prototype.destroy.call(this,e)},t._openZSLev=4,t._openDays=11,t}(),W1=function(e){function t(){this._Tqeff=null,this._TqeffId=null,this.fight=0,this.attrObj=null,this._tqIndex=0,t.__super.call(this),this.title=_r.getAtlasSubPath("yueka/fl_text_yk.png"),this.isHideBg=!0}b(t,"modules.yueka.views.MonthCardMV",rd);var i=t.prototype;return G.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.hdv_time.style.align="center",e.hdv_time.style.font="SimHei",e.hdv_time.style.fontFamily="SimHei",e.hdv_time.style.fontSize=24,e.hdv_time.style.color="#e0d6c1",e.hdv_des0.style.align="center",e.hdv_des0.style.font="SimHei",e.hdv_des0.style.fontFamily="SimHei",e.hdv_des0.style.fontSize=22,e.hdv_des0.style.color="#e6d80d",e.hdv_des0.innerHTML=RP.n[1416],e.hdv_des2.style.align="center",e.hdv_des2.style.font="SimHei",e.hdv_des2.style.fontFamily="SimHei",e.hdv_des2.style.fontSize=24,e.hdv_des2.style.color="#e0d6c1",e.hdv_des2.innerHTML=Ql.createColor(RP.n[1417]+3e3+"元宝","#e6d80d"),e.box_all.visible=e.box_tq.visible=e.box_yk.visible=e.img_tq_ylq.visible=e.img_yk_ylq.visible=!1,e.box_all_top.visible=e.box_tq_top.visible=e.box_yk_top.visible=!1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.parent.parent.addChild(t.box_top),t.on("click",t,t.onClick),t.btn_all_sale.on("click",t,t.onBuyAll),t.btn_yk_sale.on("click",t,t.onSale),t.btn_tq_sale.on("click",t,t.onBuy),ad.reqTwoCard(),t.layout.dragon_border.visible=!1,t.box_all.visible=t.box_all_top.visible=!0,t._Tqeff&&(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t._tqIndex=co.getIndex(666),t._TqeffId=co.MODEL.effect(t._tqIndex),t._TqeffId&&0<t._TqeffId.length?(null==t._Tqeff&&(t._Tqeff=mj.GetNew(),t._Tqeff.pos(355,350),t._Tqeff.loadEffect(t._TqeffId),t._Tqeff.renderInSelf=!0,t.box.addChild(t._Tqeff)),t._Tqeff.loadEffect(t._TqeffId)):(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t.box_select.x=9,t.updateTqTime(),t.showTime()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.box_top.removeSelf(),t.off("click",t,t.onClick),G.timer.clear(t,t.showTime),G.timer.clear(t,t.updateTqTime),t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null},i.destroy=function(e){void 0===e&&(e=!0),this.img_bg.dispose(),this.img_bg=null,ui.SubPanel.prototype.destroy.call(this,e)},i.onClick=function(e){e.target==this.btn_all?this.updatePanel(1):e.target==this.btn_yk?(this.updatePanel(2),ad.reqMonthCardInfo()):e.target==this.btn_tq&&(this.updatePanel(3),_g.reqTqMonthCard())},i.updatePanel=function(e){var t=this;switch(e){case 1:t.box_select.x=t.btn_all.x+1,t.box_all.visible=t.box_all_top.visible=!0,t.box_yk.visible=t.box_tq.visible=!1,t.box_tq_top.visible=t.box_yk_top.visible=!1,t._Tqeff&&(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t._tqIndex=co.getIndex(666),t._TqeffId=co.MODEL.effect(t._tqIndex),t._TqeffId&&0<t._TqeffId.length?(null==t._Tqeff&&(t._Tqeff=mj.GetNew(),t._Tqeff.pos(355,350),t._Tqeff.loadEffect(t._TqeffId),t._Tqeff.renderInSelf=!0,t.box.addChild(t._Tqeff)),t._Tqeff.loadEffect(t._TqeffId)):(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null);break;case 2:t.box_select.x=t.btn_yk.x+1,t.box_yk.visible=t.box_yk_top.visible=!0,t.box_all.visible=t.box_tq.visible=!1,t.box_all_top.visible=t.box_tq_top.visible=!1,t._Tqeff&&(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t.showTime(),G.timer.loop(1e3,t,t.showTime,null,!1);ld.ins.data22303;break;case 3:t.box_select.x=t.btn_tq.x+1,t.box_tq.visible=t.box_tq_top.visible=!0,t.box_all.visible=t.box_yk.visible=!1,t.box_all_top.visible=t.box_yk_top.visible=!1,t._Tqeff&&(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t._tqIndex=co.getIndex(666),t.attrObj=co.MODEL.attr(t._tqIndex),t.fight=RR.getFight(t.attrObj,null,0,!0,!1),t.num_fight.value=3*t.fight,t._TqeffId=co.MODEL.effect(t._tqIndex),t._TqeffId&&0<t._TqeffId.length?(null==t._Tqeff&&(t._Tqeff=mj.GetNew(),t._Tqeff.pos(355,305),t._Tqeff.loadEffect(t._TqeffId),t._Tqeff.renderInSelf=!0,t.box.addChild(t._Tqeff)),t._Tqeff.loadEffect(t._TqeffId)):(t._Tqeff&&t._Tqeff.dispose(),t._Tqeff=null,t._TqeffId=null),t.updateTqTime(),G.timer.loop(1e3,t,t.updateTqTime,null,!1)}},i.onBuyAll=function(){this.updatePanel(1),EB.pay(4,13)},i.onSale=function(){this.updatePanel(2);var e=ld.ins.data22303;e&&0<e.dayLeft?ad.reqGetAward():EB.pay(2,11)},i.onBuy=function(e){this.updatePanel(3);var t=gR.ins.lv,i=hg.ins.datas22352;i&&0<i.leftTime?_g.reqReceive():20<t?EB.pay(4,12):zB.ins.showMsg(RP.n[1418],1)},i.updateTqTime=function(){var e=hg.ins.getLeftTime();e<=0?(G.timer.clear(this,this.updateTqTime),this.txt_tq_time.visible=!1):(this.txt_tq_time.visible=!0,this.txt_tq_time.changeText("剩余"+this.getTimeStr(e)+"天"))},i.update=function(){this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!1);var e=ld.ins.data22303;this.hdv_des2.visible=e.hadBuyTime<=0},i.showTime=function(){var e=ld.ins.getLeftTimes();e<=0?G.timer.clear(this,this.showTime):this.hdv_time.innerHTML="剩余"+this.getTimeStr(e)+"天"},i.getTimeStr=function(e){return Math.floor(e/86400).toString()},i.updateBtnLabel=function(e){var t=this,i=0,n=0;if(e instanceof protos.yueka.toc_22303){var s=ld.ins.getLeftTimes(),o=ld.ins.getReceiveTimes();s<=0?(n=Ln.getIndex(11),i=HN.ins.getShowMoney(n),t.btn_yk_sale.label="￥"+i):0==o?(t.btn_yk_sale.label="领取",t.btn_yk_sale.visible=!0,t.img_yk_ylq.visible=!1,t.btn_yk_sale.showTip=!0):(t.btn_yk_sale.visible=!1,t.img_yk_ylq.visible=!0,t.btn_yk_sale.showTip=!1)}else if(e instanceof protos.tqyueka.toc_22352){var a=hg.ins.datas22352;hg.ins.getLeftTime()<=0?(n=Ln.getIndex(12),i=HN.ins.getShowMoney(n),t.btn_tq_sale.label="￥"+i):0<a.receiveTime?(t.btn_tq_sale.visible=!1,t.img_tq_ylq.visible=!0,t.btn_tq_sale.showTip=!1):(t.btn_tq_sale.visible=!0,t.img_tq_ylq.visible=!1,t.btn_tq_sale.label="领取",t.btn_tq_sale.showTip=!0)}else if(e instanceof protos.yueka.toc_22363){var r=e,l=r.state_ykBtn,c=r.state_tqBtn;switch(n=Ln.getIndex(13),i=HN.ins.getShowMoney(n),t.btn_all_sale.label="￥"+i,l){case 0:t.btn_yk_sale.visible=!0,t.img_yk_ylq.visible=!1,t.btn_yk_sale.label="领取",t.btn_yk_sale.showTip=!0;break;case 1:t.btn_yk_sale.visible=!1,t.img_yk_ylq.visible=!0,t.btn_yk_sale.showTip=!1;break;case 2:n=Ln.getIndex(11),i=HN.ins.getShowMoney(n),t.btn_yk_sale.label="￥"+i}switch(c){case 0:t.btn_tq_sale.visible=!0,t.img_tq_ylq.visible=!1,t.btn_tq_sale.label="领取",t.btn_tq_sale.showTip=!0;break;case 1:t.btn_tq_sale.visible=!1,t.img_tq_ylq.visible=!0,t.btn_tq_sale.showTip=!1;break;case 2:n=Ln.getIndex(12),i=HN.ins.getShowMoney(n),t.btn_tq_sale.label="￥"+i}}},i.hideByVSC=function(e,t){},i.showByVSC=function(e,t){},i.updateByVSC=function(e){},t.CARD_ID=11,t.TEQUAN_ID=12,t.MOOTH_ALL_ID=13,t}(),Y1=function(e){function t(){this.btn=null,this._type=0,t.__super.call(this),this.btn=new vt,this.btn.pos(220,138),this.btn.stateNum=2,this.btn.mouseEnabled=!1,this.addChild(this.btn)}b(t,"modules.yzbqc.view.YzbqcTipsPanel",Vv);var i=t.prototype;return i.update=function(e){switch(e){case 1:var t=No.getIndex(kt,{iconName:"btnYzbq"});this.btn.skin=_r.getAtlasSubPath("mainicons_mix/"+kt.MODEL.icon(t)+".png"),this.txt_name.innerHTML=RP.n[1419];break;case 2:t=No.getIndex(kt,{iconName:"btnGcz"}),this.btn.skin=_r.getAtlasSubPath("mainicons_mix/"+kt.MODEL.icon(t)+".png"),this.txt_name.innerHTML=RP.n[1420]}this._type=e},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this.show()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){if(e.target==this.btnClose)this.hide(),gB.ins.pushTips=!1;else if(e.target==this.btnGo){if(ZN.isEnabledChangeScene())switch(this._type){case 1:ZN.goTarget(1,"100211");break;case 2:hN.ins.open("GUILD_MNG_MAINVIEW",{_subIndex_:0})}this.hide()}},i.show=function(){this.alpha=0,Og.clearAll(this),Og.to(this,{alpha:1},150,pa.backOut)},i.hide=function(e){void 0===e&&(e=!1),Og.clearAll(this),Og.to(this,{alpha:0},150,null,ql.create(this,this.onHideComplete))},i.onHideComplete=function(){hN.ins._closePanelForce(this)},t}(),z1=function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0,this.mouseEnabled=!0}b(t,"modules.yzbqc.view.YzbqcRankMV",FY);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.yzbqc_awards.visible=!1,t.yzbqc_rank.visible=!0,t.btn_rank.selected=!0,t.btn_rank.on("click",t,t.onClick),t.btn_close.on("click",t,t.onClick),t.btn_award.on("click",t,t.onClick)},i.update=function(e){"23110"==e.actionOrder&&this.yzbqc_rank.show()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_rank.off("click",t,t.onClick),t.btn_close.off("click",t,t.onClick),t.btn_award.off("click",t,t.onClick)},i.onClick=function(e){var t=this;e.target==t.btn_award?(t.btn_rank.selected=!1,t.btn_award.selected=!0,t.yzbqc_awards.showInfo(),t.yzbqc_awards.visible=!0,t.yzbqc_rank.visible=!1):e.target==t.btn_rank?(t.btn_rank.selected=!0,t.btn_award.selected=!1,t.yzbqc_awards.visible=!1,t.yzbqc_rank.visible=!0,t.yzbqc_rank.show()):e.target==t.btn_close&&hN.ins.isOpen("YZBQC_RANK")&&hN.ins.close("YZBQC_RANK")},t}(),X1=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.gongce.ActivityGongceLoginView",l);var i=t.prototype;return i.initialize=function(){this.list.itemRender=cz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();this.actInfo.position.split(",")}},i.update=function(){this.updateList();var e,t=this.actInfo.gifts[0];e=t.owerActivity==QP.A_ID_1057?aB.isActiveSoul?QP.getSoluLevel(t.currentNum):Ql.createColor("未激活","#ff2e24"):20==t.type?0<gR.ins.zsLv?gR.ins.zsLv+"转"+gR.ins.lv+"级":gR.ins.lv+"级":1==t.type?gR.ins.zsLv+"转"+gR.ins.lv+"级":100==t.type?t.loginDay+"":t.currentNum+"",this.txt_my.innerHTML=RP.n[1421]+"："+Ql.createColor(e,"#23b11f")},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(QP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},t}(),Q1=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuAthleticsView",c);var i=t.prototype;return i.initialize=function(){this.list.itemRender=cz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(this,e),this.btn_link.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.btn_link.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();var e=this.actInfo.position.split(",");e[0]&&(this.btn_link.label=e[0])}},i.update=function(){this.updateList();var e,t=this.actInfo.gifts[0];e=t.owerActivity==QP.A_ID_1057?aB.isActiveSoul?QP.getSoluLevel(t.currentNum):Ql.createColor("未激活","#ff2e24"):20==t.type?0<gR.ins.zsLv?gR.ins.zsLv+"转"+gR.ins.lv+"级":gR.ins.lv+"级":1==t.type?gR.ins.zsLv+"转"+gR.ins.lv+"级":t.currentNum+"",this.txt_my.innerHTML="我的"+St.MODEL.content(St.getIndex(t.giftId))+"："+Ql.createColor(e,"#23b11f")},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(QP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.onClickHandler=function(e){if(this.actInfo){var t=this.actInfo.position.split(",");t&&1<t.length&&t[1]&&QP.goToLink(t[1])}},t}(),J1=function(e){function i(){var e=this;e._$10_acitivityId=null,e._currentGiftVo=null,e._grids=null,e._effect=null,e._effArr=null,e.g_items=null,e.GRAP_X=145,e.GRAP_Y=146,e._endTime=-1,e.lastTime=0,i.__super.call(e),e._grids=new wj(3,2,116,40,75,!0,null,100),e._grids.isCenter=!0,e._grids.pos(360,397),e._grids.height+=40,e._grids.vScrollBarSkin="",e._grids.vScrollBar.elasticDistance=0;var t=e.btn_get.parent.parent.getChildIndex(e.btn_get.parent);e.btn_get.parent.parent.addChildAt(e._grids,t-1)}b(i,"modules.activity.views.hefu.ActivityHeFuChargeGiftView",u);var t=i.prototype;return t.onAdd=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(this,e),this.txt_time.height=30,this.txt_time.mouseThrough=!0,this.btn_get.on("click",this,this.onBtnGoClicked)},t.onRemove=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(this,e),this.actInfo=null,G.timer.clear(this,this.showTime),this.btn_get.off("click",this,this.onBtnGoClicked)},t.destroy=function(e){if(void 0===e&&(e=!0),this._effect&&(this._effect.dispose(),this._effect=null),this._effArr){for(var t=this._effArr.length,i=0;i<t;i++){this._effArr[i].dispose()}this._effArr=null}modules.activity.views.hefu.ActivityHeFuBaseView.prototype.destroy.call(this,e)},t.showByVSC=function(e,t){this.updateByVSC(t)},t.updateByVSC=function(e){this._$10_acitivityId=e,WB.getActivityData(this._$10_acitivityId,ql.create(this,this.onReqBack))},t.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this._$10_acitivityId),this.actInfo&&(this.initInfo(),this.resetrShow())},t.initInfo=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e._$10_acitivityId),null==e.actInfo)return e.btn_get.gray=!0,e.btn_get.mouseEnabled=!1,void(e.txt_time.innerHTML="已结束");e.setTime();for(var t,i=e.actInfo.gifts,n=0;n<e.actInfo.gifts.length;n++)if(2!=(t=e.actInfo.gifts[n]).status){e._currentGiftVo=t;break}switch(null==e._currentGiftVo&&(e._currentGiftVo=i[i.length-1],e.btn_get.gray=!0,e.btn_get.mouseEnabled=!1),e.btn_get.showTip=!1,e.btn_get.mouseEnabled=!1,e._currentGiftVo.status){case 0:e.btn_get.label=RP.n[1422],e.btn_get.mouseEnabled=!0,e.btn_get.showTip=!1;break;case 1:e.btn_get.label="可领取",e.btn_get.mouseEnabled=!0,e.btn_get.showTip=!0;break;case 2:e.btn_get.label="已领取",e.btn_get.showTip=!1,e.btn_get.gray=!0;break;default:e.btn_get.label="已领取",e.btn_get.gray=!0,e.btn_get.showTip=!1}e._grids.gridDatas=e._currentGiftVo.rewardGoods,e.setBG()},t.setTime=function(){null!=this.actInfo&&(this.lastTime=this.actInfo.endTime-dr.serverTimeSec,this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!0))},t.showTime=function(){this.lastTime<=0?G.timer.clear(this,this.showTime):(this.lastTime--,this.txt_time.innerHTML=RP.n[1423]+Ql.createColor(Jp.getSTRDHMS(this.lastTime),"#23b11f"))},t.setBG=function(){var e=It.getIndex(this._$10_acitivityId),t=It.MODEL.bg(e),i=0;for(i=1;i<5;i++)this["bg_"+i].skin=_r.getOsNewPath("bg/"+t+i,".jpg");e=St.getIndex(this._currentGiftVo.giftId);var n=parseInt(St.MODEL.targetParam1(e));this.num.value=n+"";for(var s=1;s<4;s++)this["hg"+s+"_1"].width=320,this["hg"+s+"_1"].skin=_r.getLayoutsImagePath("activity/cqqd_czhl_gb.png")},t.onBtnGoClicked=function(e){if(this._currentGiftVo)switch(this._currentGiftVo.status){case 2:case 0:EB.showCharge&&(HN.ins.toc_recharge&&2!=HN.ins.toc_recharge.canGet?hN.ins.open("FIRST_RECHARGE",null):hN.ins.open("RECHARGE_VIEW",null,0));break;case 1:WB.getGift(this._currentGiftVo.giftId,ql.create(this,this.onRefresh,[this._currentGiftVo.giftId]))}},t.onRefresh=function(e){var t=mB.getInStance().getActivityData(this._$10_acitivityId);if(t){var i=t.getGift(e);i&&(this._currentGiftVo=i,this.initInfo())}},i}(),Z1=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuLoginView",v);var i=t.prototype;return i.initialize=function(){this.list.itemRender=cz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();this.actInfo.position.split(",")}},i.update=function(){var e,t;(this.updateList(),this.actInfo.gifts&&0<this.actInfo.gifts.length&&(e=this.actInfo.gifts[0]),e)&&(t=e.owerActivity==QP.A_ID_1057?aB.isActiveSoul?QP.getSoluLevel(e.currentNum):Ql.createColor("未激活","#ff2e24"):20==e.type?0<gR.ins.zsLv?gR.ins.zsLv+"转"+gR.ins.lv+"级":gR.ins.lv+"级":1==e.type?gR.ins.zsLv+"转"+gR.ins.lv+"级":e.currentNum+"",this.txt_my.innerHTML=RP.n[1424]+"："+Ql.createColor(t,"#23b11f"))},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(QP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},t}(),K1=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuRankNewView",C);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.listInfo.vScrollBarSkin="",this.listInfo.itemRender=_z,this.listInfo.repeatX=1,this.listInfo.repeatY=4,this.listInfo.spaceY=12,this.btn_rank.x=227,this.btn_link.visible=!1},i.onAdd=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(this,e),this.btn_rank.on("click",this,this.onClickHandler),this.btn_link.on("click",this,this.onClickHandler)},i.onRemove=function(e){G.timer.clear(this,this.initShow),this.btn_rank.off("click",this,this.onClickHandler),this.btn_link.off("click",this,this.onClickHandler),modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();var e=this.actInfo.position.split(",");e&&0<e.length&&(this.btn_link.label=e[0])}},i.update=function(){HP.loadConfig(["ConfigActivityRank"],["CActivityRank"],ql.create(this,this.initShow))},i.initShow=function(){this.setMyInfo(),this.setRankInfo(),this.updateBtnShow()},i.setMyInfo=function(){var e,t=this;null!=t.actInfo&&(0<t.actInfo.myRank?t.txt_rank.innerHTML=RP.n[1425]+Ql.createColor(t.actInfo.myRank+"","#e0d6c1"):t.txt_rank.innerHTML=RP.n[1426]+Ql.createColor("未上榜","#e0d6c1"),e=1==t.actInfo.myRankType?0==t.actInfo.rankValue?t.actInfo.rankLevel+"级":t.actInfo.rankValue+"转"+t.actInfo.rankLevel+"级":t.actInfo.activityId==JP.A_ID_1053?aB.isActiveSoul?JP.getSoluLevel(t.actInfo.rankValue):Ql.createColor("未激活","#ff2e24"):t.actInfo.rankValue+JP.getWordsByRtype(t.actInfo.type),t.txt_total.innerHTML="我的"+t.actInfo.rankLevelStr+":"+Ql.createColor(e,"#e0d6c1"))},i.setRankInfo=function(){if(this.actInfo){var e,t=JP.getListById(this.actInfo.activityId),i=[];if(t)for(var n=0;n<t.length;n++){var s=St.getIndex(t[n].giftId),o=St.MODEL.targetParam1(s).split(",");if(o&&!(o.length<1)){for(var a=[],r=0;r<o.length&&!(n==t.length-1&&0<r);r++)a.push(this.actInfo.rank[parseInt(o[r])-1]);e={rankInfo:a,giftInfo:t[n],rank:n+1,valueName:this.actInfo.rankLevelStr},i.push(e)}}this.listInfo.array=i}},i.updateBtnShow=function(){this.actInfo&&(this.btn_rank.x=227)},i.onClickHandler=function(e){if(this.actInfo)switch(e.currentTarget){case this.btn_rank:hN.ins.open("OS_RANK_VIEW",this.actInfo);break;case this.btn_link:var t=this.actInfo.position.split(",");t&&1<t.length&&t[1]&&(JP.goToLink(t[1]),QP.ins.isClickedBack=!0)}},t}(),$1=function(e){function t(){this.gvo=null,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.hefu.ActivityHeFuShaChengView",m);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(this,e),this.btn_join.on("click",this,this.onClickHandler)},i.onRemove=function(e){modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.gvo=null,this.btn_join.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),this.img_bg&&this.img_bg.skin&&""!=this.img_bg.skin&&G.loader.clearRes(this.img_bg.skin),modules.activity.views.hefu.ActivityHeFuBaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();for(var e=0;e<3;e++)this["g_"+e]}},i.update=function(){var e=this;if(e.actInfo.gifts&&!(e.actInfo.gifts.length<=0)&&(e.gvo=e.actInfo.gifts[0],e.gvo)){e.btn_join.visible=2!=e.gvo.status,e.img_got.visible=!e.btn_join.visible;var t=St.getIndex(e.gvo.giftId);e.font_power.value=St.MODEL.targetParam1(t).split(".")[0],e.btn_join.visible&&(0==e.gvo.status?e.btn_join.label=RP.n[1427]:(e.btn_join.label=RP.n[1428],e.btn_join.showTip=1==e.gvo.status)),e.setAwards()}},i.setAwards=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=850,e._gridsList.x=45,e._gridsList._spaceX=35,e._gridsList.size(666,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)),e._gridsList._gridH=e._gridsList._gridW=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.setGoodsItems(e.gvo.rewardGoods,1),e._gridsList.x=(e.width-e._gridsList.contentWidth)/2},i.onClickHandler=function(e){if(this.gvo)if(0==this.gvo.status){var t=parseInt($e.MODEL.value($e.getIndex(14)));if(gR.ins.lv<t)return void zB.ins.showMsg(t+RP.n[1429],1);JP.closeAosPanel(),vN.ins.joinGuild?hN.ins.open("GUILD_MNG_MAINVIEW",{_subIndex_:3}):hN.ins.open("GUILD_LIST_VIEW")}else WB.getGift(this.gvo.giftId,ql.create(this,this.update))},t}(),e2=function(e){function t(){this._datas=null,this.level=0,this.rechargeArr=null,this.rechargeId=0,this.investLevel=0,this.statusArr1=null,this.statusArr2=null,t.__super.call(this),this.initUI()}b(t,"modules.activity.views.invest.InvestMainView",CI);var i=t.prototype;return i.initUI=function(){this.list.itemRender=gz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.list.scrollBar.on("change",t,t.onScrollChanged),t.box_0.on("click",t,t.onClick),t.box_1.on("click",t,t.onClick),t.btn_buy.on("click",t,t.onClick),t.btn_help.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.list.scrollBar.off("change",t,t.onScrollChanged),t.box_1.off("click",t,t.onClick),t.box_0.off("click",t,t.onClick),t.btn_buy.off("click",t,t.onClick),t.btn_help.off("click",t,t.onClick)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.hideByVSC=function(){},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack)),Tu.sendToModule("UPDATE_BARGAIN_PEDPT",["modules.activity.ActivityModule"]),this.c_sp_2.visible=this.toptitle1.visible=this.toptitle2.visible=this.c_left.visible=this.c_right.visible=!1},i.update=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack1))},i.onReqBack1=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&this.updatePanel()},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.resetrShow(),this.updateView())},i.updateView=function(){var e=this;e._datas=[],e.rechargeArr=[],e.statusArr1=[],e.statusArr2=[];for(var t=e.actInfo.gifts,i=0;i<t.length;i++){var n=t[i].status,s=t[i].giftId,o=St.getIndex(s);if(parseInt(St.MODEL.targetParam1(o))==e.level){var a={status:n,giftId:s};e._datas.push(a),e.statusArr1.push(n)}else e.statusArr2.push(n);0<e.investLevel||(e.investLevel=t[i].levelCount)}e._datas=e._datas.sort(JP.sortArray),e.list.dataSource=e._datas,e.updateBtnRed();var r=It.getIndex(e.acitivityId),l=It.MODEL.RechargeId(r);1<l.length&&(e.rechargeArr=l.split(",")),e.rechargeId=parseInt(e.rechargeArr[0]),e.autoSelect(e.investLevel),e.updateBuyBtn(),e.updateIcon()},i.updateIcon=function(){for(var e=ns.getIndex(this.acitivityId),t=ns.MODEL.icon(e),i=0;i<t.length;i++)this["img_"+i].skin=_r.getCztzPath("icgoods"+t[i]);for(var n=ns.MODEL.timsIcon(e),s=0;s<n.length;s++)this["num_"+s].value=n[s],9<n[s]?this["num_"+s].pos(1,67):this["num_"+s].pos(18,59);for(var o=ns.MODEL.levelText(e).split(","),a=0;a<o.length;a++)this["txt_level"+a].skin=_r.getCztzPath(o[a])},i.updatePanel=function(){var e=this;e._datas=[],e.statusArr1=[],e.statusArr2=[];for(var t=e.actInfo.gifts,i=0;i<t.length;i++){var n=t[i].status,s=t[i].giftId,o=St.getIndex(s);if(parseInt(St.MODEL.targetParam1(o))==e.level){var a={status:n,giftId:s};e._datas.push(a),e.statusArr1.push(n)}else e.statusArr2.push(n);0<e.investLevel||(e.investLevel=t[i].levelCount)}e._datas=e._datas.sort(JP.sortArray),e.list.dataSource=e._datas,e.updateBuyBtn(),e.updateBtnRed()},i.updateBuyBtn=function(){var e=this;0<e.investLevel?e.investLevel!=e.level?(e.btn_buy.label="投资"+e.level+"元",e.btn_buy.disabled=!1):(e.btn_buy.label="已投资",e.btn_buy.disabled=!0):(e.btn_buy.label="投资"+e.level+"元",e.btn_buy.disabled=!1)},i.autoSelect=function(e){var t=this;e<=0?(t.level=168,t.img_xz_0.visible=!1,t.img_xz_1.visible=!0,t.rechargeId=parseInt(t.rechargeArr[1]),t.updatePanel()):68==e?(t.level=68,t.img_xz_0.visible=!0,t.img_xz_1.visible=!1,t.rechargeId=parseInt(t.rechargeArr[0]),t.updatePanel()):168==e&&(t.level=168,t.img_xz_0.visible=!1,t.img_xz_1.visible=!0,t.rechargeId=parseInt(t.rechargeArr[1]),t.updatePanel())},i.updateBtnRed=function(){var e=this;68==e.level?(e.img_red_0.visible=-1!=e.statusArr1.indexOf(1),e.img_red_1.visible=-1!=e.statusArr2.indexOf(1)):168==e.level&&(e.img_red_0.visible=-1!=e.statusArr2.indexOf(1),e.img_red_1.visible=-1!=e.statusArr1.indexOf(1))},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_m.visible=!1:this.img_m.visible=!0},i.onClick=function(e){var t=this;switch(e.currentTarget){case t.box_0:t.level=68,t.img_xz_0.visible=!0,t.img_xz_1.visible=!1,t.rechargeId=parseInt(t.rechargeArr[0]),t.updatePanel();break;case t.box_1:t.level=168,t.img_xz_0.visible=!1,t.img_xz_1.visible=!0,t.rechargeId=parseInt(t.rechargeArr[1]),t.updatePanel();break;case t.btn_buy:if(0<t.investLevel){if(t.investLevel!=t.level)return void zB.ins.showById(4961,1)}else EB.pay(6,t.rechargeId);break;case t.btn_help:QR.goToOpenHelpDes(30)}},t}(),t2=function(e){function t(){var e=this;e._gbox=null,e._grids=null,e.g_items=null,e.GRAP_X=145,e.GRAP_Y=146,e.GIFTARR=null,e.gvo=null,e.arrowView=null,e._currentSelectGiftID=-1,e._circleMask=null,e._currentSelectedIndex=-1,e._isFree=!1,e._needGold=0,e._tryCost=0,e.redScroll=null,e._isInit=!1,t.__super.call(e),e._gbox||(e._gbox=new dt,e._gbox.pos(0,420),e.box_c.addChild(e._gbox)),e.txt_cost.height=30,e.txt_cost.mouseThrough=!0}b(t,"modules.activity.views.hefu.ActivityHeFuVipView",I);var i=t.prototype;return i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[],e._gbox&&e._gbox.graphics.clear();for(var t,i=zi.getIndex(e._currentSelectGiftID),n=zi.MODEL.goodsReward(i).split(";"),s=0;s<n.length;s++){var o=new MF,a=n[s].split(",");t=yB.create(parseInt(a[0]),parseInt(a[1])),o.bindData=t,8<=n.length?o.pos(81+s%4*e.GRAP_X,Math.floor(s/4)*e.GRAP_Y):o.pos((0<Math.floor(s/3)?220:138)+s%3*164,Math.floor(s/3)*e.GRAP_Y),e.g_items.push(o),e._gbox.addChild(o);var r=Bi.MODEL.simpleName(Bi.getIndex(t.goodsId)),l=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(t.goodsId)));e._gbox.graphics.fillText(r,o.x+57,o.y+119,"20px SimHei",l,"center")}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onAdd=function(e){var t=this;modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onAdd.call(t,e),t.btn_buy.on("click",t,t.onBuyBtnClicked),t.btn_try.on("click",t,t.onTryBtnClicked),t.btn_prev.on("click",t,t.onClick),t.btn_next.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;t.btn_buy.off("click",t,t.onBuyBtnClicked),t.btn_try.off("click",t,t.onTryBtnClicked),modules.activity.views.hefu.ActivityHeFuBaseView.prototype.onRemove.call(t,e),t._currentSelectedIndex=-1,t.actInfo=null,t._isInit=!1,t.redScroll=null,t.gvo=null,t.arrowView&&(t.arrowView.closeThisPanel(),t.arrowView=null)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),modules.activity.views.hefu.ActivityHeFuBaseView.prototype.destroy.call(this,e)},i.initInfo=function(){var e=this;e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&(e.acitivityId=e.actInfo.activityId,e.actInfo.gifts&&(e.list_gift.array=e.actInfo.gifts,e.list_gift.refresh(),e._currentSelectedIndex<0?e.onSelect(e._currentSelectedIndex):(e.list_gift.selectedIndex=e._currentSelectedIndex,e.list_gift.scrollTo(e._currentSelectedIndex))),e._isInit||(e._isInit=!0,WB.requestHeFuVip(e._currentSelectGiftID,ql.create(e,e.refresh))),e.list_gift.scrollTo(e._currentSelectedIndex))},i.initUI=function(){var e=this;e.list_gift.hScrollBarSkin="",e.list_gift.scrollBar.elasticBackTime=300,e.list_gift.scrollBar.elasticDistance=100,e.list_gift.scrollBar.on("end",e,e.onScrollEnd),e.list_gift.renderHandler=new ql(e,e.onListRender),e.list_gift.selectHandler=new ql(e,e.onSelect),e.list_gift.selectEnable=!0},i.onClick=function(e){var t=this;if("next"==e.target.name){var i=t.list_gift.startIndex+4;i>=t.list_gift.length&&(i=t.list_gift.length-1),t.list_gift.startIndex!=i&&t.list_gift.tweenTo(i,150*(i-t.list_gift.startIndex),ql.create(t,t.onScrollEnd))}else"prev"==e.target.name&&((i=t.list_gift.startIndex-4)<0&&(i=0),t.list_gift.startIndex!=i&&t.list_gift.tweenTo(i,150*(t.list_gift.startIndex-i),ql.create(t,t.onScrollEnd)))},i.onListRender=function(e,t){t==this.list_gift.selectedIndex?e.img_select.visible=!0:e.img_select.visible=!1;var i="ui/images/activity/hefu/vip/";e.img_select.skin=_r.getFullUrl(i+"vip_lb_img_xzgq.png"),e.img_circle.skin=_r.getFullUrl(i+"ty_btn_dk_blz.png"),e.img_point.visible=!1;for(var n,s=this.list_gift.array[t];0<e.img_grid.numChildren;)(n=e.img_grid.getChildAt(0))&&(n.removeSelf(),n.destroy(),n=null);if(s){var o=zi.getIndex(s.giftId),a=zi.MODEL.minVipLevel(o);e.img_vg.skin=_r.getFullUrl(i+"vip_lb_text_v"+(a-1)+".png");var r=zi.MODEL.goodsReward(o);if(null==r)return;var l,c=r.split(";");if(0<c.length&&(l=c[0].split(","))[0]){(n=new MF(80)).mouseEnabled=!1,n.needEffect=!1,n.needGridBg=!1,n.isShowSmallIcon=!1,n.needMoShow=!1,n.isShowJob=!1,n.needGodShow=!1;e.getChildIndex(e.img_grid);e.img_grid.addChild(n),n.dataSource=yB.create(parseInt(l[0]),1)}var u,d=0,h=!1;for(var _ in QP.ins.currentVipStatuArr)if((u=QP.ins.currentVipStatuArr[_]).giftID==s.giftId){var f=Yg.getIndex(u.resourceID),p=Yg.MODEL.consumDef(f);if(p){var g=yB.createStr(p);g&&(h=!0,d=g.goodsNum)}}s.status<2&&gR.ins.YB>=d&&h&&gR.ins.VIPLevel>=a?e.img_point.visible=!0:e.img_point.visible=!1,0<this._currentSelectGiftID&&s.giftId==this._currentSelectGiftID?e.img_select.visible=!0:e.img_select.visible=!1}else e.img_point.visible=!1,e.img_select.visible=!1;this._circleMask=new pp,this._circleMask.graphics.drawCircle(49,48,43,"#010101"),this._circleMask.pos(0,0),e.img_grid.mask=this._circleMask},i.onSelect=function(e){this.redScroll&&(this.redScroll.clear(),this.redScroll=null),this.txt_beyong.visible=!0,this.img_buy.visible=!1,this.setCurGiftID(e)},i.setCurGiftID=function(e){var t=this;if(null!=t.actInfo||0!=t.actInfo.gifts.length){var i,n;if(t._currentSelectedIndex=-1,e<0){for(var s=0;s<t.actInfo.gifts.length;s++)if((i=t.actInfo.gifts[s]).status<=1){t._currentSelectedIndex=s,t._currentSelectGiftID=i.giftId,t.gvo=i;break}}else for(var o=0;o<t.actInfo.gifts.length;o++)if(e==o&&(i=t.actInfo.gifts[o])){t._currentSelectedIndex=o,t._currentSelectGiftID=i.giftId,t.gvo=i;break}for(var a in t._currentSelectedIndex<0&&(t._currentSelectedIndex=0,t._currentSelectGiftID=t.actInfo.gifts[0].giftId),QP.ins.currentVipStatuArr)(n=QP.ins.currentVipStatuArr[a]).giftID==t._currentSelectGiftID&&(QP.ins.currentGiftNumID=n.numID,QP.ins.currentGiftResourceID=n.resourceID);t.gvo&&2<=t.gvo.status&&(t.img_buy.visible=!0),t.refresh()}},i.refresh=function(){this.setAwards(),this.updatePrice(),this.updateBtn(),this.list_gift.refresh()},i.updateBtn=function(){var e=this,t=e.list_gift.array[e._currentSelectedIndex].status;e.btn_buy.label=RP.n[1430],e.btn_try.visible=!0,t<2?(e.btn_buy.visible=!0,e.btn_try.visible=!0,e.txt_cost.visible=!0):2<=t&&(e.btn_buy.visible=!1,e.btn_try.visible=!1,e.txt_cost.visible=!1),e.btn_buy.gray=e._isFree,e.btn_buy.mouseEnabled=!e._isFree},i.updatePrice=function(){var e=this;if(!(QP.ins.currentGiftNumID<=0)){e.clearArrow();var t,i=zi.getIndex(e._currentSelectGiftID),n=zi.MODEL.oriCostGold(i).split(":")[1];if(e.txt_original.text=n,e._needGold=0,i=zg.getIndex(QP.ins.currentGiftNumID),t=yB.createStr(zg.MODEL.consumDef(i)),e._isFree=Boolean(zg.MODEL.isFree(i)),(e._tryCost=0)==t.goodsNum?(e._needGold=0,e.txt_cost.innerHTML=""):(e.txt_cost.innerHTML="花费"+Ql.createColor(t.goodsNum+"","#23b11f")+RP.n[1431],e._tryCost=t.goodsNum),-1<QP.ins.currentGiftResourceID){i=Yg.getIndex(QP.ins.currentGiftResourceID),t=yB.createStr(Yg.MODEL.consumDef(i)),e._isFree?(e._needGold=parseInt(n),e.txt_discount.text=n):(e._needGold=t.goodsNum,e.txt_discount.text=t.goodsNum.toString()),e._isFree&&e.showArrow();var s=Yg.MODEL.probabilityInt(i).split(","),o=parseInt(s[0]),a=parseInt(s[1]),r=0;r=o==a?o:o+Math.floor(Math.random()*(a-o)),e.txt_beyong.innerHTML=RP.n[1432]+r+RP.n[1433]}}},i.onScrollEnd=function(){0==this.list_gift.scrollBar.value?this.btn_prev.visible=!1:this.btn_prev.visible=!0,this.list_gift.scrollBar.value==this.list_gift.scrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.sortArray=function(e,t){var i=0,n=0;return(i=0==e.status?5:1==e.status?7:9)==(n=0==t.status?5:1==t.status?7:9)?-(e.id-t.id):i-n},i.showByVSC=function(e,t){this.initUI(),this.updateByVSC(t)},i.updateByVSC=function(e){null!=e&&(this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){this.initInfo(),this.refresh(),this.resetrShow()},i.onBuyBtnClicked=function(e){if(this._isFree)this.showArrow();else if(gR.ins.YB<this._needGold)KQ.ins.showNoGold();else{var t=zi.getIndex(this._currentSelectGiftID),i=zi.MODEL.minVipLevel(t);gR.ins.VIPLevel>=i?(WB.buyGift(this._currentSelectGiftID,ql.create(this,this.onBoughtback,[this.acitivityId])),this.clearArrow()):KQ.ins.show(RP.n[1434],ql.create(this,recharge=function(e){switch(e){case 1:Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])}}),!1,3,RP.n[744])}},i.onBoughtback=function(){this._currentSelectedIndex=-1,this.initInfo(),this.refresh(),this.resetrShow()},i.onTryBtnClicked=function(e){var t=this;t.redScroll||(t.arrowView&&(t.arrowView.closeThisPanel(),t.arrowView=null),t._isFree?WB.requestHeFuTry(t._currentSelectGiftID,ql.create(t,t.tryBackHandler,[t.acitivityId])):gR.ins.YB>=t._tryCost?WB.requestHeFuTry(t._currentSelectGiftID,ql.create(t,t.tryBackHandler,[t.acitivityId])):KQ.ins.showNoGold())},i.tryBackHandler=function(){var e=this;e.txt_beyong.visible=!1,e.onReqBack();var t=zi.getIndex(e._currentSelectGiftID),i=zi.MODEL.oriCostGold(t).split(":")[1];t=Yg.getIndex(QP.ins.currentGiftResourceID);var n=yB.createStr(Yg.MODEL.consumDef(t));null==e.redScroll&&(e.redScroll=new KB,e.redScroll.playText(n.goodsNum,parseInt(i),e.txt_discount),e.redScroll.on("complete",e,e.onSctollComplete))},i.showArrow=function(){null==this.arrowView&&(this.arrowView=new LY,this.arrowView.showforDir(1,RP.n[1436],this.btn_try,!1,!0,0,0))},i.onSctollComplete=function(e){this.txt_beyong.visible=!0,this.redScroll&&(this.redScroll=null)},i.clearArrow=function(){null!=this.arrowView&&(this.arrowView.closeThisPanel(),this.arrowView=null)},t}(),i2=function(e){function t(){this.gvo=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_BossScoreView",ey);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onClickHandler),this.btn_score.on("click",this,this.onClickHandler)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.gvo=null,this.btn_go.off("click",this,this.onClickHandler),this.btn_score.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),this.g_bg&&this.g_bg.skin&&""!=this.g_bg.skin&&G.loader.clearRes(this.g_bg.skin),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.gvo=this.actInfo.gifts[0],this.txt_score.innerHTML="积分："+Ql.createColor(this.gvo.scoreObj.score,"#e0d6c1"),this.btn_score.showTip=JP.getIsRedPt(this.gvo)},i.refresh=function(e){e&&1==e.result&&(this.gvo.scoreObj.score=e.score,this.gvo.scoreObj.exchange.take(e.exchangeId)&&this.gvo.scoreObj.exchange.remove(e.exchangeId),this.gvo.scoreObj.exchange.put(e.exchangeId,e.exchangeNum),this.update(),Tu.sendToModule("UPDATE_BOSS_EXCHANGE",["modules.activity.ActivityModule"],this.gvo))},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_go:if(gR.ins.lv<parseInt($e.MODEL.value($e.getIndex(59))))return;hN.ins.open("BOSS_MAINVIEW",{_subIndex_:1});break;case this.btn_score:hN.ins.open("OS_BOSS_SEXCHANGE_VIEW",this.gvo)}},t}(),n2=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.OS_DailyPayView",iy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=xz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.txt_total.visible=!1},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.updateList()},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(JP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},t}(),s2=function(e){function t(){this._datas=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_DailyPayView2",iy);var i=t.prototype;return i.initialize=function(){var e=this;e.list.itemRender=Sz,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.c_bg.skin=_r.getOsNewPath("bg_pay",".jpg"),e.c_bg.scaleX=e.c_bg.scaleY=1,e.c_bg.height=306,e.c_title.loadImage(_r.getOsNewPath("title/title_1026"),0,0,0,0,ql.create(e,e._$10_onComplete,[0])),e.txt_total.visible=!1},i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.list.scrollBar.on("change",t,t.onScrollChanged),G.timer.loop(1e3,t,t.updateLeaveTime),t.updateLeaveTime(),t.c_sp_2.visible=!0,t.c_sp_1.visible=!1,t.c_sp_3.visible=!1,t.c_sp_4.visible=!1,$U.reqRecharge()},i.updateLeaveTime=function(){var e=dr.serverDate,t=86400-(60*e.getHours()*60+60*e.getMinutes()+e.getSeconds());this.txt_time_2.innerHTML=Ql.createColor(Jp.getHMSOrDHm(t),"#23b11f")},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),G.timer.clear(this,this.updateLeaveTime)},i.showByVSC=function(e,t){if(t){this.acitivityId=t;var i=It.getIndex(this.acitivityId);It.MODEL.desc(i)&&(this.txt_desc_2.innerHTML=It.MODEL.desc(i))}this.updateByVSC(t)},i.hideByVSC=function(){},i.updateByVSC=function(e){var t=HN.ins.toc_every;if(null!=t){this._datas=[];var i=0;for(var n=0 in t.showArray){var s=t.showArray[n],o={configIndex:i=Kt.getIndex(n),status:s,id:Kt.MODEL.totalGold(i)};this._datas.push(o)}this._datas=this._datas.sort(JP.sortArray),this.list.dataSource=this._datas}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.destroy=function(e){void 0===e&&(e=!0),G.loader.clearRes(_r.getOsNewPath("title/title_1026")),this.c_title.dispose(),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i._$10_onComplete=function(e){var t=this;t.c_title.x=(t.width-t.c_title.width)/2,t.c_left.visible=0==e,t.c_right.visible=0==e,t.c_left.visible&&(t.c_left.x=t.c_title.x-127,t.c_right.x=t.c_title.x+t.c_title.width+125)},t}(),o2=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.OS_GoalView",ly);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Tz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_link.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.btn_link.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();var e=this.actInfo.position.split(",");e[0]&&(this.btn_link.label=e[0])}},i.update=function(){this.updateList();var e,t=this.actInfo.gifts[0];e=t.owerActivity==JP.A_ID_1057?aB.isActiveSoul?JP.getSoluLevel(t.currentNum):Ql.createColor("未激活","#ff2e24"):20==t.type?0<gR.ins.zsLv?gR.ins.zsLv+"转"+gR.ins.lv+"级":gR.ins.lv+"级":1==t.type?gR.ins.zsLv+"转"+gR.ins.lv+"级":t.currentNum+"",this.txt_my.innerHTML="我的"+St.MODEL.content(St.getIndex(t.giftId))+"："+Ql.createColor(e,"#23b11f")},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(JP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.onClickHandler=function(e){if(this.actInfo){var t=this.actInfo.position.split(",");t[1]&&JP.goToLink(t[1])}},t}(),a2=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.os.OS_LimitBuyView",uy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Cz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.setChildIndex(this.g_blod,2),this.g_fontBg.height=128,this.txt_tip.innerHTML="提升"+Ql.createColor("VIP","#e6d80d")+RP.n[1437]+Ql.createColor(RP.n[1438],"#e6d80d")},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.txt_link.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.txt_link.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){"object"==typeof e&&e.pType&&1==e.pType?(this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack))):(this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.updateList()},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(JP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onClickHandler=function(e){Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],0)},t}(),r2=function(e){function t(){var e=this;e.isP=!1,e.f=null,e.n=0,e.w=null,e.l=null,e.g=null,e.b=null,e.t=null,e.c=0,e.MR=3,e.r=0,e.e=0,t.__super.call(e)}b(t,"modules.activity.views.invite.In_LotteryView",Cm);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.c=0,t.isP=!1;for(var i=0;i<4;i++)t["b"+i].parent&&t["b"+i].parent.removeChild(t["b"+i]),t["b"+i].skin=_r.getOsNewPath("egg/xfsl_"+i,".jpg"),t.addChildAt(t["b"+i],0);t.t_f.on("click",t,t.onClick),t.b_s.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;if(modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.clear(),G.timer.clearAll(t),t.b&&t.b.graphics.clear(),t.isP&&WB.reqLottA(t.e),t.l){for(var i=0;i<t.l.length;++i)t.l[i]&&(t.l[i].removeSelf(),t.l[i].destroy(),t.l[i]=null);t.l.splice(0,t.l.length)}t.t_f.off("click",t,t.onClick),t.b_s.off("click",t,t.onClick)},i.showByVSC=function(e,t){this.acitivityId=t,0<gn.count?this._$10_onComplete():uc.ins().onLoadJxrs([{url:_r.getJxrDBPath("NewServerGiftResource"),type:"arraybuffer",cls:gn}],ql.create(this,this._$10_onComplete))},i._$10_onComplete=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&e.actInfo.exchangeList&&(e.resetrShow(),e.b_time.centerX=NaN,e.b_time.x=280,e.b_time.width=408,e.txt_desc.width=390,e.txt_time.x=e.txt_desc.x,e.txt_time.align="left",e.g_fbg.visible=!1,e.box.bottom=131,e.g_r.visible=!e.actInfo.share,e.n=e.actInfo.growth,e.w=e.actInfo.exchangeList,e.g=e.awards,e.setAward())},i.refresh=function(e){e&&e instanceof protos.activity.toc_34018&&(this.n=e.n,this.g_r.visible=!1,this.redPt())},i.setAward=function(){var e=this;e.b||(e.b=new dt,e.b.pos(0,470),e.addChild(e.b)),e.b.graphics.clear(),e.t||(e.t=G.loader.getRes(_r.getAtlasSubPath("base_ui2/ty_gat_ylq.png"))),e.l=e.l||[];for(var t=0;t<12;t++){var i=e.l[t];if(!i){(i=new MF).needEffect=!1;var n=yB.create(e.g[t].gd,e.g[t].gn);i.bindData=n,e["g"+t].addChild(i),e.l.push(i)}e.isT(e.g[t].id)&&(e.b.graphics.drawTextures(e.t,[e["g"+t].x+5,e["g"+t].y-450]),i.filters=A_.getGrayFilter5())}e.redPt()},i.redPt=function(){var e=this;e.b_s.disabled=e.n<1,e.b_s.showTip=0<e.n,e.t_t.innerHTML=RP.n[1439]+Ql.createColor(e.n+"",0<e.n?"#23b11f":"#ff2e24"),Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:e.acitivityId,redPt:0<e.n||e.g_r.visible,mType:e.mainType})},i.isT=function(e){if(!this.w)return!1;for(var t=0;t<this.w.length;t++)if(e==this.w[t])return!0;return!1},i.onClick=function(e){switch(e.currentTarget){case this.t_f:YB.reqWxCanShare("NEW_SERVER_GIFT");break;case this.b_s:if(this.isP||this.n<1)return;WB.reqLottery(this.acitivityId,ql.create(this,this.onPlay))}},i.onPlay=function(){var e=this;e.n--,e.redPt(),e.e=JP.lotId,e.w&&e.w.push(e.e),e.isP=!0,e.r=0,G.timer.frameLoop(4,e,e.onLoop)},i.onLoop=function(){var e=this;e.c++,12<=e.c&&(e.c=0,e.r++),e.gs.pos(e["g"+e.c].x-3,e["g"+e.c].y-3),e.r>=e.MR&&(G.timer.clear(e,e.onLoop),G.timer.frameLoop(7,e,e.onEnd))},i.onEnd=function(){var e=this;if(e.c++,12<=e.c&&(e.c=0),e.gs.pos(e["g"+e.c].x-3,e["g"+e.c].y-3),e.c==e.e-1){e.c=e.e-1,e.isP=!1,e.clear();var t=e["g"+e.c].x+(e["g"+e.c].width>>1),i=e["g"+e.c].y+(e["g"+e.c].height>>1);if(e.f||(e.f=kB.createEffect("jm1060",t,i,e)),e.g&&e.g[e.c]){var n=e.localToGlobal(new Uh(t,i));zB.ins.playGetItemsByPos([e.g[e.c].gd],new Uh(n.x,n.y))}e.setAward(),WB.reqLottA(e.e)}},i.clear=function(){this.f&&(this.f.parent&&this.f.parent.removeChild(this.f),this.f.dispose(),this.f=null),G.timer.clear(this,this.onEnd)},p(0,i,"awards",function(){for(var e=[],t=0;t<gn.count;t++)if(gn.MODEL.activityId(t)==this.acitivityId){var i=JSON.parse(gn.MODEL.reward(t));if(i){var n=i[0].value.toString().split(":");e.push({id:gn.MODEL.key(t),gd:parseInt(n[0]),gn:parseInt(n[1])})}}return e}),t}(),l2=function(e){function t(){this.g_list=null,this.g_items=null,this.m_Eff=null,this.effLoc=[],t.__super.call(this)}b(t,"modules.activity.views.os.OS_RankMainView",fy);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_rank.on("click",this,this.onClickHandler),this.btn_link.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;G.timer.clear(t,t.initShow),t.btn_rank.off("click",t,t.onClickHandler),t.btn_link.off("click",t,t.onClickHandler),t.clearItems(),t.clearEff(),modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();var e=this.actInfo.position.split(",");e[0]&&(this.btn_link.label=e[0])}},i.update=function(){HP.loadConfig(["ConfigActivityRank"],["CActivityRank"],ql.create(this,this.initShow))},i.initShow=function(){if(!this.actInfo)return this.actInfo=mB.getInStance().getActivityData(this.acitivityId),void G.timer.once(100,this,this.initShow);this.setMyInfo(),this.setRankInfo(),this.setTitleEff(),this.setAwards()},i.setMyInfo=function(){var e,t=this;0<t.actInfo.myRank?t.txt_rank.innerHTML=RP.n[1425]+Ql.createColor(t.actInfo.myRank+"","#e0d6c1"):t.txt_rank.innerHTML=RP.n[1426]+Ql.createColor("未上榜","#e0d6c1"),e=1==t.actInfo.myRankType?0==t.actInfo.rankValue?t.actInfo.rankLevel+"级":t.actInfo.rankValue+"转"+t.actInfo.rankLevel+"级":t.actInfo.activityId==JP.A_ID_1053?aB.isActiveSoul?JP.getSoluLevel(t.actInfo.rankValue):Ql.createColor("未激活","#ff2e24"):t.actInfo.rankValue+JP.getWordsByRtype(t.actInfo.type),t.txt_total.innerHTML="我的"+t.actInfo.rankLevelStr+":"+Ql.createColor(e,"#e0d6c1")},i.setRankInfo=function(){for(var e,t=this,i=0;i<3;i++)i<t.actInfo.rank.length?(e=t.actInfo.rank[i],t["txt_name_"+i].changeText(e.charName),t["txt_level_"+i].visible=!0,1==e.rankType?0==e.value?t["txt_level_"+i].changeText(e.level+"级"):t["txt_level_"+i].changeText(e.value+"转"+e.level+"级"):19==e.rankType?t["txt_level_"+i].changeText(JP.getSoluLevel(e.value)):t["txt_level_"+i].changeText(e.value+JP.getWordsByRtype(e.rankType))):(t["txt_name_"+i].changeText(RP.n[1442]),t["txt_level_"+i].visible=!1)},i.setAwards=function(){var e=this;if(!(e.g_items&&0<e.g_items.length)){var t;e.g_list=JP.getListById(e.acitivityId),e.clearItems(),e.g_items=[];for(var i=0;i<4;++i)if(t=e.g_list[i])for(var n=1==t.rankTarget?2:1,s=0;s<n;++s){var o=t.rewardGoods[s];if(o){var a=new MF;a.bindData=o,a.size(116,116),a.pos(135*s,0),e.g_items.push(a),e["sp_"+i].addChild(a),e["gn_"+i+"_"+s].changeText(o.name),e["gn_"+i+"_"+s].color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(o.goodsId)))}}}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length)}},i.setTitleEff=function(){var e=this,t=Tt.MODEL.effectId(Tt.getIndex(e.actInfo.activityId));if(!t||""==t)return e.clearEff(),e.sp_show.y=178,void(e.g_qicon.skin=_r.getAtlasSubPath("activity/cz_sc_bq_xy.png"));e.sp_show.y=229,e.g_qicon.skin=_r.getAtlasSubPath("activity/cz_sc_bq_jb.png"),e.m_Eff||(e.m_Eff=mj.GetNew(),e.m_Eff.renderInSelf=!0,e.m_Eff.loadEffect(t,"body_top",t),"jm1277"==(e.m_Eff.id=t)?e.m_Eff.setXY(188,625):"jm1279"==t?e.m_Eff.setXY(188,605):e.m_Eff.setXY(188,615),e.m_Eff.mouseEnabled=!1,e.addChild(e.m_Eff))},i.clearEff=function(){this.m_Eff&&(this.m_Eff.parent&&this.m_Eff.parent.removeChild(this.m_Eff),this.m_Eff.dispose(),this.m_Eff=null)},i.onClickHandler=function(e){if(this.actInfo)switch(e.currentTarget){case this.btn_rank:hN.ins.open("OS_RANK_VIEW",this.actInfo);break;case this.btn_link:var t=this.actInfo.position.split(",");t[1]&&JP.goToLink(t[1])}},t}(),c2=function(e){function t(){this.curIndex=0,this.gvo=null,this.MAX_DAYS=6,this._BAR_W=0,this.g_items=null,this.g_icons=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_RechargeReturnView",vy);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.curIndex=1,t._BAR_W=t.bar.width,t.img_got.visible=t.btn_award.visible=!1,t.btn_award.on("click",t,t.onClickHandler),t.img_g_0.on("click",t,t.onClickHandler),t.img_g_1.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,t.cleatIcons(),t.clearItems(),t.btn_award.off("click",t,t.onClickHandler),t.img_g_0.off("click",t,t.onClickHandler),t.img_g_1.off("click",t,t.onClickHandler)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.curIndex=1==this.actInfo.gifts[0].status?0:this.curIndex,this.update(),this.resetrShow())},i.update=function(){var e=this;e.initShow(e.curIndex),e.setIcons();var t=e.gvo.rechargeDays/e.MAX_DAYS;1<t&&(t=1);var i=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);i.width=e._BAR_W*t,e.bar.scrollRect=i},i.initShow=function(e){var t=this;t.curIndex=e,t.gvo=t.actInfo.gifts[e],t.img_got.visible=2==t.gvo.status,t.btn_award.visible=2!=t.gvo.status,t.box_tri.visible=1==e,t.btn_award.visible&&(0==t.gvo.status?t.btn_award.label=RP.n[1443]:t.btn_award.label=RP.n[1444],t.btn_award.showTip=1==t.gvo.status),t.img_select.x=t["img_g_"+e].x;var i=_r.getOsNewPath("pay/r_return_"+t.gvo.maxRechargeDay);if(t.img_card.skin&&t.img_card.skin!=i){var n=yc.getRes(t.img_card.skin);n&&(n.destroy(),yc.clearRes(t.img_card.skin),tt.ins.clearTexture(t.img_card.skin))}t.img_card.skin=i,t.setAwards()},i.setIcons=function(){this.cleatIcons();var e=this.actInfo.gifts[this.actInfo.gifts.length-1].rechargeDays;this.txt_days.changeText(e.toString()),this.g_icons=[];for(var t=0;t<2;t++){var i=this.actInfo.gifts[t],n=i.rewardGoods[0];if(n){var s=new MF;s.isClearUrl=!0,s.size(93,93),s.bindData=n,s.pos(0,0),s.toolTipEnabled=!1,this["img_g_"+t].addChild(s),this.g_icons.push(s)}this["txt_d_"+t].innerHTML="累充"+i.maxRechargeDay+"天"}},i.cleatIcons=function(){var e=this;if(e.g_icons&&0<e.g_icons.length){for(var t=0;t<e.g_icons.length;++t)e.g_icons[t]&&(e.g_icons[t].parent&&e.g_icons[t].parent.removeChild(e.g_icons[t]),e.g_icons[t].destroy(),e.g_icons[t]=null);e.g_icons.splice(0,e.g_icons.length)}},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[];for(var t=0,i=e.gvo.rewardGoods,n=0;n<6;++n)if(e["txt_gn_"+n].visible=n<i.length,e["img_gr_"+n].visible=n<i.length,n<i.length){var s=new MF;s.size(93,93),s.bindData=i[n],s.pos(e["img_gr_"+n].x+34,e["img_gr_"+n].y+612),e.g_items.push(s),e.box_c.addChild(s),t=Bi.getIndex(i[n].goodsId),e["txt_gn_"+n].changeText(Bi.MODEL.simpleName(t)),e["txt_gn_"+n].color=ms.getByQuality(Bi.MODEL.colourId(t))}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_award:0==t.gvo.status?(JP.closeAosPanel(),Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])):WB.getGift(t.gvo.giftId,ql.create(t,t.update));break;case t.img_g_0:0!=t.curIndex&&t.initShow(0);break;case t.img_g_1:1!=t.curIndex&&t.initShow(1)}},t}(),u2=function(e){function t(){this.t=null,this.g=null,this.sale=0,this.l=null,this.e=null,this._$10_pos=[[280,437],[437,503],[502,657],[437,811],[280,877],[123,813],[59,657],[123,503]],t.__super.call(this)}b(t,"modules.activity.views.invite.In_SaleView",Dm);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.b_b.on("click",t,t.onClick),t.b_v.on("click",t,t.onClick),t.t_l.on("click",t,t.onClick),t.hit.on("click",t,t.onClick);for(var i=0;i<4;i++)t["g_"+i].parent&&t["g_"+i].parent.removeChild(t["g_"+i]),t["g_"+i].skin=_r.getOsNewPath("egg/zklb_"+i,".jpg"),t.addChildAt(t["g_"+i],0)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.g=null,t.clearEff(),t.l&&t.l.graphics.clear(),t.b_b.off("click",t,t.onClick),t.b_v.off("click",t,t.onClick),t.t_l.off("click",t,t.onClick),t.hit.off("click",t,t.onClick)},i.destroy=function(e){void 0===e&&(e=!0),G.loader.clearRes(_r.getFullUrl(this.cp_n.skin,!1)),modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.acitivityId=t,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack,[1]))},i.onReqBack=function(e){var t=this;void 0===e&&(e=0),t.actInfo=mB.getInStance().getActivityData(t.acitivityId),t.actInfo&&t.actInfo.gifts&&(1==e&&(t.resetrShow(),t.b_time.centerX=NaN,t.b_time.x=280,t.b_time.width=408,t.txt_desc.width=390,t.txt_time.x=t.txt_desc.x,t.txt_time.align="left",t.g_fbg.visible=!1,t.box.bottom=131),t.g=t.actInfo.gifts[0],t.t_pr.changeText(t.g.oriCostGold[1]),t.sale=Math.ceil(10*t.actInfo.growth/parseInt(t.g.oriCostGold[1])),t.bs.visible=t.sale<10,t.g_s.visible=t.cp_n.visible=t.bs.visible,t.g_p.visible=!t.bs.visible,t.g_b.height=t.bs.visible?70:35,t.bs.visible?(t.cp_n.value=t.sale.toString(),t.t_sl.changeText(t.actInfo.growth.toString()),t.l||(t.l=new pp,t.bp.addChild(t.l)),t.l.graphics.clear(),t.l.graphics.drawLine(-4,t.t_pr.y+11,t.t_pr.x+11*t.t_pr.text.length+5,t.t_pr.y+12,"#90877b",1)):t.l&&t.l.graphics.clear(),t.initShow(),t.creat())},i.refresh=function(e){e&&e instanceof protos.activity.toc_34007&&WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.initShow=function(){this.g_t.visible=2==this.g.status,this.b_b.disabled=this.b_v.disabled=this.g_t.visible,this.b_b.label=this.b_b.disabled?"已购买":RP.n[1445]},i.creat=function(){this.t=this.t||[];for(var e=0;e<8;e++){var t=this.t[e];t||((t=new mz).pos(this._$10_pos[e][0],this._$10_pos[e][1]),this.addChild(t),this.t.push(t)),t.dataSource=this.actInfo.shopitemList[e]?this.actInfo.shopitemList[e]:null}},i.onClick=function(e){var t=this;if(t.actInfo&&t.g)switch(e.currentTarget){case t.b_b:if(2==t.g.status)return;var i=RP.n[1446]+Ql.createColor(t.actInfo.growth+"元宝","#e6d80d")+RP.n[1447];KQ.ins.show(i,ql.create(t,t.onConfirm));break;case t.b_v:if(2==t.g.status)return;if(8<=t.actInfo.shopitemList.length)return void zB.ins.showMsg(RP.n[1448],1);jP.sdk_cmd("wx_share_2","DISCOUNT_GIFT");break;case t.t_l:hN.ins.open("IN_SALELOG",t.actInfo.shopitemList);break;case t.hit:hN.ins.open("IN_SALEAWARD",t.g.goodsReward)}},i.onConfirm=function(e){this.actInfo&&1==e&&(gR.ins.YB<this.actInfo.growth?KQ.ins.showNoGold():WB.buyGift(this.g.giftId,ql.create(this,this.onRefresh)))},i.onRefresh=function(){var e=this;e.destroyed||(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&e.actInfo.gifts&&(e.clearEff(),e.e||(e.e=kB.createEffect("jm1060",e.hit.width>>1,e.hit.height>>1,e.hit)),e.g=e.actInfo.gifts[0],e.initShow(),e.goToPos()))},i.clearEff=function(){this.e&&(this.e.parent&&this.e.parent.removeChild(this.e),this.e.dispose(),this.e=null)},i.goToPos=function(){var e,t=this.g.goodsReward;if(t&&(e=t.split(";")),e&&!(e.length<1)){for(var i=[],n=0;n<e.length;n++)if(t=e[n]){var s=t.split(",");i.push(parseInt(s[0]))}var o=this.localToGlobal(new Uh(this.width>>1,60+(this.height>>1)));zB.ins.playGetItemsByPos(i,new Uh(o.x,o.y))}},t}(),d2=function(e){function t(){this.gvo=null,this._BAR_W=0,this.g_items=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_RechargeTotalView",my);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this._BAR_W=this.bar.width,this.btn_award.on("click",this,this.onClickHandler),this.img_card.skin=_r.getOsNewPath("pay/r_total")},i.onRemove=function(e){var t=this;if(modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,t.btn_award.off("click",t,t.onClickHandler),t.g_items&&0<t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){var e=this;e.gvo=e.actInfo.gifts[0],e.btn_award.visible=2!=e.gvo.status,e.img_got.visible=!e.btn_award.visible,e.btn_award.visible&&(0==e.gvo.status?e.btn_award.label=RP.n[1443]:(e.btn_award.label=RP.n[1444],e.btn_award.showTip=1==e.gvo.status));var t=e.gvo.recharge/e.gvo.targetValue;1<t&&(t=1);var i=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);i.width=e._BAR_W*t,e.bar.scrollRect=i,e.txt_pay.innerHTML="已充值"+Math.min(e.gvo.recharge,e.gvo.targetValue)+"/"+e.gvo.targetValue+"元宝",e.setAwards()},i.setAwards=function(){var e=this;if(!(e.g_items&&0<e.g_items.length)){e.g_items=[];for(var t=0,i=e.gvo.rewardGoods,n=0;n<6;++n)if(e["txt_gn_"+n].visible=n<i.length,e["img_g_"+n].visible=n<i.length,n<i.length){var s=new MF;s.size(93,93),s.isClearUrl=!0,s.bindData=i[n],s.pos(e["img_g_"+n].x,e["img_g_"+n].y),e.g_items.push(s),e.box_items.addChild(s),t=Bi.getIndex(i[n].goodsId),e["txt_gn_"+n].changeText(Bi.MODEL.simpleName(t)),e["txt_gn_"+n].color=ms.getByQuality(Bi.MODEL.colourId(t))}}},i.onClickHandler=function(e){this.gvo&&(0==this.gvo.status?(JP.closeAosPanel(),Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])):WB.getGift(this.gvo.giftId,ql.create(this,this.update)))},t}(),h2=function(e){function t(){this._datas=null,this.lastTime=0,t.__super.call(this)}b(t,"modules.activity.views.sp.FestivalPayView",iy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Nz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.txt_total.visible=!0},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged),this.c_sp_2.visible=!0,this.c_sp_1.visible=!1,this.c_sp_3.visible=!1},i.updateLeaveTime=function(){this.lastTime=this.actInfo.endTime-dr.serverTimeSec,this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!0)},i.showTime=function(){this.lastTime<=0?(hN.ins.isOpen("OPENSERVER")&&hN.ins.close("OPENSERVER"),G.timer.clear(this,this.showTime)):(this.lastTime--,this.txt_time_2.innerHTML=Ql.createColor(Jp.getSTRDHMS(this.lastTime),"#23b11f"))},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),G.timer.clear(this,this.showTime)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.hideByVSC=function(){},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.updatePanel(),this.updateView(),this.updateLeaveTime())},i.updatePanel=function(){var e=It.getIndex(this.acitivityId),t=It.MODEL.upbgui(e);if(t){var i=t.split(",");i&&0<i.length&&(this.c_bg.skin=_r.getOsNewPath(i[0],".jpg"),this.c_bg.scaleX=this.c_bg.scaleY=1,this.c_bg.height=306),(t=It.MODEL.secondtitleui(e))&&((i=t.split(","))&&0<i.length&&this.c_title.loadImage(_r.getOsNewPath("title/"+i[0]),0,0,0,0,ql.create(this,this._$10_onComplete,[0])),(t=It.MODEL.desc(e))&&(this.txt_desc_2.innerHTML=t))}},i.updateView=function(){this._datas=[];var e,t=this.actInfo.gifts,i=0;if(t&&0<t.length)for(var n in t){var s={status:(e=t[n]).status,giftId:e.giftId};this._datas.push(s),i=e.recharge}this._datas=this._datas.sort(JP.sortArray),this.list.dataSource=this._datas,this.txt_total.text=RP.n[1451]+i+"元宝"},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.destroy=function(e){void 0===e&&(e=!0),this.c_title.dispose(),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i._$10_onComplete=function(e){var t=this;t.c_title.x=(t.width-t.c_title.width)/2,t.c_left.visible=0==e,t.c_right.visible=0==e,t.c_left.visible&&(t.c_left.x=t.c_title.x-127,t.c_right.x=t.c_title.x+t.c_title.width+125)},t}(),_2=function(e){function t(){this._datas=null,this.lastTime=0,t.__super.call(this)}b(t,"modules.activity.views.sp.FestivalUseYBView",iy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Bz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.txt_total.visible=!0},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged),this.c_sp_2.visible=!0,this.c_sp_1.visible=!1,this.c_sp_3.visible=!1},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged),G.timer.clear(this,this.showTime)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.updatePanel(),this.updateView(),this.updateLeaveTime())},i.updatePanel=function(){var e=It.getIndex(this.acitivityId),t=It.MODEL.upbgui(e);if(t){var i=t.split(",");i&&0<i.length&&(this.c_bg.skin=_r.getOsNewPath(i[0],".jpg"),this.c_bg.scaleX=this.c_bg.scaleY=1,this.c_bg.height=306),(t=It.MODEL.secondtitleui(e))&&((i=t.split(","))&&0<i.length&&this.c_title.loadImage(_r.getOsNewPath("title/"+i[0]),0,0,0,0,ql.create(this,this._$10_onComplete,[0])),(t=It.MODEL.desc(e))&&(this.txt_desc_2.innerHTML=t))}},i.updateView=function(){this._datas=[];var e,t=this.actInfo.gifts,i=0;if(t&&0<t.length)for(var n in t){var s={status:(e=t[n]).status,giftId:e.giftId};this._datas.push(s),i=e.recharge}this._datas=this._datas.sort(JP.sortArray),this.list.dataSource=this._datas,this.txt_total.text=RP.n[1452]+i+"元宝"},i.updateLeaveTime=function(){this.lastTime=this.actInfo.endTime-dr.serverTimeSec,this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!0)},i.showTime=function(){this.lastTime<=0?(hN.ins.isOpen("OPENSERVER")&&hN.ins.close("OPENSERVER"),G.timer.clear(this,this.showTime)):(this.lastTime--,this.txt_time_2.innerHTML=Ql.createColor(Jp.getSTRDHMS(this.lastTime),"#23b11f"))},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i._$10_onComplete=function(e){var t=this;t.c_title.x=(t.width-t.c_title.width)/2,t.c_left.visible=0==e,t.c_right.visible=0==e,t.c_left.visible&&(t.c_left.x=t.c_title.x-127,t.c_right.x=t.c_title.x+t.c_title.width+125)},t}(),f2=function(e){function t(){var e=this;e._BAR_W=0,e.MAX_NUM=10,e.MAX_TYPE=3,e.curOpen=0,e.curType=0,e.hash=null,e.curObj=null,e.openDays=0,e.g_items=null,e.eff=null,e.image_rewards=null,e.rewardEff=null,t.__super.call(e)}b(t,"modules.activity.views.os.OS_SevenKHView",wy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Oz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.rewardEff=kB.createEffect("jm1308",47,50,this.btn_showReward)},i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t._BAR_W=t.bar.width,t.list.scrollBar.on("change",t,t.onScrollChanged),t.btn_showReward.on("click",t,t.onPreview),t.curOpen=t.curType=1;var i=0;for(i=0;i<5;i++)t["g_icon_"+i].visible=!1,t["btn_d_"+i].on("click",t,t.onClickDays);for(i=0;i<3;i++)t["g_red_"+i].visible=!1,t["g_rect_"+i].on("click",t,t.onClickType);t.setRateBar()},i.onRemove=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.list.scrollBar.off("change",t,t.onScrollChanged),t.btn_showReward.off("click",t,t.onPreview),t.hash&&(t.hash.dispose(),t.hash=null);var i=0;for(i=0;i<5;i++)t["btn_d_"+i].off("click",t,t.onClickDays);for(i=0;i<3;i++)t["g_rect_"+i].off("click",t,t.onClickType);if(t.g_items&&t.g_items.length){for(i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}if(t.clearEff(),t.image_rewards){for(i=0;i<9;i++){var n=t.image_rewards[i];n.removeSelf(),n.dispose()}t.image_rewards=null}},i.destroy=function(e){void 0===e&&(e=!0),this.rewardEff&&(this.rewardEff.parent&&this.rewardEff.parent.removeChild(this.rewardEff),this.rewardEff.dispose(),this.rewardEff=null),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow(),WB.reqSevenKHScore())},i.update=function(){var e,t=this;t.hash=new jl;for(var i=t.openDays=0,n=0;n<t.actInfo.gifts.length;n++){e=t.actInfo.gifts[n],i=St.getIndex(e.giftId);var s=parseInt(St.MODEL.targetParam2(i)),o=St.MODEL.type(i);t.hash.take(s+"_"+o)?t.hash.take(s+"_"+o).list.push(e):t.hash.put(s+"_"+o,{list:[e],gname:St.MODEL.content(i).split(",")[0]}),1==e.sevenOpen&&(t.openDays=s)}for(n=0;n<5;n++)t["g_icon_"+n].visible=t.openDays<parseInt(t["btn_d_"+n].name)+1,t["btn_d_"+n].mouseEnabled=t.openDays>=parseInt(t["btn_d_"+n].name)+1;t.setShows(),t.refreshAward(),t.setAwards()},i.setShows=function(){this.curObj=this.hash.take(this.curOpen+"_"+this.curType),this.g_select.x=this["g_rect_"+(this.curType-1)].x-2,this.setList()},i.setList=function(){this.curObj&&this.curObj.list&&(this.curObj.list=this.curObj.list.sort(JP.sortArray),this.list.dataSource=this.curObj.list,this.list.tweenTo(0))},i.setTypeGoal=function(){var e,t=0;for(t=0;t<this.MAX_TYPE;t++)e=this.hash.take(this.curOpen+"_"+(t+1)),this["txt_goal_"+t].changeText(e.gname),this["g_red_"+t].visible=this.getRedPt(e.list);for(t=0;t<5;t++)this["btn_d_"+t].selected=t+1==this.curOpen},i.refreshAward=function(){this.setTypeGoal();for(var e=0;e<5;e++)this["btn_d_"+e].showTip=this.getRedPtByOpen(e+1)},i.refresh=function(e){var t=this;e.hasOwnProperty("isUpdate")&&(t.setList(),t.refreshAward()),t.txt_score.changeText(e.score.toString());var i=e.score/100;1<i&&(i=1),t.setRateBar(i);for(var n=-1,s=0;s<t.MAX_NUM;s++)t["txt_s_"+s].color=parseInt(t["txt_s_"+s].text)>e.score?"#90877b":"#23b11f",e.score>=parseInt(t["txt_s_"+s].text)&&(n=s);t.setEff(n),t.txt_had.changeText(e.score+"/100")},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.bar.scrollRect||new u_(0,0,this.bar.width,this.bar.height);t.width=this._BAR_W*e,this.bar.scrollRect=t},i.setAwards=function(){if(!this.image_rewards){this.image_rewards=[];for(var e=0;e<9;e++)e<4?this.image_rewards.push(kB.createImage(_r.getIconPath("icgoods10001"),70+59*e,40,40,40,this.a_box)):this.image_rewards.push(kB.createImage(_r.getIconPath("icgoods10002"),70+59*e,40,40,40,this.a_box))}},i.setEff=function(e){var t=this;t.clearEff(),e<0||!t.g_items||!t.g_items[e]||t.eff||(e<t.g_items.length-1?(t.eff=kB.createEffect(JP.g_eff_gold,t.g_items[e].x+22,t.g_items[e].y+22,t),t.eff.scale_X=.4,t.eff.scale_Y=.4):(t.eff=kB.createEffect(JP.g_eff_gold,t.g_items[e].x+30,t.g_items[e].y+30,t),t.eff.scale_X=.5,t.eff.scale_Y=.5))},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.onClickDays=function(e){this.curOpen==parseInt(e.currentTarget.name)+1||this.openDays<parseInt(e.currentTarget.name)+1||(this.curOpen=parseInt(e.currentTarget.name)+1,this.setShows(),this.setTypeGoal())},i.onClickType=function(e){this.curType!=parseInt(e.currentTarget.name)&&(this.curType=parseInt(e.currentTarget.name),this.setShows())},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onPreview=function(e){this.rewardEff&&(this.rewardEff.visible=!1),hN.ins.open("OS_SEVENKH_PREVIEW")},i.getRedPt=function(e){for(var t=0;t<e.length;t++)if(1==e[t].status)return!0;return!1},i.getRedPtByOpen=function(e){var t;if(e>this.openDays)return!1;for(var i=0;i<this.MAX_TYPE;i++)if(t=this.hash.take(e+"_"+(i+1)),this.getRedPt(t.list))return!0;return!1},t}(),p2=function(e){function t(){this.gvo=null,this.g_items=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_SevenRechargeView",xy);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_pay.label="",this.btn_pay.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;if(modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,t.g_items&&t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}t.btn_pay.off("click",t,t.onClickHandler)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){var e=this;if(e){e.gvo=e.actInfo.gifts[0];var t=e.gvo.targetValue-e.gvo.recharge;t<0&&(t=0),e.clip_pay.value=t.toString(),e.g_font_0.x=(e.width-e.g_font_0.width-32*t.toString().length-137-e.g_font_2.width)/2,e.clip_pay.x=e.g_font_0.x+135,e.g_font_1.x=e.clip_pay.x-(e.g_font_1.width-32*t.toString().length-193),e.g_font_2.x=e.g_font_1.x+443,e.btn_pay.showTip=1==e.gvo.status,e.btn_pay.disabled=2==e.gvo.status,0==e.gvo.status?e.btn_pay.label="充 值":1==e.gvo.status?e.btn_pay.label="领 取":e.btn_pay.label="已领取",e.setAwards()}},i.setAwards=function(){var e=this;if(!(e.g_items&&0<e.g_items.length)){e.g_items=[];for(var t=e.gvo.rewardGoods,i=0;i<6;++i)if(e["txt_n_"+i].visible=i<t.length,e["g_bg_"+i].visible=i<t.length,i<t.length){var n=new MF;n.isClearUrl=!0,n.size(116,116),n.bindData=t[i],n.pos(e["g_bg_"+i].x+19,e["g_bg_"+i].y+63),e.g_items.push(n),e._box.addChild(n);var s=Bi.getIndex(t[i].goodsId);e["txt_n_"+i].changeText(Bi.MODEL.simpleName(s)),e["txt_n_"+i].color=ms.getByQuality(Bi.MODEL.colourId(s))}}},i.onClickHandler=function(e){this.gvo&&(0==this.gvo.status?(JP.closeAosPanel(),Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"])):WB.getGift(this.gvo.giftId,ql.create(this,this.onReqBack)))},t}(),g2=function(e){function t(){this.gvo=null,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_ShaChengPKView",Sy);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_join.on("click",this,this.onClickHandler)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.gvo=null,this.btn_join.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),this.img_bg&&this.img_bg.skin&&""!=this.img_bg.skin&&G.loader.clearRes(this.img_bg.skin),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){this.update(),this.resetrShow();for(var e=0;e<3;e++)this["g_"+e]}},i.update=function(){var e=this;if(e.gvo=e.actInfo.gifts[0],e.gvo){e.btn_join.visible=2!=e.gvo.status,e.img_got.visible=!e.btn_join.visible;var t=St.getIndex(e.gvo.giftId);e.font_power.value=St.MODEL.targetParam1(t).split(".")[0],e.btn_join.visible&&(0==e.gvo.status?e.btn_join.label=RP.n[1427]:(e.btn_join.label=RP.n[1428],e.btn_join.showTip=1==e.gvo.status)),e.setAwards()}},i.setAwards=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=850,e._gridsList.x=45,e._gridsList._spaceX=35,e._gridsList.size(666,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)),e._gridsList._gridH=e._gridsList._gridW=93,e._gridsList._gnameY=e._gridsList._gridH+1,e._gridsList.setGoodsItems(e.gvo.rewardGoods,1),e._gridsList.x=(e.width-e._gridsList.contentWidth)/2},i.onClickHandler=function(e){if(this.gvo)if(0==this.gvo.status){var t=parseInt($e.MODEL.value($e.getIndex(14)));if(gR.ins.lv<t)return void zB.ins.showMsg(t+RP.n[1429],1);JP.closeAosPanel(),vN.ins.joinGuild?hN.ins.open("GUILD_MNG_MAINVIEW",{_subIndex_:3}):hN.ins.open("GUILD_LIST_VIEW")}else WB.getGift(this.gvo.giftId,ql.create(this,this.update))},t}(),v2=function(e){function t(){this.gvo=null,this.g_items=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_SoulView",Ey);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_chanllenge.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;if(modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,t.btn_chanllenge.off("click",t,t.onClickHandler),t.g_items&&t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}},i.destroy=function(e){void 0===e&&(e=!0),this.g_bg&&this.g_bg.skin&&""!=this.g_bg.skin&&G.loader.clearRes(this.g_bg.skin),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){for(var e=this,t=0;t<e.actInfo.gifts.length;t++)if(0==e.actInfo.gifts[t].status){e.gvo=e.actInfo.gifts[t];break}e.gvo||(e.gvo=e.actInfo.gifts[e.actInfo.gifts.length-1]);var i=St.getIndex(e.gvo.giftId),n=St.MODEL.costGold(i);e.txt_cose.innerHTML=n.toString(),e.g_icon.x=(e.width-e.g_icon.width-e.txt_cose.contextWidth-10)/2,e.txt_cose.x=e.g_icon.x+67,e.btn_chanllenge.showTip=JP.getIsRedPtSoul(e.gvo),e.setAwards()},i.setAwards=function(){if(!(this.g_items&&0<this.g_items.length)){this.g_items=[];for(var e=this.gvo.rewardGoods,t=0;t<2;++t)if(t<e.length){var i=new MF;i.size(93,93),i.bindData=e[t],i.pos(213+200*t,879),this.g_items.push(i),this.addChild(i),this["txt_gn_"+t].changeText(e[t].name),this["txt_gn_"+t].color=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(e[t].goodsId)))}}},i.onClickHandler=function(e){if(this.gvo.soulObj.enterTime>=this.gvo.soulObj.totalTime)zB.ins.showMsg(RP.n[1456],1);else{var t=St.getIndex(this.gvo.giftId),i=parseInt(St.MODEL.targetParam1(t)),n=St.MODEL.costGold(t);this.txt_cose.innerHTML=n.toString(),gR.ins.YB<n?KQ.ins.showNoGold():(jR.reqEntry(i),hN.ins.close("OPENSERVER"))}},t}(),m2=function(e){function t(){this.gvo=null,this.curIndex=0,this.maxLen=0,this._gridsList=null,t.__super.call(this)}b(t,"modules.activity.views.os.OS_UniversalBossView",Cy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Rz,this.list.vScrollBarSkin="",this.list.hScrollBarSkin=""},i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.curIndex=-1,t.btn_kill.on("click",t,t.onClickHandler),t.btn_pre.on("click",t,t.onClickHandler),t.btn_next.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.gvo=null,t.btn_kill.off("click",t,t.onClickHandler),t.btn_pre.off("click",t,t.onClickHandler),t.btn_next.off("click",t,t.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.os.OS_BaseView.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.curIndex=this.getSelectIndex(),this.maxLen=this.actInfo.perBossKiller.length,this.setCurrentInfo()},i.setCurrentInfo=function(){var e=this;e.btn_pre.visible=0!=e.curIndex,e.btn_next.visible=e.curIndex!=e.maxLen-1,e.gvo=e.actInfo.perBossKiller[e.curIndex],e.btn_kill.disabled=2==e.gvo.status,0==e.gvo.status?e.btn_kill.label=RP.n[1457]:1==e.gvo.status?e.btn_kill.label=RP.n[1458]:e.btn_kill.label="已领取",e.btn_kill.showTip=1==e.gvo.status;for(var t=[],i=St.getIndex(e.gvo.giftId),n=St.MODEL.targetParam1(i).split(","),s=0;s<n.length;s++)t.push({mainType:e.mainType,copyId:parseInt(n[s]),kill:-1<e.gvo.killList.indexOf(parseInt(n[s]))});e.list.dataSource=t,e.list.width=176*n.length+4*(n.length-1),e.list.x=(e.width-e.list.width)/2,e.txt_name.text=St.MODEL.content(i),e.g_right.x=e.txt_name.x+e.txt_name.textWidth+12,e.box_gn.x=(e.width-e.g_right.x)/2,e.setAwards()},i.setAwards=function(){var e=this;e._gridsList||(e._gridsList=new vj,e._gridsList.y=775,e._gridsList.x=-2,e._gridsList._spaceX=30,e._gridsList.size(666,180),e._gridsList._gnameY=e._gridsList._gridH+3,e._gridsList._gsimpleName=!0,e._gridsList._gnameFont=JP.gnameFont,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.addChild(e._gridsList)),e._gridsList.setGoodsItems(e.gvo.rewardGoods,1),e._gridsList.x=(e.width-e._gridsList.contentWidth)/2},i.getSelectIndex=function(){for(var e=-1,t=0;t<this.actInfo.perBossKiller.length;++t){var i=this.actInfo.perBossKiller[t];if(1==i.status)return t;0==i.status&&e<0&&(e=t)}return e<0?0:e},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_kill:if(0==t.gvo.status){var i=t.gvo.targetValue;JP.closeAosPanel();var n=rn.getIndex(i),s=0;switch(rn.MODEL.cate(n)){case 2:s=0;break;case 47:s=2;break;default:s=1}hN.ins.open("BOSS_MAINVIEW",{_subIndex_:s,copyId:i},0)}else 1==t.gvo.status&&WB.getGift(t.gvo.giftId,ql.create(t,t.onReqBack));break;case t.btn_pre:0<t.curIndex&&(t.curIndex--,t.setCurrentInfo());break;case t.btn_next:t.curIndex<t.maxLen-1&&(t.curIndex++,t.setCurrentInfo())}},t.urls=[],t}(),y2=function(e){function l(){l.__super.call(this),this.initUI()}b(l,"modules.activity.views.qq.QqDaTingView",i_);var t=l.prototype;return t.initUI=function(){this.list_item.itemRender=Uz,this.list_item.vScrollBarSkin="",this.list_item.scrollBar.elasticBackTime=300,this.list_item.scrollBar.elasticDistance=100},t.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e)},t.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e)},t.showByVSC=function(e,t){this.toptitle1.visible=this.toptitle2.visible=this.c_title.visible=this.c_left.visible=this.c_right.visible=!1,this.updateByVSC(t)},t.updateByVSC=function(e){this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack))},t.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.resetrShow(),this.updateView())},t.updateView=function(){for(var e,t,i=this.actInfo.gifts,n=[],s=0,o=0,a=0;a<l.typeArr.length;a++){e=l.typeArr[a],null==n[a]&&(n[a]=[]);for(var r=o;r<i.length;r++)t=i[r],s=xn.getIndex(t.giftId),e==xn.MODEL.targetParamType1(s)&&(o++,n[a].push(t))}this.list_item.dataSource=n},l.NAME="QqDaTingView",f(l,["typeArr",function(){return this.typeArr=["DAY_ACTIVE","NEW_PLAYER_REGIST","GROW_UP_LEVEL"]}]),l}(),I2=function(e){function t(){this.g_items=null,this._gbox=null,this.GNUM=5,this.GRAP_X=120,this.GRAP_Y=100,t.__super.call(this)}b(t,"modules.activityDaily.view.OS_DayReturnView",sy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Xz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this._gbox||(this._gbox=new dt,this._gbox.pos(0,487),this.addChild(this._gbox))},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){var t=this;if(modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.list.scrollBar.off("change",t,t.onScrollChanged),t.g_items&&t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}t._gbox&&t._gbox.graphics.clear()},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.updateList(),this.getShowList()},i.updateList=function(){if(this.actInfo&&this.actInfo.gifts){var e=this.actInfo.gifts.concat();e=e.sort(JP.sortArray),this.list.dataSource=e,this.list.tweenTo(0)}},i.getShowList=function(){var e=this;if(!(e.g_items&&0<e.g_items.length)){var t,i,n=0,s=[];for(n=0;n<e.actInfo.gifts.length;n++){t=e.actInfo.gifts[n],i=St.MODEL.goodsReward(St.getIndex(t.giftId)).split(";");for(var o=0;o<i.length;o++){var a=i[o].split(","),r=e.getValue(parseInt(a[0]),s);0<r?s[o].count=r+parseInt(a[1]):s.push({modelId:parseInt(a[0]),count:parseInt(a[1])})}}for(e._gbox&&e._gbox.graphics.clear(),e.g_items=[],n=0;n<s.length;n++){var l=new MF,c=yB.create(s[n].modelId,s[n].count);l.size(74,74),l.bindData=c,l.pos((0<Math.floor(n/e.GNUM)?144:84)+n%e.GNUM*e.GRAP_X,Math.floor(n/e.GNUM)*e.GRAP_Y),e.g_items.push(l),e._gbox.addChild(l);var u=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(c.goodsId)));e._gbox.graphics.fillText(c.simpleName,l.x+36,l.y+74,"18px SimHei",u,"center")}}},i.getValue=function(e,t){for(var i=0;i<t.length;i++)if(t[i].modelId==e)return t[i].count;return 0},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},t}(),b2=function(e){function t(){this._gcArr=null,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_CoupletView",Yy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Qz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.os.OS_BaseView.prototype.onAdd.call(this,e),this.btn_kill.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.actInfo=null,this.btn_kill.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack));var t=wt.getIndex(this.acitivityId);wt.MODEL.desc(t)&&this.txt_tip.changeText(wt.MODEL.desc(t))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){if(e.resetrShow(),e.actInfo.exchangeList){var t,i=e.actInfo.exchangeList.concat(),n=[];for(var s in i){var o={exId:(t=i[s]).exId,exTimes:t.exTimes,activityId:e.actInfo.activityId};n.push(o)}n=n.sort(JP.sortArray),e.list.dataSource=n,e.list.tweenTo(0)}e.actInfo.position&&(e._gcArr=e.actInfo.position.split(",")),e._gcArr&&0<e._gcArr.length&&(e.btn_kill.label=e._gcArr[0])}},i.refresh=function(e){if(e&&e instanceof protos.backpack.BackPack_Back_Echange_toc_23621){var t=!1;if(this.list&&this.list.cells){var i=0;for(i=0;i<this.list.cells.length;i++){var n=this.list.getCell(i);n&&(n.setExchagne(),n.exchangeId==e.exchangeID&&n.goToPos())}for(i=0;i<this.list.cells.length;i++){var s=this.list.getCell(i);if(s&&s.isExchagne){t=!0;break}}}Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:this.acitivityId,redPt:t,mType:this.mainType})}},i.onClickHandler=function(e){this._gcArr&&1<this._gcArr.length&&JP.goToLink(this._gcArr[1])},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),w2=function(e){function t(){var e=this;e.index=0,e.curObj=null,e.g_items=null,e.RUN_ROUND=4,e.RUN_ANGLE=5,e.Rotation_Config=[[0,15],[1,20],[3,10],[e.RUN_ROUND,e.RUN_ANGLE]],e._numRound=0,e._numAngle=0,e._drawAngle=0,e._drawing=!1,e._currentRecord=0,e._idsArr=null,e.arrowArr=[0,0],e.shankCnt=0,t.__super.call(e)}b(t,"modules.activity.views.returns.Re_InvestView",Ay);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.txt_time.parent&&t.txt_time.parent.removeChild(t.txt_time),t.addChild(t.txt_time),t.txt_time.pos(95,156),t.g_redPt_0.visible=t.g_redPt_1.visible=!1,t.g_current.visible=!1,t.btn_invest.on("click",t,t.onClickHandler),t.btn_type_0.on("click",t,t.onClickHandler),t.btn_type_1.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),JP.isPlaying&&t.curObj&&WB.reqInvestDrop(t.curObj.type,JP.investSerid),JP.isPlaying=!1,t.actInfo=null,t.curObj=null,t.clearItems(),t.btn_invest.off("click",t,t.onClickHandler),t.btn_type_0.off("click",t,t.onClickHandler),t.btn_type_1.off("click",t,t.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){"object"==typeof e&&e.pType&&1==e.pType&&(this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo){var e;for(var t in this.resetrShow(),JP.investHash.proto)this["g_redPt_"+((e=JP.investHash.proto[t]).type-1)]&&(this["g_redPt_"+(e.type-1)].visible=0<e.curTiems);this.setAwards(1)}},i.onClickHandler=function(e){var t=this;if(!JP.isPlaying)switch(e.target){case t.btn_invest:if(!t.curObj)return;if(0==t.curObj.isInvest)return void EB.pay(7,Ln.MODEL.key(t._$10_index));if(t.curObj.curTiems<1)return void zB.ins.showMsg(RP.n[1459],1);if(!TR.ins.hasEmptyNum(10))return void KQ.ins.showBagRecycle();WB.reqInvestAward(t.curObj.type,ql.create(t,t.onRefesh));break;case t.btn_type_0:case t.btn_type_1:t.setAwards(parseInt(e.currentTarget.name))}},i.onRefesh=function(){this.curObj&&this.play(JP.investSerid,this.curObj.type)},i.setAwards=function(e){var t=this;if((!t.curObj||t.curObj.type!=e)&&(t.curObj=JP.investHash.take(e),t.curObj)){var i;t.clearItems(),t.g_items=[],t._idsArr=[];for(var n=0;n<t.curObj.list.length;n++){i=yB.create(t.curObj.list[n].goodsId,t.curObj.list[n].goodsNum);var s=new MF;s.size(93,93),s.bindData=i,t["g_grid_"+n].addChild(s),t.g_items.push(s),t._idsArr.push(t.curObj.list[n].serId)}t.g_select.x=t["btn_type_"+(e-1)].x,t.setInvestState(),t.initArrowPos(t.arrowArr[t.curObj.type-1])}},i.setInvestState=function(){var e=this;if(e.curObj){for(var t=0;t<e.curObj.list.length;t++)e["g_got_"+t].visible=1==e.curObj.list[t].isSign;e["g_redPt_"+(e.curObj.type-1)].visible=0<e.curObj.curTiems,e.txt_times.visible=1==e.curObj.isInvest,e.txt_times.visible&&(e.txt_times.innerHTML=RP.n[1460]+Ql.createColor(e.curObj.curTiems+"",0<e.curObj.curTiems?"#23b11f":"#ff2e24")),e._$10_index=e.getReIndex(e.curObj.type),1==e.curObj.isInvest?(e.btn_invest.label="转一转",e.btn_invest.disabled=!1):(e.isEnded?e.btn_invest.label=RP.n[1461]:e.btn_invest.label=Ln.MODEL.money(e._$10_index)+"元投资",e.btn_invest.disabled=e.isEnded)}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.getReIndex=function(e){for(var t=0;t<Ln.count;t++)if(7==Ln.MODEL.type(t)&&Ln.MODEL.equipInvestType(t)==e)return t;return 0},i.goToPos=function(e){var t=this;if(t.curObj&&t.g_items[e]&&t["g_grid_"+e]){var i=t.b_circle.x+t["g_grid_"+e].x+(t.g_items[e].width>>1),n=t.b_circle.y+t["g_grid_"+e].y+(t.g_items[e].height>>1),s=t.localToGlobal(new Uh(i,n));zB.ins.playGetItemsByPos([t.g_items[e].goodsId],new Uh(s.x,s.y))}},i.refreshRedPt=function(){var e=!1;for(var t in JP.investHash.proto)if(0<JP.investHash.proto[t].curTiems){e=!0;break}Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:this.acitivityId,redPt:e,mType:this.mainType})},i.play=function(e,t){var i=this;i._currentRecord=e,i.arrowArr[t-1]=i._currentRecord,i._numRound=0,i._drawAngle=-1,i._drawing=!0,i.lockMask(!0),G.timer.frameLoop(1,i,i.onPlayLoop),JP.isPlaying=!0,i.txt_times.innerHTML=RP.n[1462]+Ql.createColor(i.curObj.curTiems+"",0<i.curObj.curTiems?"#23b11f":"#ff2e24"),i["g_redPt_"+(i.curObj.type-1)].visible=0<i.curObj.curTiems,i.refreshRedPt(),i.btn_invest.mouseEnabled=!1,i.btn_invest.gray=!0},i.onPlayLoop=function(){for(var e=this,t=0,i=e.Rotation_Config.length-1;0<=i;){var n=e.Rotation_Config[i];if(e._numRound>=n[0]){t=n[1];break}i--}if(360<=e._numAngle&&(e._numAngle-=360,e._numRound++),e._numRound>=e.RUN_ROUND){if(e._drawAngle<0)for(var s=0;s<e._idsArr.length;s++)if(e._currentRecord==e._idsArr[s]){e._drawAngle=45*s,0==s&&(e._drawAngle=1);break}if(0<e._drawAngle){var o=e._drawAngle-e._numAngle;if(0<=o&&o<=t)return e._numAngle=e._drawAngle,e._drawing=!1,e.g_arrow.rotation=e._numAngle,G.timer.clear(e,e.onPlayLoop),void e.onPlayEnd()}}e._numAngle+=t,e.g_arrow.rotation=e._numAngle},i.initArrowPos=function(e){for(var t=0;t<this._idsArr.length;t++)if(e==this._idsArr[t]){this._drawAngle=45*t,0==t&&(this._drawAngle=1);break}this.g_arrow.rotation=this._drawAngle},i.onPlayEnd=function(){this.shankCnt=0,G.timer.loop(120,this,this.onShank),this.curObj&&(this.goToPos(JP.investSerid),WB.reqInvestDrop(this.curObj.type,JP.investSerid),this.curObj=JP.investHash.take(this.curObj.type),this.setInvestState())},i.onShank=function(){8<this.shankCnt&&this.onShankEnd(),this.shankCnt++},i.onShankEnd=function(){this.lockMask(!1),G.timer.clear(this,this.onShank),JP.isPlaying=!1,JP.investSerid=-1},i.lockMask=function(e){hN.ins.lockMask("Re_InvestView",e),this.btn_invest.mouseEnabled=!e,this.btn_invest.gray=e},t.NAME="Re_InvestView",t}(),x2=function(e){function t(){var e=this;e.curVo=null,e.curItem=null,e.d_Items=null,e.l_Items=null,e.loginArr=null,e.daysArr=null,e._BAR_W=0,e._curLogin=0,e._maxLogin=0,e.posX=[193,339,560],t.__super.call(e)}b(t,"modules.activity.views.returns.Re_LoginView",Py);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.b_time.height=38,t.b_time.centerX=130,t.b_time.y=305,t.txt_time.align="right",t.txt_time.pos(-85,7),t._BAR_W=t.bar.width,t.g_gold.visible=t.g_got.visible=t.btn_sign.visible=!1,t.btn_sign.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.curVo=null,t.curItem=null,t.actInfo=null,t.btn_sign.off("click",t,t.onClickHandler);var i=0;for(i=0;i<t.d_Items.length;i++)t.d_Items[i]&&(t.d_Items[i].off("change",t,t.onChangeHandler),t.d_Items[i].removeSelf(),t.d_Items[i].destroy(),t.d_Items[i]=null);for(t.d_Items.splice(0,t.d_Items.length),i=0;i<t.l_Items.length;i++)t.l_Items[i]&&(t.l_Items[i].removeSelf(),t.l_Items[i].destroy(),t.l_Items[i]=null);t.l_Items.splice(0,t.l_Items.length)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){"object"==typeof e&&e.pType&&1==e.pType&&(this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){e.resetrShow();var t=e.actInfo.gifts;if(t&&!(t.length<1)){e.loginArr=[],e.daysArr=[];for(var i=0;i<t.length;i++)"LOGIN_DAY"==xn.MODEL.targetParamType1(t[i].index)?(e.loginArr.push(t[i]),t[i].targetValue>e._maxLogin&&(e._maxLogin=t[i].targetValue),t[i].currentNum>e._curLogin&&(e._curLogin=t[i].currentNum)):e.daysArr.push(t[i]);e.setLoginData(),e.setDailyData();var n=e._curLogin/e._maxLogin;1<n&&(n=1);var s=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);s.width=e._BAR_W*n,e.bar.scrollRect=s;var o=RP.n[1463];o+=Ql.createColor(e._curLogin+"/"+e._maxLogin,"#e6d80d"),o+="天，",o+=Ql.createColor(RP.n[1464],"#e6d80d"),o+=RP.n[1465],e.txt_tip.innerHTML=o}}},i.setLoginData=function(){var e=this;e.l_Items=e.l_Items||[];for(var t=0;t<e.loginArr.length;t++){var i;e.l_Items[t]?i=e.loginArr[t]:(i=new qz(e.acitivityId),e.posX[t]&&i.pos(e.posX[t],390),e.addChild(i),e.l_Items.push(i)),i.dataSource=e.loginArr[t]}},i.setDailyData=function(){var e=this;e.d_Items=e.d_Items||[];for(var t=0,i=0;i<e.daysArr.length;i++){var n;e.d_Items[i]?n=e.d_Items[i]:(n=new Fz,i<4?n.pos(49+160*i,529):n.pos(119+170*(i-4),765),e.addChild(n),e.d_Items.push(n)),n.dataSource=e.daysArr[i],n.on("change",e,e.onChangeHandler),0==t&&1==e.daysArr[i].status&&(t=i)}e.onChangeHandler(e.d_Items[t])},i.onChangeHandler=function(e,t){var i=this;if(void 0===t&&(t=!1),e&&(t||!i.curVo||i.curVo.giftId!=e.gvo.giftId)){i.curVo=e.gvo,i.curItem=e,0==i.curVo.status&&1==i.curVo.currentNum?i.g_gold.visible=!0:i.g_gold.visible=!1,i.g_got.visible=2==i.curVo.status,i.btn_sign.visible=!i.g_got.visible,i.btn_sign.label=i.g_gold.visible?RP.n[1466]:RP.n[1467],i.g_gold.visible&&(i.txt_gold.changeText(i.curVo.costGold.toString()),i.txt_gold.color=gR.ins.YB>=i.curVo.costGold?"#23b11f":"#ff2e24");for(var n=0;n<i.d_Items.length;n++){var s=i.d_Items[n];s&&s.resetSelect(i.curVo.giftId)}}},i.onClickHandler=function(e){var t=this;if(t.curVo)return 0==t.curVo.status&&1==t.curVo.currentNum?t.g_gold.visible&&gR.ins.YB<t.curVo.costGold?void KQ.ins.showNoGold():void WB.reqPlayerLogin(t.curVo.giftId,ql.create(t,t.onRefresh,[t.curVo.giftId])):void WB.reqPlayerAward(t.curVo.giftId,ql.create(t,t.onRefresh,[t.curVo.giftId]))},i.onRefresh=function(e){if(this.curItem){var t=mB.getInStance().getActivityData(this.acitivityId);t&&(this.curVo=t.getGift(e),this.curItem.dataSource=this.curVo,this.onChangeHandler(this.curItem,!0)),this.curItem.goToPos()}},t}(),S2=function(e){function t(){this._BAR_W=0,this._curNum=0,this._maxNum=0,this.l_Items=null,this.posX=[65,180,325,572],this.taskHash=null,t.__super.call(this)}b(t,"modules.activity.views.returns.Re_TaskView",Ny);var i=t.prototype;return i.initialize=function(){this.list.itemRender=jz,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.addChildAt(this.g_line,0),this.addChildAt(this.g_bg,0)},i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.b_time.height=38,t.b_time.centerX=130,t.b_time.y=312,t.txt_time.align="right",t.txt_time.pos(-85,7),t._BAR_W=t.bar.width;for(var i=0;i<3;i++)t["g_item_"+i].name=(i+1).toString(),t["g_item_"+i].on("click",t,t.onClickHandler);t.list.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.actInfo=null;for(var i=0;i<3;i++)t["g_item_"+i].off("click",t,t.onClickHandler);for(t.list.scrollBar.off("change",t,t.onScrollChanged),i=0;i<t.l_Items.length;i++)t.l_Items[i]&&(t.l_Items[i].removeSelf(),t.l_Items[i].destroy(),t.l_Items[i]=null);t.l_Items.splice(0,t.l_Items.length)},i.destroy=function(e){void 0===e&&(e=!0),modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){"object"==typeof e&&e.pType&&1==e.pType&&(this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){e.resetrShow(),WB.reqTaskInfo(e.acitivityId);var t=e.actInfo.gifts;t&&(e._curNum=t[t.length-1].currentNum,e._maxNum=t[t.length-1].targetValue);var i=e._curNum/e._maxNum;1<i&&(i=1);var n=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);n.width=e._BAR_W*i,e.bar.scrollRect=n,e.setTaskScore(t)}},i.setTaskScore=function(e){this.l_Items=this.l_Items||[];for(var t=0;t<e.length;t++){var i;this.l_Items[t]?i=e[t]:(i=new qz(this.acitivityId),this.posX[t]&&i.pos(this.posX[t],53),this.d_box.addChild(i),this.l_Items.push(i)),i.dataSource=e[t]}},i.updateTaskList=function(e){this.taskHash=new jl;var t=e,i=0,n=0,s=0,o=[];for(s=0;s<t.length;s++)i=Ut.getIndex(t[s].taskid),n=Ut.MODEL.taskMainType(i),this.taskHash.take(n)?this.taskHash.take(n).list.push(t[s]):(this.taskHash.put(n,{type:n,list:[t[s]]}),o.push(Ut.MODEL.taskMainName(i)));for(s=0;s<o.length;s++)this["g_tname_"+s].changeText(o[s]);this.setTaskLsit(this.initIndex)},i.getIsOver=function(e){for(var t=0;t<e.length;t++){var i=Ut.getIndex(e[t].taskid),n=Ut.MODEL.targetMaxTimes(i);if(e[t].currentNum<n)return!1}return!0},i.onClickHandler=function(e){this.setTaskLsit(parseInt(e.currentTarget.name))},i.setTaskLsit=function(e){this.taskHash.take(e)&&(this.list.dataSource=this.taskHash.take(e).list,this.list.scrollTo(0)),this.g_select.x=this["g_item_"+(e-1)].x;for(var t=0;t<3;t++)this["g_tname_"+t]&&(this["g_tname_"+t].color=t==e-1?"#fff9b4":"#91856d")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},p(0,i,"initIndex",function(){var e;for(var t in this.taskHash.proto)if(e=this.taskHash.proto[t],!this.getIsOver(e.list))return e.type;return 1}),t}(),k2=function(e){function t(){var e=this;e._keyGrid=null,e.times=0,e.moneyIcon=null,e._recordTime=NaN,t.__super.call(e),e.list.itemRender=vW,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=100,e.list.scrollBar.elasticBackTime=300,e._keyGrid=new MF,e._keyGrid.needGridBg=!1,e.key_icon.addChild(e._keyGrid),e._keyGrid.size(e.key_icon.width+5,e.key_icon.height+5),e._keyGrid.bindData=yB.create(60650,1),e.key_num.style.wordWrap=!1}b(t,"modules.activity.views.tehui.ActivityMysteryView",M);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.hde_times.style.font="SimHei",t.hde_times.style.fontFamily="SimHei",t.hde_times.style.fontSize=24,t.hde_times.style.wordWrap=!1,t.hde_times.style.color="#a19980",t.hde_times.style.align="center",t.hde_times.width=220,t.hdv_timer.innerHTML="",t.btn_refresh.on("click",t,t.reqRefresh)},i.onRemove=function(e){modules.activity.views.os.OS_BaseView.prototype.onRemove.call(this,e),this.btn_refresh.off("click",this,this.reqRefresh),this.list.array=null},i.reqRefresh=function(e){this.times=this.getLeftTime();var t=TR.ins.getGoodsNum(60650),i=0,n=0;if(this.times<=0)i=n=0;else if(0<t)i=60650,n=1;else if(gR.ins.YB<200)return void KQ.ins.showNoGold();if(this.actInfo){var s=new CM;s.costId=i,s.costNum=n,s.activityId=this.actInfo.activityId,Tu.sendToService(s)}},i.updateBagItem=function(){var e=TR.ins.getGoodsNum(60650),t="#23b11f";0==e&&(t="#ff2e24"),this.key_num.innerHTML=Ql.createColor(e+"/1",t)+"）"},i.hideByVSC=function(e,t){G.timer.clearAll(this)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&(e._recordTime=pt.now(),e.list.array=e.actInfo.shopitemList,e.showLeftRefreshTime(),e.showLeftTime(),G.timer.loop(1e3,e,e.showLeftTime),e.updateBagItem(),e.resetrShow())},i.showLeftRefreshTime=function(){0==this.actInfo.refreshtime?(this.btn_refresh.label=RP.n[967],this.cost.visible=!1,this.hde_times.visible=!1):(this.btn_refresh.label="刷 新",this.hde_times.visible=!1,this.cost.visible=!0,this.txt_refreshCost.text="200")},i.showLeftTime=function(){var e=this,t=e.getLeftTime();t<=1e3?(e.hdv_timer.visible=!1,e.btn_refresh.label=RP.n[967],e.cost.visible=!1,e.hde_times.visible=!1,e.times=0,e.btn_refresh.showTip=!0):(e.hdv_timer.visible=!0,t-=1e3,e.parent&&(e.hdv_timer.innerHTML=RP.n[1470]+Ql.createColor(Jp.getHMSTimeString(t/1e3),"#23b11f")),e.btn_refresh.showTip=!1)},i.getLeftTime=function(){var e=pt.now();return this.actInfo.refreshtime-Math.floor(e-this._recordTime)},t}(),E2=function(e){function t(){this._circleMask=null,this._currentSelectedIndex=0,this.curlistArr=null,t.__super.call(this)}b(t,"modules.activity.views.tehui.ActivityTehuiView",N);var i=t.prototype;return i.initialize=function(){var e=this;e.list.itemRender=Cz,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.setChildIndex(e.g_blod,2),e.g_fontBg.height=128,e.txt_tip.innerHTML="提升"+Ql.createColor("VIP","#e6d80d")+RP.n[1437]+Ql.createColor(RP.n[1438],"#e6d80d"),e.list_gift.hScrollBarSkin="",e.list_gift.scrollBar.elasticBackTime=300,e.list_gift.scrollBar.elasticDistance=100,e.list_gift.scrollBar.on("end",e,e.onScrollEnd),e.list_gift.renderHandler=new ql(e,e.onListRender),e.list_gift.selectHandler=new ql(e,e.onSelect),e.list_gift.selectEnable=!0},i.onListRender=function(e,t){t==this.list_gift.selectedIndex?e.img_select.visible=!0:e.img_select.visible=!1;var i="ui/images/activity/tehui/";if(e.img_select.skin=_r.getFullUrl(i+"vip_lb_img_xzgq.png"),this.curlistArr&&this.curlistArr[t]){var n=this.curlistArr[t].split(",")[1],s=this.curlistArr[t].split(",")[0];e.img_grid.skin=_r.getFullUrl(i+"giftIcon_"+s+".png"),e.txt_vg.changeText(n)}e.img_grid.scale(.83,.83),e.img_point.visible=!1;this._circleMask=new pp,this._circleMask.graphics.drawCircle(49,48,43,"#010101"),this._circleMask.pos(0,0),e.img_grid.mask=this._circleMask},i.onSelect=function(e){if(this._currentSelectedIndex=e,this.curlistArr){var t=parseInt(this.curlistArr[e].split(",")[0]);this.setCurGiftID(t)}},i.setCurGiftID=function(e){var t,i=0,n=[];if(this.actInfo&&this.actInfo.gifts)for(i=0;i<this.actInfo.gifts.length;i++)(t=this.actInfo.gifts[i])&&zi.MODEL.goodsType(zi.getIndex(t.giftId))==e&&n.push(t);n=n.sort(JP.sortArray),this.list.dataSource=n},i.getNeedShowNext=function(){var e,t=0,i=0,n=[],s=0,o=0;for(t=0;t<this.curlistArr.length;t++){if(this.curlistArr[t]){for(o=parseInt(this.curlistArr[t].split(",")[0]),i=0;i<this.actInfo.gifts.length;i++)(e=this.actInfo.gifts[i])&&zi.MODEL.goodsType(zi.getIndex(e.giftId))==o&&n.push(e);for(i=0;i<n.length;i++)if((e=n[i]).status<2){s=0;break}}if(0==s)return-1}return t>=this.curlistArr.length&&(t=0),t},i.onClick=function(e){var t=this;if("next"==e.target.name){var i=t.list_gift.startIndex+4;i>=t.list_gift.length&&(i=t.list_gift.length-1),t.list_gift.startIndex!=i&&t.list_gift.tweenTo(i,150*(i-t.list_gift.startIndex),ql.create(t,t.onScrollEnd))}else"prev"==e.target.name&&((i=t.list_gift.startIndex-4)<0&&(i=0),0==t.list_gift.startIndex&&(t.list_gift.startIndex=1),t.list_gift.startIndex!=i&&t.list_gift.tweenTo(i,150*(t.list_gift.startIndex-i),ql.create(t,t.onScrollEnd)))},i.onScrollEnd=function(){0==this.list_gift.scrollBar.value?this.btn_prev.visible=!1:this.btn_prev.visible=!0,this.list_gift.scrollBar.value==this.list_gift.scrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.onAdd=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onAdd.call(t,e),t.txt_link.on("click",t,t.onClickHandler),t.btn_prev.on("click",t,t.onClick),t.btn_next.on("click",t,t.onClick),t.list.scrollBar.on("change",t,t.onScrollChanged),t.btn_prev.visible=!1,t.btn_next.visible=!0},i.onRemove=function(e){var t=this;modules.activity.views.os.OS_BaseView.prototype.onRemove.call(t,e),t.actInfo=null,t.txt_link.off("click",t,t.onClickHandler),t.list.scrollBar.off("change",t,t.onScrollChanged),t.btn_prev.off("click",t,t.onClick),t.btn_next.off("click",t,t.onClick)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.update(),this.resetrShow())},i.update=function(){this.updateList()},i.updateList=function(){var e=this,t=It.MODEL.goodsType(It.getIndex(e.acitivityId));t&&(e.curlistArr=t.split(";")),e.curlistArr||(e.curlistArr=[]),e.list_gift.array=e.curlistArr,e.list_gift.refresh();var i=e.getNeedShowNext();-1==i&&(i=e._currentSelectedIndex),e.list_gift.selectedIndex=i,e.list_gift.scrollTo(i),e.onSelect(i)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onClickHandler=function(e){Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],0)},t}(),T2=function(e){function t(){var e=this;e.curInfo=null,e._gridPanel=null,e.curBuyNum=0,e.isBargaining=!1,e._cdTime=0,e.tempLog=[],e.selInfo=null,e.getSelectIndex=0,e.MAX_NUM=3,e._gridsList=null,e.gItem=null,e.cItem=null,e.line=null,e._BAR_W=0,e.oriPrice=0,e.lowerPrice=0,e.curPrice=0,e.isSucBuy=!1,e._$10_eTime=NaN,t.__super.call(e)}b(t,"modules.activity.views.sp.Sp_BargainView",qy);var i=t.prototype;return i.initialize=function(){var e=this;e._BAR_W=e.bar.width,e.list.itemRender=zz,e.list.selectEnable=!0,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e._gridPanel||(e._gridPanel=new vj,e._gridPanel.y=20,e._gridPanel._gridW=e._gridPanel._gridH=93,e._gridPanel._spaceX=30,e._gridPanel.size(688,180),e._gridPanel._gnameFont=JP.gnameFont,e._gridPanel._gsimpleName=!0,e._gridPanel._hScrollBarSkin=null,e._gridPanel._vScrollBarSkin=null,e._gridPanel._gnameY=e._gridPanel._gridH+4,e.b_sp.addChild(e._gridPanel)),e.logList.itemRender=XF,e.logList.vScrollBarSkin="",e.logList.spaceY=10,e.logList.scrollBar.elasticDistance=200,e.g_poster.skin=_r.getOsNewPath("sp/other/pxx_text_msz1")},i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.setPoster(!0),t.on("click",t,t.onClickHandler),t.txt_help.on("click",t,t.onClickHandler),t.btn_hand.on("click",t,t.onClickHandler),t.txt_link.on("click",t,t.onClickHandler),t.txt_link_1.on("click",t,t.onClickHandler),t.txt_link_2.on("click",t,t.onClickHandler);for(var i=0;i<3;i++)t["g_rect_"+i].on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.curInfo=null,ZP.actInfo=null,t.b_gift.visible=t.b_pro.visible=!1,t.clearTime(),G.timer.clear(t,t.onClearIds),t.line&&t.line.graphics.clear(),t.off("click",t,t.onClickHandler),t.btn_hand.off("click",t,t.onClickHandler),t.txt_help.off("click",t,t.onClickHandler),t.txt_link.off("click",t,t.onClickHandler),t.txt_link_1.off("click",t,t.onClickHandler),t.txt_link_2.off("click",t,t.onClickHandler);for(var i=0;i<3;i++)t["g_rect_"+i].off("click",t,t.onClickHandler)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._gridPanel&&(t._gridPanel.destroy(e),t._gridPanel=null),t._gridsList&&(t._gridsList.destroy(e),t._gridsList=null),t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.cItem&&(t.cItem.parent&&t.cItem.parent.removeChild(t.cItem),t.cItem.destroy(),t.cItem=null),modules.activity.views.sp.Sp_Base.prototype.destroy.call(t,e)},i.showByVSC=function(e,t){this.acitivityId=t,0<bn.count?this.onJxrComplete():uc.ins().onLoadJxrs([{url:_r.getJxrDBPath("PinXiXiComResource"),type:"arraybuffer",cls:bn}],ql.create(this,this.onJxrComplete))},i.onJxrComplete=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),ZP.actInfo=e.actInfo,e.actInfo){e.actInfo.endTime,dr.serverTimeSec;e.b_time.pos(400,281),e.g_fbg.visible=!1,e.txt_time.pos(250,7),e.txt_time.align="left",e.resetrShow(),ZP.reqBargainInfo(ql.create(e,e.setListView))}G.timer.once(1e3,e,e.onClearIds)},i.onClearIds=function(){ZP.isFrtRedPt=!1,G.timer.clear(this,this.onClearIds)},i.onClickHandler=function(e){var t=this;if(!(BB.getTimer()-t._cdTime<500))switch(t._cdTime=BB.getTimer(),e.target){case t.btn_help:case t.txt_help:QR.goToOpenHelpDes(21);break;case t.btn_pro:t.setPoster(),t.setBargainView();break;case t.btn_bargain:t.setPoster(),t.curInfo&&null==t.curInfo.info?ZP.reqBargain(t.curInfo.gvo.giftId,parseInt(gR.ins.charId),0,ql.create(t,t.setListView,[t.curInfo.gvo.giftId])):t.setBargainView(t.curInfo.gvo.giftId);break;case t.btn_gift:t.setPoster(!0),t.isSucBuy&&(t.curInfo=null,t.tempLog=[],t.onJxrComplete());break;case t.txt_link_1:case t.txt_link_2:t.setPoster(!0);break;case t.btn_friend:if(!vN.ins.joinGuild)return void zB.ins.showById(2031,1);if(!t.selInfo)return;ZP.reqFriendsHand(t.selInfo.giftId,ql.create(t,t.onFriendHand));break;case t.btn_use:if(!t.selInfo)return;if(!t.b_l.visible)return void ZP.reqBargain(t.selInfo.giftId,parseInt(gR.ins.charId),3,ql.create(t,t.setListView,[t.selInfo.giftId]));if(TR.ins.getGoodsNum(ZP.consumDef)<1)return void zB.ins.showById(104,1);ZP.reqBargain(t.selInfo.giftId,parseInt(gR.ins.charId),1,ql.create(t,t.setListView,[t.selInfo.giftId]));break;case t.btn_buy:if(!t.selInfo)return;if(gR.ins.YB<t.oriPrice-t.selInfo.cutPrice)return void KQ.ins.showNoGold();WB.buyGift(t.selInfo.giftId,ql.create(t,t.onRefresh));break;case t.txt_link:if(!t.selInfo)return;var i=t.getVo(t.selInfo.giftId);if(!i)return;hN.ins.open("SP_BARGAIN_PROMPT",{info:t.selInfo,gvo:i,endTime:t.actInfo.endTime});break;case t.btn_hand:if(!vN.ins.joinGuild)return void zB.ins.showById(2031,1);if(ZP.bargainNum>=ZP.allBargainNum)return void zB.ins.showById(4633,1);hN.ins.open("SP_BARGAIN_GUILD");break;case t.g_rect_0:case t.g_rect_1:case t.g_rect_2:var n=parseInt(e.target.name)-1;if(!t["txt_name_"+n].visible)return;t.resetCurSelect(n)}},i.setPoster=function(e){void 0===e&&(e=!1),this.b_gift.visible=e,this.b_pro.visible=!e},i.getVo=function(e){for(var t=this.list.array,i=0;i<t.length;i++)if(e==t[i].gvo.giftId)return t[i].gvo;return null},i.onRefresh=function(e){var t=this;void 0===e&&(e=!0),t.isSucBuy=!0,t.g_got.visible=!0,t.btn_buy.visible=!1,t.b_l.visible=t.b_r.visible=t.txt_link.visible=!1,t["g_pt_"+t.getSelectIndex]&&(t["g_pt_"+t.getSelectIndex].visible=!1),t.selInfo&&e&&t.tempLog.push(t.selInfo.giftId),t.refreshTabRedPt()},i.setListView=function(e){var t=this;void 0===e&&(e=0),0<e&&t.refreshTabRedPt();for(var i=[],n=t.actInfo.gifts.concat(),s=0;s<n.length;s++)n[s]&&i.push({gvo:n[s],info:ZP.getBargainInfo(n[s].giftId)});i=i.sort(ZP.sortArray),t.curInfo=i[t.initIndex],ZP.gid_select=t.curInfo.gvo.giftId,t.list.dataSource=i,t.btn_pro.visible=t.g_proBg.visible=0<ZP.bargainList.length,t.btn_pro.showTip=ZP.getRateRedPt(),t.curBuyNum=ZP.giftNumLimit-ZP.bargainList.length,t.setCurInfo(),t.b_pro.visible&&t.setBargainView(e)},i.refresh=function(e){if(e)if(e instanceof protos.activity.toc_30808||e instanceof protos.activity.toc_30805)this.onRefreshRedPt();else if(e instanceof protos.activity.toc_30807)this.setHandTimes();else if(e.hasOwnProperty("isBuy"))this.onRefresh();else{for(var t=0;t<this.list.cells.length;t++)this.list.cells[t]&&this.list.cells[t].refresh();this.curInfo=e,this.setCurInfo()}},i.setCurInfo=function(){var e=this;if(e.curInfo&&e.curInfo.gvo){var t=zi.getIndex(e.curInfo.gvo.giftId),i=JP.praseGoodsStr(zi.MODEL.goodsReward(t));e._gridPanel.setGoodsItems(i,1),e._gridPanel.x=(e.b_sp.width-e._gridPanel.contentWidth)/2,e.txt_giftName.changeText(zi.MODEL.dec(t)+"详情");var n=Math.max(e.curInfo.gvo.personalLimit-e.curInfo.gvo.perBuyNum,0);e.g_buyed.visible=n<=0,e.b_bargain.visible=!e.g_buyed.visible,n<=0||(e.isBargaining=null!=e.curInfo.info,e.curInfo.info?(e.btn_bargain.label=RP.n[1474],e.btn_bargain.disabled=!1):(e.btn_bargain.label=RP.n[1473],e.btn_bargain.disabled=e.curBuyNum<=0),e.btn_bargain.showTip=!e.curInfo.info&&0<e.curBuyNum,e.txt_times.innerHTML=RP.n[1475]+Ql.createColor(e.curBuyNum.toString(),0<e.curBuyNum?"#23b11f":"#ff2e24")+"/"+ZP.giftNumLimit+")")}},i.setBargainView=function(e){var t=this;if(void 0===e&&(e=0),t.isSucBuy=!1,t.getSelectIndex=0==e?0:ZP.getSelectIndex(e),t.selInfo=ZP.bargainList[t.getSelectIndex],t.selInfo){for(var i=0,n=!1,s=0;s<t.MAX_NUM;s++)n=s<ZP.bargainList.length,t["g_pt_"+s].visible=t["txt_name_"+s].visible=n,t["txt_link_"+s]&&(t["txt_link_"+s].visible=!n),n&&(i=zi.getIndex(ZP.bargainList[s].giftId),t["txt_name_"+s].changeText(zi.MODEL.dec(i)),t["g_pt_"+s].visible=ZP.getBargainRedPt(ZP.bargainList[s].giftId));t.setHandTimes(),t.setSingleInfo()}},i.setHandTimes=function(){var e=ZP.allBargainNum-ZP.bargainNum;e<0&&(e=0);var t=0<e?"#23b11f":"#ff2e24";this.txt_handTimes.innerHTML=Ql.createColor(RP.n[1476]+e,t)+"/"+ZP.allBargainNum,this.btn_hand.showTip=1==ZP.handRedPt},i.resetCurSelect=function(e){this.getSelectIndex=e,this.selInfo=ZP.bargainList[this.getSelectIndex],this.selInfo&&this.setSingleInfo()},i.setSingleInfo=function(){var e=this;e.g_select.x=e["g_rect_"+e.getSelectIndex].x,e.txt_link.visible=0<e.selInfo.playerList.length;var t=zi.getIndex(e.selInfo.giftId),i=JP.praseGoodsStr(zi.MODEL.goodsReward(t));e.setAwards(i),e.oriPrice=parseInt(zi.MODEL.oriCostGold(t).split(":")[1]),e.lowerPrice=parseInt(zi.MODEL.actCostGold(t).split(":")[1]),e.txt_price.changeText("原价:"+e.oriPrice),e.txt_bgold.changeText(e.selInfo.cutPrice.toString()),e.cp_pay.value=(e.oriPrice-e.selInfo.cutPrice).toString(),e.line||(e.line=new pp,e.b_pro.addChild(e.line)),e.line.graphics.clear(),e.line.graphics.drawLine(154-e.txt_price.textField.textWidth-2,e.txt_price.y+11,e.txt_price.width+2,e.txt_price.y+12,"#90877b",1),e.logList.visible=0<e.selInfo.playerList.length,e.txt_no.visible=!e.logList.visible,e.setBarInfo(),e.logList.dataSource=e.selInfo.playerList,-1<e.tempLog.indexOf(e.selInfo.giftId)?e.onRefresh(!1):(e.curPrice=Math.max(e.oriPrice-e.lowerPrice-e.selInfo.cutPrice,0),e.btn_buy.visible=e.curPrice<=0,e.g_got.visible=!1,e.curPrice<=0?e.b_l.visible=e.b_r.visible=e.txt_link.visible=!1:e.setBtnInfo())},i.setBtnInfo=function(){var e=this;if(e.b_r.visible=!0,e.b_l.visible=0<e.selInfo.playerList.length,!e.b_l.visible)return e.txt_cfont.visible=e.txt_nums.visible=e.txt_useTimes.visible=!1,e.cItem&&(e.cItem.visible=!1),e.btn_use.showTip=!0,void(e.b_r.right=230);e.b_r.right=49,e.txt_cfont.visible=e.txt_nums.visible=e.txt_useTimes.visible=!0,e.cItem||(e.cItem=new MF(45),e.cItem.needGridBg=!1,e.cItem.pos(115,-7),e.cItem.bindData=yB.create(ZP.consumDef),e.b_r.addChild(e.cItem)),e.cItem.visible=!0;var t=TR.ins.getGoodsNum(ZP.consumDef);e.txt_nums.innerHTML=Ql.createColor(t.toString(),0<t?"#23b11f":"#ff2e24")+"/1";var i=ZP.cutUseGoodsLimit-ZP.useTimes;i<0&&(i=0),e.txt_useTimes.innerHTML=RP.n[1477]+Ql.createColor(i.toString(),0<i?"#23b11f":"#ff2e24")+"/"+ZP.cutUseGoodsLimit,e.btn_use.showTip=0<t&&0<i,e.setCdTimes()},i.onFriendHand=function(){zB.ins.showById(4626,1),this.selInfo=ZP.getBargainInfo(this.selInfo.giftId),this.setCdTimes()},i.setCdTimes=function(){var e=this;if(e.selInfo){var t=ZP.callCutLimit-e.selInfo.handNum;t<0&&(t=0),e.txt_ftimes.innerHTML=RP.n[1478]+Ql.createColor(t.toString(),0<t?"#23b11f":"#ff2e24")+"/"+ZP.callCutLimit,e.txt_cdTime.visible=0!=e.selInfo.cdTime,e.btn_friend.disabled=0!=e.selInfo.cdTime,e.btn_friend.showTip=0<t&&!e.btn_friend.disabled,e.txt_cdTime.visible?(e._$10_eTime=e.selInfo.cdTime,e._$10_onResetTime(),0<e._$10_eTime&&G.timer.frameLoop(10,e,e._$10_onResetTime)):e.clearTime(),e["g_pt_"+e.getSelectIndex]&&e.selInfo&&(e["g_pt_"+e.getSelectIndex].visible=ZP.getBargainRedPt(e.selInfo.giftId))}},i.setBarInfo=function(){var e=this,t=e.selInfo.cutPrice/(e.oriPrice-e.lowerPrice);1<t&&(t=1);var i=e.bar.scrollRect||new u_(0,0,e.bar.width,e.bar.height);i.width=e._BAR_W*t,e.bar.scrollRect=i,e.g_pro.width=e.txt_bgold.x+12*e.selInfo.cutPrice.toString().length+15;var n=e.b_pro.width-(e.bar.x+e._BAR_W*t)-74;n<0&&(n=0),e.g_pro.right=n},i.setAwards=function(e){var t=this;if(e&&!(e.length<1)){t.gItem||(t.gItem=new MF,t.sp_award.addChild(t.gItem)),t.gItem.dataSource=e[0];var i=e.slice(1);t._gridsList||(t._gridsList=new vj,t._gridsList.y=595,t._gridsList._gridW=t._gridsList._gridH=93,t._gridsList._spaceX=15,t._gridsList.size(688,180),t._gridsList._gnameFont=JP.gnameFont,t._gridsList._hScrollBarSkin=null,t._gridsList._nameVisible=!1,t._gridsList._vScrollBarSkin=null,t.b_pro.addChildAt(t._gridsList,0)),t._gridsList.setGoodsItems(i,1),t._gridsList.x=(t.b_pro.width-t._gridsList.contentWidth)/2}},i._$10_onResetTime=function(){this._$10_eTime=Math.floor(this.selInfo.cdTime/1e3)-dr.serverTimeSec,0<this._$10_eTime?this.txt_cdTime.innerHTML=Ql.createColor(Jp.getTickNumber(this._$10_eTime),"#23b11f")+RP.n[1479]:this.clearTime()},i.clearTime=function(){var e=this;G.timer.clear(e,e._$10_onResetTime),e.selInfo&&(ZP.resetBargainInfo(e.selInfo.giftId,0),e.btn_friend.showTip=0<ZP.callCutLimit-e.selInfo.handNum&&!e.btn_friend.disabled),e.txt_cdTime.visible=!1,e.btn_friend.disabled=!1,e.onRefreshRedPt()},i.onRefreshRedPt=function(){if(this.btn_pro.showTip=ZP.getRateRedPt(),this.refreshTabRedPt(),this.b_pro.visible){this.btn_hand.showTip=1==ZP.handRedPt;for(var e=0;e<this.MAX_NUM;e++)null!=ZP.bargainList[e]&&(this["g_pt_"+e].visible=ZP.getBargainRedPt(ZP.bargainList[e].giftId))}},i.refreshTabRedPt=function(){Tu.sendToModule("UPDATE_BARGAIN_PEDPT",["modules.activity.ActivityModule"])},p(0,i,"initIndex",function(){if(!this.curInfo)return 0;for(var e=this.list.array,t=0;t<e.length;t++)if(this.curInfo.gvo.giftId==e[t].giftId)return t;return 0}),t}(),C2=function(e){function t(){this.gvo=null,this._gridsList=null,this._gcArr=null,this._avatar=null,this.missionIdx=0,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_BossView",jy);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.sp.Sp_Base.prototype.onAdd.call(this,e),this.b_time.y=230,this.btn_go.on("click",this,this.onClickHandler),this.txt_link.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.actInfo=null,t.btn_go.off("click",t,t.onClickHandler),t.txt_link.off("click",t,t.onClickHandler),t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.missionIdx=0},i.destroy=function(e){void 0===e&&(e=!0),this._gridsList&&(this._gridsList.destroy(e),this._gridsList=null),modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){$P.ins.actId=t,this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){e.img_bg.visible=!0,e.img_bg.skin=_r.getOsNewPath("sp/boss/bg1309",".jpg"),e.resetrShow(),e.setAwards(),e.setbtnRed();var t=$P.ins.toc21272.bossInfo.bossId,i=rn.getIndex(t);e.missionIdx=i;var n=rn.MODEL.bossId(i);i=hn.getIndex(n),e.setAvatar(i)}},i.setbtnRed=function(){var e=$P.ins.toc21272;if(e){var t=e.bossInfo;t&&(0<t.blood?this.btn_go.showTip=!0:this.btn_go.showTip=!1)}else this.btn_go.showTip=!1},i.setAwards=function(){var e=this;e.actInfo&&e.actInfo.gifts&&0<e.actInfo.gifts.length&&(e.gvo=e.actInfo.gifts[0]),e.gvo&&(e.actInfo&&e.actInfo.position&&(e._gcArr=e.actInfo.position.split(",")),e._gcArr&&0<e._gcArr.length&&(e.btn_go.label=e._gcArr[0]),e._gridsList||(e._gridsList=new vj,e._gridsList.y=30,e._gridsList.x=5,e._gridsList._spaceX=13,e._gridsList.size(688,180),e._gridsList._gnameFont=JP.gnameFont,e._gridsList._gsimpleName=!0,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e._gridsList.owerModule=JP.M_GRIDE_NAME,e.box_award.addChild(e._gridsList)),e._gridsList._gnameY=e._gridsList._gridH+20,e._gridsList.setGoodsItems(e.gvo.rewardGoods,1),e._gridsList.x=(e.width-e._gridsList.contentWidth)/2)},i.setAvatar=function(e){var t=this,i=hn.MODEL.muId(e);e=_n.getIndex(i);var n=_n.MODEL.avatarId(e);t._avatar||(t._avatar=new uq,t._avatar.renderInSelf=!0,t._avatar.pos(370,(t.stage.height-t._avatar.height)/2),t.addChild(t._avatar)),t._avatar.mid=n,t._avatar.type=Za.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(5),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(.8,.8)},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_go:var t=rn.MODEL.levelLimit(this.missionIdx);if(gR.ins.lv<t)return void zB.ins.showMsg(RP.n[1480]+t+"开启",1);JP.ins.isLinkToView=0,this._gcArr&&this._gcArr[1]&&JP.goToLink(this._gcArr[1]);break;case this.txt_link:JP.ins.isLinkToView=1;var i=new AA;i.actId=this.acitivityId,Tu.sendToService(i)}},t}(),L2=function(e){function o(){var e=this;e._costGrid=null,e.JF=0,e.times=0,e.moneyIcon=null,e._recordTime=NaN,o.__super.call(e),e.list.itemRender=gW,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=100,e.list.scrollBar.elasticBackTime=300,e._costGrid=new MF,e._costGrid.needGridBg=!1,e._costGrid.needEffect=!1,e.item_icon.addChild(e._costGrid),e._costGrid.size(e.item_icon.width+5,e.item_icon.height+5),e._costGrid.bindData=yB.create(2400,1),e.g_poster.skin=_r.getOsNewPath("sp/other/cjhd_hb_msz")}b(o,"modules.activity.views.sp.ActivityPointsShopView",O);var t=o.prototype;return t.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.hde_times.style.font="SimHei",t.hde_times.style.fontFamily="SimHei",t.hde_times.style.fontSize=24,t.hde_times.style.wordWrap=!1,t.hde_times.style.color="#a19980",t.hde_times.style.align="center",t.hde_times.width=220,t.hdv_timer.innerHTML="",t.btn_refresh.on("click",t,t.reqRefresh),t.txt_desc.on("link",t,t.linked),t.txt_desc.y=140,t.txt_desc.x=115,t.txt_desc.align="right",t.box.mouseThrough=!0},t.onRemove=function(e){modules.activity.views.sp.Sp_Base.prototype.onRemove.call(this,e),this.btn_refresh.off("click",this,this.reqRefresh),this.txt_desc.off("link",this,this.linked),this.list.array=null},t.updateJF=function(){this.JF=TR.ins.getGoodsNum(2400),this.hasitem.innerHTML="+"+this.JF},t.reqRefresh=function(e){this.times=this.getLeftTime();var t=TR.ins.getGoodsNum(60650),i=0,n=0;if(this.times<=0)i=n=0;else if(0<t)i=60650,n=1;else if(gR.ins.YB<200)return void KQ.ins.showNoGold();if(this.actInfo){var s=new OM;s.costId=i,s.costNum=n,s.activityId=this.actInfo.activityId,Tu.sendToService(s)}},t.updateBagItem=function(){TR.ins.getGoodsNum(60650)},t.hideByVSC=function(e,t){G.timer.clearAll(this)},t.showByVSC=function(e,t){this.updateByVSC(t)},t.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},t.onReqBack=function(){var e=this;e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo&&(e.g_fbg.visible=!1,e.txt_time.align="left",e.txt_time.pos(143,-73),e._recordTime=pt.now(),e.list.array=e.actInfo.shopitemList,e.showLeftRefreshTime(),e.btn_refresh.showTip=tH.instance.hasLeftFreeTime(),e.showLeftTime(),G.timer.loop(1e3,e,e.showLeftTime),e.updateBagItem(),e.resetrShow(),e.updateJF(),e.addChild(e.showitem),e.addChild(e.list))},t.linked=function(e){var t=e;if("0"!=t&&0==t.search(o.hrefReg)){var i=t.indexOf("#"),n=parseInt(t.substring(0,i)),s=(t=t.substring(i+1)).split("|");10==n&&CN.getAIconOpen(parseInt(s[0]))&&CN.dealActIcon(CN.getIconBtn(s[0]))}},t.showLeftRefreshTime=function(){0==this.actInfo.refreshtime?(this.btn_refresh.label=RP.n[967],this.cost.visible=!1,this.hde_times.visible=!1):(this.btn_refresh.label="刷 新",this.hde_times.visible=!1,this.cost.visible=!0,this.txt_refreshCost.text="200")},t.showLeftTime=function(){var e=this,t=e.getLeftTime();t<=1e3?(e.hdv_timer.visible=!1,e.btn_refresh.label=RP.n[967],e.cost.visible=!1,e.hde_times.visible=!1,e.times=0,e.btn_refresh.showTip=!0):(e.hdv_timer.visible=!0,t-=1e3,e.parent&&(e.hdv_timer.innerHTML=RP.n[1483]+Ql.createColor(o.getHMSTimeString(t),"#23b11f")))},t.getLeftTime=function(){var e=pt.now();return this.actInfo.refreshtime-Math.floor(e-this._recordTime)},o.getHMSTimeString=function(e){var t=e/1e3,i=Math.floor(t/3600),n=10<=i?i.toString():"0"+i.toString(),s=Math.floor((t-3600*i)/60),o=10<=s?s.toString():"0"+s.toString(),a=Math.floor(t-3600*i-60*s);return n+":"+o+":"+(10<=a?a.toString():"0"+a.toString())},f(o,["hrefReg",function(){return this.hrefReg=/([0-9]+)#/g}]),o}(),M2=function(e){function t(){this._gcArr=null,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_CrackerView",Xy);var i=t.prototype;return i.initialize=function(){this.list.itemRender=Zz,this.list.vScrollBarSkin=""},i.onAdd=function(e){modules.activity.views.sp.Sp_Base.prototype.onAdd.call(this,e),this.btn_kill.on("click",this,this.onClickHandler)},i.onRemove=function(e){modules.activity.views.sp.Sp_Base.prototype.onRemove.call(this,e),this.actInfo=null,this.btn_kill.off("click",this,this.onClickHandler)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack));var t=wt.getIndex(this.acitivityId);wt.MODEL.desc(t)&&this.txt_tip.changeText(wt.MODEL.desc(t))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){if(e.resetrShow(),e.actInfo.exchangeList){var t=e.actInfo.exchangeList.concat();t&&0<t.length&&(t=t.sort(JP.sortArray),e.list.dataSource=t,e.list.tweenTo(0))}e.actInfo.position&&(e._gcArr=e.actInfo.position.split(",")),e._gcArr&&0<e._gcArr.length&&(e.btn_kill.label=e._gcArr[0])}},i.refresh=function(e){if(e&&e instanceof protos.backpack.BackPack_Back_Echange_toc_23621){var t=!1;if(this.list&&this.list.cells){var i=0;for(i=0;i<this.list.cells.length;i++){var n=this.list.getCell(i);n&&(n.exchangeId==e.exchangeID?n.refresh(e.num):n.setExchagne())}for(i=0;i<this.list.cells.length;i++){var s=this.list.getCell(i);if(s&&s.isEnough){t=!0;break}}}Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:this.acitivityId,redPt:t,mType:this.mainType})}},i.onClickHandler=function(e){this._gcArr&&1<this._gcArr.length&&JP.goToLink(this._gcArr[1])},t}(),A2=function(e){function t(){var e=this;e.g_cost=0,e.index=0,e.awardList=null,e.g_items=null,e._gbox=null,e.GRAP_X=149,e.GRAP_Y=173,e.countfire=0,e.intervalTime=20,t.__super.call(e),e._gbox||(e._gbox=new dt,e._gbox.pos(0,560),e.addChild(e._gbox))}b(t,"modules.activity.views.sp.Sp_FireworksView",Ky);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.btn_works.on("click",t,t.onClickHandler),t.txt_link.on("click",t,t.onClickHandler),t.txt_jilu.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.btn_works.off("click",t,t.onClickHandler),t.txt_link.off("click",t,t.onClickHandler),t.txt_jilu.off("click",t,t.onClickHandler),t._gbox&&t._gbox.graphics.clear(),t.clearItems(),G.timer.clear(t,t.playFirework),Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:t.acitivityId,redPt:!1,mType:t.mainType})},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.resetrShow(),this.update(),this.img_bg.visible=!0,this.img_bg.skin=_r.getOsNewPath("sp/bg/kfhd_jm_db",".jpg"))},i.update=function(){if(0<xt.count)this.onJxrComplete();else{var e=[{url:_r.getJxrDBPath("ConfigChunJieYanhuo"),type:"arraybuffer",cls:xt}];uc.ins().onLoadJxrs(e,ql.create(this,this.onJxrComplete))}},i.onJxrComplete=function(){this._$10_index=xt.getIndex(this.acitivityId);var e=xt.MODEL.consumptionDef(this._$10_index);if(e){var t=JSON.parse(e);if(t&&0<t.length)for(var i=0;i<t.length;i++)if("res"==t[i].type){var n=t[i].value.toString().split(":");n&&1<n.length&&"GOLD"==n[0]&&(this.g_cost=n[1])}}this.txt_gold.innerHTML=this.g_cost.toString(),this.setAwards()},i.setAwards=function(){var e=this;e.clearItems(),e.g_items=[],e._gbox&&e._gbox.graphics.clear(),e.awardList=JP.praseGoodsStr(xt.MODEL.showAward(e._$10_index));var t=e.awardList.slice(0,8);if(t&&!(t.length<=0))for(var i=0;i<t.length;i++)if(t[i]){var n=new MF;n.bindData=t[i],n.pos(78+i%4*e.GRAP_X,Math.floor(i/4)*e.GRAP_Y),e.g_items.push(n),e._gbox.addChild(n);var s=Bi.MODEL.simpleName(Bi.getIndex(t[i].goodsId)),o=ms.getByQuality(Bi.MODEL.colourId(Bi.getIndex(t[i].goodsId)));e._gbox.graphics.fillText(s,n.x+57,n.y+130,"20px SimHei",o,"center")}},i.clearItems=function(){var e=this;if(e.g_items&&0<e.g_items.length){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.onClickHandler=function(e){if(!(xt.count<=0))switch(e.currentTarget){case this.btn_works:if(gR.ins.YB<this.g_cost)return void Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"]);if(TR.ins.getLeftGridNumMore20())return void(0==hN.ins.isOpen("RECYCLE")&&KQ.ins.showBagRecycle());if(JP.isShowFireTips)WB.reqFireworks(this.acitivityId);else{var t=JP.praseGoodsStr(xt.MODEL.costGoods(this._$10_index));hN.ins.open("SP_FIREWORKS_PROMPT",{awards:t,activityId:this.acitivityId})}break;case this.txt_link:hN.ins.open("SP_FIREWORKS_PREVIEW",this.awardList);break;case this.txt_jilu:var i=new AM;Tu.sendToService(i)}},i.refresh=function(e){e&&(e instanceof protos.activity.toc_12229&&1==e.result&&this.playFireworkEffect(),e instanceof protos.activity.toc_12235&&this.goToPos(e.gList))},i.goToPos=function(e){if(e&&!(e.length<1)){for(var t=[],i=0;i<e.length;i++)e[i]&&t.push(e[i].gId);var n=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(t,new Uh(n.x,n.y))}},i.playFireworkEffect=function(){for(var e=80,t=this.countfire=0;t<6;t++)G.timer.once(e,this,this.playFirework,null,!1),e=20+Math.ceil(180*Math.random())},i.playFirework=function(){var e;(e=mj.GetNew()).renderInSelf=!0,e.loadEffect("jm1314"),e.playEndHandler=ql.create(this,this.effEnd,[e]),e.setXY(150+Math.ceil(400*Math.random()),300+Math.ceil(200*Math.random())),this.addChild(e)},i.effEnd=function(e){e&&e.parent&&e.parent.removeChild(e),e&&e.dispose(),e=null},t}(),D2=function(e){function t(){this.gvo=null,this._grids=null,this.lastTime=0,this._effect=null,this._effArr=null,this.imgDesc=null,this.imgDesc1=null,t.__super.call(this),this.initUI()}b(t,"modules.activity.views.sp.Sp_RechargeView",$y);var i=t.prototype;return i.initUI=function(){var e=this;e._grids=new wj(3,2,116,40,75,!1,null,100,!0,!1),e._grids.isCenter=!0,e._grids.pos(357,415),e._grids.height+=40,e._grids.vScrollBarSkin="",e._grids.vScrollBar.elasticDistance=0,e.addChild(e._grids),e._effArr=[],e.addChild(e.btn_get)},i.onAdd=function(e){modules.activity.views.sp.Sp_Base.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onClickHandler)},i.onRemove=function(e){modules.activity.views.sp.Sp_Base.prototype.onRemove.call(this,e),this.actInfo=null,this.btn_get.off("click",this,this.onClickHandler),G.timer.clear(this,this.showTime)},i.destroy=function(e){if(void 0===e&&(e=!0),this._effect&&(this._effect.dispose(),this._effect=null),this._effArr){for(var t=this._effArr.length,i=0;i<t;i++){this._effArr[i].dispose()}this._effArr=null}modules.activity.views.sp.Sp_Base.prototype.destroy.call(this,e)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){"object"==typeof e&&e.pType&&1==e.pType?(this.acitivityId=e.aId,WB.reqPlayerActivity(this.acitivityId,ql.create(this,this.onReqBack))):(this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack)))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){if(e.resetrShow(),e.b_title.visible=!1,e.actInfo&&28==e.actInfo.mainType&&(null==e.imgDesc&&(e.imgDesc=new Kl),null==e.imgDesc.parent&&(e.addChild(e.imgDesc),e.imgDesc.x=175,e.imgDesc.y=216,e.imgDesc.skin=mB.getInStance().getActiveDescPath(e.acitivityId)),null==e.imgDesc1&&(e.imgDesc1=new Kl),null==e.imgDesc1.parent)){var t=e.getChildIndex(e.num);e.addChildAt(e.imgDesc1,t-1),e.imgDesc1.x=57,e.imgDesc1.y=115,e.imgDesc1.skin=_r.getOsNewPath("title/cqqd_czhl_msz")}e.updateData()}},i.updateData=function(){for(var e=this,t=e.actInfo.gifts,i=0;i<t.length;i++)if(t[i].status<2&&0<=t[i].status){e.gvo=t[i];break}null==e.gvo&&(e.gvo=t[t.length-1]),null!=e.gvo&&(e.setAwards(),e.updateBtnStatus(),e.setPanel(),e.setTime(),e.num.value=e.gvo.targetValue.toString())},i.setPanel=function(){this.mainType=JP.c_mainType,this.box_time.y=983,this.num.pos(190,150);for(var e=1;e<4;e++)this["hg"+e+"_1"].width=320,this["hg"+e+"_1"].skin=_r.getOsNewPath("sp/other/taijie_"+this.mainType);this.img_LB.skin=_r.getOsNewPath("sp/other/lbname_"+this.mainType)},i.setAwards=function(){this._grids.gridDatas=this.gvo.rewardGoods;var e=this.gvo.rewardGoods;if(e&&0<e.length){for(var t=0;t<e.length;t++){var i=e[t].goodsId,n=Bi.getIndex(i);this["name"+t].text=Bi.MODEL.name(n),this["name"+t].color=ms.getByQuality(Bi.MODEL.colourId(n))}if(e.length<6)for(var s=e.length;s<6;s++)this["name"+s].text=""}},i.setTime=function(){this.lastTime=this.actInfo.endTime-dr.serverTimeSec,this.showTime(),G.timer.loop(1e3,this,this.showTime,null,!0)},i.showTime=function(){this.lastTime<=0?G.timer.clear(this,this.showTime):(this.lastTime--,this.txt_time2.text=RP.n[1484]+Jp.getSTRDHMS(this.lastTime))},i.updateBtnStatus=function(){var e=this;1<e.gvo.status?(e.btn_get.label="已领取",e.btn_get.showTip=!1,e.btn_get.disabled=!0,e._effect&&(e._effect.dispose(),e._effect=null)):(e.btn_get.disabled=!1,1==e.gvo.status?(e.btn_get.label=RP.n[935],e.btn_get.showTip=!1,null==e._effect&&(e._effect=mj.GetNew(),e._effect.loadEffect("jm1242"),e._effect.renderInSelf=!0,e._effect.setXY(e.btn_get.x+e.btn_get.width/2,e.btn_get.y+e.btn_get.height/2),e.addChild(e._effect))):(e._effect&&(e._effect.dispose(),e._effect=null),e.btn_get.label=RP.n[1486],e.btn_get.showTip=!1))},i.onClickHandler=function(e){var t=this;t.gvo.recharge<t.gvo.targetValue?HN.ins.toc_recharge.canGet<2?hN.ins.open("FIRST_RECHARGE",null,0):Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],0):0==t.actInfo.isPlayerAct?WB.getGift(t.gvo.giftId,ql.create(t,t.onRefresh,[t.gvo.giftId])):WB.reqPlayerAward(t.gvo.giftId,ql.create(t,t.onRefresh,[t.gvo.giftId]))},i.onRefresh=function(e){var t=mB.getInStance().getActivityData(this.acitivityId);if(t){var i=t.getGift(e);i&&(this.gvo=i,this.setAwards(),this.updateBtnStatus(),this.goToPos())}},i.goToPos=function(){if(this.gvo){var e,t=this.gvo.goodsReward;if(t&&(e=t.split(";")),e&&!(e.length<1)){for(var i=[],n=0;n<e.length;n++)if(t=e[n]){var s=t.split(",");i.push(parseInt(s[0]))}var o=this.localToGlobal(new Uh(this.width>>1,this.height>>1));zB.ins.playGetItemsByPos(i,new Uh(o.x,o.y))}}},t}(),O2=function(e){function t(){this.w_list=null,this.posArr=[[461,530],[277,461],[100,390],[251,258]],t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_TreePickPreviewView",nI);var i=t.prototype;return i.onAdd=function(e){modules.activity.views.sp.Sp_Base.prototype.onAdd.call(this,e),this.btn_pick.on("click",this,this.onClickHandler),this.txt_link.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;if(modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.w_list){for(var i=0;i<t.w_list.length;++i)t.w_list[i]&&(t.w_list[i].parent&&t.w_list[i].parent.removeChild(t.w_list[i]),t.w_list[i].destroy(),t.w_list[i]=null);t.w_list.splice(0,t.w_list.length),t.w_list=null}t.actInfo=null,t.btn_pick.off("click",t,t.onClickHandler),t.txt_link.off("click",t,t.onClickHandler)},i.showByVSC=function(e,t){this.acitivityId=t,0<Zn.count?this.onJxrComplete():uc.ins().onLoadJxrs([{url:_r.getJxrDBPath("ConfigActivityPlant"),type:"arraybuffer",cls:Zn}],ql.create(this,this.onJxrComplete))},i.onJxrComplete=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){e.g_fbg.visible=!1,e.txt_time.y=-3,e.resetrShow();var t=Zn.getIndex(e.acitivityId);e.btn_pick.label=Zn.MODEL.typeName(t);var i=e.actInfo.position.split(",");i[0]&&e.txt_link.changeText(i[0]),e.txt_hgrowth.changeText(e.actInfo.growth.toString()),e.setWhole()}},i.setWhole=function(){var e=this;e.w_list=e.w_list||[];for(var t=e.getPickList(),i=0;i<t.length;i++){if(!e.w_list[i]){var n=new sX;e.posArr[i]&&n.pos(e.posArr[i][0],e.posArr[i][1]),e.addChild(n),e.w_list.push(n)}e.w_list[i].dataSource={id:t[i],growth:e.actInfo.growth}}},i.getPickList=function(){for(var e=[],t=0;t<Jn.count;t++)Jn.MODEL.planActivityId(t)==this.actInfo.rankValue&&Jn.MODEL.previewActivityId(t)==this.acitivityId&&0!=Jn.MODEL.level(t)&&e.push(Jn.MODEL.key(t));return e},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_pick:zB.ins.showById(4998,1);break;case this.txt_link:if(!this.actInfo)return;var t=this.actInfo.position.split(",");t[1]&&JP.goToLink(t[1])}},t}(),P2=function(e){function t(){this.p_list=null,this.gItem=null,this.dto=null,this.g_items=null,this.pindex=0,this.posArr=[[251,240],[387,326],[83,370],[265,409],[143,519],[443,528]],t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_TreePickView",sI);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.link_record.on("click",t,t.onClickHandler),t.link_award.on("click",t,t.onClickHandler),t.btn_pick.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.actInfo=null,t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null),t.clearItems(),t.link_record.off("click",t,t.onClickHandler),t.link_award.off("click",t,t.onClickHandler),t.btn_pick.off("click",t,t.onClickHandler)},i.showByVSC=function(e,t){this.acitivityId=t,0<Jn.count?this.onJxrComplete():uc.ins().onLoadJxrs([{url:_r.getJxrDBPath("ConfigActivityPick"),type:"arraybuffer",cls:Jn}],ql.create(this,this.onJxrComplete))},i.onJxrComplete=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){var e=this;if(e.actInfo=mB.getInStance().getActivityData(e.acitivityId),e.actInfo){var t=e.actInfo.position.split(",");t[0]&&(e.btn_pick.label="点击"+t[0]),e.g_fbg.visible=!1,e.txt_time.y=-3,e.resetrShow(),e.pindex=Jn.getIndex(e.actInfo.growth),JP.pickLevel=e.actInfo.growth,e.p_list=e.getPickList(),e.setPickCost(),e.setAward()}},i.setAward=function(){var e=this;e.g_items=e.g_items||[];var t=JP.praseGoodsStr(Jn.MODEL.showAward(e.pindex));t=t.splice(0,6);for(var i=0;i<t.length;i++){var n;e.g_items[i]?n=e.g_items[i]:(n=new $z,e.posArr[i]&&n.pos(e.posArr[i][0],e.posArr[i][1]),e.addChild(n),e.g_items.push(n)),n.dataSource={dto:t[i],isShow:!0}}},i.clearItems=function(){var e=this;if(e.g_items&&!(e.g_items.length<1)){for(var t=0;t<e.g_items.length;++t)e.g_items[t]&&(e.g_items[t].parent&&e.g_items[t].parent.removeChild(e.g_items[t]),e.g_items[t].destroy(),e.g_items[t]=null);e.g_items.splice(0,e.g_items.length),e.g_items=null}},i.setPickCost=function(){for(var e=this,t=yB.createStrArr(Jn.MODEL.consumptionDef(e.pindex)),i=0;i<t.length;i++)15!=t[i].goodsId&&14!=t[i].goodsId&&(e.dto=t[i]);e.dto&&(e.gItem||(e.gItem=new MF(45),e.gItem.pos(300,900),e.gItem.needGridBg=!1,e.gItem.needEffect=!1,e.addChild(e.gItem)),e.gItem.bindData=e.dto,e.resetCost())},i.resetCost=function(){var e=this,t=TR.ins.getGoodsNum(e.dto.goodsId),i=t>=e.dto.goodsNum?"#23b11f":"#ff2e24";e.txt_cost.innerHTML=Ql.createColor(t.toString(),i)+"/"+e.dto.goodsNum,e.gItem.x=(e.width-(45+e.txt_cost.contextWidth))/2,e.txt_cost.x=e.gItem.x+45,e.btn_pick.showTip=t>=e.dto.goodsNum},i.refresh=function(e){e&&e instanceof protos.activity.toc_12247&&this.dto&&this.resetCost()},i.onClickHandler=function(e){switch(e.currentTarget){case this.link_record:WB.reqPickLogs(this.acitivityId);break;case this.link_award:var t=JP.praseGoodsStr(Jn.MODEL.showAward(this.pindex));hN.ins.open("SP_FIREWORKS_PREVIEW",t);break;case this.btn_pick:if(!this.dto)return;if(this.dto.goodsNum>TR.ins.getGoodsNum(this.dto.goodsId))return void zB.ins.showMsg(RP.n[1176],1);hN.ins.open("SP_TREE_PICK_AWARD"),WB.reqPickAward(this.acitivityId)}},i.getPickList=function(){for(var e=[],t=0;t<Jn.count;t++)Jn.MODEL.pickActivityId(t)==this.acitivityId&&e.push(Jn.MODEL.key(t));return e},t}(),R2=function(e){function t(){this.w_list=null,this.s_list=null,this.g_list=null,this.c_list=null,this.T_WORD="",this.posArr=[[163,420],[364,398]],this.curKey=0,this._cdTime=0,t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_TreePlantView",oI);var i=t.prototype;return i.onAdd=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onAdd.call(t,e),t.link_rank.on("click",t,t.onClickHanlder),t.link_preview.on("click",t,t.onClickHanlder),t.link_help.on("click",t,t.onClickHanlder),t.btn_help.on("click",t,t.onClickHanlder),t.btn_plan_0.on("click",t,t.onClickHanlder),t.btn_plan_1.on("click",t,t.onClickHanlder)},i.onRemove=function(e){var t=this;modules.activity.views.sp.Sp_Base.prototype.onRemove.call(t,e),t.actInfo=null;var i=0;if(t.g_list&&0<t.g_list.length){for(i=0;i<t.g_list.length;++i)t.g_list[i]&&(t.g_list[i].parent&&t.g_list[i].parent.removeChild(t.g_list[i]),t.g_list[i].destroy(),t.g_list[i]=null);t.g_list.splice(0,t.g_list.length),t.g_list=null}if(t.w_list){for(i=0;i<t.w_list.length;++i)t.w_list[i]&&t.w_list[i].parent&&t.w_list[i].parent.removeChild(t.w_list[i]);t.w_list.splice(0,t.w_list.length)}if(t.s_list){for(i=0;i<t.s_list.length;++i)t.s_list[i]&&t.s_list[i].parent&&t.s_list[i].parent.removeChild(t.s_list[i]);t.s_list.splice(0,t.s_list.length)}t.link_rank.off("click",t,t.onClickHanlder),t.link_preview.off("click",t,t.onClickHanlder),t.link_help.off("click",t,t.onClickHanlder),t.btn_help.off("click",t,t.onClickHanlder),t.btn_plan_0.off("click",t,t.onClickHanlder),t.btn_plan_1.off("click",t,t.onClickHanlder)},i.showByVSC=function(e,t){if(this.acitivityId=t,0<Zn.count&&0<Jn.count)this.onJxrComplete();else{var i=[];Zn.count<=0&&i.push({url:_r.getJxrDBPath("ConfigActivityPlant"),type:"arraybuffer",cls:Zn}),Jn.count<=0&&i.push({url:_r.getJxrDBPath("ConfigActivityPick"),type:"arraybuffer",cls:Jn}),uc.ins().onLoadJxrs(i,ql.create(this,this.onJxrComplete))}},i.onJxrComplete=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack,[!0]))},i.onReqBack=function(e){var t=this;if(void 0===e&&(e=!1),t.actInfo=mB.getInStance().getActivityData(t.acitivityId),t.actInfo){if(e){t.g_fbg.visible=!1,t.txt_time.y=-3,t.resetrShow();var i=t.actInfo.position.split(",");i[0]&&(t.T_WORD=i[0]),i[2]&&t.link_preview.changeText(i[2])}t.g_list=t.g_list||[],t.c_list=[];for(var n=0;n<t.actInfo.exchangeList.length;n++){var s=xa.getIndex(t.actInfo.exchangeList[n].exId);t.c_list.push({index:s,limit:xa.MODEL.limitNum(s),cList:yB.createStrArr(xa.MODEL.consumption(s))}),t["btn_plan_"+n].label=xa.MODEL.desc(s)}t.setWhole(),t.setMyGrowth(),t.setCost(e),e||t.refreshRedPt()}},i.setWhole=function(){var e=this;e.w_list=e.w_list||[];for(var t=e.getPlantIndex(),i=JP.praseGoodsStr(Zn.MODEL.reward(t)),n=Zn.MODEL.typeName(t).split("|"),s=0;s<i.length;s++){if(!e.w_list[s]){var o=new $z;e.posArr[s]&&o.pos(e.posArr[s][0],e.posArr[s][1]),e.addChild(o),e.w_list.push(o)}n[s]&&(e.w_list[s].dataSource={dto:i[s],isShow:!1,gName:n[s]+"奖池"})}},i.setMyGrowth=function(){var e=this;e.s_list=e.s_list||[];for(var t=0;t<e.actInfo.gifts.length;t++){if(!e.s_list[t]){var i=new iX;i.pos(110+110*t,2),e.sp.addChildAt(i,0),e.s_list.push(i)}var n=e.actInfo.gifts[t-1]?e.actInfo.gifts[t-1].targetValue:0;e.s_list[t].dataSource={index:t,acitivityId:e.acitivityId,gvo:e.actInfo.gifts[t],pre:n}}e.txt_score.changeText(e.actInfo.gifts[0].currentNum)},i.setCost=function(e){var t,i,n=this;void 0===e&&(e=!1);for(var s=0,o=0;o<n.actInfo.exchangeList.length;o++)if(n.c_list[o]&&n.c_list[o].cList){for(var a=0;a<n.c_list[o].cList.length;a++)n.setShowIcon(n.c_list[o].cList[a],o,e);n["btn_plan_"+o].showTip=n.getRedPt(n.c_list[o].cList,n.actInfo.exchangeList[o]),s=xa.getIndex(n.actInfo.exchangeList[o].exId),n["txt_plant_"+o].visible=0<xa.MODEL.limitNum(s),n["txt_plant_"+o].visible&&(t=n.actInfo.exchangeList[o].exTimes<1?"#ff2e24":"#23b11f",i="本日"+n.T_WORD+"：",i+=Ql.createColor(n.actInfo.exchangeList[o].exTimes,t),i+=Ql.createColor("/"+n.c_list[o].limit,"#e0d6c1"),n["txt_plant_"+o].innerHTML=i)}},i.setShowIcon=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e){if(15==e.goodsId)return i&&(n["g_icon_"+t].skin=_r.getAtlasSubPath("base_ui2/ty_hb_tb.png"),n["txt_cn_"+t].changeText(e.goodsNum.toString())),void(n["txt_cn_"+t].color=gR.ins.coin<e.goodsNum?"#ff2e24":"#23b11f");if(14==e.goodsId)return i&&(n["g_icon_"+t].skin=_r.getAtlasSubPath("base_ui2/ty_hb_yb.png"),n["txt_cn_"+t].changeText(e.goodsNum.toString())),void(n["txt_cn_"+t].color=gR.ins.YB<e.goodsNum?"#ff2e24":"#23b11f");if(!n.g_list[t]){var s=new MF(45);s.pos(90+304*t,0),s.needGridBg=!1,s.needEffect=!1,n.box_d.addChild(s),s.dataSource=e,s.goodsNum=1,n.g_list.push(s)}var o=TR.ins.getGoodsNum(e.goodsId),a=e.goodsNum>o?"#ff2e24":"#23b11f";n["txt_cg_"+t].innerHTML=Ql.createColor(o.toString(),a)+"/"+e.goodsNum}},i.onClickHanlder=function(e){var t=this;if(!(BB.getTimer()-t._cdTime<500))switch(t._cdTime=BB.getTimer(),e.currentTarget){case t.btn_help:case t.link_help:QR.goToOpenHelpDes(41);break;case t.link_rank:var i=t.actInfo.position.split(",");i[1]&&JP.goToLink(i[1]);break;case t.link_preview:var n=t.actInfo.position.split(",");n[3]&&JP.goToLink(n[3]);break;case t.btn_plan_0:case t.btn_plan_1:t.onExchange(parseInt(e.currentTarget.name))}},i.onExchange=function(e){if(this.actInfo){var t=this.actInfo.exchangeList[e];if(t){var i=xa.getIndex(t.exId);if(0<xa.MODEL.limitNum(i)&&t.exTimes<1)zB.ins.showMsg(RP.n[1488],1);else{var n=yB.createStrArr(xa.MODEL.consumption(i));if(n&&!(n.length<1)){for(var s,o=0;o<n.length;o++)if(s=n[o])if(15==s.goodsId){if(gR.ins.coin<s.goodsNum)return void zB.ins.showById(1003,1)}else if(14==s.goodsId){if(gR.ins.YB<s.goodsNum)return void Tu.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],1)}else if(s.goodsNum>TR.ins.getGoodsNum(s.goodsId))return void zB.ins.showById(4440,1);this.curKey=e,WB.setComplete(ql.create(this,this.onReqBack)),OR.requestExchange(t.exId)}}}}},i.refresh=function(e){if(e){if(e.hasOwnProperty("isGrowth")){if(this.actInfo=mB.getInStance().getActivityData(this.acitivityId),!this.actInfo)return;return this.setMyGrowth(),void this.refreshRedPt()}e instanceof protos.activity.toc_23622&&this.goToPos(e.gList)}},i.goToPos=function(e){var t=this;if(e&&!(e.length<1)){for(var i=[],n=0;n<e.length;n++)i.push(e[n].gId);var s=0,o=0;t.w_list&&t.w_list[t.curKey]&&(s=t.w_list[t.curKey].x+(t.w_list[t.curKey].width>>1),o=t.w_list[t.curKey].y+(t.w_list[t.curKey].height>>1)-12);var a=t.localToGlobal(new Uh(s,o));zB.ins.playGetItemsByPos(i,new Uh(a.x,a.y))}},i.getPlantIndex=function(){for(var e=0;e<Zn.count;e++)if(Zn.MODEL.key(e)==this.acitivityId)return e;return 0},i.refreshRedPt=function(){Tu.sendToModule("REFESH_RED_PT",["modules.activity.ActivityModule"],{activityId:this.acitivityId,redPt:this.plainPedPt,mType:this.mainType})},i.getRedPt=function(e,t){if(t){var i=xa.getIndex(t.exId);if(0<xa.MODEL.limitNum(i)&&t.exTimes<1)return!1}if(!e)return!1;for(var n,s=0;s<e.length;s++)if(n=e[s])if(15==n.goodsId){if(gR.ins.coin<n.goodsNum)return!1}else if(14==n.goodsId){if(gR.ins.YB<n.goodsNum)return!1}else if(n.goodsNum>TR.ins.getGoodsNum(n.goodsId))return!1;return!0},p(0,i,"plainPedPt",function(){if(this.myGrowthRedPt)return!0;if(this.actInfo&&this.actInfo.exchangeList)for(var e=0;e<this.actInfo.exchangeList.length;e++)if(this.getRedPt(this.c_list[e].cList,this.actInfo.exchangeList[e]))return!0;return!1}),p(0,i,"myGrowthRedPt",function(){if(!this.actInfo)return!1;for(var e=0;e<this.actInfo.gifts.length;e++)if(1==this.actInfo.gifts[e].status)return!0;return!1}),t}(),N2=function(e){function t(){t.__super.call(this)}b(t,"modules.activity.views.sp.Sp_WelfareView",cI);var i=t.prototype;return i.initialize=function(){this.list.itemRender=oX,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.onAdd=function(e){modules.activity.views.sp.Sp_Base.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){modules.activity.views.sp.Sp_Base.prototype.onRemove.call(this,e),this.actInfo=null,this.list.scrollBar.off("change",this,this.onScrollChanged)},i.showByVSC=function(e,t){this.updateByVSC(t)},i.updateByVSC=function(e){this.acitivityId=e,WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.updateView=function(){WB.getActivityData(this.acitivityId,ql.create(this,this.onReqBack))},i.onReqBack=function(){this.actInfo=mB.getInStance().getActivityData(this.acitivityId),this.actInfo&&(this.updateList(!1),this.resetrShow())},i.updateList=function(e){if(void 0===e&&(e=!0),e&&(this.actInfo=mB.getInStance().getActivityData(this.acitivityId)),this.actInfo&&this.actInfo.gifts){var t=It.getIndex(this.acitivityId),i=this.actInfo.gifts.concat();i&&(1!=It.MODEL.isReset(t)&&(i=i.sort(JP.sortArray)),this.list.dataSource=i,this.list.tweenTo(0))}},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}();G.__init([sJ,U$,D1,tH,KN,OQ,VP,SB,nq,cW,zW,$F,pq,QF,aR,UF,XJ,jF,jN])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";for(var i in Object.defineProperty(t,"__esModule",{value:!0}),Laya){var n=Laya[i];n&&n.__isclass&&(t[i]=n)}});