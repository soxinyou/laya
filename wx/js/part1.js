!function(e,t,Y){Y.un,Y.uns;var i=Y.static,u=Y.class,n=Y.getset,o=(Y.__newvec,protos.activityDaily.tos_39016,protos.treasure.tr_toc_30314,layouts.god.GeAttrUI,ui.ViewStackComponent),s=protos.db.ConfigShaoZhu,d=protos.db.ConfigGuildBuildUpgrade,a=protos.crossBoss.tos_30743,m=protos.crossBoss.tos_30741,c=(protos.newworldboss.NewWorldBoss_Back_Relive_30862_toc,protos.siege.toc_23302,protos.guild.tos_12925),r=(protos.crossBoss.toc_30742,ui.text.TextField),l=ui.gridrender.MGoodsGrid,h=(protos.crossBoss.toc_30744,protos.boss.toc_22151,protos.scene.toc_22153,protos.db.CFashionSuitModel,modules.friendnew.orders.FriendNew_serverOrder,layouts.guild.manage._GuildMng_FuncItemViewUI,modules.pet.order.Pet_InternalOrder,modules.scene.others.fight.FightUtils),_=protos.db.ConfigRaiseKunSkill,p=layouts.pet.PetOpenDownTipUI,f=(modules.copy.others.CopyConst,modules.backpack.others.util.FightingUtil),g=(modules.newsiege.order.NewSiege_InternalOrder,layouts.boss._Boss_MijingViewUI,modules.godweapon.order.GodWeapon_ServerOrder,layouts.guild.domain._GuildKun_titleUI),v=(protos.fashion.toc_22715,layouts.boss.scene._Boss_sczbAwardViewUI),b=layouts.auctionhouse.auctionGoodsTipUI,w=(modules.auctionhouse.order.Auction_ServiceOrder,protos.copy.toc_21214,layouts.pig.pigTwo.PigTwoMainViewUI),y=layouts.teamCopy.TeamCopyHeadVUI,x=(protos.boss.toc_21210,layouts.friendnew.FriendNewFriendRenderLayoutUI),I=layouts.boss.scene._Boss_WildKillViewUI,S=layouts.boss.bosshome.BossHomeSubLayoutUI,k=layouts.guild.store._GuildStore_RecordViewUI,K=protos.db.ConfigVip,C=layouts.guild.domain._GuildKun_BaseVUI,T=protos.pet.tos_36001,E=layouts.auctionhouse.myattontionItemUI,L=modules.corssbattle.others.CrossBattleDataModel,A=layouts.teamCopy.TeamCopyChallageVUI,B=layouts.boss.bosshome.BossHomeMainRenderLayoutUI,D=laya.renders.Render,J=global.Global,X=modules.vip.others.VipManager,O=protos.db.CSkillModel,V=utils.TimeUtils,M=modules.actor.others.enum.EEquip,R=layouts.guild.domain._GuildKunDamagRankUI,P=protos.db.CrossBattleMainShow,N=(modules.firedragon.order.FireDragon_ServiceOrder,modules.actor.views.soaring.interior.SoaringInteriorTip),G=(modules.firedragon.order.FireDragon_InterOrder,layouts.guild.manage._GuildMng_ListItemViewUI,laya.utils.Ease),U=modules.scene.proxys.SceneBossProxy,H=layouts.boss.scene._Boss_MijingAttackViewUI,F=(protos.newworldboss.NewWorldBoss_Back_GuiShu_30859_toc,zwc.engine.core.controls.dock.SubProxy),z=modules.actor.views.samsaraequip.SamsaraEquipTip,W=ui.gridrender.MGridsContainer,j=layouts.guild.siege.GC_GuildRankViewUI,q=layouts.pet.PetTunshiSelectItemUI,Q=layouts.auctionhouse.blackmacketViewUI,Z=modules.boss.others.FlyupBossModel,$=protos.achieve.DailyTaskModel,ee=protos.db.CGcAward,te=modules.tqyueka.others.TqMonthCardDataCenter,ie=layouts.teamCopy.TeamCopyFriendYaoQingVUI,se=modules.scene.others.MainMoveCtrl,ne=layouts.fashion.FashionItemRenderUI,oe=(modules.friendnew.others.FriendNewVo,modules.copy.order.Copy_InternalOrder,global.ResUtils),ae=(protos.title.toc_13507,modules.checkpoint.others.CheckPointModel),le=(protos.pet.toc_36002,protos.copy.tos_21217),ce=(layouts.guild.manage._GuildMng_BaseItemViewUI,protos.guild.toc_12904,protos.guild.toc_12906,modules.fight.views.Fight_Attack_Mask),de=(protos.guild.toc_12902,protos.guild.toc_12908,modules.guild.others.GuildKunData),ue=layouts.pet.PetListBarUI,he=(protos.friendsnew.toc.FriendNew_back_chatBack_30473_toc,utils.DateUtil),_e=(protos.boss.toc_22621,modules.yzbqc.order.YzbqcOrder,protos.scene.DtoCharData,layouts.friendnew.FriendNewAddFriendLayoutUI),pe=layouts.boss._Boss_PersonViewUI,fe=modules.task.views.DirectionAchieveGrid,ge=protos.db.GuildCreateResource,ve=modules.copy.others.MentalData,me=(modules.mall.order.Mall_ServerOrder,protos.db.MissionKillResource),be=layouts.boss.scene._Boss_WildSceneUI,we=protos.guild.tos_12971,ye=(modules.nav.views.sub.NavActRView,protos.guild.tos_12973),xe=protos.guild.tos_12975,Ie=protos.guild.tos_12977,Se=modules.actor.others.enum.EAttri,ke=modules.guild.others.GuildModel,Ce=(protos.copy.teamCopy.toc_30712,layouts.pig.pigTwo.PigTwoEnterViewUI),Te=(protos.boss.BossHome_back_bossDead_30402_toc,layouts.boss._Boss_PersonItemViewUI),Ee=layouts.fashion.FashionViewBaseUI,Le=utils.easing.Circ,Ae=(protos.copy.teamCopy.toc_30705,protos.copy.teamCopy.toc_30702,protos.guild.toc_12974,protos.guild.toc_12976,protos.guild.toc_12978,zwc.engine.core.controls.dock.DefaultModule,zwc.engine.global.EGlobal),Be=layouts.yzbqc.YzbqcRRItemVUI,De=(protos.copy.teamCopy.toc_30708,protos.friendsnew.tos.FriendNew_request_delFriend_30470_tos),Oe=(laya.display.Node,layouts.fazhen.FazhenQnGridUI),Ve=layouts.copy.CpMaterialViewUI,Me=layouts.teamCopy.TeamCopyStrategyItemUI,Re=protos.db.CGoodsModel,Pe=layouts.tower.TowerLevelUpLayoutUI,Ne=layouts.boss.worldBoss._Boss_WorldBossYaoQingViewUI,Ge=(protos.gov.toc.Gov_back_lettoryTime_21714_toc,layouts.fazhen.FazhenAllViewUI),Ue=protos.guild.tos_12909,He=protos.db.ConfigWildBossTimes,Fe=(protos.scene.toc_22614,modules.weaponsoul.proxy.WeaponSoulProxy),ze=layouts.boss.scene._Boss_WorldSceneJieSuanViewUI,We=protos.friendsnew.tos.FriendNew_requestApply_30467_tos,je=(protos.auctionhouse.toc_30638,protos.auctionhouse.toc_30633,layouts.guild.skill._GuildSkill_cangbaoViewUI),qe=(protos.actor.toc_10205,protos.auctionhouse.toc_30637,laya.utils.Browser),Ye=layouts.friendnew.FriendNewBlockRenderLayoutUI,Ke=layouts.guild.domain._GuildKunRankVUI,Je=(modules.scene.order.Scene_ServiceOrder,global.EScene),Xe=layouts.auctionhouse.pirceRemindViewUI,Qe=modules.chat.others.ChatManager,Ze=protos.db.CTeamCopyOtherModel,$e=modules.chat.views.ChatFaceUI,et=(protos.strength.toc_11004,modules.weaponsoul.other.WeaponSoulReq),tt=layouts.guild.manage._GuildModifyNoteViewUI,it=protos.db.ConfigGuildDonation,st=protos.db.CFlyupBoss,nt=protos.guild.tos_23343,ot=layouts.guild.boss._GuildBoss_RankUI,at=modules.bossancient.others.BossAncientModel,rt=layouts.crossbattle.CrossBattleViewUI,lt=(global.ESound,protos.db.CAuctionResource),ct=protos.boss.tos_21260,dt=modules.strength.views.CircleEquipPanel,ut=protos.fashion.tos_22708,ht=modules.fashion.others.FashionDataModel,_t=(zwc.saiman.interfaces.dock.IMessage,modules.vip.order.VipOrder,protos.boss.toc_21264,protos.boss.toc_21263,layouts.hllx._FireDragonMainViewUI),pt=(protos.boss.toc_21261,layouts.pet.PetFutiViewUI),ft=layouts.hllx._FireDragonViewUI,gt=(laya.html.dom.HTMLDivElement,protos.firedragon.toc_21268,protos.db.PetEggResource),vt=protos.copy.tos_21223,mt=layouts.guild.base._GcPersonAwardsItemUI,bt=protos.boss.worldboss.Tos_21249,wt=(protos.vip.toc_14003,protos.newworldboss.NewWorldBoss_Request_GuiShu_30858_tos),yt=protos.guild.tos_12911,xt=(modules.boss.others.BossWildVo,modules.pet.order.Pet_ServiceOrder,protos.firedragon.toc_21269,layouts.guild.store._GuildStore_RecordItemViewUI,layouts.guild.boss.CallBossMainViewUI),It=(protos.fashion.toc_22709,protos.db.CFDShowAward),St=(protos.guild.toc_25016,laya.ui.List,protos.crossBoss.toc_25011,protos.fashion.toc_22702,layouts.guild.manage._GuildMng_FuncViewUI),kt=(modules.gui.order.Gui_order,protos.chat.tos_11804),Ct=(modules.boss.others.BossConst,modules.corssbattle.views.crossboss.CrossBossCaijiBar,protos.db.PetEatingResource),Tt=modules.skill.views.item.SkillGrid,Et=protos.db.ConfigTitle,Lt=(modules.copy.others.TeamCopyVO,protos.title.toc_13504,layouts.pig.mental.MentalSummonVUI),At=(protos.backpack.toc_30653,protos.db.ConfigYCTianGuan),Bt=(protos.boss.toc_21233,layouts.fazhen.FazhenSkillAlertUI),Dt=layouts.tower.TowerRankDetailItemLayoutUI,Ot=modules.actor.others.MoEquipData,Vt=layouts.pet.PetTunshiViewUI,Mt=layouts.pig.pigTwo.PigTwoFightNoEnouphUI,Rt=layouts.guild.siege.GC_ScAwardsViewUI,Pt=(modules.fashion.others.FashionConfigData,layouts.boss.jipinRecord._jipinRecordViewUI),Nt=protos.pig.two.tos_22015,Gt=protos.pig.two.tos_22017,Ut=(modules.boss.order.Boss_InterOrder,protos.pig.two.tos_22019),Ht=protos.pig.two.tos_22018,Ft=(protos.guild.toc_30785,modules.activityDaily.others.DailyDataModel),zt=(protos.backpack.toc_10402,modules.auctionhouse.other.AuctionRequest),Wt=(protos.godweapon.toc_30352,protos.pig.two.toc_22016,layouts.pet.PetTunshiSelectViewUI),jt=utils.RewardUtil,qt=protos.friendsnew.tos.FriendNew_request_allChatRecord_30475_tos,Yt=(modules.chat.others.ChatInfo,layouts.pet.PetOpenTipUI),Kt=zwc.utils.Hash,Jt=(protos.boss.worldboss.Toc_24052,protos.boss.worldboss.Toc_24051,protos.boss.worldboss.Toc_24050,modules.auctionhouse.order.Auction_InternalOrder,protos.db.CFazhenQn),Xt=layouts.boss.scene._Boss_GodWeaponFairyLandSceneUI,Qt=modules.title.views.TitleTotalV,Zt=protos.db.ConfigShaoZhuEnter,$t=modules.backpack.views.tip.EquipToolTip,ei=modules.gui.views.LayoutManager,ti=utils.CodeUtils,ii=(protos.db.CShopModel,protos.guild.tos_30779),si=laya.net.URL,ni=protos.guild.tos_30775,oi=layouts.pet.PetShopViewUI,ai=layouts.fashion.ClothesCupboardViewUI,ri=(modules.boss.others.FlyupBossVO,modules.backpack.others.BackPackData),li=modules.rank.others.RankReqs,ci=(protos.siege.toc_23337,layouts.boss.bosshome.BossHomeMainLayoutUI),di=(modules.map.views.MapPanel,layouts.boss._Boss_GodViewUI),hi=layouts.fight._Fight_SettleUI,_i=(protos.auctionhouse.toc_30646,modules.boss.others.BossHomeVO),pi=layouts.boss.worldBoss._Boss_WorldBossRankItem2UI,fi=(protos.guild.toc_30774,modules.tianguan.order.Tianguan_ServiceOrder,modules.soul.views.soulskin.SoulSkinGoodsTip,ui.ColorFont),gi=modules.gui.views.commonui.PanelMask,vi=protos.db.ShaoZhuReward,mi=(modules.friendnew.orders.FriendNew_InnerOrder,laya.net.Loader),bi=modules.guild.others.GuildConst,wi=modules.backpack.others.util.BackPackReqs,yi=(protos.scene.heji.toc_24011,layouts.strength.SubStrengthUI),xi=layouts.guild.raisekunmaster.RaiseKunSkillViewUI,Ii=protos.guild.tos_12935,Si=layouts.boss.flyupBoss.FlyupBossLevelRenderItemUI,ki=(laya.events.Event,protos.guild.toc_12912,protos.guild.tos_12932),Ci=(protos.boss.toc_21221,protos.boss.toc_21220,protos.boss.toc_21227,protos.boss.toc_21225,layouts.guild.shop._Guild_ShopViewUI),Ti=modules.actor.others.SamEquipData,Ei=laya.filters.ColorFilter,Li=(protos.guild.toc_12965,layouts.boss.bosshome.BossHomeSubIRenderLayoutUI),Ai=(protos.friendsnew.toc.FriendNew_back_recordAll_30476_toc,protos.db.CashExchange),Bi=ui.layerrender.MRenderUtil,Di=zwc.Engine,Oi=utils.UIUtil,Vi=layouts.boss.worldBoss._Boss_WorldBossRankItemUI,Mi=modules.corssbattle.others.CrossStatusConst,Ri=(modules.scene.others.fight.CateConst,layouts.guild.siege.GC_GuildAwardsViewUI),Pi=layouts.teamCopy.TeamCopyYaoQingVUI,Ni=modules.broadcast.views.DialogueView,Gi=(protos.auctionhouse.toc_30631,modules.actor.others.PlayerData),Ui=layouts.teamCopy.TeamCopyOutVUI,Hi=modules.task.proxys.TaskProxy,Fi=layouts.pig.pigTwo.PigTwoShowAwardsViewUI,zi=modules.guild.others.RaiseKunVo,Wi=(protos.pet.toc_36003,modules.actor.views.item.RoleAvatar),ji=(modules.actor.others.enum.EMoney,modules.chat.views.gm.GMLog),qi=protos.db.CModuleOpenResource,Yi=(protos.boss.toc_22623,protos.boss.toc_22620,ui.controls.HtmlDiv),Ki=protos.db.ConfigBuff,Ji=layouts.pet.PetHasBirthedTipUI,Xi=protos.fashion.tos_22717,Qi=(protos.auctionhouse.toc_30636,ui.IPanelProxy,layouts.boss.flyupBoss.FlyupBossItemViewUI),Zi=layouts.guild.raisekunmaster.RaiseKunMasterViewUI,$i=layouts.friendnew.FriendNewApplyRenderLayoutUI,es=protos.boss.tos_30006,ts=layouts.guild.boss._GuildBoss_BaseUI,is=laya.maths.Point,ss=(modules.copy.others.TeamCopyYaoQingVO,layouts.guild.boss._GuildBoss_CountDownUI),ns=(protos.boss.toc_30005,protos.boss.toc_30007,zwc.engine.core.displays.world.char.Char,modules.specialgodring.other.SGRConst),os=layouts.crossbattle.crossboss.CrossbossItemUI,as=(modules.copy.others.TeamCopyGLVO,layouts.boss._Boss_GodAttentionUI),rs=layouts.guild.base._GuildManage_ViewUI,ls=protos.boss.tos_21224,cs=layouts.teamCopy.TeamCopyHelpVUI,ds=layouts.guild.siege.GC_PersonAwardsViewUI,us=layouts.guild.manage._GuildMng_ListViewUI,hs=(protos.scene.DtoGKData,protos.db.GiveWeiResource),_s=utils.ArrayUtil,ps=protos.db.ConfigSpecialDonation,fs=modules.fashion.others.FashionReqUtils,gs=(laya.resource.Texture,protos.db.CClothDispose),vs=layouts.boss._Boss_MainViewUI,ms=laya.utils.Handler,bs=modules.chat.ModuleOpenCheck,ws=layouts.pig.pigTwo.PigTwoShowExpViewUI,ys=layouts.crossbattle.newworldboss.CrossNewBossKillSmallRecordItemUI,xs=layouts.guild.base._GuildPlyerlist_ViewUI,Is=(protos.boss.BossHome_back_bossRebord_30401_toc,protos.db.PetGridNumResource),Ss=modules.scene.others.invented.InventedScene,ks=(layouts.guild.base._GuildManage_LogItemUI,laya.utils.Dictionary),Cs=protos.db.CMonsterModels,Ts=layouts.boss.worldBoss._Boss_WorldBossResultUI,Es=zwc.engine.core.displays.avatars.Effect,Ls=protos.db.PetShopResource,As=(protos.auctionhouse.toc_30643,layouts.auctionhouse.auctionhouseItemViewUI),Bs=modules.scene.others.fight.FightCtrl,Ds=(modules.corssbattle.order.CrossBattle_InternalOrder,layouts.pig.pigTwo.PigTwoBoxItemUI),Os=modules.scene.proxys.Scene_CharProxy,Vs=(modules.yueka.order.MonthCardOrder,ui.IVSCView,global.JXRConst),Ms=protos.guild.tos_12969,Rs=protos.db.CFeedRankResource,Ps=layouts.pig.pigTwo.PigTwoAwardsViewUI,Ns=layouts.teamCopy.TeamCopyResultVUI,Gs=(protos.guild.toc_12963,protos.guild.toc_12961,modules.backpack.views.tip.FashionTip),Us=layouts.teamCopy.TeamCopyItemUI,Hs=laya.ui.Label,Fs=layouts.guild.shop._Guild_ShopItemUI,zs=modules.actor.others.OtherPlayerData,Ws=protos.tianguan.tos_21710,js=layouts.boss._Boss_GodItemViewUI,qs=(modules.copy.order.Copy_ServiceOrder,layouts.boss._Boss_MijingAlertItemUI),Ys=(modules.copy.order.Pig_Order,protos.tianguan.toc_21711,laya.ui.ScrollBar,modules.chat.order.Chat_order,protos.db.MissionTransfers),Ks=layouts.guild.base._GcGuildRankItemUI,Js=(protos.guild.toc_30784,modules.recharge.others.RechargeManager),Xs=(protos.guild.toc_30783,layouts.teamCopy.TeamCopySceneViewUI),Qs=(protos.guild.toc_30781,layouts.auctionhouse.myrecordItemUI),Zs=(protos.broadcast.EMsgId,protos.db.PetStarUpgradeResource),$s=modules.passsuit.views.PassSuitToolTip,en=global.IconTexture,tn=(protos.title.DtoTitle,utils.easing.Bounce),sn=(layouts.guild.base._GuildPlayeritem_ViewUI,modules.login.order.Login_SerOrder,modules.specialgodring.other.SGRDateModel),nn=(ui.ViewBase,layouts.boss._Boss_WildViewUI),on=modules.copy.others.CopyReqs,an=protos.backpack.DtoGoods,rn=(modules.title.order.Title_order,laya.display.Sprite),ln=(protos.auctionhouse.toc_30649,protos.task.TaskModel),cn=(modules.corssbattle.others.CrossBattleConst,laya.ui.Component),dn=(zwc.engine.core.displays.world.terrain.TileConst,protos.boss.DtoMonsterData),un=(laya.display.Graphics,utils.BitmapLoader),hn=modules.broadcast.views.Alert2,_n=(protos.boss.toc_24046,protos.boss.toc_24047,protos.friendsnew.tos.FriendNew_request_addByName_30471_tos),pn=laya.utils.ClassUtils,fn=(laya.ui.Button,protos.pig.hundunmonster.toc_21276,protos.guild.tos_12927),gn=layouts.crossbattle.newworldboss.CrossBossItemViewUI,vn=modules.guild.views.skill.GuildSkill_BaseView,mn=protos.newworldboss.NewWorldBoss_Request_Kill_30860_tos,bn=protos.db.CMentalMissonModel,wn=utils.Common,yn=modules.title.others.TitleManager,xn=modules.nav.proxys.NavBossProxy,In=layouts.guild.store.RedpagTipUI,Sn=protos.boss.worldboss.Tos_21253,kn=layouts.crossbattle.newworldboss.CrossNewBossFightViewUI,Cn=protos.boss.worldboss.Tos_21256,Tn=layouts.fashion.ClothesDisposeItemUI,En=(protos.guild.Dto_GuildInfo,protos.newworldboss.NewWorldBoss_Back_Kill_30861_toc,layouts.boss.scene._Boss_MijingResultViewUI),Ln=(modules.activityDaily.order.Daily_InternalOrder,layouts.boss.scene._Boss_WorldBossSceneRankItemUI,layouts.boss.bosshome.BossHomeSubLevelRenderLayoutUI),An=protos.db.CActivityMainType,Bn=modules.chat.views.ChatRecord,Dn=(utils.ByteArray,zwc.utils.ByteUtils),On=(protos.friendsnew.toc.FriendNew_back_list_30468_toc,modules.gui.others.PU),Vn=(protos.fashion.toc_22713,modules.backpack.others.enum.EGoodsType),Mn=layouts.tower.TowerRewardLayoutUI,Rn=laya.ui.UIUtils,Pn=(modules.backpack.order.BackPack_ServerOrder,layouts.guild.domain._GuildKun_FightViewUI),Nn=modules.nav.views.NavMainView,Gn=(modules.nav.views.item.NavActIcon,layouts.pig.mental.MentalEnterVUI,protos.scene.heji.toc_24004,modules.gui.others.GuiEvent,protos.title.toc_13502,layouts.guild.manage._GuildCreateViewUI),Un=protos.db.PetAttrResource,Hn=(protos.newworldboss.NewWorldBoss_Back_Info_30857_toc,modules.ModuleConst,modules.scene.others.invented.PlayerGroupAI,protos.guild.toc_12934,layouts.boss.scene._Boss_WildSceneAwardViewUI),Fn=(protos.friendsnew.toc.FriendNew_back_applyRed_30477_toc,protos.pig.hundunmonster.tos_21275),zn=modules.fight.others.FightResultUtil,Wn=layouts.yzbqc.YzbqcPRItemVUI,jn=(protos.guild.toc_12936,layouts.crossbattle.crossboss.CrossBossViewUI),qn=(modules.corssbattle.order.CrossBattle__ServiceOrder,modules.weaponsoul.other.WeaponSoulDM),Yn=(protos.guild.toc_12924,protos.godweapon.toc_30342,protos.db.CForgingiCostModel),Kn=(protos.guild.toc_12921,modules.task.others.ENewGuideEvent,utils.easing.Quad),Jn=layouts.crossbattle.newworldboss.CrossNewBossAttentionUI,Xn=modules.nav.others.NavUISet,Qn=protos.db.ShaoZhuSpecialReward,Zn=layouts.guild.store._GuildStore_ContribViewUI,$n=layouts.pig.pigTwo.PigTwoShowVipExpUI,eo=(modules.pet.views.NavPetBirth,protos.db.PetAppendageResource),to=protos.db.ConfigKunMisstionPrice,io=protos.db.CFireDragon,so=(ui.ICheckPanelOpen,protos.fashion.tos_22716),no=layouts.guild.siege.GC_GuildHuiZhangAwardsViewUI,oo=(protos.guild.toc_23344,protos.strength.StrengthVo),ao=modules.corssbattle.others.CrossNewBossDataModel,ro=layouts.pig.mental.MentalSceneUI,lo=layouts.guild.boss.CallBossExitUI,co=modules.title.views.TitleShowV,uo=(protos.auctionhouse.toc_30641,protos.db.CMissionModel),ho=layouts.guild.domain._GuildKunRankBaseUI,_o=(modules.map.order.Map_ServerOrder,modules.mall.order.Mall_InternalOrder,layouts.boss.scene._Boss_PersonBossSceneUI),po=(protos.guild.toc_30768,protos.strength.toc_30880,protos.db.CHelpDes),fo=(protos.guild.toc_12995,layouts.guild.siege.GC_RankInfoViewUI),go=layouts.pet.PetJichengViewUI,vo=(modules.copy.order.TeamCopy_Order,layouts.copy.CpMaterialItemUI),mo=(protos.scene.heji.toc_24001,modules.backpack.views.tip.IToolTip,protos.guild.tos_12926),bo=(protos.boss.BossHome_back_baseInfo_30400_toc,layouts.guild.base._GcGuildAwardsItemUI),wo=protos.guild.tos_12922,yo=protos.guild.tos_12923,xo=protos.guild.tos_12920,Io=protos.db.CGemStoneModel,So=(protos.boss.toc_21236,protos.guild.toc_12947,layouts.pig.hundunMonster._hundunMonsterEnterViewUI),ko=layouts.guild.store._GuildStore_RedViewUI,Co=utils.ColorConst,To=modules.actor.others.ActorReq,Eo=(modules.mall.others.MallReqUtils,layouts.guild.boss._GuildBoss_SettleUI),Lo=(protos.fashion.toc_22711,modules.corssbattle.order.NewWorldBoss_InternalOrder,layouts.hllx._FireDragonRankAwardVUI),Ao=layouts.auctionhouse.cashExchangeItemViewUI,Bo=protos.strength.tos_11002,Do=layouts.pet.PetTipUI,Oo=(protos.chat.toc_11805,layouts.fazhen.FazhenSkilllTipsUI),Vo=modules.nav.views.sub.NavExit,Mo=(protos.boss.worldboss.Toc_21250,protos.guild.tos_12916),Ro=(modules.actor.order.Actor_ServerOrder,protos.boss.worldboss.Toc_21254,protos.boss.worldboss.Toc_21255,protos.boss.worldboss.Toc_21258,layouts.guild.manage._GuildApplyMngItemViewUI,layouts.boss.scene._Boss_WorldBossSceneUI),Po=(protos.scene.toc_22613,protos.copy.tos_21240),No=(protos.scene.toc_22616,layouts.title.TitleShowVUI),Go=layouts.tower.TowerMainLayoutUI,Uo=(protos.scene.toc_22618,protos.guild.tos_12944),Ho=layouts.boss._Boss_GodAttentionItemUI,Fo=layouts.boss.worldBoss._Boss_WorldBossViewUI,zo=layouts.boss._Boss_WildItemViewUI,Wo=(modules.newDailyAct.view.NewDailyActMainView,layouts.guild.domain.scene._BossKun_CallVUI),jo=layouts.strength.SubStoneUI,qo=laya.maths.Rectangle,Yo=layouts.pet.PetXilianViewUI,Ko=layouts.auctionhouse.auctionhouseMainViewUI,Jo=layouts.strength.SubSpritUI,Xo=protos.db.ConfigRaiseKun,Qo=zwc.utils.GomeUtils,Zo=protos.boss.tos_21234,$o=protos.copy.tos_21235,ea=protos.copy.tos_21237,ta=(modules.strength.order.Strength_InternalOrder,protos.rank.toc_10702,modules.newsiege.others.NewSiegeData),ia=(layouts.hllx._FireDragonRankAwardItemUI,modules.nav.order.Nav_Order,protos.copy.tos_21238),sa=layouts.guild.siege.GC_PersonRankViewUI,na=modules.arena.others.ArenaManager,oa=protos.db.ConfigGuildBoss,aa=(protos.fashion.toc_22707,modules.rank.order.Rank_ServiceOrder,layouts.tower.TowerRankLayoutUI),ra=modules.backpack.views.grid.GoodsGrid,la=modules.activity.others.A_OsDataModel,ca=protos.guild.tos_12946,da=layouts.tower.TowerFightSuccessLayoutUI,ua=(modules.copy.order.Hundun_Order,modules.backpack.order.BackPack_InternalOrder,modules.weaponsoul.order.WeaponSoulOrder,layouts.pet.PetEggSelectItemUI),ha=modules.boss.others.BossModel,_a=(modules.skill.order.Skill_InternalOrder,layouts.teamCopy.TeamCopyMainVUI),pa=protos.strength.tos_11001,fa=(modules.copy.others.ECopyType,modules.siege.order.Siege_ServiceOrder,layouts.crossbattle.newworldboss.CrossNewWorldBossViewUI),ga=ui.gridrender.MGridsList,va=modules.actor.views.longwen.LongWenToolsTips,ma=(global.PanelConst,modules.actor.views.active.ActorSelector),ba=layouts.teamCopy.TeamCopyYaoQingItemUI,wa=layouts.crossbattle.newworldboss.CrossNewBossFightItemUI,ya=layouts.hllx._FireDragonZhuWeiViewUI,xa=layouts.guild.siege.GC_ScAwardsItemUI,Ia=(modules.corssbattle.views.crossboss.CrossBossTitle,modules.recharge.order.Recharge_order,protos.db.BossHome),Sa=layouts.magic.NavHelpFriendUI,ka=protos.db.PetLvUpgradeResource,Ca=layouts.boss.worldBoss._Boss_WorldBossMainViewUI,Ta=(protos.copy.teamCopy.toc_30681,protos.db.BaseConfig),Ea=protos.guild.tos_12919,La=layouts.auctionhouse.cashExchangeViewUI,Aa=modules.tqyueka.others.TqMonthCardUtil,Ba=protos.vip.tos_14002,Da=layouts.fazhen.FazhenViewUI,Oa=protos.tianguan.tos_21701,Va=modules.actor.views.mo.MoEquipToolTip,Ma=protos.tianguan.tos_21704,Ra=protos.tianguan.tos_21705,Pa=protos.tianguan.tos_21706,Na=protos.tianguan.tos_21708,Ga=layouts.crossbattle.crossboss.CrossBossCenterItemUI,Ua=(modules.fight.order.Fight_order,protos.newworldboss.NewWorldBoss_Request_Info_30856_tos),Ha=zwc.engine.core.protos.Socket_tos,Fa=(protos.boss.worldboss.Toc_21252,protos.tianguan.toc_21702,protos.tianguan.toc_21707,protos.tianguan.toc_21709,protos.guild.tos_30778),za=layouts.boss._Boss_GodRefreshUI,Wa=layouts.pig.pigTwo.PigTwoChangeStrongViewUI,ja=modules.broadcast.views.Alert,qa=modules.backpack.views.tip.RingToolTip,Ya=protos.guild.tos_30777,Ka=protos.db.CActivityEntranceResource,Ja=layouts.friendnew.FriendNewMainViewUI,Xa=(modules.nav.order.Nav_InternalOrder,protos.db.CSceneCheckPoint),Qa=(modules.fashion.order.Fashion_order,layouts.tower.TowerRankSimpleItemLayoutUI),Za=layouts.boss.scene._Boss_GWshengyuViewUI,$a=(protos.fashion.DtoFashion,modules.copy.others.CopyTowerData),er=layouts.crossbattle.newworldboss.CrossNewBossSceneItemUI,tr=layouts.crossbattle.newworldboss.CrossNewBossKillRecordViewUI,ir=(zwc.engine.core.displays.avatars.ActConst,protos.guild.tos_30772),sr=protos.db.PetColorUpgradeResource,nr=protos.db.CFashionModel,or=protos.guild.tos_30770,ar=layouts.guild.boss._GuildBoss_InfoUI,rr=modules.firedragon.others.FireDragonData,lr=(layouts.fashion.FashionAchieveRenderUI,layouts.crossbattle.newworldboss.CrossNewBossAttentionItemUI),cr=(modules.tqyueka.order.TqMonthCardOrder,modules.chat.views.ChatSimpleUI,layouts.boss._Boss_RefreshNoteUI),dr=(modules.pet.others.PetConst,protos.db.RoleLevelResource),ur=utils.StringUtils,hr=(protos.scene.heji.toc_24033,protos.db.CTeamCopyModel),_r=layouts.guild.manage._GuildApplyMngViewUI,pr=(modules.nav.views.sub.NavMissionView,protos.boss.toc_21209,modules.actor.views.soaring.SoaringEquipTip),fr=modules.activity.proxys.ActivityProxy,gr=protos.db.CEnhanceModel,vr=protos.friendsnew.tos.FriendNew_request_addChat_30472_tos,mr=(protos.guild.toc_30776,layouts.guild.raisekunmaster.RaiseKunSkillGridUI),br=laya.filters.GlowFilter,wr=modules.backpack.others.enum.EGoodsConst,yr=protos.db.CMatMisstionPrice,xr=protos.db.ConfigGuildLevel,Ir=layouts.fazhen.FazhenJulianViewUI,Sr=modules.fight.views.Fight_Relive,kr=layouts.teamCopy.TeamCopyStrategyVUI,Cr=layouts.guild.siege.GC_AwardsViewUI,Tr=layouts.pig.pigTwo.PigTwoSuccessUI,Er=(protos.guild.toc_30771,ui.controls.ConfigView_Temp_1,layouts.guild.boss.CallBossItemUI),Lr=modules.achievenew.views.tujian.Tujian_ToolTips,Ar=layouts.boss.jipinRecord._jipinItemViewUI,Br=(layouts.tower.TowerCengLayoutUI,modules.guild.order.Guild_InternalOrder,layouts.crossbattle.CrossBattleItemUI),Dr=layouts.pet.PetPopUI,Or=global.GC,Vr=modules.copy.others.TeamCopyModelData,Mr=protos.db.CYiguiResource,Rr=protos.db.PetLeadModel,Pr=layouts.guild.boss._GuildBoss_SceneUI,Nr=laya.display.Text,Gr=layouts.guild.domain._GuildKun_ViewUI,Ur=layouts.fashion.FashionSuitItemUI,Hr=protos.db.CKunResource,Fr=(protos.guild.toc_12970,modules.chat.views.ChatInfoUI),zr=modules.nav.others.NavDataModel,Wr=modules.pet.others.Petvo,jr=ui.SubPanel,qr=modules.backpack.views.tip.GoodsToolTip,Yr=protos.copy.tos_21201,Kr=utils.InputUtils,Jr=layouts.crossbattle.crossboss.CrossBossEnterViewUI,Xr=protos.copy.tos_21202,Qr=(protos.boss.toc_30372,protos.boss.toc_30371,protos.boss.toc_30370,protos.boss.toc_30375,modules.nav.others.redpt.RedptM),Zr=(protos.guild.toc_12918,layouts.fashion.FashionSuitAttrUI),$r=protos.db.PetResource,el=protos.db.CFazhenSkill,tl=(modules.login.order.Login_IntOrder,modules.broadcast.others.EMsgShow,layouts.auctionhouse.myrecordMainViewUI),il=layouts.guild.boss._GuildBoss_BossItemUI,sl=layouts.auctionhouse.myattentionViewUI,nl=layouts.crossbattle.newworldboss.CrossNewBossKillRecordItemUI,ol=layouts.guild.store._GuildStore_RedResultViewUI,al=(zwc.engine.core.displays.world.char.MainChar,modules.nav.views.sub.NavFirstPayTime),rl=protos.strength.tos_30876,ll=protos.pet.tos_30979,cl=protos.pet.tos_30975,dl=protos.pet.tos_30974,ul=protos.pet.tos_30976,hl=protos.pet.tos_30971,_l=protos.db.CLunhuiModel,pl=protos.pet.tos_30973,fl=(modules.corssbattle.order.NewWorldBoss_ServiceOrder,layouts.tower.TowerLotteryLayoutUI),gl=(protos.strength.toc_30877,modules.bossancient.order.BossAncient_InterOrder,protos.pet.toc_30978,protos.pet.toc_30977,protos.strength.toc_30879,protos.pet.toc_30972,laya.ui.Box),vl=modules.guild.views.domain.scene.GuildKun_NoticeView,ml=protos.friendsnew.tos.FriendNew_request_readPlayer_30474_tos,bl=layouts.boss.worldBoss._Boss_WorldBossRankViewUI,wl=layouts.pig.DailyCopyVUI,yl=protos.db.CBlackGoodsMatch,xl=protos.guild.tos_12987,Il=modules.siege.others.SiegeData,Sl=protos.guild.tos_12981,kl=(laya.utils.Timer,protos.guild.toc_12945,protos.char.toc_10301,modules.backpack.views.item.GridPanel),Cl=(protos.copy.teamCopy.toc_30710,layouts.guild.boss._GuildBoss_RankItemUI),Tl=protos.backpack.DtoEquip,El=(protos.siege.toc_12986,protos.guild.toc_12982,modules.nav.others.redpt.RedPtConst),Ll=(modules.chat.others.EChannel,layouts.teamCopy.TeamCopyRoomItemVUI),Al=protos.friendsnew.tos.FriendNew_request_list_30469_tos,Bl=modules.task.views.ArrowView,Dl=(modules.strength.order.Strength_ServiceOrder,laya.ui.Image),Ol=layouts.fashion.ClothesDisposeTipUI,Vl=modules.broadcast.others.BroadcastUtils,Ml=layouts.fazhen.FazhenItemUI,Rl=protos.guild.tos_12913,Pl=(protos.guild.Dto_GuildMem,protos.guild.tos_12917),Nl=protos.boss.tos_30376,Gl=protos.guild.tos_12915,Ul=protos.boss.tos_30374,Hl=global.web.WebSdkUtil,Fl=zwc.engine.core.controls.dock.Message,zl=layouts.guild.base._GuildBase_ViewUI,Wl=modules.activity.JxrManager,jl=(ui.layerrender.IMRenderer,layouts.boss._Boss_MijingItemUI,protos.db.PetFootEffect),ql=(modules.scene.order.Scene_InternalOrder,modules.map.others.MapDataModel),Yl=laya.utils.Tween,Kl=protos.guild.tos_12933,Jl=(protos.guild.toc_12910,layouts.pet.PetgetEggTipUI),Xl=protos.db.CMonsterData,Ql=(laya.debug.tools.JsonTool,protos.tqyueka.toc_22357,protos.tqyueka.toc_22352,modules.strength.others.FazhenAttrCache),Zl=(modules.nav.views.sub.NavAttackOther,modules.gui.others.LayerManager),$l=layouts.crossbattle.newworldboss.CrossNewBossSceneViewUI,ec=layouts.hllx._FireDragonRankViewUI,tc=layouts.pig.pigTwo.PigTwoAwardsItemUI,ic=modules.nav.others.NavActUtil,sc=modules.actor.others.ActorData,nc=utils.HtmlUtils,oc=protos.scene.DtoEnterScene,ac=(layouts.fashion.FashionAttrRenderUI,modules.corssbattle.others.CrossBossVo,modules.scene.others.GameStage),rc=(protos.scene.toc_22604,protos.db.CMateMissionTimes),lc=(protos.scene.toc_22606,layouts.guild.domain._GuildKunFeedVUI),cc=(protos.scene.toc_22602,modules.activity.others.ActivityRequestUtil),dc=layouts.boss.scene._Boss_CheckPointSceneUI,uc=protos.boss.worldboss.Tos_21251,hc=modules.digger.others.AE_BubbleDataModel,_c=laya.ui.Panel,pc=modules.copy.others.CopyData,fc=(protos.scene.DtoZhanBao,protos.boss.toc_21259,layouts.fashion.FashionNameRenderUI,modules.boss.order.Boss_ServiceOrder,modules.rank.others.RankData,layouts.pet.PetBaseViewUI),gc=layouts.friendnew.FriendNewRecentPlayerHeadItemLayoutUI,vc=(modules.zzt.order.ZztOrder,protos.strength.tos_30878),mc=zwc.engine.global.GConst,bc=layouts.guild.domain._GuildKunRewardVUI,wc=layouts.boss.worldBoss._Boss_WorldBossZhuWeiViewUI,yc=(modules.corssbattle.views.crossboss.CrossBossResultView,layouts.soulout.soulskin.SoulSkillGridUI),xc=global.ClearTextureUtils,Ic=layouts.guild.domain.scene._Boss_KunSceneUI,Sc=protos.db.CEnchantModel,kc=protos.strength.tos_30875,Cc=protos.guild.tos_12928,Tc=modules.CustomModule,Ec=layouts.boss.worldBoss._Boss_WorldBossItemUI,Lc=layouts.guild.siege._GuildGc_NewSiegeVUI,Ac=modules.siege.others.SiegeReqs,Bc=(protos.pig.two.toc_25003,modules.scene.others.invented.InventedUtils),Dc=(protos.copy.teamCopy.toc_25006,protos.firedragon.toc_25005,protos.firedragon.toc_25004,protos.guild.Guild_recordInout_12983_toc,modules.nav.views.sub.NavAutoWay,protos.db.CrossBossMissionResource),Oc=protos.db.CGuildShopGoods,Vc=layouts.pig.mental.MentalMoppingTipUI,Mc=layouts.boss.flyupBoss.FlyupBossMainLayoutUI,Rc=(protos.db.CActivityIcon,layouts.guild.boss._GuildBoss_InfoItemUI),Pc=(layouts.guild.base._GuildGuilditem_ViewUI,global.sound.SoundUtil),Nc=protos.db.CFazhenResourse,Gc=layouts.guild.domain._GuildKunOpenVUI,Uc=layouts.boss._Boss_MijingAlertViewUI,Hc=protos.friendsnew.tos.FriendNew_request_add_30466_tos,Fc=(global.GI,laya.ui.ViewStack,laya.debug.DebugPanel),zc=modules.pet.views.EggTips,Wc=(protos.guild.toc_12943,modules.scene.others.SceneUtils),jc=layouts.res.basicUIConst,qc=layouts.guild.base._GuildGuildlist_ViewUI,Yc=protos.db.CAuctionWorldBossResource,Kc=(protos.boss.DtoMijingBossData,layouts.pet.PetEggSelectViewUI),Jc=zwc.engine.core.displays.avatars.AvatarUnitDisplay,Xc=protos.db.ConfigShaoZhuCommon,Qc=(modules.corssbattle.others.CrossBettleItemTypeConst,utils.CommonUtils),Zc=(protos.guild.Guild_recordPosChange_12984_toc,protos.db.CDescModel),$c=layouts.friendnew.FriendNewAddLayoutUI;protos.guild.toc_30846;ZB_Act=protos.scene.ZB_Act,Di=zwc.Engine,Hl=global.web.WebSdkUtil;zwc.engine.core.protos.Socket_toc,Ha=zwc.engine.core.protos.Socket_tos;var ed=global.C,td=modules.pet.views.PetSkillTip1,id=modules.pet.views.PetSkillTip2,sd=modules.firedragon.view.FireDragonRankItem2,nd=modules.copy.views.daily.pigTwo.PigTwoGoodsGrid;Y.interface("modules.resonate.views.IResonateView"),Y.interface("zwc.saiman.interfaces.IAI","zwc.saiman.interfaces.IProto"),Y.interface("zwc.saiman.interfaces.displays.IAvatar","zwc.saiman.interfaces.displays.IDisplay");(function(e){function t(){t.__super.call(this),this.registerSubProxy(od),this.subPackages=["CROSSBATTLEOPEN","30744"]}u(t,"modules.corssbattle.CrossBattleModule",Tc)})(),function(e){function t(){t.__super.call(this),this.registerSubProxy(ad),this.subPackages=["CROSSBOSSOPEN","CROSSBOSSENTER","24034","30742","25009","25011"]}u(t,"modules.corssbattle.CrossBossModule",Tc)}(),function(e){function t(){t.__super.call(this),this.registerSubProxy(rd),this.subPackages=["30744","30857","30861","30859","25018"]}u(t,"modules.corssbattle.NewBossModule",Tc)}();var od=function(e){function t(){this._mainView=null,t.__super.call(this);var e=[Or.getLayoutsPath("crossbattle")];On.ins.registPanel("CROSSBATTLE_MAIN_VIEW",cd,"_mainView",this,{wait:On.wait(On.waitRes(e)),layer:"layout",mask:!1})}u(t,"modules.corssbattle.proxys.CrossBattleProxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"CROSSBATTLREQDATA":var t=new a;Fl.sendToService(t);break;case"CROSSBATTLEOPEN":if(On.ins.isOpen("CROSSBATTLE_MAIN_VIEW"))On.ins.close("CROSSBATTLE_MAIN_VIEW");else{var i=0,s=null;e.proto&&(e.proto.hasOwnProperty("_subIndex_")&&(i=e.proto._subIndex_),e.proto.hasOwnProperty("backID")&&(s=e.proto.backID)),On.ins.open("CROSSBATTLE_MAIN_VIEW",{_subIndex_:i},s)}break;case"30744":L.ins.crossBattleData=e.proto,Fl.sendToModule("CROSSBATTLEOPEN",["modules.corssbattle.CrossBattleModule"])}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),ad=function(e){function i(){var e=this;e._mainView=null,e._bossEnter=null,i.__super.call(e);var t=[Or.getLayoutsPath("crossbattle"),Or.getLayoutsPath("treasure"),Or.getLayoutsPath("crossboss"),Or.getLayoutsPath("mission")];On.ins.registPanel("CROSSBOSS_MAIN_VIEW",pd,"_mainView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["CrossBossMissionResource","ConfigRule"],["CrossBossMissionResource","CHelpDes"])),layer:"layout",mask:!1}),On.ins.registPanel("CROSSBOS_ENTER_VIEW",hd,"_bossEnter",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["CrossBossMissionResource"],["CrossBossMissionResource"])),mask:!0})}u(i,"modules.corssbattle.proxys.CrossBossProxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"CROSSBOSSOPEN":if(On.ins.isOpen("CROSSBOSS_MAIN_VIEW"))On.ins.close("CROSSBOSS_MAIN_VIEW");else{var i=0;e.proto&&e.proto.hasOwnProperty("_subIndex_")&&(i=e.proto._subIndex_),On.ins.open("CROSSBOSS_MAIN_VIEW",{_subIndex_:i},0)}break;case"CROSSBOSSRESULT":Nn.ins.showCompoment("CROSSBOSSRESULTVIEW"),Nn.ins.notice(["CROSSBOSSRESULTVIEW"],e);break;case"CROSSBOSSENTER":On.ins.open("CROSSBOS_ENTER_VIEW",e.proto);break;case"CROSSBOSSDEAD":Nn.ins.hideCompoment("NavAttackOther"),Nn.ins.notice(["CROSSBOSSTITLE"],e),L.ins.isBorn=0;break;case"CROSSBOSSENTERSCENE":t.enterSceneHandler();break;case"24034":Nn.ins.showCompoment("CROSSBOSSCAIJIBAR"),Nn.ins.notice(["CROSSBOSSCAIJIBAR"],e);break;case"30742":L.ins.crossBossData=e.proto,Nn.ins.notice(["CROSSBOSSTITLE"],e),t._mainView&&t._mainView.parent&&t._mainView.updateByVSC(e.proto);break;case"25009":Nn.ins.notice(["CROSSBOSSCAIJIBAR"],e);break;case"25011":var s=e.proto;L.ins.curBossId=s.bossId,L.ins.isBorn=s.isRefresh,xn.ins.lockBossId=s.bossId,Nn.ins.notice(["CROSSBOSSTITLE"],e),1==s.isRefresh&&(Nn.ins.showCompoment("NavAttackOther"),Vl.ins.playRainbowByWords(ed.n[1489]),xn.ins.setDropBtnStatus(L.ins.curBossId,!0,ms.create(t,t.onAward,null,!1))),Nn.ins.notice(["NavAttackOther"],e)}},t.onAward=function(){On.ins.open("BOSS_WILD_SCENE_AWARD",{id:ha.ins.curCopyId})},t.enterSceneHandler=function(){L.ins.bossisBorn()&&Vl.ins.playRainbowByWords(ed.n[1490])},t.showPanel=function(e,t){"CROSSBOS_ENTER_VIEW"==e&&this._bossEnter&&this._bossEnter.update(t)},t.closePanel=function(e,t){},i}(),rd=function(d){function i(){var e=this;e._mainCrossBossView=null,e._refreshView=null,e._killRecordView=null,e._killDetailView=null,e._sceneBossView=null,i.__super.call(e);var t=[Or.getLayoutsPath("crossbattle")];On.ins.registPanel("CROSSNEWWORLDBOSSPANEL",kd,"_mainCrossBossView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["ConfigRule"],["CHelpDes"])),layer:"layout",mask:!1}),On.ins.registPanel("CrossNewBossAttentionView",vd,"_refreshView",e,{}),On.ins.registPanel("CrossNewBossFightView",bd,"_killDetailView",e,{}),On.ins.registPanel("CrossNewBossKillRecordView",yd,"_killRecordView",e,{}),On.ins.registPanel("CrossNewBossSceneView",Id,"_sceneBossView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["MissionTransfers"],["MissionTransfers"]))})}u(i,"modules.corssbattle.proxys.CrossNewWorldBossProxy",d);var e=i.prototype;return Y.imps(e,{"ui.IPanelProxy":!0}),e.subHandler=function(e){var t=this;d.prototype.subHandler.call(t,e);var i=0,s=0;switch(e.actionOrder){case"OPENMAINVIEW":On.ins.isOpen("CROSSNEWWORLDBOSSPANEL")||On.ins.open("CROSSNEWWORLDBOSSPANEL",null,0);break;case"30744":var n=e.proto;ao.ins().currentStatue=n.newBossStatues;break;case"30857":var o=e.proto;ao.ins().update30857(o),t._mainCrossBossView&&t._mainCrossBossView.parent&&t._mainCrossBossView.updateByVSC(e.proto),t._refreshView&&t._refreshView.parent&&t._refreshView.updateView();break;case"30861":var a=e.proto;ao.ins().update30861(a),t._mainCrossBossView&&t._mainCrossBossView.parent&&t._mainCrossBossView.updateByVSC(e.proto);break;case"30859":var r=e.proto;ao.ins().update30859(r),t._mainCrossBossView&&t._mainCrossBossView.parent&&t._mainCrossBossView.updateByVSC(e.proto),t._killDetailView&&t._killDetailView.parent&&t._killDetailView.updateInfo();break;case"MOVE_END_TO_MONSTER":i=uo.getIndex(ha.ins.curCopyId),s=uo.MODEL.cate(i);var l=e.proto;if(56==s&&null!=l)if(0==Ys.count){var c=[{url:Or.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Ys}];Wl.ins().onLoadJxrs(c,ms.create(t,t.onJxrComplete,[l]))}else t.onJxrComplete(l);break;case"__SCENE_CHANGED__":On.ins.isOpen("MapPanel")&&On.ins.close("MapPanel");break;case"CREATE_SCENE_COMPLETE":switch(i=uo.getIndex(ha.ins.curCopyId),s=uo.MODEL.cate(i)){case 56:0<ao.ins().backMissionID?Nn.ins.showCompoment("NavAutoWay"):0<ao.ins().currentSelectMissionID&&t.toBoss(ao.ins().currentSelectMissionID);break;case 57:null!=ha.ins.enterScenceBossInfo&&Bs.fights(ha.ins.enterScenceBossInfo.objectId),zr.isTarMove=!1}break;case"25018":t._sceneBossView&&t._sceneBossView.parent}},e.toBoss=function(e){if(0==Ys.count){var t=[{url:Or.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Ys}];Wl.ins().onLoadJxrs(t,ms.create(this,this.loadComplete,[e]))}else this.loadComplete(e)},e.loadComplete=function(e){for(var t=0;t<Ys.count;t++)if(Ys.MODEL.nextMissionId(t)==e){var i=Ys.MODEL.location(t),s=i[0],n=i[1],o=new is(s,n),a=Bc.findCharsBySize(o,5);if(0<a.length){var r=ac.mainChar,l=a[0];if(ac.Ins().selectChar=l,ql.Ins().updateClickPoint(l.tileX,l.tileY),Wc.getTileDisByPos(l.tileX,l.tileY,r.tileX,r.tileY)<=0)ac.Ins().onMoveEndHander();else{h.getCharNearPt(l);se.Ins().mainCharMove(l.point,!0,ms.create(ac.Ins(),ac.Ins().onMoveEndHander),!0)}}break}},e.onJxrComplete=function(e){for(var t=e.proto,i=parseInt(t.modelId),s=0;s<Ys.count;s++)if(Ys.MODEL.bossId(s)==i){var n=Ys.MODEL.nextMissionId(s),o=Ys.MODEL.nextMissionId(s),a=ql.Ins().mapBossDate[n];a&&0<a.bossHp?on.reqEntry(o):On.ins.open("CrossNewBossSceneView");break}},e.showPanel=function(e,t){var i=this;switch(e){case"CROSSNEWWORLDBOSSPANEL":i._mainCrossBossView&&i._mainCrossBossView.parent;break;case"CrossNewBossAttentionView":i._refreshView&&i._refreshView.parent&&i._refreshView.updateView()}},e.closePanel=function(e,t){},i}(F),ld=function(e){function t(){this.crossType=0,this._bubble=null,t.__super.call(this)}u(t,"modules.corssbattle.views.CrossBattleItem",Br);var i=t.prototype;return i.setData=function(e){var t=this,i=P.MODEL.entranceIcon(e),s=P.MODEL.entranceName(e);t.crossType=P.MODEL.playType(e),t.crossType;var n=P.MODEL.show(e);t.icon.skin=Or.getAtlasSubPath("crossbattle/"+i+".png"),t.bossname.skin=Or.getAtlasSubPath("crossbattle/"+s+".png"),t.visible=1==n},i.onClick=function(e){switch(this.crossType){case 1:if(L.ins.crossBattleData)switch(L.ins.crossBattleData.crossBossStatus){case 0:Fl.sendToModule("CROSSBOSSOPEN",["modules.corssbattle.CrossBossModule"]);break;case Mi.status1:Vl.ins.showById(4537,1);break;case Mi.status2:Vl.ins.showById(4538,1);break;case Mi.status3:Vl.ins.showById(4539,1)}break;case 2:switch(ao.ins().currentStatue){case 0:if(bs.getInstance().checkModuleOpen(79))Fl.sendToModule("OPENMAINVIEW",["modules.corssbattle.NewBossModule"]);else{var t=bs.getInstance().getErrorTips(79);Vl.ins.showMsg(t,1)}break;case Mi.status1:Vl.ins.showById(4537,1);break;case Mi.status2:Vl.ins.showById(4538,1);break;case Mi.status3:Vl.ins.showById(4539,1)}}},i.createBubble=function(){if(null==this._bubble){var e=Zc.MODEL.content(Zc.getIndex(4920));this._bubble=Ni.addShow(e,this,0,0,!0,3)}},i.refreshRedPoint=function(){var e=this;switch(e.crossType){case 1:L.ins.crossBattleData&&0==L.ins.crossBattleData.crossBossStatus&&(Qr.ins.getStateByCareList([268])?e.btn_red.visible=!0:e.btn_red.visible=!1);break;case 2:Qr.ins.getStateByCareList([274])?e.btn_red.visible=!0:e.btn_red.visible=!1}},i.onAdd=function(e){var t=this;t.on("click",t,t.onClick),ui.ViewBase.prototype.onAdd.call(t,e),t.btn_red.visible=!1},i.onRemove=function(e){var t=this;t.off("click",t,t.onClick),ui.ViewBase.prototype.onRemove.call(t,e),t._bubble&&(t._bubble.removeSelf(),t._bubble.destroy(),t._bubble=null)},t}(),cd=function(i){function e(){this.vsc=null,this.bossOpenLv=0,this.bossOpenLv=1,e.__super.call(this)}u(e,"modules.corssbattle.views.CrossBattlePanel",i);var t=e.prototype;return t.initialize=function(){var e=this;e.size(720,1280),e.top=e.bottom=e.left=e.right=0,e.navList=[],e.vsc=new o(e),e.vsc.registAll([{cls:dd,id:"0",isHideBg:!0,wait:On.wait(On.waitConfig(["CrossBattleMainShow"],["CrossBattleMainShow"]))}]),e.vsc.invalid(),e.title=Or.getAtlasSubPath("crossbattle/kfzc_text_kfzc.png"),e.vsc.filterHandler=ms.create(e,e.onVscFilter,null,!1)},t.onVscFilter=function(e,t){return"0"==e&&Qr.ins.getStateByCareList([104])?3:0},t.onRemove=function(e){i.prototype.onRemove.call(this,e)},t.onAdd=function(e){i.prototype.onAdd.call(this,e),Qr.reqRedPt([268]);var t=ms.create(this,this.redPtUpdate,null,!1);Qr.ins.addListener("BTN_CROSSBOSS",[268],t)},t.redPtUpdate=function(e,t){this.vsc&&this.vsc.updateSelectedView&&this.vsc.updateSelectedView()},t.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,i.prototype.destroy.call(this,e)},e}(jr),dd=function(n){function e(){this.battllIPos=null,this.itemArr=null,e.__super.call(this)}u(e,"modules.corssbattle.views.CrossBattleView",n);var t=e.prototype;return t.createChildren=function(){var e=this;n.prototype.createChildren.call(e),e.itemArr=[];var t=P.count;e.battllIPos=[[-5,190],[377,150],[79,469],[408,522],[327,811]];var i,s=0;for(s=0;s<t;s++)(i=new ld).pos(e.battllIPos[s][0],e.battllIPos[s][1]),i.setData(s),e.addChild(i),e.itemArr.push(i)},t.updateByVSC=function(e){this.updateRedPoint()},t.updateRedPoint=function(){if(0<this.itemArr.length)for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].refreshRedPoint()},t.initBattle=function(){},t.onAdd=function(e){this.initBattle(),ui.ViewBase.prototype.onAdd.call(this,e)},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},e}(rt),ud=function(e){function t(){this.copyid=0,this.isOpen=1,this.countTime=0,t.__super.call(this)}u(t,"modules.corssbattle.views.crossboss.CrossBossCenterItem",Ga);var i=t.prototype;return i.setData=function(e){var t=this;if(e){t.copyid=e.copyId,t.txt_limit.changeText(e.zsLimitStr);var i=Dc.MODEL.missionType(Dc.getIndex(t.copyid));if(0==e.serverId?(0==i||(t.isOpen=0,t.gray=!0),t.txt_server.changeText(""),t.serverbg.visible=!1):(t.txt_server.changeText("S."+e.serverId+"服"),t.serverbg.visible=!0),Gi.ins.serverId==e.serverId){var s=Gi.ins.actorById(1);t.txt_server.changeText("本服"),s&&(t.headImg.scaleX=t.headImg.scaleY=.6,t.headImg.skin=Or.getActorHeadPath(s.job,s.sex))}Dc.MODEL.entrance(Dc.getIndex(t.copyid));var n=Dc.MODEL.btnIcon(Dc.getIndex(t.copyid));t.img_icon.skin=Or.getAtlasSubPath("crossboss/"+n+".png");var o=Dc.MODEL.entrance(Dc.getIndex(t.copyid));o&&(t.bossname.skin=Or.getAtlasSubPath("crossboss/"+o+".png"));var a=L.ins.getBossRefreshTime(t.copyid);t.countTime=a-J.serverTimeSec,0<t.countTime?(t.txt_limit.y=291,t.onResetTime(),0<t.countTime&&Y.timer.loop(1e3,t,t.onResetTime)):(t.txt_time.changeText(""),t.txt_limit.y=305);var r=e.caijileftTime-J.serverTimeSec;if(e.getzsLevelLimit()){if(L.ins.crossBossData&&(!L.ins.crossBossData.map[t.copyid]||0==L.ins.crossBossData.map[t.copyid].selected)&&(0<L.ins.crossBossData.bossCount||L.ins.crossBossData.assitCount)&&t.isOpen&&t.countTime<=0)return void(t.btn_red.visible=!0);L.ins.crossBossData&&0<L.ins.crossBossData.caijiCount&&t.isOpen&&r<=0&&(t.btn_red.visible=!0)}}},i.onResetTime=function(){var e=this;e.txt_time.changeText(ed.n[1491]+V.getENTickMS(e.countTime)),e.countTime--,e.countTime<=0&&(Y.timer.clear(e,e.onResetTime),e.txt_time.changeText(""),e.txt_limit.y=305)},i.onClick=function(e){0!=this.isOpen?Fl.sendToModule("CROSSBOSSENTER",["modules.corssbattle.CrossBossModule"],this.copyid):Vl.ins.showMsg(ed.n[1492],1)},i.onAdd=function(e){var t=this;t.on("click",t,t.onClick),ui.ViewBase.prototype.onAdd.call(t,e),t.isOpen=1,t.btn_red.visible=!1},i.onRemove=function(e){var t=this;t.off("click",t,t.onClick),Y.timer.clear(t,t.onResetTime),ui.ViewBase.prototype.onRemove.call(t,e)},t}(),hd=function(e){function t(){var e=this;e.BossSp=null,e._avatar=null,e._copyId=0,e.bossId=0,e.awardArr=[],e.textArr=[],t.__super.call(e)}u(t,"modules.corssbattle.views.crossboss.CrossBossEnterView",e);var i=t.prototype;return i.onAdd=function(e){this.btn_go.on("click",this,this.onClick),ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){this.btn_go.off("click",this,this.onClick),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_go:this.enterCopy()}},i.enterCopy=function(){ri.ins.hasEmptyNum(20)?on.reqEntry(this._copyId):ja.ins.showBagRecycle()},i.createChildren=function(){e.prototype.createChildren.call(this)},i.update=function(e){var t=this;if(null==t.BossSp&&(t.BossSp=new rn,t.BossSp.pos(362,350),t.addChild(t.BossSp)),t._avatar||(t._avatar=new Jc,t._avatar.renderInSelf=!0,t.BossSp.addChild(t._avatar)),0<e){if(t._copyId=e,t.bossId=Dc.MODEL.bossId(Dc.getIndex(e)),t.bossId){var i=Xl.getIndex(t.bossId),s=Xl.MODEL.muId(i);i=Cs.getIndex(s);Cs.count;var n=Cs.MODEL.avatarId(i);t._avatar.mid=n,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.scale_X=t._avatar.scale_Y=.9,t.setAward()}var o=Dc.MODEL.bossName(Dc.getIndex(t._copyId));t.bossName.skin=Or.getAtlasSubPath("crossboss/"+o+".png")}},i.setAward=function(){var e=uo.MODEL.bossShowAward(uo.getIndex(this._copyId));if(e)for(var t=e.split(";"),i=0;i<t.length;i++){var s=t[i].split(",")[0];this.setGodEquipStar(s,i)}},i.setGodEquipStar=function(e,t){var i=an.create(e);this.awardArr[t].bindData=i,this.textArr[t].text=i.simpleName,this.textArr[t].color=Co.getByQuality(i.colourId)},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e);for(var t=0;t<5;t++){var i=new ra(92);i.x=88+112*t,i.y=459,e.addChild(i),e.awardArr.push(i);var s=new Nr;s.x=i.x-22,s.y=i.y+100,s.font="SimHei",s.width=135,s.align="center",s.fontSize=20,e.addChild(s),e.textArr.push(s)}},i.destroy=function(e){var t=this;void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(t,e),t._avatar&&(t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.awardArr.length=0,t.textArr.length=0},t}(Jr),_d=function(e){function t(){this.copyid=0,this.isOpen=1,this.countTime=0,t.__super.call(this)}u(t,"modules.corssbattle.views.crossboss.CrossBossItem",os);var i=t.prototype;return i.setData=function(e){var t=this;if(e){t.copyid=e.copyId,t.txt_limit.changeText(e.zsLimitStr);var i=Dc.MODEL.missionType(Dc.getIndex(t.copyid));if(0==e.serverId?(0==i||(t.isOpen=0,t.img_icon.gray=!0),t.txt_server.changeText(""),t.serverbg.visible=!1):(t.txt_server.changeText("S."+e.serverId+"服"),t.txt_server.color="#e0d6c1",t.serverbg.visible=!0),Gi.ins.serverId==e.serverId){var s=Gi.ins.actorById(1);t.txt_server.changeText("本服"),t.txt_server.color="#e6d80d",s&&(t.headImg.scaleX=t.headImg.scaleY=.6,t.headImg.skin=Or.getActorHeadPath(s.job,s.sex))}Dc.MODEL.entrance(Dc.getIndex(t.copyid));var n=Dc.MODEL.btnIcon(Dc.getIndex(t.copyid));t.img_icon.skin=Or.getAtlasSubPath("crossboss/"+n+".png");var o=L.ins.getBossRefreshTime(t.copyid);t.countTime=o-J.serverTimeSec,0<t.countTime?(t.txt_limit.y=202,t.onResetTime(),0<t.countTime&&Y.timer.loop(1e3,t,t.onResetTime)):(t.txt_time.changeText(""),t.txt_limit.y=216);var a=e.caijileftTime-J.serverTimeSec;if(e.getzsLevelLimit()){if(L.ins.crossBossData&&(!L.ins.crossBossData.map[t.copyid]||0==L.ins.crossBossData.map[t.copyid].selected)&&(0<L.ins.crossBossData.bossCount||L.ins.crossBossData.assitCount)&&t.isOpen&&t.countTime<=0)return void(t.btn_red.visible=!0);L.ins.crossBossData&&0<L.ins.crossBossData.caijiCount&&t.isOpen&&a<=0&&(t.btn_red.visible=!0)}}},i.onResetTime=function(){var e=this;e.txt_time.changeText(ed.n[1491]+V.getENTickMS(e.countTime)),e.countTime--,e.countTime<=0&&(Y.timer.clear(e,e.onResetTime),e.txt_time.changeText(""),e.txt_limit.y=216)},i.onClick=function(e){0!=this.isOpen?Fl.sendToModule("CROSSBOSSENTER",["modules.corssbattle.CrossBossModule"],this.copyid):Vl.ins.showMsg(ed.n[1492],1)},i.onAdd=function(e){var t=this;t.on("click",t,t.onClick),ui.ViewBase.prototype.onAdd.call(t,e),t.isOpen=1,t.btn_red.visible=!1},i.onRemove=function(e){var t=this;t.off("click",t,t.onClick),ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clear(t,t.onResetTime)},t}(),pd=function(t){function e(){this.vsc=null,this.bossOpenLv=0,e.__super.call(this)}u(e,"modules.corssbattle.views.crossboss.CrossBossPanel",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.top=e.bottom=e.left=e.right=0,e.vsc=new o(e),e.vsc.registAll([{cls:fd,id:"0",isHideBg:!0}]),e.vsc.invalid(),e.title=Or.getAtlasSubPath("crossboss/kfboss_text_kfboss.png")},i.updateByVSC=function(e){this.vsc.selectedView.updateByVSC&&this.vsc.selectedView.updateByVSC(e)},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,t.prototype.destroy.call(this,e)},e}(jr),fd=function(e){function t(){this.bossArr=null,this.bossItemArr=null,this.bossIPos=null,t.__super.call(this)}u(t,"modules.corssbattle.views.crossboss.CrossBossView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.bossItemArr=[],this.bossIPos=[[200,362],[55,193],[317,92],[510,275],[455,650],[73,712]]},i.initBattle=function(e){var t=this;if(e&&t.bossItemArr){t.bossArr=e.copyList;var i,s=0;for(s=0;s<t.bossArr.length;s++)(i=t.bossItemArr[s])||(i=0==s?new ud:new _d,t.box_c.addChild(i),i.pos(t.bossIPos[s][0],t.bossIPos[s][1]),t.bossItemArr.push(i)),i.setData(t.bossArr[s]);t.txt_qi.changeText(e.caijiCount+""),t.txt_boss.changeText(e.bossCount+""),t.txt_help.changeText(e.assitCount+"")}},i.updateByVSC=function(e){this.initBattle(e)},i.onAdd=function(e){var t=this,i=new m;Fl.sendToService(i),t.btn_help.on("click",t,t.onClickHelp),t.txt_remide.on("click",t,t.onClickHanlder),t.txt_jipin.on("click",t,t.toJiPinView),ui.ViewBase.prototype.onAdd.call(t,e)},i.onRemove=function(e){var t=this;t.btn_help.off("click",t,t.onClickHelp),t.txt_remide.off("click",t,t.onClickHanlder),t.txt_jipin.off("click",t,t.toJiPinView),ui.ViewBase.prototype.onRemove.call(t,e)},i.onClickHanlder=function(e){L.ins.crossBossData&&L.ins.crossBossData.copyList&&0<L.ins.crossBossData.copyList.length&&On.ins.open("BOSS_GOD_ATTENTION_VIEW",{type:53})},i.onClickHelp=function(){var e=po.MODEL.description(po.getIndex(13));On.ins.open("AE_EXPLAIN_VIEW",{desc:e})},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.toJiPinView=function(){On.ins.open("BOSS_MAINVIEW",[5],0)},t}(jn),gd=function(e){function t(){this.targetId=0,this.type=0,this.allScore=0,t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossAttentionItem",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.cb_attention.on("click",t,t.onCbHandler),t.cb_attention.visible=t.txt_unLevel.visible=!1},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.cb_attention.off("click",this,this.onCbHandler)},i.onCbHandler=function(e){var t=this,i=ao.ins().bossStatueObj[t.targetId];i&&(i.isCheck=t.cb_attention.selected?0:1,ao.ins().bossStatueObj[t.targetId]=i);var s=new le;s.copyId=t.targetId,s.selected=t.cb_attention.selected,Fl.sendToService(s),t.event("end")},i.intToString=function(e){var t;switch(e){case 1:t="一";break;case 2:t="二";break;case 3:t="三";break;case 4:t="四";break;case 5:t="五";break;case 6:t="六";break;case 7:t="七"}return t},i.setAttention=function(){var e=ao.ins().bossStatueObj[this.targetId];e&&(this.cb_attention.selected=0==e.isCheck)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(lr,t,"dataSource",e),null!=e){t.targetId=e;var i=uo.getIndex(t.targetId),s=i,n=uo.MODEL.bossId(i);t.type=uo.MODEL.cate(i),i=Xl.getIndex(n);var o=uo.MODEL.extraCondition(s);if(o)for(var a=0;a<JSON.parse(o).length;a++){var r=JSON.parse(o)[a];"godEquipScore"==r.type&&(t.allScore=parseInt(r.value))}var l=Xl.MODEL.name(i);t.txt_bname.changeText(l),t.txt_unLevel.visible=!1;var c,d=uo.MODEL.levelLimit(s),u=uo.MODEL.zsLevelLimit(s),h=(ha.ins.getBossIds(57),ao.ins().score);c=9999<t.allScore?Math.floor(t.allScore/1e4)+"万":t.allScore+"",0<t.allScore?t.txt_needLevel.changeText(t.allScore+""):t.txt_needLevel.changeText(u+""),Gi.ins.lv<d?(t.txt_unLevel.visible=!0,t.txt_unLevel.changeText(d+ed.n[1495])):Gi.ins.zsLv<u?(t.txt_unLevel.visible=!0,t.txt_unLevel.changeText(u+ed.n[1496])):t.allScore>h&&0!=t.allScore&&(t.txt_unLevel.visible=!0,t.txt_unLevel.changeText(ed.n[1497]+c)),t.txt_blevel.changeText(u+"转"),t.txt_needLevel.changeText(c),t.cb_attention.visible=!t.txt_unLevel.visible,t.setAttention()}}),t}(lr),vd=function(e){function t(){t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossAttentionView",Jn);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e);var t=new Ua;Fl.sendToService(t)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.initialize=function(){var e=this;e.list.itemRender=gd,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.g_title.skin=Or.getBossPath("boss_text_bosstx")},i.updateView=function(){var e=ha.ins.getBossIds(57);this.list.array=e},t.NAME="CrossNewBossAttentionView",t}(),md=function(e){function t(){t.__super.call(this)}return u(t,"modules.corssbattle.views.newworldboss.CrossNewBossFightItem",e),n(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;Y.superSet(wa,t,"dataSource",e),null!=e&&(t.img_flag.visible=!1,t.img_head.skin=Or.getActorHeadPath(e.job,e.sex),t.txt_playerName.changeText(e.name),0<e.guildID?(t.img_flag.visible=!0,Gi.ins.guildId==e.guildID?t.img_flag.skin="ui/layouts/crossbattle/mjrq_jb_th.png":0<Gi.ins.guildId?t.img_flag.skin="ui/layouts/crossbattle/mjrq_jb_dh.png":t.img_flag.skin="",t.txt_guild.changeText(e.guildName)):t.txt_guild.changeText("无"),t.txt_fight.changeText(e.fight+""))}),t}(wa),bd=function(e){function t(){this._guiShu=null,t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossFightView",kn);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.list_other.itemRender=md,this.list_other.selectEnable=!1,this.list_other.vScrollBarSkin=""},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._guiShu=new md,t._guiShu.pos(40,160),t.addChild(t._guiShu),t.updateInfo();var i=Zc.getIndex(4752);t.txt_info.innerHTML=Zc.MODEL.content(i),t.btn_close.on("click",t,t.onBtnClicked),Y.timer.loop(5e3,t,t.requestView)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onBtnClicked),Y.timer.clearAll(t)},i.updateInfo=function(){var e=this,t=ao.ins().guiShuArr;if(e._guiShu.visible=!1,e.list_other.dataSource=[],0<t.length){for(var i,s,n=[],o=0;o<t.length;o++)1==(s=t[o]).isGuiShu?i=s:n.push(s);i&&(e._guiShu.visible=!0,e._guiShu.dataSource=i),0<n.length&&(e.list_other.dataSource=n)}},i.requestView=function(){var e=new wt;e.missionID=ao.ins().currentSelectMissionID,Fl.sendToService(e)},i.onBtnClicked=function(e){On.ins.isOpen("CrossNewBossFightView")&&On.ins.close("CrossNewBossFightView")},t.NAME="CrossNewBossFightView",t}(),wd=function(e){function t(){t.__super.call(this)}return u(t,"modules.corssbattle.views.newworldboss.CrossNewBossKillRecordItem",e),n(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){Y.superSet(nl,this,"dataSource",e),e&&(this.txt_name.changeText(e.name),this.txt_time.changeText(V.getSTRHMS(1e3*e.time)),this.txt_fight.changeText(e.fight))}),t}(nl),yd=function(e){function t(){t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossKillRecordView",tr);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.list_record.itemRender=wd,this.list_record.selectEnable=!1,this.list_record.dataSource=[new Object,new Object,new Object,new Object,new Object]},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.list_record.dataSource=ao.ins().killArr},t.NAME="CrossNewBossKillRecordView",t}(),xd=function(e){function t(){this._data=null,this._time=0,this._missionID=0,t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossSceneItem",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),Y.timer.loop(1e3,t,t.timeTick),t.btn_challenge.on("click",t,t.onBtnChallengeClicked)},i.timeTick=function(){var e=this;e._data?(e._time--,0<e._time?(e.btn_challenge.visible=!1,e.txt_time.color="#FF2E24",e.txt_time.changeText(V.simpleFormat(e._time/1e3))):(e.btn_challenge.visible=!0,e.txt_time.changeText("已刷新"),e.txt_time.color="#23B11F")):Y.timer.clearAll(e)},i.onBtnChallengeClicked=function(e){for(var t=0;t<Ys.count;t++)if(Ys.MODEL.nextMissionId(t)==this._missionID){var i=Ys.MODEL.location(t),s=i[0],n=i[1],o=new is(s,n),a=Bc.findCharsBySize(o,5);if(0<a.length){var r=ac.mainChar,l=a[0];if(ac.Ins().selectChar=l,Wc.getTileDisByPos(l.tileX,l.tileY,r.tileX,r.tileY)<=0)ac.Ins().onMoveEndHander();else{h.getCharNearPt(l);se.Ins().mainCharMove(l.point,!1,ms.create(ac.Ins(),ac.Ins().onMoveEndHander),!1)}}On.ins.close("CrossNewBossSceneView");break}},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clearAll(t),t.btn_challenge.off("click",t,t.onBtnChallengeClicked)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(er,t,"dataSource",e),e){t._data=e;var i=uo.getIndex(t._data.missionID);t._missionID=t._data.missionID;var s=Xl.getIndex(uo.MODEL.bossId(i)),n=Xl.MODEL.level(s),o=Xl.MODEL.muId(s);i=Cs.getIndex(o);var a=Cs.MODEL.headId(i),r=Xl.MODEL.name(s);t.txt_name.changeText(r+"["+n+"]"),t.img_head.skin=a&&"0"!=a?Or.getBossPath(a):"",t._time=t._data.rebrithTime,t.timeTick()}}),t}(er),Id=function(e){function t(){this._myScroe=0,this._ids=null,this._showIds=null,t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewBossSceneView",$l);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onBtnCloseClicked),t._myScroe=ao.ins().score,t._ids=ha.ins.getBossIds(57);var i,s,n=0,o=0,a=0,r=0,l=0;t._showIds=[];for(var c=0;c<t._ids.length;c++){n=t._ids[c],o=uo.getIndex(n),l=uo.MODEL.zsLevelLimit(o),uo.MODEL.bossId(o),r=uo.MODEL.levelLimit(o),i=uo.MODEL.extraCondition(o);var d=ql.Ins().mapBossDate[n];if(d&&Gi.ins.lv>=r&&Gi.ins.zsLv>=l)if((s=new Object).missionID=n,s.monsterID=d.missionId,s.rebrithTime=d.rebrithTime,s.bossHp=d.bossHp,i){for(var u=0;u<JSON.parse(i).length;u++){var h=JSON.parse(i)[u];"godEquipScore"==h.type&&(a=parseInt(h.value))}a<t._myScroe&&t._showIds.push(s)}else t._showIds.push(s)}t.list_boss.dataSource=t._showIds.sort(t.sortArr)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onBtnCloseClicked)},i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.list_boss.itemRender=xd,this.list_boss.selectEnable=!1,this.list_boss.vScrollBarSkin=""},i.onBtnCloseClicked=function(e){On.ins.close("CrossNewBossSceneView")},i.sortArr=function(e,t){var i=e.rebrithTime,s=t.rebrithTime;return i!=s?i-s:e.missionID-t.missionID},t.NAME="CrossNewBossSceneView",t}(),Sd=function(e){function t(){this.lastTime=0,this.monsterId=0,t.__super.call(this)}u(t,"modules.corssbattle.views.newworldboss.CrossNewWorldBossItem",e);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clear(this,this.showTime)},i.showTime=function(){var e=this;e.lastTime<=0?(Y.timer.clear(e,e.showTime),e.txt_bossState.innerHTML=""):(e.lastTime--,e.txt_bossState.innerHTML=nc.createColor(V.getHMSTimeString(e.lastTime),"#e41b00"))},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(gn,t,"dataSource",e),e){var i=e.id,s=uo.getIndex(i),n=s;t.monsterId=uo.MODEL.bossId(s),s=Xl.getIndex(t.monsterId);var o=Xl.MODEL.level(s),a=(Xl.MODEL.muId(s),Xl.MODEL.name(s)),r=e.time-J.curServerTime;t.lastTime=Math.floor(r/1e3),t.txt_bossName.changeText(a);uo.MODEL.levelLimit(n);var l,c=uo.MODEL.zsLevelLimit(n),d=uo.MODEL.extraCondition(n),u=0,h=ao.ins().score;if(d)for(var _=0;_<JSON.parse(d).length;_++){var p=JSON.parse(d)[_];"godEquipScore"==p.type&&(u=parseInt(p.value))}l=9999<u?Math.floor(u/1e4)+"万":u+"",t.txt_bossLv.changeText(o+"级"),Y.timer.clearAll(t),h<u&&0!=u?t.txt_bossState.innerHTML=nc.createColor(ed.n[1498]+l,"#e41b00"):Gi.ins.zsLv<c?t.txt_bossState.innerHTML=nc.createColor(c+"转开启","#e41b00"):0<r?(t.showTime(),Y.timer.loop(1e3,t,t.showTime,null,!0)):t.txt_bossState.innerHTML=nc.createColor("可击杀","#23b11f")}}),n(0,i,"select",null,function(e){this.box_select.visible=e,this.txt_bossName.color=e?"#fff9b4":"#91856d"}),t}(gn),kd=function(t){function e(){this.vsc=null,e.__super.call(this)}u(e,"modules.corssbattle.views.newworldboss.CrossNewWorldBossPanel",t);var i=e.prototype;return i.initialize=function(){var e=this;e.width=720,e.top=e.bottom=e.left=e.right=0,e.vsc=new o(e),e.vsc.registAll([{cls:Cd,id:"0",isHideBg:!0}]),e.vsc.invalid(),e.title=Or.getAtlasSubPath("crossbattle/mjrq_text_mjzl.png")},i.updateByVSC=function(e){this.vsc.selectedView.updateByVSC&&this.vsc.selectedView.updateByVSC(e)},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,t.prototype.destroy.call(this,e)},e.NAME="CROSSNEWWORLDBOSSPANEL",e}(jr),Cd=function(e){function t(){var e=this;e._array=null,e._gridsList=null,e._avatar=null,e._currentMissionID=0,e._time=0,e.curObj=null,t.__super.call(e)}u(t,"modules.corssbattle.views.newworldboss.CrossNewWorldBossView",fa);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_checkFight.on("click",t,t.onCheckFightTxtClicked),t.txt_detail.on("click",t,t.onCheckBossStatueClicked),t.txt_refresh.on("click",t,t.onRefreshTxtClicked),t.cb_info.on("click",t,t.onInfoClicked),t.btn_enter.on("click",t,t.onBtnEnterClicked);var i=new Ua;Fl.sendToService(i),t.txt_jipin.on("click",t,t.toJiPinView)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.txt_checkFight.off("click",t,t.onCheckFightTxtClicked),t.txt_detail.off("click",t,t.onCheckBossStatueClicked),t.txt_refresh.off("click",t,t.onRefreshTxtClicked),t.cb_info.off("click",t,t.onInfoClicked),t.btn_enter.off("click",t,t.onBtnEnterClicked),On.ins.isOpen("CrossNewBossFightView")&&On.ins.close("CrossNewBossFightView"),t.txt_jipin.off("click",t,t.toJiPinView)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.newworldboss.NewWorldBoss_Back_Info_30857_toc){for(var i,s=e.bossStatueArr,n=ao.ins().score,o=0,a=0,r=0,l=0,c=0;c<t._array.length;c++){var d=t._array[c];if(l=uo.getIndex(d.id),a=uo.MODEL.levelLimit(l),r=uo.MODEL.zsLevelLimit(l),i=uo.MODEL.extraCondition(l))for(var u=0;u<JSON.parse(i).length;u++){var h=JSON.parse(i)[u];"godEquipScore"==h.type&&(o=parseInt(h.value))}o<=n&&0!=o&&Gi.ins.zsLv>=r&&Gi.ins.lv>=a&&0==s[d.id].time?d.statue=1:d.statue=0,d.time=s[d.id].time}!t.list_boss.visible&&(t.list_boss.visible=!0),t._array=t._array.sort(t.sortArray),t.list_boss.array=t._array,t.setStartIndex(t._array);var _="#23b11f",p="#ff2e24",f=ao.ins().leftGuiShuTime;t.txt_myTime.innerHTML=nc.createColor(f.toString(),0<f?_:p)+"/"+parseInt(Ta.MODEL.value(Ta.getIndex(298))),f=ao.ins().leftAssitTime,t.txt_assistTime.innerHTML=nc.createColor(f.toString(),0<f?_:p)+"/"+parseInt(Ta.MODEL.value(Ta.getIndex(299))),f=ao.ins().leftCollectTime,t.txt_collectTime.innerHTML=nc.createColor(f.toString(),0<f?_:p)+"/"+parseInt(Ta.MODEL.value(Ta.getIndex(300)));var g=ao.ins().score.toString();t.mc_fight.value=g,t.box_fight.x=267-19*g.length}else e instanceof protos.newworldboss.NewWorldBoss_Back_Kill_30861_toc&&t.box_kill.visible?t.updateKillRecord(e):e instanceof protos.newworldboss.NewWorldBoss_Back_GuiShu_30859_toc&&t.box_guishu&&t.updateFightView(e)},i.onRefreshTxtClicked=function(e){On.ins.open("CrossNewBossAttentionView",{type:57})},i.onCheckFightTxtClicked=function(e){On.ins.open("CrossNewBossFightView")},i.onCheckBossStatueClicked=function(e){On.ins.open("CrossNewBossKillRecordView")},i.onInfoClicked=function(e){if(0<po.count){var t=po.getIndex(23),i=po.MODEL.description(t);On.ins.open("AE_EXPLAIN_VIEW",{desc:i})}},i.onBtnEnterClicked=function(e){var t,i=uo.getIndex(this._currentMissionID),s=i,n=uo.MODEL.zsLevelLimit(s),o=uo.MODEL.levelLimit(s),a=uo.MODEL.extraCondition(s),r=0,l=ao.ins().score;t=uo.MODEL.bossId(i),i=Xl.getIndex(t);var c=Xl.MODEL.name(i);if(ri.ins.hasEmptyNum(20)){if(a)for(var d=0;d<JSON.parse(a).length;d++){var u=JSON.parse(a)[d];"godEquipScore"==u.type&&(r=parseInt(u.value))}var h;h=9999<r?Math.floor(r/1e4)+"万":r+"",l<r&&0!=r?Vl.ins.showMsg("达"+h+ed.n[1499]+c,1):Gi.ins.zsLv<n?Vl.ins.showMsg(n+ed.n[1500],1):o>Gi.ins.lv?Vl.ins.showMsg(o+ed.n[1501],1):on.reqEntry(this._currentMissionID,0,0,0,0,1)}else ja.ins.showBagRecycle()},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e._gridsList=new ga(4),e._gridsList.pos(127,85),e._gridsList.size(480,180),e._gridsList._gsimpleName=!0,e._gridsList._spaceX=26,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.box_down.addChild(e._gridsList),e.list_boss.itemRender=Sd,e.list_boss.selectEnable=!0,e.list_boss.vScrollBarSkin="",e.list_boss.height=520,e.list_boss.repeatY=5,e.list_boss.renderHandler=ms.create(e,e.onListRender,null,!1),e.list_boss.selectHandler=ms.create(e,e.onChange,null,!1),e.list_kill.itemRender=Td,e.list_kill.selectEnable=!1,e._array=[];for(var t=ha.ins.getBossIds(57),i=0;i<t.length;i++){var s=t[i],n=uo.getIndex(s),o=uo.MODEL.isCard(n);e._array.push({id:s,isCard:o,cate:57,time:0})}},i.onListRender=function(e,t){t==this.list_boss.selectedIndex&&this._array[t]?e.select=!0:e.select=!1},i.onChange=function(e){var t=this;if(t.curObj=t._array[e],t.curObj){var i=uo.getIndex(t.curObj.id),s=i,n=uo.MODEL.bossId(i);i=Xl.getIndex(n);var o=uo.MODEL.key(s);t._currentMissionID=o,t._time=t.curObj.time;var a=uo.MODEL.bossShowAward(s);switch(t._gridsList.setGoodsItems(a,3),t._gridsList.items.length){case 3:t._gridsList.x=127;break;case 4:t._gridsList.x=62}t.btn_enter.gray=0==t.curObj.status,ao.ins().currentSelectMissionID=o,t.setAvatar(i),t.setBossLevel(i),t.updateBossStatue(i)}},i.setAvatar=function(e){var t=this,i=Xl.MODEL.muId(e);e=Cs.getIndex(i);var s=Cs.MODEL.avatarId(e);if(!t._avatar){t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(480,600);var n=t.getChildIndex(t.box_up);t.addChildAt(t._avatar,n)}t._avatar.mid=s,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",s,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1.2,1.2)},i.setBossLevel=function(e){var t=this,i=Xl.MODEL.name(e),s=Xl.MODEL.level(e);t.txt_bossName.text=i+"︵",t.txt_blvl.innerHTML=s.toString(),t.txt_te.text="级︶",t.txt_blvl.y=t.txt_bossName.y+t.txt_bossName.textHeight,t.txt_te.y=t.txt_blvl.y+t.txt_blvl.contextWidth+5},i.updateBossStatue=function(e){var t=this;if(t.curObj=t._array[t.list_boss.selectedIndex],t.curObj)if(t.box_guishu.visible=!1,t.box_kill.visible=!1,0==t.curObj.time){t.box_guishu.visible=!0;var i=new wt;i.missionID=t._currentMissionID,Fl.sendToService(i),t.txt_guishuName.changeText("无"),t.txt_fightNum.changeText("0")}else{t.box_kill.visible=!0;var s=new mn;s.missionID=t._currentMissionID,Fl.sendToService(s)}},i.updateKillRecord=function(e){3<e.killerArr.l?this.list_kill.dataSource=e.killerArr:this.list_kill.dataSource=e.killerArr.slice(0,3)},i.updateFightView=function(e){if(this.txt_guishuName.changeText("无"),0<e.guiShuArr.length){var t;for(var i in e.guiShuArr)if(1==(t=e.guiShuArr[i]).isGuiShu){this.txt_guishuName.changeText(t.name);break}this.txt_fightNum.changeText(e.guiShuArr.length+"")}else this.txt_fightNum.changeText("0")},i.destroy=function(e){var t=this;void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(t,e),t._avatar&&(t._avatar.dispose(),t._avatar.destroy(),t._avatar=null)},i.sortArray=function(e,t){var i=e.time,s=t.time;return i!=s?i-s:e.isCard!=t.isCard?t.isCard-e.isCard:e.id-t.id},i.setStartIndex=function(e){for(var t=-1,i=-1,s=e.length-1;0<s;s--)if(1==e[s].statue&&-1==i){i=s;break}t<0&&(t=i<0?0:i),4<(this.list_boss.selectedIndex=t)?this.list_boss.scrollTo(t-4):this.list_boss.scrollTo(0),this.onChange(t)},i.toJiPinView=function(){On.ins.open("BOSS_MAINVIEW",[5],0)},t}(),Td=function(e){function t(){t.__super.call(this)}return u(t,"modules.corssbattle.views.newworldboss.NewBossKillSmallRecordItem",e),n(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){Y.superSet(ys,this,"dataSource",e),null!=e&&(this.txt_name.changeText(e.name),this.txt_time.changeText(V.getSTRHMS(1e3*e.time)))}),t}(ys),Ed=(function(e){function t(){t.__super.call(this),this.addSubscribe(Vd,Pd,Rd,Nd,Md),this.subPackages=["21203","21205","21207","21214","10119","10702","21702","21707","21709","21711","21712","21713","21714","22002","22007","10909","22357","10605","10204","10201","21236","24046","24047","24048","22016","25003","24001","30712","30681","30702","30704","30705","30708","30710","30684","30714","30716","30686","30687","24033","25006","24011","21230","21276","22806","10119"]}u(t,"modules.copy.CopyModule",Tc),t.MODULE_NAME="COPYMODULE"}(),function(){function e(){this.isFirstRed=!0,this.toc21276=null,this.again=!1,this.linkTo=!1}return u(e,"modules.copy.others.HundunData"),n(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}()),Ld=function(){function e(){}return u(e,"modules.copy.others.HundunReq"),e.reqHundunInfo=function(){var e=new Fn;Fl.sendToService(e)},e}(),Ad=function(){function e(){}return u(e,"modules.copy.others.MentalReq"),e.reqEnter=function(e){void 0===e&&(e=2980);var t=new Yr;t.copyId=e,Fl.sendToService(t)},e.reqSummon=function(){Fl.sendToService(new ea)},e.reqSummonBossTime=function(){Fl.sendToService(new ia)},e.reqChallengeInfo=function(){on.reqCopy(31)},e.reqUseBuff=function(e){void 0===e&&(e=1);var t=new $o;t.buff_index=e,Fl.sendToService(t)},e.reqMopping=function(e,t){void 0===e&&(e=0),void 0===t&&(t=2980);var i=new Po;i.copyId=t,i.summonTime=e,Fl.sendToService(i)},e}(),Bd=function(){function t(){var e=this;e.monsterPoint=null,e.currentLayMaxNum=0,e.killNum=0,e.toc22016=null,e.openLv=0,e.isOut=!1,e.isShowRedPoint=!0,e.vipExpShow=null,e.isReturnShaoZhu=!1,e.hash_layer=new Kt,t._ins&&qe.window.alert("NewPigData not new"),e.openLv=Xa.MODEL.limitLv(Xa.getIndex(Je.S_PIG_SCENE[0]))}u(t,"modules.copy.others.NewPigData");var e=t.prototype;return e.initHashLayer=function(){if(20<=this.hash_layer.length&&this.hash_layer.has(20)&&5<=this.hash_layer.take(20).length)return;var e=0,t=1;for(t=1;t<=20;t++){var i=[];for(e=0;e<vi.count;e++){vi.MODEL.tier(e)==t&&i.push(vi.MODEL.key(e))}this.hash_layer.put(t,i,!0)}},e.isGetReturnAwards=function(){if(!this.toc22016)return null;var e=Gi.ins.VIPLevel,t=this.toc22016.hashTotal,i=[!1,!1];for(var s in t.proto)for(var n=t.take(s),o=0;o<n.length;o++){var a=vi.getIndex(n[o].awardsIDs),r=vi.MODEL.level(a);if(0!=n[o].awardsBei)if(1==r){if(i=[!0,!1],1<=e&&(i=[!0,!0]),i[0]&&i[1])break}else if(2==r){if(i=[!0,!1],2<=e&&(i=[!0,!0]),i[0]&&i[1])break}else if(3==r){if(i=[!0,!1],3<=e&&(i=[!0,!0]),i[0]&&i[1])break}else if(4==r){if(i=[!0,!1],4<=e&&(i=[!0,!0]),i[0]&&i[1])break}else if(5==r&&(i=[!0,!1],6<=e&&(i=[!0,!0]),i[0]&&i[1]))break}return i},e.getPingJiForKillNum=function(){var e=this,t={},i=0,s="",n="";if(e.toc22016){var o,a,r=0,l=e.hash_layer.take(e.toc22016.layer),c=0,d=0;if(o=vi.MODEL.conditionDef(l[0]-1),a=JSON.parse(o),e.toc22016.maxNum<parseInt(a[0].value)){o=vi.MODEL.rewardDef(l[0]-1);var u=JSON.parse(o);for(r=0;r<u.length;r++)if(4==u[r].value.split(":")[0]){i=parseInt(u[r].value.split(":")[1]);break}s="C",t.pj=s,t.layerd=0,t.willKill=a[0].value,t.nextPj="B",t.totalExp=t.nextExp=i,t.getedExp=0}else{for(var h=0,_=0,p=l.length-1;0<=p;p--)if(o=vi.MODEL.conditionDef(l[p]-1),a=JSON.parse(o),e.toc22016.maxNum<parseInt(a[0].value)){for(_=parseInt(a[0].value),o=vi.MODEL.rewardDef(l[p]-1),a=JSON.parse(o),r=0;r<a.length;r++)if(4==a[r].value.split(":")[0]){i=parseInt(a[r].value.split(":")[1]);break}}else parseInt(a[0].value)<=e.toc22016.maxNum&&h++;4==h?(s="SS",n="SSS"):3==h?(s="S",n="SS"):2==h?(s="A",n="S"):1==h&&(s="B",n="A"),t.pj=s,t.layerd=h,t.willKill=_,t.nextPj=n,t.nextExp=i;var f=0;for(p=0;p<l.length;p++)if(-1==e.toc22016.currentLayerArr.indexOf(l[p])){if(o=vi.MODEL.conditionDef(l[p]-1),a=JSON.parse(o),c=parseInt(a[0].value),e.toc22016.maxNum>=c)for(o=vi.MODEL.rewardDef(l[p]-1),a=JSON.parse(o),r=0;r<a.length;r++)if(4==a[r].value.split(":")[0]){d+=parseInt(a[r].value.split(":")[1]);break}}else if(-1!=e.toc22016.currentLayerArr.indexOf(l[p]))for(o=vi.MODEL.rewardDef(l[p]-1),a=JSON.parse(o),r=0;r<a.length;r++)if(4==a[r].value.split(":")[0]){f+=parseInt(a[r].value.split(":")[1]);break}t.getedExp=f,t.totalExp=d+i}}return t},e.getTotalExpByVipLv=function(e){var t=0,i=0,s=this.hash_layer.take(this.toc22016.layer),n="",o=0,a=[];for(t=0;t<s.length;t++){var r=new Object;n=vi.MODEL.doubleConditionDef(s[t]-1);var l=JSON.parse(n);for(r.vip=parseInt(l[0].value),n=vi.MODEL.rewardDef(s[t]-1),l=JSON.parse(n),i=0;i<l.length;i++)if(4==l[i].value.split(":")[0]){o=parseInt(l[i].value.split(":")[1]),r.exp=o;break}a.push(r)}var c=Gi.ins.VIPLevel,d=0;for(t=0;t<a.length;t++)a[t].vip>c&&a[t].vip<=e&&(d+=a[t].exp);return d},e.getRecoFight=function(){var e=this.hash_layer.take(this.toc22016.layer),t=vi.MODEL.copyID(e[0]-1);return uo.MODEL.bestFightingScore(uo.getIndex(t))},e.isAlertView=function(e){var t=!1;if(Gi.ins.lv<=80){var i=this.hash_layer.take(this.toc22016.layer),s=vi.MODEL.copyID(i[0]-1),n=uo.MODEL.bestFightingScore(uo.getIndex(s));if(Gi.ins.force<n){var o="",a=0,r=[],l=0,c=0,d=0;for(a=0;a<i.length;a++)o=vi.MODEL.conditionDef(i[a]-1),r=JSON.parse(o),(d=parseInt(r[0].value))<=this.toc22016.maxNum&&l++,d<=e&&c++;c<=l&&(t=!0)}}return t},n(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins.initHashLayer(),t._ins}),t._ins=null,t.FIRE_PIG_SCENE="5001",t.FA_SKILL_ID=10196,t.ALTER_VIEW_LEVEL=80,t.alertedFv=!1,t}(),Dd=function(){function t(){var e=this;e.killMonsterNumber=0,e.PigCopyID=0,e.currCopyExp=0,e.isInit=0,e.isOpen3=!1,e.isFirst=0,e.restNum=0,e.enterResult=0,e.cid=0,e.skillActive=0,e.skillCd=0,e.curExp=NaN,e.openLv=0,e.restTime=NaN,e.isEnd=!1,e.killNum=0,e.totalNum=0,e.baseExp=NaN,e.expbyRoll=NaN,e.expbySkill=NaN,e.upPer=0,e._uiShow=!1,t._ins&&qe.window.alert("PigData not new"),e.openLv=Xa.MODEL.limitLv(Xa.getIndex(Je.S_PIG_SCENE[0]))}u(t,"modules.copy.others.PigData");var e=t.prototype;return e.getCurCid=function(){var e=Je.S_PIG_SCENE.indexOf(this.cid);e=-1==e?0:e;for(var t=0;e<Je.S_PIG_SCENE.length;e++)if(t=Xa.getIndex(Je.S_PIG_SCENE[e]),Xa.MODEL.limitLv(t)>Gi.ins.lv||Xa.MODEL.limitZsLv(t)>Gi.ins.zsLv)return 0==e?-1:Je.S_PIG_SCENE[e-1];return Je.S_PIG_SCENE[Je.S_PIG_SCENE.length-1]},e.changeUI=function(e){!!this._uiShow!=!!e&&(e?(On.ins.open("PIG_MAIN"),Fl.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],Xn.SZFB)):(On.ins.isOpen("PIG_MAIN")&&On.ins.close("PIG_MAIN"),On.ins.isOpen("PIG_SKILL")&&On.ins.close("PIG_SKILL"),On.ins.isOpen("PIG_RESULT_NEW")&&On.ins.close("PIG_RESULT_NEW"),Fl.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],Xn.NORMAL)),this._uiShow=e)},e.gameEnd=function(){},e.gameEnd_0=function(){this.reset(),modules.copy.others.PigData.ins.changeUI(!1),null!=Ss.Ins().prveCid&&ac.Ins().changeScene(Ss.Ins().prveCid,!0,ms.create(this,this.exitPig))},e.getSkillExp=function(e){var t=s.getIndex(e),i=s.MODEL.doomsdayJudgmentAddExp(t);return i=-1==i.indexOf(".")?i.slice(0,-4):i.slice(0,-6),i=1==modules.copy.others.PigData.ins.isFirst?(parseInt(i)*Math.ceil(Xc.MODEL.firstMissionTime(0)/Xc.MODEL.firstMissionSkillTime(0))).toString():(parseInt(i)*Math.ceil(Xc.MODEL.totlaMissionTime(0)/Xc.MODEL.skillTime(0))).toString()},e.reset=function(){var e=this;e.curExp=0,e.cid=0,e.isEnd=!1,e.killNum=0,e.killMonsterNumber=0,null!=J.dtoEnterScene&&(J.dtoEnterScene.cid=0,J.dtoEnterScene=null)},e.getTimesForVIPLv=function(){for(var e=[],t=0,i=Gi.ins.VIPLevel,s=0;s<Zt.count;s++){var n=Zt.MODEL.vipRangeStr(s).split(",");if(i<n[0]){t=Zt.MODEL.purchaseLimit(s),e.push(t),e.push(n[0]);break}}return e},e.isInPigCopy=function(){return 5020==this.cid||-1!=Je.S_PIG_SCENE.indexOf(this.cid)},e.exitPig=function(){Bs.start()},n(0,e,"skillActiveGold",function(){return Xc.MODEL.purchaseDJSkillCost(0)}),n(1,t,"ins",function(){return null==t._ins&&(t._ins=new t),t._ins}),t.COST_YB_NUM=500,t.MAX_VIP=6,t._ins=null,t}(),Od=function(){function e(){}return u(e,"modules.copy.others.PigReq"),e.reqInfo=function(){var e=new Nt;Fl.sendToService(e),Dd.ins.isInit=0},e.reqGetAwards=function(e,t){var i=new Gt;i.awardsIds=e,i.beishu=t,Fl.sendToService(i)},e.reqGetZHAwards=function(e){var t=new Ht;t.lv=e,Fl.sendToService(t)},e.reqGetTSAwards=function(){var e=new Ut;Fl.sendToService(e)},e}(),Vd=function(e){function s(){var e=this;e._copyMainView=null,e._copyTowerRankView=null,e._copyTowerDailyRewardView=null,e._copyTwoerLotteryView=null,e._copyTowerSuccessView=null,e._copyLevelUpView=null,s.__super.call(e);Or.getLayoutsPath("copy");On.ins.registPanel("COPYMAINVIEW",Gd,"_copyMainView",e,{wait:On.wait(On.waitAtlas("copy"),On.waitConfig(Vs.copy_A.concat(["ConfigProtectStal"]),Vs.copy_C.concat(["CMentalMissonModel"]))),layer:"layout",mask:!1}),On.ins.registPanel("CopyTowerRankView",Cu,"_copyTowerRankView",e,{mask:!0}),On.ins.registPanel("CopyTowerDailyRewardView",bu,"_copyTowerDailyRewardView",e,{mask:!0}),On.ins.registPanel("CopyTowerLotteryView",xu,"_copyTwoerLotteryView",e,{mask:!0});var t=[Or.getLayoutsPath("fightresult")];On.ins.registPanel("CopyTowerFightSuccessView",wu,"_copyTowerSuccessView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["RoleLevelResource"],["RoleLevelResource"])),mask:!0,clickClose:!1});var i=[Or.getLayoutsPath("tower")];On.ins.registPanel("CopyTowerLevelUpView",yu,"_copyLevelUpView",e,{wait:On.wait(On.waitRes(i)),mask:!0,clickClose:!0})}u(s,"modules.copy.proxys.CopyProxy",F);var t=s.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this,i=0;switch(e.actionOrder){case"OPEN_MATERIAL":var s=e.proto;null!=s&&0<s.selectedIndex?On.ins.open("COPYMAINVIEW",{selectedIndex:parseInt(s.selectedIndex)}):On.ins.open("COPYMAINVIEW",{index:0});break;case"__ZHAOBAO_END__":switch(i=pc.ins.currCopyId,e.proto){case 8:on.reqDisplayAward(i);break;case 1:0<$a.instance.currentLevel?Fl.sendToModule("OPEN_TOWER_SUCCESS",["modules.copy.CopyModule"],{award:e.proto.award}):Fl.sendToModule("OPEN_FAIL",["modules.fight.FightModule"],{award:null,callback:ms.create(this,this.onFightResultClose)})}break;case"__PICKUP_OVER__":0<(i=pc.ins.currCopyId)&&(pc.ins.currCopyId=0,ri.ins.mulFly=!0,on.reqAward(i));var n=pc.ins.getCopyAward(i);Fl.sendToModule("OPEN_SUCC",["modules.fight.FightModule"],{award:n,callback:ms.create(this,this.onExitCopy)});break;case"21203":break;case"21214":if(0<pc.ins.currCopyId){var o=e.proto;Fl.sendToModule("__SHOW_PICKUP_ITEMS__",["modules.scene.SceneModule"],{cid:o.cid,items:o.items})}break;case"21205":i=e.proto.copyId,pc.ins.setCopyRaids(i),0<pc.ins.isRaiding&&pc.ins.isRaiding--,pc.ins.isRaiding<=0&&this._copyMainView&&this._copyMainView.parent&&(Qr.reqRedPt([71]),this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView());break;case"22357":var a=e.proto;te.ins.datas22357=a,this._copyMainView&&this._copyMainView.parent&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView();break;case"10119":Aa.reqTqMonthCard();var r=Qr.ins.getStateByCareList([277]);this._copyMainView&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView(r);break;case"21207":pc.ins.materialHash=e.proto.hash,0<pc.ins.isRaiding&&pc.ins.isRaiding--,pc.ins.isRaiding<=0&&this._copyMainView&&this._copyMainView.parent&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView();break;case"OPEN_MAIN_VIEW":Bd.ins.isReturnShaoZhu=!1,On.ins.isOpen("COPYMAINVIEW")||On.ins.open("COPYMAINVIEW",e.proto);break;case"21702":if($a.instance.update21702(e.proto),1==$a.instance.isChallengeNext){$a.instance.isChallengeNext=!1;var l=$a.instance.currentLevel;return void(0<At.count&&on.reqEntry(At.MODEL.missionId(l)))}this._copyMainView&&this._copyMainView.parent&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView(),this._copyTwoerLotteryView&&this._copyTwoerLotteryView.parent&&this._copyTwoerLotteryView.update(e.proto),$a.instance.needToUpdateSuccessPanel&&this._copyTowerSuccessView&&this._copyTowerSuccessView.parent&&this._copyTowerSuccessView.updateView();break;case"10702":var c=e.proto;8==c.type&&($a.instance.rankData=c,this._copyMainView&&this._copyMainView.parent&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView());break;case"21707":case"21709":this._copyTwoerLotteryView&&this._copyTwoerLotteryView.parent&&this._copyTwoerLotteryView.update(e.proto);break;case"OPEN_TOWER_SUCCESS":On.ins.isOpen("CopyTowerFightSuccessView")||($a.instance.currentSuccessData=e.proto,On.ins.open("CopyTowerFightSuccessView",e.proto));break;case"21711":var d=e.proto;$a.instance.currentLevel=d.pass,Fl.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],Xn.COPY_0),null!=J.dtoEnterScene&&1==J.dtoEnterScene.type||Y.timer.once(3e3,this,this.onStart);var u=At.getIndex(d.pass),h=At.MODEL.monsterId(u);xn.ins.currentType=2;var _=new oc;_.type=1,_.cid=4001,_.dtoZhanbao=d.zhanbao,_.monsterId=h,_.isInit=!1,Fl.sendToModule("ENTER_INTER",["modules.scene.SceneModule"],_);break;case"21712":break;case"COPY_TOWER_EXIT":var p=e.proto.status;this.onFightResultClose(p);break;case"21713":On.ins.isOpen("CopyTowerDailyRewardView")||On.ins.open("CopyTowerDailyRewardView",e.proto);break;case"21714":$a.instance.leftLotteryTime=e.proto.lettoryTime;break;case"21236":ve.ins.toc21236=e.proto,this._copyMainView&&this._copyMainView.parent&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView();break;case"OPEN_ENTER":if(Bd.alertedFv)return;Od.reqInfo(),On.ins.isOpen("COPYMAINVIEW")||On.ins.open("COPYMAINVIEW",{selectedIndex:1});break;case"22016":Bd.ins.toc22016=e.proto,this._copyMainView&&this._copyMainView.parent&&(this._copyMainView.refreshView(),Y.timer.once(200,this,function(){t._copyMainView&&t._copyMainView.vsc&&t._copyMainView.vsc.updateSelectedView()}));break;case"21276":var f=e.proto;this._copyMainView&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView(f);break;case"UPDATE_HUNDUN_VIEW":this._copyMainView&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView();break;case"22806":var g=Qr.ins.getStateByCareList([277]);this._copyMainView&&this._copyMainView.vsc&&this._copyMainView.vsc.updateSelectedView(g);break;case"OPEN_HUNDUN_VIEW":Y.timer.loop(2e3,this,this.openView)}},t.openView=function(){On.ins.open("COPYMAINVIEW",{selectedIndex:1}),Y.timer.clear(this,this.openView)},t.onFightResultClose=function(e){void 0===e&&(e=0);var t=new Ma;t.status=e,Fl.sendToService(t),this.exitTower(),zn.isFaildLink||On.ins.open("COPYMAINVIEW")},t.exitTower=function(){xn.ins.updateBossBlood(0),Fl.sendToModule("EXIT_INTER",["modules.scene.SceneModule"],{type:1})},t.onStart=function(){J.inCountDown=!1,xn.ins.setBossHeadVisible(!0),Fl.sendToModule("__ZHANBAO_START__",["modules.scene.SceneModule"],1)},t.closePanel=function(e,t){pc.ins.isRaiding=0},t.showPanel=function(e,t){var i=this;switch(e){case"COPYMAINVIEW":t&&t.selectedIndex&&i._copyMainView&&i._copyMainView.vsc&&(i._copyMainView.vsc.selectedIndex=t.selectedIndex);break;case 2:i._copyMainView&&i._copyMainView.vsc&&(i._copyMainView.vsc.selectedIndex=t.selectedIndex);break;case"CopyTowerDailyRewardView":i._copyTowerDailyRewardView.showPanel(t);break;case"CopyTowerFightSuccessView":break;case"CopyTowerLevelUpView":i._copyLevelUpView.updateView(t.exp)}},t.onEntryCopy=function(){Fl.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],Xn.COPY),Vo.callback=ms.create(this,this.onSure),On.ins.close("COPYMAINVIEW")},t.onExitCopy=function(){Bs.getInstance().exit(),On.ins.open("COPYMAINVIEW")},t.onSure=function(){this.onExitCopy()},s}(),Md=function(e){function t(){this._hundunMonsterEnterView=null,t.__super.call(this),On.ins.registPanel("HUNDUN_BOSS_VIEW",Hd,"_hundunMonsterEnterView",this,{mask:!1,layer:"layout",clearAll:!0})}u(t,"modules.copy.proxys.HundunProxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){e.actionOrder},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),Rd=function(e){function t(){var e=this;e._mentalScene=null,e._mentalSummonTip=null,e._mentalMoppingTip=null,e._effect=null,t.__super.call(e);On.ins.registPanel("MENTAL_SCENE",zd,"_mentalScene",e,{wait:On.wait(On.waitAtlas("mentalScene"),On.waitConfig(["ConfigProtectStal"],["CMentalMissonModel"])),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("MENTAL_SUMMON_TIP",Wd,"_mentalSummonTip",e,{clearAll:!1,mask:!0,layer:"panel"}),On.ins.registPanel("MENTAL_MOPPING_TIP",Fd,"_mentalMoppingTip",e,{clearAll:!1,mask:!0,layer:"panel"})}u(t,"modules.copy.proxys.MentalProxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.showPanel=function(e,t){switch(e){case"MENTAL_SCENE":Y.timer.frameLoop(1,this,this.loop)}},i.closePanel=function(e,t){var i=this;switch(e){case"MENTAL_SCENE":Y.timer.clear(i,i.loop),null!=i._effect&&(i._effect.removeSelf(),i._effect.dispose()),i._effect=null}},i.loop=function(){var e=ha.ins.curCopyId,t=uo.getIndex(e);31==uo.MODEL.cate(t)&&Ss.Ins().currCid==Je.S_MENTAL_COPY.toString()&&Ae.isSceneReady&&null==this._effect&&this.createEffect()},i.createEffect=function(){this._effect=ti.createEffect("jm1305",0,0),this._effect.pos(462,1065),ac.scene.sceneEffectLayer.addChild(this._effect)},i.subHandler=function(e){var t=this,i=e.proto;switch(e.actionOrder){case"10605":case"10204":case"10201":null!=t._mentalScene&&t._mentalScene.refreshActor();break;case"UpdateCurrHP":null!=t._mentalScene&&null!=i&&t._mentalScene.updateTargetHp(i.heroId,i.hp);break;case"24046":ve.ins.toc24046=e.proto,t._mentalScene&&t._mentalScene.parent&&t._mentalScene.updateScore();break;case"24047":ve.ins.toc24047=e.proto,t._mentalSummonTip&&t._mentalSummonTip.parent&&t._mentalSummonTip.updateView(),t._mentalScene&&t._mentalScene.parent&&t._mentalScene.updateRedDot();break;case"24048":t._mentalScene&&t._mentalScene.parent&&t._mentalScene.refreshTime()}},t}(),Pd=function(e){function i(){var e=this;e._mainTwoView=null,e._awardsView=null,e._enterView=null,e._awardShowView=null,e._success=null,e._expView=null,e._changeView=null,e._pigshowVipExp=null,i.__super.call(e);On.ins.registPanel("PIG_FIRE_ENTER",Jd,"_enterView",e,{wait:On.wait(On.waitConfig(["ShaoZhuRewardResource","SZSpecialRewardResource"],["ShaoZhuReward","ShaoZhuSpecialReward"]),On.waitAtlas(["pigTwo","pig"])),mask:!1,layer:"nav"}),On.ins.registPanel("PIG_FIRE_MAIN",Zd,"_mainTwoView",e,{wait:On.waitAtlas("pigTwo"),mask:!1,layer:"bottom"}),On.ins.registPanel("FIRE_PIG_CHANGE",Kd,"_changeView",e,{mask:!0}),On.ins.registPanel("PIG_FIRE_AWARD",qd,"_awardsView",e,{wait:On.waitAtlas("pigTwo"),mask:!0}),On.ins.registPanel("PIG_FIRE_SHOWAWARD",$d,"_awardShowView",e,{wait:On.waitAtlas("pigTwo"),mask:!0});var t=[Or.getLayoutsPath("fightresult"),Or.getLayoutsPath("pigTwo")];On.ins.registPanel("PIG_FIRE_RESULT",iu,"_success",e,{wait:On.waitRes(t),mask:!0,clickClose:!1}),On.ins.registPanel("FIRE_PIG_EXP_RESULT",eu,"_expView",e,{wait:On.waitConfig(["RoleLevelResource"],["RoleLevelResource"]),mask:!0,clickClose:!1}),On.ins.registPanel("FIRE_PIG_VIP_EXP",tu,"_pigshowVipExp",e,{mask:!0}),On.ins.registPanel("PigTwoFightNoEnTip",Xd,"",e,{mask:!0})}u(i,"modules.copy.proxys.PigProxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_FIRE_PIG_AWARDS":On.ins.open("PIG_FIRE_AWARD");break;case"OPEN_FIRE_PIG_SHOWAWARDS":On.ins.open("PIG_FIRE_SHOWAWARD",e.proto);break;case"OPEN_FIRE_PIG_RESULT":On.ins.open("PIG_FIRE_RESULT");break;case"22016":Bd.ins.toc22016=e.proto,t._awardsView&&t._awardsView.showInfo(),t._awardShowView&&null!=t._awardShowView.parent&&On.ins.close("PIG_FIRE_SHOWAWARD");break;case"25003":Bd.ins.killNum=e.proto.skillNum;break;case"OPEN_FIRE_PIG_EXP":On.ins.open("FIRE_PIG_EXP_RESULT",e.proto);break;case"MAIN_CHAR_USE_SKILL":t._mainTwoView&&t._mainTwoView.showSkill(e.proto);break;case"OPEN_FIRE_PIG_KILL_MONSTER":t._mainTwoView&&t._mainTwoView.showPower();break;case"OPEN_FIRE_PIG_STRONG":On.ins.open("FIRE_PIG_CHANGE");break;case"OPEN_FIRE_VIP_EXP":On.ins.open("FIRE_PIG_VIP_EXP")}},t.showPanel=function(e,t){var i=this;"PIG_RESULT_NEW"==e?Pc.ins.playSound("11"):"PIG_FIRE_SHOWAWARD"==e?i._awardShowView&&i._awardShowView.showInfo(t):"PIG_FIRE_AWARD"==e?i._awardsView&&i._awardsView.showInfo():"FIRE_PIG_EXP_RESULT"==e?i._expView&&i._expView.showExp(t):"FIRE_PIG_VIP_EXP"==e&&i._pigshowVipExp.showData()},t.closePanel=function(e,t){},i}(),Nd=function(e){function s(){var e=this;e._tcGongLueView=null,e._tcYaoQingView=null,e._tcYQListView=null,e._tcRoomView=null,e._tcAcceptView=null,e._tcOutView=null,e._sceneView=null,e._resultView=null,e.teamData=null,s.__super.call(e);var t=["TeamCopyTemplatel","TeamCopyGLTemplatel","TeamCopyOtherTemplatel"],i=["CTeamCopyModel","CTeamCopyGLModel","CTeamCopyOtherModel"];On.ins.registPanel("TEAM_COPY_GONGLUE",uu,"_tcGongLueView",e,{wait:On.waitAtlas("teamCopy"),mask:!0}),On.ins.registPanel("TEAM_COPY_YAOQING",mu,"_tcYaoQingView",e,{wait:On.waitAtlas("teamCopy"),mask:!0}),On.ins.registPanel("TEAM_COPY_YAOQINGLIST",fu,"_tcYQListView",e,{wait:On.waitAtlas("teamCopy"),mask:!0}),On.ins.registPanel("TEAM_COPY_ROOM",du,"_tcRoomView",e,{wait:On.wait(On.waitConfig(t,i),On.waitAtlas("teamCopy")),mask:!0,clickClose:!1}),On.ins.registPanel("TEAM_COPY_ACCEPT",hu,"_tcAcceptView",e,{wait:On.wait(On.waitConfig(t,i),On.waitAtlas("teamCopy")),mask:!1,layer:"nav"}),On.ins.registPanel("TEAM_COPY_SCENE",vu,"_sceneView",e,{wait:On.wait(On.waitConfig(t,i),On.waitAtlas("teamCopy")),mask:!1,layer:"bottom"}),On.ins.registPanel("TEAM_COPY_OUT",pu,"_tcOutView",e,{mask:!0}),On.ins.registPanel("TEAM_COPY_RESULT",gu,"_resultView",e,{wait:On.wait(On.waitAtlas("fightresult")),mask:!0}),e.teamData=Vr.ins}u(s,"modules.copy.proxys.TeamCopyProxy",F);var t=s.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_TEAM_COPY_GONGLUE":On.ins.open("TEAM_COPY_GONGLUE",e.proto);break;case"OPEN_TEAM_COPY_YAOQING":On.ins.open("TEAM_COPY_YAOQINGLIST",e.proto);break;case"OPEN_TEAM_COPY_SEND_YQ":On.ins.open("TEAM_COPY_YAOQING");break;case"OPEN_TEAM_COPY_CROOM":if(e.proto&&e.proto.hasOwnProperty("vo")){var i=e.proto.vo;t.teamData.reqCreateTeam(i)}break;case"CHAT_EXIT":t._tcRoomView&&t._tcRoomView.parent&&t._tcRoomView.showChat();break;case"OPEN_TEAM_COPY_EXIT":On.ins.open("TEAM_COPY_OUT",e.proto);break;case"ATTACK_MONSTER_LIST_SELECT":t._sceneView&&t._sceneView.parent&&t._sceneView.updateMonsterSelected(e.proto);break;case"OPEN_TEAM_RESULT":On.ins.open("TEAM_COPY_RESULT",e.proto);break;case"30702":var s=e.proto;t.teamData.setLeaderInfo(s),t._tcRoomView&&t._tcRoomView.parent?t._tcRoomView.setLeaderInfo(s):On.ins.open("TEAM_COPY_ROOM",s);break;case"30712":var n=e.proto;t.teamData.currentCopyID=n.currentCopyID,t.teamData.nextRefreshTime=J.curServerTime+1e3*n.nextTime,t.teamData.assistAward=n.assistAward;var o=On.ins._getPanel("COPYMAINVIEW");o&&3==o.vsc.selectedIndex&&o.vsc.selectedView.updateView();break;case"30684":Vl.ins.showMsg(ed.n[1502],1),On.ins.close("TEAM_COPY_ROOM"),t.teamData.clearTeamdata();break;case"30714":case"30716":t._tcYQListView&&t._tcYQListView.parent&&t._tcYQListView.showListInfo();break;case"30705":var a=e.proto;t.teamData.noShow||On.ins.open("TEAM_COPY_ACCEPT",a);break;case"30708":var r=e.proto;t.teamData.teamCopyID=r.copyID,t._tcRoomView&&t._tcRoomView.parent?t._tcRoomView.showMemberInfo(r):On.ins.open("TEAM_COPY_ROOM",r),On.ins.close("CHAT");break;case"30681":var l=e.proto;t._tcRoomView&&t._tcRoomView.parent&&t._tcRoomView.changeTeamInfo(l);break;case"30686":Vl.ins.showMsg(ed.n[1503],1),On.ins.close("TEAM_COPY_ROOM"),t.teamData.clearTeamdata();break;case"30687":Vl.ins.showMsg(ed.n[1504],1),On.ins.close("TEAM_COPY_ROOM"),t.teamData.clearTeamdata();break;case"24033":t._sceneView&&t._sceneView.parent&&t._sceneView.showSceneMonster(e.proto);break;case"25006":t._sceneView&&t._sceneView.parent&&t._sceneView.updateActorHP(e.proto);break;case"24011":if(t._sceneView&&t._sceneView.parent){var c=e.proto;t.teamData.currentTargetID!=c.targetObjId&&c.casterObjId==Gi.ins.objectId&&(t.teamData.currentTargetID=c.targetObjId,t._sceneView.updateAttack());var d=uo.getIndex(ha.ins.curCopyId),u=t.getChar(c.targetObjId);u&&u.isElites&&51==uo.MODEL.cate(d)&&0<u.currHp&&xn.ins.updateBossBlood(u.data.modelId,u.currHp,u.maxHP)}break;case"24001":if(t._sceneView&&t._sceneView.parent){var h=e.proto,_=t.getChar(h.objectId);_&&_.isElites&&(xn.ins.lockBossId=0,xn.ins.updateBossBlood(0,0,0))}break;case"21230":t._sceneView&&t._sceneView.parent&&Bs.startInstantFight();break;case"30710":var p=e.proto;Vl.ins.showMsg("队员["+p.name+ed.n[1505],1)}},t.showPanel=function(e,t){var i=this;"TEAM_COPY_GONGLUE"==e?i._tcGongLueView.showGongLueInfo(t.gonglueIDS):"TEAM_COPY_YAOQINGLIST"==e?i._tcYQListView.reqYaoQingInfo(t.type):"TEAM_COPY_YAOQING"==e||("TEAM_COPY_ROOM"==e?t.hasOwnProperty("vo")?i._tcRoomView.createTeamInfo(t.vo):t instanceof protos.copy.teamCopy.toc_30708?i._tcRoomView.showMemberInfo(t):t instanceof protos.copy.teamCopy.toc_30702&&i._tcRoomView.setLeaderInfo(t):"TEAM_COPY_ACCEPT"==e?i._tcAcceptView.updateLabel(t):"TEAM_COPY_RESULT"==e?i._resultView.showResult(t.award,t.callback):"TEAM_COPY_OUT"==e&&t.hasOwnProperty("tips")&&i._tcOutView.showText(t.tips)),Pc.ins.playSound("11")},t.closePanel=function(e,t){},t.getChar=function(e){if(ac.mainChar.objectId==e)return ac.mainChar;var t=Os.charQueue.take(e);return t||null},s}(),Gd=function(t){function i(){var e=this;e.vsc=null,e._towerOpenLevel=0,e._towerOpenDay=0,e._teamCopyOpenFL=0,e._teamCopyOpenDay=0,e.soundID=null,e.soundIns=null,i.__super.call(e),e.top=e.bottom=e.left=e.right=0}u(i,"modules.copy.views.CopyMainView",t);var e=i.prototype;return e.onAdd=function(e){t.prototype.onAdd.call(this,e),this.refreshView()},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.onRemove=function(e){t.prototype.onRemove.call(this,e),Qr.ins.removeListener("BTN_COPYTOWER"),Qr.ins.removeListener("BTN_COPYCP"),Qr.ins.removeListener("BTN_COPYDAILY"),Qr.ins.removeListener("BTN_TEAM_COPY"),$a.clearTowerUrl(),Di.isShaozhu()&&0<Dd.ins.PigCopyID&&Dd.ins.gameEnd()},e.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(this),this.size(720,1280),this.centerX=this.centerY=0,this._towerOpenLevel=parseInt(Ta.MODEL.value(Ta.getIndex(78))),this._towerOpenDay=parseInt(Ta.MODEL.value(Ta.getIndex(77))),this._teamCopyOpenFL=parseInt(Ta.MODEL.value(Ta.getIndex(251))),this._teamCopyOpenDay=parseInt(Ta.MODEL.value(Ta.getIndex(252))),this.navList=["ui/layouts/copy/btn_tab_material.png","ui/layouts/copy/btn_tab_daily.png","ui/layouts/copy/btn_tab_tower.png","ui/layouts/copy/yq_btn_zdfb.png"];this.vsc=new o(this),this.vsc.selectHandler=ms.create(this,this.onVSCSelected,null,!1),this.vsc.registAll([{cls:nu,id:"SUB_MATERAIL",wait:On.wait(On.waitConfig(["ConfigVip"],["ConfigVip"]))},{cls:Ud,id:"SUB_DAILY",isHideBg:!0,wait:On.wait(On.waitConfig(["ShaoZhuRewardResource","SZSpecialRewardResource","ConfigChuanshi","ConfigChuanshiSuit","ConfigRule"],["ShaoZhuReward","ShaoZhuSpecialReward","ConfigChuanshi","ConfigChuanshiSuit","CHelpDes"]),On.waitAtlas(["pigTwo","pig"]))},{cls:Iu,id:"SUB_TOWER",isHideBg:!0,grayTip:function(){Vl.ins.showById(3952,1)},wait:On.wait(On.waitConfig(["ConfigYCTianGuan","DragonDesignUpgrade","DragonView"],["ConfigYCTianGuan","CConfigDragonInfo","CConfigDragonView"]),On.waitAtlas("tower"))},{cls:_u,id:"SUB_TEAMCOPY",grayTip:function(){Vl.ins.showMsg(ed.n[1506]+e._teamCopyOpenFL+ed.n[1507]+e._teamCopyOpenDay+"天开放",1)},wait:On.wait(On.waitConfig(["TeamCopyTemplatel","TeamCopyGLTemplatel","TeamCopyOtherTemplatel"],["CTeamCopyModel","CTeamCopyGLModel","CTeamCopyOtherModel"]),On.waitAtlas(["teamCopy"]))}]),this.vsc.filterHandler=ms.create(this,this.checkTips,null,!1)},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},e.updateSelectedView=function(e){switch(this.vsc.selectedView){case Iu:case nu:case Ud:this.vsc.updateSelectedView(e)}},e.checkTips=function(e){switch(e){case"SUB_TOWER":if(Gi.ins.lv<this._towerOpenLevel||J.getOpenServiceDay()<this._towerOpenDay)return 1;if(Qr.ins.getStateByBtnName("BTN_COPYTOWER")||$a.instance.isFirstLoginClicked)return 3;break;case"SUB_MATERAIL":if(Qr.ins.getStateByBtnName("BTN_COPYCP"))return 3;break;case"SUB_DAILY":if(Qr.ins.getStateByBtnName("BTN_COPYDAILY")||Bd.ins.isShowRedPoint||Ed.ins.isFirstRed)return 3;break;case"SUB_TEAMCOPY":if(Gi.ins.zsLv<this._teamCopyOpenFL||J.getOpenServiceDay()<this._teamCopyOpenDay)return 1;if(Qr.ins.getStateByBtnName("BTN_TEAM_COPY"))return 3}return 0},e.onVSCSelected=function(e,t){var i="";switch(e){case"SUB_MATERAIL":i="copy/title_daily.png";break;case"SUB_DAILY":i="copy/title_daily.png",Fl.sendToModule("OPEN_ENTER",["modules.copy.CopyModule"]),(Bd.ins.isShowRedPoint||Ed.ins.isFirstRed)&&(Bd.ins.isShowRedPoint=!1,Ed.ins.isFirstRed=!1,Fl.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),this.updateItemEnabled());break;case"SUB_TOWER":$a.instance.isFirstLoginClicked&&($a.instance.isFirstLoginClicked=!1,Fl.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),this.updateItemEnabled()),i="tower/lwt_text_lwt.png";break;case"SUB_TEAMCOPY":i="copy/title_daily.png",Qr.ins._stateH.take(265)&&(Qr.ins.updatePt(265,!1),Fl.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),this.updateItemEnabled())}this.setTitle(Or.getAtlasSubPath(i))},e.refreshView=function(){Qr.reqRedPt([212,71,221,231,265]);var e=ms.create(this,this.redPtUpdate,null,!1);Qr.ins.addListener("BTN_COPYTOWER",[212],e),Qr.ins.addListener("BTN_COPYCP",[71],e),Qr.ins.addListener("BTN_COPYDAILY",[221,231],e),Qr.ins.addListener("BTN_TEAM_COPY",[265],e)},i}(jr),Ud=function(e){function t(){var e=this;e._curView=null,e._dicViews=null,e.open=!1,t.__super.call(e),e.init()}u(t,"modules.copy.views.daily.DailyCopyView",wl);var i=t.prototype;return i.init=function(){var e=this;e.dot1.visible=!1,e.dot2.visible=!1,e.dot3.visible=!1,e._dicViews=new ks,null==e._curView&&e.openTab(Jd)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.copy1.on("click",t,t.onClickTab),t.copy2.on("click",t,t.onClickTab),t.copy3.on("click",t,t.onClickTab),Ad.reqChallengeInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.copy1.off("click",t,t.onClickTab),t.copy2.off("click",t,t.onClickTab),t.copy3.off("click",t,t.onClickTab)},i.updateByVSC=function(e){var t=this;return t.updateRedDot(),1==Ed.ins.again?(Ed.ins.again=!1,t.openTab(Hd),t.copy2.addChildAt(t.img_selected,0),t.img_selected.x=1,void(t.img_selected.y=1)):1==Ed.ins.linkTo?(Ed.ins.linkTo=!1,t.openTab(Hd),t.copy2.addChildAt(t.img_selected,0),t.img_selected.x=1,void(t.img_selected.y=1)):void("boolean"!=typeof e&&t._curView&&t._curView.parent&&t._curView.updateByVSC&&(1==t._curView.c_id?t._curView.updateByVSC(e):t._curView.updateByVSC()))},i.onClickTab=function(e){var t=this;switch(e.target){case t.copy1:t.openTab(Jd);break;case t.copy2:if(1!=t.open)return void Vl.ins.showById(4949,1);t.openTab(Hd);break;case t.copy3:return}e.target.addChildAt(t.img_selected,0),t.img_selected.x=1,t.img_selected.y=1},i.openTab=function(e){var t=this;if(null!=t._curView){if(Y.__typeof(t._curView,e))return;t._curView.removeSelf()}null!=e?(t._dicViews.get(e)||t._dicViews.set(e,new e),t._curView=t._dicViews.get(e),t.view.addChild(t._curView)):t._curView=null},i.updateRedDot=function(){var e=this;e.dot1.visible=!1,e.dot2.visible=!1,e.dot3.visible=!1,Qr.ins.getStateByCareList([231])||Bd.ins.isShowRedPoint?e.dot1.visible=!0:e.dot1.visible=!1,Qr.ins.getStateByCareList([277])||Ed.ins.isFirstRed?e.dot2.visible=!0:e.dot2.visible=!1,e.open=!0;var t=qi.getIndex(81),i=qi.MODEL.openConditions(t);if(i)for(var s=JSON.parse(i),n=0;n<s.length;n++){var o,a=s[n];null==a&&(e.open=!1),a.type&&(o=a.type.toLowerCase());var r=parseInt(a.value);"serveropenday"==o&&J.getOpenServiceDay()<r&&(e.open=!1),"playerzhuanshenglevel"==o&&Gi.ins.zsLv<r&&(e.open=!1)}1==e.open?e.copy2.gray=!1:e.copy2.gray=!0,Nn.ins.notice(["NavMission"],null)},i.destroy=function(e){var t=this;if(void 0===e&&(e=!0),t._curView=null,t._dicViews&&t._dicViews.values&&0<t._dicViews.values.length){for(var i=0 in t._dicViews.values)t._dicViews.values[i].destroy(e);t._dicViews.clear(),t._dicViews=null}ui.SubPanel.prototype.destroy.call(t,e)},t}(),Hd=function(e){function t(){var e=this;e.c_id=1,e._avatar=null,e.g_cost=null,e.colorMatrix=[.2586,.1094,.082,0,0,.2586,.1094,.082,0,0,.2586,.1094,.082,0,0,0,0,0,1,0],e.GrayFilter=null,e._gridsList=null,e.infoArr=null,e.currIdx=0,e.avatarArr=[],e.copyid=0,e.num=0,e.status1=0,e.needNum=0,t.__super.call(e),e.initUI()}u(t,"modules.copy.views.daily.hundunMonster.HundunMonsterEnterView",So);var i=t.prototype;return i.initUI=function(){var e=this;e.GrayFilter=new Ei(e.colorMatrix),e.g_cost=new ra(45),e.g_cost.needGridBg=!1,e.g_cost.pos(e.txt_times.x-50,e.txt_times.y-10),e.box_t.addChild(e.g_cost);var t=an.create(60001);e.g_cost.bindData=t,e.img_xz_1.visible=!1,e.img_xz_2.visible=!1,e.img_xz_3.visible=!1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onClick),t.box_1.on("click",t,t.onClick),t.box_2.on("click",t,t.onClick),t.box_3.on("click",t,t.onClick),t.txt_get.on("click",t,t.onClick),t.btn_help.on("click",t,t.onClick),Ld.reqHundunInfo(),t._gridsList=new ga(3),t._gridsList.pos(182,25),t._gridsList._gsimpleName=!0,t._gridsList._gridW=t._gridsList._gridH=80,t._gridsList._spaceX=28,t._gridsList._gnameY=t._gridsList._gridH+7,t._gridsList._vScrollBarSkin=null,t._gridsList._hScrollBarSkin=null,t.box_t.addChild(t._gridsList)},i.onRemove=function(e){var t=this;if(ui.SubPanel.prototype.onRemove.call(t,e),0<t.avatarArr.length)for(var i=0;i<t.avatarArr.length;i++)t.avatarArr[i]&&(t.avatarArr[i].parent&&t.avatarArr[i].parent.removeChild(t.avatarArr[i]),t.avatarArr[i].dispose(),t.avatarArr[i].destroy(),t.avatarArr[i]=null);t.avatarArr=[],t._gridsList.destroy(),t.btn_go.off("click",t,t.onClick),t.box_1.off("click",t,t.onClick),t.box_2.off("click",t,t.onClick),t.box_3.off("click",t,t.onClick),t.txt_get.off("click",t,t.onClick),t.btn_help.off("click",t,t.onClick)},i.destroy=function(e){var t=this;if(void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(t,e),0<t.avatarArr.length)for(var i=0;i<t.avatarArr.length;i++)t.avatarArr[i]&&(t.avatarArr[i].dispose(),t.avatarArr[i].destroy(),t.avatarArr[i]=null);t.avatarArr=[];var s=[Or.getAtlasSubPath("ui/layouts/pigTwo/hdsy_xh_tz.png"),Or.getAtlasSubPath("ui/layouts/pigTwo/hdsy_xh_lr.png"),Or.getAtlasSubPath("ui/layouts/pigTwo/hdsy_jm_bg.jpg")];for(i=0;i<s.length;i++){var n=Y.loader.getRes(s[i]);n&&n.destroy(),n=null}},i.updateByVSC=function(e){var t,i=this;if(e instanceof protos.pig.hundunmonster.toc_21276){i.infoArr=e.infoArr,t=[];for(var s=0;s<i.infoArr.length;s++){var n=i.infoArr[s].copyId,o=i.infoArr[s].status;t.push(o);var a=uo.getIndex(n);i.setAvatar(a,o,s+1)}if(-1==t.indexOf(2)&&-1==t.indexOf(1))i.currIdx=0;else if(-1==t.indexOf(1))i.currIdx=t[t.length-1];else{var r=t.indexOf(1);i.currIdx=r}i.changeView(i.currIdx)}else i.changeView(i.currIdx)},i.setAvatar=function(e,t,i){var s=this;s["num_"+i].value=i;var n=uo.MODEL.bossId(e);e=Xl.getIndex(n);var o=Xl.MODEL.muId(e);e=Cs.getIndex(o);var a=Cs.MODEL.avatarId(e);s._avatar=new Jc,s._avatar.renderInSelf=!0,s._avatar.pos(s["box_"+i].x+85,s["box_"+i].y+200);var r=s.box_c.getChildIndex(s["box_"+i]);s.box_c.addChildAt(s._avatar,r-1),s._avatar.mid=a,s._avatar.type=mc.MONSTER,s._avatar.loadAvatarParts("mid",a,!0),s._avatar.setDir(4),s._avatar.play("stand"),s._avatar.mat.identity(),s._avatar.mat.scale(1,1),s.avatarArr.push(s._avatar),0==t?(s._avatar.isPause=!0,s._avatar.filters=[s.GrayFilter],s["img_yjs_"+i].visible=!1):(s._avatar.isPause=!1,s._avatar.filters=[],1==t?s["img_yjs_"+i].visible=!1:2==t&&(s["img_yjs_"+i].visible=!0))},i.changeView=function(e){var t=this;t.copyid=t.infoArr[e].copyId,t.status1=t.infoArr[e].status;var i=uo.getIndex(t.copyid),s=uo.MODEL.name(i);t.txt_name.text="第"+(e+1)+"关 "+s;for(var n=0;n<t.infoArr.length;n++)t["img_xz_"+(n+1)].visible=n==e;var o=uo.MODEL.bossShowAward(i);t._gridsList.setGoodsItems(o,3),t._gridsList.x=(t.box_t.width-t._gridsList.contentWidth)/2,1==t.status1?t.btn_go.gray=!1:t.btn_go.gray=!0,t.num=ri.ins.getGoodsNum(60001);var a=JSON.parse(uo.MODEL.consumption(i))[0].value.toString();t.needNum=parseInt(a.split(":")[1]),t.txt_times.text=t.num+"/"+t.needNum,t.txt_times.color=t.num<t.needNum?"#e41b00":"#23b11f",1==t.status1&&t.num>=t.needNum?t.btn_go.showTip=!0:t.btn_go.showTip=!1},i.onClick=function(e){var t=this;switch(e.currentTarget){case t.box_1:t.changeView(0);break;case t.box_2:t.changeView(1);break;case t.box_3:t.changeView(2);break;case t.btn_go:if(0==t.status1)return void Vl.ins.showById(4922,1);if(2==t.status1)return void Vl.ins.showById(4921,1);if(t.num<t.needNum)return void Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1051,max:-1});on.reqEntry(t.copyid);break;case t.txt_get:Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1051,max:-1});break;case t.btn_help:hc.goToOpenHelpDes(28)}},t}(),Fd=function(e){function t(){var e=this;e._price=0,e._max=0,e._cur=1,t.__super.call(e),e.centerX=e.centerY=0,e.init()}u(t,"modules.copy.views.daily.mental.MentalMoppingTip",Vc);var i=t.prototype;return i.init=function(){this.txt_num.changeText("1"),this.icon.visible=!0},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick);for(var i=Gi.ins.zsLv,s=0;s<bn.count;s++)if(i==bn.MODEL.flyLevel(s)){var n=bn.MODEL.gold(s);t._price=n}t._max=3,t._cur=0,t.updateView()},i.onRemove=function(e){this.off("click",this,this.onClick),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClick=function(e){var t=this;switch(e.target){case t.btn_ok:var i=ve.ins.toc21236;if(null!=i){var s=!0;Gi.ins.YB<t._cur*t._price&&(s=!1),s?(Ad.reqMopping(t._cur,i.copyId),On.ins.close("COPYMAINVIEW")):ja.ins.showNoGold()}case t.btn_close:t.close();break;case t.btn_add:t._cur++,t.updateView();break;case t.btn_sub:t._cur--,t.updateView();break;case t.btn_max:t._cur=t._max,t.updateView();break;case t.btn_min:t._cur=0,t.updateView()}},i.setValue=function(e){void 0===e&&(e=1),this._max=e,this.updateView()},i.updateView=function(){var e=this;0==e._max?e._cur=e._max:e._cur>e._max?e._cur=e._max:e._cur<0&&(e._cur=0),e.txt_num.changeText(e._cur+""),e.setCost(e._cur*e._price)},i.setCost=function(e){Gi.ins.YB<e?this.txt_cost.color="#ff2e24":this.txt_cost.color="#90877b",this.txt_cost.changeText(e+"")},i.close=function(){On.ins.close("MENTAL_MOPPING_TIP")},t}(),zd=function(e){function t(){var e=this;e._buffMask=null,e._waveNum=0,e._refreshLeaveTime=0,e._copyLeaveTime=0,e._countDowns=null,e._buffCools=null,t.__super.call(e),e.init()}u(t,"modules.copy.views.daily.mental.MentalScene",ro);var i=t.prototype;return i.init=function(){var e=this;e.mouseThrough=!0,e._buffMask=[];for(var t=0;t<3;t++){var i=new rn;i.graphics.drawCircle(35,35,35,"#000000"),i.width=i.height=70,i.alpha=.8,i.scaleY=-1;var s=e["buff"+(t+1)];i.x=s.width-i.width>>1,i.y=2+i.height,s.addChild(i),e._buffMask[t]=i}e.img_dot.visible=!1},i.onAdd=function(e){var t=this;for(var i in ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.refreshActor(),Ad.reqSummonBossTime(),t.updateRedDot(),t.startCountLeave(),t._countDowns=[],t._buffCools=[],t._buffMask)t._buffMask[i].visible=!1;Y.timer.loop(1e3,t,t.updateReviveCountDown),Y.timer.loop(200,t,t.updateBuffCountDown),t._waveNum=0,t._refreshLeaveTime=3,Y.timer.loop(1e3,t,t.onUpdateRefreshTime),t.onUpdateRefreshTime()},i.onRemove=function(e){var t=this;t.off("click",t,t.onClick),ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clear(t,t.onUpdateRefreshTime),Y.timer.clear(t,t.onUpdateLeaveTime),Y.timer.clear(t,t.updateReviveCountDown),Y.timer.clear(t,t.updateBuffCountDown)},i.updateByVSC=function(e){},i.onClick=function(e){var t=this,i=ve.ins.toc24046,s=0;switch(null!=i&&(s=i.score),e.target){case t.buff1:250<=s&&!t._buffCools.hasOwnProperty(1)?(t._buffCools[1]={end:J.curServerTime+2e4,begin:J.curServerTime},t.reqUseBuff(1)):Vl.ins.showMsg(ed.n[1508],1);break;case t.buff2:100<=s&&!t._buffCools.hasOwnProperty(2)?(t._buffCools[2]={end:J.curServerTime+2e4,begin:J.curServerTime},t.reqUseBuff(2)):Vl.ins.showMsg(ed.n[1508],1);break;case t.buff3:150<=s&&!t._buffCools.hasOwnProperty(3)?(t._buffCools[3]={end:J.curServerTime+2e4,begin:J.curServerTime},t.reqUseBuff(3)):Vl.ins.showMsg(ed.n[1508],1);break;case t.btn_help:On.ins.open("AE_EXPLAIN_VIEW",{desc:ed.n[1511]});break;case t.btn_summon:On.ins.open("MENTAL_SUMMON_TIP",1)}},i.reqUseBuff=function(e){var t;void 0===e&&(e=1),this["buff"+e].disabled=!0,(t=this._buffMask[e-1]).visible=!0,(t.scrollRect=t.scrollRect||new qo(0,0,t.width,t.height)).height=t.height,Ad.reqUseBuff(e),this.updateBuffCountDown()},i.updateHP=function(){var e,t=Gi.ins.actorList,i=1;for(var s in t){e=t[s];var n=this["bar"+i],o=this["revive"+i],a=n.scrollRect||new qo(0,0,n.width,n.height);a.width=n.width*(e.currHP/e.maxHP),n.scrollRect=a,0<e.currHP?o.visible=!1:o.visible=!0,i++}},i.refreshActor=function(){var e=this;e.role1.visible=!1,e.role2.visible=!1,e.role3.visible=!1,e.revive1.visible=!1,e.revive2.visible=!1,e.revive3.visible=!1,e.bar_bg1.visible=!1,e.bar_bg2.visible=!1,e.bar_bg3.visible=!1;var t,i=Gi.ins.actorList,s=1;for(var n in i){t=i[n];var o=e["role"+s],a=e["bar_bg"+s];o.skin=Or.getActorHeadPath(t.job,t.sex),o.visible=!0,a.visible=!0,s++}e.updateHP()},i.updateTargetHp=function(e,t){var i,s=Gi.ins.actorList,n=1;for(var o in s){i=s[o];var a=this["bar"+n],r=this["role"+n],l=this["revive"+n];if(e==n){var c=a.scrollRect||new qo(0,0,a.width,a.height);c.width=a.width*(t/i.maxHP),a.scrollRect=c,a.visible=!1,0<t?(l.visible=!1,r.gray=!1,a.visible=!0):(l.visible=!0,r.gray=!0,this.setReviveCoolDown(e));break}n++}},i.setReviveCoolDown=function(e){var t=ha.ins.curCopyId,i=uo.getIndex(t);if(31==uo.MODEL.cate(i)){var s=this["revive"+e];this._countDowns.hasOwnProperty(e)||(s.innerHTML="",this._countDowns[e]=1e4+J.curServerTime,this.updateReviveCountDown())}},i.updateReviveCountDown=function(){for(var e=this,t=0,i=0,s=Ss.heroQueue,n=0;n<s.length;n++){var o=s[n];o&&o.hero_id<4&&t++}for(var a=0 in e._countDowns){null!=e._countDowns[a]&&i++;var r=e["revive"+a];r.innerHTML=""}if(!(t<=i))for(a in e._countDowns){var l=e._countDowns[a];J.curServerTime>=l&&delete e._countDowns[a];var c=l-J.curServerTime;c<=0&&(c=0);var d=Math.round(c/1e3);(r=e["revive"+a]).innerHTML=d}},i.updateBuffCountDown=function(){var e;for(var t=0 in this._buffCools){var i=this._buffCools[t],s=i.begin,n=i.end,o=this["buff"+t];if(e=this._buffMask[t-1],J.curServerTime>=n)e.visible=!1,o.disabled=!1,delete this._buffCools[t],(new Yl).to(o,{scaleX:1.2,scaleY:1.2},100,null,ms.create(this,function(e){(new Yl).to(e,{scaleX:1,scaleY:1},100)},[o]));var a=(J.curServerTime-s)/(n-s);(e.scrollRect=e.scrollRect||new qo(0,0,e.width,e.height)).height=70*(1-a)}},i.updateScore=function(){var e=ve.ins.toc24046;null!=e&&(this.div_score.innerHTML=e.score+"",this.div_total.innerHTML=e.monsterNum+"")},i.updateRedDot=function(){var e=ve.ins.toc24047;null!=e&&(this.img_dot.visible=0<e.time)},i.refreshTime=function(){var e=this;e._waveNum++,e._refreshLeaveTime=20,Y.timer.clear(e,e.onUpdateRefreshTime),Y.timer.loop(1e3,e,e.onUpdateRefreshTime),e.onUpdateRefreshTime()},i.onUpdateRefreshTime=function(){var e,t=this;t._waveNum<15?e=nc.createColor("("+t._waveNum+"/15)","#23b11f")+ed.n[1512]+nc.createColor(t._refreshLeaveTime+"秒","#ff2e24"):(e=nc.createColor("("+t._waveNum+"/15)","#23b11f")+ed.n[1513],Y.timer.clear(t,t.onUpdateRefreshTime)),t.div_refresh.innerHTML=e,0==t._refreshLeaveTime&&Y.timer.clear(t,t.onUpdateRefreshTime),t._refreshLeaveTime--},i.startCountLeave=function(){var e=this;e._copyLeaveTime=360,Y.timer.clear(e,e.onUpdateLeaveTime),Y.timer.loop(1e3,e,e.onUpdateLeaveTime),e.onUpdateLeaveTime()},i.onUpdateLeaveTime=function(){var e=this,t=ed.n[1514]+nc.createColor(V.getHMSTimeString(e._copyLeaveTime),"#ff2e24");e.div_leave.innerHTML=t,0==e._copyLeaveTime&&Y.timer.clear(e,e.onUpdateLeaveTime),e._copyLeaveTime--},t}(),Wd=function(e){function t(){this._cost=0,t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.copy.views.daily.mental.MentalSummonTip",Lt);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),Ad.reqSummonBossTime(),t.updateView()},i.onRemove=function(e){this.off("click",this,this.onClick),ui.ViewBase.prototype.onRemove.call(this,e)},i.onClick=function(e){switch(e.target){case this.btn_ok:if(this._cost>Gi.ins.YB)return void ja.ins.showNoGold();Ad.reqSummon();case this.btn_close:this.close()}},i.close=function(){On.ins.close("MENTAL_SUMMON_TIP")},i.updateView=function(){var e=this,t=ve.ins.toc24047;if(null!=t){var i="#23b11f";t.time<=0&&(i="#ff2e24"),e.div_times.innerHTML=ed.n[1515]+nc.createColor(t.time+"次",i)}e.icon.visible=!1;for(var s=Gi.ins.zsLv,n=0;n<bn.count;n++)if(s==bn.MODEL.flyLevel(n)){var o=bn.MODEL.gold(n);e.txt_cost.changeText(o.toString()),e.icon.visible=!0,e._cost=o,i="#90877b",e._cost>Gi.ins.YB&&(i="#ff2e24"),e.txt_cost.color=i;break}},t}(),jd=function(e){function t(){var e=this;e.vipLv=0,e._pigData=null,e.currData=null,e.totalAwardsLength=0,e.goodsStr="",e.maxPage=0,e.currentPage=0,e.goodsList=[],e.img_redPoint=null,e.totalExp=0,t.__super.call(e),e._pigData=Bd.ins,e.panel_awards.height=102,e.txt_tips.style.leading=15,e.txt_tips.style.font="SimHei",e.txt_tips.style.fontSize=24,e.txt_tips.y=11,e.img_redPoint=new Dl(Or.getAtlasSubPath("basic_ui/ty_ts_hd.png")),e.addChild(e.img_redPoint)}u(t,"modules.copy.views.daily.pigTwo.PigTwoAwardsItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_left.on("click",t,t.onClickPageBtn),t.btn_right.on("click",t,t.onClickPageBtn),t.btn_get.on("click",t,t.onClickGet),t.panel_awards.hScrollBarSkin=""},i.onRemove=function(e){for(;this.goodsList&&0<this.goodsList.length;){this.goodsList.shift().removeSelf()}ui.SubPanel.prototype.onRemove.call(this,e)},i.onClickPageBtn=function(e){var t=this;if(e.target==t.btn_left){if(t.currentPage<=0)return t.currentPage=0,t.btn_left.mouseEnabled=!1,void Rn.gray(t.btn_left,!0);t.btn_left.mouseEnabled=!0,Rn.gray(t.btn_left,!1),t.currentPage--,t.panel_awards.hScrollBar.setScroll(0,380,380*t.currentPage)}else if(e.target==t.btn_right){if(t.currentPage>=t.maxPage)return t.currentPage=t.maxPage,t.btn_right.mouseEnabled=!1,void Rn.gray(t.btn_right,!0);t.btn_right.mouseEnabled=!0,Rn.gray(t.btn_right,!1),t.currentPage++,t.panel_awards.hScrollBar.setScroll(0,380*t.maxPage,380*t.currentPage)}},i.onClickGet=function(e){var t=this;if(Gi.ins.VIPLevel<t.vipLv)return Vl.ins.showMsg(ed.n[1516],1),void Fl.sendToModule("OPEN_PANEL",["modules.vip.VipModule"]);if(Gi.ins.lv<150){var i=new Object;i.type=2,i.awardID=-1,i.lv=t.currData[0].lv,i.exp=t.totalExp,i.bei=-1,Fl.sendToModule("OPEN_FIRE_PIG_EXP",["modules.copy.CopyModule"],i)}else Od.reqGetZHAwards(t.currData[0].lv),Vl.ins.playGetGoodsByPos(t.goodsStr)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(null!=e){t.currentPage=0;var i=new Kt;if(t.currData=e,t.currData.length<=0)return;t.txt_tips.innerHTML=ed.n[1517]+e[0].vip+ed.n[1518],t.vipLv=e[0].vip;var s,n=0,o=0,a=0;for(n=0;n<t.currData.length;n++){var r=t.currData[n].id,l=t.currData[n].bei,c=vi.getIndex(r),d=vi.MODEL.rewardDef(c),u=JSON.parse(d);for(o=0;o<u.length;o++){var h=u[o].value,_=parseInt(h.split(":")[0]),p=parseInt(h.split(":")[1]);if(i.has(_)){a=i.take(_);var f=p*l;i.put(_,a+=f,!0)}else i.put(_,p*l)}}for(var g in t.totalAwardsLength=i.length,a=0,t.goodsStr="",i.proto){t.goodsList.length>a?s=t.goodsList[a]:(s=new nd,t.goodsList.push(s));var v=parseInt(i.take(g));s.data=an.create(parseInt(g),v),null==s.parent&&t.panel_awards.addChild(s),s.pos(105*a,2),a++,t.goodsStr+=g+","+v+";","4"==g&&(t.totalExp=v)}t.maxPage=Math.ceil(i.length/3),t.btn_left.visible=t.btn_right.visible=3<i.length,t.img_redPoint.visible=Gi.ins.VIPLevel>=t.vipLv,t.img_redPoint.pos(490,49)}}),t.PANEL_WIDTH=380,t}(tc),qd=function(e){function t(){var e=this;e._pigData=null,t.__super.call(e),e._pigData=Bd.ins,e.list_item.itemRender=jd,e.list_item.vScrollBarSkin="",e.list_item.scrollBar.elasticDistance=300,e.list_item.spaceY=6,e.list_item.dataSource=[],e.centerX=e.centerY=0,e.btn_close.on("click",e,e.onClickClose)}u(t,"modules.copy.views.daily.pigTwo.PigTwoAwardsView",Ps);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.btn_close.off("click",this,this.onClickClose),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_no.fontSize=28,t.list_item.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list_item.scrollBar.off("change",this,this.onScrollChanged)},i.onScrollChanged=function(){var e=this;0==e.list_item.scrollBar.max||e.list_item.scrollBar.value>=e.list_item.scrollBar.max?e.g_mask.visible=!1:e.g_mask.visible=!0},i.showInfo=function(){var e=this;e.list_item.dataSource=[];var t=e._pigData.toc22016.hashTotal,i=[],s=[],n=[],o=[],a=[],r=[];for(var l in t.proto)for(var c=t.take(l),d=0;d<c.length;d++){var u=vi.getIndex(c[d].awardsIDs),h=vi.MODEL.level(u);0!=c[d].awardsBei&&(1==h?s.push({id:c[d].awardsIDs,bei:c[d].awardsBei,vip:1,lv:1}):2==h?n.push({id:c[d].awardsIDs,bei:c[d].awardsBei,vip:2,lv:2}):3==h?o.push({id:c[d].awardsIDs,bei:c[d].awardsBei,vip:3,lv:3}):4==h?a.push({id:c[d].awardsIDs,bei:c[d].awardsBei,vip:4,lv:4}):5==h&&r.push({id:c[d].awardsIDs,bei:c[d].awardsBei,vip:6,lv:5}))}0<s.length&&i.push(s),0<n.length&&i.push(n),0<o.length&&i.push(o),0<a.length&&i.push(a),0<r.length&&i.push(r),e.list_item.dataSource=i,e.g_mask.visible=5<=i.length,e.txt_no.visible=i.length<=0},i.onClickClose=function(e){On.ins.close("PIG_FIRE_AWARD")},t}(),Yd=function(e){function t(){var e=this;e.hasGetAwards=!1,e.effect=null,e.pigData=null,e.currentNeedNum=0,e.awardsIds=0,e._mask=null,t.__super.call(e),e.pigData=Bd.ins,e.createMask()}u(t,"modules.copy.views.daily.pigTwo.PigTwoBoxItem",Ds);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.on("click",this,this.onClickThis)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClickThis)},i.thisBoxIsOk=function(){return this.pigData.toc22016.maxNum>=this.currentNeedNum},i.setState=function(e){var t=this;t.hasGetAwards=!1,0==e?(t.img_ok.visible=!1,t._mask&&t._mask.parent&&t._mask.parent.removeChild(t._mask)):(t.img_ok.visible=!0,t._mask&&null==t._mask.parent&&t.addChildAt(t._mask,2))},i.onClickThis=function(e){var t=new Object;t.id=this.awardsIds,t.isget=this.pigData.toc22016.maxNum>=this.currentNeedNum,Fl.sendToModule("OPEN_FIRE_PIG_SHOWAWARDS",["modules.copy.CopyModule"],t)},i.createMask=function(){var e=this;null==e._mask&&(e._mask=new cn,e._mask.left=e._mask.right=e._mask.top=e._mask.bottom=0,e._mask.alpha=.4,e._mask.graphics.drawCircle(60,55,45,"#000000",null),e._mask.mouseEnabled=!1,e._mask.mouseThrough=!1)},n(0,i,"data",null,function(e){this.awardsIds=e;var t=vi.MODEL.conditionDef(e-1),i=JSON.parse(t);this.txt_score.text=i[0].value,this.currentNeedNum=parseInt(i[0].value),this.img_item.skin=Or.getAtlasSubPath("pigTwo/jqsz_bx_"+vi.MODEL.level(e-1)+".png")}),t}(),Kd=function(e){function t(){var e=this;e.directId=220,e.showList=[],e._achieves=null,t.__super.call(e),e.init(),e.centerX=e.centerY=0}u(t,"modules.copy.views.daily.pigTwo.PigTwoChangeStrongView",Wa);var i=t.prototype;return i.init=function(){this.btn_close.on("click",this,this.onClick)},i.update=function(){var e=this,t=Ta.getIndex(e.directId),i=Ta.MODEL.value(t);if(e.showList.length=0,i&&0<i.length){for(var s=i.split(";"),n=[],o=/starlevel_\d+/g,a=0,r=0;r<s.length;r++){var l=s[r],c=0,d=!0,u=l.match(o);if(u){var h=u[0];h&&(c=parseInt(h.split("_")[1]))}var _=l.split("|");1==parseInt(_[0])?_[2]>Gi.ins.lv&&(d=!1):2==parseInt(_[0])&&_[3]>Gi.ins.lv&&(d=!1);"ACTOR_ACTIVE"==_[1]?Gi.ins.actorList.length<3?n.push({open:d,star:c,link:l}):a++:"FIRST_RECHARGE"==_[1]?Js.ins.toc_recharge&&2!=Js.ins.toc_recharge.canGet?n.push({open:d,star:c,link:l}):a++:n.push({open:d,star:c,link:l})}e.showList=n}0<e.showList.length&&(e._achieves||(e._achieves=new fe,e._achieves.x=35,e._achieves.y=395,e.addChild(e._achieves)),e._achieves.update(e.showList)),e._achieves&&(e._achieves.visible=0<e.showList.length),1==a?e.height=760:2==a&&(e.height=680)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.update()},i.sortFunc=function(e,t){return e.open==t.open?e.star==t.star?0:e.star>t.star?-1:1:e.open>t.open?-1:1},i.onClick=function(){On.ins.close("FIRE_PIG_CHANGE")},t}(),Jd=function(e){function t(){var e=this;e.c_id=0,e.pigData=null,e.listItem=[],e.minNum=0,e.stateSP=!1,e.img_redPoint=null,e.effect_zh=null,e.effect_ceng=null,e.hasAwardsGet=!1,e.imageGetedSP=null,e.currentCeng=0,e.arrowView=null,e._ringEff=null,e._blingEff=null,e.goodsStr="",e._mask=null,e.f=new Ei([.5,0,0,0,16.75,0,.5,0,0,16.75,0,0,.5,0,16.75,0,0,0,1,0]),t.__super.call(e),e.pigData=Bd.ins,e.txt_time.style.font="SimHei",e.txt_time.style.fontSize=22,e.txt_time.style.align="center",e.txt_time.style.color="#90877b",e.txt_time.x=209,e.txt_time.y=903,e.img_redPoint=new Dl(Or.getAtlasSubPath("basic_ui/ty_ts_hd.png")),e.createMask()}u(t,"modules.copy.views.daily.pigTwo.PigTwoEnterView",Ce);var i=t.prototype;return i.destroy=function(e){var t=this;void 0===e&&(e=!0);for(var i=0;i<t.listItem.length;i++)t.listItem[i].removeSelf(),t.listItem[i]=null;t.listItem=[],t.img_bg&&Y.loader.clearRes(si.formatURL(t.img_bg.skin)),t.imgBoss&&Y.loader.clearRes(si.formatURL(t.imgBoss.skin)),ui.SubPanel.prototype.destroy.call(t,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_tz.on("click",t,t.onClickTZ),t.btn_zh.on("click",t,t.onClickZH),t.btn_wf.on("click",t,t.onClickWF),t.txt_desc.on("click",t,t.onClickWF),t.boxSp.on("click",t,t.onClickEff),t.img_bar.width=400,t.txt_time.innerHTML=ed.n[1519],t.boxSp.visible=2==t.currentCeng,2==t.currentCeng&&(t._ringEff=ti.createEffect("jm1321",108,50),t._blingEff=ti.createEffect("jm1422",t.imgDizuo.width/2,t.imgDizuo.height/2-10),t.imgDizuo.addChild(t._blingEff),t.boxSp.addChildAt(t._ringEff,1)),t.updateTheBg()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_tz.off("click",t,t.onClickTZ),t.btn_zh.off("click",t,t.onClickZH),t.btn_wf.off("click",t,t.onClickWF),t.txt_desc.off("click",t,t.onClickWF),t.arrowView&&(t.arrowView.closeThisPanel(),t.arrowView=null),t._ringEff&&t._ringEff.dispose(),t._ringEff=null,t._blingEff&&t._blingEff.dispose(),t._blingEff=null},i._$9_showGuide=function(e,t){if(t&&ln.Ins().hasNewGuide(e)){var i=new qo;switch(e){case 40:i.x=525,i.y=175}i.width=50,i.height=50}},i.updateByVSC=function(e){var t=this;if(null!=t.pigData.toc22016){var i,s=0;if(0==t.currentCeng&&(t.currentCeng=t.pigData.toc22016.layer),t.boxSp.visible=2==t.currentCeng,2==t.currentCeng&&(t._ringEff=ti.createEffect("jm1321",108,50,t.boxSp),t._blingEff=ti.createEffect("jm1422",t.imgDizuo.width/2,t.imgDizuo.height/2-10,t.imgDizuo)),t.pigData.toc22016.layer<=10?(t.img_shi.visible=!1,t.img_d.x=300,t.img_ge.x=340,t.img_ge.y=93,t.img_c.x=376,t.img_ge.skin=Or.getAtlasSubPath("pigTwo/jqsz_cjs_"+t.pigData.toc22016.layer+".png")):(t.img_shi.visible=!0,t.img_d.x=280,t.img_shi.x=319,t.img_shi.y=93,t.img_ge.x=363,t.img_ge.y=93,t.img_c.x=402,t.pigData.toc22016.layer<20?(t.img_shi.skin=Or.getAtlasSubPath("pigTwo/jqsz_cjs_10.png"),t.img_ge.skin=Or.getAtlasSubPath("pigTwo/jqsz_cjs_"+t.pigData.toc22016.layer%10+".png")):(t.img_shi.skin=Or.getAtlasSubPath("pigTwo/jqsz_cjs_2.png"),t.img_ge.skin=Or.getAtlasSubPath("pigTwo/jqsz_cjs_10.png"))),t.txt_num.text=ed.n[1520]+t.pigData.toc22016.maxNum.toString(),0<t.pigData.hash_layer.length&&t.pigData.hash_layer.has(t.pigData.toc22016.layer)){i=t.pigData.hash_layer.take(t.pigData.toc22016.layer);var n=vi.MODEL.copyID(i[0]-1),o=uo.MODEL.bestFightingScore(uo.getIndex(n));t.fp_fight.value=o.toString();var a=vi.MODEL.conditionDef(i[0]-1),r=JSON.parse(a);for(t.minNum=parseInt(r[0].value),s=0;s<i.length;s++){var l;t.listItem.length>s?l=t.listItem[s]:(l=new Yd,t.listItem.push(l)),l.x=56+120*s,l.y=763,l.data=i[s],null==l.parent&&t.box_c.addChild(l)}}""!=Qn.MODEL.rewardDef(t.pigData.toc22016.layer-1)?t._$9_showGuide(40,!0):t.boxSp.visible=!1;var c=Qn.MODEL.conditionDef(t.pigData.toc22016.layer-1),d=JSON.parse(c),u=parseInt(d[0].value);if(t.pigData.currentLayMaxNum=u,t.pigData.toc22016.maxNum<t.minNum)t.showBarWidth(0);else if(t.pigData.toc22016.maxNum>=t.pigData.currentLayMaxNum)t.showBarWidth(1);else{var h=(t.pigData.toc22016.maxNum-t.minNum)/(u-t.minNum);t.showBarWidth(h)}t.stateSP=!1,1==t.pigData.toc22016.specialRewarded?(t.stateSP=!1,t.addSPMask(!0)):(t.addSPMask(!1),t.pigData.toc22016.maxNum>=u&&(t.stateSP=!0));var _=!1,p=t.pigData.toc22016.currentLayerArr;i=t.pigData.hash_layer.take(t.pigData.toc22016.layer);var f,g=[];for(s=0;s<i.length;s++)f=t.listItem[s],-1!=p.indexOf(i[s])?f.setState(1):(f.setState(0),f.thisBoxIsOk()&&g.push(f)),f.hasGetAwards&&(_=!0);0<g.length?(f=g[0],null!=t.arrowView&&(t.arrowView.closeThisPanel(),t.arrowView=null),t.arrowView=new Bl,t.arrowView.showforDir(3,ed.n[1521],f,!1,!0,33,18)):t.arrowView&&(t.arrowView.closeThisPanel(),t.arrowView=null),(_=t.stateSP||_)&&(t.hasAwardsGet=!0),null==t.img_redPoint.parent&&t.box_c.addChild(t.img_redPoint),t.img_redPoint.pos(185,486),t.img_redPoint.visible=!1,t.currentCeng!=t.pigData.toc22016.layer?(t.currentCeng=t.pigData.toc22016.layer,t.boxSp.visible=2==t.currentCeng,2==t.currentCeng&&(t._ringEff=ti.createEffect("jm1321",108,50,t.boxSp),t._blingEff=ti.createEffect("jm1422",t.imgDizuo.width/2,t.imgDizuo.height/2-10,t.imgDizuo)),null==t.effect_ceng&&(t.effect_ceng=ti.createEffect("jm1060",0,0,null),t.effect_ceng.scale_X=1,t.effect_ceng.scale_Y=1,t.effect_ceng.mouseEnabled=!0),null==t.effect_ceng.parent&&t.box_c.addChild(t.effect_ceng),t.effect_ceng.pos(2+(t.width>>1),117)):(t.effect_ceng&&t.effect_ceng.dispose(),t.effect_ceng=null),t.showRedPoint(),0==t.boxSp.visible&&t.imageGetedSP&&t.imageGetedSP.removeSelf(),t.updateTheBg()}},i.showBarWidth=function(e){var t=this.img_bar.scrollRect||new qo(0,0,this.img_bar.width,this.img_bar.height);t.width=400*e,this.img_bar.scrollRect=t},i.addSPMask=function(e){var t=this;t._ringEff&&(t._ringEff.filters=null),e?(null==t.imageGetedSP&&(t.imageGetedSP=new Dl(Or.getAtlasSubPath("base_ui2/ty_gat_ylq.png"))),null==t.imageGetedSP.parent&&t.boxSp.visible&&t.box_c.addChild(t.imageGetedSP),t._ringEff&&(t._ringEff.filters=[t.f]),t.imageGetedSP.pos(115,508)):t.imageGetedSP&&t.imageGetedSP.parent&&t.imageGetedSP.parent.removeChild(t.imageGetedSP)},i.onClickTZ=function(e){var t=this;if(null!=t.pigData.toc22016){var i=parseInt(Ta.MODEL.value(Ta.getIndex(21)));if(Gi.ins.lv<i)Vl.ins.showMsg(i+ed.n[1522],1);else{if(t.pigData.toc22016.maxNum>=t.pigData.currentLayMaxNum&&20==t.pigData.toc22016.layer&&5<=t.pigData.toc22016.currentLayerArr.length)return void Vl.ins.showMsg(ed.n[1523],1);if(t.pigData.toc22016.maxNum>=t.pigData.currentLayMaxNum)return void Vl.ins.showMsg(ed.n[1524],1);var s=t.pigData.hash_layer.take(t.pigData.toc22016.layer),n=vi.MODEL.copyID(s[0]-1);J.dtoEnterScene&&15==J.dtoEnterScene.type?(ha.ins.exitCopy(1),Y.timer.once(500,t,t.enterCopy,[n])):(on.reqEntry(n),On.ins._closePanelForce(t))}}},i.enterCopy=function(e){ha.ins.isCheckPointBoss=!1,On.ins._closePanelForce(this),on.reqEntry(e)},i.onClickZH=function(e){Fl.sendToModule("OPEN_FIRE_PIG_AWARDS",["modules.copy.CopyModule"])},i.onClickWF=function(e){var t=po.getIndex(4),i=po.MODEL.description(t);On.ins.open("AE_EXPLAIN_VIEW",{desc:i})},i.onClickEff=function(e){this.stateSP?this.onGetSpecailAwards():qa.instance.show(an.create(311))},i.onGetSpecailAwards=function(){Od.reqGetTSAwards(),Vl.ins.playGetGoodsByPos("311")},i.showRedPoint=function(){var e=this,t=e.pigData.isGetReturnAwards();t&&(1==t[1]?(e.btn_zh.visible=!0,e.btn_zh.showTip=!0,null==e.effect_zh&&(e.effect_zh=ti.createEffect("jm1320",0,0,null),e.effect_zh.scale_X=1,e.effect_zh.scale_Y=1,e.effect_zh.mouseEnabled=!1),null==e.effect_zh.parent&&e.box_c.addChildAt(e.effect_zh,6),e.effect_zh.pos(e.btn_zh.x+52,e.btn_zh.y+45)):(e.btn_zh.visible=t[0],e.btn_zh.showTip=!1,1==e.btn_zh.visible?(null==e.effect_zh&&(e.effect_zh=ti.createEffect("jm1320",0,0,null),e.effect_zh.scale_X=1,e.effect_zh.scale_Y=1,e.effect_zh.mouseEnabled=!1),null==e.effect_zh.parent&&e.box_c.addChildAt(e.effect_zh,6),e.effect_zh.pos(e.btn_zh.x+52,e.btn_zh.y+45)):(e.effect_zh&&e.effect_zh.dispose(),e.effect_zh=null)),e.stateSP&&e.boxSp.visible?e.img_redPoint.visible=!0:e.img_redPoint.visible=!1)},i.createMask=function(){var e=this;null==e._mask&&(e._mask=new cn,e._mask.left=e._mask.right=e._mask.top=e._mask.bottom=0,e._mask.alpha=.4,e._mask.graphics.drawRect(0,0,70,70,"#000000",null),e._mask.mouseEnabled=!1,e._mask.mouseThrough=!1)},i.updateTheBg=function(){var e=Qn.getIndex(this.currentCeng),t=Qn.MODEL.bgImg(e);t&&(this.imgBoss.skin=Or.getAtlasSubPath("pigTwo/"+t))},t}(),Xd=function(e){function s(){s.__super.call(this),this.centerX=this.centerY=0}u(s,"modules.copy.views.daily.pigTwo.PigTwoFightNoEnTip",Mt);var t=s.prototype;return t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btnBuy.on("click",t,t.onClick),t.btnRMB.on("click",t,t.onClick),t.btnClose.on("click",t,t.onClick),t.labCurFi.text=Gi.ins.force+"",t.labRecoFi.text=Bd.ins.getRecoFight()+""},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnBuy.off("click",t,t.onClick),t.btnRMB.off("click",t,t.onClick),t.btnClose.off("click",t,t.onClick),null!=J.dtoEnterScene&&ha.ins.changeSceneUI(J.dtoEnterScene.type,!1)},t.onClick=function(e){var t=this;switch(e.target){case t.btnBuy:if(Bd.alertedFv=!0,Xn.isNormalShow)fr.targetId=10013,ic.dealActIcon(ic.getIconBtn(46));else if(0<An.count)t.onJxrComplete(46);else{var i=[{url:Or.getJxrDBPath("ConfigActivityMainType"),type:"arraybuffer",cls:An}];Wl.ins().onLoadJxrs(i,ms.create(ic,t.onJxrComplete,[46]))}break;case t.btnRMB:Bd.alertedFv=!0,Fl.sendToModule("OPEN_QRECHARGE",["modules.recharge.RechargeModule"]);break;case t.btnClose:Bd.alertedFv=!1,On.ins.close("PigTwoFightNoEnTip")}},t.onJxrComplete=function(e){if(An.hasIndex(e)){var t=An.getIndex(e),i=An.MODEL.mainType(t);cc.getActivity(i,ms.create(ic,s.onGetActivityList,[i,t]))}},s.onGetActivityList=function(e,t){var i=An.MODEL.UIId(t);i&&On.ins.toggle(i,e)},s.NAME="PigTwoFightNoEnTip",s}(),Qd=function(e){function t(){var e=this;e.killArr=[],e.boxNum=null,t.__super.call(e),e.boxNum=new gl,e.addChild(e.boxNum)}u(t,"modules.copy.views.daily.pigTwo.PigtwoKillNum",cn);var i=t.prototype;return i.destr=function(){for(;0<this.killArr.length;){this.killArr.shift().removeSelf()}},n(0,i,"num",null,function(e){var t,i=this,s=e.toString(),n=0;for(n=0;n<s.length;n++)i.killArr.length>n?(t=i.killArr[n]).skin=Or.getAtlasSubPath("pigTwo/pz_hj_z_"+s.charAt(n)+".png"):(t=new Dl,i.killArr.push(t),t.skin=Or.getAtlasSubPath("pigTwo/pz_hj_z_"+s.charAt(n)+".png")),t.scaleX=t.scaleY=1.3,t.x=38*n,i.boxNum.addChild(i.killArr[n])}),t}(),Zd=function(e){function t(){var e=this;e.totalTime=0,e._newW=null,e._oldW=null,e.killNum=0,e.pdata=null,e.currentLayerNum=[],e.tempCurrentLayerNum=[],e.killnum=0,e.pj="B",e.cpj="",e.exp=0,e.currentLvNeedKillNum=0,e.firePigArr={},e.willKill=0,e.willPingJi="",e.killImageNum=null,e.chaNum=0,e.xx=0,e.yy=0,e._circle=null,e.tween=null,t.__super.call(e),e.txt_time.text="",e.centerX=e.centerY=0,e.pdata=Bd.ins,e.txt_desc.y=1e3,e.txt_desc.style.font="SimHei",e.txt_desc.style.fontSize=24,e.txt_desc.style.color="#90877b",e.txt_desc.style.leading=5,e.panel_kill.y=215}u(t,"modules.copy.views.daily.pigTwo.PigTwoMainView",w);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.killNum=0,t.btn_bq.on("click",t,t.onClick);var i=Ss.getHero(4);i&&ac.scene.removeItem(i),t.panel_kill.visible=!1,null==t.killImageNum&&(t.killImageNum=new Qd),null==t.killImageNum.parent&&t.panel_kill.addChild(t.killImageNum),t.killImageNum.num=0,t.killImageNum.x=180,t.killImageNum.y=90;for(var s,n,o=t.pdata.hash_layer.take(t.pdata.toc22016.layer),a=0;a<o.length;a++)if(s=vi.MODEL.conditionDef(o[a]-1),n=JSON.parse(s),t.currentLayerNum.push(parseInt(n[0].value)),0==a){s=vi.MODEL.rewardDef(o[a]-1),n=JSON.parse(s);for(var r=0;r<n.length;r++)if(4==n[r].value.split(":")[0]){t.exp=parseInt(n[r].value.split(":")[1]);break}}for(t.tempCurrentLayerNum=t.currentLayerNum.concat(),t.img_pj.skin=Or.getAtlasSubPath("pigTwo/pingji_3.png"),t.img_pj.y=1005,t.img_pj.x=201,t.img_pj.pivotX=63,t.img_pj.pivotY=64,t.img_bar.visible=t.box_pj_ss.visible=t.box_pj_sss.visible=!1,t.firePigArr=t.pdata.getPingJiForKillNum(),t.txt_pingji.text=t.firePigArr.pj,a=0;a<t.firePigArr.layerd;a++)t.tempCurrentLayerNum.shift();t.willPingJi=t.firePigArr.nextPj,t.exp=t.firePigArr.totalExp,t.willKill=t.firePigArr.willKill,t.pj=t.firePigArr.nextPj,t.cpj=t.firePigArr.pj,t.txt_desc.innerHTML=ed.n[1525]+t.willKill+"</font>"+ed.n[1526]+t.willPingJi+ed.n[1527]+ed.n[1528]+t.exp+ed.n[1529],null==t._circle&&(t._circle=new rn,t.img_bar.mask=t._circle),t.showInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),Y.timer.clearAll(t),t.killImageNum&&(t.killImageNum.num=0,t.killImageNum.destr(),t.killImageNum.removeSelf(),t.killImageNum=null),t.img_bar.mask=null,t._circle=null,t.killNum=0,t.btn_bq.off("click",t,t.onClick),On.ins.close("FIRE_PIG_CHANGE"),Vl.ins.clearPowerEffect()},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),Y.timer.clearAll(this)},i.showInfo=function(){this.showCDTime()},i.showSkill=function(e){ti.createEffect("jn10670",e.x,e.y,ac.scene),Y.timer.once(50,this,this.showSkill2,[e]),Y.timer.once(100,this,this.showSkill3,[e])},i.showSkill2=function(e){ti.createEffect("jn10670",e.x-120,e.y-120,ac.scene)},i.showSkill3=function(e){ti.createEffect("jn10670",e.x+120,e.y-120,ac.scene)},i.showPower=function(){var e=this,t=e.img_bar.localToGlobal(new is(e.img_bar.width>>1,e.img_bar.height>>1));Vl.ins.playPower(e.pdata.monsterPoint,t,ms.create(e,e.showPowers),!1)},i.showPowers=function(){this.updatePower(this.currentLayerNum[0])},i.showKillNum=function(){var e=this;e.panel_kill.scaleX=e.panel_kill.scaleY=.9,e.panel_kill.visible=0<e.pdata.killNum,e.killNum!=e.pdata.killNum&&(e.chaNum=e.pdata.killNum-e.killNum),e.showNum()},i.showNum=function(){var e=this;e.killImageNum&&(e.killImageNum.num=e.killNum),0<e.chaNum?Yl.to(e.panel_kill,{scaleX:1.1,scaleY:1.1},100,G.quadIn,ms.create(e,e.onComplete)):(e.killNum=e.pdata.killNum,e.killImageNum&&(e.killImageNum.num=e.killNum))},i.onComplete=function(){var e=this;this.chaNum--,Yl.to(this.panel_kill,{scaleX:.9,scaleY:.9},70,G.quadInOut,ms.create(this,function(){e.showNum()})),this.killImageNum&&(this.killImageNum.num=this.killNum++)},i.showCDTime=function(){var e=this,t=uo.getIndex(ha.ins.curCopyId);e.totalTime=uo.MODEL.duration(t),Y.timer.loop(1e3,e,e.showTimerCD),Y.timer.loop(2e3,e,e.showKillNum)},i.showTimerCD=function(){if(Bd.ins.killNum>=Bd.ins.currentLayMaxNum)return Bs.stop(),Y.timer.clear(this,this.showTimerCD),void Y.timer.once(400,this,function(){Fl.sendToModule("OPEN_FIRE_PIG_RESULT",["modules.copy.CopyModule"])});this.totalTime--,this.txt_time.text=V.getTickMS(this.totalTime),this.totalTime<=0&&(Bs.stop(),Y.timer.clear(this,this.showTimerCD),Fl.sendToModule("OPEN_FIRE_PIG_RESULT",["modules.copy.CopyModule"]))},i.updatePower=function(e){var t=this;if(null!=t.img_bar&&null!=t._circle){var i=(t.pdata.killNum-t.currentLvNeedKillNum)/(e-t.currentLvNeedKillNum)*180;if((i=180<i?180:i)<=0)t.img_pj.visible=!1;else if(t.img_bar.visible=!0,180<=i)t.img_bar.mask=t._circle,t._circle.graphics.clear(),t._circle.graphics.drawPie(t.img_bar.width>>1,t.img_bar.height>>1,52,-90,-90,"#000000"),t._circle.repaint(),t.currentLvNeedKillNum=t.currentLayerNum.shift(),t.showPingJi();else{t.currentLayerNum.length>t.tempCurrentLayerNum.length?t.txt_desc.innerHTML=ed.n[1530]+(t.willKill-t.pdata.killNum)+"</font>"+ed.n[1526]+t.willPingJi+ed.n[1527]+ed.n[1528]+t.exp+ed.n[1529]:(t.txt_pingji.text=t.cpj,t.txt_desc.innerHTML=ed.n[1535]+(e-t.pdata.killNum)+"</font>"+ed.n[1536]+t.pj+ed.n[1537]+ed.n[1528]+t.exp+ed.n[1529]);var s=i/180*360;t.img_bar&&t._circle&&(t.img_bar.mask=t._circle,t._circle.graphics.clear(),t._circle.graphics.drawPie(t.img_bar.width>>1,t.img_bar.height>>1,52,-90,s-90,"#000000"),t._circle.repaint())}}},i.showPingJi=function(){var e=this;e.tween&&e.tween.clear(),e.tween=null,5==e.currentLayerNum.length?(e.pdata.killNum>=e.pdata.toc22016.maxNum&&(e.exp+=e.getExpByLv(5,3),e.pj="B",e.cpj="C"),e.showPjSkin(3),e.img_pj.y=1005,e.img_pj.x=201):4==e.currentLayerNum.length?(e.pdata.killNum>=e.pdata.toc22016.maxNum&&(e.exp+=e.getExpByLv(4,2),e.pj="A",e.cpj="B"),e.showPjSkin(2),e.img_pj.y=1005,e.img_pj.x=208):3==e.currentLayerNum.length?(e.pdata.killNum>=e.pdata.toc22016.maxNum&&(e.exp+=e.getExpByLv(3,1),e.pj="S",e.cpj="A"),e.showPjSkin(1),e.img_pj.y=1005,e.img_pj.x=201):2==e.currentLayerNum.length?(e.pdata.killNum>=e.pdata.toc22016.maxNum&&(e.exp+=e.getExpByLv(2,0),e.pj="SS",e.cpj="S"),e.showPjSkin(0),e.img_pj.y=1005,e.img_pj.x=208):1==e.currentLayerNum.length?(e.pdata.killNum>=e.pdata.toc22016.maxNum&&(e.exp+=e.getExpByLv(1,0),e.pj="SSS",e.cpj="SS"),e.showPjSkin(0),e.box_pj_ss.scaleX=e.box_pj_ss.scaleY=3,e.box_pj_sss.visible=e.img_pj.visible=!1,e.box_pj_ss.visible=!0):(e.cpj="SSS",e.box_pj_sss.scaleX=e.box_pj_sss.scaleY=3,e.box_pj_sss.visible=!0,e.img_pj.visible=e.box_pj_ss.visible=!1,e.txt_pingji.text=e.cpj,e.txt_desc.innerHTML=ed.n[1540]),1==e.img_pj.visible?e.tween=Yl.to(e.img_pj,{scaleX:.55,scaleY:.55},200,G.backIn):1==e.box_pj_ss.visible?e.tween=Yl.to(e.box_pj_ss,{scaleX:1,scaleY:1},200,G.backIn):1==e.box_pj_sss.visible&&(e.tween=Yl.to(e.box_pj_sss,{scaleX:1,scaleY:1},200,G.backIn))},i.getExpByLv=function(e,t){for(var i,s,n=0,o=this.pdata.hash_layer.take(this.pdata.toc22016.layer),a=0;a<o.length;a++){i=vi.MODEL.rewardDef(o[o.length-e]-1),s=JSON.parse(i);for(var r=0;r<s.length;r++)if(4==s[r].value.split(":")[0]){n=parseInt(s[r].value.split(":")[1]);break}}return n},i.showPjSkin=function(e){var t=this;t.img_pj.skin=null,t.img_pj.skin=Or.getAtlasSubPath("pigTwo/pingji_"+e+".png"),t.img_pj.scaleX=t.img_pj.scaleY=3,t.img_pj.visible=!0,t.img_pj.pivotX=63,t.img_pj.pivotY=64},i.onClick=function(){Fl.sendToModule("OPEN_FIRE_PIG_STRONG",["modules.copy.CopyModule"])},t}(),$d=function(e){function t(){var e=this;e._grids=null,e._pigData=null,e.needVIP=0,e.awardsIds=0,e._expAwards=0,e.effect=null,e.image=null,e.goodsStr="",t.__super.call(e),e._pigData=Bd.ins,e._grids=new kl(4,4,116,14),e._grids.isCenter=!0,e._grids.pos(-15,68),e.panel_awards.addChild(e._grids),e.centerX=e.centerY=0}u(t,"modules.copy.views.daily.pigTwo.PigTwoShowAwardsView",Fi);var i=t.prototype;return i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._grids&&t._grids.destroy(e),t._grids=null,t.image&&(t.image.removeSelf(),t.image=null),t.effect&&(t.effect.removeSelf(),t.effect=null),ui.SubPanel.prototype.destroy.call(t,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClickClose),t.btn_lq.on("click",t,t.onClickDouble),t.btn_sb.on("click",t,t.onClickDouble),t.btn_lq.label=ed.n[1541]},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClickClose),t.btn_lq.off("click",t,t.onClickDouble),t.btn_sb.off("click",t,t.onClickDouble)},i.showInfo=function(e){var t=this;if(null!=e){t.awardsIds=e.id;var i=0;t.goodsStr="";var s=[],n=[],o=vi.MODEL.rewardDef(e.id-1);for(s=JSON.parse(o),i=0;i<s.length;i++){var a;if("goods"==s[i].type){var r=s[i].value.split(":")[0],l=s[i].value.split(":")[1];a=an.create(r,l),t.goodsStr+=r+","+l+";",4==r&&(t._expAwards=l)}a&&n.push(a)}t._grids.gridDatas=n,t._grids.x=t.panel_awards.width-t._grids.contentW>>1,-1!=t._pigData.toc22016.currentLayerArr.indexOf(e.id)?t.txt_vip.visible=t.btn_lq.visible=t.btn_sb.visible=!1:(t.btn_lq.visible=t.btn_sb.visible=e.isget,t.txt_vip.visible=e.isget&&Qc.showCharge);var c=vi.MODEL.doubleConditionDef(e.id-1);s=JSON.parse(c),t.needVIP=parseInt(s[0].value),t.txt_vip.text="VIP"+t.needVIP+"可领取",t.height=t.btn_lq.visible?524:404,t.view_tips.y=t.btn_lq.visible?537:417}t.needVIP<=Gi.ins.VIPLevel?(t.btn_lq.visible=!1,t.btn_sb.bottom=60,t.btn_sb.right=192,t.txt_vip.x=188):(t.btn_lq.visible=!0,t.btn_sb.bottom=60,t.btn_sb.right=56,t.txt_vip.x=323),1==t.btn_sb.visible&&1==t.btn_lq.visible&&(null==t.effect&&null==t.effect&&(t.effect=ti.createEffect("jm1382",t.btn_sb.x+t.btn_sb.width/2,t.btn_sb.y+t.btn_sb.height/2-2,null),t.effect.scale_X=.4,t.effect.scale_Y=.9,t.addChild(t.effect),t.effect.mouseEnabled=t.effect.mouseThrough=!1),null==t.image&&(t.image=new Dl(Or.getAtlasSubPath("basic_ui/cz_sc_bq_tj.png")),t.image.x=t.btn_sb.x-40,t.image.y=t.btn_sb.y-30,t.image.mouseEnabled=t.image.mouseThrough=!1,t.addChild(t.image)))},i.onClickClose=function(){On.ins.close("PIG_FIRE_SHOWAWARD")},i.onClickDouble=function(e){var t=this,i=new Object;if(i.type=1,i.awardID=t.awardsIds,i.lv=0,t._pigData.vipExpShow=null,e.target==t.btn_lq)if(Gi.ins.lv<150){var s=t._pigData.getTotalExpByVipLv(t.needVIP);t._pigData.vipExpShow={vipLevel:t.needVIP,Exp:s},i.exp=t._expAwards,i.bei=1,Fl.sendToModule("OPEN_FIRE_PIG_EXP",["modules.copy.CopyModule"],i)}else Od.reqGetAwards(t.awardsIds,1);else e.target==t.btn_sb&&(t.needVIP>Gi.ins.VIPLevel?(Bd.ins.isReturnShaoZhu=!0,Fl.sendToModule("OPEN_PANEL",["modules.vip.VipModule"])):Gi.ins.lv<150?(i.exp=2*t._expAwards,i.bei=2,Fl.sendToModule("OPEN_FIRE_PIG_EXP",["modules.copy.CopyModule"],i)):Od.reqGetAwards(t.awardsIds,2));On.ins.close("PIG_FIRE_SHOWAWARD")},t}(),eu=function(e){function t(){this.data={},this._newW=null,this._oldW=null,t.__super.call(this)}u(t,"modules.copy.views.daily.pigTwo.PigTwoShowExpView",ws);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.fc_lv.value="0",this.fc_exp.value="0"},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Y.timer.clearAll(this)},i.showExp=function(e){var t=this;this.data=e;var i=this.getIsLvAndGetLvByExp(e.exp);1==i[0]?(this.fc_lv.scaleX=4,this.fc_lv.scaleY=4,Yl.to(this.fc_lv,{scaleX:1,scaleY:1},500,G.backIn),this.fc_lv.visible=this.img_lv.visible=!0,this.img_exp.visible=!1,this.fc_lv.value=i[1]+"",Y.timer.once(500,this,function(){t.showExpNum(e.exp.toString())})):(this.fc_lv.visible=this.img_lv.visible=!1,this.img_exp.visible=!0,this.showExpNum(e.exp.toString())),Y.timer.once(1500,this,this.closeThis)},i.closeThis=function(){var e=this;1==e.data.type?Od.reqGetAwards(e.data.awardID,e.data.bei):Od.reqGetZHAwards(e.data.lv),On.ins._closePanelForce(e),null!=Bd.ins.vipExpShow&&Fl.sendToModule("OPEN_FIRE_VIP_EXP",["modules.copy.CopyModule"])},i.getIsLvAndGetLvByExp=function(e){var t=[],i=dr.getIndex(Gi.ins.lv),s=dr.MODEL.exp(i)-Gi.ins.exp;if(s<=e){s=e-s,t[0]=!0;for(var n=i+1,o=0,a=1;n<dr.count&&(o+=dr.MODEL.exp(n))<s;n++)a++;t[1]=a}else t[0]=!1,t[1]=0;return t},i.showExpNum=function(e){var t=this;if(J.isSleep)t.fc_exp.value=e;else{var i=t.fc_exp.value;if(e.length!=i.length)for(var s=0;s<e.length-i.length;s++)i="0"+i;t._newW=e.split(""),t._oldW=i.split(""),t.showPos(0,0),t.showPos(1,0),t.showPos(2,0)}},i.showPos=function(e,t){var i=this,s=i._newW.length-e-1;if(i._newW[s]!=i._oldW[s])i._oldW[s]=t+"",i.fc_exp.value=i._oldW.join(""),Y.timer.once(30,i,i.showPos,[e,t+1],!1);else{if(i.fc_exp.value=i._oldW.join(""),(e+=3)>=i._newW.length)return;Y.timer.once(30,i,i.showPos,[e,0],!1)}},t}(),tu=function(e){function t(){var e=this;e._pigdata=null,e.eff=null,t.__super.call(e),e._pigdata=Bd.ins,e.centerY=-50}u(t,"modules.copy.views.daily.pigTwo.PigTwoShowVipExp",$n);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_fb.on("click",t,t.onClickFbEvent),t.eff=ti.createEffect("jm1242",t.btn_fb.width/2,t.btn_fb.height/2,t.btn_fb),t.btn_fb.addChild(t.eff)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_fb.off("click",t,t.onClickFbEvent),t._pigdata.vipExpShow=null,t.eff&&t.eff.removeSelf(),Y.timer.clearAll(t)},i.onClickFbEvent=function(e){Bd.ins.isReturnShaoZhu=!0,Fl.sendToModule("OPEN_PANEL",["modules.vip.VipModule"])},i.showData=function(){var e=this;null!=e._pigdata.vipExpShow&&(e.fp_vip.value=e._pigdata.vipExpShow.vipLevel+"",e.fp_exp.value=e._pigdata.vipExpShow.Exp+"")},i.closeFunc=function(){On.ins._closePanelForce(this)},t}(),iu=function(e){function t(){var e=this;e.Exit_timer=5,e._grids=null,e._pigData=null,t.__super.call(e),e.centerX=e.centerY=0,e.txt_next.style.leading=15,e.txt_next.style.font="SimHei",e.txt_next.style.fontSize=24,e.txt_next.style.color="#e0d6c1",e.txt_next.style.align="center",e._grids=new kl(3,4),e._grids.isCenter=!0,e._grids.pos(114,600),e.addChildAt(e._grids,2),e._pigData=Bd.ins}u(t,"modules.copy.views.daily.pigTwo.PigTwoSuccess",Tr);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.fcExp.value="0",t.btn_get.on("click",t,t.onClickGet),t.showAwards(),Y.timer.loop(1e3,t,t.onTimer)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_get.off("click",t,t.onClickGet),Y.timer.clearAll(t)},i.showAwards=function(){var e=this,t=!1,i="";e.fcExp.value=Bd.ins.killNum+"";var s=0,n=e._pigData.hash_layer.take(e._pigData.toc22016.layer);for(s=0;s<n.length;s++){var o=vi.MODEL.conditionDef(n[s]-1),a=JSON.parse(o),r=parseInt(a[0].value);if(r>Bd.ins.killNum){t=!0,e.txt_next.innerHTML=ed.n[1542]+(r-Bd.ins.killNum)+ed.n[1543],i=vi.MODEL.rewardDef(n[s]-1);break}}if(0==t&&(e.txt_next.innerHTML=ed.n[1544],i=Qn.MODEL.nextTierReward(e._pigData.toc22016.layer-1)),""!=i){var l,c=JSON.parse(i),d=[];for(s=0;s<c.length;s++)"goods"==c[s].type&&(l=an.create(c[s].value.split(":")[0],c[s].value.split(":")[1])),l&&d.push(l);e._grids.gridDatas=d}else e.txt_next.innerHTML=ed.n[1545]},i.onClickGet=function(e){null!=J.dtoEnterScene&&ha.ins.changeSceneUI(J.dtoEnterScene.type,!1),On.ins._closePanelForce(this),this.event("end"),Y.timer.clear(this,this.onTimer)},i.onTimer=function(){var e=this,t=e.Exit_timer--;if(t<0)return e.event("end"),Y.timer.clear(e,e.onTimer),e.txt_time.text="",null!=J.dtoEnterScene&&ha.ins.changeSceneUI(J.dtoEnterScene.type,!1),void On.ins._closePanelForce(e);e.txt_time.text="("+t+"S)"},t}(),su=function(e){function t(){var e=this;e.icon=null,e._mask=null,e._copyId=0,e.fightT=0,e.raidsT=0,e.runT=0,e.raidsB=!1,e.isZSLevel=!1,e.isNotFirst=!1,t.__super.call(e),e._mask=new rn,e._mask.graphics.drawRect(0,0,e.bar.width,e.bar.height,"#000000"),e.bar.mask=e._mask}u(t,"modules.copy.views.material.CpMaterialItem",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onClick),t.lk_vip.on("click",t,t.onLink)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.runT=0,Y.timer.clear(t,t.loop),Y.timer.clear(t,t.loop1),t.btn_go.off("click",t,t.onClick),t.lk_vip.off("click",t,t.onLink)},i.init=function(){var e=this,t=uo.getIndex(e._copyId);e.txt_name.innerHTML=uo.MODEL.name(t);var i=uo.MODEL.goodsAward(t).split(","),s=0|i[0],n=0|i[1],o=Re.getIndex(s);e.txt_award.changeText("奖励："+Re.MODEL.name(o)),e.txt_num.changeText("数量："+n),e.icon||(e.icon=new ra,ti.replace(e.bg,e.icon));var a=an.create(s,n);e.icon.bindData=a},i.update=function(){var e=this,t=uo.getIndex(e._copyId);e.fightT=rc.MODEL.challengeTimes(Gi.ins.VIPLevel),e.raidsT=rc.MODEL.saodangTimes(Gi.ins.VIPLevel);var i=Ta.MODEL.value(Ta.getIndex(181)).split(";");for(var s in e.isZSLevel=!1,i){var n=i[s].split(",");if(n[0]==e._copyId.toString()&&Gi.ins.zsLv>=parseInt(n[1])){e.isZSLevel=!0;break}}var o=pc.ins.getMaterial(e._copyId);o&&(e.fightT-=o.f,e.raidsT-=o.r,e.isNotFirst=o.isFirst);var a=uo.MODEL.levelLimit(t);Gi.ins.lv>=a?(e.btn_go.visible=!0,e.txt_Lv.visible=!1,e.txt_rest.visible=!0):(e.btn_go.visible=!1,e.txt_Lv.visible=!0,e.txt_Lv.changeText(a+"级开启"),e.txt_rest.visible=!e.txt_Lv.visible);var r=te.ins.datas22352,l=r?r.leftTime:0,c=te.ins.datas22357;if(e.btn_go.showTip=!1,0<e.fightT){if(c&&0<l)-1!=c.idArr.indexOf(e._copyId)?e.btn_go.label="挑 战":e.isNotFirst&&e.isZSLevel?e.btn_go.label="扫 荡":e.btn_go.label="挑 战";else e.btn_go.label="挑 战";e.btn_go.disabled=!1,e.txt_rest.innerHTML=ed.n[1546]+nc.createColor(e.fightT.toString(),"#23b11f")+"次",e.txt_rest.visible=Gi.ins.lv>=a,e.mc_gold.visible=e.mc_bar.visible=e.lk_vip.visible=!1,e.btn_go.showTip=0<e.fightT}else{e.btn_go.label="扫 荡";var d=o.r>=yr.count?yr.count-1:o.r,u=0|yr.MODEL.price(d).split(":")[1];0<e.raidsT?(e.btn_go.disabled=!1,1==r.loginday&&Gi.ins.YB>=u&&(e.btn_go.showTip=!0),e.txt_rest.innerHTML=ed.n[1547]+nc.createColor(e.raidsT.toString(),"#23b11f")+"次",e.txt_rest.visible=Gi.ins.lv>=a,e.lk_vip.visible=!1):(e.btn_go.disabled=!0,e.txt_rest.innerHTML=ed.n[1548],e.lk_vip.visible=Gi.ins.VIPLevel<K.MODEL.key(K.count-1),e.txt_rest.visible=!e.lk_vip.visible),e.txt_cost.changeText(u+""),e.raidsB=Gi.ins.YB>=u,e.mc_gold.visible=!0,e.mc_bar.visible=!1}},i.onClick=function(e){var t=this,i=te.ins.datas22352,s=i?i.leftTime:0,n=te.ins.datas22357;if(0<t._copyId)if(0<t.fightT)if(Wc.isEnabledChangeScene()){if(n)-1!=n.idArr.indexOf(t._copyId)?0<s?(t.runT=Di.getTimer(),t.btn_go.disabled=!0,t.mc_bar.visible=!0,t.btn_go.showTip=!1,pc.ins.isRaiding+=1,Y.timer.loop(20,t,t.loop1),t.loop1()):(t.isNotFirst&&t.isZSLevel,on.reqEntry(t._copyId)):0==pc.ins.isRaiding&&(t.isNotFirst&&t.isZSLevel,on.reqEntry(t._copyId));else t.enterCopy();Pc.ins.playSound("14",3,!0)}else Vl.ins.showById(2076,1);else if(0<t.raidsT){if(!t.raidsB)return void Vl.ins.showById(1004,1);pc.ins.isRaiding+=1,t.runT=Di.getTimer(),t.btn_go.disabled=!0,t.mc_gold.visible=!1,t.mc_bar.visible=!0,Y.timer.loop(20,t,t.loop),t.loop(),t.btn_go.showTip=!1,Pc.ins.playSound("14",3,!0)}},i.enterCopy=function(){this.isNotFirst&&this.isZSLevel,on.reqEntry(this._copyId)},i.onLink=function(e){Fl.sendToModule("OPEN_PANEL",["modules.vip.VipModule"])},i.loop=function(){var e=this,t=Di.getTimer()-e.runT;700<=t?(e.mc_bar.visible=!1,t=0,Y.timer.clear(e,e.loop),ri.ins.mulFly=!0,on.reqRaids(e._copyId),ji.push("CopyReqs.reqRaids")):(e._mask.scaleX=t/700,e._mask.repaint())},i.loop1=function(){var e=this,t=Di.getTimer()-e.runT;700<=t?(e.mc_bar.visible=!1,t=0,Y.timer.clear(e,e.loop1),ri.ins.mulFly=!0,ji.push("TqMonthCardUtil.reqSaoDangCop"),Aa.reqSaoDangCopy(e._copyId)):(e._mask.scaleX=t/700,e._mask.repaint())},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(null!=e&&null!=e&&pc.ins.materialHash){var t=e;this._copyId!=t&&(this._copyId=t,this.init()),this.update()}}),t}(vo),nu=function(e){function s(){var e=this;e.guideArr=[36,37,38,39],s.__super.call(e),e.list.itemRender=su,e.list.vScrollBarSkin="",e.list.scrollBar.elasticDistance=300;for(var t=[],i=0;i<uo.count;i++)1==uo.MODEL.cate(i)&&t.push(uo.MODEL.key(i));e.list.array=t,e.txt_dect.align="left",e.txt_dect.width=400}u(s,"modules.copy.views.material.CpMaterialView",Ve);var t=s.prototype;return t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),on.reqCopy(1),Aa.reqGetCanSweep(1);var i=Zc.getIndex(4220);t.txt_dect.innerHTML=Zc.MODEL.content(i),t.txt_link.on("click",t,t.onLinkClick);for(var s=0;s<t.guideArr.length;s++)if(ln.Ins().hasNewGuide(t.guideArr[s])){t._$9_showGuide(t.guideArr[s],!0);break}},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),pc.ins.isRaiding=0,t.txt_link.off("click",t,t.onLinkClick);for(var i=0;i<t.guideArr.length;i++)if(ln.Ins().hasNewGuide(t.guideArr[i])){t._$9_showGuide(t.guideArr[i],!1);break}},t._$9_showGuide=function(e,t){if(t){if(ln.Ins().hasNewGuide(e)){var i=new qo;switch(e){case 36:i.x=525,i.y=175;break;case 37:i.x=525,i.y=366;break;case 38:i.x=525,i.y=558;break;case 39:i.x=525,i.y=750}i.width=50,i.height=50,Bl.Ins().show(e,i,!1,this)}}else Bl.showing&&Bl.Ins().closeLockArrow(e)},t.updateByVSC=function(e){var t=this;t.list.refresh();var i=te.ins.datas22352;i&&0==i.leftTime?(t.txt_link.visible=!0,t.txt_link.x=t.txt_dect.x+t.txt_dect.contextWidth+20):t.txt_link.visible=!1},t.onLinkClick=function(e){0!=Qc.showCharge&&(On.ins.isOpen("MONTHCARD")||On.ins.open("MONTHCARD",{selectedIndex:3},0))},s}(),ou=function(e){function t(){var e=this;e.glVO=null,t.__super.call(e),e.txt_bsName.style.font="SimHei",e.txt_bsName.style.fontSize=24,e.txt_bsName.style.align="left",e.txt_bsName.style.color="#90877b",e.txt_lv.style.font="SimHei",e.txt_lv.style.fontSize=24,e.txt_lv.style.align="left",e.txt_lv.style.color="#90877b",e.txt_strategy.style.font="SimHei",e.txt_strategy.style.fontSize=24,e.txt_strategy.style.align="left",e.txt_strategy.style.color="#90877b",e.txt_strategy.style.leading=14}u(t,"modules.copy.views.teamcopy.sub.TeamCopyGLItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(null!=e){if(t.glVO=e,!t.glVO)return;t.txt_bsName.innerHTML=t.glVO.bossName,t.txt_lv.innerHTML=t.glVO.bossLv,t.txt_strategy.innerHTML=ed.n[1549]+t.glVO.bossWalkThrough,t.img_head.skin=Or.getBossPath(t.glVO.headRes)}}),t}(Me),au=function(e){function t(){var e=this;e.teamCopyVO=null,e.teamData=null,e.isActived=!1,e.awardsArr=[],t.__super.call(e),e.txt_descc.style.font="SimHei",e.txt_descc.style.align="left",e.txt_descc.style.color="#90877b",e.txt_descc.style.fontSize=24,e.txt_descc.style.leading=8,e.panel_awards.hScrollBarSkin="",e.panel_awards.hScrollBar.elasticBackTime=300,e.panel_awards.hScrollBar.elasticDistance=100,e.teamData=Vr.ins}u(t,"modules.copy.views.teamcopy.sub.TeamCopyItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_go.on("click",t,t.onClickGo),t.txt_gl.on("click",t,t.onClickGongLue)},i.onRemove=function(e){var t=this;for(ui.ViewBase.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onClickGo),t.txt_gl.off("click",t,t.onClickGongLue);0<t.awardsArr.length;){var i=t.awardsArr.shift();null!=i.parent&&i.parent.removeChild(i),i=null}},i.onClickGo=function(e){this.isActived?Fl.sendToModule("OPEN_TEAM_COPY_CROOM",["modules.copy.CopyModule"],{vo:this.teamCopyVO}):(this.teamData.nextRefreshTime-J.curServerTime)/1e3<=7200?Vl.ins.showMsg(ed.n[1550],1):Vl.ins.showMsg(ed.n[1551],1)},i.onClickGongLue=function(e){Fl.sendToModule("OPEN_TEAM_COPY_GONGLUE",["modules.copy.CopyModule"],{gonglueIDS:this.teamCopyVO.walkthroughIDS})},i.showAwards=function(e){if(e){var t,i=0,s=JSON.parse(e);if(s)for(i=0;i<s.length;i++){this.awardsArr.length>i?t=this.awardsArr[i]:((t=new l).size(80,80),t._simpleName=!0,t._nameVisible=!0,t._nameY=91,t._nameFont="20px SimHei",this.awardsArr.push(t));var n=parseInt(s[i].value.split(":")[0]),o=parseInt(s[i].value.split(":")[1]);t.bindData=an.create(n,o),t.x=95*i+10,t.y=10,null==t.parent&&this.panel_awards.addChild(t)}}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(null!=e){if(t.teamCopyVO=e,!t.teamCopyVO)return;if(t.img_copyName.skin=Or.getAtlasSubPath("teamCopy/"+t.teamCopyVO.copyNameRes+".png"),t.teamCopyVO.copyBgRes)for(var i=t.teamCopyVO.copyBgRes.split(","),s=0;s<i.length;s++)t["img_bg"+s].skin=Or.getTeamCopyBGPath(i[s],".jpg");t.txt_descc.innerHTML=t.teamCopyVO.copyDesc,t.img_bossHead.skin=Or.getBossPath(t.teamCopyVO.bossHeadRes),t.txt_name.text=t.teamCopyVO.bossName,t.showAwards(t.teamCopyVO.copyAwards),t.txt_gl.visible=!0;var n="";t.teamData.currentCopyID>=t.teamCopyVO.key?(t.txt_gl.visible=!1,n="zd_bq_ytg",t.isActived=t.btn_go.visible=!1):t.teamData.currentCopyID+1==t.teamCopyVO.key?(n="zd_bq_ktz",t.isActived=t.btn_go.visible=!0,t.btn_go.gray=!1,(t.teamData.nextRefreshTime-J.curServerTime)/1e3<=7200&&(t.isActived=!1,t.btn_go.visible=t.btn_go.gray=!0)):(n="zd_bq_wjh",t.btn_go.gray=t.btn_go.visible=!0,t.isActived=!1),t.img_state.skin=Or.getAtlasSubPath("teamCopy/"+n+".png")}}),t}(Us),ru=function(e){function t(){this.vo=null,t.__super.call(this),this.btn.selected=!1}u(t,"modules.copy.views.teamcopy.sub.TeamCopyMonsterAttackListItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.vo=null,laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_state.visible=!1,t.on("click",t,t.onGoClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onGoClicked)},i.onGoClicked=function(e){Bs.fights(this.vo.objectId),zr.attackSelect=null,Vr.attackMonsterSelect=this.vo,Fl.sendToModule("ATTACK_MONSTER_LIST_SELECT",["modules.copy.CopyModule"],this.vo)},i.onSelectItem=function(e){this.btn.selected=e},i.showFightting=function(e){this.txt_state.visible=this.btn.selected=e},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.vo=e,t.vo){var i=Xl.getIndex(t.vo.bossid),s=Xl.MODEL.type(i);t.tx_name.text=Xl.MODEL.name(i);var n=Xl.MODEL.muId(i);i=Cs.getIndex(n),t.head.skin=Or.getBossPath(Cs.MODEL.headId(i)),102==s?(t.head.scaleX=t.head.scaleY=.7,t.btn.scaleX=t.btn.scaleY=.7):(t.head.scaleX=t.head.scaleY=.8,t.btn.scaleX=t.btn.scaleY=.8)}}),t}(y),lu=function(e){function t(){var e=this;e._data=null,e.ac=null,e.teamData=null,e._info=null,e.ind=1,t.__super.call(e),e.teamData=Vr.ins}u(t,"modules.copy.views.teamcopy.sub.TeamCopyRoomItem",Ll);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_out.on("click",this,this.onClickBtnOut)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.setOptionSkin=function(e){this.img_option.skin=2==e?Or.getAtlasSubPath("teamCopy/zd_zd_dysc.png"):Or.getAtlasSubPath("teamCopy/zd_zd_dytj.png")},i.showRoleInfo=function(e,t){var i=this;if(null==(i._info=t))i.btn_add.visible=i.btn_out.visible=!1,i.img_role.visible=!0,i.initHead(!1);else{if(i.img_role.visible=i.btn_add.visible=!1,i.btn_out.visible=!0,i.initHead(!0),null==i.ac&&(i.ac=new Wi),null==i.ac.parent){var s=i.getChildIndex(i.img_role);i.addChildAt(i.ac,s)}i.ac.changeAvatar(t.sex,t.weapon,t.avatar,t.wing),i.fc_fight.value=t.fightValue,i.txt_name.text=t.name,e?(i.ac.scale(.7,.7),i.btn_out.visible=i.btn_add.visible=!1,i.img_team.skin=Or.getAtlasSubPath("teamCopy/zd_zd_dz.png")):(i.ac.scale(.6,.6),i.img_team.skin=Or.getAtlasSubPath("teamCopy/zd_zd_dy.png")),i.setX()}},i.setActorPos=function(e,t){this.ac.pos(e,t)},i.onClickBtnOut=function(e){var t=this;t.teamData.teamCopyData&&1==t.btn_out.visible&&null!=t._info&&t.teamData.teamCopyData.teamLeaderID.toString()==Gi.ins.charId&&t.teamData.lickPlayer(t._info.playerID)},i.initHead=function(e){this.img_team.visible=this.txt_name.visible=this.img_fight.visible=this.fc_fight.visible=e},i.setX=function(){var e=this;e.img_team.x=(e.width-e.txt_name.textWidth)/2-32,e.img_fight.x=(e.width-24*(e.fc_fight.value.length+1)*.7>>1)-25,e.fc_fight.x=e.width-24*e.fc_fight.value.length*.7+45>>1},n(0,i,"data",function(){return this._data},function(e){null==(this._data=e)&&(this.btn_add.visible=this.btn_out.visible=!1,this.img_role.visible=!0,this.initHead(!1),this.ac&&this.ac.parent&&(this.ac.parent.removeChild(this.ac),this.ac=null))}),t}(),cu=function(e){function t(){var e=this;e.teamData=null,e.yaoqingVO=null,e.cdTime=0,t.__super.call(e),e.teamData=Vr.ins,e.img_head.x=8,e.img_head.y=17}u(t,"modules.copy.views.teamcopy.sub.TeamCopyYaoQingItem",e);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_yaoqing.on("click",this,this.onClickYaoQing)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_yaoqing.off("click",this,this.onClickYaoQing)},i.onClickYaoQing=function(e){var t=this;1!=t.btn_yaoqing.gray?(Vr.ins.reqYaoQingToPlayer(t.yaoqingVO.playerID,t.yaoqingVO.type),t.btn_yaoqing.gray=!0,t.btn_yaoqing.label="已邀请",t.cdTime=J.curServerTime+1e3*Ze.MODEL.inviteCD(0),t.teamData.YaoQingCDList.put(t.yaoqingVO.playerID,t.cdTime),Y.timer.loop(1e3,t,t.onTimer)):Vl.ins.showMsg(ed.n[1552],1)},i.onTimer=function(){var e=this;if(e.cdTime-J.curServerTime<=0)return Y.timer.clearAll(e),e.btn_yaoqing.gray=!1,e.teamData.YaoQingCDList.remove(e.yaoqingVO.playerID),void(e.btn_yaoqing.label="邀 请");e.btn_yaoqing.gray=!0,e.btn_yaoqing.label="已邀请"},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(null!=e){if(t.yaoqingVO=e,!t.yaoqingVO)return;t.teamData.YaoQingCDList.has(t.yaoqingVO.playerID)&&(t.cdTime=t.teamData.YaoQingCDList.proto[t.yaoqingVO.playerID],1e3<t.cdTime-J.curServerTime?(t.btn_yaoqing.gray=!0,t.btn_yaoqing.label="已邀请",Y.timer.loop(1e3,t,t.onTimer)):(t.btn_yaoqing.gray=!1,t.btn_yaoqing.label="邀 请",Y.timer.clearAll(t))),1==t.yaoqingVO.type?(t.txt_zw.text="",t.txt_name.x=128):(t.txt_zw.text="["+bi.getCNPos(t.yaoqingVO.lv)+"]",t.txt_name.x=201),t.img_vip.visible=1==t.yaoqingVO.isVip,t.img_head.skin=Or.getActorHeadPath(t.yaoqingVO.career,t.yaoqingVO.sex),t.txt_name.text=t.yaoqingVO.playerName,t.txt_ml.text=ed.n[1553]+t.yaoqingVO.meiliValue,t.txt_fight.text=ed.n[1554]+t.yaoqingVO.fightValue}}),t}(ba),du=function(e){function t(){var e=this;e.teamData=null,e.teamVO=null,e.actorRole_member1=null,e.actorRole_member2=null,e.actorRole_Leader=null,e._infoUI=null,e.startCD=0,t.__super.call(e),e.teamData=Vr.ins,e.centerY=e.centerX=0,e.panel_awards.hScrollBarSkin="",e.panel_awards.hScrollBar.elasticBackTime=300,e.panel_awards.hScrollBar.elasticDistance=100,e.txt_startCD.text="",e.txt_time.width=600}u(t,"modules.copy.views.teamcopy.TeamCopyChallageView",A);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_go.visible=!1,t.btn_go.on("click",t,t.onClickGo),t.btn_out.on("click",t,t.onClickOut),t.btn_close.on("click",t,t.onClickOut),t._infoUI=Fr.ins,Qe.ins.changeChannel(0),t._infoUI.x=60,t._infoUI.y=t.height-100,t._infoUI.width=t.width-100,t._infoUI.height=70,t._infoUI.refresh(),t._infoUI.vScrollBar.value=t._infoUI.vScrollBar.max,t._infoUI.parent&&t._infoUI.parent==t||(t.on("click",t,t.onClickOpenChar),t.addChild(t._infoUI))},i.onClickOpenChar=function(e){e.target instanceof modules.chat.views.ChatRecord&&On.ins.open("CHAT")},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_go.off("click",t,t.onClickGo),t.btn_out.off("click",t,t.onClickOut),Nn.ins.showCompoment("ChatSimpleUI"),t.actorRole_member1&&t.actorRole_member1.btn_add.off("click",t,t.onClickBtnAdd),t.actorRole_member2&&t.actorRole_member2.btn_add.off("click",t,t.onClickBtnAdd),Y.timer.clear(t,t.onTimerForChallage),Y.timer.clear(t,t.onTimer),Y.timer.clearAll(t),t._infoUI&&t._infoUI.parent&&t._infoUI.parent==t&&(t.off("click",t,t.onClickOpenChar),t._infoUI.removeSelf())},i.showChat=function(){var e=this;e._infoUI.lock=!1,On.ins.isOpen("CHAT")||e._infoUI.parent&&e._infoUI.parent==e||(e._infoUI.x=60,e._infoUI.y=e.height-100,e._infoUI.width=e.width-100,e._infoUI.height=70,e._infoUI.refresh(),e._infoUI.vScrollBar.value=e._infoUI.vScrollBar.max,e.addChild(e._infoUI))},i.createTeamInfo=function(e){var t=this;null!=e&&(t.teamVO=e,t.img_title.skin=Or.getAtlasSubPath("teamCopy/"+t.teamVO.copyNameRes+".png"),t.showAwards(t.teamVO.copyAwards),t.teamData.reqCreateTeam(t.teamVO))},i.updateNextRefreshTime=function(){var e=this;e.teamData.nextRefreshTime-J.curServerTime<=0?(e.txt_time.text=ed.n[1555],Y.timer.clear(e,e.onTimerForChallage)):(e.txt_time.text=ed.n[1556]+V.getDHM((e.teamData.nextRefreshTime-J.curServerTime)/1e3)+")",Y.timer.loop(1e3,e,e.onTimerForChallage))},i.setLeaderInfo=function(e){var t=this;null!=t.teamData.teamCopyData&&(null==t.actorRole_Leader&&(t.actorRole_Leader=new lu),null==t.actorRole_Leader.parent&&t.addChild(t.actorRole_Leader),t.actorRole_Leader.showRoleInfo(!0,t.teamData.teamCopyData),t.actorRole_Leader.pos(260,180),t.actorRole_Leader.setActorPos(-400,-40),t.teamData.teamCopyID=t.teamData.teamCopyData.copyID,t.teamData.currentCopyID<t.teamData.teamCopyID?t.teamData.isAssist=!1:t.teamData.isAssist=!0);var i=hr.getIndex(e.copyID);t.img_title.skin=Or.getAtlasSubPath("teamCopy/"+hr.MODEL.copyNameRes(i)+".png"),t.showAwards(hr.MODEL.copyAwards(i));for(var s=[],n=0;n<e.mumberList.length;n++)e.mumberList[n].playerID!=e.teamLeaderID&&s.push(e.mumberList[n]);null==t.actorRole_member1&&(t.actorRole_member1=new lu),null==t.actorRole_member1.parent&&t.addChild(t.actorRole_member1),t.actorRole_member1.data=null,t.actorRole_member1.pos(70,100),null==t.actorRole_member2&&(t.actorRole_member2=new lu),null==t.actorRole_member2.parent&&t.addChild(t.actorRole_member2),t.actorRole_member2.data=null,t.actorRole_member2.pos(420,100),t.actorRole_member1.btn_add.on("click",t,t.onClickBtnAdd),t.actorRole_member2.btn_add.on("click",t,t.onClickBtnAdd),t.btn_go.visible=!0,t.actorRole_member2.btn_add.visible=t.actorRole_member1.btn_add.visible=!0,t.actorRole_member1.setOptionSkin(1),t.actorRole_member2.setOptionSkin(1),t.showautoStart(e.mumberList.length),t.setRoleInfo(s,e.teamLeaderID,!0)},i.changeTeamInfo=function(e){for(var t=[],i=0;i<e.mumberList.length;i++)e.mumberList[i].playerID!=e.teamLeaderID&&t.push(e.mumberList[i]);this.setRoleInfo(t,e.teamLeaderID,!0),this.showautoStart(e.mumberList.length)},i.showMemberInfo=function(e){for(var t=this,i=[],s=0;s<e.mumberList.length;s++)e.mumberList[s].playerID==e.teamLeaderID?(null==t.actorRole_Leader&&(t.actorRole_Leader=new lu),null==t.actorRole_Leader.parent&&t.addChild(t.actorRole_Leader),t.actorRole_Leader.showRoleInfo(!0,e.mumberList[s]),t.actorRole_Leader.pos(260,180),t.actorRole_Leader.setActorPos(-400,-40)):i.push(e.mumberList[s]);t.setRoleInfo(i,e.teamLeaderID);var n=hr.getIndex(e.copyID);t.img_title.skin=Or.getAtlasSubPath("teamCopy/"+hr.MODEL.copyNameRes(n)+".png"),t.showAwards(hr.MODEL.copyAwards(n)),t.showautoStart(e.mumberList.length),t.teamData.currentCopyID<e.copyID?t.teamData.isAssist=!1:t.teamData.isAssist=!0},i.showautoStart=function(e){var t=this;3<=e?(t.startCD=Ze.MODEL.autoStartCD(0),Y.timer.loop(1e3,t,t.onTimer)):(Y.timer.clear(t,t.onTimer),t.txt_startCD.text="",t.startCD=0)},i.setRoleInfo=function(e,t,i){var s=this;void 0===i&&(i=!1);var n=t==parseInt(Gi.ins.charId);1<=e.length&&(null==s.actorRole_member1&&(s.actorRole_member1=new lu),null==s.actorRole_member1.parent&&s.addChild(s.actorRole_member1),s.actorRole_member1.showRoleInfo(!1,e[0]),s.actorRole_member1.pos(70,100),s.actorRole_member1.setActorPos(-326,-20),s.actorRole_member1.btn_add.visible=!1,(s.actorRole_member1.btn_out.visible=n)&&s.actorRole_member1.setOptionSkin(2)),2<=e.length&&(null==s.actorRole_member2&&(s.actorRole_member2=new lu),null==s.actorRole_member2.parent&&s.addChild(s.actorRole_member2),s.actorRole_member2.showRoleInfo(!1,e[1]),s.actorRole_member2.btn_add.visible=!1,(s.actorRole_member2.btn_out.visible=n)&&s.actorRole_member2.setOptionSkin(2),s.actorRole_member2.pos(420,100),s.actorRole_member2.setActorPos(-326,-20)),0==e.length&&s.actorRole_member1&&(s.actorRole_member1.data=null,(s.actorRole_member1.btn_add.visible=n)&&s.actorRole_member1.setOptionSkin(1),s.actorRole_member1.parent&&0==i&&(s.actorRole_member1.parent.removeChild(s.actorRole_member1),s.actorRole_member1=null)),1==e.length&&s.actorRole_member2&&(s.actorRole_member2.data=null,(s.actorRole_member2.btn_add.visible=n)&&s.actorRole_member2.setOptionSkin(1),s.actorRole_member2.parent&&0==i&&(s.actorRole_member2.parent.removeChild(s.actorRole_member2),s.actorRole_member2=null))},i.onClickBtnAdd=function(e){this.teamData.teamCopyData&&this.teamData.teamCopyData.teamLeaderID.toString()==Gi.ins.charId&&Fl.sendToModule("OPEN_TEAM_COPY_SEND_YQ",["modules.copy.CopyModule"])},i.showAwards=function(e){var t,i=0,s=JSON.parse(e);for(i=0;i<s.length;i++){(t=new l).size(110,110),t._simpleName=!0,t._nameVisible=!0,t._nameY=116;var n=parseInt(s[i].value.split(":")[0]),o=parseInt(s[i].value.split(":")[1]),a=an.create(n,o);a.needGetWay=!1,t.bindData=a,t.x=140*i+27,t.y=10,this.panel_awards.addChild(t)}},i.onClickOut=function(e){Fl.sendToModule("OPEN_TEAM_COPY_EXIT",["modules.copy.CopyModule"],{tips:"是否确定离开当前队伍？"})},i.onClickGo=function(e){Y.timer.clear(this,this.onTimer),Y.timer.clearAll(this),this.teamData.reqCopyStart()},i.onTimer=function(){var e=this;if(e.startCD<=0)return 1==e.btn_go.visible&&e.teamData.reqCopyStart(),void Y.timer.clear(e,e.onTimer);e.startCD--,e.txt_startCD.text="["+e.startCD+ed.n[1557]},i.onTimerForChallage=function(){var e=this;e.teamData.nextRefreshTime-J.curServerTime<=0?Y.timer.clear(e,e.onTimerForChallage):e.txt_time.text=ed.n[1558]+V.getDHM((e.teamData.nextRefreshTime-J.curServerTime)/1e3)+")"},t}(),uu=function(e){function t(){var e=this;e.teamCopyData=null,t.__super.call(e),e.teamCopyData=Vr.ins,e.list_item.itemRender=ou,e.list_item.vScrollBarSkin="",e.list_item.scrollBar.elasticDistance=300,e.list_item.spaceY=10,e.list_item.height=668,e.list_item.pos(35,87),e.list_item.dataSource=[],e.centerX=e.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopyGongLueView",kr);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickEvent)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickEvent)},i.showGongLueInfo=function(e){this.list_item.dataSource=this.teamCopyData.getGongLueInfo(e)},i.onClickEvent=function(e){On.ins.close("TEAM_COPY_GONGLUE")},t}(),hu=function(e){function t(){this._teamUUID=0,t.__super.call(this),this.centerX=0,this.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopyHelpView",cs);var i=t.prototype;return i.initialize=function(){var e=this;e.cb_noremind.selected=!1,e.txt_des.style.font="SimHei",e.txt_des.style.fontSize=28,e.txt_des.style.color="#e0d6c1",e.txt_des.style.align="center",e.txt_des.style.leading=14},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onRefuse),t.btn_go.on("click",t,t.onChallenge),t.cb_noremind.on("click",t,t.setRemind)},i.onRemove=function(e){var t=this;t.img_bosshead&&t.img_bosshead.skin&&Y.loader.clearRes(t.img_bosshead.skin),ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onRefuse),t.btn_go.off("click",t,t.onChallenge),t.cb_noremind.off("click",t,t.setRemind)},i.updateLabel=function(e){this._teamUUID=e.teamUUID;var t=e.name,i=hr.getIndex(e.copyId),s=hr.MODEL.copyName(i),n="";n=1==e.type?ed.n[1559]:ed.n[1560],this.txt_des.innerHTML=n+nc.createColor(t,"#02b0e9")+ed.n[1561]+nc.createColor(s,"#ffb11a")+"副本!",this.img_bosshead.skin=Or.getNoClearImage("xt_zdfb")},i.setRemind=function(){Vr.ins.noShow=this.cb_noremind.selected},i.onChallenge=function(e){Wc.isEnabledChangeScene()?(Vr.ins.checkSelfHasTeam()?Vl.ins.showMsg(ed.n[1562],1):Vr.ins.enterTeam(this._teamUUID),On.ins.close("TEAM_COPY_ACCEPT")):Vl.ins.showById(2126,1)},i.onRefuse=function(e){On.ins.close("TEAM_COPY_ACCEPT")},t}(),_u=function(e){function i(){var e=this;e.teamcopyData=null,e.g_cost=null,i.__super.call(e),e.teamcopyData=Vr.ins,e.teamcopyData.getTeamCopyList(),e.list_team.itemRender=au,e.list_team.vScrollBarSkin="",e.list_team.scrollBar.elasticDistance=300,e.list_team.spaceY=4,e.list_team.dataSource=[],e.g_cost=new ra(45),e.g_cost.needGridBg=!1,e.g_cost.needEffect=!1,e.g_cost.pos(e.txt_des.x+105,e.txt_des.y-10),e.addChild(e.g_cost);var t=an.create(2370);e.g_cost.bindData=t}u(i,"modules.copy.views.teamcopy.TeamCopyMainView",_a);var t=i.prototype;return t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_desc.on("click",t,t.onClickDesc),t.txt_desc.on("click",t,t.onClickDesc),t.list_team.scrollBar.on("change",t,t.onScrollChanged),t.teamcopyData.reqCopyInfo()},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_desc.off("click",t,t.onClickDesc),t.txt_desc.off("click",t,t.onClickDesc),t.list_team.scrollBar.off("change",t,t.onScrollChanged),Y.timer.clear(t,t.onCDTimer),Y.timer.clearAll(t)},t.updateView=function(){var e=this;e.list_team.dataSource=e.teamcopyData.teamCopyList,e.list_team.scrollBar.value=314*(e.teamcopyData.currentCopyID-1),(e.teamcopyData.nextRefreshTime-J.curServerTime)/1e3<=0?(e.txt_resetTime.text="已刷新",Y.timer.clear(e,e.onCDTimer),Y.timer.clearAll(e)):(e.txt_resetTime.text=ed.n[1563]+e.setTime((e.teamcopyData.nextRefreshTime-J.curServerTime)/1e3),Y.timer.loop(1e3,e,e.onCDTimer));var t=parseInt(Ta.MODEL.value(Ta.getIndex(313)));e.txt_times.text=e.teamcopyData.assistAward+"/"+t,e.teamcopyData.assistAward,e.txt_times.color="#28b11f"},t.onClickDesc=function(e){var t=Ze.MODEL.copyWalkThrough(0);On.ins.open("AE_EXPLAIN_VIEW",{desc:t})},t.onCDTimer=function(){var e=this;(e.teamcopyData.nextRefreshTime-J.curServerTime)/1e3<=0?(e.teamcopyData.reqCopyInfo(),e.txt_resetTime.text="已刷新",Y.timer.clear(e,e.onCDTimer),Y.timer.clearAll(e)):e.txt_resetTime.text=ed.n[1563]+e.setTime((e.teamcopyData.nextRefreshTime-J.curServerTime)/1e3)},t.onScrollChanged=function(){var e=this;0==e.list_team.scrollBar.max||e.list_team.scrollBar.value>=e.list_team.scrollBar.max?e.g_mask.visible=!1:e.g_mask.visible=!0},t.setTime=function(e){var t=Math.floor(e/86400),i=Math.floor((e-86400*t)/3600),s=Math.floor((e-86400*t-3600*i)/60);return 1<=t?t+"天":i+"时"+s+"分"},i}(),pu=function(e){function t(){var e=this;e.teamData=null,t.__super.call(e),e.teamData=Vr.ins,e.centerX=e.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopyOutView",Ui);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClickSure),t.btn_sure.on("click",t,t.onClickSure),t.btn_cancel.on("click",t,t.onClickSure)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showText=function(e){this.txt_yaoqing.text=e},i.onClickSure=function(e){e.target==this.btn_sure&&(this.teamData.teamCopyData&&this.teamData.teamCopyData.teamLeaderID.toString()==Gi.ins.charId?Vr.ins.reqJieSanTeam():Vr.ins.reqOutTeam()),On.ins.close("TEAM_COPY_OUT")},t}(),fu=function(e){function t(){var e=this;e.teamData=null,t.__super.call(e),e.teamData=Vr.ins,e.list_item.itemRender=cu,e.list_item.vScrollBarSkin="",e.list_item.scrollBar.elasticDistance=300,e.list_item.spaceY=16,e.list_item.dataSource=[],e.centerX=e.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopyQaoQingListView",ie);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickClose)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.showListInfo=function(){this.list_item.dataSource=this.teamData.yaoQingMemberList},i.reqYaoQingInfo=function(e){this.img_title.skin=1==e?Or.getAtlasSubPath("teamCopy/zd_text_yqhy.png"):Or.getAtlasSubPath("teamCopy/zd_text_yqghcy.png"),this.teamData.reqYaoQingFriendOrGuildMember(e)},i.onClickClose=function(e){On.ins.close("TEAM_COPY_YAOQINGLIST")},i.onSortList=function(e,t){var i=0;return e.fightValue>t.fightValue?i=-1:e.fightValue==t.fightValue?i=e.meiliValue>t.meiliValue?-1:e.meiliValue==t.meiliValue?0:1:e.fightValue<t.fightValue&&(i=1),i},t}(),gu=function(e){function t(){var e=this;e.modelData=null,e._callback=null,e._grids=null,e.cdTime=5,t.__super.call(e),e._grids=new kl(1,4,116,10,30,!0,null,10),e._grids.pos(110,520),e.addChild(e._grids),e.img_role1.skin=e.img_role2.skin=null,e.modelData=Vr.ins}u(t,"modules.copy.views.teamcopy.TeamCopyResultView",Ns);var i=t.prototype;return i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clear(t,t.onTimer),Y.timer.clearAll(t),t._callback&&(t._callback.run(),t._callback=null)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_out.on("click",this,this.onClickOut)},i.showResult=function(e,t){var i,s=this,n=1;if(s.box_des.visible=!0,0<s.modelData.teamMemberHash.length)for(var o in s.modelData.teamMemberHash.proto)(i=s.modelData.teamMemberHash.proto[o]).playerID==i.LeaderID.toString()?(s.img_leader.skin=Or.getActorHeadPath(i.career,i.sex),s.txt_name.innerHTML=i.name):(s["img_role"+n].skin=Or.getActorHeadPath(i.career,i.sex),s["txt_role"+n].innerHTML=i.name,n++);else if(s.modelData.teamCopyData&&s.modelData.teamCopyData.playerID.toString()==Gi.ins.charId){var a=Gi.ins.actorList[0];s.img_leader.skin=Or.getActorHeadPath(a.job,a.sex),s.txt_name.innerHTML=Gi.ins.charName}var r,l,c=[],d=0,u=0;for(l in e)(i=e[l])instanceof protos.backpack.DtoGoods?c.push(i):(d=i.modelId,u=i.count,r=an.create(d,u),c.push(r));if(1==s.modelData.isAssist){var h=parseInt(Ta.MODEL.value(Ta.getIndex(313)));s.modelData.assistAward>=h?s.txt_nohad.visible=!0:s.txt_nohad.visible=!1,s.box_des.visible=!1}else s.txt_nohad.visible=!1,s.box_des.visible=!0;s._grids.gridDatas=c,s._callback=t,s.txt_Time.innerHTML="("+s.cdTime+ed.n[1565],Y.timer.loop(1e3,s,s.onTimer)},i.onTimer=function(){var e=this;if(e.cdTime--,e.cdTime<=0)return Y.timer.clear(e,e.onTimer),Y.timer.clearAll(e),e._callback&&(e._callback.run(),e._callback=null),void On.ins.close("TEAM_COPY_RESULT");e.txt_Time.innerHTML="("+e.cdTime+ed.n[1565]},i.onClickOut=function(e){On.ins.close("TEAM_COPY_RESULT")},t}(),vu=function(e){function t(){var e=this;e.modelData=null,e.cdTime=0,t.__super.call(e),e.modelData=Vr.ins,e.list.itemRender=ru,e.list.dataSource=[],e.list.width=560,e.list.height=139,e.list.spaceX=-30,e.list.hScrollBarSkin="",e.list.vScrollBarSkin="",e.list.isDisableScrollBar=!0,e.centerX=e.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopySceneView",Xs);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),Bs.startInstantFight(),t.txt_time.innerHTML="",t.showTeamInfo(),t.showCD(),t.box_team.visible=!1,t.txt_gonglue.on("click",t,t.onClickGL)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clear(t,t.showTimerCD),Y.timer.clearAll(t),t.txt_gonglue.off("click",t,t.onClickGL)},i.showSceneMonster=function(e){var t=this;t.clearSelected(),t.list.dataSource=e.list,t.list.visible=0<e.list.length,5<e.list.length?t.list.x=20+(t.width-600>>1):t.list.x=20+(t.width-120*e.list.length>>1),t.list.refresh();for(var i=0;i<e.list.length;i++){var s=Xl.getIndex(e.list[i].bossid);if(202==Xl.MODEL.type(s)){Vl.ins.playRainbowByWords(ed.n[1567]);break}}},i.updateActorHP=function(e){var t,i=this,s=e.memberHPList,n=1;if(0<s.length)for(var o in s.proto)if(t=s.proto[o],o!=Gi.ins.charName){i["role"+n].skin=Or.getActorHeadPath(t.career,t.sex),i["txt_name"+n].changeText(t.name),i["role"+n].visible=!0,i["bar_bg"+n].visible=i["txt_name"+n].visible=!0;var a=i["bar"+n],r=i["revive"+n],l=a.scrollRect||new qo(0,0,a.width,a.height);if(l.width=a.width*(t.currentHp/t.maxHp),a.scrollRect=l,i["role"+n].gray=!(0<t.currentHp),i["img_fight"+n].visible=0<t.currentHp,r.visible=!(0<t.currentHp),0<t.currentHp);else{var c=hr.getIndex(i.modelData.teamCopyID);c=uo.getIndex(hr.MODEL.missionId(c));var d=uo.MODEL.reliveCD(c);if(J.curServerTime-(t.dieTime+d)<=0)r.visible=!1;else{r.visible=!0;var u=(d-(J.curServerTime-t.dieTime)/1e3).toString();parseInt(u)<=0?r.innerHTML="":r.innerHTML=parseInt(u)+"秒"}}n++}2==s.length&&(i.img_fight2.visible=i.role2.visible=i.revive2.visible=i.bar_bg2.visible=i.txt_name2.visible=!1),i.box_team.visible=1<s.length,i.box_team.height=s.length-1==1?260:420},i.updateAttack=function(){for(var e=0;e<this.list.content.numChildren;e++){var t=this.list.content.getChildAt(e);t&&t.vo&&t.vo.objectId==this.modelData.currentTargetID?t.showFightting(!0):t.showFightting(!1)}},i.updateMonsterSelected=function(e){Vr.attackMonsterSelect?this.clickFun(Vr.attackMonsterSelect.objectId):this.clearSelected()},i.clickFun=function(e){for(var t=0;t<this.list.content.numChildren;t++){var i=this.list.content.getChildAt(t);i&&i.vo&&i.vo.objectId==e?i.onSelectItem(!0):i.onSelectItem(!1)}},i.clearSelected=function(){if(0<this.list.length)for(var e=0;e<this.list.content.numChildren;e++){this.list.content.getChildAt(e).onSelectItem(!1)}},i.showTeamInfo=function(){var e=this;e.img_fight1.visible=e.role1.visible=e.revive1.visible=e.bar_bg1.visible=e.txt_name1.visible=!1,e.img_fight2.visible=e.role2.visible=e.revive2.visible=e.bar_bg2.visible=e.txt_name2.visible=!1;var t=hr.getIndex(e.modelData.teamCopyID);e.img_copyName.skin=e.modelData.getTeamCopyTitlePath(hr.MODEL.sceneTitleRes(t))},i.showCD=function(){var e=this;if(0!=e.modelData.teamCopyID){var t=hr.getIndex(e.modelData.teamCopyID),i=uo.getIndex(hr.MODEL.missionId(t));e.cdTime=uo.MODEL.duration(i),e.txt_time.innerHTML=ed.n[1568]+V.getCNTickMS(e.cdTime)+"</font>",Y.timer.loop(1e3,e,e.showTimerCD)}},i.showTimerCD=function(){var e=this;e.cdTime--,e.txt_time.innerHTML=ed.n[1569]+V.getCNTickMS(e.cdTime)+"</font>",e.cdTime<=0&&(Bs.stop(),Y.timer.clear(e,e.showTimerCD),Y.timer.clearAll(e))},i.onClickGL=function(e){if(0!=this.modelData.teamCopyID){var t=hr.getIndex(this.modelData.teamCopyID);Fl.sendToModule("OPEN_TEAM_COPY_GONGLUE",["modules.copy.CopyModule"],{gonglueIDS:hr.MODEL.walkthroughIDS(t)})}},t}(),mu=function(e){function t(){var e=this;e.teamData=null,e.isCDOver=!0,t.__super.call(e),e.teamData=Vr.ins,e.txt_cd.text="",e.centerX=e.centerY=0}u(t,"modules.copy.views.teamcopy.TeamCopyYQView",Pi);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_fd.on("click",t,t.onClickYaoQing),t.btn_guild.on("click",t,t.onClickYaoQing),t.btn_world.on("click",t,t.onClickYaoQing),t.btn_close.on("click",t,t.onClickClose),t.txt_yaoqing.text=ed.n[1570],1e3<t.teamData.worldYaoQingCD-J.curServerTime?(t.txt_cd.text=ed.n[1571]+parseInt(((t.teamData.worldYaoQingCD-J.curServerTime)/1e3).toString()),Y.timer.loop(1e3,t,t.onTimer),t.btn_world.gray=!0,t.isCDOver=!1):(t.btn_world.gray=!1,t.isCDOver=!0)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_fd.off("click",t,t.onClickYaoQing),t.btn_guild.off("click",t,t.onClickYaoQing),t.btn_world.off("click",t,t.onClickYaoQing),t.btn_close.off("click",t,t.onClickClose),Y.timer.clear(t,t.onTimer),Y.timer.clearAll(t),t.btn_world.gray=!1,t.isCDOver=!0},i.onClickClose=function(e){On.ins.close("TEAM_COPY_YAOQING")},i.onClickYaoQing=function(e){var t=this;if(e.target==t.btn_fd)Fl.sendToModule("OPEN_TEAM_COPY_YAOQING",["modules.copy.CopyModule"],{type:1}),On.ins.close("TEAM_COPY_YAOQING");else if(e.target==t.btn_guild)Fl.sendToModule("OPEN_TEAM_COPY_YAOQING",["modules.copy.CopyModule"],{type:2}),On.ins.close("TEAM_COPY_YAOQING");else if(t.isCDOver){var i=Ze.MODEL.worldCD(0);t.teamData.worldYaoQingCD=J.curServerTime+1e3*i,Y.timer.loop(1e3,t,t.onTimer),t.btn_world.gray=!0,t.teamData.reqYaoQingToWorld(),On.ins.close("TEAM_COPY_YAOQING")}else Vl.ins.showMsg(ed.n[1572],1)},i.onTimer=function(){var e=this;if(e.teamData.worldYaoQingCD-J.curServerTime<=0)return Y.timer.clear(e,e.onTimer),Y.timer.clearAll(e),e.btn_world.gray=!1,e.isCDOver=!0,e.teamData.worldYaoQingCD=0,void(e.txt_cd.text="");e.isCDOver=!1,e.txt_cd.text=ed.n[1573]+parseInt(((e.teamData.worldYaoQingCD-J.curServerTime)/1e3).toString())},t}(),bu=function(t){function i(){var e=this;e._gridsList=null,e.leftArr=null,e.currentPage=0,e.totalPage=0,e.dataArr=null,i.__super.call(e)}u(i,"modules.copy.views.tower.CopyTowerDailyRewardView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._gridsList=new ga,e._gridsList._repeatX=4,e._gridsList._hScrollBarSkin=null,e._gridsList.x=7,e._gridsList.y=75,e._gridsList.size(540,450),e._gridsList._spaceX=20,e._gridsList._spaceY=30,e.addChild(e._gridsList)},e.showPanel=function(e){var t=this;t.leftArr=[];var i,s,n=[];for(var o in e.rewardArr)if(1<(s=e.rewardArr[o]).goodsNum)for(var a=0;a<s.goodsNum;a++)i=an.create(s.goodsId,1),n.push(i);else n.push(s);t.dataArr=n,t.dataArr.length%12==0?t.totalPage=t.dataArr.length/10:t.totalPage=parseInt(t.dataArr.length/10+""),t.currentPage=0,t._gridsList.items=t.dataArr.slice(12*t.currentPage,12*(t.currentPage+1))},e.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_get.on("click",this,this.onGetClicked)},e.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_get.off("click",this,this.onGetClicked)},e.onGetClicked=function(e){var t=this;if(t.currentPage!=t.totalPage){t.currentPage++;var i=12*(t.currentPage+1)>t.dataArr.length?t.dataArr.length:12*(t.currentPage+1);t._gridsList.items=t.dataArr.slice(12*t.currentPage,i)}else On.ins.close("CopyTowerDailyRewardView")},e.onCloseBtnClicked=function(e){this.close()},i.NAME="CopyTowerDailyRewardView",i}(Mn),wu=function(e){function i(){var e=this;e._time=0,e.rewardGrid=null,e._callBack=null,e._reward=null,e._levelShow=0,e._zhuanShengLevelLimit=0,e._levelLimit=0,e._expDto=null,e._curLv=-1,e._curExp=-1,e._maxExp=-1,e._leftUpgraceExp=-1,e._hasGetReward=!1,e._tweenTime=500,e._maxLevel=0,e._missionID=0,i.__super.call(e),e.rewardGrid=new ga,e.rewardGrid._gnameFont="20px SimHei",e.rewardGrid._repeatX=4,e.rewardGrid._vScrollBarSkin="",e.rewardGrid.x=109,e.rewardGrid.y=e.img_exp.y+71,e.rewardGrid.size(620,330),e.rewardGrid._spaceX=7,e.rewardGrid._spaceY=30,e.addChild(e.rewardGrid)}u(i,"modules.copy.views.tower.CopyTowerFightSuccessView",e);var t=i.prototype;return t.createChildren=function(){e.prototype.createChildren.call(this)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),i.COUNT_DOWN_TIME=parseInt(Ta.MODEL.value(Ta.getIndex(308))),t._time=i.COUNT_DOWN_TIME,t._maxLevel=parseInt(Ta.MODEL.value(Ta.getIndex(224))),t.btn_get.on("click",t,t.onGetClicked),t.btn_next.on("click",t,t.onNextClicked),Y.timer.loop(1e3,t,t.onTime),$a.instance.needToUpdateSuccessPanel=!0,t._levelShow=parseInt(Ta.MODEL.value(Ta.getIndex(159))),t.lbl_countDown.changeText(""),t.updateView()},t.updateView=function(){var e=this,t=$a.instance.currentSuccessData;if(t){$a.instance.needToUpdateSuccessPanel&&($a.instance.needToUpdateSuccessPanel=!1),e._callBack=t.callback,e._reward=t.award,e._missionID=t.missionID;var i=$a.instance.currentLevel;i<0&&(i=0),i>At.count-1&&At.count;At.MODEL.firstReward(i);var s=an.createStrArr(At.MODEL.firstReward(i));e._expDto=s[0],e._curExp=Gi.ins.exp,e._maxExp=Gi.ins.maxExp,e._curLv=Gi.ins.lv,e._curLv+1>=e._maxLevel?e._curLv==e._maxLevel?(e.getReward(),e.txt_exp.text="已满级",e.img_exp.scaleX=1):(e._curExp+e._expDto.goodsNum>e._maxExp?e._leftUpgraceExp=e._maxExp-e._curExp:e._leftUpgraceExp=e._expDto.goodsNum,e.txt_exp.text=e._leftUpgraceExp.toString(),e.img_exp.scaleX=e._curExp/e._maxExp):(e._leftUpgraceExp=e._expDto.goodsNum,e.txt_exp.text=e._expDto.goodsNum.toString(),e.img_exp.scaleX=e._curExp/e._maxExp),e.updateLevelText(),e.updateLevel(),e.txt_exp.color="#23b11f";for(var n,o,a=s[2],r=(At.MODEL.firstReward(i),[]),l=0;l<e._reward.length;l++)e._reward[l]&&(n=e._reward[l],o=an.create(n.modelId,n.count),r.push(o));r.unshift(a),e.rewardGrid.items=r,e.btn_get.x=130,e.btn_next.x=380;var c=0;c=$a.instance.currentLevel+1<At.count?At.MODEL.missionId($a.instance.currentLevel+1):At.MODEL.missionId(At.count-1);var d=uo.getIndex(c);if(e._zhuanShengLevelLimit=uo.MODEL.zsLevelLimit(d),e._levelLimit=uo.MODEL.levelLimit(d),$a.instance.isSix=!1,$a.instance.currentLevel+1==$a.instance.getCurrentTypeMaxLevel()&&($a.instance.isSix=!0),$a.instance.currentLevel+1>=At.count||$a.instance.currentLevel+1==$a.instance.getCurrentTypeMaxLevel()||9<$a.instance.leftLotteryTime&&$a.instance.currentLevel>e._levelShow||!(Gi.ins.zsLv>=e._zhuanShengLevelLimit&&Gi.ins.lv>=e._levelLimit))e.btn_next.visible=!1,e.btn_get.centerX=0;else{var u,h=!(e.btn_next.visible=!0),_=0;u=($a.instance.currentLevel+1)%10==0?(_=parseInt(($a.instance.currentLevel+1)/10+"")+1,$a.instance.currentLevel>$a.instance.getCurrentTypeMaxLevel()&&(_-=$a.instance.getCurrentTypeMaxLevel()/10,h=!0),"第"+_+"重"):"第"+parseInt($a.instance.currentLevel%10+2+"")+"层",e.btn_next.label=h&&0<_?"云中"+u:"挑战"+u}e.onTime()}},t.updateLevel=function(){this.showBarEffect()},t.showBarEffect=function(){var e=this,t=!1,i=0;e._curExp+e._leftUpgraceExp>e._maxExp?(t=!0,i=parseInt(e._tweenTime*(1-e._curExp/e._maxExp)+""),e._tweenTime-=i):i=e._tweenTime,Yl.clearAll(e.img_exp);var s=t?1:(e._curExp+e._leftUpgraceExp)/e._maxExp;Yl.to(e.img_exp,{scaleX:s,update:ms.create(e,e.onUpdate,null,!1)},i,null,ms.create(e,e.onEnd),0,!1,!1),e.updateLevelText()},t.onUpdate=function(){var e=this;e._curLv>=e._maxLevel?e.txt_present.changeText("100%"):e.txt_present.changeText(parseInt(100*e.img_exp.scaleX+"")+"%")},t.onEnd=function(){var e=this;e._leftUpgraceExp-=e._maxExp-e._curExp,0<e._leftUpgraceExp?(e._curLv+=1,e._curExp=0,e._maxExp=dr.MODEL.exp(e._curLv-1),e.img_exp.scaleX=0,$a.instance.hasShowLevelUpPanel++,e.showBarEffect()):On.ins.isOpen("CopyTowerLevelUpView")||Y.timer.once(500,e,e.showLevel),e.updateLevelText()},t.showLevel=function(){this._hasGetReward=!0,On.ins.open("CopyTowerLevelUpView",{exp:this._expDto.goodsNum,missionID:this._missionID})},t.updateLevelText=function(){var e=this;e._curLv<e._maxLevel?(e.txt_currentLevel.text=e._curLv+"级",e.txt_nextLevel.text=e._curLv+1+"级"):(e.txt_currentLevel.text=e._curLv-1+"级",e.txt_nextLevel.text=e._curLv+"级")},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),Y.timer.clearAll(t),Yl.clearAll(t.img_exp),t.btn_get.off("click",t,t.onGetClicked),t.btn_next.off("click",t,t.onNextClicked),t._hasGetReward||t.getReward(),On.ins.isOpen("CopyTowerLevelUpView")&&On.ins.close("CopyTowerLevelUpView"),$a.instance.hasShowLevelUpPanel=0},t.getReward=function(){if(!this._hasGetReward||0!=$a.instance.hasShowLevelUpPanel){this._hasGetReward=!0;var e=new Xr;e.copyId=this._missionID;var t=uo.getIndex(this._missionID);uo.MODEL.name(t);Fl.sendToService(e)}},t.onGetClicked=function(e){var t=this;t.getReward(),t._callBack&&(t._callBack.run(),t._callBack.clear(),t._callBack=null),On.ins.close("CopyTowerFightSuccessView")},t.onNextClicked=function(){this._hasGetReward?this.enterNext():(this.getReward(),$a.instance.isChallengeNext=!0),On.ins.close("CopyTowerFightSuccessView")},t.onTime=function(){var e=this;e._time-=1,e.btn_next.visible&&ri.ins.hasEmptyNum(20)?(e.lbl_countDown.changeText(e._time+ed.n[1574]),e.btn_get.label=ed.n[1575]):(e.lbl_countDown.changeText(""),e.btn_get.label=ed.n[1576]+"("+e._time+"s)"),e._time<=0&&(Y.timer.clearAll(e),e.btn_next.visible&&ri.ins.hasEmptyNum(20)?(e.enterNext(),On.ins.close("CopyTowerFightSuccessView")):e.onGetClicked(null))},t.enterNext=function(){var e=0;0<ha.ins.curCopyId&&(e=uo.getIndex(ha.ins.curCopyId),10==uo.MODEL.cate(e)&&(e=$a.instance.currentLevel,on.reqEntry(At.MODEL.missionId(e))))},t.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),ui.SubPanel.prototype.destroy.call(this,e)},i.NAME="CopyTowerFightSuccessView",i.COUNT_DOWN_TIME=0,i}(da),yu=function(e){function t(){this._missionID=0,t.__super.call(this),this.centerX=0,this.centerY=-120}u(t,"modules.copy.views.tower.CopyTowerLevelUpView",Pe);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);var i=$a.instance.currentSuccessData;t._missionID=i?i.missionID:ha.ins.curCopyId;var s=new Xr;s.copyId=t._missionID;var n=uo.getIndex(t._missionID);uo.MODEL.name(n);Fl.sendToService(s)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Y.timer.clearAll(this)},i.updateView=function(e){var t=this;t.clip_level.visible=t.img_lv.visible=0<$a.instance.hasShowLevelUpPanel,t.img_exp.visible=!t.img_lv.visible,t.clip_level.value=$a.instance.hasShowLevelUpPanel.toString(),t.fp_exp.value=e.toString(),$a.instance.hasShowLevelUpPanel=0,Y.timer.once(2e3,t,t.closeThis)},i.closeThis=function(){On.ins._closePanelForce(this)},t.NAME="CopyTowerLevelUpView",t}(),xu=function(e){function o(){var e=this;e._curRotation=0,e._tarRotation=0,e._gid=0,e._status=0,e._imgRender=null,e._grids=null,e._goods=null,e.tipLayer=3,e.textLayer=5,e.effectLayer=7,e._curR=NaN,e._lastFrameTime=NaN,e._msR=1.44,e._msA=.002,e._startR=NaN,e.Vm=NaN,e._add_1=NaN,e._add_3=NaN,e._rPass=0,e.V1=.4,e.V3=.07,e.T1=500,e.T2=1e3,e.T3=1800,e.T4=1200,e.ROLL=5,e._lunEndReq=!1,o.__super.call(e)}u(o,"modules.copy.views.tower.CopyTowerLotteryView",fl);var t=o.prototype;return t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),Bi._initContainer(e.sp_grids),e._curRotation=0;new is(e.img_arrow.x,e.img_arrow.y);var t=e.getChildByName("_mr_layer_0");e.getChildIndex(t);e._grids=[];for(var i=0;i<10;i++){var s=e.sp_grids.getChildByName("g_"+i),n=new l;n.x=s.x,n.y=s.y,n.isClearUrl=!1,n.size(74,74),n._iconLayer=1,n._effectLayer=e.effectLayer,n._textLayer=e.textLayer,n._tipLayer=e.tipLayer,e.sp_grids.addChild(n),e._grids.push(n),s.destroy(!0)}e.img_bg.skin=Or.getFullUrl("ui/images/tower/lwt_tgzp_db.png"),e.img_bg.scale(1.68,1.68),e.img_arrow.skin=Or.getFullUrl("ui/layouts/tower/lwt_tgzp_zz.png"),e.img_light_bg.skin=Or.getFullUrl("ui/layouts/tower/lwt_tgzp_tx.png"),e.img_title_bg.skin=Or.getFullUrl("ui/layouts/tower/gq_ts_db.png"),e._imgRender=Bi.createMRenderer(),e._imgRender.graphicsMode=!0,e._imgRender.renderHandler=ms.create(e,e.onImgRender,null,!1),e.sp_grids.addChild(e._imgRender),e.img_light.visible=!1},t.onImgRender=function(){var e=this;if(e._goods)for(var t=Y.loader.getRes(Or.getAtlasSubPath("base_ui2/ty_gat_ylq.png")),i=e._imgRender.mRenderLayerGraphics(e.effectLayer+1,null),s=e._imgRender.mRenderLayerGraphics(e.textLayer,null),n=0;n<e._goods.length;n++){var o=e._goods[n],a=e._grids[n];1==o.status&&i.drawTexture(t,a.x-(t.width-a.width)/2,a.y,t.width,t.height);var r=Re.getIndex(o.modelId),l=Co.getByQuality(Re.MODEL.colourId(r)),c=Re.MODEL.name(r);s.fillText(c,a.x+a.width/2,a.y+a.height+3,"20px SimHei",l,"center")}},t.startNextLun=function(){var e=this;e.lockMask(!0),e.sp_grids.rotation=0,e.sp_grids.alpha=1,e._curR=0,e._lastFrameTime=qe.now(),e.frameLoop(1,e,e.onLunFrame)},t.onLunFrame=function(){var e=this,t=qe.now(),i=t-e._lastFrameTime;e._lastFrameTime=t;var s=NaN;if(720<=e._curR){if(e._status<6)return;7!=e._status&&(e._status=7,e.updateGridsData()),s=e.sp_grids.alpha+e._msA*i}else s=e.sp_grids.alpha-e._msA*i;e._curR+=e._msR*i,1440<=e._curR&&(e._curR=0,s=1,e._status=0,e.clearTimer(e,e.onLunFrame),e.lockMask(!1),e._lunEndReq&&(e._lunEndReq=!1,e.onStartClicked())),e.sp_grids.alpha=s,e.sp_grids.rotation=e._curR},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_start.on("click",t,t.onStartClicked),t.img_arrow.rotation=t._curRotation,t.btn_start.disabled=!1,t.updateRotation(t._curRotation),Fl.sendToService(new Pa)},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_start.off("click",t,t.onStartClicked),t._status=0,t.clearTimer(t,t.startNextLun),t.clearTimer(t,t.onLunFrame),t.clearTimer(t,t.onRotateFrame),t.sp_grids.rotation=0,t.sp_grids.alpha=1,Yl.clearAll(t.sp_grids),Yl.clearAll(t.img_arrow)},t.onStartClicked=function(){if(ri.ins.hasEmptyNum(20))if($a.instance.currentLevel!=At.count||0!=$a.instance.leftLotteryTime)if(5!=this._status&&6!=this._status){if(0==this._status)if($a.instance.leftLotteryTime<=0)Vl.ins.showMsg(ed.n[1577],1);else{var e=new Na;Fl.sendToService(e)}}else this.reqNext(!0);else Vl.ins.showMsg(ed.n[1577],1);else ja.ins.showBagRecycle()},t.update=function(e){var t=this;e instanceof protos.tianguan.toc_21709?t.start(e.gid):e instanceof protos.tianguan.toc_21707?(t._goods=e.goods,0==t._status?t.updateGridsData():5==t._status&&(t._status=6),t.updateBase()):e instanceof protos.tianguan.toc_21702&&t.updateBase()},t.updateGridsData=function(){for(var e=this,t=0;t<e._goods.length;t++){var i=e._goods[t];e._grids[t].bindData=an.create(i.modelId,i.count),$a.addTowerUrl(e._grids[t].getIconUrl())}Bi.invalidRender(e._imgRender)},t.start=function(e){var t=this;t._gid=e,t._status=1,t.lockMask(!0),t.ROLL=3+(3*Math.random()>>0),t.T2=125*t.ROLL,t._startR=t.img_arrow.rotation=t._curRotation%360;var i=t._tarRotation=o.EACH_ANGLE*e;i+=360*t.ROLL;var s=t.T3+t.T4;t.T4=600+Math.round(400*Math.random()),t.T3=s-t.T4,t.Vm=(2*(i-t._startR)-t.V1*t.T1-t.V3*t.T3-2*t.V3*t.T4)/(t.T1+2*t.T2+t.T3),t._add_1=(t.Vm-t.V1)/t.T1,t._add_3=(t.V3-t.Vm)/t.T3,t._rPass=0,t._lastFrameTime=qe.now(),t.frameLoop(1,t,t.onRotateFrame)},t.onRotateFrame=function(){var e=this;e._rPass=qe.now()-e._lastFrameTime;var t=0;return e._rPass<=e.T1?(t=e._rPass,e.img_arrow.rotation=e._startR+(e.V1*t+.5*e._add_1*t*t),void e.updateRotation(e.img_arrow.rotation)):e._rPass<=e.T1+e.T2?(t=e._rPass-e.T1,e.img_arrow.rotation=e._startR+(e.V1*e.T1+.5*e._add_1*e.T1*e.T1)+e.Vm*t,void e.updateRotation(e.img_arrow.rotation)):e._rPass<=e.T1+e.T2+e.T3?(t=e._rPass-e.T1-e.T2,e.img_arrow.rotation=e._startR+(e.V1*e.T1+.5*e._add_1*e.T1*e.T1)+e.Vm*e.T2+(e.Vm*t+.5*e._add_3*t*t),void e.updateRotation(e.img_arrow.rotation)):e._rPass>=e.T1+e.T2+e.T3+e.T4?(e.clearTimer(e,e.onRotateFrame),e.img_arrow.rotation=e._curRotation=e._tarRotation,void e.rotaryComplete()):(t=e._rPass-e.T1-e.T2-e.T3,e.img_arrow.rotation=e._startR+(e.V1*e.T1+.5*e._add_1*e.T1*e.T1)+e.Vm*e.T2+(e.Vm*e.T3+.5*e._add_3*e.T3*e.T3)+e.V3*t,void e.updateRotation(e.img_arrow.rotation))},t.lockMask=function(e){On.ins.lockMask("CopyTowerLotteryView",e)},t.rotaryComplete=function(){var e=this;e._status=0,e.btn_start.disabled=!1,e._curRotation=e._tarRotation,e.updateRotation(e._curRotation),e._goods[e._gid].status=1,Bi.invalidRender(e._imgRender);var t=e._grids[e._gid],i=t.bindData,s=t.localToGlobal(new is(32,32));Vl.ins.playGetItemsByPos([i.goodsId],s);for(var n=!(e._lunEndReq=!1),o=0;o<e._goods.length;o++)if(1!=e._goods[o].status){n=!1;break}n&&(e._status=5),e.lockMask(!1);var a=new Ws;Fl.sendToService(a)},t.reqNext=function(e){var t=this,i=!!e;5==t._status||6==t._status?(t.startNextLun(),i&&(t._lunEndReq=!0)):i&&t.onStartClicked()},t.updateRotation=function(e){(e%=360)<0&&(e+=360);for(var t=0,i=o.EACH_ANGLE/2;t<360;){if(Math.abs(e-t)<=i){var s=t/o.EACH_ANGLE;this.box_light_bg.rotation=t;var n=this._grids[s];return this.img_light.x=n.x+27,void(this.img_light.y=n.y+10)}t+=o.EACH_ANGLE}},t.updateBase=function(){this.txt_time.text=ed.n[1579]+$a.instance.leftLotteryTime},t.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},o.NAME="CopyTowerLotteryView",o.ITEM_COUNT=10,o.STATUS_NORMAL=0,o.STATUS_PLAYING=1,o.STATUS_LUN_START=5,o.STATUS_LUN_RESP=6,o.STATUS_LUN_HALF=7,o.layerSprite=null,i(o,["EACH_ANGLE",function(){return this.EACH_ANGLE=36}]),o}(),Iu=function(t){function i(){var e=this;e._levelGrid=null,e._extraGrid=null,e._currentScorll=0,e._towerNameColorArr=["#90877b","#e6d80d"],e._towerYArr=[-617,-617,-617,-617,-353,-222,-100,-100,-100,-100],e._isJustShow=!1,e._levelShow=0,e._zhuanShengLevelLimit=0,e._levelLimit=0,e._attrEffect=null,e._currentType=1,i.__super.call(e)}u(i,"modules.copy.views.tower.CopyTowerMainView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.list_rank.itemRender=ku,e._levelGrid=new ga,e._levelGrid._repeatX=3,e._levelGrid._spaceX=20,e._levelGrid.pos(e.txt_currentLevel.x-100,e.txt_currentLevel.y+20),e._levelGrid._hScrollBarSkin=null,e._levelGrid.size(500,170),e.box_award.addChild(e._levelGrid),e._extraGrid=new ra,e._extraGrid.size(e.img_ten.width,e.img_ten.height),e._extraGrid.x=e.img_ten.x,e._extraGrid.y=e.img_ten.y,e.box_exta.addChild(e._extraGrid),e.img_bg.skin=Or.getFullUrl("ui/images/tower/lwt_jm_bj.jpg"),e.img_rank_bg.skin=Or.getFullUrl("ui/layouts/tower/gq_ph_dk.png"),e.img_tower.skin=Or.getFullUrl("ui/layouts/tower/lwt_lwt_dc.png"),e.img_yun.skin=Or.getFullUrl("ui/images/tower/lwt_img_yd.png"),e.img_yun.scale(1.4,1.4)},e.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_challenge.on("click",t,t.onChallengeBtnClicked),t.btn_dailyReward.on("click",t,t.onDailyRewardBtnClicked),t.btn_lottery.on("click",t,t.onLotteryBtnClicked),t.txt_checkRank.on("click",t,t.onShowRankPanel),t.btn_common.on("click",t,t.onBtnCommonClicked),t.btn_difficult.on("click",t,t.onBtnDifficultClicked),t._isJustShow=!0,t.img_select.visible=!1,t._levelShow=parseInt(Ta.MODEL.value(Ta.getIndex(159)));var i=new Oa;Fl.sendToService(i),li.reqRank(8)},e.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t._isJustShow=!1,t.btn_challenge.off("click",t,t.onChallengeBtnClicked),t.btn_dailyReward.off("click",t,t.onDailyRewardBtnClicked),t.btn_lottery.off("click",t,t.onLotteryBtnClicked),t.txt_checkRank.off("click",t,t.onShowRankPanel),t.btn_common.off("click",t,t.onBtnCommonClicked),t.btn_difficult.off("click",t,t.onBtnDifficultClicked),t.disposeAttEff()},e.disposeAttEff=function(){var e=this;e._attrEffect&&(e._attrEffect.parent&&e._attrEffect.parent.removeChild(e._attrEffect),e._attrEffect.dispose(),e._attrEffect=null)},e.onBtnCommonClicked=function(e){this._currentType=1,this.updateSelect(),this.updateByVSC()},e.onBtnDifficultClicked=function(e){$a.instance.currentLevel<$a.instance.getCurrentTypeMaxLevel()?Vl.ins.showById(4938,1):(this._currentType=2,this.updateSelect(),this.updateByVSC())},e.refreshView=function(){this.updateByVSC()},e.updateSelect=function(){var e=this;switch(e._currentType){case 1:e.img_select.x=e.btn_common.x;break;case 2:e.img_select.x=e.btn_difficult.x+8}},e.updateByVSC=function(e){var t=this;switch(t.img_select.visible||(0==$a.instance.currentLevel?t._currentType=1:$a.instance.currentLevel>=$a.instance.getCurrentTypeMaxLevel()&&!$a.instance.isSix?t._currentType=2:($a.instance.isSix=!1,t._currentType=1),t.img_select.visible=!0,t.updateSelect()),t.updateCeng(),t.updateRank(),t.btn_dailyReward.showTip=!1,0==$a.instance.currentLevel?t.txt_dailyGet.text="":$a.instance.hasDailyReward?(t.txt_dailyGet.text="可领取",t.btn_dailyReward.showTip=!0):t.txt_dailyGet.text=ed.n[1580],0<$a.instance.leftLotteryTime&&30<$a.instance.currentLevel?t.btn_lottery.showTip=!0:t.btn_lottery.showTip=!1,t._currentType){case 1:t.img_bg.skin=Or.getFullUrl("ui/images/tower/lwt_jm_bj.jpg");break;case 2:t.img_bg.skin=Or.getFullUrl("ui/images/tower/yzlwt_jm_bj.jpg")}var i=$a.instance.currentLevel;if(t.btn_common.showTip=!1,t.btn_difficult.showTip=!1,t.box_reward.visible=!1,$a.instance.currentLevel>=$a.instance.getCurrentTypeMaxLevel()){t.btn_difficult.gray=!1;var s=Math.floor($a.instance.getCurrentTypeMaxLevel()/10);switch(t._currentType){case 1:t.txt_currentChong.innerHTML=nc.createColor("当前：","#90877b")+nc.createColor("龙纹塔"+s+"重天","#23b11f");break;case 2:(t.btn_lottery.showTip||t.btn_dailyReward.showTip)&&(t.btn_difficult.showTip=!0),t.box_reward.visible=!0,t.txt_currentChong.innerHTML=nc.createColor("当前：","#90877b")+nc.createColor("云中塔"+($a.instance.currentChong()-s)+"重天","#23b11f")}}else t.btn_difficult.gray=!0,(t.btn_lottery.showTip||t.btn_dailyReward.showTip)&&(t.btn_common.showTip=!0),t.box_reward.visible=!0,t.txt_currentChong.innerHTML=nc.createColor("当前：","#90877b")+nc.createColor($a.instance.currentChong()+"重天","#23b11f");if(i>=At.count||1==t._currentType&&$a.instance.currentLevel>=$a.instance.getCurrentTypeMaxLevel())return t.btn_challenge.visible=t.txt_level_limit.visible=t.box_award.visible=t.box_exta.visible=t.box_fight.visible=t.txt_currentChong.visible=!1,void(t.img_through.visible=!0);t.btn_challenge.visible=t.txt_level_limit.visible=t.box_award.visible=t.box_exta.visible=t.box_fight.visible=t.txt_currentChong.visible=!0,t.img_through.visible=!1,t.updateCurrentTen();var n=At.MODEL.firstReward(i);t._levelGrid.setGoodsItems(n,6);var o,a=At.MODEL.extraAward(i),r=At.MODEL.effectID(i);t.disposeAttEff();0!=a.length?(t.box_exta.visible=!0,o=Tl.createStr(a),o=Vn.getIsDragon(o.goodsId)?Tl.createStr(a):an.createStr(a),t._extraGrid.bindData=o,null!=r&&0<r.length&&(t._attrEffect=ti.createEffect(r,t._extraGrid.x+t.img_ten.width/2,t._extraGrid.y+t.img_ten.height-30,t.box_exta)),t.txt_extraAwardName.text=o.name,t.txt_extraAwardName.color=Co.getByQuality(Re.MODEL.colourId(o.cfgIdx))):(t.box_exta.visible=!1,t.txt_extraAwardName.text="",t.txt_currentLevel.text="");var l=($a.instance.currentLevel+1)%10==0?10:($a.instance.currentLevel+1)%10;t.txt_currentLevel.text="通关第"+l+"层奖励",30<$a.instance.currentLevel?t.txt_lottery.text=ed.n[1581]:t.txt_lottery.text=ed.n[1582],t._isJustShow&&0<$a.instance.leftLotteryTime&&$a.instance.currentLevel>t._levelShow&&$a.instance.isNeedToShowLottery&&($a.instance.isNeedToShowLottery=!1,t.onLotteryBtnClicked(null));var c=At.MODEL.missionId(i),d=uo.getIndex(c);t._zhuanShengLevelLimit=uo.MODEL.zsLevelLimit(d),t._levelLimit=uo.MODEL.levelLimit(d);var u=uo.MODEL.bestFightingScore(d);t.font_fight.value=u.toString(),t.box_fight.x=423-10*u.toString().length,0==t._zhuanShengLevelLimit?(t.txt_level_limit.text=t._levelLimit+ed.n[1583],Gi.ins.lv>=t._levelLimit?t.txt_level_limit.color="#23b11f":t.txt_level_limit.color="#ff2e24"):(t.txt_level_limit.text=t._zhuanShengLevelLimit+"转"+t._levelLimit+ed.n[1584],Gi.ins.zsLv>=t._zhuanShengLevelLimit&&Gi.ins.lv>=t._levelLimit?t.txt_level_limit.color="#23b11f":t.txt_level_limit.color="#ff2e24")},e.updateCurrentTen=function(){var e="",t=$a.instance.currentLevel,i=At.MODEL.extraType(t),s=At.MODEL.extraLevel(t);switch(i){case 1:e=s+"层解锁";break;case 2:e=s+"层获得";break;case 3:e="再闯"+s+"层获得";break;case 4:e="再闯"+s+"层解锁"}this.txt_currentTen.text=e},e.updateCeng=function(){var e=this,t=0;1==e._currentType&&$a.instance.currentLevel>=$a.instance.getCurrentTypeMaxLevel()?t=10:2==e._currentType&&$a.instance.currentLevel-$a.instance.getCurrentTypeMaxLevel()>=$a.instance.getCurrentTypeMaxLevel(2)?t=10:0==$a.instance.currentLevel?t=1:10<=(t=$a.instance.currentLevel%10+1)&&(t=10);for(var i=1;i<=10;i++)e["txt_"+i].color=e._towerNameColorArr[0],10==i?10==t?(e["img_"+i].skin=Or.getAtlasSubPath("tower/lwt_lwt_td2.png"),e["img_levelbg_"+i].skin=Or.getAtlasSubPath("tower/lwt_lc_db2.png"),e["txt_"+i].color=e._towerNameColorArr[1]):(e["img_"+i].skin=Or.getAtlasSubPath("tower/lwt_lwt_td.png"),e["img_levelbg_"+i].skin=Or.getAtlasSubPath("tower/lwt_lc_db1.png")):i==t?(e["img_"+i].skin=Or.getAtlasSubPath("tower/lwt_lwt_lc2.png"),e["img_levelbg_"+i].skin=Or.getAtlasSubPath("tower/lwt_lc_db2.png"),e["txt_"+i].color=e._towerNameColorArr[1]):(e["img_levelbg_"+i].skin=Or.getAtlasSubPath("tower/lwt_lc_db1.png"),e["img_"+i].skin=Or.getAtlasSubPath("tower/lwt_lwt_lc.png"));e.panel_tower.y=e._towerYArr[t-1]},e.onChallengeBtnClicked=function(e){var t=this,i=$a.instance.currentLevel;if(i!=At.count){if(0==t._zhuanShengLevelLimit){if(Gi.ins.lv<t._levelLimit)return void Vl.ins.showMsg(t._levelLimit+ed.n[1585],1)}else if(Gi.ins.zsLv<t._zhuanShengLevelLimit||Gi.ins.lv<t._levelLimit)return void Vl.ins.showMsg(t._zhuanShengLevelLimit+"转"+t._levelLimit+ed.n[1586],1);on.reqEntry(At.MODEL.missionId(i)),On.ins._closePanelForce(t)}else Vl.ins.showById(3669,2)},e.updateRank=function(){if($a.instance.rankData){var e=3<=$a.instance.rankData.datas.length?3:$a.instance.rankData.datas.length,t=$a.instance.rankData.datas.slice(0,e);this.list_rank.dataSource=t}else this.list_rank.dataSource=[]},e.onDailyRewardBtnClicked=function(e){if(0==$a.instance.currentLevel)Vl.ins.showById(3541,1);else if($a.instance.hasDailyReward){var t=new Ra;t.type=1,Fl.sendToService(t)}else Vl.ins.showById(1010,1)},e.onLotteryBtnClicked=function(e){var t=parseInt(Ta.MODEL.value(Ta.getIndex(159)));$a.instance.currentLevel<t?Vl.ins.showById(4330,1):On.ins.isOpen("CopyTowerLotteryView")||On.ins.open("CopyTowerLotteryView")},e.onShowRankPanel=function(e){On.ins.isOpen("CopyTowerRankView")||On.ins.open("CopyTowerRankView")},e.destroy=function(e){void 0===e&&(e=!0);for(var t=1;t<10;t++)this["img_"+t]&&this["img_"+t].skin&&Y.loader.clearRes(this["img_"+t].skin);laya.ui.View.prototype.destroy.call(this,e)},i.MAX_CENG=10,i.TYPE_COMMON=1,i.TYPE_DIFFICULT=2,i}(Go),Su=function(e){function o(){o.__super.call(this)}return u(o,"modules.copy.views.tower.CopyTowerRankDetailItem",e),n(0,o.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(Dt,t,"dataSource",e),t.img_vip.visible=!1,t.txt_name.text="",t.txt_rank.text="",t.img_bg.skin="",t.img_rank.visible=!1,e){0<e.vip&&(t.img_vip.visible=!0),e.r<4?(t.img_rank.visible=!0,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+e.r+".png"),t.txt_name.color=o._rankNameColorArr[e.r-1],t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no"+e.r+".png")):(t.txt_name.color=o._rankNameColorArr[o._rankNameColorArr.length-1],t.img_bg.skin=Or.getAtlasSubPath("basic_ui_3/ty_btn_lb_2.png")),t.txt_rank.text=e.r+"",t.txt_name.text=e.n;var i,s=0;s=e.copyTower<At.count?e.copyTower+1:e.copyTower;var n=$a.instance.getCurrentTypeMaxLevel();i=s<n?"龙纹塔"+$a.getChineseFormateNumByLevel(s):"云中塔"+$a.getChineseFormateNumByLevel(s-n),t.txt_detail.text=i}}),i(o,["_rankNameColorArr",function(){return this._rankNameColorArr=["#f7efcf","#f0d1a4","#c5a386","#90877b"]}]),o}(Dt),ku=function(e){function t(){this.gAlpha=[1,.6,.3],t.__super.call(this)}return u(t,"modules.copy.views.tower.CopyTowerRankSimpleItem",e),n(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(Qa,t,"dataSource",e),t.txt_Leve.text="",t.txt_name.text="",e){t.txt_name.text=e.n;var i,s=0;s=e.copyTower<At.count?e.copyTower+1:e.copyTower;var n=$a.instance.getCurrentTypeMaxLevel();i=n<=s?"云中塔"+$a.getFormateNumByLevel(s-n):"龙纹塔"+$a.getFormateNumByLevel(s),t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+e.r+".png"),t.txt_Leve.text=i,t.img_bg.alpha=t.gAlpha[e.r-1]}}),t}(Qa),Cu=function(t){function e(){e.__super.call(this)}u(e,"modules.copy.views.tower.CopyTowerRankView",t);var i=e.prototype;return i.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.list_rank.itemRender=Su,e.list_rank.repeatY=10,e.list_rank.vScrollBarSkin="",e.list_rank.scrollBar.elasticBackTime=10,e.list_rank.scrollBar.elasticDistance=10,e.txt_no.visible=!1},i.onAdd=function(e){var t=this;if(ui.SubPanel.prototype.onAdd.call(t,e),100<$a.instance.rankData.datas.length?t.list_rank.dataSource=$a.instance.rankData.datas.slice(0,100):t.list_rank.dataSource=$a.instance.rankData.datas.slice(),t.btn_close.on("click",t,t.onCloseClicked),0<$a.instance.rankData.myRank){var i=$a.instance.getCurrentTypeMaxLevel();$a.instance.currentLevel+1>At.count?t.txt_myRecord.text="云中塔"+$a.getChineseFormateNumByLevel($a.instance.currentLevel-i):$a.instance.currentLevel>=i?t.txt_myRecord.text="云中塔"+$a.getChineseFormateNumByLevel($a.instance.currentLevel-i+1):t.txt_myRecord.text="龙纹塔"+$a.getChineseFormateNumByLevel($a.instance.currentLevel+1),t.txt_myrank.text=$a.instance.rankData.myRank+""}else t.txt_myrank.text="未上榜",t.txt_myRecord.text="";t.txt_no.visible=t.list_rank.length<1,t.list_rank.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onCloseClicked),t.list_rank.scrollBar.off("change",t,t.onScrollChanged)},i.onCloseClicked=function(e){this.close()},i.onScrollChanged=function(){var e=this;0==e.list_rank.scrollBar.max||e.list_rank.scrollBar.value>=e.list_rank.scrollBar.max?e.g_mask.visible=!1:e.g_mask.visible=!0},e.NAME="CopyTowerRankView",e}(aa),Tu=(function(e){function t(){t.__super.call(this),this.addSubscribe(Bu,Au,Du),this.subPackages=["21209","21210","21211","22102","22103","22104","22105","22106","22109","21220","21263","21264","21221","21222","21225","22621","22622","21227","30005","22604","22606","22610","22613","22616","22618","22620","21215","23614","21214","21219","30370","30371","30372","30375","21233","22151","22152","22153","22154","30342","30352","24004","10301","SCENE_COMM_SUCCESS","22357","30400","30401","30402","10402","OPEN_WILD_BY_ANCIENT","21250","21252","24050","24051","24052","21254","21255","21258","22623","21259","21261","30862","30007"]}u(t,"modules.boss.BossModule",Tc)}(),function(){function e(){var e=this;e._configArr=null,e.currentSubSelected=0,e._map=null,e._timeMap=null,e._currentCoolTime=0,e.needToShowSubView=!1,e.needToShow=!0}u(e,"modules.boss.others.BossHomeModel");var t=e.prototype;return t.update30400=function(e){this.needToShowSubView=e.isLoginSend,this._timeMap=e.timeMap,this._currentCoolTime=J.serverTimeSec+e.coolDownTime+1,this._map=e.map},t.getBossInfoByIndex=function(){var e=this,t=[];e.cofigArr[e.currentSubSelected]||console.log("boss提示异常报错",e.cofigArr,e.currentSubSelected);for(var i=e.cofigArr[e.currentSubSelected].bossIDArr,s=0;s<i.length;s++){var n;for(var o in e._map)(n=e._map[o])&&n.id==parseInt(i[s])&&t.push(n.id)}return t},t.getRedPt=function(e,t){if(void 0===t&&(t=26),!e||e.length<1)return!1;for(var i=0;i<e.length;i++)if(2==this.getStatus(e[i])&&modules.boss.others.BossHomeModel.instance.map&&modules.boss.others.BossHomeModel.instance.map[e[i]]&&0==modules.boss.others.BossHomeModel.instance.map[e[i]].selected)return!0;return!1},t.getStatus=function(e){var t=uo.getIndex(e),i=uo.MODEL.levelLimit(t);return Gi.ins.lv<i?0:(i=uo.MODEL.zsLevelLimit(t),Gi.ins.zsLv<i?0:modules.boss.others.BossHomeModel.instance.map[e].blood<=0?1:2)},n(0,t,"cofigArr",function(){if(null==this._configArr){var e;this._configArr=[];for(var t=0;t<Ia.count;t++)(e=new _i).id=Ia.MODEL.key(t),e.dectId=Ia.MODEL.descId(t),e.bossIDArr=Ia.MODEL.bossIds(t).split(","),e.rewardStr=Ia.MODEL.reward(t),e.vipLimit=Ia.MODEL.vipLimit(t),e.type=Ia.MODEL.type(t),e.level=Ia.MODEL.level(t),e.refreshTime=Ia.MODEL.refreshTime(t),this._configArr.push(e)}return this._configArr}),n(0,t,"timeMap",function(){return this._timeMap}),n(0,t,"map",function(){return this._map}),n(0,t,"currentCoolTime",function(){return this._currentCoolTime}),n(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}()),Eu=function(){function e(){}return u(e,"modules.boss.others.Boss_Mijing_ReqUtil"),e.reqChallenge=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0);var s=new Yr;s.copyId=e,s.x=t,s.y=i,Fl.sendToService(s)},e.reqRandomNum=function(e,t){var i=new Ul;i.randomNum=e,i.missionId=t,Fl.sendToService(i)},e.reqShieldAward=function(e){var t=new Nl;t.missionId=e,Fl.sendToService(t)},i(e,["SHOW_MISSIONS",function(){return this.SHOW_MISSIONS=[15]}]),e}(),Lu=function(){function e(){var e=this;e.toc2152=null,e.zwNums=0,e.missId=0,e.copyPersonNum=0,e.copyHurtList=[]}u(e,"modules.boss.others.Boss_WorldBossData");var t=e.prototype;return t.reqWB_BaseDataInfo=function(){var e=new uc;Fl.sendToService(e)},t.reqWB_YQ=function(e){var t=new bt;t.missId=e,t.msgID=4265,Fl.sendToService(t)},t.reqWB_ZW=function(){var e=new Cn;Fl.sendToService(e)},t.reqWB_ZWInfo=function(){var e=new Sn;Fl.sendToService(e)},t.getKeyByMissIdAndRank=function(e,t){var i=0,s="";for(i=0;i<Yc.count;i++){if(Yc.MODEL.missionId(i)==e){var n=Yc.MODEL.rankUpperLim(i),o=Yc.MODEL.rankLowerLim(i);if(n<=t&&t<=o){s=Yc.MODEL.auctionIds(i);break}}}return s},n(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),Au=function(e){function i(){var e=this;e._personScene=null,e._worldScene=null,e._worldJieSuan=null,e._wildOwnScene=null,e._wildScene=null,e._checkPointScene=null,e._wildOwnSceneJiesuan=null,e._wildSceneAward=null,e._wildSceneJiesuan=null,e._sczbSceneAward=null,e._belongSettle=null,e._syBoss=null,e._godSettle=null,e._boss_GodWeaponFairyland=null,i.__super.call(e);var t=[];On.ins.registPanel("BOSS_WORLDBOSS_SCENE",vh,"_worldScene",e,{wait:On.waitRes(t),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_PERSONBOSS_SCENE",lh,"_personScene",e,{clearAll:!1,mask:!1,layer:"nav"}),t=[Or.getLayoutsPath("fightresult")],On.ins.registPanel("BOSS_WILD_SCENE_JIESUAN",gh,"_wildSceneJiesuan",e,{layer:"under",wait:On.waitRes(t)}),On.ins.registPanel("BOSS_GOD_SETTLE",nh,"_godSettle",e,{layer:"under",wait:On.waitRes(t)}),On.ins.registPanel("BOSS_BELONG_SETTLE",ih,"_belongSettle",e,{layer:"under",wait:On.waitRes(t)}),t=t.concat(),On.ins.registPanel("BOSS_WORLDBOSS_JIESUAN",mh,"_worldJieSuan",e,{layer:"under",wait:On.wait(On.waitRes(t),On.waitConfig(["ConfigWorldBoss"],["ConfigWorldBoss"]))}),On.ins.registPanel("BOSS_WILD_SCENE",ph,"_wildScene",e,{wait:On.waitRes(t),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_CHECKPOINT_SCENE",sh,"_checkPointScene",e,{wait:On.waitAtlas("checkpoint"),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_WILD_SCENE_AWARD",fh,"_wildSceneAward",e,{clearAll:!1,mask:!0,wait:On.waitAtlas("boss")}),On.ins.registPanel("BOSS_SCZB_SCENE_AWARD",ch,"_sczbSceneAward",e,{clearAll:!1,mask:!0,wait:On.waitAtlas("boss")}),On.ins.registPanel("BOSS_WILD_OWN_SCENE",hh,"_wildOwnScene",e,{wait:On.waitRes(t),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_WILD_OWN_SCENE_JIESUAN",_h,"_wildOwnSceneJiesuan",e,{layer:"under",wait:On.waitRes(t)}),On.ins.registPanel("BOSS_SY_OWN_SCENE",dh,"_syBoss",e,{wait:On.waitAtlas("boss_scene"),layer:"nav",mask:!1}),On.ins.registPanel("Boss_GodWeaponFairylandScene",oh,"_boss_GodWeaponFairyland",e,{layer:"under",wait:On.waitRes(t)})}u(i,"modules.boss.proxys.BossScene_Proxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.onNote=function(){Fl.sendToModule("CHANGE_UI_SET",["modules.nav.NavModule"],["ChatSimpleUI"]),Zl.topLayer.visible=!1,ei.isPanelOnStage=!0,Fc.init()},t.subHandler=function(e){var t=this,i=0;switch(e.actionOrder){case"__LOGIN_ENTERSCENE__":case"21215":break;case"__ZHAOBAO_END__":var s=ha.ins.curCopyId;if(s<=0)return;switch(e.proto){case 6:ae.instance.currentBo=0,t.personBossZhanbaoEndOrPickOver(!0),ha.ins.iswin;break;case 15:t.personBossZhanbaoEndOrPickOver(!0),ha.ins.iswin&&(ae.instance.isNeedShowUpdate=!0)}break;case"__PICKUP_OVER__":if((s=ha.ins.curCopyId)<=0)return;i=uo.getIndex(s);var n=uo.MODEL.cate(i);2==n&&t.personBossZhanbaoEndOrPickOver(!1),30==n&&ha.ins.exitCopy();break;case"23614":case"22610":case"22154":break;case"FIGHT_BLOOD_UPDATE":ha.ins.bossBlood=e.proto.bossCurrHP,(t._wildScene||t._wildOwnScene)&&U.isFirstShowBool&&(i=uo.getIndex(ha.ins.curCopyId),xn.ins.updateBossBlood(uo.MODEL.bossId(i),ha.ins.bossBlood));break;case"22604":var o=ha.ins.toc22604=e.proto;ha.ins.ascripStatus=""+o.charId==Gi.ins.charId?0:2,ha.ins.checkCopyId(ha.ins.curCopyId,7)?t._wildOwnScene&&t._wildOwnScene.update(o):t._wildScene&&t._wildScene.update(o),t._wildScene&&t._wildScene.update(o),t._wildSceneAward&&t._wildSceneAward.update(o);break;case"22618":ha.ins.toc22604&&(ha.ins.toc22604.curHp=e.proto.blood,t._wildScene&&t._wildScene.updateAscriptorHp(ha.ins.toc22604),t._wildOwnScene&&t._wildOwnScene.updateAscriptorHp(ha.ins.toc22604));break;case"22606":var a=e.proto.dtoZhanBao;t.parseZhaobao(a,!1),t.parseZhaobao(a,!0);break;case"__BOSS_ZHANBAO_END__":a=e.proto;break;case"22616":o=ha.ins.toc22604;var r=e.proto;o&&o.charId==r.playerId&&(o.curHp=r.blood,t._wildScene&&t._wildScene.update(o));break;case"FIGHT_RELIVE":e.proto.success&&(t._wildScene&&t._wildScene.startCheckSceneShowBool(),t._wildOwnScene&&t._wildOwnScene.startCheckSceneShowBool());break;case"22109":break;case"22102":t._worldScene&&t._worldScene.update(e.proto);break;case"21220":case"21263":On.ins.open("BOSS_GOD_REFRESH",e.proto.copyId,null,!0);break;case"30401":On.ins.isOpen("BOSS_MAINVIEW")||On.ins.open("BOSS_GOD_REFRESH",e.proto.copyId,null,!0);break;case"30862":if(!On.ins.isOpen("BOSS_MAINVIEW")){var l=e.proto;On.ins.open("BOSS_GOD_REFRESH",[l.copyId,l.timesGS,l.timesXZ],null,!0)}break;case"22105":ha.ins.copyEnd=!0,On.ins.open("BOSS_WORLDBOSS_JIESUAN",e.proto);break;case"21211":t._worldScene&&t._worldScene.update(e.proto);break;case"22153":ha.ins.copyEnd=!0,On.ins.open("BOSS_WILD_OWN_SCENE_JIESUAN",e.proto);break;case"30005":var c=e.proto;Y.timer.once(1e3,t,t.openBelongReward,[c]);break;case"30342":case"30352":if("30352"==e.actionOrder||"30342"==e.actionOrder){if("30352"==e.actionOrder)e.proto.missionID==ha.ins.curCopyId&&t._syBoss&&0==t._syBoss.isSHowCopyEnd&&t._syBoss&&t._syBoss.showBossDInfo();else if("30342"==e.actionOrder){e.proto.missionID==ha.ins.curCopyId&&t._syBoss&&0==t._syBoss.isSHowCopyEnd&&t._syBoss&&t._syBoss.showBossDInfo()}}else t._syBoss&&0==t._syBoss.isSHowCopyEnd&&t._syBoss&&t._syBoss.showBossDInfo();break;case"24004":if(0<ha.ins.curCopyId){i=uo.getIndex(ha.ins.curCopyId);var d=uo.MODEL.cate(i);21!=d&&20!=d||t._syBoss&&t._syBoss.showGuiShuInfo()}break;case"10301":for(var u=e.proto,h=0;h<u.charQueue.length;h++){var _=u.charQueue[h],p=Xl.getIndex(_.modelId),f=Xl.MODEL.type(p);if(3==_.charType&&202==f){ha.ins.enterScenceBossInfo=_;break}}break;case"SCENE_COMM_SUCCESS":ha.ins.copyEnd=!0,On.ins.open("BOSS_GOD_SETTLE",e.proto)}},t.openBelongReward=function(e){On.ins.open("BOSS_BELONG_SETTLE",e)},t.parseZhaobao=function(e,t){var i=this,s=parseInt(Gi.ins.charId),n=e.attacker_id==s,o=e.isWin(s),a={};a.time=e.startTime,a.victory=o,a.attacker=n,a.rivalName=n?e.defenderName:e.attackerName,t||n||(i._wildScene&&i._wildScene.showAttackMask(),i._wildOwnScene&&i._wildOwnScene.showAttackMask());var r=!n&&o;(r&&!t||!r&&t)&&(o?i._wildScene&&uh.pushNote(a,i._wildScene._view_kill_ctn):i._wildScene?(uh.hideAll(),i._wildScene.showReliveView(a)):i._wildOwnScene?(uh.hideAll(),i._wildOwnScene.showReliveView(a)):ha.ins.reliveObj=a)},t.onStartPerson=function(e,t){ha.ins.curCopyId==e&&Fl.sendToModule("__ZHANBAO_START__",["modules.scene.SceneModule"],t)},t.personBossZhanbaoEndOrPickOver=function(e){var t=ha.ins.curCopyId;if(!(t<=0||e&&ha.ins.curVictory)){ha.ins.copyEnd=!0;var i,s,n=uo.getIndex(t),o=uo.MODEL.cate(n);if(ha.ins.curVictory)on.reqAward(t),i=ha.ins.copyReward,s="OPEN_SUCC";else{var a=new ls;a.copyId=t,Fl.sendToService(a),s="OPEN_FAIL"}Fl.sendToModule(s,["modules.fight.FightModule"],{award:i,callback:ms.create(ha.ins,ha.ins.changeSceneUI,[o,!1])})}},t.showPanel=function(e,t){var i=this;"BOSS_WILD_SCENE_AWARD"==e?ha.ins.checkCopyId(ha.ins.curCopyId,2)?0<ha.ins.wild_own_cl_count&&i._wildSceneAward.update(t):i._wildSceneAward.update(t):"BOSS_WORLDBOSS_JIESUAN"==e?(i._worldJieSuan.update(t),Pc.ins.playSound("11")):"BOSS_WILD_SCENE_JIESUAN"==e?(i._wildSceneJiesuan.update(t),Pc.ins.playSound("11")):"BOSS_WILD_OWN_SCENE_JIESUAN"==e?(i._wildOwnSceneJiesuan.update(t),Pc.ins.playSound("11")):"BOSS_GOD_SETTLE"==e?(i._godSettle.update(t),Pc.ins.playSound("11")):"BOSS_SCZB_SCENE_AWARD"==e?i._sczbSceneAward.update(t):"BOSS_BELONG_SETTLE"==e&&(i._belongSettle.update(t),Pc.ins.playSound("11"))},t.closePanel=function(e,t){"BOSS_WORLDBOSS_SCENE"==e&&(On.ins.close("BOSS_WORLDBOSS_ZHUWEI"),On.ins.close("BOSS_WORLDBOSS_JIESUAN"))},i}(),Bu=function(e){function t(){var e=this;e._mainView=null,e._mijingAlertView=null,e._mijingBossScene=null,e._mijingResultScene=null,e._boss_refreshView=null,e._godAttentionView=null,e._godRefreshView=null,e._bossHomeSubView=null,e._flyUpBossView=null,t.__super.call(e);On.ins.registPanel("BOSS_MAINVIEW",Nu,"_mainView",e,{wait:On.wait(On.waitAtlas("boss"),On.waitConfig(["MissionResource"],["CMissionModel"])),layer:"layout"}),On.ins.registPanel("BOSS_MIJING_ALERTLIST_VIEW",ju,"_mijingAlertView",e,{wait:On.waitAtlas("boss")}),On.ins.registPanel("BOSS_MIJING_SCENE",ah,"_mijingBossScene",e,{wait:On.waitAtlas("boss"),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_MIJING_RESULT_SCENE",rh,"_mijingResultScene",e,{wait:On.waitAtlas("boss"),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_REFRESH_NOTE",Ku,"_boss_refreshView",e,{clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_GOD_ATTENTION_VIEW",Uu,"_godAttentionView",e,{wait:On.wait(On.waitConfig(["lunhui"],["CLunhuiModel"])),mask:!0}),On.ins.registPanel("BOSS_GOD_REFRESH",Fu,"_godRefreshView",e,{wait:On.wait(On.waitConfig(["lunhui","CrossBossMissionResource"],["CLunhuiModel","CrossBossMissionResource"])),mask:!1,layer:"nav"}),On.ins.registPanel("BOSSHOEMSUBVIEW",Pu,"_bossHomeSubView",e,{wait:On.waitAtlas("boss"),layer:"layout"}),On.ins.registPanel("FLYUPBOSSMAINVIEW",$u,"_flyUpBossView",e,{wait:On.waitAtlas("boss"),layer:"layout"})}u(t,"modules.boss.proxys.Boss_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"21209":if(ha.ins._btnCallBossPanel){ha.ins._btnCallBossPanel=!1;var t=0<e.proto.challengeCount?"SUB_PERSON":"SUB_WILD";null!=Y.loader.getRes(Or.getLayoutsPath("boss"))?On.ins.open("BOSS_MAINVIEW",{_subId_:t}):Y.loader.load(Or.getLayoutsPath("boss"),ms.create(this,function(){On.ins.open("BOSS_MAINVIEW",{_subId_:t})}))}else this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);Aa.reqGetCanSweep(2);break;case"22151":var i=e.proto;ha.ins.wild_own_cl_count=i.hasNum;case"22357":var s=e.proto;te.ins.datas22357=s,this._mainView&&this._mainView.parent&&this._mainView.vsc.updateSelectedView();break;case"21210":var n=e.proto;ha.ins.wildBossObj=n.map,this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"21211":this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"21219":break;case"_UI_SET_CHANGED":this._boss_refreshView&&(this._boss_refreshView.visible=Xn.isNormalShow);break;case"21221":case"21264":this._boss_refreshView&&this._boss_refreshView.removeCopyId(e.proto.copyId),this._godRefreshView&&this._godRefreshView.currentCopyId==e.proto.copyId&&On.ins.close("BOSS_GOD_REFRESH");break;case"22620":var o=e.proto;if(ha.ins.wild_cl_count=o.wildBossCount,ha.ins.buyNum=o.buyNum,!He.count)return;var a=0,r=X.ins.toc_info;if(r){var l=K.getIndex(r.vipLvl),c=K.MODEL.missionCountStr(l).split(",");a=parseInt(c[1])}ha.ins.remainBuy=Math.max(a-o.buyNum,0),this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"21225":var d=e.proto;ha.ins.godBossHash=d.bossHash,ha.ins.gb_totalNum=d.challengeTimes,ha.ins.gb_leftlNum=d.challengeTimes-d.curChallengeTimes,ha.ins.gb_leftlNum<0&&(ha.ins.gb_leftlNum=0),this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"22621":ha.ins.gb_leftlNum=e.proto.challengeTimes,this._mainView&&this._mainView.vsc.updateSelectedView(e.proto);break;case"21227":var u=e.proto;On.ins.open("BOSS_GOD_REFRESH",[e.proto.missionId,u.timesGS,u.timesXZ],null,!0);break;case"OPEN_BOSS_MIJING_ALERT_VIEW":On.ins.isOpen("BOSS_MIJING_ALERTLIST_VIEW")||On.ins.open("BOSS_MIJING_ALERTLIST_VIEW",e.proto);break;case"30370":ha.ins.data30370=e.proto,this.updateRedPoint(),this._mainView&&this._mainView.vsc.updateSelectedView(e.proto),this._mijingResultScene&&this._mijingResultScene.updateBossData();break;case"30371":var h=e.proto;if(null!=ha.ins.data30370){ha.ins.data30370;for(var _=ha.ins.data30370.arrBossData,p=0;p<_.length;p++){var f=_[p];if(f.missionId==h.missionId){var g=uo.getIndex(f.missionId),v=uo.MODEL.reliveTime(g);f.time=v,this._mainView&&this._mainView.vsc.updateSelectedView(e.proto)}}}this.updateRedPoint();break;case"30372":var m=e.proto;if(null!=ha.ins.data30370)for(ha.ins.data30370,_=ha.ins.data30370.arrBossData,p=0;p<_.length;p++)(f=_[p]).missionId==m.missionId&&(f.time=0,this._mainView&&this._mainView.vsc.updateSelectedView(e.proto));this.updateRedPoint();break;case"30375":var b=e.proto;ha.ins.data30375=b,null!=this._mijingBossScene&&this._mijingBossScene.update();break;case"BP_UPDATE":if(this._mainView&&2==this._mainView.vsc.selectedIndex)for(p=0;p<Eu.SHOW_MISSIONS.length;p++){var w=Eu.SHOW_MISSIONS[p];on.reqCopy(w)}break;case"NAV_BOSS_HUDUN_OVER":var y=!1,x=Ss.heroQueue;for(p=0;p<x.length;p++){var I=x[p];if(I&&I.hero_id<4&&!I.isDeath){y=!0;break}}if(!y)return;var S=ha.ins.curCopyId;g=uo.getIndex(S),15!=(w=uo.MODEL.cate(g))&&28!=w||On.ins.open("BOSS_MIJING_SCENE",e.proto);break;case"BOSS_MIJING_RESULT":15==(w=e.proto)&&On.ins.open("BOSS_MIJING_RESULT_SCENE",e.proto);break;case"30400":var k=e.proto;if(Tu.instance.update30400(k),Tu.instance.needToShowSubView)return;this._mainView&&this._mainView.parent&&this._mainView.update(),this._bossHomeSubView&&this._bossHomeSubView.parent?this._bossHomeSubView.updateView():(!Tu.instance.needToShowSubView&&Tu.instance.needToShow&&On.ins.open("BOSSHOEMSUBVIEW",null,0),Tu.instance.needToShow||(Tu.instance.needToShow=!0));break;case"30401":var C=e.proto;if(Tu.instance.map&&Tu.instance.map[C.copyId]){var T=Se.formatNewAttrToObject(JSON.parse(Xl.MODEL.attributes(Xl.getIndex(C.bossId))));Tu.instance.map[C.copyId].blood=parseInt(T.MAXHP)}this._bossHomeSubView&&this._bossHomeSubView.parent&&this._bossHomeSubView.updateView();break;case"30402":var E=e.proto;Tu.instance.map&&Tu.instance.map[E.missionId]&&(Tu.instance.map[E.missionId].blood=0),this._bossHomeSubView&&this._bossHomeSubView.parent&&this._bossHomeSubView.updateView();break;case"__PERSONAL_BOSS_EXIT__":if(!ha.ins.backToPersonBoss)return;ha.ins.backToPersonBoss=!1,Y.timer.once(100,this,function(){On.ins.open("BOSS_MAINVIEW",{_subIndex_:0})});break;case"CATE_1_QUIT":Y.timer.once(100,this,function(){On.ins.open("COPYMAINVIEW",{index:0})});break;case"CATE_43_QUIT":Z.ins.isFinishFlyup&&(Z.ins.isFinishFlyup=0,Y.timer.once(100,this,function(){Z.ins.openFlyupBossView()}));break;case"__BOSS_HOME_EXIT__":Y.timer.once(150,this,function(){on.reqCopy(26)});break;case"10402":var L=uo.getIndex(ha.ins.curCopyId);if(15==(w=uo.MODEL.cate(L))){var A,B=e.proto;for(var D in B.goodsList)6==(A=B.goodsList[D]).subType&&Vl.ins.showGetToolInfo(A.goodsId)}break;case"OPEN_WILD_BY_ANCIENT":On.ins.open("BOSS_MAINVIEW",{_subIndex_:1},"BOSS_ANCIENT_MAINVIEW",!0);break;case"21233":var O=e.proto.canEnterID;if(0==O)return;var V=uo.getIndex(O),M=uo.MODEL.cate(V),R=0,P=!1,N=te.ins.datas22352;if(N&&0<N.leftTime){if(!ri.ins.hasEmptyNum(20)){ja.ins.showBagRecycle(),On.ins.close("BOSS_GOD_ATTENTION_VIEW");var G=new Zo;switch(M){case 3:ha.ins.wildIsAuto=!1;break;case 13:ha.ins.godIsAuto=!1}return G.isOpen=0,G.type=M,void Fl.sendToService(G)}switch(M){case 3:R=ha.ins.wild_cl_count,P=ha.ins.wildIsAuto;break;case 13:R=ha.ins.gb_leftlNum,P=ha.ins.godIsAuto;break;case 49:R=ha.ins.wild_cl_count,P=ha.ins.wildIsAuto}if(R<=0)return void Vl.ins.showMsg(ed.n[1587],1);if(0==P)return;if(!Wc.isEnabledChangeScene()&&J.dtoEnterScene&&49!=J.dtoEnterScene.type)return;Y.timer.once(700,this,this.enterWillBoss,[O])}break;case"22623":var U=e.proto;Z.ins.buyNum=U.buyNum,Z.ins.flyup_cl_count=U.flyupBossCount;var H=0,F=X.ins.toc_info;if(F&&0<K.count){var z=K.getIndex(F.vipLvl),W=K.MODEL.missionCountStr(z).split(";");if(1<W.length)H=parseInt(W[2].split(",")[1])}Z.ins.remainBuy=Math.max(H-U.buyNum,0),this._mainView&&this._mainView.vsc.updateSelectedView(U);break;case"21259":var j=e.proto;if(Z.ins.updateInfo(j),1==ha.ins.isfirst_flyup)return void(ha.ins.isfirst_flyup=!1);this._mainView&&this._mainView.vsc.updateSelectedView(j);break;case"21261":On.ins.open("BOSS_GOD_REFRESH",e.proto.copyId,null,!0);break;case"OPEN_FS_BOSS_VIEW":On.ins.open("BOSS_MAINVIEW",{_subId_:"SUB_FLYUP_BOSS"});break;case"UPDATE_FLYUP_LIST":this._mainView&&this._mainView.vsc.updateSelectedView();break;case"30007":var q=e.proto;this._mainView&&this._mainView.vsc.updateSelectedView(q)}},i.enterWillBoss=function(e){na.ins.isMatching||(On.ins.isOpen("COPYMAINVIEW")&&On.ins.close("COPYMAINVIEW"),ha.ins.autoBossId=e,on.reqEntry(e),Y.timer.clear(this,this.enterWillBoss))},i.updateRedPoint=function(){var e=ha.ins.data30370;if(null!=e&&0<e.curChallengeTimes)for(var t=ha.ins.data30370.arrBossData,i=0;i<t.length;i++){var s=t[i],n=s.missionId,o=uo.getIndex(n),a=uo.MODEL.zsLevelLimit(o),r=uo.MODEL.zsLevelUpLimit(o);if(s.curCD<=0&&Gi.ins.zsLv>=a&&Gi.ins.zsLv<=r){!0;break}}},i.showPanel=function(e,t){var i=this;switch(e){case"BOSS_MAINVIEW":t&&(t.copyId?i._mainView.vsc.updateSelectedView(t):i._mainView.vsc.selectedIndex=t),Pc.ins.playSound("15");break;case"BOSS_MIJING_ALERTLIST_VIEW":case"BOSS_WILDNOTE_VIEW":case"BOSS_WORLDRANK_VIEW":break;case"BOSS_REFRESH_NOTE":t&&i._boss_refreshView.update(t),i._boss_refreshView.visible=Xn.isNormalShow;break;case"BOSS_GOD_REFRESH":t&&i._godRefreshView.update(t),i._godRefreshView.visible=Xn.isNormalShow;break;case"BOSS_GOD_ATTENTION_VIEW":i._godAttentionView&&i._godAttentionView.parent&&i._godAttentionView.updatePanel(t.type);break;case"BOSSHOEMSUBVIEW":i._bossHomeSubView&&i._bossHomeSubView.parent&&i._bossHomeSubView.updateView();break;case"FLYUPBOSSMAINVIEW":i._flyUpBossView&&i._flyUpBossView.parent&&i._flyUpBossView.updateView()}},i.closePanel=function(e,t){},t}(),Du=function(e){function i(){var e=this;e.boss_enterView=null,e.boss_copyView=null,e.boss_zhuweiView=null,e.boss_yqView=null,e.boss_hurtView=null,e.boss_resultView=null,e.wbData=null,i.__super.call(e);var t=[Or.getLayoutsPath("fightresult"),Or.getAtlasSubPath("boss")];On.ins.registPanel("WB_ENTER_PANEL",bh,"boss_enterView",e,{wait:On.waitAtlas("boss"),layer:"layout"}),On.ins.registPanel("WB_HURT_RANK_PANEL",Sh,"boss_hurtView",e,{wait:On.waitAtlas("boss"),mask:!0}),On.ins.registPanel("WB_ZW_PANEL",Th,"boss_zhuweiView",e,{wait:On.waitAtlas("boss"),mask:!0}),On.ins.registPanel("WB_RESULT_PANEL",kh,"boss_resultView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(Vs.wboss_A,Vs.wboss_C)),mask:!0,clickClose:!1}),On.ins.registPanel("WB_YQ_PANEL",Ch,"boss_yqView",e,{layer:"nav",mask:!1}),On.ins.registPanel("WB_MAIN_PANEL",yh,"boss_copyView",e,{wait:On.wait(On.waitAtlas("boss"),On.waitConfig(Vs.wboss_A,Vs.wboss_C)),layer:"bottom"}),e.wbData=Lu.instance}u(i,"modules.boss.proxys.Boss_WorldBossProxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_WB_ENTER_PANEL":t.wbData.reqWB_BaseDataInfo(),e.proto&&(t.wbData.missId=parseInt(e.proto.toString()));break;case"21252":Lu.instance.toc2152=e.proto,On.ins.open("WB_ENTER_PANEL");break;case"OPEN_WB_HURT_RANK_PANEL":On.ins.open("WB_HURT_RANK_PANEL");break;case"24051":t.wbData.copyPersonNum=e.proto.playerNum,t.boss_copyView&&t.boss_copyView.showGuildCurrentPerson(e.proto.playerNum);break;case"24050":t.wbData.copyHurtList=e.proto.hurtList,t.boss_copyView&&t.boss_copyView.showGuildCurrentHurt(e.proto.hurtList);break;case"24052":t.boss_copyView&&t.boss_copyView.showZhuWeiHurt(e.proto.zhuweiNum),t.boss_zhuweiView&&t.boss_zhuweiView.refreshGuildZWNum(e.proto.zhuweiNum);break;case"OPEN_WB_ZW_PANEL":t.wbData.reqWB_ZWInfo();break;case"21254":On.ins.open("WB_ZW_PANEL",e.proto);break;case"21255":t.boss_zhuweiView&&t.boss_zhuweiView.parent&&t.boss_zhuweiView.refreshNum(e.proto);break;case"21250":Xn.isNormalShow&&On.ins.open("WB_YQ_PANEL",e.proto);break;case"21258":On.ins.close("WB_ZW_PANEL"),On.ins.open("WB_RESULT_PANEL",e.proto)}},t.showPanel=function(e,t){var i=this;"WB_ENTER_PANEL"==e?i.boss_enterView&&i.boss_enterView.showBaseInfo():"WB_ZW_PANEL"==e?i.boss_zhuweiView&&i.boss_zhuweiView.showCurrentZhuWei(t):"WB_YQ_PANEL"==e?i.boss_yqView&&i.boss_yqView.showInfo(t):"WB_RESULT_PANEL"==e&&i.boss_resultView&&i.boss_resultView.showResultInfo(t)},t.closePanel=function(e,t){},i}(),Ou=function(e){function t(){this._vo=null,this._gridsList=null,this._effect=null,t.__super.call(this)}u(t,"modules.boss.views.bosshome.BossHomeMainRenderView",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new ga(5),e._gridsList.isClearUrl=!1,e._gridsList.pos(2,149),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=9,e._gridsList._gridH=e._gridsList._gridW=93,e._gridsList._gnameY=e._gridsList._gridH+2,e._gridsList._gsimpleName=!0,e._gridsList._hScrollBarSkin=null,e._gridsList._vScrollBarSkin=null,e.addChild(e._gridsList)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onGoClicked)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t._effect&&(t._effect.removeSelf(),t._effect.destroy(),t._effect=null),t.btn_go.off("click",t,t.onGoClicked)},i.destroy=function(e){void 0===e&&(e=!0),Y.loader.clearRes(this.font_ceng.skin),laya.ui.View.prototype.destroy.call(this,e)},i.onGoClicked=function(e){var t=this;if(t._vo){var i;i=t._vo.vipLimit[0];var s=0;if(1==t._vo.vipLimit.length)Gi.ins.VIPLevel<i?Vl.ins.showById2(3906,[i],1):(Tu.instance.currentSubSelected=t._vo.id-1,on.reqCopy(26));else if(2==t._vo.vipLimit.length){s=t._vo.vipLimit[1];var n="";Gi.ins.VIPLevel>=i&&Gi.ins.VIPLevel<=s?(Tu.instance.currentSubSelected=t._vo.id-1,on.reqCopy(26)):(n=i+"～"+s,Vl.ins.showById2(4959,[n],1))}}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(B,t,"dataSource",e),e){switch(t._vo=e,t._vo.type){case 1:t.box_kuang.visible=!1,t.img_levelEff.skin=Or.getAtlasSubPath("basic_ui_g/ty_fbbt_db.png"),t.img_zhuanshu.skin=Or.getAtlasSubPath("boss/bosszj_dt_vip.png"),t._effect&&(t._effect.removeSelf(),t._effect.destroy(),t._effect=null);break;case 2:if(t.box_kuang.visible=!0,t.img_levelEff.skin=Or.getAtlasSubPath("boss/bosszj_vip_gx.png"),t.img_zhuanshu.skin=Or.getAtlasSubPath("boss/bosszj_vip_zs.png"),null==t._effect){t._effect=Es.GetNew(),t._effect.loadEffect("jm1553"),t._effect.renderInSelf=!0;var i=t.getChildIndex(t.img_di);t.addChildAt(t._effect,i),t._effect.pos(t.img_di.x+140,t.img_di.y+32)}}t.img_bg.skin=Or.getFullUrl("ui/images/boss/bosshome/main_"+t._vo.type+"_"+t._vo.level+".jpg");var s=Zc.getIndex(t._vo.dectId);t.txt_dect.text=Zc.MODEL.content(s),t.img_vip.skin=Or.getAtlasSubPath("basic_ui_n/num1_vip.png"),t.txt_refresh.text="每"+t._vo.refreshTime/V.HOUR_SECOND+ed.n[1588],t._gridsList.setGoodsItems(t._vo.rewardStr,3),t.img_ceng.skin=Or.getAtlasSubPath("boss/bosszj_cs_vip_dc.png"),t.font_ceng.value=t._vo.level.toString();var n=!1,o=0;if(o=t._vo.vipLimit[0],1==t._vo.vipLimit.length)Gi.ins.VIPLevel>=o&&(n=Tu.instance.getRedPt(e.bossIDArr)),t.font_vipDown.visible=!1,t.font_vipUp.value=o.toString(),t.img_di.skin=Or.getAtlasSubPath("boss/bosszj_cs_d.png"),t.font_vipUp.x=600-16*t.font_vipUp.value.length-5;else if(2==t._vo.vipLimit.length){var a=t._vo.vipLimit[1];t.font_vipDown.visible=!0,t.font_vipUp.value=o.toString(),t.font_vipDown.value=a.toString(),Gi.ins.VIPLevel>=o&&Gi.ins.VIPLevel<=a&&(n=Tu.instance.getRedPt(e.bossIDArr)),t.img_di.skin=Or.getAtlasSubPath("boss/bosszj_cs_vip_d.png"),t.font_vipDown.x=600-16*t.font_vipDown.value.length-3,t.img_tiao.x=t.font_vipDown.x-t.img_tiao.width+2,t.font_vipUp.x=t.img_tiao.x-16*t.font_vipUp.value.length-2}t.img_tiao.visible=t.font_vipDown.visible,t.img_vip.x=t.font_vipUp.x-t.img_vip.width+3,t.font_ceng.x=t.img_di.x+t.img_di.width-20,t.img_ceng.x=t.font_ceng.x+(54+t.font_ceng.spaceX)*t.font_ceng.value.length,t.img_vip_kuang.width=t.width-15-t.img_vip.x+30,t.img_vip_kuang.x=t.img_vip.x-40,t.btn_go.showTip=n}}),t}(B),Vu=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.bosshome.BossHomeMainView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this.list_level.itemRender=Ou,this.list_level.vScrollBarSkin="",this.list_level.selectEnable=!1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),Tu.instance.needToShow=!1,on.reqCopy(26),t.link_open.visible=!1,t.link_open.on("click",t,t.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.link_open.off("click",this,this.onClickHandler)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.updateList=function(){this.list_level.dataSource=Tu.instance.cofigArr,this.setSelected()},i.setSelected=function(){for(var e,t=Tu.instance.cofigArr,i=0,s=0,n=t.length-1;0<n;n--)if(i=(e=t[n]).vipLimit[0],1==e.vipLimit.length){if(Gi.ins.VIPLevel>=i&&Tu.instance.getRedPt(e.bossIDArr)){n;break}}else if(2==e.vipLimit.length&&(s=e.vipLimit[1],Gi.ins.VIPLevel>=i&&Gi.ins.VIPLevel<=s&&Tu.instance.getRedPt(e.bossIDArr))){n;break}this.list_level.scrollTo(n)},i.onClickHandler=function(e){Fl.sendToModule("OPEN_RECHARGE",["modules.recharge.RechargeModule"],0)},t}(ci),Mu=function(e){function t(){this._vo=null,t.__super.call(this)}u(t,"modules.boss.views.bosshome.BossHomeSubLevelRenderView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.g_red.visible=!1,t.on("click",t,t.onItemClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onItemClicked)},i.onItemClicked=function(e){var t,i=this;if(null!=i._vo)if(t=i._vo.vipLimit[0],1==i._vo.vipLimit.length){if(t>Gi.ins.VIPLevel)return void Vl.ins.showById2(3906,[i._vo.vipLimit],1)}else if(2==i._vo.vipLimit.length){var s=i._vo.vipLimit[1];if(Gi.ins.VIPLevel<t||Gi.ins.VIPLevel>s)return void Vl.ins.showById2(4959,[t+"～"+s],1)}},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(Ln,t,"dataSource",e),e){switch(t._vo=e,t.img_bg.skin=Or.getFullUrl("ui/images/boss/bosshome/sub_"+t._vo.type+"_"+t._vo.level+".png"),t._vo.type){case 1:t.img_title1.skin=Or.getAtlasSubPath("boss/bosszj_btn_zj.png"),t.img_title1.x=10,t.font_level.x=130,t.img_ceng.x=150;break;case 2:t.img_title1.skin=Or.getAtlasSubPath("boss/bosszj_btn_vip_zj.png"),t.img_title1.x=40,t.font_level.x=98,t.img_ceng.x=120}t.img_selected.visible=t._vo.selected,t.box_go.visible=!t._vo.selected,t.font_level.value=t._vo.level.toString();var i,s=!1;if(i=t._vo.vipLimit[0],1==t._vo.vipLimit.length)Gi.ins.VIPLevel>=i&&(s=Tu.instance.getRedPt(e.bossIDArr));else if(2==t._vo.vipLimit.length){var n=t._vo.vipLimit[1];Gi.ins.VIPLevel>=i&&Gi.ins.VIPLevel<=n&&(s=Tu.instance.getRedPt(e.bossIDArr))}t.g_red.visible=s}}),t}(Ln),Ru=function(e){function t(){var e=this;e._BAR_W=0,e._gridsList=null,e.state=0,e.limitDown=0,e.limitUp=0,e._info=null,t.__super.call(e)}u(t,"modules.boss.views.bosshome.BossHomeSubMonsterRenderView",e);var i=t.prototype;return i.initialize=function(){var e=this;e._gridsList=new W(5,!1),e._gridsList.isClearUrl=!1,e._gridsList.pos(150,34),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=5,e._gridsList._gsimpleName=!0,e._gridsList.owerModule=t.Name,e.addChild(e._gridsList)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._BAR_W=t.bar.width,t.btn_challenge.on("click",t,t.onClickHanlder)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_challenge.off("click",this,this.onClickHanlder)},i.dis=function(){},i.onClickHanlder=function(e){if(this.dataSource)if(ri.ins.hasEmptyNum(20))if(Wc.isEnabledChangeScene()){var t=Tu.instance.currentCoolTime-J.serverTimeSec;0<t?Vl.ins.showById2(3907,[t],1):this.enterCopy()}else Vl.ins.showById(2126,1);else ja.ins.showBagRecycle()},i.enterCopy=function(){var e=this;0<e.limitDown?e.limitDown==e.limitUp?Gi.ins.VIPLevel!=e.limitDown?Vl.ins.showById2(4959,[e.limitDown],1):e.enter():Gi.ins.VIPLevel>=e.limitDown&&Gi.ins.VIPLevel<=e.limitUp?e.enter():Vl.ins.showById2(4959,[e.limitDown+"～"+e.limitUp],1):e.enter()},i.enter=function(){on.reqEntry(this.dataSource.id),this._gridsList.isClearUrl=!0},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(Li,t,"dataSource",e),e){var i,s,n=uo.getIndex(e.id),o=n,a=uo.MODEL.bossId(n),r=uo.MODEL.extraCondition(n);if(t.txt_vip.changeText(""),r){i=JSON.parse(r);for(var l=0;l<i.length;l++)if("playerVipLevelRange"==(s=i[l]).type){var c=s.value.split(",");t.limitDown=parseInt(c[0]),t.limitUp=parseInt(c[1]),t.limitDown==t.limitUp&&Gi.ins.VIPLevel!=t.limitDown?t.txt_vip.color="#f52d23":t.limitDown!=t.limitUp&&(Gi.ins.VIPLevel<t.limitDown||Gi.ins.VIPLevel>t.limitUp)?t.txt_vip.color="#f52d23":t.txt_vip.color="#23b11f",t.limitDown==t.limitUp?t.txt_vip.changeText("VIP"+t.limitDown+"专属"):t.txt_vip.changeText("VIP"+t.limitDown+"～"+t.limitUp+"专属")}}n=Xl.getIndex(a);var d=Xl.MODEL.muId(n),u=Xl.MODEL.name(n),h=Xl.MODEL.level(n);n=Cs.getIndex(d);var _=Cs.MODEL.headId(n);t.txt_name.text=u;var p=uo.MODEL.levelLimit(o),f=uo.MODEL.zsLevelLimit(o);t.txt_level.text=t.txt_dect.text=0<f?f+"转":0<p?p+"级":h+"级",t._info=Tu.instance.map[e.id];var g=t._info.blood,v=t._info.status,m=dn.takeMonsterModelProtoData(a),b=Se.formatNewAttrToObject(JSON.parse(Xl.MODEL.attributes(Xl.getIndex(a))));if(m){1==v&&0==g?g=m.hp-1:0==v&&(g=0);var w=g/b.MAXHP;1<w&&(w=1),1<w&&(w=1);var y=t.bar.scrollRect||new qo(0,0,t.bar.width,t.bar.height);y.width=t._BAR_W*w,t.bar.scrollRect=y}g<=0?(t.txt_dect.visible=!0,t.txt_dect.text="已击杀"):Gi.ins.zsLv<f?(t.txt_dect.visible=!0,t.txt_dect.changeText(f+"转开启")):Gi.ins.lv<p?(t.txt_dect.visible=!0,t.txt_dect.changeText(p+"级开启")):t.txt_dect.visible=!1,t.btn_challenge.visible=!t.txt_dect.visible}var x=_&&"0"!=_?t.img_boss.skin=Or.getBossPath(_):"";if(t.img_boss.skin&&t.img_boss.skin!=x){var I=mi.getRes(t.img_boss.skin);I&&(I.destroy(),mi.clearRes(t.img_boss.skin),un.ins.clearTexture(t.img_boss.skin))}t.img_boss.skin=x;r=uo.MODEL.bossShowAward(o);t._gridsList.setGoodsItems(r,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight)}),t.Name="BOSS_HOME_AWARD_GOODS",t}(Li),Pu=function(t){function i(){var e=this;e._lastRequestTime=0,e._currentIndex=0,e._lastRefreshTime=NaN,i.__super.call(e),e.title=Or.getAtlasSubPath("boss/bosszj_text_bosszj.png")}u(i,"modules.boss.views.bosshome.BossHomeSubView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e.list_level.itemRender=Mu,e.list_level.hScrollBarSkin="",e.list_level.selectEnable=!0,e.list_level.selectHandler=ms.create(e,e.onLevelSelected,null,!1),e.list_monster.itemRender=Ru,e.list_monster.vScrollBarSkin=""},e.onLevelSelected=function(e){var t=this,i=t.list_level.array[e];if(null!=i){var s;if(s=i.vipLimit[0],t._lastRefreshTime=Tu.instance.timeMap[i.id],1==i.vipLimit.length){if(s>Gi.ins.VIPLevel)return void(t.list_level.selectedIndex=Tu.instance.currentSubSelected);t.txt_vip.text="VIP"+s+ed.n[1589]}else if(2==i.vipLimit.length){var n=i.vipLimit[1];if(Gi.ins.VIPLevel<s||Gi.ins.VIPLevel>n)return void(t.list_level.selectedIndex=Tu.instance.currentSubSelected);t.txt_vip.text="VIP"+s+"～"+n+ed.n[1590]}i.selected=!0,Tu.instance.currentSubSelected=e;for(var o=0;o<t.list_level.array.length;o++){var a=t.list_level.array[o];if(o!=e&&a.selected){a.selected=!1,t.list_level.changeItem(o,a);break}}switch(i.type){case 1:t.img_title.skin=Or.getAtlasSubPath("boss/bosszj_cs_wz.png"),t.img_title.x=160,t.font_level.x=410,t.img_ceng.x=437;break;case 2:t.img_title.skin=Or.getAtlasSubPath("boss/bosszj_cs_vip_x.png"),t.img_title.x=150,t.font_level.x=430,t.img_ceng.x=457}t.updateMonster(),t.font_level.value=i.level+""}},e.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_remind.on("click",t,t.onRemindClicked),t.btn_left.on("click",t,t.onBtnLeftClicked),t.btn_right.on("click",t,t.onBtnRightClicked),t.list_level.dataSource=Tu.instance.cofigArr,t._lastRequestTime=J.serverTimeSec,t.timer.loop(1e3,t,t.loop),t.delayReqViewData(1e4),t.list_monster.scrollBar.on("change",t,t.onScrollChanged)},e.loop=function(){var e=this._lastRefreshTime/1e3-J.serverTimeSec;e<=0&&5<J.serverTimeSec-this._lastRequestTime&&(on.reqCopy(26),this._lastRequestTime=J.serverTimeSec),this.txt_coungDount.text="("+V.getHMSTimeString(e<=0?0:e)+ed.n[1591]},e.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.txt_remind.off("click",t,t.onRemindClicked),t.btn_left.off("click",t,t.onBtnLeftClicked),t.btn_right.off("click",t,t.onBtnRightClicked),t.timer.clear(t,t.loop),Y.timer.clear(t,t.reqViewData),t.list_monster.scrollBar.off("change",t,t.onScrollChanged)},e.onScrollChanged=function(){var e=this;0==e.list_monster.scrollBar.max||e.list_monster.scrollBar.value>=e.list_monster.scrollBar.max?e.g_mask.visible=!1:e.g_mask.visible=!0},e.onRemindClicked=function(e){On.ins.open("BOSS_GOD_ATTENTION_VIEW",{type:26,selectedIndex:this.list_level.selectedIndex})},e.onBtnLeftClicked=function(e){0<this._currentIndex&&(this._currentIndex--,this.list_level.scrollTo(this._currentIndex))},e.onBtnRightClicked=function(e){var t=this;t._currentIndex<t.list_level.array.length-3&&(t._currentIndex++,t.list_level.scrollTo(t._currentIndex))},e.delayReqViewData=function(e){Y.timer.loop(e,this,this.reqViewData)},e.reqViewData=function(){on.reqCopy(26)},e.updateView=function(){var e=this;e.list_level.selectedIndex!=Tu.instance.currentSubSelected&&(e.list_level.selectedIndex=Tu.instance.currentSubSelected,e.list_level.scrollTo(e.list_level.selectedIndex),e._currentIndex=e.list_level.selectedIndex),e.updateMonster();for(var t=0;t<e.list_level.array.length;t++){var i=e.list_level.array[t];if(i.selected){e.list_level.changeItem(t,i);break}}},e.updataList=function(){for(var e=0;e<this.list_level.array.length;e++){var t=this.list_level.array[e];this.list_level.changeItem(e,t)}},e.updateMonster=function(){var e,t,i,s=this,n=[];if(s.list_level&&(t=s.list_level.selectedItem),t&&(i=t.bossIDArr),i){for(var o=0;o<i.length;o++)(e=new Object).id=parseInt(i[o]),e.status=s.getStatus(i[o]),e.selected=Tu.instance.map[i[o]].selected,n.push(e);Y.timer.once(60,s,s.setBoss,[n])}},e.setBoss=function(e){this.list_monster.dataSource=e.sort(this.sortArray)},e.sortArray=function(e,t){var i=0,s=0;return 0==e.status?i+=2:1==e.status&&(i+=1),e.selected&&(i+=1),0==t.status?s+=2:1==t.status&&(s+=1),t.selected&&(s+=1),i==s?-(e.id-t.id):i-s},e.getStatus=function(e){var t,i,s=uo.getIndex(e),n=uo.MODEL.levelLimit(s),o=0,a=0,r=uo.MODEL.extraCondition(s);if(Gi.ins.lv<n)return 0;if(n=uo.MODEL.zsLevelLimit(s),Gi.ins.zsLv<n)return 0;if(Tu.instance.map[e].blood<=0)return 1;if(r){t=JSON.parse(r);for(var l=0;l<t.length;l++)if("playerVipLevelRange"==(i=t[l]).type){var c=i.value.split(",");if((a=parseInt(c[0]))==(o=parseInt(c[1]))&&Gi.ins.VIPLevel<o)return 0;if(a!=o&&(Gi.ins.VIPLevel<a||Gi.ins.VIPLevel>o))return 0}}return 2},e.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),Y.timer.clear(this,this.reqViewData)},i.NAME="BOSSHOEMSUBVIEW",i}(S),Nu=function(e){function n(){var e=this;e.SHOW_MISSIONS=[15],e.vsc=null,e._mijingOpenLv=0,e._godOpenDay=0,n.__super.call(e),e.top=e.bottom=e.left=e.right=0}u(n,"modules.boss.views.BossMainView",vs);var t=n.prototype;return t.initialize=function(){var e=this;this._mijingOpenLv=parseInt(Ta.MODEL.value(Ta.getIndex(142))),this._godOpenDay=parseInt(Ta.MODEL.value(Ta.getIndex(162))),this.navList=["ui/layouts/boss/btn_tab_grbs.png","ui/layouts/boss/yq_btn_ywb.png","ui/layouts/boss/yq_btn_fsb.png","ui/layouts/boss/yq_btn_syb2.png","ui/layouts/boss/yq_btn_bzj.png","ui/layouts/boss/yq_btn_jpjl.png"];this.vsc=new o(this),this.vsc.registAll([{cls:Yu,id:"SUB_PERSON",isHideBg:!0,wait:On.wait(On.waitConfig(["MissionKillResource"],["MissionKillResource"]))},{cls:Xu,id:"SUB_WILD",isHideBg:!0,wait:On.wait(On.waitConfig(["ConfigVip","ConfigWorldBoss","ConfigWildBossTimes","lunhui"],["ConfigVip","ConfigWorldBoss","ConfigWildBossTimes","CLunhuiModel"]))},{cls:$u,id:"SUB_FLYUP_BOSS",isHideBg:!0,wait:On.wait(On.waitConfig(["FlyUPBoss","ConfigVip"],["CFlyupBoss","ConfigVip"])),grayTip:function(){Vl.ins.showMsg(ed.n[1592],1)}},{cls:zu,id:"SUB_WILD_GOD",isHideBg:!0,grayTip:function(){Vl.ins.showMsg(ed.n[1593]+ur.WORDS[e._godOpenDay]+ed.n[1594],1),Pc.ins._playLevelNot()}},{cls:Vu,id:"SUB_BOSS_HOME",isHideBg:!0,wait:On.wait(On.waitConfig(["BossHome"],["BossHome"]))},{cls:th,id:"SUB_JIPIN_VIEW",isHideBg:!0,wait:On.wait(On.waitConfig(["CrossBossMissionResource"],["CrossBossMissionResource"]))}]),this.vsc.selectHandler=ms.create(this,this.onViewChanged,null,!1),this.vsc.filterHandler=ms.create(this,this.checkTips,null,!1)},t.onViewChanged=function(e,t){var i=this,s=!0;"SUB_PERSON"==e?i.setTitle(Or.getAtlasSubPath("boss/boss_text_grboss.png")):"SUB_JIPIN_VIEW"==e?i.setTitle(Or.getAtlasSubPath("boss/jpjl_text_jpjl.png")):"SUB_WILD"==e?i.setTitle(Or.getAtlasSubPath("boss/boss_text_ywboss.png")):"SUB_WORLD"==e?s=!1:"SUB_WILD_OWN"==e||("SUB_WILD_GOD"==e?i.setTitle(Or.getAtlasSubPath("boss/boss-text-syboss.png")):"SUB_MIJING"==e?(i.setTitle(Or.getAtlasSubPath("boss/boss_text_myboss.png")),s=!1):"SUB_BOSS_HOME"==e?(i.setTitle(Or.getAtlasSubPath("boss/bosszj_text_bosszj.png")),s=!1):"SUB_FLYUP_BOSS"==e&&i.setTitle(Or.getAtlasSubPath("boss/fsboss_text_fsboss.png"))),i.img_txt_bg.visible=s,i.delayReqViewData(1e4,e),n.curTab=i.vsc.selectedIndex,i.bg.skin="SUB_BOSS_HOME"==e?Or.getAtlasSubPath("boss/jjwf_img_bg.jpg"):Or.getAtlasSubPath("boss/gq_bj.jpg")},t.checkTips=function(e,t){if("SUB_PERSON"==e&&Qr.ins.getStateByCareList([72]))return 3;if("SUB_WILD"==e&&Qr.ins.getStateByCareList([62]))return 3;if("SUB_WORLD"==e&&Qr.ins.getStateByCareList([63]))return 3;if("SUB_WILD_GOD"==e){if(Gi.ins.lv<80||this._godOpenDay>J.getOpenServiceDay())return 1;if(Qr.ins.getStateByCareList([66]))return 3}else if("SUB_MIJING"==e){if(!this.isOpenMijing())return 1;if(Qr.ins.getStateByCareList([105]))return 3}else{if("SUB_BOSS_HOME"==e&&Qr.ins.getStateByBtnName("BTN_BOSS_HOME"))return 3;if("SUB_FLYUP_BOSS"==e&&Qr.ins.getStateByBtnName("BTN_BOSS_FLYUP"))return 3}return 0},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.panelName="bossView";var i=ms.create(t,t.redPtUpdate,null,!1);Qr.ins.addListener("btn_personal_boss",[72],i),Qr.ins.addListener("btn_wild_boss",[62],i),Qr.ins.addListener("btn_world_boss",[63],i),Qr.ins.addListener("btn_god_boss",[66],i),Qr.ins.addListener("btn_mijing_boss",[105],i),Qr.ins.addListener("BTN_BOSS_HOME",[69],i),Qr.ins.addListener("BTN_BOSS_FLYUP",[254],i),Qr.reqRedPt([62,69,254]);for(var s=0;s<t.SHOW_MISSIONS.length;s++){var n=t.SHOW_MISSIONS[s];on.reqCopy(n)}},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Qr.ins.removeListener("btn_personal_boss"),Qr.ins.removeListener("btn_wild_boss"),Qr.ins.removeListener("btn_world_boss"),Qr.ins.removeListener("btn_god_boss"),Qr.ins.removeListener("btn_mijing_boss"),Qr.ins.removeListener("BTN_BOSS_HOME"),Qr.ins.removeListener("BTN_BOSS_FLYUP"),Y.timer.clear(this,this.reqViewData)},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.isOpenMijing=function(){return Gi.ins.zsLv>=this._mijingOpenLv},t.destroy=function(e){var t=this;void 0===e&&(e=!0),!On.ins.isOpen("BOSS_ANCIENT_MAINVIEW")&&t.bg&&t.bg.skin&&Y.loader.clearRes(t.bg.skin),(On.ins.isOpen("BOSSHOEMSUBVIEW")||On.ins.isOpen("BOSS_ANCIENT_MAINVIEW")||1!=la.ins.isActToView)&&(Y.timer.clear(t,t.reqViewData),ui.SubPanel.prototype.destroy.call(t,e))},t.delayReqViewData=function(e,t){Y.timer.clear(this,this.reqViewData),Y.timer.loop(e,this,this.reqViewData,[t])},t.reqViewData=function(e){switch(e){case"SUB_WILD":on.reqCopy(3),on.reqCopy(49);break;case"SUB_MIJING":on.reqCopy(15);break;case"SUB_WILD_GOD":on.reqCopy(13);break;case"SUB_FLYUP_BOSS":on.reqCopy(47)}},t.update=function(){this.vsc.selectedView instanceof modules.boss.views.bosshome.BossHomeMainView&&this.vsc.selectedView.updateList&&this.vsc.selectedView.updateList()},n.TAB_PERSON="0",n.TAB_WILD="1",n.TAB_FLYUP="2",n.TAB_GOD="3",n.TAB_BOSSHOME="4",n.curTab=0,n}(),Gu=function(e){function t(){this.target=null,this.type=0,t.__super.call(this)}u(t,"modules.boss.views.Boss_GodAttentionItem",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.cb_attention.on("click",t,t.onCbHandler),t.cb_attention.visible=t.txt_unLevel.visible=!1},i.onRemove=function(e){this.cb_attention.off("click",this,this.onCbHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.getIsOpen=function(){var e=uo.getIndex(this.target.id),t=uo.MODEL.levelLimit(e),i=uo.MODEL.lunHuiLevelLimit(e);if(Gi.ins.lunhuiId<i)return!1;if(Gi.ins.lv<t)return!1;if(t=uo.MODEL.zsLevelLimit(e),Gi.ins.zsLv<t)return!1;var s,n,o=uo.MODEL.extraCondition(e);if(o){var a=0,r=0;s=JSON.parse(o);for(var l=0;l<s.length;l++)if("playerVipLevelRange"==(n=s[l]).type){var c=n.value.split(",");return((a=parseInt(c[0]))!=(r=parseInt(c[1]))||Gi.ins.VIPLevel==a)&&(a==r||!(Gi.ins.VIPLevel<a||Gi.ins.VIPLevel>r))}}return!0},i.setAttention=function(){var e=this,t=1,i=0;switch(e.type){case 49:case 3:ha.ins.wildBossObj[e.target.id]&&(i=e.target.id,e.cb_attention.selected=ha.ins.wildBossObj[i.toString()].selected);break;case 13:ha.ins.godBossHash.take(e.target.id)&&(t=ha.ins.godBossHash.take(e.target.id).select,e.cb_attention.selected=1!=t);break;case 26:Tu.instance.map[e.target.id]&&(i=e.target.id,e.cb_attention.selected=0==Tu.instance.map[i.toString()].selected);break;case 47:Z.ins.map[e.target.id]&&(i=e.target.id,e.cb_attention.selected=0==Z.ins.map[i.toString()].selected);break;case 53:L.ins.crossBossData.map[e.target.id]?(i=e.target.id,e.cb_attention.selected=0==L.ins.crossBossData.map[i.toString()].selected):(i=e.target.id,e.cb_attention.selected=!0)}},i.onCbHandler=function(e){var t=this;switch(t.type){case 49:case 3:ha.ins.wildBossObj[t.target.id].selected=t.cb_attention.selected;break;case 13:ha.ins.godBossHash.take(t.target.id).select=t.cb_attention.selected?0:1;break;case 26:Tu.instance.map[t.target.id].selected=t.cb_attention.selected?0:1;break;case 47:Z.ins.map[t.target.id].selected=t.cb_attention.selected?0:1;break;case 53:L.ins.crossBossData.map[t.target.id]?L.ins.crossBossData.map[t.target.id].selected=t.cb_attention.selected?0:1:L.ins.crossBossData.map[t.target.id]={id:t.target.id,selected:t.cb_attention.selected?0:1}}var i=new le;i.copyId=t.target.id,i.selected=t.cb_attention.selected,Fl.sendToService(i),26==t.type&&on.reqCopy(26),t.event("end")},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.target=e;var i,s=uo.getIndex(t.target.id),n=s,o=uo.MODEL.bossId(s);53==t.target.cate&&(o=Dc.MODEL.bossId(Dc.getIndex(t.target.id)),i=L.ins.getBossServer(t.target.id)),t.type=uo.MODEL.cate(s),s=Xl.getIndex(o);var a=Xl.MODEL.name(s);53==t.target.cate&&(a=i+a),t.txt_bname.changeText(a);var r=Xl.MODEL.muId(s),l=Xl.MODEL.level(s);s=Cs.getIndex(r);var c=uo.MODEL.levelLimit(n),d=uo.MODEL.zsLevelLimit(n),u=uo.MODEL.lunHuiLevelLimit(n),h=_l.getIndex(u),_=(_l.MODEL.level(h),_l.MODEL.tier(h),"");0<u&&(_=_l.MODEL.levelName(h)),0<u?t.txt_blevel.changeText(_):0<d?t.txt_blevel.changeText(d+"转"):0<c?t.txt_blevel.changeText(c+"级"):t.txt_blevel.changeText(l+"级"),t.txt_unLevel.visible=!t.getIsOpen(),t.cb_attention.visible=!t.txt_unLevel.visible,t.setAttention()}}),t}(Ho),Uu=function(e){function t(){this.toc=null,this._type=0,t.__super.call(this)}u(t,"modules.boss.views.Boss_GodAttentionView",as);var i=t.prototype;return i.initialize=function(){var e=this;e.list.itemRender=Gu,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100;var t=te.ins.getLeftTime();e.link_buy.visible=t<=0},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.cb_isauto.on("click",t,t.onSelected),t.link_buy.on("click",t,t.onBuyYueka),t.toc=te.ins.datas22352,t.toc&&0<t.toc.leftTime?t.cb_isauto.visible=!0:t.cb_isauto.visible=!1,t.g_title.skin=Or.getBossPath("boss_text_bosstx")},i.onRemove=function(e){var t=this;t.cb_isauto.off("click",t,t.onSelected),t.link_buy.off("click",t,t.onBuyYueka)},i.onSelected=function(e){var t=this,i=new Zo;switch(t._type){case 3:ha.ins.wildIsAuto=t.cb_isauto.selected;break;case 13:ha.ins.godIsAuto=t.cb_isauto.selected}1==t.cb_isauto.selected?i.isOpen=1:i.isOpen=0,i.type=t._type,Fl.sendToService(i),1==t.cb_isauto.selected&&On.ins.close("BOSS_GOD_ATTENTION_VIEW")},i.onBuyYueka=function(e){0!=Qc.showCharge&&On.ins.open("MONTHCARD",{selectedIndex:3})},i.updatePanel=function(e){var t=this;if(26==e){if(Ia.count<=0)return void oe.loadConfig(["BossHome"],["BossHome"],ms.create(t,t.updatePanel,[26]))}else if(47==e&&st.count<=0)return void oe.loadConfig(["FlyUPBoss"],["CFlyupBoss"],ms.create(t,t.updatePanel,[47]));var i=[],s=ha.ins.getBossIds(e);switch(26==(t._type=e)||47==e||53==e?(t.cb_isauto.visible=!1,t.box_yueka.visible=!1,t.height=740):3!=e&&13!=e||(t.box_yueka.visible=!0,t.height=766),e){case 26:s=Tu.instance.getBossInfoByIndex();break;case 47:s=Z.ins.getBossInfoByIndex();break;case 53:s=L.ins.getAttentionBossArr();break;default:s=ha.ins.getBossIds(e)}if(3==e?s=s.concat(ha.ins.getBossIds(49)):49==e&&(s=ha.ins.getBossIds(3).concat(s)),s)for(var n=0;n<s.length;n++)i.push({id:s[n],cate:e});switch(t.list.array=i,e){case 3:t.cb_isauto.selected=ha.ins.wildIsAuto,t.txt_yueka.text=ed.n[1595];break;case 13:t.cb_isauto.selected=ha.ins.godIsAuto,t.txt_yueka.text=ed.n[1596]}},t}(),Hu=function(e){function i(){var e=this;e._BAR_W=0,e._gridsList=null,e.state=0,e.curObj=null,e.endTime=NaN,i.__super.call(e)}u(i,"modules.boss.views.Boss_GodItem",e);var t=i.prototype;return t.initialize=function(){var e=this;e._gridsList=new W(5,!1),e._gridsList.isClearUrl=!1,e._gridsList.pos(155,30),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=2,e._gridsList._gsimpleName=!0,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList.owerModule=i.Name,e.addChild(e._gridsList)},t.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._BAR_W=t.bar.width,t.btn_challenge.on("click",t,t.onClickHanlder)},t.onRemove=function(e){var t=this;t.clearTimer(t,t.onTimer),t.btn_challenge.off("click",t,t.onClickHanlder),ui.ViewBase.prototype.onRemove.call(t,e)},t.setClear=function(){var e=this;e.txt_brefesh.visible=!1,e.txt_bopen.visible=!1,e.btn_challenge.visible=!1,e.clearTimer(e,e.onTimer)},t.setBossInfo=function(e){var t=this;t.curObj=ha.ins.godBossHash.take(t.tag.id),t.curObj&&(t.state=i.getStatus(t.tag),t.setBossState(t.state,e))},t.resetChallange=function(){on.reqCopy(13)},t.setBossState=function(e,t){var i=this,s=i.curObj.bossHp,n=Xl.getIndex(t),o=Se.formatNewAttrToObject(JSON.parse(Xl.MODEL.attributes(n)));switch(e){case 0:i.txt_bopen.visible=!0,i.txt_bopen.changeText(i.txt_blevel.text+"开启"),i.clearTimer(i,i.onTimer);break;case 1:i.btn_challenge.visible=!0,i.clearTimer(i,i.onTimer);break;case 2:s=0,i.txt_brefesh.visible=!0,i.endTime=J.curServerTime+1e3*i.curObj.reviveTime,i.timerLoop(1e3,i,i.onTimer),i.onTimer()}var a=s/o.MAXHP;1<a&&(a=1);var r=i.bar.scrollRect||new qo(0,0,i.bar.width,i.bar.height);r.width=i._BAR_W*a,i.bar.scrollRect=r},t.onTimer=function(){var e=this;if(e.tag){var t=e.endTime-J.curServerTime;if(t<=0)return e.endTime=0,e.event("end"),e.clearTimer(e,e.onTimer),void e.resetChallange();e.txt_brefesh.text=he.deltaFormat(t,"hh:mm:ss")+"后重生"}},t.onClickHanlder=function(e){this.tag&&1==this.state&&(ri.ins.hasEmptyNum(20)?Wc.isEnabledChangeScene()?ha.ins.gb_leftlNum<=0?Vl.ins.showMsg(ed.n[1597],1):on.reqEntry(this.tag.id):Vl.ins.showById(2126,1):ja.ins.showBagRecycle())},n(0,t,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.setClear(),e){t.tag=e;var i=uo.getIndex(t.tag.id),s=i,n=uo.MODEL.bossId(i);i=Xl.getIndex(n);var o=Xl.MODEL.muId(i),a=Xl.MODEL.name(i),r=Xl.MODEL.level(i);i=Cs.getIndex(o),t.txt_bname.changeText(a);var l=Cs.MODEL.headId(i),c=uo.MODEL.levelLimit(s),d=uo.MODEL.zsLevelLimit(s);0<d?t.txt_blevel.changeText(d+"转"):0<c?t.txt_blevel.changeText(c+"级"):t.txt_blevel.changeText(r+"级");var u=uo.MODEL.bossShowAward(s);t._gridsList.setGoodsItems(u,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),t.setBossInfo(n);var h=l&&"0"!=l?t.img_boss.skin=Or.getBossPath(l):"";if(t.img_boss.skin&&t.img_boss.skin!=h){var _=mi.getRes(t.img_boss.skin);_&&(_.destroy(),mi.clearRes(t.img_boss.skin),un.ins.clearTexture(t.img_boss.skin))}t.img_boss.skin=h}}),i.getStatus=function(e){var t=uo.getIndex(e.id),i=uo.MODEL.levelLimit(t);return Gi.ins.lv<i?0:(i=uo.MODEL.zsLevelLimit(t),Gi.ins.zsLv<i?0:ha.ins.godBossHash.take(e.id)&&0<ha.ins.godBossHash.take(e.id).reviveTime?2:1)},i.Name="BOSS_GOD_AWARD_GOODS",i}(js),Fu=function(e){function t(){var e=this;e.copyID=0,e.copyType=0,e.timeGS=0,e.timeXZ=0,e.panelAttId=null,e.panelId=null,e.tabsId=0,e.vipLimit=0,t.__super.call(e)}u(t,"modules.boss.views.Boss_GodRefreshView",za);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.refreshSet.on("click",t,t.openAttention);var i=parseInt(Ta.MODEL.value(Ta.getIndex(242)));Y.timer.once(i,t,t.closeWindow)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.refreshSet.off("click",t,t.openAttention),Y.timer.clear(t,t.closeWindow)},i.closeWindow=function(){On.ins.close("BOSS_GOD_REFRESH")},i.update=function(e){var t=this;if(e instanceof Array?(e[0]&&(t.copyID=e[0]),e[1]&&(t.timeGS=e[1]),e[2]&&(t.timeXZ=e[2])):"number"==typeof e&&Math.floor(e)==e&&(t.copyID=e,t.timeGS=0,t.timeXZ=0),On.ins.isOpen("FIRST_PAY")){var i=On.ins._getPanel("FIRST_PAY");i&&i.parent&&t.parent.setChildIndex(t,i.parent.getChildIndex(i)-1)}var s=uo.getIndex(t.copyID),n="",o=uo.MODEL.lunHuiLevelLimit(s),a=_l.getIndex(o);0<o&&(n=_l.MODEL.levelName(a));var r=s,l=uo.MODEL.cate(r);t.copyType=l;var c=uo.MODEL.bossId(s);53==l&&(c=Dc.MODEL.bossId(Dc.getIndex(t.copyID))),t.vipLimit=uo.MODEL.vipLimit(s),s=Xl.getIndex(c);var d=Xl.MODEL.level(s),u=Xl.MODEL.muId(s),h=Xl.MODEL.name(s),_=uo.MODEL.levelLimit(r),p=uo.MODEL.zsLevelLimit(r);switch(0<o?t.bossName.changeText(h+"·"+n):0<p?t.bossName.changeText(h+"·"+p+"转"):0<_?t.bossName.changeText(h+"·"+_+"级"):t.bossName.changeText(h+"·"+d+"级"),l){case 49:t.typeName.text=ed.n[1598],on.reqCopy(3),on.reqCopy(49),t.changeView(1),t.panelAttId="BOSS_GOD_ATTENTION_VIEW",t.tabsId=1,t.panelId="BOSS_MAINVIEW",t.height=423;break;case 3:t.typeName.text=ed.n[1599],on.reqCopy(3),on.reqCopy(49),t.changeView(1),t.panelAttId="BOSS_GOD_ATTENTION_VIEW",t.tabsId=1,t.panelId="BOSS_MAINVIEW",t.height=423;break;case 13:on.reqCopy(13),t.typeName.text=ed.n[1600],t.changeView(1),t.panelAttId="BOSS_GOD_ATTENTION_VIEW",t.tabsId=3,t.panelId="BOSS_MAINVIEW",t.height=423;break;case 26:t.typeName.text=ed.n[1601],t.changeView(1),t.panelAttId="BOSS_GOD_ATTENTION_VIEW",t.tabsId=4,t.panelId="BOSS_MAINVIEW",t.height=423;break;case 41:t.typeName.text=ed.n[1602],t.changeView(2),t.panelAttId="MAGICATTENTION_VIEW",on.reqCopy(41),t.tabsId=1,t.panelId="MAGIC_VIEW",t.height=456;break;case 42:t.typeName.text=ed.n[1603],t.changeView(2),t.panelAttId="MAGICATTENTION_VIEW",on.reqCopy(42),t.tabsId=2,t.panelId="MAGIC_VIEW",t.height=456;break;case 47:t.typeName.text=ed.n[1604],t.changeView(1),t.panelId="BOSS_MAINVIEW",t.tabsId=2,t.panelAttId="MAGICATTENTION_VIEW",t.height=423;break;case 53:t.typeName.text=ed.n[1605],t.changeView(1),t.panelId="CROSSBOSS_MAIN_VIEW",t.tabsId=2,t.panelAttId="BOSS_GOD_ATTENTION_VIEW";var f=new m;Fl.sendToService(f),t.height=423;break;case 57:t.typeName.text=ed.n[1606],t.changeView(2),t.panelId="CROSSNEWWORLDBOSSPANEL",t.panelAttId="CrossNewBossAttentionView",t.height=456}var g=Cs.getIndex(u),v=Cs.MODEL.headId(g);t.bossHead.skin=Or.getBossPath(v),t.hasListener("click")||t.on("click",t,t.onClick),t.refreshSet.hasListener("click")||t.refreshSet.on("click",t,t.openAttention)},i.changeView=function(e){var t=this;switch(e){case 1:t.lab_canyu.visible=!1,t.lab_guishu.visible=!1,t.txt_canyu.visible=!1,t.txt_guishu.visible=!1,t.height=456;break;case 2:t.lab_canyu.visible=!0,t.lab_guishu.visible=!0,t.txt_canyu.visible=!0,t.txt_guishu.visible=!0,t.txt_guishu.changeText(t.timeGS+"次"),t.txt_canyu.changeText(t.timeXZ+"次"),t.height=456}},i.onClick=function(e){if(e.target==this.btn_go){if(!ri.ins.hasEmptyNum(20))return void ja.ins.showBagRecycle();if(!Wc.isEnabledChangeScene())return void Vl.ins.showById(2126,1);On.ins.close("BOSS_GOD_REFRESH"),On.ins.open(this.panelId,{_subIndex_:this.tabsId})}else e.target==this.btn_close&&On.ins.close("BOSS_GOD_REFRESH")},i.openAttention=function(e){var t=this;26==t.copyType?On.ins.open(t.panelAttId,{type:t.copyType,selectedIndex:t.vipLimit}):On.ins.open(t.panelAttId,{type:t.copyType})},n(0,i,"currentCopyId",function(){return this.copyID}),t}(),zu=function(e){function t(){this.endTime=NaN,this._array=null,t.__super.call(this)}u(t,"modules.boss.views.Boss_GodView",di);var i=t.prototype;return i.initialize=function(){var e=this;e.list.itemRender=Hu,e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1,e._array=[];for(var t=ha.ins.getBossIds(13),i=0;i<t.length;i++)e._array.push({id:t[i],cate:13})},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.link_refesh.on("click",t,t.onClickHanlder),t.list.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.link_refesh.off("click",t,t.onClickHanlder),t.list.scrollBar.off("change",t,t.onScrollChanged),t.clearTimer(t,t.onTimer)},i.showByVSC=function(e,t){on.reqCopy(13)},i.updateByVSC=function(e){var t,i=this;if(e instanceof protos.boss.toc_22621)return t=ha.ins.gb_leftlNum?"#23b11f":"#ff2e24",i.txt_nums.innerHTML=ed.n[1607]+nc.createColor(ha.ins.gb_leftlNum+"/"+ha.ins.gb_totalNum,t),void i.resetRenewTimes();if(e instanceof protos.boss.toc_21225){t=ha.ins.gb_leftlNum?"#23b11f":"#ff2e24",i.txt_nums.innerHTML=ed.n[1607]+nc.createColor(ha.ins.gb_leftlNum+"/"+ha.ins.gb_totalNum,t),!i.list.visible&&(i.list.visible=!0);e.bossHash;for(var s=0;s<i._array.length;s++){var n=i._array[s],o=ha.ins.godBossHash.take(n.id);n&&o&&(wn.assign(n,o),n.status=Hu.getStatus(n),n.selected=0<n.status&&0==n.select)}i._array=i._array.sort(i.sortArray),i.list.dataSource=i._array,i.list.tweenTo(0),0<e.renewTimes?(i.endTime=J.curServerTime+1e3*e.renewTimes,i.txt_time.visible=!0,i.timerLoop(1e3,i,i.onTimer),i.onTimer()):(i.txt_time.visible=!1,i.clearTimer(i,i.onTimer))}},i.sortArray=function(e,t){var i=0,s=0;return(i=0==e.status?5:e.selected?1==e.status?1:3:1==e.status?7:9)==(s=0==t.status?5:t.selected?1==t.status?1:3:1==t.status?7:9)?-(e.id-t.id):i-s},i.resetRenewTimes=function(){var e=this;ha.ins.gb_leftlNum<parseInt(Ta.MODEL.value(Ta.getIndex(101)))&&(e.clearTimer(e,e.onTimer),e.endTime=J.curServerTime+1e3*parseInt(Ta.MODEL.value(Ta.getIndex(102))),e.txt_time.visible=!0,e.timerLoop(1e3,e,e.onTimer),e.onTimer())},i.onTimer=function(){var e=this,t=e.endTime-J.curServerTime;if(t<0)return e.clearTimer(e,e.onTimer),e.txt_time.visible=!1,void e.event("end");e.txt_time.innerHTML="("+nc.createColor(he.deltaFormat(t,"hh:mm:ss"),"#23b11f")+ed.n[1609]},i.onClickHanlder=function(e){On.ins.open("BOSS_GOD_ATTENTION_VIEW",{type:13})},i.onScrollChanged=function(){var e=this;0==e.list.scrollBar.max||e.list.scrollBar.value>=e.list.scrollBar.max?e.g_mask.visible=!1:e.g_mask.visible=!0},i.onCellRender=function(e,t){e.on("end",this,this.onCellTimerEnd)},i.onCellTimerEnd=function(){},t}(),Wu=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.Boss_MijingAlertItem",e);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.cb_alert.on("change",this,this.onShowAlert)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.cb_alert.off("change",this,this.onShowAlert)},i.onShowAlert=function(e){var t=this.cb_alert.selected,i=new le;i.copyId=1,i.selected=t,Fl.sendToService(i)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){}),t}(qs),ju=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.Boss_MijingAlertView",Uc);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.lst_boss.array=null,this.lst_boss.itemRender=Wu},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_close:On.ins.close("BOSS_MIJING_ALERTLIST_VIEW")}},t}(),qu=function(e){function t(){this._container=null,t.__super.call(this)}u(t,"modules.boss.views.Boss_PersonItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_state.visible=!1},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){var i=t.tag.id,s=uo.getIndex(i),n=s,o=uo.MODEL.bossId(s);s=Xl.getIndex(o);var a=Xl.MODEL.level(s),r=(Xl.MODEL.muId(s),Xl.MODEL.name(s));t.txt_boss_name.changeText(r);var l=uo.MODEL.levelLimit(n),c=uo.MODEL.zsLevelLimit(n),d=uo.MODEL.isCard(n);0<d?t.txt_boss_lv.changeText(1==d?ed.n[1610]:ed.n[1611]):0<c?t.txt_boss_lv.changeText(c+"转开启"):0<l?t.txt_boss_lv.changeText(l+"级开启"):t.txt_boss_lv.changeText(a+"级开启"),t.img_state.visible=0==t.tag.status,t.img_state.visible&&(t.img_state.skin=Or.getAtlasSubPath("boss/boss_bq_wkq.png")),t.filters=2==t.tag.status?ns.getGrayFilter():null}}),n(0,i,"select",null,function(e){this.btn_challenge.selected=e,this.txt_boss_name.color=e?"#fff9b4":"#91856d";var t=this.tag.id,i=uo.getIndex(t),s=uo.MODEL.isCard(i);this.txt_boss_lv.color=0<s?e?"#fff000":"#e6d80d":e?"#fff9b4":"#91856d"}),t}(Te),Yu=function(e){function t(){this._array=null,this._gridsList=null,this._avatar=null,this.toc22352=null,this.toc22357=null,this._fistReward=null,this.curObj=null,t.__super.call(this)}u(t,"modules.boss.views.Boss_PersonView",pe);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e._gridsList=new ga(3),e._gridsList.pos(247,858),e._gridsList.size(480,180),e._gridsList._gsimpleName=!0,e._gridsList._spaceX=26,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.box_c.addChild(e._gridsList),e.list.itemRender=qu,e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1,e.list.selectEnable=!0,e.list.renderHandler=ms.create(e,e.onListRender,null,!1),e.list.selectHandler=ms.create(e,e.onChange,null,!1),e._array=[];for(var t=ha.ins.getBossIds(2),i=0;i<t.length;i++){var s=t[i],n=uo.getIndex(s),o=uo.MODEL.isCard(n);e._array.push({id:s,isCard:o,cate:2})}e.txt_time.innerHTML="每日"+nc.createColor(ed.n[1612],"#23b11f")+ed.n[1613]},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_kill.visible=!1,this.btn_challenge.on("click",this,this.onClickHandler)},i.onRemove=function(e){var t=this;t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.btn_challenge.off("click",t,t.onClickHandler),Hi.boss_mId=-1,ui.ViewBase.prototype.onRemove.call(t,e)},i.showByVSC=function(e,t){on.reqCopy(2)},i.hideByVSC=function(e,t){},i.updateByVSC=function(e){var t=this;if(e instanceof protos.boss.toc_21209){for(var i=e.map,s=0;s<t._array.length;s++){var n=t._array[s];n.status=0|i[n.id]}!t.list.visible&&(t.list.visible=!0),t._array=t._array.sort(t.sortArray),t.list.array=t._array,t.setStartIndex(t._array)}},i.setStartIndex=function(e){for(var t=-1,i=-1,s=0;s<e.length;s++)if(1==e[s].status&&(-1==i&&(i=s),0<Hi.boss_mId&&Hi.boss_mId==e[s].id)){t=s;break}t<0&&(t=i<0?0:i),10<(this.list.selectedIndex=t)?this.list.scrollTo(t-5):this.list.scrollTo(0),this.onChange(t,!0)},i.sortArray=function(e,t){if(e.isCard&&2!=e.status)return-1;if(t.isCard&&2!=t.status)return 1;var i=0==e.status?1.5:e.status,s=0==t.status?1.5:t.status;return i!=s?i-s:e.isCard!=t.isCard?t.isCard-e.isCard:e.id-t.id},i.onListRender=function(e,t){t==this.list.selectedIndex&&this._array[t]&&2!=this._array[t].status?e.select=!0:e.select=!1},i.onChange=function(e,t){var i=this;if(void 0===t&&(t=!1),i.toc22352=te.ins.datas22352,i.toc22357=te.ins.datas22357,i.curObj=i._array[e],i.curObj&&(2!=i.curObj.status||t)){var s=uo.getIndex(i.curObj.id),n=s,o=uo.MODEL.bossId(s);s=Xl.getIndex(o);var a=uo.MODEL.key(n),r=ha.ins.checkPersonHasFirstKillReward(a);if(0<=r){null==i._fistReward&&(i._fistReward=new ra,i.box_firstKill.addChild(i._fistReward),i.box_firstKill.addChild(i.img_isGet)),i.box_firstKill.visible=!0,i.firstskilltip.visible=!0,ha.ins.bossPersonHash&&0==ha.ins.bossPersonHash.take(i.curObj.id).passTimes?i.img_isGet.visible=!1:i.img_isGet.visible=!0;var l=Gi.ins.actorById(1).job-1,c=an.createStrArr(me.MODEL.reward(r))[l];i._fistReward.dataSource=c,i.txt_firstKillName.text=c.simpleName,i.txt_firstKillName.color=Co.getByQuality(Re.MODEL.colourId(c.cfgIdx))}else i.box_firstKill.visible&&(i.box_firstKill.visible=!1),i.firstskilltip.visible&&(i.firstskilltip.visible=!1);var d=uo.MODEL.bossShowAward(n);if(i._gridsList.setGoodsItems(d,3),i.img_kill.visible=0!=i.curObj.status,i.img_kill.visible&&(2==i.curObj.status?i.img_kill.skin=Or.getAtlasSubPath("boss/boss_yzbq_yjs.png"):1==i.curObj.status&&(i.img_kill.skin=Or.getAtlasSubPath("boss/boss_yzbq_kjs.png"))),i.btn_challenge.visible=1==i.curObj.status,i.txt_ch.visible=0==i.curObj.status,i.txt_ch.visible){var u=uo.MODEL.levelLimit(n),h=uo.MODEL.zsLevelLimit(n),_=uo.MODEL.isCard(n);0<_?i.txt_ch.changeText(1==_?ed.n[1614]:ed.n[1615]):Gi.ins.zsLv<h?i.txt_ch.changeText(h+ed.n[1616]):Gi.ins.lv<u&&i.txt_ch.changeText(u+ed.n[1617])}if(1==i.curObj.status&&i.toc22357){var p=i.toc22357.idArr;i.toc22352&&0<i.toc22352.leftTime&&-1!=p.indexOf(i.curObj.id)?i.btn_challenge.label="扫 荡":i.btn_challenge.label="挑 战"}i.setAvatar(s),i.setBossLevel(s)}},i.setBossLevel=function(e){var t=Xl.MODEL.name(e),i=Xl.MODEL.level(e);this.txt_bname.text=t+"︵",this.txt_blvl.innerHTML=i.toString(),this.txt_te.text="级︶",this.txt_blvl.y=this.txt_bname.y+this.txt_bname.textHeight,this.txt_te.y=this.txt_blvl.y+this.txt_blvl.contextWidth+5},i.setAvatar=function(e){var t=this,i=Xl.MODEL.muId(e);e=Cs.getIndex(i);var s=Cs.MODEL.avatarId(e);if(!t._avatar){t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(480,715);var n=t.box_c.getChildIndex(t.img_kill);t.box_c.addChildAt(t._avatar,n)}t._avatar.mid=s,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",s,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1.2,1.2)},i.onClickHandler=function(e){var t=this;if(t.curObj)if(ri.ins.hasEmptyNum(20))if(Wc.isEnabledChangeScene())if(t.toc22357){var i=t.toc22357.idArr;0<t.toc22352.leftTime&&-1!=i.indexOf(t.curObj.id)?(Aa.reqSaoDangCopy(t.curObj.id),t.btn_challenge.visible=1==t.curObj.status):on.reqEntry(t.curObj.id)}else on.reqEntry(t.curObj.id);else Vl.ins.showById(2126,1);else ja.ins.showBagRecycle()},i.destroy=function(e){void 0===e&&(e=!0),this.bg&&this.bg.skin&&Y.loader.clearRes(this.bg.skin),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),laya.ui.View.prototype.destroy.call(this,e)},t}(),Ku=function(e){function t(){this._queue=null,t.__super.call(this),this._queue=[],this.btn_go.on("click",this,this.onClick),this.btn_close.on("click",this,this.hide,[!0])}u(t,"modules.boss.views.Boss_RefreshNote",cr);var i=t.prototype;return i.onClick=function(){if(0!=this._queue.length){var e,t=this._queue.pop(),i=uo.getIndex(t),s=uo.MODEL.cate(i);3==s?e="SUB_WILD":4==s?e="SUB_WORLD":26==s&&(e="SUB_BOSS_HOME");for(var n=this._queue.length-1;0<=n;){var o=uo.getIndex(this._queue[n]);s==uo.MODEL.cate(o)&&this._queue.splice(n,1),n--}this.hide(),e&&On.ins.open("BOSS_MAINVIEW",{_subId_:e,copyId:t},null,!0)}},i.removeCopyId=function(e){var t=this._queue.indexOf(e);if(-1!=t){var i=t==this._queue.length-1;this._queue.splice(t,1),i&&(0<this._queue.length?this.update(this._queue.pop()):this.hide())}},i.show=function(){this.alpha=0,Yl.clearAll(this),Yl.to(this,{alpha:1},150,G.backOut)},i.hide=function(e){void 0===e&&(e=!1),e&&0<this._queue.length&&this._queue.pop(),Yl.clearAll(this),Yl.to(this,{alpha:0},150,null,ms.create(this,this.onHideComplete))},i.onHideComplete=function(){if(0<this._queue.length)return this.update(this._queue.pop()),void this.show();On.ins._closePanelForce(this)},i.update=function(e){-1!=this._queue.indexOf(e)&&this._queue.splice(this._queue.indexOf(e),1),this._queue.push(e);var t=uo.getIndex(e),i=t,s=uo.MODEL.bossId(t);t=Xl.getIndex(s);var n=Xl.MODEL.level(t),o=Xl.MODEL.muId(t),a=Xl.MODEL.name(t);t=Cs.getIndex(o);var r,l=Cs.MODEL.headId(t);if(this.img_head.skin=l&&"0"!=l?Or.getBossPath(l):"",3==uo.MODEL.cate(i)){var c=uo.MODEL.zsLevelLimit(i);if(0<c)r=c+"转";else{var d=uo.MODEL.levelLimit(i);0<d&&(r=d+"级")}}else r=n+"级";this.txt_name.innerHTML=a+" "+nc.createColor("("+r+")","#a19980"),this.txt_desc.changeText(uo.MODEL.extraDes(i))},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.show()},t}(),Ju=function(e){function o(){this._BAR_W=0,this._gridsList=null,this._blood=0,this.curObj=null,o.__super.call(this)}u(o,"modules.boss.views.Boss_WildItemView",e);var t=o.prototype;return t.initialize=function(){var e=this;e.btn_challenge.on("click",e,e.onClick),e._gridsList=new W(5,!1),e._gridsList.pos(155,30),e._gridsList._iconLayer=6,e._gridsList._tipLayer=8,e._gridsList._textLayer=10,e._gridsList._spaceX=2,e._gridsList._gsimpleName=!0,e._gridsList._gnameY=e._gridsList._gridH+5,e._gridsList.owerModule=o.Name,e.addChild(e._gridsList),e._BAR_W=e.bar.width,e.lunhui.visible=!1},t.onClick=function(e){if(e.target==this.icon_boss||e.currentTarget==this._gridsList);else if(e.target==this.btn_challenge){if(!ri.ins.hasEmptyNum(20))return void ja.ins.showBagRecycle();if(!Wc.isEnabledChangeScene())return void Vl.ins.showById(2126,1);if(ha.ins.wild_cl_count<=0){if(0<ri.ins.getGoodsNum(340)){var t=Re.getIndex(340),i=ur.getFormat(ed.n[1618],[nc.createColor(Re.MODEL.name(t),Co.getByQuality(Re.MODEL.colourId(t)))]);return void ja.ins.showBox(i,ed.n[1619],ms.create(this,this.onUseConfirm),!1,1,null,ed.n[1620],ed.n[1621])}if(0<ha.ins.remainBuy)return void Xu.onPlus(!0,this.tag.id);var s=ha.ins.remainBuy,n=ur.getFormat(ed.n[1622],[nc.createColor("100元宝","#01fb01"),nc.createColor(s+"次数","#01fb01"),nc.createColor(ed.n[1623],"#e6d80d")]);return void ja.ins.show(n,ms.create(Xu,o.onConfirm,[100,!1,this.tag.id,s]))}on.reqEntry(this.tag.id)}},t.onUseConfirm=function(e){if(1==e){var t=ri.ins.getGoodsDto(340);t&&this.tag&&(Fl.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:t,num:1}),on.reqEntry(this.tag.id))}},t.onLinkNote=function(){On.ins.open("BOSS_WILDNOTE_VIEW",this.tag.id)},t.onCBSelected=function(e){},t.onTimer=function(){var e=this.tag.time-J.curServerTime;if(e<0)return this.tag.time=0,this.tag.status=o.getStatus(this.tag),on.reqCopy(3),void this.event("end");this.txt_time.text=he.deltaFormat(e,"hh:mm:ss")+"后重生"},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},t.setBossState=function(e){this.tag.blood;var t=Xl.getIndex(e),i=Se.formatNewAttrToObject(JSON.parse(Xl.MODEL.attributes(t))),s=this._blood/i.MAXHP;1<s&&(s=1),1<s&&(s=1);var n=this.bar.scrollRect||new qo(0,0,this.bar.width,this.bar.height);n.width=this._BAR_W*s,this.bar.scrollRect=n},n(0,t,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e&&e.time<=0&&e.blood<=0&&ji.push(ed.n[1624]+e.id+", time: "+e.time+", blood: "+e.blood+ed.n[1625]+e.status),t.tag=e,t.clearTimer(t,t.onTimer),t.tag){t._blood=t.tag.blood;var i=t.tag.id,s=uo.getIndex(i),n=s,o=uo.MODEL.bossId(s);t.setBossState(o),s=Xl.getIndex(o);var a=Xl.MODEL.level(s),r=Xl.MODEL.muId(s),l=Xl.MODEL.name(s);s=Cs.getIndex(r);var c=Cs.MODEL.headId(s);t.icon_boss.skin=c&&"0"!=c?Or.getBossPath(c):"",t.txt_boss_name.changeText(l);var d=uo.MODEL.levelLimit(n),u=uo.MODEL.zsLevelLimit(n),h=uo.MODEL.lunHuiLevelLimit(n),_=_l.getIndex(h),p=(_l.MODEL.level(_),_l.MODEL.tier(_),"");t.lunhui.visible=!1,0<h&&(p=_l.MODEL.levelName(_),t.lunhui.visible=!0),0<h?t.txt_boss_lv.changeText(""+p):0<u?t.txt_boss_lv.changeText(u+"转"):0<d?t.txt_boss_lv.changeText(d+"级"):t.txt_boss_lv.changeText(a+"级"),t.txt_limit.visible=!1,t.txt_time.visible=!1,t.btn_challenge.visible=!1;var f=t.tag.status;if(2==f){t.tag.time;t.txt_time.visible=!0}else if(0==f)t.txt_limit.visible=!0,0<h&&0<u&&(Gi.ins.lunhuiId<h||Gi.ins.zsLv<u)?t.txt_limit.text=p+"且"+u+"转开启":0<h&&Gi.ins.lunhuiId<h?t.txt_limit.text=p+"开启":Gi.ins.zsLv<u?t.txt_limit.text=u+"转开启":Gi.ins.lv<d&&(t.txt_limit.text=d+"级开启");else{t.btn_challenge.visible=!0;t.tag.person}t.txt_time.visible?(t.timerLoop(1e3,t,t.onTimer),t.onTimer()):t.clearTimer(t,t.onTimer);var g=Or.getBossPath(c);if(t.icon_boss.skin&&t.icon_boss.skin!=g){var v=mi.getRes(t.icon_boss.skin);v&&(v.destroy(),mi.clearRes(t.icon_boss.skin),un.ins.clearTexture(t.icon_boss.skin))}t.icon_boss.skin=g;var m=uo.MODEL.bossShowAward(n),b=ha.ins.bossWildHash.take(i),w=b&&b.isFirstKill;if(w){var y=ha.ins.getFirstKillReward(i);if(0<y.id&&0<y.count){var x=y.id+","+y.count+";";m=m.replace(/[0-9]*,[0-9]*[,0-9]*;/,x)}}if(t._gridsList.setGoodsItems(m,3),t._gridsList.size(t._gridsList.contentWidth,t._gridsList.contentHeight),w){var I,S="firstkill_"+t.txt_boss_lv.text,k=t._gridsList.getChildAt(0);try{I=Bi.layerSprite(k,k._effectLayer+1,new is(k.width>>1,k.height>>1))}catch(e){}if(I&&!I.getChildByName(S)){var C=ti.createImage("ui/layouts/boss/boss_bq_ssbdx.png",t._gridsList.x+k.x,t._gridsList.y+t.y+30);C.name=S,I.addChild(C)}}}}),o.getStatus=function(e){var t=uo.getIndex(e.id),i=uo.MODEL.levelLimit(t),s=uo.MODEL.lunHuiLevelLimit(t);return Gi.ins.lunhuiId<s?0:Gi.ins.lv<i?0:(i=uo.MODEL.zsLevelLimit(t),Gi.ins.zsLv<i?0:0<e.time?2:1)},o.onConfirm=function(e,t,i,s,n){if(1==n){if(0==s)return void Vl.ins.showById(2161,1);if(Gi.ins.YB<e)return void ja.ins.showNoGold();Fl.sendToService(new vt),t&&on.reqEntry(i)}},o.MIN_ANGLE=-90,o.MAX_ANGLE=270,o.Name="BOSS_Wild_AWARD_GOODS",o}(zo),Xu=function(e){function n(){this.toc21210=null,this.endTime=NaN,this._array=null,this._openCopyId=0,this.item=null,this._isFirstScroll=!1,n.__super.call(this)}u(n,"modules.boss.views.Boss_WildView",nn);var t=n.prototype;return Y.imps(t,{"ui.IVSCView":!0}),t.initialize=function(){var e=this;e.list.itemRender=Ju,e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1,e._array=[];for(var t=ha.ins.getBossIds(3),i=0;i<t.length;i++)e._array.push({id:t[i],cate:3});for(t=ha.ins.getBossIds(49),i=0;i<t.length;i++)e._array.push({id:t[i],cate:49});e.btn_plus.on("click",n,n.onPlus)},t.onAdd=function(e){var t=this;t.btn_plus.visible=!1;var i=xc.noClearTexture.indexOf("/layouts/boss");at._canClear?-1<i&&xc.noClearTexture.splice(i,1):-1==i&&xc.noClearTexture.push("/layouts/boss"),ui.ViewBase.prototype.onAdd.call(t,e),t.link_refesh.on("click",t,t.onClickHanlder),t.list.scrollBar.on("change",t,t.onScrollChanged),t.btn_share.on("click",t,t.onShare),t.scrollToIndex();var s=new Ba;Fl.sendToService(s)},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.link_refesh.off("click",t,t.onClickHanlder),t.list.scrollBar.off("change",t,t.onScrollChanged),t.btn_share.off("click",t,t.onShare),t.clearTimer(t,t.onTimer),at.ins.showWildId=0,t.item&&(t.item.parent&&t.item.parent.removeChild(t.item),t.item.destroy(),t.item=null),t._isFirstScroll=!1},t.onClickHanlder=function(e){On.ins.open("BOSS_GOD_ATTENTION_VIEW",{type:3})},t.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t.onCellRender=function(e,t){e.on("end",this,this.onCellTimerEnd)},t.onCellTimerEnd=function(){},t.updateByVSC=function(e){var t=this;if(e instanceof protos.boss.toc_21210){t.toc21210=e,t.updateCount(),!t.list.visible&&(t.list.visible=!0);for(var i=t.toc21210.map,s=0;s<t._array.length;s++){var n=t._array[s],o=i[n.id];n&&o&&(wn.assign(n,o),n.status=Ju.getStatus(n),n.selected=0<n.status&&n.selected,n.blood=o.blood)}var a=Ta.getIndex(236),r=Ta.MODEL.value(a),l=parseInt(r.split(",")[0]),c=parseInt(r.split(",")[1]);if(t._array=t.lunhuiFilter(t._array,Gi.ins.zsLv>=l&&c<=J.getOpenServiceDay()),t._array=t._array.sort(t.sortArray),t.list.dataSource=t._array,0<t._openCopyId){for(s=0;s<t._array.length;s++)if(t._array[s].id==t._openCopyId){t._isFirstScroll||t.list.tweenTo(s,100),t._isFirstScroll=!0;break}t._openCopyId=0}else{var d=-1;for(s=t._array.length-1;0<=s;s--){var u=(n=t._array[s]).status;n.selected;if(1==u){d=s;break}}-1==d&&(d=t._array.length),d=Math.max(d-2,0),t._isFirstScroll||t.list.tweenTo(d),t._isFirstScroll=!0}}else e instanceof protos.boss.toc_22620?t.toc21210&&(t.toc21210.clCount=e.wildBossCount,t.toc21210.clCount>=t.toc21210.maxClCount&&(t.toc21210.hfTime=0),t.updateCount()):e.copyId&&(t._openCopyId=e.copyId);t._isFirstScroll||t.scrollToIndex(),t._isFirstScroll=!0,t.btn_share.visible=Hl.getCpShareSwitch(),t.btn_share.showTip=Ft.ins.getRWT(4)<=0},t.lunhuiFilter=function(e,t){var i,s=[];for(var n in e)0<(i=e[n]).lhId&&!t||s.push(i);return s},t.scrollToIndex=function(){var e=at.ins.showWildId;if(0!=e){for(var t=0,i=0;i<this._array.length;i++)if(this._array[i].id==e){t=i;break}this.list.tweenTo(t)}},t.updateCount=function(){var e=this;0<e.toc21210.hfTime?(e.endTime=J.curServerTime+1e3*e.toc21210.hfTime,e.txt_time.visible=!0,e.timerLoop(1e3,e,e.onTimer),e.onTimer()):(e.txt_time.visible=!1,e.clearTimer(e,e.onTimer)),ha.ins.wild_cl_count=e.toc21210.clCount,ha.ins.wild_cl_max=e.toc21210.maxClCount,e.txt_num.innerHTML=ed.n[1626]+nc.createColor(""+e.toc21210.clCount,0==e.toc21210.clCount?"#ff2e24":"#23b11f")+nc.createColor("/"+e.toc21210.maxClCount,"#23b11f");var t=ri.ins.getGoodsNum(340);if(e.txt_gnum.visible=0<t,e.btn_plus.visible=e.toc21210.clCount<1&&t<1,0<t){if(!i){e.txt_num.x=150;var i=new ra(52);i.isShowSmallIcon=!0,i.needGridBg=!1,i.needEffect=!1,i.pos(e.txt_num.x+e.txt_num.width,81),e.addChild(i);var s=an.create(340);i.bindData=s}i.visible=!0,e.txt_gnum.x=i.x+45,e.txt_gnum.changeText("("+t+")"),e.txt_time.x=e.txt_gnum.x+e.txt_gnum.textWidth+30}else e.txt_num.x=150,i&&(i.visible=!1),e.txt_time.x=e.txt_num.x+e.txt_num.contextWidth+30},t.sortArray=function(e,t){return e.missionSeq-t.missionSeq},t.onTimer=function(){var e=this,t=e.endTime-J.curServerTime;if(t<0){if(t=0,e.clearTimer(e,e.onTimer),e.toc21210.clCount++,e.toc21210.clCount<e.toc21210.maxClCount){var i=Ta.getIndex(44);e.toc21210.hfTime=parseInt(Ta.MODEL.value(i))}else e.toc21210.hfTime=0;e.updateCount()}else e.txt_time.innerHTML="("+nc.createColor(he.deltaFormat(t,"hh:mm:ss"),"#23b11f")+ed.n[1627]},t.showByVSC=function(e,t){on.reqCopy(3),on.reqCopy(49)},t.hideByVSC=function(e,t){this.clearTimer(this,this.onTimer),this._openCopyId=0},t.onShare=function(e){Fl.sendToModule("COPY_SHARE",["modules.activityDaily.DailyModule"],{id:4})},n.onPlus=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=0);var i=ha.ins.remainBuy;if(ha.ins.wild_cl_count>=ha.ins.wild_cl_max)Vl.ins.showById(2162,1);else{He.getIndex(ha.ins.buyNum+1);var s=ur.getFormat(ed.n[1628],[nc.createColor("100元宝","#01fb01"),nc.createColor(i+"次数","#01fb01"),nc.createColor(ed.n[1629],"#e6d80d")]);ja.ins.show(s,ms.create(n,n.onConfirm,[100,e,t,i]))}},n.onConfirm=function(e,t,i,s,n){if(1==n){if(0==s)return void Vl.ins.showById(2161,1);if(Gi.ins.YB<e)return void ja.ins.showNoGold();Fl.sendToService(new vt),t&&on.reqEntry(i)}},n}(),Qu=function(e){function t(){this.lastTime=0,t.__super.call(this),this.txt_bossState.style.font="SimHei",this.txt_bossState.style.fontFamily="SimHei",this.txt_bossState.style.fontSize=20,this.txt_bossState.style.align="center"}u(t,"modules.boss.views.flyupboss.FlyupBossItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),Y.timer.clear(this,this.showTime)},i.showTime=function(){this.lastTime<=0?Y.timer.clear(this,this.showTime):(this.lastTime--,this.txt_bossState.innerHTML=nc.createColor(this.getDHM(this.lastTime),"#e41b00"))},i.getDHM=function(e){var t=e,i=Math.floor(t/3600),s=Math.floor((t-3600*i)/60),n=t-3600*i-60*s;return i<=0?10<=s?"00:"+s+(10<=n?":":":0")+n:"00:0"+s+(10<=n?":":":0")+n:i<=0&&s<=0?10<=n?"00:00:"+n:"00:00:0"+n:(10<=i?"":"0")+i+(10<=s?":":":0")+s+(10<=n?":":":0")+n},i.getJobString=function(e){var t;switch(e){case 1:t="战士";break;case 2:t="法师";break;case 3:t="道士"}return t},n(0,i,"select",null,function(e){this.box_select.visible=e,this.txt_bossName.color=e?"#fff9b4":"#91856d"}),n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){var i=t.tag.id,s=uo.getIndex(i),n=s,o=uo.MODEL.bossId(s);s=Xl.getIndex(o);var a=Xl.MODEL.level(s),r=(Xl.MODEL.muId(s),Xl.MODEL.name(s));t.txt_bossName.changeText(r);var l=uo.MODEL.levelLimit(n),c=uo.MODEL.zsLevelLimit(n);uo.MODEL.isCard(n);switch(0<c?t.txt_bossLv.changeText(c+"转"):0<l?t.txt_bossLv.changeText(l+"级"):t.txt_bossLv.changeText(a+"级"),t.lastTime=Math.floor((t.tag.time-J.curServerTime)/1e3),0==Gi.ins.actorFlyUpBosstask&&0<l&&l>Gi.ins.lv&&(t.tag.status=1),t.tag.status){case 0:Gi.ins.actorList[0].job;t.txt_bossState.innerHTML="飞升"+ur.WORDS[Z.ins.getFlyupLimit(t.tag.id)]+"重解锁";break;case 1:0<c?t.txt_bossState.innerHTML=nc.createColor(c+"转开启","#e41b00"):0<l&&(t.txt_bossState.innerHTML=nc.createColor(l+"级开启","#e41b00"));break;case 2:t.txt_bossState.innerHTML=nc.createColor("可击杀","#23b11f");break;case 3:t.showTime(),Y.timer.loop(1e3,t,t.showTime,null,!0)}}}),t}(Qi),Zu=function(e){function t(){this._vo=null,t.__super.call(this),this.txt_des.style.font="SimHei",this.txt_des.style.color="#e0d6c1",this.txt_des.style.fontSize=20,this.txt_des.style.fontFamily="SimHei",this.txt_des.style.align="center"}u(t,"modules.boss.views.flyupboss.FlyupBossLevelRenderView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.getJobString=function(e){var t;switch(e){case 1:t="战士";break;case 2:t="法师";break;case 3:t="道士"}return t},n(0,i,"select",null,function(e){this.img_selected.visible=e}),n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(Si,t,"dataSource",e),e){t._vo=e;Gi.ins.actorList[0].job;t._vo.flyup_limit<=Gi.ins.actorFlyUpLevel?(t.box_mask.visible=!1,t.box_go.visible=!t._vo.selected):(t.box_mask.visible=!0,t.box_go.visible=!1,t.txt_des.innerHTML="飞升"+nc.createColor(ur.WORDS[t._vo.flyup_limit],"#e6d80d")+"重解锁"),Z.ins.showRedPot(t._vo.id-1,!0)?t.img_red.visible=!0:t.img_red.visible=!1,Z.ins.renderRedArr[t._vo.id-1]=t.img_red.visible,t.img_bg.skin=Or.getFullUrl("ui/images/boss/flyupboss/"+t._vo.buttonImg+".png")}}),t}(Si),$u=function(e){function l(){var e=this;e._array=null,e._avatar=null,e.flyupData=null,e.toc21259=null,e.first=!0,e.sorrArr=null,e.endTime=NaN,e.curObj=null,e.awardArr=[],e.textArr=[],l.__super.call(e)}u(l,"modules.boss.views.flyupboss.FlyupBossMainView",Mc);var t=l.prototype;return t.initialize=function(){var e=this;e.flyupData=Z.ins,e.list_level.itemRender=Zu,e.list_level.hScrollBarSkin="",e.list_level.selectEnable=!0,e.list_level.selectHandler=ms.create(e,e.onLevelSelected,null,!1),e.list_level.renderHandler=ms.create(e,e.onListRender1,null,!1),e.list_moster.itemRender=Qu,e.list_moster.vScrollBarSkin="",e.list_moster.selectEnable=!0,e.list_moster.renderHandler=ms.create(e,e.onListRender,null,!1),e.list_moster.selectHandler=ms.create(e,e.onChange,null,!1),e._array=[];for(var t=0;t<4;t++){var i=new ra;i.x=101+142*t,i.y=864,e.box_c.addChild(i),e.awardArr.push(i);var s=new Nr;s.x=i.x-10,s.y=i.y+120,s.font="SimHei",s.width=135,s.align="center",s.fontSize=20,e.box_c.addChild(s),e.textArr.push(s)}},t.onLevelSelected=function(e){var t=this.list_level.array[e];t.flyup_limit>Gi.ins.actorFlyUpLevel&&Vl.ins.showById2(4340,[t.flyup_limit],1),t.selected=!0,this.flyupData.currentSubSelected=e;for(var i=0;i<this.list_level.array.length;i++){var s=this.list_level.array[i];if(i!=e&&s.selected){s.selected=!1,this.list_level.changeItem(i,s);break}}this.toNewSelected(),this.updateMonster(),this.onChange(0),this.autoSelected()},t.updateMonster=function(){var e,t=this,i=[];t.sorrArr=[];var s=0;if(0==Gi.ins.actorFlyUpBosstask)for(i=[47022,47023,47024],s=0;s<i.length;s++)(e=new Object).id=parseInt(i[s]),e.status=2,e.selected=!1,e.time=0,t.sorrArr.push(e);else for(i=t.list_level.selectedItem.bossIds,s=0;s<i.length;s++)(e=new Object).id=parseInt(i[s]),e.status=t.flyupData.map[i[s]].state,e.selected=t.flyupData.map[i[s]].selected,e.time=t.flyupData.map[i[s]].time,t.sorrArr.push(e);Y.timer.once(60,t,t.setBoss,[t.sorrArr])},t.setBoss=function(e){3<(this.list_moster.dataSource=e).length?this.listgb.height=464:this.listgb.height=409,this.addBossGuide()},t.autoSelected=function(){if(!(0<Gi.ins.actorFlyUpLevel&&0==Gi.ins.actorFlyUpBosstask)){for(var e=this.sorrArr,t=[],i=0,s=0,n=0;n<e.length;n++)2==e[n].status&&n<e.length&&t.push(n);t.length<=0?(this.list_moster.scrollTo(0),this.list_moster.selectedIndex=0,i=uo.getIndex(this.sorrArr[0].id),s=uo.MODEL.bossId(i),Xl.getIndex(s),this.onChange(0)):(this.list_moster.scrollTo(t[t.length-1]),this.list_moster.selectedIndex=t[t.length-1],i=uo.getIndex(this.sorrArr[t[t.length-1]].id),s=uo.MODEL.bossId(i),Xl.getIndex(s),this.onChange(t[t.length-1]))}},t.sortArray=function(e,t){var i=0,s=0;return(i=0==e.status?9:e.selected?2==e.status?1:3:2==e.status?5:7)==(s=0==t.status?9:t.selected?2==t.status?1:3:2==t.status?5:7)?-(e.id-t.id):i-s},t.updateCount=function(){var e=this;0<Z.ins.hfTime?(e.endTime=J.curServerTime+1e3*Z.ins.hfTime,e.txt_time.visible=!0,e.timerLoop(1e3,e,e.onTimer),e.onTimer()):(e.txt_time.visible=!1,e.clearTimer(e,e.onTimer)),Z.ins.flyup_cl_count=e.toc21259.clCount,e.txt_num.innerHTML=ed.n[1630]+nc.createColor(""+e.toc21259.clCount,0==e.toc21259.clCount?"#ff2e24":"#23b11f")+nc.createColor("/"+Z.ins.flyup_cl_max,"#23b11f");var t=ri.ins.getGoodsNum(2162);if(e.txt_gnum.visible=0<t,e.btn_plus.visible=e.toc21259.clCount<1&&t<1,0<t){if(!i){var i=new ra(52);i.isShowSmallIcon=!0,i.needGridBg=!1,i.needEffect=!1,i.pos(223,81),e.addChild(i);var s=an.create(2162);i.bindData=s}i.visible=!0,e.txt_gnum.x=i.x+45,e.txt_gnum.changeText("("+t+")"),e.txt_time.x=e.txt_gnum.x+e.txt_gnum.textWidth+15}else i&&(i.visible=!1),e.txt_time.x=283},t.onTimer=function(){var e=this.endTime-J.curServerTime;if(e<0){if(e=0,this.clearTimer(this,this.onTimer),this.toc21259.clCount++,this.toc21259.clCount<Z.ins.flyup_cl_max){var t=Ta.getIndex(228);Z.ins.hfTime=parseInt(Ta.MODEL.value(t))}else Z.ins.hfTime=0;this.updateCount()}else this.txt_time.innerHTML="("+nc.createColor(he.deltaFormat(e,"hh:mm:ss"),"#23b11f")+ed.n[1627]},t.onListRender=function(e,t){t==this.list_moster.selectedIndex?e.select=!0:e.select=!1},t.onListRender1=function(e,t){t==this.list_level.selectedIndex?e.select=!0:e.select=!1},t.onChange=function(e){var t=this.sorrArr;if(this.curObj=t[e],this.curObj){var i=uo.getIndex(this.curObj.id),s=i,n=uo.MODEL.bossId(i);i=Xl.getIndex(n);uo.MODEL.key(s);for(var o=uo.MODEL.bossShowAward(s).split(";"),a=0;a<o.length;a++){var r=o[a].split(",")[0];this.setGodEquipStar(r,a)}this.btn_challenge.disabled=!(2==this.curObj.status),this.setAvatar(i,this.curObj.id)}},t.setGodEquipStar=function(e,t){var i=an.create(e);this.awardArr[t].bindData=i,this.textArr[t].text=i.name,this.textArr[t].color=Co.getByQuality(i.colourId)},t.setAvatar=function(e,t){var i=this,s=Xl.MODEL.muId(e);e=Cs.getIndex(s);var n=Cs.MODEL.avatarId(e);if(!i._avatar){i._avatar=new Jc,i._avatar.renderInSelf=!0,i._avatar.pos(450,640);var o=i.box_c.getChildIndex(i.img_yz);i.box_c.addChildAt(i._avatar,o+1)}i._avatar.mid=n,i._avatar.type=mc.MONSTER,i._avatar.loadAvatarParts("mid",n,!0),i._avatar.setDir(4),i._avatar.play("stand"),i._avatar.mat.identity(),i.btn_challenge.disabled=!(2==i.curObj.status),i.img_bg.skin=Or.getFullUrl("ui/images/boss/flyupboss/"+Z.ins.getBGimgStr(t)+".jpg"),0<Gi.ins.actorFlyUpLevel&&0==Gi.ins.actorFlyUpBosstask&&(i.btn_challenge.disabled=!1)},t.delayReqViewData=function(e){Y.timer.loop(e,this,this.reqViewData)},t.reqViewData=function(){on.reqCopy(47)},t.addBossGuide=function(){0<Gi.ins.actorFlyUpLevel&&0==Gi.ins.actorFlyUpBosstask&&(0==Gi.ins.actorFlyUpBosstask&&(Bl.Ins().showforDir(2,ed.n[1632],this.btn_challenge,!0,!1,0,0,!1),Bl.Ins().lockSceneShowByDisPlay(this.btn_challenge),this.list_moster.selectedIndex=0),this.list_level.selectedIndex=0)},t.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.list_level.dataSource=t.flyupData.configArr,on.reqCopy(47),t.btn_challenge.on("click",t,t.onClickHandler),t.btn_plus.on("click",l,t.onPlus),t.btn_help.on("click",t,t.openHelp),t.link_refesh.on("click",t,t.onClickHanlder),t.btn_next.on("click",t,t.onClick),t.btn_prev.on("click",t,t.onClick),t.btn_share.on("click",t,t.onShare),t.first=!0},t.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),Y.timer.clear(t,t.reqViewData),t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.btn_challenge.off("click",t,t.onClickHandler),t.btn_plus.off("click",l,t.onPlus),t.btn_help.off("click",t,t.openHelp),t.link_refesh.off("click",t,t.onClickHanlder),t.btn_next.off("click",t,t.onClick),t.btn_prev.off("click",t,t.onClick),t.btn_share.off("click",t,t.onShare)},t.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),Y.timer.clear(this,this.reqViewData),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null)},t.onClickHandler=function(e){if(this.curObj){if(ri.ins.hasEmptyNum(20))return J.dtoEnterScene&&15==J.dtoEnterScene.type?(ha.ins.exitCopy(1),void Y.timer.once(500,this,this.enterFlyCopy)):void(!Wc.isEnabledChangeScene()||J.dtoEnterScene&&13==J.dtoEnterScene.type?Vl.ins.showById(2126,1):this.enterFlyCopy());ja.ins.showBagRecycle()}},t.enterFlyCopy=function(){if(ha.ins.isCheckPointBoss=!1,0!=Gi.ins.actorFlyUpBosstask)if(Z.ins.flyup_cl_count<=0){if(0<ri.ins.getGoodsNum(2162)){var e=Re.getIndex(2162),t=ur.getFormat(ed.n[1633],[nc.createColor(Re.MODEL.name(e),Co.getByQuality(Re.MODEL.colourId(e)))]);return void ja.ins.showBox(t,ed.n[1634],ms.create(this,this.onUseConfirm),!1,1,null,ed.n[1635],ed.n[1636])}if(0<Z.ins.remainBuy)return void this.onPlus(!0,this.curObj.id);var i=Z.ins.remainBuy,s=ur.getFormat(ed.n[1637],[nc.createColor("500元宝","#01fb01"),nc.createColor(i+"次数","#01fb01"),nc.createColor(ed.n[1638],"#e6d80d")]);ja.ins.show(s,ms.create(l,l.onConfirm,[100,!1,this.curObj.id,i]))}else on.reqEntry(this.curObj.id);else on.reqEntry(47022)},t.onUseConfirm=function(e){if(1==e){var t=ri.ins.getGoodsDto(2162);t&&this.curObj&&(Fl.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:t,num:1}),on.reqEntry(this.curObj.id))}},t.onPlus=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=0);var i=Z.ins.remainBuy;if(Z.ins.flyup_cl_count>=Z.ins.flyup_cl_max)Vl.ins.showById(2162,1);else{var s;ri.ins.getGoodsNum(2162);s=ur.getFormat(ed.n[1639],[nc.createColor("500元宝","#01fb01"),nc.createColor(i+"次数","#01fb01"),nc.createColor(ed.n[1629],"#e6d80d")]),ja.ins.show(s,ms.create(l,l.onConfirm1,[500,e,t,i]))}},t.openHelp=function(){On.ins.open("AE_EXPLAIN_VIEW",{desc:ed.n[1641]})},t.onClickHanlder=function(e){On.ins.open("MAGICATTENTION_VIEW",{type:47,selectedIndex:this.list_level.selectedIndex})},t.updateView=function(){this.updateMonster(),this.btn_share.visible=Hl.getCpShareSwitch(),this.img_red.visible=Ft.ins.getRWT(5)<=0},t.updateByVSC=function(e){e instanceof protos.boss.toc_21259?(this.toc21259=e,this.onLevelSelected(0),this.updateView(),this.list_level.refresh()):e instanceof protos.boss.toc_22623?(this.toc21259&&(this.toc21259.clCount=e.flyupBossCount,this.toc21259.clCount>=Z.ins.flyup_cl_max&&(Z.ins.hfTime=0)),this.updateCount()):this.list_level.refresh()},t.onClick=function(e){var t=this,i=t.list_level.selectedIndex;if(e.target==t.btn_next?i<t.list_level.length-1&&i++:e.target==t.btn_prev&&0<i&&i--,i!=t.list_level.selectedIndex&&(t.list_level.selectedIndex=i,t.list_level.tweenTo(i,200)),0<t.list_level.selectedIndex)for(var s=Z.ins.renderRedArr,n=0;n<t.list_level.selectedIndex;n++){if(1==s[n])return void(t.btn_prev.showTip=!0);t.btn_prev.showTip=!1}else t.btn_prev.showTip=!1},t.updateList=function(){this.list_level.refresh()},t.toNewSelected=function(){var e=this;if(1==this.first){this.first=!1;var t=-1!=Z.openLevel?Z.openLevel:Gi.ins.actorFlyUpLevel;Z.openLevel=-1,3<=t&&t<=this.list_level.length?(this.list_level.selectedIndex=t-1,Y.timer.once(100,this,function(){e.list_level.tweenTo(t-2,200)})):1==t||2==t?this.list_level.selectedIndex=t-1:0==t&&(this.list_level.selectedIndex=t)}},t.onShare=function(e){Fl.sendToModule("COPY_SHARE",["modules.activityDaily.DailyModule"],{id:5})},l.onConfirm=function(e,t,i,s,n){if(1==n){if(0==s)return void Vl.ins.showById(2161,1);var o=ri.ins.getGoodsNum(e),a=an.create(e);if(0<o)wi.reqUseGoods(a.uuId,1),t&&on.reqEntry(i);else{var r=ur.getFormat(ed.n[1628],[nc.createColor("500元宝","#01fb01"),nc.createColor(s+"次数","#01fb01"),nc.createColor(ed.n[1629],"#e6d80d")]);ja.ins.show(r,ms.create(l,l.onConfirm1,[500,t,i,s]))}}},l.onConfirm1=function(e,t,i,s,n){if(1==n){if(0==s)return void Vl.ins.showById(2161,1);if(Gi.ins.YB<e)return void ja.ins.showNoGold();Fl.sendToService(new ct),t&&on.reqEntry(i)}},l.NAME="FLYUPBOSSMAINVIEW",l}(),eh=function(e){function t(){this.goodsLink=null,this.playerId=0,this.link=null,this.objList=[],this.desc="",this.serverNum=0,this.playerName=null,t.__super.call(this),this.initUI()}u(t,"modules.boss.views.jipinRecord.JipinRecordItem",e);var i=t.prototype;return i.initUI=function(){var e=this;e.txt_des.style.font="SimHei",e.txt_des.style.fontFamily="SimHei",e.txt_des.style.fontSize=24,e.txt_des.style.wordWrap=!0,e.txt_des.style.color="#90877b",e.txt_des.style.align="left",e.bossType.style.font="SimHei",e.bossType.style.fontFamily="SimHei",e.bossType.style.fontSize=24,e.bossType.style.wordWrap=!0,e.bossType.style.color="#e0d6c1",e.bossType.style.align="left",e.goodsLink=new r,e.goodsLink.color="#90877b",e.goodsLink.fontSize=24,e.goodsLink.font="SimHei",e.goodsLink.pos(44,69),e.goodsLink.leading=8,e.goodsLink.width=540,e.goodsLink.height=80,e.goodsLink.wordWrap=!0,e.addChild(e.goodsLink),e.goodsLink.on("link",e,e.showTips)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.objList=[],this.goodsLink.innerHTML&&0<this.goodsLink.innerHTML.length&&(this.goodsLink.innerHTML=""),this.desc=""},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e),this.goodsLink.off("link",this,this.showTips),this.goodsLink.innerHTML&&0<this.goodsLink.innerHTML.length&&(this.goodsLink.innerHTML=""),this.objList=[],this.desc=""},i.copyType=function(e){var t;switch(e){case 2:t=ed.n[1644];break;case 3:t=ed.n[1645];break;case 47:t=ed.n[1646];break;case 13:t=ed.n[1647];break;case 26:t=ed.n[1648];break;case 41:t=ed.n[1649];break;case 42:t=ed.n[1650];break;case 21:t=ed.n[1651];break;case 20:t=ed.n[1652];break;case 53:t=ed.n[1653];break;case 57:t=ed.n[1654];break;case 49:t=ed.n[1655]}return t},i.showTips=function(e){var t=this,i=t.objList[e];if(e==t.playerName)return 0!=t.serverNum?void To.reqViewOther(t.playerId,"37wan",t.serverNum):void To.reqViewOther(t.playerId);var s,n=Re.getIndex(i),o=Re.MODEL.type(n);if(1==o?s=an.create(i):2==o&&(s=Tl.create(i)),s instanceof protos.backpack.DtoGoods?(t.toolTip=s.isFashionProp?Gs.instance:qr.instance,wr.isMabiOrHushenRing(s.goodsId)&&(t.toolTip=qa.instance),8==s.subType&&(t.toolTip=Lr.instance),34==s.subType&&(t.toolTip=zc.instance),s instanceof protos.backpack.DtoEquip&&(wr.isSoaringEquip(i)?t.toolTip=pr.instance:wr.isSoaringInteriors(i)?t.toolTip=N.instance:Vn.getIsDragon(s.goodsId)?t.toolTip=va.instance:Ot.isMoEquipByDto(s)?(Ot.ins.curStatus=-1,Ot.ins.curPosition=s.decoratePosition,t.toolTip=Va.instance):t.toolTip=$t.instance)):t.toolTip=null,wr.isZZTID(i))Fl.sendToModule("ZZT_GOOD_TIP",["modules.zzt.ZztModule"],s);else if(wr.isChuanShiEqu(i)){parseInt(i.toString().substr(-1,1));var a={lv:1,ps:parseInt(i.toString().substr(-1,1))-1};$s.instance.show(a)}else if(Vn.getIsSamsara(s.goodsId)){var r=Ti.ins.getJobByCfg(s);z.ins.show({dto:s,actorId:r,pos:0,noRefine:!0})}else 22!=s.subType?wr.isZhuhunMaterial(s.goodsId)?On.ins.open("LUNHUI_ZHUHUN_MATERIAL_TIP",{dtoGoods:s}):t._toolTip&&s&&t._toolTip.show(s):On.ins.open("SoulSkinGoodsTip",s.goodsId)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){t.goodsLink.innerHTML&&0<t.goodsLink.innerHTML.length&&(t.goodsLink.innerHTML=""),t.desc="";var i=1==e.istop;t.img_top.visible=i,t.objList=[],t.playerId=e.playerId;var s=e.missionId,n=uo.getIndex(s),o=uo.MODEL.cate(n),a=t.copyType(o),r=e.time,l=V.getSTRYMDHM(r);t.bossType.innerHTML=nc.createColor(a,"#25b11f")+nc.createColor(l,"#25b11f");var c,d="",u=0;53==o||57==o?Gi.ins.serverId==e.serverId?(t.desc="玩家",t.serverNum=0):(t.serverNum=e.serverId,d="S."+e.serverId+"服",t.desc=nc.createColor(d,"#02b0e9")+"玩家"):(t.serverNum=0,t.desc="玩家"),u=53==o?(n=Dc.getIndex(s),Dc.MODEL.bossId(n)):uo.MODEL.bossId(n);var h=Xl.getIndex(u);c=Xl.MODEL.name(h),t.playerName=e.playerName,t.desc+=nc.createColorHerf(t.playerName,"#02b0e9",t.playerName);var _=e.awardList;t.desc+="击杀了"+nc.createColor(c,"#e41b00")+ed.n[1656];for(var p=0;p<_.length;p++){var f=_[p],g=Re.getIndex(f),v=Re.MODEL.name(g),m=Co.getByQuality(Re.MODEL.colourId(g));""==t.desc&&0==p?t.desc=nc.createColor("【",m)+nc.createColorHerf(v,m,v)+nc.createColor("】",m):t.desc+=nc.createColor("【",m)+nc.createColorHerf(v,m,v)+nc.createColor("】",m),t.objList[v]=f,t.goodsLink.innerHTML=t.desc}}}),t}(Ar),th=function(e){function t(){t.__super.call(this),this.initUI()}u(t,"modules.boss.views.jipinRecord.JipinRecordView",Pt);var i=t.prototype;return i.initUI=function(){this.list.itemRender=eh,this.list.vScrollBarSkin=""},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e);var t=new es;Fl.sendToService(t)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e)},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){var t=[];if(e instanceof protos.boss.toc_30007){var i=e.topList,s=e.notopList;0<(t=i.concat(s)).length?(this.list.dataSource=t,this.txt_nodata.visible=!1):(this.list.dataSource=[],this.txt_nodata.visible=!0)}},t}(),ih=function(e){function t(){var e=this;e._remainSec=0,e._grids=null,e._currentCate=0,e.list=[],e.moEquitList=[],e.shenyuList=[],e.shenEquitList=[],e.redEquitList=[],e.syFragmentList=[],e.szFragmentList=[],e.redFragmentList=[],e.otherList=[],e.commonList=[],e.syFragmentMap={},e.szFragmentMap={},e.otherMap={},e.belongName=null,e.belongServer=0,e.isCollection=0,e.BlackMacketGoods=null,t.__super.call(e)}u(t,"modules.boss.views.scene.BossBelongRewardNewV",hi);var i=t.prototype;return i.initialize=function(){var e=this;e.btn_gain.clickHandler=ms.create(e,e.onGain,null,!1),e._grids=new kl(2,4,116,10,30,!0,null,10),e._grids.isCenter=!0,e._grids.pos(3,550),e._grids.height+=40,e.addChild(e._grids),e.txt_des.style.font="SimHei",e.txt_des.style.fontFamily="SimHei",e.txt_des.style.fontSize=24,e.txt_des.style.color="#e41b00",e.txt_des.style.align="center"},i.onGain=function(){if(53==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId)));else if(57==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId)))if(0<Ys.count)this.onJxrComplete();else{var e=[{url:Or.getJxrDBPath("MissionTransfers"),type:"arraybuffer",cls:Ys}];Wl.ins().onLoadJxrs(e,ms.create(this,this.onJxrComplete))}else 56==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId))||ha.ins.exitCopy(300),On.ins.isOpen("RELIVE_TIPS")&&On.ins.close("RELIVE_TIPS");On.ins._closePanelForce(this)},i.update=function(e){var t,i=this,s=0,n=0,o=0,a=0,r=0;if(i._currentCate=0,i.BlackMacketGoods=[],e){if(e&&e.rewards){i._currentCate=e.copyId;var l,c=e.rewards;for(var d in c)if(l=c[d],1==wr.isBlackMacketGoods(l.modelId)&&(t=an.create(l.modelId,l.count),i.BlackMacketGoods.push(t)),s=Re.MODEL.type(Re.getIndex(l.modelId)),n=Re.MODEL.subType(Re.getIndex(l.modelId)),1==s&&12!=n&&11!=n&&17!=n)(t=i.otherMap[l.modelId])?t.goodsNum+=l.count:(t=an.create(l.modelId,l.count),i.otherMap[l.modelId]=t,i.otherList.push(t));else switch((t=an.create(l.modelId,l.count)).subType){case 16:i.moEquitList.push(t);break;case 3:i.shenyuList.push(t);break;case 15:i.shenEquitList.push(t);break;case 9:i.redEquitList.push(t);break;case 17:i.szFragmentList.push(t);break;case 12:(o=i.syFragmentMap[l.modelId])?t.goodsNum+=l.count:(o=l.modelId,i.syFragmentMap[l.modelId]=o,i.syFragmentList.push(t));break;case 11:if(a=i.szFragmentMap[l.modelId])for(r=0;r<i.redFragmentList.length;r++)i.redFragmentList[r].goodsId==l.modelId&&(i.redFragmentList[r].goodsNum+=l.count);else a=l.modelId,i.szFragmentMap[l.modelId]=a,i.redFragmentList.push(t);break;case 10:i.commonList.push(t);break;default:i.otherList.push(t)}var u=i.moEquitList.concat(i.shenyuList).concat(i.shenEquitList).concat(i.redEquitList).concat(i.syFragmentList).concat(i.szFragmentList).concat(i.redFragmentList).concat(i.otherList).concat(i.commonList);i._grids.gridDatas=u,i._grids.vScrollBar.value=1,i._grids.x=i.width-i._grids.contentW>>1,i.addChildAt(i.xiala,i.numChildren-1),i.xiala.visible=4<u.length}var h=!1;if(e&&e.playerName&&(h=e.playerName==Gi.ins.charName,i.belongName=e.playerName),i.isFirstKill(h)&&i.setFirstKill(),e&&e.playerName&&i.txt_name.changeText(e.playerName),e&&e.isCollection&&(i.isCollection=e.isCollection),41==e.copyId||42==e.copyId){if(i.txt_rank.visible=!1,i.txt_guildName.visible=!0,i.txt_guildName.changeText(e.guildName),i.txt_title.text=h?ed.n[1657]:ed.n[1658],i.txt_gsz.text=h?"我是归属者：":ed.n[1659],0<e.canShow)switch(i.txt_des.visible=!0,e.canShow){case 1:i.txt_des.innerHTML=ed.n[1660];break;case 2:i.txt_des.innerHTML=ed.n[1661]}}else if(50==e.copyId)On.ins.isOpen("FIREDRAGONGUWUVIEW")&&On.ins.close("FIREDRAGONGUWUVIEW"),i.txt_rank.visible=!0,i.txt_rank.text=ed.n[1662]+e.myrank+"名",i.txt_guildName.visible=!0,i.txt_guildName.changeText(e.guildName),i.txt_title.text=h?ed.n[1663]:ed.n[1664],i.txt_gsz.text=h?"我是封印者：":ed.n[1665];else if(52==e.copyId)On.ins.isOpen("FESTBOSS_GUWU_VIEW")&&On.ins.close("FESTBOSS_GUWU_VIEW"),i.txt_rank.visible=!0,i.txt_rank.text=ed.n[1662]+e.myrank+"名",i.txt_guildName.visible=!0,i.txt_guildName.changeText(e.guildName),i.txt_title.text=h?ed.n[1667]:ed.n[1668],i.txt_gsz.text=h?"我是击杀者：":ed.n[1669];else if(53==e.copyId){if(i.txt_rank.visible=!1,i.txt_guildName.visible=!1,i.txt_title.text=h?ed.n[1657]:ed.n[1658],i.txt_gsz.text=h?"我是归属者：":ed.n[1659],i.belongServer=e.serverId,0<e.canShow)switch(i.txt_des.visible=!0,e.canShow){case 1:i.txt_des.innerHTML=ed.n[1673];break;case 2:i.txt_des.innerHTML=ed.n[1661]}53==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId))&&0==i.isCollection&&Fl.sendToModule("CROSSBOSSDEAD",["modules.corssbattle.CrossBossModule"])}else if(57==e.copyId){if(i.txt_rank.visible=!1,i.txt_guildName.visible=!1,i.txt_title.text=h?ed.n[1657]:ed.n[1658],i.txt_gsz.text=h?"我是归属者：":ed.n[1659],i.belongServer=e.serverId,0<e.canShow)switch(i.txt_des.visible=!0,e.canShow){case 1:i.txt_des.innerHTML=ed.n[1673];break;case 2:i.txt_des.innerHTML=ed.n[1661]}53==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId))&&0==i.isCollection&&Fl.sendToModule("CROSSBOSSDEAD",["modules.corssbattle.CrossBossModule"])}else i.txt_rank.visible=!1,i.txt_guildName.visible=!1,i.txt_des.visible=!1,i.txt_title.text=h?ed.n[1680]:ed.n[1681],i.txt_gsz.text=h?"我是归属者：":ed.n[1659];var _=Or.getActorHeadPath(e.roleType,e.gender);i.img_head.skin=_,i._remainSec=10,i.timerLoop(1e3,i,i.onTimer),i.onTimer()}},i.onTimer=function(){if(this._remainSec<=0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),gi.ins.show(this);var t=ha.ins.curCopyId;on.reqAward(t)},i.onRemove=function(e){if(ui.SubPanel.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer),0<this.belongServer&&0==this.isCollection&&57!=this._currentCate){var t="S."+this.belongServer+this.belongName;Fl.sendToModule("CROSSBOSSRESULT",["modules.corssbattle.CrossBossModule"],t)}},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.list=[],t.moEquitList=[],t.shenyuList=[],t.shenEquitList=[],t.redEquitList=[],t.syFragmentList=[],t.szFragmentList=[],t.redFragmentList=[],t.otherList=[],t.commonList=[],t.otherMap={},t._grids.destroy(e),t._grids=null,ui.SubPanel.prototype.destroy.call(t,e)},i.onJxrComplete=function(){for(var e=ha.ins.curCopyId,t=0,i=0,s=0;s<Ys.count;s++)if(e==Ys.MODEL.nextMissionId(s)){var n=Ys.MODEL.location(s);t=n[0]+1,i=n[1]+1;break}ao.ins().currentSelectMissionID=0,on.reqEntry(3096,t,i,0,0,ha.ins.curCopyId),0<this.BlackMacketGoods.length&&(ha.ins.crossAwardArr=this.BlackMacketGoods,ha.ins.isCrossFirst=!0)},i.isFirstKill=function(e){var t=!1,i=uo.getIndex(ha.ins.curCopyId);if(3==uo.MODEL.cate(i)){var s=ha.ins.bossWildHash.take(ha.ins.curCopyId);t=s&&s.isFirstKill&&e}return t},i.setFirstKill=function(){var e=new ra,t=ha.ins.getFirstKillReward(ha.ins.curCopyId),i=an.create(t.id,t.count);e.dataSource=i,this.addChild(e),e.pos(302,500),this.addChild(ti.createText(128,464,0,0,ed.n[1683],24,"#e0d6c1"));var s=ti.createText(210,624,300,0,ed.n[1684],22);s.text=i.simpleName,s.color=Co.getByQuality(Re.MODEL.colourId(i.cfgIdx)),this.addChild(s);var n=ti.createImage("ui/layouts/fightresult/boss_bq_ssbdd.png",304,500);this.addChild(n),this.txt_title.y=654,this._grids.y=693,this._grids.height-=143},t}(),sh=function(e){function t(){this.lineOneText=null,this.lineTwoText=null,this.levelNameImg=null,this.lineOneBg=null,this.lineTwoBg=null,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_CheckPointScene",dc);var i=t.prototype;return i.initialize=function(){var e=this;e.lineOneText=new Yi,e.lineOneText.fontSize=35,e.lineOneText.font="SimHei",e.lineOneText.style.wordWrap=!1,e.lineOneText.color="#02b0e9",e.lineOneText.align="left",e.lineTwoText=new Yi,e.lineTwoText.fontSize=35,e.lineTwoText.font="SimHei",e.lineTwoText.style.wordWrap=!1,e.lineTwoText.color="#02b0e9",e.lineTwoText.align="right",e.lineOneBg=new Dl,e.lineOneBg.skin=Or.getAtlasSubPath("base_ui2/FieldBOSS_mimg_frame.png"),e.lineTwoBg=new Dl,e.lineTwoBg.skin=Or.getAtlasSubPath("base_ui2/FieldBOSS_mimg_frame.png"),e.superBoss.filters=[new br("#b11717",10,0,0)],e.box_ck.visible=e.box_sb.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.size(Y.stage.width,Y.stage.height),this.clip_num.value=ae.instance.currentPoint+"",this.box_ck.visible=!0,Y.timer.once(3e3,this,this.onHide)},i.showEffect=function(){var e=this;e.lineOneText.innerHTML=ed.n[1685],e.lineOneText.x=.2*(e.width-e.lineOneText.width)-100,e.lineOneText.y=.2*(e.height-e.lineOneText.height)-50,Yl.to(e.lineOneText,{x:.5*(e.width-e.lineOneText.width)-80,y:.35*(e.height-e.lineOneText.height)},600,null,ms.create(e,e.onTextOneEaseInEnd)),e.lineOneBg.alpha=.2,e.lineOneBg.width=e.lineOneText.width+50,e.lineOneBg.height=60,e.lineOneBg.x=.1*(e.width-e.lineOneBg.width)-300,e.lineOneBg.y=.35*(e.height-e.lineOneText.height)-10,e.addChild(e.lineOneBg),e.addChild(e.lineOneText),Yl.to(e.lineOneBg,{x:.5*(e.width-e.lineOneText.width)-100,alpha:1},600,tn.easeOut,ms.create(e,e.onImgOneEaseInEnd)),e.lineTwoText.innerHTML=ed.n[1686],e.lineTwoText.x=.6*(e.width-e.lineTwoText.width)+100,e.lineTwoText.y=.6*(e.height-e.lineTwoText.height)+50,Yl.to(e.lineTwoText,{x:.5*(e.width-e.lineTwoText.width)+160,y:.415*(e.height-e.lineTwoText.height)},600,null,ms.create(e,e.onTextTwoEaseInEnd)),e.lineTwoBg.alpha=.2,e.lineTwoBg.width=e.lineTwoText.width+50,e.lineTwoBg.height=60,e.lineTwoBg.x=.1*(e.width-e.lineTwoBg.width)+300,e.lineTwoBg.y=.415*(e.height-e.lineTwoText.height)-10,e.addChild(e.lineTwoBg),e.addChild(e.lineTwoText),Yl.to(e.lineTwoBg,{x:.5*(e.width-e.lineTwoBg.width)+160,alpha:1},600,tn.easeOut,ms.create(e,e.onImgTwoEaseInEnd))},i.onHide=function(){this.box_ck.visible=this.box_sb.visible=!1},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.box_ck.visible=this.box_sb.visible=!1},i.destroy=function(e){void 0===e&&(e=!0),Y.timer.clearAll(this),Yl.clearAll(this.lineOneText),Yl.clearAll(this.lineTwoBg),Yl.clearAll(this),this.destoryImage(this),laya.ui.View.prototype.destroy.call(this,e)},i.onTextOneEaseInEnd=function(){var e=this;Y.timer.once(1e3,this,hide=function(){e.onTextOneEaseBack()})},i.onTextOneEaseBack=function(){Yl.to(this.lineOneText,{x:.2*(this.width-this.lineOneText.width)-100,y:.2*(this.height-this.lineOneText.height)-50,alpha:0},600,null,ms.create(this,this.onTextOneEaseBackEnd))},i.onTextOneEaseBackEnd=function(){this.lineOneText&&this.lineOneText.parent&&this.lineOneText.parent.removeChild(this.lineOneText)},i.onTextTwoEaseInEnd=function(){var e=this;Y.timer.once(1e3,this,hide=function(){e.lineTwoText&&e.lineTwoText.parent&&e.lineTwoText.parent.removeChild(e.lineTwoText)})},i.onTextTwoEaseBack=function(){},i.onImgOneEaseInEnd=function(){var e=this;Y.timer.once(1e3,this,hide=function(){e.lineOneBg&&e.lineOneBg.parent&&e.lineOneBg.parent.removeChild(e.lineOneBg)})},i.onImgTwoEaseInEnd=function(){var e=this;Y.timer.once(1e3,this,hide=function(){e.lineTwoBg&&e.lineTwoBg.parent&&e.lineTwoBg.parent.removeChild(e.lineTwoBg)})},t}(),nh=function(e){function t(){var e=this;e._ctn=null,e._remainSec=0,e._grids=null,e.list=[],e.moEquitList=[],e.shenyuList=[],e.shenEquitList=[],e.redEquitList=[],e.syFragmentList=[],e.szFragmentList=[],e.redFragmentList=[],e.otherList=[],e.commonList=[],e.syFragmentMap={},e.szFragmentMap={},e.otherMap={},t.__super.call(e)}u(t,"modules.boss.views.scene.Boss_GodSceneSettle",hi);var i=t.prototype;return i.initialize=function(){this.btn_gain.clickHandler=ms.create(this,this.onGain,null,!1),this._grids=new kl(2,4,116,10,30,!0,null,10),this._grids.isCenter=!0,this._grids.pos(3,550),this.addChild(this._grids)},i.onGain=function(){ha.ins.exitCopy(300),On.ins.isOpen("RELIVE_TIPS")&&On.ins.close("RELIVE_TIPS"),On.ins._closePanelForce(this)},i.update=function(e){var t,i=this,s=0,n=0,o=0,a=0,r=0;if(e){if(e&&e.rewards){var l,c=e.rewards;for(var d in c)if(l=c[d],s=Re.MODEL.type(Re.getIndex(l.modelId)),n=Re.MODEL.subType(Re.getIndex(l.modelId)),1==s&&12!=n&&11!=n&&17!=n)(t=i.otherMap[l.modelId])?t.goodsNum+=l.count:(t=an.create(l.modelId,l.count),i.otherMap[l.modelId]=t,i.otherList.push(t));else switch((t=an.create(l.modelId,l.count)).subType){case 16:i.moEquitList.push(t);break;case 3:i.shenyuList.push(t);break;case 15:i.shenEquitList.push(t);break;case 9:i.redEquitList.push(t);break;case 17:i.szFragmentList.push(t);break;case 12:(o=i.syFragmentMap[l.modelId])?t.goodsNum+=l.count:(o=l.modelId,i.syFragmentMap[l.modelId]=o,i.syFragmentList.push(t));break;case 11:if(a=i.szFragmentMap[l.modelId])for(r=0;r<i.redFragmentList.length;r++)i.redFragmentList[r].goodsId==l.modelId&&(i.redFragmentList[r].goodsNum+=l.count);else a=l.modelId,i.szFragmentMap[l.modelId]=a,i.redFragmentList.push(t);break;case 10:i.commonList.push(t);break;default:i.otherList.push(t)}var u=i.moEquitList.concat(i.shenyuList).concat(i.shenEquitList).concat(i.redEquitList).concat(i.syFragmentList).concat(i.szFragmentList).concat(i.redFragmentList).concat(i.otherList).concat(i.commonList);i._grids.gridDatas=u,i._grids.vScrollBar.value=1,i._grids.x=i.width-i._grids.contentW>>1}if(e&&e.playerName)var h=e.playerName==Gi.ins.charName;i.txt_title.text=h?ed.n[1687]:ed.n[1688],e&&e.playerName&&i.txt_name.changeText(e.playerName);var _=Or.getActorHeadPath(e.roleType,e.gender);i.img_head.skin=_,i._remainSec=10,i.timerLoop(1e3,i,i.onTimer),i.onTimer()}},i.onTimer=function(){if(this._remainSec<=0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),gi.ins.show(this),this.update(null)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.list=[],t.moEquitList=[],t.shenyuList=[],t.shenEquitList=[],t.redEquitList=[],t.syFragmentList=[],t.szFragmentList=[],t.redFragmentList=[],t.otherList=[],t.commonList=[],t.otherMap={},t._grids.destroy(e),t._grids=null,ui.SubPanel.prototype.destroy.call(t,e)},t}(),oh=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_GodWeaponFairylandScene",Xt);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.onExitClicked=function(e){ha.ins.changeSceneUI(12,!1)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),laya.ui.View.prototype.destroy.call(this,e)},t.NAME="Boss_GodWeaponFairylandScene",t}(),ah=function(e){function t(){this._count=0,this.MAX_COUNT=1e4,this.TWEEN_MOVE=30,this._goods=null,this.INTERVAL=50,this._curCopyId=0,this._tweener=null,this._isRightArrow=!1,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_MijingAttackView",H);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this._goods=new ra,this.lbl_progress.style.color="#90877b",this.lbl_progress.style.font="SimHei",this.lbl_progress.style.fontSize=24,this.div_max_num.style.color="#90877b",this.div_max_num.style.font="SimHei",this.div_max_num.style.fontSize=20},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),Y.timer.clear(this,this.onCountdown),this.showInfo()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),null!=t._tweener&&t._tweener.clear(),t._tweener=null,t._goods&&(t._goods.removeSelf(),t._goods.bindData=null),Y.timer.clear(t,t.onCountdown),t._curCopyId=0},i.onClick=function(e){switch(e.target){case this.btn_close:On.ins.close("BOSS_MIJING_SCENE");break;case this.btn_random:if(0==this._curCopyId)return;this.random.visible=!1,this.result.visible=!0;var t=Math.floor(100*Math.random())+1;this.clipnum_drop.value=t.toString(),Eu.reqRandomNum(t,this._curCopyId)}},i.showInfo=function(){var e=this;e.progress.visible=!0,e.div_max_num.visible=!1,e.img_progress.scaleX=1,e.txt_name.text=ed.n[1689],e.random.visible=!0,e.result.visible=!1,null!=e._tweener&&e._tweener.clear(),e._tweener=null,e.onShowNextTweener(),e._count=e.MAX_COUNT,Y.timer.loop(e.INTERVAL,e,e.onCountdown);var t=ha.ins.curCopyId;e._curCopyId=t;var i=uo.getIndex(t),s=uo.MODEL.shieldReward(i),n=JSON.parse(s),o=n[0].value.toString();if("goods"==n[0].type){var a=o.split(":");e._goods.bindData=an.create(a[0],a[1]),null==e._goods.parent&&e.award.addChild(e._goods);var r=Re.getIndex(a[0]);e.award_name.changeText(Re.MODEL.name(r)),e.award_name.color=Co.getByQuality(Re.MODEL.colourId(r))}},i.onShowNextTweener=function(){var e=this;e._isRightArrow?e._tweener=Yl.to(e.img_arrow,{x:0},1e3,null,ms.create(e,e.onShowNextTweener)):e._tweener=Yl.to(e.img_arrow,{x:-e.TWEEN_MOVE},1e3,null,ms.create(e,e.onShowNextTweener)),e._isRightArrow=!e._isRightArrow},i.onCountdown=function(){this._count-=this.INTERVAL,this._count<=0&&(this.progress.visible=!1,Y.timer.clear(this,this.onCountdown),Y.timer.once(1e3,this,function(){On.ins.close("BOSS_MIJING_SCENE");var e=ha.ins.data30375;null!=e&&e.playerId.toString()==Gi.ins.charId&&Eu.reqShieldAward(ha.ins.curCopyId)}),this._count=0);var e=this._count/this.MAX_COUNT;this.img_progress.scaleX=e;var t=this._count/1e3;t=1<t?Math.floor(t):t<0?0:Math.floor(10*t)/10,this.lbl_progress.innerHTML=ed.n[1690]+t+"秒"},i.update=function(){var e=ha.ins.data30375;this._curCopyId==e.missionId&&(this.txt_name.changeText(e.playerName),this.div_max_num.visible=!0,this.div_max_num.innerHTML="掷出"+nc.createColor(e.randomNum.toString(),"#23b11f")+"点")},t}(),rh=function(e){function t(){this.MAX_COUNT=6e4,this._count=0,this.INTERVAL=1e3,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_MijingResultView",En);var i=t.prototype;return i.initialize=function(){laya.ui.Component.prototype.initialize.call(this)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=ha.ins.curCopyId,i=uo.getIndex(t),s=uo.MODEL.cate(i);on.reqCopy(s),this.showCountDown()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clear(this,this.onCountdown)},i.showCountDown=function(){this._count=this.MAX_COUNT,Y.timer.loop(this.INTERVAL,this,this.onCountdown),this.onCountdown()},i.onClick=function(e){},i.onCountdown=function(){this._count-=this.INTERVAL,this._count<=0&&(ha.ins.exitCopy(0),On.ins.close("BOSS_MIJING_RESULT_SCENE"),Y.timer.clear(this,this.onCountdown));var e=Math.floor(this._count/1e3);this.txt_countdown.text=V.getTickMS(e)},i.updateBossData=function(){ha.ins.toc24004&&(ha.ins.toc24004.playerName?this.txt_name.text=ha.ins.toc24004.playerName:this.txt_name.text="无归属")},t}(),lh=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_PersonBossScene",_o);var i=t.prototype;return i.initialize=function(){},i.onBtnClick=function(e){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.size(Y.stage.width,Y.stage.height)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},t}(),ch=function(e){function s(){var e=this;e._awards=null,e.startLayer=null,e.SIZE=116,s.__super.call(e),e.centerX=e.centerY=0,e._awards=[];for(var t=0;t<8;t++){var i=new ra;e["icon"+t].addChild(i),e._awards[t]=i}e.div_tips.style.color="#5f5952",e.div_tips.style.font="SimHei",e.div_tips.style.fontSize=24,e.div_tips.style.leading=10,e.div_tips.innerHTML=ed.n[1691]+ed.n[1692]+ed.n[1693]+ed.n[1694],Bi._initContainer(e),e.startLayer=new rn,e.addChild(e.startLayer)}u(s,"modules.boss.views.scene.Boss_sczbAwardView",v);var t=s.prototype;return t.update=function(e){var t=e.id,i=uo.getIndex(t),s=[];s[s.length]=uo.MODEL.propGroupIds(i);for(var n=uo.MODEL.bossShowAward(i).split(";"),o=0;o<3;o++)n.length>o&&(s[s.length]=n[o]);var a=uo.MODEL.actorpropGroupIds(i);for(""!=a&&a&&(s[s.length]=a),n=""!=(a=uo.MODEL.actorbossShowAward(i))&&a?a.split(";"):[],o=0;o<3;o++)n.length>o&&(s[s.length]=n[o]);for(o=0;o<8;o++)if(s.length>o){var r=s[o];this["txt_name_"+o].visible=!0;var l=r.split(","),c=an.create(l[0],l[1]);this._awards[o].visible=!0,this._awards[o].bindData=c;var d=this["txt_name_"+o];if(d.changeText(c.name),i=Re.getIndex(c.goodsId),d.color=Co.getByQuality(Re.MODEL.colourId(i)),!Ot.getIsMoEquit(l[0]))continue}else this._awards[o].visible=!1,this["txt_name_"+o].visible=!1;var u=ha.ins.curCopyId,h=uo.getIndex(u);uo.MODEL.cate(h)},t.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),ha.ins.toc22604&&this.update(ha.ins.toc22604),this.btn_close.on("click",this,this.onClick)},t.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick)},t.onClick=function(e){On.ins.close("BOSS_SCZB_SCENE_AWARD")},t.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),this._awards=null,Y.timer.clearAll(this),this.graphics.clear(),this.startLayer.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t.setMoEquitStar=function(e,t,i){if(Ot.getIsMoEquit(e)){var s=Re.MODEL.magicStarLevel(Re.getIndex(e));if(a||(a=new gl,this.addChild(a)),a.graphics.clear(),!Ot.getIsMoEquitSpecial(e))return a.pos(t+3,i-this.SIZE+3),a.graphics.drawTextures(Ot.starBgTexture,[0,0]),void a.graphics.fillTexture(Ot.starLevelTexture,2,3,26,22,"no-repeat",new is(26*(10-s),0));var n=Math.floor(s/6),o=Math.floor(s%6),a=new gl;a.pos(t+5,i-28),this.startLayer.addChild(a);for(var r=0;r<o;r++)a.graphics.drawTextures(Ot.getStarTexture(n),[Ot.getStartX(o)+44*r,0]);a.scaleX=a.scaleY=.45}},s}(),dh=function(e){function t(){this.Exit_timer=0,this.isSHowCopyEnd=!1,this._$8_name="",t.__super.call(this),this.centerX=0,this.centerY=-300,this.initUI()}u(t,"modules.boss.views.scene.Boss_ShengYuView",Za);var i=t.prototype;return i.onAdd=function(e){if(ui.ViewBase.prototype.onAdd.call(this,e),this.isSHowCopyEnd=!1,0!=ha.ins.curCopyId){var t=uo.getIndex(ha.ins.curCopyId),i=uo.MODEL.bossId(t);xn.ins.setDropBtnStatus(i,!0,ms.create(this,this.onAward,null,!1))}this.showGuiShuInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clear(this,this.onTimer),this.isSHowCopyEnd=!1,this.box_killInfo.visible=!1},i.onResize=function(){ui.ViewBase.prototype.onResize.call(this)},i.onAward=function(){On.ins.open("BOSS_WILD_SCENE_AWARD",{id:ha.ins.curCopyId})},i.showGuiShuInfo=function(){ha.ins.toc24004&&(this._$8_name=ha.ins.toc24004.playerName)},i.showBossDInfo=function(){this.box_killInfo.visible=!0,ha.ins.enterScenceBossInfo=null,this.Exit_timer=30,this.isSHowCopyEnd=!0,this.txt_guishu.innerHTML=ed.n[1695]+this._$8_name,ha.ins.toc24004&&Y.timer.loop(1e3,this,this.onTimer)},i.onTimer=function(){var e=this;if(!ha.ins.toc24004)return Y.timer.clear(e,e.onTimer),void(e.parent&&e.parent.removeChild(e));var t=e.Exit_timer--;if(t<0)return e.event("end"),Y.timer.clear(e,e.onTimer),e.txt_exit.text="",J.dtoEnterScene&&ha.ins.toc24004&&ha.ins.changeSceneUI(J.dtoEnterScene.type,!1),void(e.isSHowCopyEnd=!1);e.txt_exit.text=ed.n[1696]+he.deltaFormat(1e3*t,"hh:mm:ss")},i.onClickGuiShu=function(e){ha.ins.toc24004.playerId.toString()!=Gi.ins.charId&&Bs.fights(ha.ins.toc24004.objectId)},i.initUI=function(){this.box_killInfo.visible=!1},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),laya.ui.View.prototype.destroy.call(this,e)},t}(),uh=function(e){function o(){o.__super.call(this)}u(o,"modules.boss.views.scene.Boss_WildKillView",I);var t=o.prototype;return t.updateData=function(e){if(Ss.Ins().currCid==Je.S_YeZhanBIQI.toString())return this.txt_desc.changeText(""),void(this.txt_name.innerHTML=nc.createColor(ed.n[1697],"#a19880")+"&nbsp;"+e.rivalName);e.attacker?(this.txt_title.changeText(ed.n[1698]),this.txt_name.innerHTML=nc.createColor(ed.n[1697],"#a19880")+"&nbsp;"+e.rivalName,this.txt_desc.changeText(ed.n[1700])):(this.txt_title.changeText(ed.n[1701]),this.txt_name.innerHTML=e.rivalName+"&nbsp;"+nc.createColor(ed.n[1702],"#a19880"),this.txt_desc.changeText(ed.n[1703]))},t.start=function(){Yl.to(this,{scaleX:1,scaleY:1,alpha:1},100);this.fadeHide(100,2100),this.timerOnce(2700,this,this.recover)},t.fadeHide=function(e,t){void 0===t&&(t=0),Yl.to(this,{scaleX:.7,scaleY:.7,alpha:0},e,null,ms.create(this,this.recover),t)},t.recover=function(){Yl.clearAll(this),this.clearTimer(this,this.recover),this.visible=!1;var e=o._views.indexOf(this);o._views.splice(e,1),o._pool.push(this)},o.pushNote=function(e,t){o._queue.push(e),o._scene=t,o._onFrame||(o._onFrame=!0,Y.timer.frameLoop(1,o,o.onPushNoteFrame))},o.hideAll=function(e){void 0===e&&(e=!0);for(var t=o._views.length-1;0<=t;){var i=o._views[t];Yl.clearAll(i),e?i.fadeHide(200):i.recover(),t--}},o.destroyAll=function(){for(var e=0;e<o._views.length;e++){var t=o._views[e];Yl.clearAll(t),t.destroy(!0)}for(e=o._views.length=0;e<o._pool.length;e++)(t=o._pool[e]).destroy(!0);o._pool.length=0},o.onPushNoteFrame=function(){if(!(4<=o._views.length||qe.now()-o._lastCreateTime<375)){o._lastCreateTime=qe.now();var e,t=o._queue.shift();0<o._pool.length?(e=o._pool.pop()).destroyed?e=new o:e.visible=!0:e=new o,e.scaleX=e.scaleY=.7,e.alpha=0,e.y=0,e.updateData(t),o._scene.addChildAt(e,0),e.start(),o._views.push(e);for(var i=o._views.length,s=0;s<i-1;s++){var n=0-(e.height+10)*(i-s-1);Yl.to(o._views[s],{y:n},200)}0==o._queue.length&&(Y.timer.clear(o,o.onPushNoteFrame),o._onFrame=!1)}},o._pool=[],o._queue=[],o._views=[],o._scene=null,o.MAX_VIEW=4,o._onFrame=!1,o._lastCreateTime=0,o}(),hh=function(e){function t(){this.BAR_W=0,this._view_relive=null,this._attack_mask=null,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WildOwnScene",be);var i=t.prototype;return i.initialize=function(){},i.update=function(e){e instanceof protos.scene.toc_22604&&(0==e.charId||this.updateAscriptor(e))},i.showReliveView=function(e){var t=this;null==t._view_relive&&(t._view_relive=new Sr,t._view_relive.centerX=0,t._view_relive.bottom=t._view_kill_ctn.bottom),t._view_relive.parent!=t&&(t._view_relive.fadeShow(t),t._view_relive.dataSource=e)},i.showAttackMask=function(){null==this._attack_mask&&(this._attack_mask=new ce,this.addChild(this._attack_mask)),this._attack_mask.fadeShow()},i.onAscrip=function(){if(2==ha.ins.ascripStatus){if(this._view_relive&&this._view_relive.parent)return void Vl.ins.showMsg(ed.n[1704],1);if(!U.enabled())return void Vl.ins.showMsg(ed.n[1705],1)}else if(0==ha.ins.ascripStatus)return void Vl.ins.showById(2154,1)},i.onExit=function(){ha.ins.copyEnd?this.onExitConfirm(1):ja.ins.showBox(ed.n[1707],ed.n[1708],ms.create(this,this.onExitConfirm),!1,3,null,ed.n[1709],ed.n[1710])},i.onExitConfirm=function(e){1==e&&ha.ins.changeSceneUI(7,!1),this._view_relive&&this._view_relive.parent&&this._view_relive.clearTimerListener()},i.onAward=function(){On.ins.open("BOSS_WILD_SCENE_AWARD",{id:ha.ins.curCopyId})},i.updateAscriptor=function(e){this.setCharhead(e.charJob,e.charSex),0!=e.maxHp&&this.setBloodRate(e.curHp/e.maxHp);e.charId,Gi.ins.charId;this.updateAscripStatus()},i.updateAscriptorHp=function(e){U.isFirstShowBool&&(0!=e.maxHp&&this.setBloodRate(e.curHp/e.maxHp),e.curHp<=0&&e.charId==parseInt(Gi.ins.charId)&&this.showReliveView({name:"BOSS"}))},i.setCharhead=function(e,t){},i.setBloodRate=function(e){e<0?e=0:1<e&&(e=1)},i.updateAscripStatus=function(){var e=ha.ins.ascripStatus;if(-1!=e)0==e?ed.n[1711]:1==e?ed.n[1712]:ed.n[1713]},i.checkSceneShowBool=function(){if(U.isFirstShowBool){this.clearTimer(this,this.checkSceneShowBool);var e=uo.getIndex(ha.ins.curCopyId);xn.ins.updateBossBlood(uo.MODEL.bossId(e),ha.ins.bossBlood),ha.ins.toc22604&&this.updateAscriptorHp(ha.ins.toc22604)}},i.startCheckSceneShowBool=function(){U.isFirstShowBool?this.clearTimer(this,this.checkSceneShowBool):this.frameLoop(1,this,this.checkSceneShowBool)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.size(Y.stage.width,Y.stage.height);var t=ha.ins.curCopyId,i=uo.getIndex(t),s=uo.MODEL.bossId(i);xn.ins.setDropBtnStatus(s,!0,ms.create(this,this.onAward,null,!1)),xn.ins.lockBossId=s,0<ha.ins.bossBlood&&xn.ins.updateBossBlood(s,ha.ins.bossBlood),ha.ins.toc22604&&this.update(ha.ins.toc22604),ha.ins.reliveObj&&(this.showReliveView(ha.ins.reliveObj),ha.ins.reliveObj=null),this.parent.setChildIndex(this,0),this.startCheckSceneShowBool()},i.onRemove=function(e){this._view_relive&&this._view_relive.removeSelf(),uh.hideAll(!1),ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.checkSceneShowBool)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._view_relive&&(t._view_relive.destroy(!0),t._view_relive=null),t._attack_mask&&t._attack_mask.destroy(!0),t._attack_mask=null,uh.destroyAll(),t.destoryImage(t),Y.timer.clearAll(t),t.graphics.clear(),laya.ui.View.prototype.destroy.call(t,e)},t}(),_h=function(e){function t(){this._ctn=null,this._remainSec=0,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WildOwnSceneSettle",hi);var i=t.prototype;return i.initialize=function(){var e=this;e.btn_gain.clickHandler=ms.create(e,e.onGain,null,!1),e._ctn=new ga(4),e._ctn.pos(3,502),e._ctn.size(560,315),e._ctn._spaceX=10,e._ctn._spaceY=47,e._ctn._vScrollBarSkin="",e._ctn._hScrollBarSkin=null,e._ctn._gsimpleName=!0,e.addChild(e._ctn)},i.onGain=function(){On.ins.isOpen("RELIVE_TIPS")&&On.ins.close("RELIVE_TIPS"),On.ins._closePanelForce(this),ha.ins.changeSceneUI(7,!1)},i.update=function(e){var t=this;if(e instanceof protos.scene.toc_22153&&ha.ins.toc22604){var i=e,s=ha.ins.toc22604,n=""+s.charId==Gi.ins.charId,o=s.charName;t.txt_title.text=n?ed.n[1714]:ed.n[1715],t.txt_name.changeText(o);var a=Or.getActorHeadPath(s.charJob,s.charSex);t.img_head.skin=a,t._ctn.setGoodsItems(i.rewards,4),t._ctn.x=(t.width-t._ctn.contentWidth)/2,t._remainSec=9,t.timerLoop(1e3,t,t.onTimer),t.onTimer()}},i.onTimer=function(){if(this._remainSec<0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),gi.ins.show(this),this.update(null)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t}(),ph=function(e){function t(){this.BAR_W=0,this._view_relive=null,this._attack_mask=null,this.copyId=0,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WildScene",be);var i=t.prototype;return i.initialize=function(){},i.update=function(e){e instanceof protos.scene.toc_22604&&this.updateAscriptor(e)},i.showReliveView=function(e){var t=this;null==t._view_relive&&(t._view_relive=new Sr,t._view_relive.centerX=0,t._view_relive.bottom=t._view_kill_ctn.bottom),t._view_relive.parent!=t&&(t._view_relive.fadeShow(t),t._view_relive.dataSource=e)},i.showAttackMask=function(){null==this._attack_mask&&(this._attack_mask=new ce,this.addChild(this._attack_mask)),this._attack_mask.fadeShow()},i.onBtnClick=function(e){},i.setPingbiStatus=function(e){Wc.updatePingbiStatus(!e)},i.onAscrip=function(){if(2==ha.ins.ascripStatus){if(this._view_relive&&this._view_relive.parent)return void Vl.ins.showMsg(ed.n[1704],1);if(!U.enabled())return void Vl.ins.showMsg(ed.n[1705],1)}else if(0==ha.ins.ascripStatus)return void Vl.ins.showById(2154,1)},i.onAward=function(){On.ins.open("BOSS_WILD_SCENE_AWARD",{id:ha.ins.curCopyId})},i.updateAscriptor=function(e){this.setCharhead(e.charJob,e.charSex),0!=e.maxHp&&this.setBloodRate(e.curHp/e.maxHp);e.charId,Gi.ins.charId;this.updateAscripStatus()},i.updateAscriptorHp=function(e){U.isFirstShowBool&&(0!=e.maxHp&&this.setBloodRate(e.curHp/e.maxHp),e.curHp<=0&&e.charId==parseInt(Gi.ins.charId)&&this.showReliveView({name:"BOSS"}))},i.setCharhead=function(e,t){},i.setBloodRate=function(e){e<0?e=0:1<e&&(e=1)},i.updateAscripStatus=function(){var e=ha.ins.ascripStatus;if(-1!=e)0==e?ed.n[1711]:1==e?ed.n[1712]:ed.n[1713]},i.checkSceneShowBool=function(){if(U.isFirstShowBool){this.clearTimer(this,this.checkSceneShowBool);var e=uo.getIndex(ha.ins.curCopyId);xn.ins.updateBossBlood(uo.MODEL.bossId(e),ha.ins.bossBlood),ha.ins.toc22604&&this.updateAscriptorHp(ha.ins.toc22604)}},i.startCheckSceneShowBool=function(){U.isFirstShowBool?this.clearTimer(this,this.checkSceneShowBool):this.frameLoop(1,this,this.checkSceneShowBool);var e=uo.getIndex(this.copyId),t=uo.MODEL.cate(e);0<ha.ins.autoBossId&&ha.ins.autoBossId==ha.ins.curCopyId&&(3==t&&ha.ins.wildIsAuto||13==t&&ha.ins.godIsAuto)&&(ha.ins.enterScenceBossInfo||Y.timer.once(1e4,this,this.exitCopy)),ha.ins.autoBossId=-1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.size(Y.stage.width,Y.stage.height),t.copyId=ha.ins.curCopyId;var i=uo.getIndex(t.copyId),s=uo.MODEL.bossId(i);53==uo.MODEL.cate(uo.getIndex(ha.ins.curCopyId))&&(s=L.ins.curBossId),xn.ins.setDropBtnStatus(s,!0,ms.create(t,t.onAward,null,!1)),xn.ins.lockBossId=s,0<ha.ins.bossBlood&&xn.ins.updateBossBlood(s,ha.ins.bossBlood),ha.ins.toc22604&&t.update(ha.ins.toc22604),ha.ins.reliveObj&&(t.showReliveView(ha.ins.reliveObj),ha.ins.reliveObj=null),t.parent.setChildIndex(t,0),t.startCheckSceneShowBool(),t.setPingbiStatus(!0)},i.onRemove=function(e){this._view_relive&&this._view_relive.removeSelf(),uh.hideAll(!1),ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clear(this,this.exitCopy),this.clearTimer(this,this.checkSceneShowBool),this.setPingbiStatus(!0)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t._view_relive&&(t._view_relive.destroy(!0),t._view_relive=null),t._attack_mask&&t._attack_mask.destroy(!0),t._attack_mask=null,uh.destroyAll(),t.destoryImage(t),Y.timer.clearAll(t),t.graphics.clear(),laya.ui.View.prototype.destroy.call(t,e)},i.exitCopy=function(){var e,t=0,i=Os.charQueue;for(var s in i.proto)if((e=i.proto[s])&&e.type==mc.MONSTER&&e.isBoss){t=1;break}ha.ins.enterScenceBossInfo||0!=t?Y.timer.clear(this,this.exitCopy):ha.ins.exitCopy(300)},t}(),fh=function(e){function t(){this._awards=null,this.flyupBossArr=[47022,47001,47002,47003,47004,47005,47006,47007,47008,47009,47010,47011,47012,47013,47014,47015,47016,47017,47018,47019,47020,47021],t.__super.call(this),this.div_tips.innerHTML=ed.n[1721]+ed.n[1722]+ed.n[1723],Bi._initContainer(this)}u(t,"modules.boss.views.scene.Boss_WildSceneAwardView",Hn);var i=t.prototype;return i.onBtnClick=function(){U.enabled()||Vl.ins.showMsg("请稍候",1)},i.update=function(e){var t=this;ha.ins.toc24004;try{t.box_canyuawards.visible=!1;var i=e.id,s=uo.getIndex(i),n=uo.MODEL.cate(s);t.div_tips.innerHTML=41==n||42==n?ed.n[1724]+ed.n[1725]+ed.n[1726]:46==n?ed.n[1727]+ed.n[1728]+ed.n[1729]:ed.n[1721]+ed.n[1722]+ed.n[1723];var o=[],a=(uo.MODEL.key(s),uo.MODEL.cate(s)),r=0;r=47!=a&&48!=a?(o[o.length]=uo.MODEL.propGroupIds(s),3):4;for(var l,c=uo.MODEL.bossShowAward(s).split(";"),d=0;d<r;d++)c.length>d&&(o[o.length]=c[d]);for(47!=a&&48!=a&&""!=(l=uo.MODEL.actorpropGroupIds(s))&&l&&(o[o.length]=l),c=""!=(l=uo.MODEL.actorbossShowAward(s))&&l?l.split(";"):[],d=0;d<r;d++)c.length>d&&(o[o.length]=c[d]);for(t.txt_no.visible=o.length<=4,t.bidiao2.visible=!t.txt_no.visible,d=0;d<8;d++)if(o.length>d){var u=o[d];t.box_canyuawards.visible=!0,t["txt_name_"+d].visible=!0;var h=u.split(","),_=an.create(h[0],h[1]);t._awards[d].visible=!0,t._awards[d].bindData=_;var p=t["txt_name_"+d];p.changeText(_.simpleName),s=Re.getIndex(_.goodsId),p.color=Co.getByQuality(Re.MODEL.colourId(s))}else t._awards[d].visible=!1,t["txt_name_"+d].visible=!1,t.box_canyuawards.visible=!1;var f=ha.ins.curCopyId,g=uo.getIndex(f),v=uo.MODEL.cate(g);15==v?(t.gao.visible=!0,t.five.visible=!1,t.bidiao1.visible=!1,t.bidiao2.visible=!1,t.di1.visible=!0):47==v||48==v?(t.bidiao1.visible=!1,t.bidiao2.visible=!1,t.gao.visible=!1,t.five.visible=!0,t.di1.visible=!1):(t.gao.visible=!1,t.five.visible=!0,t.di1.visible=!1,t.bidiao1.visible=!0)}catch(e){console.log("WilsonTrace:"+e.message)}},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this._awards=[];for(var t=0;t<8;t++){var i=new ra;this["icon"+t].addChild(i),this._awards[t]=i}ha.ins.toc22604&&this.update(ha.ins.toc22604),this.btn_close.on("click",this,this.onClick)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this._awards.length=0,this.btn_close.off("click",this,this.onClick)},i.onClick=function(e){On.ins.close("BOSS_WILD_SCENE_AWARD")},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t}(),gh=function(e){function t(){this._ctn=null,this._remainSec=0,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WildSceneSettle",hi);var i=t.prototype;return i.initialize=function(){},i.onGain=function(){On.ins.isOpen("RELIVE_TIPS")&&On.ins.close("RELIVE_TIPS"),On.ins._closePanelForce(this),ha.ins.changeSceneUI(3,!1)},i.update=function(e){var t=this;if(e instanceof protos.scene.toc_22613&&ha.ins.toc22604){var i=e,s=ha.ins.toc22604,n=""+s.charId==Gi.ins.charId,o=s.charName;t.txt_title.text=n?ed.n[1714]:ed.n[1715],t.txt_name.changeText(o);var a=Or.getActorHeadPath(s.charJob,s.charSex);t.img_head.skin=a,t._ctn.setGoodsItems(i.rewards,4),t._ctn.x=(t.width-t._ctn.contentWidth)/2,t._remainSec=9,t.timerLoop(1e3,t,t.onTimer),t.onTimer()}},i.onTimer=function(){if(this._remainSec<0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_gain.clickHandler=ms.create(t,t.onGain,null,!1),t._ctn=new ga(4),t._ctn.pos(3,502),t._ctn.size(560,335),t._ctn._spaceX=10,t._ctn._spaceY=47,t._ctn._vScrollBarSkin="",t._ctn._hScrollBarSkin=null,t._ctn._gsimpleName=!0,t.addChild(t._ctn),gi.ins.show(t),t.update(null)},i.onRemove=function(e){this.btn_gain.clickHandler=null,this._ctn&&this._ctn.removeSelf(),this._ctn=null,ui.SubPanel.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t}(),vh=function(e){function t(){this._cRemain=0,this._cEndTime=NaN,this._bossId=0,this._bossMaxHp=0,t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WorldBossScene",Ro);var i=t.prototype;return i.initialize=function(){this.btn_pingbi.visible=this.btn_unpingbi.visible=!1,this.list.vScrollBarSkin="",this.list.renderHandler=ms.create(this,this.onCellRender,null,!1)},i.onCellRender=function(e,t){var i=this.list.array[t];if(e.graphics.clear(),t%2==0){var s=Y.loader.getRes(Or.getAtlasSubPath("boss_scene/WorldBOSS_img_bg2.png"));e.graphics.drawTexture(s,0,0,e.width,e.height)}e.txt_name.changeText(i.rank+"、"+i.name),e.txt_damage.changeText(ur.getBigIntStr(i.damage))},i.onBtnClick=function(e){e==this.btn_pingbi?this.setPingbiStatus(!1):e==this.btn_unpingbi?this.setPingbiStatus(!0):e==this.btn_zhuwei&&On.ins.open("BOSS_WORLDBOSS_ZHUWEI")},i.setPingbiStatus=function(e){this.btn_pingbi.visible=e,this.btn_unpingbi.visible=!e,Wc.updatePingbiStatus(!e)},i.update=function(e){},i.updateRank=function(){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=void 0,this.txt_myguilddamage.text=ur.getBigIntStr(0)},i.updateBossBlood=function(e){xn.ins.updateBossBlood(this._bossId,e)},i.onTimer=function(){var e=this;if(-1==e._cRemain){var t=(e._cEndTime-J.curServerTime)/1e3>>0;if(t<0)return t=0,e.box_remain.visible=!1,void e.clearTimer(e,e.onTimer);t<=30&&(e._cRemain=t,e.box_remain.visible=!0)}if(-1!=e._cRemain){var i=""+e._cRemain;1==i.length?(e.num_1.visible=!1,e.num_0.index=e._cRemain,e.img_f_end.x=e.num_0.x+37):(e.num_1.visible=!0,e.num_0.index=parseInt(i.charAt(0)),e.num_1.index=parseInt(i.charAt(1)),e.img_f_end.x=e.num_1.x+37),e._cRemain--}},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.size(Y.stage.width,Y.stage.height),t.btn_pingbi.on("click",t,t.onBtnClick,[t.btn_pingbi]),t.btn_unpingbi.on("click",t,t.onBtnClick,[t.btn_unpingbi]),t.btn_zhuwei.on("click",t,t.onBtnClick,[t.btn_zhuwei]);var i=ha.ins.curCopyId,s=uo.getIndex(i);t._bossId=uo.MODEL.bossId(s);var n=dn.takeMonsterModelProtoData(t._bossId);t._bossMaxHp=n.hp,t._cEndTime=ha.ins.getWorldBossEndTime(i),t._cRemain=-1,t.box_remain.visible=!1,xn.ins.lockBossId=t._bossId,-1!=ha.ins.bossBlood&&xn.ins.updateBossBlood(t._bossId,ha.ins.bossBlood),t.updateRank(),t.timerLoop(1e3,t,t.onTimer),t.parent.setChildIndex(t,0),t.setPingbiStatus(!0)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_pingbi.off("click",t,t.onBtnClick,[t.btn_pingbi]),t.btn_unpingbi.off("click",t,t.onBtnClick,[t.btn_unpingbi]),t.btn_zhuwei.off("click",t,t.onBtnClick,[t.btn_zhuwei]),t.clearTimer(t,t.onTimer),xn.ins.updateBossBlood(0),t.setPingbiStatus(!0)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),laya.ui.View.prototype.destroy.call(this,e)},t}(),mh=function(e){function t(){t.__super.call(this)}u(t,"modules.boss.views.scene.Boss_WorldSceneJieSuanView",ze);var i=t.prototype;return i.initialize=function(){this.txt_desc.text=ed.n[1735],this.btn_exit.clickHandler=ms.create(this,this.onBtnClick,null,!1)},i.onBtnClick=function(){On.ins._closePanelForce(this),ha.ins.changeSceneUI(4,!1)},i.update=function(e){},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),gi.ins.show(this)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t}(),bh=function(e){function t(){var e=this;e.wbData=null,e.wb_list=[],e.currentMissData=null,e.awardsList=[],e.currentSelectedItem=null,e._avatar=null,t.__super.call(e),e.centerX=0,e.centerY=0,e.wbData=Lu.instance}u(t,"modules.boss.views.worldboss.Boss_WorldBossEnterView",Fo);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;t.setTitle(Or.getAtlasSubPath("boss/mwmj_title_tmrq.png")),t.layout.dragon_border.visible=!1,t.txt_rank.on("click",t,t.onClickRankEvent),t.btn_enter.on("click",t,t.onClickEnterEvent),Qr.ins.addListener("BTN_NEW_WORLD_BOSS",[243],ms.create(t,t.redPtHandler,null,!1)),ui.SubPanel.prototype.onAdd.call(t,e)},i.onRemove=function(e){var t=this;for(Qr.ins.removeListener("BTN_NEW_WORLD_BOSS"),t.txt_rank.off("click",t,t.onClickRankEvent),t.btn_enter.off("click",t,t.onClickEnterEvent);t.awardsList&&0<t.awardsList.length;){t.awardsList.shift().removeSelf()}t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.wbData.missId=0,ui.SubPanel.prototype.onRemove.call(t,e)},i.showBaseInfo=function(){var e,t=this,i=0;if(0==t.wbData.toc2152.hurtList.length)for(i=0;i<3;i++)t["txt_rank_"+i].text=ed.n[1738],t["txt_score_"+i].text="0";else for(i=0;i<t.wbData.toc2152.hurtList.length;i++)if(i<3){t["txt_rank_"+i].text=t.wbData.toc2152.hurtList[i].guildName;var s="";s=1e8<=t.wbData.toc2152.hurtList[i].hurt?(t.wbData.toc2152.hurtList[i].hurt/1e8).toFixed(2)+"亿":1e4<=t.wbData.toc2152.hurtList[i].hurt?Math.floor(t.wbData.toc2152.hurtList[i].hurt/1e4)+"万":t.wbData.toc2152.hurtList[i].hurt+"",t["txt_score_"+i].text=s}var n=0;for(i=0;i<t.wbData.toc2152.bossList.length;i++)t.wb_list.length>i?e=t.wb_list[i]:(e=new wh,t.wb_list.push(e)),null==e.parent&&t.addChild(e),e.pos(72,114*i+387),e.data=t.wbData.toc2152.bossList[i],e.on("click",t,t.onClickBossItemEvent),0!=t.wbData.missId?t.wbData.toc2152.bossList[i].missId==t.wbData.missId&&(n=i):1==t.wbData.toc2152.bossList[i].state&&(n=i);t.setDefaultItem(t.wb_list[n].missData.missId),t.currentSelectedItem=t.wb_list[n],t.currentSelectedItem.setSelected(!0),t.currentMissData=t.wb_list[n].missData,t.wbData.missId=0},i.setDefaultItem=function(e){for(var t,i=this,s=uo.getIndex(e),n=uo.MODEL.bossShowAward(s).split(";"),o=0;o<n.length;o++){var a=n[o],r=parseInt(a.split(",")[0]),l=parseInt(a.split(",")[1]);i.awardsList.length>o?t=i.awardsList[o]:(t=new ra,i.awardsList.push(t)),null==t.parent&&i.box_c.addChild(t),t.pos(i["img_"+o].x,i["img_"+o].y),t.bindData=an.create(r,l),i["txt_tool_"+o].text=Re.MODEL.name(Re.getIndex(r)),i["txt_tool_"+o].color=Co.getByQuality(Re.MODEL.colourId(Re.getIndex(r)))}if(i.awardsList.length>o)for(;o<i.awardsList.length;o++)(t=i.awardsList[o])&&t.parent&&t.removeSelf();var c=uo.MODEL.bossId(s);s=Xl.getIndex(c),i.txt_name.text=Xl.MODEL.name(s)+"︵",i.txt_lv.innerHTML=Xl.MODEL.level(s)+"",i.txt_ji.text="级︶",i.setAvatar(s)},i.onClickBossItemEvent=function(e){e.target instanceof modules.boss.views.worldboss.Boss_WorldBossItem&&(this.currentSelectedItem.setSelected(!1),this.setDefaultItem(e.target.missData.missId),this.currentSelectedItem=e.target,this.currentSelectedItem.setSelected(!0),this.currentMissData=e.target.missData)},i.onClickRankEvent=function(e){Fl.sendToModule("OPEN_WB_HURT_RANK_PANEL",["modules.boss.BossModule"])},i.onClickEnterEvent=function(e){if(null!=this.currentMissData){var t=0;if(this.currentMissData){t=uo.getIndex(this.currentMissData.missId);var i=uo.MODEL.levelLimit(t);if(i>Gi.ins.lv)return void Vl.ins.showMsg(ed.n[1739]+i+ed.n[1740],1);if((i=uo.MODEL.zsLevelLimit(t))>Gi.ins.zsLv)return void Vl.ins.showMsg(ed.n[1741]+i+ed.n[1742],1)}if(""==Gi.ins.guildName||null==Gi.ins.guildName)return Vl.ins.showById(4264,1),void On.ins.open("GUILD_LIST_VIEW");this.currentMissData&&1!=this.currentMissData.state?Vl.ins.showMsg(ed.n[1743],1):ri.ins.hasEmptyNum(20)?Wc.isEnabledChangeScene()?(on.reqEntry(this.currentMissData.missId),On.ins._closePanelForce(this)):Vl.ins.showById(2126,1):ja.ins.showBagRecycle()}},i.setAvatar=function(e){var t=this,i=Xl.MODEL.muId(e);e=Cs.getIndex(i);var s=Cs.MODEL.avatarId(e);t._avatar||(t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(510,620),t.box_c.addChildAt(t._avatar,3)),t._avatar.mid=s,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",s,!0),t._avatar.setDir(4),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1.2,1.2)},i.redPtHandler=function(e,t){1==(this.btn_enter.showTip=t)&&this.wbData.reqWB_BaseDataInfo()},t}(),wh=function(e){function t(){var e=this;e.missData={},t.__super.call(e),e.html_relive.style.font="SimHei",e.html_relive.style.fontSize=20,e.txt_tz.mouseEnabled=e.txt_lv.mouseEnabled=e.html_relive.mouseEnabled=e.txt_name.mouseEnabled=!1,e.txt_tz.mouseThrough=e.txt_lv.mouseThrough=e.html_relive.mouseThrough=e.txt_name.mouseThrough=!1}u(t,"modules.boss.views.worldboss.Boss_WorldBossItem",Ec);var i=t.prototype;return i.setSelected=function(e){void 0===e&&(e=!1),this.img_jt.visible=this.img_selected.visible=e},n(0,i,"data",null,function(e){var t=this;if(null!=e){t.missData=e;var i=uo.getIndex(e.missId),s=uo.MODEL.bossId(i);i=Xl.getIndex(s),t.txt_name.text=Xl.MODEL.name(i),t.txt_lv.text="（"+Xl.MODEL.level(i)+"级）",t.html_relive.innerHTML="",t.img_killed.visible=!1,t.txt_tz.visible=!1;var n=uo.MODEL.openTime(uo.getIndex(e.missId));n=n.replace('"',"").replace('"',""),0==e.state?t.html_relive.innerHTML=ed.n[1744]+n+"</font>":1==e.state?(t.txt_tz.visible=!0,t.html_relive.innerHTML=""):(t.img_killed.visible=!0,t.html_relive.innerHTML=ed.n[1744]+n+"</font>"),t.setSelected(!1)}}),t}(),yh=function(e){function t(){this.totalTime=0,this.wbData=null,t.__super.call(this),this.list_hurt.width=350,this.list_hurt.vScrollBarSkin="",this.list_hurt.scrollBar.elasticDistance=200,this.list_hurt.itemRender=Ih,this.list_hurt.dataSource=[],this.wbData=Lu.instance}u(t,"modules.boss.views.worldboss.Boss_WorldBossMainView",Ca);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e);var i=Ss.getHero(4);i&&ac.scene.removeItem(i),t.txt_rank.text="未上榜",t.txt_hurt.align="center",t.txt_zhaoji.align="center",t.txt_zhaoji.on("click",t,t.onClickYaoQingEvent),t.btn_zhuwei.on("click",t,t.onClickZhuWeiEvent),t.txt_num.text="1",t.txt_guildHurt.text=ed.n[1746],Bs.startInstantFight()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clearAll(this),this.txt_zhaoji.off("click",this,this.onClickYaoQingEvent),this.btn_zhuwei.off("click",this,this.onClickZhuWeiEvent)},i.showGuildCurrentPerson=function(e){this.txt_num.text=e.toString()},i.showZhuWeiHurt=function(e){this.txt_guildHurt.text=ed.n[1747]+10*e+"%"},i.showGuildCurrentHurt=function(e){this.txt_noHurt.visible=e.length<=0;var t=0;if(""!=Gi.ins.guildName||null!=Gi.ins.guildName)for(t=0;t<e.length;t++)if(e[t].guildName==Gi.ins.guildName){this.txt_rank.text="第"+e[t].rank+"名",1e8<e[t].hurt?this.txt_hurt.text=(e[t].hurt/1e8).toFixed(2)+"亿":1e4<e[t].hurt?this.txt_hurt.text=Math.floor(e[t].hurt/1e4)+"万":this.txt_hurt.text=e[t].hurt+"";break}this.list_hurt.dataSource=e},i.onClickZhuWeiEvent=function(e){Fl.sendToModule("OPEN_WB_ZW_PANEL",["modules.boss.BossModule"])},i.onClickYaoQingEvent=function(e){this.totalTime<=0?(this.totalTime=30,this.txt_zhaoji.text=ed.n[1748]+this.totalTime+"s)",this.txt_zhaoji.color="#ff2e24",Y.timer.loop(1e3,this,this.onCDYaoQing),this.wbData.reqWB_YQ(J.dtoEnterScene.copyId),Vl.ins.playRainbowByWords(ed.n[1749])):Vl.ins.showMsg(ed.n[1750]+this.totalTime+ed.n[1751],1)},i.onCDYaoQing=function(){this.totalTime--,this.txt_zhaoji.text=ed.n[1752]+this.totalTime+"s)",this.txt_zhaoji.color="#ff2e24",this.totalTime<=0&&(this.txt_zhaoji.text=ed.n[1753],this.txt_zhaoji.color="#23B11f",Y.timer.clear(this,this.onCDYaoQing))},t}(),xh=function(e){function t(){this.vo={},t.__super.call(this)}u(t,"modules.boss.views.worldboss.Boss_WorldBossRankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_rank.visible=this.img_bg.visible=!1},i.getColor=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386";default:return"#90877b"}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.vo=e,t.vo&&(t.txt_rank.text=t.vo.rank+"",t.txt_name.text=t.vo.guildName+"",t.txt_hurt.text=t.vo.hurt+"",3<t.vo.rank?(t.img_rank.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(t.vo.rank+""),t.img_bg.visible=!1):(t.img_rank.visible=!0,t.txt_rank.visible=!1,t.img_bg.visible=!0,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+t.vo.rank+".png"),t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no"+t.vo.rank+".png")),t.txt_name.color=t.getColor(t.vo.rank),t.txt_hurt.color=t.getColor(t.vo.rank))}),t}(Vi),Ih=function(e){function t(){this.vo={},t.__super.call(this)}u(t,"modules.boss.views.worldboss.Boss_WorldBossRankItem2",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_rank.visible=this.img_bg.visible=!1},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.vo=e,t.vo&&(t.txt_rank.text=t.vo.rank+"",t.txt_name.text=t.vo.guildName+"",1e8<=t.vo.hurt?t.txt_hurt.text=(t.vo.hurt/1e8).toFixed(2)+"亿":1e5<=t.vo.hurt?t.txt_hurt.text=Math.floor(t.vo.hurt/1e4)+"万":t.txt_hurt.text=t.vo.hurt+"",3<t.vo.rank?(t.img_bg.visible=!1,t.img_rank.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(t.vo.rank+""),t.img_bg.visible=!1):(t.img_bg.visible=!0,t.img_rank.visible=!0,t.txt_rank.visible=!1,t.img_bg.visible=!0,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+t.vo.rank+".png"),1==t.vo.rank?t.img_bg.alpha=1:2==t.vo.rank?t.img_bg.alpha=.7:3==t.vo.rank&&(t.img_bg.alpha=.4)))}),t}(pi),Sh=function(e){function t(){this.bossData=null,t.__super.call(this),this.centerX=this.centerY=0,this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticDistance=200,this.list_rank.itemRender=xh,this.list_rank.dataSource=[],this.bossData=Lu.instance}u(t,"modules.boss.views.worldboss.Boss_WorldBossRankView",bl);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.list_rank.dataSource=this.bossData.toc2152.hurtList,this.txt_rank.text="0",this.txt_hurtValue.text="0",this.showMyGuildRank()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent)},i.onClickCloseEvent=function(e){On.ins.close("WB_HURT_RANK_PANEL")},i.showMyGuildRank=function(){var e=0;for(e=0;e<this.bossData.toc2152.hurtList.length;e++)if(Gi.ins.guildName==this.bossData.toc2152.hurtList[e].guildName){this.txt_rank.text=e+1+"",this.txt_hurtValue.text=this.bossData.toc2152.hurtList[e].hurt;break}},t}(),kh=function(e){function t(){var e=this;e.Exit_timer=10,e._grids=null,e.wbData=null,t.__super.call(e),e.centerX=e.centerY=0,e.wbData=Lu.instance,e.html_desc.style.font="SimHei",e.html_desc.style.fontSize=24,e.html_desc.style.color="#90877b",e.html_desc.style.leading=30,e._grids=new kl(2,4),e._grids.isCenter=!0,e._grids.pos(112,580),e.addChildAt(e._grids,2)}u(t,"modules.boss.views.worldboss.Boss_WorldBossResult",Ts);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_ok.on("click",this,this.onClickExitEvent)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_ok.off("click",this,this.onClickExitEvent)},i.showResultInfo=function(e){var t=this,i=0;null==t.wbData&&(t.wbData=Lu.instance),t.fc_num.value=e.maxPlayer+"";var s=0;for(s=0;s<t.wbData.copyHurtList.length;s++)if(t.wbData.copyHurtList[s].guildName==Gi.ins.guildName){t.fc_rank.value=s+1+"",i=s+1;break}if(e.maxPlayer<2)t._grids.visible=!1,t.html_desc.visible=!0,t.html_desc.innerHTML=ed.n[1754];else if(3<i)t._grids.visible=!1,t.html_desc.visible=!0,t.html_desc.innerHTML=ed.n[1755];else if(t.html_desc.visible=!1,t._grids.visible=!0,i<=3){var n=[];for(s=0;s<e.awardsList.length;s++)for(var o=e.awardsList[s].num,a=0;a<o;a++){var r=lt.MODEL.goodsId(lt.getIndex(e.awardsList[s].id)),l=lt.MODEL.count(lt.getIndex(e.awardsList[s].id));n.push(an.create(r,l))}t._grids.gridDatas=n}Y.timer.loop(1e3,t,t.onTimer)},i.onTimer=function(){var e=this.Exit_timer--;if(e<0)return this.event("end"),Y.timer.clear(this,this.onTimer),this.txt_time.text="",ha.ins.changeSceneUI(45,!1),this.wbData.copyHurtList=[],void On.ins._closePanelForce(this);this.txt_time.text="("+e+"S)"},i.onClickExitEvent=function(e){ha.ins.changeSceneUI(45,!1),this.wbData.copyHurtList=[],On.ins._closePanelForce(this),this.event("end"),Y.timer.clear(this,this.onTimer)},t}(),Ch=function(e){function t(){this.missid=0,t.__super.call(this),this.centerX=this.centerY=0,this.html_desc.style.font="SimHei",this.html_desc.style.fontSize=24,this.html_desc.style.color="#e0d6c1"}u(t,"modules.boss.views.worldboss.Boss_WorldBossYaoQingView",Ne);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.btn_enter.on("click",this,this.onClickCloseEvent)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent),this.btn_enter.off("click",this,this.onClickCloseEvent)},i.onClickCloseEvent=function(e){e.target==this.btn_enter?Fl.sendToModule("OPEN_WB_ENTER_PANEL",["modules.boss.BossModule"],this.missid):Lu.instance.missId=0,On.ins.close("WB_YQ_PANEL")},i.showInfo=function(e){this.missid=e.missId,this.html_desc.innerHTML=ed.n[1756]+e.playerName+ed.n[1757]},t}(),Th=function(e){function t(){var e=this;e.awardsGrid=null,e.wbData=null,e.goodsStr=null,e.guildNums=0,t.__super.call(e),e.centerX=e.centerY=0,e.html_desc.style.font="SimHei",e.html_desc.style.fontSize=24,e.html_desc.style.color="#90877b",e.wbData=Lu.instance}u(t,"modules.boss.views.worldboss.Boss_WorldBossZhuWeiView",wc);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.btn_enter.on("click",this,this.onClickCloseEvent),this.html_desc.innerHTML=ed.n[1758]+nc.createColor(ed.n[1759],"#23b11f")+"上限"+nc.createColor("300%","#23b11f")},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent),this.btn_enter.off("click",this,this.onClickCloseEvent)},i.refreshGuildZWNum=function(e){this.txt_hurt.text=10*e+"%",this.guildNums=e},i.refreshNum=function(e){var t=this;if(1==e.result){t.wbData.zwNums+=1,5<=t.wbData.zwNums?t.txt_zwNum.color="#ff2e24":t.txt_zwNum.color="#23d11f",t.txt_zwNum.text="("+t.wbData.zwNums+"/5)",Vl.ins.playGetGoodsByPos(t.goodsStr);var i=0;i=t.wbData.zwNums+1<=5?t.wbData.zwNums+1:5,t.showZhuWeiAwards(i)}else 30<=t.guildNums?Vl.ins.showMsg(ed.n[1760],1):Vl.ins.showMsg(ed.n[1761],1)},i.showCurrentZhuWei=function(e){var t=this;t.wbData.zwNums=e.selfNum,t.guildNums=e.guildNum,t.txt_hurt.text=10*e.guildNum+"%",5<=t.wbData.zwNums?t.txt_zwNum.color="#ff2e24":t.txt_zwNum.color="#23d11f",t.txt_zwNum.text="("+t.wbData.zwNums+"/5)",null==t.awardsGrid&&(t.awardsGrid=new ra(74)),null==t.awardsGrid.parent&&t.addChild(t.awardsGrid),t.awardsGrid.pos(t.img_tools.x,t.img_tools.y);var i=0;i=e.selfNum+1<=5?e.selfNum+1:5,t.showZhuWeiAwards(i)},i.showZhuWeiAwards=function(e){var t=hs.getIndex(e);this.txt_cost.text=hs.MODEL.costGold(t)+"";var i=hs.MODEL.rewards(t),s=JSON.parse(i),n=parseInt(s[0].value.split(":")[0]),o=parseInt(s[0].value.split(":")[1]);this.awardsGrid.bindData=an.create(n,o),this.goodsStr=n+","+o+";"},i.onClickCloseEvent=function(e){e.target==this.btn_close?On.ins.close("WB_ZW_PANEL"):e.target==this.btn_enter&&(5<=this.wbData.zwNums?Vl.ins.showMsg(ed.n[1762],1):30<=this.guildNums?Vl.ins.showMsg(ed.n[1763],1):parseInt(this.txt_cost.text)>Gi.ins.YB?ja.ins.showNoGold():Lu.instance.reqWB_ZW())},t}(),Eh=function(){function e(){var e=this;e.petdata=null,e.petShopdata=null,e.curSelectIndex=-1,e.tsNoTips=!1,e.xiLianNoTips=!1,e.rongHeNoTips=!1,e.isUseEgg=0,e.isBrithPet=0,e.petSkill=null,e.petQuiltyArr=[],e.fightFly=NaN,e.petFightTime=NaN,e.btnPetShow=0,e._maxGrip=-1,e._posToLvMap=null,e._petBirthTime=0,e._petWelShowLv=0,e._petEggVo=null,e._petWelInfo=null,e._petOpenTime=0,e._isOpenTip=!1,e._petLeftTime=0,e.skillpetIndex=0,e._popLeftTime=-5}u(e,"modules.pet.others.PetDataModel");var t=e.prototype;return t.getOpenGrip=function(){var e=0;if(0<Is.count)for(var t=0;t<Is.count;t++)Gi.ins.zsLv>=Is.MODEL.key(t)&&(e=Is.MODEL.gridNum(t));return e},t.getMaxGrip=function(){if(!this._posToLvMap){this._posToLvMap=new Kt,this._maxGrip=0;for(var e=Is.count,t={},i=[],s=0,n=99,o=0;o<e;o++)s=Is.MODEL.gridNum(o),this._maxGrip<s&&(this._maxGrip=s),i.indexOf(s)<0&&i.push(s),(!(n=t[s])||o<n)&&(t[s]=o);for(i.sort(),o=0;o<this._maxGrip;o++)for(var a=0;a<i.length;a++)o<i[a]&&this._posToLvMap.put(o,t[i[a]])}return this._maxGrip},t.getLabelByPZ=function(e){var t="";switch(e){case 1:t="普通";break;case 2:t="稀有";break;case 3:t="卓越";break;case 4:t="史诗";break;case 5:t="传说"}return t},t.getHSkinByPZ=function(e){var t=Ta.MODEL.value(Ta.getIndex(325));t&&this.petQuiltyArr.length<=0&&(this.petQuiltyArr=t.split(";"));var i=1;if(this.petQuiltyArr.length>=e){var s=this.petQuiltyArr[e-1];i=parseInt(s.split(",")[1])}var n="";switch(i){case 1:n="cw_jb_pt";break;case 2:n="cw_jb_xy";break;case 3:n="cw_jb_zy";break;case 4:n="cw_jb_ss";break;case 5:n="cw_jb_zz";break;case 6:n="cw_jb_zc";break;case 7:n="cw_jb_cs"}return Or.getFullUrl("ui/layouts/pet/"+n+".png",!1)},t.getSkinByPZ=function(e){var t=Ta.MODEL.value(Ta.getIndex(325));t&&this.petQuiltyArr.length<=0&&(this.petQuiltyArr=t.split(";"));var i=1;if(this.petQuiltyArr.length>=e){var s=this.petQuiltyArr[e-1];i=parseInt(s.split(",")[1])}var n="";switch(i){case 1:n="cw_text_pt";break;case 2:n="cw_text_xy";break;case 3:n="cw_text_zy";break;case 4:n="cw_text_ss";break;case 5:n="cw_text_zz";break;case 6:n="cw_text_zc";break;case 7:n="cw_text_cs"}return Or.getFullUrl("ui/images/pet/"+n+".png")},t.getColorSkinByPZ=function(e){var t=Ta.MODEL.value(Ta.getIndex(325));t&&this.petQuiltyArr.length<=0&&(this.petQuiltyArr=t.split(";"));var i=1;if(this.petQuiltyArr.length>=e){var s=this.petQuiltyArr[e-1];i=parseInt(s.split(",")[0])}var n="";switch(i){case 1:n="cw_jb_l";break;case 2:n="cw_jb_z";break;case 3:n="cw_jb_c";break;case 4:n="cw_jb_h";break;case 5:n="cw_jb_j"}return Or.getFullUrl("ui/images/pet/"+n+".png")},t.getColorByPZ=function(e){var t=Ta.MODEL.value(Ta.getIndex(325));t&&this.petQuiltyArr.length<=0&&(this.petQuiltyArr=t.split(";"));var i=1;if(this.petQuiltyArr.length>=e){var s=this.petQuiltyArr[e-1];i=parseInt(s.split(",")[0])}return i+1},t.getProByIndex=function(e,t,i){for(var s,n=0;n<Zs.count;n++)if(Zs.MODEL.petStar(n)==i&&Zs.MODEL.petId(n)==t){(s=new Object).attr=Zs.MODEL.attrPre(n)/100+"%",s.maxStarExp=Zs.MODEL.maxStarExp(n),s.zizhiAdd=Zs.MODEL.zizhiAdd(n);break}for(n=0;n<sr.count;n++)if(sr.MODEL.petColor(n)==e&&sr.MODEL.petId(n)==t){var o=sr.MODEL.growRange(n).split(",")[1];s.maxG=parseInt(o)/100;break}return s},t.getPetIndexByPro=function(e,t){for(var i=0,s=0;s<$r.count;s++)if($r.MODEL.key(s)==e){i=s;break}return i},t.getStarIndexByPro=function(e,t){for(var i=0,s=0;s<Zs.count;s++)if(Zs.MODEL.petId(s)==e&&Zs.MODEL.petStar(s)==t){i=s;break}return i},t.getFlghtValue=function(e){var t=0;if(null==e)return 0;var i=this.getStarIndexByPro(e.petId,e.petStar),s=Zs.MODEL.attrPre(i)/1e4,n=this.getPetAttr(e,s);if(0<n.length)for(var o,a="",r=0;r<n.length;r++)(a=(o=n[r]).attrKey)==Se.CRI_RATE.keyStr?t+=1500*Number(o.attrValue.replace("%","")):a==Se.ATK.keyStr?t+=3.6*Number(o.attrValue):a==Se.DEF.keyStr||a==Se.MDEF.keyStr?t+=1.8*Number(o.attrValue):a==Se.MAXHP.keyStr?t+=.2*Number(o.attrValue):a==Se.CRI.keyStr&&(t+=3.6*Number(o.attrValue)*2e3/1e4);return Math.round(t)},t.getPetAttr=function(e,t){if(void 0===t&&(t=0),null==e)return[];for(var i=[],s=0,n=0;n<Un.count;n++)if(Un.MODEL.key(n)==e.petId){s=n;break}var o=Un.MODEL.kValueStr(s),a=0,r=JSON.parse(Un.MODEL.baseAttr(s));if(o){var l,c=JSON.parse(o);for(var d in c){l=new Object;var u=Se.getAttributByKey(d);if(l.attrName=u.attrName+"：",(l.attrKey=d)==Se.CRI_RATE.keyStr)l.attrValue=(Math.pow(e.zizhi*e.grow,.5)*parseInt(c[d])*(1+t)/1e4).toFixed(2)+"%";else{a=this.getBaseValue(d,r);var h=e.zizhi*e.grow*(e.petLevel+50)*parseInt(c[d])*(1+t)/1e4;l.attrValue=a+Math.floor(h)}i.push(l)}}return i},t.getColorIndexByPro=function(e,t){for(var i=0,s=0;s<sr.count;s++)if(sr.MODEL.petId(s)==e&&sr.MODEL.petColor(s)==t){i=s;break}return i},t.getAtkK=function(){return 0},t.sendTs=function(e,t,i){var s=new dl;s.mainIndex=e,s.otherIndex=t,s.type=i,Fl.sendToService(s)},t.sendSx=function(e,t){var i=new pl;i.index=e,i.type=t,Fl.sendToService(i)},t.sendFuti=function(){var e=new ll;Fl.sendToService(e)},t.getChuzhanIndex=function(){var e=-1;if(this.petdata&&this.petdata.petArr&&0<this.petdata.petArr.length)for(var t=0;t<this.petdata.petArr.length;t++)2==this.petdata.petArr[t].petState&&(e=this.petdata.petArr[t].index);return e},t.petPop=function(e){var t=Ta.getIndex(326),i=parseInt(Ta.MODEL.value(t));this.setPopTime(i),Y.timer.clear(this,this.onLoop),modules.pet.others.PetDataModel.shouldOpenPop=!0,this._petEggVo||(this._petEggVo=new Lh),this._petEggVo.update(e.quality,e.curValue)},t.petLeader=function(e){if(e)switch(e.status){case 0:break;case 1:if(this._isOpenTip)return;Hh.ins.show(),this._isOpenTip=!0;break;case 2:this._petLeftTime=1e3*e.leftTime+qe.now(),-1==Xn.NORMAL.indexOf("NavPetBirth")&&Xn.NORMAL.push("NavPetBirth"),Nn.ins.showCompoment("NavPetBirth");break;case 3:var t=Xn.NORMAL.indexOf("NavPetBirth");-1<t&&Xn.NORMAL.splice(t,1),Nn.ins.hideCompoment("NavPetBirth");var i={leader:!0,petId:parseInt(Ta.MODEL.value(Ta.getIndex(318)))};On.ins.isCloseAll2?Rh.ins.show(i):Rh.ins.addShow(i)}},t.setPetLeader2=function(){var e=Xn.NORMAL.indexOf("NavPetBirth");-1<e&&Xn.NORMAL.splice(e,1),Nn.ins.hideCompoment("NavPetBirth");var t=new Ha;t.packId=30983,Fl.sendToService(t),this.sendStr2Server(2)},t.sendStr2Server=function(e){var t={type:e,leftTime:0},i=new T;i.infoStr=JSON.stringify(t),Fl.sendToService(i)},t.isFinishShop=function(){return this.petShopdata.giftArr.length<Ls.count?0:1},t.gift1IsFinish=function(){for(var e=!1,t=0;t<this.petShopdata.giftArr.length;t++){var i=this.petShopdata.giftArr[t],s=Ls.getIndex(i);if(1==Ls.MODEL.type(s))return e=!0}return e},t.getPetSkill=function(){if((!this.petSkill||this.petSkill&&this.skillpetIndex!=Gi.ins.petIndex)&&0<Gi.ins.petIndex)if(0<Zs.count){this.skillpetIndex=Gi.ins.petIndex,this.petSkill=[];var e=Zs.MODEL.skills(this.getStarIndexByPro(Gi.ins.petIndex,Gi.ins.petStar));if(e)for(var t=e.split(","),i=0;i<t.length;i++)this.petSkill.push(parseInt(t[i]))}else{var s=[{url:Or.getJxrDBPath("PetStarUpgradeResource"),type:"arraybuffer",cls:Zs}];Wl.ins().onLoadJxrs(s)}return this.petSkill},t.getAttByIndex=function(){return Gi.ins.petAttrHash.take("ATK")},t.getLimitByPos=function(e){return this._posToLvMap||this.getMaxGrip(),this._posToLvMap.take(e)},t.getCurMaxZizhi=function(e,t,i){var s=0,n=0;for(n=0;n<sr.count;n++)if(sr.MODEL.petId(n)==t&&sr.MODEL.petColor(n)==e){var o=sr.MODEL.zizhiRange(n).split(",");s+=parseInt(o[1])}var a=0;for(n=0;n<Zs.count&&a<=i;n++)Zs.MODEL.petId(n)==t&&Zs.MODEL.petStar(n)==a&&(s+=Zs.MODEL.zizhiAdd(n),a++);return s},t.isSelectPet=function(){var e,t=1;if(0<this.curSelectIndex){for(var i=modules.pet.others.PetDataModel.ins().petdata.petArr,s=0;s<i.length;s++)this.curSelectIndex==i[s].index&&(e=this.petdata.petArr[s]);e&&(1==e.gridState?t=0:2==e.gridState&&(t=1))}return t},t.getBaseValue=function(e,t){for(var i=0,s=0;s<t.length;s++)if(t[s].type==e){i=t[s].value;break}return i},t.getChineseByAlb=function(e){var t="";switch(e){case 0:t="零";break;case 1:t="一";break;case 2:t="二";break;case 3:t="三";break;case 4:t="四";break;case 5:t="五";break;case 6:t="六";break;case 7:t="七";break;case 8:t="八";break;case 9:t="九";break;case 10:t="十";break;case 11:t="十一";break;case 12:t="十二";break;case 13:t="十三";break;case 14:t="十四";break;case 15:t="十五";break;case 16:t="十六";break;case 17:t="十七";break;case 18:t="十八";break;case 19:t="十九";break;case 20:t="二十"}return t},t.getHasPetorEgg=function(){if(this.petdata&&this.petdata.petArr&&0<this.petdata.petArr.length)for(var e=0;e<this.petdata.petArr.length;e++)if(2==this.petdata.petArr[e].petState||1==this.petdata.petArr[e].petState)return 1;return 0},t.nextPetIndex=function(){var e=0;if(this.petdata&&this.petdata.petArr&&0<this.petdata.petArr.length)for(var t=0;t<this.petdata.petArr.length;t++)0==this.petdata.petArr[t].petState&&(e=t);return e},t.setPopTime=function(e){this._popLeftTime=e,Y.timer.loop(1e3,this,this.onLoop)},t.onLoop=function(){this._popLeftTime--,this._popLeftTime<=0&&(modules.pet.others.PetDataModel.shouldOpenPop=!1,Y.timer.clear(this,this.onLoop))},t.checkPetEgg=function(){return 0<ri.ins.getPackEgg().length},t.getMaxLvByPetVo=function(e){var t=0,i=0;for(t=0;t<ka.count;t++)e.petStar>=ka.MODEL.needStar(t)&&ka.MODEL.key(t)>i&&(i=ka.MODEL.key(t));return i},t.getEffX=function(e){var t=0;switch(e){case"jm1607":case"jm1608":t=350;break;case"jm1609":case"jm1610":t=360;break;case"jm1611":case"jm1612":t=370;break;case"jm1613":case"jm1614":t=350;break;case"jm1615":case"jm1616":t=360;break;case"jm1617":case"jm1618":t=350;break;case"jm1619":case"jm1620":t=350;break;case"jm1621":case"jm1622":default:t=350}return t},t.getEffY=function(e){var t=0;switch(e){case"jm1607":case"jm1608":t=530;break;case"jm1609":case"jm1610":t=560;break;case"jm1611":case"jm1612":t=490;break;case"jm1613":case"jm1614":t=570;break;case"jm1615":case"jm1616":t=530;break;case"jm1617":case"jm1618":t=430;break;case"jm1619":case"jm1620":t=430;break;case"jm1621":case"jm1622":t=490;break;default:t=530}return t},t.getTipsEffY=function(e){var t=0;switch(e){case"jm1607":case"jm1608":t=250;break;case"jm1609":case"jm1610":t=255;break;case"jm1611":case"jm1612":t=230;break;case"jm1613":case"jm1614":t=265;break;case"jm1615":case"jm1616":t=250;break;case"jm1617":case"jm1618":t=200;break;case"jm1619":case"jm1620":t=230;break;case"jm1621":case"jm1622":default:t=230}return t},t.getBrithEffY=function(e){var t=0;switch(e){case"jm1607":case"jm1608":t=170;break;case"jm1609":case"jm1610":t=200;break;case"jm1611":case"jm1612":t=150;break;case"jm1613":case"jm1614":t=210;break;case"jm1615":case"jm1616":t=190;break;case"jm1617":case"jm1618":t=110;break;case"jm1619":case"jm1620":t=125;break;case"jm1621":case"jm1622":t=160;break;default:t=140}return t},n(0,t,"petEggDropVo",function(){return this._petEggVo}),n(0,t,"petWelShowLv",function(){if(this._petWelShowLv<1){var e=Ta.getIndex(317);this._petWelShowLv=parseInt(Ta.MODEL.value(e))}return this._petWelShowLv}),n(0,t,"petLeftTime",function(){return this._petLeftTime}),n(0,t,"petBirthtime",function(){if(this._petBirthTime<1){var e=Ta.getIndex(316);this._petBirthTime=1e3*parseInt(Ta.MODEL.value(e))}return this._petBirthTime}),n(0,t,"petOpenTime",function(){return this._petOpenTime}),n(0,t,"isBuyTrain",function(){return!!(this.petShopdata&&this.petShopdata.giftArr&&-1<this.petShopdata.giftArr.indexOf(2))}),n(0,t,"popLeftTime",function(){return this._popLeftTime}),e.ins=function(){return null==e._ins&&(e._ins=new e),e._ins},e._ins=null,e.isPetTrain=!1,e.JICHENG=1,e.TUNSHI=2,e.LG_PETSHOP=!0,e.LG_PETMAIN=!0,e.isShowArrow=!1,e.shouldOpenPop=!1,e}(),Lh=function(){function e(){this.quality=0,this.curValue=0}u(e,"modules.pet.others.PetEggDropVo");var t=e.prototype;return t.update=function(e,t){this.quality=e,this.curValue=t},n(0,t,"index",function(){return Rr.getIndex(this.quality)}),n(0,t,"model",function(){return Rr.MODEL.model(this.index)}),n(0,t,"desc",function(){return Rr.MODEL.desc(this.index)}),n(0,t,"maxPro",function(){return Rr.MODEL.maxProcess(this.index)}),e}(),Ah=(function(e){function t(){t.__super.call(this),this.registerSubProxy(Ah),this.subPackages=["30972","30978","36002","30977","30980","36003","10205"]}u(t,"modules.pet.PetModule",Tc)}(),function(e){function i(){var e=this;e.isOpen=0,e._mainView=null,e._tsSelectedView=null,e.eggSelectView=null,e._petFutiView=null,e._petPop=null,e._openIndex=0,i.__super.call(e);var t=[Or.getLayoutsPath("pet"),Or.getLayoutsPath("activity")];On.ins.registPanel("PETMAIN_VIEW",Uh,"_mainView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["PetEggResource","PetLvUpgradeResource","PetStarUpgradeResource","PetColorUpgradeResource","PetResource","PetAttrResource","PetEatingResource","PetGridNumResource","PetShopResource","ConfigRule","PetAppendageResource"],["PetEggResource","PetLvUpgradeResource","PetStarUpgradeResource","PetColorUpgradeResource","PetResource","PetAttrResource","PetEatingResource","PetGridNumResource","PetShopResource","CHelpDes","PetAppendageResource"])),layer:"layout",mask:!1}),On.ins.registPanel("PET_TUNSHI_LIST_VIEW",jh,"_tsSelectedView",e,{mask:!0}),On.ins.registPanel("PETEGGSELECT_VIEW",Vh,"eggSelectView",e,{mask:!0,clickClose:!0}),On.ins.registPanel("PETFUTI_VIEW",Mh,"_petFutiView",e,{mask:!0,clickClose:!0}),On.ins.registPanel("PETPOPTIP",Fh,"_petPop",e,{mask:!1,clickClose:!1,layer:"nav",wait:On.wait(On.waitConfig(["petEggGuildReource"],["PetLeadModel"]))})}u(i,"modules.pet.proxys.PetProxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"PETOPENVIEW":if(e.proto&&e.proto.hasOwnProperty("subIndex")&&(t._openIndex=e.proto.subIndex),e.proto&&e.proto.hasOwnProperty("isT")&&(Eh.isPetTrain=e.proto.isT),On.ins.isOpen("PETMAIN_VIEW"))0<=t._openIndex&&(t._mainView&&t._mainView.setSelectIndex(t._openIndex),t._openIndex=0);else{t.isOpen=1;var i=new hl;Fl.sendToService(i)}break;case"30972":var s=e.proto;Eh.ins().petdata=s,!On.ins.isOpen("PETMAIN_VIEW")&&t.isOpen?(t.isOpen=0,On.ins.open("PETMAIN_VIEW",{_subIndex_:t._openIndex,message:e},0),t._openIndex=0):t._mainView&&t._mainView.parent&&t._mainView.updateByVSC(e),t._petFutiView&&t._petFutiView.parent&&t._petFutiView.show(),-1==Eh.ins().getChuzhanIndex()&&(Gi.ins.petIndex=-1,Fl.sendToModule("HIDE_PET",["modules.scene.SceneModule"]));break;case"PET_TUNSHI_S_VIEW":var n=e.proto;On.ins.open("PET_TUNSHI_LIST_VIEW",n);break;case"PET_TUNSHI_SELECTED":2==e.proto.type?t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView instanceof modules.pet.views.PetTunshiView&&t._mainView.vsc.selectedView.setTSPet(e.proto.vo):1==e.proto.type&&t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView instanceof modules.pet.views.PetJichengView&&t._mainView.vsc.selectedView.setPetInfo(e.proto.vo),On.ins.close("PET_TUNSHI_LIST_VIEW");break;case"30978":var o=e.proto;1==o.result&&t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView&&(1==o.type||4==o.type?t._mainView.vsc.selectedView.success():2==o.type?t._mainView.vsc.selectedView.success():3==o.type&&t._mainView.vsc.selectedView.success());break;case"BP_UPDATE":t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView&&(t._mainView.vsc.selectedView instanceof modules.pet.views.PetTunshiView?t._mainView.vsc.selectedView.updateTools():t._mainView.vsc.selectedView instanceof modules.pet.views.PetXilianView?t._mainView.vsc.selectedView.updateTools():t._mainView.vsc.selectedView instanceof modules.pet.views.PetBaseView&&t._mainView.vsc.selectedView.updateRedPoint()),t._petFutiView&&t._petFutiView.parent&&t._petFutiView.updateTool();break;case"10205":t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView&&t._mainView.vsc.selectedView instanceof modules.pet.views.PetShopView&&t._mainView.vsc.selectedView.updateMoney();break;case"30977":var a=e.proto;Eh.ins().petShopdata=a,t._mainView&&t._mainView.parent&&t._mainView.updateByVSC(e);break;case"36002":Eh.ins().petLeader(e.proto);break;case"36003":var r=parseInt(Ta.MODEL.value(Ta.getIndex(59)));Eh.ins().petPop(e.proto),t._petPop?t._petPop.update():Wc.isEnabledChangeScene()&&Gi.ins.lv>=r&&On.ins.open("PETPOPTIP"),Y.timer.clear(t,t.checkOpenPop),Y.timer.loop(18e5,t,t.checkOpenPop);break;case"30980":var l={leader:!1,petId:e.proto.petId,index:e.proto.index};Wc.isEnabledChangeScene()&&Rh.ins.show(l);break;case"PET_SHOWARROW":t._mainView&&t._mainView.vsc&&t._mainView.vsc.selectedView instanceof modules.pet.views.PetBaseView&&t._mainView.vsc.selectedView.showArrow();break;case"PETBAR_SELECTED":t._mainView&&t._mainView.vsc.invalid()}},t.checkOpenPop=function(){if(Eh.shouldOpenPop=!0,Wc.isEnabledChangeScene()){var e=parseInt(Ta.MODEL.value(Ta.getIndex(59)));Gi.ins.lv>=e&&On.ins.open("PETPOPTIP")}},t.showPanel=function(e,t){switch(e){case"PETMAIN_VIEW":this._mainView&&this._mainView.parent&&t&&this._mainView.updateByVSC(t.message);break;case"PET_TUNSHI_LIST_VIEW":this._tsSelectedView&&this._tsSelectedView.parent&&this._tsSelectedView.updateData(t);break;case"PETFUTI_VIEW":this._petFutiView&&this._petFutiView.parent&&this._petFutiView.updateData(t)}},t.closePanel=function(e,t){},i}()),Bh=function(e){function t(){this.petItem=null,this.petVo=null,this.chooseType=0,t.__super.call(this),this.initUI()}u(t,"modules.pet.views.item.PetTunshiSelectItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_enter.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_enter.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){this.petVo&&(2==this.petVo.petState?2==this.chooseType?Vl.ins.playErrorMsg(ed.n[1764]):Vl.ins.playErrorMsg(ed.n[1765]):Fl.sendToModule("PET_TUNSHI_SELECTED",["modules.pet.PetModule"],{vo:this.petVo,type:this.chooseType}))},i.initUI=function(){this.petItem=new Ph,this.petItem.x=this.img_head.x-8,this.petItem.y=this.img_head.y-8,this.addChild(this.petItem)},i.getRangeByZiZhi=function(){var e="";if(this.petVo){var t=0;for(t=0;t<Ct.count;t++){var i=Ct.MODEL.zizhiRange(t).split(",");if(this.petVo.zizhi>=parseInt(i[0])&&this.petVo.zizhi<=parseInt(i[1])){e=Ct.MODEL.expRange(t).replace(",","~");break}}}return e},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.petVo=e.vo,t.chooseType=e.type,2==t.chooseType?(t.box_jicheng.visible=!1,t.box_tunshi.visible=!0):(t.box_jicheng.visible=!0,t.box_tunshi.visible=!1),t.petItem.dataSource=t.petVo,t.petItem.showName(!1),t.petItem.addTipsClick();var i=Xl.getIndex(t.petVo.petModel);Xl.MODEL.muId(i);t.txt_name.text=Xl.MODEL.name(i),t.txt_name.color=Co.getPetColorByQuality(Eh.ins().getColorByPZ(t.petVo.petColor)-1),t.txt_lv.text=" Lv."+t.petVo.petLevel,t.txt_lv.x=275,t.txt_zz.text=t.petVo.zizhi.toString(),t.txt_cz.text=t.petVo.grow.toFixed(2),t.txt_exp.text=t.getRangeByZiZhi()}}),t}(q),Dh=function(t){function i(){var e=this;e._selector=null,e.curPetVo=null,e.selectId=0,e.bornTime=0,e._BAR_W=0,e.g_cost=null,e.costId=0,e.costNum=0,e.isEnought=0,e._tween=null,e.timeCount=0,e.timeCostNum=0,e.timeBei=0,e.attrArr=[],e.skillEff=null,e.buffEff=null,e.skillEffSt=null,e.buffEffSt=null,e._mouseDown=!1,e._Skillgrid=null,e._buffImg=null,e.perSeletIndex=0,e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,e.footEff=null,e.footEffSt=0,e.footSp=null,e._operateType=0,e.hasArrow=!1,i.__super.call(e)}u(i,"modules.pet.views.PetBaseView",t);var e=i.prototype;return e.createChildren=function(){var e=this;t.prototype.createChildren.call(e),e._selector=new Gh(1),e._selector.centerX=0,e._selector.y=80,e.addChild(e._selector),e.mc_bar.mask=e.bar_mask,e.petmc_bar.mask=e.petbar_mask,e.footSp=new rn,e.addChildAt(e.footSp,e.getChildIndex(e.btnTemp)),e._Skillgrid=new Tt,e._Skillgrid.scaleX=e._Skillgrid.scaleY=.85,e._Skillgrid.pos(e.btn_skill1.x,e.btn_skill1.y),e.petview.addChild(e._Skillgrid),e.petview.addChild(e.img_zhu),e._buffImg=new Dl,e._buffImg.width=e._buffImg.height=102,e._buffImg.scaleX=e._buffImg.scaleY=.85,e._buffImg.pos(e.btn_skill2.x+6,e.btn_skill2.y+6),e.petview.addChild(e._buffImg),e.petview.addChild(e.img_tian)},e.initView=function(){var e=Eh.ins().getChuzhanIndex();-1==Eh.ins().curSelectIndex&&(0<=e?Eh.ins().curSelectIndex=e:Eh.ins().petdata&&Eh.ins().petdata.petArr&&0<Eh.ins().petdata.petArr.length?Eh.ins().curSelectIndex=Eh.ins().petdata.petArr[0].index:Eh.ins().curSelectIndex=0),this.perSeletIndex=0;try{this.updateSelectView(Eh.ins().curSelectIndex)}catch(e){}},e.updateCzStatus=function(){var e=Eh.ins().getChuzhanIndex();0<=e&&e==Eh.ins().curSelectIndex?this.btn_chuzhan.skin=Or.getFullUrl("ui/layouts/pet/cw_btn_xx.png",!1):this.btn_chuzhan.skin=Or.getFullUrl("ui/layouts/pet/cw_btn_cz.png",!1)},e.updateByVSC=function(e){e&&"30972"==e.actionOrder&&(this._selector.updatePet(),this.updateSelectView(Eh.ins().curSelectIndex))},e.updateRedPoint=function(){this._selector.setEggPoint(),this.updateCost(),this.btn_futi.showTip=0<ri.ins.getGoodsNum(89013)},e.updateSelectView=function(e,t){var i=this;if(void 0===t&&(t=0),Eh.ins().petdata&&Eh.ins().petdata.petArr){if(0==Eh.ins().petdata.petArr.length&&0==t||-1==e)i.eggview.visible=!1,i.petview.visible=!1,i.nostuffview.visible=!0;else{i.nostuffview.visible=!1;for(var s=Eh.ins().petdata.petArr,n=0;n<s.length;n++)e==s[n].index&&(i.curPetVo=s[n]);if(i.curPetVo){if(1==i.curPetVo.gripOpen)return void On.ins.open("PETEGGSELECT_VIEW");1==i.curPetVo.gridState?(i.eggview.visible=!0,i.petview.visible=!1,i.setEggview(i.curPetVo),i.setAvatar(1)):2==i.curPetVo.gridState&&(i.eggview.visible=!1,i.petview.visible=!0,i.setPetview(i.curPetVo),1==t&&(Eh.ins().petFightTime=0),i.perSeletIndex!=e&&(i.setAvatar(2),i.perSeletIndex=e))}else On.ins.open("PETEGGSELECT_VIEW")}i.updateCzStatus()}Eh.isShowArrow&&(i.showArrow(),Eh.isShowArrow=!1)},e.setEggview=function(e){var t=this,i=gt.MODEL.goodsId(gt.getIndex(e.eggId));t.name=Re.MODEL.name(Re.getIndex(i)),t.eggname.text=t.name,t.eggname.color=Co.getByQuality(Re.MODEL.colourId(Re.getIndex(i))),t.bornTime=e.breakTime-J.serverTimeSec,t.left_txt.changeText(V.getENTickMS(t.bornTime)),t.timeCount=10,t.time_txt.changeText(t.timeCount+"分钟"),t.addgold.innerHTML="50",t.timeBei=gt.MODEL.reduceTime(gt.getIndex(e.eggId));var s=gt.MODEL.consumptionDef(gt.getIndex(e.eggId)),n=JSON.parse(s);t.pross_txt.innerHTML="",t.timeCostNum=parseInt(n[0].value.split(":")[1]),t.onResetTime(),(t.perSeletIndex=0)<t.bornTime&&Y.timer.loop(1e3,t,t.onResetTime)},e.setPetview=function(e){var t=this,i=Eh.ins().getStarIndexByPro(e.petId,e.petStar),s=Eh.ins().getColorIndexByPro(e.petId,e.petColor),n=sr.MODEL.effectId(s),o=sr.MODEL.maxGrow(s),a=Zs.MODEL.effectId(i),r=Xl.getIndex(e.petModel);Xl.MODEL.muId(r);t.name=Xl.MODEL.name(r),t.fc_value.value=Eh.ins().getFlghtValue(e).toString(),t.name_txt.text=t.name,t.name_txt.color="#e0d6c1",t.zhizi_txt.changeText("资质:"+e.zizhi+"/"+Eh.ins().getCurMaxZizhi(e.petColor,e.petId,e.petStar)),t.grow_txt.changeText("成长："+e.grow+"/"+o/100),t.level_txt.changeText(ed.n[1766]+e.petLevel),t.img_color.skin=Eh.ins().getColorSkinByPZ(e.petColor),t.img_fen.skin=Eh.ins().getSkinByPZ(e.petColor);var l=ka.MODEL.consumptionDef(ka.getIndex(e.petLevel)),c=JSON.parse(l);t.costId=parseInt(c[0].value.split(":")[0]),t.costNum=parseInt(c[0].value.split(":")[1]),t.g_cost||(t.g_cost=new ra(45),t.g_cost.needGridBg=!1,t.g_cost.needEffect=!1,t.g_cost.pos(t.cost_div.x-50,t.cost_div.y-10),t.cost_box.addChild(t.g_cost));var d=an.create(t.costId);t.g_cost.bindData=d;var u=Zs.MODEL.skillsNow(i),h="",_=[],p=0;u||(h=Zs.MODEL.skillsNext(i))&&(_=h.split(","),p=parseInt(_[0]),u=Zs.MODEL.skillsNow(Eh.ins().getStarIndexByPro(e.petId,p))),t._Skillgrid.bindData=u;var f=O.getIndex(u);t.txt_skillname1.changeText(O.MODEL.name(f));var g=sr.MODEL.roleBuffs(s);g&&(_=g.split(","),u=parseInt(_[0]),f=Ki.getIndex(u),t.txt_skillname2.changeText(Ki.MODEL.skillName(f)),t._buffImg.skin=Or.getIconPath(Ki.MODEL.icon(f))),a||t.clearEffect1(),a!=t.skillEffSt&&(t.skillEffSt=a,t.clearEffect1(),t.skillEff=Es.GetNew(),t.skillEff.renderInSelf=!0,t.petview.addChild(t.skillEff),t.skillEff.loadEffect(t.skillEffSt),t.skillEff.pos(t.btn_skill1.x+49,t.btn_skill1.y+49),t.skillEff.scale_Y=t.skillEff.scale_X=.85),n||t.clearEffect2(),n!=t.buffEffSt&&(t.buffEffSt=n,t.clearEffect2(),t.buffEff=Es.GetNew(),t.buffEff.renderInSelf=!0,t.petview.addChild(t.buffEff),t.buffEff.loadEffect(t.buffEffSt),t.buffEff.pos(t.btn_skill2.x+49,t.btn_skill2.y+49),t.buffEff.scale_Y=t.buffEff.scale_X=.85),t.updateCost(),t.showBar(),t.updateAttr()},e.updateAttr=function(){if(this.curPetVo){var e=0,t=Eh.ins().getStarIndexByPro(this.curPetVo.petId,this.curPetVo.petStar),i=Zs.MODEL.attrPre(t)/1e4,s=Eh.ins().getPetAttr(this.curPetVo,i);for(e=0;e<s.length;e++)this["item_"+e].txt_name.text=s[e].attrName,this["item_"+e].txt_value.text=s[e].attrValue,this["item_"+e].txt_value.color="#23b11f"}},e.updateCost=function(){var e=this;if(0<e.costId){var t=ri.ins.getGoodsNum(e.costId);t>=e.costNum?(e.isEnought=1,e.petupgrade.showTip=!0,e.cost_div.innerHTML=nc.createColor(t+"","#23b11f")+"/"+e.costNum):(e.isEnought=0,e.petupgrade.showTip=!1,e.cost_div.innerHTML=nc.createColor(t+"","#ff2e24")+"/"+e.costNum),e.curPetVo.petLevel==ka.count&&20<=e.curPetVo.petStar?(e.petupgrade.label="已满级",e.petupgrade.disabled=!0,e.petupgrade.showTip=!1):Eh.ins().getMaxLvByPetVo(e.curPetVo)>e.curPetVo.petLevel?(e.petupgrade.label="升 级",e.petupgrade.disabled=!1):e.petupgrade.showTip=!1}},e.onResetTime=function(){var e=this;e.left_txt.changeText(V.getENTickMS(e.bornTime)),e.bornTime--;var t=gt.MODEL.needBrokenTime(gt.getIndex(e.curPetVo.eggId)),i=0==e.bornTime?0:e.bornTime/t;e.bar_mask.x=-e._BAR_W+i*e._BAR_W,e.bornTime<=0&&(Y.timer.clear(e,e.onResetTime),e.left_txt.changeText(""))},e.showBar=function(){var e=this,t=ka.MODEL.exp(ka.getIndex(e.curPetVo.petLevel)),i=NaN;i=e.curPetVo.petLeExp==t?(t=ka.MODEL.exp(ka.getIndex(e.curPetVo.petLevel+1)),e.div_pross.innerHTML="0/"+t,0):(e.div_pross.innerHTML=e.curPetVo.petLeExp+"/"+t,0==e.curPetVo.petLeExp?0:e.curPetVo.petLeExp/t),e._tween=Yl.to(e.petbar_mask,{x:-e._BAR_W+i*e._BAR_W},100,null)},e.showList=function(){var e=[];e=Qo.srotOn(e,"goodsId",Array.NUMERIC)},e.onClick=function(e){var t=this;if(e.target==t.petupgrade){if(!t.curPetVo)return;if(ri.ins.getGoodsNum(t.costId)<t.costNum)return void Fl.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:t.costId});var i=new pl;i.index=t.curPetVo.index,i.type=1,Fl.sendToService(i)}else if(e.target==t.labTushi)Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:1});else if(e.target==t.jian1){if(t._mouseDown)return;t.timeCount-=t.timeBei/60,t.timeCount<10&&(t.timeCount=10),t.time_txt.changeText(t.timeCount+"分钟"),t.addgold.innerHTML=60*t.timeCount/t.timeBei*t.timeCostNum+""}else if(e.target==t.jia1){if(t._mouseDown)return;var s=Math.floor(t.bornTime/60);if(s<10)t.timeCount=10;else{if(s-t.timeCount<=10)return;t.timeCount+=t.timeBei/60}t.time_txt.changeText(t.timeCount+"分钟"),t.addgold.innerHTML=60*t.timeCount/t.timeBei*t.timeCostNum+""}else if(e.target==t.egguse){if(t.curPetVo){if(0==t.timeCount)return;if(Gi.ins.YB<60*t.timeCount/t.timeBei*t.timeCostNum)return void ja.ins.showNoGold();var n=new cl;n.index=t.curPetVo.index,n.time=t.timeCount,Fl.sendToService(n)}}else if(e.target==t.btn_futi)t.curPetVo&&On.ins.open("PETFUTI_VIEW",t.curPetVo);else if(e.target==t.btn_skill1)td.instance.show(t.curPetVo);else if(e.target==t._buffImg)id.instance.show(t.curPetVo);else if(e.target==t.btn_chuzhan){if(t.hasArrow){t.hasArrow=!1,Bl.Ins().closeArrow();var o=new Ha;o.packId=30981,Fl.sendToService(o)}Eh.ins().fightFly=-1;var a=J.curServerTime;if(0!=Eh.ins().petFightTime){if(a-Eh.ins().petFightTime<4500){var r=(5-(a-Eh.ins().petFightTime)/1e3).toFixed();return void Vl.ins.showMsg(ed.n[1767]+r+"秒",1)}Eh.ins().petFightTime=a}else Eh.ins().petFightTime=a;Eh.ins().sendSx(t.curPetVo.index,2)}else if(e.target==t.btn_help){var l=po.MODEL.description(po.getIndex(36));On.ins.open("AE_EXPLAIN_VIEW",{desc:l})}else e.target==t.btn_fangru&&On.ins.open("PETEGGSELECT_VIEW")},e.setAvatar=function(e){var t=this;if(null!=t.curPetVo){var i,s=0;if(i=1==e?gt.MODEL.interfaceModel(gt.getIndex(t.curPetVo.eggId)):(s=Eh.ins().getPetIndexByPro(t.curPetVo.petId,t.curPetVo.petColor),$r.MODEL.interfaceModel(s)),Y.timer.clear(t,t.effEnd),t.clearAvator(),t.clearAvator2(),i){var n=i.split(",");t.modeleff1=n[0],t.modeleff2=n[1]}2==e?(t.footEffSt=jl.MODEL.awayEffect(jl.getIndex(t.curPetVo.petStar+1)),t.footEffSt?(t.clearFootEFF(),t.footEff=new Es,t.footEff.renderInSelf=!0,t.footSp.addChild(t.footEff),t.footEff.loadEffect("jm"+t.footEffSt),t.footEff.scale_X=1.2,t.footEff.scale_Y=.55,t.footEff.pos(360,670)):t.clearFootEFF()):t.clearFootEFF(),t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.loadEffect(t.modeleff1),t._avatar.pos(Eh.ins().getEffX(t.modeleff1),Eh.ins().getEffY(t.modeleff1))}},e.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.loadEffect(e.modeleff2),e._avatar2.pos(Eh.ins().getEffX(e.modeleff2),Eh.ins().getEffY(e.modeleff2))},e.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},e.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},e.clearFootEFF=function(){this.footEff&&(this.footEff.parent&&this.footEff.parent.removeChild(this.footEff),this.footEff.playEndHandler=null,this.footEff.forceDestory(),this.footEff=null)},e.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._BAR_W=t.mc_bar.width,t.bar_mask.x=-t._BAR_W,t._BAR_W=t.petmc_bar.width,t.petbar_mask.x=-t._BAR_W,t._selector.on("select",t,t.onSelectRole),t.petupgrade.on("click",t,t.onClick),t.labTushi.on("click",t,t.onClick),t.jian10.on("click",t,t.onClick),t.jian1.on("click",t,t.onClick),t.jia1.on("click",t,t.onClick),t.jia10.on("click",t,t.onClick),t.jia10.visible=!1,t.jian10.visible=!1,t.egguse.on("click",t,t.onClick),t.btn_futi.on("click",t,t.onClick),t.btn_skill1.on("click",t,t.onClick),t._buffImg.on("click",t,t.onClick),t.btn_chuzhan.on("click",t,t.onClick),t.btn_help.on("click",t,t.onClick),t.btn_fangru.on("click",t,t.onClick),t.on("mousedown",t,t.onMouseDownHandler),t.on("mouseup",t,t.onMouseUpHandler),t.on("mouseout",t,t.onMouseUpHandler),t._selector.updatePet(),t.initView(),t.timer.once(500,t,t.updateRedPoint),-1==t._selector.selectIdx&&(t._selector.selectIdx=0)},e.onMouseUpHandler=function(e){Y.timer.clear(this,this.checkMouseDown),Y.timer.clear(this,this.changeHandler),this._mouseDown=!1},e.onMouseDownHandler=function(e){var t=this;if(e.target instanceof laya.ui.Button)switch(e.target){case t.jia1:t._operateType=1,t._mouseDown=!0,Y.timer.once(500,t,t.checkMouseDown);break;case t.jian1:t._operateType=2,t._mouseDown=!0,Y.timer.once(500,t,t.checkMouseDown)}},e.checkMouseDown=function(){this._mouseDown&&Y.timer.loop(150,this,this.changeHandler,[this._operateType])},e.changeHandler=function(e){var t=this;switch(void 0===e&&(e=-1),e){case 1:if(t.timeCount>Math.floor(t.bornTime/60))return;t.timeCount+=t.timeBei/60,t.time_txt.changeText(t.timeCount+"分钟"),t.addgold.innerHTML=60*t.timeCount/t.timeBei*t.timeCostNum+"";break;case 2:t.timeCount-=t.timeBei/60,t.timeCount<10&&(t.timeCount=10),t.time_txt.changeText(t.timeCount+"分钟"),t.addgold.innerHTML=60*t.timeCount/t.timeBei*t.timeCostNum+""}},e.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t._selector.off("select",t,t.onSelectRole),t.petupgrade.off("click",t,t.onClick),t.labTushi.off("click",t,t.onClick),t.jian10.off("click",t,t.onClick),t.jian1.off("click",t,t.onClick),t.jia1.off("click",t,t.onClick),t.jia10.off("click",t,t.onClick),t.egguse.off("click",t,t.onClick),t.btn_futi.off("click",t,t.onClick),t.btn_skill1.off("click",t,t.onClick),t._buffImg.off("click",t,t.onClick),t.btn_chuzhan.off("click",t,t.onClick),t.btn_help.off("click",t,t.onClick),t.btn_fangru.off("click",t,t.onClick),Y.timer.clearAll(t),t.clearAvator(),t.clearAvator2(),t.g_cost&&(t.g_cost.parent&&t.g_cost.parent.removeChild(t.g_cost),t.g_cost.destroy(),t.g_cost=null)},e.onSelectRole=function(){Eh.ins().curSelectIndex=this._selector.getSelectIndex(),this.updateSelectView(Eh.ins().curSelectIndex,1)},e.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),Eh.ins().curSelectIndex=-1},e.showArrow=function(){this.hasArrow=!0,Bl.Ins().showforDir(0,ed.n[1768],this.btnTemp,!1,!1,0,0,!1),Bl.Ins().lockSceneShowByDisPlay(this.btnTemp)},e.clearEffect1=function(){this.skillEff&&(this.skillEff.parent&&this.skillEff.parent.removeChild(this.skillEff),this.skillEff.dispose(),this.skillEff=null)},e.clearEffect2=function(){this.buffEff&&(this.buffEff.parent&&this.buffEff.parent.removeChild(this.buffEff),this.buffEff.dispose(),this.buffEff=null)},n(0,e,"addRate",function(){if(!Eh.ins().petdata)return 0;var e=eo.getIndex(Eh.ins().petdata.futiLevel),t=eo.MODEL.attrRate(e).split(",");return t[this.curPetVo.petColor-1]?Math.floor(t[this.curPetVo.petColor-1]/100):0}),i}(fc),Oh=(function(e){function t(){var e=this;e.mid="jm1623,jm1624",e._leftTime=0,e._BARWIDTH=0,e._allTime=0,e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,t.__super.call(e),e.labDesc.text=ed.n[1769],e._BARWIDTH=e.imgBar.width,e.imgBar.mask=e.imgMask,e.imgMask.x=0}u(t,"modules.pet.views.PetBirthingTip",p);var i=t.prototype;i.show=function(e){var t=this;t.imgBg.skin=Or.getNoClearImage2("cwud_tc_dt.jpg"),t._leftTime=e,t._allTime=Eh.ins().petBirthtime,t._leftTime<=0||(t.labTime.text=al.simpleFormat(t._leftTime/10),Y.timer.clearAll(t),Y.timer.loop(10,t,t.onLoop),t._avatar&&(t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t.setAvatar(),t.parent||(Zl.panelLayer.on("MASK_CLOSE",t,t.onClick),Zl.panelLayer.openTip(t)),t.btn_close.on("click",t,t.onClick))},i.onLoop=function(){this._leftTime-=10,this._leftTime<=0&&this.close(!0),this.labTime.text=al.simpleFormat(this._leftTime/10),this.updateBar()},i.updateBar=function(){var e=this._leftTime/this._allTime*this._BARWIDTH;Yl.to(this.imgMask,{x:e-this._BARWIDTH},8,null,ms.create(this,this.barEnd))},i.barEnd=function(){Yl.clearAll(this.imgMask)},i.onClick=function(e){this.close(!0)},i.close=function(e){var t=this;(void 0===e&&(e=!1),e)?!Zl.panelLayer.closeTip(t)&&Zl.panelLayer.close(t):Zl.panelLayer.close(t);Zl.panelLayer.off("MASK_CLOSE",t,t.onClick),t.btn_close.off("click",t,t.onClick),Y.timer.clearAll(t),t.imgBg&&t.imgBg.skin&&Y.loader.clearRes(t.imgBg.skin),t.imgBg.skin=null,t._avatar&&(t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t._leftTime<=0&&Y.timer.once(500,t,t.checkShowBirthed)},i.checkShowBirthed=function(){if(!Rh.ins.parent){var e={leader:!0,petId:parseInt(Ta.MODEL.value(Ta.getIndex(318)))};Rh.ins.show(e)}},i.setAvatar=function(){var e=this;e.clearAvator();if(e.mid){var t=e.mid.split(",");e.modeleff1=t[0],e.modeleff2=t[1]}e._avatar=new Es,e._avatar.renderInSelf=!0,Y.timer.once(800,e,e.effEnd),e.addChild(e._avatar),e._avatar.loadEffect(e.modeleff1),e._avatar.pos(310,275)},i.effEnd=function(){this.clearAvator2(),this._avatar2=new Es,this._avatar2.renderInSelf=!0,this.addChild(this._avatar2),this._avatar2.loadEffect(this.modeleff2),this._avatar2.pos(310,275)},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.pet.PetOpenDownTipUI._$SET_ins),t._ins=null}(),function(e){function t(){this.grid=null,t.__super.call(this)}u(t,"modules.pet.views.PetEggSelectItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_go.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_go.off("click",this,this.onClick)},i.onClick=function(e){Eh.ins().isUseEgg=1,Fl.sendToModule("BP_GOODSUSE",["modules.backpack.BackpackModule"],{dto:this.grid.bindData,num:1}),On.ins.close("PETEGGSELECT_VIEW")},i.createChildren=function(){e.prototype.createChildren.call(this),this.grid=new ra(116),this.grid.pos(this.img.x,this.img.y),this.addChild(this.grid)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.setData=function(e){this.grid.bindData=e,this.name_txt.changeText(e.name),this.name_txt.color=Co.getDragonColorByQuality(e.colourId)},t}(ua)),Vh=function(e){function t(){t.__super.call(this),this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.itemRender=Oh,this.list.renderHandler=ms.create(this,this.onListRender,null,!1)}u(t,"modules.pet.views.PetEggSelectView",Kc);var i=t.prototype;return i.onListRender=function(e,t){var i=this.list.array[t];e.setData(i)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick),this.link_get.on("click",this,this.onClick),this.updateList()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick),this.link_get.off("click",this,this.onClick)},i.onClick=function(e){e.target==this.btn_close?On.ins.close("PETEGGSELECT_VIEW"):e.target==this.link_get&&(On.ins.close("PETEGGSELECT_VIEW"),0==Eh.ins().gift1IsFinish()?Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:4}):On.ins.open("BOSS_MAINVIEW",{_subIndex_:1},0,!0))},i.updateList=function(){var e=ri.ins.getPackEgg();0<e.length?(this.list.dataSource=e,this.list.visible=!0,this.nostuff.visible=!1):(this.list.visible=!1,this.nostuff.visible=!0)},t}(),Mh=function(e){function t(){var e=this;e._grid=null,e.skillIcon=null,e.costId=0,e.costNum=0,e._dto=null,e.curLevel=-1,e.successEft=null,e.petVo=null,t.__super.call(e),e._grid=new ra(45),e._grid.y=5,e._grid.needGridBg=!1,e._grid.needEffect=!1,e.btn_go.disabled=!0,e.img_max.visible=!1,e.img_cost.addChild(e._grid),e.skillIcon=new Dl,e.skillIcon.width=e.skillIcon.height=105,e.skillIcon.pos(5,5),e.img_icon.addChild(e.skillIcon)}u(t,"modules.pet.views.PetFutiView",pt);var i=t.prototype;return i.show=function(){if(Eh.ins().petdata){for(var e,t=Eh.ins().petdata.petArr,i=0;i<t.length;i++)if(Eh.ins().curSelectIndex==t[i].index){e=t[i];break}this.updateData(e)}},i.updateData=function(e){var t=this;if(e&&e instanceof modules.pet.others.Petvo&&(t.petVo=e,Eh.ins().petdata&&t._grid)){var i,s=Eh.ins().petdata.futiLevel;if(s>=eo.count)t.img_max.visible=!0,t.cost_box.visible=!1,t.txt_name.changeText(eo.MODEL.name(eo.getIndex(s))),t.title1.changeText(ed.n[1770]),i=t.getRateStr(s),t.txt_curdes.innerHTML=ur.getFormat(i[0],[i[1]]),t.title2.changeText(""),t.txt_nextdes.innerHTML="",t.skillIcon.skin=Or.getIconPath(eo.MODEL.icon(eo.getIndex(s))),t.txt_netxlevel.visible=!1,t.g_line.bottom=117,t.height=t.txt_curdes.y+t.txt_curdes.contextHeight+134;else{if(0==s)t.txt_name.changeText(eo.MODEL.name(eo.getIndex(s+1))),t.title1.changeText(ed.n[1771]),i=t.getRateStr(s+1),t.txt_curdes.innerHTML=ur.getFormat(i[0],[i[1]]),t.title2.changeText(""),t.txt_nextdes.innerHTML="",t.skillIcon.skin=Or.getIconPath(eo.MODEL.icon(eo.getIndex(s+1))),t.g_line.bottom=117,t.height=t.txt_curdes.y+t.txt_curdes.contextHeight+134;else if(t.txt_name.changeText(eo.MODEL.name(eo.getIndex(s))),t.title1.changeText(ed.n[1770]),i=t.getRateStr(s),t.txt_curdes.innerHTML=ur.getFormat(i[0],[i[1]]),i=t.getRateStr(s+1),t.skillIcon.skin=Or.getIconPath(eo.MODEL.icon(eo.getIndex(s))),t.cost_box.visible=0!=i[1],0!=i[1])t.title2.changeText(ed.n[1773]),t.txt_nextdes.innerHTML=ur.getFormat(i[0],[i[1]]),t.txt_netxlevel.y=t.txt_curdes.y+t.txt_curdes.contextHeight+17,t.txt_nextdes.y=t.txt_netxlevel.y+48,t.g_line.bottom=170,t.height=t.txt_nextdes.y+t.txt_nextdes.contextHeight+187;else{var n=nc.createSizeColor(ed.n[1774],24,"#23b11f");n+=ed.n[1775],n+=nc.createSizeColor(ed.n[1776],24,"#23b11f"),n+=ed.n[1777],t.txt_nextdes.innerHTML=n,t.txt_netxlevel.visible=!1,t.txt_nextdes.y=t.txt_curdes.y+t.txt_curdes.contextHeight+25,t.g_line.bottom=130,t.height=t.txt_nextdes.y+t.txt_nextdes.contextHeight+30}t.setCost(s+1)}-1!=t.curLevel&&t.curLevel<s?(t.curLevel=s,t.clearEffect(),t.successEft=Es.GetNew(),t.successEft.renderInSelf=!0,t.addChild(t.successEft),t.successEft.loadEffect("jm1072"),t.successEft.pos(t.width>>1,t.height>>1)):(t.curLevel=s,t.clearEffect()),t.btn_go.on("click",t,t.onClickHandler)}},i.getRateStr=function(e){var t=eo.getIndex(e),i=eo.MODEL.dec(t),s=eo.MODEL.attrRate(t).split(",");return[i,s[this.petVo.petColor-1]?Math.floor(s[this.petVo.petColor-1]/100):0]},i.clearEffect=function(){this.successEft&&(this.successEft.parent&&this.successEft.parent.removeChild(this.successEft),this.successEft.dispose(),this.successEft=null)},i.setCost=function(e){var t=this;if(t._grid.visible=t.cost_box.visible,t._grid.visible){var i;i=eo.MODEL.consumeDef(eo.getIndex(e)),eo.MODEL.nextId(eo.getIndex(e));var s=JSON.parse(i);t.costId=parseInt(s[0].value.split(":")[0]),t.costNum=parseInt(s[0].value.split(":")[1]);var n=an.create(t.costId);t._grid.bindData=n;var o=ri.ins.getGoodsNum(t.costId);o>=t.costNum?(t.btn_go.disabled=!1,t.div_cost.innerHTML=nc.createColor(o+"","#23b11f")+"/"+t.costNum):t.div_cost.innerHTML=nc.createColor(o+"","#ff2e24")+"/"+t.costNum,t.btn_go.showTip=o>=t.costNum}},i.onClickHandler=function(e){Eh.ins().sendFuti()},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!Zl.panelLayer.closeTip(this)&&Zl.panelLayer.close(this):Zl.panelLayer.close(this);this.btn_go.off("click",this,this.onClickHandler)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.updateTool=function(){var e=Eh.ins().petdata.petArr,t=0;if(e)for(t=0;t<e.length;t++)if(Eh.ins().curSelectIndex==e[t].index){var i=Eh.ins().petdata.petArr[t];this.updateData(i)}},t}(),Rh=(function(e){function t(){var e=this;e._avatar=null,e.petItem=null,e.textName=null,e._dto=null,e._showList=[],t.__super.call(e),e.petItem=new Ph,e.petItem.x=e.btn_Go.x+e.btn_Go.width/2-e.petItem.width/2,e.petItem.y=e.btn_Go.y-160,e.addChild(e.petItem),e.textName=ti.createText(e.petItem.x,e.petItem.y+120,116,50,"",20,"#6c6250",!1,"center",!1,!1,e),e.addChild(e.textName)}u(t,"modules.pet.views.PetgetEggTip",Jl);var i=t.prototype;i.checkShow=function(){this._showList.length&&this.show(this._showList.pop())},i.addShowInfo=function(e){this._showList.push(e)},i.show=function(e){var t=this;if(e)if(t._dto=e,gt.count<=0){var i=[{url:Or.getJxrDBPath("PetEggResource"),type:"arraybuffer",cls:gt}];Wl.ins().onLoadJxrs(i,ms.create(modules.pet.views.PetgetEggTip.ins,modules.pet.views.PetgetEggTip.ins.show,[e]))}else{Zl.panelLayer.on("MASK_CLOSE",t,t.onClick);for(var s=new Wr,n=0;n<gt.count;n++)gt.MODEL.goodsId(n)==e.goodsId&&(s.eggId=gt.MODEL.key(n));s.gridState=1,s.index=1,t.petItem.dataSource=s,t.petItem.showName(!1),t.petItem.setEggTip(!0),t.textName.changeText(e.name),t.textName.color=Co.getDragonColorByQuality(e.colourId),t.parent||Zl.panelLayer.openTip(t),t.hasListener("click")||t.on("click",t,t.onClickHandler)}},i.onClickHandler=function(e){switch(e.target){case this.btn_Close:this.onClick(null);break;case this.btn_Go:Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"]),this.onClick(null)}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!Zl.panelLayer.closeTip(this)&&Zl.panelLayer.close(this):Zl.panelLayer.close(this);Zl.panelLayer.off("MASK_CLOSE",this,this.onClick)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.pet.PetgetEggTipUI._$SET_ins),t._ins=null}(),function(e){function t(){this._needShow=null,this._info=null,this._avatar=null,this._avatar2=null,this.modeleff1=null,this.modeleff2=null,this.footEff=null,this.footEffSt=null,t.__super.call(this)}u(t,"modules.pet.views.PetHasBirthedTip",Ji);var i=t.prototype;return i.addShow=function(e){this._needShow=e},i.checkShow=function(){this._needShow&&(this.show(this._needShow),this._needShow=null)},i.show=function(e){var t=this;t.clearAvator(),t.clearAvator2(),Y.timer.clearAll(t),t._needShow==e&&(t._needShow=null),t._info=e,t.uiClose.visible=!1,e.leader||(t.uiClose.visible=!0,Zl.panelLayer.on("MASK_CLOSE",t,t.onClick));var i=e.petId,s=$r.getIndex(i),n=$r.MODEL.petColor(s),o=$r.MODEL.model(s),a=Xl.getIndex(o);Xl.MODEL.muId(a);t.txtName.text=Xl.MODEL.name(a),t.imgColor.skin=Eh.ins().getColorSkinByPZ(n),t.imgQua.skin=Eh.ins().getSkinByPZ(n),t.imgTitle.skin=Or.getNoClearImage("cw_title_pdec"),t.imgRight.skin=Or.getNoClearImage2("cw_pdec_bg2.jpg"),t.imgLeft.skin=Or.getNoClearImage2("cw_pdec_bg1.jpg"),t.parent||(e.leader?Zl.panelLayer.open(t,!0,!1,!1):Zl.panelLayer.openTip(t)),t.hasListener("click")||t.on("click",t,t.onClickHandler),t.setAvatar(2),t.y=440,t.x=(Y.stage.width-t.width)/2},i.onClickHandler=function(e){switch(e.target){case this.btnEntrance:if(this._info.leader)return Eh.isShowArrow=!0,void this.onClick(null);Eh.ins().isBrithPet=this._info.index,Y.timer.once(100,this,this.openPetView),this.onClick(null)}},i.openPetView=function(){Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"])},i.onClick=function(e){this.close(!0),this._needShow=this._info=null},i.close=function(e){var t=this;if(void 0===e&&(e=!1),t._info&&t._info.leader){if(t.parent){var i=ic.getActIcon(107),s=Nn.ins.getCompomentsByName("NavActRView");if(!i||!s)return void t.onComplete();var n=s.localToGlobal(i._p);Yl.to(t,{x:n.x,y:n.y+10,scaleX:.15,scaleY:.15,alpha:.1},500,null,ms.create(t,t.onComplete1))}}else{if(e)!Zl.panelLayer.closeTip(t)&&Zl.panelLayer.close(t);else Zl.panelLayer.close(t);Zl.panelLayer.off("MASK_CLOSE",t,t.onClick)}},i.onComplete1=function(){Y.timer.once(600,this,this.onComplete)},i.onComplete=function(){Yl.clearAll(this),this.parent&&(Zl.panelLayer?Zl.panelLayer.close(this):this.parent.removeChild(this)),Y.timer.once(100,this,this.openPet)},i.openPet=function(){Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"])},i.setAvatar=function(e){var t=this;if(t.clearAvator(),null!=t._info){var i,s;if(i=Eh.ins().getPetIndexByPro(t._info.petId,1),s=$r.MODEL.interfaceModel(i)){var n=s.split(",");t.modeleff1=n[0],t.modeleff2=n[1]}t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.loadEffect(t.modeleff1),t._avatar.scale_X=t._avatar.scale_Y=.6,t._avatar.pos(285,Eh.ins().getBrithEffY(t.modeleff1))}},i.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.loadEffect(e.modeleff2),e._avatar2.scale_X=e._avatar2.scale_Y=.6,e._avatar2.pos(285,Eh.ins().getBrithEffY(e.modeleff2))},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.clearFootEFF=function(){this.footEff&&(this.footEff.parent&&this.footEff.parent.removeChild(this.footEff),this.footEff.playEndHandler=null,this.footEff.forceDestory(),this.footEff=null)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.imgTitle&&t.imgTitle.skin&&Y.loader.clearRes(t.imgTitle.skin),t.imgLeft&&t.imgLeft.skin&&Y.loader.clearRes(t.imgLeft.skin),t.imgRight&&t.imgRight.skin&&Y.loader.clearRes(t.imgRight.skin),t.clearAvator(),t.clearAvator2(),Y.timer.clearAll(t),laya.ui.View.prototype.destroy.call(t,e)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.pet.PetHasBirthedTipUI._$SET_ins),t._ins=null,t}()),Ph=function(e){function t(){var e=this;e.textName=null,e.textLevel=null,e.petGrid=null,e.icon_pet=null,e.icon_lock=null,e.btn_add=null,e.bgIcon=null,e.starImg=null,e.redImg=null,e.chuzhanImg=null,e.item=null,e._petvo=null,e.bornTime=0,e.select_mc=null,e.limitText=null,t.__super.call(e),e.size(116,156),e.on("display",e,e.onAdd),e.on("undisplay",e,e.onRemove),e.petGrid=new rn,e.addChild(e.petGrid),e.bgIcon=new Dl,e.petGrid.addChild(e.bgIcon),e.item=new ra,e.addChild(e.item),e.textName=ti.createText(-10,120,136,50,"",20,"#6c6250",!1,"center",!1,!1,e),e.textLevel=ti.createText(0,140,116,50,"",20,"#6c6250",!1,"center",!1,!1,e),e.addChild(e.textName),e.addChild(e.textLevel),e.icon_pet=new Dl,e.icon_pet.pos(7,10),e.petGrid.addChild(e.icon_pet),e.icon_lock=new Dl,e.icon_lock.pos(30,30),e.petGrid.addChild(e.icon_lock),e.btn_add=ti.createButton(Or.getFullUrl("ui/layouts/basic_ui_b2/ty_btn_jh.png",!1),24,24,68,68),e.petGrid.addChild(e.btn_add),e.item.toolTipEnabled=!1,e.starImg=new Dl,e.petGrid.addChild(e.starImg),e.chuzhanImg=new Dl,e.chuzhanImg.pos(22,85),e.addChild(e.chuzhanImg),e.select_mc=new Dl,e.addChild(e.select_mc),e.select_mc.skin=Or.getFullUrl("ui/layouts/basic_ui/ty_gz_xzzt.png",!1),e.select_mc.width=e.select_mc.height=116}u(t,"modules.pet.views.PetItem",rn);var i=t.prototype;return i.setSelcet=function(e){0==this._petvo.gripOpen&&(this.select_mc.visible=e)},i.setEggTip=function(e){this.item.toolTipEnabled=e},i.setPetRedPoint=function(){var e=this;if(e.clearRedP(),e._petvo)if(1==e._petvo.gripOpen)0<Eh.ins().checkPetEgg()?e.drawRedIcon():e.clearRedP();else if(2==e._petvo.gridState)if(Eh.ins().getMaxLvByPetVo(e._petvo)>e._petvo.petLevel&&2==e._petvo.petState){var t=ka.MODEL.consumptionDef(ka.getIndex(e._petvo.petLevel)),i=JSON.parse(t),s=parseInt(i[0].value.split(":")[0]),n=parseInt(i[0].value.split(":")[1]);if(0<s)n<=ri.ins.getGoodsNum(s)?e.drawRedIcon():e.clearRedP()}else e.clearRedP()},i.setPetSXPoint=function(){var e=this;if(e.clearRedP(),e._petvo&&2==e._petvo.gridState)if(e._petvo.isTop)e.clearRedP();else{var t=Eh.ins().getProByIndex(e._petvo.petColor,e._petvo.petId,e._petvo.petStar),i=Eh.ins().getStarIndexByPro(e._petvo.petId,e._petvo.petStar),s=Zs.MODEL.upgradeStarConsumptionDef(i);if(s&&e._petvo.petStarExp>=t.maxStarExp){var n=JSON.parse(s)[0].value,o=n.split(":")[0];n.split(":")[1]<=ri.ins.getGoodsNum(o)?e.drawRedIcon():e.clearRedP()}else e.clearRedP()}},i.onAdd=function(e){},i.onRemove=function(e){this.off("click",this,this.onClickHandler)},i.addTipsClick=function(){this.on("click",this,this.onClickHandler)},i.onClickHandler=function(){Wh.instance.show(this._petvo)},i.onResetTime=function(){this.textLevel.changeText(""+V.getENTickMS(this.bornTime)),this.bornTime--,this.bornTime<=0&&(Y.timer.clear(this,this.onResetTime),this.textLevel.changeText(""))},i.showName=function(e){this.textName.visible=e,this.textLevel.visible=e,this.select_mc.visible=e},i.getName=function(){var e={};return e.lv=this.textLevel.text,e.name=this.textName.text,e.color=this.textName.color,e},i.drawRedIcon=function(){var e,t;this.clearRedP(),this.redImg||(this.redImg=new Dl),this.redImg.parent||this.petGrid.addChild(this.redImg),this.redImg.pos(80,0),t=Or.getAtlasSubPath("basic_ui/ty_ts_hd.png"),e=Y.loader.getRes(t),this.redImg.graphics.drawTextures(e,[0,0])},i.clearRedP=function(){this.redImg&&(this.redImg.graphics.clear(),this.redImg.parent&&this.redImg.parent.removeChild(this.redImg))},n(0,i,"dataSource",null,function(e){var t=this;if(t._petvo!=e&&(t.limitText&&(t.limitText.changeText(""),t.limitText.removeSelf(),t.limitText=null),t._petvo=e,t.petGrid.visible=!0,t.btn_add.visible=!1,t.icon_lock.visible=!1,e))if(0==e.gripOpen&&e.index){var i,s=e.gridState;if(2==s){t.item.dataSource=null,Y.timer.clear(t,t.onResetTime),t.textLevel.changeText("");var n=Xl.getIndex(e.petModel),o=Xl.MODEL.muId(n);i=Xl.MODEL.name(n),t.textLevel.changeText("Lv."+e.petLevel),t.textName.text=i,t.textName.color=Co.getPetColorByQuality(Eh.ins().getColorByPZ(e.petColor)-1);var a=jc.gridBg(Eh.ins().getColorByPZ(e.petColor));t.bgIcon.skin=a,n=Cs.getIndex(o);var r,l,c=Cs.MODEL.headId(n);if(t.icon_pet.skin=Or.getBossPath(c),t.icon_pet.visible=!0,2==e.petState){if(t.chuzhanImg.skin=Or.getFullUrl("ui/layouts/pet/cw_text_czz.png",!1),t.chuzhanImg.visible=!0,Gi.ins.petIndex!=t._petvo.petId){Gi.ins.petIndex=t._petvo.petId,Gi.ins.petColor=e.petColor,Gi.ins.petStar=e.petStar;var d=0,u=Eh.ins().getStarIndexByPro(t._petvo.petId,t._petvo.petStar),h=Zs.MODEL.attrPre(u)/1e4,_=Eh.ins().getPetAttr(t._petvo,h);for(d=0;d<_.length;d++)"ATK"==_[d].attrKey&&Gi.ins.petAttrHash.put("ATK",_[d].attrValue,!0);Fl.sendToModule("ADD_PET",["modules.scene.SceneModule"])}}else t.chuzhanImg.visible=!1;if(0<e.petColor)l=Or.getAtlasSubPath("grids/lhzb_jb_m.png"),r=Y.loader.getRes(l),t.starImg.graphics.drawTextures(r,[0,0]),l=Eh.ins().getHSkinByPZ(e.petColor),r=Y.loader.getRes(l),t.starImg.graphics.drawTextures(r,[0,0]);else t.starImg._graphics.clear()}else if(1==s){t.petGrid.visible=!1,t.chuzhanImg.visible=!1;var p=gt.MODEL.goodsId(gt.getIndex(e.eggId)),f=an.create(p);t.item.dataSource=f,i=Re.MODEL.simpleName(Re.getIndex(p)),t.textName.text=i,t.textName.color=Co.getByQuality(Re.MODEL.colourId(Re.getIndex(p))),t.bornTime=e.breakTime-J.serverTimeSec,t.onResetTime(),0<t.bornTime&&Y.timer.loop(1e3,t,t.onResetTime)}}else{Y.timer.clear(t,t.onResetTime),t.chuzhanImg.visible=!1,t.select_mc.visible=!1;var g=jc.gridBg(1,t.width);t.starImg._graphics.clear(),t.icon_pet.visible=!1,t.bgIcon.skin=g,t.item.dataSource=null,t.textLevel.changeText(""),t.textName.color="#6c6250",1==e.gripOpen?(t.textName.text=ed.n[1778],t.btn_add.visible=!0):2==e.gripOpen&&(t.textName.text="未开启",t.icon_lock.skin=Or.getFullUrl("ui/layouts/pet/ty_jm_gz_locked.png",!1),t.icon_lock.scaleX=t.icon_lock.scaleY=1,t.icon_lock.visible=!0,t.limitText=ti.createText(0,30,116,80,"",26,"#ff2e24",!1,"center",!1,!1,t),t.limitText.changeText(Eh.ins().getLimitByPos(e.gridPos)+ed.n[1779]))}}),t}(),Nh=function(e){function t(){var e=this;e.petData=null,e.petItemSrc=null,e.petItemTar=null,e.petItemOver=null,e.petVoSrc=null,e.petVoTar=null,e.petOverVO=null,e.tools=null,e.isEnough=!1,e.chooseType=0,e.jcSuccessEft=null,e.imgSkill=null,e.imgBuff=null,e.skillEff=null,e.buffEff=null,e.skillEffSt=null,e.buffEffSt=null,t.__super.call(e),e.petData=Eh.ins()}u(t,"modules.pet.views.PetJichengView",go);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_desc.on("click",t,t.onClickDesc),t.txt_desc.on("click",t,t.onClickDesc),t.btn_ts.on("click",t,t.onClickJiCheng),t.img_src.on("click",t,t.onClickXZ),t.img_tar.on("click",t,t.onClickXZ),t.btn_src.on("click",t,t.onClickTH),t.btn_tar.on("click",t,t.onClickTH),t.btn_src.visible=t.btn_tar.visible=!1,t.box_cost.visible=!1,t.txt_tar.text=t.txt_src.text=ed.n[1780],t.txt_tar.color=t.txt_src.color="#e0d6c1",t.txt_target.changeText(""),t.initPetInfo(),t.txt_grow.text="",Fl.sendToModule("PETBAR_SELECTED",["modules.pet.PetModule"])},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_desc.off("click",t,t.onClickDesc),t.txt_desc.off("click",t,t.onClickDesc),t.btn_ts.off("click",t,t.onClickJiCheng),t.img_src.off("click",t,t.onClickXZ),t.img_tar.off("click",t,t.onClickXZ),t.btn_src.off("click",t,t.onClickTH),t.btn_tar.off("click",t,t.onClickTH),t.petItemTar&&(t.petItemTar.parent&&t.petItemTar.parent.removeChild(t.petItemTar),t.petItemTar=null),t.petItemSrc&&(t.petItemSrc.parent&&t.petItemSrc.parent.removeChild(t.petItemSrc),t.petItemSrc=null),t.petItemOver&&(t.petItemOver.parent&&t.petItemOver.parent.removeChild(t.petItemOver),t.petItemOver=null),t.imgBuff&&(t.imgBuff.off("click",t,t.onClickSkill),t.imgBuff.parent&&t.imgBuff.parent.removeChild(t.imgBuff),t.imgBuff.skin="",t.imgBuff=null),t.imgSkill&&(t.imgSkill.off("click",t,t.onClickSkill),t.imgSkill.parent&&t.imgSkill.parent.removeChild(t.imgSkill),t.imgSkill.skin="",t.imgSkill=null),t.clearEffect(),t.clearEffect1(),t.clearEffect2(),t.petVoTar=null,t.petVoSrc=null},i.updateMoney=function(){},i.setPetInfo=function(e){var t,i=this;0==i.chooseType?(i.petItemSrc||(i.petItemSrc=new Ph),i.petItemSrc.parent||i.box_main.addChild(i.petItemSrc),i.petVoSrc=e,i.petItemSrc.dataSource=e,i.petItemSrc.setSelcet(!1),i.petItemSrc.addTipsClick(),i.petItemSrc.showName(!1),i.btn_src.visible=!0,i.petItemSrc.x=i.img_src.x,i.petItemSrc.y=i.img_src.y,(t=i.petItemSrc.getName())&&(i.txt_src.text=t.name+"("+t.lv+"级)",i.txt_src.color=t.color)):1==i.chooseType&&(i.petItemTar||(i.petItemTar=new Ph),i.petItemTar.parent||i.box_main.addChild(i.petItemTar),i.petVoTar=e,i.petItemTar.dataSource=e,i.petItemTar.setSelcet(!1),i.petItemTar.showName(!1),i.petItemTar.addTipsClick(),i.btn_tar.visible=!0,i.petItemTar.x=i.img_tar.x,i.petItemTar.y=i.img_tar.y,(t=i.petItemTar.getName())&&(i.txt_tar.text=t.name+"("+t.lv+"级)",i.txt_tar.color=t.color)),null!=i.petVoSrc&&null!=i.petVoTar||i.initPetInfo(),i.showJiChengInfo()},i.success=function(){var e=this;e.petItemSrc&&(e.petItemSrc.parent&&e.petItemSrc.parent.removeChild(e.petItemSrc),e.petItemSrc=null,e.petVoSrc=null,e.btn_src.visible=!1,e.txt_src.text=ed.n[1781],e.txt_src.color="#e0d6c1"),e.petItemTar&&(e.petItemTar.parent&&e.petItemTar.parent.removeChild(e.petItemTar),e.petItemTar=null,e.petVoTar=null,e.btn_tar.visible=!1,e.txt_tar.text=ed.n[1782],e.txt_tar.color="#e0d6c1"),e.clearEffect(),e.jcSuccessEft=Es.GetNew(),e.jcSuccessEft.renderInSelf=!0,e.jcSuccessEft.loadEffect("jm1592"),e.jcSuccessEft.pos(360,420),e.box_main.addChild(e.jcSuccessEft)},i.clearEffect=function(){this.jcSuccessEft&&(this.jcSuccessEft.parent&&this.jcSuccessEft.parent.removeChild(this.jcSuccessEft),this.jcSuccessEft.dispose(),this.jcSuccessEft=null)},i.showJiChengInfo=function(){var e=this;if(e.txt_target.changeText(""),e.petVoTar&&e.petVoSrc){e.petItemOver||(e.petItemOver=new Ph),e.petItemOver.parent||e.box_main.addChild(e.petItemOver),e.petItemOver.showName(!1),e.petOverVO=e.petVoSrc.clone(),e.petOverVO.petStar=e.petVoTar.petStar>e.petVoSrc.petStar?e.petVoTar.petStar:e.petVoSrc.petStar,e.petOverVO.petLevel=e.petVoTar.petLevel>e.petVoSrc.petLevel?e.petVoTar.petLevel:e.petVoSrc.petLevel,e.petOverVO.zizhi=e.petVoTar.zizhi>e.petVoSrc.zizhi?e.petVoTar.zizhi:e.petVoSrc.zizhi,e.petOverVO.petColor=e.petVoTar.petColor>e.petVoSrc.petColor?e.petVoTar.petColor:e.petVoSrc.petColor,e.petOverVO.grow=e.petVoTar.grow>e.petVoSrc.grow?e.petVoTar.grow:e.petVoSrc.grow,e.petItemOver.dataSource=e.petOverVO,e.petItemOver.x=e.img_over.x+31,e.petItemOver.y=e.img_over.y+31,e.txt_Lv.text="Lv."+e.petOverVO.petLevel,e.txt_Star.text=e.petData.getChineseByAlb(e.petOverVO.petStar)+"星",e.txt_zizhi.text=e.petOverVO.zizhi+"/"+Eh.ins().getCurMaxZizhi(e.petOverVO.petColor,e.petOverVO.petId,e.petOverVO.petStar);var t=0;t=Eh.ins().getColorIndexByPro(e.petVoSrc.petId,e.petVoSrc.petColor);var i=sr.MODEL.maxGrow(t);t=Eh.ins().getColorIndexByPro(e.petVoTar.petId,e.petVoTar.petColor);var s=sr.MODEL.maxGrow(t);e.txt_grow.text=s<i?e.petOverVO.grow.toFixed(2)+"/"+(i/100).toFixed(2):e.petOverVO.grow.toFixed(2)+"/"+(s/100).toFixed(2),e.petItemOver.addTipsClick(),e.petItemOver.setSelcet(!1),e.showSkillInfo(e.petOverVO);var n=e.petItemOver.getName();n&&(e.txt_target.text=n.name+"("+n.lv+"级)",e.txt_target.color=n.color)}},i.showSkillInfo=function(e){var t=this,i=Eh.ins().getStarIndexByPro(e.petId,e.petStar),s=Eh.ins().getColorIndexByPro(e.petId,e.petColor),n=sr.MODEL.effectId(s),o=Zs.MODEL.effectId(i),a=Zs.MODEL.skills(i),r=0,l="";a&&(r=O.getIndex(parseInt(a.split(",")[0])),l=O.MODEL.icon(r),null==t.imgSkill&&(t.imgSkill=new Dl,t.imgSkill.width=t.imgSkill.height=104),t.imgSkill.parent||t.box_main.addChild(t.imgSkill),t.imgSkill.x=t.img_skill.x+2,t.imgSkill.y=t.img_skill.y+2,t.imgSkill.skin=Or.getIconPath(l),t.txt_skillName.text=O.MODEL.name(r),t.imgSkill.on("click",t,t.onClickSkill)),(a=sr.MODEL.roleBuffs(s))&&(null==t.imgBuff&&(t.imgBuff=new Dl,t.imgBuff.width=t.imgBuff.height=100),t.imgBuff.parent||t.box_main.addChild(t.imgBuff),t.imgBuff.x=t.img_buff.x+4,t.imgBuff.y=t.img_buff.y+4,r=Ki.getIndex(parseInt(a)),l=Ki.MODEL.icon(r),t.imgBuff.skin=Or.getIconPath(l),t.txt_TFName.text=Ki.MODEL.skillName(r),t.imgBuff.on("click",t,t.onClickSkill)),t.skillEffSt=o,t.clearEffect1(),t.skillEff=Es.GetNew(),t.skillEff.renderInSelf=!0,t.box_main.addChild(t.skillEff),t.skillEff.loadEffect(t.skillEffSt),t.skillEff.pos(t.img_skill.x+52,t.img_skill.y+52),t.skillEff.mat.scale(1.05,1.05),t.buffEffSt=n,t.clearEffect2(),t.buffEff=Es.GetNew(),t.buffEff.renderInSelf=!0,t.box_main.addChild(t.buffEff),t.buffEff.loadEffect(t.buffEffSt),t.buffEff.pos(t.img_buff.x+53,t.img_buff.y+53),t.buffEff.mat.scale(.98,.98)},i.getNextUpExp=function(e){var t=9999999999,i=ka.getIndex(e);return i?t=ka.MODEL.addExp(i):t},i.clearEffect1=function(){this.skillEff&&(this.skillEff.parent&&this.skillEff.parent.removeChild(this.skillEff),this.skillEff.dispose(),this.skillEff=null)},i.clearEffect2=function(){this.buffEff&&(this.buffEff.parent&&this.buffEff.parent.removeChild(this.buffEff),this.buffEff.dispose(),this.buffEff=null)},i.onClickTH=function(e){e.target==this.btn_src?this.chooseType=0:e.target==this.btn_tar&&(this.chooseType=1);var t="";this.petVoSrc&&(t=this.petVoSrc.index.toString()),this.petVoTar&&(t+=","+this.petVoTar.index),Fl.sendToModule("PET_TUNSHI_S_VIEW",["modules.pet.PetModule"],{petIndex:t,type:1})},i.onClickXZ=function(e){e.target==this.img_src?this.chooseType=0:e.target==this.img_tar&&(this.chooseType=1);var t="";this.petVoSrc&&(t=this.petVoSrc.index.toString()),this.petVoTar&&(t+=","+this.petVoTar.index),Fl.sendToModule("PET_TUNSHI_S_VIEW",["modules.pet.PetModule"],{petIndex:t,type:1})},i.onClickSkill=function(e){e.target==this.imgBuff?id.instance.show(this.petOverVO):e.target==this.imgSkill&&td.instance.show(this.petOverVO)},i.onClickDesc=function(e){var t=po.MODEL.description(po.getIndex(40));On.ins.open("AE_EXPLAIN_VIEW",{desc:t})},i.onClickJiCheng=function(e){this.petVoTar&&this.petVoSrc?this.petData.rongHeNoTips?this.petData.sendTs(this.petVoSrc.index,this.petVoTar.index,2):hn.ins.show(ed.n[1783],ms.create(this,this.onSure),!1,3,null,null,!0,0,!0):Vl.ins.playErrorMsg(ed.n[1784])},i.onSure=function(e,t){void 0===t&&(t=!1),this.petData.rongHeNoTips=t,1==e&&this.petData.sendTs(this.petVoSrc.index,this.petVoTar.index,2)},i.initPetInfo=function(){var e=this;e.txt_zizhi.text=e.txt_Star.text=e.txt_Lv.text="",e.txt_skillName.text="",e.txt_TFName.text="",e.petOverVO=null,e.petItemOver&&(e.petItemOver.parent&&e.petItemOver.parent.removeChild(e.petItemOver),e.petItemOver=null)},t}(),Gh=function(e){function i(e){var t=this;t._selectIdx=-1,t._items=null,t.totalData=null,t.isSetData=0,void(t.pageType=0)===e&&(e=0),i.__super.call(t),t.pageType=e,t.list.hScrollBarSkin="",t.list.itemRender=Ph,t.list.selectEnable=!0,t.list.scrollBar.elasticBackTime=300,t.list.scrollBar.elasticDistance=100,t.list.scrollBar.on("end",t,t.onScrollEnd),t.list.renderHandler=ms.create(t,t.onCellRender,null,!1),t.list.selectHandler=ms.create(t,t.selectItem,null,!1),t.list.height=170}u(i,"modules.pet.views.PetListBar",ue);var t=i.prototype;return t.onCellRender=function(e,t){this._selectIdx==t?e.setSelcet(!0):e.setSelcet(!1),1==this.pageType?this.setEggPoint():2==this.pageType&&this.setSXPoint()},t.setData=function(e){for(var t=Eh.ins().getOpenGrip(),i=Eh.ins().getMaxGrip();e.length<i;){var s=new Wr;e.length+1<=t?s.gripOpen=1:s.gripOpen=2,s.gridPos=e.length,e.push(s)}this.list.dataSource=e,this._items=e,this.isSetData=1;var n=0,o=Eh.ins().getChuzhanIndex(),a=Eh.ins().petdata.petArr;if(1==Eh.ins().isUseEgg)Eh.ins().isUseEgg=0,this.list.selectedIndex=Eh.ins().nextPetIndex();else if(0<Eh.ins().isBrithPet){for(n=0;n<a.length;n++)Eh.ins().isBrithPet==a[n].index&&(this.list.selectedIndex=n);Eh.ins().isBrithPet=0}else if(-1==Eh.ins().curSelectIndex)if(0<=o)for(n=0;n<a.length;n++)o==a[n].index&&(this.list.selectedIndex=n);else this.list.selectedIndex=-1;else for(n=0;n<a.length;n++)Eh.ins().curSelectIndex==a[n].index&&(this.list.selectedIndex=n)},t.updatePet=function(){if(Eh.ins().petdata){var e=Eh.ins().petdata.petArr.concat();e&&this.setData(e)}},t.selectItem=function(e){var t=this;if(0<=e&&t._items&&t._items[e])if(0==t._items[e].gripOpen)t._selectIdx=e,t.isSetData=0,Fl.sendToModule("PETBAR_SELECTED",["modules.pet.PetModule"]),t.event("select");else if(1==t._items[e].gripOpen)return-1!=t.list.selectedIndex&&(On.ins.open("PETEGGSELECT_VIEW"),t.list.selectedIndex=-1),1==t.isSetData?void(t.isSetData=0):void On.ins.open("PETEGGSELECT_VIEW")},t.getSelectIndex=function(){var e=0;return this._items[this._selectIdx]&&(e=this._items[this._selectIdx].index),e},t.onClick=function(e){var t=this;if(e.target==t.right_btn){var i=t.list.startIndex+4;i>=t.list.length&&(i=t.list.length-1),t.list.startIndex!=i&&t.list.tweenTo(i,150*(i-t.list.startIndex),ms.create(t,t.onScrollEnd))}else e.target==t.left_btn&&((i=t.list.startIndex-4)<0&&(i=0),t.list.startIndex!=i&&t.list.tweenTo(i,150*(t.list.startIndex-i),ms.create(t,t.onScrollEnd)))},t.onScrollEnd=function(){this.list.array.length<=4||(0==this.list.scrollBar.value?this.left_btn.visible=!1:this.left_btn.visible=!0,this.list.scrollBar.value==this.list.scrollBar.max?this.right_btn.visible=!1:this.right_btn.visible=!0)},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.left_btn.on("click",this,this.onClick),this.right_btn.on("click",this,this.onClick),this.left_btn.visible=!1},t.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.list.off("select",t,t.selectItem),t.left_btn.on("click",t,t.onClick),t.right_btn.on("click",t,t.onClick)},t.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t.setEggPoint=function(){for(var e,t=0;t<this._items.length;t++)(e=this.list.getCell(t))&&e.setPetRedPoint()},t.setSXPoint=function(){for(var e,t=0;t<this._items.length;t++)(e=this.list.getCell(t))&&e.setPetSXPoint()},n(0,t,"selectIdx",function(){return this._selectIdx},function(e){this.list.selectedIndex=e}),i}(),Uh=function(i){function e(){this.vsc=null,e.__super.call(this)}u(e,"modules.pet.views.PetMainView",i);var t=e.prototype;return t.initialize=function(){this.size(720,1280),this.top=this.bottom=this.left=this.right=0,this.navList=["ui/layouts/pet/yq_btn_cw.png","ui/layouts/pet/yq_btn_ts.png","ui/layouts/pet/yq_btn_xl.png","ui/layouts/pet/yq_btn_rh.png"],this.vsc=new o(this);var e=[{cls:Dh,id:"0",isHideBg:!0,wait:On.wait(On.waitConfig(["CrossBattleMainShow"],["CrossBattleMainShow"]))},{cls:qh,id:"1",isHideBg:!0,limitTip:function(){Vl.ins.playErrorMsg(ed.n[1785])}},{cls:Yh,id:"2",isHideBg:!0,limitTip:function(){Vl.ins.playErrorMsg(ed.n[1786])}},{cls:Nh,id:"3",isHideBg:!0}];Eh.ins().isFinishShop()?Eh.LG_PETSHOP=!1:(e.push({cls:zh,id:"4",isHideBg:!0}),this.navList.push("ui/layouts/pet/yq_btn_cwlb.png")),this.vsc.registAll(e),this.vsc.invalid(),this.title=Or.getAtlasSubPath("pet/cw_title_cw.png"),this.vsc.filterHandler=ms.create(this,this.onVscFilter,null,!1),this.vsc.selectHandler=ms.create(this,this.onSubChanged,null,!1)},t.onVscFilter=function(e,t){if("0"==e){if(Qr.ins.getStateByCareList([281]))return 3;if(Eh.LG_PETMAIN)return 3}else if("1"==e){if(!Eh.ins().petdata||!Eh.ins().petdata.petArr||0==Eh.ins().petdata.petArr.length)return 4;if(!Eh.ins().isSelectPet())return 4;if(Qr.ins.getStateByCareList([282]))return 3}else if("2"==e){if(!Eh.ins().petdata||!Eh.ins().petdata.petArr||0==Eh.ins().petdata.petArr.length)return 4;if(!Eh.ins().isSelectPet())return 4}else if("4"==e){if(Qr.ins.getStateByCareList([283]))return 3;if(Eh.LG_PETSHOP)return 3}return 0},t.onSubChanged=function(e){var t=this;switch(e){case"0":this.timer.once(1e3,this,function(){Eh.LG_PETMAIN&&(Eh.LG_PETMAIN=!1,Fl.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),t.vsc.updateItemEnabled())});break;case"1":case"1":case"3":break;case"4":Eh.LG_PETSHOP&&(Eh.LG_PETSHOP=!1,Fl.sendToModule("UPDATE_RED_POINT",["modules.nav.NavModule"]),this.vsc.updateItemEnabled())}},t.onRemove=function(e){i.prototype.onRemove.call(this,e),Qr.ins.removeListener("BTN_PET_MAIN"),Qr.ins.removeListener("BTN_PET_SHOP"),Qr.ins.removeListener("BTN_PET_TUNSHI")},t.setSelectIndex=function(e){switch(e.toString()){case"0":this.vsc.selectedIndex=0;break;case"1":this.vsc.selectedIndex=1;break;case"1":this.vsc.selectedIndex=2;break;case"3":this.vsc.selectedIndex=3;break;case"4":this.vsc.selectedIndex=4}},t.onAdd=function(e){i.prototype.onAdd.call(this,e),Qr.reqRedPt([281,282,283]);var t=ms.create(this,this.redPtUpdate,null,!1);Qr.ins.addListener("BTN_PET_MAIN",[281],t),Qr.ins.addListener("BTN_PET_TUNSHI",[282],t),Qr.ins.addListener("BTN_PET_SHOP",[283],t)},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.updateByVSC=function(e){this.vsc.selectedView&&this.vsc.selectedView.updateByVSC&&(this.vsc.invalid(),this.vsc.selectedView.updateByVSC(e))},t.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,i.prototype.destroy.call(this,e)},e}(jr),Hh=function(e){function t(){this._eff=null,this._tweener=null,t.__super.call(this)}u(t,"modules.pet.views.PetOpenTip",Yt);var i=t.prototype;return i.onBtnEntrance=function(e){this.close();var t=new Ha;t.packId=30982,Fl.sendToService(t)},i.close=function(){var e=this;if(e.x=Y.stage.width-e.width>>1,e.y=Y.stage.height-e.height>>1,e.centerX=NaN,e.centerY=NaN,e.parent){var t=new is(130,387);null!=e._tweener&&e._tweener.clear(),e._tweener=Yl.to(e,{x:t.x,y:t.y,scaleX:0,scaleY:0,alpha:0},800,G.sineOut,ms.create(e,e.onComplete))}null!=e._eff&&(e._eff.removeSelf(),e._eff.dispose(),e._eff=null),e.off("click",e,e.onBtnEntrance)},i.onComplete=function(){this.parent&&(Zl.panelLayer?Zl.panelLayer.close(this):this.parent.removeChild(this))},i.show=function(){var e=this;e.imgTitle.skin=Or.getNoClearImage("cwud_text_fhcwd"),e.imgRight.skin=Or.getNoClearImage2("cwud_hb_2.jpg"),e.imgLeft.skin=Or.getNoClearImage2("cwud_hb_1.jpg"),e.parent||(Zl.panelLayer?Zl.panelLayer.open(e,!1,!0,!1):Y.stage.addChild(e),null==e._eff?(e._eff=ti.createEffect("jm1130",e.btnEntrance.width>>1,e.btnEntrance.height>>1,e.btnEntrance),e._eff.scale_X=1.25,e._eff.scale_Y=1.25):e.btnEntrance.addChild(e._eff),e.onResize()),e.x=NaN,e.y=NaN,e.alpha=1,e.scale(1,1),e.centerX=0,e.centerY=0,e.on("click",e,e.onBtnEntrance)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.imgTitle&&t.imgTitle.skin&&Y.loader.clearRes(t.imgTitle.skin),t.imgLeft&&t.imgLeft.skin&&Y.loader.clearRes(t.imgLeft.skin),t.imgRight&&t.imgRight.skin&&Y.loader.clearRes(t.imgRight.skin),laya.ui.View.prototype.destroy.call(t,e)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.pet.PetOpenTipUI._$SET_ins),t._ins=null,t}(),Fh=function(e){function t(){var e=this;e._avatar=null,e._cdTime=-1,e.BAR_W=0,e._vo=null,t.__super.call(e),e.right=135,e.bottom=309,e.BAR_W=e.imgBar.width,e.imgBar.mask=e.rectBar,e.rectBar.x=-e.BAR_W}u(t,"modules.pet.views.PetPopTip",Dr);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_bg.skin=Or.getNoClearImage("cw_cwdsj_bg"),this.update()},i.onLoop=function(){this._cdTime--,this._cdTime<0&&(Y.timer.clearAll(this),On.ins.close("PETPOPTIP"),Eh.shouldOpenPop=!1)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.img_bg.skin=null,this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),0<this._cdTime&&Eh.ins().setPopTime(this._cdTime)},i.destroy=function(e){void 0===e&&(e=!0),this.img_bg&&this.img_bg.skin&&Y.loader.clearRes(this.img_bg.skin),laya.ui.View.prototype.destroy.call(this,e)},i.update=function(e){var t=this;void 0===e&&(e=!0);var i=0;if(t._cdTime=Eh.ins().popLeftTime,-5==t._cdTime&&(i=Ta.getIndex(326),t._cdTime=parseInt(Ta.MODEL.value(i))),t._vo=Eh.ins().petEggDropVo,!t._vo||!t._vo.desc)return On.ins.close("PETPOPTIP"),void(Eh.shouldOpenPop=!1);Y.timer.clearAll(t),Y.timer.loop(1e3,t,t.onLoop);var s=t._vo.desc;t._avatar&&(t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(138,110),t.addChild(t._avatar),t._avatar.mid=t._vo.model,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",t._vo.model,!0),t._avatar.setDir(4),t._avatar.mat.identity(),t._avatar.mat.scale(.9,.9),t.htmlDesc.innerHTML=s.replace("X",(t._vo.maxPro-t._vo.curValue).toString()),t.htmlPro.innerHTML=ed.n[1787]+"("+t._vo.curValue+"/"+t._vo.maxPro+")",t.updateBar()},i.updateBar=function(){var e=this._vo.curValue/this._vo.maxPro*this.BAR_W;Yl.to(this.rectBar,{x:-this.BAR_W+e},100,null,ms.create(this,this.tweenDown))},i.tweenDown=function(){Yl.clearAll(this.rectBar)},t.NAME="PETPOPTIP",t}(),zh=function(e){function t(){var e=this;e.giftArr=null,e.selectId=0,e.costId=0,e.costNum=0,e.awardArr=[],e.textArr=[],e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,t.__super.call(e)}u(t,"modules.pet.views.PetShopView",oi);var i=t.prototype;return i.updateByVSC=function(e){e&&"30977"==e.actionOrder&&(this.selectId=0,this.updateView())},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.redImg_0.visible=!1,t.redImg_1.visible=!1,t.gift1.on("click",t,t.onClick),t.gift2.on("click",t,t.onClick),t.buy_btn.on("click",t,t.onClick),t.giftArr=[],t.initView(),t.updateView(),Fl.sendToModule("PETBAR_SELECTED",["modules.pet.PetModule"])},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.clearAvator(),t.clearAvator2(),Y.timer.clearAll(t),t.gift1.on("click",t,t.onClick),t.gift2.on("click",t,t.onClick),t.buy_btn.on("click",t,t.onClick),Eh.isPetTrain=!1},i.updateMoney=function(){this.updateRedPoint()},i.onClick=function(e){var t=this;t.giftArr&&0<t.giftArr.length&&(e.target==t.gift1?(t.selectId=t.giftArr[0],t.selcet.x=t.gift1.x,t.setAward(),Eh.isPetTrain=!1):e.target==t.gift2?(t.selectId=t.giftArr[1],t.selcet.x=t.gift2.x,t.setAward(),Eh.isPetTrain=!1):e.target==t.buy_btn&&t.buyHandler())},i.buyHandler=function(){var e=Ls.MODEL.consumptionDef(Ls.getIndex(this.selectId)),t=JSON.parse(e);if(this.costId=parseInt(t[0].value.split(":")[0]),this.costNum=parseInt(t[0].value.split(":")[1]),this.costNum>Gi.ins.YB)ja.ins.showNoGold();else{var i=new ul;i.giftid=this.selectId,Fl.sendToService(i)}},i.initView=function(){if(0<Ls.count)for(var e=0;e<Ls.count;e++)this.giftArr.push(Ls.MODEL.key(e))},i.updateView=function(){var e=this;e.img_ygm1.visible=e.img_ygm2.visible=!1;var t=0;if(e.selcet.visible=!0,Eh.ins().petShopdata&&Eh.ins().petShopdata.giftArr){var i=Eh.ins().petShopdata.giftArr;if(0<i.length){if(0==e.selectId){if(Eh.isPetTrain)e.selectId=e.giftArr[1],e.selcet.x=e.gift2.x;else for(t=0;t<e.giftArr.length;t++)if(i.indexOf(e.giftArr[t])<0){e.selectId=e.giftArr[t],e.selcet.x=e["gift"+(t+1)].x;break}e.setAward()}for(t=0;t<i.length;t++)if(0<=e.giftArr.indexOf(i[t])){var s=i[t].toString();e["gift"+s].gray=!0,e["img_ygm"+s].visible=!0}i.length==Ls.count&&(e.selcet.visible=!1,e.buy_btn.disabled=!0)}else Eh.isPetTrain?(e.selectId=e.giftArr[1],e.selcet.x=e.gift2.x):(e.selectId=e.giftArr[0],e.selcet.x=e.gift1.x),e.setAward()}e.updateRedPoint()},i.setAward=function(){var e=this,t=Ls.MODEL.rewardDef(Ls.getIndex(e.selectId));if(t){for(var i=JSON.parse(t),s=0;s<i.length;s++)if(!e.awardArr[s]){var n=new ra(116);n.x=88+147*s,n.y=759,e.addChild(n),e.awardArr.push(n);var o=new Nr;o.x=n.x-13,o.y=n.y+116,o.font="SimHei",o.width=135,o.align="center",o.fontSize=20,e.addChild(o),e.textArr.push(o)}for(s=0;s<i.length;s++){var a=i[s].value.split(":");e.setGodEquipStar(a[0],a[1],s)}}switch(e.selectId){case 1:e.img_des.skin=Or.getPetPath("cw_text_scbxcz");break;case 2:e.img_des.skin=Or.getPetPath("cw_text_cwfscz")}-1!=Eh.ins().petShopdata.giftArr.indexOf(e.selectId)?(e.buy_btn.disabled=!0,e.buy_btn.label="已购买"):(e.buy_btn.disabled=!1,e.buy_btn.label=ed.n[1788]),e.setAvatar(e.selectId)},i.setGodEquipStar=function(e,t,i){var s=an.create(e,t);this.awardArr[i].bindData=s,this.textArr[i].text=s.simpleName,this.textArr[i].color=Co.getByQuality(s.colourId)},i.setAvatar=function(e){var t=this;switch(t.clearAvator(),t.clearAvator2(),e){case 1:t.modeleff1="jm1619",t.modeleff2="jm1620";break;case 2:t.modeleff1="jm1623",t.modeleff2="jm1624"}t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.loadEffect(t.modeleff1),t._avatar.scale_X=t._avatar.scale_Y=.7,t._avatar.pos(360,420)},i.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.loadEffect(e.modeleff2),e._avatar2.scale_X=e._avatar2.scale_Y=.7,e._avatar2.pos(360,420)},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.updateRedPoint=function(){var e=0;for(e=0;e<this.giftArr.length;e++){if(Eh.ins().petShopdata.giftArr.indexOf(this.giftArr[e])<0){var t=Ls.MODEL.consumptionDef(Ls.getIndex(this.giftArr[e])),i=JSON.parse(t),s=parseInt(i[0].value.split(":")[1]);this["redImg_"+e].visible=s<=Gi.ins.YB,this.buy_btn.showTip=s<=Gi.ins.YB}else this["redImg_"+e].visible=!1,this.buy_btn.showTip=!1}},t}(),Wh=function(e){function t(){var e=this;e.attrArr=[],e._data=null,e._skillId=0,e._buffId=0,e._skillgrid=null,e._sbox=null,e._buffIcon=null,e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,e.footEff=null,e.footEffSt=0,t.__super.call(e);e._skillgrid=new Tt,e._skillgrid.pos(e.skillimg.x,e.skillimg.y),e.addChild(e._skillgrid),e.addChild(e.img_zhu),e._buffIcon=new Dl,e._buffIcon.width=e._buffIcon.height=105,e._buffIcon.pos(e.buffimg.x+5,e.buffimg.y+5),e.addChild(e._buffIcon),e.addChild(e.img_tian)}u(t,"modules.pet.views.PetTips",Do);var i=t.prototype;return Y.imps(i,{"modules.backpack.views.tip.IToolTip":!0}),i.show=function(e){var t=this;if(e){t.tipsbg.skin=Or.getFullUrl("ui/images/pet/cw_tips_bg.jpg");var i=e;t._data=i,t.txt_name.changeText(i.name),t.txt_level.changeText("Lv."+i.petLevel),t.txt_zizhi.changeText("资质："+i.zizhi),t.txt_grow.changeText("成长："+i.grow),t.updateAttr(),t.fc_value.value=t.fc_value.value=Eh.ins().getFlghtValue(t._data).toString(),t.img_color.skin=Eh.ins().getColorSkinByPZ(t._data.petColor),t.img_quality.skin=Eh.ins().getSkinByPZ(t._data.petColor);var s=Eh.ins().getStarIndexByPro(t._data.petId,t._data.petStar),n=Zs.MODEL.skillsNow(s);if(!n){var o=Zs.MODEL.skillsNext(s).split(",");n=parseInt(o[1])}t._skillgrid.bindData=n;var a=O.getIndex(n);t.txt_skill1.changeText(O.MODEL.name(a)),t.txt_skilldes1.innerHTML=O.MODEL.desc(a),t.txt_getway.visible=!1;var r=sr.MODEL.roleBuffs(Eh.ins().getColorIndexByPro(t._data.petId,t._data.petColor));if(r){var l=r.split(",");t._skillId=parseInt(l[0]);var c=Ki.getIndex(t._skillId);t.txt_skill2.changeText(Ki.MODEL.skillName(c)),t.txt_skilldes2.innerHTML=Ki.MODEL.skillDesc(c),t._buffIcon.skin=Or.getIconPath(Ki.MODEL.icon(c))}t.showLevel(),t.setAvatar(2)}t.parent||(Zl.panelLayer.on("MASK_CLOSE",t,t.onClick),Zl.panelLayer.openTip(t))},i.showLevel=function(){var e=this;if(null!=e._data){var t=0,i=e._data.petStar<10?0:1;for(t=0;t<10;t++)e["img_x"+t].skin=Or.getAtlasSubPath("base_ui2/g_level_"+i+"_1.png");e._sbox&&e._sbox.graphics.clear(),e._sbox||(e._sbox=new gl,e._sbox.pos(0,0),e.boxStar.addChild(e._sbox));var s,n;if(n=Or.getAtlasSubPath("base_ui2/g_level_"+i+"_0.png"),s=Y.loader.getRes(n),e._data.petStar<10)for(t=0;t<e._data.petStar;t++)e._sbox.graphics.drawTextures(s,[53*t,0]);else for(t=0;t<e._data.petStar-10;t++)e._sbox.graphics.drawTextures(s,[53*t,0])}},i.updateAttr=function(){if(this._data){var e=0,t=Eh.ins().getStarIndexByPro(this._data.petId,this._data.petStar),i=Zs.MODEL.attrPre(t)/1e4,s=Eh.ins().getPetAttr(this._data,i);for(e=0;e<s.length;e++)this["item_"+e].txt_name.text=s[e].attrName,this["item_"+e].txt_value.text=s[e].attrValue,this["item_"+e].txt_value.color="#23b11f"}},i.close=function(e){var t=this;(void 0===e&&(e=!1),t.clearAvator(),t.clearAvator2(),Y.timer.clearAll(t),e)?!Zl.panelLayer.closeTip(t)&&Zl.panelLayer.close(t):Zl.panelLayer.close(t);t.tipsbg&&t.tipsbg.skin&&(Y.loader.clearRes(t.tipsbg.skin),t.tipsbg.skin="")},i.onClick=function(e){this.close(!0)},i.setAvatar=function(e){var t=this;if(t.clearAvator(),null!=t._data){var i,s=0;if(i=1==e?gt.MODEL.interfaceModel(gt.getIndex(t._data.eggId)):(s=Eh.ins().getPetIndexByPro(t._data.petId,t._data.petColor),$r.MODEL.interfaceModel(s))){var n=i.split(",");t.modeleff1=n[0],t.modeleff2=n[1]}t.footEffSt=jl.MODEL.awayEffect(jl.getIndex(t._data.petStar+1)),t.footEffSt&&(t.clearFootEFF(),t.footEff=new Es,t.footEff.renderInSelf=!0,t.addChild(t.footEff),t.footEff.loadEffect("jm"+t.footEffSt),t.footEff.scale_X=1.2,t.footEff.scale_Y=.55,t.footEff.pos(280,320)),t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.scale_X=t._avatar.scale_Y=.5,t._avatar.loadEffect(t.modeleff1),t._avatar.pos(280,Eh.ins().getTipsEffY(t.modeleff1))}},i.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.scale_X=e._avatar2.scale_Y=.5,e._avatar2.loadEffect(e.modeleff2),e._avatar2.pos(280,Eh.ins().getTipsEffY(e.modeleff2))},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.clearFootEFF=function(){this.footEff&&(this.footEff.parent&&this.footEff.parent.removeChild(this.footEff),this.footEff.playEndHandler=null,this.footEff.forceDestory(),this.footEff=null)},n(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance},layouts.pet.PetTipUI._$SET_instance),t._instance=null,t}(),jh=function(e){function t(){t.__super.call(this),this.initUI()}u(t,"modules.pet.views.PetTunShiSelectView",Wt);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClickHandler),t.link_get.on("click",t,t.onClick),t.list.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClickHandler),t.link_get.off("click",t,t.onClick),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.onClickHandler=function(e){On.ins.close("PET_TUNSHI_LIST_VIEW")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.updateData=function(e){var t=e.petIndex.split(",");2==e.type?this.txt_no.text=ed.n[1789]:1==e.type&&(this.txt_no.text=ed.n[1790]);for(var i,s,n=Eh.ins().petdata.petArr,o=[],a=0;a<n.length;a++)2==(i=n[a]).gridState&&-1==t.indexOf(i.index.toString())&&((s=new Object).type=e.type,s.vo=i,o.push(s));o.sort(this.onSortByStar),this.list.array=o,this.g_mask.visible=this.txt_no.visible=o.length<1},i.onSortByStar=function(e,t){var i=e.vo,s=t.vo;return i.petStar>s.petStar?-1:i.petStar==s.petStar?i.zizhi>s.zizhi?-1:i.zizhi==s.zizhi?0:1:1},i.initUI=function(){this.list.itemRender=Bh,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,Bi.optimizeList(this.list,Bh)},i.onClick=function(){On.ins.close("PET_TUNSHI_LIST_VIEW"),0==Eh.ins().gift1IsFinish()?Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:4}):On.ins.open("BOSS_MAINVIEW",{_subIndex_:1},0,!0)},t}(),qh=function(e){function t(){var e=this;e._sbox=null,e._petData=null,e.petBar=null,e._BAR_W=538,e._effect=null,e._effId="",e._upStep=!1,e._upStar=!1,e._tween=null,e._nextPetInfo=null,e.tools=null,e.selectedIndex=-1,e.petItem=null,e.tunshiOkEfc=null,e.petVO=null,e.petVO_c=null,e.imgNextSKill=null,e.petStar=0,e.nextPetIndex=0,e.skillEff=null,e.skillEffSt=null,e.successEft=null,e.isEnoughTools=!1,e.effStar=null,e._avatar=null,e._avatar2=null,e.modeleff1=null,e.modeleff2=null,e.footEff=null,e.footEffSt=0,e._flys=new Array,t.__super.call(e),e._petData=Eh.ins(),e.initUI()}u(t,"modules.pet.views.PetTunshiView",Vt);var i=t.prototype;return i.destroy=function(e){var t=this;void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(t,e),t.imgNextSKill&&(t.imgNextSKill.off("click",t,t.onClickSkill),t.imgNextSKill.parent&&t.imgNextSKill.parent.removeChild(t.imgNextSKill),t.imgNextSKill.skin="",t.imgNextSKill=null),t.tools&&(t.tools.parent&&t.tools.parent.removeChild(t.tools),t.tools=null)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.txt_oName.text="",t.txt_oLv.text="",t.nextPetIndex=0,t.petBar.updatePet(),t.btn_ts.on("click",t,t.onclickTS),t.btn_sx.on("click",t,t.onclickSX),t.img_xzhe.on("click",t,t.onclickXZ),t.petBar.on("select",t,t.onSelectPet),t.btn_change.on("click",t,t.onclickXZ),-1==Eh.ins().curSelectIndex&&(0<t._petData.petdata.petArr.length?Eh.ins().curSelectIndex=t._petData.petdata.petArr[0].index:Eh.ins().curSelectIndex=0),t.updateSelectView(Eh.ins().curSelectIndex),t.btn_desc.on("click",t,t.onClickDesc),t.txt_desc.on("click",t,t.onClickDesc),-1==t.petBar.selectIdx&&(t.petBar.selectIdx=0)},i.onRemove=function(e){var t=this;for(ui.ViewBase.prototype.onRemove.call(t,e),t.timer.clearAll(t),t.clearAvator(),t.btn_ts.off("click",t,t.onclickTS),t.btn_sx.off("click",t,t.onclickSX),t.btn_desc.off("click",t,t.onClickDesc),t.txt_desc.off("click",t,t.onClickDesc),t.img_xzhe.off("click",t,t.onclickXZ),t.petBar.off("select",t,t.onSelectPet),t.btn_change.off("click",t,t.onclickXZ),t.clearAvator(),t.clearAvator2(),t.tunshiOkEfc&&(t.tunshiOkEfc.parent&&t.tunshiOkEfc.parent.removeChild(t.tunshiOkEfc),t.tunshiOkEfc.dispose(),t.tunshiOkEfc=null),t.successEft&&(t.successEft.parent&&t.successEft.parent.removeChild(t.successEft),t.successEft.dispose(),t.successEft=null),Y.timer.clearAll(t),t.selectedIndex=-1,t.petVO_c=null,t._upStar=t.isEnoughTools=!1,t.clearStarEff();0<t._flys.length;){var i=t._flys.shift();i&&(Yl.clearAll(i),i.dispose(),i=null)}null!=t.petItem&&(t.petItem.parent&&t.petItem.parent.removeChild(t.petItem),t.petItem=null),t.clearEft(),ja.ins.parent&&ja.ins.close()},i.updateByVSC=function(e){e&&"30972"==e.actionOrder&&(this.petBar.updatePet(),this.updateSelectView(Eh.ins().curSelectIndex))},i.setTSPet=function(e){var t=this;e&&(t.petVO_c=e,t.txt_fc.text="",null==t.petItem&&(t.petItem=new Ph),null==t.petItem.parent&&t.box_main.addChild(t.petItem),t.petItem.dataSource=e,t.petItem.showName(!1),t.petItem.x=t.img_xzhe.x,t.petItem.y=t.img_xzhe.y,t.petItem.mouseEnabled=!1,t.btn_change.visible=!0)},i.updateTools=function(){var e=this;if(e.petVO&&e.box_up.visible){var t=e._petData.getStarIndexByPro(e.petVO.petId,e.petVO.petStar),i=Zs.MODEL.upgradeStarConsumptionDef(t);if(i){var s=JSON.parse(i)[0].value,n=s.split(":")[0],o=s.split(":")[1],a=ri.ins.getGoodsNum(n);e.tools.bindData=an.create(n),e.trxt_has.innerHTML=o<=a?"<font style='color:#23b11f;'>"+a+"</font>/"+o:"<font style='color:#ff2e24;'>"+a+"</font>/"+o,e.isEnoughTools=o<=a}e.btn_sx.showTip=e.isEnoughTools,e.petBar.setSXPoint()}},i.success=function(){var e=this;if(Eh.ins().petdata.petArr&&(e._upStar=!1,e.petVO)){for(var t=0;t<e._petData.petdata.petArr.length;t++)if(e.petVO.index==e._petData.petdata.petArr[t].index){e.petVO.petStar>e.petStar&&(e._upStar=!0);break}if(e._nextPetInfo){var i=e._petData.getProByIndex(e.petVO.petColor,e.petVO.petId,e.petVO.petStar);i&&(e.petVO.lvStarUpExp=i.maxStarExp)}}e.btn_change.visible=!1,e.txt_fc.text=ed.n[1791],e.showTunShiEffect(),e.showUpStar(),e._upStar&&(e.updateSelectView(e.selectedIndex),e.showUpEffect())},i.onClickDesc=function(e){var t=po.MODEL.description(po.getIndex(38));On.ins.open("AE_EXPLAIN_VIEW",{desc:t})},i.onSelectPet=function(){var e=this;e._petData.petdata.petArr.length>e.petBar.selectIdx&&(2==e._petData.petdata.petArr[e.petBar.selectIdx].gridState?(null!=e.petItem&&(e.petItem.parent&&e.petItem.parent.removeChild(e.petItem),e.petItem=null),e.petVO_c&&(e.petVO_c=null),Eh.ins().curSelectIndex=e.petBar.getSelectIndex(),e.updateSelectView(Eh.ins().curSelectIndex)):Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:0}))},i.updateSelectView=function(e){var t=this;if(Y.timer.clear(t,t.effEnd),t.clearAvator(),t.clearAvator2(),t.btn_change.visible=!1,t.selectedIndex=e,0<t._petData.petdata.petArr.length){for(var i=0;i<t._petData.petdata.petArr.length;i++)e==t._petData.petdata.petArr[i].index&&(t.petVO=t._petData.petdata.petArr[i]);if(t.petVO&&2==t.petVO.gridState){t.fc_value.value=t._petData.getFlghtValue(t.petVO).toString();var s=t._petData.getProByIndex(t.petVO.petColor,t.petVO.petId,t.petVO.petStar);t.setAvatar(2),t.showLevel(),t.txt_nAttr.visible=t.txt_nZz.visible=t.img_jt.visible=!t.petVO.isTop,t.txt_cAttr.text=s.attr,t.txt_cZz.text=t.petVO.zizhi.toString(),t.petVO.isTop||(t._nextPetInfo=t._petData.getProByIndex(t.petVO.petColor,t.petVO.petId,t.petVO.petStar+1),t._nextPetInfo&&(t.petVO.lvStarUpExp=s.maxStarExp,t.txt_nAttr.text=t._nextPetInfo.attr,t.txt_nZz.text=t.petVO.zizhi+t._nextPetInfo.zizhiAdd+"")),t.showBarChange(),t.showUpStar(),t.showSkill(),s=null}else t.petVO&&1==t.petVO.gridState&&(Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:0}),Eh.ins().curSelectIndex=-1)}},i.onclickTS=function(e){var t=this;t.petVO&&t.petVO_c?t.petVO_c.zizhi>t.petVO.zizhi?t._petData.tsNoTips?(t.petStar=t.petVO.petStar,t._petData.sendTs(t.petVO.index,t.petVO_c.index,1)):ja.ins.show(ed.n[1792],ms.create(t,t.onSure),!1,3,ed.n[1793],null,!0,0):(t.petStar=t.petVO.petStar,t._petData.sendTs(t.petVO.index,t.petVO_c.index,1)):Vl.ins.showMsg(ed.n[1794],1)},i.onSure=function(e,t){void 0===t&&(t=!1),1==e?Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:3}):0==e&&(this.petStar=this.petVO.petStar,this._petData.sendTs(this.petVO.index,this.petVO_c.index,1))},i.onclickSX=function(e){this.petVO&&(this.petStar=this.petVO.petStar,this.isEnoughTools?this._petData.sendSx(this.petVO.index,3):Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1502,max:-1}))},i.onclickXZ=function(e){var t="";this.petVO&&(t=this.petVO.index.toString(),this.petVO_c&&(t+=","+this.petVO_c.index),Fl.sendToModule("PET_TUNSHI_S_VIEW",["modules.pet.PetModule"],{petIndex:t,type:2}))},i.showSkill=function(){var e=this,t=e._petData.getStarIndexByPro(e.petVO.petId,e.petVO.petStar),i="";if(i=e.petVO.isTop?Zs.MODEL.skillsNext(e._petData.getStarIndexByPro(e.petVO.petId,e.petVO.petStar-1)):Zs.MODEL.skillsNext(t)){e.nextPetIndex=parseInt(i.split(",")[0]),e.petVO.isTop?e.txt_open.text="已满级":e.txt_open.text=e.nextPetIndex+"星解锁";var s=O.getIndex(parseInt(i.split(",")[1])),n=O.MODEL.icon(s);null==e.imgNextSKill&&(e.imgNextSKill=new Dl,e.imgNextSKill.width=e.imgNextSKill.height=70),e.labSkillName.text=O.MODEL.name(s),e.labSkillName.y=663,e.imgNextSKill.parent||e.box_main.addChild(e.imgNextSKill),e.imgNextSKill.x=e.img_nskill.x+2,e.imgNextSKill.y=e.img_nskill.y+2,e.imgNextSKill.skin=Or.getIconPath(n),e.imgNextSKill.on("click",e,e.onClickSkill);var o=Zs.MODEL.effectId($r.getIndex(e.petVO.petId));o||e.clearEffect1(),o!=e.skillEffSt&&(e.skillEffSt=o,e.clearEffect1(),e.skillEff=Es.GetNew(),e.skillEff.renderInSelf=!0,e.box_main.addChild(e.skillEff),e.skillEff.loadEffect(e.skillEffSt),e.skillEff.pos(e.img_nskill.x+37,e.img_nskill.y+37),e.skillEff.mat.scale(.66,.66))}},i.clearEffect1=function(){this.skillEff&&(this.skillEff.parent&&this.skillEff.parent.removeChild(this.skillEff),this.skillEff.dispose(),this.skillEff=null)},i.onClickSkill=function(e){e.target==this.imgNextSKill&&td.instance.show(this.petVO)},i.showUpEffect=function(){this.successEft&&(this.successEft.parent&&this.successEft.parent.removeChild(this.successEft),this.successEft.dispose(),this.successEft=null),this.successEft=ti.createEffect("jm1590",350,300,this.box_main),this.successEft.renderInSelf=!0},i.showUpStar=function(){var e=this;if(e.petVO)if(e.petVO.isTop)e.img_lock.visible=!0,e.img_xzhe.visible=e.box_up.visible=!1,e.btn_ts.visible=e.btn_ts.disabled=!0,e.btn_ts.label="已满星",e.txt_fc.text=ed.n[1795];else if(e.btn_ts.label="吞  噬",e.txt_fc.text=ed.n[1791],e.img_xzhe.visible=!0,e.img_lock.visible=e.btn_ts.disabled=!1,e.petVO.petStarExp>=e.petVO.lvStarUpExp){e.img_lock.visible=!0,e.img_xzhe.visible=e.btn_ts.visible=!1,e.box_up.visible=!0,e.txt_fc.text=ed.n[1797],null==e.tools&&(e.tools=new ra(45)),null==e.tools.parent&&e.box_up.addChild(e.tools),e.tools.x=e.img_tools.x,e.tools.y=e.img_tools.y,e.tools.needGridBg=!1,e.tools.needEffect=!1;var t=e._petData.getStarIndexByPro(e.petVO.petId,e.petVO.petStar),i=Zs.MODEL.upgradeStarConsumptionDef(t);if(i){var s=JSON.parse(i)[0].value,n=s.split(":")[0],o=s.split(":")[1],a=ri.ins.getGoodsNum(n);e.tools.bindData=an.create(n),e.trxt_has.innerHTML=o<=a?"<font style='color:#23b11f;'>"+a+"</font>/"+o:"<font style='color:#ff2e24;'>"+a+"</font>/"+o,e.isEnoughTools=o<=a,e.btn_sx.showTip=e.isEnoughTools}}else e.btn_ts.disabled=e.box_up.visible=!1,e.btn_ts.visible=!0},i.showLevel=function(){var e=this;if(null!=e.petVO){var t=0,i=e.petVO.petStar<10?0:1;for(t=0;t<10;t++)e["img_x"+t].skin=Or.getAtlasSubPath("base_ui2/g_level_"+i+"_1.png");e._sbox&&e._sbox.graphics.clear(),e._sbox||(e._sbox=new gl,e._sbox.pos(0,0),e.box_star.addChild(e._sbox));var s,n;if(n=Or.getAtlasSubPath("base_ui2/g_level_"+i+"_0.png"),s=Y.loader.getRes(n),e.petVO.petStar<10)for(t=0;t<e.petVO.petStar;t++)e._sbox.graphics.drawTextures(s,[53*t,0]);else for(t=0;t<e.petVO.petStar-10;t++)e._sbox.graphics.drawTextures(s,[53*t,0])}},i.showTunShiEffect=function(){var t=this;if(this.clearEft(),this._upStar)this.showBarChange();else{var i=new is(20+(this.img_lock.x+this.img_lock.width>>1),430+(this.img_lock.y+this.img_lock.height>>1)),s=new is(80+(this.imgBar.x+this.imgBar.width>>1),790+(this.imgBar.y+this.imgBar.height>>1)),e=ti.createEffect("jm1588",i.x-30,i.y-30,this.box_main);this._flys.push(e),Yl.to(e,{x:s.x,y:s.y},300,Kn.easeIn,ms.create(this,this.playEffEnd)),this.timer.once(20,this,function(){var e=ti.createEffect("jm1588",i.x+30,i.y-30,t.box_main);Yl.to(e,{x:s.x,y:s.y},300,Le.easeIn,ms.create(this,t.playEffEnd)),t._flys.push(e)}),this.timer.once(70,this,function(){var e=ti.createEffect("jm1588",i.x-30,i.y+30,t.box_main);Yl.to(e,{x:s.x,y:s.y},300,Kn.easeOut,ms.create(this,t.playEffEnd)),t._flys.push(e)}),this.timer.once(120,this,function(){var e=ti.createEffect("jm1588",i.x+30,i.y+30,t.box_main);Yl.to(e,{x:s.x,y:s.y},300,Le.easeInOut,ms.create(this,t.playEffEnd)),t._flys.push(e)}),this.timer.once(160,this,function(){var e=ti.createEffect("jm1588",i.x,i.y,t.box_main);Yl.to(e,{x:s.x,y:s.y},300,Kn.easeIn,ms.create(this,t.playEffEnd)),t._flys.push(e)})}this.petVO_c&&(this.petVO_c=null),null!=this.petItem&&(this.petItem.parent&&this.petItem.parent.removeChild(this.petItem),this.petItem=null)},i.playEffEnd=function(){var e=this,t=e._flys.shift();t&&(Yl.clearAll(t),t.dispose(),t=null,e._flys.length<=0&&(e.tunshiOkEfc=ti.createEffect("jm1589",80+(e.imgBar.x+e.imgBar.width>>1),790+(e.imgBar.y+e.imgBar.height>>1),e.box_main),e.tunshiOkEfc.renderInSelf=!0,e.showBarChange()))},i.showBarChange=function(){this.showBar()},i.clearEft=function(){for(;0<this._flys.length;){var e=this._flys.shift();Yl.clearAll(e),e.dispose(),e=null}},i.showBar=function(e){var t=this;void 0===e&&(e=!0),t.txt_progress.text=t.petVO.petStarExp+"/"+t.petVO.lvStarUpExp;var i=0==t.petVO.petStarExp?0:t.petVO.petStarExp/t.petVO.lvStarUpExp;1<i&&(i=1),e?(t._tween&&t._tween.clear(),t._tween=null,t._upStar?t._tween=Yl.to(t.bar_mask,{x:0},100,null,ms.create(t,t.onT),0,!1,!1):t._tween=Yl.to(t.bar_mask,{x:-t._BAR_W+i*t._BAR_W},100,null,ms.create(t,t.onEnd),0,!1,!1)):(t.bar_mask.repaint(),t.bar_mask.x=-t._BAR_W+i*t._BAR_W)},i.onT=function(){var e=this;e._upStar=!1,e.bar_mask.repaint(),e.setStar(),e.petVO&&!e.petVO.isTop?(e.bar_mask.x=-e._BAR_W,e.showBar()):(e._tween&&e._tween.clear(),e._tween=null)},i.onEnd=function(){this._upStep=!1,this._upStar=!1,this.showBar(!0),this._tween&&this._tween.clear(),this._tween=null},i.setStar=function(){this.clearStarEff(),this.effStar||(this.effStar=ti.createEffect("jm1217",53*this.petVO.petStar-31,23,this.box_star)),Y.timer.once(100,this,this.showLevel)},i.clearStarEff=function(){this.effStar&&(this.effStar.parent&&this.effStar.parent.removeChild(this.effStar),this.effStar.dispose(),this.effStar=null)},i.setAvatar=function(e){var t=this;if(t.clearAvator(),null!=t.petVO){var i,s=0;i=1==e?gt.MODEL.interfaceModel(gt.getIndex(t.petVO.eggId)):(s=Eh.ins().getPetIndexByPro(t.petVO.petId,t.petVO.petColor),$r.MODEL.interfaceModel(s)),s=Xl.getIndex(t.petVO.petModel);Xl.MODEL.muId(s);if(t.pet_name.text=Xl.MODEL.name(s),t.imgQuality.skin=t._petData.getSkinByPZ(t.petVO.petColor),t.imgColor.skin=t._petData.getColorSkinByPZ(t.petVO.petColor),i){var n=i.split(",");t.modeleff1=n[0],t.modeleff2=n[1]}t.footEffSt=jl.MODEL.awayEffect(jl.getIndex(t.petVO.petStar+1)),t.footEffSt&&(t.clearFootEFF(),t.footEff=new Es,t.footEff.renderInSelf=!0,t.addChild(t.footEff),t.footEff.loadEffect("jm"+t.footEffSt),t.footEff.scale_X=1.2,t.footEff.scale_Y=.55,t.footEff.pos(360,670)),t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.loadEffect(t.modeleff1),t._avatar.pos(Eh.ins().getEffX(t.modeleff1),Eh.ins().getEffY(t.modeleff1))}},i.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.loadEffect(e.modeleff2),e._avatar2.pos(Eh.ins().getEffX(e.modeleff2),Eh.ins().getEffY(e.modeleff2))},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.clearFootEFF=function(){this.footEff&&(this.footEff.parent&&this.footEff.parent.removeChild(this.footEff),this.footEff.playEndHandler=null,this.footEff.forceDestory(),this.footEff=null)},i.initUI=function(){this.petBar=new Gh(2),this.petBar.centerX=0,this.petBar.y=80,this.addChild(this.petBar)},t}(),Yh=function(e){function t(){var e=this;e._petData=null,e.petBar=null,e.petVO=null,e.isEnoughTools=!1,e.tools=null,e.btnEffect=null,e.xlSuccessEft=null,e.costToolsID=NaN,e.perSeletIndex=0,e.tween=null,e._avatar=null,e._avatar2=null,e.preEff="",e.modeleff1=null,e.modeleff2=null,e.footEff=null,e.footEffSt=0,t.__super.call(e),e.initUI()}u(t,"modules.pet.views.PetXilianView",Yo);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.petBar.updatePet(),t.petBar.on("select",t,t.onSelectPet),-1==Eh.ins().curSelectIndex&&(0<t._petData.petdata.petArr.length?Eh.ins().curSelectIndex=t._petData.petdata.petArr[0].index:Eh.ins().curSelectIndex=0),t.updateSelectView(Eh.ins().curSelectIndex),t.txt_get.on("click",t,t.onGetTools),t.btn_xl.on("click",t,t.onClickXL),t.btn_desc.on("click",t,t.onClickDesc),t.txt_desc.on("click",t,t.onClickDesc),t.perSeletIndex=0,-1==t.petBar.selectIdx&&(t.petBar.selectIdx=0)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.petBar.off("select",t,t.onSelectPet),t.txt_get.off("click",t,t.onGetTools),t.btn_desc.off("click",t,t.onClickDesc),t.txt_desc.off("click",t,t.onClickDesc),t.btn_xl.off("click",t,t.onClickXL),t.clearAvator(),t.clearAvator2(),t.btnEffect&&(t.btnEffect.parent&&t.btnEffect.parent.removeChild(t.btnEffect),t.btnEffect.dispose(),t.btnEffect=null)},i.success=function(){var e=this;e.tween&&e.tween.clear(),e.tween=null;var t=Eh.ins().petdata.petArr;if(t&&(e.petBar.setData(t),e.petVO))for(var i=0;i<e._petData.petdata.petArr.length;i++)if(e.petVO.index==e._petData.petdata.petArr[i].index){e.petVO=e._petData.petdata.petArr[i];break}e.xlSuccessEft||(e.xlSuccessEft=ti.createEffect("jm1591",e.txt_Allcz.x+18,e.txt_Allcz.y+13,e.box_main),e.xlSuccessEft.scale_X=1.15),e.tween=Yl.to(e.xlSuccessEft,{alpha:0},500,null,ms.create(e,e.onEndFunc)),e.updateSelectView(Eh.ins().curSelectIndex),e.updateAttr()},i.onEndFunc=function(){this.tween&&this.tween.clear(),this.tween=null,this.xlSuccessEft&&this.xlSuccessEft.parent.removeChild(this.xlSuccessEft),this.xlSuccessEft.dispose(),this.xlSuccessEft=null},i.onClickDesc=function(e){var t=po.MODEL.description(po.getIndex(39));On.ins.open("AE_EXPLAIN_VIEW",{desc:t})},i.onSelectPet=function(){this._petData.petdata.petArr.length>this.petBar.selectIdx&&(2==this._petData.petdata.petArr[this.petBar.selectIdx].gridState?(Eh.ins().curSelectIndex=this.petBar.getSelectIndex(),this.updateSelectView(Eh.ins().curSelectIndex)):Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:0}))},i.onClickXL=function(e){this.isEnoughTools?this._petData.xiLianNoTips?this._petData.sendSx(this.petVO.index,4):hn.ins.show(ed.n[1799],ms.create(this,this.onSure),!1,3,null,null,!0,0,!0):Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1503,max:-1})},i.onGetTools=function(e){Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1503,max:-1})},i.onSure=function(e,t){void 0===t&&(t=!1),this._petData.xiLianNoTips=t,1==e&&this._petData.sendSx(this.petVO.index,4)},i.updateByVSC=function(e){e&&"30972"==e.actionOrder&&(this.petBar.updatePet(),this.updateSelectView(Eh.ins().curSelectIndex))},i.updateSelectView=function(e){var t=this;if(0<t._petData.petdata.petArr.length&&-1!=e){for(var i=Eh.ins().petdata.petArr,s=0;s<i.length;s++)e==i[s].index&&(t.petVO=i[s]);if(t.petVO&&2==t.petVO.gridState){t.fc_value.value=t._petData.getFlghtValue(t.petVO).toString();var n=t._petData.getColorIndexByPro(t.petVO.petId,t.petVO.petColor);t.txt_Allcz.text=t.petVO.grow.toFixed(2)+"/"+(sr.MODEL.maxGrow(n)/100).toFixed(2),t.perSeletIndex!=e&&(t.setAvatar(2),t.perSeletIndex=e),t.pet_lv.text=t.petVO.petLevel.toString(),t.showTools(),t.updateAttr()}else t.petVO&&1==t.petVO.gridState&&(Fl.sendToModule("PETOPENVIEW",["modules.pet.PetModule"],{subIndex:0}),Eh.ins().curSelectIndex=-1)}},i.updateAttr=function(){if(this.petVO){var e=0,t=this._petData.getStarIndexByPro(this.petVO.petId,this.petVO.petStar),i=Zs.MODEL.attrPre(t)/1e4,s=this._petData.getPetAttr(this.petVO,i);for(e=0;e<s.length;e++)this["item_"+e].txt_name.text=s[e].attrName,this["item_"+e].txt_value.text=s[e].attrValue,this["item_"+e].txt_value.color="#23b11f"}},i.updateTools=function(){this.showTools()},i.showTools=function(){var e=this,t=$r.getIndex(e.petVO.petId),i=$r.MODEL.xilianConsumptionDef(t);if(i){null==e.tools&&(e.tools=new ra(45)),null==e.tools.parent&&e.box_main.addChild(e.tools),e.tools.x=e.img_tools.x,e.tools.y=e.img_tools.y,e.tools.needGridBg=!1,e.tools.needEffect=!1;var s=JSON.parse(i)[0].value,n=s.split(":")[0],o=s.split(":")[1],a=ri.ins.getGoodsNum(n);e.tools.bindData=an.create(n),e.costToolsID=n,e.txt_tools.innerHTML=o<=a?"<font style='color:#23b11f;'>"+a+"</font>/"+o:"<font style='color:#ff0000;'>"+a+"</font>/"+o,e.isEnoughTools=o<=a,e.isEnoughTools?e.btnEffect||(e.btnEffect=ti.createEffect("jm1130",e.btn_xl.width>>1,e.btn_xl.height>>1,e.btn_xl),e.btnEffect.scale_X=1.25,e.btnEffect.scale_Y=1.25):e.btnEffect&&(e.btnEffect.parent&&e.btnEffect.parent.removeChild(e.btnEffect),e.btnEffect.dispose(),e.btnEffect=null)}},i.setAvatar=function(e){var t=this;if(null!=t.petVO){var i,s=0;i=1==e?gt.MODEL.interfaceModel(gt.getIndex(t.petVO.eggId)):(s=Eh.ins().getPetIndexByPro(t.petVO.petId,t.petVO.petColor),$r.MODEL.interfaceModel(s)),s=Xl.getIndex(t.petVO.petModel);Xl.MODEL.muId(s);if(t.pet_name.text=Xl.MODEL.name(s),t.imgQuality.skin=t._petData.getSkinByPZ(t.petVO.petColor),t.imgColor.skin=t._petData.getColorSkinByPZ(t.petVO.petColor),Y.timer.clear(t,t.effEnd),t.clearAvator(),t.clearAvator2(),i){var n=i.split(",");t.modeleff1=n[0],t.modeleff2=n[1]}t._avatar=new Es,t.footEffSt=jl.MODEL.awayEffect(jl.getIndex(t.petVO.petStar+1)),t.footEffSt&&(t.clearFootEFF(),t.footEff=new Es,t.footEff.renderInSelf=!0,t.addChild(t.footEff),t.footEff.loadEffect("jm"+t.footEffSt),t.footEff.scale_X=1.2,t.footEff.scale_Y=.55,t.footEff.pos(360,670)),t._avatar=new Es,t._avatar.renderInSelf=!0,Y.timer.once(800,t,t.effEnd),t.addChild(t._avatar),t._avatar.loadEffect(t.modeleff1),t._avatar.pos(Eh.ins().getEffX(t.modeleff1),Eh.ins().getEffY(t.modeleff1))}},i.effEnd=function(){var e=this;e.clearAvator2(),e._avatar2=new Es,e._avatar2.renderInSelf=!0,e.addChild(e._avatar2),e._avatar2.loadEffect(e.modeleff2),e._avatar2.pos(Eh.ins().getEffX(e.modeleff2),Eh.ins().getEffY(e.modeleff2))},i.clearAvator=function(){this._avatar&&(this._avatar.parent&&this._avatar.parent.removeChild(this._avatar),this._avatar.playEndHandler=null,this._avatar.forceDestory(),this._avatar=null)},i.clearAvator2=function(){this._avatar2&&(this._avatar2.parent&&this._avatar2.parent.removeChild(this._avatar2),this._avatar2.playEndHandler=null,this._avatar2.forceDestory(),this._avatar2=null)},i.clearFootEFF=function(){this.footEff&&(this.footEff.parent&&this.footEff.parent.removeChild(this.footEff),this.footEff.playEndHandler=null,this.footEff.forceDestory(),this.footEff=null)},i.initUI=function(){this._petData=Eh.ins(),this.petBar=new Gh,this.petBar.centerX=0,this.petBar.y=80,this.addChild(this.petBar)},t}(),Kh=(function(e){function t(){t.__super.call(this),this.addSubscribe(t_,n_,s_,e_,$h,o_,$h,i_),this.subPackages=["10205","12902","12904","12906","12908","12910","12912","12914","12918","12921","12924","12930","12934","12936","12938","12941","12943","12945","12947","12949","12952","12954","12956","12961","12963","12965","12967","12970","12972","12974","12976","12978","12982","12983","12984","12986","12932","23302","23305","23337","23344","12989","12991","12993","12994","12995","30776","BP_UPDATE","12995","OPEN_SHOP_VIEW","30771","30773","30768","30774","GUILD_KUN_RELIVE","GUILD_KUN_OPEN","GUILD_KUN_CLOSE","GUILD_KUN_GROWTH","BP_UPDATE","30781","30783","30784","25016","25017","30846","30847","30848","30849"]}u(t,"modules.guild.GuildModule",Tc)}(),function(){function e(){}u(e,"modules.guild.order.Guild_ServiceOrder"),e.TOC_12902="12902",e.TOC_12904="12904",e.TOC_12906="12906",e.TOC_12908="12908",e.TOC_12910="12910",e.TOC_12912="12912",e.TOC_12914="12914",e.TOC_12918="12918",e.TOC_12921="12921",e.TOC_12924="12924",e.TOC_12930="12930",e.TOC_12934="12934",e.TOC_12936="12936",e.TOC_12938="12938",e.TOC_12941="12941",e.TOC_12943="12943",e.TOC_12945="12945",e.TOC_12947="12947",e.TOC_12949="12949",e.TOC_12952="12952",e.TOC_12954="12954",e.TOC_12956="12956",e.TOC_12961="12961",e.TOC_12963="12963",e.TOC_12965="12965",e.TOC_12967="12967",e.TOC_12970="12970",e.TOC_12972="12972",e.TOC_12974="12974",e.TOC_12976="12976",e.TOC_12978="12978",e.TOC_12982="12982",e.TOC_12983="12983",e.TOC_12984="12984",e.TOC_23302="23302",e.TOC_12986="12986",e.TOC_23337="23337",e.TOC_12932="12932",e.TOC_23344="23344",e.TOC_12989="12989",e.TOC_12991="12991",e.TOC_12993="12993",e.TOC_12994="12994",e.TOC_12995="12995",e.TOC_30776="30776",e.TOC_30771="30771",e.TOC_30773="30773",e.TOC_30768="30768",e.TOC_30774="30774",e.TOC_30781="30781",e.TOC_30783="30783",e.TOC_30784="30784",e.TOC_25016="25016",e.TOC_25017="25017",e.TOC_30846="30846",e.TOC_30847="30847",e.TOC_30848="30848",e.TOC_30849="30849"}(),function(){function e(){var e=this;e.maxTimes=0,e._bossInfo=null,e._leftTimes=0,e.noShow=!1,e._copyId=0,e._playerId=NaN,e._cd=-1,e._missionId=0,e._isCalled=!1,e._helpCopyId=0;var t=Ta.getIndex(208);e.maxTimes=parseInt(Ta.MODEL.value(t))}u(e,"modules.guild.others.GuildCallBossUtils");var t=e.prototype;return t.getTicketIdByLevel=function(e){var t=2130;switch(e){case 0:t=2130;break;case 1:t=2131;break;case 2:t=2132}return t},t.getItemBgNameByLevel=function(e){var t="";switch(e){case 0:t="gh_zh_hbdj_0";break;case 1:t="gh_zh_hbzj_0";break;case 2:t="gh_zh_hbgj_0"}return t},t.getELByLevel=function(e){var t=60;switch(e){case 0:t=60;break;case 1:t=70;break;case 2:t=80}return t},t.setCallBossInfo=function(e){var t=0;if(this._bossInfo&&this._bossInfo.length)for(t=0;t<this._bossInfo.length;t++)this._bossInfo[t]instanceof modules.guild.others.GuildCallBossVo&&Jh.recover(this._bossInfo[t]);for(this._bossInfo=[],t=0;t<e.length;t++)this._bossInfo.push(Jh.create(e[t],t))},t.setCallInfo=function(e){this._copyId=e.missionId,this._playerId=e.callPlayerId},t.startCallCD=function(){this._cd=30,Y.timer.loop(1e3,this,this.loopCD)},t.loopCD=function(){this._cd--,this._cd<0&&Y.timer.clear(this,this.loopCD)},t.reqEnterMission=function(){on.reqEntry(this._missionId)},t.reqAllowHelp=function(e,t,i){this._helpCopyId=e,this.leftTimes<=0?Vl.ins.playErrorMsg(ed.n[1800]):J.dtoEnterScene&&46==J.dtoEnterScene.type?Vl.ins.playErrorMsg(ed.n[1801]):2==ac.Ins().cType||6==ac.Ins().cType?(t.toString()!=Gi.ins.charId&&(this._isCalled=!0),on.reqEntry(e,0,0,t,i)):Vl.ins.playErrorMsg(ed.n[1802])},n(0,t,"leftTimes",function(){return this._leftTimes},function(e){this._leftTimes=e}),n(0,t,"bossInfo",function(){return this._bossInfo}),n(0,t,"cdTime",function(){return this._cd}),n(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e.callFriendCD=30,e}()),Jh=function(){function t(){this.level=0,this.reward=null,this.ticketID=0,this.ticketNum=0,this.missionId=0}return u(t,"modules.guild.others.GuildCallBossVo"),t.create=function(e,t){var i=modules.guild.others.GuildCallBossVo.getNewVo();i.missionId=e;var s=uo.getIndex(e);return i.ticketID=Kh.ins.getTicketIdByLevel(t),i.ticketNum=1,i.reward=uo.MODEL.bossShowAward(s),i.level=t,i},t.destroy=function(e){},t.recover=function(e){3<t._pools.length?modules.guild.others.GuildCallBossVo.destroy(e):(e.ticketID=0,e.level=0,t._pools.push(e))},t.getNewVo=function(){return t._pools.length?t._pools.pop():new t},t._pools=[],t}(),Xh=function(){function e(){this.kunJieNum=0}u(e,"modules.guild.others.Guild_ShopModel");var t=e.prototype;return t.reqGuildShopInfo=function(){var e=new or;Fl.sendToService(e)},t.reqBuyGoods=function(e){var t=new ir;t.index=e,Fl.sendToService(t)},n(0,t,"guildmedal",function(){return 2370}),n(1,e,"ins",function(){return null==e._ins&&(e._ins=new e),e._ins}),e._ins=null,e}(),Qh=function(){function e(){this._skillInfo=null,this._kunVo=null,this._maxStep=-1}u(e,"modules.guild.others.RaiseKunMasterData");var t=e.prototype;return t.initSkillInfo=function(){this._skillInfo={};for(var e=0;e<Xo.count;e++){var t=0,i=0,s=Xo.MODEL.skillCode(e);if(0<s){t=Xo.MODEL.tier(e),i=Xo.MODEL.level(e);var n=1;this._skillInfo[t]?n=2:(n=1,this._skillInfo[t]={});var o=new Zh;o.decode(s),o.pos=n,o.lockStep=t,o.lockStar=i,this._skillInfo[t][i]=o}}},t.updateKunVo=function(e){this._kunVo||(this._kunVo=new zi),this._kunVo.decode(e.index,e.step,e.star),this._skillInfo||this.initSkillInfo();for(var t=e.skills,i=0;i<t.length;i++){var s=t[i];for(var n in this._skillInfo){var o=this._skillInfo[n];for(var a in o){var r=o[a];r.skillType==s.skillType&&r.decode(r.skillType,s.level)}}}},t.getCanSkillOper=function(){var e=this.skillInfo;for(var t in e){var i=e[t];for(var s in i){if(i[s].canOper)return!0}}return!1},t.getSkillFight=function(){var e=0,t=this.skillInfo;for(var i in t){var s=t[i];for(var n in s){e+=s[n].fight}}return e},t.getCanOperSkill=function(){var e,t,i,s=this.skillInfo;for(t in s){if(e)return e;var n=s[t];for(i in n){var o=n[i];if(o.canOper){e=o;break}}}if(!e){var a=s[1];for(i in a){e=a[i];break}}return e},t.getSkillByGoods=function(e){var t,i,s,n=this.skillInfo;for(i in n){if(t)return t;var o=n[i];for(s in o){var a=o[s];if(a){var r=a.consume,l=JSON.parse(r)[0].value.split(":");if(parseInt(l[0])==e.goodsId){t=a;break}}}}if(!t){var c=n[1];for(s in c){t=c[s];break}}return t},t.getSkillIdxByTypeLevel=function(e,t){for(var i=0;i<_.count;i++){var s=_.MODEL.skillCode(i),n=_.MODEL.level(i);if(s==e&&n==t)return i}return-1},t.getMaxStep=function(){for(var e=0;e<Xo.count;e++){var t=Xo.MODEL.tier(e);t>=this._maxStep&&(this._maxStep=t)}},n(0,t,"kunVo",function(){return this._kunVo||(this._kunVo=new zi,this._kunVo.decode(0,1,0)),this._kunVo}),n(0,t,"skillInfo",function(){return this._skillInfo||this.initSkillInfo(),this._skillInfo}),n(0,t,"maxStep",function(){return this._maxStep<0&&this.getMaxStep(),this._maxStep}),n(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e.openSKillVo=null,e}(),Zh=function(){function e(){var e=this;e.skillId=0,e.skillName=null,e.skillDesc=null,e.cfgIdx=0,e.icon=null,e.level=0,e.skillType=0,e.lockStep=0,e.lockStar=0,e.pos=1,e.consume=null,e.fight=0,e.isShowLockInfo=!0}u(e,"modules.guild.others.RaiseKunSkillVo");var t=e.prototype;return t.decode=function(e,t){var i=this;void 0===t&&(t=0),i.level=t,i.cfgIdx=Qh.ins.getSkillIdxByTypeLevel(e,i.level),i.skillId=_.MODEL.buffId(i.cfgIdx),i.skillType=_.MODEL.skillCode(i.cfgIdx),i.consume=_.MODEL.consumptionDef(i.cfgIdx);var s=Ki.getIndex(i.skillId);i.skillName=Ki.MODEL.skillName(s),i.skillDesc=Ki.MODEL.skillDesc(s),i.icon=Ki.MODEL.icon(s),i.fight=Ki.MODEL.fighting(s)},n(0,t,"nextIdx",function(){return Qh.ins.getSkillIdxByTypeLevel(this.skillType,this.level+1)}),n(0,t,"nextDesc",function(){if(-1==this.nextIdx)return null;var e=_.MODEL.buffId(this.nextIdx),t=Ki.getIndex(e);return Ki.MODEL.skillDesc(t)}),n(0,t,"canOper",function(){if(-1==this.nextIdx)return!1;var e=Qh.ins.kunVo;if(e.step<this.lockStep||e.step==this.lockStep&&e.star<this.lockStar)return!1;if(!this.consume)return!1;var t=JSON.parse(this.consume);if(!t)return!1;var i=t[0].value.split(":"),s=parseInt(i[0]);return parseInt(i[1])<=ri.ins.getGoodsNum(s)}),n(0,t,"unLock",function(){var e=Qh.ins.kunVo;return!(e.step<this.lockStep||e.step==this.lockStep&&e.star<this.lockStar)&&(0<this.level||0!=this.level)}),e}(),$h=function(e){function t(){var e=this;e._base_MainView=null,e._base_View=null,e._manage_View=null,e._player_View=null,e._guild_View=null,e._contribult_View=null,e._guildInfoView=null,t.__super.call(e),On.ins.registPanel("GUILD_BASE_MAINVIEW",a_,"_base_MainView",e,{wait:On.wait(On.waitAtlas("newguild"),On.waitConfig(["ConfigGuildBuildUpgrade","ConfigGuildDonation","ConfigGuildLevel"],["ConfigGuildBuildUpgrade","ConfigGuildDonation","ConfigGuildLevel"])),layer:"layout"}),On.ins.registPanel("GUILD_BASE_VIEW",r_,"_base_View",e,{wait:On.waitAtlas("newguild"),layer:"layout"}),On.ins.registPanel("GUILD_MANAGE_VIEW",c_,"_manage_View",e,{wait:On.wait(On.waitAtlas("newguild")),mask:!0}),On.ins.registPanel("GUILD_PLAYERLIST_VIEW",d_,"_player_View",e,{wait:On.waitAtlas("newguild")}),On.ins.registPanel("GUILD_GUILDLIST_VIEW",l_,"_guild_View",e,{wait:On.waitAtlas("newguild")}),On.ins.registPanel("GUILD_CONTTIBULT_VIEW",pp,"_contribult_View",e),On.ins.registPanel("GUILD_MNG_GINFO_VIEW",H_,"_guildInfoView",e,{wait:On.wait(On.waitConfig(["ConfigGuildLevel"],["ConfigGuildLevel"])),clearAll:!1,mask:!0})}u(t,"modules.guild.proxys.GuildBase_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"12904":ke.ins.allGuildToc=e.proto,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"12912":1==e.proto.opcode&&On.ins.close("GUILD_CREATE_VIEW");break;case"12918":break;case"12902":var i=e.proto;1==i.status?(Gi.ins.guildId=i.guildId,Gi.ins.guildName=i.guildName):(Gi.ins.guildId=0,Gi.ins.guildName=null),ke.ins.joinGuild=1==i.status,ke.ins.gczT=i.gczT,t._base_MainView&&(t._base_MainView.vsc.invalid(),t._base_MainView.vsc.selectId=ke.ins.joinGuild?"SUB_MNG_BASE":"SUB_MNG_LIST"),Fl.sendToModule("GUILD_CHANGE",["modules.scene.SceneModule"]);break;case"12906":ke.ins.myGuildMemList=e.proto,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"12908":t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"12914":break;case"12945":ke.ins.mycontribute=e.proto,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto),t._contribult_View&&t._contribult_View.update(e.proto);break;case"12921":1==e.proto.opcode&&ke.ins.noGuild();break;case"12924":var s=e.proto.pos;On.ins.isOpen("GUILD_MNG_MAINVIEW")&&ke.ins.tc_myGuildMems.invalid(),ke.ins.myGuildBaseToc&&(ke.ins.myGuildBaseToc.minePos=s,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(ke.ins.myGuildBaseToc));break;case"12910":break;case"12965":t._base_MainView&&(t._base_MainView.vsc.updateItemEnabled(),t._base_MainView.vsc.updateSelectedView(e.proto));break;case"23302":Il.ins.panelInfo=e.proto,t._base_MainView&&t._base_MainView.parent&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"12947":case"12983":case"12984":ke.ins.updaterecordArr(e.proto),t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"ICON_POS_CHANGED":break;case"12976":for(var n=e.proto,o=ke.ins.myBuildInfo.list,a=0;a<o.length;a++)o[a].type==n.type&&(o[a].level=n.level);ke.ins.myGuildBaseToc.guildFunds=n.guildFunds,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto);break;case"12978":ke.ins.myBuildInfo=e.proto,t._base_MainView&&t._base_MainView.vsc.updateSelectedView(e.proto),t._base_MainView&&t._base_MainView.vsc.updateItemEnabled();break;case"UPDATE_GUILD_PLAYER":var r=e.proto;On.ins.open("FRIENDNEWADDFRIENDVIEW"),t._guildInfoView&&t._guildInfoView.parent&&t._guildInfoView.updateGuildInfo(r)}},i.showPanel=function(e,t){"GUILD_MNG_GINFO_VIEW"==e&&this._guildInfoView.updateGuildInfo(t)},i.closePanel=function(e,t){},i.checkPanelOpen=function(e,t){return!!ke.ins.joinGuild||(On.ins.open("GUILD_MNG_MAINVIEW"),!1)},t}(),e_=function(e){function n(){var e=this;e._boss_mainview=null,e._boss_infoview=null,e._boss_settleview=null,e._boss_sceneview=null,e._boss_rankview=null,e._helpAskView=null,e._GuildKunRankMV=null,e._GuildKunFeedView=null,e._GuildKunOpenView=null,e._GuildKunDamageRankV=null,e._Boss_KunSceneSettle=null,e._BossKunScene=null,e._GuildKun_CallView=null,e._GuildKun_NoticeView=null,n.__super.call(e),On.ins.registPanel("GUILD_BOSS_MAINVIEW",f_,"_boss_mainview",e,{wait:On.wait(On.waitAtlas("guildcallboss","guildboss","kun"),On.waitConfig(["ConfigGuildBoss","GuildBossRankRewarRes"],["ConfigGuildBoss","GuildBossRankRewarRes"])),layer:"layout"}),On.ins.registPanel("GUILD_BOSS_HELP",p_,"_helpAskView",e,{mask:!1,layer:"nav"}),On.ins.registPanel("GUILD_BOSS_INFOVIEW",b_,"_boss_infoview",e,{mask:!0}),On.ins.registPanel("GUILD_BOSS_RANK_VIEW",x_,"_boss_rankview",e,{mask:!0}),On.ins.registPanel("GUILD_BOSS_CD_VIEW",v_,"_boss_cdview",e,{wait:On.wait(On.waitAtlas("guildboss")),mask:!1,layer:"nav"}),On.ins.registPanel("GCBossExitAlert",__,"",e,{mask:!1,layer:"nav"});var t=[Or.getLayoutsPath("fightresult"),Or.getLayoutsPath("guildboss")];On.ins.registPanel("GUILD_BOSS_SETTLE_VIEW",S_,"_boss_settleview",e,{wait:On.waitRes(t),layer:"top"}),On.ins.registPanel("GUILD_BOSS_SCENE_VIEW",I_,"_boss_sceneview",e,{clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("GUILD_KUN_RANK_VIEW",A_,"_GuildKunRankMV",e,{layer:"panel",mask:!0}),On.ins.registPanel("GUILD_KUN_FEED_VIEW",T_,"_GuildKunFeedView",e,{layer:"panel",mask:!0}),On.ins.registPanel("GUILD_KUN_OPEN_VIEW",L_,"_GuildKunOpenView",e,{layer:"panel",mask:!0}),On.ins.registPanel("GUILD_DAMAGE_RANK",C_,"_GuildKunDamageRankV",e,{layer:"panel",mask:!0});var i=[Or.getLayoutsPath("kun")],s=[Or.getLayoutsPath("fightresult")];On.ins.registPanel("BOSS_GUILD_KUN",M_,"_BossKunScene",e,{wait:On.waitRes(i),clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("BOSS_KUN_SUCCESS",R_,"_Boss_KunSceneSettle",e,{clearAll:!1,mask:!1,layer:"nav",wait:On.waitRes(s)}),On.ins.registPanel("GUILD_KUN_CALL_VIEW",P_,"_GuildKun_CallView",e,{clearAll:!1,mask:!1,layer:"nav"}),On.ins.registPanel("GUILD_KUN_NOTICE_VIEW",vl,"_GuildKun_NoticeView",e,{clearAll:!1,mask:!1,layer:"nav"})}u(n,"modules.guild.proxys.GuildBoss_Proxy",F);var t=n.prototype;return Y.imps(t,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"FIGHT_BLOOD_UPDATE":if(ke.ins.bossBlood=e.proto.bossCurrHP,ha.ins.bossBlood=e.proto.bossCurrHP,t._boss_sceneview&&U.isFirstShowBool){var i=uo.getIndex(ke.ins.curCopyId);xn.ins.updateBossBlood(uo.MODEL.bossId(i),ke.ins.bossBlood)}break;case"12963":On.ins.open("GUILD_BOSS_SETTLE_VIEW",e.proto),t._boss_infoview&&t._boss_infoview.update({id:w_.currentIndex}),On.ins.close("GUILD_BOSS_CD_VIEW");break;case"12961":t._boss_mainview&&t._boss_mainview.vsc&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.boss.GuildBoss_MainView&&t._boss_mainview.vsc.selectedView.updateToc(e.proto),t._boss_infoview&&t._boss_infoview.update({id:w_.currentIndex});break;case"12970":t._boss_infoview&&t._boss_infoview.updateToc(e.proto);break;case"12972":break;case"12974":var s=e.proto;ke.ins.guild_bossToc.awardList.take(s.copyId)&&ke.ins.guild_bossToc.awardList.remove(s.copyId),ke.ins.guild_bossToc.awardList.put(s.copyId,{copyId:s.copyId,state:1}),t._boss_infoview&&t._boss_infoview.updateAward(),t._boss_mainview&&t._boss_mainview.vsc&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.boss.GuildBoss_MainView&&t._boss_mainview.vsc.selectedView.updateAward();break;case"12965":t._boss_mainview&&(t._boss_mainview.vsc.updateItemEnabled(),t._boss_mainview.vsc.updateSelectedView(e.proto));break;case"12989":if(!Wc.isEnabledChangeScene())return;if(Kh.ins.leftTimes<=0)return;Kh.ins.noShow||(Kh.ins.setCallInfo(e.proto),On.ins.open("GUILD_BOSS_HELP",e.proto));break;case"12994":0==e.proto.isMe?On.ins.open("GCBossExitAlert"):1==e.proto.type&&On.ins.open("RESULT_FAIL",{awards:[],callback:ms.create(t,t.exit)});break;case"12995":var n=e.proto;Kh.ins.leftTimes=n.leftCTimes,Kh.ins.setCallBossInfo(n.info),t._boss_mainview&&(t._boss_mainview.vsc.updateItemEnabled(),t._boss_mainview.vsc.updateSelectedView(e.proto));break;case"30768":var o=e.proto,a=[],r=de.ins.kunsInfo.kuns;for(var l=0 in o.kuns.proto){var c=o.kuns.take(l),d=r.take(l);(!(null!=d)||c.growth>d.growth)&&a.push(l)}de.ins.kunsInfo=o;for(var u=0;u<a.length;u++)Fl.sendToModule("GUILD_KUN_GROWTH",["modules.guild.GuildModule"],a[u]);if(t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.updateByVSC(e.proto);t._GuildKunFeedView&&t._GuildKunFeedView.parent&&t._GuildKunFeedView.update(null);break;case"GUILD_KUN_RELIVE":de.ins.setRelive(e.proto);break;case"30774":if(de.ins.feedRankInfo=e.proto,t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.updateRank(e.proto);break;case"GUILD_KUN_OPEN":if(t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.reqData();break;case"GUILD_KUN_CLOSE":break;case"GUILD_KUN_GROWTH":t._GuildKunFeedView&&t._GuildKunFeedView.parent&&t._GuildKunFeedView.feedSuccess(e.proto);break;case"BP_UPDATE":if(t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.updateGoods();t._GuildKunFeedView&&t._GuildKunFeedView.parent&&t._GuildKunFeedView.updateGoods();break;case"12965":if(t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.updateRed();t._boss_mainview&&t._boss_mainview.vsc.updateItemEnabled(),t._boss_mainview&&t._boss_mainview.vsc.updateSelectedView(e.proto);break;case"30781":var h=e.proto;if(de.ins.leaveOpenTimes[h.missionId]=h.totalOpenTime-h.openTime,t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView)t._boss_mainview.vsc.selectedView.updateByVSC(h);t._GuildKunOpenView&&t._GuildKunOpenView.parent&&t._GuildKunOpenView.update(h);break;case"30783":if(!de.ins.neverNotice&&0==ha.ins.curCopyId){var _=e.proto;On.ins.open("GUILD_KUN_CALL_VIEW",_.missionId)}break;case"30784":var p=e.proto;if(de.ins.damageRankInfo=p,t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView){var f=t._boss_mainview.vsc.selectedView;f.updateRank(p),f.updateHP(p)}break;case"25016":var g=e.proto;if(de.ins.damageRankInfo=g,t._boss_mainview&&t._boss_mainview.parent&&t._boss_mainview.vsc.selectedView instanceof modules.guild.views.domain.GuildKunBaseView){var v=t._boss_mainview.vsc.selectedView;v.updateRank(g),v.updateHP(g)}break;case"25017":break;case"30847":Fl.sendToModule("GUILD_KUN_OPEN",["modules.guild.GuildModule"]);break;case"30846":if(0==ha.ins.curCopyId){var m=e.proto.kunId;On.ins.open("GUILD_KUN_NOTICE_VIEW",m)}break;case"30848":Fl.sendToModule("GUILD_KUN_OPEN",["modules.guild.GuildModule"]);break;case"30849":On.ins.isOpen("GUILD_KUN_NOTICE_VIEW")&&On.ins.close("GUILD_KUN_NOTICE_VIEW")}},t.delayOpenResult=function(e){On.ins.open("BOSS_KUN_SUCCESS",e)},t.exit=function(){ha.ins.exitCopy()},t.showPanel=function(e,t){var i=this;switch(e){case"GUILD_BOSS_INFOVIEW":t&&i._boss_infoview.update(t);break;case"GUILD_BOSS_SETTLE_VIEW":i._boss_settleview.update(t);break;case"GUILD_BOSS_RANK_VIEW":i._boss_rankview.update(t);break;case"GUILD_BOSS_HELP":i._helpAskView.updateLabel(t);break;case"GUILD_KUN_FEED_VIEW":i._GuildKunFeedView&&i._GuildKunFeedView.parent&&i._GuildKunFeedView.update(t);break;case"GUILD_KUN_OPEN_VIEW":i._GuildKunOpenView&&i._GuildKunOpenView.parent&&i._GuildKunOpenView.update(t);break;case"BOSS_GUILD_KUN":break;case"BOSS_KUN_SUCCESS":i._Boss_KunSceneSettle&&i._Boss_KunSceneSettle.parent&&i._Boss_KunSceneSettle.update(t);break;case"GUILD_KUN_CALL_VIEW":i._GuildKun_CallView&&i._GuildKun_CallView.parent&&i._GuildKun_CallView.update(t);break;case"GUILD_KUN_NOTICE_VIEW":i._GuildKun_NoticeView&&i._GuildKun_NoticeView.parent&&i._GuildKun_NoticeView.update(t);break;case"GUILD_DAMAGE_RANK":i._GuildKunDamageRankV&&i._GuildKunDamageRankV.parent&&i._GuildKunDamageRankV.show()}},t.closePanel=function(e,t){},t.checkPanelOpen=function(e,t){return!!ke.ins.joinGuild||(On.ins.open("GUILD_MNG_MAINVIEW"),!1)},n}(),t_=function(e){function t(){var e=this;e._rankMview=null,e._mng_mainView=null,e._listView=null,e._modifyNoteView=null,e._applyMngView=null,e._createView=null,e._pkV=null,e._guildAwardsShow=null,e._guilhz=null,e._scawardsff=null,t.__super.call(e),On.ins.registPanel("GUILD_MNG_MAINVIEW",z_,"_mng_mainView",e,{wait:On.wait(On.waitAtlas("guildfun"),On.waitConfig(["ConfigFightCastleCommon","ConfigFightCastleAward"],["CGcCommon","CGcAward"])),layer:"layout"}),On.ins.registPanel("GUILD_RANK_MAINVIEW",op,"_rankMview",e,{wait:On.wait(On.waitAtlas("newguild","guildchengzhu"),On.waitConfig(["ConfigFightCastleCommon","ConfigFightCastleAward"],["CGcCommon","CGcAward"])),mask:!0}),On.ins.registPanel("GUILD_PK_MAINVIEW",ap,"_pkV",e,{wait:On.wait(On.waitAtlas("guildchengzhu"),On.waitConfig(["ConfigFightCastleCommon","ConfigFightCastleAward","FightCastleEnterResource","FightCastleReliveResource","ActivityEntranceResource"],["CGcCommon","CGcAward","CGenter","CGRelive","CActivityEntranceResource"])),layer:"layout"}),On.ins.registPanel("GUILD_MODIFYNOTE_VIEW",W_,"_modifyNoteView",e,{wait:On.waitAtlas("newguild"),clearAll:!1,mask:!0}),On.ins.registPanel("GUILD_APPLYMNG_VIEW",N_,"_applyMngView",e,{clearAll:!1,mask:!0}),On.ins.registPanel("GUILD_CREATE_VIEW",G_,"_createView",e,{wait:On.wait(On.waitAtlas("newguild"),On.wait(On.waitConfig(["ConfigGuildLevel"],["ConfigGuildLevel"]))),clearAll:!1,mask:!0}),On.ins.registPanel("GUILD_LIST_VIEW",F_,"_listView",e,{wait:On.wait(On.waitAtlas("newguild"),On.waitConfig(["GuildCreateResource","ConfigGuildBuildUpgrade","ConfigGuildLevel"],["GuildCreateResource","ConfigGuildBuildUpgrade","ConfigGuildLevel"])),mask:!0}),On.ins.registPanel("GUILD_AWARDS_SHOW_VIEW",np,"_guildAwardsShow",e,{clearAll:!1,mask:!0}),On.ins.registPanel("GUILD_AWARDS_HZ_VIEW",ep,"_guilhz",e,{wait:On.wait(On.waitAtlas("newguild")),clearAll:!1,mask:!0}),On.ins.registPanel("GUILD_AWARDS_FF_VIEW",sp,"_scawardsff",e,{wait:On.wait(On.waitAtlas("newguild")),clearAll:!1,mask:!0})}u(t,"modules.guild.proxys.GuildMng_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"12904":ke.ins.allGuildToc=e.proto,t._listView&&t._listView.updateByVSC(e.proto),t._mng_mainView&&t._mng_mainView.vsc.updateSelectedView(e.proto);break;case"12912":1==e.proto.opcode&&(On.ins.close("GUILD_CREATE_VIEW"),On.ins.close("GUILD_LIST_VIEW"),On.ins.open("GUILD_BASE_MAINVIEW"));break;case"12918":1==e.proto.opcode&&(t._listView&&On.ins.close("GUILD_LIST_VIEW"),On.ins.open("GUILD_BASE_MAINVIEW"));break;case"12902":var i=e.proto;1==i.status?(Gi.ins.guildId=i.guildId,Gi.ins.guildName=i.guildName):(Gi.ins.guildId=0,Gi.ins.guildName=null),ke.ins.joinGuild=1==i.status,ke.ins.gczT=i.gczT,t._mng_mainView&&(t._mng_mainView.vsc.invalid(),t._mng_mainView.vsc.selectId=ke.ins.joinGuild?"SUB_MNG_BASE":"SUB_MNG_LIST"),t.gczCoutTime(),Fl.sendToModule("GUILD_CHANGE",["modules.scene.SceneModule"]);break;case"12965":t._mng_mainView&&t._mng_mainView.vsc.updateSelectedView(e.proto),t._pkV&&t._pkV.parent&&t._pkV.updateByVSC(e.proto);break;case"23344":t._pkV&&t._pkV.parent&&t._pkV.updateByVSC(e.proto);break;case"12906":ke.ins.myGuildMemList=e.proto,t._mng_mainView&&t._mng_mainView.vsc.updateSelectedView(e.proto),t._scawardsff&&t._scawardsff.parent&&t._scawardsff.showGetAwardsMembers();break;case"12908":t._mng_mainView&&t._mng_mainView.vsc.updateSelectedView(e.proto);break;case"12914":break;case"12924":var s=e.proto.pos;On.ins.isOpen("GUILD_MNG_MAINVIEW")&&ke.ins.tc_myGuildMems.invalid(),ke.ins.myGuildBaseToc&&(ke.ins.myGuildBaseToc.minePos=s,t._mng_mainView&&t._mng_mainView.vsc.updateSelectedView(ke.ins.myGuildBaseToc));break;case"12910":t._applyMngView&&t._applyMngView.update(e.proto);break;case"23302":Il.ins.panelInfo=e.proto,On.ins.open("GUILD_PK_MAINVIEW"),t._pkV&&t._pkV.parent&&t._pkV.updateByVSC(e.proto);break;case"ICON_POS_CHANGED":t.gczCoutTime();break;case"GUILD_RANK_AWARDS":On.ins.open("GUILD_RANK_MAINVIEW",e.proto,0);break;case"GUILD_RANK_AWARDS_UPDATE":t._rankMview&&t._rankMview.updateScore();break;case"GUILD_AWARDS_SHOW":On.ins.open("GUILD_AWARDS_SHOW_VIEW",e.proto,0);break;case"12986":t._guilhz&&t._guilhz.showInfo(e.proto.rewerdsList);break;case"23337":t._guildAwardsShow&&t._guildAwardsShow.parent&&t._guildAwardsShow.updateBtnInfo(e.proto.status);break;case"12934":t._pkV&&t._pkV.parent&&t._pkV.updateByVSC(e.proto);break;case"GUILD_AWARDS_SELECTED":var n=e.proto.bool;t._scawardsff&&t._scawardsff.parent&&t._scawardsff.updateNum(n)}},i.showPanel=function(e,t){if("GUILD_RANK_MAINVIEW"==e)this._rankMview.showSelectedPanel(t.selectedIndex);else if("GUILD_AWARDS_SHOW_VIEW"==e){var i=Boolean(t.guild);this._guildAwardsShow.showAwards(i)}},i.closePanel=function(e,t){},i.gczCoutTime=function(){},i.doCountTime=function(){},t}(),i_=function(e){function t(){this.mainView=null,this.shopdata=null,t.__super.call(this),On.ins.registPanel("GUILD_SHOP_VIEW",X_,"mainView",this,{wait:On.wait(On.waitAtlas("guildstore"),On.waitConfig(["ConfigGuildShopRefresh","ConfigGuildShopGoods"],["CGuildShopRefresh","CGuildShopGoods"])),layer:"layout"}),this.shopdata=Xh.ins}u(t,"modules.guild.proxys.GuildShop_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"OPEN_SHOP_VIEW":0==ke.ins.joinGuild?On.ins.open("GUILD_LIST_VIEW"):On.ins.open("GUILD_SHOP_VIEW",null,0);break;case"30771":var t=e.proto;this.mainView&&this.mainView.updateByVSC(t)}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},i.checkPanelOpen=function(e,t){return!0},t}(),s_=function(e){function t(){this._skill_mainview=null,t.__super.call(this),On.ins.registPanel("GUILD_SKILL_MAINVIEW",_p,"_skill_mainview",this,{wait:On.wait(On.waitAtlas("guildskill"),On.waitConfig(["ConfigGuildSkill","ConfigSpecialDonation"],["ConfigGuildSkill","ConfigSpecialDonation"])),layer:"layout"})}u(t,"modules.guild.proxys.GuildSkill_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"12982":var i=e.proto;ke.ins.myGuildBaseToc.baocangLevel=i.baocangLevel,ke.ins.myGuildBaseToc.baocangCurExp=i.baocangCurExp,ke.ins.myGuildBaseToc.guildFunds=i.guildFunds,t._skill_mainview&&t._skill_mainview.vsc.updateSelectedView(e.proto),t._skill_mainview&&t._skill_mainview.vsc.updateItemEnabled();break;case"12949":t._skill_mainview&&t._skill_mainview.vsc.updateSelectedView(e.proto),t._skill_mainview&&t._skill_mainview.vsc.updateItemEnabled();break;case"BP_UPDATE":case"10205":t._skill_mainview&&t._skill_mainview.vsc.updateSelectedView(e),t._skill_mainview&&t._skill_mainview.vsc.updateItemEnabled();break;case"10204":t._skill_mainview&&t._skill_mainview.vsc.selectedView instanceof modules.guild.views.skill.GuildSkill_BaseView&&t._skill_mainview.vsc.selectedView.refreshNewActor()}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},i.checkPanelOpen=function(e,t){return!!ke.ins.joinGuild||(On.ins.open("GUILD_MNG_MAINVIEW"),!1)},t}(),n_=function(e){function i(){var e=this;e._store_mainView=null,e._redresultView=null,e._recordView=null,e._redView=null,e._reNarView=null;var t=[];t.push(Or.getLayoutsPath("guildstore")),t.push("ui/layouts/guildstore/hb_jm_db.png"),t.push("ui/layouts/basic_ui/lxsy_db_gx.png"),i.__super.call(e),On.ins.registPanel("GUILD_STORE_MAINVIEW",fp,"_store_mainView",e,{wait:On.waitAtlas("guildstore"),layer:"layout"}),On.ins.registPanel("GUILD_STORE_REDRESVIEW",vp,"_redresultView",e,{wait:On.waitAtlas("guildstore")}),On.ins.registPanel("GUILD_STORE_RECORDVIEW",gp,"_recordView",e,{wait:On.waitAtlas("guildstore")}),On.ins.registPanel("GUILD_REDVIEW",mp,"_redView",e,{wait:On.waitRes(t),mask:!0}),On.ins.registPanel("GUILD_REDNAVVIEW",bp,"_reNarView",e,{wait:On.waitRes(t),clearAll:!1,mask:!1,layer:"nav"})}u(i,"modules.guild.proxys.GuildStore_Proxy",F);var t=i.prototype;return Y.imps(t,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"12906":ke.ins.myGuildMemList=e.proto,t._redView&&t._redView.updateByVSC(e.proto);break;case"12908":case"12930":case"12967":t._redView&&t._redView.updateByVSC(e.proto);break;case"12934":var i=e.proto;t._redView&&t._redView.updateByVSC(i),0<i.remainNum&&0==i.status?On.ins.open("GUILD_REDNAVVIEW",i.remainNum,0):On.ins.close("GUILD_REDNAVVIEW");break;case"12936":var s=e.proto;1==s.opcode&&On.ins.open("GUILD_STORE_REDRESVIEW",s.yb);break;case"12965":t._store_mainView&&(t._store_mainView.vsc.updateItemEnabled(),t._store_mainView.vsc.updateSelectedView(e.proto));break;case"12943":var n=e.proto;ke.ins.updaterecordArr(e.proto),t._recordView&&t._recordView.parent&&t._recordView.update(n)}},t.showPanel=function(e,t){"GUILD_STORE_REDRESVIEW"==e?this._redresultView.update(t):"GUILD_STORE_RECORDVIEW"==e?this._recordView.update(t):"GUILD_REDNAVVIEW"==e&&this._reNarView.openView(t)},t.closePanel=function(e,t){},t.checkPanelOpen=function(e,t){return!!ke.ins.joinGuild||(On.ins.open("GUILD_MNG_MAINVIEW"),!1)},i}(),o_=function(e){function t(){this._raiseKun=null,this._kunSkill=null,t.__super.call(this),On.ins.registPanel("RaiseKunMasterMainView",j_,"_raiseKun",this,{wait:On.wait(On.waitAtlas("raisekun"),On.waitConfig(["ConfigKunMaster","ConfigKunMasterSkill"],["ConfigRaiseKun","ConfigRaiseKunSkill"])),layer:"layout"}),On.ins.registPanel("RaiseKunMasterSkillView",q_,"_kunSkill",this,{wait:On.wait(On.waitAtlas("raisekun"),On.waitConfig(["ConfigKunMaster","ConfigKunMasterSkill"],["ConfigRaiseKun","ConfigRaiseKunSkill"])),layer:"panel"})}u(t,"modules.guild.proxys.RaiseKunMasterProxy",F);var i=t.prototype;return Y.imps(i,{"ui.ICheckPanelOpen":!0,"ui.IPanelProxy":!0}),i.subHandler=function(e){switch(e.actionOrder){case"30776":var t=e.proto;Qh.ins.updateKunVo(t),this._raiseKun&&this._raiseKun.vsc.updateSelectedView(e),this._kunSkill&&this._kunSkill.updateByVSC(e);break;case"BP_UPDATE":this._kunSkill&&this._kunSkill.updateByVSC(e);case"10205":this._raiseKun&&this._raiseKun.vsc.updateSelectedView(e)}},i.showPanel=function(e,t){switch(e){case"RaiseKunMasterMainView":this._raiseKun&&this._raiseKun.vsc.updateSelectedView(t);break;case"RaiseKunMasterSkillView":this._kunSkill&&this._kunSkill.updateByVSC(t)}},i.closePanel=function(e,t){},i.checkPanelOpen=function(e,t){return!!ke.ins.joinGuild||(On.ins.open("GUILD_MNG_MAINVIEW"),!1)},t}(),a_=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.base.GuildBaseMainView",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/newguild/btn_tab_jcxx.png","ui/layouts/newguild/btn_tab_ghgn.png","ui/layouts/newguild/btn_tab_sczb.png","ui/layouts/newguild/btn_tab_ghlb.png"],e.vsc=new o(e),e.vsc.registAll([{cls:r_,id:"SUB_BASE_BASE",isHideBg:!0},{cls:c_,id:"SUB_BASE_MANAGE"},{cls:d_,id:"SUB_BASE_PLAYER"},{cls:l_,id:"SUB_BASE_GUILD"}]),e.vsc.filterHandler=ms.create(e,e.onVscFilter,null,!1),e.vsc.selectHandler=ms.create(e,e.onSelectedView,null,!1),e.title=Or.getAtlasSubPath("newguild/gh_text_gh.png")},i.onSelectedView=function(e,t){this.setTitle(Or.getAtlasSubPath("newguild/gh_text_gh.png"))},i.onVscFilter=function(e,t){if("SUB_BASE_MANAGE"==e){if(ke.ins.isReddot(2))return 3}else if("SUB_BASE_BASE"==e&&ke.ins.isReddot(1))return 3;return 0},i.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,t.prototype.destroy.call(this,e)},i.onAdd=function(e){t.prototype.onAdd.call(this,e)},e}(jr),r_=function(e){function t(){this.GN_TYPES=null,this.eff=null,t.__super.call(this),this.GN_TYPES={},this.GN_TYPES[1]={label:ed.n[1803],type:1},this.GN_TYPES[2]={label:ed.n[1804],type:2},this.GN_TYPES[3]={label:ed.n[1805],type:3},this.GN_TYPES[4]={label:ed.n[1806],type:4},this.GN_TYPES[5]={label:ed.n[1807],type:5}}u(t,"modules.guild.views.base.GuildBaseView",zl);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1,e.link_note.on("click",e,e.onModifyNoteClick),e.label_checkreq.on("click",e,e.openReqPanel),e.btn_juan.on("click",e,e.openJuanPanel)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.openJuanPanel=function(){On.ins.open("GUILD_CONTTIBULT_VIEW")},i.openReqPanel=function(){On.ins.open("GUILD_APPLYMNG_VIEW")},i.onModifyNoteClick=function(){On.ins.open("GUILD_MODIFYNOTE_VIEW")},i.onCellRender=function(e,t){var i=this.list.array[t];e.txt_name.changeText(i.name),e.txt_position.changeText(bi.getCNPos(i.pos)),e.txt_power.changeText(ur.getBigIntStr(i.totalContrib)),e.mc_vip.visible=0<i.viplevel,e.on("click",this,this.onCellClick,[t])},i.onCellClick=function(e){var t=this.list.array[e];if(""+t.id!=Gi.ins.charId){var i=[this.GN_TYPES[5]],s=ke.ins.myPos,n=t.pos;1==n?2==s&&!t.online&&172800<=J.curServerTime-t.offline&&i.push(this.GN_TYPES[2]):2==n?1==s&&i.push(this.GN_TYPES[1],this.GN_TYPES[3],this.GN_TYPES[4]):1==s?i.push(this.GN_TYPES[3],this.GN_TYPES[4]):2==s&&7==n&&i.push(this.GN_TYPES[4]),0<i.length&&1==i.length&&To.reqViewOther(t.id)}},i.updateByVSC=function(e){e instanceof protos.guild.toc_12908?this.updateBase(e):e instanceof protos.guild.toc_12906?this.updateList(e):protos.guild.toc_12945},i.updateBase=function(e){var t=this;t.txt_name.changeText(e.guildName),t.txt_level.changeText(e.guildLevel+""),t.txt_money.changeText(e.guildFunds+"");var i=0,s=e.list,n=1,o=0;for(o=0;o<s.length;o++)3==s[o].type&&(n=s[o].level);for(o=0;o<d.count;o++)3==d.MODEL.buildId(o)&&d.MODEL.level(o)==n&&(i=d.MODEL.capacity(o));t.txt_count.changeText(e.guildMemOwn+"/"+i),t.txt_juan.changeText(e.mineContrib+""),t.txt_note.text=e.guildNote,t.txt_note.height=t.txt_note.textHeight,t.p_note.refresh(),t.label_checkreq.visible=e.minePos<=5,t.label_checkreq.visible&&ke.ins.isReddot(1)?t.eff||(t.eff=ti.createEffect("jm1033",t.label_checkreq.x+69,t.label_checkreq.y+80,t),t.eff.scale_X=.7,t.eff.scale_Y=.7):t.eff&&(t.eff.parent.removeChild(t.eff),t.eff=null),t.link_note.visible=1==e.minePos||2==e.minePos},i.updateList=function(e){!this.list.visible&&(this.list.visible=!0);var t=e.memList;t&&(t=_s.sortOn(t,["pos","totalContrib"],[Array.NUMERIC,Array.NUMERIC|Array.DESCENDING])),this.list.dataSource=t},i.showByVSC=function(e,t){!ke.ins.tc_myGuildBase.invalid()&&ke.ins.myGuildBaseToc&&this.updateByVSC(ke.ins.myGuildBaseToc),!ke.ins.tc_myGuildMems.invalid()&&ke.ins.myGuildMemList&&this.updateByVSC(ke.ins.myGuildMemList),ke.ins.reqReddot(1);var i=new Uo;Fl.sendToService(i)},i.hideByVSC=function(e,t){},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),l_=function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.base.GuildGuildlistView",qc);var i=t.prototype;return i.initialize=function(){this.list.renderHandler=ms.create(this,this.onCellRender,null,!1),this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onCellRender=function(e,t){var i=this.list.array[t],s=i.rank,n=i.level;xr.getIndex(n);e.img_r_1.visible=s<=3,e.img_r_1.visible&&(e.img_r_1.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+s+".png")),3<s?(e.txt_rank.visible=!0,e.txt_rank.text=""+s):e.txt_rank.visible=!1,e.txt_guild.changeText(i.name),e.txt_champion.changeText(i.male),e.txt_level.changeText(n+"");var o=0,a=0,r=i.buildList,l=1;for(o=0;o<r.length;o++)3==r[o].type&&(l=r[o].level);for(o=0;o<d.count;o++)3==d.MODEL.buildId(o)&&d.MODEL.level(o)==l&&(a=d.MODEL.capacity(o));e.txt_num.changeText(i.memOwn+"/"+a)},i.updateByVSC=function(e){e instanceof protos.guild.toc_12908&&this.updateBase(e),e instanceof protos.guild.toc_12904&&this.updateList(e)},i.updateBase=function(e){},i.updateList=function(e){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=e.list},i.showByVSC=function(e,t){!ke.ins.tc_allGuildInfo.invalid()&&ke.ins.allGuildToc&&this.updateByVSC(ke.ins.allGuildToc)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),c_=function(e){function t(){this.buildName=null,this._curIndex=0,this._BAR_W=0,t.__super.call(this)}u(t,"modules.guild.views.base.GuildManageView",rs);var i=t.prototype;return i.initialize=function(){var e=this;e._BAR_W=e.mc_bar1.width,e.buildName=[ed.n[1808],"练功房","议事堂"],e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1},i.onUpGrade=function(e){var t=0;e==this.btn_up1?t=1:e==this.btn_up2?t=2:e==this.btn_up3&&(t=3);var i=new xe;i.buildType=t,Fl.sendToService(i)},i.onCellRender=function(e,t){var i=this.list.array[t];e.txt_time.text=i.timeStr,e.txt_content.innerHTML=i.text},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),ke.ins.tc_records[3].invalid(),ke.ins.tc_records[4].invalid(),ke.ins.tc_records[5].invalid(),t.btn_up1.on("click",t,t.onUpGrade,[t.btn_up1]),t.btn_up2.on("click",t,t.onUpGrade,[t.btn_up2]),t.btn_up3.on("click",t,t.onUpGrade,[t.btn_up3]),t.list.scrollBar.on("change",t,t.onScrollChanged);var i=new Ie;Fl.sendToService(i)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_up1.off("click",t,t.onUpGrade,[t.btn_up1]),t.btn_up2.off("click",t,t.onUpGrade,[t.btn_up2]),t.btn_up3.off("click",t,t.onUpGrade,[t.btn_up3]),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.updateList=function(){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=ke.ins.getRecord(),this.g_mask.visible=10<this.list.length;var e,t=this.getChildAt(0);e=3==this._curIndex?ed.n[1809]:"",t.title=e},i.updateByVSC=function(e){e instanceof protos.guild.toc_12947||e instanceof protos.guild.Guild_recordInout_12983_toc||e instanceof protos.guild.Guild_recordPosChange_12984_toc?this.updateList():e instanceof protos.guild.toc_12976?this.updateBuild():e instanceof protos.guild.toc_12978?this.updateBuild():"number"==typeof e&&(this._curIndex=e,!ke.ins.tc_records[this._curIndex].invalid()&&ke.ins.recordArrayVec&&this.updateList())},i.updateBuild=function(){var e,t,i,s=this,n=0,o=0,a=0,r=[],l=ke.ins.myGuildBaseToc.guildFunds,c=ke.ins.myBuildInfo.list;for(o=0;o<c.length;o++)for(n=0;n<d.count;n++)d.MODEL.buildId(n)==c[o].type&&d.MODEL.level(n)==c[o].level&&(s["txt_level"+c[o].type].changeText("(Lv."+c[o].level+")"),t=d.MODEL.consumptions(n),e=d.MODEL.conditions(n),s["txt_limit"+c[o].type]&&(e?(r=(i=JSON.parse(e))[0].value,s["txt_limit"+c[o].type].innerHTML=ed.n[1810]+nc.createColor("达到"+r+"级","#23b11f")):s["txt_limit"+c[o].type].innerHTML=""),t&&(i=JSON.parse(t),a=parseInt(i[0].value),s["txt_precent"+c[o].type].innerHTML=l+"/"+a,s["txt_needMoney"+c[o].type].changeText(""+a),s.setBarRate(l/a,c[o].type),e?a<=l&&0==d.MODEL.maxLevel(n)&&c[0].level>=r?s["btn_up"+c[o].type].showTip=!0:s["btn_up"+c[o].type].showTip=!1:a<=l&&0==d.MODEL.maxLevel(n)?s["btn_up"+c[o].type].showTip=!0:s["btn_up"+c[o].type].showTip=!1))},i.setBarRate=function(e,t){1<e&&(e=1);var i=this["mc_bar"+t].scrollRect||new qo(0,0,this["mc_bar"+t].width,this["mc_bar"+t].height);i.width=this._BAR_W*e,this["mc_bar"+t].scrollRect=i},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),d_=function(e){function a(){this.renmingPos=0,this.OP_EXIT=0,this.OP_JIESAN=1,a.__super.call(this)}u(a,"modules.guild.views.base.GuildPlayerListView",xs);var t=a.prototype;return t.initialize=function(){this.list.renderHandler=ms.create(this,this.onCellRender,null,!1),this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.spaceY=12,this.list.visible=!1},t.onCellRender=function(e,t){var i=this.list.array[t];e.txt_name.changeText(i.name),e.txt_position.changeText("["+bi.getCNPos(i.pos)+"]"),e.txt_gongxian.changeText(ed.n[1811]+i.totalContrib),e.txt_power.changeText(ed.n[1812]+i.power),e.headImg.skin=Or.getActorHeadPath(i.job,i.sex),e.mc_vip.visible=0<i.viplevel,e.txt_status.changeText(""),e.btn_tichu.visible=!1,e.btn_renming.visible=!1,1==ke.ins.myPos?(i.online?(e.txt_status.color="#23b11f",e.txt_status.changeText("在线")):(e.txt_status.color="#ff2e24",e.txt_status.changeText(he.deltaFormatPro(new Date(J.curServerTime),new Date(i.offline),he.FARR_1))),e.btn_tichu.visible=!0,e.btn_renming.visible=!0,i.id+""==Gi.ins.charId?(e.btn_tichu.visible=!1,e.btn_renming.visible=!1):2==i.pos?(e.btn_tichu.label="禅 让",e.btn_renming.label="降 职"):i.pos<7?(e.btn_tichu.label="踢 出",e.btn_renming.label="降 职"):7==i.pos&&(e.btn_tichu.label="踢 出",e.btn_renming.label="任 命"),e.btn_tichu.on("click",this,this.ontichuClick,[i]),e.btn_renming.on("click",this,this.onrenmingClick,[i])):2!=ke.ins.myPos&&3!=ke.ins.myPos&&4!=ke.ins.myPos&&5!=ke.ins.myPos||(i.id+""==Gi.ins.charId?(e.btn_tichu.visible=!1,e.btn_renming.visible=!1):7==i.pos&&(e.btn_tichu.visible=!0,e.btn_tichu.label="踢 出"),e.btn_tichu.on("click",this,this.ontichuClick,[i])),i.id+""!=Gi.ins.charId&&e.bg.on("click",this,this.onCellClick,[t])},t.onquit=function(){switch(this.btn_quite.tag){case this.OP_EXIT:ja.ins.show(ed.n[1813],ms.create(this,this.alertConfirm,[null,5]));break;case this.OP_JIESAN:ja.ins.show(ed.n[1814],ms.create(this,this.alertConfirm,[null,8]))}},t.onrenmingClick=function(e){if(e.pos<7)ja.ins.show(ed.n[1815]+e.name+"]"+bi.getCNPos(e.pos)+"之职？",ms.create(this,this.alertConfirm,[e,6]));else{var t=this.findPosUse();0<t?(this.renmingPos=t,ja.ins.show(ed.n[1816]+e.name+"]为"+bi.getCNPos(t)+"之职？",ms.create(this,this.alertConfirm,[e,7]))):Vl.ins.showMsg(ed.n[1817],1)}},t.findPosUse=function(){var e=xr.MODEL.memberLimit(ke.ins.myGuildBaseToc.guildLevel-1).split(","),t=ke.ins.myGuildMemList.memList,i=0,s=0;if(0<t.length)for(var n=0;n<a.LIST.length;n++)if((s=0)<(i=e[a.LIST[n]-1])){for(var o=0;o<t.length;o++){t[o].pos==a.LIST[n]&&s++}if(s<i)return a.LIST[n]}return 0},t.ontichuClick=function(e){1==ke.ins.myPos&&2==e.pos?ja.ins.show(ed.n[1818]+e.name+"]吗？",ms.create(this,this.alertConfirm,[e,1])):e.pos>ke.ins.myPos&&ja.ins.show(ed.n[1819]+e.name+ed.n[1820],ms.create(this,this.alertConfirm,[e,4]))},t.alertConfirm=function(e,t,i){if(1==i)if(1==t){var s=new mo;s.playerId=e.id,Fl.sendToService(s)}else if(2==t){var n=new fn;Fl.sendToService(n)}else if(4==t){var o=new c;o.list=[e.id],Fl.sendToService(o)}else if(5==t){var a=new xo;Fl.sendToService(a)}else if(6==t){var r=new yo;r.playerId=e.id,r.pos=7,Fl.sendToService(r)}else if(7==t)(r=new yo).playerId=e.id,r.pos=this.renmingPos,Fl.sendToService(r);else if(8==t){var l=new wo;Fl.sendToService(l)}},t.onCellClick=function(e){On.ins.open("GUILD_MNG_GINFO_VIEW",this.list.array[e])},t.updateByVSC=function(e){e instanceof protos.guild.toc_12908?this.updateBase(e):e instanceof protos.guild.toc_12906?this.updateList(e):protos.guild.toc_12965,this.updateBtn()},t.updateBase=function(e){this.txt_myposition.changeText(ed.n[1821]+bi.getCNPos(ke.ins.myGuildBaseToc.minePos)),this.txt_myvalue.changeText(ed.n[1822]+ke.ins.myGuildBaseToc.mineContrib)},t.updateList=function(e){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=e.memList},t.updateBtn=function(){if(ke.ins.joinGuild)if(1==ke.ins.myPos){var e=ke.ins.myGuildMemList?ke.ins.myGuildMemList.memList.length:0;this.btn_quite.tag=1==e?this.OP_JIESAN:this.OP_EXIT}else this.btn_quite.tag=this.OP_EXIT},t.showByVSC=function(e,t){!ke.ins.tc_myGuildBase.invalid()&&ke.ins.myGuildBaseToc&&this.updateByVSC(ke.ins.myGuildBaseToc),!ke.ins.tc_myGuildMems.invalid()&&ke.ins.myGuildMemList&&this.updateByVSC(ke.ins.myGuildMemList)},t.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_quite.on("click",this,this.onquit),this.list.scrollBar.on("change",this,this.onScrollChanged)},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_quite.off("click",this,this.onquit),this.list.scrollBar.off("change",this,this.onScrollChanged)},i(a,["LIST",function(){return this.LIST=[2,3,4,5,6,7]}]),a}(),u_=function(e){function t(){var e=this;e._gridsList=null,e._grid=null,t.__super.call(e),e._gridsList=new ga(6),e._gridsList.needEffect=!1,e._gridsList.pos(18,150),e._gridsList.scaleX=e._gridsList.scaleY=.8,e._gridsList._gnameVisible=!0,e._gridsList._gsimpleName=!0,e._gridsList._spaceX=10,e._gridsList._gnameY=e._gridsList._gridH+3,e._gridsList._vScrollBarSkin=null,e._gridsList._hScrollBarSkin=null,e.addChildAt(e._gridsList,3),e._grid=new ra(60),e._grid.needEffect=!1,e._grid.pos(570,148),e._grid.needGridBg=!1,e.addChildAt(e._grid,e.numChildren-1)}u(t,"modules.guild.views.boss.CallBossItem",e);var i=t.prototype;return i.onClick=function(){if(1<=ri.ins.getGoodsNum(this.dataSource.ticketID)){Kh.ins._isCalled=!1;ri.ins.getGoodsDto(this.dataSource.ticketID);on.reqEntry(this.dataSource.missionId),Kh.ins._missionId=this.dataSource.missionId}else Vl.ins.playErrorMsg(ed.n[1823])},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){Y.superSet(Er,t,"dataSource",e);var i=e;t.imgBg1.left=12,t.imgBg2.right=12,t.imgBg1.skin=Or.getAtlasSubPath("guildcallboss/"+Kh.ins.getItemBgNameByLevel(i.level)+"1.jpg"),t.imgBg2.skin=Or.getAtlasSubPath("guildcallboss/"+Kh.ins.getItemBgNameByLevel(i.level)+"2.jpg"),t._gridsList.needEffect=!1,t._gridsList.setGoodsItems(i.reward,3),t._grid.bindData=an.create(i.ticketID),t.txt_dect.text=ed.n[1824]+Kh.ins.getELByLevel(i.level)+"级红装";var s=ri.ins.getGoodsNum(i.ticketID);t.labConsume.text="("+s+")";var n=s<i.ticketNum?"#ff2e24":"#23b11f";t.labConsume.color=n,t.btnCall.clickHandler||(t.btnCall.clickHandler=ms.create(t,t.onClick,null,!1)),t.imgDot.visible=s>=i.ticketNum}}),t}(Er),h_=function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.boss.CallBossMainView",xt);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){this.listLevel.itemRender=u_},i.updateByVSC=function(e){e instanceof protos.guild.toc_12995&&this.updatePanel()},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.updatePanel(),this.labLink.on("click",this,this.onClick)},i.updatePanel=function(){this.labTimes.text=Kh.ins.leftTimes+"/"+Kh.ins.maxTimes;var e=Kh.ins.leftTimes<=0?"#ff2e24":"#23b11f";this.labTimes.color=e,this.listLevel.array=Kh.ins.bossInfo},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.labLink.off("click",this,this.onClick)},i.onClick=function(e){if(e.currentTarget==this.labLink){var t=parseInt(Ta.MODEL.value(Ta.getIndex(119)));if(sn.instance.activedRingId<t)return void Vl.ins.showMsg(ed.n[1825],1);On.ins.open("NewDailyActMainView",{_subIndex_:0})}},t}(),__=function(e){function t(){var e=this;e._descDiv=null,e._cd=0,t.__super.call(e),e.centerX=e.centerY=0,e._descDiv=ti.createHtmlDiv(90,140,26,"#90877b",420,0,e),e._descDiv.style.leading=8,e._descDiv.style.align="center",e._descDiv.innerHTML=ed.n[1826]+nc.createColor(ed.n[1827],"#ff2e24")+ed.n[1828]}u(t,"modules.guild.views.boss.GCBossExitAlert",lo);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this._cd=10,this.labCD.changeText("("+this._cd+"s)"),Y.timer.loop(1e3,this,this.loopCD)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clear(this,this.loopCD),this.off("click",this,this.onClick),ha.ins.exitCopy(300)},i.loopCD=function(){this.labCD.changeText("("+this._cd+"s)"),this._cd--,this._cd<=0&&(Y.timer.clear(this,this.loopCD),On.ins.close("GCBossExitAlert"))},i.onClick=function(e){e.target!=this.btn_close&&e.target!=this.btn_ok||On.ins.close("GCBossExitAlert")},t.NAME="GCBossExitAlert",t}(),p_=function(e){function t(){this.playId=NaN,this.chanId=0,this._copyId=0,t.__super.call(this),this.centerX=0,this.centerY=0}u(t,"modules.guild.views.boss.GCBossHelpView",Sa);var i=t.prototype;return i.initialize=function(){this.cb_noremind.selected=!1,this.txt_des.style.font="SimHei",this.txt_des.style.fontFamily="SimHei",this.txt_des.style.fontSize=24,this.txt_des.style.color="#90877b",this.txt_des.style.align="center",this.cb_noremind.y=84,this.btn_go.y=146},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onRefuse),t.btn_go.on("click",t,t.onChallenge),t.cb_noremind.on("click",t,t.setRemind)},i.onRemove=function(e){var t=this;t.img_bosshead&&t.img_bosshead.skin&&Y.loader.clearRes(t.img_bosshead.skin),ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onRefuse),t.btn_go.off("click",t,t.onChallenge),t.cb_noremind.off("click",t,t.setRemind)},i.updateLabel=function(e){var t=e.missionId;this._copyId=t;var i=e.callPlayer,s=uo.getIndex(t),n=uo.MODEL.bossId(s);s=Xl.getIndex(n);var o=Xl.MODEL.name(s);this.img_bosshead.skin=Or.getNoClearImage("zjm_pd_btn_zhboss"),this.img_bosshead.centerX=0,this.playId=e.callPlayerId,this.chanId=e.chanId,this.txt_des.innerHTML=ed.n[1829]+nc.createColor(i,"#23b11f")+ed.n[1830]+nc.createColor(o,"#23b11f")},i.setRemind=function(){Kh.ins.noShow=this.cb_noremind.selected},i.onChallenge=function(e){ri.ins.hasEmptyNum(20)?Wc.isEnabledChangeScene()?(On.ins.close("GUILD_BOSS_HELP"),Kh.ins._isCalled=!0,on.reqEntry(this._copyId,0,0,this.playId,this.chanId)):Vl.ins.showById(2126,1):ja.ins.showBagRecycle()},i.onRefuse=function(e){On.ins.close("GUILD_BOSS_HELP")},t}(),f_=function(n){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.boss.GuildBossMainView",n);var t=e.prototype;return t.destroy=function(e){void 0===e&&(e=!0),n.prototype.destroy.call(this,e);for(var t=[Or.getAtlasSubPath("guildcallboss/gh_zh_hbdj_01.jpg"),Or.getAtlasSubPath("guildstore/ghhj_title_ghsd.png"),Or.getAtlasSubPath("guildcallboss/gh_zh_hbdj_02.jpg"),Or.getAtlasSubPath("guildcallboss/gh_zh_hbgj_01.jpg"),Or.getAtlasSubPath("guildcallboss/gh_zh_hbgj_02.jpg"),Or.getAtlasSubPath("guildcallboss/gh_zh_hbzj_01.jpg"),Or.getAtlasSubPath("guildcallboss/gh_zh_hbzj_02.jpg")],i=0;i<t.length;i++){var s=Y.loader.getRes(t[i]);s&&s.destroy(),s=null}},t.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/kun/yq_btn_ghhj.png","ui/layouts/guildcallboss/yq_btn_zhboss.png"];e.vsc=new o(e),e.vsc.registAll([{cls:k_,id:1,isHideBg:!0,grayTip:ed.n[1831],wait:On.wait(On.waitConfig(["KunResource","feedKunResource","feedRankResource","ConfigKunMisstionPrice","ConfigRule"],["CKunResource","CFeedKunResource","CFeedRankResource","ConfigKunMisstionPrice","CHelpDes"]),On.waitAtlas("kun"))},{cls:h_,id:2}]),e.vsc.selectHandler=ms.create(e,e.onViewChanged,null,!1),e.vsc.filterHandler=ms.create(e,e.checkTips,null,!1)},t.onAdd=function(e){ke.ins.tc_myGuildBase.invalid()},t.updateByVSC=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},t.redPtUpdate=function(e,t){this.updateItemEnabled()},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.onViewChanged=function(e,t){"0"==e?this.layout.head_bar.visible=!1:"2"==e?(this.layout.head_bar.visible=!0,this.setTitle(Or.getAtlasSubPath("guildcallboss/gh_text_zhboss.png"))):"1"==e&&this.setTitle(Or.getAtlasSubPath("kun/ghhj_title_ghhj.png"))},t.checkTips=function(e){if("0"==e){if(ke.ins.isReddot(7))return 3}else if("2"==e){if(ke.ins.isReddot(14))return 3}else if("1"==e&&ke.ins.isReddot(15,17))return 3;return 0},e}(jr),g_=function(e){function t(){this._BAR_W=0,this.curIndex=0,this.id=0,this.index=0,t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_BossItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._BAR_W=this.bar.width,this.img_passed.visible=this.img_point.visible=!1,this.on("click",this,this.onClickHandler)},i.onRemove=function(e){this.off("click",this,this.onClickHandler),ui.ViewBase.prototype.onRemove.call(this,e)},i.resetRedPt=function(){ke.ins.getIsPassedAward(this.id)||this.isHasTimes?this.img_point.visible=!0:this.img_point.visible=!1},i.onClickHandler=function(){On.ins.open("GUILD_BOSS_INFOVIEW",{id:this.id}),w_.currentIndex=this.id},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(ke.ins.guild_bossToc){t.id=e,t.index=oa.getIndex(e),t.txt_bname.changeText(e+"."+oa.MODEL.bossName(t.index)),t.mcBossHead.skin=Or.getGuildBossPath("icon_"+oa.MODEL.bossHs(t.index)),t.curIndex=ke.ins.guild_bossToc.bossCount,t.img_passed.visible=t.index<t.curIndex,t.resetRedPt();var i=NaN;1<(i=t.index==t.curIndex?ke.ins.guild_bossToc.bloodRate/100:t.index<t.curIndex?0:1)&&(i=1);var s=t.bar.scrollRect||new qo(0,0,t.bar.width,t.bar.height);s.width=t._BAR_W*i,t.bar.scrollRect=s}}),n(0,i,"isHasTimes",function(){return 0!=$.Ins().serverDate.getDay()&&(this.index==this.curIndex&&ke.ins.guild_bossToc.challengeCount<ke.ins.guild_bossToc.challengeTotal)}),t}(il),v_=function(e){function t(){this._remainT=0,t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_CountDownView",ss);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this._remainT=30,this.cd_clip.value=this._remainT+"",this.timerLoop(1e3,this,this.onTimer)},i.onRemove=function(e){this.clearTimerListener(),On.ins.open("GUILD_BOSS_MAINVIEW",{_subIndex_:1},null,!0),ui.ViewBase.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.clearTimerListener=function(){this.clearTimer(this,this.onTimer)},i.onTimer=function(){this._remainT--,this.cd_clip.value=this._remainT+"",this._remainT<=0&&(this.clearTimer(this,this.onTimer),On.ins._closePanelForce(this))},t}(),m_=function(e){function t(){this._BAR_W=0,t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_InfoItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.box.alpha=0,this._BAR_W=this.bar.width},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(!e)return t.txt_bar.changeText(""),t.txt_gname.changeText(ed.n[1832]),void(t.box.alpha=0);t.box.alpha=1;var i=e.rate/100;1<i&&(i=1);var s=t.bar.scrollRect||new qo(0,0,t.bar.width,t.bar.height);s.width=t._BAR_W*i,t.bar.scrollRect=s,t.txt_bar.changeText(e.rate+"/100"),t.txt_gname.changeText(e.guildName)}),t}(Rc),b_=function(e){function t(){var e=this;e.k_list=null,e.h_list=null,e._BAR_W=0,e._BAR_W_H=0,e.index=0,e.curIndex=0,e.copyId=0,e.bossId=0,e.MAX_GUILD_RANK=3,e._toc_12970=null,e.isEnterCopy=0,t.__super.call(e),e._BAR_W=e.bar.width,e._BAR_W_H=e.bar_hurt.width,e.list.spaceY=14,e.list.itemRender=m_}u(t,"modules.guild.views.boss.GuildBoss_InfoView",ar);var i=t.prototype;return i.initialize=function(){var e;this.clearAwardItem();var t=0;for(this.k_list=[],t=0;t<3;t++)(e=new ra).pos(167+140*t,12),e.size(116,116),this.a_sp.addChild(e),this.k_list.push(e);for(this.h_list=[],t=0;t<4;t++)(e=new ra).pos(71+70*t,273),e.size(56,56),this.h_sp.addChild(e),this.h_list.push(e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_passTip.visible=t.txt_times.visible=!1,t.btn_chanllenge.visible=t.btn_award.visible=!1,t.btn_rank.on("click",t,t.onClickHandler),t.btn_award.on("click",t,t.onClickHandler),t.btn_chanllenge.on("click",t,t.onClickHandler),t.btn_close.on("click",t,t.onClickHandler),t.btn_clear.on("click",t,t.onClickHandler)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t._toc_12970.dispose(),t._toc_12970=null,t.clearAwardItem(),t.btn_rank.off("click",t,t.onClickHandler),t.btn_award.off("click",t,t.onClickHandler),t.btn_chanllenge.off("click",t,t.onClickHandler),t.btn_close.off("click",t,t.onClickHandler),t.btn_clear.off("click",t,t.onClickHandler),0==t.isEnterCopy&&(w_.currentIndex=0)},i.reqRankInfo=function(e){var t=new Ms;t.guildId=e,Fl.sendToService(t)},i.updateToc=function(e){if(e&&e instanceof protos.guild.toc_12970){this._toc_12970=e;for(var t=[],i=0;i<this.MAX_GUILD_RANK;i++)i<this._toc_12970.r_guild_arr.length?t.push(this._toc_12970.r_guild_arr[i]):t.push(null);this.list.array=t}},i.updateAward=function(){this.setAwardBtnState()},i.update=function(e){var t=this;e&&(t.reqRankInfo(e.id),t.bossId=e.id,t.index=oa.getIndex(e.id),t.copyId=oa.MODEL.key(t.index),t.txt_bossName.changeText(oa.MODEL.bossName(t.index)),t.mcBossHead.skin=Or.getGuildBossPath("icon_"+oa.MODEL.bossHs(t.index)),t.curIndex=ke.ins.guild_bossToc.bossCount,t.txt_passTip.visible=t.index>t.curIndex,t.btn_clear.visible=t.btn_chanllenge.visible=t.index==t.curIndex,t.txt_times.visible=t.btn_chanllenge.visible,t.txt_times.visible&&ke.ins.guild_bossToc&&(t.btn_chanllenge.showTip=0!=$.Ins().serverDate.getDay()&&0<t.freeNum,t.btn_chanllenge.disabled=0==$.Ins().serverDate.getDay(),t.btn_clear.disabled=0==$.Ins().serverDate.getDay(),t.btn_chanllenge.disabled?(t.txt_times.color="#e41b00",t.txt_times.changeText(ed.n[1833])):(t.txt_times.color="#23b11f",t.txt_times.changeText(ed.n[1834]+t.freeNum+"/"+ke.ins.guild_bossToc.challengeTotal))),t.setAwardBtnState(),t.setAwards(),t.setKillBar())},i.setAwardBtnState=function(){var e=this;if(e.btn_award.visible=e.index<e.curIndex,e.btn_clear.visible&&e.btn_chanllenge.showTip){var t=te.ins.datas22352,i=!1;0<(t?t.leftTime:0)&&(i=!0)}e.btn_clear.showTip=i;var s=ke.ins.getIsPassedAward(e.bossId);e.btn_award.showTip=s,e.btn_award.disabled=!s,e.btn_award.label=s?"领 取":"已领取"},i.setKillBar=function(){var e=this,t=0,i=(t=e.index==e.curIndex?ke.ins.guild_bossToc.bloodRate:e.index<e.curIndex?0:100)/100;1<i&&(i=1);var s=e.bar.scrollRect||new qo(0,0,e.bar.width,e.bar.height);s.width=e._BAR_W*i,e.bar.scrollRect=s,e.txt_bar.changeText(t+"/100"),1<(i=(100-t)/100)&&(i=1);var n=e.bar_hurt.scrollRect||new qo(0,0,e.bar_hurt.width,e.bar_hurt.height);n.width=e._BAR_W_H*i,e.bar_hurt.scrollRect=n},i.setAwards=function(){var e,t,i=0;for(e=oa.MODEL.killAward(this.index).split(";"),i=0;i<3;i++)if(this.k_list[i].visible=i<e.length,this.k_list[i].visible){var s=String(e[i]).split(",");(t=an.create(parseInt(s[0]),parseInt(s[1]))).disAchi=!1,this.k_list[i].bindData=t}for(e=oa.MODEL.hurtAward(this.index).split(";"),i=0;i<4;i++)if(this.h_list[i].visible=i<e.length,this.h_list[i].visible){var n=String(e[i]).split(",");(t=an.create(parseInt(n[0]),parseInt(n[1]))).disAchi=!1,this.h_list[i].bindData=t}},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.btn_close:On.ins._closePanel(t);break;case t.btn_rank:t._toc_12970&&On.ins.open("GUILD_BOSS_RANK_VIEW",{list:t._toc_12970.r_hurt_arr});break;case t.btn_award:if(!ke.ins.getIsPassedAward(t.bossId))return;var i=new ye;i.copyId=oa.MODEL.key(t.index),Fl.sendToService(i);break;case t.btn_chanllenge:if(!ke.ins.guild_bossToc||ke.ins.guild_bossToc.copyId<=0)return;if(0==$.Ins().serverDate.getDay())return;if(ke.ins.guild_bossToc.challengeCount>=ke.ins.guild_bossToc.challengeTotal)return void Vl.ins.showMsg(ed.n[1835],1);on.reqEntry(ke.ins.guild_bossToc.copyId),On.ins._closePanelForce(t),On.ins.close("GUILD_BOSS_MAINVIEW"),t.isEnterCopy=1;break;case t.btn_clear:if(0==$.Ins().serverDate.getDay())return;var s=te.ins.datas22352;(s?s.leftTime:0)<=0&&Fl.sendToModule("OPEN_MV",["modules.yueka.MonthCardModule"]);var n=new xl;n.bossId=t.bossId,Fl.sendToService(n)}},i.clearAwardItem=function(){var e=this,t=0;if(e.k_list&&e.k_list.length){for(t=0;t<e.k_list.length;t++)e.k_list[t]&&(e.k_list[t].parent&&e.k_list[t].parent.removeChild(e.k_list[t]),e.k_list[t].destroy(),e.k_list[t]=null);e.k_list.splice(0,e.k_list.length),e.k_list=null}if(e.h_list&&e.h_list.length){for(t=0;t<e.h_list.length;t++)e.h_list[t]&&(e.h_list[t].parent&&e.h_list[t].parent.removeChild(e.h_list[t]),e.h_list[t].destroy(),e.h_list[t]=null);e.h_list.splice(0,e.h_list.length),e.h_list=null}},n(0,i,"freeNum",function(){return ke.ins.guild_bossToc.challengeTotal-ke.ins.guild_bossToc.challengeCount<0?0:ke.ins.guild_bossToc.challengeTotal-ke.ins.guild_bossToc.challengeCount}),t}(),w_=function(e){function t(){this.MAX_NUM=6,this.itemArr=null,this.curPage=0,this.maxPage=0,this._BAR_W=0,this._toc12961=null,this.localXY=[[50,180],[350,260],[160,476],[460,556],[50,772],[350,852]],t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_MainView",ts);var i=t.prototype;return i.initialize=function(){var e=this,t=new rn;if(e.addChild(t),!e.itemArr){var i;e.itemArr=[];for(var s=0;s<e.MAX_NUM;s++)(i=new g_).pos(e.localXY[s][0],e.localXY[s][1]),t.addChild(i),e.itemArr.push(i)}e._BAR_W=e.bar_my.width,e.maxPage=Math.ceil(oa.count/e.MAX_NUM)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_previous.visible=this.btn_next.visible=!1,this.btn_previous.on("click",this,this.onClickHandler),this.btn_next.on("click",this,this.onClickHandler),on.reqCopy(6),0<modules.guild.views.boss.GuildBoss_MainView.currentIndex&&On.ins.open("GUILD_BOSS_INFOVIEW",{id:modules.guild.views.boss.GuildBoss_MainView.currentIndex})},i.onRemove=function(e){this.btn_previous.off("click",this,this.onClickHandler),this.btn_next.off("click",this,this.onClickHandler),ui.SubPanel.prototype.onRemove.call(this,e)},i.updateToc=function(e){e&&e instanceof protos.guild.toc_12961&&(this._toc12961=e,this.initInfo())},i.initInfo=function(){var e=this,t=(0!=e._toc12961.copyId?e._toc12961.bloodRate:100)/100;1<t&&(t=1);var i=e.bar_my.scrollRect||new qo(0,0,e.bar_my.width,e.bar_my.height);i.width=e._BAR_W*t,e.bar_my.scrollRect=i,e.txt_my_bar.changeText((0!=e._toc12961.copyId?e._toc12961.bloodRate:100)+"/100"),e.txt_my_gname.text=Gi.ins.guildName,1<(t=e._toc12961.other_rate/100)&&(t=1);var s=e.bar_other.scrollRect||new qo(0,0,e.bar_other.width,e.bar_other.height);s.width=e._BAR_W*t,e.bar_other.scrollRect=s,e.txt_other_bar.changeText(0!=e._toc12961.copyId?e._toc12961.other_rate+"/100":""),e.txt_other_gname.text=e._toc12961.other_guildName,e.bossHead.skin=Or.getGuildBossPath("head_"+oa.MODEL.bossHs(e.cindex)),e.curPage=Math.floor(e._toc12961.bossCount/e.MAX_NUM),e.curPage>=e.maxPage&&(e.curPage=e.maxPage-1),e.showBossInfo()},i.showBossInfo=function(){this.btn_previous.visible=0!=this.curPage,this.btn_next.visible=this.curPage+1<this.maxPage;for(var e=0;e<this.MAX_NUM;e++)this.itemArr[e].dataSource=this.curPage*this.MAX_NUM+e+1},i.updateAward=function(){for(var e=0;e<this.MAX_NUM;e++)this.itemArr[e]&&this.itemArr[e].resetRedPt()},i.onClickHandler=function(e){switch(e.currentTarget){case this.btn_previous:0<this.curPage&&this.curPage--;break;case this.btn_next:this.curPage+1<this.maxPage&&this.curPage++}this.showBossInfo()},i.destroy=function(e){void 0===e&&(e=!0),this.guildbossbg&&this.guildbossbg.skin&&Y.loader.clearRes(this.guildbossbg.skin),ui.SubPanel.prototype.destroy.call(this,e)},n(0,i,"cindex",function(){for(var e=0;e<oa.count;e++)if(this._toc12961.copyId==oa.MODEL.missionId(e))return e;return oa.count-1}),t.currentIndex=0,t}(),y_=function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_RankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_rank.visible=this.img_bg.visible=!1},i.getColor=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386";default:return"#90877b"}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;e&&(t.txt_rank.changeText(e.rank+1+""),t.txt_name.changeText(e.playerName),t.txt_hurt.changeText(e.hurt),t.txt_tribute.changeText(ke.ins.getGuildDonateByRank(parseInt(e.rank+1))),3<e.rank+1?(t.img_rank.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(e.rank+1+""),t.img_bg.visible=!1):(t.img_rank.visible=!0,t.txt_rank.visible=!1,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+(e.rank+1)+".png"),t.img_bg.visible=!0,t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no"+(e.rank+1)+".png")),t.txt_name.color=t.getColor(e.rank+1))}),t}(Cl),x_=function(e){function t(){this.myRank=0,this.myHurt=0,t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_RankView",ot);var i=t.prototype;return i.initialize=function(){this.list.spaceY=5,this.list.itemRender=y_,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.txt_no.visible=!1},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.txt_rank.visible=this.rankIcon.visible=!1,this.txt_name.visible=this.txt_hurt.visible=this.txt_tribute.visible=!1,this.btn_close.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){On.ins._closePanel(this)},i.update=function(e){var t=this;if(e){t.list.array=e.list,t.txt_no.visible=e.list.length<1,t.myRank=-1;for(var i=t.myHurt=0;i<e.list.length;i++)if(Gi.ins.charId==e.list[i].playerId){t.myRank=e.list[i].rank+1,t.myHurt=e.list[i].hurt;break}-1<t.myRank&&(t.txt_name.visible=t.txt_hurt.visible=t.txt_tribute.visible=!0,t.txt_name.changeText(Gi.ins.charName),t.txt_hurt.changeText(t.myHurt+""),t.txt_tribute.changeText(ke.ins.getGuildDonateByRank(t.myRank)),3<t.myRank?(t.txt_rank.visible=!0,t.txt_rank.text=t.myRank+""):(t.rankIcon.visible=!0,t.rankIcon.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+t.myRank+".png")))}},t}(),I_=function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_SceneView",Pr);var i=t.prototype;return i.initialize=function(){this.btn_exit.visible=!1,Oi.limitEvent(800,this.btn_exit,"click",ms.create(this,this.onExit,null,!1))},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.size(Y.stage.width,Y.stage.height);var t=ke.ins.curCopyId,i=uo.getIndex(t),s=uo.MODEL.bossId(i);0<ke.ins.bossBlood&&xn.ins.updateBossBlood(s,ke.ins.bossBlood)},i.onExit=function(){ke.ins.changeBossUI(!1)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},t}(),S_=function(e){function t(){this._ctn=null,this._remainSec=0,this._ctn1=null,t.__super.call(this)}u(t,"modules.guild.views.boss.GuildBoss_SettleView",Eo);var i=t.prototype;return i.initialize=function(){var e=this;e.btn_award.clickHandler=ms.create(e,e.onGain,null,!1),e._ctn=new ga(4),e._ctn.x=87,e._ctn.y=460,e._ctn.size(556,304),e._ctn._spaceX=10,e._ctn._spaceY=32,e._ctn._vScrollBarSkin=null,e._ctn._hScrollBarSkin=null,e.addChild(e._ctn),e._ctn1=new ga(4),e._ctn1.x=92,e._ctn1.y=693,e._ctn1.size(556,304),e._ctn1._spaceX=15,e._ctn1._spaceY=32,e._ctn1._vScrollBarSkin="",e._ctn1._hScrollBarSkin=null,e.addChild(e._ctn1)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),gi.ins.show(this),this.update(null)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onGain=function(){var e=new we;Fl.sendToService(e),ha.ins.curCopyId=0,Bs.getInstance().exit(),Y.timer.clearAll(this),On.ins.close("GUILD_BOSS_SETTLE_VIEW")},i.update=function(e){var t=this;if(e&&e instanceof protos.guild.toc_12963){var i=e;t.txt_num.changeText(i.guildDonate+""),t._ctn.setGoodsItems(i.chanllegeGoods,4);t._ctn1.visible&&(t._ctn1.y=5,t._ctn1.setGoodsItems(i.killGoods,4)),t._remainSec=10,t.timerLoop(1e3,t,t.onTimer),t.onTimer()}},i.onTimer=function(){if(this._remainSec<=0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},t}(),k_=function(e){function t(){this.hasGrowup=!1,this.hasOpen=!1,this.childFeed=null,this.childFight=null,this.hasInit=!1,t.__super.call(this)}u(t,"modules.guild.views.domain.GuildKunBaseView",C);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){void 0===e&&(e=!0),this.childFeed&&(this.childFeed.removeSelf(),this.childFeed.destroy(),this.childFeed=null),this.childFight&&(this.childFight.removeSelf(),this.childFight.destroy(),this.childFight=null),ui.SubPanel.prototype.destroy.call(this,e)},i.initialize=function(){this.top=this.bottom=this.left=this.right=0},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),On.ins.isOpen("GUILD_KUN_FEED_VIEW")&&On.ins.close("GUILD_KUN_FEED_VIEW"),On.ins.isOpen("GUILD_KUN_OPEN_VIEW")&&On.ins.close("GUILD_KUN_OPEN_VIEW"),On.ins.isOpen("GUILD_KUN_RANK_VIEW")&&On.ins.close("GUILD_KUN_RANK_VIEW"),On.ins.isOpen("GUILD_DAMAGE_RANK")&&On.ins.close("GUILD_DAMAGE_RANK")},i.updateByVSC=function(e){var t=this;if(t.hasInit)var i=t.panel,s=t.hasOpen;e&&e instanceof protos.guild.toc_30768&&(t.hasOpen=e.hasOpenMission),i&&t.hasInit&&s!=t.hasOpen&&(i.removeSelf(),i.destroy(),t.childFeed=null,t.childFight=null),t.panel.updateByVSC(e),t.hasInit||t.reqData(),t.hasInit=!0},i.updateRank=function(e){this.hasInit&&this.panel.updateRank(e)},i.updateHP=function(e){this.hasInit&&this.panel.updateHP&&this.panel.updateHP(e)},i.updateRed=function(){this.hasInit&&this.panel instanceof modules.guild.views.domain.GuildKunView&&this.panel.updateMasterRed()},i.updateGoods=function(){this.hasInit&&this.panel.updateGoods&&this.panel.updateGoods()},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),de.ins.reqKunPanelInfo(),ke.ins.reqReddot(15,17)},i.reqData=function(){de.ins.reqKunPanelInfo();for(var e=Hr.count,t=0;t<e;t++){var i=Hr.MODEL.missionId(t);de.ins.reqFightPanelInfo(ke.ins.myGuildId,i)}},n(0,i,"panel",function(){var e=this;return e.hasOpen?(e.childFeed&&(e.childFeed.removeSelf(),e.childFeed.destroy(),e.childFeed=null),e.childFight||(e.childFight=new E_,e.addChildAt(e.childFight,0)),e.childFight):(e.childFight&&(e.childFight.removeSelf(),e.childFight.destroy(),e.childFight=null),e.childFeed||(e.childFeed=new B_,e.addChildAt(e.childFeed,0)),e.childFeed)}),t}(),C_=function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.domain.GuildKunDamageRankV",R);var i=t.prototype;return i.initialize=function(){this.view_rank.txt_bar3.text=ed.n[1836]},i.updateByVSC=function(e){},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.close)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.centerX=this.centerY=0,this.btn_close.on("click",this,this.close)},i.show=function(){if(de.ins.damageRankInfo){var e=de.ins.damageRankInfo;this.view_rank.mcL.itemRender=O_,this.view_rank.mcL.dataSource=e.list,this.view_rank.mcL.vScrollBarSkin="";var t=0==e.myRank?"未上榜":e.myRank+"";this.view_rank.txt_rank.changeText(ed.n[1837]+t),this.view_rank.txt_score.changeText(ed.n[1838]+e.myDamage)}},t}(),T_=function(e){function t(){var e=this;e.monsterId=0,e.kunId=0,e._avatar=null,e.barWidth=389,e.food1Id=0,e.food2Id=0,e.commonIdx=0,e.luxuryIdx=0,e.g_cost1=null,e.g_cost2=null,e._font1=null,e._font2=null,e._font3=null,e.recordRate=NaN,e.imgFood=null,e.isSimpleClick=!1,e.onFlyAction=!1,t.__super.call(e)}u(t,"modules.guild.views.domain.GuildKunFeedView",lc);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),Y.timer.clearAll(this),Yl.clearAll(this)},i.initialize=function(){var e=this,t=de.ins.getConsuptionByCfg(de.ins.getCommonFeedIdx(e.kunId),0);e.food1Id=t.goodsId,t=de.ins.getConsuptionByCfg(de.ins.getLuxuryFeedIdx(e.kunId),1),e.food2Id=t.goodsId,e.g_cost1=new ra(45),e.g_cost1.needGridBg=!1,e.g_cost1.needEffect=!1,e.g_cost1.pos(100,e.img_left1.y-10),e.addChild(e.g_cost1);var i=an.create(e.food1Id);e.g_cost1.bindData=i,e.g_cost2=new ra(45),e.g_cost2.needGridBg=!1,e.g_cost2.needEffect=!1,e.g_cost2.pos(300,e.img_righ2.y-10),e.addChild(e.g_cost2),i=an.create(e.food2Id),e.g_cost2.bindData=i,e._font1=new fi(e.img_left1.fontSize),ti.replace(e.img_left1,e._font1),e._font2=new fi(e.img_righ2.fontSize),ti.replace(e.img_righ2,e._font2),e._font2.x=350,e._font3=new fi(e.img_right3.fontSize),ti.replace(e.img_right3,e._font3),e.txt_free.visible=!1},i.setAvatar=function(e){var t=this;if(!t._avatar){var i=Xl.getIndex(e),s=Xl.MODEL.muId(i);i=Cs.getIndex(s);var n=Cs.MODEL.avatarId(i);t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(300,330),t.addChild(t._avatar),t._avatar.mid=n,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(2),t._avatar.play("stand"),t._avatar.mat.identity();var o=de.ins.getGrowthPercent(t.kunId),a=o*de.ins.getSizeRate(t.kunId)+.5;t._avatar.mat.scale(a,a),t.recordRate=o,t._avatar.mouseThrough=!0,t._avatar.mouseEnabled=!1;var r=de.ins.getKunResIdx(t.kunId);t.img_title.skin="ui/layouts/kun/"+Hr.MODEL.nameImg(r)}},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.closeSelf),t.btn_left.off("click",t,t.simpleFeed),t.btn_right.off("click",t,t.specialFeed)},i.feedSuccess=function(e){var t=this;if(t._avatar&&e==t.kunId){var i=t.isSimpleClick?t.g_cost1:t.g_cost2,s=i._iconUrl;t.imgFood=new Dl(s),t.addChild(t.imgFood),t.imgFood.pos(i.x,i.y),(new Yl).to(t.imgFood,{x:t._avatar.x+100,y:t._avatar.y},500,null,ms.create(t,t.resetState,[t.imgFood])),t._avatar.play("attack"),Y.timer.once(800,t,t.resetAva),t.onFlyAction=!0}},i.resetAva=function(){this._avatar.play("stand")},i.resetState=function(e){e&&e.removeSelf(),this.onFlyAction=!1;var t=de.ins.getGrowthPercent(this.kunId);if(1==t)return Vl.ins.showById(4767,2),void this.closeSelf(null);if(1<=t||.1<=Math.abs(t-this.recordRate)){var i=t*de.ins.getSizeRate(this.kunId)+.5;this._avatar.mat.identity(),this._avatar.mat.scale(i,i),this.recordRate=t}},i.update=function(e){var t=this;t._avatar||(t.kunId=e||t.kunId,t.monsterId=de.ins.getMonsterId(t.kunId),t.setAvatar(t.monsterId));var i=de.ins.getGrowthPercent(t.kunId);t.mc_Mask_g.x=t.barWidth*(i-1),t.txt_percent.text=de.ins.getGrowthPerStr(t.kunId),t.commonIdx=de.ins.getCommonFeedIdx(t.kunId),t.luxuryIdx=de.ins.getLuxuryFeedIdx(t.kunId),t.img_left0.text="奖励："+de.ins.getExpByCfg(t.commonIdx,0)+ed.n[1839],t.img_right0.text="奖励："+de.ins.getExpByCfg(t.luxuryIdx,1)+ed.n[1840];var s,n=de.ins.kunsInfo.specialtimes,o=de.ins.specialFeedMax;t.img_right1.text=n+"/"+o,t.img_right1.color=n<=0?"#ff2e24":"#23b11f";var a;t._font3.clear(),a=de.ins.getGoldByCfg(t.luxuryIdx),s=Gi.ins.YB>=a?"#23b11f":"#ff2e24",t._font3.append(a+"",s),t.updateGoods(),t.btn_left.showTip=de.ins.canSimpleFeed(t.kunId),t.btn_right.showTip=de.ins.canSpecialFeed(t.kunId)},i.updateGoods=function(){var e,t=this;t._font1.clear(),t._font2.clear();var i=0,s=de.ins.getConsuptionByCfg(t.commonIdx,0);e=(i=ri.ins.getGoodsNum(t.food1Id))>=s.num?"#23b11f":"#ff2e24",t._font1.append(i+"",e),t._font1.append("/"+s.num,"#90877b"),t._font1.x=t.g_cost1.x+t.g_cost1.width+2,s=de.ins.getConsuptionByCfg(t.luxuryIdx,1),e=(i=ri.ins.getGoodsNum(t.food2Id))>=s.num?"#23b11f":"#ff2e24",t._font2.append(i+"",e),t._font2.append("/"+s.num,"#e0d6c1"),t._font2.append(" 或","#90877b"),t.img_yb.x=t._font2.x+t._font2.contentW+3,t._font3.x=t.img_yb.x+t.img_yb.width-2;var n=0<de.ins.kunsInfo.simpletimes;t.txt_free.visible=n,t._font1.visible=!n,t.g_cost1.visible=!n},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.closeSelf),t.btn_left.on("click",t,t.simpleFeed),t.btn_right.on("click",t,t.specialFeed)},i.closeSelf=function(e){On.ins.close("GUILD_KUN_FEED_VIEW")},i.simpleFeed=function(e){if(!this.onFlyAction){var t=0<de.ins.kunsInfo.simpletimes?3:0;de.ins.reqFeed(this.kunId,t),this.isSimpleClick=!0}},i.specialFeed=function(e){if(!this.onFlyAction){de.ins.kunsInfo.specialtimes;var t=0<ri.ins.getGoodsNum(de.ins.food2Id)?1:2;de.ins.reqFeed(this.kunId,t),this.isSimpleClick=!1}},t}(),E_=function(e){function t(){var e=this;e.monsterId=0,e._avatar=null,e._grids=null,e.kunId=0,e.closeTime=NaN,e.curFightNum=1,e.missionId=0,e.status=0,e.barWidth=438,e.payChallengeTime=0,e.NAME="GUILDKUNFIGHTVIEW",t.__super.call(e)}u(t,"modules.guild.views.domain.GuildKunFightView",Pn);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){void 0===e&&(e=!0),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),Yl.clearAll(this),Y.timer.clearAll(this)},i.initialize=function(){var e=this;e.kunId=de.ins.openedKunId||de.ins.getGrowedKunId(),e.monsterId=de.ins.getMonsterId(e.kunId),e.missionId=de.ins.getMissionId(e.kunId),e._avatar||e.setAvatar(e.monsterId);var t=Xl.getIndex(e.monsterId),i=Xl.MODEL.name(t);e.txt_name.text=i+"︵"+de.ins.getLevelString(e.kunId)+"︶",e._grids=new kl(1,4,116,30,15,!0,null,100,!0,!1),e._grids.isCenter=!0,e._grids.pos(82,848),e._grids.vScrollBarSkin="",e._grids.vScrollBar.elasticDistance=0,e.addChild(e._grids),e._grids.gridDatas=de.ins.getRewardByCfg(e.kunId),e.addChild(e.btn_main),Y.timer.loop(6e4,e,e.reqUpdate)},i.onRemove=function(e){this.btn_main.off("click",this,this.toFight),this.btn_add.off("click",this,this.toAdd),this.box_rank.off("click",this,this.openRank)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.guild.toc_30781&&1==e.status){var i=e;t.missionId=i.missionId,t.closeTime=i.restTime+2,Y.timer.clear(t,t.updateCloseTime),t.status=i.status,Y.timer.loop(1e3,t,t.updateCloseTime),t.updateCloseTime();var s=1-i.freeChallengeTimes;s<0&&(s=0),t.txt_num.text=ed.n[1841]+s+"/1",t.payChallengeTime=i.payChallengeTime,t.btn_main.disabled=s<=0,t.btn_main.showTip=0<s}},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.onAdd=function(e){var t=this;t.btn_main.on("click",t,t.toFight),t.btn_add.on("click",t,t.toAdd),t.box_rank.on("click",t,t.openRank),t.reqUpdate()},i.reqUpdate=function(){de.ins.reqFightPanelInfo(ke.ins.myGuildId,this.missionId)},i.setAvatar=function(e){var t=this;if(!t._avatar){var i=Xl.getIndex(e),s=Xl.MODEL.muId(i);i=Cs.getIndex(s);var n=Cs.MODEL.avatarId(i);t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(370,600),t.addChild(t._avatar),t._avatar.mid=n,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(2),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mouseThrough=!0,t._avatar.mouseEnabled=!1}},i.toFight=function(e){this.curFightNum<=0?Vl.ins.showById(4617,1):ri.ins.hasEmptyNum(20)?on.reqEntry(this.missionId):ja.ins.showBagRecycle()},i.toAdd=function(e){if(this.payChallengeTime!=to.count){var t=de.ins.getFightCost(this.payChallengeTime),i=t>=Gi.ins.YB?"#23b11f":"#ff2e24";ja.ins.show(ed.n[1842]+nc.createColor(t+"元宝",i)+ed.n[1843]+nc.newline()+ed.n[1844]+this.payChallengeTime+"/"+to.count,ms.create(this,this.onBuyAlert),!1)}else Vl.ins.showById(2075,1)},i.onBuyAlert=function(e){1==e&&de.ins.reqUseGold(this.missionId)},i.openRank=function(e){On.ins.open("GUILD_DAMAGE_RANK",null,null,!0)},i.updateCloseTime=function(){this.txt_time.text=ed.n[1845]+V.getCNDHMS(--this.closeTime),this.closeTime<=0&&(Yl.clearAll(this),Y.timer.clearAll(this),Fl.sendToModule("GUILD_KUN_OPEN",["modules.guild.GuildModule"],this.kunId))},i.updateRank=function(e){if((e instanceof protos.guild.toc_30784||e instanceof protos.guild.toc_25016)&&e){var t=0;for(t=0;t<3;t++)this["txt_name"+(t+1)].text=ed.n[1846],this["txt_value"+(t+1)].text="0";var i=Math.min(e.list.length,3);for(t=0;t<i;t++){var s=e.list[t];this["txt_name"+(t+1)].text=s.name,this["txt_value"+(t+1)].text=s.feed+""}}},i.updateHP=function(e){var t,i=de.ins.getTotalHP(this.kunId),s=Math.min(1,e.bossHp/i);this.mc_Mask_g.x=this.barWidth*(s-1),t=1==s?"100%":(100*s).toFixed(2)+"%",this.txt_progress.text=t},t}(),L_=function(e){function t(){this._avatar=null,this.monsterId=0,this.kunId=0,this._description=null,this._grids=null,this.openTime=NaN,this.leaveTimes=0,t.__super.call(this)}u(t,"modules.guild.views.domain.GuildKunOpenView",Gc);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),Yl.clearAll(this),Y.timer.clearAll(this)},i.initialize=function(){var e=this;e._description=ti.createHtmlDiv(0,0,24,e.txt_description.color,470,150),ti.replace(e.txt_description,e._description),e._description.style.leading=20,e._grids=new kl(1,4,116,30,15,!0,null,100,!0,!1),e._grids.isCenter=!0,e._grids.pos(0,530),e._grids.vScrollBarSkin="",e._grids.vScrollBar.elasticDistance=0,e.addChild(e._grids),e.btn_open.showTip=!0;var t=1==ke.ins.myPos||2==ke.ins.myPos;e.btn_open.label=t?"开启":ed.n[1847],e.addChild(e.btn_open)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.closeSelf),this.btn_open.off("click",this,this.toOpen)},i.update=function(e){var t=this;if(Y.timer.clear(t,t.updateOpenTime),e instanceof protos.guild.toc_30781){var i=e;t.leaveTimes=i.totalOpenTime-i.openTime,t.txt_openTimes.text=ed.n[1848]+t.leaveTimes+"/"+i.totalOpenTime,0<t.leaveTimes&&0<i.openRestTime?(t.openTime=i.openRestTime+5,t.txt_time.visible=!0,Y.timer.loop(1e3,t,t.updateOpenTime),t.updateOpenTime()):t.txt_time.visible=!1}else{t.kunId=e,t._avatar||(t.monsterId=de.ins.getMonsterId(t.kunId)),t._grids.gridDatas=de.ins.getRewardByCfg(t.kunId),t.txt_bossName.text=de.ins.getKunName(t.kunId);var s=de.ins.getLevelString(t.kunId);t.txt_name.text=s,t._description.innerHTML=nc.createColor(de.ins.getDescription(t.kunId),"#90877b");var n=Or.getBossPath(de.ins.getMonsterHeadId(t.kunId));t.img1.skin=n;var o=de.ins.getKunResIdx(t.kunId);t.img_title.skin="ui/layouts/kun/"+Hr.MODEL.nameImg(o);var a=de.ins.getMissionId(t.kunId);de.ins.reqFightPanelInfo(ke.ins.myGuildId,a)}},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.closeSelf),this.btn_open.on("click",this,this.toOpen)},i.closeSelf=function(e){On.ins.close("GUILD_KUN_OPEN_VIEW")},i.setAvatar=function(e){var t=this;if(!t._avatar){var i=Xl.getIndex(e),s=Xl.MODEL.muId(i);i=Cs.getIndex(s);var n=Cs.MODEL.avatarId(i);t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(300,330),t.addChild(t._avatar),t._avatar.mid=n,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",n,!0),t._avatar.setDir(2),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(.5,.5),t._avatar.mouseThrough=!0,t._avatar.mouseEnabled=!1}},i.toOpen=function(e){this.leaveTimes<=0?Vl.ins.showById(4776,1):(1==ke.ins.myPos||2==ke.ins.myPos?de.ins.reqOpenMission(ke.ins.myGuildId,de.ins.getMissionId(this.kunId)):de.ins.reqNoticeHZ(this.kunId),this.closeSelf(null))},i.updateOpenTime=function(){this.txt_time.text=V.getCNDHMS(--this.openTime)+ed.n[1849],this.openTime<=0&&(Yl.clearAll(this),Y.timer.clearAll(this),Fl.sendToModule("GUILD_KUN_OPEN",["modules.guild.GuildModule"],this.kunId),this.closeSelf(null))},t}(),A_=(function(e){function t(){t.__super.call(this)}u(t,"modules.guild.views.domain.GuildKunPlayerRankV",Ke);var i=t.prototype;i.initialize=function(){this.txt_bar3.text="贡献",this.mcL.vScrollBarSkin="",this.mcL.scrollBar.elasticBackTime=300,this.mcL.scrollBar.elasticDistance=100},i.updateByVSC=function(e){"23110"==e.actionOrder&&this.show()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.mcL.scrollBar.off("change",this,this.onScrollChanged)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.show(),this.mcL.scrollBar.on("change",this,this.onScrollChanged),this.onScrollChanged()},i.show=function(){if(de.ins.feedRankInfo){var e=de.ins.feedRankInfo;this.mcL.itemRender=O_,this.mcL.dataSource=e.list;var t=0==e.myRank?"未上榜":e.myRank+"";this.txt_rank.changeText(ed.n[1851]+t),this.txt_score.changeText(ed.n[1852]+e.myFeed)}else console.error(ed.n[1850])},i.onScrollChanged=function(){0==this.mcL.scrollBar.max||this.mcL.scrollBar.value>=this.mcL.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0}}(),function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0,this.mouseEnabled=!0}u(t,"modules.guild.views.domain.GuildKunRankMV",ho);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.view_reward.visible=!1,t.view_rank.visible=!0,t.btn_rank.selected=!0,t.btn_rank.on("click",t,t.onClick),t.btn_close.on("click",t,t.onClick),t.btn_award.on("click",t,t.onClick)},i.update=function(e){},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_rank.off("click",t,t.onClick),t.btn_close.off("click",t,t.onClick),t.btn_award.off("click",t,t.onClick)},i.onClick=function(e){var t=this;e.target==t.btn_award?t.view_reward.visible||(t.btn_rank.selected=!1,t.btn_award.selected=!0,t.view_reward.showInfo(),t.view_reward.visible=!0,t.view_rank.visible=!1,t.img_title.skin="ui/layouts/kun/ghhj_title_wypmjl.png"):e.target==t.btn_rank?t.view_rank.visible||(t.btn_rank.selected=!0,t.btn_award.selected=!1,t.view_reward.visible=!1,t.view_rank.visible=!0,t.view_rank.show(),t.img_title.skin="ui/layouts/kun/ghhj_title_wyphb.png"):e.target==t.btn_close&&On.ins.isOpen("GUILD_KUN_RANK_VIEW")&&On.ins.close("GUILD_KUN_RANK_VIEW")},t}()),B_=(function(e){function t(){this._list=[],this.currentPage=0,this.totalPage=0,t.__super.call(this),this.mcL.vScrollBarSkin="",this.mcL.scrollBar.elasticBackTime=300,this.mcL.scrollBar.elasticDistance=100}u(t,"modules.guild.views.domain.GuildKunRewardRankV",bc);var i=t.prototype;i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showInfo(),this.mcL.scrollBar.on("change",this,this.onScrollChanged),this.onScrollChanged()},i.onclick=function(e){},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.mcL.scrollBar.off("change",this,this.onScrollChanged)},i.showInfo=function(){if(this.mcL.itemRender=V_,0==this._list.length)for(var e=0;e<Rs.count;e++)this._list[e]=e;this.mcL.dataSource=this._list},i.onScrollChanged=function(){0==this.mcL.scrollBar.max||this.mcL.scrollBar.value>=this.mcL.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0}}(),function(e){function t(){this.g_cost1=null,this.g_cost2=null,this.NAME="GUILDKUNVIEW",this.swingKuns=null,t.__super.call(this)}u(t,"modules.guild.views.domain.GuildKunView",Gr);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){if(void 0===e&&(e=!0),this.swingKuns&&0<this.swingKuns.length){for(var t=0;t<this.swingKuns.length;t++)this.swingKuns[t].removeSelf(),this.swingKuns[t].destroy();this.swingKuns=null}Y.timer.clear(this,this.reqUpdate),ui.SubPanel.prototype.destroy.call(this,e)},i.initialize=function(){var e=this;e.g_cost1=new ra(45),e.g_cost1.needGridBg=!1,e.g_cost1.needEffect=!1,e.g_cost1.pos(e.txt0.x+e.txt0.width-5,e.txt0.y-7),e.addChild(e.g_cost1);var t=an.create(de.ins.food1Id);if(e.g_cost1.bindData=t,e.g_cost2=new ra(45),e.g_cost2.needGridBg=!1,e.g_cost2.needEffect=!1,e.g_cost2.pos(e.txt_food1.x+e.txt_food1.width+20,e.txt_food1.y-7),e.addChild(e.g_cost2),t=an.create(de.ins.food2Id),e.g_cost2.bindData=t,!e.swingKuns){e.swingKuns=[];for(var i=Hr.count,s=0;s<i;s++){var n=new D_;e.swingKuns.push(n);var o=Hr.MODEL.kunId(s),a=de.ins.getPanelPos(o);n.show(o,e,a.x,a.y)}}Y.timer.loop(6e4,e,e.reqUpdate)},i.onRemove=function(e){var t=this;if(t.swingKuns&&0<t.swingKuns.length)for(var i=0;i<t.swingKuns.length;i++)t.swingKuns[i].onRemove(e);t.box_rank.off("click",t,t.openRank),t.btn_master.off("click",t,t.onClickMaster),t.btn_help.off("click",t,t.onClickWF),t.txt_help.off("click",t,t.onClickWF)},i.updateByVSC=function(e){var t=0;if(e instanceof protos.guild.toc_30781){var i=e;for(t=0;t<this.swingKuns.length;t++){var s=this.swingKuns[t],n=de.ins.getMissionId(s.kunId);2==i.status&&i.missionId==n&&s.setReliveTime(i.reliveRestTime)}}else{for(this.updateGoods(),t=0;t<this.swingKuns.length;t++){this.swingKuns[t].setTitleInfo()}this.updateMasterRed()}},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},i.onAdd=function(e){var t=this;if(t.box_rank.on("click",t,t.openRank),t.btn_master.on("click",t,t.onClickMaster),t.btn_help.on("click",t,t.onClickWF),t.txt_help.on("click",t,t.onClickWF),t.swingKuns&&0<t.swingKuns.length)for(var i=0;i<t.swingKuns.length;i++)t.swingKuns[i].onAdd(null);ke.ins.reqReddot(17),t.reqUpdate(),t.updateMasterRed()},i.reqUpdate=function(){de.ins.reqKunPanelInfo()},i.updateMasterRed=function(){this.btn_master.showTip=ke.ins.isReddot(17)},i.onClickMaster=function(e){e.target==this.btn_master&&On.ins.open("RaiseKunMasterMainView",null,0)},i.updateGoods=function(){var e=this,t=ri.ins.getGoodsNum(de.ins.food1Id);e.txt_food1.text=t+"",e.txt_food1.color=0<t?"#23b11f":"#ff2e24",e.g_cost1.pos(e.txt0.x+e.txt0.width-5,e.txt0.y-7),t=ri.ins.getGoodsNum(de.ins.food2Id),e.txt_food2.text=t+"",e.txt_food2.color=0<t?"#23b11f":"#ff2e24",e.g_cost2.pos(e.txt_food1.x+e.txt_food1.width+30,e.txt_food1.y-7),e.txt_food2.pos(e.g_cost2.x+e.g_cost2.width,e.txt_food1.y)},i.openRank=function(e){On.ins.open("GUILD_KUN_RANK_VIEW",null,null,!0)},i.updateRank=function(e){if(e instanceof protos.guild.toc_30774){var t=de.ins.feedRankInfo;if(t){var i=0;for(i=0;i<3;i++)this["txt_name"+(i+1)].text=ed.n[1846],this["txt_value"+(i+1)].text="0";var s=Math.min(t.list.length,3);for(i=0;i<s;i++){var n=t.list[i];this["txt_name"+(i+1)].text=n.name,this["txt_value"+(i+1)].text=n.feed+""}this.txt_myrank.text=ed.n[1854]+t.myRank,this.txt_myvalue.text=t.myFeed+""}}},i.onClickWF=function(e){var t=po.getIndex(27);if(0<=t){var i=po.MODEL.description(t);On.ins.open("AE_EXPLAIN_VIEW",{desc:i})}},t}()),D_=function(t){function i(){var e=this;e._avatar=null,e.dis=100,e.time=2e3,e.blocks=[],e._titleComp=null,e.monsterId=0,e.kunId=0,e.isDead=!1,e.reliveTime=NaN,e.titleBarWidth=168,e._fontTitle=null,e.recordRate=NaN,i.__super.call(e)}u(i,"modules.guild.views.domain.GuildSwingKun",t);var e=i.prototype;return e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this.blocks=null,this._avatar&&(this._avatar.dispose(),this._avatar.destroy(),this._avatar=null),Yl.clearAll(this),Y.timer.clearAll(this)},e.initialize=function(){},e.show=function(e,t,i,s){var n=this;n._avatar||(Yl.clearAll(n),Y.timer.clearAll(n),n.kunId=e,n.monsterId=de.ins.getMonsterId(e),n.isDead=de.ins.isDead(n.kunId),n.isDead?n.addChild(n.getADeadFish()):n.addChild(n.getAFish()),n._titleComp||(n._titleComp=new g,n._titleComp.height=260,n.addChild(n._titleComp),n._titleComp.pos(-140,-200),n._fontTitle=new fi(n._titleComp.txt_desc.fontSize),ti.replace(n._titleComp.txt_desc,n._fontTitle)),n.parent||(n.pos(i,s),t.addChild(n)),n.setTitleInfo(),!n.isDead&&n.canSwim(n.x,n.y)&&n.swing())},e.getAFish=function(){var e=this,t=Xl.getIndex(e.monsterId),i=Xl.MODEL.muId(t);t=Cs.getIndex(i);var s=Cs.MODEL.avatarId(t);e._avatar=new Jc,e._avatar.renderInSelf=!0,e._avatar.mid=s,e._avatar.type=mc.MONSTER,e._avatar.loadAvatarParts("mid",s,!0);var n=Math.floor(10*Math.random())%8;e._avatar.setDir(n),e._avatar.play("stand"),e._avatar.mat.identity();var o=de.ins.getGrowthPercent(e.kunId),a=o*de.ins.getSizeRate(e.kunId)+.5;return e.recordRate=o,e._avatar.mat.scale(a,a),e._avatar.mouseThrough=!0,e._avatar.mouseEnabled=!1,e._avatar},e.getADeadFish=function(){var e=this;return e._avatar=new Jc,e._avatar.renderInSelf=!0,e._avatar.mid="ms226",e._avatar.type=mc.MONSTER,e._avatar.loadAvatarParts("mid","ms226",!0),e._avatar.setDir(4),e._avatar.play("stand"),e._avatar.mouseThrough=!0,e._avatar.mouseEnabled=!1,e._avatar.mat.identity(),e._avatar.mat.scale(.5,.5),e._avatar},e.setBlock=function(e){this.blocks=e},e.swing=function(){var e=!1;do{var t=this.getDest();if(t&&this.canSwim(t.x,t.y)){if(!this.parent)break;Y.timer.once(500+2e3*Math.random(),this,this.beginMove,[t]),de.ins.kunMovePoint[this.kunId]=new is(t.x,t.y),e=!0}}while(!e)},e.canSwim=function(e,t){return!this.isOnBorder(e,t)&&!this.isOnBlock(e,t)},e.beginMove=function(e){this.setDir(e.dir),Yl.to(this,e,this.time+1e3*Math.random(),null,ms.create(this,this.moveCompleted),200)},e.isOnColide=function(e){for(var t=0 in de.ins.kunMovePoint)if(t!=this.kunId){var i=de.ins.kunMovePoint[t];if(i&&i.distance(e.x,e.y)<80)return!0}return!1},e.getDest=function(){for(var e=null,t=this,i=0,s=this.dis,n=0,o=0;o<20;o++){switch(((i=Math.floor(10*Math.random())%8)<0||7<i)&&(i=0),i){case 0:e={y:t.y-s,x:t.x};break;case 1:e={y:t.y-s/1.42,x:t.x+s/1.42};break;case 2:e={x:t.x+s,y:t.y};break;case 3:e={y:t.y+s/1.42,x:t.x+s/1.42};break;case 4:e={y:t.y+s,x:t.x};break;case 5:e={y:t.y+s/1.42,x:t.x-s/1.42};break;case 6:e={x:t.x-s,y:t.y};break;case 7:e={y:t.y-s/1.42,x:t.x-s/1.42}}if(e.dir=i,e.x=Number(e.x).toFixed(0),e.y=Number(e.y).toFixed(0),!this.isOnColide(e))return e;if(5<++n)return e}return e},e.moveCompleted=function(){this.swing()},e.setDir=function(e){this._avatar&&(this._avatar.setDir(e),this._avatar.play("stand"))},e.getReverseDir=function(e){return 4<=e?e-4:e+4},e.isOnBorder=function(e,t){return!!this.parent&&(e<=150||550<=e||t>=this.parent.height-280||t<=280||200<=e&&t<=565)},e.isOnBlock=function(e,t){for(var i=0;i<this.blocks.length;i++){var s=this.blocks[i],n=e,o=t;if(n>=s.x&&n<=s.x+s.width&&o>=s.y&&o<=s.y+s.height)return!0;if((n=e+this.width)>=s.x&&n<=s.x+s.width&&o>=s.y&&o<=s.y+s.height)return!0}return!1},e.onRemove=function(e){this._titleComp&&this._titleComp.off("click",this,this.onAvatarClicked)},e.onAdd=function(e){this._titleComp&&this._titleComp.on("click",this,this.onAvatarClicked)},e.onAvatarClicked=function(e){this.isDead?Vl.ins.showById(4760,1):de.ins.canOpenMission(this.kunId)?On.ins.open("GUILD_KUN_OPEN_VIEW",this.kunId):On.ins.open("GUILD_KUN_FEED_VIEW",this.kunId)},e.setReliveTime=function(e){this.reliveTime=e+2,Y.timer.clear(this,this.updateReliveTime),this._titleComp.txt_relive.text=ed.n[1855]+V.getCNDHMS(e),Y.timer.loop(1e3,this,this.updateReliveTime)},e.setTitleInfo=function(){var e=this,t=e,i=de.ins.isDead(t.kunId);i!=t.isDead&&(Y.timer.clear(e,t.beginMove),t.isDead=i,e._avatar&&(e._avatar.dispose(),e._avatar.destroy(),e._avatar=null),t.isDead?e.addChild(e.getADeadFish()):(e.addChild(e.getAFish()),e.canSwim(e.x,e.y)&&e.swing())),t._titleComp.txt_relive.visible=t.isDead,t._titleComp.green_pro.visible=!t.isDead;de.ins.getKunResIdx(t.kunId);e._fontTitle.clear();var s="["+de.ins.getLevelString(t.kunId)+"]"+de.ins.getKunName(t.kunId);e._fontTitle.append(s);var n=0;if(t.isDead||(e._fontTitle.append("("+de.ins.getGrowthPerStr(t.kunId)+")","#ff2e24"),1<=(n=de.ins.getGrowthPercent(t.kunId))&&e._fontTitle.append(ed.n[1856],"#23b11f"),t._titleComp.mc_Mask_g.x=t.titleBarWidth*(n-1)),e.setRedPoint(),(1<=n||.1<=Math.abs(n-e.recordRate))&&e._avatar&&!t.isDead){var o=n*de.ins.getSizeRate(t.kunId)+.5;e._avatar.mat.identity(),e._avatar.mat.scale(o,o),e.recordRate=n}},e.setRedPoint=function(){var e=de.ins.getMissionId(this.kunId);this._titleComp.img_rd.visible=!this.isDead&&(de.ins.canSimpleFeed(this.kunId)||de.ins.canSpecialFeed(this.kunId)||de.ins.canOpenMission(this.kunId)&&de.ins.hasOpenTimes(e))},e.updateReliveTime=function(){this._titleComp.txt_relive.text=ed.n[1857]+V.getCNDHMS(--this.reliveTime),this.reliveTime<=0&&(Yl.clearAll(this),Y.timer.clearAll(this),Fl.sendToModule("GUILD_KUN_OPEN",["modules.guild.GuildModule"],this.kunId))},i}(cn),O_=function(e){function t(){t.__super.call(this)}return u(t,"modules.guild.views.domain.item.GuildKunRankItem",e),n(0,t.prototype,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;null!=e&&(e.rank<4?(t.txt_rank.visible=!1,t.img_rank.visible=t.img_bg.visible=!0,1==e.rank?(t.img_rank.skin="ui/layouts/kun/phb_dj_1.png",t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no1.png")):2==e.rank?(t.img_rank.skin="ui/layouts/kun/phb_dj_2.png",t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no2.png")):3==e.rank&&(t.img_rank.skin="ui/layouts/kun/phb_dj_3.png",t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no3.png"))):(t.img_rank.visible=t.img_bg.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(e.rank+"")),t.txName.changeText(e.name),t.txS.changeText(e.feed+""))}),t}(Wn),V_=function(e){function t(){this._grids=null,t.__super.call(this)}u(t,"modules.guild.views.domain.item.GuildKunRewardItem",e);var i=t.prototype;return i.getGrid=function(e){return this._grids||(this._grids=[]),null==this._grids[e]&&(this._grids[e]=new ra(80)),this._grids[e]},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(null!=e){var t=e,i=Rs.MODEL.min(t),s=Rs.MODEL.max(t);i==s?this.txNum.changeText("第"+i+"名"):this.txNum.changeText("第"+i+"-"+s+"名");for(var n,o,a=JSON.parse(Rs.MODEL.reward(t)),r=0;r<a.length;r++){n=a[r].value.split(":"),(o=this.getGrid(r)).dataSource=an.create(n[0],n[1]),o.pos(this["b_"+(r+1)].x,this["b_"+(r+1)].y),this.addChild(o),this["txtName_"+r].text=Re.MODEL.simpleName(Re.getIndex(n[0]))}}}),t}(Be),M_=function(e){function t(){this.totalTime=0,t.__super.call(this),this.centerX=0}u(t,"modules.guild.views.domain.scene.BossKunScene",Ic);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.showInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),Y.timer.clearAll(this)},i.showInfo=function(e){void 0===e&&(e=0);var t=uo.getIndex(ha.ins.curCopyId);this.totalTime=uo.MODEL.playerDuration(t),this.txt_time.text=V.getTickMS(this.totalTime),this.showCDTime()},i.showSkill=function(e){},i.showSkill2=function(e){},i.showSkill3=function(e){},i.showPower=function(){},i.showPowers=function(){},i.showNum=function(){},i.onComplete=function(){},i.showCDTime=function(){Y.timer.loop(1e3,this,this.showTimerCD)},i.showTimerCD=function(){this.totalTime--,this.txt_time.text=V.getTickMS(this.totalTime),this.totalTime<=0&&(Bs.stop(),Y.timer.clear(this,this.showTimerCD))},i.updatePower=function(e){},i.showPjSkin=function(e){},i.onClick=function(){},t}(),R_=function(e){function t(){this._ctn=null,this._remainSec=0,this.isWin=!1,t.__super.call(this)}u(t,"modules.guild.views.domain.scene.Boss_KunSceneSettle",hi);var i=t.prototype;return i.initialize=function(){var e=this;e.txt_gsz.align="center",e.txt_gsz.visible=e.txt_name.visible=!0,e.txt_gsz.width=e.txt_name.width=415,e.txt_gsz.x=e.txt_name.x=152,e.txt_rank&&(e.txt_rank.visible=!1),e.txt_title.text=ed.n[1858],e.txt_name.color=e.txt_gsz.color,e.txt_guildName.visible=!1},i.onGain=function(){Y.timer.clearAll(this),On.ins.isOpen("RELIVE_TIPS")&&On.ins.close("RELIVE_TIPS"),ha.ins.changeSceneUI(54,!1),Os.firstAtt=!0,Os.firstDef=!0,ha.ins.exitCopy(300),On.ins._closePanelForce(this)},i.update=function(e){var t=this;if(e instanceof protos.guild.toc_30785){t.isWin=e.isWin;var i=e.list;t._ctn.setGoodsItems(i,4),t._ctn.x=(t.width-t._ctn.contentWidth)/2,t.txt_gsz.text=ed.n[1859]+(e?e.myDamage:0),t.txt_name.text=ed.n[1860]+(e?e.totalDamage:0),t._remainSec=9,t.timerLoop(1e3,t,t.onTimer),t.onTimer()}},i.onTimer=function(){if(this._remainSec<0)return this.clearTimer(this,this.onTimer),void this.onGain();this.txt_time.changeText("("+this._remainSec+"s)"),this._remainSec--},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_gain.clickHandler=ms.create(t,t.onGain,null,!1),t._ctn=new ga(4),t._ctn.pos(3,502),t._ctn.size(560,335),t._ctn._spaceX=10,t._ctn._spaceY=47,t._ctn._vScrollBarSkin="",t._ctn._hScrollBarSkin=null,t._ctn._gsimpleName=!0,t.addChild(t._ctn),gi.ins.show(t)},i.onRemove=function(e){this.btn_gain.clickHandler=null,this._ctn&&this._ctn.removeSelf(),this._ctn=null,ui.SubPanel.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer)},i.destroy=function(e){void 0===e&&(e=!0),this.destoryImage(this),Y.timer.clearAll(this),this.graphics.clear(),ui.SubPanel.prototype.destroy.call(this,e)},t}(),P_=function(e){function t(){this._imgIcon=null,this._font1=null,this.missionId=0,t.__super.call(this),this.centerY=this.centerX=0}u(t,"modules.guild.views.domain.scene.GuildKun_CallView",Wo);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.clearOverdueTextures()},i.initialize=function(){var e=this;null==e._imgIcon&&(e._imgIcon=new Dl,e.addChild(e._imgIcon),e._imgIcon.centerX=0,e._imgIcon.centerY=-145,e._imgIcon.scrollRect=new qo(0,0,132,132),e._imgIcon.scale(1.2,1.2)),e._font1=new fi(e.txt_name.fontSize),ti.replace(e.txt_name,e._font1)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btnGo.on("click",this,this.onClick),this.btnClose.on("click",this,this.onClose)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btnGo.off("click",this,this.onClick),this.btnClose.off("click",this,this.onClose)},i.clearOverdueTextures=function(){var e=this._imgIcon.skin;mi.clearRes(e),mi.clearTextureRes(e),un.ins.clearTexture(e)},i.update=function(e){this.missionId=e;var t=uo.getIndex(e),i=uo.MODEL.bossId(t),s=Xl.getIndex(i),n=Xl.MODEL.muId(s),o=Cs.getIndex(n),a=Or.getBossPath(Cs.MODEL.headId(o));this._imgIcon.skin=a;var r=Xl.MODEL.name(s);this._font1.append(r,"#ff2e24"),this._font1.append(ed.n[1861]),this._font1.x=(this.width-this._font1.contentW)/2},i.onClick=function(e){de.ins.neverNotice=this.chk.selected,on.reqEntry(this.missionId),this.onClose(e)},i.onClose=function(e){On.ins.close("GUILD_KUN_CALL_VIEW")},t}(),N_=function(e){function t(){this.isSelect=!1,t.__super.call(this)}u(t,"modules.guild.views.manage.GuildApplyMngView",_r);var i=t.prototype;return i.initialize=function(){var e=this;e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.spaceY=16,e.list.visible=!1,e.chk.on("click",e,e.onClick),ke.ins.myGuildBaseToc&&(e.isSelect=e.chk.selected=1==ke.ins.myGuildBaseToc.applyMode,e.input_power.text=ke.ins.myGuildBaseToc.needPower+"")},i.onClick=function(e){e.target==this.chk&&ke.ins.myGuildBaseToc.minePos<=2?(this.isSelect=!this.isSelect,this.chk.selected=this.isSelect):e.target==this.btn_close&&this.close()},i.onCellRender=function(e,t){var i=this.list.array[t];e.txt_name.changeText(i.name),e.txt_power.changeText(ur.getBigIntStr(i.power)),e.img_head.skin=Or.getActorHeadPath(i.job,i.sex),e.btn_agree.on("click",this,this.onCellBtnClick,[0,i.id,t]),e.btn_reject.on("click",this,this.onCellBtnClick,[1,i.id,t])},i.onCellBtnClick=function(e,t,i){if(0==e){var s=new Mo;s.list=[t],Fl.sendToService(s)}else{var n=new Pl;n.list=[t],Fl.sendToService(n)}this.list.deleteItem(i)},i.onBtnClick=function(e){},i.update=function(e){e instanceof protos.guild.toc_12910&&(!this.list.visible&&(this.list.visible=!0),this.list.dataSource=e.list,this.txt_no.visible=this.list.length<1,this.g_mask.visible=5<this.list.length)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClick),t.chk.on("click",t,t.onClick);var i=new Ue;Fl.sendToService(i),t.txt_no.visible=t.g_mask.visible=!1,t.list.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),ke.ins.reqReddot(1,4,3,6,10,8,7);var i=t.isSelect?1:0,s=parseInt(ur.trim(t.input_power.text));if(ke.ins.myGuildBaseToc.needPower!=s||ke.ins.myGuildBaseToc.applyMode!=i){ke.ins.myGuildBaseToc.applyMode=i;var n=new Ea;n.applyMode=i,n.needPower=s,Fl.sendToService(n)}t.btn_close.off("click",t,t.onClick),t.chk.off("click",t,t.onClick),t.list.scrollBar.off("change",t,t.onScrollChanged)},t}(),G_=function(e){function t(){this.DEFAULT_TEXT=ed.n[1862],this.createIndex=0,this.vipLimitArr=null,this.ybLimit=null,t.__super.call(this)}u(t,"modules.guild.views.manage.GuildCreateView",Gn);var i=t.prototype;return i.initialize=function(){var e=this;e.btn_confirm.clickHandler=ms.create(e,e.onConfirmClick,null,!1),e.vipLimitArr=[],e.ybLimit=[],e.input.on("focus",e,e.onInputFocusChange);var t=ge.MODEL.conditions(0),i=JSON.parse(t);for(var s in i)"rechargeGold"==i[s].type?(e.txt_limit1.innerHTML="(充值"+nc.createColor(i[s].value+"","#23b11f")+ed.n[1863],e.vipLimitArr.push(0)):"playerVipLevel"==i[s].type&&(e.txt_limit1.innerHTML="("+nc.createColor("VIP"+i[s].value,"#23b11f")+ed.n[1864],e.vipLimitArr.push(i[s].value));for(var n in t=ge.MODEL.conditions(1),i=JSON.parse(t))"playerVipLevel"==i[n].type&&(e.txt_limit2.innerHTML="("+nc.createColor("VIP"+i[n].value,"#23b11f")+ed.n[1865],e.vipLimitArr.push(i[n].value));e.txt_level1.changeText("1级"),e.txt_tips1.changeText("容纳"+xr.MODEL.capacity(0)+ed.n[1866]),0<ge.MODEL.addDonate(0)?e.txtward1.changeText("返还"+ge.MODEL.addDonate(0)+ed.n[1867]):e.txtward1.changeText(""),e.txt_commose1.innerHTML=ed.n[1868]+nc.createColor(an.createStr(ge.MODEL.consumptions(0)).goodsNum+"","#e6d80d")+"元宝",e.txt_level2.changeText("2级"),e.txt_tips2.changeText("容纳"+xr.MODEL.capacity(1)+ed.n[1869]),0<ge.MODEL.addDonate(1)?e.txt_ward2.changeText("返还"+ge.MODEL.addDonate(1)+ed.n[1870]):e.txt_ward2.changeText(""),e.txt_commose2.innerHTML=ed.n[1871]+nc.createColor(an.createStr(ge.MODEL.consumptions(1)).goodsNum+"","#e6d80d")+"元宝",e.ybLimit.push(an.createStr(ge.MODEL.consumptions(0)).goodsNum),e.ybLimit.push(an.createStr(ge.MODEL.consumptions(1)).goodsNum),e.sp1.on("click",e,e.onCellClick,[e.sp1]),e.sp2.on("click",e,e.onCellClick,[e.sp2]),e.kuang1.visible=!0,e.kuang1.mouseEnabled=!1,e.kuang2.visible=!1,e.kuang2.mouseEnabled=!1},i.onCellClick=function(e){e==this.sp1?(this.createIndex=0,this.kuang1.visible=!0,this.kuang2.visible=!1):e==this.sp2&&(this.createIndex=1,this.kuang1.visible=!1,this.kuang2.visible=!0)},i.onInputFocusChange=function(){this.input.focus&&this.input.text==this.DEFAULT_TEXT&&(this.input.text="")},i.update=function(e){},i.onConfirmClick=function(){var e=this,t=ur.trim(e.input.text);if(t&&t!=ed.n[1872])if(Gi.ins.VIPLevel<e.vipLimitArr[e.createIndex])Vl.ins.showMsg(ed.n[1874]+e.vipLimitArr[e.createIndex]+"级",1);else if(Gi.ins.YB<e.ybLimit[e.createIndex])ja.ins.showNoGold();else{if(0==e.createIndex){var i=ge.MODEL.conditions(0),s=JSON.parse(i);for(var n in s)if("rechargeGold"==s[n].type&&X.ins.toc_info.totalPay<s[n].value)return void Vl.ins.showById2(4878,[],1)}ja.ins.show(ed.n[1875]+e.ybLimit[e.createIndex]+ed.n[1876]+(e.createIndex+1)+ed.n[1877]+t+ed.n[1878],ms.create(e,e.alertConfirm,[t]))}else Vl.ins.showMsg(ed.n[1873],1)},i.alertConfirm=function(e,t){if(1==t){var i=new yt;i.guildname=e,i.guildType=this.createIndex+1,Fl.sendToService(i)}},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.input.text=this.DEFAULT_TEXT,this.btn_close.on("click",this,this.onClick)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick)},i.onClick=function(e){e.target==this.btn_close&&this.close()},t}(),U_=function(e){function t(){this.sp_reddot=null,this.shawArr=null,t.__super.call(this)}u(t,"modules.guild.views.manage.GuildMng_FuncView",St);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.destroy=function(e){var t=this;void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(t,e),Y.loader.getRes(t.guildfunbg.skin)&&Y.loader.clearRes(t.guildfunbg.skin,!0),Y.loader.getRes(t.shaw_active.skin)&&Y.loader.clearRes(t.shaw_active.skin,!0),Y.loader.getRes(t.shaw_shacheng.skin)&&Y.loader.clearRes(t.shaw_shacheng.skin,!0),Y.loader.getRes(t.shaw_boss.skin)&&Y.loader.clearRes(t.shaw_boss.skin,!0),Y.loader.getRes(t.shaw_hall.skin)&&Y.loader.clearRes(t.shaw_hall.skin,!0),Y.loader.getRes(t.shaw_shop.skin)&&Y.loader.clearRes(t.shaw_shop.skin,!0)},i.initialize=function(){var e=this;e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.scrollBar.elasticBackTime=160,e.list.scrollBar.elasticDistance=80,e.list.visible=!1,e.shawArr=[e.shaw_active,e.shaw_shacheng,e.shaw_boss,e.shaw_hall,e.shaw_shop];for(var t=0;t<e.shawArr.length;t++)e.shawArr[t]&&(e.shawArr[t].alpha=.1);e.sp_reddot=new rn,e.addChild(e.sp_reddot)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_active.off("mousedown",t,t.onBtnDonwClick,[t.btn_active]),t.btn_hall.off("mousedown",t,t.onBtnDonwClick,[t.btn_hall]),t.btn_boss.off("mousedown",t,t.onBtnDonwClick,[t.btn_boss]),t.btn_pk.off("mousedown",t,t.onBtnDonwClick,[t.btn_pk]),t.btn_shop.off("mousedown",t,t.onBtnDonwClick,[t.btn_shop]),t.btn_active.off("mouseup",t,t.onBtnUpClick,[t.btn_active]),t.btn_hall.off("mouseup",t,t.onBtnUpClick,[t.btn_hall]),t.btn_boss.off("mouseup",t,t.onBtnUpClick,[t.btn_boss]),t.btn_pk.off("mouseup",t,t.onBtnUpClick,[t.btn_pk]),t.btn_shop.off("mouseup",t,t.onBtnUpClick,[t.btn_shop]),t.shaw_shacheng.off("mousedown",t,t.onBtnDonwClick,[t.btn_active]),t.shaw_hall.off("mousedown",t,t.onBtnDonwClick,[t.btn_hall]),t.shaw_boss.off("mousedown",t,t.onBtnDonwClick,[t.btn_boss]),t.shaw_active.off("mousedown",t,t.onBtnDonwClick,[t.btn_pk]),t.shaw_shop.off("mousedown",t,t.onBtnDonwClick,[t.btn_shop]),t.shaw_shacheng.off("mouseup",t,t.onBtnUpClick,[t.btn_active]),t.shaw_hall.off("mouseup",t,t.onBtnUpClick,[t.btn_hall]),t.shaw_boss.off("mouseup",t,t.onBtnUpClick,[t.btn_boss]),t.shaw_active.off("mouseup",t,t.onBtnUpClick,[t.btn_pk]),t.shaw_shop.off("mouseup",t,t.onBtnUpClick,[t.btn_shop])},i.onCellRender=function(e,t){e.graphics.clear();var i=this.list.array[t];e.txt_name.changeText(i.name),e.txt_pos.changeText(bi.getCNPos(i.pos)),e.txt_contrib.changeText(""+i.dayContrib)},i.onBtnDonwClick=function(e){for(var t=this,i=0;i<t.shawArr.length;i++)t.shawArr[i]&&(t.shawArr[i].alpha=.1);e==t.btn_pk||e==t.shaw_shacheng?t.shaw_shacheng.alpha=1:e==t.btn_hall||e==t.shaw_hall?t.shaw_hall.alpha=1:e==t.btn_boss||e==t.shaw_boss?t.shaw_boss.alpha=1:e==t.btn_active||e==t.shaw_active?t.shaw_active.alpha=1:e!=t.btn_shop&&e!=t.shaw_shop||(t.shaw_shop.alpha=1)},i.onBtnUpClick=function(e){var t=this;e==t.btn_pk||e==t.shaw_shacheng?(On.ins.open("GUILD_PK_MAINVIEW",null,0),t.shaw_shacheng.alpha=.1):e==t.btn_hall||e==t.shaw_hall?(On.ins.open("GUILD_BASE_MAINVIEW",null,0),t.shaw_hall.alpha=.1):e==t.btn_boss||e==t.shaw_boss?(On.ins.open("GUILD_BOSS_MAINVIEW",{_subId_:1},0),t.shaw_boss.alpha=.1):e==t.btn_active||e==t.shaw_active?(On.ins.open("GUILD_SKILL_MAINVIEW",null,0),t.shaw_active.alpha=.1):e!=t.btn_shop&&e!=t.shaw_shop||(Fl.sendToModule("OPEN_SHOP_VIEW",["modules.guild.GuildModule"]),t.shaw_shop.alpha=.1)},i.updateByVSC=function(e){if(e instanceof protos.guild.toc_12906){var t=e.memList;1<t.length&&(t=_s.sortOn(t,["dayContrib"],[Array.DESCENDING])),!this.list.visible&&(this.list.visible=!0),this.list.dataSource=t}else e instanceof protos.guild.toc_12965&&this.updateReddot()},i.updateReddot=function(){var e=this;e.sp_reddot.graphics.clear(),ke.ins.isReddot(4,5)&&e.drawReddot(e.btn_active),ke.ins.isReddot(1,2,3)&&e.drawReddot(e.btn_hall),ke.ins.isReddot(7,14,15,17)&&e.drawReddot(e.btn_boss),ke.ins.isReddot(8,11,12,13)&&e.drawReddot(e.btn_pk),ke.ins.isReddot(16)&&e.drawReddot(e.btn_shop)},i.drawReddot=function(e){var t=Y.loader.getRes(jc.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+48,e.y-1,t.width,t.height)},i.showByVSC=function(e,t){!ke.ins.tc_myGuildMems.invalid()&&ke.ins.myGuildMemList&&this.updateByVSC(ke.ins.myGuildMemList),this.updateReddot()},i.hideByVSC=function(e,t){},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),ke.ins.tc_myGuildBase.invalid(),ke.ins.reqReddot(1,2,5,4,3,6,16,10,8,7,11,12,13,15,17),t.btn_active.on("mousedown",t,t.onBtnDonwClick,[t.btn_active]),t.btn_hall.on("mousedown",t,t.onBtnDonwClick,[t.btn_hall]),t.btn_boss.on("mousedown",t,t.onBtnDonwClick,[t.btn_boss]),t.btn_pk.on("mousedown",t,t.onBtnDonwClick,[t.btn_pk]),t.btn_shop.on("mousedown",t,t.onBtnDonwClick,[t.btn_shop]),t.btn_active.on("mouseup",t,t.onBtnUpClick,[t.btn_active]),t.btn_hall.on("mouseup",t,t.onBtnUpClick,[t.btn_hall]),t.btn_boss.on("mouseup",t,t.onBtnUpClick,[t.btn_boss]),t.btn_pk.on("mouseup",t,t.onBtnUpClick,[t.btn_pk]),t.btn_shop.on("mouseup",t,t.onBtnUpClick,[t.btn_shop]),t.shaw_shacheng.on("mousedown",t,t.onBtnDonwClick,[t.shaw_shacheng]),t.shaw_hall.on("mousedown",t,t.onBtnDonwClick,[t.shaw_hall]),t.shaw_boss.on("mousedown",t,t.onBtnDonwClick,[t.shaw_boss]),t.shaw_active.on("mousedown",t,t.onBtnDonwClick,[t.shaw_active]),t.shaw_shop.on("mousedown",t,t.onBtnDonwClick,[t.shaw_shop]),t.shaw_shacheng.on("mouseup",t,t.onBtnUpClick,[t.shaw_shacheng]),t.shaw_hall.on("mouseup",t,t.onBtnUpClick,[t.shaw_hall]),t.shaw_boss.on("mouseup",t,t.onBtnUpClick,[t.shaw_boss]),t.shaw_active.on("mouseup",t,t.onBtnUpClick,[t.shaw_active]),t.shaw_shop.on("mouseup",t,t.onBtnUpClick,[t.shaw_shop])},t}(),H_=function(e){function t(){this.strLevel=null,this.playerId=NaN,t.__super.call(this)}u(t,"modules.guild.views.manage.GuildMng_GuildInfoView",_e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_check.on("click",t,t.checkOther),t.btn_chat.on("click",t,t.priChat),t.btn_block.on("click",t,t.onBlockClicked),t.btn_friend.on("click",t,t.onFriendBtnClicked)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_check.off("click",t,t.checkOther),t.btn_chat.off("click",t,t.priChat),t.btn_block.off("click",t,t.onBlockClicked),t.btn_friend.off("click",t,t.onFriendBtnClicked)},i.checkOther=function(e){To.reqViewOther(this.playerId)},i.priChat=function(e){yf.instance.isFriend(this.playerId)?wf.instance.isInit?On.ins.isOpen("FRIENDNEWMAINVIEW")?(yf.instance.currentSelectedPlayerID=this.playerId,Fl.sendToModule("OPEN_SELECT_PLAYER",["modules.friendnew.FriendNewModule"])):On.ins.open("FRIENDNEWMAINVIEW"):(yf.instance.needToShowView=!0,yf.instance.currentSelectedPlayerID=this.playerId,Sf.requestAllRecord()):Vl.ins.showMsg(ed.n[1879],1)},i.onBlockClicked=function(e){yf.instance.isFriendOpen()?Sf.requestAddFriend(this.playerId,2):Vl.ins.showById(4e3,1)},i.onFriendBtnClicked=function(e){yf.instance.isFriendOpen()?yf.instance.isFriend(this.playerId)?Vl.ins.showMsg(ed.n[1880],1):Sf.requestAddFriend(this.playerId,1):Vl.ins.showById(4e3,1)},i.updateGuildInfo=function(e){var t=e;this.playerId=t.id,this.strLevel="";zs.ins.actorById(0);this.img_head.skin=Or.getActorHeadPath(t.job,t.sex),this.txt_playerName.changeText(e.name),this.strLevel=ed.n[1881]+e.totalContrib,this.txt_level.changeText(this.strLevel),ke.ins.myGuildBaseToc.guildName?this.txt_guildName.changeText(ke.ins.myGuildBaseToc.guildName):this.txt_guildName.changeText(ed.n[1882])},t}(),F_=function(e){function t(){this.OP_EXIT=0,this.OP_CREATE=1,this.OP_JIESAN=2,this.id=null,t.__super.call(this),this.centerX=0,this.y=250}u(t,"modules.guild.views.manage.GuildMng_ListView",us);var i=t.prototype;return i.initialize=function(){var e=this;e.list.renderHandler=ms.create(e,e.onCellRender,null,!1),e.list.vScrollBarSkin="",e.list.spaceY=15,e.list.scrollBar.elasticBackTime=300,e.list.scrollBar.elasticDistance=100,e.list.visible=!1,e.id="GUILD_MNG_GINFO_VIEW",e.btn_op.clickHandler=ms.create(e,e.onOpBtnClick,null,!1)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_no.visible=!1,this.btn_close.on("click",this,this.onClick),this.list.scrollBar.on("change",this,this.onScrollChanged),this.showByVSC()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onClick=function(e){e.target==this.btn_close&&this.close()},i.close=function(){this.id?On.ins.close(this.id):this.event("close",this)},i.onCellRender=function(e,t){var i=this.list.array[t],s=i.rank,n=i.level;e.img_r_1.visible=s<=3,e.img_r_1.visible&&(e.img_r_1.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+s+".png")),3<s?(e.txt_rank.visible=!0,e.txt_rank.text=""+s):e.txt_rank.visible=!1,e.txt_guild.text=i.name,e.txt_champion.changeText("会长："+i.male),e.txt_level.changeText("(Lv."+n+")"),e.txt_level.x=e.txt_guild.x+e.txt_guild.textWidth+2,e.txt_level.repaint();var o=0,a=i.buildList,r=1,l=0;for(l=0;l<a.length;l++)3==a[l].type&&(r=a[l].level);for(l=0;l<d.count;l++)3==d.MODEL.buildId(l)&&d.MODEL.level(l)==r&&(o=d.MODEL.capacity(l));e.txt_num.changeText("人数："+i.memOwn+"/"+o),e.btn_apply.disabled=1==i.status,e.btn_apply.label="申 请",e.btn_apply.on("click",this,this.onCellBtnClick,[t]),0==i.needPower?e.txt_need.changeText(ed.n[1883]):e.txt_need.changeText(ed.n[1884]+ur.getBigIntStr(0|i.needPower))},i.onCellBtnClick=function(e){var t=this.list.array[e];if(0==t.status){var i=0|t.needPower;if(Gi.ins.force<i&&1==t.applyMode)return void Vl.ins.showMsg(ed.n[1885],1);var s=new Rl;s.guildId=t.id,Fl.sendToService(s),t.status=1}else{var n=new Gl;n.guildId=t.id,Fl.sendToService(n),t.status=0}this.list.changeItem(e,t)},i.onShowGuildInfo=function(e){On.ins.open("GUILD_MNG_GINFO_VIEW",e)},i.onOpBtnClick=function(){switch(this.btn_op.tag){case this.OP_CREATE:On.ins.open("GUILD_CREATE_VIEW");break;case this.OP_EXIT:var e=ed.n[1886]+nc.newline()+nc.createColor(ed.n[1887],"#e70909");ja.ins.show(e,ms.create(this,this.onConfirmCallback,[1]));break;case this.OP_JIESAN:e=ed.n[1888]+nc.newline()+nc.createColor(ed.n[1889],"#e70909"),ja.ins.show(e,ms.create(this,this.onConfirmCallback,[2]))}},i.onConfirmCallback=function(e,t){if(1==t)if(1==e){var i=new xo;Fl.sendToService(i)}else if(2==e){var s=new wo;Fl.sendToService(s)}},i.updateByVSC=function(e){e instanceof protos.guild.toc_12904&&this.updateList(e),this.updateOpBtnStatus()},i.updateList=function(e){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=e.list,this.txt_no.visible=e.list.length<1,this.g_mask.visible=5<e.list.length},i.updateOpBtnStatus=function(){var e=this;if(ke.ins.joinGuild)if(1==ke.ins.myPos){var t=ke.ins.myGuildMemList?ke.ins.myGuildMemList.memList.length:0;e.btn_op.disabled=!1,e.btn_op.visible=1==t,e.btn_op.label=ed.n[1890],e.btn_op.tag=e.OP_JIESAN}else e.btn_op.disabled=!1,e.btn_op.label=ed.n[1891],e.btn_op.tag=e.OP_EXIT;else e.btn_op.disabled=!1,e.btn_op.label=ed.n[1892],e.btn_op.tag=e.OP_CREATE},i.showByVSC=function(){!ke.ins.tc_allGuildInfo.invalid()&&ke.ins.allGuildToc&&this.updateByVSC(ke.ins.allGuildToc),ke.ins.joinGuild&&(!ke.ins.tc_myGuildMems.invalid()&&ke.ins.myGuildMemList&&this.updateByVSC(ke.ins.myGuildMemList),!ke.ins.tc_myGuildBase.invalid()&&ke.ins.myGuildBaseToc&&this.updateByVSC(ke.ins.myGuildBaseToc))},i.hideByVSC=function(e,t){},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),z_=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.manage.GuildMng_MainView",t);var i=e.prototype;return i.initialize=function(){this.size(720,1280),this.centerX=this.centerY=0,this.vsc=new o(this),this.vsc.registAll([{cls:U_,id:"SUB_MNG_FUNC",isHideBg:!0,grayTip:ed.n[1893]}])},i.onSelectedView=function(e,t){},i.onVscFilter=function(e,t){if(!ke.ins.joinGuild)return"SUB_MNG_FUNC"==e||"SUB_MNG_BASE"==e||"SUB_MNG_SIEGE"==e?1:0;if("SUB_MNG_FUNC"==e){if(ke.ins.isReddot(4,3,6,8,7))return 3}else if("SUB_MNG_BASE"==e){if(ke.ins.isReddot(1))return 3}else if("SUB_MNG_SIEGE"==e&&ke.ins.isReddot(10))return 3;return 0},i.onAdd=function(e){t.prototype.onAdd.call(this,e),ke.ins.reqReddot(1,4,3,6,10,8,7),this.layout.head_bar.visible=!1,ta.instance.reqLastRank()},i.onRemove=function(e){t.prototype.onRemove.call(this,e),this.layout.head_bar.visible=!0},e}(jr),W_=function(e){function t(){this._text=null,t.__super.call(this)}u(t,"modules.guild.views.manage.GuildModifyNoteView",tt);var i=t.prototype;return i.initialize=function(){this.btn_confirm.clickHandler=ms.create(this,this.onConfirm,null,!1)},i.onInput=function(){54<this.txt_note.text.length?this.txt_note.text=this._text:this._text=this.txt_note.text},i.onConfirm=function(){var e=ur.rtrim(this.txt_note.text);if(!e||e.length<2||e.length>this.txt_note.maxChars)Vl.ins.showById(2015,1);else{if(e!=ke.ins.myGuildBaseToc.guildNote){var t=new Cc;t.guildNote=e,Fl.sendToService(t)}this.close()}},i.onAdd=function(e){var t=this;if(ui.SubPanel.prototype.onAdd.call(t,e),ke.ins.myGuildBaseToc){var i=ke.ins.myGuildBaseToc.guildNote;t.txt_note.text=t._text=i||"",t.btn_close.on("click",t,t.onClick),t.txt_note.on("input",t,t.onInput)}else t.close()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick),this.txt_note.off("input",this,this.onInput)},i.onClick=function(e){e.target==this.btn_close&&this.close()},t}(),j_=function(i){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.raisekun.RaiseKunMasterMainView",i);var t=e.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=[],e.vsc=new o(e),e.vsc.registAll([{cls:Y_,id:0,isHideBg:!0}]),e.vsc.selectHandler=ms.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ms.create(e,e.checkTips,null,!1)},t.onAdd=function(e){i.prototype.onAdd.call(this,e);var t=new ni;Fl.sendToService(t)},t.onRemove=function(e){i.prototype.onRemove.call(this,e)},t.checkTips=function(e){return 0},t.onSubChanged=function(e,t){this.setTitle(Or.getAtlasSubPath("raisekun/ghhj_title_ykds.png"))},t.showPanel=function(e,t){},t.closePanel=function(e,t){},e.NAME="RaiseKunMasterMainView",e}(jr),q_=function(e){function t(){this._skillGrid=null,this._curSkillVo=null,this._gridRes=null,this._oldSelectIdx=-1,this._listArr=null,t.__super.call(this)}u(t,"modules.guild.views.raisekun.RaiseKunMasterSkillView",xi);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.listType.itemRender=K_,e.listType.hScrollBarSkin="",e.listType.repeatX=6,e.listType.selectEnable=!0,e.listType.mouseEnabled=!0,e._skillGrid=new K_,e._skillGrid.y=190,e._skillGrid.centerX=0,e.addChild(e._skillGrid),e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x+51,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes),e.listType.selectHandler=ms.create(e,e.onSelectedHandler,null,!1)},i.onSelectedHandler=function(e){this._oldSelectIdx=e,this.btnNext.visible=e!=this._listArr.length-1,this.listType.tweenTo(e),this._curSkillVo=this.listType.getItem(e),this.updatePanel()},i.updateByVSC=function(e){var t=this;if(e)if("BP_UPDATE"!=e.actionOrder){t._listArr=[];var i=Qh.ins.skillInfo;for(var s in i){var n=i[s];for(var o in n)t._listArr.push(n[o])}t.listType.array=t._listArr,e instanceof modules.guild.others.RaiseKunSkillVo?(t._curSkillVo=e,t.listType.selectedIndex=t._listArr.indexOf(e)):t.onSelectedHandler(t._oldSelectIdx),Y.timer.once(100,t,t.onScrollEnd)}else t.updateConsume()},i.onClickConsume=function(e){this._gridRes&&this._gridRes._doShowToolTip()},i.updatePanel=function(){var e=this;e._skillGrid.update(e._curSkillVo),e._skillGrid.labLock.visible=!1,e._skillGrid.imgMask.visible=!1,e._skillGrid.imgRed.visible=!1,e.htmlCurDesc.innerHTML=e._curSkillVo.skillDesc,0<e._curSkillVo.nextIdx&&0<e._curSkillVo.level?(e.boxNext.visible=!0,e.boxNext.y=549,e.htmlNextDesc.innerHTML=e._curSkillVo.nextDesc,e.boxList.y=749,e.imgBlackBg.height=805,e.height=1080,e.boxConsume.bottom=43):(e.boxNext.visible=!1,e.imgBlackBg.height=611,e.boxList.y=556,e.height=845,e.boxConsume.bottom=20),e.fightNum.value=e._curSkillVo.fight,e.updateConsume()},i.updateConsume=function(){var e=this;if(0<e._curSkillVo.nextIdx){e.imgMax.visible=!1,e.boxConsume.visible=!0,e.btnUp.label=0==e._curSkillVo.level?"激 活":"提 升";var t=e._curSkillVo.consume;if(t){var i=JSON.parse(t)[0].value.split(":"),s=parseInt(i[0]),n=parseInt(i[1]),o=ri.ins.getGoodsNum(s);e._gridRes.bindData=an.create(s),e.htmlCost.innerHTML=n<=o?nc.createColor(o+"","#23b11f")+"/"+n:nc.createColor(o+"","#ff2e24")+"/"+n,e.imgRedP.visible=e._curSkillVo.canOper}}else e.boxConsume.visible=!1,e.imgMax.visible=!0},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.on("click",t,t.onClick),t.listType.scrollBar.on("change",t,t.onScrollChanged),t.listType.scrollBar.on("end",t,t.onScrollEnd),t.txt_cost.on("click",t,t.onClickConsume),t.htmlCost.on("click",t,t.onClickConsume),Zl.panelLayer.on("click",t,t.onClickClose)},i.onClickClose=function(e){On.ins.close("SoulSkinGoodsTip")},i.onScrollChanged=function(){0<this.listType.scrollBar.value?this.btnPre.visible=!0:this.btnPre.visible=!1,this.onScrollEnd()},i.onScrollEnd=function(){this.imgNextRed.visible=this.getRRedPt(),this.imgPreRed.visible=this.getLRedPt()},i.getRRedPt=function(){var e=0;for(e=this.listType.startIndex+4;e<this._listArr.length;e++){if(this.listType.getItem(e).canOper)return!0}return!1},i.getLRedPt=function(){var e=0;for(e=this.listType.startIndex-1;0<=e;e--){var t=this.listType.getItem(e);if(t&&t.canOper)return!0}return!1},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.txt_cost.off("click",t,t.onClickConsume),t.htmlCost.off("click",t,t.onClickConsume),t.listType.scrollBar.off("change",t,t.onScrollChanged),t.listType.scrollBar.off("end",t,t.onScrollEnd),Zl.panelLayer.off("click",t,t.onClickClose)},i.onClick=function(e){var t=this;switch(e.target){case t.btnUp:if(!t._curSkillVo)return;var i=new ii;i.skillType=t._curSkillVo.skillType,Fl.sendToService(i);break;case t.btnPre:var s=t.listType.selectedIndex;--s<0&&(s=0),t.listType.selectedIndex=s;break;case t.btnNext:var n=t.listType.selectedIndex;++n>=t._listArr.length&&(n=t._listArr.length-1),t.listType.selectedIndex=n;break;case t.btnClose:On.ins.close("RaiseKunMasterSkillView")}},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},t.NAME="RaiseKunMasterSkillView",t}(),Y_=function(e){function t(){var e=this;e.CONSUMEID=2381,e._skillLeft=null,e._skillRight=null,e._skillGrid=null,e._curShowStep=0,e._curRealStep=-1,e._curStars=-1,e._gridRes=null,e._kunVo=null,e._effectSuc=null,e._openSkill=!1,e._openSkillGdto=null,e._skills=null,e._hasData=!1,e._canUp=!1,e._effs=new Array,t.__super.call(e)}u(t,"modules.guild.views.raisekun.RaiseKunMasterView",Zi);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e._skillLeft=new K_,e._skillLeft.pos(20,270),e.addChild(e._skillLeft),e._skillRight=new K_,e._skillRight.pos(606,270),e.addChild(e._skillRight),e._skillGrid={},e._skillGrid[1]=e._skillLeft,e._skillGrid[2]=e._skillRight,e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x+51,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e._gridRes.bindData=an.create(e.CONSUMEID),e.boxConsume.addChild(e._gridRes)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.updateBtnSkillRed(),t.on("click",t,t.onClick),t.img_costBg.on("click",t,t.onClickConsume),t.txt_cost.on("click",t,t.onClickConsume),t.html_cost.on("click",t,t.onClickConsume),t._skillLeft.on("click",t,t.onClickSkill),t._skillRight.on("click",t,t.onClickSkill)},i.onClickConsume=function(e){this._gridRes&&this._gridRes._doShowToolTip()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),Y.timer.clear(t,t.checkOpenSkill),t.off("click",t,t.onClick),t._skillLeft.off("click",t,t.onClickSkill),t._skillRight.off("click",t,t.onClickSkill),t.img_costBg.off("click",t,t.onClickConsume),t.txt_cost.off("click",t,t.onClickConsume),t.html_cost.off("click",t,t.onClickConsume),t._effectSuc&&t._effectSuc.dispose(),t._effectSuc=null},i.checkOpenSkill=function(){this._openSkill&&this._hasData&&(Y.timer.clear(this,this.checkOpenSkill),this._openSkill=!1,On.ins.open("RaiseKunMasterSkillView",Qh.ins.getSkillByGoods(this._openSkillGdto)))},i.updateByVSC=function(e){var t=this;if(e){if(e.openSkill)return t._openSkill=!0,t._openSkillGdto=e.dto,void Y.timer.loop(100,t,t.checkOpenSkill);if("BP_UPDATE"==e.actionOrder||"10205"==e.actionOrder)return t.updateBtnSkillRed(),void t.updateConsume();t._kunVo=Qh.ins.kunVo,t._effectSuc&&t._effectSuc.dispose(),t._effectSuc=null,-1!=t._curRealStep&&t._curRealStep!=t._kunVo.step||-1!=t._curStars&&t._curStars!=t._kunVo.star&&(t._effectSuc=ti.createEffect("jm0011",t.width/2,t.height/2+40,t)),t._curRealStep=t._kunVo.step,t._curStars=t._kunVo.star,t.curShowStep=t._curRealStep,t.updateAttrs(),t.updateConsume(),t.updateBtnSkillRed()}},i.updatePanel=function(){this.imgKun.skin=Or.getFullUrl("ui/images/kunmaster/ghhj_ykds_bg"+this._curShowStep+".jpg"),this.btnPre.visible=1<this.curShowStep,this.btnNext.visible=this.curShowStep<Qh.ins.maxStep,this.updateSkills()},i.updateAttrs=function(){var e,t,i,s=this;s.boxLeft.graphics.clear(),s.boxRight.graphics.clear();var n,o,a,r=0,l=0;for(t=(e=s._kunVo.attr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxLeft,o,"#90877b",a,"#90877b",20,l,24),l+=42;var c=0;for(r=1;r<=3;r++)c+=Ql.ins.getPlusByModule("KUN_MASTER",r);if(s.fight_item.value=Math.floor(f.getFight(t)*(1+c))+Qh.ins.getSkillFight(),l=0,-1<s._kunVo.getNextCfgIdx())for(s.boxCur.x=25,s.boxNext.visible=!0,s.img_arrow.visible=!0,s.boxRight.visible=!0,s.boxLeft.x=86,t=(e=s._kunVo.nextAttr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxRight,o,"#23b11f",a,"#23b11f",20,l,24),l+=42;else s.img_arrow.visible=!1,s.boxRight.visible=!1,s.boxLeft.x=279,s.boxCur.x=210,s.boxNext.visible=!1},i.drawAttr=function(e,t,i,s,n,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(ur.getStringLength(t)*r>>1)+l;return""!=s&&e.graphics.fillText(s,c,a,r+"px 黑体",n,"left"),c+(ur.getStringLength(s)*r>>1)+l},i.updateBalls=function(e){var t=this;for(void 0===e&&(e=0);t._effs.length;){var i=t._effs.pop();i&&i.dispose(),i=null}for(var s=0;s<9;s++)if(s<e){if(t["clip_star"+s]){t["clip_star"+s].index=0;var n=ti.createEffect("jm0009",t["clip_star"+s].width/2,t["clip_star"+s].height/2,t["clip_star"+s]);t._effs.push(n)}t["clip_line"+s]&&(t["clip_line"+s].index=0)}else t["clip_star"+s]&&(t["clip_star"+s].index=1),t["clip_line"+s]&&(t["clip_line"+s].index=1);if(t._curShowStep==t._curRealStep&&e<8){t.imgCurAt.visible=!0,t.imgCurAt.pos(t["clip_star"+e].x+23,t["clip_star"+e].y+24);var o=ti.createEffect("jm0008",t["clip_star"+e].width/2,t["clip_star"+e].height/2,t["clip_star"+e]);t._effs.push(o)}else t.imgCurAt.visible=!1},i.updateSkills=function(){var e=this,t=Qh.ins.skillInfo;if(e._skills=t[e._curShowStep],e._hasData=!0,!e._skills)return e._skillLeft.visible=!1,void(e._skillRight.visible=!1);for(var i in e._skillLeft.visible=!0,e._skillRight.visible=!0,e._skills){var s=e._skills[i],n=e._skillGrid[s.pos];n.update(s),n.tag=s}},i.updateConsume=function(){var e,t=this,i=t._kunVo.getNextCfgIdx();if(t.btn_update.label=t._kunVo.isUpStep?"升 阶":"升 级",-1<i)if(t.boxConsume.visible=!0,t.img_max.visible=!1,t._kunVo.isUpStep)t._canUp=!0,t.labStepUp.visible=!0,t.txt_cost.visible=t._gridRes.visible=t.html_cost.visible=t.img_costBg.visible=!1;else{t.labStepUp.visible=!1,t.txt_cost.visible=t._gridRes.visible=t.html_cost.visible=t.img_costBg.visible=!0;var s=(e=JSON.parse(t._kunVo.consume))[0].value.split(":"),n=0,o=parseInt(s[1]),a=0;"goods"==e[0].type?(n=parseInt(s[0]),a=ri.ins.getGoodsNum(n),t._gridRes.bindData=an.create(n)):"res"==e[0].type&&(a=Gi.ins.kunExp,t._gridRes.bindData=an.create(t.CONSUMEID)),o<=a?(t._canUp=!0,t.html_cost.innerHTML=nc.createColor(a+"","#23b11f")+"/"+o,t.imgTipCanUp.visible=!0):(t._canUp=!1,t.html_cost.innerHTML=nc.createColor(a+"","#ff2e24")+"/"+o,t.imgTipCanUp.visible=!1),t.img_costBg.width=t.html_cost.contextWidth+30}else t.boxConsume.visible=!1,t.img_max.visible=!0},i.onClick=function(e){switch(e.target){case this.btn_update:if(!this._canUp)return void Vl.ins.playErrorMsg(ed.n[1894]);var t;t=new(this._kunVo.isUpStep?Fa:Ya),Fl.sendToService(t);break;case this.btnPre:this.curShowStep--;break;case this.btnNext:this.curShowStep++;break;case this.btnSkill:On.ins.open("RaiseKunMasterSkillView",Qh.ins.getCanOperSkill())}},i.updateBtnSkillRed=function(){this.btnSkill.showTip=Qh.ins.getCanSkillOper()},i.onClickSkill=function(e){var t=e.currentTarget;if(t){var i=t.tag;On.ins.open("RaiseKunMasterSkillView",i)}},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this.imgKun&&this.imgKun.skin&&Y.loader.clearRes(this.imgKun.skin)},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},n(0,i,"curShowStep",function(){return this._curShowStep},function(e){this._curShowStep=e,this.clip_lvl.value=ur.getChineseNum(this._curShowStep)+"阶",this._curShowStep==this._curRealStep?this.updateBalls(this._curStars):this._curShowStep<this._curRealStep?this.updateBalls(9999):this.updateBalls(0),this.updatePanel()}),t}(),K_=function(e){function t(){this._imgSkill=null,t.__super.call(this),this._imgSkill=new Dl,this._imgSkill.pos(7,9),this._imgSkill.width=this._imgSkill.height=100,this.boxSkill.addChild(this._imgSkill)}u(t,"modules.guild.views.raisekun.RaiseKunSkillGrid",e);var i=t.prototype;return i.update=function(e,t){var i=this;void 0===t&&(t=!1),i.imgRed.visible=!1,i.labLock.visible=!1,i.imgMask.visible=!1;var s=Qh.ins.kunVo;e.lockStep<s.step||e.lockStep==s.step&&e.lockStar<=s.star?0==e.level&&e.isShowLockInfo&&(i.imgMask.visible=!0,i.labLock.visible=!0,i.labLock.text="待激活",i.labLock.y=44,i.labLock.color="#07ff00"):(i.imgMask.visible=!0,e.isShowLockInfo&&(i.labLock.visible=!0,i.labLock.text=ur.getChineseNum(e.lockStep)+"阶"+ur.getChineseNum(e.lockStar)+ed.n[1895],i.labLock.y=27,i.labLock.color="#ff0000")),i.labLv.visible=t&&0<e.level,i.labLv.text="Lv."+e.level,i._imgSkill.skin=Or.getIconPath(e.icon),i.labName.text=t?e.skillName.split("L")[0]:e.skillName,i.imgRed.visible=e.canOper;var n=i.getChildByName("selectBox");n&&(n.visible=!1)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){e&&this.update(e,!0)}),t}(mr),J_=function(e){function t(){this.icon=null,this.shopdata=null,this.id=0,this.index=0,this.currCount=0,this.limitCount=0,t.__super.call(this),this.initUI()}u(t,"modules.guild.views.shop.Guild_ShopItem",e);var i=t.prototype;return i.initUI=function(){this.shopdata=Xh.ins,this.icon=new ra,this.icon.pos(29,18),this.addChild(this.icon)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_buy.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_buy.off("click",this,this.onClick)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.setBuyTypeTxet=function(e){var t;switch(e){case 1:t=ed.n[1896];break;case 2:t=ed.n[1897];break;case 3:t=ed.n[1898]}return t},i.setBuyCount=function(e){var t=0;switch(e){case 1:t=Oc.MODEL.dayLimit(this.index);break;case 2:t=Oc.MODEL.weekLimit(this.index);break;case 3:t=Oc.MODEL.foreverLimit(this.index)}return t},i.onClick=function(e){this.limitCount<=0?Vl.ins.showMsg(ed.n[1899],1):this.shopdata.reqBuyGoods(this.id)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t.id=e.id,t.index=Oc.getIndex(t.id);for(var i=Oc.MODEL.buyCondition(t.index),s=JSON.parse(i),n=!0,o=0;o<s.length;o++){var a,r=s[o];if(null==r)return;r.type&&(a=r.type.toLowerCase());var l=parseInt(r.value);"kunlevel"==a&&(n=t.shopdata.kunJieNum>=l)}var c=Oc.MODEL.goodsId(t.index),d=Oc.MODEL.num(t.index),u=an.create(c,d),h=(t.icon.bindData=u).name,_=Co.getByQuality(u.colourId);if(t.txt_goodsName.innerHTML=nc.createColor(h,_),1==n){t.b_buy.visible=!0,t.b_nobuy.visible=!1;var p=e.limitType;t.txt_buyType.text=t.setBuyTypeTxet(p),t.currCount=e.buyNum,t.limitCount=t.setBuyCount(p),t.txt_count.text=t.currCount+"/"+t.limitCount,t.txt_count.color=t.currCount<=0?"#e41b00":"#23b11f",t.txt_price.text=Oc.MODEL.price(t.index)+""}else t.b_buy.visible=!1,t.b_nobuy.visible=!0,t.txt_des.text=ed.n[1900]+l+"阶"}}),t}(Fs),X_=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.shop.Guild_ShopMainView",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=[],e.vsc=new o(e),e.vsc.registAll([{cls:Q_,id:1}]),e.vsc.selectHandler=ms.create(e,e.onSelectedView,null,!1),e.vsc.filterHandler=ms.create(e,e.onFilter,null,!1),e.vsc.invalid()},i.onFilter=function(e,t){return 0},i.onSelectedView=function(e,t){var i="";switch(e){case 1:i="guildstore/ghhj_title_ghsd.png"}this.vsc.updateItemEnabled(),this.setTitle(Or.getAtlasSubPath(i))},i.updateByVSC=function(e){this.vsc&&this.vsc.selectedView&&this.vsc.selectedView instanceof modules.guild.views.shop.Guild_ShopView&&this.vsc.selectedView.updateView(e)},i.onAdd=function(e){t.prototype.onAdd.call(this,e)},i.onRemove=function(e){t.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e)},e}(jr),Q_=function(e){function t(){this.lastTime=0,this.shopData=null,t.__super.call(this),this.initUI()}u(t,"modules.guild.views.shop.Guild_ShopView",Ci);var i=t.prototype;return i.initUI=function(){this.list.itemRender=J_,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.shopData=Xh.ins},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),Xh.ins.reqGuildShopInfo(),t.list.scrollBar.on("change",t,t.onScrollChanged),t.txt_link.on("click",t,t.onClick),t.txt_link2.on("click",t,t.onClick)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.list.scrollBar.off("change",t,t.onScrollChanged),t.txt_link.off("click",t,t.onClick),t.txt_link2.off("click",t,t.onClick);var i=Or.getAtlasSubPath("guildstore/ghhj_title_ghsd.png"),s=Y.loader.getRes(i);s&&s.destroy(),s=null},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateView=function(e){var t=e;this.setTime(t.time);var i=t.jieNum,s=t.levelNum;this.txt_level.text=ed.n[1901]+i+"阶"+s+"级",this.shopData.kunJieNum=t.jieNum;var n=t.myNum;this.txt_myNum.text=n+"";var o=t.goodArr;this.list.dataSource=o},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.img_mask.visible=!1:this.img_mask.visible=!0},i.onClick=function(e){switch(e.currentTarget){case this.txt_link:On.ins.open("RaiseKunMasterMainView",null,0);break;case this.txt_link2:Fl.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:this.shopData.guildmedal})}},i.setTime=function(e){this.lastTime=e,this.showTime(),Y.timer.loop(1e3,this,this.showTime,null,!0)},i.showTime=function(){this.lastTime<=0?(Xh.ins.reqGuildShopInfo(),Y.timer.clear(this,this.showTime)):(this.lastTime--,this.txt_time.innerHTML=V.getSTRDHMS(this.lastTime))},t}(),Z_=function(e){function t(){this.siegeData=null,this.guildArr=[],this.personArr=[],t.__super.call(this),this.siegeData=ta.instance,this.initUI()}u(t,"modules.guild.views.siege.GC_AwardsDayView",ds);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.showRankAwards(),t.showJiFenAwards(),t.btn_left.on("click",t,t.onclick),t.btn_right.on("click",t,t.onclick),t.panel_0.vScrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e);var i,s,n=0;for(n=0;n<t.guildArr.length;n++)(i=t.guildArr[n]).parent&&i.parent.removeChild(i),i=null;for(t.guildArr=[],n=0;n<t.personArr.length;n++)(s=t.personArr[n]).parent&&s.parent.removeChild(s),s=null;t.personArr=[],t.btn_left.off("click",t,t.onclick),t.btn_right.off("click",t,t.onclick),t.panel_0.vScrollBar.off("change",t,t.onScrollChanged)},i.onclick=function(e){e.target==this.btn_left?this.panel_1.hScrollBar.setScroll(0,120,0):e.target==this.btn_right&&this.panel_1.hScrollBar.setScroll(0,120,600)},i.showRankAwards=function(){for(var e,t=this.siegeData.getAwardsList("PersonalRank"),i=0;i<t.length;i++){e=new rp;var s=new Object;s.mingci=ee.MODEL.param(t[i]),s.awards=ee.MODEL.goodsRewardStr(t[i]),e.data=s,e.y=133*i,e.x=10,this.panel_0.addChild(e),this.guildArr.push(e)}},i.showJiFenAwards=function(){this.panel_1.centerX=-5;for(var e,t=this.siegeData.getAwardsList("Score"),i=0;i<t.length;i++){e=new cp;var s=new Object;s.point=ee.MODEL.param(t[i]);var n=ee.MODEL.goodsRewardStr(t[i]);s.goodsid=n.split(",")[0],s.goodsnum=n.split(",")[1],e.data=s,e.x=120*i,this.panel_1.addChild(e),this.personArr.push(e)}},i.initUI=function(){this.panel_0.vScrollBarSkin="",this.panel_0.vScrollBar.elasticBackTime=300,this.panel_0.vScrollBar.elasticDistance=100,this.panel_1.hScrollBarSkin="",this.panel_1.hScrollBar.elasticBackTime=300,this.panel_1.hScrollBar.elasticDistance=100},i.onScrollChanged=function(){0==this.panel_0.vScrollBar.max||this.panel_0.vScrollBar.value>=this.panel_0.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),$_=function(e){function t(){this.arr=null,this.img_gz=null,this.img_label=null,this.img_label1=null,this.img_dt=null,this.txt_name1=null,t.__super.call(this),this.initUI()}u(t,"modules.guild.views.siege.GC_AwardsView",Ri);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.showGuildPersonAwards(),t.panel_awards.vScrollBar.on("change",t,t.onScrollChanged),t.btn_left.on("click",t,t.onClick),t.btn_right.on("click",t,t.onClick),t.panel_hz.scrollBar.on("change",t,t.updateBtn)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.panel_hz.removeChildren(0),t.panel_awards.removeChildren(0),t.panel_awards.vScrollBar.off("change",t,t.onScrollChanged),t.btn_left.off("click",t,t.onClick),t.btn_right.off("click",t,t.onClick),t.panel_hz.scrollBar.off("change",t,t.updateBtn)},i.destroy=function(e){if(void 0===e&&(e=!0),this.panel_hz.array&&0<this.panel_hz.array.length)for(var t=0 in this.panel_hz.array){var i=this.panel_hz.array[t].awardsList.goods;i&&i.destroy()}ui.SubPanel.prototype.destroy.call(this,e)},i.showGuildPersonAwards=function(){for(var e,t=ta.instance.getAwardsList("GuildRank"),i=0;i<t.length;i++){e=new rp;var s=new Object;s.mingci=ee.MODEL.param(t[i]),s.awards=ee.MODEL.goodsRewardStr(t[i]),e.data=s,e.y=133*i,e.x=0,this.panel_awards.addChild(e)}},i.initUI=function(){this.panel_hz.hScrollBarSkin="",this.panel_hz.scrollTo(0),this.panel_hz.selectedIndex=0,this.getListData(),this.btn_left.visible=!1,this.panel_awards.vScrollBarSkin="",this.panel_awards.vScrollBar.elasticBackTime=300,this.panel_awards.vScrollBar.elasticDistance=100},i.getListData=function(){var e=this;e.arr=[];var t=ta.instance.getAwardsList("GuildAuction");t=ee.MODEL.goodsRewardStr(t[0]).split(";");for(var i=0;i<t.length;i++){var s;(s=new ra).size(90,90);var n=an.create(parseInt(t[i].split(",")[0]),parseInt(t[i].split(",")[1]));s.bindData=n,s.x=0,s.y=0;var o=parseInt(t[i].split(",")[2]);e.arr.push({awardsList:{goods:s,labelNum:o,name:n.name,color:n.colourId}})}e.panel_hz.array=e.arr,e.panel_hz.renderHandler=ms.create(e,e.onRender,null,!1),e.arr.length<=4?e.btn_left.visible=e.btn_right.visible=!1:e.btn_left.visible=e.btn_right.visible=!0},i.onRender=function(e,t){var i=this;if(!(t>i.arr.length)){var s=i.arr[t];i.img_gz=e.getChildByName("img_gz"),i.img_label=e.getChildByName("img_label"),i.img_label1=e.getChildByName("img_label1"),i.img_dt=e.getChildByName("img_dt"),i.txt_name1=e.getChildByName("txt_name1"),i.img_gz.addChild(s.awardsList.goods),i.txt_name1.text=s.awardsList.name,i.txt_name1.color=Co.getByQuality(s.awardsList.color),s.awardsList.labelNum<=0?(i.img_dt.visible=!1,i.img_label.visible=!1,i.img_label1.visible=!1):(i.img_dt.visible=!0,1==s.awardsList.labelNum?(i.img_label.visible=!0,i.img_label1.visible=!1):2==s.awardsList.labelNum&&(i.img_label.visible=!1,i.img_label1.visible=!0))}},i.onScrollChanged=function(){0==this.panel_awards.vScrollBar.max||this.panel_awards.vScrollBar.value>=this.panel_awards.vScrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onClick=function(e){var t=this,i=0;e.currentTarget==t.btn_left?((i=t.panel_hz.startIndex-t.arr.length)<0&&(i=0),t.panel_hz.startIndex!=i&&t.panel_hz.tweenTo(i,150*(t.panel_hz.startIndex-i),ms.create(t,t.updateBtn))):e.currentTarget==t.btn_right&&((i=t.panel_hz.startIndex+t.arr.length)>=t.panel_hz.length&&(i=t.panel_hz.length-1),t.panel_hz.startIndex!=i&&t.panel_hz.tweenTo(i,37.5*(i-t.panel_hz.startIndex),ms.create(t,t.updateBtn)))},i.updateBtn=function(){var e=this;e.arr.length<=4?e.btn_left.visible=e.btn_right.visible=!1:0==e.panel_hz.scrollBar.value?(e.btn_left.visible=!1,e.btn_right.visible=!0):e.panel_hz.scrollBar.value==e.panel_hz.scrollBar.max?(e.btn_left.visible=!0,e.btn_right.visible=!1):(e.btn_left.visible=!0,e.btn_right.visible=!0)},t}(),ep=function(e){function t(){this.goodsList=[],t.__super.call(this),this.centerX=this.centerY=0,this.panel_awards.hScrollBarSkin="",this.panel_awards.hScrollBar.elasticBackTime=300,this.panel_awards.hScrollBar.elasticDistance=100}u(t,"modules.guild.views.siege.GC_GuildHuiZhangAwardsView",no);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler),ta.instance.reqGuildAwards()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClickHandler);for(var i=0;i<t.goodsList.length;i++)t.goodsList[i].parent.removeChild(t.goodsList[i]),t.goodsList[i].off("click",t,t.onClickGoods);t.goodsList=[]},i.showInfo=function(e){for(var t,i=0;i<e.length;i++)(t=new l).size(106,106),t._nameY=105,t._nameVisible=!0,t.bindData=an.create(e[i].goodsIds,e[i].num),this.panel_awards.addChild(t),t.x=125*i+(500-120*e.length)/2,t.y=20,this.goodsList.push(t),t.toolTipEnabled=!1,t.on("click",this,this.onClickGoods)},i.onClickGoods=function(e){ta.instance.selectedGoodsObject={id:e.target.goodsId,num:e.target.goodsNum},On.ins._closePanel(this),On.ins.open("GUILD_AWARDS_FF_VIEW")},i.onClickHandler=function(e){On.ins._closePanel(this)},t}(),tp=function(e){function t(){this.siegeData=null,t.__super.call(this),this.siegeData=ta.instance,this.list.vScrollBarSkin="",this.list.itemRender=lp,this.list.dataSource=[],this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100}u(t,"modules.guild.views.siege.GC_GuildRankView",j);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this.shachengbg&&this.shachengbg.skin&&Y.loader.clearRes(this.shachengbg.skin),ui.SubPanel.prototype.destroy.call(this)},i.updateByVSC=function(e){0<this.siegeData.guideRank.length?this.txtGuildName.changeText(this.siegeData.guideRank[0].gname):this.txtGuildName.changeText(ed.n[1902]),this.list.dataSource=this.siegeData.guideRank,this.list.refresh(),this.txt_no.visible=this.siegeData.guideRank.length<1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.txt_no.visible=!1;var i=[];J.dtoEnterScene&&0!=J.dtoEnterScene.cid?(t.txt_result.changeText(ed.n[1903]),i=t.siegeData.guideRank,0<t.siegeData.guideRank.length?t.txtGuildName.changeText(t.siegeData.guideRank[0].gname):t.txtGuildName.changeText(ed.n[1902])):(t.txt_result.changeText(ed.n[1905]),t.siegeData.reqLastRank()),t.list.dataSource=i,t.list.refresh(),t.txt_no.visible=i.length<1,t.g_mask.visible=11<i.length,t.list.scrollBar.on("change",t,t.onScrollChanged)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),ip=function(e){function t(){t.__super.call(this),this.list.vScrollBarSkin="",this.list.itemRender=dp,this.list.dataSource=[]}u(t,"modules.guild.views.siege.GC_PersonRankView",sa);var i=t.prototype;return i.updateByVSC=function(e){this.list.dataSource=ta.instance.personRank,this.list.refresh(),this.txt_no.visible=ta.instance.personRank.length<1},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.txt_no.visible=!1;var t=[];J.dtoEnterScene&&0!=J.dtoEnterScene.cid?ta.instance.reqCurrentRank():ta.instance.reqLastRank(),this.list.dataSource=t,this.list.refresh(),this.txt_no.visible=t.length<1,this.g_mask.visible=13<t.length,this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),sp=function(e){function t(){this.siegeData=null,t.__super.call(this),this.siegeData=ta.instance,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.itemRender=up}u(t,"modules.guild.views.siege.GC_ScAwardsView",Rt);var i=t.prototype;return i.updateNum=function(e){var t=0;t=this.siegeData.selectedGoodsObject.num-this.siegeData.selectedNum<0?0:this.siegeData.selectedGoodsObject.num-this.siegeData.selectedNum,this.txt_num.text=t+""},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.list.dataSource=[],ta.instance.reqGetAwardsMembers(),t.btn_ff.on("click",t,t.onClickAwards),t.btn_close.on("click",t,t.onclickClosePanel),t.txt_num.text=t.siegeData.selectedGoodsObject.num-t.siegeData.selectedNum+"",ke.ins.selectArr={}},i.showGetAwardsMembers=function(){null!=ke.ins.myGuildMemList&&(this.showGuildPlayerList(),60027==this.siegeData.selectedGoodsObject.id?this.img_title.skin=Or.getAtlasSubPath("guild/sczb_text_mfbx.png"):60028==this.siegeData.selectedGoodsObject.id?this.img_title.skin=Or.getAtlasSubPath("guild/sczb_text_mfjx.png"):60029==this.siegeData.selectedGoodsObject.id&&(this.img_title.skin=Or.getAtlasSubPath("guild/sczb_text_mfyx.png")))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_ff.off("click",this,this.onClickAwards),this.btn_close.off("click",this,this.onclickClosePanel),this.siegeData.selectedGoodsObject=null,this.siegeData.selectedNum=0,ke.ins.isFirst=!0},i.showGuildPlayerList=function(){this.list.dataSource=ke.ins.myGuildMemList.memList,ke.ins.isFirst=!1},i.onclickClosePanel=function(e){On.ins._closePanel(this)},i.onClickAwards=function(e){var t=0,i=[];for(t=0;t<this.list.cells.length;t++){var s=this.list.cells[t];null!=s.vo&&1==s.ck_box.selected&&i.push(s.vo.id)}i.length<=0?Vl.ins.showMsg(ed.n[1906],1):(ta.instance.reqFFguildAwards(this.siegeData.selectedGoodsObject.id,i),On.ins._closePanel(this))},t}(),np=function(e){function t(){t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.guild.views.siege.GC_ShowAwardsView",Cr);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),ta.instance.getdayAwardsStatus(),this.btn_get.on("click",this,this.onclickBtnGet)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_get.off("click",this,this.onclickBtnGet),this.panel_awards.removeChildren(0)},i.updateBtnInfo=function(e){1==e?(this.btn_get.filters=ns.getGrayFilter(),this.btn_get.label="已领取"):(this.btn_get.filters=[],this.btn_get.label="领 取")},i.showAwards=function(e){var t=this;void 0===e&&(e=!1);var i,s="",n=[];if(e)t.img_mrjl.skin=Or.getFullUrl("ui/layouts/guildchengzhu/sczb_text_hzjl.png",!1),n=ta.instance.getAwardsList("DominateChairman"),s=ee.MODEL.goodsRewardStr(n[0]),t.btn_get.visible=!1,t.lab_huizhang1.visible=t.lab_huizhang2.visible=!0,t.height=412,t.txt_person.visible=!1;else{t.img_mrjl.skin=Or.getFullUrl("ui/layouts/guildchengzhu/sczb_text_mrjl.png",!1),n=ta.instance.getAwardsList("GuildDay"),s=ee.MODEL.goodsRewardStr(n[0]),t.lab_huizhang1.visible=t.lab_huizhang2.visible=!1,t.txt_person.visible=!0;var o=Il.ins.panelInfo;if(null!=o){var a=o.wcGuild?o.wcGuild:ed.n[1907];t.btn_get.visible=a==Gi.ins.guildName}t.height=465}n=jt.parse(s);for(var r=0;r<n.length;r++)(i=new l).size(116,116),i._nameVisible=!0,i._nameY=119,i.bindData=n[r],t.panel_awards.addChild(i),i.x=127*r+(500-127*n.length+11)/2,i.toolTipEnabled=!0},i.onclickBtnGet=function(e){ta.instance.reqDayguildAwards()},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},t}(),op=function(e){function t(){this.guildRank=null,this.guildAwards=null,this.personRank=null,this.personAwards=null,this.currentSelectedPanel=null,this.selectedIndex=-1,t.__super.call(this)}u(t,"modules.guild.views.siege.GuildGc_RankMV",fo);var i=t.prototype;return i.initialize=function(){this.centerX=this.centerY=0},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.onClickClose),t.btn_gonghui.on("click",t,t.onClickRank),t.btn_ghawards.on("click",t,t.onClickRank),t.btn_person.on("click",t,t.onClickRank),t.btn_psawards.on("click",t,t.onClickRank),t.getPanelByIndex(0)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.onClickClose),t.btn_gonghui.off("click",t,t.onClickRank),t.btn_ghawards.off("click",t,t.onClickRank),t.btn_person.off("click",t,t.onClickRank),t.btn_psawards.off("click",t,t.onClickRank),t.currentSelectedPanel&&(t.currentSelectedPanel.parent&&t.currentSelectedPanel.parent.removeChild(t.currentSelectedPanel),t.currentSelectedPanel.destroy(),t.currentSelectedPanel=null),t.selectedIndex=0},i.updateScore=function(e){void 0===e&&(e=!1),this.currentSelectedPanel instanceof modules.guild.views.siege.GC_GuildRankView?this.currentSelectedPanel.updateByVSC():this.currentSelectedPanel instanceof modules.guild.views.siege.GC_PersonRankView&&this.currentSelectedPanel.updateByVSC()},i.showSelectedPanel=function(e){this.getPanelByIndex(e)},i.onClickRank=function(e){var t=0;e.target==this.btn_gonghui?t=0:e.target==this.btn_person?t=1:e.target==this.btn_ghawards?t=2:e.target==this.btn_psawards&&(t=3),this.getPanelByIndex(t)},i.onClickClose=function(e){On.ins._closePanel(this)},i.getPanelByIndex=function(e){var t=this;null!=t.currentSelectedPanel&&t.selectedIndex==e||(t.btn_gonghui.selected=t.btn_person.selected=t.btn_ghawards.selected=t.btn_psawards.selected=!1,t.selectedIndex=e,t.clearPanel(),t.currentSelectedPanel&&(t.currentSelectedPanel.parent&&t.currentSelectedPanel.parent.removeChild(t.currentSelectedPanel),t.currentSelectedPanel.destroy(),t.currentSelectedPanel=null),0==e?(t.guildRank=new tp,t.guildRank.updateByVSC(),t.currentSelectedPanel=t.guildRank,t.btn_gonghui.selected=!0,J.dtoEnterScene&&0!=J.dtoEnterScene.cid?t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_bjph.png"):t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_sjph.png")):1==e?(t.personRank=new ip,t.personRank.updateByVSC(),t.currentSelectedPanel=t.personRank,t.btn_person.selected=!0,J.dtoEnterScene&&0!=J.dtoEnterScene.cid?t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_bjph.png"):t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_sjph.png")):2==e?(t.guildAwards=new $_,t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_phjl.png"),t.currentSelectedPanel=t.guildAwards,t.btn_ghawards.selected=!0):3==e&&(t.personAwards=new Z_,t.img_title.skin=Or.getAtlasSubPath("newguild/sczb_text_phjl.png"),t.currentSelectedPanel=t.personAwards,t.btn_psawards.selected=!0),t.currentSelectedPanel&&(t.currentSelectedPanel.pos(25,100),t.addChild(t.currentSelectedPanel)))},i.clearPanel=function(){this.guildRank&&(this.guildRank=null),this.personRank&&(this.personRank=null),this.guildAwards&&(this.guildAwards=null),this.personAwards&&(this.personAwards=null)},t}(),ap=function(e){function t(){var e=this;e._avatar=null,e.sp_reddot=null,e.box_avatar=null,e.effect_wc=null,t.__super.call(e),e.box_avatar=new gl,e.box_c.addChild(e.box_avatar),e.box_avatar.centerX=-700,e.box_avatar.centerY=-300,e.btn_RB.visible=!1,e.btn_mo.visible=!1,e.centerX=e.centerY=0,e.sp_reddot=new rn,e.box_c.addChild(e.sp_reddot),e.isHideBg=!0}u(t,"modules.guild.views.siege.GuildGc_SiegeView",Lc);var i=t.prototype;return i.hideByVSC=function(e,t){var i=this;i.btn_go.off("click",i,i.onJoin),i.btn_mo.off("click",i,i.onMo),i.btn_0.off("click",i,i.onClick),i.btn_1.off("click",i,i.onClick),i.btn_2.off("click",i,i.onClick),i.btn_3.off("click",i,i.onClick),i.btn_4.off("click",i,i.onClick),i.btn_desc.off("click",i,i.onClickDesc)},i.showByVSC=function(e,t){var i=this;i.btn_go.on("click",i,i.onJoin),i.btn_mo.on("click",i,i.onMo),i.btn_0.on("click",i,i.onClick),i.btn_1.on("click",i,i.onClick),i.btn_2.on("click",i,i.onClick),i.btn_3.on("click",i,i.onClick),i.btn_4.on("click",i,i.onClick),i.btn_desc.on("click",i,i.onClickDesc)},i.onAdd=function(e){var t=this;t.layout.dragon_border.visible=!1,t.btn_go.on("click",t,t.onJoin),t.btn_mo.on("click",t,t.onMo),t.btn_0.on("click",t,t.onClick),t.btn_1.on("click",t,t.onClick),t.btn_2.on("click",t,t.onClick),t.btn_3.on("click",t,t.onClick),t.btn_4.on("click",t,t.onClick),t.btn_RB.on("click",t,t.openRedView),t.btn_desc.on("click",t,t.onClickDesc),t.txt_guild.changeText(""),t.txt_name.changeText(""),Ac.reqInfo();var i="";""!=(i=ee.MODEL.goodsRewardStr(0))&&jt.parse(i),""!=(i=ee.MODEL.goodsRewardStr(1))&&jt.parse(i),t.setTitle(Or.getAtlasSubPath("guildchengzhu/sczb_text_sczb.png")),t.updateReddot()},i.onRemove=function(e){var t=this;t.btn_go.off("click",t,t.onJoin),t.btn_mo.off("click",t,t.onMo),t.btn_0.off("click",t,t.onClick),t.btn_1.off("click",t,t.onClick),t.btn_2.off("click",t,t.onClick),t.btn_3.off("click",t,t.onClick),t.btn_4.off("click",t,t.onClick),t.btn_RB.off("click",t,t.openRedView),t.btn_desc.off("click",t,t.onClickDesc)},i.updateByVSC=function(e){var t=this;if(e instanceof protos.siege.toc_23302){null==t.effect_wc&&(t.effect_wc=ti.createEffect("jm1106",360,240)),null==t.effect_wc.parent&&t.box_c.addChild(t.effect_wc),t.btn_go.disabled=!ke.ins.joinGuild;var i=Il.ins.panelInfo;if(i)if(t.txt_guild.changeText(i.wcGuild?i.wcGuild:ed.n[1908]),t.txt_name.changeText(i.charName?i.charName:""),t._avatar||(t._avatar=new Wi,t._avatar.pos(15,10),t.box_avatar.addChild(t._avatar)),""==i.wcGuild&&""==i.charName?t._avatar.changeAvatar(1,"tyw11004","ty11004",""):1==i.charSex?t._avatar.changeAvatar(1,"tyw11004","ty11004",""):t._avatar.changeAvatar(2,"tyw11004","ty12004",""),i.wcGuild&&i.moT<=0?(t.btn_mo.disabled=!0,t.btn_mo.label="已膜拜"):(t.btn_mo.disabled=i.moT<=0,t.btn_mo.label=ed.n[1909]),t.btn_mo.showTip=!t.btn_mo.disabled,0<i.openT){var s=new Date(1e3*i.openT),n=s.getMonth()+1+"月"+s.getDate()+"日(周"+ur.DAYS[s.getDay()]+ed.n[1910];t.txt_open.changeText(n),t.btn_go.showTip=0<J.serverTimeSec-i.openT&&J.serverTimeSec-i.openT<1200}else t.txt_open.changeText(ed.n[1911]),t.btn_go.showTip=!1;var o=new Kl;Fl.sendToService(o)}else if(e instanceof protos.guild.toc_12934){var a=e.useYB;t.btn_RB.visible=0<a,Fl.sendToService(new nt)}else e instanceof protos.guild.toc_12965?t.updateReddot():e instanceof protos.guild.toc_23344&&(t.btn_4.visible=1==e.status)},i.onJoin=function(e){Wc.isEnabledChangeScene()?Fl.sendToModule("NEW_SS_ENTRY",["modules.newsiege.NewSiegeModule"],20130):Vl.ins.showById(2126,1)},i.onMo=function(e){Ac.reqMo()},i.openRedView=function(){On.ins.open("GUILD_REDVIEW")},i.onClick=function(e){var t=0;e.target==this.btn_0||e.target==this.btn_1?(e.target==this.btn_0?t=0:e.target==this.btn_1&&(t=2),Fl.sendToModule("GUILD_RANK_AWARDS",["modules.guild.GuildModule"],{selectedIndex:t})):e.target==this.btn_2?Fl.sendToModule("GUILD_AWARDS_SHOW",["modules.guild.GuildModule"],{guild:1}):e.target==this.btn_3?Fl.sendToModule("GUILD_AWARDS_SHOW",["modules.guild.GuildModule"],{guild:0}):e.target==this.btn_4&&On.ins.open("GUILD_AWARDS_HZ_VIEW")},i.onClickDesc=function(e){var t=Ka.MODEL.rule(2);On.ins.open("AE_EXPLAIN_VIEW",{desc:t})},i.updateReddot=function(){this.sp_reddot.graphics.clear(),ke.ins.isReddot(11)&&this.drawReddot(this.btn_4),ke.ins.isReddot(12)&&this.drawReddot(this.btn_RB),ke.ins.isReddot(13)&&this.drawReddot(this.btn_3),Fl.sendToService(new nt)},i.drawReddot=function(e){var t=Y.loader.getRes(jc.POINT);this.sp_reddot.graphics.drawTexture(t,e.x+48,e.y-1,t.width,t.height)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.effect_wc&&(t.effect_wc.parent&&t.effect_wc.parent.removeChild(t.effect_wc),t.effect_wc.dispose(),t.effect_wc=null),t.sp_reddot&&(t.sp_reddot.graphics.clear(),t.sp_reddot.parent&&t.sp_reddot.parent.removeChild(t.sp_reddot),t.sp_reddot=null),t.shachengbg&&t.shachengbg.skin&&Y.loader.clearRes(t.shachengbg.skin),t._avatar&&(t._avatar.destroy(e),t._avatar=null),ui.SubPanel.prototype.destroy.call(t,e)},t}(),rp=function(e){function t(){this.goodsInfo=null,t.__super.call(this),this.initUI()}u(t,"modules.guild.views.siege.item.GcGuildAwardsItem",bo);var i=t.prototype;return i.initUI=function(){},n(0,i,"data",null,function(e){var t=this;if(null!=e){t.goodsInfo=e;var i,s=t.goodsInfo.mingci.toString();s.split(",")[0]==s.split(",")[1]?t.txt_mingci.text="第"+s.split(",")[0]+"名":t.txt_mingci.text="第"+s.split(",")[0]+"-"+s.split(",")[1]+"名",3<s.split(",")[0]?(t.img_rank.visible=!1,t.txt_mingci.visible=!0):(t.img_rank.visible=!0,t.txt_mingci.visible=!1,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+s.split(",")[0]+".png"));for(var n=t.goodsInfo.awards.split(";"),o=0;o<n.length;o++)(i=new l).size(74,74),i._nameY=76,i._simpleName=!0,i._nameVisible=!0,i.bindData=an.create(parseInt(n[o].split(",")[0]),parseInt(n[o].split(",")[1])),t.addChild(i),i.x=113+122*o,i.y=13}}),t}(),lp=function(e){function t(){this.vo={},t.__super.call(this)}u(t,"modules.guild.views.siege.item.GcGuildRankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_rank.visible=this.img_bg.visible=!1},i.getColor=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386";default:return"#90877b"}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.vo=e,t.vo&&(t.txt_rank.text=t.vo.rank+"",t.txt_guild.text=t.vo.gname+"",t.txt_name.text=t.vo.name,t.txt_socre.text=t.vo.score+"",3<t.vo.rank?(t.img_rank.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(t.vo.rank+""),t.img_bg.visible=!1):(t.img_rank.visible=!0,t.txt_rank.visible=!1,t.img_bg.visible=!0,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+t.vo.rank+".png"),t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no"+t.vo.rank+".png")),t.txt_name.color=t.getColor(t.vo.rank),t.txt_guild.color=t.getColor(t.vo.rank),t.txt_socre.color=t.getColor(t.vo.rank))}),t}(Ks),cp=function(e){function t(){this.goodsInfo=null,t.__super.call(this)}return u(t,"modules.guild.views.siege.item.GcPersonAwardsItem",mt),n(0,t.prototype,"data",null,function(e){if(e){this.goodsInfo=e,this.txt_jifen.text=this.goodsInfo.point+"积分";var t=new l;t.size(90,90),t._nameVisible=!0,t._nameY=95,t.bindData=an.create(parseInt(this.goodsInfo.goodsid),parseInt(this.goodsInfo.goodsnum)),this.addChild(t),t.x=15,t.y=28}}),t}(),dp=function(e){function t(){this.vo={},t.__super.call(this)}u(t,"modules.guild.views.siege.item.GcPersonRankItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.img_rank.visible=this.img_bg.visible=!1},i.getColor=function(e){switch(e){case 1:return"#f7efcf";case 2:return"#f0d1a4";case 3:return"#c5a386";default:return"#90877b"}},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.vo=e,t.vo&&(t.txt_rank.text=t.vo.rank+"",t.txt_name.text=t.vo.gname+"",t.txt_guild.text=t.vo.name,t.txt_socre.text=t.vo.score+"",3<t.vo.rank?(t.img_rank.visible=!1,t.txt_rank.visible=!0,t.txt_rank.changeText(t.vo.rank+""),t.img_bg.visible=!1):(t.img_rank.visible=!0,t.txt_rank.visible=!1,t.img_bg.visible=!0,t.img_rank.skin=Or.getAtlasSubPath("base_ui2/phb_dj_"+t.vo.rank+".png"),t.img_bg.skin=Or.getAtlasSubPath("base_ui2/phb_db_no"+t.vo.rank+".png")),t.txt_name.color=t.getColor(t.vo.rank),t.txt_guild.color=t.getColor(t.vo.rank),t.txt_socre.color=t.getColor(t.vo.rank))}),t}(Ks),up=function(e){function t(){this.vo=null,this.siegedata=null,this.siegedata=ta.instance,t.__super.call(this)}u(t,"modules.guild.views.siege.item.GC_ScAwardsItem",e);var i=t.prototype;return i.onClickSelected=function(e){var t=this;if(t.ck_box.selected?t.siegedata.selectedNum+=1:t.siegedata.selectedNum-=1,ke.ins.selectArr[t.vo.id]=t.ck_box.selected,t.siegedata.selectedGoodsObject.num-t.siegedata.selectedNum<0&&t.ck_box.selected)return Vl.ins.showMsg(ed.n[1912],1),t.ck_box.selected=!1,void(t.siegedata.selectedNum-=1);Fl.sendToModule("GUILD_AWARDS_SELECTED",["modules.guild.GuildModule"],{bool:t.ck_box.selected})},i.getPosStr=function(e){return 1==e?"会长":1==e?"副会长":1==e?"长老":1==e?"护法":ed.n[1913]},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.vo=e,t.vo&&(1==ke.ins.isFirst?t.ck_box.selected=!1:t.ck_box.selected=ke.ins.selectArr[t.vo.id],t.txt_name.text=t.vo.name,t.txt_career.text=t.getPosStr(t.vo.pos),t.txt_point.text=t.vo.totalContrib.toString(),t.ck_box.on("click",t,t.onClickSelected))}),t}(xa),hp=function(e){function t(){this.BAR_W,t.__super.call(this)}u(t,"modules.guild.views.skill.GuildSkill_CangbaoView",je);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){this.updateShow()},i.updateByVSC=function(e){Y.timer.once(50,this,this.updateShow)},i.showByVSC=function(e,t){this.updateShow()},i.destroy=function(e){void 0===e&&(e=!0),Y.loader.getRes(this.guildcbbg.skin)&&Y.loader.clearRes(this.guildcbbg.skin,!0),laya.ui.View.prototype.destroy.call(this,e)},i.reqSkillInfo=function(){var e=new Sl;Fl.sendToService(e)},i.onCellClick=function(e){this.reqSkillInfo()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_upgrade.on("click",this,this.onCellClick),this.BAR_W=this.mc_bar.width,this.setRateBar()},i.setRateBar=function(e){void 0===e&&(e=0);var t=this.mc_bar.scrollRect||new qo(0,0,this.mc_bar.width,this.mc_bar.height);t.width=this.BAR_W*e,this.mc_bar.scrollRect=t},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_upgrade.off("click",this,this.onCellClick)},i.updateShow=function(){if(ke.ins.myGuildBaseToc){var e=ke.ins.myGuildBaseToc.baocangLevel,t=ps.MODEL.upgradeReward(e),i=ps.MODEL.value(e),s=(i-ke.ins.myGuildBaseToc.baocangCurExp)/5;this.txt_des1.innerHTML="每捐献"+nc.createColor("1","#e6d80d")+ed.n[1914]+nc.createColor("5","#e6d80d")+ed.n[1915]+nc.createColor("30","#e6d80d")+ed.n[1916],e>=ps.count-1?this.txt_des2.innerHTML=ed.n[1917]+nc.createColor(15e4+"","#e6d80d")+ed.n[1918]:this.txt_des2.innerHTML=ed.n[1919]+nc.createColor(s+"","#e6d80d")+ed.n[1920]+nc.createColor(t+"","#e6d80d")+ed.n[1921],this.txt_count.changeText("x"+ri.ins.getGoodsNum(ps.MODEL.modelId(e))),this.txt_bar.innerHTML=ke.ins.myGuildBaseToc.baocangCurExp+"/"+i;var n=ke.ins.myGuildBaseToc.baocangCurExp/i;1<n&&(n=1),this.setRateBar(n),this.btn_upgrade.showTip=10<ri.ins.getGoodsNum(ps.MODEL.modelId(e))}},i.updateReddotData=function(){},i.hideByVSC=function(e,t){},t}(),_p=function(t){function e(){this.vsc=null,e.__super.call(this),this.top=this.bottom=this.left=this.right=0}u(e,"modules.guild.views.skill.GuildSkill_MainView",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/guildskill/btn_tab_liangong.png","ui/layouts/guildskill/btn_tab_cangbao.png"],e.vsc=new o(e),e.vsc.registAll([{cls:vn,id:"SUB_SKILL_BASE",showDragon:!0},{cls:hp,id:"SUB_CANGBAO_BASE",isHideBg:!0}]),e.vsc.selectHandler=ms.create(e,e.onViewSelected,null,!1),e.vsc.filterHandler=ms.create(e,e.onVscFilter,null,!1)},i.onVscFilter=function(e,t){if("SUB_SKILL_BASE"==e){if(ke.ins.isReddot(4))return 3}else if("SUB_CANGBAO_BASE"==e&&ke.ins.isReddot(5))return 3;return 0},i.onViewSelected=function(e,t){var i;"SUB_SKILL_BASE"==e&&(i="gh_text_hddt"),"SUB_CANGBAO_BASE"==e&&(i="gh_text_hddt"),i&&this.setTitle(Or.getAtlasSubPath("guildskill/"+i+".png"))},i.onAdd=function(e){t.prototype.onAdd.call(this,e),ke.ins.reqReddot(4,3)},i.destroy=function(e){void 0===e&&(e=!0),this.vsc=null,t.prototype.destroy.call(this,e)},e}(jr),pp=function(e){function t(){var e=this;e._toc=null,e.id=null,e.ybGrid=null,e.jbGrid=null,t.__super.call(e),e.centerX=0,e.y=250,e.ybGrid=new ra,e.ybGrid.pos(74,181),e.ybGrid.bindData=an.create(14,1),e.addChild(e.ybGrid),e.jbGrid=new ra,e.jbGrid.pos(74,391),e.jbGrid.bindData=an.create(15,1),e.addChild(e.jbGrid)}u(t,"modules.guild.views.store.GuildStore_ContribView",Zn);var i=t.prototype;return i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),ke.ins.tc_myGuildBase.invalid(),ke.ins.tc_myGuildMems.invalid(),this.btn_close.off("click",this,this.onClick)},i.initialize=function(){var e=this;e.id="GUILD_CONTTIBULT_VIEW",e.btn_jb.on("click",e,e.onBtnClick0),e.btn_yb.on("click",e,e.onBtnClick1),ke.ins.mycontribute&&e.update(ke.ins.mycontribute),e.txt_jb.innerHTML="捐献"+nc.createColor("1000","#e6d80d")+"元宝",e.txt_yb.innerHTML="捐献"+nc.createColor(2e5+"","#e6d80d")+"金币"},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick),ke.ins.mycontribute&&this.reFreshData(ke.ins.mycontribute)},i.onClick=function(e){e.target==this.btn_close&&this.close()},i.close=function(){this.id?On.ins.close(this.id):this.event("close",this)},i.onBtnClick0=function(){if(this._toc)if(0!=this._toc.jb_remain)if(Gi.ins.coin<this._toc.jb_need)Vl.ins.showById(1003,1);else{var e=new ca;e.type=1,Fl.sendToService(e)}else Vl.ins.showMsg(ed.n[1922],1)},i.onBtnClick1=function(){if(this._toc)if(0!=this._toc.yb_remain)if(Gi.ins.YB<this._toc.yb_need)ja.ins.showNoGold();else{var e=new ca;e.type=2,Fl.sendToService(e)}else Vl.ins.showMsg(ed.n[1923],1)},i.onLinkClick=function(){On.ins.open("GUILD_STORE_RECORDVIEW",3)},i.update=function(e){e instanceof protos.guild.toc_12945&&this.reFreshData(e)},i.destroy=function(e){void 0===e&&(e=!0),this.ybGrid&&(this.ybGrid.clearIconTexture(),this.ybGrid=null),this.jbGrid&&(this.jbGrid.clearIconTexture(),this.jbGrid=null),laya.ui.View.prototype.destroy.call(this,e)},i.reFreshData=function(e){var t=this;t._toc=e;var i=0,s=0,n=0,o=0;for(i=0;i<it.count;i++)1==it.MODEL.type(i)&&Gi.ins.VIPLevel>=it.MODEL.vipLimit(i)&&(s=it.MODEL.showtime(i));for(i=0;i<it.count;i++)2==it.MODEL.type(i)&&Gi.ins.VIPLevel>=it.MODEL.vipLimit(i)&&(n=it.MODEL.showtime(i),o=it.MODEL.showviptime(i));var a=t._toc.jb_remain;t.txt_remain_1.innerHTML="("+nc.createColor(""+a,0==a?"#ff2e24":"#23b11f")+"/"+s+")",t.btn_jb.disabled=0==a,a=t._toc.yb_remain,t.txt_remain_0.innerHTML="("+nc.createColor(""+a,0==a?"#ff2e24":"#23b11f")+"/"+n+")",0==a?(t.btn_yb.disabled=!0,t.txt_vip_add.visible=!0,10<=Gi.ins.VIPLevel?t.txt_vip_add.innerHTML=ed.n[1924]:t.txt_vip_add.innerHTML=nc.createColor("VIP"+(Gi.ins.VIPLevel+1),"#ff2e24")+ed.n[1925]+o+"次"):(t.btn_yb.disabled=!1,t.txt_vip_add.visible=!1)},t}(),fp=function(t){function e(){this.vsc=null,e.__super.call(this)}u(e,"modules.guild.views.store.GuildStore_MainView",t);var i=e.prototype;return i.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/guildstore/btn_tab_ghjx.png","ui/layouts/guildstore/btn_tab_ghbx.png"],e.vsc=new o(e),e.vsc.registAll([]),e.vsc.selectHandler=ms.create(e,e.onSelectedView,null,!1),e.vsc.filterHandler=ms.create(e,e.onFilter,null,!1)},i.onFilter=function(e,t){return"SUB_STORE_CONTRIB"==e&&ke.ins.isReddot(3)||"SUB_STORE_BOX"==e&&ke.ins.isReddot(6)?3:0},i.onSelectedView=function(e,t){var i;"SUB_STORE_CONTRIB"==e?i="guilddonate_tset_title":"SUB_STORE_BOX"==e?i="guildchest_tset_title":"SUB_STORE_RED"==e&&(i="guildredpacket_tset_title"),i&&this.setTitle(Or.getAtlasSubPath("guildstore/"+i+".png"))},i.onAdd=function(e){t.prototype.onAdd.call(this,e),ke.ins.reqReddot(3,6)},e}(jr),gp=function(e){function t(){this._curIndex=0,t.__super.call(this)}u(t,"modules.guild.views.store.GuildStore_RecordView",k);var i=t.prototype;return i.initialize=function(){this.list.renderHandler=ms.create(this,this.onCellRender,null,!1),this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100,this.list.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickHandler),this.list.scrollBar.on("change",this,this.onScrollChanged)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickHandler),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.onClickHandler=function(e){On.ins._closePanel(this)},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onCellRender=function(e,t){var i=this.list.array[t];e.txt_time.text=i.timeStr,e.txt_content.innerHTML=i.text},i.update=function(e){e instanceof protos.guild.toc_12943&&2==this._curIndex&&this.updateList(),e instanceof protos.guild.toc_12947?3==this._curIndex&&this.updateList():"number"==typeof e&&(this._curIndex=e,!ke.ins.tc_records[this._curIndex].invalid()&&ke.ins.recordArrayVec[this._curIndex]&&this.updateList())},i.updateList=function(){!this.list.visible&&(this.list.visible=!0),this.list.dataSource=ke.ins.recordArrayVec[this._curIndex],this.g_mask.visible=4<this.list.length;var e,t=this.getChildAt(0);e=2==this._curIndex?ed.n[1926]:3==this._curIndex?ed.n[1927]:"",t.title=e},i.destroy=function(e){void 0===e&&(e=!0),ke.ins.clearRecord(),laya.ui.View.prototype.destroy.call(this,e)},t}(),vp=function(e){function t(){t.__super.call(this)}return u(t,"modules.guild.views.store.GuildStore_RedResultView",ol),t.prototype.update=function(e){this.clip_yb.value=e;var t=25*this.clip_yb.value.length+53;this.clip_yb.x=Math.floor((this.width-t)/2),this.g_icon.x=this.clip_yb.x+25*this.clip_yb.value.length-1},t}(),mp=function(e){function t(){this.useYB=0,this._endTime=0,this._lastCui=0,this.toc=null,t.__super.call(this),this.setSendEnabled(!1),this.centerX=0,this.centerY=0,this.sp_ctn.visible=!1}u(t,"modules.guild.views.store.GuildStore_RedView",ko);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.btn_send.clickHandler=ms.create(e,e.onSendClick,null,!1),e.btn_snatch.clickHandler=ms.create(e,e.onSnatchClick,null,!1),e.txt_desc.text=ed.n[1928],e.link_note.clickHandler=ms.create(e,e.onLinkNote,null,!1)},i.onLinkNote=function(){On.ins.open("GUILD_STORE_RECORDVIEW",2),ke.ins.sendRecordReq(2)},i.onSendClick=function(){if(1!=ke.ins.myPos)return qe.now()-this._lastCui<3e3?(this._lastCui=qe.now(),void Vl.ins.showById(2113,1)):void ke.ins.sendCallMsg(1);var e=parseInt(ur.trim(this.input_yb.text));isNaN(e)&&(e=0);var t,i=parseInt(ur.trim(this.input_num.text));if(isNaN(i)&&(i=0),e<1e3?t=ed.n[1929]+1e3:e>this.useYB?t=ed.n[1930]:5e5<e?t=ed.n[1931]+5e5:i<10?t=ed.n[1932]+10:50<i&&(t=ed.n[1933]+50),t)Vl.ins.showMsg(t,1);else{var s=new ki;s.yb=e,s.redNum=i,Fl.sendToService(s)}},i.onSnatchClick=function(){var e=new Ii;Fl.sendToService(e),this.btn_snatch.disabled=!0},i.updateByVSC=function(e){var t=this;e instanceof protos.guild.toc_12934?(t.toc=e,t.btn_snatch.disabled=1==t.toc.status||0==t.toc.remainNum||t.toc.remainTime<=0,t.txt_remain.innerHTML=ed.n[1934]+nc.createColor(t.toc.remainNum+"个",0==t.toc.remainNum?"#ff2e24":"#23b11f"),t.txt_yb.text=""+(0|t.toc.useYB),t.useYB=t.toc.useYB,t.sp_ctn.visible=0<t.toc.useYB,t.txt_desc.visible=t.toc.useYB<=0&&1==t.toc.status,t.box.visible=!t.txt_desc.visible,t.box.visible&&(0<t.toc.remainTime?(t._endTime=J.curServerTime+1e3*t.toc.remainTime,t.txt_time.visible=!0,t.timerLoop(1e3,t,t.onTimer),t.onTimer()):(t.clearTimer(t,t.onTimer),t.txt_time.visible=!1),t.updateBtnTip())):e instanceof protos.guild.toc_12908?(ke.ins.pos=e.minePos,t.setSendEnabled(1==ke.ins.pos),t.updateBtnTip()):e instanceof protos.guild.toc_12936?1==e.opcode?Vl.ins.showMsg(ed.n[1935],1):Vl.ins.showMsg(ed.n[1936],1):e instanceof protos.guild.toc_12965&&t.updateBtnTip()},i.updateBtnTip=function(){var e=ke.ins.myGuildBaseToc;if(e){var t=1==e.minePos;this.btn_send.showTip=t&&1e3<=this.useYB,this.btn_snatch.showTip=!this.btn_snatch.disabled}},i.setSendEnabled=function(e){this.btn_send.label=e?"发红包":"催红包",this.input_num.editable=this.input_yb.editable=e,this.input_num.text="10",this.input_yb.text="1000",0<this.useYB?this.sp_ctn.visible=!!e:this.sp_ctn.visible=!1},i.onTimer=function(){var e=(this._endTime-J.curServerTime)/1e3;if(e<0)return this.clearTimer(this,this.onTimer),void(this.txt_time.visible=!1);this.txt_time.innerHTML=ed.n[1937]+nc.createColor(V.getSTRDHMS(e),"#23b11f")},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){this.clearTimer(this,this.onTimer),this.txt_time.visible=!1},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_snatch.disabled=!0,this.useYB=0,this.txt_remain.innerHTML="";var t=new Kl;Fl.sendToService(t),!ke.ins.tc_myGuildBase.invalid()&&ke.ins.myGuildBaseToc&&this.updateByVSC(ke.ins.myGuildBaseToc)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearTimer(this,this.onTimer),this.txt_time.visible=!1},t}(),bp=function(e){function t(){t.__super.call(this),this.on("click",this,this.onClick)}u(t,"modules.guild.views.store.NavRedpagTipsView",In);var i=t.prototype;return i.openView=function(e){this.centerX=-100,this.centerY=310,this.visible=0<e},i.onClick=function(e){On.ins.isOpen("GUILD_REDVIEW")||On.ins.open("GUILD_REDVIEW","SUB_STORE_RED"),On.ins.close("GUILD_REDNAVVIEW")},t}(),wp=function(){function e(){this._allInfo=null,this._allTalent=null,this._normalSkills=null,this._allJulian=null,this._allQianneng=null,this.initData()}u(e,"modules.strength.others.FazhenData");var t=e.prototype;return t.initData=function(){var e=this;e._allInfo={},e._allTalent={},e._normalSkills={},e._allJulian={},e._allQianneng={};for(var t=1;t<=3;t++){e._allInfo[t]||(e._allInfo[t]={});for(var i=0;i<Nc.count;i++){var s=Nc.MODEL.type(i),n=Nc.MODEL.level(i);if(!e._allInfo[t][s]){var o=new Ip;o.decode({type:s,level:n,curValue:0,roleIdx:t}),e._allInfo[t][s]=o}}e._allTalent[t]||(e._allTalent[t]={}),e._normalSkills[t]||(e._normalSkills[t]={}),e._allQianneng[t]||(e._allQianneng[t]={});for(var a=0;a<el.count;a++){var r=el.MODEL.fazhenType(a),l=el.MODEL.type(a);if(0<r&&1==l){if(!e._allTalent[t][r]){var c=new xp;c.decode(r,1,l,t,r),e._allTalent[t][r]=c}}else if(r<=0&&l<=5){var d=e._allInfo[t];for(var u in d){var h=new xp,_=el.MODEL.level(a);h.decode(0,_,l,t,0),e._normalSkills[t][u]||(e._normalSkills[t][u]={}),e._normalSkills[t][u][l]||(e._normalSkills[t][u][l]=h)}}else if(0==r){for(var p=1;p<=6;p++)if(e._allQianneng[t][p]||(e._allQianneng[t][p]={}),!e._allQianneng[t][p][l]){var f=new xp;f.decode(r,0,l,t,p),e._allQianneng[t][p][l]=f}}else if(10<=l){var g=new xp;g.decode(r,0,l,t,r),e._allQianneng[t][r]||(e._allQianneng[t][r]={}),e._allQianneng[t][r][l]=g}}e._allJulian[t]||(e._allJulian[t]={});for(var v=0;v<Jt.count;v++){var m=Jt.MODEL.type(v);if(!e._allJulian[t][m]){var b=new yp;b.decode(m,0,t),e._allJulian[t][m]=b}}}},t.updateInfo=function(e){for(var t=e.roleIdx,i=e.info,s=this._allInfo[t],n=this._allTalent[t],o=this._normalSkills[t],a=0;a<i.length;a++){var r=s[i[a].type],l=n[i[a].type];r&&r.decode(i[a]),l&&l.decode(i[a].type,i[a].talentLv,1,i[a].roleIdx,i[a].type);for(var c=i[a].normal,d=0;d<c.length;d++){o[i[a].type][c[d].type].decode(0,c[d].level,c[d].type,i[a].roleIdx,i[a].type)}}},t.updateQnInfo=function(e){for(var t=e.roleIdx,i=e.infos,s=this._allQianneng[t],n=this._allJulian[t],o=0;o<i.length;o++){var a=n[i[o].type];a&&a.decode(i[o].type,i[o].curTimes,t);for(var r=i[o].skills,l=0;l<r.length;l++){var c,d=s[i[o].type][r[l].skill];0==(c=d instanceof modules.strength.others.FazhenSkillVo?d:d[i[o].type]).level&&Fl.sendToModule("QN_FLY",["modules.strength.StrengthModule"],r[l].skill),c&&c.decode(c.type,1,r[l].skill,t,i[o].type)}}},t.getQNbytype=function(e,t){var i={},s=this.qianInfo[t][e];for(var n in s){var o,a=s[n];if(a instanceof modules.strength.others.FazhenSkillVo)0!=(o=a).type&&o.type!=e||(i[n]=o);else for(var r in a)0!=(o=a[r]).type&&o.type!=e||(i[n]=o)}return i},t.getQnAttrByVo=function(e,t){var i,s;if(void 0===t&&(t=!1),s=this.julianInfo[e.roleIdx][e.fazhenType],0==e.level){var n=t?this.getMaxQnLv(e):this.getJihuoLv(e);(i=new yp).decode(e.fazhenType,n,e.roleIdx)}else i=s;var o=i.attrForClient;if(o)for(var a=JSON.parse(o),r=0;r<a.length;r++)if(a[r].type==e.aimAttrType)return JSON.stringify(a[r]);return null},t.getMaxQnLv=function(e){for(var t=0,i=0;i<Jt.count;i++){var s=Jt.MODEL.times(i);Jt.MODEL.skillType(i);Jt.MODEL.type(i)==e.fazhenType&&t<s&&(t=s)}return t},t.getJihuoLv=function(e){for(var t=0;t<Jt.count;t++){var i=Jt.MODEL.times(t),s=Jt.MODEL.skillType(t);if(Jt.MODEL.type(t)==e.fazhenType&&s==e.skillType)return i}return 16},t.getAttrMulByVo=function(e){for(var t=0,i=this.julianInfo[e.roleIdx][e.type].attrForClient,s=JSON.parse(i),n=0;n<s.length;n++)s[n].type==Se.FAZHEN_ZZ.keyStr&&(t=parseInt(s[n].value)/1e4);return 1+t},t.getAddFightBySelf=function(e){if(!e)return 0;if(!e.attr)return 0;var t,i,s,n=JSON.parse(e.attr),o=modules.strength.others.FazhenData.ins.normalSkills[e.roleIdx][e.type],a=[];for(var r in o)if((t=o[r])&&0!=t.level&&(s=(i=t.attrs)?JSON.parse(i):null)){var l,c=0;if(-1<s[0].type.indexOf("_")){for(var d in l=s[0].type.split("_")[0],c=parseInt(s[0].value)/1e4,n)if(n[d].type==l){var u=n[d].value*c;a.push({type:n[d].type,value:u})}}else l=s[0].type,c=parseInt(s[0].value),a.push({type:l,value:c})}return Math.floor(f.getFight(a))},n(0,t,"talentSkills",function(){return this._allTalent||this.initData(),this._allTalent}),n(0,t,"fazhenInfo",function(){return this._allInfo||this.initData(),this._allInfo}),n(0,t,"qianInfo",function(){return this._allQianneng||this.initData(),this._allQianneng}),n(0,t,"julianInfo",function(){return this._allJulian||this.initData(),this._allJulian}),n(0,t,"normalSkills",function(){return this._normalSkills||this.initData(),this._normalSkills}),n(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e.curShowFazhenVo=null,e._ins=null,i(e,["QN_POINT",function(){return this.QN_POINT=[{pos:new is(50,472),scale:1},{pos:new is(162,382),scale:1},{pos:new is(307,344),scale:1},{pos:new is(452,382),scale:1},{pos:new is(564,472),scale:1},{pos:new is(677,18),scale:1},{pos:new is(998,18),scale:1}]}]),e}(),yp=function(){function e(){var e=this;e.index=0,e.type=0,e.skill=null,e.attr=null,e.showAttrRange=null,e.curTimes=0,e.consume=null,e.condition=null,e.roleIdx=0,e.attrForClient=null,e.colors=null}u(e,"modules.strength.others.FazhenJulianVo");var t=e.prototype;return t.decode=function(e,t,i){var s=this;s.type=e,s.curTimes=t,s.roleIdx=i,s.index=s.cfgIdx,s.attr=Jt.MODEL.attrs(s.index),s.condition=Jt.MODEL.conditions(s.index),s.showAttrRange=Jt.MODEL.preview(s.index),s.consume=Jt.MODEL.consume(s.index),s.attrForClient=Jt.MODEL.attrForClient(s.index),s.colors=Jt.MODEL.colors(s.index)},n(0,t,"cfgIdx",function(){for(var e=0;e<Jt.count;e++){var t=Jt.MODEL.type(e),i=Jt.MODEL.times(e);if(t==this.type&&i==this.curTimes)return e}return-1}),n(0,t,"maxTimes",function(){var e=wp.ins.fazhenInfo[this.roleIdx][this.type];return e?e.maxJunlianTimes:0}),n(0,t,"nextCfgIdx",function(){var e=this.index+1,t=Jt.MODEL.type(e),i=Jt.MODEL.times(e);return t==this.type&&i==this.curTimes+1?e:-1}),n(0,t,"canOper",function(){if(!this.consume)return!1;if(this.curTimes>=this.maxTimes)return!1;var e=JSON.parse(this.consume)[0].value.split(":"),t=parseInt(e[0]);return parseInt(e[1])<=ri.ins.getGoodsNum(t)}),n(0,t,"nextCondition",function(){return-1<this.nextCfgIdx?Jt.MODEL.conditions(this.nextCfgIdx):""}),e}(),xp=function(){function e(){var e=this;e.index=0,e.type=0,e.level=0,e.consume=null,e.needFazhenLvl=0,e.name=null,e.icon=null,e.desc=null,e.roleIdx=0,e.skillType=0,e.aimAttrType=null,e.attrMaxValue=null,e.fazhenType=0,e.attrs=null}u(e,"modules.strength.others.FazhenSkillVo");var t=e.prototype;return t.decode=function(e,t,i,s,n){var o=this;o.type=e,o.level=t,o.skillType=i,o.fazhenType=n,o.index=o.cfgIdx,o.roleIdx=s,o.consume=el.MODEL.consume(o.index),o.name=el.MODEL.name(o.index),o.icon=el.MODEL.icon(o.index),o.desc=el.MODEL.desc(o.index),o.needFazhenLvl=el.MODEL.needFazhenLvl(o.index),o.aimAttrType=el.MODEL.cAttrType(o.index),o.attrMaxValue=el.MODEL.attrMaxValue(o.index),o.attrs=el.MODEL.attrs(o.index)},n(0,t,"cfgIdx",function(){for(var e=0;e<el.count;e++){var t=el.MODEL.fazhenType(e),i=el.MODEL.level(e),s=el.MODEL.type(e);if(5<this.skillType&&this.skillType<11&&t==this.type&&s==this.skillType)return e;if(t==this.type&&i==this.level&&s==this.skillType)return e}return-1}),n(0,t,"nextDesc",function(){return-1<this.nextCfgIdx?el.MODEL.desc(this.nextCfgIdx):null}),n(0,t,"nextCfgIdx",function(){var e=this.index+1,t=el.MODEL.fazhenType(e),i=el.MODEL.level(e);return t==this.type&&i==this.level+1?e:-1}),n(0,t,"nextConsume",function(){return-1==this.nextCfgIdx?null:el.MODEL.consume(this.nextCfgIdx)}),n(0,t,"nextFazhenLv",function(){return-1<this.nextCfgIdx?el.MODEL.needFazhenLvl(this.nextCfgIdx):-1}),n(0,t,"canOper",function(){if(-1==this.nextCfgIdx)return!1;if(!this.consume)return!1;var e=JSON.parse(this.consume)[0].value.split(":"),t=parseInt(e[0]);return parseInt(e[1])<=ri.ins.getGoodsNum(t)}),e}(),Ip=function(){function e(){var e=this;e.type=0,e.level=0,e.curValue=0,e.maxValue=0,e.consume=null,e.effId=null,e.nameImg=null,e.nameImg2=null,e.index=0,e.roleIdx=0,e.attr=null,e.maxJunlianTimes=0}u(e,"modules.strength.others.FazhenVo");var t=e.prototype;return t.decode=function(e){if(e){var t=this;t.type=e.type,t.level=e.level,t.curValue=e.curValue,t.roleIdx=e.roleIdx,t.index=t.cfgIdx,t.index<0||(t.maxValue=Nc.MODEL.maxPro(t.index),t.consume=Nc.MODEL.consume(t.index),t.effId=Nc.MODEL.jmId(t.index),t.nameImg=Nc.MODEL.nameImg(t.index),t.attr=Nc.MODEL.attrs(t.index),t.nameImg2=Nc.MODEL.nameImg2(t.index),t.maxJunlianTimes=Nc.MODEL.qnTimes(t.index))}},n(0,t,"cfgIdx",function(){for(var e=0;e<Nc.count;e++){var t=Nc.MODEL.type(e),i=Nc.MODEL.level(e);if(t==this.type&&i==this.level)return e}return-1}),n(0,t,"nextCfgIdx",function(){var e=this.index+1,t=Nc.MODEL.type(e),i=Nc.MODEL.level(e);return t==this.type&&i==this.level+1?e:-1}),n(0,t,"nextAttr",function(){return-1<this.nextCfgIdx?Nc.MODEL.attrs(this.nextCfgIdx):null}),n(0,t,"nextLvNeedZhenxin",function(){return-1<this.nextCfgIdx?Nc.MODEL.needZhenxinLvl(this.nextCfgIdx):-1}),n(0,t,"canOper",function(){if(!this.consume)return!1;var e=wp.ins.talentSkills[this.roleIdx][this.type];if(e.canOper)return!0;if(this.nextCfgIdx<0)return!1;if(this.nextLvNeedZhenxin>e.level&&0<this.level)return!1;var t=JSON.parse(this.consume)[0].value.split(":"),i=parseInt(t[0]);return parseInt(t[1])<=ri.ins.getGoodsNum(i)}),n(0,t,"juLianCanOper",function(){var e=wp.ins.julianInfo[this.roleIdx][this.type];return!!e&&e.canOper}),e}(),Sp=function(){function a(){}return u(a,"modules.strength.others.StrengthUtil"),a.reqUpdate=function(e,t,i){var s=new pa;s.strengthType=e,s.roleIndex=t,s.equipIndex=i,Fl.sendToService(s)},a.reqStrengthInfo=function(e){var t=new Bo;Fl.sendToService(t)},a.getStrenAttr=function(e,t){var i=kp.EQUIP_INDEX.indexOf(e);return a.getStrenPro(i,t)},a.getStrenPro=function(e,t){var i=e+"_"+t;if(a._strenHash_.has(i))return a._strenHash_.take(i);for(var s=0;s<gr.count;s++)if(e==gr.MODEL.position(s)&&t==gr.MODEL.level(s)){var n=gr.MODEL.resource(s),o=JSON.parse(n);return a._strenHash_.put(i,o),o}return null},a.getEnchantAttr=function(e,t){var i=kp.EQUIP_INDEX.indexOf(e);return a.getEnchantPro(i,t)},a.getEnchantPro=function(e,t){var i=e+"_"+t;if(a._enchantHash_.has(i))return a._enchantHash_.take(i);for(var s=0;s<Sc.count;s++)if(e==Sc.MODEL.position(s)&&t==Sc.MODEL.level(s)){var n=Sc.MODEL.resource(s),o=JSON.parse(n);return a._enchantHash_.put(i,o),o}return null},a.getStoneAttr=function(e,t){var i=e+"_"+t;if(a._stoneHash_.has(i))return a._stoneHash_.take(i);for(var s=0;s<Io.count;s++)if(e==Io.MODEL.position(s)&&t==Io.MODEL.level(s)){var n=Io.MODEL.resource(s),o=JSON.parse(n);return a._stoneHash_.put(i,o),o}return null},a.getStoneProByP=function(e,t){var i=kp.EQUIP_INDEX.indexOf(e);return a.getStonePro(i,t)},a.getStonePro=function(e,t){var i,s=e+"_"+t;if(a._stoneHash_.has(s))return a._stoneHash_.take(s);for(var n=0;n<Io.count;n++)if(e==Io.MODEL.position(n)&&t==Io.MODEL.level(n)){var o=Io.MODEL.resource(n);return i=JSON.parse(o),a._stoneHash_.put(s,i),i}return i},a.getList=function(e){var t=Math.ceil(e/8),i=e%8,s=[],n=0;if(0==i)for(n=0;n<8;n++)s.push(t);else{for(n=0;n<i;n++)s.push(t);for(;n<8;n++)s.push(t-1)}return s},a.getPartLvl=function(e,t){var i=e/8>>0;return kp.EQUIP_INDEX.indexOf(t)+1<=e%8?1+i:i},a.getIndex=function(e){return e%8},a.getName=function(e){var t="";switch(e){case Se.MAXHP.id:t=ed.n[1938];break;case Se.ATK.id:t=ed.n[1939];break;case Se.DEF.id:t=ed.n[1940];break;case Se.MDEF.id:t=ed.n[1941]}return t},i(a,["_strenHash_",function(){return this._strenHash_=new Kt},"_enchantHash_",function(){return this._enchantHash_=new Kt},"_stoneHash_",function(){return this._stoneHash_=new Kt}]),a}(),kp=function(){function e(){this.selectTab=0,this.currentSelectedRoleIndex=0,this.forRed=!1,this.strengthVos=[null],this._operateType=0}u(e,"modules.strength.others.Strength_Data_Model");var t=e.prototype;return t.decode=function(e){this._operateType=e.readByte();for(var t,i=e.readByte(),s=0,n=0;n<i;n++)(s=e.readByte())>=this.strengthVos.length&&(t=new oo,this.strengthVos[s]=t),(t=this.strengthVos[s]).decode(this._operateType,e)},t.getVoByIndex=function(e){return e>=this.strengthVos.length?null:this.strengthVos[e]},t.getCost=function(e,t){var i=Yn.getIndex(e),s=Yn.MODEL.costStr(i);return s?s.length<=t?-1:s[t]:1},t.isMaterialEnough=function(e){for(var t=0;t<Gi.ins.actorList.length;t++)if(this.checkMaterialEnough(t,e))return{state:!0,index:t};return null},t.checkMaterialEnough=function(e,t){var i,s,n,o=0,a=0,r=0;switch(i=Gi.ins.actorList[e],t){case 1:o=i.strengthTotalLv,a=1;break;case 2:o=i.stoneTotalLv,a=2;break;case 3:o=i.spriteTotalLv,a=3}if(r=Sp.getList(o)[Sp.getIndex(o)],2==t&&(r=Sp.getList(o)[Sp.getIndex(o)]),s=ri.ins.getGoodsNum(a),-1==(n=modules.strength.others.Strength_Data_Model.ins.getCost(t,r)));else if(n<=s)return!0;return!1},n(1,e,"ins",function(){return e._ins||(e._ins=new e),e._ins}),e._ins=null,e.STRENGTH=1,e.STONE=2,e.SPRIT=3,e.GODCAST=4,e.circlePanel=null,e.actorSelector=null,i(e,["selectRoleIndexs",function(){return this.selectRoleIndexs=[0,0,0]},"EQUIP_INDEX",function(){return this.EQUIP_INDEX=[1,8,2,7,5,6,3,4,51]}]),e}(),Cp=function(e){function t(){this._mainView=null,this._fazhenView=null,t.__super.call(this);var e=[];e.push(Or.getLayoutsPath("strength_mix")),e.push(Or.getLayoutsPath("fazhen"));On.ins.registPanel("STRENGTH",Mp,"_mainView",this,{wait:On.wait(On.waitRes(e),On.waitConfig(Vs.streng_A,Vs.streng_C)),mask:!1,layer:"layout"}),On.ins.registPanel("FazhenMainView",Lp,"_fazhenView",this,{wait:On.wait(On.waitAtlas("fazhen"),On.waitConfig(["FazhenUpgradeResource","FazhenSkillResource","FazhenQnUpGradeResource"],["CFazhenResourse","CFazhenSkill","CFazhenQn"])),mask:!1,layer:"layout"})}u(t,"modules.strength.proxys.StrengthProxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"Layer_Init":Y.timer.once(1e3,t,et.ReqInfo);break;case"ST_OPEN_RED":kp.ins.forRed=!0;case"ST_OPEN":var i=null;e.proto.hasOwnProperty("backID")&&(i=e.proto.backID),On.ins.open("STRENGTH",e.proto,i);break;case"BP_UPDATE":t._mainView&&t._mainView.parent&&t._mainView.update(e),t._fazhenView&&t._fazhenView.vsc.updateSelectedView(e);break;case"UPDATE_MAIN":case"11003":t._mainView&&t._mainView.parent&&t._mainView.update(e);break;case"11004":var s=e.proto;t._mainView&&t._mainView.parent&&(t._mainView.showSuccess(s.type),"1"==t._mainView.nav.selectId?t._mainView.nav.selectedView.showSuccessEffect():"2"==t._mainView.nav.selectId?t._mainView.nav.selectedView.showSuccessEffect():"3"==t._mainView.nav.selectId&&s.success&&t._mainView.nav.selectedView.showSuccessEffect());break;case"11005":t._mainView&&t._mainView.parent&&t._mainView.update(e);break;case"10204":kp.actorSelector&&kp.actorSelector.refresh(),et.ReqInfo();break;case"22507":case"22504":t._mainView&&t._mainView.update(e);break;case"30877":wp.ins.updateInfo(e.proto),t._mainView&&t._mainView.update(e),t._fazhenView&&t._fazhenView.update(e);break;case"QN_FLY":t._fazhenView&&t._fazhenView.vsc&&t._fazhenView.vsc.selectedView instanceof modules.strength.views.fazhen.FazhenJulianView&&t._fazhenView.vsc.selectedView.showFly(e.proto);break;case"30879":wp.ins.updateQnInfo(e.proto),t._fazhenView&&t._fazhenView.update(e);break;case"30880":Ql.ins.updateAttr(e.proto)}},i.closePanel=function(e,t){},i.showPanel=function(e,t){"FazhenMainView"==e&&this._fazhenView&&this._fazhenView.vsc.updateSelectedView(t),t&&t.hasOwnProperty("selectedInex")&&(this._mainView.nav.selectedIndex=parseInt(t.selectedInex)-1)},t}(),Tp=(function(e){function t(){t.__super.call(this),this.registerSubProxy(Cp,Fe),this.subPackages=["11003","11004","11005","10204","22502","22504","22509","22511","22507","30877","QN_FLY","30879","30880"]}u(t,"modules.strength.StrengthModule",Tc)}(),function(e){function t(){this._vo=null,this._eff=null,t.__super.call(this)}u(t,"modules.strength.views.fazhen.FazhenItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.off("click",this,this.onClick),this._eff&&this._eff.dispose(),this._eff=null},i.onClick=function(e){wp.curShowFazhenVo=this._vo,On.ins.open("FazhenMainView",this._vo)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){Y.superSet(Ml,t,"dataSource",e);var i=e;t._vo=i,t.imgTitle.skin=Or.getFullUrl("ui/images/fazhen/"+i.nameImg2+".png"),t._eff&&t._eff.dispose(),t._eff=null,t._eff=ti.createEffect(i.effId,t.width/2,186,t),t._eff.scale_X=t._eff.scale_Y=.56,t.imgRed.visible=i.canOper||i.juLianCanOper||0<i.level&&Ql.firstLogin||i.type<=2&&Ql.firstLogin,t.labLv.text=""+i.level,t._eff.filters=[],0==i.level&&Rn.grayDeepper(t._eff,!0)}}),t}(Ml)),Ep=function(e){function t(){var e=this;e._vo=null,e._fazhenVo=null,e._selector=null,e.COLOR={0:"#90877b",1:"#d6d6d6",2:"#01b527",3:"#a93aff",4:"#ff831e",5:"#e41b00"},e.eff=null,e._eff=null,e.skills={},e._costId=0,e._gridRes=null,e._isEnouph=!1,e.flys=new Array,t.__super.call(e)}u(t,"modules.strength.views.fazhen.FazhenJulianView",Ir);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.onAdd=function(e){var t=this;Ql._firstLogin=!1,ui.ViewBase.prototype.onAdd.call(t,e),t.eff=ti.createEffect("jm1130",t.btnUpgrade.width>>1,t.btnUpgrade.height>>1,t.btnUpgrade),t.eff.scale_X=1.25,t.eff.scale_Y=1.2,t.on("click",t,t.onClick),t._selector.on("select",t,t.onRoleHandler),t.onRoleHandler()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.eff&&t.eff.dispose(),t.eff=null,t._eff&&t._eff.dispose(),t._eff=null,t.off("click",t,t.onClick),t._selector.off("select",t,t.onRoleHandler)},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.centerY=e.centerX=0,e._selector=new ma,e._selector.redptHandler=ms.create(e,e.needRedpt,null,!1),e.addChild(e._selector),e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x-51,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes),e.btnRule.hitArea=new qo(0,0,130,50)},i.onRoleHandler=function(){var e=new vc;e.roleIndex=this._selector.selectIdx+1,Fl.sendToService(e)},i.updateByVSC=function(e){var t=this;if(e instanceof modules.strength.others.FazhenVo)t._fazhenVo=e,t._selector.selectIdx=t._fazhenVo.roleIdx-1,t.onRoleHandler();else if(e instanceof protos.strength.toc_30879){t._fazhenVo||(t._fazhenVo=wp.curShowFazhenVo);var i=wp.ins.fazhenInfo[t._selector.selectIdx+1],s=i[t._fazhenVo.type];t._fazhenVo=s;var n=(i=wp.ins.julianInfo[t._selector.selectIdx+1])[t._fazhenVo.type];t._vo=n,t.updatePanel(),t._selector.invalid()}else"BP_UPDATE"==e.actionOrder&&t.updateConsume()},i.updatePanel=function(){var e=this;e._eff||(e._eff=ti.createEffect(e._fazhenVo.effId,192,256,e.imgBg),e._eff.scale_X=e._eff.scale_Y=.4),e.soulname.skin=Or.getFullUrl("ui/images/fazhen/"+e._fazhenVo.nameImg+".png"),e.updateConsume(),e.updateAttrs(),e.updateSkills()},i.updateSkills=function(){var e=wp.ins.getQNbytype(this._vo.type,this._selector.selectIdx+1),t=0;for(var i in e){var s=e[i];if(s.fazhenType=this._vo.type,!this.skills[s.skillType]){var n=new Ap;n.pos(wp.QN_POINT[t].pos.x,wp.QN_POINT[t].pos.y),n.scaleX=n.scaleY=wp.QN_POINT[t].scale,n.on("click",this,this.onClickSkill),this.addChild(n),this.skills[s.skillType]=n}this.skills[s.skillType].setShow(s),t++}},i.onClickSkill=function(e){var t=e.currentTarget;t&&Bp.ins.show(t.vo)},i.showFly=function(e){if(this._vo){var t=this.skills[e];if(t)ti.createEffect("jm1082",53,52,t).isAutoDispose=!0}},i.onFlyEnd=function(){Yl.clearAll(this.flys.pop().removeSelf()),this.updateSkills()},i.updateConsume=function(){var e=this;if(e.htmlTimes.innerHTML=nc.createColor(e._vo.curTimes+"","#23b11f")+"/"+e._vo.maxTimes,0<e._vo.nextCfgIdx)if(e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!0,e.btnUpgrade.visible=!0,e.maxLevel.visible=!1,e.htmlLimit.visible=!1,e._vo.curTimes>=e._vo.maxTimes&&0!=e._fazhenVo.level){e.htmlTimes.visible=!1,e.txtDesc.visible=e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btnUpgrade.visible=!1,e.imgRed.visible=!1,e.htmlLimit.visible=!0;var t=e._vo.nextCondition.split(";");e.htmlLimit.innerHTML=ed.n[1942]+nc.createColor(t[0]+"","#23b11f")+ed.n[1943]+nc.createColor(t[1]+"","#23b11f")+"次"}else{e.txtDesc.visible=e.htmlTimes.visible=!0;var i=e._vo.consume;if(i){var s=JSON.parse(i)[0].value.split(":"),n=parseInt(s[0]);e._costId=n;var o=parseInt(s[1]),a=ri.ins.getGoodsNum(n);e._gridRes.bindData=an.create(n),o<=a?(e._isEnouph=!0,e.txt_cost.innerHTML=nc.createColor(a+"","#23b11f")+"/"+o,e.imgRed.visible=0<e._fazhenVo.level):(e._isEnouph=!1,e.txt_cost.innerHTML=nc.createColor(a+"","#ff2e24")+"/"+o,e.imgRed.visible=!1)}}else e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btnUpgrade.visible=!1,e.imgRed.visible=!1,e.htmlLimit.visible=!1,e.maxLevel.visible=!0,e.htmlTimes.visible=!1,e.txtDesc.visible=!1},i.updateAttrs=function(){var e,t,i,s=this;s.boxleft.graphics.clear(),s.boxright.graphics.clear();var n,o,a,r=0,l=0;t=(e=s._vo.attrForClient)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1);var c=s._vo.colors?s._vo.colors.split(","):[];for(r=0;r<i.length;r++){o=(n=i[r]).name+":";a=0<(-1<n.val.indexOf("%")?100*parseInt(n.val.slice(0,n.val.indexOf("%"))):parseInt(n.val))?n.val+"":"未激活";var d=s.COLOR[c[r]];s.drawAttr(s.boxleft,o,d,a,d,0,l,24),l+=26}if(l=0,-1<s._vo.nextCfgIdx)for(s.mc_arrow.visible=!0,s.boxright.visible=!0,s.imgAttrRight.visible=!0,s.imgAttrLeft.x=408,i=s._vo.showAttrRange.split(";"),r=0;r<i.length;r++)s.drawAttr(s.boxright,i[r],"#23b11f","","#23b11f",0,l,24),l+=26;else s.imgAttrLeft.x=215,s.boxright.visible=!1,s.mc_arrow.visible=!1,s.imgAttrRight.visible=!1;t=(e=s._vo.attr)?JSON.parse(e):null,s.fcForce.value=f.getFight(t)},i.drawAttr=function(e,t,i,s,n,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(ur.getStringLength(t)*r>>1)+l;return""!=s&&e.graphics.fillText(s,c,a,r+"px 黑体",n,"left"),c+(ur.getStringLength(s)*r>>1)+l},i.onClick=function(e){switch(e.target){case this.btnUpgrade:if(0==this._fazhenVo.level)return void Vl.ins.playErrorMsg(ed.n[1944]);if(!this._isEnouph)return void Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:121,max:-1});var t=new kc;t.roleIdx=this._vo.roleIdx,t.fazhenType=this._vo.type,t.operType=4,Fl.sendToService(t);break;case this.btnRule:hc.goToOpenHelpDes(29)}},i.needRedpt=function(e){return wp.ins.julianInfo[Gi.ins.actorList.indexOf(e)+1][this._vo.type].canOper},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},t}(),Lp=function(n){function e(){this.vsc=null,e.__super.call(this)}u(e,"modules.strength.views.fazhen.FazhenMainView",n);var t=e.prototype;return t.onAdd=function(e){n.prototype.onAdd.call(this,e);var t=ms.create(this,this.redPtUpdate,null,!1);Qr.ins.addListener("BTN_FAZHEN",[279,278],t),Qr.reqRedPt([279,278]);for(var i=0;i<Gi.ins.actorList.length;i++){var s=new vc;s.roleIndex=i+1,s.operType=0,Fl.sendToService(s)}},t.onRemove=function(e){n.prototype.onRemove.call(this,e),Qr.ins.removeListener("BTN_FAZHEN")},t.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},t.update=function(e){this.vsc.updateSelectedView(e.proto),this.callLater(this.updateItemEnabled)},t.updateItemEnabled=function(){this.vsc.updateItemEnabled()},t.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.size(720,1280),e.centerX=0,e.top=e.bottom=e.left=e.right=0,e.navList=["ui/layouts/fazhen/yq_btn_fzpy.png","ui/layouts/fazhen/yq_btn_fzjl.png"],e.vsc=new o(e),e.vsc.registAll([{cls:Vp,id:0,isHideBg:!0,showDragon:!0},{cls:Ep,id:1,isHideBg:!0,showDragon:!0}]),e.vsc.selectHandler=ms.create(e,e.onSubChanged,null,!1),e.vsc.filterHandler=ms.create(e,e.checkTips,null,!1)},t.checkTips=function(e){if("0"==e){if(this.getCanOperFazhen())return 3}else if("1"==e&&(this.getCanOperJulian()||Ql.firstLogin&&wp.curShowFazhenVo&&0<wp.curShowFazhenVo.level))return 3;return 0},t.getCanOperFazhen=function(){for(var e=0;e<Gi.ins.actorList.length;e++){if(wp.ins.fazhenInfo[e+1][wp.curShowFazhenVo.type].canOper)return!0}return!1},t.getCanOperJulian=function(){for(var e=0;e<Gi.ins.actorList.length;e++){if(wp.ins.fazhenInfo[e+1][wp.curShowFazhenVo.type].juLianCanOper)return!0}return!1},t.onSubChanged=function(e,t){this.setTitle(Or.getAtlasSubPath("fazhen/fz_text_fz.png")),this.callLater(this.updateItemEnabled)},e.NAME="FazhenMainView",e}(jr),Ap=function(e){function i(){var e=this;e._img=null,e.vo=null,e.f=new Ei([.5,0,0,0,16.75,0,.5,0,0,16.75,0,0,.5,0,16.75,0,0,0,1,0]),i.__super.call(e),e._img=new Dl,e._img.centerX=e._img.centerY=0,e.addChildAt(e._img,1);var t=new rn;(e._img.mask=t).graphics.drawCircle(35,35,35,"#FFFFFF")}return u(i,"modules.strength.views.fazhen.FazhenQnGrid",Oe),i.prototype.setShow=function(e){e&&(this.vo=e,this._img.skin=Or.getIconPath(e.icon),this._img.width=this._img.height=70,this._img.filters=[],0==e.level&&Rn.grayDeepper(this._img,!0))},i}(),Bp=function(e){function t(){this._skillGrid=null,t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.strength.views.fazhen.FazhenQnTip",Oo);var i=t.prototype;return i.show=function(e){var t=this;if(e){var i,s,n=e;t._skillGrid||(t._skillGrid=new Op,t._skillGrid.y=89,t._skillGrid.x=30,t._skillGrid.boxSkill.scaleX=t._skillGrid.boxSkill.scaleY=1,t.addChild(t._skillGrid)),t._skillGrid.update(n,99999,!1),t.txtName.text=n.name,t.txtDesc.innerHTML=n.desc;var o=0,a="";if(0==n.level){var r=wp.ins.getQnAttrByVo(n,!0);if(r)for(i=r?JSON.parse(r):null,s=Se.formatNewAttrToChinese([i],!1,!0,!1),o=0;o<s.length;o++)a=nc.newline()+ed.n[1945]+nc.createColor(s[o].name+"+"+s[o].val,"#23b11f")}t.txtDesc.innerHTML+=a,t.txtStatus.text=0==n.level?"未激活":"已激活",t.txtStatus.color=0==n.level?"#ff2e24":"#90877b";var l,c=wp.ins.getQnAttrByVo(n);if(c){i=c?JSON.parse(c):null,s=Se.formatNewAttrToChinese([i],!1,!0,!1);var d=0;for(o=0;o<s.length;o++){l=s[o].name+":"+s[o].val;d=-1<s[o].val.indexOf("%")?100*parseInt(s[o].val.slice(0,s[o].val.indexOf("%"))):parseInt(s[o].val)}}var u=0==n.level?"激活属性：":ed.n[1946],h=0==n.level?"#ff2e24":"#90877b";if(t.txtDesc1.innerHTML=nc.createColor(u+l,h),t.txtDesc1.y=0==n.level?t.txtDesc.y+t.txtDesc.contextHeight+60:t.txtDesc.y+t.txtDesc.contextHeight,t.imgLine.y=0==n.level?t.txtDesc.y+t.txtDesc.contextHeight+20:t.txtDesc1.y+t.txtDesc1.contextHeight+20,n.attrMaxValue&&-1<n.attrMaxValue.indexOf(",")){var _=n.attrMaxValue.split(",");t.imgMax.visible=d>=parseInt(_[n.fazhenType-1])&&0!=n.level}else n.attrMaxValue&&-1==n.attrMaxValue.indexOf(",")&&(t.imgMax.visible=d>=parseInt(n.attrMaxValue)&&0!=n.level);0==n.level&&(t.imgMax.visible=!1),t.height=t.imgLine.y+120,t.parent||(Zl.panelLayer.on("MASK_CLOSE",t,t.onClick),Zl.panelLayer.openTip(t))}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),e)?!Zl.panelLayer.closeTip(this)&&Zl.panelLayer.close(this):Zl.panelLayer.close(this);Zl.panelLayer.off("MASK_CLOSE",this,this.onClick)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.fazhen.FazhenSkilllTipsUI._$SET_ins),t._ins=null,t}(),Dp=function(e){function t(){var e=this;e._gridRes=null,e._vo=null,e._canUp=!1,e._skillGrid=null,e._costId=0,e.isTalent=!1,e._level=-1,t.__super.call(e),e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.htmlCost.x-47,e._gridRes.y=e.htmlCost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes)}u(t,"modules.strength.views.fazhen.FazhenSkillAlert",Bt);var i=t.prototype;return i.onClickUp=function(e){switch(e.target){case this.btnUp:if(!this._canUp)return void this._gridRes._doShowToolTip();var t=new kc;t.roleIdx=this._vo.roleIdx,t.fazhenType=this._vo.type,t.operType=3,Fl.sendToService(t)}},i.show=function(e){var t=this;if(e){if(-1<t._level&&t._level<e.info.level)ti.createEffect("jm1060",70,140,t).isAutoDispose=!0,ti.createEffect("jm1078",293,200,t).isAutoDispose=!0;if(t.lab_title.text=e.isTalent?"阵心技能":ed.n[1947],t._vo=e.info,t._level=t._vo.level,t.isTalent=e.isTalent,t.imgMax.visible=!1,t.txtName.text=t._vo.name,t.txtLv.text=t._vo.level+"级",t.txtStatus.text=0==t._vo.level?"未激活":"已激活",t.txtStatus.color=0==t._vo.level?"#ff2e24":"#90877b",t.labLimit.visible=!1,t._skillGrid||(t._skillGrid=new Op,t._skillGrid.y=89,t._skillGrid.x=30,t._skillGrid.boxSkill.scaleX=t._skillGrid.boxSkill.scaleY=1,t.addChild(t._skillGrid)),t._skillGrid.update(t._vo,99999,!1),t.boxConsume.visible=!1,t.crtDescr.innerHTML=ed.n[1948]+t._vo.desc,-1<t._vo.nextCfgIdx){t.txtCurLevel.text=ed.n[1949],t.nextDescr.visible=!0,t.nextDescr.y=t.crtDescr.contextHeight+20+t.crtBox.y+t.crtDescr.y,t.nextDescr.innerHTML=ed.n[1950]+t._vo.nextDesc,t.img_line.y=t.nextDescr.y+t.nextDescr.contextHeight+20;var i=t._vo.consume;if(i&&""!=i){t.boxConsume.visible=!0;var s=JSON.parse(i)[0].value.split(":"),n=parseInt(s[0]),o=parseInt(s[1]),a=ri.ins.getGoodsNum(n);t._gridRes.visible=!0,t._gridRes.bindData=an.create(n),t._costId=n,o<=a?(t._canUp=!0,t.htmlCost.innerHTML=nc.createColor(a+"","#23b11f")+"/"+o,t.btnUp.showTip=!0):(t._canUp=!1,t.htmlCost.innerHTML=nc.createColor(a+"","#ff2e24")+"/"+o,t.btnUp.showTip=!1),t.on("click",t,t.onClickUp),t.height=t.img_line.y+164}else 0==t._vo.level&&e.isTalent?(t.labLimit.visible=!0,t.labLimit.text=ed.n[1951]):0!=t._vo.level||e.isTalent?(t.labLimit.visible=!0,t.labLimit.text=ed.n[1953]+t._vo.nextFazhenLv+"级提升"):(t.labLimit.visible=!0,t.labLimit.text=ed.n[1952]+t._vo.nextFazhenLv+"级解锁"),t.height=t.img_line.y+80}else t.txtCurLevel.text=ed.n[1954],t.nextDescr.visible=!1,t.img_line.y=t.crtDescr.contextHeight+20+t.crtBox.y+t.crtDescr.y,t._gridRes.visible=!1,t.boxConsume.visible=!1,t.height=t.img_line.y+134,t.imgMax.visible=!0;t.parent||(Zl.panelLayer.on("MASK_CLOSE",t,t.onClick),Zl.panelLayer.openTip(t))}},i.onClick=function(e){this.close(!0)},i.close=function(e){(void 0===e&&(e=!1),this._level=-1,e)?!Zl.panelLayer.closeTip(this)&&Zl.panelLayer.close(this):Zl.panelLayer.close(this);this.off("click",this,this.onClickUp),Zl.panelLayer.off("MASK_CLOSE",this,this.onClick)},n(1,t,"ins",function(){return t._ins||(t._ins=new t),t._ins},layouts.fazhen.FazhenSkillAlertUI._$SET_ins),t._ins=null,t}(),Op=function(e){function t(){this._imgSkill=null,t.__super.call(this),this._imgSkill=new Dl,this._imgSkill.pos(7,7),this.boxSkill.addChild(this._imgSkill)}u(t,"modules.strength.views.fazhen.FazhenSkillGrid",yc);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),en.clearIconTexture(this)},i.update=function(e,t,i){var s=this;void 0===i&&(i=!0),s.imgRed.visible=!1,s._imgSkill.skin=Or.getIconPath(e.icon),en.addIconUse(s,s._imgSkill.skin),s._imgSkill.width=s._imgSkill.height=100,i?(s.labName.visible=!0,s.labName.text=e.name):s.labName.visible=!1,s.labLock.y=22,0==e.level&&e.nextFazhenLv>t?(s.imgMask.visible=!0,s.labLock.visible=!0,s.labLock.text=e.nextFazhenLv+ed.n[1955]):0==e.level&&e.nextConsume&&99999!=t?(s.labLock.y=12,s.imgMask.visible=!0,s.labLock.visible=!0,s.labLock.text=ed.n[1956]):(s.imgMask.visible=!1,s.labLock.visible=!1),99999!=t&&(s.imgRed.visible=e.canOper)},t}(),Vp=function(e){function t(){var e=this;e._selector=null,e._eff=null,e._vo=null,e._BARWIDTH=0,e._level=-1,e._showEff=!1,e._role=-1,e._isLvUp=!1,e._isAuto=!1,e._gridRes=null,e._isEnouph=!1,e._upEff=null,e._canUpEff=!1,e._skillGrids=new Array,t.__super.call(e)}u(t,"modules.strength.views.fazhen.FazhenUpLvlView",Da);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.updateByVSC=function(e){var t=this;if(e)if(e instanceof modules.strength.others.FazhenVo)t._vo=e,t._selector.selectIdx=t._vo.roleIdx-1,t.onRoleHandler();else if(e instanceof protos.strength.toc_30877){var i=wp.ins.fazhenInfo[t._selector.selectIdx+1];t._vo||(t._vo=wp.curShowFazhenVo);var s=i[t._vo.type];t._vo=s,0==t._level&&1==t._vo.level&&t._vo.roleIdx==t._role?t._showEff=!0:t._showEff=!1,-1!=t._level&&t._vo.level>t._level&&t._vo.roleIdx==t._role?t._isLvUp=!0:t._isLvUp=!1,t._level=t._vo.level,t._role=t._vo.roleIdx,t.updatePanel(),t._selector.invalid()}else"BP_UPDATE"==e.actionOrder&&t.updateConsume()},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.on("click",this,this.onClick),this._selector.on("select",this,this.onRoleHandler),this.onRoleHandler(),(!Ql.haveAnyActive()||wp.curShowFazhenVo&&wp.curShowFazhenVo.type<=2&&0==wp.curShowFazhenVo.level)&&(Ql._firstLogin=!1)},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),Yl.clearAll(t.bar_mask),t._eff&&t._eff.dispose(),t._eff=null,t._selector.off("select",t,t.onRoleHandler),t._isAuto=!1},i.onClick=function(e){switch(e.target){case this.btnUpgrade:if(!this._vo)return;if(0==this._vo.level){if(!this._isEnouph)return void this._gridRes._doShowToolTip();var t=new kc;t.roleIdx=this._vo.roleIdx,t.fazhenType=this._vo.type,t.operType=1,Fl.sendToService(t)}else this.autoUpgrade(!this._isAuto)}},i.autoUpgrade=function(e){var t=this;if(void 0===e&&(e=!0),!t._isEnouph&&e?(t._isAuto=!1,t._gridRes._doShowToolTip()):t._isAuto=e,t._isAuto){t.btnUpgrade.label="取 消";var i=new kc;i.roleIdx=t._vo.roleIdx,i.fazhenType=t._vo.type,i.operType=2,Fl.sendToService(i)}else 0==t._vo.level?t.btnUpgrade.label="激 活":t.btnUpgrade.label=ed.n[1957]},i.updateConsume=function(){var e=this;if(0==e._vo.level?e.btnUpgrade.label="激 活":e._isAuto?e.btnUpgrade.label="取 消":e.btnUpgrade.label=ed.n[1958],0<e._vo.nextCfgIdx){e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!0,e.btnUpgrade.visible=!0,e.maxLevel.visible=!1,e.htmlLimit.visible=!1;var t=wp.ins.talentSkills[e._selector.selectIdx+1][e._vo.type];if(e._vo.nextLvNeedZhenxin>t.level&&0<e._vo.level)e._isAuto=!1,e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btnUpgrade.visible=!1,e.htmlLimit.visible=!0,e.htmlLimit.innerHTML=ed.n[1959]+nc.createColor(e._vo.nextLvNeedZhenxin+"","#23b11f")+ed.n[1960];else{var i=e._vo.consume;if(i){var s=JSON.parse(i)[0].value.split(":"),n=parseInt(s[0]),o=parseInt(s[1]),a=ri.ins.getGoodsNum(n);e._gridRes.bindData=an.create(n),o<=a?(e._isEnouph=!0,e.txt_cost.innerHTML=nc.createColor(a+"","#23b11f")+"/"+o,e.btnUpgrade.showTip=!0):(e._isEnouph=!1,e.txt_cost.innerHTML=nc.createColor(a+"","#ff2e24")+"/"+o,e.btnUpgrade.showTip=!1)}}}else e._gridRes.visible=e.txt_cost.visible=e.cost_tips.visible=!1,e.btnUpgrade.visible=!1,e.htmlLimit.visible=!1,e.maxLevel.visible=!0,e._isAuto=!1},i.updateBar=function(){var e=this;if(0==e._vo.level||e._vo.nextCfgIdx<0)e.boxBar.visible=!1;else{e.boxBar.visible=!0;var t=e._vo.curValue/e._vo.maxValue*e._BARWIDTH;e._isLvUp?Yl.to(e.bar_mask,{x:0},100,null,ms.create(e,e.lvUpEnd)):Yl.to(e.bar_mask,{x:-e._BARWIDTH+t},100,null,ms.create(e,e.barEnd))}},i.lvUpEnd=function(){this._isLvUp=!1,this.updateBar()},i.barEnd=function(){Yl.clearAll(this.bar_mask),this.txtPro.text=this._vo.curValue+"/"+this._vo.maxValue,Y.timer.once(10,this,this.doAuto)},i.doAuto=function(){this.autoUpgrade(this._isAuto)},i.updateAttrs=function(){var e,t,i,s=this;s.boxleft.graphics.clear(),s.boxright.graphics.clear();var n,o,a,r=0,l=15;for(t=(e=s._vo.attr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxleft,o,"#90877b",a,"#90877b",20,l,24),l+=26;if(s.fcForce.value=Math.floor(f.getFight(t)*wp.ins.getAttrMulByVo(s._vo))+wp.ins.getAddFightBySelf(s._vo),l=15,-1<s._vo.nextCfgIdx)for(s.mc_arrow.visible=!0,s.boxright.visible=!0,s.imgAttrRight.visible=!0,s.imgAttrLeft.x=92,t=(e=s._vo.nextAttr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxright,o,"#23b11f",a,"#23b11f",20,l,24),l+=26;else s.imgAttrLeft.x=252,s.boxright.visible=!1,s.mc_arrow.visible=!1,s.imgAttrRight.visible=!1},i.drawAttr=function(e,t,i,s,n,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(ur.getStringLength(t)*r>>1)+l;return""!=s&&e.graphics.fillText(s,c,a,r+"px 黑体",n,"left"),c+(ur.getStringLength(s)*r>>1)+l},i.clearCanUpEff=function(){this._upEff&&this._upEff.dispose(),this._upEff=null},i.updateSkills=function(){for(var e=this;e._skillGrids.length;)e._skillGrids.pop().destroy();var t=0,i=wp.ins.talentSkills[e._vo.roleIdx][e._vo.type];if(i){var s=new Op;e._skillGrids.push(s),s.pos(110,20),e.imgSkilBg.addChild(s),s.on("click",e,e.onClickSkill),s.update(i,e._vo.level),s.tag={info:i,isTalent:!0,curLevel:e._vo.level,type:e._vo.type},Dp.ins.parent&&Dp.ins.isTalent&&Dp.ins.show(s.tag),e._canUpEff&&(e._canUpEff=!1,0<i.level&&-1<i.nextCfgIdx&&(e._upEff=ti.createEffect("jm1498",s.width/2,s.height/5*3,s),Y.timer.once(3e3,e,e.clearCanUpEff)))}var n=wp.ins.normalSkills[e._vo.roleIdx][e._vo.type];for(var o in n){i=n[o];var a=new Op;e._skillGrids.push(a),a.pos(276+101*t,20),e.imgSkilBg.addChild(a),a.on("click",e,e.onClickSkill),a.update(i,e._vo.level),a.tag={info:i,isTalent:!1,curLevel:e._vo.level,type:e._vo.type},t++}e._showEff&&(ti.createEffect("jm1426",e.width/2,e.height/2,e).isAutoDispose=!0)},i.onClickSkill=function(e){var t=e.currentTarget;t&&Dp.ins.show(t.tag)},i.onRoleHandler=function(){this._isAuto=!1,this._canUpEff=!0;var e=new rl;e.roleIndex=this._selector.selectIdx+1,Fl.sendToService(e)},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.centerY=e.centerX=0,e._selector=new ma,e._selector.redptHandler=ms.create(e,e.needRedpt,null,!1),e.addChild(e._selector),e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x-51,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes),e._BARWIDTH=e.imgBar.width,e.imgBar.mask=e.bar_mask,e.bar_mask.x=-e._BARWIDTH},i.updatePanel=function(){var e=this;e._eff||(e._eff=ti.createEffect(e._vo.effId,192,.4*508,e.imgBg),e._eff.scale_X=e._eff.scale_Y=.4),e.fazhenname.skin=Or.getFullUrl("ui/images/fazhen/"+e._vo.nameImg+".png"),e.txtLv.text="Lv."+e._vo.level,e.updateAttrs(),e.updateSkills(),e.updateConsume(),e.updateBar()},i.needRedpt=function(e){return wp.ins.fazhenInfo[Gi.ins.actorList.indexOf(e)+1][this._vo.type].canOper},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},t}(),Mp=function(c){function t(){this.nav=null,this._effect=null,this._effId="",this._isPlayEff=!1,t.__super.call(this),this.size(960,1280),this.centerX=0,this.top=this.bottom=0,this.left=this.right=0;var e=[Or.getLayoutsPath("strength")];this.navList=["ui/layouts/strength_mix/btn_tab_qh.png","ui/layouts/strength_mix/btn_tab_fm.png","ui/layouts/strength_mix/btn_tab_bs.png","ui/layouts/fazhen/yq_btn_fz.png"],this.nav=new o(this),this.nav.registAll([{cls:Gp,id:"1",showDragon:!0,isHideBg:!0,wait:On.waitRes(e)},{cls:Pp,id:"2",showDragon:!0,isHideBg:!0,wait:On.waitRes(e)},{cls:Np,id:"3",showDragon:!0,isHideBg:!0,wait:On.waitRes(e)},{cls:Rp,id:"4",showDragon:!0,isHideBg:!1,grayTip:function(){Vl.ins.playErrorMsg("开服第"+Ql.openServerDay+ed.n[1961]+Ql.zsLevel+"转开启")}}]),null==kp.circlePanel&&(kp.circlePanel=new dt),null==kp.actorSelector&&(kp.actorSelector=new ma,kp.actorSelector.selectIdx=0),this.nav.selectHandler=ms.create(this,this.changeSelect,null,!1),this.nav.filterHandler=ms.create(this,this.checkRedPoint,null,!1)}u(t,"modules.strength.views.StrengthMainView",c);var e=t.prototype;return e.update=function(e){this.nav.updateSelectedView(e),this.callLater(this.updateItemEnabled)},e.updateItemEnabled=function(){this.nav.updateItemEnabled()},e.initialize=function(){},e.onAdd=function(e){var t=this;c.prototype.onAdd.call(this,e);var i=ms.create(this,function(){t.updateItemEnabled},null,!1);if(Qr.ins.addListener("BTN_FAZHEN1",[279,278],i),Qr.reqRedPt([279,278]),Ql.checkFazhenOpen()){for(var s=0;s<Gi.ins.actorList.length;s++){var n=new rl;n.roleIndex=s+1,Fl.sendToService(n)}for(s=0;s<Gi.ins.actorList.length;s++){var o=new vc;o.roleIndex=s+1,o.operType=0,Fl.sendToService(o)}}for(var a=0;a<Vs.streng_C.length;a++){var r="protos.db."+Vs.streng_C[a],l=pn.getClass(r);if(l&&(!l.hash||0==l.hash.length)){l.hash&&(l.hash.length||0)}}},e.onRemove=function(e){c.prototype.onRemove.call(this,e),Qr.ins.removeListener("BTN_FAZHEN1"),qn.ins.needUpdate=0,kp.ins.currentSelectedRoleIndex=0,qn.ins.curRole=1},e.checkRedPoint=function(e){if(Yn.count<=0)return 0;var t,i=0;if("1"==e&&(kp.selectRoleIndexs[0]=0,t=kp.ins.isMaterialEnough(1)))return t.state,i=t.index,kp.selectRoleIndexs[0]=i,3;if("2"==e&&(kp.selectRoleIndexs[1]=0,t=kp.ins.isMaterialEnough(3)))return t.state,i=t.index,kp.selectRoleIndexs[1]=i,3;if("3"==e&&(kp.selectRoleIndexs[2]=0,t=kp.ins.isMaterialEnough(2)))return t.state,i=t.index,kp.selectRoleIndexs[2]=i,3;if("4"==e){if(!Ql.checkFazhenOpen())return 1;if(Qr.ins.getStateByCareList([279,278])||Ql.checkFazhenOpen()&&Ql.firstLogin)return 3}return 0},e.setFirstTap=function(e){var t=this;kp.ins.forRed&&(kp.ins.forRed=!1,this.callLater(function(){t.nav.selectedIndex=e}))},e.changeSelect=function(e,t){switch(e){case"1":this.setTitle(Or.getAtlasSubPath("strength_mix/strengthen_text_title.png"));break;case"3":this.setTitle(Or.getAtlasSubPath("strength_mix/jewel_text_title.png"));break;case"2":this.setTitle(Or.getAtlasSubPath("strength_mix/enchant_text_title.png"));break;case"4":this.setTitle(Or.getAtlasSubPath("fazhen/fz_text_fz.png"))}this.callLater(this.updateItemEnabled)},e.destroy=function(e){void 0===e&&(e=!0),this.nav&&(this.nav=null),kp.circlePanel&&(kp.circlePanel.destroy(!0),kp.circlePanel=null),kp.actorSelector&&(kp.actorSelector=null);var t=Or.getAtlasSubPath("weaponsoul/ghost_refine_img_bg.jpg");Y.loader.clearRes(t),c.prototype.destroy.call(this,e)},e.showSuccess=function(e){},e.clear=function(){this._isPlayEff=!1,this._effect&&(this._effect.dispose(),this._effect=null)},t.STRENGTH="1",t.SPRIT="2",t.STONE="3",t.FAZHEN="4",t}(jr),Rp=function(e){function t(){this._selector=null,t.__super.call(this)}u(t,"modules.strength.views.sub.FazhenAllView",Ge);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.updateByVSC=function(e){if(e){var t=wp.ins.fazhenInfo[this._selector.selectIdx+1],i=[];for(var s in t){var n=t[s];i.push(n)}i.sort(this.sort),this.listType.array=i,this._selector.invalid()}},i.sort=function(e,t){return e.type-t.type},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.listType.scrollBar.on("change",this,this.onScrollEnd),this._selector.on("select",this,this.onRoleHandler),this.onRoleHandler()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.listType.scrollBar.off("change",this,this.onScrollEnd),this._selector.off("select",this,this.onRoleHandler)},i.onRoleHandler=function(){var e=new rl;e.roleIndex=this._selector.selectIdx+1,Fl.sendToService(e)},i.onScrollEnd=function(e){this.listType.scrollBar.value>=this.listType.scrollBar.max?this.imgBlack.visible=!1:this.imgBlack.visible=!0},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.centerY=e.centerX=0,e._selector=new ma,e._selector.redptHandler=ms.create(e,e.needRedpt,null,!1),e.addChild(e._selector),e.listType.itemRender=Tp,e.listType.vScrollBarSkin="",e.listType.spaceX=-5,e.listType.centerX=3},i.needRedpt=function(e){var t=wp.ins.fazhenInfo[Gi.ins.actorList.indexOf(e)+1];for(var i in t){var s=t[i];if(s.canOper||s.juLianCanOper)return!0}return Ql.firstLogin},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},t}(),Pp=function(e){function t(){var e=this;e._sp=null,e._actorSelector=null,e._roleIndex=0,e._isEnough=!1,e.g_cost=null,e._effect=null,e._upEff=null,t.__super.call(e),e.centerY=e.centerX=0,e.initUI()}u(t,"modules.strength.views.sub.SpritView",Jo);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initUI=function(){this.g_cost=new ra(45),this.g_cost.needGridBg=!1,this.g_cost.pos(this.lbl_cost.x+50,this.lbl_cost.y-10),this.sp.addChild(this.g_cost);var e=an.create(3);this.g_cost.bindData=e},i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.hde_cost.style.font="SimHei",this.hde_cost.style.fontFamily="SimHei",this.hde_cost.style.fontSize=24,this.hde_cost.style.color="#e3dcc2",this.hde_cost.style.align="center",this.hde_cost.width=180,this.hde_cost.innerHTML="",this.bg.skin=Or.getFullUrl("ui/images/strength/dz_jm_bg.jpg")},i.hideByVSC=function(e,t){var i=this;i.btb_sprit.off("mousedown",i,i.onMouseDownHandler),i.btb_sprit.off("mouseup",i,i.onMouseUpHandler),i.btb_sprit.off("mouseout",i,i.onMouseUpHandler),Y.timer.clear(i,i.autoUpgrade)},i.showByVSC=function(e,t){var i=this;i.btb_sprit.on("mousedown",i,i.onMouseDownHandler),i.btb_sprit.on("mouseup",i,i.onMouseUpHandler),i.btb_sprit.on("mouseout",i,i.onMouseUpHandler),i._sp=kp.circlePanel,i._sp.x=112,i._sp.y=200,i.addChild(i._sp),i._actorSelector=kp.actorSelector,i._actorSelector.centerX=0,i.addChild(i._actorSelector),i._actorSelector.selectIdx=kp.ins.currentSelectedRoleIndex,i._actorSelector.on("select",i,i.onSelectRole),i._roleIndex=i._actorSelector.selectIdx+1,i.sprit_get.on("click",i,i.openQuickBuyPanel),i.updateByVSC(null)},i.openQuickBuyPanel=function(e){Fl.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:3})},i.onSelectRole=function(e){this._actorSelector&&this._actorSelector.parent instanceof modules.strength.views.sub.SpritView&&this._roleIndex!=this._actorSelector.selectIdx+1&&(this._roleIndex=this._actorSelector.selectIdx+1,kp.ins.currentSelectedRoleIndex=this._actorSelector.selectIdx,this.updateByVSC(null))},i.updateByVSC=function(e){var t=this;if(t.showRedPoint(),e&&Y.__typeof(e,"zwc.saiman.interfaces.dock.IMessage")&&"BP_UPDATE"==e.actionOrder)t.updateMaterial();else{t._isEnough=!1;var i=Gi.ins.actorList[t._roleIndex-1].spriteTotalLv,s=Sp.getList(i),n=Sp.getIndex(i),o=s[n];t._sp.update(n,s,3);var a=ri.ins.getGoodsNum(3),r=kp.ins.getCost(3,o);if(-1==r){t.hde_cost.innerHTML="",t.sp.visible=!1,t.g_cost.visible=!1,t.img_max.visible=!0,t.mc_arrow.visible=!1;var l=Sp.getEnchantPro(n,o);l&&""!=l?t.showAttr(t._beforeBox.graphics,l,"#e3dcc2",!1):t.clearAttr(t._beforeBox.graphics),t._beforeBox.x=415,t.clearAttr(t._afterBox.graphics)}else{t.mc_arrow.visible=!0,t.g_cost.visible=!0,t.sp.visible=!0,t.img_max.visible=!1,r<=a?(t._isEnough=!0,t.hde_cost.innerHTML=nc.createColor(a+"","#23b11f")+"/"+r):(t._isEnough=!1,t.hde_cost.innerHTML=nc.createColor(a+"","#ff2e24")+"/"+r),t._beforeBox.x=349;var c=Sp.getEnchantPro(n,o),d=Sp.getEnchantPro(n,o+1);c&&""!=c?t.showAttr(t._beforeBox.graphics,c,"#90877b",!1):t.clearAttr(t._beforeBox.graphics),d&&""!=d?t.showAttr(t._afterBox.graphics,d,"#23b11f",!0):t.clearAttr(t._afterBox.graphics)}t.sp.visible||Y.timer.clear(t,t.autoUpgrade),t.caculateFightValue()}},i.showRedPoint=function(){for(var e=0;e<Gi.ins.actorList.length;e++){var t=kp.ins.checkMaterialEnough(e,3);this._actorSelector.setRedPtByIdx(e,t)}var i=kp.ins.checkMaterialEnough(this._roleIndex-1,3);this.btb_sprit.showTip=i},i.clearAttr=function(e){e.clear()},i.showAttr=function(e,t,i,s){void 0===s&&(s=!1),e.clear();var n,o,a=Se.formatNewAttrToChinese(t),r=s?-5:-13,l=0,c=0,d=r,u=a.length;c=(l=1==u?50:2==u?35:4,27);for(var h=mi.getRes(Or.getAtlasSubPath("basic_ui/comp_textbg.png")),_=0;_<a.length;_++)n=a[_],s?e.drawTexture(h,d,l,50,25):(e.drawTexture(h,d,l,155,25),o=Se.getAttributById(parseInt(n.id)),e.fillText(o.name+": ",d,l,"24px SimHei",i,"left"),d+=22*ur.getStringLength(o.name+": ")>>1),e.fillText(n.val+"",d,l,"24px SimHei",i,"left"),l+=c,d=r},i.caculateFightValue=function(){for(var e,t=Gi.ins.actorList[this._roleIndex-1].spriteTotalLv,i=0,s=0,n=0;n<kp.EQUIP_INDEX.length;n++)i=Sp.getPartLvl(t,kp.EQUIP_INDEX[n]),e=Sp.getEnchantAttr(kp.EQUIP_INDEX[n],i),s+=f.getFight(e,this._roleIndex);this.fight_value.value=s},i.onMouseDownHandler=function(e){this.autoUpgrade(),Y.timer.loop(300,this,this.autoUpgrade)},i.onMouseUpHandler=function(e){Y.timer.clear(this,this.autoUpgrade)},i.autoUpgrade=function(){if(!this._isEnough)return this.openQuickBuyPanel(null),void Y.timer.clear(this,this.autoUpgrade);var e=Gi.ins.actorList[this._roleIndex-1].spriteTotalLv,t=Sp.getIndex(e);Sp.reqUpdate(3,this._roleIndex,t),Pc.ins.playSound("34",3,!0)},i.updateMaterial=function(){this._isEnough=!1;ri.ins.getGoodsNum(3);var e=Gi.ins.actorList[this._roleIndex-1].spriteTotalLv,t=Sp.getList(e),i=Sp.getIndex(e),s=ri.ins.getGoodsNum(3),n=kp.ins.getCost(3,t[i]);n<=s?(this._isEnough=!0,this.hde_cost.innerHTML=nc.createColor(s+"","#23b11f")+"/"+nc.createColor(n+"","#e0d6c1")):(this._isEnough=!1,this.hde_cost.innerHTML=nc.createColor(s+"","#ff2e24")+"/"+nc.createColor(n+"","#e0d6c1"))},i.showSuccessEffect=function(){var e=this;e._effect&&(e._effect.parent&&e._effect.parent.removeChild(e._effect),e._effect.dispose(),e._effect=null),e._effect=Es.GetNew(),e._effect.renderInSelf=!0,e._effect.loadEffect("jm1074"),e._effect.setXY(480,565),e.addChildAt(e._effect,e.getChildIndex(e.bg)+1),e.showUpEff()},i.showUpEff=function(){this.clearUpEff(),this._upEff=Es.GetNew(),this._upEff.renderInSelf=!0,this._upEff.loadEffect("jm1071"),this._upEff.setXY(480,590),this.addChild(this._upEff)},i.clearUpEff=function(){this._upEff&&(this._upEff.parent&&this._upEff.parent.removeChild(this._upEff),this._upEff.dispose(),this._upEff=null)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.bg&&t.bg.skin&&Y.loader.clearRes(t.bg.skin),t.clearUpEff(),t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null),laya.ui.View.prototype.destroy.call(t,e)},t}(),Np=function(e){function t(){var e=this;e._sp=null,e._actorSelector=null,e._roleIndex=0,e._isEnough=!1,e.g_cost=null,e._effect=null,e._upEff=null,t.__super.call(e),e.centerY=e.centerX=0,e.initUI()}u(t,"modules.strength.views.sub.StoneView",jo);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initUI=function(){this.g_cost=new ra(45),this.g_cost.needGridBg=!1,this.g_cost.pos(this.lbl_cost.x+50,this.lbl_cost.y-10),this.sp.addChild(this.g_cost);var e=an.create(2);this.g_cost.bindData=e},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.hde_cost.style.font="SimHei",e.hde_cost.style.fontFamily="SimHei",e.hde_cost.style.fontSize=24,e.hde_cost.style.color="#e3dcc2",e.hde_cost.style.align="center",e.hde_cost.style.valign="middle",e.hde_cost.width=180,e.hde_cost.innerHTML="",e.bg.skin=Or.getFullUrl("ui/images/strength/dz_jm_bg.jpg")},i.hideByVSC=function(e,t){var i=this;i.btn_stone.off("mousedown",i,i.onMouseDownHandler),i.btn_stone.off("mouseup",i,i.onMouseUpHandler),i.btn_stone.off("mouseout",i,i.onMouseUpHandler),Y.timer.clear(i,i.autoUpgrade)},i.showByVSC=function(e,t){var i=this;i.btn_stone.on("mousedown",i,i.onMouseDownHandler),i.btn_stone.on("mouseup",i,i.onMouseUpHandler),i.btn_stone.on("mouseout",i,i.onMouseUpHandler),i._sp=kp.circlePanel,i._sp.x=112,i._sp.y=200,i.addChild(i._sp),i._actorSelector=kp.actorSelector,i._actorSelector.centerX=0,i.addChild(i._actorSelector),i._actorSelector.selectIdx=kp.ins.currentSelectedRoleIndex,i._actorSelector.on("select",i,i.onSelectRole),i._roleIndex=i._actorSelector.selectIdx+1,i.stone_get.on("click",i,i.openQuickBuyPanel),i.updateByVSC(null)},i.openQuickBuyPanel=function(e){Fl.sendToModule("OPEN_MALL_QUICKBUY",["modules.mall.MallModule"],{key:1002,max:-1}),Pc.ins.playSound(90006)},i.onSelectRole=function(e){this._actorSelector&&this._actorSelector.parent instanceof modules.strength.views.sub.StoneView&&this._roleIndex!=this._actorSelector.selectIdx+1&&(this._roleIndex=this._actorSelector.selectIdx+1,kp.ins.currentSelectedRoleIndex=this._actorSelector.selectIdx,this.updateByVSC(null))},i.clearAttr=function(){},i.showAttr=function(e,t,i,s){void 0===s&&(s=!1);var n,o=Se.formatNewAttrToChinese(e),a=0,r=0,l=3,c=o.length;r=(a=1==c?32:2==c?19:4,27),this.graphics.clear();for(var d=mi.getRes(Or.getAtlasSubPath("basic_ui/comp_textbg.png")),u=0;u<o.length;u++)n=o[u],s?this.graphics.drawTexture(d,l,a,50,25):(this.graphics.drawTexture(d,l,a,155,25),Se.getAttributById(parseInt(n.id)),this.graphics.fillText(Sp.getName(n.id)+": ",l,a,"24px SimHei",i,"left"),l+=22*ur.getStringLength(Sp.getName(n.id)+": ")>>1),n&&0<n.val&&0<t?(this["pro_"+u].color="#23b11f",this["pro_"+u].text=Se.getAttributById(n.id).name+"+"+n.val):(this["pro_"+u].color="#90877b",this["pro_"+u].text="未镶嵌"),a+=r,l=3},i.updateByVSC=function(e){var t=this;if(t.showRedPoint(),e&&Y.__typeof(e,"zwc.saiman.interfaces.dock.IMessage")&&"BP_UPDATE"==e.actionOrder)t.updateMaterial();else{t._isEnough=!1;var i=Gi.ins.actorList[t._roleIndex-1].stoneTotalLv,s=Sp.getList(i),n=Sp.getIndex(i);t._sp.update(n,s,2);var o=s[n];t.btn_stone.label=o<4?"镶 嵌":"提 升";var a=Sp.getStonePro(n,o);Sp.getStonePro(n,o+1);a&&""!=a?t.showAttr(a,o,"#23b11f",!1):t.clearAttr();var r=ri.ins.getGoodsNum(2),l=kp.ins.getCost(2,s[n]);-1==l?(t.hde_cost.innerHTML="",t.sp.visible=!1,t.img_max.visible=!0,t.g_cost.visible=!1):(t.g_cost.visible=!0,t.sp.visible=!0,t.img_max.visible=!1,l<=r?(t._isEnough=!0,t.hde_cost.innerHTML=nc.createColor(r+"","#23b11f")+"/"+l):(t._isEnough=!1,t.hde_cost.innerHTML=nc.createColor(r+"","#ff2e24")+"/"+l)),t.sp.visible||Y.timer.clear(t,t.autoUpgrade),t.caculateFightValue()}},i.showRedPoint=function(){for(var e=0;e<Gi.ins.actorList.length;e++){var t=kp.ins.checkMaterialEnough(e,2);this._actorSelector.setRedPtByIdx(e,t)}var i=kp.ins.checkMaterialEnough(this._roleIndex-1,2);this.btn_stone.showTip=i},i.caculateFightValue=function(){for(var e,t=Gi.ins.actorList[this._roleIndex-1].stoneTotalLv,i=0,s=0,n=0;n<kp.EQUIP_INDEX.length;n++)i=Sp.getPartLvl(t,kp.EQUIP_INDEX[n]),e=Sp.getStoneAttr(kp.EQUIP_INDEX[n]-1,i),s+=f.getFight(e,this._roleIndex);this.fight_value.value=s+Math.floor(s*this.checkTitle(14))+Math.floor(s*Ql.ins.getPlusByModule("GEMSTONE",this._roleIndex))},i.checkTitle=function(e){var t=0,i=yn.ins.toc_title;if(!i)return 0;var s,n=i.titles[0];for(var o in n)if((s=n[o]).id==e&&0<=s.state){var a=Et.getIndex(e);t=JSON.parse(Et.MODEL.attr(a))[4].value/1e4}else;return t},i.onMouseDownHandler=function(e){this.autoUpgrade(),Y.timer.loop(300,this,this.autoUpgrade)},i.onMouseUpHandler=function(e){Y.timer.clear(this,this.autoUpgrade)},i.autoUpgrade=function(){if(!this._isEnough)return this.openQuickBuyPanel(null),void Y.timer.clear(this,this.autoUpgrade);var e=Gi.ins.actorList[this._roleIndex-1].stoneTotalLv,t=Sp.getIndex(e);Sp.reqUpdate(2,this._roleIndex,t),Pc.ins.playSound("4",3,!0)},i.updateMaterial=function(){this._isEnough=!1;ri.ins.getGoodsNum(2);var e=Gi.ins.actorList[this._roleIndex-1].stoneTotalLv,t=Sp.getList(e),i=Sp.getIndex(e),s=ri.ins.getGoodsNum(2),n=kp.ins.getCost(2,t[i]);n<=s?(this._isEnough=!0,this.hde_cost.innerHTML=nc.createColor(s+"","#23b11f")+"/"+nc.createColor(n+"","#e0d6c1")):(this._isEnough=!1,this.hde_cost.innerHTML=nc.createColor(s+"","#ff2e24")+"/"+nc.createColor(n+"","#e0d6c1"))},i.showSuccessEffect=function(){var e=this;e._effect&&(e._effect.parent&&e._effect.parent.removeChild(e._effect),e._effect.dispose(),e._effect=null),e._effect=Es.GetNew(),e._effect.renderInSelf=!0,e._effect.loadEffect("jm1073"),e._effect.setXY(480,565),e.addChildAt(e._effect,e.getChildIndex(e.bg)+1),e.showUpEff()},i.showUpEff=function(){this.clearUpEff(),this._upEff=Es.GetNew(),this._upEff.renderInSelf=!0,this._upEff.loadEffect("jm1072"),this._upEff.setXY(480,590),this.addChild(this._upEff)},i.clearUpEff=function(){this._upEff&&(this._upEff.parent&&this._upEff.parent.removeChild(this._upEff),this._upEff.dispose(),this._upEff=null)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.bg&&t.bg.skin&&Y.loader.clearRes(t.bg.skin),t.clearUpEff(),t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null),laya.ui.View.prototype.destroy.call(t,e)},t}(),Gp=function(e){function t(){var e=this;e._sp=null,e._actorSelector=null,e._roleIndex=0,e.g_cost=null,e._isEnough=!1,e._effect=null,e._upEff=null,t.__super.call(e),e.centerY=e.centerX=0,e.initUI()}u(t,"modules.strength.views.sub.StrengthView",yi);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initUI=function(){this.g_cost=new ra(45),this.g_cost.needGridBg=!1,this.g_cost.pos(this.lbl_cost.x+50,this.lbl_cost.y-10),this.sp.addChild(this.g_cost);var e=an.create(1);this.g_cost.bindData=e},i.initialize=function(){var e=this;laya.ui.Component.prototype.initialize.call(e),e.html_cost.style.font="SimHei",e.html_cost.style.fontFamily="SimHei",e.html_cost.style.fontSize=24,e.html_cost.style.color="#e3dcc2",e.html_cost.style.align="center",e.html_cost.style.valign="middle",e.html_cost.width=180,e.html_cost.innerHTML="",e.bg.skin=Or.getFullUrl("ui/images/strength/dz_jm_bg.jpg")},i.showByVSC=function(e,t){var i=this;i.btn_strength.on("mousedown",i,i.onMouseDownHandler),i.btn_strength.on("mouseup",i,i.onMouseUpHandler),i.btn_strength.on("mouseout",i,i.onMouseUpHandler),i._sp=kp.circlePanel,i._sp.x=112,i._sp.y=200,i.addChild(i._sp),i._actorSelector=kp.actorSelector,i._actorSelector.centerX=0,i.addChild(i._actorSelector),i._actorSelector.selectIdx=kp.ins.currentSelectedRoleIndex,i._actorSelector.on("select",i,i.onSelectRole),i._roleIndex=i._actorSelector.selectIdx+1,i.strength_get.on("click",i,i.openQuickBuyPanel),i.updateByVSC(null)},i.openQuickBuyPanel=function(e){Fl.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:1})},i.onSelectRole=function(e){this._actorSelector&&this._actorSelector.parent instanceof modules.strength.views.sub.StrengthView&&this._roleIndex!=this._actorSelector.selectIdx+1&&(this._roleIndex=this._actorSelector.selectIdx+1,kp.ins.currentSelectedRoleIndex=this._actorSelector.selectIdx,this.updateByVSC(null))},i.hideByVSC=function(e,t){var i=this;i.btn_strength.off("mousedown",i,i.onMouseDownHandler),i.btn_strength.off("mouseup",i,i.onMouseUpHandler),i.btn_strength.off("mouseout",i,i.onMouseUpHandler),Y.timer.clear(i,i.autoUpgrade),Bl.showing&&Bl.Ins().closeLockArrow(9)},i.updateByVSC=function(e){var t=this;if(t.showRedPoint(),e&&Y.__typeof(e,"zwc.saiman.interfaces.dock.IMessage")&&"BP_UPDATE"==e.actionOrder)t.updateMaterial();else{t._isEnough=!1;var i=Gi.ins.actorList[t._roleIndex-1].strengthTotalLv,s=Sp.getList(i),n=Sp.getIndex(i),o=s[n];t._sp.update(n,s,1);var a,r,l=ri.ins.getGoodsNum(1),c=kp.ins.getCost(1,o);-1==c?(t._isEnough=!1,t.html_cost.innerHTML="",t.sp.visible=!1,t.img_max.visible=!0,t.mc_arrow.visible=!1,t.g_cost.visible=!1,t._afterBox.visible=!1,t._beforeBox.x=411,(a=Sp.getStrenPro(n,o))&&""!=a?t.showAttr(t._beforeBox.graphics,a,"#90877b",!1):t.clearAttr(t._beforeBox.graphics)):(t.mc_arrow.visible=!0,t.g_cost.visible=!0,t.sp.visible=!0,t._afterBox.visible=!0,t.img_max.visible=!1,c<=l?(t._isEnough=!0,t.html_cost.innerHTML=nc.createColor(l+"","#23b11f")+"/"+c):(t._isEnough=!1,t.html_cost.innerHTML=nc.createColor(l+"","#ff2e24")+"/"+c),t._beforeBox.x=341,a=Sp.getStrenPro(n,o),r=Sp.getStrenPro(n,o+1),a&&""!=a?t.showAttr(t._beforeBox.graphics,a,"#90877b",!1):t.clearAttr(t._beforeBox.graphics),r&&""!=r?t.showAttr(t._afterBox.graphics,r,"#23b11f",!0):t.clearAttr(t._afterBox.graphics)),t.sp.visible=!t.img_max.visible,t.sp.visible||Y.timer.clear(t,t.autoUpgrade),t.caculateFightValue()}},i.showGuide=function(e,t){if(t)if(ln.Ins().hasNewGuide(e))switch(e){case 9:var i=new qo;i.x=this.btn_strength.x,i.y=this.btn_strength.y-15,i.width=this.btn_strength.width,i.height=this.btn_strength.height+10,Bl.Ins().show(e,i,!1,this.sp),Bl.Ins().lockSceneShowByDisPlay(this.btn_strength)}else Bl.showing&&Bl.Ins().closeLockArrow(9);else Bl.showing&&Bl.Ins().closeLockArrow(9)},i.clearAttr=function(e){e.clear()},i.showRedPoint=function(){var e=this;e.red_point.visible=!1;for(var t=0;t<Gi.ins.actorList.length;t++){var i=kp.ins.checkMaterialEnough(t,1);e._actorSelector.setRedPtByIdx(t,i)}var s=kp.ins.checkMaterialEnough(e._roleIndex-1,1);((e.btn_strength.showTip=s)?Y.timer.once(200,e,e.showGuide,[9,!0]):e.showGuide(9,!1),e.sp.visible&&(e.red_point.visible=!1),s)||8<ri.ins.getRecycleEquips(M.NORMAL).length&&(e.sp.visible=!0,e.red_point.visible=!1)},i.showAttr=function(e,t,i,s){void 0===s&&(s=!1),e.clear();var n,o,a=Se.formatNewAttrToChinese(t),r=0,l=0,c=-5,d=a.length;l=(r=1==d?50:2==d?35:4,27);for(var u=mi.getRes(Or.getAtlasSubPath("basic_ui/comp_textbg.png")),h=0;h<a.length;h++)n=a[h],s?e.drawTexture(u,c,r,50,25):(e.drawTexture(u,c,r,155,25),o=Se.getAttributById(parseInt(n.id)),e.fillText(o.name+": ",c,r,"24px SimHei",i,"left"),c+=22*ur.getStringLength(o.name+": ")>>1),e.fillText(n.val+"",c,r,"24px SimHei",i,"left"),r+=l,c=-5},i.caculateFightValue=function(){for(var e,t=Gi.ins.actorList[this._roleIndex-1].strengthTotalLv,i=0,s=0,n=0;n<kp.EQUIP_INDEX.length;n++)i=Sp.getPartLvl(t,kp.EQUIP_INDEX[n]),e=Sp.getStrenAttr(kp.EQUIP_INDEX[n],i),s+=f.getFight(e,this._roleIndex);this.fight_value.value=s},i.onMouseDownHandler=function(e){var t=!1;Bl.showing&&9==Bl.Ins().currGuideId&&(this.showGuide(9,!0),Fl.sendToModule("SHOWCLOSENEWGUIDE",["modules.gui.GuiModule"]),t=!0),t?this.autoUpgrade():(this.autoUpgrade(),Y.timer.loop(300,this,this.autoUpgrade))},i.onMouseUpHandler=function(){Y.timer.clear(this,this.autoUpgrade)},i.autoUpgrade=function(){if(!this._isEnough)return this.openQuickBuyPanel(null),void Y.timer.clear(this,this.autoUpgrade);var e=Gi.ins.actorList[this._roleIndex-1].strengthTotalLv,t=Sp.getIndex(e);Sp.reqUpdate(1,this._roleIndex,t),Pc.ins.playSound("3",3,!0)},i.updateMaterial=function(){this._isEnough=!1;ri.ins.getGoodsNum(1);var e=Gi.ins.actorList[this._roleIndex-1].strengthTotalLv,t=Sp.getList(e),i=Sp.getIndex(e),s=ri.ins.getGoodsNum(1),n=kp.ins.getCost(1,t[i]);n<1?this.sp.visible=!1:(this.sp.visible=!0,n<=s?(this._isEnough=!0,this.html_cost.innerHTML=nc.createColor(s+"","#23b11f")+"/"+nc.createColor(n+"","#e0d6c1")):(this._isEnough=!1,this.html_cost.innerHTML=nc.createColor(s+"","#ff2e24")+"/"+nc.createColor(n+"","#e0d6c1")))},i.showSuccessEffect=function(){var e=this;e._effect&&(e._effect.parent&&e._effect.parent.removeChild(e._effect),e._effect.dispose(),e._effect=null),e._effect=Es.GetNew(),e._effect.renderInSelf=!0,e._effect.loadEffect("jm1073"),e._effect.setXY(480,565),e.addChildAt(e._effect,e.getChildIndex(e.bg)+1),e.showUpEff()},i.showUpEff=function(){this.clearUpEff(),this._upEff=Es.GetNew(),this._upEff.renderInSelf=!0,this._upEff.loadEffect("jm1070"),this._upEff.setXY(480,590),this.addChild(this._upEff)},i.clearUpEff=function(){this._upEff&&(this._upEff.parent&&this._upEff.parent.removeChild(this._upEff),this._upEff.dispose(),this._upEff=null)},i.destroy=function(e){var t=this;void 0===e&&(e=!0),t.bg&&t.bg.skin&&Y.loader.clearRes(t.bg.skin),t.clearUpEff(),t._effect&&(t._effect.parent&&t._effect.parent.removeChild(t._effect),t._effect.dispose(),t._effect=null),laya.ui.View.prototype.destroy.call(t,e)},t}(),Up=(function(e){function t(){t.__super.call(this),this.addSubscribe(Up),this.subPackages=["22702","22707","22709","22711","22713","22715","13501","13502","13504","13507","BP_UPDATE"]}u(t,"modules.fashion.FashionModule",Tc)}(),function(){function e(e){this.index=0,this.step=0,this.star=0,this.consume=null,this.attr=null,this.fight=0,this.decode(e)}u(e,"modules.fashion.others.YiguiVo");var t=e.prototype;t.decode=function(e){this.index=Mr.getIndex(e),this.star=Mr.MODEL.level(this.index),this.step=Mr.MODEL.tie(this.index),this.consume=Mr.MODEL.consume(this.index),this.attr=Mr.MODEL.attrs(this.index)},t.getIndex=function(){for(var e=0;e<Mr.count;e++)if(Mr.MODEL.level(e)==this.star&&Mr.MODEL.tie(e)==this.step)return e;return 0},t.getNextCfgIdx=function(){var e=this.index+1,t=Mr.MODEL.level(e),i=Mr.MODEL.tie(e);return t==this.star+1||i==this.step+1?e:-1},n(0,t,"isUpStep",function(){var e=this.index+1;Mr.MODEL.level(e);return Mr.MODEL.tie(e)==this.step+1}),n(0,t,"nextAttr",function(){var e=this.getNextCfgIdx();return-1<e?Mr.MODEL.attrs(e):null}),n(0,t,"canOper",function(){if(-1<this.getNextCfgIdx()){var e,t=JSON.parse(this.consume)[0].value.split(":"),i=parseInt(t[1]);if(e=parseInt(t[0]),i<=ri.ins.getGoodsNum(e))return!0}return!1})}(),function(e){function n(){var e=this;e._fashionView=null,e._fashionSubView=null,e._titleTotalView=null,e._suitAttrView=null,e._clothesDis=null,n.__super.call(e);var t=["ConfigWardrodeUpgrade","ConfigWardrodeDecompose","ConfigWardrodeMatch","ConfigRule"],i=["CYiguiResource","CClothDispose","CGFTmapping","CHelpDes"],s=[];s.push(Or.getLayoutsPath("fashion")),s.push(Or.getLayoutsPath("title")),s.push(Or.getLayoutsPath("yigui")),On.ins.registPanel("FASHION_VIEW",zp,"_fashionView",e,{wait:On.wait(On.waitRes(s),On.waitConfig(t,i)),layer:"layout",clearAll:!0,mask:!1}),On.ins.registPanel("ClothesDisposeTip",Fp,"_clothesDis",e,{wait:On.wait(On.waitRes(s),On.waitConfig(t,i)),layer:"panel",mask:!0,clickClose:!0}),On.ins.registPanel("TITLE_TOTAL_VIEW",Qt,"_titleTotalView",e,{clearAll:!1,mask:!0}),On.ins.registPanel("SUIT_ATTR_VIEW",jp,"_suitAttrView",e,{clearAll:!1,mask:!0})}u(n,"modules.fashion.proxys.FashionMainProxy",F);var t=n.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){var t=this;switch(e.actionOrder){case"FASHION_OPEN":var i=e.proto;On.ins.open("FASHION_VIEW",i,0);break;case"SUIT_OPEN":break;case"OPEN_SPEC_TAB":if(t._fashionView){var s=e.proto;t._fashionView.setSelectIndex(s)}break;case"22702":var n=e.proto;n&&(ht.ins.fashionHash=n.fashionHash,ht.ins.suitHash=n.suitHash,t._fashionView&&t._fashionView.parent&&t._fashionView.updateView());break;case"22707":e.proto;break;case"22709":var o=e.proto,a=o.index;o&&(0!=a?t._fashionView&&Y.timer.once(200,t,t.updateSubView,[o]):Vl.ins.showById(101,1));break;case"13502":e.proto.count;break;case"13504":yn.ins.toc_title=e.proto,t._fashionView&&t._fashionView.updateView();break;case"13507":yn.ins.update(e.proto),t._fashionView&&t._fashionView.updateView();break;case"OPEN_TOTALV":On.ins.open("TITLE_TOTAL_VIEW");break;case"22711":var r=e.proto;if(ht._suitHash){var l=ht._suitHash.take(r.roleId+"_"+r.suitId);if(!l)return;l.state=r.state,ht._suitHash.put(r.roleId+"_"+r.suitId,l),fs.runComplete(),t._fashionView&&t._fashionView.parent&&t._fashionView.vsc.selectedView instanceof modules.fashion.views.FashionSuitView&&t._fashionView.updateView(e.proto)}break;case"22713":ht._suitHash&&ht._suitHash.dispose(),ht._suitHash=e.proto.sHash,t._fashionView&&t._fashionView.parent&&t._fashionView.vsc.selectedView instanceof modules.fashion.views.FashionSuitView&&t._fashionView.updateView(e.proto);break;case"22715":ht.ins.updateYiguiVo(e.proto),t._fashionView&&t._fashionView.parent&&t._fashionView.vsc.selectedView instanceof modules.fashion.views.ClothesCupboardView&&t._fashionView.updateView(e);break;case"BP_UPDATE":t._fashionView&&t._fashionView.parent&&t._fashionView.vsc.selectedView instanceof modules.fashion.views.ClothesCupboardView&&t._fashionView.updateView(e),t._clothesDis&&t._clothesDis.updateShow()}},t.updateSubView=function(e){this._fashionView.updateView(e)},t.showPanel=function(e,t){"FASHION_VIEW"==e?(ht.ins.openIdx!=parseInt(t)&&this._fashionView.openView(parseInt(t)),ht.ins.openIdx=parseInt(t)):"TITLE_TOTAL_VIEW"==e&&this._titleTotalView.showTotal()},t.closePanel=function(e,t){},n}()),Hp=function(e){function t(){var e=this;e._selector=null,e._curShowStep=0,e._curRealStep=-1,e._curStars=-1,e._gridRes=null,e._yiguiVo=null,e._oldActorIdx=-1,e._effectSuc=null,e._canUp=!1,e._effs=new Array,t.__super.call(e)}u(t,"modules.fashion.views.ClothesCupboardView",ai);var i=t.prototype;return i.initialize=function(){var e=this;e._selector=new ma,e._selector.redptHandler=ms.create(e,e.needRedpt,null,!1),e.addChild(e._selector),e._gridRes=new ra(45),e._gridRes.needGridBg=!1,e._gridRes.x=e.txt_cost.x+51,e._gridRes.y=e.txt_cost.y-10,e._gridRes.needEffect=!1,e.boxConsume.addChild(e._gridRes),e.btnRule.hitArea=new qo(0,0,130,50)},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e);var i=new Ha;i.packId=22714,Fl.sendToService(i),t.on("click",t,t.onClick),t.labGetClip.on("click",t,t.onClick),t._selector.on("select",t,t.onSelectRole),t.imgCanDis.visible=0<ht.ins.getCanDisposeCloth().length&&t._yiguiVo&&-1<t._yiguiVo.getNextCfgIdx()},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClick),t.labGetClip.off("click",t,t.onClick),t._selector.off("select",t,t.onSelectRole),t._effectSuc&&t._effectSuc.dispose(),t._effectSuc=null},i.onSelectRole=function(e){this.updateByVSC(1)},i.updateByVSC=function(e){var t=this;if(e){if(t._selector.invalid(),"BP_UPDATE"==e.actionOrder)return t.updateConsume(),void(t.imgCanDis.visible=0<ht.ins.getCanDisposeCloth().length&&t._yiguiVo&&-1<t._yiguiVo.getNextCfgIdx());var i=ht.ins.yiguiInfo,s=!1;t._yiguiVo||(s=!0),t._yiguiVo=i[t._selector.selectIdx+1],t._effectSuc&&t._effectSuc.dispose(),t._effectSuc=null,-1!=t._curRealStep&&t._curRealStep!=t._yiguiVo.step||-1!=t._curStars&&t._curStars!=t._yiguiVo.star&&t._oldActorIdx==t._selector.selectIdx&&(t._effectSuc=ti.createEffect("jm0011",t.width/2,t.height/2+40,t)),t._curRealStep=t._yiguiVo.step,t._curStars=t._yiguiVo.star,t.curShowStep=t._curRealStep,t._oldActorIdx=t._selector.selectIdx,t.updateAttrs(),t.updateConsume(),s&&(t.imgCanDis.visible=0<ht.ins.getCanDisposeCloth().length&&t._yiguiVo&&-1<t._yiguiVo.getNextCfgIdx())}},i.updateAttrs=function(){var e,t,i,s=this;s.boxLeft.graphics.clear(),s.boxRight.graphics.clear();var n,o,a,r=0,l=0;for(t=(e=s._yiguiVo.attr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxLeft,o,"#90877b",a,"#90877b",20,l,24),l+=42;if(s.fight_item.value=f.getFight(t),l=0,-1<s._yiguiVo.getNextCfgIdx())for(s.boxCur.x=25,s.boxNext.visible=!0,s.img_arrow.visible=!0,s.boxRight.visible=!0,s.boxLeft.x=86,t=(e=s._yiguiVo.nextAttr)?JSON.parse(e):null,i=Se.formatNewAttrToChinese(t,!1,!0,!1),r=0;r<i.length;r++)o=(n=i[r]).name+":",a=n.val+"",s.drawAttr(s.boxRight,o,"#23b11f",a,"#23b11f",20,l,24),l+=42;else s.img_arrow.visible=!1,s.boxRight.visible=!1,s.boxLeft.x=279,s.boxCur.x=210,s.boxNext.visible=!1},i.drawAttr=function(e,t,i,s,n,o,a,r,l){void 0===r&&(r=24),void 0===l&&(l=4),e.graphics.fillText(t,o,a,r+"px 黑体",i,"left");var c=o+(ur.getStringLength(t)*r>>1)+l;return""!=s&&e.graphics.fillText(s,c,a,r+"px 黑体",n,"left"),c+(ur.getStringLength(s)*r>>1)+l},i.updateBalls=function(e){var t=this;for(void 0===e&&(e=0);t._effs.length;){var i=t._effs.pop();i&&i.dispose(),i=null}for(var s=0;s<10;s++)if(s<e){if(t["clip_star"+s]){t["clip_star"+s].index=0;var n=ti.createEffect("jm0009",t["clip_star"+s].width/2,t["clip_star"+s].height/2,t["clip_star"+s]);t._effs.push(n)}t["clip_line"+s]&&(t["clip_line"+s].index=0)}else t["clip_star"+s]&&(t["clip_star"+s].index=1),t["clip_line"+s]&&(t["clip_line"+s].index=1);if(t._curShowStep==t._curRealStep&&e<10){t.imgCurAt.visible=!0,t.imgCurAt.pos(t["clip_star"+e].x+23,t["clip_star"+e].y+24);var o=ti.createEffect("jm0008",t["clip_star"+e].width/2,t["clip_star"+e].height/2,t["clip_star"+e]);t._effs.push(o)}else t.imgCurAt.visible=!1},i.updateConsume=function(){var e=this,t=e._yiguiVo.getNextCfgIdx();if(e.btn_update.label=e._yiguiVo.isUpStep?"升 阶":"升 级",-1<t)if(e.boxConsume.visible=!0,e.img_max.visible=!1,e._yiguiVo.isUpStep)e._canUp=!0,e.imgTipCanUp.visible=!0,e.txt_cost.visible=e._gridRes.visible=e.html_cost.visible=e.img_costBg.visible=!1;else{e.txt_cost.visible=e._gridRes.visible=e.html_cost.visible=e.img_costBg.visible=!0;var i,s,n=JSON.parse(e._yiguiVo.consume)[0].value.split(":"),o=parseInt(n[1]);i=parseInt(n[0]),s=ri.ins.getGoodsNum(i),e._gridRes.bindData=an.create(i),o<=s?(e._canUp=!0,e.html_cost.innerHTML=nc.createColor(s+"","#23b11f")+"/"+o,e.imgTipCanUp.visible=!0):(e._canUp=!1,e.html_cost.innerHTML=nc.createColor(s+"","#ff2e24")+"/"+o,e.imgTipCanUp.visible=!1),e.img_costBg.width=e.html_cost.contextWidth+30}else e.boxConsume.visible=!1,e.img_max.visible=!0},i.onClick=function(e){switch(e.target){case this.btn_update:if(!this._canUp)return void Vl.ins.playErrorMsg(ed.n[1962]);var t=new so;t.role=this._selector.selectIdx+1,Fl.sendToService(t);break;case this.btnRule:var i=po.getIndex(31),s=po.MODEL.description(i);On.ins.open("AE_EXPLAIN_VIEW",{desc:s})}e.currentTarget==this.labGetClip&&On.ins.open("ClothesDisposeTip")},i.needRedpt=function(e){var t=ht.ins.yiguiInfo[Gi.ins.actorList.indexOf(e)+1];return t.canOper||0<ht.ins.getCanDisposeCloth().length&&-1<t.getNextCfgIdx()},i.showByVSC=function(e,t){},i.hideByVSC=function(e,t){},n(0,i,"curShowStep",function(){return this._curShowStep},function(e){this._curShowStep=e,this.clip_lvl.value=ur.getChineseNum(this._curShowStep)+"阶";var t=ur.getChineseNum(this._yiguiVo.step).length;this.img_lvlbg.height=78+27*t,this.updateBalls(this._curStars)}),t}(),Fp=function(e){function t(){t.__super.call(this)}u(t,"modules.fashion.views.ClothesDisposeTip",Ol);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.txt_no.visible=!1,this.btn_close.on("click",this,this.onClick),this.updateShow(),this.list.scrollBar.on("change",this,this.onScrollEnd)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick),this.list.scrollBar.off("change",this,this.onScrollEnd)},i.onScrollEnd=function(e){this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.initialize=function(){laya.ui.Component.prototype.initialize.call(this),this.centerX=this.centerY=0,this.list.itemRender=Kp,this.list.vScrollBarSkin="",this.list.scrollBar.elasticBackTime=300,this.list.scrollBar.elasticDistance=100},i.updateShow=function(){var e=ht.ins.getCanDisposeCloth();this.list.array=e,this.txt_no.visible=e.length<1},i.onClick=function(e){On.ins.close("ClothesDisposeTip")},t.NAME="ClothesDisposeTip",t}(),zp=function(s){function t(){var e=this;e.V_CLOTHES="1",e.V_WEAPONS="2",e.V_TITLE="3",e.V_WING="4",e.V_SUIT="5",e.V_YIGUI="6",e._curIdx=-1,e.vsc=null,e.avatorData=null,e.originalData=null,t.__super.call(e),e.mouseEnabled=!0,e.top=e.bottom=e.left=e.right=0}u(t,"modules.fashion.views.FashionMainView",s);var e=t.prototype;return e.initialize=function(){var e=this;e.size(720,1280),e.centerX=e.centerY=0,e.navList=["ui/layouts/fashion/yq_btn_sz.png","ui/layouts/fashion/yq_btn_wq.png","ui/layouts/fashion/yq_btn_ch.png","ui/layouts/fashion/yq_btn_yysz.png","ui/layouts/fashion/yq_btn_tz2.png","ui/layouts/yigui/yq_btn_yc.png"],e.vsc=new o(e),e.vsc.selectHandler=ms.create(e,e.onSubChanged,null,!1),e.vsc.registAll([{cls:Wp,id:e.V_CLOTHES,isHideBg:!0,wait:On.wait(On.waitConfig(["FashionUpgradeResource","ConfigFashion","ConfigFashionSuit"],["CFashionUpgradeResourceModel","CFashionModel","CFashionSuitModel"]))},{cls:Wp,id:e.V_WEAPONS,isHideBg:!0},{cls:co,id:e.V_TITLE,showDragon:!0},{cls:Wp,id:e.V_WING,isHideBg:!0},{cls:Yp,id:e.V_SUIT,showDragon:!0},{cls:Hp,id:e.V_YIGUI,showDragon:!0,isHideBg:!0}]),e.vsc.filterHandler=ms.create(e,e.checkTips,null,!1),e.vsc.invalid()},e.onAdd=function(e){var t=this;s.prototype.onAdd.call(t,e),Qr.ins.addListener("BTN_FASHION",[12,13,15,14,276,280],ms.create(t,t.redPtUpdate,null,!1));for(var i=0;i<Gi.ins.actorList.length;i++)t.originalData=Gi.ins.actorList[i],t.avatorData=new sc(t.originalData.id),t.avatorData.sex=t.originalData.sex,t.avatorData.mid=t.originalData.mid,t.avatorData.wid=t.originalData.wid,t.avatorData.wgid=t.originalData.wgid,ht.ins.avatorDataArr.push(t.avatorData);ht.ins.selectArr=[0,0,0,0]},e.onRemove=function(e){s.prototype.onRemove.call(this,e),Qr.ins.removeListener("BTN_FASHION"),ht.ins.avatorDataArr=[],ht.ins.selectArr=[],this.avatorData=null,this.originalData=null},e.updateView=function(e){this.vsc.selectedView instanceof modules.title.views.TitleShowV?(this.reqTabRedPt(),this.vsc.selectedView.update()):(this.reqTabRedPt(),this.vsc.updateSelectedView(e))},e.updateItemEnabled=function(){this.vsc.updateItemEnabled()},e.openView=function(e){this._curIdx=e;var t="";switch(this._curIdx){case 3:t="title/ch_text_ch.png";break;case 5:t="fashion/tz_title_tz.png";break;case 6:t="yigui/yc_text_yc.png";break;default:t="fashion/zb_title_zb.png"}this.vsc.selectedIndex=this._curIdx-1,this.setTitle(Or.getAtlasSubPath(t))},e.reqTabRedPt=function(){Qr.reqRedPt([12,13,15,14,276,280])},e.onSubChanged=function(e,t){this.openView(parseInt(e)),e!=this.V_TITLE&&fs.reqFashionData()},e.redPtUpdate=function(e,t){this.updateItemEnabled()},e.checkTips=function(e){return e==this.V_CLOTHES&&Qr.ins.getStateByCareList([12])?3:e==this.V_WEAPONS&&Qr.ins.getStateByCareList([13])?3:e==this.V_WING&&Qr.ins.getStateByCareList([14])?3:e==this.V_TITLE&&Qr.ins.getStateByCareList([15])?3:e==this.V_SUIT&&Qr.ins.getStateByCareList([276])?3:e==this.V_YIGUI&&Qr.ins.getStateByCareList([280])?3:0},e.setSelectIndex=function(e){this.vsc.selectedIndex=e-1},e.destroy=function(e){void 0===e&&(e=!0),s.prototype.destroy.call(this,e)},t}(jr),Wp=function(e){function t(){var e=this;e.curRoleIndex=0,e._selector=null,e.curSelectRender=null,e.avatar=null,e._type=0,e._status=0,e._canActive=!1,e._fid=0,e.act_dto=null,e._costId=0,e.isShowRemainTime=!1,e.isFirst=!0,e._currentSelectIndex=0,e.beforeSelectIndex=0,e.guildColth=80100001,e.guildWeather=80200001,e.fashionData=ht.ins,t.__super.call(e)}u(t,"modules.fashion.views.FashionSubView",Ee);var i=t.prototype;return Y.imps(i,{"ui.IVSCView":!0}),i.initialize=function(){var e=this;e.list_fashion.itemRender=Xp,e.list_fashion.vScrollBarSkin="",e.list_fashion.repeatY=1,e.list_fashion.spaceY=6,e.list_fashion.scrollBar.elasticBackTime=300,e.list_fashion.scrollBar.elasticDistance=100,e.list_fashion.selectEnable=!0,e.list_fashion.scrollBar.on("end",e,e.onScrollEnd),e.list_fashion.selectHandler=ms.create(e,e.onListMouse,null,!1),e._selector=new ma,e._selector.centerX=0,e._selector.y=60,e.addChild(e._selector),e.avatar=new Wi,e.avatar.pos(-260,314),e.avatar.scale(.9,.9),e.addChildAt(e.avatar,1),e.txt_desc.visible=!1},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t._currentSelectIndex=0,t.btn.on("click",t,t.onClickBtn),t.btn_next.on("click",t,t.onClickNextBtn),t.btn_prev.on("click",t,t.onClickPrevBtn),t.btnup.on("click",t,t.onClickUpBtn)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t._currentSelectIndex=0,t.btn.off("click",t,t.onClickBtn),t.btn_next.off("click",t,t.onClickNextBtn),t.btn_prev.off("click",t,t.onClickPrevBtn),t.btnup.off("click",t,t.onClickUpBtn)},i.updateByVSC=function(e){e instanceof protos.fashion.toc_22709?(this.showFashionList(!0),this.showDetailInfo(e.index),Vl.ins.showMsg(ed.n[1963],1)):(this.showFashionList(this.isFirst),this.list_fashion.selectedItem&&this.showDetailInfo(this.list_fashion.selectedItem.fid))},i.showByVSC=function(e,t){var i=this;i._selector.selectIdx=ma.globalIdx,i._selector.on("select",i,i.onSelectRole),i.curRoleIndex=i._selector.selectIdx+1,i.updateAvatar(),i._type=parseInt(e),i._status=0,i.setDefault(!1),i.isFirst=!0,i.showFashionList(!0);var s=i.fashionData.getFashionById(i.curRoleIndex,i._fid);s?10<=nr.MODEL.level(s.f_id-1)?(i.btnup.visible=!1,i.setTextCostPos1(),i.txt_next.visible=!1,i.img_jt.visible=!1,i.txt_cur.x=309,i.txt_cur.changeText(ed.n[1964])):(i.btnup.visible=!0,i.setTextCostPos(),i.txt_next.visible=!0,i.img_jt.visible=!0,i.txt_cur.x=173,i.txt_cur.changeText(ed.n[1965])):(i.btnup.visible=!1,i.setTextCostPos1(),i.txt_next.visible=!0,i.img_jt.visible=!0,i.txt_cur.x=173,i.txt_cur.changeText(ed.n[1966]))},i.hideByVSC=function(e,t){this._selector.off("select",this,this.onSelectRole),this.curSelectRender&&this.curSelectRender.setSelectBg(!1),this.act_dto=null,this.list_fashion.selectedIndex=-1,this.list_fashion.tweenTo(0)},i.showFashionList=function(e){var t=this;void 0===e&&(e=!1);for(var i,s,n,o=t._type-1,a=0,r=1,l=[],c=t.fashionData.configArr[o],d=0;d<c.length;d++)if(null!=c[d]){i=c[d];for(var u=r=0;u<i.length;u++)if(a=(n=i[u]).suitID,null!=t.fashionData.findFashionByID(n.id,t.curRoleIndex)){r=nr.MODEL.level(n.id-1);break}if(0==r&&(r=1),n=t.fashionData.findConfigDataByPositionSuitLevel(t._type,a,r),!t.fashionData.canPlatformUse(n))continue;(s={}).fid=n.id,s.roleIndex=t.curRoleIndex,l.push(s)}t.list_fashion.dataSource=l,t._currentSelectIndex>l.length&&(t._currentSelectIndex=0),t.beforeSelectIndex=t.fashionData.selectArr[t._type-1],t.onListMouse(t.beforeSelectIndex),t.curSelectRender=t.list_fashion.selection,t.btn_next.visible=2<=l.length,t.btn_prev.visible=!1,t.list_fashion.repeatY=l.length,Y.timer.callLater(t,t.selectDefault,[e,t._fid])},i.selectDefault=function(e,t){e&&this.list_fashion.tweenTo(0,100,ms.create(this,this.onScrollComplete)),Y.timer.once(200,this,this.showRedPoint,[t,this.curRoleIndex])},i.onScrollComplete=function(){switch(this._type){case 1:this.list_fashion.selectedIndex=this.fashionData.selectArr[0];break;case 2:this.list_fashion.selectedIndex=this.fashionData.selectArr[1];break;case 4:this.list_fashion.selectedIndex=this.fashionData.selectArr[3]}},i.showDetailInfo=function(e){var t=this;if(0!=e){t._fid=e,t.isShowRemainTime=!1;var i=t.fashionData.getFashionById(t.curRoleIndex,e);Gi.ins.actorList[t._selector.selectIdx].sex;if(i?0==i.status?(t.btnup.visible=!1,t.setTextCostPos1(),t.txt_next.visible=!0,t.img_jt.visible=!0,t.txt_cur.x=173,t.txt_cur.changeText(ed.n[1965]),t._status=i.status):10<=nr.MODEL.level(i.f_id-1)?(t.btnup.visible=!1,t.setTextCostPos1(),t.txt_next.visible=!1,t.img_jt.visible=!1,t.txt_cur.x=309,t.txt_cur.changeText(ed.n[1964])):(t.btnup.visible=!0,t.setTextCostPos(),t.txt_next.visible=!0,t.img_jt.visible=!0,t.txt_cur.x=173,t.txt_cur.changeText(ed.n[1965])):(t.btnup.visible=!1,t.setTextCostPos1(),t.txt_next.visible=!0,t.img_jt.visible=!0,t.txt_cur.x=173,t.txt_cur.changeText(ed.n[1966])),i){var s;t._status=i.status,10<=nr.MODEL.level(i.f_id-1)?0==t._status?t.div_cost.visible=!0:t.div_cost.visible=!1:t.div_cost.visible=!0;var n=(s=10<=nr.MODEL.level(nr.getIndex(e))?nr.MODEL.goodsCost(nr.getIndex(e)).split(","):nr.MODEL.goodsCost(nr.getIndex(e+1)).split(","))[0],o=s[1],a=ri.ins.getGoodsNum(n),r=Re.getIndex(n),l=Re.MODEL.name(r);o<=a?(t._canActive=!0,t.div_cost.innerHTML="需要："+nc.createColor(l+"x"+o,"#23b11f")):(t._canActive=!1,t.div_cost.innerHTML="需要："+nc.createColor(l+"x"+o,"#ff2e24")),t.updateOneAttr(e,t.curRoleIndex)}else{t._status=0,t.div_cost.visible=!0;var c=nr.MODEL.goodsCost(nr.getIndex(e)).split(",");t._costId=c[0];var d=Re.getIndex(t._costId),u=Re.MODEL.name(d),h=c[1];h<=ri.ins.getGoodsNum(t._costId)?(t._canActive=!0,t.div_cost.innerHTML="需要："+nc.createColor(u+"x"+h,"#23b11f")):(t._canActive=!1,t.div_cost.innerHTML="需要："+nc.createColor(u+"x"+h,"#ff2e24")),t.updateOneAttr(0,t.curRoleIndex)}t.caculateFight(t.list_fashion.selectedItem.fid-1,t.curRoleIndex);var _=t.fashionData.avatorDataArr[t.curRoleIndex-1];t.updateAvatar(_.mid,_.wid,_.wgid),t.setBtnLabel();nr.MODEL.suitId(nr.getIndex(e))}},i.showRedPoint=function(e,t){for(var i=0;i<Gi.ins.actorList.length;i++){var s=this.fashionData.checkRedPoint(i+1,this._type,e,t);this._selector.setRedPtByIdx(i,s)}},i.setTextCostPos=function(){this.div_cost.x=337,this.btn.left=125},i.setTextCostPos1=function(){this.div_cost.x=200,this.btn.left=262},i.updateAvatar=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i="");var s=this.fashionData.avatorDataArr[this.curRoleIndex-1];""==e&&(e=s.mid),""==t&&(t=s.wid),""==i&&(i=s.wgid),this.avatar.changeAvatar(s.sex,t,e,i)},i.setBtnLabel=function(){switch(this._status){case 0:this.btn.label="激 活";break;case 1:this.btn.label="幻 化";break;case 2:this.btn.label="卸 下"}},i.setDefault=function(e){this.btn.visible=e,this.div_cost.visible=e,this.txt_desc1.visible=e},i.onListMouse=function(e){var t=this;if(!(e<0)){switch(t.curSelectRender&&t.curSelectRender.setSelectBg(!1),t._currentSelectIndex=e,t._type){case 1:t.fashionData.selectArr[0]=t._currentSelectIndex;break;case 2:t.fashionData.selectArr[1]=t._currentSelectIndex;break;case 4:t.fashionData.selectArr[3]=t._currentSelectIndex}var i=t.list_fashion.array[e].fid,s=t.fashionData.avatorDataArr[t.curRoleIndex-1],n=s.sex,o=nr.MODEL.panelId(i-1),a="",r="",l=nr.MODEL.goodsCost(i-1).split(",")[0];if(l==t.guildColth||l==t.guildWeather)switch(t._type){case 1:r="ty";break;case 2:r="tyw"}else switch(t._type){case 1:r="szy";break;case 2:r="szw";break;case 4:r="szc"}if(1<o.length)switch(n){case 1:a=r+o[0];break;case 2:a=r+o[1]}else a=r+o[0];switch(t._type){case 1:s.mid=a;break;case 2:s.wid=a;break;case 4:s.wgid=a}t.fashionData.avatorDataArr[t.curRoleIndex-1]=s,t.curSelectRender=t.list_fashion.selection,t.curSelectRender&&(t.setDefault(!0),t.curSelectRender.setSelectBg(!0),t.showDetailInfo(t.curSelectRender.fid));t.fashionData.getFashionById(t.curRoleIndex,t._fid)}},i.onScrollEnd=function(){0==this.list_fashion.scrollBar.value?this.btn_prev.visible=!1:this.btn_prev.visible=!0,this.list_fashion.scrollBar.value==this.list_fashion.scrollBar.max?this.btn_next.visible=!1:this.btn_next.visible=!0},i.onSelectRole=function(){this.list_fashion.selectedIndex=-1,this.curRoleIndex=this._selector.selectIdx+1,this.updateAvatar(),this.setDefault(!1),this.showFashionList(!0)},i.onClickBtn=function(e){var t,i=this,s=(t=10<=nr.MODEL.level(nr.getIndex(i._fid))?nr.MODEL.goodsCost(nr.getIndex(i._fid)).split(","):nr.MODEL.goodsCost(nr.getIndex(i._fid+1)).split(","))[0],n=t[1],o=Re.getIndex(s),a=Re.MODEL.name(o);switch(i._status){case 0:var r=ed.n[1971]+n+"个"+a+ed.n[1972];ja.ins.show(r,ms.create(i,i.onAlertHandler),!1);break;case 1:fs.reqPutOnFashion(i.curRoleIndex,i._fid);break;case 2:fs.reqTakeOffFashion(i.curRoleIndex,i._fid)}},i.onAlertHandler=function(e){if(1==e){if(!this._canActive)return void Fl.sendToModule("OPEN_NORMAL_QUICKBUY",["modules.mall.MallModule"],{key:this._costId});var t=nr.MODEL.platform(nr.getIndex(this._fid));if(this.fashionData&&!this.fashionData.canPlatformUseByID(t))return;fs.reqActFashion(this.curRoleIndex,this._fid)}},i.onClickUpBtn=function(e){var t=this,i=[],s=t.fashionData.getFashionById(t.curRoleIndex,t._fid);if(s?10<=nr.MODEL.level(nr.getIndex(s.f_id))?(t.btnup.visible=!1,t.setTextCostPos1()):(t.btnup.visible=!0,t.setTextCostPos()):(t.btnup.visible=!1,t.setTextCostPos1()),s){for(var n=!1,o=t.fashionData.getUpgradeCostByFid(s.f_id),a=JSON.parse(o),r=parseInt(a[0].value.split(":")[0]),l=parseInt(a[0].value.split(":")[1]),c=ri.ins.getBackPackItems(),d=0;d<c.length;d++){var u=c[d];i.push(u.goodsId)}for(var h=0;h<i.length;h++){if(i[h]==r)if(l<=ri.ins.getGoodsNum(i[h])){var _=new ut;_.selectIdx=t._selector.selectIdx+1,_.Id=t._fid,Fl.sendToService(_),n=!0}else n=!1}0==n&&Vl.ins.showMsg(ed.n[1973],1)}},i.onClickSuitBtn=function(e){var t=nr.getIndex(this._fid),i=nr.MODEL.suitId(t);fs.reqSuitData(this.curRoleIndex,i),Fl.sendToModule("SUIT_OPEN",["modules.fashion.FashionModule"])},i.onClickNextBtn=function(e){var t=this.list_fashion.startIndex+5;t>=this.list_fashion.length&&(t=this.list_fashion.length-1),this.list_fashion.startIndex!=t&&this.list_fashion.tweenTo(t,150*(t-this.list_fashion.startIndex),ms.create(this,this.onScrollEnd))},i.onClickPrevBtn=function(e){var t=this.list_fashion.startIndex-5;t<0&&(t=0),this.list_fashion.startIndex!=t&&this.list_fashion.tweenTo(t,150*(this.list_fashion.startIndex-t),ms.create(this,this.onScrollEnd))},i.caculateFight=function(e,t){var i,s;s=nr.MODEL.attr(e),i=f.getFight(s,t,0,!0,!1),this.num_fight.value=i},i.updateOneAttr=function(e,t){var i,s,n,o,a,r,l=this,c=[],d=[],u=l.fashionData.getFashionById(t,e);if(u){s=10<=nr.MODEL.level(nr.getIndex(u.f_id))?(l.txt_next.visible=!1,l.img_jt.visible=!1,l.txt_cur.x=309,i=JSON.parse(nr.MODEL.attr(nr.getIndex(u.f_id))),null):(l.txt_next.visible=!0,l.img_jt.visible=!0,l.txt_cur.x=173,i=JSON.parse(nr.MODEL.attr(nr.getIndex(u.f_id))),JSON.parse(nr.MODEL.attr(nr.getIndex(u.f_id+1))));var h=Se.formatAttrToChineseByList(i);h&&0<h.length&&(c=Se.mergeFormatAttrs(h,c));for(var _=0;_<h.length;_++)n=l["txt_cur"+(_+1)],a=h[_],n.changeText(a.sname+"："+a.val);if(null!=s)var p=Se.formatAttrToChineseByList(s);if(p&&0<p.length){d=Se.mergeFormatAttrs(p,d);for(var f=0;f<p.length;f++)o=l["txt_next"+(f+1)],r=p[f],o.innerHTML=r.sname+"："+nc.createColor(r.val,"#23b11f")}}else{i=JSON.parse(nr.MODEL.attr(l._fid-1)),s=JSON.parse(nr.MODEL.attr(l._fid)),h=Se.formatAttrToChineseByList(i),p=Se.formatAttrToChineseByList(s),h&&0<h.length&&(c=Se.mergeFormatAttrs(h,c));for(var g=0;g<h.length;g++)n=l["txt_cur"+(g+1)],a=h[g],n.changeText(a.sname+"："+a.val);p&&0<p.length&&(d=Se.mergeFormatAttrs(p,d));for(var v=0;v<p.length;v++)o=l["txt_next"+(v+1)],r=p[v],o.innerHTML=r.sname+"："+nc.createColor(r.val,"#23b11f")}},i.destroy=function(e){void 0===e&&(e=!0),this.list_fashion.dataSource=[],this.list_fashion.array=[],ui.SubPanel.prototype.destroy.call(this,e)},t}(),jp=function(e){function t(){this.GRID_Y=41,this.GRID_X=280,this.a_box=null,this.s_box=null,this.attrHash=null,t.__super.call(this)}u(t,"modules.fashion.views.FashionSuitAttrView",Zr);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.attrHash=ht.getFsuitAttrs(),this.initShow()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.a_box&&this.a_box.graphics.clear(),this.s_box&&this.a_box.graphics.clear()},i.initShow=function(){var e=this;if(e.attrHash){var t,i=[],s=[];for(var n in e.attrHash.proto)1e4<(t=e.attrHash.proto[n]).sIdx?s.push(t):i.push(t);e.a_box||(e.a_box=new gl,e.a_box.pos(70,133),e.addChild(e.a_box)),e.a_box.graphics.clear();var o=0;for(o=0;o<i.length;o++)e.a_box.graphics.fillText(i[o].sname+"："+i[o].val,Math.floor(o%2)*e.GRID_X,Math.floor(o/2)*e.GRID_Y,"24px SimHei","#90877b","left");for(e.b_spe.y=e.a_box.y+(Math.ceil(i.length/2)-1)*e.GRID_Y+24+27,e.s_box||(e.s_box=new gl,e.addChild(e.s_box)),e.s_box.pos(70,e.b_spe.y+45),e.s_box.graphics.clear(),o=0;o<s.length;o++)e.s_box.graphics.fillText(s[o].sname+"："+s[o].val,0,o*e.GRID_Y,"24px SimHei","#23b11f","left");e.height=e.s_box.y+Math.ceil(s.length-1)*e.GRID_Y+24+45}},t}(),qp=function(t){function r(){var e=this;e._datas=null,e._array=null,e._h=NaN,e._spaceY=12,e._pre=null,e._maxv=-1,e._allrender=!1,r.__super.call(e),e._array=[],e._datas=[],e._h=0}u(r,"modules.fashion.views.FashionSuitListPanel",t);var e=r.prototype;return e.toggleClose=function(){this._pre&&(this._pre.toggle=!1,this._pre=null),this.scrollTo(0,0)},e.changeSize=function(){t.prototype.changeSize.call(this),this._maxv=-1},e.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._datas=null,this._array=null},e.onScrollBarChange=function(e){t.prototype.onScrollBarChange.call(this,e),this._allrender||this.callLater(this.renderCells)},e.renderCells=function(){var e=this,t=e._content.scrollRect;if(!(t.y<=e._maxv)){e._maxv=t.y,e.runCallLater(e.changeSize);var i=e._datas.length,s=15,n=0;e._allrender=!0;for(var o=0;o<i;o++){0<o&&(s+=e._spaceY);var a=e._array[o];a?n=s+a.height:(n=s+r.defH,e._allrender=!1),n>=t.y&&s<t.y+t.height&&null==a&&(a=new Qp,e.addChild(a),a.update(e._datas[o]),a.on("change",e,e.onChange),e._array[o]=a),a&&(a.y=s,a.x=15),s=n}e._h!=s&&(e._h=s,e.refresh()),e._h=s}},e.onChange=function(e){null==this._pre||this._pre==e||(this._pre.toggle=!1),this._pre=e,this._maxv=-1,this.callLater(this.renderCells)},n(0,e,"datas",null,function(e){var t=this;e=e||[],t._datas=e,t.removeChildren();var i=t._datas.length;t._array.length=i;for(var s=0;s<i;s++){var n=t._array[s];n&&(n.update(t._datas[s]),t.addChild(n))}t._maxv=-1,t.callLater(t.renderCells)}),n(0,e,"contentHeight",function(){return this.runCallLater(this.renderCells),this._h}),r.defH=50,r}(_c),Yp=function(e){function t(){this._selector=null,this._panel=null,this.suitHash=null,this.eff=null,t.__super.call(this)}u(t,"modules.fashion.views.FashionSuitView",No);var i=t.prototype;return i.initialize=function(){var e=this;e._selector=new ma,e.addChild(e._selector),e._panel=new qp,qp.defH=110,e._panel.width=640,e._panel.top=245,e._panel.bottom=149,e._panel.centerX=0,e._panel.vScrollBarSkin="",e._panel.vScrollBar.elasticBackTime=300,e._panel.vScrollBar.elasticDistance=100,e.addChildAt(e._panel,e.getChildIndex(e.img_shadow)),e.img_shadow.visible=!1,e.suitHash=ht.fashionSuitHash},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),t._panel.toggleClose(),t._selector.selectIdx=0,ht._curRole=t._selector.selectIdx+1,t._selector.on("select",t,t.onSelectRole),t.btn_total.on("click",t,t.onClickHandler),fs.reqSuitInfo()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.clearEff(),this._selector.off("select",this,this.onSelectRole),this.btn_total.off("click",this,this.onClickHandler)},i.updateByVSC=function(e){e instanceof protos.fashion.toc_22713&&(this.initShow(),this.showRedPoint()),e instanceof protos.fashion.toc_22711&&(this.showRedPoint(),this.clearEff(),this.eff||(this.eff=ti.createEffect("jm1426",this.width>>1,this.height>>1,this)))},i.clearEff=function(){this.eff&&(this.eff.parent&&this.eff.parent.removeChild(this.eff),this.eff.dispose(),this.eff=null)},i.initShow=function(){var e,t,i=[];for(var s in this.suitHash.proto)t=this.suitHash.proto[s],(e=ht._suitHash.take(ht._curRole+"_"+t.sid))&&i.push({suitId:e.suitId,state:e.state,cvo:t,svo:e});i=_s.sortOn(i,["state","suitId"],[Array.DESCENDING,Array.NUMERIC]),this._panel.datas=i},i.onSelectRole=function(){this._selector.selectIdx+1!=ht._curRole&&(this._panel.toggleClose(),ht._curRole=this._selector.selectIdx+1,this.initShow())},i.onClickHandler=function(e){On.ins.open("SUIT_ATTR_VIEW")},i.showRedPoint=function(){for(var e=0;e<Gi.ins.actorList.length;e++){var t=ht.getRoleRedPt(Gi.ins.actorList[e].id);this._selector.setRedPtByIdx(e,t)}},t}(),Kp=function(e){function t(){this._dto=null,this._goodsGrid=null,t.__super.call(this)}u(t,"modules.fashion.views.item.ClothesDisposeItem",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_resolve.on("click",this,this.onClickHandler)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_resolve.off("click",this,this.onClickHandler)},i.onClickHandler=function(e){if(Gi.ins.actorList.length<3&&ht.ALERT)return hn.ins.show(ed.n[1974],ms.create(this,this.onClickHandler),!1),void(ht.ALERT=!1);var t=new Xi;t.arr=[this._dto.uuId],Fl.sendToService(t)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(e){t._dto=e,t._goodsGrid||(t._goodsGrid=new ra,t.gridBox.addChild(t._goodsGrid)),t._goodsGrid.bindData=t._dto,t.labName.text=t._dto.name,t.labName.color=Co.getByQuality(t._dto.colourId);var i=gs.getIndex(t._dto.goodsId),s=gs.MODEL.decomposeGoods(i);if(s){var n=JSON.parse(s)[0].value.split(":"),o=parseInt(n[0]),a=parseInt(n[1]),r=an.create(o);t.labGet.text=r.name+"x"+a,t.labGet.color=Co.getByQuality(r.colourId)}}}),t}(Tn),Jp=function(t){function i(){var e=this;e.fid=0,e.roleIndex=0,e.skin=null,e.img_icon=null,i.__super.call(e),e.img_icon=new Dl,e.img_icon.pos(0,10),e.img_icon.size(116,116),e.addChild(e.img_icon)}u(i,"modules.fashion.views.item.FashionGrid",t);var e=i.prototype;return e.destroy=function(e){void 0===e&&(e=!0),this.img_icon.dispose(),t.prototype.destroy.call(this,e)},e.refresh=function(){if(this.graphics.clear(),nr.hasIndex(this.fid)){var e=nr.getIndex(this.fid),t=nr.MODEL.iconId(e);if(1<t.length){var i=Gi.ins.actorList[this.roleIndex].sex-1;this.img_icon.skin=Or.getFashionIconPath("icgoods"+t[i])}else this.img_icon.skin=Or.getFashionIconPath("icgoods"+t[0])}},e.drawIcon=function(e){e&&this.graphics.drawTexture(e,1,8,this.width,this.height)},n(0,e,"dataSource",null,function(e){this.bindData=e}),n(0,e,"bindData",null,function(e){e&&(this.fid=e.fid,this.roleIndex=e.roleIndex-1,this.refresh())}),i}(rn),Xp=function(e){function t(){this.fid=0,this.roleIndex=0,this._grid=null,this.act_dto=null,this._fidTime=0,t.__super.call(this),this.txt_name.align="center",this.txt_name.font="SimHei"}u(t,"modules.fashion.views.item.FashionItemRender",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._grid=new Jp,this._grid.x=0,this._grid.y=0,this.addChildAt(this._grid,1),this.img_select.visible=!1,this.img_red.visible=!1,this.img_puton.visible=!1},i.update=function(){var e=this,t=nr.getIndex(e.fid);e.txt_name.changeText(nr.MODEL.name(t));var i=nr.MODEL.level(t);e.txt_level.changeText(i+"级");var s={};s.fid=e.fid,s.roleIndex=e.roleIndex,e._grid.bindData=s,e._grid.scale(.9,.9),e._grid.x=8;var n=e.img_puton.visible=!1,o=ht.ins.getFashionById(e.roleIndex,e.fid),a=nr.MODEL.timeType(e.fid-1),r=nr.MODEL.goodsCost(nr.getIndex(e.fid)).split(","),l=r[0],c=r[1],d=ri.ins.getGoodsNum(l);o?(2==o.status&&(e.img_puton.visible=!0),1==a?0<o.remainTime?(e.act_dto=o,e.fidTime=e.act_dto.remainTime):0==o.remainTime?e.txt_time.changeText("未激活"):e.clearTimer(e,e.onTimer):0==a?e.txt_time.changeText(ed.n[1975]):-2==a&&e.txt_time.changeText(ed.n[1976]),c<=d&&i<=9&&(n=!0)):(e._fidTime=0,c<=d&&(n=!0),e.txt_time.changeText("未激活")),e.img_red.visible=n},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,!0)},i.setGrad=function(e,t){e!==this._gray&&(this._gray=e,Rn.gray(t,e))},i.showTimeTxt=function(e){e>=V.DATE_SECOND?this.txt_time.changeText(V.getDH(e)):e<V.DATE_SECOND&&e>=V.HOUR_SECOND?this.txt_time.changeText(Math.floor(e/V.HOUR_SECOND)+"小时"):this.txt_time.changeText(V.getCNTickMS(e))},i.onTimer=function(){if(this._fidTime--,this._fidTime<0)return this.event("end"),void this.txt_time.changeText("未激活");this.showTimeTxt(this._fidTime)},i.setSelectBg=function(e){this.img_select.visible=!!e},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){Y.superSet(ne,this,"dataSource",e),e&&(this.fid=e.fid,this.roleIndex=e.roleIndex,this.update())}),n(0,i,"fidTime",function(){return this._fidTime},function(e){0<(this._fidTime=e)?(this.timerLoop(1e3,this,this.onTimer),this.onTimer()):(this.txt_time.changeText("未激活"),this.clearTimer(this,this.onTimer))}),t}(ne),Qp=function(e){function t(){var e=this;e._toggle=!1,e._data=null,e._anums=0,e._showH=110,e._showS=0,e.g_items=null,e._box=null,e.GRID_Y=43,e.GRID_X=230,t.__super.call(e)}u(t,"modules.fashion.views.item.FashionSuitItem",Ur);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.g_bg.on("click",t,t.onClickHandler),t.btn_show.on("click",t,t.onClickHandler),t.btn_active.on("click",t,t.onClickHandler),t.b_hide.visible=!1},i.onRemove=function(e){var t=this;if(ui.SubPanel.prototype.onRemove.call(t,e),t.g_bg.off("click",t,t.onClickHandler),t.btn_show.off("click",t,t.onClickHandler),t.btn_active.off("click",t,t.onClickHandler),t._box&&t._box.graphics.clear(),t.g_items&&0<t.g_items.length){for(var i=0;i<t.g_items.length;++i)t.g_items[i]&&(t.g_items[i].parent&&t.g_items[i].parent.removeChild(t.g_items[i]),t.g_items[i].destroy(),t.g_items[i]=null);t.g_items.splice(0,t.g_items.length),t.g_items=null}},i.update=function(e){var t=this;if(e&&e.cvo&&e.svo){t._data=e,t.g_name.skin=Or.getFsuitPath("suit_"+e.suitId),t._anums=0;var i="";t.g_items=t.g_items||[];for(var s=0;s<e.svo.list.length;s++)if(i=1==e.svo.list[s].pstate?"#23b11f":"#5f5952",3==e.svo.list[s].position?t["txt_arr_"+s].changeText(ht.getFsuitTitleName(e.svo.list[s].position,e.suitId)):t["txt_arr_"+s].changeText(ht.getFsuitName(e.suitId,e.svo.list[s].position)),t["txt_arr_"+s].color=i,t["txt_arr_"+s].underlineColor=i,1==e.svo.list[s].pstate&&t._anums++,!t.g_items[s]){var n=new ra;n.needEffect=!1,n.alpha=0,n.pos(t["txt_arr_"+s].x,t["txt_arr_"+s].y),n.size(t["txt_arr_"+s].textField.textWidth,t["txt_arr_"+s].textField.textHeight),t.b_hide.addChild(n);var o=ht.getGoodsCost(e.svo.list[s].position,e.suitId);o&&0<o.length&&(n.dataSource=o[0]),t.g_items.push(n)}t.setText(),t.setAttr()}},i.setText=function(){var e=this;if(e._data&&e._data.svo){e.g_state.skin=Or.getAtlasSubPath("fashion/tz_active_"+e._data.state+".png"),e.g_select.visible=0<e._data.state;var t="";t=0<e._data.state?"#23b11f":"#5f5952";var i="("+e._anums+"/"+e._data.svo.list.length+")";e.txt_nums.innerHTML=nc.createColor(i,t),t=e._anums>=e._data.svo.list.length?"#23b11f":"#ff2e24",i=e._data.cvo.suitName+"·套装"+nc.createColor("(","#e0d6c1"),i+=nc.createColor(e._anums.toString(),t),i+=nc.createColor("/"+e._data.svo.list.length+")","#e0d6c1"),e.txt_suit.innerHTML=i}},i.setAttr=function(e){var t,i=this;void 0===e&&(e=!1),i._box||(i._box=new gl,i._box.pos(55,320),i.b_hide.addChild(i._box)),i._box.graphics.clear(),i._showS=i._box.y;for(var s,n=0,o=0;o<i._data.cvo.suit.length;o++){n+=0<o?i.GRID_Y:0,s=0==o?0<i._data.state?"#23b11f":"#90877b":1<i._data.state?"#23b11f":"#90877b",i._box.graphics.fillText(i._data.cvo.suit[o].suitNum+"件套：",0,n,"24px SimHei",s,"left"),t=Se.formatAttrToChineseByList(i._data.cvo.suit[o].attrs,!1,!0);var a=0;for(a=0;a<t.length;a++)0==Math.floor(a%2)&&0<Math.floor(a/2)&&(n+=i.GRID_Y),i._box.graphics.fillText(t[a].sname+"+"+t[a].val,84+Math.floor(a%2)*i.GRID_X,n,"24px SimHei",s,"left");if(0<i._data.cvo.suit[o].enhanceRate)for(a=0;a<i._data.svo.list.length;a++)3!=i._data.svo.list[a].position&&(n+=i.GRID_Y,i._box.graphics.fillText(ht.getFsuitName(i._data.suitId,i._data.svo.list[a].position,!1)+ed.n[1977]+"+"+100*i._data.cvo.suit[o].enhanceRate/1e4+"%",84,n,ed.n[1978],s,"left"))}i._showS+=n+70,i.setActive(e)},i.setActive=function(e){var t=this;void 0===e&&(e=!1);var i=0;switch(t._data.state){case 0:t.btn_active.visible=!0,t.btn_active.disabled=t._anums<2,t.btn_active.showTip=2<=t._anums,i=0,t._showS+=70;break;case 1:t.btn_active.visible=!0,t.btn_active.disabled=t._anums<4,t.btn_active.showTip=4<=t._anums,t._showS+=70,i=f.getFight(t._data.cvo.suit[0].attrs);break;case 2:t.btn_active.visible=!1;for(var s=i=0;s<t._data.cvo.suit.length;s++)i+=f.getFight(t._data.cvo.suit[s].attrs)}t.g_red.visible=t.btn_active.visible&&t.btn_active.showTip,t.b_hide.height=t._showS,t.fightNum.value=i,e&&2==t._data.state&&(t.height=t._toggle?t.b_hide.y+t._showS:t._showH,t.event("change",t))},i.onClickHandler=function(e){var t=this;switch(e.currentTarget){case t.g_bg:case t.btn_show:t.toggle=!t.toggle,t.event("change",t);break;case t.btn_active:if(!t._data||!t._data.cvo||!t._data.svo)return;fs.reqSuitActive(ht._curRole,t._data.suitId,ms.create(t,t.onRefresh))}},i.onRefresh=function(){this._data&&this._data.svo&&(this._data.svo=ht._suitHash.take(ht._curRole+"_"+this._data.suitId),this._data.state=this._data.svo.state,this.setText(),this.setAttr(!0))},n(0,i,"toggle",function(){return this._toggle},function(e){this._toggle=e,this.b_hide.visible=this._toggle,this.btn_show.selected=this._toggle,this.btn_show.scaleY=this._toggle?-1:1,this.btn_show.y=this._toggle?78:35,this.height=this._toggle?this.b_hide.y+this._showS:this._showH}),t}(),Zp=(function(e){function t(){t.__super.call(this),this.addSubscribe($p),this.subPackages=["10205","30631","30633","30635","30636","30637","30638","30641","30643","30646","30649","30653"]}u(t,"modules.auctionhouse.AuctionHouseModule",Tc)}(),function(){function e(){}return u(e,"modules.auctionhouse.other.AuctionHouseData"),n(1,e,"isOpenAuction",function(){return!(Gi.ins.lv<parseInt(Ta.MODEL.value(Ta.getIndex(188))))&&(!(Gi.ins.zsLv<parseInt(Ta.MODEL.value(Ta.getIndex(189))))&&!(J.getOpenServiceDay()<parseInt(Ta.MODEL.value(Ta.getIndex(190)))))}),e.TAB_GUILD="0",e.TAB_WORLD="1",e.TAB_BLACKMACKET="2",e.openChoise=!1,e.listIndex=1,e.attentionList=[],e.noAttentionInfo=[],e.attenArr=[],e.myAuctionId=[],e.isFirst=!1,i(e,["CHOISE",function(){return this.CHOISE=[{name:"全部"},{name:"材料"},{name:"装备"},{name:"时装"}]},"BLACKMARCKET_CHOISE",function(){return this.BLACKMARCKET_CHOISE=[{name:"全部"},{name:ed.n[1979]},{name:ed.n[1980]}]}]),e}()),$p=function(e){function i(){var e=this;e._mainView=null,e._recordView=null,e._attentionView=null,e._remindView=null,e._cashExchangeView=null,e._blackMacketGoodsTip=null,i.__super.call(e);var t;t=[Or.getLayoutsPath("auctionhouse")],On.ins.registPanel("AUCTION_MAIN",tf,"_mainView",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["AuctionGoodsResource"],["CAuctionResource"])),layer:"layout",clearAll:!0}),On.ins.registPanel("AUCTION_RECORD",of,"_recordView",e,{mask:!0}),On.ins.registPanel("AUCTION_ATTENTION",sf,"_attentionView",e,{mask:!0}),On.ins.registPanel("AUCTION_REMIND",af,"_remindView",e,{mask:!1,layer:"nav"}),On.ins.registPanel("AUCTION_CASH_EXCHANGE",cf,"_cashExchangeView",e,{wait:On.wait(On.waitRes(t),On.waitRes([Or.getLayoutsPath("activity")]),On.waitConfig(["CashExchange","VipExchange","AuctionGoodsResource"],["CashExchange","VipExchange","CAuctionResource"])),layer:"layout"}),On.ins.registPanel("AUCTION_BLACK_GOODS",ef,"_blackMacketGoodsTip",e,{wait:On.wait(On.waitRes(t),On.waitConfig(["AuctionGoodsResource","ConfigGoods"],["CAuctionResource","CGoodsModel"])),mask:!0})}u(i,"modules.auctionhouse.proxy.AuctionHouseProxy",F);var t=i.prototype;return Y.imps(t,{"ui.IPanelProxy":!0}),t.subHandler=function(e){switch(e.actionOrder){case"AUCTION_OPEN":var t=e.proto;On.ins.open("AUCTION_MAIN",t);break;case"30633":var i=e.proto;this._mainView&&this._mainView.vsc.updateSelectedView(i);break;case"30631":var s=e.proto;this._mainView&&this._mainView.vsc.updateSelectedView(s);break;case"30636":var n=e.proto;On.ins.open("AUCTION_REMIND",n);break;case"30635":1==Zp.isFirst&&(Vl.ins.showById(4269,1),Zp.isFirst=!1);break;case"30637":var o=e.proto;this._mainView&&this._mainView.vsc.selectedView.pushGoods(o);break;case"30638":var a=e.proto;this._mainView&&this._mainView.vsc.selectedView.deleteGoods(a);break;case"30641":var r=e.proto;Zp.noAttentionInfo=r.noAttentionArr;break;case"30643":var l=e.proto;this._recordView&&this._recordView.update(l);break;case"30646":var c=e.proto;this._cashExchangeView&&this._cashExchangeView.updateByVSC(c);break;case"10205":var d=e.proto;this._cashExchangeView&&this._cashExchangeView.updateByVSC(d),this._mainView&&this._mainView.vsc.updateSelectedView(d);break;case"30649":var u=e.proto;Zp.myAuctionId=u.myUuid,this._mainView&&this._mainView.vsc.updateSelectedView(u);break;case"GET_GOODS":var h=e.proto;h.dto&&wr.isBlackMacketGoods(h.dto.goodsId)&&Y.timer.once(1e3,this,function(){On.ins.open("AUCTION_BLACK_GOODS",{dtoGoods:h.dto,uuid:h.dto.uuid})}),ha.ins.crossAwardArr=[];break;case"USE_GOODS":var _=e.proto;!On.ins.isOpen("AUCTION_BLACK_GOODS")&&_&&_.dtoGoods&&_.dtoGoods instanceof protos.backpack.DtoGoods&&On.ins.open("AUCTION_BLACK_GOODS",{dtoGoods:_.dtoGoods});break;case"CLOSE_GOODS":On.ins.isOpen("AUCTION_BLACK_GOODS")&&On.ins.close("AUCTION_BLACK_GOODS");break;case"30653":var p=e.proto;if(p.len&&0<p.len)for(var f=0;f<p.len;f++)if(wr.isBlackMacketGoods(p.goodsList[f].goodsId)){var g=an.create(p.goodsList[f].goodsId);On.ins.open("AUCTION_BLACK_GOODS",{dtoGoods:g,uuid:p.goodsList[f].uuid,isToc:!0})}}},t.showPanel=function(e,t){switch(e){case"AUCTION_REMIND":this._remindView.update(t)}},t.closePanel=function(e,t){},i}(),ef=function(e){function t(){this._dto=null,this.uuid=0,this.isToc=!1,t.__super.call(this)}u(t,"modules.auctionhouse.view.AuctionGoodsTip",b);var i=t.prototype;return i.initialize=function(){this.centerX=this.centerY=0},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e);var i=On.ins._getOpenData("AUCTION_BLACK_GOODS");if(i&&i.dtoGoods){t._dto=i.dtoGoods,i.uuid&&(t.uuid=i.uuid),i.isToc&&(t.isToc=i.isToc);var s=new ra;t.addChild(s),t.img_tag.zOrder=s.zOrder+1,s.x=t.item_bg.x,s.y=t.item_bg.y,s.bindData=an.create(t._dto.goodsId);var n=new Hs(t._dto.name);if(n.color="#90877b",n.fontSize=20,n.font="SimHei",n.x=t.item_bg.x+t.item_bg.width/2-n.width/2,n.y=t.item_bg.y+t.item_bg.height+5,t.addChild(n),0<yl.count)t.updateText();else{var o=[{url:Or.getJxrDBPath("BlackGoodsMatch"),type:"arraybuffer",cls:yl}];Wl.ins().onLoadJxrs(o,ms.create(t,t.updateText))}t.txt_desc.text=Ta.MODEL.value(Ta.getIndex(306))}t.on("click",t,t.onClick)},i.updateText=function(){for(var e=0;e<yl.count;e++)if(yl.MODEL.blackid(e)==this._dto.goodsId){var t=yl.MODEL.goodid(e),i=lt.getIndex(t),s=lt.MODEL.basePrice(i),n=lt.MODEL.maxPrice(i);this.txt_qipai&&this.txt_qipai.text&&(this.txt_qipai.text=""+s),this.txt_yikou&&this.txt_yikou.text&&(this.txt_yikou.text=""+n)}},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.off("click",this,this.onClick)},i.onClick=function(e){switch(e.target){case this.btn_use:Fl.sendToModule("CLOSE_GOODS",["modules.auctionhouse.AuctionHouseModule"]),1==this.isToc?wi.reqUseGoods(this.uuid,1):wi.reqUseGoods(this._dto.uuId,1);break;case this.btn_auction:Fl.sendToModule("CLOSE_GOODS",["modules.auctionhouse.AuctionHouseModule"]),1==this.isToc?zt.reqAuctionGround(this.uuid):zt.reqAuctionGround(this._dto.uuId),Fl.sendToModule("AUCTION_OPEN",["modules.auctionhouse.AuctionHouseModule"],{_subIndex_:"2"});break;case this.btn_close:Fl.sendToModule("CLOSE_GOODS",["modules.auctionhouse.AuctionHouseModule"])}},t}(),tf=function(s){function t(){var e=this;e.vsc=null,e.isShowRedPot_G=!1,e.isShowRedPot_W=!1,e.isShowRedPot_B=!1,e.resList=[245,246,248,273],t.__super.call(e),e.top=e.bottom=e.left=e.right=0,e.size(720,1280),e.centerX=e.centerY=0}u(t,"modules.auctionhouse.view.AuctionHouseMainView",s);var e=t.prototype;return e.initialize=function(){this.vsc=new o(this),this.vsc.selectHandler=ms.create(this,this.onVSCSelected,null,!1),this.navList=["ui/layouts/auctionhouse/yq_btn_ghpm.png","ui/layouts/auctionhouse/yq_btn_qfpm.png","ui/layouts/auctionhouse/yq_btn_hspm.png"],this.vsc.registAll([{cls:nf,id:"0",grayTip:function(){On.ins.open("GUILD_LIST_VIEW")}},{cls:rf,id:"1"},{cls:lf,id:"2",grayTip:function(){Vl.ins.showById(4925,1)}}]),this.vsc.filterHandler=ms.create(this,this.checkTips,null,!1)},e.onAdd=function(e){s.prototype.onAdd.call(this,e);ms.create(this,this.redPtUpdate,null,!1);var t=El.equipCareList.concat(this.resList);Qr.reqRedPt(t),this.isShowRedPot_G=!0,this.isShowRedPot_W=!0,this.isShowRedPot_B=!0;var i=On.ins._getOpenData("AUCTION_MAIN");i&&i._subIndex_&&(this.vsc.selectedIndex=i.subIndex)},e.redPtUpdate=function(e,t){this.vsc.updateItemEnabled()},e.onRemove=function(e){s.prototype.onRemove.call(this,e),zt.reqBtnClickState(2)},e.destroy=function(e){void 0===e&&(e=!0),s.prototype.destroy.call(this,e)},e.updateView=function(e){this.vsc.updateItemEnabled(),this.vsc.updateSelectedView(e)},e.checkTips=function(e){if("0"==e){if(1==this.isShowRedPot_G){if(!Gi.ins.guildName)return 1;if(Qr.ins.getStateByCareList([245]))return 3}}else if("1"==e){if(1==this.isShowRedPot_W&&Qr.ins.getStateByCareList([246]))return 3}else if("2"==e){if(!bs.getInstance().checkModuleOpen(77))return 1;if(1==this.isShowRedPot_B&&Qr.ins.getStateByCareList([273]))return 3}return 0},e.openIndex=function(e){this.vsc.selectedIndex=e?e.subIndex:0},e.onVSCSelected=function(e,t){var i="";switch(e){case"0":i="auctionhouse/pmh_text_pmh.png",this.isShowRedPot_G=!1;break;case"1":i="auctionhouse/pmh_text_pmh.png",this.isShowRedPot_W=!1;break;case"2":i="auctionhouse/pmh_text_pmh.png",this.isShowRedPot_B=!1}this.vsc.updateItemEnabled(),this.setTitle(Or.getAtlasSubPath(i))},t}(jr),sf=function(e){function t(){this._array=null,this.array=null,this.black_array=null,this.hadArr=null,this.nowChoiseIndex=0,t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.auctionhouse.view.Auction_AttentionView",sl);var i=t.prototype;return i.initialize=function(){var e=this;e._array=[],e.array=[],e.black_array=[],e.hadArr=[],e.list.itemRender=uf,e.list.vScrollBarSkin="",e.list.selectEnable=!0;for(var t=lt.count,i=0;i<t;i++){var s=lt.MODEL.goodsId(i),n=lt.MODEL.auctionType(i),o=Re.getIndex(s),a=Re.MODEL.name(o);-1==e.hadArr.indexOf(s)&&("BLACK"!=n?e._array.push({goodsName:a,goodsId:s,auctionType:n,selected:!0}):e.black_array.push({goodsName:a,goodsId:s,auctionType:n,selected:!0}),e.hadArr.push(s))}},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.closePanel),t.list.scrollBar.on("change",t,t.onScrollChanged),t.nowChoiseIndex=0;var i=On.ins._getOpenData("AUCTION_ATTENTION");i&&i.subIndex&&(t.nowChoiseIndex=i.subIndex),t.update()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.closePanel),this.list.scrollBar.off("change",this,this.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.update=function(){var e=this,t=Zp.noAttentionInfo;if(3!=e.nowChoiseIndex)if(t&&0<t.length){var i;for(var s in e._array)i=e._array[s],-1!=t.indexOf(i.goodsId)&&(i.selected=!1);e.list.array=e._array}else e.list.array=e._array;else if(t&&0<t.length){var n;for(var o in e.black_array)n=e.black_array[o],-1!=t.indexOf(n.goodsId)&&(n.selected=!1);e.list.array=e.black_array}else e.list.array=e.black_array;e.g_mask.visible=6<e._array.length},i.closePanel=function(e){On.ins.close("AUCTION_ATTENTION")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),nf=function(e){function t(){var e=this;e._array=null,e._otherList=null,e.arr_choice=null,e.CHOISE=null,e.txt_choiseDes=null,e.joinArr=null,e.noJoinArr=null,e.nowChoiseIndex=0,e.curObj=null,e.hadJoinArr=null,t.__super.call(e)}u(t,"modules.auctionhouse.view.Auction_GuildView",Ko);var i=t.prototype;return i.initialize=function(){var e=this;e.CHOISE=Zp.CHOISE,e.list.itemRender=df,e.list.vScrollBarSkin="",e.list.selectEnable=!0,e.list_choise.selectEnable=!0,e.list_choise.selectHandler=ms.create(e,e.onChangeList,null,!1),e.getListData(),e._array=[],e._otherList=[],e.list.array=e._array,e.list_choise.y=0-41*e.CHOISE.length},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_attention.on("click",t,t.openMyAttention),t.btn_record.on("click",t,t.openMyRecord),t.btn_help.on("click",t,t.openHelpPanel),t.btn_open.on("click",t,t.choiseLise),t.btn_close.on("click",t,t.choiseLise),t.cb_hadjoin.on("click",t,t.showHadJoin),t.list.scrollBar.on("change",t,t.onScrollChanged),t.img_nothing.visible=!1,t.list_choise.visible=!1,t.btn_close.visible=!1,t.nowChoiseIndex=0,t.txt_nowchoise.changeText("全部"),zt.reqAuctionInfo(2,0),zt.reqBtnClickState(4)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_attention.off("click",t,t.openMyAttention),t.btn_record.off("click",t,t.openMyRecord),t.btn_help.off("click",t,t.openHelpPanel),t.btn_open.off("click",t,t.choiseLise),t.btn_close.off("click",t,t.choiseLise),t.cb_hadjoin.off("click",t,t.showHadJoin),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){this.joinArr=[],this.noJoinArr=[];var t=Qr.ins._stateH.take(248);if(e instanceof protos.auctionhouse.toc_30633){this._array=e.goodInfo.concat();for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}else if(e instanceof protos.auctionhouse.toc_30631){var n=e.uuid,o=e.type;if(this.joinArr=[],this.noJoinArr=[],2==o){for(var a=0;a<this._array.length;a++)this._array[a].uuid==n&&(this._array.splice(a,1),this._array.push(e));for(i=0;i<this._array.length;i++)s=[],(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i]);this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}else this.list.array=this._array}this.btn_record.showTip=t},i.getListData=function(){this.arr_choice=[];for(var e=0;e<this.CHOISE.length;e++)this.arr_choice.push({listName:{text:this.CHOISE[e].name}});this.list_choise.array=this.arr_choice,this.list_choise.renderHandler=ms.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr_choice.length)){var i=this.arr_choice[t];this.txt_choiseDes=e.getChildByName("txt_clistDes"),this.txt_choiseDes.text=i.listName.text,this.nowChoiseIndex==t?this.txt_choiseDes.color="#e0d6c1":this.txt_choiseDes.color="#90877b"}},i.onChangeList=function(e){if(this.curObj=this.arr_choice[e],this.curObj)if(this.txt_nowchoise.changeText(this.curObj.listName.text),this.nowChoiseIndex=this.list_choise.selectedIndex,this.list_choise.visible=!1,this.btn_close.visible=!1,this.btn_open.visible=!0,this._otherList=[],0==e)this.list.array=this._array;else{var t;for(var i in this._array){t=this._array[i];var s=lt.getIndex(t.goodsId);lt.MODEL.type(s)==this.nowChoiseIndex&&this._otherList.push(t)}this.joinArr=[],this.noJoinArr=[];for(var n=0;n<this._otherList.length;n++){var o=[];(o=this._otherList[n].playId_join.concat()).length<=0||-1==o.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._otherList[n]):this.joinArr.push(this._otherList[n])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._otherList=[],this._otherList=this.joinArr.concat(this.noJoinArr),this.list.array=this._otherList}},i.pushGoods=function(e){var t=e;if(2==e.type){this._array.push(t),this.joinArr=[],this.noJoinArr=[];for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}},i.deleteGoods=function(e){for(var t=e.uuid,i=0;i<this._array.length;i++){this._array[i].uuid==t&&this._array.splice(i,1),this.joinArr=[],this.noJoinArr=[];for(var s=0;s<this._array.length;s++){var n=[];(n=this._array[s].playId_join.concat()).length<=0||-1==n.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[s]):this.joinArr.push(this._array[s])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[]}this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1},i.openMyAttention=function(e){On.ins.open("AUCTION_ATTENTION")},i.openMyRecord=function(e){1==this.btn_record.showTip&&(this.btn_record.showTip=!1),On.ins.open("AUCTION_RECORD")},i.openHelpPanel=function(e){hc.goToOpenHelpDes(24)},i.choiseLise=function(e){var t=this;1==t.btn_open.visible&&0==t.btn_close.visible?(t.list_choise.visible=!0,t.btn_close.visible=!0,t.btn_open.visible=!1):0==t.btn_open.visible&&1==t.btn_close.visible&&(t.list_choise.visible=!1,t.btn_close.visible=!1,t.btn_open.visible=!0)},i.showHadJoin=function(e){if(this.hadJoinArr=[],1==this.cb_hadjoin.selected){var t;for(var i in this._array)for(var s=(t=this._array[i]).playId_join,n=0;n<s.length;n++)s[n]==parseInt(Gi.ins.charId)&&this.hadJoinArr.push(t);this.list.array=this.hadJoinArr}else this.list.array=this._array},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),of=function(e){function t(){this._array=null,this.txt_choiseDes=null,this.arr_choice=null,this.CHOISE=[{name:"全部"},{name:ed.n[1981]},{name:ed.n[1982]},{name:ed.n[1983]}],this.nowChoiseIndex=0,this.curObj=null,t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.auctionhouse.view.Auction_RecordView",tl);var i=t.prototype;return i.initialize=function(){var e=this;e.list.itemRender=hf,e.list.vScrollBarSkin="",e.list.selectEnable=!0,e.list_choise.selectEnable=!0,e.list_choise.selectHandler=ms.create(e,e.onChangeList,null,!1),e.getListData(),e.list_choise.visible=!1,e._array=[],e.list_choise.y=0-41*e.CHOISE.length},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btnopen.on("click",t,t.choiseLise),t.btnclose.on("click",t,t.choiseLise),t.btn_close.on("click",t,t.closePanel),t.list.scrollBar.on("change",t,t.onScrollChanged),t.btnclose.visible=!1,t.txt_no.visible=!1,t.nowChoiseIndex=0,t.txt_nowchoise.changeText("全部");On.ins._getOpenData("AUCTION_RECORD");zt.reqBtnClickState(5),zt.reqRecondInfo()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btnopen.off("click",t,t.choiseLise),t.btnclose.off("click",t,t.choiseLise),t.btn_close.off("click",t,t.closePanel),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.update=function(e){this._array=e.recondArr;var t=[];switch(this.nowChoiseIndex){case 0:this._array.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=this._array;break;case 1:var i;for(var s in this._array)2==(i=this._array[s]).type&&t.push(i);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t;break;case 2:var n;for(var o in this._array)2!=(n=this._array[o]).type&&5!=n.type&&t.push(n);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t;break;case 3:var a;for(var r in this._array)5==(a=this._array[r]).type&&t.push(a);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t}this.list_choise.visible=!1,this.btnclose.visible=!1,this.btnopen.visible=!0,this.g_mask.visible=3<this.list.array.length,this.txt_no.visible=this._array.length<=0},i.choiseLise=function(e){var t=this;1==t.btnopen.visible&&0==t.btnclose.visible?(t.list_choise.visible=!0,t.btnclose.visible=!0,t.btnopen.visible=!1):0==t.btnopen.visible&&1==t.btnclose.visible&&(t.list_choise.visible=!1,t.btnclose.visible=!1,t.btnopen.visible=!0)},i.getListData=function(){this.arr_choice=[];for(var e=0;e<this.CHOISE.length;e++)this.arr_choice.push({listName:{text:this.CHOISE[e].name}});this.list_choise.array=this.arr_choice,this.list_choise.renderHandler=ms.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr_choice.length)){var i=this.arr_choice[t];this.txt_choiseDes=e.getChildByName("txt_clistDes"),this.txt_choiseDes.text=i.listName.text,this.nowChoiseIndex==t?this.txt_choiseDes.color="#e0d6c1":this.txt_choiseDes.color="#90877b"}},i.onChangeList=function(e){if(this.curObj=this.arr_choice[e],this.curObj){this.txt_nowchoise.changeText(this.curObj.listName.text),this.nowChoiseIndex=this.list_choise.selectedIndex,this.list_choise.visible=!1,this.btnclose.visible=!1,this.btnopen.visible=!0;var t=[];switch(e){case 0:this._array.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=this._array;break;case 1:var i;for(var s in this._array)2==(i=this._array[s]).type&&t.push(i);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t;break;case 2:var n;for(var o in this._array)2!=(n=this._array[o]).type&&5!=n.type&&t.push(n);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t;break;case 3:var a;for(var r in this._array)5==(a=this._array[r]).type&&t.push(a);t.sort(function(e,t){return e.time<=t.time?1:-1}),this.list.array=t}this.g_mask.visible=3<this.list.array.length,this.txt_no.visible=this._array.length<=0}},i.closePanel=function(e){On.ins.close("AUCTION_RECORD")},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),af=function(e){function t(){this.uuid=null,this.lastAddTime=0,this.type=0,t.__super.call(this),this.centerX=this.centerY=0}u(t,"modules.auctionhouse.view.Auction_RemindView",Xe);var i=t.prototype;return i.initialize=function(){this.txt_des.style.font="SimHei",this.txt_des.style.fontFamily="SimHei",this.txt_des.style.fontSize=28,this.txt_des.style.color="#90877b",this.txt_des.style.leading=20},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_close.on("click",t,t.closePanel),t.btn_check.on("click",t,t.gotoAuction),t.btn_more.on("click",t,t.addPrice)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_close.off("click",t,t.closePanel),t.btn_check.off("click",t,t.gotoAuction),t.btn_more.off("click",t,t.addPrice)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.update=function(e){var t=this;if(t.tag=e,t.tag){var i;t.uuid=t.tag.uuid,t.type=t.tag.type,t.lastAddTime=t.tag.lastAddTime,i=5==t.type?(t.img.skin=Or.getAtlasSubPath("base_ui2/ty_hb_yp.png"),"银票"):(t.img.skin=Or.getAtlasSubPath("base_ui2/ty_hb_yb.png"),"元宝");var s=t.tag.goodsId,n=lt.getIndex(s),o=lt.MODEL.goodsId(n),a=(Re.getIndex(o),lt.MODEL.goodsName(n)),r=t.tag.price,l=lt.MODEL.addPrice(n);t.txt_addprice.text=r+l+"",t.txt_des.innerHTML=ed.n[1984]+nc.createColor(a,"#ff831e")+ed.n[1985]+nc.createColor(r+i,"#e6d80d")}},i.closePanel=function(e){On.ins.close("AUCTION_REMIND")},i.gotoAuction=function(e){On.ins.close("AUCTION_REMIND"),2==this.type?On.ins.open("AUCTION_MAIN",{_subIndex_:0}):5==this.type?On.ins.open("AUCTION_MAIN",{_subIndex_:2}):On.ins.open("AUCTION_MAIN",{_subIndex_:1})},i.addPrice=function(e){zt.reaAddPrice(this.uuid,this.lastAddTime),On.ins.close("AUCTION_REMIND")},t}(),rf=function(e){function t(){var e=this;e._array=null,e._otherList=null,e.arr_choice=null,e.CHOISE=null,e.txt_choiseDes=null,e.joinArr=null,e.noJoinArr=null,e.nowChoiseIndex=0,e.curObj=null,e.hadJoinArr=null,t.__super.call(e)}u(t,"modules.auctionhouse.view.Auction_WorldView",Ko);var i=t.prototype;return i.initialize=function(){var e=this;e.CHOISE=Zp.CHOISE,e.list.itemRender=df,e.list.vScrollBarSkin="",e.list.selectEnable=!0,e.list_choise.selectEnable=!0,e.list_choise.selectHandler=ms.create(e,e.onChangeList,null,!1),e.getListData(),e._array=[],e._otherList=[],e.list.array=e._array,e.list_choise.y=0-41*e.CHOISE.length},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_attention.on("click",t,t.openMyAttention),t.btn_record.on("click",t,t.openMyRecord),t.btn_help.on("click",t,t.openHelpPanel),t.btn_open.on("click",t,t.choiseLise),t.btn_close.on("click",t,t.choiseLise),t.cb_hadjoin.on("click",t,t.showHadJoin),t.list.scrollBar.on("change",t,t.onScrollChanged),t.img_nothing.visible=!1,t.list_choise.visible=!1,t.btn_close.visible=!1,t.nowChoiseIndex=0,t.txt_nowchoise.changeText("全部"),zt.reqAuctionInfo(1,0),zt.reqBtnClickState(3)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_attention.off("click",t,t.openMyAttention),t.btn_record.off("click",t,t.openMyRecord),t.btn_help.off("click",t,t.openHelpPanel),t.btn_open.off("click",t,t.choiseLise),t.btn_close.off("click",t,t.choiseLise),t.cb_hadjoin.off("click",t,t.showHadJoin),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){this.joinArr=[],this.noJoinArr=[];var t=Qr.ins._stateH.take(248);if(e instanceof protos.auctionhouse.toc_30633){this._array=e.goodInfo.concat();for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}else if(e instanceof protos.auctionhouse.toc_30631){var n=e.uuid,o=e.type;if(this.joinArr=[],this.noJoinArr=[],2!=o){for(var a=0;a<this._array.length;a++)this._array[a].uuid==n&&(this._array.splice(a,1),this._array.splice(a,1,e));for(i=0;i<this._array.length;i++)s=[],(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i]);this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}else this.list.array=this._array}this.btn_record.showTip=t},i.getListData=function(){this.arr_choice=[];for(var e=0;e<this.CHOISE.length;e++)this.arr_choice.push({listName:{text:this.CHOISE[e].name}});this.list_choise.array=this.arr_choice,this.list_choise.renderHandler=ms.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr_choice.length)){var i=this.arr_choice[t];this.txt_choiseDes=e.getChildByName("txt_clistDes"),this.txt_choiseDes.text=i.listName.text,this.nowChoiseIndex==t?this.txt_choiseDes.color="#e0d6c1":this.txt_choiseDes.color="#90877b"}},i.onChangeList=function(e){if(this.curObj=this.arr_choice[e],this.curObj)if(this.txt_nowchoise.changeText(this.curObj.listName.text),this.nowChoiseIndex=this.list_choise.selectedIndex,this.list_choise.visible=!1,this.btn_close.visible=!1,this.btn_open.visible=!0,this._otherList=[],0==e)this.list.array=this._array;else{var t;for(var i in this._array){t=this._array[i];var s=lt.getIndex(t.goodsId);lt.MODEL.type(s)==this.nowChoiseIndex&&this._otherList.push(t)}this.joinArr=[],this.noJoinArr=[];for(var n=0;n<this._otherList.length;n++){var o=[];(o=this._otherList[n].playId_join.concat()).length<=0||-1==o.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[n]):this.joinArr.push(this._array[n])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._otherList=[],this._otherList=this.joinArr.concat(this.noJoinArr),this.list.array=this._otherList}},i.pushGoods=function(e){var t=e;if(2!=e.type){this._array.push(t),this.joinArr=[],this.noJoinArr=[];for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}},i.deleteGoods=function(e){for(var t=e.uuid,i=0;i<this._array.length;i++){this._array[i].uuid==t&&this._array.splice(i,1),this.joinArr=[],this.noJoinArr=[];for(var s=0;s<this._array.length;s++){var n=[];(n=this._array[s].playId_join.concat()).length<=0||-1==n.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[s]):this.joinArr.push(this._array[s])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[]}this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1},i.openMyAttention=function(e){On.ins.open("AUCTION_ATTENTION")},i.openMyRecord=function(e){1==this.btn_record.showTip&&(this.btn_record.showTip=!1),On.ins.open("AUCTION_RECORD")},i.openHelpPanel=function(e){hc.goToOpenHelpDes(25)},i.choiseLise=function(e){var t=this;1==t.btn_open.visible&&0==t.btn_close.visible?(t.list_choise.visible=!0,t.btn_close.visible=!0,t.btn_open.visible=!1):0==t.btn_open.visible&&1==t.btn_close.visible&&(t.list_choise.visible=!1,t.btn_close.visible=!1,t.btn_open.visible=!0)},i.showHadJoin=function(e){if(this.hadJoinArr=[],1==this.cb_hadjoin.selected){var t;for(var i in this._array)for(var s=(t=this._array[i]).playId_join,n=0;n<s.length;n++)s[n]==parseInt(Gi.ins.charId)&&this.hadJoinArr.push(t);this.list.array=this.hadJoinArr}else this.list.array=this._array},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},t}(),lf=function(e){function t(){var e=this;e._array=null,e._otherList=null,e.arr_choice=null,e.CHOISE=null,e.txt_choiseDes=null,e.joinArr=null,e.noJoinArr=null,e.nowChoiseIndex=0,e.curObj=null,e.hadJoinArr=null,t.__super.call(e)}u(t,"modules.auctionhouse.view.BlackMacketView",Q);var i=t.prototype;return i.initialize=function(){var e=this;e.CHOISE=Zp.BLACKMARCKET_CHOISE,e.list.itemRender=df,e.list.vScrollBarSkin="",e.list.selectEnable=!0,e.list_choise.selectEnable=!0,e.list_choise.selectHandler=ms.create(e,e.onChangeList,null,!1),e.getListData(),e._array=[],e._otherList=[],e.list.array=e._array,e.list_choise.y=0-41*e.CHOISE.length},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),ui.SubPanel.prototype.onAdd.call(t,e),t.btn_attention.on("click",t,t.openMyAttention),t.btn_record.on("click",t,t.openMyRecord),t.btn_help.on("click",t,t.openHelpPanel),t.btn_open.on("click",t,t.choiseLise),t.btn_close.on("click",t,t.choiseLise),t.cb_hadjoin.on("click",t,t.showHadJoin),t.btn_exchange.on("click",t,t.onClickExchange),t.list.scrollBar.on("change",t,t.onScrollChanged),t.img_nothing.visible=!1,t.list_choise.visible=!1,t.btn_close.visible=!1,t.nowChoiseIndex=0,t.txt_nowchoise.changeText("全部"),zt.reqAuctionInfo(5,0),zt.reqBtnClickState(6),zt.reqMyAuctionList()},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_attention.off("click",t,t.openMyAttention),t.btn_record.off("click",t,t.openMyRecord),t.btn_help.off("click",t,t.openHelpPanel),t.btn_open.off("click",t,t.choiseLise),t.btn_close.off("click",t,t.choiseLise),t.cb_hadjoin.off("click",t,t.showHadJoin),t.btn_exchange.off("click",t,t.onClickExchange),t.list.scrollBar.off("change",t,t.onScrollChanged)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){this.joinArr=[],this.noJoinArr=[];var t=Qr.ins._stateH.take(248);if(e instanceof protos.auctionhouse.toc_30633){this._array=e.goodInfo.concat();for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}else if(e instanceof protos.auctionhouse.toc_30631){var n=e.uuid,o=e.type;if(this.joinArr=[],this.noJoinArr=[],5==o){for(var a=0;a<this._array.length;a++)this._array[a].uuid==n&&(this._array.splice(a,1),this._array.push(e));for(i=0;i<this._array.length;i++)s=[],(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i]);this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1}}this.btn_record.showTip=t;var r=Gi.ins.cash;this.txt_cash.text=r<1e4?""+r:(r/1e4).toFixed(1)+"万"},i.getListData=function(){this.arr_choice=[];for(var e=0;e<this.CHOISE.length;e++)this.arr_choice.push({listName:{text:this.CHOISE[e].name}});this.list_choise.array=this.arr_choice,this.list_choise.renderHandler=ms.create(this,this.onRender,null,!1)},i.onRender=function(e,t){if(!(t>this.arr_choice.length)){var i=this.arr_choice[t];this.txt_choiseDes=e.getChildByName("txt_clistDes"),this.txt_choiseDes.text=i.listName.text,this.nowChoiseIndex==t?this.txt_choiseDes.color="#e0d6c1":this.txt_choiseDes.color="#90877b"}},i.onChangeList=function(e){if(this.curObj=this.arr_choice[e],this.curObj)if(this.txt_nowchoise.changeText(this.curObj.listName.text),this.nowChoiseIndex=this.list_choise.selectedIndex,this.list_choise.visible=!1,this.btn_close.visible=!1,this.btn_open.visible=!0,this._otherList=[],0==e)this.list.array=this._array;else{var t;for(var i in this._array){t=this._array[i];var s=lt.getIndex(t.goodsId);lt.MODEL.type(s)==this.nowChoiseIndex+3&&this._otherList.push(t)}this.joinArr=[],this.noJoinArr=[];for(var n=0;n<this._otherList.length;n++){var o=[];(o=this._otherList[n].playId_join.concat()).length<=0||-1==o.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._otherList[n]):this.joinArr.push(this._otherList[n])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._otherList=[],this._otherList=this.joinArr.concat(this.noJoinArr),this.list.array=this._otherList}},i.pushGoods=function(e){var t=e;if(2!=e.type){this._array.push(t),this.joinArr=[],this.noJoinArr=[];for(var i=0;i<this._array.length;i++){var s=[];(s=this._array[i].playId_join.concat()).length<=0||-1==s.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[i]):this.joinArr.push(this._array[i])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[],this._array=this.joinArr.concat(this.noJoinArr),this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1;var n=lt.getIndex(t.goodsId),o=lt.MODEL.type(n);0==this.nowChoiseIndex?this.list.array=this._array:o==this.nowChoiseIndex+3&&(this.list.array=this._array)}},i.deleteGoods=function(e){for(var t=e.uuid,i=0;i<this._array.length;i++)if(this._array[i].uuid==t){this._array.splice(i,1),this.joinArr=[],this.noJoinArr=[];for(var s=0;s<this._array.length;s++){var n=[];(n=this._array[s].playId_join.concat()).length<=0||-1==n.indexOf(parseInt(Gi.ins.charId))?this.noJoinArr.push(this._array[s]):this.joinArr.push(this._array[s])}this.noJoinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this.joinArr.sort(function(e,t){return e.sortId<=t.sortId?1:-1}),this._array=[]}this._array=this.joinArr.concat(this.noJoinArr),this.list.array=this._array,this._array.length<=0?this.img_nothing.visible=!0:this.img_nothing.visible=!1},i.openMyAttention=function(e){On.ins.open("AUCTION_ATTENTION",{subIndex:3})},i.openMyRecord=function(e){1==this.btn_record.showTip&&(this.btn_record.showTip=!1),On.ins.open("AUCTION_RECORD",{subIndex:3})},i.openHelpPanel=function(e){hc.goToOpenHelpDes(26)},i.choiseLise=function(e){var t=this;1==t.btn_open.visible&&0==t.btn_close.visible?(t.list_choise.visible=!0,t.btn_close.visible=!0,t.btn_open.visible=!1):0==t.btn_open.visible&&1==t.btn_close.visible&&(t.list_choise.visible=!1,t.btn_close.visible=!1,t.btn_open.visible=!0)},i.showHadJoin=function(e){if(this.hadJoinArr=[],1==this.cb_hadjoin.selected){var t;for(var i in this._array)for(var s=(t=this._array[i]).playId_join,n=0;n<s.length;n++)s[n]==parseInt(Gi.ins.charId)&&this.hadJoinArr.push(t);this.list.array=this.hadJoinArr}else this.list.array=this._array},i.onScrollChanged=function(){0==this.list.scrollBar.max||this.list.scrollBar.value>=this.list.scrollBar.max?this.g_mask.visible=!1:this.g_mask.visible=!0},i.onClickExchange=function(e){On.ins.open("AUCTION_CASH_EXCHANGE",null,0)},t}(),cf=function(e){function t(){t.__super.call(this)}u(t,"modules.auctionhouse.view.CashExchangeView",La);var i=t.prototype;return i.initialize=function(){},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.parent.addChild(t.box_l),t.btn_bm.on("click",t,t.onClickBm),t.img_bg1.skin=Or.getFullUrl("ui/layouts/auctionhouse/hspm_bg1.jpg"),t.img_bg2.skin=Or.getFullUrl("ui/layouts/auctionhouse/hspm_bg2.jpg");t.setTitle(Or.getAtlasSubPath("auctionhouse/hspm_title_dhyp.png")),t.list.itemRender=_f,t.list.vScrollBarSkin="",t.updateList(),t.updateCash(Gi.ins.cash),zt.reqCashExchangeTimes()},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_bm.off("click",this,this.onClickBm),this.box_l.removeSelf()},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.updateByVSC=function(e){e instanceof protos.actor.toc_10205&&this.updateCash(Gi.ins.cash)},i.updateList=function(){for(var e=Ai.count,t=[],i=0;i<e;i++){var s={index:i+1,sycee:Ai.MODEL.sycee(Ai.getIndex(i+1)),cash:Ai.MODEL.cash(Ai.getIndex(i+1))};t.push(s)}this.list.array=t},i.updateCash=function(e){this.txt_cash.text=e<1e4?""+e:(e/1e4).toFixed(1)+"万"},i.onClickBm=function(e){Fl.sendToModule("AUCTION_OPEN",["modules.auctionhouse.AuctionHouseModule"],{_subIndex_:"2"})},t}(),df=function(e){function t(){var e=this;e.gItem=null,e.time=0,e.dto=null,e.gold=0,e.lastAddTime=0,e.uuid=null,e.maxPrice=0,e.addPrice=0,e.basePrice=0,e.playId_max=null,e.index=0,e.auctionType=null,e.payType=null,t.__super.call(e),e.gItem=new ra,e.img_goods.addChild(e.gItem)}u(t,"modules.auctionhouse.view.item.AuctionHouseItemView",e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.btn_one.on("click",t,t.onOnePriceBuy),t.btn_jingjia.on("click",t,t.onAddPrice),t.img_light.visible=t.img_priceState.visible=t.img_yb.visible=!1,t.gItem||(t.gItem=new ra,t.img_goods.addChild(t.gItem))},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_one.off("click",t,t.onOnePriceBuy),t.btn_jingjia.off("click",t,t.onAddPrice),t.gItem&&(t.gItem.parent&&t.gItem.parent.removeChild(t.gItem),t.gItem.destroy(),t.gItem=null)},i.showTime=function(){this.time<=0?Y.timer.clear(this,this.showTime):(this.time--,this.txt_time.changeText(this.getTime(this.time)+"后结束"))},i.getTime=function(e){var t=e,i=Math.floor(t/3600),s=Math.floor((t-3600*i)/60),n=t-3600*i-60*s;return i<=0?10<=s?"00:"+s+(10<=n?":":":0")+n:"00:0"+s+(10<=n?":":":0")+n:i<=0&&s<=0?10<=n?"00:00:"+n:"00:00:0"+n:(10<=i?"":"0")+i+(10<=s?":":":0")+s+(10<=n?":":":0")+n},i.showTwinkle=function(){this.img_light.visible=!0,Yl.to(this.img_light,{alpha:1},500,G.linearIn,null,0,!1,!1),Yl.to(this.img_light,{alpha:0},500,G.linearIn,null,500,!1,!1),Yl.to(this.img_light,{alpha:1},500,G.linearIn,null,1e3,!1,!1),Yl.to(this.img_light,{alpha:0},500,G.linearIn,ms.create(this,this.hideTwinkle),1500,!1,!1)},i.hideTwinkle=function(){this.img_light.visible=!1},i.onOnePriceBuy=function(e){this.gold=this.maxPrice,1!=this.tag.state?this.showConfirmGold(this.dto,this.gold):Vl.ins.showMsg(ed.n[1986],1)},i.showConfirmGold=function(e,t){var i=ed.n[1987]+nc.createColor(t+this.payType,"#fcd132")+ed.n[1988]+nc.createColor(lt.MODEL.goodsName(this.index),Co.getByQuality(Re.MODEL.colourId(e.cfgIdx)))+"吗？";ja.ins.show(i,ms.create(this,this.onConfirm),!1)},i.onConfirm=function(e){if(1==e)if("BLACK"==this.auctionType){if(!(Gi.ins.cash>=this.gold))return void Vl.ins.showById(4876,1);zt.reqMaxPriceBuy(this.uuid)}else Gi.ins.YB>=this.gold?zt.reqMaxPriceBuy(this.uuid):ja.ins.showNoGold()},i.onAddPrice=function(e){this.gold=this.basePrice,1!=this.tag.state?this.showConfirmGold1(this.dto,this.gold):Vl.ins.showMsg(ed.n[1986],1)},i.showConfirmGold1=function(e,t){var i;i=t>=this.maxPrice?ed.n[1990]+nc.createColor(t+"","#23b11f")+this.payType+"拍下"+nc.createColor(lt.MODEL.goodsName(this.index),"#fcd132")+"？":ed.n[1991]+nc.createColor(lt.MODEL.goodsName(this.index),"#fcd132")+"出价"+nc.createColor(t+"","#23b11f")+this.payType+"吗？",ja.ins.show(i,ms.create(this,this.onConfirm1),!1)},i.onConfirm1=function(e){if(1==e)if("BLACK"==this.auctionType){if(!(Gi.ins.cash>=this.gold))return void Vl.ins.showById(4876,1);0==Zp.isFirst&&(Zp.isFirst=!0),zt.reaAddPrice(this.uuid,this.lastAddTime)}else Gi.ins.YB>=this.gold?zt.reaAddPrice(this.uuid,this.lastAddTime):ja.ins.showNoGold()},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){t.index=lt.getIndex(t.tag.goodsId),t.auctionType=lt.MODEL.auctionType(t.index),"BLACK"==t.auctionType?(t.img_yb.skin=t.img_yb1.skin=t.img_yb2.skin=Or.getAtlasSubPath("base_ui2/ty_hb_yp.png"),t.payType="银票"):(t.img_yb.skin=t.img_yb1.skin=t.img_yb2.skin=Or.getAtlasSubPath("base_ui2/ty_hb_yb.png"),t.payType="元宝");var i=lt.MODEL.goodsId(t.index);t.dto=an.create(i,lt.MODEL.count(t.index)),t.dto&&(t.gItem&&null!=t.gItem.bindData&&(t.gItem.bindData=t.dto),t.txt_name.changeText(Re.MODEL.simpleName(t.dto.cfgIdx)),t.txt_name.color=Co.getByQuality(Re.MODEL.colourId(t.dto.cfgIdx))),1==t.tag.state?(t.btn_one.gray=t.btn_jingjia.gray=!0,t.img_yb.visible=!1,t.txt_price.x=216):(t.btn_one.gray=t.btn_jingjia.gray=!1,t.img_yb.visible=!0,t.txt_price.x=249);var s=t.tag.playId_join;if(s&&0<s.length)for(var n=0;n<s.length;n++)s[n]==Gi.ins.charId&&(t.img_priceState.visible=!0,0==t.btn_one.gray&&0==t.btn_jingjia.gray&&(t.tag.playId_max!=Gi.ins.charId?(t.showTwinkle(),t.img_priceState.skin=Or.getAtlasSubPath("auctionhouse/pmh_bq_bcg.png")):t.img_priceState.skin=Or.getAtlasSubPath("auctionhouse/pmh_bq_wzg.png")));else t.img_priceState.visible=!1;t.playId_max=t.tag.playId_max,t.maxPrice=lt.MODEL.maxPrice(t.index),t.addPrice=lt.MODEL.addPrice(t.index),t.basePrice=t.tag.maxprice+t.addPrice,1==t.tag.state?t.txt_price.changeText("公示期"):t.txt_price.changeText(t.tag.maxprice+""),t.txt_onepirce.changeText(t.maxPrice+""),t.txt_jingjiapirce.changeText(t.basePrice+""),t.time=Math.floor((t.tag.time-J.curServerTime)/1e3),t.showTime(),Y.timer.loop(1e3,t,t.showTime,null,!0),t.lastAddTime=t.tag.lastAddTime,t.uuid=t.tag.uuid,0<=Zp.myAuctionId.indexOf(t.uuid)?t.box_myAuc.visible=!0:t.box_myAuc.visible=!1}}),t}(As),uf=function(e){function t(){this.goodsId=0,this.noArr=null,t.__super.call(this)}u(t,"modules.auctionhouse.view.item.Auction_AttentionItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.cb_choice.on("click",this,this.setSelect),this.noArr=Zp.noAttentionInfo},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.cb_choice.off("click",this,this.setSelect)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.setSelect=function(){if(1==this.cb_choice.selected){var e=this.noArr.indexOf(this.goodsId);Zp.noAttentionInfo.splice(e,1)}else Zp.noAttentionInfo.push(this.goodsId);zt.reqAmendAttentionInfo(this.goodsId,this.cb_choice.selected)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.tag=e,t.tag&&(t.goodsId=t.tag.goodsId,-1!=t.noArr.indexOf(t.goodsId)?t.cb_choice.selected=!1:t.cb_choice.selected=!0,t.goodsname.changeText(t.tag.goodsName))}),t}(E),hf=function(e){function t(){this.gItem=null,t.__super.call(this),this.gItem=new ra,this.img_goods.addChild(this.gItem)}u(t,"modules.auctionhouse.view.item.Auction_RecordItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.gItem||(this.gItem=new ra,this.img_goods.addChild(this.gItem))},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.gItem&&(this.gItem.parent&&this.gItem.parent.removeChild(this.gItem),this.gItem.destroy(),this.gItem=null)},i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(t.tag=e,t.tag){var i=an.create(t.tag.goodsId);i&&t.gItem&&(t.gItem&&null!=t.gItem.bindData&&(t.gItem.bindData=i),t.txt_gname.changeText(Re.MODEL.simpleName(i.cfgIdx)),t.txt_gname.color=Co.getByQuality(Re.MODEL.colourId(i.cfgIdx)));var s=lt.getIndex(t.tag.resourceId),n=lt.MODEL.auctionType(s);t.img_yb.skin="BLACK"==n?Or.getAtlasSubPath("base_ui2/ty_hb_yp.png"):Or.getAtlasSubPath("base_ui2/ty_hb_yb.png"),""==t.tag.playName?(t.txt_name.changeText("流拍"),t.txt_name.color="#ff2e24",t.txt_pirce.visible=t.img_yb.visible=!1):(t.txt_pirce.visible=t.img_yb.visible=!0,t.txt_name.changeText(t.tag.playName),t.txt_name.color="#e0d6c1",t.txt_pirce.changeText(t.tag.goodsPrice+""));var o=new Date(t.tag.time);t.txt_time.innerHTML=V.getFormatDate(o)+"<br>"+V.getFormatTime(o)}}),t}(Qs),_f=function(e){function t(){this.index=0,this.sycee=0,this.cash=0,t.__super.call(this)}u(t,"modules.auctionhouse.view.item.CashExchangeItemView",e);var i=t.prototype;return i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_exchange.on("click",this,this.onClickExchange)},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_exchange.off("click",this,this.onClickExchange)},i.onClickExchange=function(e){Gi.ins.YB>=this.sycee?zt.reqCashExchange(this.index):ja.ins.showNoGold()},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;t.tag=e,t.tag&&(t.index=t.tag.index,t.sycee=t.tag.sycee,t.cash=t.tag.cash,t.txt_sycee.text=""+t.tag.sycee,t.txt_cash.text=""+t.tag.cash)}),t}(Ao),pf=(function(e){function t(){t.__super.call(this),this.addSubscribe(pf),this.subPackages=["21268","21269","25005","25004"]}u(t,"modules.firedragon.FireDragonModule",Tc)}(),function(e){function t(){var e=this;e.firedragonView=null,e.firedragonRankView=null,e.firedragonGuWuView=null,e.firedragonMainView=null,e.firedragonShowAward=null,e.fdData=null,t.__super.call(e),On.ins.registPanel("FIREDRAGONVIEW",mf,"firedragonView",e,{wait:On.wait(On.waitAtlas("boss"),On.waitConfig(Vs.firedragon_A,Vs.firedragon_C)),layer:"layout"}),On.ins.registPanel("FIREDRAGONRANKVIEW",gf,"firedragonRankView",e,{mask:!0}),On.ins.registPanel("FIREDRAGON_SHOW_AWARD_VIEW",vf,"firedragonShowAward",e,{mask:!0}),On.ins.registPanel("FIREDRAGONGUWUVIEW",bf,"firedragonGuWuView",e,{mask:!0,layer:"panel"}),On.ins.registPanel("FIREDRAGONMAINVIEW",ff,"firedragonMainView",e,{wait:On.wait(On.waitAtlas("boss")),layer:"bottom"}),e.fdData=rr.ins}u(t,"modules.firedragon.proxy.FireDragonProxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_FD_ENTER_PANEL":on.reqCopy(50);break;case"21269":var i=e.proto;rr.ins.toc21269=i,On.ins.open("FIREDRAGONVIEW");break;case"21268":var s=e.proto;t.firedragonGuWuView&&t.firedragonGuWuView.refreshNum(s),1==s.type&&t.firedragonMainView&&t.firedragonMainView.showZhuWeiHurt(t.fdData.gwNums);break;case"25004":var n=e.proto;t.fdData.toc25004=n,t.fdData.gwNums=n.time,t.firedragonMainView&&t.firedragonMainView.showZhuWeiHurt(t.fdData.gwNums);break;case"25005":t.fdData.copyHurtList=e.proto.hurtList,t.firedragonMainView&&t.firedragonMainView.showGuildCurrentHurt(e.proto.hurtList);break;case"OPEN_FD_GUWU_PANEL":On.ins.open("FIREDRAGONGUWUVIEW")}},i.showPanel=function(e,t){"FIREDRAGONGUWUVIEW"==e?this.firedragonGuWuView&&this.firedragonGuWuView.showCurrentZhuWei():"FIREDRAGONVIEW"==e&&this.firedragonView&&this.firedragonView.updateView()},i.closePanel=function(e,t){},t}()),ff=function(e){function t(){this.bossData=null,t.__super.call(this),this.list_hurt.right=0,this.list_hurt.vScrollBarSkin="",this.list_hurt.scrollBar.elasticDistance=200,this.list_hurt.itemRender=sd,this.list_hurt.dataSource=[],this.bossData=rr.ins}u(t,"modules.firedragon.view.FireDragonMainView",_t);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e);var t=Ss.getHero(4);t&&ac.scene.removeItem(t),this.txt_rank.text="未上榜",this.txt_hurt.align="center",this.btn_zhuwei.on("click",this,this.onClickZhuWeiEvent),this.txt_addHurt.text=ed.n[1992],Bs.startInstantFight()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),Y.timer.clearAll(this),this.btn_zhuwei.off("click",this,this.onClickZhuWeiEvent)},i.showZhuWeiHurt=function(e){this.txt_addHurt.text=ed.n[1993]+20*e+"%"},i.showGuildCurrentHurt=function(e){this.txt_noHurt.visible=e.length<=0;var t=0;for(t=0;t<e.length;t++)if(e[t].name==Gi.ins.charName){this.txt_rank.text="第"+e[t].rank+"名",1e8<e[t].hurt?this.txt_hurt.text=(e[t].hurt/1e8).toFixed(2)+"亿":1e4<e[t].hurt?this.txt_hurt.text=Math.floor(e[t].hurt/1e4)+"万":this.txt_hurt.text=e[t].hurt+"";break}this.list_hurt.dataSource=e},i.onClickZhuWeiEvent=function(e){On.ins.open("FIREDRAGONGUWUVIEW")},t}(),gf=function(e){function t(){this.bossData=null,t.__super.call(this),this.centerX=this.centerY=0,this.list_rank.vScrollBarSkin="",this.list_rank.scrollBar.elasticDistance=200,this.list_rank.itemRender=FireDragonRankItem,this.list_rank.dataSource=[],this.bossData=rr.ins}u(t,"modules.firedragon.view.FireDragonRankView",ec);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.list_rank.dataSource=this.bossData.toc21269.hurtList,this.txt_rank.text="0",this.txt_hurtValue.text="0",this.showMyGuildRank()},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent)},i.onClickCloseEvent=function(e){On.ins.close("FIREDRAGONRANKVIEW")},i.showMyGuildRank=function(){for(var e=this.bossData.toc21269.hurtList,t=0;t<e.length;t++)if(e[t].name==Gi.ins.charName){this.txt_rank.text="第"+e[t].rank+"名",1e8<e[t].hurt?this.txt_hurtValue.text=(e[t].hurt/1e8).toFixed(2)+"亿":1e4<e[t].hurt?this.txt_hurtValue.text=Math.floor(e[t].hurt/1e4)+"万":this.txt_hurtValue.text=e[t].hurt+"";break}},t}(),vf=function(e){function i(){var e=this;e.bossData=null,i.__super.call(e),e.list_rank.vScrollBarSkin="",e.list_rank.scrollBar.elasticBackTime=300,e.list_rank.scrollBar.elasticDistance=100,e.list_rank.spaceY=6;var t=[];t.length=It.count,e.list_rank.array=t,e.list_rank.renderHandler=ms.create(e,e.onListRender,null,!1),e.bossData=rr.ins}u(i,"modules.firedragon.view.FireDragonShowAward",Lo);var t=i.prototype;return t.onListRender=function(e,t){var i=It.MODEL.key(t);e.img_r_1.visible=1==i,e.img_r_2.visible=2==i,e.img_r_3.visible=3==i,3<i?(e.txt_rank.visible=!0,e.txt_rank.text="参与奖"):e.txt_rank.visible=!1;for(var s=It.MODEL.showReward(t).split(";"),n=0;n<2;n++){var o=e["grid"+n];if(null==o&&((o=new ra(116)).font="20px SimHei",o.x=e["img_award"+n].x,o.y=e["img_award"+n].y,e.addChild(o),e["grid"+n]=o),n<s.length){o.visible=!0;var a=s[n].split(","),r=parseInt(a[0]),l=parseInt(a[1]),c=an.create(r,l);o.bindData=c,e["txt_award"+n].changeText(Re.MODEL.name(c.cfgIdx))}else o.visible=!1,e["txt_award"+n].changeText("")}},t.close=function(){On.ins.close("FIREDRAGON_SHOW_AWARD_VIEW")},t.onClick=function(e){e.target==this.btn_close&&this.close()},t.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClick)},t.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClick),0<this.bossData.toc21269.myrank?this.txt_rank.changeText(this.bossData.toc21269.myrank+""):this.txt_rank.changeText("未上榜")},i}(),mf=function(e){function t(){this._avatar=null,this.awardsList=[],this.fdData=null,this.currentBoss=null,this.BAR_W,t.__super.call(this),this.isHideBg=!0,this.fdData=rr.ins}u(t,"modules.firedragon.view.FireDragonView",ft);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),ui.SubPanel.prototype.destroy.call(this,e)},i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),on.reqCopy(50),t.BAR_W=t.img_bar.width,t.setTitle(Or.getAtlasSubPath("boss/hllx_title_hllx.png")),t.layout.dragon_border.visible=!1,t.txt_rank.on("click",t,t.onClickRankEvent),t.btn_enter.on("click",t,t.onClickEnterEvent),t.link_showGift.on("click",t,t.openGiftView),Qr.ins.addListener("BTN_FIREDRAGON",[258],ms.create(t,t.redPtHandler,null,!1)),t.img_yjs.visible=!1},i.onRemove=function(e){var t=this;for(ui.SubPanel.prototype.onRemove.call(t,e),t.txt_rank.off("click",t,t.onClickRankEvent),t.btn_enter.off("click",t,t.onClickEnterEvent),t.link_showGift.off("click",t,t.openGiftView);t.awardsList&&0<t.awardsList.length;){t.awardsList.shift().removeSelf()}t._avatar&&(t._avatar.parent&&t._avatar.parent.removeChild(t._avatar),t._avatar.dispose(),t._avatar.destroy(),t._avatar=null),Qr.ins.removeListener("BTN_FIREDRAGON")},i.updateView=function(){var e,t=this,i=0;if(0==t.fdData.toc21269.hurtList.length){for(i=0;i<3;i++)t["txt_rank_"+i].text=ed.n[1738],t["txt_score_"+i].text="0";t.txt_befName.innerHTML=ed.n[1995]}else{for(i=0;i<t.fdData.toc21269.hurtList.length;i++)if(i<3){t["txt_rank_"+i].text=t.fdData.toc21269.hurtList[i].name;var s="";s=1e8<=t.fdData.toc21269.hurtList[i].hurt?(t.fdData.toc21269.hurtList[i].hurt/1e8).toFixed(2)+"亿":1e4<=t.fdData.toc21269.hurtList[i].hurt?Math.floor(t.fdData.toc21269.hurtList[i].hurt/1e4)+"万":t.fdData.toc21269.hurtList[i].hurt+"",t["txt_score_"+i].text=s}t.txt_befName.innerHTML=ed.n[1996]+nc.createColor(t.fdData.toc21269.hurtList[0].name,"#e0d6c1")}for(var n in t.fdData.toc21269.bossList)if(0!=(e=t.fdData.toc21269.bossList[n]).state){if(1==e.state){t.currentBoss=e;break}-2==e.state&&(t.currentBoss=e)}null==t.currentBoss&&(t.currentBoss=t.fdData.toc21269.bossList[0]),t.currentBoss.state<0?t.img_yjs.visible=!0:t.img_yjs.visible=!1,t.setBlood(t.currentBoss),t.setDefaultItem(t.currentBoss.bossId)},i.setBlood=function(e){var t=uo.getIndex(e.bossId),i=uo.MODEL.bossId(t);t=Xl.getIndex(i);var s=Se.formatNewAttrToObject(JSON.parse(Xl.MODEL.attributes(t))).MAXHP,n=e.blood;this.txt_blood.text=(100*n/s).toFixed(2)+"%",this.setRateBar(n/s)},i.setRateBar=function(e){void 0===e&&(e=0),1<e&&(e=1);var t=this.img_bar.scrollRect||new qo(0,0,this.img_bar.width,this.img_bar.height);t.width=this.BAR_W*e,this.img_bar.scrollRect=t},i.setDefaultItem=function(e){for(var t,i=this,s=uo.getIndex(e),n=uo.MODEL.bossShowAward(s).split(";"),o=0;o<n.length;o++){var a=n[o],r=parseInt(a.split(",")[0]),l=parseInt(a.split(",")[1]);i.awardsList.length>o?t=i.awardsList[o]:(t=new ra,i.awardsList.push(t)),null==t.parent&&i.b_center.addChild(t),t.pos(i["img_"+o].x,i["img_"+o].y),t.bindData=an.create(r,l),i["txt_tool_"+o].text=Re.MODEL.name(Re.getIndex(r)),i["txt_tool_"+o].color=Co.getByQuality(Re.MODEL.colourId(Re.getIndex(r)))}if(i.awardsList.length>o)for(;o<i.awardsList.length;o++)(t=i.awardsList[o])&&t.parent&&t.removeSelf();var c=uo.MODEL.bossId(s);s=Xl.getIndex(c),i.txt_name.text=Xl.MODEL.name(s)+"︵",i.txt_lv.innerHTML=Xl.MODEL.level(s)+"",i.txt_ji.text="级︶",i.setAvatar(s)},i.setAvatar=function(e){var t=this,i=Xl.MODEL.muId(e);e=Cs.getIndex(i);var s=Cs.MODEL.avatarId(e);t._avatar||(t._avatar=new Jc,t._avatar.renderInSelf=!0,t._avatar.pos(350,620),t.b_center.addChildAt(t._avatar,3)),t._avatar.mid=s,t._avatar.type=mc.MONSTER,t._avatar.loadAvatarParts("mid",s,!0),t._avatar.setDir(5),t._avatar.play("stand"),t._avatar.mat.identity(),t._avatar.mat.scale(1,1)},i.onClickEnterEvent=function(e){if(1!=this.currentBoss.state){if(this.currentBoss.state<0)return void Vl.ins.showMsg(ed.n[1997],1);if(0==this.currentBoss.state)return void Vl.ins.showMsg(ed.n[1998],1)}ri.ins.hasEmptyNum(20)?Wc.isEnabledChangeScene()?(on.reqEntry(this.currentBoss.bossId),On.ins._closePanelForce(this)):Vl.ins.showById(2126,1):ja.ins.showBagRecycle()},i.onClickRankEvent=function(e){On.ins.open("FIREDRAGONRANKVIEW")},i.openGiftView=function(){On.ins.open("FIREDRAGON_SHOW_AWARD_VIEW")},i.redPtHandler=function(e,t){1==(this.btn_enter.showTip=t)&&on.reqCopy(50)},t}(),bf=function(e){function t(){this.bossData=null,t.__super.call(this),this.centerX=this.centerY=0,this.html_desc.style.font="SimHei",this.html_desc.style.fontSize=24,this.html_desc.style.color="#90877b",this.html_desc.style.align="center",this.bossData=rr.ins}u(t,"modules.firedragon.view.FireDragonZhuWeiView",ya);var i=t.prototype;return i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_close.on("click",this,this.onClickCloseEvent),this.btn_enter.on("click",this,this.onClickCloseEvent);var t=io.MODEL.damagePercent(1);this.txt_cost.text=io.MODEL.costGold(1)+"",this.html_desc.innerHTML=ed.n[1999]+nc.createColor(t+"%伤害","#23b11f")},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_close.off("click",this,this.onClickCloseEvent),this.btn_enter.off("click",this,this.onClickCloseEvent)},i.refreshGuildZWNum=function(e){var t=io.getIndex(e),i=io.MODEL.damagePercent(t);this.txt_hurt.text=e*i+"%"},i.refreshNum=function(e){if(1==e.type){this.bossData.gwNums+=1;var t=io.count;this.bossData.gwNums>=t?this.txt_zwNum.color="#ff2e24":this.txt_zwNum.color="#23d11f",this.txt_zwNum.text="("+(t-this.bossData.gwNums)+"/"+t+")"}this.refreshGuildZWNum(this.bossData.gwNums)},i.showCurrentZhuWei=function(){rr.ins.toc25004;var e=io.getIndex(1),t=io.MODEL.damagePercent(e);this.txt_hurt.text=this.bossData.gwNums*t+"%";var i=io.count;this.bossData.gwNums>=i?this.txt_zwNum.color="#ff2e24":this.txt_zwNum.color="#23d11f",this.txt_zwNum.text="("+(i-this.bossData.gwNums)+"/"+i+")"},i.onClickCloseEvent=function(e){e.target==this.btn_close?On.ins.close("FIREDRAGONGUWUVIEW"):e.target==this.btn_enter&&(this.bossData.gwNums>=io.count?Vl.ins.showById(4364,1):io.MODEL.costGold(1)>Gi.ins.YB?ja.ins.showNoGold():rr.ins.reqFireDragonGUWU())},t}(),wf=(function(e){function t(){t.__super.call(this),this.addSubscribe(kf),this.subPackages=["30468","30473","30476","30477","11805"]}u(t,"modules.friendnew.FriendNewModule",Tc)}(),function(){function e(){this._recordDic=null,this.isInit=!1}u(e,"modules.friendnew.others.FriendNewChatRecordDataCenter");var t=e.prototype;return t.initRecord=function(e){var t;for(var i in e.list)t=e.list[i],this.recordDic[t.playerID]=t},t.pushRecord=function(e){var t=0;t=e.senderID.toString()==Gi.ins.charId?e.receiveID:e.senderID,e.senderID.toString()!=Gi.ins.charId&&e.senderID!=yf.instance.currentSelectedPlayerID&&(this.getRecordByID(t).isRed=!0),50<=this.getRecordByID(t).recordArr.length&&this.getRecordByID(t).recordArr.shift(),this.getRecordByID(t).recordArr.push(e)},t.getRecordByID=function(e){var t;return this.recordDic[e]?t=this.recordDic[e]:((t=new xf).playerID=e,t.isRed=!1,t.recordArr=[],this.recordDic[e]=t),t},t.getCurrentSelcetedPlayerRecord=function(){return this.getRecordByID(yf.instance.currentSelectedPlayerID).recordArr},t.hasUnreadMessage=function(){for(var e in this.recordDic)if(this.recordDic[e].isRed)return!0;return!1},n(0,t,"recordDic",function(){return null==this._recordDic&&(this._recordDic=new ks),this._recordDic}),n(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e.MAX_SINGlE_RECORD=50,e}()),yf=function(){function e(){this.blockList=[],this._friendList=null,this.currentSelectedPlayerID=0,this.hasApply=!1,this.needToShowView=!1}u(e,"modules.friendnew.others.FriendNewDataModel");var t=e.prototype;return t.updateFriend=function(e){this._friendList=e.slice()},t.isFriend=function(e){for(var t in this.friendList)if(this.friendList[t].playerID==e)return!0;return!1},t.isFriendOpen=function(){var e=parseInt(Ta.MODEL.value(Ta.getIndex(171))),t=parseInt(Ta.MODEL.value(Ta.getIndex(170)));return Gi.ins.zsLv>=e&&Gi.ins.lv>=t},n(0,t,"friendList",function(){return null==this._friendList&&(this._friendList=[]),this._friendList}),n(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(),xf=function(){function e(){this.playerID=0,this.isRed=!1,this.recordArr=null}return u(e,"modules.friendnew.others.FriendNewLocalPlayerRecord"),e.prototype.decode=function(e){this.playerID=Dn.readLong64(e),this.isRed=Boolean(e.readByte());var t,i=e.readShort();this.recordArr=[];for(var s=0;s<i;s++)(t=new If).senderID=Dn.readLong64(e),t.senderName=e.readUTF(),t.receiveID=Dn.readLong64(e),t.receiveName=e.readUTF(),t.content=e.readUTF(),t.time=Dn.readLong64(e),this.recordArr.push(t)},e}(),If=function(){function e(){this.senderID=0,this.senderName=null,this.receiveID=0,this.receiveName=null,this.time=0,this.content=null}u(e,"modules.friendnew.others.FriendNewRecord");var t=e.prototype;return t.decode=function(e){this.senderID=e.senderID,this.senderName=e.senderName,this.receiveID=e.receiveID,this.receiveName=e.receiveName,this.time=e.time,this.content=e.chatText},t.getShowStr=function(){var e="";e+=nc.createColor(V.getSpecialTimeFormat2(this.time),"#5f5952"),e+="\n",e+=nc.createColor(this.senderName,"#e0d6c1")+":";var s=Qe.ins.faceArr,t=this.content.replace(/\[#([0-9]+)\]/g,re=function(e,t){var i=parseInt(t);return 0<i&&i<=s.length?nc.htmlClip(Or.getFacePath("face"+i),1,s[i-1],52,52):e});return this.senderID.toString()==Gi.ins.charId?e+=nc.createColor(t,"#e6d80d"):e+=nc.createColor(t,"#11c237"),e},e}(),Sf=function(){function e(){}return u(e,"modules.friendnew.others.FriendNewRequsetUtils"),e.requestAddFriend=function(e,t){var i=new Hc;i.playerID=e,i.type=t,Fl.sendToService(i)},e.requestDelFriend=function(e,t){var i=new De;i.playerID=e,i.type=t,Fl.sendToService(i)},e.requestListType=function(e){var t=new Al;t.type=e,Fl.sendToService(t)},e.requestAddFriendByName=function(e){var t=new _n;t.playerName=e,Fl.sendToService(t)},e.requestApply=function(e,t){var i=new We;i.playerID=e,i.type=t,Fl.sendToService(i)},e.requestSendFriendMessage=function(e,t){var i=new vr;i.playerID=e,i.chatText=t,Fl.sendToService(i)},e.requestReadPlayerMessage=function(e){var t=new ml;t.playerID=e,Fl.sendToService(t)},e.requestAllRecord=function(){var e=new qt;Fl.sendToService(e)},e.TYPE_APPLY=0,e.TYPE_FRIEND=1,e.TYPE_BLOCK=2,e}(),kf=function(e){function t(){this._friendNewMainView=null,this._friendNewAddView=null,this._friendView=null,t.__super.call(this),On.ins.registPanel("FRIENDNEWMAINVIEW",Lf,"_friendNewMainView",this,{wait:On.waitAtlas("chat","friendnew"),mask:!1}),On.ins.registPanel("FriendNewAddView",Tf,"_friendNewAddView",this,{mask:!0}),On.ins.registPanel("FRIENDNEWADDFRIENDVIEW",Cf,"_friendView",this,{mask:!0})}u(t,"modules.friendnew.proxys.FriendNew_Proxy",F);var i=t.prototype;return Y.imps(i,{"ui.IPanelProxy":!0}),i.subHandler=function(e){var t=this;switch(e.actionOrder){case"OPEN_FRIENDNEW_MAINVIEW":wf.instance.isInit?On.ins.isOpen("FRIENDNEWMAINVIEW")||On.ins.open("FRIENDNEWMAINVIEW"):Sf.requestAllRecord();break;case"30476":wf.instance.isInit=!0;var i=e.proto;wf.instance.initRecord(i),!On.ins.isOpen("FRIENDNEWMAINVIEW")&&yf.instance.needToShowView&&On.ins.open("FRIENDNEWMAINVIEW"),Fl.sendToModule("UPDATE_FRIEND_RED_POINT",["modules.nav.NavModule"]);break;case"OPEN_FRIENDNEW_ADD":On.ins.isOpen("FriendNewAddView")||On.ins.open("FriendNewAddView");break;case"30468":var s=e.proto;switch(s.type){case 1:yf.instance.updateFriend(s.list.slice());break;case 2:yf.instance.blockList=s.list.slice()}t._friendNewMainView&&t._friendNewMainView.parent&&t._friendNewMainView.updateList(s);break;case"11805":var n=e.proto;t._friendView&&t._friendView.parent&&t._friendView.update(n);break;case"30473":var o=e.proto,a=new If;a.decode(o),wf.instance.pushRecord(a),t._friendNewMainView&&t._friendNewMainView.parent&&(o.senderID.toString()==Gi.ins.charId?t._friendNewMainView.updateChatInfo(o.receiveID):t._friendNewMainView.updateChatInfo(o.senderID),t._friendNewMainView.updateBtnRed()),Fl.sendToModule("UPDATE_FRIEND_RED_POINT",["modules.nav.NavModule"]);break;case"OPEN_SELECT_PLAYER":t._friendNewMainView&&t._friendNewMainView.parent&&t._friendNewMainView.showRecentChannel();break;case"30477":var r=e.proto;yf.instance.hasApply=r.hasApply,t._friendNewMainView&&t._friendNewMainView.parent&&t._friendNewMainView.updateBtnRed(),Fl.sendToModule("UPDATE_FRIEND_RED_POINT",["modules.nav.NavModule"])}},i.showPanel=function(e,t){},i.closePanel=function(e,t){},t}(),Cf=function(e){function t(){this.strLevel=null,this.playerId=NaN,t.__super.call(this)}u(t,"modules.friendnew.views.FriendNewAddFriendView",_e);var i=t.prototype;return i.onAdd=function(e){var t=this;ui.SubPanel.prototype.onAdd.call(t,e),t.playerId=Qe.ins.playID,t.btn_check.on("click",t,t.checkOther),t.btn_chat.on("click",t,t.priChat),t.btn_block.on("click",t,t.onBlockClicked),t.btn_friend.on("click",t,t.onFriendBtnClicked)},i.onRemove=function(e){var t=this;ui.SubPanel.prototype.onRemove.call(t,e),t.btn_check.off("click",t,t.checkOther),t.btn_chat.off("click",t,t.priChat),t.btn_block.off("click",t,t.onBlockClicked),t.btn_friend.off("click",t,t.onFriendBtnClicked)},i.checkOther=function(e){On.ins.close("FRIENDNEWADDFRIENDVIEW"),To.reqViewOther(this.playerId,Qe.ins.platform,Qe.ins.serverId)},i.priChat=function(e){yf.instance.isFriend(this.playerId)?(On.ins.close("FRIENDNEWADDFRIENDVIEW"),wf.instance.isInit?On.ins.isOpen("FRIENDNEWMAINVIEW")?(yf.instance.currentSelectedPlayerID=this.playerId,Fl.sendToModule("OPEN_SELECT_PLAYER",["modules.friendnew.FriendNewModule"])):On.ins.open("FRIENDNEWMAINVIEW"):(yf.instance.currentSelectedPlayerID=this.playerId,Sf.requestAllRecord())):Vl.ins.showMsg(ed.n[1879],1)},i.onBlockClicked=function(e){yf.instance.isFriendOpen()?Sf.requestAddFriend(this.playerId,2):Vl.ins.showById(4e3,1)},i.onFriendBtnClicked=function(e){yf.instance.isFriendOpen()?yf.instance.isFriend(this.playerId)?Vl.ins.showMsg(ed.n[1880],1):Sf.requestAddFriend(this.playerId,1):Vl.ins.showById(4e3,1)},i.update=function(e){var t=this;t.strLevel="";zs.ins.actorById(0);t.img_head.skin=Or.getActorHeadPath(e.roleType,e.sex),t.txt_playerName.changeText(e.name),0<e.flyLevel&&(t.strLevel+=e.flyLevel+"转"),t.strLevel+=e.level+"级",t.txt_level.changeText(t.strLevel),e.guildName?t.txt_guildName.changeText(e.guildName):t.txt_guildName.changeText(ed.n[1882]),e.isCross?(t.btn_chat.disabled=!0,t.btn_block.disabled=!0,t.btn_friend.disabled=!0):(t.btn_chat.disabled=!1,t.btn_block.disabled=!1,t.btn_friend.disabled=!1)},t.NAME="FRIENDNEWADDFRIENDVIEW",t}(),Tf=function(e){function t(){this._maxChar=6,t.__super.call(this)}u(t,"modules.friendnew.views.FriendNewAddView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.onAdd=function(e){ui.SubPanel.prototype.onAdd.call(this,e),this.btn_add.on("click",this,this.onAddClicked),this.input_name.maxChars=this._maxChar},i.onRemove=function(e){ui.SubPanel.prototype.onRemove.call(this,e),this.btn_add.off("click",this,this.onAddClicked)},i.onAddClicked=function(e){Sf.requestAddFriendByName(this.input_name.text)},i.onFocusChange=function(e){},t.NAME="FriendNewAddView",t}($c),Ef=function(s){function t(){var e=this;e._list=null,e._totH=0,t.__super.call(e),e.vScrollBarSkin="",e.vScrollBar.isVertical=!0,e.vScrollBar.elasticDistance=30,e._list=[],e.vScrollBar.on("change",e,e._$6_onScrollBarChange)}u(t,"modules.friendnew.views.FriendNewChatInfoUI",s);var e=t.prototype;return e.destroy=function(e){void 0===e&&(e=!0),s.prototype.destroy.call(this,e),this._list=null},e.refresh=function(){this.runCallLater(this.changeSize),s.prototype.refresh.call(this)},e.changeSize=function(){s.prototype.changeSize.call(this),this._totH=0;for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];i.width=this.width,i.y=this._totH,i.invalid(),i.height=i.textHeight+3,this._totH+=i.textHeight+15}},e._$6_onScrollBarChange=function(){for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];i&&(i.visible=this.isVisible(i))}},e.clear=function(){this._content.removeChildren();for(var e=this._list.length,t=0;t<e;t++){var i=this._list[t];Bn.recover(i)}this._list=[],this._totH=0,this.vScrollBar.max=1,this.vScrollBar.value=0},e.pushInfos=function(e){for(var t=e.length,i=0;i<t;i++){var s=e[i],n=Bn.create();n.x=0,n.color="#e0d6c1",n.width=this.width,n.innerHTML=s.getShowStr(),n.leading=7,n.y=this._totH,this._totH+=n.textHeight+20,this.addChild(n),this._list.push(n)}this.refresh()},e.refreshInfo=function(e){if(null!=e){this.vScrollBar.value;this.clear(),this.pushInfos(e),this.vScrollBar.value=this.vScrollBar.max}},e.onDisplay=function(){this.refreshInfo(wf.instance.getCurrentSelcetedPlayerRecord())},e.isVisible=function(e){return e.y>=this.vScrollBar.value&&e.y<=this.height+this.vScrollBar.value||e.y+e.height>=this.vScrollBar.value&&e.y+e.height<=this.height+this.vScrollBar.value},n(1,t,"instance",function(){return t._instance=t._instance||new t},laya.ui.Panel._$SET_instance),t._instance=null,t}(_c),Lf=function(e){function t(){this.selectBtn=null,this._faceUI=null,this._infoUI=null,this._container=null,t.__super.call(this)}u(t,"modules.friendnew.views.FriendNewMainView",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this),this._faceUI=new $e,this._faceUI.bottom=70,this._faceUI.right=10,this._infoUI=Ef.instance,this.txt_empty.visible=!1},i.onAdd=function(e){var t=this;ui.ViewBase.prototype.onAdd.call(t,e),yf.instance.needToShowView=!1,t._faceUI.list_face.on("click",t,t.onSelect),t.list_player.selectEnable=!0,t.list_player.vScrollBarSkin="",t.list_player.selectHandler=ms.create(t,t.onPlayerSelected,null,!1),t.list_show.vScrollBarSkin="",t.on("click",t,t.onClicked),t.input_text.on("focus",t,t.onFocusChange),t.input_text.on("blur",t,t.onFocusChange),t.input_text.maxChars=40,t.btn_face.on("click",t,t.onFace),t.btn_send.on("click",t,t.onSend),t.btn_close.on("click",t,t.onCloseClicked),t.btn_check.on("click",t,t.onCheckBtnClicked),t.btn_recent.on("click",t,t.onChannel,[t.btn_recent]),t.btn_friend.on("click",t,t.onChannel,[t.btn_friend]),t.btn_apply.on("click",t,t.onChannel,[t.btn_apply]),t.btn_block.on("click",t,t.onChannel,[t.btn_block]),t.onChannel(t.btn_recent),Sf.requestListType(1),t._infoUI.x=164,t._infoUI.y=75,t._infoUI.width=t.width-20-164,t._infoUI.height=t.height-205,t._infoUI.refresh(),t._infoUI.vScrollBar.value=t._infoUI.vScrollBar.max,t.addChild(t._infoUI),t.addChild(t._faceUI),t._faceUI.visible=!1},i.onSelect=function(e){var t="[#"+(this._faceUI.list_face.selectedIndex+1)+"]";if(40<this.input_text.text.length+t.length)Vl.ins.showById(2095,1);else{var i=Kr.getCursorPos(this.input_text);if(-1!=i){var s=this.input_text.text;this.input_text.changeText(s.substring(0,i)+t+s.substring(i)),i+=t.length}else this.input_text.text+=t,i=this.input_text.text.length;Kr.setCursorPos(this.input_text,i)}},i.onRemove=function(e){var t=this;ui.ViewBase.prototype.onRemove.call(t,e),t.off("click",t,t.onClicked),t._faceUI.list_face.off("click",t,t.onSelect),t.input_text.off("focus",t,t.onFocusChange),t.input_text.off("blur",t,t.onFocusChange),t.btn_face.off("click",t,t.onFace),t.btn_send.off("click",t,t.onSend),t.btn_close.off("click",t,t.onCloseClicked),t.btn_check.off("click",t,t.onCheckBtnClicked),t.btn_recent.off("click",t,t.onChannel,[t.btn_recent]),t.btn_friend.off("click",t,t.onChannel,[t.btn_friend]),t.btn_apply.off("click",t,t.onChannel,[t.btn_apply]),t.btn_block.off("click",t,t.onChannel,[t.btn_block]),yf.instance.currentSelectedPlayerID=0,t.selectBtn.selected=!1,t.selectBtn=null,t._infoUI&&t._infoUI.parent&&t._infoUI.parent.removeChild(t._infoUI)},i.updateBtnRed=function(){wf.instance.hasUnreadMessage()?this.btn_recent.showTip=!0:this.btn_recent.showTip=!1,yf.instance.hasApply?this.selectBtn==this.btn_apply?this.btn_apply.showTip=!1:this.btn_apply.showTip=!0:this.btn_apply.showTip=!1},i.onFace=function(){this._faceUI.visible=!this._faceUI.visible},i.onSend=function(){""!=this.input_text.text&&(Sf.requestSendFriendMessage(yf.instance.currentSelectedPlayerID,this.input_text.text),this.input_text.text="",this.promtUpdate())},i.destroy=function(e){void 0===e&&(e=!0),laya.ui.View.prototype.destroy.call(this,e),this._faceUI=null},i.showRecentChannel=function(){this.onChannel(this.btn_recent)},i.onChannel=function(e){var t=this;if(t.selectBtn!=e)switch(t.selectBtn&&(t.selectBtn.selected=!1),t.selectBtn=e,t.selectBtn.selected=!0,t.input_text.editable=!1,t.btn_send.disabled=!1,t.btn_face.disabled=!1,t.txt_empty.visible=!1,t.btn_send.visible=!1,t.btn_face.visible=!1,t.img_closeChatBg.visible=!1,t.txt_desc.visible=!1,t.input_text.text="",t.box_recomend.visible=!1,t.btn_check.visible=!1,t.list_show.mouseEnabled=!1,t.list_player.mouseEnabled=!1,t._infoUI.mouseEnabled=!1,t._infoUI.clear(),t.selectBtn.name){case"recent":t.list_show.dataSource=[],t.img_closeChatBg.visible=!0,t.input_text.editable=!0,t.btn_send.visible=!0,t.btn_face.visible=!0,t.txt_desc.changeText(ed.n[2003]),t.list_player.dataSource=yf.instance.friendList,t.list_player.mouseEnabled=!0,t._infoUI.mouseEnabled=!0,0<yf.instance.currentSelectedPlayerID?t.updateSelectedPlayerID():0<t.list_player.array.length&&t.onPlayerSelected(0),t.updateBtnRed(),Fl.sendToModule("UPDATE_FRIEND_RED_POINT",["modules.nav.NavModule"]);break;case"friend":Sf.requestListType(1),t.btn_check.visible=!0,t.box_recomend.visible=!0,t.list_show.mouseEnabled=!0,yf.instance.currentSelectedPlayerID=0;break;case"apply":yf.instance.currentSelectedPlayerID=0,yf.instance.hasApply=!1,Fl.sendToModule("UPDATE_FRIEND_RED_POINT",["modules.nav.NavModule"]),t.list_show.mouseEnabled=!0,Sf.requestListType(0),t.updateBtnRed();break;case"block":yf.instance.currentSelectedPlayerID=0,t.list_show.mouseEnabled=!0,Sf.requestListType(2),t.box_recomend.visible=!0}else t.selectBtn&&(t.selectBtn.selected=!0)},i.updateSelectedPlayerID=function(){if(0<this.list_player.array.length){var e,t=0;if(0<yf.instance.currentSelectedPlayerID&&this.list_player.selectedIndex<0){for(var i=0;i<this.list_player.array.length;i++)if((e=this.list_player.array[i]).playerID==yf.instance.currentSelectedPlayerID){t=i,this.list_player.selectedIndex=t;break}}else t=this.list_player.selectedIndex<0?0:this.list_player.selectedIndex,e=this.list_player.array[t],this.list_player.scrollTo(t),yf.instance.currentSelectedPlayerID=e.playerID}},i.updateList=function(e){var t=this;switch(t.list_player.dataSource=[],e.type){case 2:if(t.selectBtn==t.btn_block){if(0==e.list.length)return t.txt_empty.visible=!0,t.list_show.dataSource=[],void t.txt_empty.changeText(ed.n[2004]);t.list_show.itemRender=Bf,t.list_show.dataSource=e.list,t.list_show.mouseEnabled=!0}break;case 0:t.selectBtn==t.btn_apply&&(0<e.list.length?t.txt_empty.visible=!1:(t.txt_empty.visible=!0,t.txt_empty.changeText(ed.n[2005])),t.box_recomend.visible=!0,t.list_show.itemRender=Af,t.list_show.dataSource=e.list);break;case 1:t.selectBtn==t.btn_friend?(0<e.list.length?t.txt_empty.visible=!1:(t.txt_empty.visible=!0,t.txt_empty.changeText(ed.n[2006])),t.list_show.itemRender=Df,t.list_show.dataSource=e.list):t.selectBtn==t.btn_recent&&(t.list_show.dataSource=[],t.list_player.itemRender=Of,0==e.list.length?(t.btn_face.disabled=!0,t.btn_send.disabled=!0,t.input_text.editable=!1):(t.input_text.editable=!0,t.btn_face.disabled=!1,t.btn_send.disabled=!1),t.list_player.dataSource=e.list)}},i.onFocusChange=function(){0!=this.input_text.editable&&(this.promtUpdate(),D.isConchApp||qe.onMobile)},i.promtUpdate=function(){this.input_text.text&&0<this.input_text.text.length?this.txt_desc.visible=!1:this.input_text.focus?this.txt_desc.visible=!1:this.txt_desc.visible=!0},i.onCheckBtnClicked=function(e){Fl.sendToModule("OPEN_FRIENDNEW_ADD",["modules.friendnew.FriendNewModule"])},i.onCloseClicked=function(e){On.ins.isOpen("FRIENDNEWMAINVIEW")&&On.ins.close("FRIENDNEWMAINVIEW")},i.onClicked=function(e){this._faceUI.visible&&e.target!=this.btn_face&&(this._faceUI.visible=!1)},i.onPlayerSelected=function(e){var t=this.list_player.array[e];t.selected=!0,wf.instance.getRecordByID(t.playerID).isRed=!1,this.updateSelectedPlayerID(),this._infoUI.refreshInfo(wf.instance.getCurrentSelcetedPlayerRecord());for(var i=0;i<this.list_player.array.length;i++){var s=this.list_player.array[i];if(i!=e&&s.selected){s.selected=!1,this.list_player.changeItem(i,s);break}}this.updateBtnRed()},i.updateChatInfo=function(e){this.list_player.refresh(),e==yf.instance.currentSelectedPlayerID&&this._infoUI.refreshInfo(wf.instance.getCurrentSelcetedPlayerRecord())},t.NAME="FRIENDNEWMAINVIEW",t.maxChar=40,t}(Ja),Af=function(e){function t(){t.__super.call(this)}u(t,"modules.friendnew.views.item.FriendNewApplyRender",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_deline.on("click",this,this.onDelineBtnClicked),this.btn_agree.on("click",this,this.onAgreeBtnClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_deline.off("click",this,this.onDelineBtnClicked),this.btn_agree.off("click",this,this.onAgreeBtnClicked)},i.onDelineBtnClicked=function(e){Sf.requestApply(this.dataSource.playerID,0)},i.onAgreeBtnClicked=function(e){Sf.requestApply(this.dataSource.playerID,1)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){Y.superSet($i,this,"dataSource",e),e&&(this.view_base.img_head.skin=Or.getActorHeadPath(e.firstRoleType,e.firstRoleSex),0<e.zhuanShengLevel?this.view_base.txt_name.text=e.name+"("+e.zhuanShengLevel+"转"+e.level+"级)":this.view_base.txt_name.text=e.name+"("+e.level+"级)",this.view_base.txt_guildName.text=e.guildName)}),t}($i),Bf=function(e){function t(){t.__super.call(this)}u(t,"modules.friendnew.views.item.FriendNewBlockRender",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_del.on("click",this,this.onDeleteBtnClicked),this.view_base.on("click",this,this.onItemClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_del.off("click",this,this.onDeleteBtnClicked),this.view_base.off("click",this,this.onItemClicked)},i.onDeleteBtnClicked=function(e){Sf.requestDelFriend(this.dataSource.playerID,2)},i.onItemClicked=function(e){Qe.ins.playID=this.dataSource.playerID,On.ins.open("FRIENDNEWADDFRIENDVIEW");var t=new kt;t.targetId=this.dataSource.playerID,Fl.sendToService(t)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){Y.superSet(Ye,this,"dataSource",e),e&&(this.view_base.img_head.skin=Or.getActorHeadPath(e.firstRoleType,e.firstRoleSex),0<e.zhuanShengLevel?this.view_base.txt_name.text=e.name+"("+e.zhuanShengLevel+"转"+e.level+"级)":this.view_base.txt_name.text=e.name+"("+e.level+"级)",this.view_base.txt_guildName.text=e.guildName)}),t}(Ye),Df=function(e){function t(){t.__super.call(this)}u(t,"modules.friendnew.views.item.FriendNewFriendRender",e);var i=t.prototype;return i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e),this.btn_del.on("click",this,this.onDeleteBtnClicked),this.view_base.on("click",this,this.onItemClicked)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e),this.btn_del.off("click",this,this.onDeleteBtnClicked),this.view_base.off("click",this,this.onItemClicked)},i.onDeleteBtnClicked=function(){Sf.requestDelFriend(this.dataSource.playerID,1)},i.onItemClicked=function(e){Qe.ins.playID=this.dataSource.playerID,On.ins.open("FRIENDNEWADDFRIENDVIEW");var t=new kt;t.targetId=this.dataSource.playerID,Fl.sendToService(t)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){var t=this;if(Y.superSet(x,t,"dataSource",e),e)if(t.view_base.img_head.skin=Or.getActorHeadPath(e.firstRoleType,e.firstRoleSex),0<e.zhuanShengLevel?t.view_base.txt_name.text=e.name+"("+e.zhuanShengLevel+"转"+e.level+"级)":t.view_base.txt_name.text=e.name+"("+e.level+"级)",t.view_base.txt_guildName.text=e.guildName,e.isOnline)t.txt_time.text="在线",t.txt_time.color="#23b11f";else{var i,s=J.serverTimeSec-e.lastLoginOutTime;t.txt_time.text=ed.n[2007],0<parseInt(s/V.DATE_SECOND+"")?i=parseInt(s/V.DATE_SECOND+"")+"天前":0<parseInt(s/V.HOUR_SECOND+"")?i=parseInt(s/V.HOUR_SECOND+"")+"小时前":0<parseInt(s/60+"")&&(i=parseInt(s/60+"")+"分钟前"),i&&(t.txt_time.text=i),t.txt_time.color="#90877b"}}),t}(x),Of=function(e){function t(){this._isSelected=!1,t.__super.call(this)}u(t,"modules.friendnew.views.item.FriendNewRecentRender",e);var i=t.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this)},i.onAdd=function(e){ui.ViewBase.prototype.onAdd.call(this,e)},i.onRemove=function(e){ui.ViewBase.prototype.onRemove.call(this,e)},n(0,i,"dataSource",e.prototype._$get_dataSource,function(e){if(Y.superSet(gc,this,"dataSource",e),e){this.img_head.skin=Or.getFullUrl("ui/images/actorhead/jb"+e.firstRoleType+"_"+e.firstRoleSex+".png"),this.txt_name.text=e.name;var t=wf.instance.getRecordByID(e.playerID);this._isSelected=!1,yf.instance.currentSelectedPlayerID==e.playerID?(this._isSelected=!0,t.isRed=!1,this.img_bg.index=1):this.img_bg.index=0,this.img_red.visible=t.isRed}}),t}(gc);Y.__init([])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(e,t){"use strict";for(var i in Object.defineProperty(t,"__esModule",{value:!0}),Laya){var s=Laya[i];s&&s.__isclass&&(t[i]=s)}});